diff --git a/packages/mermaid/package.json b/packages/mermaid/package.json
index 4f56d9112..244ebe453 100644
--- a/packages/mermaid/package.json
+++ b/packages/mermaid/package.json
@@ -1,6 +1,6 @@
 {
   "name": "mermaid",
-  "version": "10.2.0",
+  "version": "10.2.0-rc.2",
   "description": "Markdown-ish syntax for generating flowcharts, sequence diagrams, class diagrams, gantt charts and git graphs.",
   "type": "module",
   "module": "./dist/mermaid.core.mjs",
diff --git a/packages/mermaid/src/diagrams/class/parser/classDiagram.jison b/packages/mermaid/src/diagrams/class/parser/classDiagram.jison
index 6a7834eca..7afba66bc 100644
--- a/packages/mermaid/src/diagrams/class/parser/classDiagram.jison
+++ b/packages/mermaid/src/diagrams/class/parser/classDiagram.jison
@@ -200,9 +200,8 @@ Function arguments are optional: 'call <callback_name>()' simply executes 'callb
 
 start
     : mermaidDoc
-    | statements
-    | direction
     | directive start
+    | statements
     ;
 
 direction
@@ -272,7 +271,6 @@ statement
     | clickStatement
     | cssClassStatement
     | noteStatement
-    | directive
     | direction
     | acc_title acc_title_value  { $$=$2.trim();yy.setAccTitle($$); }
     | acc_descr acc_descr_value  { $$=$2.trim();yy.setAccDescription($$); }
diff --git a/scripts/jison/lint.mts b/scripts/jison/lint.mts
index 95edd4fb1..596ce308b 100644
--- a/scripts/jison/lint.mts
+++ b/scripts/jison/lint.mts
@@ -14,12 +14,17 @@ const lint = async (file: string): Promise<boolean> => {
   console.log(`Linting ${file}`);
   const jisonCode = await readFile(file, 'utf8');
   // @ts-ignore no typings
-  const jsCode = new jison.Generator(jisonCode, { moduleType: 'amd' }).generate();
+  const generator = new jison.Generator(jisonCode, { moduleType: 'amd' });
+  const jsCode = generator.generate();
   const [result] = await linter.lintText(jsCode);
   if (result.errorCount > 0) {
     console.error(`Linting failed for ${file}`);
     console.error(result.messages);
   }
+  if (generator.conflicts > 0) {
+    console.error(`Linting failed for ${file}. Conflicts found in grammar`);
+    return false;
+  }
   return result.errorCount === 0;
 };
 
