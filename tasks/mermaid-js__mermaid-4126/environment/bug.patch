diff --git a/packages/mermaid/src/config.type.ts b/packages/mermaid/src/config.type.ts
index 883dcb6ca..c835ee440 100644
--- a/packages/mermaid/src/config.type.ts
+++ b/packages/mermaid/src/config.type.ts
@@ -295,7 +295,6 @@ export interface TimelineDiagramConfig extends BaseDiagramConfig {
   leftMargin?: number;
   width?: number;
   height?: number;
-  padding?: number;
   boxMargin?: number;
   boxTextMargin?: number;
   noteMargin?: number;
@@ -312,7 +311,6 @@ export interface TimelineDiagramConfig extends BaseDiagramConfig {
   sectionFills?: string[];
   sectionColours?: string[];
   disableMulticolor?: boolean;
-  useMaxWidth?: boolean;
 }
 
 export interface GanttDiagramConfig extends BaseDiagramConfig {
diff --git a/packages/mermaid/src/diagram-api/diagram-orchestration.spec.ts b/packages/mermaid/src/diagram-api/diagram-orchestration.spec.ts
deleted file mode 100644
index f08f32391..000000000
--- a/packages/mermaid/src/diagram-api/diagram-orchestration.spec.ts
+++ /dev/null
@@ -1,45 +0,0 @@
-import { it, describe, expect } from 'vitest';
-import { detectType } from './detectType';
-import { addDiagrams } from './diagram-orchestration';
-
-describe('diagram-orchestration', () => {
-  it('should register diagrams', () => {
-    expect(() => detectType('graph TD; A-->B')).toThrow();
-    addDiagrams();
-    expect(detectType('graph TD; A-->B')).toBe('flowchart');
-  });
-
-  describe('proper diagram types should be detetced', () => {
-    beforeAll(() => {
-      addDiagrams();
-    });
-
-    it.each([
-      { text: 'graph TD;', expected: 'flowchart' },
-      { text: 'flowchart TD;', expected: 'flowchart-v2' },
-      { text: 'flowchart-v2 TD;', expected: 'flowchart-v2' },
-      { text: 'flowchart-elk TD;', expected: 'flowchart-elk' },
-      { text: 'error', expected: 'error' },
-      { text: 'C4Context;', expected: 'c4' },
-      { text: 'classDiagram', expected: 'class' },
-      { text: 'classDiagram-v2', expected: 'classDiagram' },
-      { text: 'erDiagram', expected: 'er' },
-      { text: 'journey', expected: 'journey' },
-      { text: 'gantt', expected: 'gantt' },
-      { text: 'pie', expected: 'pie' },
-      { text: 'requirementDiagram', expected: 'requirement' },
-      { text: 'info', expected: 'info' },
-      { text: 'sequenceDiagram', expected: 'sequence' },
-      { text: 'mindmap', expected: 'mindmap' },
-      { text: 'timeline', expected: 'timeline' },
-      { text: 'gitGraph', expected: 'gitGraph' },
-      { text: 'stateDiagram', expected: 'state' },
-      { text: 'stateDiagram-v2', expected: 'stateDiagram' },
-    ])(
-      'should $text be detected as $expected',
-      ({ text, expected }: { text: string; expected: string }) => {
-        expect(detectType(text)).toBe(expected);
-      }
-    );
-  });
-});
diff --git a/packages/mermaid/src/diagram-api/diagram-orchestration.ts b/packages/mermaid/src/diagram-api/diagram-orchestration.ts
index da4c4d081..d06ce846a 100644
--- a/packages/mermaid/src/diagram-api/diagram-orchestration.ts
+++ b/packages/mermaid/src/diagram-api/diagram-orchestration.ts
@@ -45,7 +45,7 @@ export const addDiagrams = () => {
           throw new Error(
             'Diagrams beginning with --- are not valid. ' +
               'If you were trying to use a YAML front-matter, please ensure that ' +
-              "you've correctly opened and closed the YAML front-matter with un-indented `---` blocks"
+              "you've correctly opened and closed the YAML front-matter with unindented `---` blocks"
           );
         },
       },
@@ -55,28 +55,25 @@ export const addDiagrams = () => {
       return text.toLowerCase().trimStart().startsWith('---');
     }
   );
-  // Ordering of detectors is important. The first one to return true will be used.
   registerLazyLoadedDiagrams(
     error,
     c4,
-    classDiagramV2,
     classDiagram,
+    classDiagramV2,
     er,
     gantt,
     info,
     pie,
     requirement,
     sequence,
-    flowchartElk,
-    // TODO @knsv: Should v2 come before flowchart?
-    // This will fail few unit tests as they expect graph to be detected as flowchart, but it is detected as flowchart-v2.
     flowchart,
     flowchartV2,
+    flowchartElk,
     mindmap,
     timeline,
     git,
-    stateV2,
     state,
+    stateV2,
     journey
   );
 };
diff --git a/packages/mermaid/src/diagrams/timeline/timelineRenderer.ts b/packages/mermaid/src/diagrams/timeline/timelineRenderer.ts
index 272ecf0c1..02e706bf6 100644
--- a/packages/mermaid/src/diagrams/timeline/timelineRenderer.ts
+++ b/packages/mermaid/src/diagrams/timeline/timelineRenderer.ts
@@ -1,37 +1,25 @@
-// @ts-ignore - db not typed yet
-import { select, Selection } from 'd3';
+// @ts-nocheck TODO: fix file
+import { select } from 'd3';
 import svgDraw from './svgDraw';
 import { log } from '../../logger';
 import { getConfig } from '../../config';
 import { setupGraphViewbox } from '../../setupGraphViewbox';
-import { Diagram } from '../../Diagram';
-import { MermaidConfig } from '../../config.type';
-
-interface Block<TDesc, TSection> {
-  number: number;
-  descr: TDesc;
-  section: TSection;
-  width: number;
-  padding: number;
-  maxHeight: number;
-}
-
-interface TimelineTask {
-  id: number;
-  section: string;
-  type: string;
-  task: string;
-  score: number;
-  events: string[];
-}
-export const draw = function (text: string, id: string, version: string, diagObj: Diagram) {
+
+export const setConf = function (cnf) {
+  const keys = Object.keys(cnf);
+
+  keys.forEach(function (key) {
+    conf[key] = cnf[key];
+  });
+};
+
+export const draw = function (text, id, version, diagObj) {
   //1. Fetch the configuration
   const conf = getConfig();
-  // @ts-expect-error - wrong config?
-  const LEFT_MARGIN = conf.leftMargin ?? 50;
+  const LEFT_MARGIN = conf.leftMargin ? conf.leftMargin : 50;
 
   //2. Clear the diagram db before parsing
-  diagObj.db.clear?.();
+  diagObj.db.clear();
 
   //3. Parse the diagram text
   diagObj.parser.parse(text + '\n');
@@ -46,19 +34,15 @@ export const draw = function (text: string, id: string, version: string, diagObj
   }
   const root =
     securityLevel === 'sandbox'
-      ? // @ts-ignore d3 types are wrong
-        select(sandboxElement.nodes()[0].contentDocument.body)
+      ? select(sandboxElement.nodes()[0].contentDocument.body)
       : select('body');
 
-  // @ts-ignore d3 types are wrong
   const svg = root.select('#' + id);
 
   svg.append('g');
 
   //4. Fetch the diagram data
-  // @ts-expect-error - db not typed yet
-  const tasks: TimelineTask[] = diagObj.db.getTasks();
-  // @ts-expect-error - db not typed yet
+  const tasks = diagObj.db.getTasks();
   const title = diagObj.db.getCommonDb().getDiagramTitle();
   log.debug('task', tasks);
 
@@ -66,8 +50,7 @@ export const draw = function (text: string, id: string, version: string, diagObj
   svgDraw.initGraphics(svg);
 
   // fetch Sections
-  // @ts-expect-error - db not typed yet
-  const sections: string[] = diagObj.db.getSections();
+  const sections = diagObj.db.getSections();
   log.debug('sections', sections);
 
   let maxSectionHeight = 0;
@@ -84,8 +67,8 @@ export const draw = function (text: string, id: string, version: string, diagObj
   let hasSections = true;
 
   //Calculate the max height of the sections
-  sections.forEach(function (section: string) {
-    const sectionNode: Block<string, number> = {
+  sections.forEach(function (section) {
+    const sectionNode = {
       number: sectionNumber,
       descr: section,
       section: sectionNumber,
@@ -104,9 +87,8 @@ export const draw = function (text: string, id: string, version: string, diagObj
   log.debug('tasks.length', tasks.length);
   //calculate max task height
   // for loop till tasks.length
-
   for (const [i, task] of tasks.entries()) {
-    const taskNode: Block<TimelineTask, string> = {
+    const taskNode = {
       number: i,
       descr: task,
       section: task.section,
@@ -142,14 +124,11 @@ export const draw = function (text: string, id: string, version: string, diagObj
 
   if (sections && sections.length > 0) {
     sections.forEach((section) => {
-      //filter task where tasks.section == section
-      const tasksForSection = tasks.filter((task) => task.section === section);
-
-      const sectionNode: Block<string, number> = {
+      const sectionNode = {
         number: sectionNumber,
         descr: section,
         section: sectionNumber,
-        width: 200 * Math.max(tasksForSection.length, 1) - 50,
+        width: 150,
         padding: 20,
         maxHeight: maxSectionHeight,
       };
@@ -163,6 +142,8 @@ export const draw = function (text: string, id: string, version: string, diagObj
       masterY += maxSectionHeight + 50;
 
       //draw tasks for this section
+      //filter task where tasks.section == section
+      const tasksForSection = tasks.filter((task) => task.section === section);
       if (tasksForSection.length > 0) {
         drawTasks(
           svg,
@@ -234,25 +215,25 @@ export const draw = function (text: string, id: string, version: string, diagObj
   setupGraphViewbox(
     undefined,
     svg,
-    conf.timeline?.padding ?? 50,
-    conf.timeline?.useMaxWidth ?? false
+    conf.timeline.padding ? conf.timeline.padding : 50,
+    conf.timeline.useMaxWidth ? conf.timeline.useMaxWidth : false
   );
 
   // addSVGAccessibilityFields(diagObj.db, diagram, id);
 };
 
 export const drawTasks = function (
-  diagram: Selection<SVGElement, unknown, null, undefined>,
-  tasks: TimelineTask[],
-  sectionColor: number,
-  masterX: number,
-  masterY: number,
-  maxTaskHeight: number,
-  conf: MermaidConfig,
-  maxEventCount: number,
-  maxEventLineLength: number,
-  maxSectionHeight: number,
-  isWithoutSections: boolean
+  diagram,
+  tasks,
+  sectionColor,
+  masterX,
+  masterY,
+  maxTaskHeight,
+  conf,
+  maxEventCount,
+  maxEventLineLength,
+  maxSectionHeight,
+  isWithoutSections
 ) {
   // Draw the tasks
   for (const task of tasks) {
@@ -268,7 +249,6 @@ export const drawTasks = function (
 
     log.debug('taskNode', taskNode);
     // create task wrapper
-
     const taskWrapper = diagram.append('g').attr('class', 'taskWrapper');
     const node = svgDraw.drawNode(taskWrapper, taskNode, sectionColor, conf);
     const taskHeight = node.height;
@@ -283,11 +263,11 @@ export const drawTasks = function (
     if (task.events) {
       // draw a line between the task and the events
       const lineWrapper = diagram.append('g').attr('class', 'lineWrapper');
-      let lineLength = maxTaskHeight;
+      let linelength = maxTaskHeight;
       //add margin to task
       masterY += 100;
-      lineLength =
-        lineLength + drawEvents(diagram, task.events, sectionColor, masterX, masterY, conf);
+      linelength =
+        linelength + drawEvents(diagram, task.events, sectionColor, masterX, masterY, conf);
       masterY -= 100;
 
       lineWrapper
@@ -310,7 +290,7 @@ export const drawTasks = function (
     }
 
     masterX = masterX + 200;
-    if (isWithoutSections && !conf.timeline?.disableMulticolor) {
+    if (isWithoutSections && !getConfig().timeline.disableMulticolor) {
       sectionColor++;
     }
   }
@@ -319,21 +299,14 @@ export const drawTasks = function (
   masterY = masterY - 10;
 };
 
-export const drawEvents = function (
-  diagram: Selection<SVGElement, unknown, null, undefined>,
-  events: string[],
-  sectionColor: number,
-  masterX: number,
-  masterY: number,
-  conf: MermaidConfig
-) {
+export const drawEvents = function (diagram, events, sectionColor, masterX, masterY, conf) {
   let maxEventHeight = 0;
   const eventBeginY = masterY;
   masterY = masterY + 100;
   // Draw the events
   for (const event of events) {
     // create node from event
-    const eventNode: Block<string, number> = {
+    const eventNode = {
       descr: event,
       section: sectionColor,
       number: sectionColor,
@@ -358,8 +331,6 @@ export const drawEvents = function (
 };
 
 export default {
-  setConf: () => {
-    // no-op
-  },
+  setConf,
   draw,
 };
diff --git a/packages/mermaid/src/mermaidAPI.spec.ts b/packages/mermaid/src/mermaidAPI.spec.ts
index d87f035d0..cf858b58e 100644
--- a/packages/mermaid/src/mermaidAPI.spec.ts
+++ b/packages/mermaid/src/mermaidAPI.spec.ts
@@ -666,7 +666,7 @@ describe('mermaidAPI', () => {
       ).rejects.toThrow(
         'Diagrams beginning with --- are not valid. ' +
           'If you were trying to use a YAML front-matter, please ensure that ' +
-          "you've correctly opened and closed the YAML front-matter with un-indented `---` blocks"
+          "you've correctly opened and closed the YAML front-matter with unindented `---` blocks"
       );
     });
     it('does not throw for a valid definition', async () => {
