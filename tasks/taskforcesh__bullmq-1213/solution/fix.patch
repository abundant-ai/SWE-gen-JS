diff --git a/src/classes/job.ts b/src/classes/job.ts
index 1772affc5f..642214f46a 100644
--- a/src/classes/job.ts
+++ b/src/classes/job.ts
@@ -840,10 +840,11 @@ export class Job<
    * Moves the job to the delay set.
    *
    * @param timestamp - timestamp where the job should be moved back to "wait"
+   * @param token - token to check job is locked by current worker
    * @returns
    */
-  moveToDelayed(timestamp: number): Promise<void> {
-    return Scripts.moveToDelayed(this.queue, this.id, timestamp);
+  moveToDelayed(timestamp: number, token?: string): Promise<void> {
+    return Scripts.moveToDelayed(this.queue, this.id, timestamp, token);
   }
 
   /**
diff --git a/src/classes/scripts.ts b/src/classes/scripts.ts
index 8ef92310ce..6378fae252 100644
--- a/src/classes/scripts.ts
+++ b/src/classes/scripts.ts
@@ -594,11 +594,9 @@ export class Scripts {
     opts: MoveToChildrenOpts = {},
   ): Promise<boolean> {
     const client = await queue.client;
-    const multi = client.multi();
 
     const args = this.moveToWaitingChildrenArgs(queue, jobId, token, opts);
-    (<any>multi).moveToWaitingChildren(args);
-    const [[err, result]] = (await multi.exec()) as [[null | Error, number]];
+    const result = await (<any>client).moveToWaitingChildren(args);
 
     switch (result) {
       case 0:
diff --git a/src/commands/moveToDelayed-5.lua b/src/commands/moveToDelayed-5.lua
index ee34e3c840..0fe834a48c 100644
--- a/src/commands/moveToDelayed-5.lua
+++ b/src/commands/moveToDelayed-5.lua
@@ -28,9 +28,9 @@ if rcall("EXISTS", KEYS[3]) == 1 then
     local lockKey = KEYS[3] .. ':lock'
     if rcall("GET", lockKey) == ARGV[3] then
       rcall("DEL", lockKey)
-    end
-  else
+    else
       return -2
+    end
   end
 
   local jobId = ARGV[2]
diff --git a/src/commands/moveToFinished-12.lua b/src/commands/moveToFinished-12.lua
index 9840a4d700..96bf4a454a 100644
--- a/src/commands/moveToFinished-12.lua
+++ b/src/commands/moveToFinished-12.lua
@@ -51,7 +51,8 @@
 
     Events:
       'completed/failed'
-]] local rcall = redis.call
+]]
+local rcall = redis.call
 
 --- Includes
 --- @include "includes/destructureJobKey"
diff --git a/src/commands/moveToWaitingChildren-4.lua b/src/commands/moveToWaitingChildren-4.lua
index f2b23a9d5b..d987302a2f 100644
--- a/src/commands/moveToWaitingChildren-4.lua
+++ b/src/commands/moveToWaitingChildren-4.lua
@@ -21,7 +21,15 @@
 ]]
 local rcall = redis.call
 
-local function move_to_waiting_children (activeKey, waitingChildrenKey, jobId, timestamp)
+local function moveToWaitingChildren (activeKey, waitingChildrenKey, jobId, timestamp, lockKey, token)
+  if token ~= "0" then
+    if rcall("GET", lockKey) == token then
+      rcall("DEL", lockKey)
+    else
+      return -2
+    end
+  end
+
   local score = tonumber(timestamp)
 
   local numRemovedElements = rcall("LREM", activeKey, -1, jobId)
@@ -35,22 +43,16 @@ local function move_to_waiting_children (activeKey, waitingChildrenKey, jobId, t
   return 0
 end
 
-if ARGV[1] ~= "0" then
-  if rcall("GET", KEYS[1]) ~= ARGV[1] then
-      return -2
-  end
-end
-
 if rcall("EXISTS", KEYS[4]) == 1 then
   if ARGV[2] ~= "" then
     if rcall("SISMEMBER", KEYS[4] .. ":dependencies", ARGV[2]) ~= 0 then
-      return move_to_waiting_children(KEYS[2], KEYS[3], ARGV[4], ARGV[3])
+      return moveToWaitingChildren(KEYS[2], KEYS[3], ARGV[4], ARGV[3], KEYS[1], ARGV[1])
     end
 
     return 1
   else
     if rcall("SCARD", KEYS[4] .. ":dependencies") ~= 0 then 
-      return move_to_waiting_children(KEYS[2], KEYS[3], ARGV[4], ARGV[3])
+      return moveToWaitingChildren(KEYS[2], KEYS[3], ARGV[4], ARGV[3], KEYS[1], ARGV[1])
     end
 
     return 1
