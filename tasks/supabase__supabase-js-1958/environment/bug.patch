diff --git a/packages/core/auth-js/src/GoTrueClient.ts b/packages/core/auth-js/src/GoTrueClient.ts
index c61e3483..20dc034b 100644
--- a/packages/core/auth-js/src/GoTrueClient.ts
+++ b/packages/core/auth-js/src/GoTrueClient.ts
@@ -255,9 +255,7 @@ export default class GoTrueClient {
    * Keep extra care to never reject or throw uncaught errors
    */
   protected initializePromise: Promise<InitializeResult> | null = null
-  protected detectSessionInUrl:
-    | boolean
-    | ((url: URL, params: { [parameter: string]: string }) => boolean) = true
+  protected detectSessionInUrl = true
   protected url: string
   protected headers: {
     [key: string]: string
@@ -2102,15 +2100,8 @@ export default class GoTrueClient {
 
   /**
    * Checks if the current URL contains parameters given by an implicit oauth grant flow (https://www.rfc-editor.org/rfc/rfc6749.html#section-4.2)
-   *
-   * If `detectSessionInUrl` is a function, it will be called with the URL and params to determine
-   * if the URL should be processed as a Supabase auth callback. This allows users to exclude
-   * URLs from other OAuth providers (e.g., Facebook Login) that also return access_token in the fragment.
    */
   private _isImplicitGrantCallback(params: { [parameter: string]: string }): boolean {
-    if (typeof this.detectSessionInUrl === 'function') {
-      return this.detectSessionInUrl(new URL(window.location.href), params)
-    }
     return Boolean(params.access_token || params.error_description)
   }
 
diff --git a/packages/core/auth-js/src/lib/types.ts b/packages/core/auth-js/src/lib/types.ts
index 20373818..2840d9e7 100644
--- a/packages/core/auth-js/src/lib/types.ts
+++ b/packages/core/auth-js/src/lib/types.ts
@@ -74,27 +74,8 @@ export type GoTrueClientOptions = {
   headers?: { [key: string]: string }
   /* Optional key name used for storing tokens in local storage. */
   storageKey?: string
-  /**
-   * Set to "true" if you want to automatically detect OAuth grants in the URL and sign in the user.
-   * Set to "false" to disable automatic detection.
-   * Set to a function to provide custom logic for determining if a URL contains a Supabase auth callback.
-   * The function receives the current URL and parsed parameters, and should return true if the URL
-   * should be processed as a Supabase auth callback, or false to ignore it.
-   *
-   * This is useful when your app uses other OAuth providers (e.g., Facebook Login) that also return
-   * access_token in the URL fragment, which would otherwise be incorrectly intercepted by Supabase Auth.
-   *
-   * @example
-   * ```ts
-   * detectSessionInUrl: (url, params) => {
-   *   // Ignore Facebook OAuth redirects
-   *   if (url.pathname === '/facebook/redirect') return false
-   *   // Use default detection for other URLs
-   *   return Boolean(params.access_token || params.error_description)
-   * }
-   * ```
-   */
-  detectSessionInUrl?: boolean | ((url: URL, params: { [parameter: string]: string }) => boolean)
+  /* Set to "true" if you want to automatically detects OAuth grants in the URL and signs in the user. */
+  detectSessionInUrl?: boolean
   /* Set to "true" if you want to automatically refresh the token before expiring. */
   autoRefreshToken?: boolean
   /* Set to "true" if you want to automatically save the user session into local storage. If set to false, session will just be saved in memory. */
diff --git a/packages/core/auth-js/test/GoTrueClient.browser.test.ts b/packages/core/auth-js/test/GoTrueClient.browser.test.ts
index 4ebe0dcb..b2d363bf 100644
--- a/packages/core/auth-js/test/GoTrueClient.browser.test.ts
+++ b/packages/core/auth-js/test/GoTrueClient.browser.test.ts
@@ -428,158 +428,6 @@ describe('Callback URL handling', () => {
 
     expect(client).toBeDefined()
   })
-
-  it('should use custom detectSessionInUrl function to filter out non-Supabase OAuth callbacks', async () => {
-    // Simulate Facebook OAuth redirect with access_token in fragment
-    window.location.href =
-      'http://localhost:9999/facebook/redirect#access_token=facebook-token&data_access_expiration_time=1658889585'
-
-    // Custom predicate to ignore Facebook OAuth redirects
-    const detectSessionInUrlFn = jest.fn((url: URL, params: { [key: string]: string }) => {
-      // Ignore Facebook OAuth redirects
-      if (url.pathname === '/facebook/redirect') return false
-      // Default behavior for other URLs
-      return Boolean(params.access_token || params.error_description)
-    })
-
-    const client = new (require('../src/GoTrueClient').default)({
-      url: 'http://localhost:9999',
-      detectSessionInUrl: detectSessionInUrlFn,
-      autoRefreshToken: false,
-      storage: mockStorage,
-    })
-
-    await client.initialize()
-
-    // The custom function should have been called
-    expect(detectSessionInUrlFn).toHaveBeenCalled()
-    expect(detectSessionInUrlFn).toHaveBeenCalledWith(
-      expect.any(URL),
-      expect.objectContaining({ access_token: 'facebook-token' })
-    )
-
-    // Session should be null because we filtered out the Facebook callback
-    const { data } = await client.getSession()
-    expect(data.session).toBeNull()
-  })
-
-  it('should process Supabase callbacks when custom detectSessionInUrl returns true', async () => {
-    // Simulate Supabase OAuth redirect
-    window.location.href =
-      'http://localhost:9999/auth/callback#access_token=supabase-token&refresh_token=test-refresh&expires_in=3600&token_type=bearer&type=implicit'
-
-    // Mock fetch for user info
-    mockFetch.mockImplementation((url: string) => {
-      if (url.includes('/user')) {
-        return Promise.resolve({
-          ok: true,
-          json: () =>
-            Promise.resolve({
-              id: 'test-user',
-              email: 'test@example.com',
-              created_at: new Date().toISOString(),
-            }),
-        })
-      }
-      return Promise.resolve({
-        ok: true,
-        json: () =>
-          Promise.resolve({
-            access_token: 'supabase-token',
-            refresh_token: 'test-refresh',
-            expires_in: 3600,
-            token_type: 'bearer',
-            user: { id: 'test-user' },
-          }),
-      })
-    })
-
-    // Custom predicate that allows Supabase callbacks but not Facebook
-    const detectSessionInUrlFn = jest.fn((url: URL, params: { [key: string]: string }) => {
-      if (url.pathname === '/facebook/redirect') return false
-      return Boolean(params.access_token || params.error_description)
-    })
-
-    const client = new (require('../src/GoTrueClient').default)({
-      url: 'http://localhost:9999',
-      detectSessionInUrl: detectSessionInUrlFn,
-      autoRefreshToken: false,
-      storage: mockStorage,
-    })
-
-    await client.initialize()
-
-    // The custom function should have been called and returned true
-    expect(detectSessionInUrlFn).toHaveBeenCalled()
-    expect(detectSessionInUrlFn.mock.results[0].value).toBe(true)
-
-    // Session should be set because we allowed this callback
-    const { data } = await client.getSession()
-    expect(data.session).toBeDefined()
-    expect(data.session?.access_token).toBe('supabase-token')
-  })
-
-  it('should return error when custom detectSessionInUrl function throws', async () => {
-    window.location.href = 'http://localhost:9999/callback#access_token=test-token'
-
-    // Reset storage state from previous tests
-    storedSession = null
-
-    // Custom predicate that throws an error
-    const detectSessionInUrlFn = jest.fn(() => {
-      throw new Error('Custom predicate error')
-    })
-
-    const client = new (require('../src/GoTrueClient').default)({
-      url: 'http://localhost:9999',
-      detectSessionInUrl: detectSessionInUrlFn,
-      autoRefreshToken: false,
-      storage: mockStorage,
-    })
-
-    // initialize() catches errors and returns them wrapped in AuthUnknownError
-    const { error } = await client.initialize()
-
-    expect(detectSessionInUrlFn).toHaveBeenCalled()
-    expect(error).toBeDefined()
-    expect(error?.message).toBe('Unexpected error during initialization')
-    expect(error?.originalError?.message).toBe('Custom predicate error')
-  })
-
-  it('should use default behavior when detectSessionInUrl is true (boolean)', async () => {
-    window.location.href =
-      'http://localhost:9999/callback#access_token=test-token&refresh_token=test-refresh&expires_in=3600&token_type=bearer&type=implicit'
-
-    // Mock fetch for user info
-    mockFetch.mockImplementation((url: string) => {
-      if (url.includes('/user')) {
-        return Promise.resolve({
-          ok: true,
-          json: () =>
-            Promise.resolve({
-              id: 'test-user',
-              email: 'test@example.com',
-              created_at: new Date().toISOString(),
-            }),
-        })
-      }
-      return Promise.resolve({ ok: true, json: () => Promise.resolve({}) })
-    })
-
-    const client = new (require('../src/GoTrueClient').default)({
-      url: 'http://localhost:9999',
-      detectSessionInUrl: true, // Boolean true - use default behavior
-      autoRefreshToken: false,
-      storage: mockStorage,
-    })
-
-    await client.initialize()
-
-    // Should process the callback with default behavior
-    const { data } = await client.getSession()
-    expect(data.session).toBeDefined()
-    expect(data.session?.access_token).toBe('test-token')
-  })
 })
 
 describe('GoTrueClient BroadcastChannel', () => {
diff --git a/packages/core/postgrest-js/src/PostgrestFilterBuilder.ts b/packages/core/postgrest-js/src/PostgrestFilterBuilder.ts
index 60e6ef1d..67efc57a 100644
--- a/packages/core/postgrest-js/src/PostgrestFilterBuilder.ts
+++ b/packages/core/postgrest-js/src/PostgrestFilterBuilder.ts
@@ -379,6 +379,34 @@ export default class PostgrestFilterBuilder<
     return this
   }
 
+  /**
+   * Match only rows where `column` is NOT included in the `values` array.
+   *
+   * @param column - The column to filter on
+   * @param values - The values array to filter with
+   */
+  notIn<ColumnName extends string>(
+    column: ColumnName,
+    values: ReadonlyArray<
+      ResolveFilterValue<Schema, Row, ColumnName> extends never
+        ? unknown
+        : ResolveFilterValue<Schema, Row, ColumnName> extends infer ResolvedFilterValue
+          ? ResolvedFilterValue
+          : never
+    >
+  ): this {
+    const cleanedValues = Array.from(new Set(values))
+      .map((s) => {
+        // handle postgrest reserved characters
+        // https://postgrest.org/en/v7.0.0/api.html#reserved-characters
+        if (typeof s === 'string' && PostgrestReservedCharsRegexp.test(s)) return `"${s}"`
+        else return `${s}`
+      })
+      .join(',')
+    this.url.searchParams.append(column, `not.in.(${cleanedValues})`)
+    return this
+  }
+
   contains<ColumnName extends string & keyof Row>(
     column: ColumnName,
     value: string | ReadonlyArray<Row[ColumnName]> | Record<string, unknown>
diff --git a/packages/core/postgrest-js/test/filters.test.ts b/packages/core/postgrest-js/test/filters.test.ts
index 1e658019..8517aa15 100644
--- a/packages/core/postgrest-js/test/filters.test.ts
+++ b/packages/core/postgrest-js/test/filters.test.ts
@@ -353,6 +353,20 @@ test('in', async () => {
   `)
 })
 
+test('notIn', async () => {
+  const statuses = ['ONLINE', 'OFFLINE'] as const
+  const res = await postgrest.from('users').select('status').notIn('status', statuses)
+  expect(res).toMatchInlineSnapshot(`
+    {
+      "count": null,
+      "data": [],
+      "error": null,
+      "status": 200,
+      "statusText": "OK",
+    }
+  `)
+})
+
 test('contains', async () => {
   const res = await postgrest.from('users').select('age_range').contains('age_range', '[1,2)')
   expect(res).toMatchInlineSnapshot(`
diff --git a/packages/core/realtime-js/src/RealtimeChannel.ts b/packages/core/realtime-js/src/RealtimeChannel.ts
index aa73036a..4db04339 100644
--- a/packages/core/realtime-js/src/RealtimeChannel.ts
+++ b/packages/core/realtime-js/src/RealtimeChannel.ts
@@ -554,21 +554,22 @@ export default class RealtimeChannel {
     payload: any,
     opts: { timeout?: number } = {}
   ): Promise<{ success: true } | { success: false; status: number; error: string }> {
-    const authorization = this.socket.accessTokenValue
-      ? `Bearer ${this.socket.accessTokenValue}`
-      : ''
-
     if (payload === undefined || payload === null) {
       return Promise.reject('Payload is required for httpSend()')
     }
 
+    const headers: Record<string, string> = {
+      apikey: this.socket.apiKey ? this.socket.apiKey : '',
+      'Content-Type': 'application/json',
+    }
+
+    if (this.socket.accessTokenValue) {
+      headers['Authorization'] = `Bearer ${this.socket.accessTokenValue}`
+    }
+
     const options = {
       method: 'POST',
-      headers: {
-        Authorization: authorization,
-        apikey: this.socket.apiKey ? this.socket.apiKey : '',
-        'Content-Type': 'application/json',
-      },
+      headers,
       body: JSON.stringify({
         messages: [
           {
@@ -626,16 +627,18 @@ export default class RealtimeChannel {
       )
 
       const { event, payload: endpoint_payload } = args
-      const authorization = this.socket.accessTokenValue
-        ? `Bearer ${this.socket.accessTokenValue}`
-        : ''
+      const headers: Record<string, string> = {
+        apikey: this.socket.apiKey ? this.socket.apiKey : '',
+        'Content-Type': 'application/json',
+      }
+
+      if (this.socket.accessTokenValue) {
+        headers['Authorization'] = `Bearer ${this.socket.accessTokenValue}`
+      }
+
       const options = {
         method: 'POST',
-        headers: {
-          Authorization: authorization,
-          apikey: this.socket.apiKey ? this.socket.apiKey : '',
-          'Content-Type': 'application/json',
-        },
+        headers,
         body: JSON.stringify({
           messages: [
             {
diff --git a/packages/core/realtime-js/test/RealtimeChannel.messaging.test.ts b/packages/core/realtime-js/test/RealtimeChannel.messaging.test.ts
index 5b26f657..f75b0702 100644
--- a/packages/core/realtime-js/test/RealtimeChannel.messaging.test.ts
+++ b/packages/core/realtime-js/test/RealtimeChannel.messaging.test.ts
@@ -330,7 +330,7 @@ describe('send', () => {
       {
         description: 'without access token',
         accessToken: undefined,
-        expectedAuth: '',
+        expectedAuth: undefined,
       },
       {
         description: 'with access token',
@@ -363,13 +363,17 @@ describe('send', () => {
           config: { private: true },
         })
 
+        const expectedHeaders: Record<string, string> = {
+          apikey: 'abc123',
+          'Content-Type': 'application/json',
+        }
+        if (expectedAuth) {
+          expectedHeaders['Authorization'] = expectedAuth
+        }
+
         const expectedBody = {
           method: 'POST',
-          headers: {
-            Authorization: expectedAuth,
-            apikey: 'abc123',
-            'Content-Type': 'application/json',
-          },
+          headers: expectedHeaders,
           body: '{"messages":[{"topic":"topic","event":"test","private":true}]}',
           signal: new AbortController().signal,
         }
@@ -498,12 +502,12 @@ describe('httpSend', () => {
     {
       name: 'without access token',
       hasToken: false,
-      expectedAuth: '',
+      expectedAuth: undefined as string | undefined,
     },
     {
       name: 'with access token',
       hasToken: true,
-      expectedAuth: 'Bearer token123',
+      expectedAuth: 'Bearer token123' as string | undefined,
     },
   ]
 
diff --git a/packages/core/supabase-js/src/lib/types.ts b/packages/core/supabase-js/src/lib/types.ts
index 55cea95c..fde2a486 100644
--- a/packages/core/supabase-js/src/lib/types.ts
+++ b/packages/core/supabase-js/src/lib/types.ts
@@ -48,26 +48,8 @@ export type SupabaseClientOptions<SchemaName> = {
     persistSession?: boolean
     /**
      * Detect a session from the URL. Used for OAuth login callbacks. Defaults to true.
-     *
-     * Can be set to a function to provide custom logic for determining if a URL contains
-     * a Supabase auth callback. The function receives the current URL and parsed parameters,
-     * and should return true if the URL should be processed as a Supabase auth callback.
-     *
-     * This is useful when your app uses other OAuth providers (e.g., Facebook Login) that
-     * also return access_token in the URL fragment, which would otherwise be incorrectly
-     * intercepted by Supabase Auth.
-     *
-     * @example
-     * ```ts
-     * detectSessionInUrl: (url, params) => {
-     *   // Ignore Facebook OAuth redirects
-     *   if (url.pathname === '/facebook/redirect') return false
-     *   // Use default detection for other URLs
-     *   return Boolean(params.access_token || params.error_description)
-     * }
-     * ```
      */
-    detectSessionInUrl?: boolean | ((url: URL, params: { [parameter: string]: string }) => boolean)
+    detectSessionInUrl?: boolean
     /**
      * A storage provider. Used to store the logged-in session.
      */
