diff --git a/packages/core/auth-js/src/GoTrueClient.ts b/packages/core/auth-js/src/GoTrueClient.ts
index 20dc034b..c61e3483 100644
--- a/packages/core/auth-js/src/GoTrueClient.ts
+++ b/packages/core/auth-js/src/GoTrueClient.ts
@@ -255,7 +255,9 @@ export default class GoTrueClient {
    * Keep extra care to never reject or throw uncaught errors
    */
   protected initializePromise: Promise<InitializeResult> | null = null
-  protected detectSessionInUrl = true
+  protected detectSessionInUrl:
+    | boolean
+    | ((url: URL, params: { [parameter: string]: string }) => boolean) = true
   protected url: string
   protected headers: {
     [key: string]: string
@@ -2100,8 +2102,15 @@ export default class GoTrueClient {
 
   /**
    * Checks if the current URL contains parameters given by an implicit oauth grant flow (https://www.rfc-editor.org/rfc/rfc6749.html#section-4.2)
+   *
+   * If `detectSessionInUrl` is a function, it will be called with the URL and params to determine
+   * if the URL should be processed as a Supabase auth callback. This allows users to exclude
+   * URLs from other OAuth providers (e.g., Facebook Login) that also return access_token in the fragment.
    */
   private _isImplicitGrantCallback(params: { [parameter: string]: string }): boolean {
+    if (typeof this.detectSessionInUrl === 'function') {
+      return this.detectSessionInUrl(new URL(window.location.href), params)
+    }
     return Boolean(params.access_token || params.error_description)
   }
 
diff --git a/packages/core/auth-js/src/lib/types.ts b/packages/core/auth-js/src/lib/types.ts
index 2840d9e7..20373818 100644
--- a/packages/core/auth-js/src/lib/types.ts
+++ b/packages/core/auth-js/src/lib/types.ts
@@ -74,8 +74,27 @@ export type GoTrueClientOptions = {
   headers?: { [key: string]: string }
   /* Optional key name used for storing tokens in local storage. */
   storageKey?: string
-  /* Set to "true" if you want to automatically detects OAuth grants in the URL and signs in the user. */
-  detectSessionInUrl?: boolean
+  /**
+   * Set to "true" if you want to automatically detect OAuth grants in the URL and sign in the user.
+   * Set to "false" to disable automatic detection.
+   * Set to a function to provide custom logic for determining if a URL contains a Supabase auth callback.
+   * The function receives the current URL and parsed parameters, and should return true if the URL
+   * should be processed as a Supabase auth callback, or false to ignore it.
+   *
+   * This is useful when your app uses other OAuth providers (e.g., Facebook Login) that also return
+   * access_token in the URL fragment, which would otherwise be incorrectly intercepted by Supabase Auth.
+   *
+   * @example
+   * ```ts
+   * detectSessionInUrl: (url, params) => {
+   *   // Ignore Facebook OAuth redirects
+   *   if (url.pathname === '/facebook/redirect') return false
+   *   // Use default detection for other URLs
+   *   return Boolean(params.access_token || params.error_description)
+   * }
+   * ```
+   */
+  detectSessionInUrl?: boolean | ((url: URL, params: { [parameter: string]: string }) => boolean)
   /* Set to "true" if you want to automatically refresh the token before expiring. */
   autoRefreshToken?: boolean
   /* Set to "true" if you want to automatically save the user session into local storage. If set to false, session will just be saved in memory. */
diff --git a/packages/core/postgrest-js/src/PostgrestFilterBuilder.ts b/packages/core/postgrest-js/src/PostgrestFilterBuilder.ts
index 67efc57a..60e6ef1d 100644
--- a/packages/core/postgrest-js/src/PostgrestFilterBuilder.ts
+++ b/packages/core/postgrest-js/src/PostgrestFilterBuilder.ts
@@ -379,34 +379,6 @@ export default class PostgrestFilterBuilder<
     return this
   }
 
-  /**
-   * Match only rows where `column` is NOT included in the `values` array.
-   *
-   * @param column - The column to filter on
-   * @param values - The values array to filter with
-   */
-  notIn<ColumnName extends string>(
-    column: ColumnName,
-    values: ReadonlyArray<
-      ResolveFilterValue<Schema, Row, ColumnName> extends never
-        ? unknown
-        : ResolveFilterValue<Schema, Row, ColumnName> extends infer ResolvedFilterValue
-          ? ResolvedFilterValue
-          : never
-    >
-  ): this {
-    const cleanedValues = Array.from(new Set(values))
-      .map((s) => {
-        // handle postgrest reserved characters
-        // https://postgrest.org/en/v7.0.0/api.html#reserved-characters
-        if (typeof s === 'string' && PostgrestReservedCharsRegexp.test(s)) return `"${s}"`
-        else return `${s}`
-      })
-      .join(',')
-    this.url.searchParams.append(column, `not.in.(${cleanedValues})`)
-    return this
-  }
-
   contains<ColumnName extends string & keyof Row>(
     column: ColumnName,
     value: string | ReadonlyArray<Row[ColumnName]> | Record<string, unknown>
diff --git a/packages/core/realtime-js/src/RealtimeChannel.ts b/packages/core/realtime-js/src/RealtimeChannel.ts
index 4db04339..aa73036a 100644
--- a/packages/core/realtime-js/src/RealtimeChannel.ts
+++ b/packages/core/realtime-js/src/RealtimeChannel.ts
@@ -554,22 +554,21 @@ export default class RealtimeChannel {
     payload: any,
     opts: { timeout?: number } = {}
   ): Promise<{ success: true } | { success: false; status: number; error: string }> {
+    const authorization = this.socket.accessTokenValue
+      ? `Bearer ${this.socket.accessTokenValue}`
+      : ''
+
     if (payload === undefined || payload === null) {
       return Promise.reject('Payload is required for httpSend()')
     }
 
-    const headers: Record<string, string> = {
-      apikey: this.socket.apiKey ? this.socket.apiKey : '',
-      'Content-Type': 'application/json',
-    }
-
-    if (this.socket.accessTokenValue) {
-      headers['Authorization'] = `Bearer ${this.socket.accessTokenValue}`
-    }
-
     const options = {
       method: 'POST',
-      headers,
+      headers: {
+        Authorization: authorization,
+        apikey: this.socket.apiKey ? this.socket.apiKey : '',
+        'Content-Type': 'application/json',
+      },
       body: JSON.stringify({
         messages: [
           {
@@ -627,18 +626,16 @@ export default class RealtimeChannel {
       )
 
       const { event, payload: endpoint_payload } = args
-      const headers: Record<string, string> = {
-        apikey: this.socket.apiKey ? this.socket.apiKey : '',
-        'Content-Type': 'application/json',
-      }
-
-      if (this.socket.accessTokenValue) {
-        headers['Authorization'] = `Bearer ${this.socket.accessTokenValue}`
-      }
-
+      const authorization = this.socket.accessTokenValue
+        ? `Bearer ${this.socket.accessTokenValue}`
+        : ''
       const options = {
         method: 'POST',
-        headers,
+        headers: {
+          Authorization: authorization,
+          apikey: this.socket.apiKey ? this.socket.apiKey : '',
+          'Content-Type': 'application/json',
+        },
         body: JSON.stringify({
           messages: [
             {
diff --git a/packages/core/supabase-js/src/lib/types.ts b/packages/core/supabase-js/src/lib/types.ts
index fde2a486..55cea95c 100644
--- a/packages/core/supabase-js/src/lib/types.ts
+++ b/packages/core/supabase-js/src/lib/types.ts
@@ -48,8 +48,26 @@ export type SupabaseClientOptions<SchemaName> = {
     persistSession?: boolean
     /**
      * Detect a session from the URL. Used for OAuth login callbacks. Defaults to true.
+     *
+     * Can be set to a function to provide custom logic for determining if a URL contains
+     * a Supabase auth callback. The function receives the current URL and parsed parameters,
+     * and should return true if the URL should be processed as a Supabase auth callback.
+     *
+     * This is useful when your app uses other OAuth providers (e.g., Facebook Login) that
+     * also return access_token in the URL fragment, which would otherwise be incorrectly
+     * intercepted by Supabase Auth.
+     *
+     * @example
+     * ```ts
+     * detectSessionInUrl: (url, params) => {
+     *   // Ignore Facebook OAuth redirects
+     *   if (url.pathname === '/facebook/redirect') return false
+     *   // Use default detection for other URLs
+     *   return Boolean(params.access_token || params.error_description)
+     * }
+     * ```
      */
-    detectSessionInUrl?: boolean
+    detectSessionInUrl?: boolean | ((url: URL, params: { [parameter: string]: string }) => boolean)
     /**
      * A storage provider. Used to store the logged-in session.
      */
