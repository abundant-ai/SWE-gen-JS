diff --git a/.circleci/config.yml b/.circleci/config.yml
index 8fa94ead5..7e6c5ec1a 100644
--- a/.circleci/config.yml
+++ b/.circleci/config.yml
@@ -1,116 +1,151 @@
-version: 2
+version: 2.1
+
+parameters:
+  check-legacy-node-version:
+    type: boolean
+    default: false
+  legacy-node-version:
+    type: string
+    default: '18.20'
+  maintenance-node-version:
+    type: string
+    default: '20.18'
+  active-node-version:
+    type: string
+    default: '22.11'
+  current-node-version:
+    type: string
+    default: '23.3'
 
 aliases:
   - &restore-cache
     restore_cache:
-        key: dependency-cache-{{ checksum "package.json" }}
+      key: dependency-cache-{{ checksum "package.json" }}
+  - &save-cache
+    save_cache:
+      key: dependency-cache-{{ checksum "package.json" }}
+      paths:
+        - ./node_modules
   - &install-deps
     run:
-        name: Install dependencies
-        command: npm ci
+      name: Install dependencies
+      command: npm ci --legacy-peer-deps
   - &build-packages
     run:
-        name: Build
-        command: npm run build
+      name: Build
+      command: npm run build
   - &run-unit-tests
     run:
-        name: Test
-        command: npm run test
-
-unit-tests-template: &unit-tests-template
-  working_directory: ~/nest
-  steps:
-    - checkout
-    - *restore-cache
-    - *install-deps
-    - *build-packages
-    - *run-unit-tests
+      name: Test
+      command: npm run test
 
 jobs:
   build:
     working_directory: ~/nest
     docker:
-      - image: circleci/node:12
+      - image: cimg/node:<< pipeline.parameters.maintenance-node-version >>
     steps:
       - checkout
       - run:
           name: Update NPM version
-          command: 'sudo npm install -g npm@latest'
-      - restore_cache:
-          key: dependency-cache-{{ checksum "package.json" }}
-      - run:
-          name: Install dependencies
-          command: npm ci
-      - save_cache:
-          key: dependency-cache-{{ checksum "package.json" }}
-          paths:
-            - ./node_modules
-      - run:
-          name: Build
-          command: npm run build
-        
-  test_node_12:
-    working_directory: ~/nest
-    docker:
-      - image: circleci/node:12
-    steps:
-      - checkout
+          command: 'sudo npm install -g npm@^9'
       - *restore-cache
       - *install-deps
+      - *save-cache
       - *build-packages
-      - *run-unit-tests
-      - run:
-          name: Collect coverage
-          command: npm run coverage
-      - store_artifacts:
-          path: coverage
 
-  test_node_10:
-    <<: *unit-tests-template
-    docker:
-      - image: circleci/node:10
-
-  test_node_14:
-    <<: *unit-tests-template
-    docker:
-      - image: circleci/node:14
-    
-  test_node_16:
-    <<: *unit-tests-template
+  test:
+    parameters:
+      node-version:
+        type: string
+    working_directory: ~/nest
     docker:
-      - image: circleci/node:16
+      - image: cimg/node:<< parameters.node-version >>
+    steps:
+      - when:
+          condition:
+            and:
+              - equal:
+                  [
+                    '<< parameters.node-version >>',
+                    '<< pipeline.parameters.legacy-node-version >>',
+                  ]
+              - not: << pipeline.parameters.check-legacy-node-version >>
+          steps:
+            - run:
+                name: Skip
+                command: |
+                  echo Skipping
+      - when:
+          condition:
+            or:
+              - not:
+                  equal:
+                    [
+                      '<< parameters.node-version >>',
+                      '<< pipeline.parameters.legacy-node-version >>',
+                    ]
+              - << pipeline.parameters.check-legacy-node-version >>
+          steps:
+            - checkout
+            - *restore-cache
+            - *install-deps
+            - *build-packages
+            - when:
+                condition:
+                  equal:
+                    [
+                      '<< parameters.node-version >>',
+                      '<< pipeline.parameters.maintenance-node-version >>',
+                    ]
+                steps:
+                  - run:
+                      name: Test (coverage)
+                      command: npm run test:cov
+                  - run:
+                      name: Collect coverage
+                      command: npm run coverage
+                  - store_artifacts:
+                      path: coverage
+            - when:
+                condition:
+                  not:
+                    equal:
+                      [
+                        '<< parameters.node-version >>',
+                        '<< pipeline.parameters.maintenance-node-version >>',
+                      ]
+                steps:
+                  - *run-unit-tests
 
   lint:
     working_directory: ~/nest
     docker:
-      - image: circleci/node:12
+      - image: cimg/node:<< pipeline.parameters.active-node-version >>
     steps:
       - checkout
       - *restore-cache
       - *install-deps
       - run:
           name: Lint
-          command: npm run lint
-      - run:
-          name: Lint commit
-          command: ./node_modules/.bin/commitlint-circle -c .commitlintrc.json
+          command: npm run lint:ci
 
   integration_tests:
     working_directory: ~/nest
     machine: true
     steps:
       - checkout
-      - run: 
+      - run:
           name: Prepare nvm
           command: |
             echo 'export NVM_DIR="/opt/circleci/.nvm"' >> $BASH_ENV
             echo ' [ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"' >> $BASH_ENV
-      - run: 
+      - run:
           name: Upgrade Node.js
           command: |
-            nvm install v12
+            nvm install << pipeline.parameters.maintenance-node-version >>
             node -v
-            nvm alias default v12
+            nvm alias default << pipeline.parameters.maintenance-node-version >>
       - run:
           name: Install Docker Compose
           command: |
@@ -129,11 +164,11 @@ jobs:
       - run:
           name: Integration tests
           command: npm run test:integration
-          
+
   codechecks_benchmarks:
     working_directory: ~/nest
     docker:
-      - image: circleci/node:12
+      - image: cimg/node:<< pipeline.parameters.maintenance-node-version >>
     steps:
       - checkout
       - *restore-cache
@@ -149,9 +184,9 @@ jobs:
   samples:
     working_directory: ~/nest
     docker:
-      - image: circleci/node:12
+      - image: cimg/node:<< pipeline.parameters.maintenance-node-version >>
     environment:
-      - DISABLE_OPENCOLLECTIVE: true
+      DISABLE_OPENCOLLECTIVE: 'true'
     steps:
       - checkout
       - *restore-cache
@@ -161,22 +196,21 @@ jobs:
           command: npm run build:samples
 
 workflows:
-  version: 2
   build-and-test:
     jobs:
       - build
-      - test_node_16:
-          requires:
-            - build
-      - test_node_14:
-          requires:
-            - build
-      - test_node_12:
-          requires:
-            - build
-      - test_node_10:
+      - test:
           requires:
             - build
+          matrix:
+            parameters:
+              node-version:
+                [
+                  '<< pipeline.parameters.legacy-node-version >>',
+                  '<< pipeline.parameters.maintenance-node-version >>',
+                  '<< pipeline.parameters.active-node-version >>',
+                  '<< pipeline.parameters.current-node-version >>',
+                ]
       - lint:
           requires:
             - build
diff --git a/.circleci/install-wrk.sh b/.circleci/install-wrk.sh
index 31f910edd..e78e13622 100755
--- a/.circleci/install-wrk.sh
+++ b/.circleci/install-wrk.sh
@@ -6,8 +6,8 @@ cd "$(dirname "$0")"
 
 cd /tmp/
 sudo apt-get install build-essential libssl-dev git -y
-git clone https://github.com/wg/wrk.git wrk
+git clone --depth=1 https://github.com/wg/wrk.git wrk
 cd wrk
 sudo make
 # move the executable to somewhere in your PATH, ex:
-sudo cp wrk /usr/local/bin
\ No newline at end of file
+sudo cp wrk /usr/local/bin
diff --git a/.commitlintrc.json b/.commitlintrc.json
index 5c5e64d4b..d541ae390 100644
--- a/.commitlintrc.json
+++ b/.commitlintrc.json
@@ -23,6 +23,22 @@
         "test",
         "sample"
       ]
+    ],
+    "scope-enum": [
+      1,
+      "always",
+      [
+        "common",
+        "core",
+        "sample",
+        "microservices",
+        "express",
+        "fastify",
+        "socket.io",
+        "ws",
+        "testing",
+        "websockets"
+      ]
     ]
   }
 }
diff --git a/.eslintignore b/.eslintignore
deleted file mode 100644
index 4197b94e5..000000000
--- a/.eslintignore
+++ /dev/null
@@ -1 +0,0 @@
-**/node_modules/**
\ No newline at end of file
diff --git a/.eslintrc.spec.js b/.eslintrc.spec.js
deleted file mode 100644
index f7b2e8ed7..000000000
--- a/.eslintrc.spec.js
+++ /dev/null
@@ -1,13 +0,0 @@
-const baseConfig = require('./.eslintrc');
-
-module.exports = {
-  ...baseConfig,
-  parserOptions: {
-    project: 'tsconfig.spec.json',
-    sourceType: 'module',
-  },
-  rules: {
-    ...baseConfig.rules,
-    '@typescript-eslint/no-empty-function': 'off',
-  },
-};
diff --git a/.github/ISSUE_TEMPLATE/Bug_report.yml b/.github/ISSUE_TEMPLATE/Bug_report.yml
index 98e32d7ca..bb3cb8597 100644
--- a/.github/ISSUE_TEMPLATE/Bug_report.yml
+++ b/.github/ISSUE_TEMPLATE/Bug_report.yml
@@ -6,7 +6,7 @@ body:
     attributes:
       value: |
         ## :warning: We use GitHub Issues to track bug reports, feature requests and regressions
- 
+
         If you are not sure that your issue is a bug, you could:
 
         - read the [FAQ's common errors](https://docs.nestjs.com/faq/common-errors) page
@@ -38,15 +38,19 @@ body:
       required: true
     attributes:
       label: "Minimum reproduction code"
-      description: "An URL to some Git repository/[StackBlitz](https://stackblitz.com/fork/github/nestjs/typescript-starter)/[CodeSandbox](https://codesandbox.io/s/github/nestjs/typescript-starter/tree/master) project that reproduces your issue. [Wtf is a minimum reproduction?](https://jmcdo29.github.io/wtf-is-a-minimum-reproduction)"
       placeholder: "https://github.com/..."
+      description: |
+        An URL to some Git repository/[StackBlitz](https://stackblitz.com/fork/github/nestjs/typescript-starter)/[CodeSandbox](https://codesandbox.io/s/github/nestjs/typescript-starter/tree/master) project that reproduces your issue. [What is a minimum reproduction?](https://jmcdo29.github.io/wtf-is-a-minimum-reproduction)
+
+        > [!WARNING]
+        > We may close this Issue if we don't manage to reproduce the potential bug. [Read this](https://antfu.me/posts/why-reproductions-are-required) to understand why.
 
   - type: textarea
     attributes:
       label: "Steps to reproduce"
       description: |
         How the issue manifests?
-        You could leave this blank if you alread write this in your reproduction code
+        You could leave this blank if you already write this in your reproduction code
       placeholder: |
         1. `npm ci`
         2. `npm start:dev`
@@ -57,7 +61,7 @@ body:
       required: true
     attributes:
       label: "Expected behavior"
-      description: "A clear and concise description of what you expected to happend (or code)"
+      description: "A clear and concise description of what you expected to happened (or code)"
 
   - type: markdown
     attributes:
diff --git a/.github/ISSUE_TEMPLATE/Feature_request.yml b/.github/ISSUE_TEMPLATE/Feature_request.yml
index 4bd28c420..814d41081 100644
--- a/.github/ISSUE_TEMPLATE/Feature_request.yml
+++ b/.github/ISSUE_TEMPLATE/Feature_request.yml
@@ -6,7 +6,7 @@ body:
     attributes:
       value: |
         ## :warning: We use GitHub Issues to track bug reports, feature requests and regressions
- 
+
         If you are not sure that your issue is a bug, you could:
 
         - read the [FAQ's common errors](https://docs.nestjs.com/faq/common-errors) page
diff --git a/.github/ISSUE_TEMPLATE/Regression.yml b/.github/ISSUE_TEMPLATE/Regression.yml
index 66ac1610b..f6e2961a7 100644
--- a/.github/ISSUE_TEMPLATE/Regression.yml
+++ b/.github/ISSUE_TEMPLATE/Regression.yml
@@ -6,7 +6,7 @@ body:
     attributes:
       value: |
         ## :warning: We use GitHub Issues to track bug reports, feature requests and regressions
- 
+
         If you are not sure that your issue is a bug, you could:
 
         - read the [FAQ's common errors](https://docs.nestjs.com/faq/common-errors) page
@@ -74,7 +74,7 @@ body:
       required: true
     attributes:
       label: "Expected behavior"
-      description: "A clear and concise description of what you expected to happend (or code)"
+      description: "A clear and concise description of what you expected to happened (or code)"
 
   - type: textarea
     attributes:
diff --git a/.github/dependabot.yml b/.github/dependabot.yml
index 4872c5afd..b31110af1 100644
--- a/.github/dependabot.yml
+++ b/.github/dependabot.yml
@@ -5,3 +5,8 @@ updates:
   schedule:
     interval: daily
   open-pull-requests-limit: 10
+- package-ecosystem: "github-actions"
+  directory: "/"
+  schedule:
+    interval: daily
+  open-pull-requests-limit: 10
diff --git a/.github/workflows/codeql-analysis.yml b/.github/workflows/codeql-analysis.yml
index d148be272..d6beb71c4 100644
--- a/.github/workflows/codeql-analysis.yml
+++ b/.github/workflows/codeql-analysis.yml
@@ -9,14 +9,19 @@ on:
   schedule:
     - cron: '0 17 * * 4'
 
+permissions:
+  contents: read
+
 jobs:
   analyse:
+    permissions:
+      security-events: write
     name: Analyse
     runs-on: ubuntu-latest
 
     steps:
     - name: Checkout repository
-      uses: actions/checkout@v2
+      uses: actions/checkout@v4
       with:
         # We must fetch at least the immediate parents so that if this is
         # a pull request then we can checkout the head.
@@ -29,7 +34,9 @@ jobs:
 
     # Initializes the CodeQL tools for scanning.
     - name: Initialize CodeQL
-      uses: github/codeql-action/init@v1
+      uses: github/codeql-action/init@v3
+      with:
+        queries: +security-extended
       # Override language selection by uncommenting this and choosing your languages
       # with:
       #   languages: go, javascript, csharp, python, cpp, java
@@ -37,7 +44,7 @@ jobs:
     # Autobuild attempts to build any compiled languages  (C/C++, C#, or Java).
     # If this step fails, then you should remove it and run the build manually (see below)
     - name: Autobuild
-      uses: github/codeql-action/autobuild@v1
+      uses: github/codeql-action/autobuild@v3
 
     # ‚ÑπÔ∏è Command-line programs to run using the OS shell.
     # üìö https://git.io/JvXDl
@@ -51,4 +58,4 @@ jobs:
     #   make release
 
     - name: Perform CodeQL Analysis
-      uses: github/codeql-action/analyze@v1
+      uses: github/codeql-action/analyze@v3
diff --git a/.gitignore b/.gitignore
index e4ac8a641..9ab7ed32d 100644
--- a/.gitignore
+++ b/.gitignore
@@ -1,3 +1,5 @@
+packages/*/package-lock.json
+
 # dependencies
 node_modules/
 
@@ -5,8 +7,19 @@ node_modules/
 /.idea
 /.awcache
 /.vscode
+/.devcontainer
+/.classpath
+/.project
+/.settings 
 *.code-workspace
 
+# Vim
+[._]*.s[a-v][a-z]
+[._]*.sw[a-p]
+[._]s[a-rt-v][a-z]
+[._]ss[a-gi-z]
+[._]sw[a-p]
+
 # bundle
 packages/**/*.d.ts
 packages/**/*.js
@@ -19,6 +32,7 @@ yarn-error.log
 /**/npm-debug.log
 /packages/**/.npmignore
 /packages/**/LICENSE
+*.tsbuildinfo
 
 # example
 /quick-start
@@ -33,3 +47,7 @@ yarn-error.log
 /packages/graphql
 /benchmarks/memory
 build/config\.gypi
+
+.npmrc
+pnpm-lock.yaml
+/.history
diff --git a/.husky/commit-msg b/.husky/commit-msg
index e8511eaea..fd2bf708e 100755
--- a/.husky/commit-msg
+++ b/.husky/commit-msg
@@ -1,4 +1 @@
-#!/bin/sh
-. "$(dirname "$0")/_/husky.sh"
-
 npx --no-install commitlint --edit $1
diff --git a/.husky/pre-commit b/.husky/pre-commit
index 36af21989..2312dc587 100755
--- a/.husky/pre-commit
+++ b/.husky/pre-commit
@@ -1,4 +1 @@
-#!/bin/sh
-. "$(dirname "$0")/_/husky.sh"
-
 npx lint-staged
diff --git a/.mocharc.js b/.mocharc.js
deleted file mode 100644
index b9cef9d6d..000000000
--- a/.mocharc.js
+++ /dev/null
@@ -1,7 +0,0 @@
-module.exports = {
-  mochaHooks: {
-    beforeAll: function() {
-      require('reflect-metadata');
-    }
-  }
-};
diff --git a/.npmignore b/.npmignore
index adb8e0dd6..d70d45ce9 100644
--- a/.npmignore
+++ b/.npmignore
@@ -10,4 +10,6 @@
 package-lock.json
 tslint.json
 tsconfig.json
-.prettierrc
\ No newline at end of file
+.prettierrc
+
+*.tsbuildinfo
\ No newline at end of file
diff --git a/.prettierignore b/.prettierignore
index 59fc75a6f..cb4f4fe93 100644
--- a/.prettierignore
+++ b/.prettierignore
@@ -1,2 +1,3 @@
 packages/**/*.d.ts
-packages/**/*.js
\ No newline at end of file
+packages/**/*.js
+.nyc_output
diff --git a/CONTRIBUTING.md b/CONTRIBUTING.md
index a00cda048..d13ca96d3 100755
--- a/CONTRIBUTING.md
+++ b/CONTRIBUTING.md
@@ -19,7 +19,7 @@ Help us keep Nest open and inclusive. Please read and follow our [Code of Conduc
 
 ## <a name="question"></a> Got a Question or Problem?
 
-**Do not open issues for general support questions as we want to keep GitHub issues for bug reports and feature requests.** You've got much better chances of getting your question answered on [Stack Overflow](https://stackoverflow.com/questions/tagged/nestjs) where the questions should be tagged with tag `nestjs`.
+**Do not open issues for general support questions as we want to keep GitHub issues for bug reports and feature requests.** You've got much better chances of getting your question answered on [Stack Overflow][stackoverflow] where the questions should be tagged with tag `nestjs`.
 
 Stack Overflow is a much better place to ask questions since:
 
@@ -71,7 +71,7 @@ A minimal reproduce scenario using a repository or Gist allows us to quickly con
 
 Unfortunately, we are not able to investigate / fix bugs without a minimal reproduction, so if we don't hear back from you we are going to close an issue that doesn't have enough info to be reproduced.
 
-You can file new issues by filling out our [new issue form](https://github.com/nestjs/nest/issues/new).
+You can file new issues by filling out our [new issue form][new_issue].
 
 ### <a name="submit-pr"></a> Submitting a Pull Request (PR)
 
@@ -84,9 +84,9 @@ To the first point
 We cannot accept code without this.
 -->
 
-1. Search [GitHub](https://github.com/nestjs/nest/pulls) for an open or closed PR
+1. Search [GitHub Pull Requests][gh_prs] for an open or closed PR
    that relates to your submission. You don't want to duplicate effort.
-1. Fork the nestjs/nest repo.
+1. Fork this repository.
 1. Make your changes in a new git branch:
 
    ```shell
@@ -159,12 +159,12 @@ from the main (upstream) repository:
 
 ## <a name="development"></a> Development Setup
 
-You will need Node.js version 8.9.0+.
+You will need [Node.js](https://nodejs.org) version >= 10.13.0 (except for v13).
 
 1. After cloning the repo, run:
 
 ```bash
-$ npm i # (or yarn install)
+$ npm ci --legacy-peer-deps # (or yarn install)
 ```
 
 2. In order to prepare your environment run `prepare.sh` shell script:
@@ -233,7 +233,7 @@ to read on GitHub as well as in various git tools.
 
 Footer should contain a [closing reference to an issue](https://help.github.com/articles/closing-issues-via-commit-messages/) if any.
 
-Samples: (even more [samples](https://github.com/nestjs/nest/commits/master))
+Samples: (even more [samples][commits_samples])
 
 ```
 docs(changelog): update change log to beta.5
@@ -262,16 +262,22 @@ Must be one of the following:
 
 ### Scope
 
-The scope should be the name of the npm package affected (as perceived by person reading changelog generated from commit messages.
+The scope should have the name of the npm package affected (as perceived by person reading changelog generated from commit messages).
 
 The following is the list of supported scopes:
 
-- **common**
-- **core**
-- **sample**
-- **microservices**
-- **testing**
-- **websockets**
+- **common**: for changes made on `packages/common` directory
+- **core**: for changes made on `packages/core` directory
+- **sample**: for changes made on `packages/sample` directory
+- **microservices**: for changes made on `packages/microservices` directory
+- **express**: for changes made on `packages/platform-express` directory
+- **fastify**: for changes made on `packages/platform-fastify` directory
+- **socket.io**: for changes made on `packages/platform-socket.io` directory
+- **ws**: for changes made on `packages/platform-ws` directory
+- **testing**: for changes made on `packages/testing` directory
+- **websockets**: for changes made on `packages/websockets` directory
+
+If your change affect more than one package, separate the scopes with a comma (e.g. `common,core`).
 
 There are currently a few exceptions to the "use package name" rule:
 
@@ -279,7 +285,6 @@ There are currently a few exceptions to the "use package name" rule:
 - **changelog**: used for updating the release notes in CHANGELOG.md
 - **sample/#**: for the example apps directory, replacing # with the example app number
 - none/empty string: useful for `style`, `test` and `refactor` changes that are done across all packages (e.g. `style: add missing semicolons`)
-  <!-- * **aio**: used for docs-app (angular.io) related changes within the /aio directory of the repo -->
 
 ### Subject
 
@@ -317,14 +322,13 @@ changes to be accepted, the CLA must be signed. It's a quick process, we promise
 <!-- [coc]: https://github.com/angular/code-of-conduct/blob/master/CODE_OF_CONDUCT.md -->
 
 [commit-message-format]: https://docs.google.com/document/d/1QrDFcIiPjSLDn3EL15IJygNPiHORgU1_OOAqWjiDU5Y/edit#
-[corporate-cla]: http://code.google.com/legal/corporate-cla-v1.0.html
+<!-- [individual-cla]: http://code.google.com/legal/individual-cla-v1.0.html -->
+<!-- [corporate-cla]: http://code.google.com/legal/corporate-cla-v1.0.html -->
 [dev-doc]: https://github.com/nestjs/nest/blob/master/docs/DEVELOPER.md
 [github]: https://github.com/nestjs/nest
+[stackoverflow]: https://stackoverflow.com/questions/tagged/nestjs
 [discord]: https://discordapp.com/invite/G7Qnnhy
-[individual-cla]: http://code.google.com/legal/individual-cla-v1.0.html
 [js-style-guide]: https://google.github.io/styleguide/jsguide.html
-[jsfiddle]: http://jsfiddle.net
-[plunker]: http://plnkr.co/edit
-[runnable]: http://runnable.com
-
-<!-- [stackoverflow]: http://stackoverflow.com/questions/tagged/angular -->
+[new_issue]: https://github.com/nestjs/nest/issues/new
+[gh_prs]: https://github.com/nestjs/nest/pulls
+[commits_samples]: https://github.com/nestjs/nest/commits/master
diff --git a/LICENSE b/LICENSE
index 8268fe7ff..449a3573e 100644
--- a/LICENSE
+++ b/LICENSE
@@ -1,6 +1,6 @@
 (The MIT License)
 
-Copyright (c) 2017-2022 Kamil Mysliwiec <https://kamilmysliwiec.com>
+Copyright (c) 2017-2024 Kamil Mysliwiec <https://kamilmysliwiec.com>
 
 Permission is hereby granted, free of charge, to any person obtaining
 a copy of this software and associated documentation files (the
diff --git a/Readme.md b/Readme.md
index 85a8c2535..4cac0d5ea 100644
--- a/Readme.md
+++ b/Readme.md
@@ -1,17 +1,16 @@
 <p align="center">
-  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
+  <a href="https://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
 </p>
 
 [circleci-image]: https://img.shields.io/circleci/build/github/nestjs/nest/master?token=abc123def456
 [circleci-url]: https://circleci.com/gh/nestjs/nest
 
-  <p align="center">A progressive <a href="http://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>
+  <p align="center">A progressive <a href="https://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>
     <p align="center">
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/v/@nestjs/core.svg" alt="NPM Version" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
 <a href="https://circleci.com/gh/nestjs/nest" target="_blank"><img src="https://img.shields.io/circleci/build/github/nestjs/nest/master" alt="CircleCI" /></a>
-<a href="https://coveralls.io/github/nestjs/nest?branch=master" target="_blank"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#9" alt="Coverage" /></a>
 <a href="https://discord.gg/G7Qnnhy" target="_blank"><img src="https://img.shields.io/badge/discord-online-brightgreen.svg" alt="Discord"/></a>
 <a href="https://opencollective.com/nest#backer" target="_blank"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
 <a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
@@ -24,21 +23,21 @@
 
 ## Description
 
-Nest is a framework for building efficient, scalable <a href="http://nodejs.org" target="_blank">Node.js</a> server-side applications. It uses modern JavaScript, is built with  <a href="http://www.typescriptlang.org" target="_blank">TypeScript</a> (preserves compatibility with pure JavaScript) and combines elements of OOP (Object Oriented Programming), FP (Functional Programming), and FRP (Functional Reactive Programming).
+Nest is a framework for building efficient, scalable <a href="https://nodejs.org" target="_blank">Node.js</a> server-side applications. It uses modern JavaScript, is built with <a href="https://www.typescriptlang.org" target="_blank">TypeScript</a> (preserves compatibility with pure JavaScript) and combines elements of OOP (Object Oriented Programming), FP (Functional Programming), and FRP (Functional Reactive Programming).
 
-<p>Under the hood, Nest makes use of <a href="https://expressjs.com/" target="_blank">Express</a>, but also, provides compatibility with a wide range of other libraries, like e.g. <a href="https://github.com/fastify/fastify" target="_blank">Fastify</a>, allowing for easy use of the myriad third-party plugins which are available.</p>
+<p>Under the hood, Nest makes use of <a href="https://expressjs.com/" target="_blank">Express</a>, but also provides compatibility with a wide range of other libraries, like <a href="https://github.com/fastify/fastify" target="_blank">Fastify</a>, allowing for easy use of the myriad of third-party plugins which are available.</p>
 
 ## Philosophy
 
-<p>In recent years, thanks to Node.js, JavaScript has become the ‚Äúlingua franca‚Äù of the web for both front and backend applications, giving rise to awesome projects like <a href="https://angular.io/" target="_blank">Angular</a>, <a href="https://github.com/facebook/react" target="_blank">React</a> and <a href="https://github.com/vuejs/vue" target="_blank">Vue</a> which improve developer productivity and enable the construction of fast, testable, extensible frontend applications. However, on the server-side, while there are a lot of superb libraries, helpers and tools for Node, none of them effectively solve the main problem - the architecture.</p>
-<p>Nest aims to provide an application architecture out of the box which allows for effortless creation of highly testable, scalable, loosely coupled and easily maintainable applications. The architecture is heavily inspired by Angular.</p>
+<p>In recent years, thanks to Node.js, JavaScript has become the ‚Äúlingua franca‚Äù of the web for both front and backend applications, giving rise to awesome projects like <a href="https://angular.io/" target="_blank">Angular</a>, <a href="https://github.com/facebook/react" target="_blank">React</a>, and <a href="https://github.com/vuejs/vue" target="_blank">Vue</a>, which improve developer productivity and enable the construction of fast, testable, and extensible frontend applications. However, on the server-side, while there are a lot of superb libraries, helpers, and tools for Node, none of them effectively solve the main problem - the architecture.</p>
+<p>Nest aims to provide an application architecture out of the box which allows for effortless creation of highly testable, scalable, and loosely coupled and easily maintainable applications. The architecture is heavily inspired by Angular.</p>
 
 ## Getting started
 
-* To check out the [guide](https://docs.nestjs.com), visit [docs.nestjs.com](https://docs.nestjs.com). :books:
-* Ë¶ÅÊü•Áúã‰∏≠Êñá [ÊåáÂçó](readme_zh.md), ËØ∑ËÆøÈóÆ [docs.nestjs.cn](https://docs.nestjs.cn). :books:
-* [Í∞ÄÏù¥Îìú](readme_kr.md)Î•º ÌôïÏù∏ÌïòÎ†§Î©¥, [docs.nestjs.com](https://docs.nestjs.com)Î•º Î∞©Î¨∏ÌïòÏÑ∏Ïöî.:books: 
-* „ÉÅ„Çß„ÉÉ„ÇØ„Åô„Çã„Å´„ÅØ [„Ç¨„Ç§„Éâ](readme_jp.md), Ë©≥„Åó„Åè„ÅØ [docs.nestjs.com](https://docs.nestjs.com). :books: 
+- To check out the [guide](https://docs.nestjs.com), visit [docs.nestjs.com](https://docs.nestjs.com). :books:
+- Ë¶ÅÊü•Áúã‰∏≠Êñá [ÊåáÂçó](readme_zh.md), ËØ∑ËÆøÈóÆ [docs.nestjs.cn](https://docs.nestjs.cn). :books:
+- [Í∞ÄÏù¥Îìú](readme_kr.md) Î¨∏ÏÑúÎäî [docs.nestjs.com](https://docs.nestjs.com)ÏóêÏÑú ÌôïÏù∏ÌïòÏã§ Ïàò ÏûàÏäµÎãàÎã§. :books:
+- [„Ç¨„Ç§„Éâ](readme_jp.md)„ÅØ [docs.nestjs.com](https://docs.nestjs.com)„Åß„ÅîÁ¢∫Ë™ç„Åè„Å†„Åï„ÅÑ„ÄÇ :books:
 
 ## Questions
 
@@ -54,71 +53,88 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
-<table style="text-align:center;"><tr>
-  <td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
-  <td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/red-hat-logo.svg" width="200" valign="middle" /></a></td>
-<td>
-<a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
-<td>
-<a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
-</tr></table>
+
+<table style="text-align:center;">
+<tr>
+<td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
+<td><a href="https://microsoft.com/" target="_blank"><img src="https://nestjs.com/img/logos/microsoft-logo.png" width="180" valign="middle" /></a></td>
+<td><a href="https://mojam.co" target="_blank"><img src="https://nestjs.com/img/logos/mojam-logo.png" width="80" valign="middle" /></a></td>
+<td><a href="https://marblism.com?utm_source=nest" target="_blank"><img src="https://nestjs.com/img/logos/marblism-logo.png" width="180" valign="middle" /></a></td>
+<td><a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
+<td><a href="https://amplication.com/" target="_blank"><img src="https://nestjs.com/img/logos/amplication-logo.svg" width="190" valign="middle" /></a></td>
+</tr>
+</table>
 
 #### Gold Sponsors
 
-<table style="text-align:center;"><tr><td>
-  <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
-  <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
-<td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
+<table style="text-align:center;">
+<tr>
+<td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/logos/red-hat-logo.svg" width="200" valign="middle" /></a></td>
+<td><a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
+<td><a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/logos/nx-logo.png" height="45" valign="middle" /></a></td>
+<td><a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/logos/intrinisic-logo.png" width="210" valign="middle" /></a></td>
+<td><a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/logos/jetbrains-logo.svg" width="90" valign="middle" /></a></td>
+</tr>
+<tr>
+<td><a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/logos/snyk-logo-black.png" width="185" valign="middle" /></a></td>
+<td><a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/logos/fuse-logo.svg" width="105" valign="middle" /></a></td>
+<td><a href="https://ridicorp.com/career/" target="_blank"><img src="https://nestjs.com/img/logos/ridi-logo.svg" width="105" valign="middle" /></a></td>
+<td><a href="https://www.movavi.com/imovie-for-windows.html" target="_blank"><img src="https://nestjs.com/img/logos/movavi-logo.svg" width="105" valign="middle" /></a></td>
+<td><a href="https://skunk.team" target="_blank"><img src="https://nestjs.com/img/logos/skunk-logo.png" height="60" valign="middle" /></a></td>
+</tr>
+</table>
 
 #### Silver Sponsors
 
-<table style="text-align:center;"><tr><td>
-<a href="https://neoteric.eu/" target="_blank"><img src="https://nestjs.com/img/neoteric-cut.png" width="120" valign="middle" /></a> </td><td>
-  <a href="http://gojob.com" target="_blank"><img src="http://nestjs.com/img/gojob-logo.png" valign="middle" width="100" /></a> </td><td>
-<a href="https://www.myleodsc.com/" target="_blank"><img src="https://nestjs.com/img/myleo-logo.png" width="180" valign="middle" /></td><td>
-<a href="https://careers.meetdandy.com/?gh_src=063ba61e3us" target="_blank"><img src="https://nestjs.com/img/dandy-roles-logo.svg" width="150" valign="middle" /></td><td>
-<a href="https://www.castlecraft.in" target="_blank"><img src="https://nestjs.com/img/castlecraft-logo.png" width="150" valign="middle" /></td>
-<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td></tr></table>
+<table style="text-align:center;">
+<tr>
+<td><a href="https://www.mercedes-benz.com/" target="_blank"><img src="https://nestjs.com/img/logos/mercedes-logo.png" width="100" valign="middle" /></a></td>
+<td><a href="https://www.dinii.jp/" target="_blank"><img src="https://nestjs.com/img/logos/dinii-logo.png" width="65" valign="middle" /></a></td>
+<td><a href="https://bloodycase.com/?promocode=NEST" target="_blank"><img src="https://nestjs.com/img/logos/bloodycase-logo.png" width="65" valign="middle" /></a></td>
+<td><a href="https://handsontable.com/docs/react-data-grid/?utm_source=NestJS_GH&utm_medium=sponsorship&utm_campaign=library_sponsorship_2024" target="_blank"><img src="https://nestjs.com/img/logos/handsontable-dark-logo.svg#2" width="150" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.itflashcards.com/" target="_blank"><img src="https://nestjs.com/img/logos/it_flashcards-logo.png" width="170" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://arcjet.com/?ref=nestjs" target="_blank"><img src="https://nestjs.com/img/logos/arcjet-logo.svg" width="170" valign="middle" /></a></td>
+</tr>
+</table>
 
 #### Sponsors
 
-<table><tr><td align="center" valign="middle">
-<a href="https://www.swingdev.io" target="_blank"><img src="https://nestjs.com/img/swingdev-logo.svg#1" width="110" valign="middle" /> </a></td><td align="center" valign="middle">
-<a href="https://www.novologic.com/" target="_blank"><img src="https://nestjs.com/img/novologic.png" width="110" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://ever.co/" target="_blank"><img src="https://nestjs.com/img/ever-logo.png" width="72" valign="middle" /></a>  </td><td align="center" valign="middle">
-<a href="https://blokt.com" target="_blank"><img src="https://nestjs.com/img/blokt-logo.png" width="120" valign="middle" /></a>  </td><td align="center" valign="middle"> 
-  <a href="http://architectnow.net/" target="_blank"><img src="https://nestjs.com/img/architectnow.png" width="125" valign="middle" /></a> </td><td align="center" valign="middle">
-  <a href="https://quander.io/" target="_blank"><img src="https://nestjs.com/img/quander.png" width="100" valign="middle" /></a> </td></tr><tr><td align="center" valign="middle">
-  <a href="https://mantro.net/" target="_blank"><img src="https://nestjs.com/img/mantro-logo.svg" width="95" valign="middle" /></a> </td><td align="center" valign="middle">
-  <a href="https://triplebyte.com/" target="_blank"><img src="https://nestjs.com/img/triplebyte.png" width="107" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://reposit.co.uk/" target="_blank"><img src="https://nestjs.com/img/reposit-logo.png" width="71" valign="middle" /></a></td><td align="center" valign="middle">
-<a href="https://nearpod.com/" target="_blank"><img src="https://nestjs.com/img/nearpod-logo.svg" width="100" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://clay.global/" target="_blank"><img src="https://nestjs.com/img/clay-logo.svg" width="75" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://firesticktricks.com" target="_blank"><img src="https://nestjs.com/img/firesticktricks-logo.png" width="120" valign="middle" /></a></td></tr><tr><td align="center" valign="middle">
-<a href="https://www.codeguesser.co.uk" target="_blank"><img src="https://nestjs.com/img/codeguesser-logo.svg" width="120" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://f-a.nz/" target="_blank"><img src="https://nestjs.com/img/franz.svg" width="80" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://sparkfabrik.com/" target="_blank"><img src="https://nestjs.com/img/sparkfabrik-logo.png" width="120" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://www.thebigphonestore.co.uk/" target="_blank"><img src="https://nestjs.com/img/the-big-phone-store-logo.png" width="65" valign="middle" /></a></td>
-  <td align="center" valign="middle">
-  <a href="https://genuinebee.com/" target="_blank"><img src="https://nestjs.com/img/genuinebee.svg" width="97" valign="middle" /></a> </td>
-<td align="center" valign="middle"><a href="https://sanyodigital.com/" target="_blank"><img src="https://nestjs.com/img/sanyo-digital.png" width="130" valign="middle" /></a></td></tr><tr><td align="center" valign="middle"><a href="https://vpn-review.com/vpn-for-torrenting" target="_blank"><img src="https://nestjs.com/img/vpn-review-logo.png" width="85" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://lambda-it.ch/" target="_blank"><img src="https://nestjs.com/img/lambda-it-logo.svg" width="115" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://pickwriters.com/top-10-translation-services" target="_blank"><img src="https://nestjs.com/img/pickwriters-logo.png" width="40" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://thewordpoint.com/services/localization" target="_blank"><img src="https://nestjs.com/img/thewordpoint-logo.png" width="40" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://meercode.io/" target="_blank"><img src="https://nestjs.com/img/meercode-logo.png" width="60" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://www.najlepszeplatformyforex.pl/blog/broker-xtb/" target="_blank"><img src="https://nestjs.com/img/npf-logo.jpg" width="200" valign="middle" /></a></td></tr><tr>
-<td align="center" valign="middle"><a href="https://thestandarddaily.com/" target="_blank"><img src="https://nestjs.com/img/the-standard-daily-logo.png" width="180" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://houseofangular.io/" target="_blank"><img src="https://nestjs.com/img/house-of-angular.png" width="100" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://rocketech.it/cases/?utm_source=google&utm_medium=badge&utm_campaign=nestjs" target="_blank"><img src="https://nestjs.com/img/rocketech-logo.svg" width="110" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://www.bystored.com/" target="_blank"><img src="https://nestjs.com/img/stored-logo.svg" width="110" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://studyclerk.com/pay-for-research-paper" target="_blank"><img src="https://nestjs.com/img/studyclerk-logo.png" width="125" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://xyndata.com" target="_blank"><img src="https://nestjs.com/img/xyndata-logo.png" width="125" valign="middle" /></a></td></tr><tr>
-  <td align="center" valign="middle"><a href="https://www.anonymistic.com/" target="_blank"><img src="https://nestjs.com/img/anonymistic-logo.png" width="125" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/naologic-logo.svg" width="125" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://messaged.com/" target="_blank"><img src="https://nestjs.com/img/messaged-logo.png" width="50" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/triplecore-logo.svg" width="50" valign="middle" /></a></td>
-  </tr></table>
+<table>
+<tr>
+<td align="center" valign="middle"><a href="https://www.swingdev.io" target="_blank"><img src="https://nestjs.com/img/logos/swingdev-logo.svg#1" width="110" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.novologic.com/" target="_blank"><img src="https://nestjs.com/img/logos/novologic.png" width="110" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://mantro.net/" target="_blank"><img src="https://nestjs.com/img/logos/mantro-logo.svg" width="95" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://triplebyte.com/" target="_blank"><img src="https://nestjs.com/img/logos/triplebyte.png" width="107" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://nearpod.com/" target="_blank"><img src="https://nestjs.com/img/logos/nearpod-logo.svg" width="100" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://genuinebee.com/" target="_blank"><img src="https://nestjs.com/img/logos/genuinebee.svg" width="97" valign="middle" /></a></td>
+</tr>
+<tr>
+<td align="center" valign="middle"><a href="https://vpn-review.com/vpn-for-torrenting" target="_blank"><img src="https://nestjs.com/img/logos/vpn-review-logo.png" width="85" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://lambda-it.ch/" target="_blank"><img src="https://nestjs.com/img/logos/lambda-it-logo.svg" width="115" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://rocketech.it/cases/?utm_source=google&utm_medium=badge&utm_campaign=nestjs" target="_blank"><img src="https://nestjs.com/img/logos/rocketech-logo.svg" width="110" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.anonymistic.com/" target="_blank"><img src="https://nestjs.com/img/logos/anonymistic-logo.png" width="125" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/logos/naologic-logo.svg" width="125" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/logos/triplecore-logo.svg" width="50" valign="middle" /></a></td>
+</tr>
+<tr>
+<td align="center" valign="middle"><a href="https://thecasinowizard.com/bonuses/no-deposit-bonuses/" target="_blank"><img src="https://nestjs.com/img/logos/casinowizard-logo.png" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://polygon-software.ch/" target="_blank"><img src="https://nestjs.com/img/logos/polygon-logo.svg" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/logos/boringowl-logo.svg" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://nordbot.app/" target="_blank"><img src="https://nestjs.com/img/logos/nordbot-logo.png" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://doppio.sh/" target="_blank"><img src="https://nestjs.com/img/logos/dopiosh-logo.png" width="50" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.hingehealth.com/" target="_blank"><img src="https://nestjs.com/img/logos/hinge-health-logo.svg" width="100" valign="middle" /></a></td>
+</tr>
+<tr>
+<td align="center" valign="middle"><a href="https://julienferand.dev/" target="_blank"><img src="https://nestjs.com/img/logos/julienferand-logo.jpeg" width="55" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.tripoffice.com/" target="_blank"><img src="https://nestjs.com/img/logos/tripoffice-logo.png" width="140" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://solcellsforetag.se/" target="_blank"><img src="https://nestjs.com/img/logos/solcellsforetag-logo.svg" width="140" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.route4me.com/" target="_blank"><img src="https://nestjs.com/img/logos/route4me-logo.svg" width="100" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.slotsup.com/" target="_blank"><img src="https://nestjs.com/img/logos/slotsup-logo.png" width="60" valign="middle" /></a></td>
+</tr>
+</table>
 
 ## Backers
 
@@ -126,9 +142,9 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 
 ## Stay in touch
 
-* Author - [Kamil My≈õliwiec](https://twitter.com/kammysliwiec)
-* Website - [https://nestjs.com](https://nestjs.com/)
-* Twitter - [@nestframework](https://twitter.com/nestframework)
+- Author - [Kamil My≈õliwiec](https://x.com/kammysliwiec)
+- Website - [https://nestjs.com](https://nestjs.com/)
+- X - [@nestframework](https://x.com/nestframework)
 
 ## License
 
diff --git a/benchmarks/fastify.js b/benchmarks/fastify.js
index baf5e7ab8..eb70ea0ba 100644
--- a/benchmarks/fastify.js
+++ b/benchmarks/fastify.js
@@ -2,4 +2,6 @@
 
 const fastify = require('fastify')();
 fastify.get('/', async (req, reply) => reply.send('Hello world'));
-fastify.listen(3000);
+fastify.listen({
+  port: 3000
+});
diff --git a/eslint.config.mjs b/eslint.config.mjs
new file mode 100644
index 000000000..b651263d2
--- /dev/null
+++ b/eslint.config.mjs
@@ -0,0 +1,55 @@
+// @ts-check
+import eslint from '@eslint/js';
+import eslintPluginPrettierRecommended from 'eslint-plugin-prettier/recommended';
+import globals from 'globals';
+import tseslint from 'typescript-eslint';
+
+export default tseslint.config(
+  {
+    ignores: ['node_modules', '**/node_modules/**', '**/*.js', '**/*.d.ts'],
+  },
+  eslint.configs.recommended,
+  ...tseslint.configs.recommendedTypeChecked,
+  eslintPluginPrettierRecommended,
+  {
+    languageOptions: {
+      globals: {
+        ...globals.node,
+        ...globals.jest,
+      },
+      ecmaVersion: 5,
+      sourceType: 'module',
+      parserOptions: {
+        project: ['tsconfig.json', 'tsconfig.spec.json'],
+        projectService: true,
+        tsconfigRootDir: import.meta.dirname,
+      },
+    },
+  },
+  {
+    rules: {
+      '@typescript-eslint/no-explicit-any': 'off',
+      '@typescript-eslint/no-unsafe-assignment': 'off',
+      '@typescript-eslint/no-unsafe-call': 'off',
+      '@typescript-eslint/no-unsafe-member-access': 'off',
+      '@typescript-eslint/no-unsafe-function-type': 'off',
+      '@typescript-eslint/no-unsafe-argument': 'off',
+      '@typescript-eslint/no-unsafe-return': 'off',
+      '@typescript-eslint/no-unused-expressions': 'off',
+      '@typescript-eslint/no-require-imports': 'off',
+      '@typescript-eslint/no-unused-vars': 'off',
+      "@typescript-eslint/no-misused-promises": [
+        "error",
+        {
+          "checksVoidReturn": false,
+          "checksConditionals": false
+        }
+      ],
+      "@typescript-eslint/require-await": "off",
+      '@typescript-eslint/prefer-promise-reject-errors': 'off',
+      '@typescript-eslint/no-base-to-string': 'off',
+      '@typescript-eslint/unbound-method': 'off',
+      '@typescript-eslint/only-throw-error': 'off',
+    },
+  },
+);
\ No newline at end of file
diff --git a/hooks/mocha-init-hook.ts b/hooks/mocha-init-hook.ts
new file mode 100644
index 000000000..82b14a111
--- /dev/null
+++ b/hooks/mocha-init-hook.ts
@@ -0,0 +1,7 @@
+export const mochaHooks = (): Mocha.RootHookObject => {
+  return {
+    async beforeAll(this: Mocha.Context) {
+      await import('reflect-metadata');
+    },
+  };
+};
diff --git a/integration/auto-mock/src/bar.service.ts b/integration/auto-mock/src/bar.service.ts
index d4224329a..5b75933f9 100644
--- a/integration/auto-mock/src/bar.service.ts
+++ b/integration/auto-mock/src/bar.service.ts
@@ -3,10 +3,9 @@ import { FooService } from './foo.service';
 
 @Injectable()
 export class BarService {
-
   constructor(private readonly foo: FooService) {}
 
   bar() {
     this.foo.foo();
   }
-}
\ No newline at end of file
+}
diff --git a/integration/auto-mock/test/bar.service.spec.ts b/integration/auto-mock/test/bar.service.spec.ts
index 754306ff3..c004bbf67 100644
--- a/integration/auto-mock/test/bar.service.spec.ts
+++ b/integration/auto-mock/test/bar.service.spec.ts
@@ -4,6 +4,7 @@ import * as chaiAsPromised from 'chai-as-promised';
 import * as sinon from 'sinon';
 import { BarService } from '../src/bar.service';
 import { FooService } from '../src/foo.service';
+
 chai.use(chaiAsPromised);
 const { expect } = chai;
 
@@ -36,7 +37,7 @@ describe('Auto-Mocking with token in factory', () => {
     const moduleRef = await Test.createTestingModule({
       providers: [BarService],
     })
-      .useMocker((token) => {
+      .useMocker(token => {
         if (token === FooService) {
           return { foo: sinon.stub };
         }
@@ -48,16 +49,13 @@ describe('Auto-Mocking with token in factory', () => {
     expect(fooServ.foo.called);
   });
   it('cannot mock the dependencies', async () => {
-
     const moduleRef = Test.createTestingModule({
       providers: [BarService],
-    })
-      .useMocker((token) => {
-        if (token === FooService.name + 'something that fails the token') {
-          return { foo: sinon.stub };
-        }
-      })
-      .compile;
-    expect(moduleRef()).to.eventually.throw()
+    }).useMocker(token => {
+      if (token === FooService.name + 'something that fails the token') {
+        return { foo: sinon.stub };
+      }
+    }).compile;
+    expect(moduleRef()).to.eventually.throw();
   });
 });
diff --git a/integration/auto-mock/tsconfig.json b/integration/auto-mock/tsconfig.json
index c6354c564..2d3b89de2 100644
--- a/integration/auto-mock/tsconfig.json
+++ b/integration/auto-mock/tsconfig.json
@@ -7,14 +7,34 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "strictNullChecks": true,
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
-    "e2e/**/*"
+    "e2e/**/*",
+    "test/**/*"
   ],
   "exclude": [
     "node_modules",
diff --git a/integration/cache/e2e/multi-store.spec.ts b/integration/cache/e2e/multi-store.spec.ts
deleted file mode 100644
index bae2dea08..000000000
--- a/integration/cache/e2e/multi-store.spec.ts
+++ /dev/null
@@ -1,31 +0,0 @@
-import { INestApplication } from '@nestjs/common';
-import { Test } from '@nestjs/testing';
-import * as request from 'supertest';
-import { MultiStoreModule } from '../src/multi-store/multi-store.module';
-
-describe('Caching Multi Store', () => {
-  let server;
-  let app: INestApplication;
-
-  before(async () => {
-    const module = await Test.createTestingModule({
-      imports: [MultiStoreModule],
-    }).compile();
-
-    app = module.createNestApplication();
-    server = app.getHttpServer();
-    await app.init();
-  });
-
-  it(`should return empty`, async () => {
-    return request(server).get('/').expect(200, '');
-  });
-
-  it(`should return data`, async () => {
-    return request(server).get('/').expect(200, 'multi-store-value');
-  });
-
-  after(async () => {
-    await app.close();
-  });
-});
diff --git a/integration/cache/src/multi-store/multi-store.controller.ts b/integration/cache/src/multi-store/multi-store.controller.ts
deleted file mode 100644
index ce4a446a8..000000000
--- a/integration/cache/src/multi-store/multi-store.controller.ts
+++ /dev/null
@@ -1,16 +0,0 @@
-import { Controller, Get, Inject, CACHE_MANAGER } from '@nestjs/common';
-import { Cache } from 'cache-manager';
-
-@Controller()
-export class MultiStoreController {
-  constructor(@Inject(CACHE_MANAGER) private cacheManager: Cache) {}
-
-  @Get()
-  async getFromMultiStore(): Promise<unknown> {
-    const value = await this.cacheManager.get('multi-store-key');
-    if (!value) {
-      await this.cacheManager.set('multi-store-key', 'multi-store-value');
-    }
-    return value;
-  }
-}
diff --git a/integration/cache/src/multi-store/multi-store.module.ts b/integration/cache/src/multi-store/multi-store.module.ts
deleted file mode 100644
index 8ebc34e5b..000000000
--- a/integration/cache/src/multi-store/multi-store.module.ts
+++ /dev/null
@@ -1,24 +0,0 @@
-import { CacheModule, Module } from '@nestjs/common';
-import * as redisStore from 'cache-manager-redis-store';
-import { MultiStoreController } from './multi-store.controller';
-
-@Module({
-  imports: [
-    CacheModule.register([
-      {
-        store: 'memory',
-        max: 100,
-        ttl: 10,
-      },
-      {
-        store: redisStore,
-        host: 'localhost',
-        port: 6379,
-        db: 0,
-        ttl: 600,
-      },
-    ]),
-  ],
-  controllers: [MultiStoreController],
-})
-export class MultiStoreModule {}
diff --git a/integration/cors/e2e/express.spec.ts b/integration/cors/e2e/express.spec.ts
index c13abf4d9..8e268c316 100644
--- a/integration/cors/e2e/express.spec.ts
+++ b/integration/cors/e2e/express.spec.ts
@@ -1,10 +1,10 @@
-import { NestFastifyApplication } from '@nestjs/platform-fastify';
+import { NestExpressApplication } from '@nestjs/platform-express';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
 import { AppModule } from '../src/app.module';
 
 describe('Express Cors', () => {
-  let app: NestFastifyApplication;
+  let app: NestExpressApplication;
   const configs = [
     {
       origin: 'example.com',
@@ -30,7 +30,7 @@ describe('Express Cors', () => {
           imports: [AppModule],
         }).compile();
 
-        app = module.createNestApplication<NestFastifyApplication>();
+        app = module.createNestApplication<NestExpressApplication>();
 
         let requestId = 0;
         const configDelegation = function (req, cb) {
@@ -84,7 +84,7 @@ describe('Express Cors', () => {
           cb(null, config);
         };
 
-        app = module.createNestApplication<NestFastifyApplication>(null, {
+        app = module.createNestApplication<NestExpressApplication>({
           cors: configDelegation,
         });
 
@@ -126,7 +126,7 @@ describe('Express Cors', () => {
           imports: [AppModule],
         }).compile();
 
-        app = module.createNestApplication<NestFastifyApplication>();
+        app = module.createNestApplication<NestExpressApplication>();
         app.enableCors(configs[0]);
 
         await app.init();
@@ -153,7 +153,7 @@ describe('Express Cors', () => {
           imports: [AppModule],
         }).compile();
 
-        app = module.createNestApplication<NestFastifyApplication>(null, {
+        app = module.createNestApplication<NestExpressApplication>({
           cors: configs[0],
         });
         await app.init();
diff --git a/integration/cors/e2e/fastify.spec.ts b/integration/cors/e2e/fastify.spec.ts
index b98d12328..df8caba43 100644
--- a/integration/cors/e2e/fastify.spec.ts
+++ b/integration/cors/e2e/fastify.spec.ts
@@ -1,9 +1,12 @@
-import { NestFastifyApplication } from '@nestjs/platform-fastify';
+import {
+  FastifyAdapter,
+  NestFastifyApplication,
+} from '@nestjs/platform-fastify';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
 import { AppModule } from '../src/app.module';
 
-describe('Fastify Cors', () => {
+describe.skip('Fastify Cors', () => {
   let app: NestFastifyApplication;
   const configs = [
     {
@@ -30,7 +33,9 @@ describe('Fastify Cors', () => {
           imports: [AppModule],
         }).compile();
 
-        app = module.createNestApplication<NestFastifyApplication>();
+        app = module.createNestApplication<NestFastifyApplication>(
+          new FastifyAdapter(),
+        );
 
         let requestId = 0;
         const configDelegation = function (req, cb) {
@@ -84,9 +89,12 @@ describe('Fastify Cors', () => {
           cb(null, config);
         };
 
-        app = module.createNestApplication<NestFastifyApplication>(null, {
-          cors: configDelegation,
-        });
+        app = module.createNestApplication<NestFastifyApplication>(
+          new FastifyAdapter(),
+          {
+            cors: configDelegation,
+          },
+        );
 
         await app.init();
       });
@@ -127,7 +135,9 @@ describe('Fastify Cors', () => {
           imports: [AppModule],
         }).compile();
 
-        app = module.createNestApplication<NestFastifyApplication>();
+        app = module.createNestApplication<NestFastifyApplication>(
+          new FastifyAdapter(),
+        );
         app.enableCors(configs[0]);
 
         await app.init();
@@ -147,16 +157,19 @@ describe('Fastify Cors', () => {
     after(async () => {
       await app.close();
     });
-    
+
     describe('Application Options', () => {
       before(async () => {
         const module = await Test.createTestingModule({
           imports: [AppModule],
         }).compile();
 
-        app = module.createNestApplication<NestFastifyApplication>(null, {
-          cors: configs[0],
-        });
+        app = module.createNestApplication<NestFastifyApplication>(
+          new FastifyAdapter(),
+          {
+            cors: configs[0],
+          },
+        );
         await app.init();
       });
 
diff --git a/integration/cors/tsconfig.json b/integration/cors/tsconfig.json
index c6354c564..4a0f01e0e 100644
--- a/integration/cors/tsconfig.json
+++ b/integration/cors/tsconfig.json
@@ -7,10 +7,29 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "strictNullChecks": true,
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
diff --git a/integration/discovery/e2e/discover-by-meta.spec.ts b/integration/discovery/e2e/discover-by-meta.spec.ts
new file mode 100644
index 000000000..679c77584
--- /dev/null
+++ b/integration/discovery/e2e/discover-by-meta.spec.ts
@@ -0,0 +1,59 @@
+import { Test, TestingModule } from '@nestjs/testing';
+import { DiscoveryService } from '@nestjs/core';
+import { expect } from 'chai';
+import { AppModule } from '../src/app.module';
+import { WebhooksExplorer } from '../src/webhooks.explorer';
+import { NonAppliedDecorator } from '../src/decorators/non-applied.decorator';
+
+describe('DiscoveryModule', () => {
+  let moduleRef: TestingModule;
+
+  beforeEach(async () => {
+    moduleRef = await Test.createTestingModule({
+      imports: [AppModule],
+    }).compile();
+  });
+
+  it('should discover all providers & handlers with corresponding annotations', async () => {
+    const webhooksExplorer = moduleRef.get(WebhooksExplorer);
+
+    expect(webhooksExplorer.getWebhooks()).to.be.eql([
+      {
+        handlers: [
+          {
+            event: 'start',
+            methodName: 'onStart',
+          },
+        ],
+        name: 'cleanup',
+      },
+      {
+        handlers: [
+          {
+            event: 'start',
+            methodName: 'onStart',
+          },
+        ],
+        name: 'flush',
+      },
+    ]);
+  });
+
+  it('should return an empty array if no providers were found for a given discoverable decorator', () => {
+    const discoveryService = moduleRef.get(DiscoveryService);
+
+    const providers = discoveryService.getProviders({
+      metadataKey: NonAppliedDecorator.KEY,
+    });
+    expect(providers).to.be.eql([]);
+  });
+
+  it('should return an empty array if no controllers were found for a given discoverable decorator', () => {
+    const discoveryService = moduleRef.get(DiscoveryService);
+
+    const controllers = discoveryService.getControllers({
+      metadataKey: NonAppliedDecorator.KEY,
+    });
+    expect(controllers).to.be.eql([]);
+  });
+});
diff --git a/integration/discovery/src/app.module.ts b/integration/discovery/src/app.module.ts
new file mode 100644
index 000000000..c0d93e30c
--- /dev/null
+++ b/integration/discovery/src/app.module.ts
@@ -0,0 +1,10 @@
+import { Module } from '@nestjs/common';
+import { DiscoveryModule } from '@nestjs/core';
+import { MyWebhookModule } from './my-webhook/my-webhook.module';
+import { WebhooksExplorer } from './webhooks.explorer';
+
+@Module({
+  imports: [MyWebhookModule, DiscoveryModule],
+  providers: [WebhooksExplorer],
+})
+export class AppModule {}
diff --git a/integration/discovery/src/decorators/non-applied.decorator.ts b/integration/discovery/src/decorators/non-applied.decorator.ts
new file mode 100644
index 000000000..e20a5f932
--- /dev/null
+++ b/integration/discovery/src/decorators/non-applied.decorator.ts
@@ -0,0 +1,9 @@
+import { DiscoveryService } from '@nestjs/core';
+
+/**
+ * This decorator must not be used anywhere!
+ *
+ * This will be used to test the scenario where we are trying to retrieving
+ * metadata for a discoverable decorator that was not applied to any class.
+ */
+export const NonAppliedDecorator = DiscoveryService.createDecorator();
diff --git a/integration/discovery/src/decorators/webhook.decorators.ts b/integration/discovery/src/decorators/webhook.decorators.ts
new file mode 100644
index 000000000..5482ede95
--- /dev/null
+++ b/integration/discovery/src/decorators/webhook.decorators.ts
@@ -0,0 +1,6 @@
+import { DiscoveryService } from '@nestjs/core';
+
+export const Webhook = DiscoveryService.createDecorator<{ name: string }>();
+export const WebhookHandler = DiscoveryService.createDecorator<{
+  event: string;
+}>();
diff --git a/integration/discovery/src/my-webhook/cleanup.webhook.ts b/integration/discovery/src/my-webhook/cleanup.webhook.ts
new file mode 100644
index 000000000..11364d87c
--- /dev/null
+++ b/integration/discovery/src/my-webhook/cleanup.webhook.ts
@@ -0,0 +1,9 @@
+import { Webhook, WebhookHandler } from '../decorators/webhook.decorators';
+
+@Webhook({ name: 'cleanup' })
+export class CleanupWebhook {
+  @WebhookHandler({ event: 'start' })
+  onStart() {
+    console.log('cleanup started');
+  }
+}
diff --git a/integration/discovery/src/my-webhook/flush.webhook.ts b/integration/discovery/src/my-webhook/flush.webhook.ts
new file mode 100644
index 000000000..e1db93087
--- /dev/null
+++ b/integration/discovery/src/my-webhook/flush.webhook.ts
@@ -0,0 +1,9 @@
+import { Webhook, WebhookHandler } from '../decorators/webhook.decorators';
+
+@Webhook({ name: 'flush' })
+export class FlushWebhook {
+  @WebhookHandler({ event: 'start' })
+  onStart() {
+    console.log('flush started');
+  }
+}
diff --git a/integration/discovery/src/my-webhook/my-webhook.module.ts b/integration/discovery/src/my-webhook/my-webhook.module.ts
new file mode 100644
index 000000000..d868b95d9
--- /dev/null
+++ b/integration/discovery/src/my-webhook/my-webhook.module.ts
@@ -0,0 +1,6 @@
+import { Module } from '@nestjs/common';
+import { CleanupWebhook } from './cleanup.webhook';
+import { FlushWebhook } from './flush.webhook';
+
+@Module({ providers: [CleanupWebhook, FlushWebhook] })
+export class MyWebhookModule {}
diff --git a/integration/discovery/src/webhooks.explorer.ts b/integration/discovery/src/webhooks.explorer.ts
new file mode 100644
index 000000000..d449950a5
--- /dev/null
+++ b/integration/discovery/src/webhooks.explorer.ts
@@ -0,0 +1,39 @@
+import { Injectable } from '@nestjs/common';
+import { DiscoveryService, MetadataScanner } from '@nestjs/core';
+import { Webhook, WebhookHandler } from './decorators/webhook.decorators';
+
+@Injectable()
+export class WebhooksExplorer {
+  constructor(
+    private readonly discoveryService: DiscoveryService,
+    private readonly metadataScanner: MetadataScanner,
+  ) {}
+
+  getWebhooks() {
+    const webhooks = this.discoveryService.getProviders({
+      metadataKey: Webhook.KEY,
+    });
+    return webhooks.map(wrapper => {
+      const { name } = this.discoveryService.getMetadataByDecorator(
+        Webhook,
+        wrapper,
+      )!;
+      return {
+        name,
+        handlers: this.metadataScanner
+          .getAllMethodNames(wrapper.metatype!.prototype)
+          .map(methodName => {
+            const { event } = this.discoveryService.getMetadataByDecorator(
+              WebhookHandler,
+              wrapper,
+              methodName,
+            )!;
+            return {
+              methodName,
+              event,
+            };
+          }),
+      };
+    });
+  }
+}
diff --git a/integration/discovery/tsconfig.json b/integration/discovery/tsconfig.json
new file mode 100644
index 000000000..4a0f01e0e
--- /dev/null
+++ b/integration/discovery/tsconfig.json
@@ -0,0 +1,41 @@
+{
+  "compilerOptions": {
+    "module": "commonjs",
+    "declaration": false,
+    "noImplicitAny": false,
+    "removeComments": true,
+    "noLib": false,
+    "emitDecoratorMetadata": true,
+    "experimentalDecorators": true,
+    "target": "ES2021",
+    "sourceMap": true,
+    "allowJs": true,
+    "strictNullChecks": true,
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
+  },
+  "include": [
+    "src/**/*",
+    "e2e/**/*"
+  ],
+  "exclude": [
+    "node_modules",
+  ]
+}
\ No newline at end of file
diff --git a/integration/docker-compose.yml b/integration/docker-compose.yml
index 148c32151..1b2687a07 100644
--- a/integration/docker-compose.yml
+++ b/integration/docker-compose.yml
@@ -17,14 +17,17 @@ services:
     restart: always
   mqtt:
     container_name: test-mqtt
-    image: toke/mosquitto
+    image: eclipse-mosquitto
+    volumes:
+      - ./mosquitto.conf:/mosquitto/config/mosquitto.conf
     ports:
       - "1883:1883"
       - "9001:9001"
     restart: always
   mysql:
-    image: mysql:8.0.27
+    image: mysql:8.4.3
     environment:
+      MYSQL_ROOT_HOST: '%'
       MYSQL_ROOT_PASSWORD: root
       MYSQL_DATABASE: test
     ports:
@@ -48,7 +51,7 @@ services:
   zookeeper:
     container_name: test-zookeeper
     hostname: zookeeper
-    image: confluentinc/cp-zookeeper:7.0.1
+    image: confluentinc/cp-zookeeper:7.7.1
     ports:
       - "2181:2181"
     environment:
@@ -57,7 +60,7 @@ services:
   kafka:
     container_name: test-kafka
     hostname: kafka
-    image: confluentinc/cp-kafka:7.0.1
+    image: confluentinc/cp-kafka:7.7.1
     depends_on:
       - zookeeper
     ports:
diff --git a/integration/graphql-code-first/e2e/code-first.spec.ts b/integration/graphql-code-first/e2e/code-first.spec.ts
index 3a2cb97b3..258edd8a9 100644
--- a/integration/graphql-code-first/e2e/code-first.spec.ts
+++ b/integration/graphql-code-first/e2e/code-first.spec.ts
@@ -1,14 +1,14 @@
 import { INestApplication } from '@nestjs/common';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 describe('GraphQL - Code-first', () => {
   let app: INestApplication;
 
   beforeEach(async () => {
     const module = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
 
     app = module.createNestApplication();
diff --git a/integration/graphql-code-first/e2e/guards-filters.spec.ts b/integration/graphql-code-first/e2e/guards-filters.spec.ts
index 6e3307b5b..4953d771c 100644
--- a/integration/graphql-code-first/e2e/guards-filters.spec.ts
+++ b/integration/graphql-code-first/e2e/guards-filters.spec.ts
@@ -1,14 +1,14 @@
 import { INestApplication } from '@nestjs/common';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 describe('GraphQL - Guards', () => {
   let app: INestApplication;
 
   beforeEach(async () => {
     const module = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
 
     app = module.createNestApplication();
diff --git a/integration/graphql-code-first/e2e/pipes.spec.ts b/integration/graphql-code-first/e2e/pipes.spec.ts
index bdd928fd9..e14e31df1 100644
--- a/integration/graphql-code-first/e2e/pipes.spec.ts
+++ b/integration/graphql-code-first/e2e/pipes.spec.ts
@@ -1,14 +1,14 @@
 import { INestApplication, ValidationPipe } from '@nestjs/common';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 describe('GraphQL Pipes', () => {
   let app: INestApplication;
 
   beforeEach(async () => {
     const module = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
 
     app = module.createNestApplication();
@@ -30,8 +30,8 @@ describe('GraphQL Pipes', () => {
         errors: [
           {
             extensions: {
-              code: 'BAD_USER_INPUT',
-              response: {
+              code: 'BAD_REQUEST',
+              originalError: {
                 error: 'Bad Request',
                 message: [
                   'description must be longer than or equal to 30 characters',
@@ -39,7 +39,14 @@ describe('GraphQL Pipes', () => {
                 statusCode: 400,
               },
             },
+            locations: [
+              {
+                column: 3,
+                line: 2,
+              },
+            ],
             message: 'Bad Request Exception',
+            path: ['addRecipe'],
           },
         ],
       });
diff --git a/integration/graphql-code-first/schema.gql b/integration/graphql-code-first/schema.gql
index 59f110694..c196e332d 100644
--- a/integration/graphql-code-first/schema.gql
+++ b/integration/graphql-code-first/schema.gql
@@ -15,7 +15,7 @@ scalar Date
 
 type Query {
   recipe(id: String!): Recipe!
-  recipes(skip: Int = 0, take: Int = 25): [Recipe!]!
+  recipes(skip: Int! = 0, take: Int! = 25): [Recipe!]!
 }
 
 type Mutation {
@@ -31,4 +31,4 @@ input NewRecipeInput {
 
 type Subscription {
   recipeAdded: Recipe!
-}
+}
\ No newline at end of file
diff --git a/integration/graphql-code-first/src/app.module.ts b/integration/graphql-code-first/src/app.module.ts
index 4fd71db94..5da27fa35 100644
--- a/integration/graphql-code-first/src/app.module.ts
+++ b/integration/graphql-code-first/src/app.module.ts
@@ -1,3 +1,4 @@
+import { ApolloDriver, ApolloDriverConfig } from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
 import { GraphQLModule } from '@nestjs/graphql';
 import { join } from 'path';
@@ -6,8 +7,9 @@ import { RecipesModule } from './recipes/recipes.module';
 @Module({
   imports: [
     RecipesModule,
-    GraphQLModule.forRoot({
-      debug: false,
+    GraphQLModule.forRoot<ApolloDriverConfig>({
+      driver: ApolloDriver,
+      includeStacktraceInErrorResponses: false,
       installSubscriptionHandlers: true,
       autoSchemaFile: join(
         process.cwd(),
@@ -16,4 +18,4 @@ import { RecipesModule } from './recipes/recipes.module';
     }),
   ],
 })
-export class ApplicationModule {}
+export class AppModule {}
diff --git a/integration/graphql-code-first/src/main.ts b/integration/graphql-code-first/src/main.ts
index c04a543a1..4561536fa 100644
--- a/integration/graphql-code-first/src/main.ts
+++ b/integration/graphql-code-first/src/main.ts
@@ -1,10 +1,10 @@
 import { ValidationPipe } from '@nestjs/common';
 import { NestFactory } from '@nestjs/core';
-import { ApplicationModule } from './app.module';
+import { AppModule } from './app.module';
 
 async function bootstrap() {
-  const app = await NestFactory.create(ApplicationModule);
+  const app = await NestFactory.create(AppModule);
   app.useGlobalPipes(new ValidationPipe());
   await app.listen(3000);
 }
-bootstrap();
+void bootstrap();
diff --git a/integration/graphql-code-first/src/recipes/recipes.resolver.ts b/integration/graphql-code-first/src/recipes/recipes.resolver.ts
index 8d77a22c9..068090d50 100644
--- a/integration/graphql-code-first/src/recipes/recipes.resolver.ts
+++ b/integration/graphql-code-first/src/recipes/recipes.resolver.ts
@@ -35,7 +35,7 @@ export class RecipesResolver {
     @Args('newRecipeData') newRecipeData: NewRecipeInput,
   ): Promise<Recipe> {
     const recipe = await this.recipesService.create(newRecipeData);
-    pubSub.publish('recipeAdded', { recipeAdded: recipe });
+    void pubSub.publish('recipeAdded', { recipeAdded: recipe });
     return recipe;
   }
 
diff --git a/integration/graphql-code-first/tsconfig.json b/integration/graphql-code-first/tsconfig.json
index ea15af490..4a0f01e0e 100644
--- a/integration/graphql-code-first/tsconfig.json
+++ b/integration/graphql-code-first/tsconfig.json
@@ -7,16 +7,35 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "strictNullChecks": true,
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
-    "src/**/*"
+    "src/**/*",
+    "e2e/**/*"
   ],
   "exclude": [
     "node_modules",
-    "**/*.spec.ts"
   ]
 }
\ No newline at end of file
diff --git a/integration/graphql-schema-first/e2e/graphql-request-scoped.spec.ts b/integration/graphql-schema-first/e2e/graphql-request-scoped.spec.ts
index fa470c2c6..125a55c81 100644
--- a/integration/graphql-schema-first/e2e/graphql-request-scoped.spec.ts
+++ b/integration/graphql-schema-first/e2e/graphql-request-scoped.spec.ts
@@ -1,3 +1,4 @@
+import { ApolloDriver } from '@nestjs/apollo';
 import { INestApplication } from '@nestjs/common';
 import { GraphQLModule } from '@nestjs/graphql';
 import { Test } from '@nestjs/testing';
@@ -15,6 +16,7 @@ describe('GraphQL request scoped', () => {
       imports: [
         CatsModule.enableRequestScope(),
         GraphQLModule.forRoot({
+          driver: ApolloDriver,
           typePaths: [join(__dirname, '..', 'src', '**', '*.graphql')],
         }),
       ],
@@ -40,7 +42,7 @@ describe('GraphQL request scoped', () => {
             ],
           },
         })
-        .end((err, res) => {
+        .end(err => {
           if (err) return end(err);
           end();
         });
diff --git a/integration/graphql-schema-first/e2e/graphql.spec.ts b/integration/graphql-schema-first/e2e/graphql.spec.ts
index 376244f1a..e8ced186f 100644
--- a/integration/graphql-schema-first/e2e/graphql.spec.ts
+++ b/integration/graphql-schema-first/e2e/graphql.spec.ts
@@ -1,14 +1,14 @@
 import { INestApplication } from '@nestjs/common';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 describe('GraphQL', () => {
   let app: INestApplication;
 
   beforeEach(async () => {
     const module = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
 
     app = module.createNestApplication();
diff --git a/integration/graphql-schema-first/src/app.module.ts b/integration/graphql-schema-first/src/app.module.ts
index a3cfa7a6d..2879cfc9f 100644
--- a/integration/graphql-schema-first/src/app.module.ts
+++ b/integration/graphql-schema-first/src/app.module.ts
@@ -1,3 +1,4 @@
+import { ApolloDriver, ApolloDriverConfig } from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
 import { GraphQLModule } from '@nestjs/graphql';
 import { join } from 'path';
@@ -6,9 +7,11 @@ import { CatsModule } from './cats/cats.module';
 @Module({
   imports: [
     CatsModule,
-    GraphQLModule.forRoot({
+    GraphQLModule.forRoot<ApolloDriverConfig>({
+      driver: ApolloDriver,
+      includeStacktraceInErrorResponses: true,
       typePaths: [join(__dirname, '**', '*.graphql')],
     }),
   ],
 })
-export class ApplicationModule {}
+export class AppModule {}
diff --git a/integration/graphql-schema-first/src/async-options-class.module.ts b/integration/graphql-schema-first/src/async-options-class.module.ts
index 749492e8c..5e702348d 100644
--- a/integration/graphql-schema-first/src/async-options-class.module.ts
+++ b/integration/graphql-schema-first/src/async-options-class.module.ts
@@ -1,14 +1,11 @@
+import { ApolloDriver, ApolloDriverConfig } from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
-import {
-  GqlModuleOptions,
-  GqlOptionsFactory,
-  GraphQLModule,
-} from '@nestjs/graphql';
+import { GqlOptionsFactory, GraphQLModule } from '@nestjs/graphql';
 import { join } from 'path';
 import { CatsModule } from './cats/cats.module';
 
 class ConfigService implements GqlOptionsFactory {
-  createGqlOptions(): GqlModuleOptions {
+  createGqlOptions(): ApolloDriverConfig {
     return {
       typePaths: [join(__dirname, '**', '*.graphql')],
     };
@@ -18,7 +15,8 @@ class ConfigService implements GqlOptionsFactory {
 @Module({
   imports: [
     CatsModule,
-    GraphQLModule.forRootAsync({
+    GraphQLModule.forRootAsync<ApolloDriverConfig>({
+      driver: ApolloDriver,
       useClass: ConfigService,
     }),
   ],
diff --git a/integration/graphql-schema-first/src/async-options-existing.module.ts b/integration/graphql-schema-first/src/async-options-existing.module.ts
index 9bfe86369..e68b65ada 100644
--- a/integration/graphql-schema-first/src/async-options-existing.module.ts
+++ b/integration/graphql-schema-first/src/async-options-existing.module.ts
@@ -1,3 +1,4 @@
+import { ApolloDriver, ApolloDriverConfig } from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
 import { GraphQLModule } from '@nestjs/graphql';
 import { CatsModule } from './cats/cats.module';
@@ -7,7 +8,8 @@ import { ConfigService } from './config.service';
 @Module({
   imports: [
     CatsModule,
-    GraphQLModule.forRootAsync({
+    GraphQLModule.forRootAsync<ApolloDriverConfig>({
+      driver: ApolloDriver,
       imports: [ConfigModule],
       useExisting: ConfigService,
     }),
diff --git a/integration/graphql-schema-first/src/async-options.module.ts b/integration/graphql-schema-first/src/async-options.module.ts
index 77dfb471d..c123cbc97 100644
--- a/integration/graphql-schema-first/src/async-options.module.ts
+++ b/integration/graphql-schema-first/src/async-options.module.ts
@@ -1,3 +1,4 @@
+import { ApolloDriver, ApolloDriverConfig } from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
 import { GraphQLModule } from '@nestjs/graphql';
 import { join } from 'path';
@@ -6,7 +7,8 @@ import { CatsModule } from './cats/cats.module';
 @Module({
   imports: [
     CatsModule,
-    GraphQLModule.forRootAsync({
+    GraphQLModule.forRootAsync<ApolloDriverConfig>({
+      driver: ApolloDriver,
       useFactory: async () => ({
         typePaths: [join(__dirname, '**', '*.graphql')],
       }),
diff --git a/integration/graphql-schema-first/src/cats/cats-request-scoped.service.ts b/integration/graphql-schema-first/src/cats/cats-request-scoped.service.ts
index 3d6e193f4..ebb88880d 100644
--- a/integration/graphql-schema-first/src/cats/cats-request-scoped.service.ts
+++ b/integration/graphql-schema-first/src/cats/cats-request-scoped.service.ts
@@ -20,6 +20,6 @@ export class CatsRequestScopedService {
   }
 
   findOneById(id: number): Cat {
-    return this.cats.find(cat => cat.id === id);
+    return this.cats.find(cat => cat.id === id)!;
   }
 }
diff --git a/integration/graphql-schema-first/src/cats/cats.resolvers.ts b/integration/graphql-schema-first/src/cats/cats.resolvers.ts
index afccc5602..9d77423c0 100644
--- a/integration/graphql-schema-first/src/cats/cats.resolvers.ts
+++ b/integration/graphql-schema-first/src/cats/cats.resolvers.ts
@@ -27,8 +27,8 @@ export class CatsResolvers {
 
   @Mutation('createCat')
   async create(@Args() args: Cat): Promise<Cat> {
-    const createdCat = await this.catsService.create(args);
-    pubSub.publish('catCreated', { catCreated: createdCat });
+    const createdCat = this.catsService.create(args);
+    void pubSub.publish('catCreated', { catCreated: createdCat });
     return createdCat;
   }
 
diff --git a/integration/graphql-schema-first/src/cats/cats.service.ts b/integration/graphql-schema-first/src/cats/cats.service.ts
index 56f362529..a529301e6 100644
--- a/integration/graphql-schema-first/src/cats/cats.service.ts
+++ b/integration/graphql-schema-first/src/cats/cats.service.ts
@@ -20,6 +20,6 @@ export class CatsService {
   }
 
   findOneById(id: number): Cat {
-    return this.cats.find(cat => cat.id === id);
+    return this.cats.find(cat => cat.id === id)!;
   }
 }
diff --git a/integration/graphql-schema-first/src/main.ts b/integration/graphql-schema-first/src/main.ts
index afb93ba07..23f3240c2 100644
--- a/integration/graphql-schema-first/src/main.ts
+++ b/integration/graphql-schema-first/src/main.ts
@@ -1,8 +1,8 @@
 import { NestFactory } from '@nestjs/core';
-import { ApplicationModule } from './app.module';
+import { AppModule } from './app.module';
 
 async function bootstrap() {
-  const app = await NestFactory.create(ApplicationModule);
+  const app = await NestFactory.create(AppModule);
   await app.listen(3000);
 }
-bootstrap();
+void bootstrap();
diff --git a/integration/graphql-schema-first/tsconfig.json b/integration/graphql-schema-first/tsconfig.json
index 3229c5596..4a0f01e0e 100644
--- a/integration/graphql-schema-first/tsconfig.json
+++ b/integration/graphql-schema-first/tsconfig.json
@@ -7,17 +7,35 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
+    "strictNullChecks": true,
     "outDir": "./dist",
-    "skipLibCheck": true
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
-    "src/**/*"
+    "src/**/*",
+    "e2e/**/*"
   ],
   "exclude": [
     "node_modules",
-    "**/*.spec.ts"
   ]
 }
\ No newline at end of file
diff --git a/integration/hello-world/e2e/exceptions.spec.ts b/integration/hello-world/e2e/exceptions.spec.ts
index 7cf8223ab..581964807 100644
--- a/integration/hello-world/e2e/exceptions.spec.ts
+++ b/integration/hello-world/e2e/exceptions.spec.ts
@@ -1,39 +1,135 @@
 import { HttpStatus, INestApplication } from '@nestjs/common';
+import {
+  FastifyAdapter,
+  NestFastifyApplication,
+} from '@nestjs/platform-fastify';
 import { Test } from '@nestjs/testing';
+import { expect } from 'chai';
+import { RawServerDefault } from 'fastify';
 import * as request from 'supertest';
 import { ErrorsController } from '../src/errors/errors.controller';
 
 describe('Error messages', () => {
-  let server;
-  let app: INestApplication;
+  let server: RawServerDefault;
 
-  beforeEach(async () => {
-    const module = await Test.createTestingModule({
-      controllers: [ErrorsController],
-    }).compile();
+  describe('Express', () => {
+    let app: INestApplication;
+    beforeEach(async () => {
+      const module = await Test.createTestingModule({
+        controllers: [ErrorsController],
+      }).compile();
 
-    app = module.createNestApplication();
-    server = app.getHttpServer();
-    await app.init();
-  });
+      app = module.createNestApplication();
+      server = app.getHttpServer();
+      await app.init();
+    });
 
-  it(`/GET`, () => {
-    return request(server).get('/sync').expect(HttpStatus.BAD_REQUEST).expect({
-      statusCode: 400,
-      error: 'Bad Request',
-      message: 'Integration test',
+    it(`/GET`, () => {
+      return request(server)
+        .get('/sync')
+        .expect(HttpStatus.BAD_REQUEST)
+        .expect({
+          statusCode: 400,
+          error: 'Bad Request',
+          message: 'Integration test',
+        });
+    });
+
+    it(`/GET (Promise/async)`, () => {
+      return request(server)
+        .get('/async')
+        .expect(HttpStatus.BAD_REQUEST)
+        .expect({
+          statusCode: 400,
+          error: 'Bad Request',
+          message: 'Integration test',
+        });
     });
-  });
 
-  it(`/GET (Promise/async)`, () => {
-    return request(server).get('/async').expect(HttpStatus.BAD_REQUEST).expect({
-      statusCode: 400,
-      error: 'Bad Request',
-      message: 'Integration test',
+    it(`/GET (InternalServerError despite custom content-type)`, async () => {
+      return request(server)
+        .get('/unexpected-error')
+        .expect(HttpStatus.INTERNAL_SERVER_ERROR)
+        .expect({
+          statusCode: 500,
+          message: 'Internal server error',
+        });
+    });
+
+    afterEach(async () => {
+      await app.close();
     });
   });
 
-  afterEach(async () => {
-    await app.close();
+  describe('Fastify', () => {
+    let app: NestFastifyApplication;
+    beforeEach(async () => {
+      const module = await Test.createTestingModule({
+        controllers: [ErrorsController],
+      }).compile();
+
+      app = module.createNestApplication<NestFastifyApplication>(
+        new FastifyAdapter(),
+      );
+      server = app.getHttpServer();
+      await app.init();
+    });
+
+    it(`/GET`, async () => {
+      return app
+        .inject({
+          method: 'GET',
+          url: '/sync',
+        })
+        .then(({ payload, statusCode }) => {
+          expect(statusCode).to.equal(HttpStatus.BAD_REQUEST);
+          expect(payload).to.equal(
+            JSON.stringify({
+              statusCode: 400,
+              error: 'Bad Request',
+              message: 'Integration test',
+            }),
+          );
+        });
+    });
+
+    it(`/GET (Promise/async)`, async () => {
+      return app
+        .inject({
+          method: 'GET',
+          url: '/sync',
+        })
+        .then(({ payload, statusCode }) => {
+          expect(statusCode).to.equal(HttpStatus.BAD_REQUEST);
+          expect(payload).to.equal(
+            JSON.stringify({
+              statusCode: 400,
+              error: 'Bad Request',
+              message: 'Integration test',
+            }),
+          );
+        });
+    });
+
+    it(`/GET (InternalServerError despite custom content-type)`, async () => {
+      return app
+        .inject({
+          method: 'GET',
+          url: '/unexpected-error',
+        })
+        .then(({ payload, statusCode }) => {
+          expect(statusCode).to.equal(HttpStatus.INTERNAL_SERVER_ERROR);
+          expect(payload).to.equal(
+            JSON.stringify({
+              statusCode: 500,
+              message: 'Internal server error',
+            }),
+          );
+        });
+    });
+
+    afterEach(async () => {
+      await app.close();
+    });
   });
 });
diff --git a/integration/hello-world/e2e/exclude-middleware-fastify.spec.ts b/integration/hello-world/e2e/exclude-middleware-fastify.spec.ts
index b3bbca679..2622d4cd0 100644
--- a/integration/hello-world/e2e/exclude-middleware-fastify.spec.ts
+++ b/integration/hello-world/e2e/exclude-middleware-fastify.spec.ts
@@ -13,7 +13,7 @@ import {
 } from '@nestjs/platform-fastify';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 const RETURN_VALUE = 'test';
 const MIDDLEWARE_VALUE = 'middleware';
@@ -57,7 +57,7 @@ class TestController {
 }
 
 @Module({
-  imports: [ApplicationModule],
+  imports: [AppModule],
   controllers: [TestController],
 })
 class TestModule {
diff --git a/integration/hello-world/e2e/exclude-middleware.spec.ts b/integration/hello-world/e2e/exclude-middleware.spec.ts
index 0b0fe2d74..3fad028d0 100644
--- a/integration/hello-world/e2e/exclude-middleware.spec.ts
+++ b/integration/hello-world/e2e/exclude-middleware.spec.ts
@@ -9,7 +9,7 @@ import {
 } from '@nestjs/common';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 const RETURN_VALUE = 'test';
 const MIDDLEWARE_VALUE = 'middleware';
@@ -45,10 +45,15 @@ class TestController {
   overviewById() {
     return RETURN_VALUE;
   }
+
+  @Get('multiple/exclude')
+  multipleExclude() {
+    return RETURN_VALUE;
+  }
 }
 
 @Module({
-  imports: [ApplicationModule],
+  imports: [AppModule],
   controllers: [TestController],
 })
 class TestModule {
@@ -59,6 +64,7 @@ class TestModule {
         path: 'middleware',
         method: RequestMethod.POST,
       })
+      .exclude('multiple/exclude')
       .forRoutes('*');
   }
 }
@@ -110,6 +116,12 @@ describe('Exclude middleware', () => {
       .expect(200, RETURN_VALUE);
   });
 
+  it(`should exclude "/multiple/exclude" endpoint`, () => {
+    return request(app.getHttpServer())
+      .get('/multiple/exclude')
+      .expect(200, RETURN_VALUE);
+  });
+
   afterEach(async () => {
     await app.close();
   });
diff --git a/integration/hello-world/e2e/express-instance.spec.ts b/integration/hello-world/e2e/express-instance.spec.ts
index 9774487a2..6529cb664 100644
--- a/integration/hello-world/e2e/express-instance.spec.ts
+++ b/integration/hello-world/e2e/express-instance.spec.ts
@@ -3,7 +3,7 @@ import { ExpressAdapter } from '@nestjs/platform-express';
 import { Test } from '@nestjs/testing';
 import * as express from 'express';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 describe('Hello world (express instance)', () => {
   let server;
@@ -11,7 +11,7 @@ describe('Hello world (express instance)', () => {
 
   beforeEach(async () => {
     const module = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
 
     app = module.createNestApplication(new ExpressAdapter(express()));
@@ -45,6 +45,10 @@ describe('Hello world (express instance)', () => {
     });
   });
 
+  it('/HEAD should respond to with a 200', () => {
+    return request(server).head('/hello').expect(200);
+  });
+
   afterEach(async () => {
     await app.close();
   });
diff --git a/integration/hello-world/e2e/express-multiple.spec.ts b/integration/hello-world/e2e/express-multiple.spec.ts
index 431e896b7..1f799d479 100644
--- a/integration/hello-world/e2e/express-multiple.spec.ts
+++ b/integration/hello-world/e2e/express-multiple.spec.ts
@@ -3,7 +3,7 @@ import { ExpressAdapter } from '@nestjs/platform-express';
 import { Test } from '@nestjs/testing';
 import * as express from 'express';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 describe('Hello world (express instance with multiple applications)', () => {
   let server;
@@ -11,10 +11,10 @@ describe('Hello world (express instance with multiple applications)', () => {
 
   beforeEach(async () => {
     const module1 = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
     const module2 = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
 
     const adapter = new ExpressAdapter(express());
diff --git a/integration/hello-world/e2e/fastify-adapter.spec.ts b/integration/hello-world/e2e/fastify-adapter.spec.ts
index 2846b0edd..73852ba23 100644
--- a/integration/hello-world/e2e/fastify-adapter.spec.ts
+++ b/integration/hello-world/e2e/fastify-adapter.spec.ts
@@ -4,14 +4,14 @@ import {
 } from '@nestjs/platform-fastify';
 import { Test } from '@nestjs/testing';
 import { expect } from 'chai';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 describe('Hello world (fastify adapter)', () => {
   let app: NestFastifyApplication;
 
   beforeEach(async () => {
     const module = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
 
     app = module.createNestApplication<NestFastifyApplication>(
@@ -87,6 +87,15 @@ describe('Hello world (fastify adapter)', () => {
       .then(({ payload }) => expect(payload).to.be.eql('Hello world!'));
   });
 
+  it('/HEAD should respond to with a 200', () => {
+    return app
+      .inject({
+        method: 'HEAD',
+        url: '/hello',
+      })
+      .then(({ statusCode }) => expect(statusCode).to.be.eq(200));
+  });
+
   afterEach(async () => {
     await app.close();
   });
diff --git a/integration/hello-world/e2e/guards.spec.ts b/integration/hello-world/e2e/guards.spec.ts
index 08e372e00..970826123 100644
--- a/integration/hello-world/e2e/guards.spec.ts
+++ b/integration/hello-world/e2e/guards.spec.ts
@@ -6,7 +6,7 @@ import {
 import { APP_GUARD } from '@nestjs/core';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 @Injectable()
 export class AuthGuard {
@@ -20,7 +20,7 @@ export class AuthGuard {
 
 function createTestModule(guard) {
   return Test.createTestingModule({
-    imports: [ApplicationModule],
+    imports: [AppModule],
     providers: [
       {
         provide: APP_GUARD,
diff --git a/integration/hello-world/e2e/hello-world.spec.ts b/integration/hello-world/e2e/hello-world.spec.ts
index 531a65160..e2f3a895f 100644
--- a/integration/hello-world/e2e/hello-world.spec.ts
+++ b/integration/hello-world/e2e/hello-world.spec.ts
@@ -1,7 +1,7 @@
 import * as request from 'supertest';
 import { Test } from '@nestjs/testing';
 import { INestApplication } from '@nestjs/common';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 describe('Hello world (default adapter)', () => {
   let server;
@@ -9,7 +9,7 @@ describe('Hello world (default adapter)', () => {
 
   beforeEach(async () => {
     const module = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
 
     app = module.createNestApplication();
diff --git a/integration/hello-world/e2e/interceptors.spec.ts b/integration/hello-world/e2e/interceptors.spec.ts
index 11222c514..249eb9312 100644
--- a/integration/hello-world/e2e/interceptors.spec.ts
+++ b/integration/hello-world/e2e/interceptors.spec.ts
@@ -10,7 +10,7 @@ import { Test } from '@nestjs/testing';
 import { of } from 'rxjs';
 import { map } from 'rxjs/operators';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 const RETURN_VALUE = 'test';
 
@@ -48,7 +48,7 @@ export class HeaderInterceptor {
     const ctx = context.switchToHttp();
     const res = ctx.getResponse();
     for (const key in this.headers) {
-      if (this.headers.hasOwnProperty(key)) {
+      if (Object.prototype.hasOwnProperty.call(this.headers, key)) {
         res.header(key, this.headers[key]);
       }
     }
@@ -58,7 +58,7 @@ export class HeaderInterceptor {
 
 function createTestModule(interceptor) {
   return Test.createTestingModule({
-    imports: [ApplicationModule],
+    imports: [AppModule],
     providers: [
       {
         provide: APP_INTERCEPTOR,
diff --git a/integration/hello-world/e2e/local-pipes.spec.ts b/integration/hello-world/e2e/local-pipes.spec.ts
index 5bc4a66d8..e982bc4ae 100644
--- a/integration/hello-world/e2e/local-pipes.spec.ts
+++ b/integration/hello-world/e2e/local-pipes.spec.ts
@@ -1,7 +1,7 @@
 import { INestApplication } from '@nestjs/common';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 describe('Hello world (default adapter)', () => {
   let server;
@@ -9,7 +9,7 @@ describe('Hello world (default adapter)', () => {
 
   beforeEach(async () => {
     const module = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
 
     app = module.createNestApplication();
diff --git a/integration/hello-world/e2e/middleware-class.spec.ts b/integration/hello-world/e2e/middleware-class.spec.ts
index 134222611..e71a12ec5 100644
--- a/integration/hello-world/e2e/middleware-class.spec.ts
+++ b/integration/hello-world/e2e/middleware-class.spec.ts
@@ -9,7 +9,7 @@ import {
 } from '@nestjs/common';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 import { Response } from 'express';
 
 const INCLUDED_VALUE = 'test_included';
@@ -32,7 +32,7 @@ class TestController {
 }
 
 @Module({
-  imports: [ApplicationModule],
+  imports: [AppModule],
   controllers: [TestController],
 })
 class TestModule {
diff --git a/integration/hello-world/e2e/middleware-fastify.spec.ts b/integration/hello-world/e2e/middleware-fastify.spec.ts
index 4fe34a0b3..a0d9d9f21 100644
--- a/integration/hello-world/e2e/middleware-fastify.spec.ts
+++ b/integration/hello-world/e2e/middleware-fastify.spec.ts
@@ -3,7 +3,10 @@ import {
   Get,
   MiddlewareConsumer,
   Module,
+  NestMiddleware,
+  NestModule,
   Query,
+  Req,
   RequestMethod,
 } from '@nestjs/common';
 import {
@@ -12,180 +15,518 @@ import {
 } from '@nestjs/platform-fastify';
 import { Test } from '@nestjs/testing';
 import { expect } from 'chai';
-import { ApplicationModule } from '../src/app.module';
-
-const INCLUDED_VALUE = 'test_included';
-const QUERY_VALUE = 'test_query';
-const REQ_URL_VALUE = 'test_req_url';
-const RETURN_VALUE = 'test';
-const SCOPED_VALUE = 'test_scoped';
-const WILDCARD_VALUE = 'test_wildcard';
-
-@Controller()
-class TestController {
-  @Get('express_style_wildcard/wildcard_nested')
-  express_style_wildcard() {
-    return RETURN_VALUE;
-  }
-
-  @Get('test')
-  test() {
-    return RETURN_VALUE;
-  }
-
-  @Get('query')
-  query() {
-    return RETURN_VALUE;
-  }
-
-  @Get('tests/wildcard_nested')
-  wildcard_nested() {
-    return RETURN_VALUE;
-  }
-
-  @Get('tests/included')
-  included() {
-    return RETURN_VALUE;
-  }
-}
-
-@Controller(QUERY_VALUE)
-class TestQueryController {
-  @Get()
-  [QUERY_VALUE](@Query('test') test: string) {
-    return test;
-  }
-}
-
-@Module({
-  imports: [ApplicationModule],
-  controllers: [TestController, TestQueryController],
-})
-class TestModule {
-  configure(consumer: MiddlewareConsumer) {
-    consumer
-      .apply((req, res, next) => res.end(INCLUDED_VALUE))
-      .forRoutes({ path: 'tests/included', method: RequestMethod.POST })
-      .apply((req, res, next) => res.end(`${REQ_URL_VALUE}${req.url}`))
-      .forRoutes('req/url/')
-      .apply((req, res, next) => res.end(WILDCARD_VALUE))
-      .forRoutes('express_style_wildcard/*', 'tests/(.*)')
-      .apply((req, res, next) => res.end(QUERY_VALUE))
-      .forRoutes('query')
-      .apply((req, res, next) => next())
-      .forRoutes(TestQueryController)
-      .apply((req, res, next) => res.end(SCOPED_VALUE))
-      .forRoutes(TestController)
-      .apply((req, res, next) => res.end(RETURN_VALUE))
-      .exclude({ path: QUERY_VALUE, method: -1 })
-      .forRoutes('(.*)');
-  }
-}
+import { AppModule } from '../src/app.module';
+import * as request from 'supertest';
+import { FastifyRequest } from 'fastify';
 
 describe('Middleware (FastifyAdapter)', () => {
   let app: NestFastifyApplication;
 
-  beforeEach(async () => {
-    app = (
-      await Test.createTestingModule({
-        imports: [TestModule],
-      }).compile()
-    ).createNestApplication<NestFastifyApplication>(new FastifyAdapter());
+  describe('should return expected values depending on the route', () => {
+    const INCLUDED_VALUE = 'test_included';
+    const QUERY_VALUE = 'test_query';
+    const REQ_URL_VALUE = 'test_req_url';
+    const RETURN_VALUE = 'test';
+    const SCOPED_VALUE = 'test_scoped';
+    const WILDCARD_VALUE = 'test_wildcard';
 
-    await app.init();
-  });
+    @Controller()
+    class TestController {
+      @Get('express_style_wildcard/wildcard_nested')
+      express_style_wildcard() {
+        return RETURN_VALUE;
+      }
 
-  it(`forRoutes((.*))`, () => {
-    return app
-      .inject({
-        method: 'GET',
-        url: '/hello',
-      })
-      .then(({ payload }) => expect(payload).to.be.eql(RETURN_VALUE));
-  });
+      @Get('test')
+      test() {
+        return RETURN_VALUE;
+      }
 
-  it(`forRoutes(TestController)`, () => {
-    return app
-      .inject({
-        method: 'GET',
-        url: '/test',
-      })
-      .then(({ payload }) => expect(payload).to.be.eql(SCOPED_VALUE));
-  });
+      @Get('query')
+      query() {
+        return RETURN_VALUE;
+      }
 
-  it(`query?test=${QUERY_VALUE} forRoutes(query)`, () => {
-    return app
-      .inject({
-        method: 'GET',
-        url: '/query',
-        query: {
-          test: QUERY_VALUE,
-        },
-      })
-      .then(({ payload }) => expect(payload).to.be.eql(QUERY_VALUE));
-  });
+      @Get('tests/wildcard_nested')
+      wildcard_nested() {
+        return RETURN_VALUE;
+      }
 
-  it(`${QUERY_VALUE}?test=${QUERY_VALUE} forRoutes(${QUERY_VALUE})`, () => {
-    return app
-      .inject({
-        method: 'GET',
-        url: QUERY_VALUE,
-        query: {
-          test: QUERY_VALUE,
-        },
-      })
-      .then(({ payload }) => expect(payload).to.be.eql(QUERY_VALUE));
-  });
+      @Get('tests/included')
+      included() {
+        return RETURN_VALUE;
+      }
+    }
 
-  it(`forRoutes(tests/(.*))`, () => {
-    return app
-      .inject({
-        method: 'GET',
-        url: '/tests/wildcard_nested',
-      })
-      .then(({ payload }) => expect(payload).to.be.eql(WILDCARD_VALUE));
-  });
+    @Controller(QUERY_VALUE)
+    class TestQueryController {
+      @Get()
+      [QUERY_VALUE](@Query('test') test: string) {
+        return test;
+      }
+    }
 
-  it(`forRoutes(express_style_wildcard/*)`, () => {
-    return app
-      .inject({
-        method: 'GET',
-        url: '/express_style_wildcard/wildcard_nested',
-      })
-      .then(({ payload }) => expect(payload).to.be.eql(WILDCARD_VALUE));
-  });
+    @Module({
+      imports: [AppModule],
+      controllers: [TestController, TestQueryController],
+    })
+    class TestModule {
+      configure(consumer: MiddlewareConsumer) {
+        consumer
+          .apply((req, res, next) => res.end(INCLUDED_VALUE))
+          .forRoutes({ path: 'tests/included', method: RequestMethod.POST })
+          .apply((req, res, next) => res.end(REQ_URL_VALUE))
+          .forRoutes('req/url/(.*)')
+          .apply((req, res, next) => res.end(WILDCARD_VALUE))
+          .forRoutes('express_style_wildcard/*', 'tests/(.*)')
+          .apply((req, res, next) => res.end(QUERY_VALUE))
+          .forRoutes('query')
+          .apply((req, res, next) => next())
+          .forRoutes(TestQueryController)
+          .apply((req, res, next) => res.end(SCOPED_VALUE))
+          .forRoutes(TestController)
+          .apply((req, res, next) => res.end(RETURN_VALUE))
+          .exclude({ path: QUERY_VALUE, method: -1 as any })
+          .forRoutes('(.*)');
+      }
+    }
 
-  it(`forRoutes(req/url/)`, () => {
-    const reqUrl = '/test';
-    return app
-      .inject({
-        method: 'GET',
-        url: `/req/url${reqUrl}`,
-      })
-      .then(({ payload }) =>
-        expect(payload).to.be.eql(`${REQ_URL_VALUE}${reqUrl}`),
-      );
-  });
+    beforeEach(async () => {
+      app = (
+        await Test.createTestingModule({
+          imports: [TestModule],
+        }).compile()
+      ).createNestApplication<NestFastifyApplication>(new FastifyAdapter());
+
+      await app.init();
+    });
+
+    it(`forRoutes((.*))`, () => {
+      return app
+        .inject({
+          method: 'GET',
+          url: '/hello',
+        })
+        .then(({ payload }) => expect(payload).to.be.eql(RETURN_VALUE));
+    });
+
+    it(`forRoutes(TestController)`, () => {
+      return app
+        .inject({
+          method: 'GET',
+          url: '/test',
+        })
+        .then(({ payload }) => expect(payload).to.be.eql(SCOPED_VALUE));
+    });
+
+    it(`query?test=${QUERY_VALUE} forRoutes(query)`, () => {
+      return app
+        .inject({
+          method: 'GET',
+          url: '/query',
+          query: {
+            test: QUERY_VALUE,
+          },
+        })
+        .then(({ payload }) => expect(payload).to.be.eql(QUERY_VALUE));
+    });
 
-  it(`GET forRoutes(POST tests/included)`, () => {
-    return app
-      .inject({
-        method: 'GET',
-        url: '/tests/included',
-      })
-      .then(({ payload }) => expect(payload).to.be.eql(WILDCARD_VALUE));
+    it(`${QUERY_VALUE}?test=${QUERY_VALUE} forRoutes(${QUERY_VALUE})`, () => {
+      return app
+        .inject({
+          method: 'GET',
+          url: QUERY_VALUE,
+          query: {
+            test: QUERY_VALUE,
+          },
+        })
+        .then(({ payload }) => expect(payload).to.be.eql(QUERY_VALUE));
+    });
+
+    it(`forRoutes(tests/(.*))`, () => {
+      return app
+        .inject({
+          method: 'GET',
+          url: '/tests/wildcard_nested',
+        })
+        .then(({ payload }) => expect(payload).to.be.eql(WILDCARD_VALUE));
+    });
+
+    it(`forRoutes(express_style_wildcard/*)`, () => {
+      return app
+        .inject({
+          method: 'GET',
+          url: '/express_style_wildcard/wildcard_nested',
+        })
+        .then(({ payload }) => expect(payload).to.be.eql(WILDCARD_VALUE));
+    });
+
+    it(`forRoutes(req/url/)`, () => {
+      const reqUrl = '/test';
+      return app
+        .inject({
+          method: 'GET',
+          url: `/req/url${reqUrl}`,
+        })
+        .then(({ payload }) => expect(payload).to.be.eql(REQ_URL_VALUE));
+    });
+
+    it(`GET forRoutes(POST tests/included)`, () => {
+      return app
+        .inject({
+          method: 'GET',
+          url: '/tests/included',
+        })
+        .then(({ payload }) => expect(payload).to.be.eql(WILDCARD_VALUE));
+    });
+
+    it(`POST forRoutes(POST tests/included)`, () => {
+      return app
+        .inject({
+          method: 'POST',
+          url: '/tests/included',
+        })
+        .then(({ payload }) => expect(payload).to.be.eql(INCLUDED_VALUE));
+    });
+
+    afterEach(async () => {
+      await app.close();
+    });
   });
 
-  it(`POST forRoutes(POST tests/included)`, () => {
-    return app
-      .inject({
-        method: 'POST',
-        url: '/tests/included',
-      })
-      .then(({ payload }) => expect(payload).to.be.eql(INCLUDED_VALUE));
+  describe('should execute middleware only once for given routes', () => {
+    class Middleware implements NestMiddleware {
+      use(request: any, reply: any, next: () => void) {
+        if (request.middlewareExecutionCount === undefined) {
+          request.middlewareExecutionCount = 1;
+        } else {
+          request.middlewareExecutionCount++;
+        }
+        next();
+      }
+    }
+
+    @Controller()
+    class AbcController {
+      @Get('/a')
+      async a(@Req() request: any) {
+        return this.validateExecutionCount({
+          request,
+          expected: 1,
+        });
+      }
+
+      @Get('/a/b')
+      async ab(@Req() request: any) {
+        return this.validateExecutionCount({
+          request,
+          expected: 1,
+        });
+      }
+
+      @Get('/a/b/c')
+      async abc(@Req() request: any) {
+        return this.validateExecutionCount({
+          request,
+          expected: 1,
+        });
+      }
+
+      @Get('/similar')
+      async withSimilar(@Req() request: any) {
+        return this.validateExecutionCount({
+          request,
+          expected: 1,
+        });
+      }
+
+      @Get('/similar/test')
+      async withSimilarTest(@Req() request: any) {
+        return this.validateExecutionCount({
+          request,
+          expected: 1,
+        });
+      }
+
+      @Get('/similar/:id')
+      async withSimilarId(@Req() request: any) {
+        return this.validateExecutionCount({
+          request,
+          expected: 1,
+        });
+      }
+
+      private validateExecutionCount({
+        request,
+        expected,
+      }: {
+        request: any;
+        expected: number;
+      }) {
+        let actual: number | undefined;
+        actual = request.raw.middlewareExecutionCount;
+        actual ??= 0;
+
+        return {
+          success: actual === expected,
+          actual,
+          expected,
+        };
+      }
+    }
+
+    @Module({
+      controllers: [AbcController],
+    })
+    class TestModule implements NestModule {
+      configure(consumer: MiddlewareConsumer) {
+        consumer.apply(Middleware).forRoutes(AbcController);
+      }
+    }
+
+    beforeEach(async () => {
+      app = (
+        await Test.createTestingModule({
+          imports: [TestModule],
+        }).compile()
+      ).createNestApplication<NestFastifyApplication>(new FastifyAdapter());
+
+      await app.init();
+    });
+
+    it(`GET forRoutes(/a/b/c)`, () => {
+      return app
+        .inject({
+          method: 'GET',
+          url: '/a/b/c',
+        })
+        .then(({ payload }) => {
+          expect(payload).to.be.eql(
+            JSON.stringify({
+              success: true,
+              actual: 1,
+              expected: 1,
+            }),
+          );
+        });
+    });
+
+    it(`GET forRoutes(/a/b)`, () => {
+      return app
+        .inject({
+          method: 'GET',
+          url: '/a/b',
+        })
+        .then(({ payload }) =>
+          expect(payload).to.be.eql(
+            JSON.stringify({
+              success: true,
+              actual: 1,
+              expected: 1,
+            }),
+          ),
+        );
+    });
+
+    it(`GET forRoutes(/a)`, () => {
+      return app
+        .inject({
+          method: 'GET',
+          url: '/a',
+        })
+        .then(({ payload }) =>
+          expect(payload).to.be.eql(
+            JSON.stringify({
+              success: true,
+              actual: 1,
+              expected: 1,
+            }),
+          ),
+        );
+    });
+
+    it(`GET forRoutes(/similar)`, () => {
+      return app
+        .inject({
+          method: 'GET',
+          url: '/similar',
+        })
+        .then(({ payload }) =>
+          expect(payload).to.be.eql(
+            JSON.stringify({
+              success: true,
+              actual: 1,
+              expected: 1,
+            }),
+          ),
+        );
+    });
+
+    it(`GET forRoutes(/similar/test)`, () => {
+      return app
+        .inject({
+          method: 'GET',
+          url: '/similar/test',
+        })
+        .then(({ payload }) =>
+          expect(payload).to.be.eql(
+            JSON.stringify({
+              success: true,
+              actual: 1,
+              expected: 1,
+            }),
+          ),
+        );
+    });
+
+    it(`GET forRoutes(/similar/arbitrary)`, () => {
+      return app
+        .inject({
+          method: 'GET',
+          url: '/similar/arbitrary',
+        })
+        .then(({ payload }) =>
+          expect(payload).to.be.eql(
+            JSON.stringify({
+              success: true,
+              actual: 1,
+              expected: 1,
+            }),
+          ),
+        );
+    });
+
+    afterEach(async () => {
+      await app.close();
+    });
   });
 
-  afterEach(async () => {
-    await app.close();
+  describe('should have data attached in middleware', () => {
+    @Controller()
+    class DataController {
+      @Get('data')
+      async data(@Req() req: FastifyRequest['raw']) {
+        return {
+          success: true,
+          extras: req?.['raw']?.extras,
+          pong: req?.['raw']?.headers?.ping,
+        };
+      }
+      @Get('pong')
+      async pong(@Req() req: FastifyRequest['raw']) {
+        return { success: true, pong: req?.['raw']?.headers?.ping };
+      }
+
+      @Get('')
+      async rootPath(@Req() req: FastifyRequest['raw']) {
+        return { success: true, root: true };
+      }
+    }
+
+    @Module({
+      controllers: [DataController],
+    })
+    class DataModule implements NestModule {
+      configure(consumer: MiddlewareConsumer) {
+        consumer
+          .apply((req, res, next) => {
+            req.extras = { data: 'Data attached in middleware' };
+            req.headers['ping'] = 'pong';
+            next();
+          })
+          .forRoutes('*');
+      }
+    }
+
+    beforeEach(async () => {
+      app = (
+        await Test.createTestingModule({
+          imports: [DataModule],
+        }).compile()
+      ).createNestApplication<NestFastifyApplication>(new FastifyAdapter());
+    });
+
+    it(`GET forRoutes('*') with global prefix`, async () => {
+      app.setGlobalPrefix('/api');
+      await app.init();
+      await app.getHttpAdapter().getInstance().ready();
+      return app
+        .inject({
+          method: 'GET',
+          url: '/api/pong',
+        })
+        .then(({ payload }) =>
+          expect(payload).to.be.eql(
+            JSON.stringify({
+              success: true,
+              pong: 'pong',
+            }),
+          ),
+        );
+    });
+
+    it(`GET forRoutes('*') without prefix config`, async () => {
+      await app.init();
+      await app.getHttpAdapter().getInstance().ready();
+      return app
+        .inject({
+          method: 'GET',
+          url: '/pong',
+        })
+        .then(({ payload }) =>
+          expect(payload).to.be.eql(
+            JSON.stringify({
+              success: true,
+              pong: 'pong',
+            }),
+          ),
+        );
+    });
+
+    it(`GET forRoutes('*') with global prefix and exclude patterns`, async () => {
+      app.setGlobalPrefix('/api', { exclude: ['/'] });
+      await app.init();
+      await app.getHttpAdapter().getInstance().ready();
+
+      await request(app.getHttpServer())
+        .get('/')
+        .expect(200, { success: true, root: true });
+    });
+
+    it(`GET forRoutes('*') with global prefix and global prefix options`, async () => {
+      app.setGlobalPrefix('/api', { exclude: ['/'] });
+      await app.init();
+      await app.getHttpAdapter().getInstance().ready();
+
+      await request(app.getHttpServer())
+        .get('/api/data')
+        .expect(200, {
+          success: true,
+          extras: { data: 'Data attached in middleware' },
+          pong: 'pong',
+        });
+      await request(app.getHttpServer())
+        .get('/')
+        .expect(200, { success: true, root: true });
+    });
+
+    it(`GET forRoutes('*') with global prefix that not starts with /`, async () => {
+      app.setGlobalPrefix('api');
+      await app.init();
+      await app.getHttpAdapter().getInstance().ready();
+
+      await request(app.getHttpServer())
+        .get('/api/data')
+        .expect(200, {
+          success: true,
+          extras: { data: 'Data attached in middleware' },
+          pong: 'pong',
+        });
+      await request(app.getHttpServer()).get('/').expect(404);
+    });
+
+    afterEach(async () => {
+      await app.close();
+    });
   });
 });
diff --git a/integration/hello-world/e2e/middleware-run-match-route.ts b/integration/hello-world/e2e/middleware-run-match-route.ts
new file mode 100644
index 000000000..c3c8ed3cf
--- /dev/null
+++ b/integration/hello-world/e2e/middleware-run-match-route.ts
@@ -0,0 +1,103 @@
+import {
+  Controller,
+  Get,
+  INestApplication,
+  Injectable,
+  MiddlewareConsumer,
+  NestMiddleware,
+  Module,
+} from '@nestjs/common';
+import { Test } from '../../../packages/testing';
+import * as request from 'supertest';
+import { expect } from 'chai';
+
+/**
+ * Number of times that the middleware was executed.
+ */
+let triggerCounter = 0;
+@Injectable()
+class Middleware implements NestMiddleware {
+  use(req, res, next) {
+    triggerCounter++;
+    next();
+  }
+}
+
+@Controller()
+class TestController {
+  @Get('/test')
+  testA() {}
+
+  @Get('/:id')
+  testB() {}
+
+  @Get('/static/route')
+  testC() {}
+
+  @Get('/:id/:nested')
+  testD() {}
+}
+
+@Module({
+  controllers: [TestController],
+})
+class TestModule {
+  configure(consumer: MiddlewareConsumer) {
+    consumer.apply(Middleware).forRoutes(TestController);
+  }
+}
+
+describe('Middleware (run on route match)', () => {
+  let app: INestApplication;
+
+  beforeEach(async () => {
+    triggerCounter = 0;
+    app = (
+      await Test.createTestingModule({
+        imports: [TestModule],
+      }).compile()
+    ).createNestApplication();
+
+    await app.init();
+  });
+
+  it(`forRoutes(TestController) should execute middleware once when request url is equal match`, () => {
+    return request(app.getHttpServer())
+      .get('/test')
+      .expect(200)
+      .then(() => {
+        expect(triggerCounter).to.be.eq(1);
+      });
+  });
+
+  it(`forRoutes(TestController) should execute middleware once when request url is not equal match`, () => {
+    return request(app.getHttpServer())
+      .get('/1')
+      .expect(200)
+      .then(() => {
+        expect(triggerCounter).to.be.eq(1);
+      });
+  });
+
+  it(`forRoutes(TestController) should execute middleware once when request url is not of nested params`, () => {
+    return request(app.getHttpServer())
+      .get('/static/route')
+      .expect(200)
+      .then(() => {
+        expect(triggerCounter).to.be.eq(1);
+      });
+  });
+
+  it(`forRoutes(TestController) should execute middleware once when request url is of nested params`, () => {
+    return request(app.getHttpServer())
+      .get('/1/abc')
+      .expect(200)
+      .then(() => {
+        expect(triggerCounter).to.be.eq(1);
+      });
+  });
+
+  afterEach(async () => {
+    await app.close();
+  });
+});
diff --git a/integration/hello-world/e2e/middleware-with-versioning.spec.ts b/integration/hello-world/e2e/middleware-with-versioning.spec.ts
new file mode 100644
index 000000000..a16645b68
--- /dev/null
+++ b/integration/hello-world/e2e/middleware-with-versioning.spec.ts
@@ -0,0 +1,171 @@
+import {
+  Controller,
+  Get,
+  INestApplication,
+  MiddlewareConsumer,
+  Module,
+  RequestMethod,
+  Version,
+  VersioningOptions,
+  VersioningType,
+  VERSION_NEUTRAL,
+} from '@nestjs/common';
+import { CustomVersioningOptions } from '@nestjs/common/interfaces';
+import { Test } from '@nestjs/testing';
+import * as request from 'supertest';
+import { AppModule } from '../src/app.module';
+
+const RETURN_VALUE = 'test';
+const VERSIONED_VALUE = 'test_versioned';
+
+@Controller()
+class TestController {
+  @Version('1')
+  @Get('versioned')
+  versionedTest() {
+    return RETURN_VALUE;
+  }
+}
+
+@Module({
+  imports: [AppModule],
+  controllers: [TestController],
+})
+class TestModule {
+  configure(consumer: MiddlewareConsumer) {
+    consumer
+      .apply((req, res, next) => res.send(VERSIONED_VALUE))
+      .forRoutes({
+        path: '/versioned',
+        version: '1',
+        method: RequestMethod.ALL,
+      });
+  }
+}
+
+describe('Middleware', () => {
+  let app: INestApplication;
+
+  describe('when using default URI versioning', () => {
+    beforeEach(async () => {
+      app = await createAppWithVersioning({
+        type: VersioningType.URI,
+        defaultVersion: VERSION_NEUTRAL,
+      });
+    });
+
+    it(`forRoutes({ path: '/versioned', version: '1', method: RequestMethod.ALL })`, () => {
+      return request(app.getHttpServer())
+        .get('/v1/versioned')
+        .expect(200, VERSIONED_VALUE);
+    });
+  });
+
+  describe('when default URI versioning with an alternative prefix', () => {
+    beforeEach(async () => {
+      app = await createAppWithVersioning({
+        type: VersioningType.URI,
+        defaultVersion: VERSION_NEUTRAL,
+        prefix: 'version',
+      });
+    });
+
+    it(`forRoutes({ path: '/versioned', version: '1', method: RequestMethod.ALL })`, () => {
+      return request(app.getHttpServer())
+        .get('/version1/versioned')
+        .expect(200, VERSIONED_VALUE);
+    });
+  });
+
+  describe('when using default URI versioning with the global prefix', () => {
+    beforeEach(async () => {
+      app = await createAppWithVersioning(
+        {
+          type: VersioningType.URI,
+          defaultVersion: VERSION_NEUTRAL,
+        },
+        async (app: INestApplication) => {
+          app.setGlobalPrefix('api');
+        },
+      );
+    });
+
+    it(`forRoutes({ path: '/versioned', version: '1', method: RequestMethod.ALL })`, () => {
+      return request(app.getHttpServer())
+        .get('/api/v1/versioned')
+        .expect(200, VERSIONED_VALUE);
+    });
+  });
+
+  describe('when using HEADER versioning', () => {
+    beforeEach(async () => {
+      app = await createAppWithVersioning({
+        type: VersioningType.HEADER,
+        header: 'version',
+      });
+    });
+
+    it(`forRoutes({ path: '/versioned', version: '1', method: RequestMethod.ALL })`, () => {
+      return request(app.getHttpServer())
+        .get('/versioned')
+        .set('version', '1')
+        .expect(200, VERSIONED_VALUE);
+    });
+  });
+
+  describe('when using MEDIA TYPE versioning', () => {
+    beforeEach(async () => {
+      app = await createAppWithVersioning({
+        type: VersioningType.MEDIA_TYPE,
+        key: 'v',
+        defaultVersion: VERSION_NEUTRAL,
+      });
+    });
+
+    it(`forRoutes({ path: '/versioned', version: '1', method: RequestMethod.ALL })`, () => {
+      return request(app.getHttpServer())
+        .get('/versioned')
+        .expect(200, VERSIONED_VALUE);
+    });
+  });
+
+  describe('when using CUSTOM TYPE versioning', () => {
+    beforeEach(async () => {
+      const extractor: CustomVersioningOptions['extractor'] = () => '1';
+
+      app = await createAppWithVersioning({
+        type: VersioningType.CUSTOM,
+        extractor,
+      });
+    });
+
+    it(`forRoutes({ path: '/versioned', version: '1', method: RequestMethod.ALL })`, () => {
+      return request(app.getHttpServer())
+        .get('/versioned')
+        .expect(200, VERSIONED_VALUE);
+    });
+  });
+
+  afterEach(async () => {
+    await app.close();
+  });
+});
+
+async function createAppWithVersioning(
+  versioningOptions: VersioningOptions,
+  beforeInit?: (app: INestApplication) => Promise<void>,
+): Promise<INestApplication> {
+  const app = (
+    await Test.createTestingModule({
+      imports: [TestModule],
+    }).compile()
+  ).createNestApplication();
+
+  app.enableVersioning(versioningOptions);
+  if (beforeInit) {
+    await beforeInit(app);
+  }
+  await app.init();
+
+  return app;
+}
diff --git a/integration/hello-world/e2e/middleware.spec.ts b/integration/hello-world/e2e/middleware.spec.ts
index d6347464f..4d0fb315b 100644
--- a/integration/hello-world/e2e/middleware.spec.ts
+++ b/integration/hello-world/e2e/middleware.spec.ts
@@ -7,11 +7,12 @@ import {
 } from '@nestjs/common';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 const RETURN_VALUE = 'test';
 const SCOPED_VALUE = 'test_scoped';
 const WILDCARD_VALUE = 'test_wildcard';
+const EXCLUDE_VALUE = 'test_exclude';
 
 @Controller()
 class TestController {
@@ -24,10 +25,15 @@ class TestController {
   wildcard_nested() {
     return RETURN_VALUE;
   }
+
+  @Get('exclude')
+  exclude() {
+    return EXCLUDE_VALUE;
+  }
 }
 
 @Module({
-  imports: [ApplicationModule],
+  imports: [AppModule],
   controllers: [TestController],
 })
 class TestModule {
@@ -36,8 +42,10 @@ class TestModule {
       .apply((req, res, next) => res.send(WILDCARD_VALUE))
       .forRoutes('tests/*')
       .apply((req, res, next) => res.send(SCOPED_VALUE))
+      .exclude('exclude')
       .forRoutes(TestController)
       .apply((req, res, next) => res.send(RETURN_VALUE))
+      .exclude('exclude')
       .forRoutes('*');
   }
 }
@@ -45,25 +53,34 @@ class TestModule {
 describe('Middleware', () => {
   let app: INestApplication;
 
-  beforeEach(async () => {
-    app = (
-      await Test.createTestingModule({
-        imports: [TestModule],
-      }).compile()
-    ).createNestApplication();
-
-    await app.init();
+  it(`forRoutes(*)`, async () => {
+    app = await createApp();
+    await request(app.getHttpServer()).get('/hello').expect(200, RETURN_VALUE);
+    await request(app.getHttpServer())
+      .get('/exclude')
+      .expect(200, EXCLUDE_VALUE);
   });
 
-  it(`forRoutes(*)`, () => {
-    return request(app.getHttpServer()).get('/hello').expect(200, RETURN_VALUE);
+  it(`forRoutes(*) with global prefix`, async () => {
+    app = await createApp(app => app.setGlobalPrefix('api'));
+    await request(app.getHttpServer())
+      .get('/api/hello')
+      .expect(200, RETURN_VALUE);
+    await request(app.getHttpServer())
+      .get('/api/exclude')
+      .expect(200, EXCLUDE_VALUE);
   });
 
-  it(`forRoutes(TestController)`, () => {
-    return request(app.getHttpServer()).get('/test').expect(200, SCOPED_VALUE);
+  it(`forRoutes(TestController)`, async () => {
+    app = await createApp();
+    await request(app.getHttpServer()).get('/test').expect(200, SCOPED_VALUE);
+    await request(app.getHttpServer())
+      .get('/exclude')
+      .expect(200, EXCLUDE_VALUE);
   });
 
-  it(`forRoutes(tests/*)`, () => {
+  it(`forRoutes(tests/*)`, async () => {
+    app = await createApp();
     return request(app.getHttpServer())
       .get('/tests/wildcard')
       .expect(200, WILDCARD_VALUE);
@@ -73,3 +90,20 @@ describe('Middleware', () => {
     await app.close();
   });
 });
+
+async function createApp(
+  beforeInit?: (app: INestApplication) => void,
+): Promise<INestApplication> {
+  const app = (
+    await Test.createTestingModule({
+      imports: [TestModule],
+    }).compile()
+  ).createNestApplication();
+
+  if (beforeInit) {
+    beforeInit(app);
+  }
+  await app.init();
+
+  return app;
+}
diff --git a/integration/hello-world/e2e/router-module-middleware.spec.ts b/integration/hello-world/e2e/router-module-middleware.spec.ts
index bc386e404..52fe55ced 100644
--- a/integration/hello-world/e2e/router-module-middleware.spec.ts
+++ b/integration/hello-world/e2e/router-module-middleware.spec.ts
@@ -8,7 +8,7 @@ import {
 import { RouterModule } from '@nestjs/core';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 const RETURN_VALUE = 'test';
 const SCOPED_VALUE = 'test_scoped';
@@ -27,7 +27,7 @@ class TestController {
 }
 
 @Module({
-  imports: [ApplicationModule],
+  imports: [AppModule],
   controllers: [TestController],
 })
 class TestModule {
diff --git a/integration/hello-world/src/app.module.ts b/integration/hello-world/src/app.module.ts
index 982d6c65f..b34bf1cfe 100644
--- a/integration/hello-world/src/app.module.ts
+++ b/integration/hello-world/src/app.module.ts
@@ -6,4 +6,4 @@ import { HostModule } from './host/host.module';
 @Module({
   imports: [HelloModule, HostModule, HostArrayModule],
 })
-export class ApplicationModule {}
+export class AppModule {}
diff --git a/integration/hello-world/src/errors/errors.controller.ts b/integration/hello-world/src/errors/errors.controller.ts
index 76f867bb7..7b2b9e1b8 100644
--- a/integration/hello-world/src/errors/errors.controller.ts
+++ b/integration/hello-world/src/errors/errors.controller.ts
@@ -1,4 +1,4 @@
-import { BadRequestException, Controller, Get } from '@nestjs/common';
+import { BadRequestException, Controller, Get, Header } from '@nestjs/common';
 
 @Controller()
 export class ErrorsController {
@@ -12,6 +12,12 @@ export class ErrorsController {
     this.throwError();
   }
 
+  @Get('unexpected-error')
+  @Header('Content-Type', 'application/pdf')
+  unexpectedError() {
+    throw new Error();
+  }
+
   throwError() {
     throw new BadRequestException({
       statusCode: 400,
diff --git a/integration/hello-world/src/host-array/host-array.controller.ts b/integration/hello-world/src/host-array/host-array.controller.ts
index 089cf51b3..8f6456bef 100644
--- a/integration/hello-world/src/host-array/host-array.controller.ts
+++ b/integration/hello-world/src/host-array/host-array.controller.ts
@@ -18,7 +18,7 @@ export class HostArrayController {
 
   @Get('async')
   async asyncGreeting(@HostParam('tenant') tenant: string): Promise<string> {
-    return `${await this.hostService.greeting()} tenant=${tenant}`;
+    return `${this.hostService.greeting()} tenant=${tenant}`;
   }
 
   @Get('stream')
diff --git a/integration/hello-world/src/host/host.controller.ts b/integration/hello-world/src/host/host.controller.ts
index 60e9a5e64..8501d59eb 100644
--- a/integration/hello-world/src/host/host.controller.ts
+++ b/integration/hello-world/src/host/host.controller.ts
@@ -18,7 +18,7 @@ export class HostController {
 
   @Get('async')
   async asyncGreeting(@HostParam('tenant') tenant: string): Promise<string> {
-    return `${await this.hostService.greeting()} tenant=${tenant}`;
+    return `${this.hostService.greeting()} tenant=${tenant}`;
   }
 
   @Get('stream')
diff --git a/integration/hello-world/tsconfig.json b/integration/hello-world/tsconfig.json
index c6354c564..4a0f01e0e 100644
--- a/integration/hello-world/tsconfig.json
+++ b/integration/hello-world/tsconfig.json
@@ -7,10 +7,29 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "strictNullChecks": true,
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
diff --git a/integration/hooks/e2e/on-module-destroy.spec.ts b/integration/hooks/e2e/on-module-destroy.spec.ts
index d34c15f01..52468cebe 100644
--- a/integration/hooks/e2e/on-module-destroy.spec.ts
+++ b/integration/hooks/e2e/on-module-destroy.spec.ts
@@ -43,10 +43,7 @@ describe('OnModuleDestroy', () => {
   it('should sort modules by distance (topological sort) - DESC order', async () => {
     @Injectable()
     class BB implements OnModuleDestroy {
-      public field: string;
-      async onModuleDestroy() {
-        this.field = 'b-field';
-      }
+      onModuleDestroy = Sinon.spy();
     }
 
     @Module({
@@ -57,13 +54,10 @@ describe('OnModuleDestroy', () => {
 
     @Injectable()
     class AA implements OnModuleDestroy {
-      public field: string;
       constructor(private bb: BB) {}
-
-      async onModuleDestroy() {
-        this.field = this.bb.field + '_a-field';
-      }
+      onModuleDestroy = Sinon.spy();
     }
+
     @Module({
       imports: [B],
       providers: [AA],
@@ -78,7 +72,8 @@ describe('OnModuleDestroy', () => {
     await app.init();
     await app.close();
 
-    const instance = module.get(AA);
-    expect(instance.field).to.equal('b-field_a-field');
+    const aa = module.get(AA);
+    const bb = module.get(BB);
+    Sinon.assert.callOrder(aa.onModuleDestroy, bb.onModuleDestroy);
   });
 });
diff --git a/integration/hooks/e2e/on-module-init.spec.ts b/integration/hooks/e2e/on-module-init.spec.ts
index 462e26919..d35a22d69 100644
--- a/integration/hooks/e2e/on-module-init.spec.ts
+++ b/integration/hooks/e2e/on-module-init.spec.ts
@@ -39,11 +39,39 @@ describe('OnModuleInit', () => {
   });
 
   it('should sort modules by distance (topological sort) - DESC order', async () => {
+    @Injectable()
+    class CC implements OnModuleInit {
+      public field: string;
+
+      async onModuleInit() {
+        this.field = 'c-field';
+      }
+    }
+
+    @Module({})
+    class C {
+      static forRoot() {
+        return {
+          module: C,
+          global: true,
+          providers: [
+            {
+              provide: CC,
+              useValue: new CC(),
+            },
+          ],
+          exports: [CC],
+        };
+      }
+    }
+
     @Injectable()
     class BB implements OnModuleInit {
       public field: string;
+      constructor(private cc: CC) {}
+
       async onModuleInit() {
-        this.field = 'b-field';
+        this.field = this.cc.field + '_b-field';
       }
     }
 
@@ -68,14 +96,19 @@ describe('OnModuleInit', () => {
     })
     class A {}
 
+    @Module({
+      imports: [A, C.forRoot()],
+    })
+    class AppModule {}
+
     const module = await Test.createTestingModule({
-      imports: [A],
+      imports: [AppModule],
     }).compile();
 
     const app = module.createNestApplication();
     await app.init();
 
     const instance = module.get(AA);
-    expect(instance.field).to.equal('b-field_a-field');
+    expect(instance.field).to.equal('c-field_b-field_a-field');
   });
 });
diff --git a/integration/hooks/src/enable-shutdown-hooks-main.ts b/integration/hooks/src/enable-shutdown-hooks-main.ts
index 0d0172215..565b2d59f 100644
--- a/integration/hooks/src/enable-shutdown-hooks-main.ts
+++ b/integration/hooks/src/enable-shutdown-hooks-main.ts
@@ -39,4 +39,4 @@ async function bootstrap() {
   process.kill(process.pid, SIGNAL);
 }
 
-bootstrap();
+void bootstrap();
diff --git a/integration/hooks/tsconfig.json b/integration/hooks/tsconfig.json
index c6354c564..4a0f01e0e 100644
--- a/integration/hooks/tsconfig.json
+++ b/integration/hooks/tsconfig.json
@@ -7,10 +7,29 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "strictNullChecks": true,
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
diff --git a/integration/injector/e2e/circular-custom-providers.spec.ts b/integration/injector/e2e/circular-custom-providers.spec.ts
new file mode 100644
index 000000000..b05a95ea3
--- /dev/null
+++ b/integration/injector/e2e/circular-custom-providers.spec.ts
@@ -0,0 +1,63 @@
+import { Test } from '@nestjs/testing';
+import { expect } from 'chai';
+
+import { Controller, Injectable, Module } from '@nestjs/common';
+
+class B {}
+
+@Injectable()
+class A {
+  constructor(b: B) {}
+}
+
+@Injectable()
+class BImpl {
+  constructor(a: A) {}
+}
+
+@Controller()
+class AppController {
+  constructor(a: A) {}
+}
+
+@Module({
+  imports: [],
+  controllers: [AppController],
+  providers: [A, { provide: B, useClass: BImpl }],
+})
+export class AppModule {}
+
+describe('Circular custom providers', () => {
+  it('should throw an exception (useClass + regular provider)', async () => {
+    try {
+      const builder = Test.createTestingModule({
+        imports: [AppModule],
+      });
+      await builder.compile();
+
+      expect(true).to.be.eql(false);
+    } catch (err) {
+      expect(err.message).to.be.eql(
+        'A circular dependency has been detected inside "A". Please, make sure that each side of a bidirectional relationships are decorated with "forwardRef()". Note that circular relationships between custom providers (e.g., factories) are not supported since functions cannot be called more than once.',
+      );
+    }
+  });
+
+  it('should throw an exception (2 factories)', async () => {
+    try {
+      const builder = Test.createTestingModule({
+        providers: [
+          { provide: 'ABC', useFactory: () => ({}), inject: ['DEF'] },
+          { provide: 'DEF', useFactory: () => ({}), inject: ['ABC'] },
+        ],
+      });
+      await builder.compile();
+
+      expect(true).to.be.eql(false);
+    } catch (err) {
+      expect(err.message).to.be.eql(
+        'A circular dependency has been detected inside "ABC". Please, make sure that each side of a bidirectional relationships are decorated with "forwardRef()". Note that circular relationships between custom providers (e.g., factories) are not supported since functions cannot be called more than once.',
+      );
+    }
+  });
+});
diff --git a/integration/injector/e2e/injector.spec.ts b/integration/injector/e2e/injector.spec.ts
index 95208f618..5fd489676 100644
--- a/integration/injector/e2e/injector.spec.ts
+++ b/integration/injector/e2e/injector.spec.ts
@@ -1,7 +1,10 @@
 import { RuntimeException } from '@nestjs/core/errors/exceptions/runtime.exception';
+import { UnknownDependenciesException } from '@nestjs/core/errors/exceptions/unknown-dependencies.exception';
 import { UnknownExportException } from '@nestjs/core/errors/exceptions/unknown-export.exception';
 import { Test } from '@nestjs/testing';
 import { expect } from 'chai';
+import * as chai from 'chai';
+import * as chaiAsPromised from 'chai-as-promised';
 import {
   DYNAMIC_TOKEN,
   DYNAMIC_VALUE,
@@ -9,6 +12,13 @@ import {
 } from '../src/dynamic/dynamic.module';
 import { ExportsModule } from '../src/exports/exports.module';
 import { InjectModule } from '../src/inject/inject.module';
+import { InjectSameNameModule } from '../src/inject/inject-same-name.module';
+import {
+  SelfInjectionProviderModule,
+  SelfInjectionProviderCustomTokenModule,
+  SelfInjectionForwardProviderModule,
+} from '../src/self-injection/self-injection-provider.module';
+chai.use(chaiAsPromised);
 
 describe('Injector', () => {
   describe('when "providers" and "exports" properties are inconsistent', () => {
@@ -24,6 +34,16 @@ describe('Injector', () => {
     });
   });
 
+  describe("When class injects a provider with the same as class's name", () => {
+    it('should compile with success', async () => {
+      const builder = Test.createTestingModule({
+        imports: [InjectSameNameModule],
+      });
+
+      await expect(builder.compile()).to.eventually.be.fulfilled;
+    });
+  });
+
   describe('when Nest cannot resolve dependencies', () => {
     it(`should fail with "RuntimeException"`, async () => {
       try {
@@ -35,6 +55,42 @@ describe('Injector', () => {
         expect(err).to.be.instanceof(RuntimeException);
       }
     });
+
+    describe('due to self-injection providers', () => {
+      it('should fail with "UnknownDependenciesException" due to self-injection via same class reference', async () => {
+        const builder = Test.createTestingModule({
+          imports: [SelfInjectionProviderModule],
+        });
+
+        await expect(
+          builder.compile(),
+        ).to.eventually.be.rejected.and.be.an.instanceOf(
+          UnknownDependenciesException,
+        );
+      });
+      it('should fail with "UnknownDependenciesException" due to self-injection via forwardRef to the same class reference', async () => {
+        const builder = Test.createTestingModule({
+          imports: [SelfInjectionForwardProviderModule],
+        });
+
+        await expect(
+          builder.compile(),
+        ).to.eventually.be.rejected.and.be.an.instanceOf(
+          UnknownDependenciesException,
+        );
+      });
+      it('should fail with "UnknownDependenciesException" due to self-injection via custom provider', async () => {
+        const builder = Test.createTestingModule({
+          imports: [SelfInjectionProviderCustomTokenModule],
+        });
+
+        await expect(
+          builder.compile(),
+        ).to.eventually.be.rejected.and.be.an.instanceOf(
+          UnknownDependenciesException,
+        );
+      });
+    });
   });
 
   describe('when dynamic module', () => {
diff --git a/integration/injector/e2e/multiple-providers.spec.ts b/integration/injector/e2e/multiple-providers.spec.ts
new file mode 100644
index 000000000..26daa0e43
--- /dev/null
+++ b/integration/injector/e2e/multiple-providers.spec.ts
@@ -0,0 +1,47 @@
+import { Test } from '@nestjs/testing';
+import { expect } from 'chai';
+import { MultipleProvidersModule } from '../src/multiple-providers/multiple-providers.module';
+
+describe('Multiple providers under the same token ("each" feature)', () => {
+  describe('get()', () => {
+    it('should return an array of providers', async () => {
+      const builder = Test.createTestingModule({
+        imports: [MultipleProvidersModule],
+      });
+      const testingModule = await builder.compile();
+
+      const multiProviderInstances = testingModule.get<string>(
+        'MULTI_PROVIDER',
+        {
+          each: true,
+        },
+      );
+
+      // @ts-expect-error: make sure "multiProviderInstances" is string[] not string
+      multiProviderInstances.charAt;
+
+      expect(multiProviderInstances).to.be.eql(['A', 'B', 'C']);
+    });
+  });
+  describe('resolve()', () => {
+    it('should return an array of providers', async () => {
+      const builder = Test.createTestingModule({
+        imports: [MultipleProvidersModule],
+      });
+      const testingModule = await builder.compile();
+
+      const multiProviderInstances = await testingModule.resolve<string>(
+        'REQ_SCOPED_MULTI_PROVIDER',
+        undefined,
+        {
+          each: true,
+        },
+      );
+
+      // @ts-expect-error: make sure "multiProviderInstances" is string[] not string
+      multiProviderInstances.charAt;
+
+      expect(multiProviderInstances).to.be.eql(['A', 'B', 'C']);
+    });
+  });
+});
diff --git a/integration/injector/e2e/optional-factory-provider-dep.spec.ts b/integration/injector/e2e/optional-factory-provider-dep.spec.ts
new file mode 100644
index 000000000..22566f1d4
--- /dev/null
+++ b/integration/injector/e2e/optional-factory-provider-dep.spec.ts
@@ -0,0 +1,134 @@
+import { Scope } from '@nestjs/common';
+import { UnknownDependenciesException } from '@nestjs/core/errors/exceptions/unknown-dependencies.exception';
+import { Test } from '@nestjs/testing';
+import { expect } from 'chai';
+
+describe('Optional factory provider deps', () => {
+  describe('when dependency is optional', () => {
+    describe('and it is available', () => {
+      it('then it should be injected into the factory function', async () => {
+        const defaultValue = 'DEFAULT_VALUE';
+        const moduleRef = await Test.createTestingModule({
+          providers: [
+            {
+              provide: 'FACTORY',
+              useFactory: dep => dep ?? defaultValue,
+              inject: [{ token: 'MISSING_DEP', optional: true }],
+            },
+            { provide: 'MISSING_DEP', useValue: 'OPTIONAL_DEP_VALUE' },
+          ],
+        }).compile();
+
+        const factoryProvider = moduleRef.get('FACTORY');
+        expect(factoryProvider).to.equal('OPTIONAL_DEP_VALUE');
+      });
+    });
+    describe('otherwise', () => {
+      it('"undefined" should be injected into the factory function', async () => {
+        const defaultValue = 'DEFAULT_VALUE';
+        const moduleRef = await Test.createTestingModule({
+          providers: [
+            {
+              provide: 'FACTORY',
+              useFactory: dep => dep ?? defaultValue,
+              inject: [{ token: 'MISSING_DEP', optional: true }],
+            },
+          ],
+        }).compile();
+
+        const factoryProvider = moduleRef.get('FACTORY');
+        expect(factoryProvider).to.equal(defaultValue);
+      });
+      it('"undefined" should be injected into the factory function (scoped provider)', async () => {
+        const MY_PROVIDER = 'MY_PROVIDER';
+        const FIRST_OPTIONAL_DEPENDENCY = 'FIRST_OPTIONAL_DEPENDENCY';
+        const SECOND_OPTIONAL_DEPENDENCY = 'SECOND_OPTIONAL_DEPENDENCY';
+
+        const module = await Test.createTestingModule({
+          providers: [
+            {
+              provide: SECOND_OPTIONAL_DEPENDENCY,
+              useValue: 'second',
+            },
+            {
+              provide: MY_PROVIDER,
+              scope: Scope.REQUEST,
+              inject: [
+                {
+                  token: FIRST_OPTIONAL_DEPENDENCY,
+                  optional: true,
+                },
+                {
+                  token: SECOND_OPTIONAL_DEPENDENCY,
+                  optional: true,
+                },
+              ],
+              useFactory: (first?: string, second?: string) => {
+                return { first, second };
+              },
+            },
+          ],
+        }).compile();
+
+        expect(await module.resolve(MY_PROVIDER)).to.deep.equal({
+          first: undefined,
+          second: 'second',
+        });
+      });
+    });
+  });
+  describe('otherwise', () => {
+    describe('and dependency is not registered', () => {
+      it('should error out', async () => {
+        try {
+          const builder = Test.createTestingModule({
+            providers: [
+              {
+                provide: 'FACTORY',
+                useFactory: () => 'RETURNED_VALUE',
+                inject: ['MISSING_DEP'],
+              },
+            ],
+          });
+          await builder.compile();
+        } catch (err) {
+          expect(err).to.be.instanceOf(UnknownDependenciesException);
+        }
+      });
+    });
+  });
+  describe('and dependency is registered but it cannot be instantiated', () => {
+    it('should error out', async () => {
+      try {
+        const builder = Test.createTestingModule({
+          providers: [
+            {
+              provide: 'POSSIBLY_MISSING_DEP',
+              useFactory: () => null,
+              inject: ['MISSING_DEP'],
+            },
+            {
+              provide: 'FACTORY',
+              useFactory: () => 'RETURNED_VALUE',
+              inject: [{ token: 'POSSIBLY_MISSING_DEP', optional: false }],
+            },
+          ],
+        });
+        await builder.compile();
+      } catch (err) {
+        expect(err).to.be.instanceOf(UnknownDependenciesException);
+        expect(err.message).to
+          .equal(`Nest can't resolve dependencies of the POSSIBLY_MISSING_DEP (?). Please make sure that the argument "MISSING_DEP" at index [0] is available in the RootTestModule context.
+
+Potential solutions:
+- Is RootTestModule a valid NestJS module?
+- If "MISSING_DEP" is a provider, is it part of the current RootTestModule?
+- If "MISSING_DEP" is exported from a separate @Module, is that module imported within RootTestModule?
+  @Module({
+    imports: [ /* the Module containing "MISSING_DEP" */ ]
+  })
+`);
+      }
+    });
+  });
+});
diff --git a/integration/injector/src/circular-structure-dynamic-module/circular.module.ts b/integration/injector/src/circular-structure-dynamic-module/circular.module.ts
index 3833f0d3b..6172fb2c5 100644
--- a/integration/injector/src/circular-structure-dynamic-module/circular.module.ts
+++ b/integration/injector/src/circular-structure-dynamic-module/circular.module.ts
@@ -6,7 +6,7 @@ export class CircularModule {
     const a = {
       module: CircularModule,
       providers: [InputService],
-      b: null,
+      b: null as any,
     };
     a.b = a;
     return a;
diff --git a/integration/injector/src/inject/inject-same-name.module.ts b/integration/injector/src/inject/inject-same-name.module.ts
new file mode 100644
index 000000000..f66fd51a7
--- /dev/null
+++ b/integration/injector/src/inject/inject-same-name.module.ts
@@ -0,0 +1,16 @@
+import { Module, Injectable, Inject } from '@nestjs/common';
+
+@Injectable()
+class CoreService {
+  constructor(@Inject(CoreService.name) private readonly coreService: any) {}
+}
+
+@Module({
+  providers: [
+    {
+      provide: CoreService.name,
+      useValue: 'anything',
+    },
+  ],
+})
+export class InjectSameNameModule {}
diff --git a/integration/injector/src/multiple-providers/a.module.ts b/integration/injector/src/multiple-providers/a.module.ts
new file mode 100644
index 000000000..95ae5eea1
--- /dev/null
+++ b/integration/injector/src/multiple-providers/a.module.ts
@@ -0,0 +1,16 @@
+import { Module, Scope } from '@nestjs/common';
+
+@Module({
+  providers: [
+    {
+      provide: 'MULTI_PROVIDER',
+      useValue: 'A',
+    },
+    {
+      provide: 'REQ_SCOPED_MULTI_PROVIDER',
+      useFactory: () => 'A',
+      scope: Scope.REQUEST,
+    },
+  ],
+})
+export class AModule {}
diff --git a/integration/injector/src/multiple-providers/b.module.ts b/integration/injector/src/multiple-providers/b.module.ts
new file mode 100644
index 000000000..1ed8ac423
--- /dev/null
+++ b/integration/injector/src/multiple-providers/b.module.ts
@@ -0,0 +1,16 @@
+import { Module, Scope } from '@nestjs/common';
+
+@Module({
+  providers: [
+    {
+      provide: 'MULTI_PROVIDER',
+      useValue: 'B',
+    },
+    {
+      provide: 'REQ_SCOPED_MULTI_PROVIDER',
+      useFactory: () => 'B',
+      scope: Scope.REQUEST,
+    },
+  ],
+})
+export class BModule {}
diff --git a/integration/injector/src/multiple-providers/c.module.ts b/integration/injector/src/multiple-providers/c.module.ts
new file mode 100644
index 000000000..4def2a71a
--- /dev/null
+++ b/integration/injector/src/multiple-providers/c.module.ts
@@ -0,0 +1,16 @@
+import { Module, Scope } from '@nestjs/common';
+
+@Module({
+  providers: [
+    {
+      provide: 'MULTI_PROVIDER',
+      useValue: 'C',
+    },
+    {
+      provide: 'REQ_SCOPED_MULTI_PROVIDER',
+      useFactory: () => 'C',
+      scope: Scope.REQUEST,
+    },
+  ],
+})
+export class CModule {}
diff --git a/integration/injector/src/multiple-providers/multiple-providers.module.ts b/integration/injector/src/multiple-providers/multiple-providers.module.ts
new file mode 100644
index 000000000..1bb2345ee
--- /dev/null
+++ b/integration/injector/src/multiple-providers/multiple-providers.module.ts
@@ -0,0 +1,9 @@
+import { Module } from '@nestjs/common';
+import { AModule } from './a.module';
+import { BModule } from './b.module';
+import { CModule } from './c.module';
+
+@Module({
+  imports: [AModule, BModule, CModule],
+})
+export class MultipleProvidersModule {}
diff --git a/integration/injector/src/self-injection/self-injection-provider.module.ts b/integration/injector/src/self-injection/self-injection-provider.module.ts
new file mode 100644
index 000000000..1dcf6eecb
--- /dev/null
+++ b/integration/injector/src/self-injection/self-injection-provider.module.ts
@@ -0,0 +1,40 @@
+import { Module, Injectable, Inject, forwardRef } from '@nestjs/common';
+
+@Injectable()
+class ServiceInjectingItself {
+  constructor(private readonly coreService: ServiceInjectingItself) {}
+}
+
+@Injectable()
+class ServiceInjectingItselfForward {
+  constructor(
+    @Inject(forwardRef(() => ServiceInjectingItself))
+    private readonly coreService: ServiceInjectingItself,
+  ) {}
+}
+
+@Injectable()
+class ServiceInjectingItselfViaCustomToken {
+  constructor(@Inject('AnotherToken') private readonly coreService: any) {}
+}
+
+@Module({
+  providers: [ServiceInjectingItself],
+})
+export class SelfInjectionProviderModule {}
+
+@Module({
+  providers: [ServiceInjectingItselfForward],
+})
+export class SelfInjectionForwardProviderModule {}
+
+@Module({
+  providers: [
+    ServiceInjectingItselfViaCustomToken,
+    {
+      provide: 'AnotherToken',
+      useClass: ServiceInjectingItselfViaCustomToken,
+    },
+  ],
+})
+export class SelfInjectionProviderCustomTokenModule {}
diff --git a/integration/injector/tsconfig.json b/integration/injector/tsconfig.json
index c6354c564..4a0f01e0e 100644
--- a/integration/injector/tsconfig.json
+++ b/integration/injector/tsconfig.json
@@ -7,10 +7,29 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "strictNullChecks": true,
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
diff --git a/integration/inspector/e2e/fixtures/post-init-graph.json b/integration/inspector/e2e/fixtures/post-init-graph.json
new file mode 100644
index 000000000..be476d57e
--- /dev/null
+++ b/integration/inspector/e2e/fixtures/post-init-graph.json
@@ -0,0 +1,3142 @@
+{
+  "nodes": {
+    "18347652": {
+      "id": "18347652",
+      "label": "LoggingInterceptor",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "injectable",
+        "internal": false,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "LoggingInterceptor",
+        "subtype": "interceptor",
+        "initTime": 0
+      }
+    },
+    "55510001": {
+      "id": "55510001",
+      "label": "UsersService",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "UsersService",
+        "initTime": 0
+      }
+    },
+    "91819333": {
+      "id": "91819333",
+      "label": "ModuleRef",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "203550704": {
+      "id": "203550704",
+      "label": "ExternalContextCreator",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": true,
+        "token": "ExternalContextCreator",
+        "initTime": 0
+      }
+    },
+    "208171089": {
+      "id": "208171089",
+      "label": "RolesGuard",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "injectable",
+        "internal": false,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "RolesGuard",
+        "subtype": "guard",
+        "initTime": 0
+      }
+    },
+    "225063248": {
+      "id": "225063248",
+      "label": "InternalCoreModule",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "InternalCoreModule",
+        "initTime": 0
+      }
+    },
+    "256260345": {
+      "id": "256260345",
+      "label": "ApplicationConfig",
+      "parent": "1528017428",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DatabaseModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "345516396": {
+      "id": "345516396",
+      "label": "ApplicationConfig",
+      "parent": "1142369607",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelperModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "345719894": {
+      "id": "345719894",
+      "label": "CoreModule",
+      "parent": "-1125887048",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "CoreModule",
+        "initTime": 0
+      }
+    },
+    "437945905": {
+      "id": "437945905",
+      "label": "ApplicationConfig",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "519735830": {
+      "id": "519735830",
+      "label": "ApplicationConfig",
+      "parent": "-493958991",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ChatModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "521671888": {
+      "id": "521671888",
+      "label": "DogsModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "555176277": {
+      "id": "555176277",
+      "label": "InternalCoreModule",
+      "metadata": {
+        "type": "module",
+        "global": true,
+        "dynamic": true,
+        "internal": true
+      }
+    },
+    "594986539": {
+      "id": "594986539",
+      "label": "InputService",
+      "parent": "-1813741655",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "InputModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": true,
+        "token": "InputService",
+        "initTime": 0
+      }
+    },
+    "603011239": {
+      "id": "603011239",
+      "label": "UsersService",
+      "parent": "-2003726489",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "UsersModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "UsersService",
+        "initTime": 0
+      }
+    },
+    "671882984": {
+      "id": "671882984",
+      "label": "Reflector",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": true,
+        "token": "Reflector",
+        "initTime": 0
+      }
+    },
+    "791004148": {
+      "id": "791004148",
+      "label": "ExternalSvcModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "867482265": {
+      "id": "867482265",
+      "label": "Interceptor",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "injectable",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "Interceptor",
+        "subtype": "interceptor",
+        "initTime": 0
+      }
+    },
+    "927096496": {
+      "id": "927096496",
+      "label": "ApplicationConfig",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "928565345": {
+      "id": "928565345",
+      "label": "HelperService",
+      "parent": "1142369607",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "HelperModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": true,
+        "token": "HelperService",
+        "initTime": 0
+      }
+    },
+    "941957564": {
+      "id": "941957564",
+      "label": "RequestChainModule",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "RequestChainModule",
+        "initTime": 0
+      }
+    },
+    "980514911": {
+      "id": "980514911",
+      "label": "Symbol(token)",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "Symbol(token)"
+      }
+    },
+    "1004276345": {
+      "id": "1004276345",
+      "label": "Meta",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "META",
+        "initTime": 0
+      }
+    },
+    "1010833816": {
+      "id": "1010833816",
+      "label": "token",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "token"
+      }
+    },
+    "1047229654": {
+      "id": "1047229654",
+      "label": "CircularModule",
+      "parent": "-369869768",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CircularModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "CircularModule",
+        "initTime": 0
+      }
+    },
+    "1074192353": {
+      "id": "1074192353",
+      "label": "ChatService",
+      "parent": "-493958991",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "ChatModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "ChatService",
+        "initTime": 0
+      }
+    },
+    "1120316353": {
+      "id": "1120316353",
+      "label": "ModuleRef",
+      "parent": "1142369607",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelperModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "1131051184": {
+      "id": "1131051184",
+      "label": "ChatGateway",
+      "parent": "-493958991",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "ChatModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "ChatGateway",
+        "initTime": 0
+      }
+    },
+    "1142369607": {
+      "id": "1142369607",
+      "label": "HelperModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "1189153544": {
+      "id": "1189153544",
+      "label": "ChatModule",
+      "parent": "-493958991",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ChatModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ChatModule",
+        "initTime": 0
+      }
+    },
+    "1253818496": {
+      "id": "1253818496",
+      "label": "RootTestModule",
+      "parent": "-1251270035",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RootTestModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "RootTestModule",
+        "initTime": 0
+      }
+    },
+    "1433815174": {
+      "id": "1433815174",
+      "label": "DogsModule",
+      "parent": "521671888",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DogsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "DogsModule",
+        "initTime": 0
+      }
+    },
+    "1434441974": {
+      "id": "1434441974",
+      "label": "CatsModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "1434456218": {
+      "id": "1434456218",
+      "label": "Reflector",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": true,
+        "token": "Reflector",
+        "initTime": 0
+      }
+    },
+    "1472486160": {
+      "id": "1472486160",
+      "label": "HelloController",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "HelloController",
+        "initTime": 0,
+        "enhancers": [
+          {
+            "id": "-2010060263",
+            "methodKey": "greeting",
+            "subtype": "guard"
+          },
+          {
+            "id": "867482265",
+            "methodKey": "greeting",
+            "subtype": "interceptor"
+          },
+          {
+            "id": "1893794611",
+            "methodKey": "greeting",
+            "subtype": "pipe"
+          }
+        ]
+      }
+    },
+    "1528017428": {
+      "id": "1528017428",
+      "label": "DatabaseModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "1535366709": {
+      "id": "1535366709",
+      "label": "ApplicationConfig",
+      "parent": "521671888",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DogsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "1551182002": {
+      "id": "1551182002",
+      "label": "ModuleRef",
+      "parent": "-1125887048",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "1616075090": {
+      "id": "1616075090",
+      "label": "CatsModule",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "CatsModule",
+        "initTime": 0
+      }
+    },
+    "1634859874": {
+      "id": "1634859874",
+      "label": "LoggerMiddleware",
+      "parent": "-1125887048",
+      "metadata": {
+        "type": "middleware",
+        "internal": false,
+        "sourceModuleName": "CoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "LoggerMiddleware",
+        "initTime": 0
+      }
+    },
+    "1743739569": {
+      "id": "1743739569",
+      "label": "HelloModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": true,
+        "internal": false
+      }
+    },
+    "1771940178": {
+      "id": "1771940178",
+      "label": "ApplicationConfig",
+      "parent": "-1251270035",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RootTestModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "1809676814": {
+      "id": "1809676814",
+      "label": "ModuleRef",
+      "parent": "1528017428",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DatabaseModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "1893794611": {
+      "id": "1893794611",
+      "label": "UserByIdPipe",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "injectable",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "UserByIdPipe",
+        "subtype": "pipe",
+        "initTime": 0
+      }
+    },
+    "1919157847": {
+      "id": "1919157847",
+      "label": "REQUEST",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": true,
+        "token": "REQUEST",
+        "initTime": 0
+      }
+    },
+    "2018972420": {
+      "id": "2018972420",
+      "label": "TransformInterceptor",
+      "parent": "-1125887048",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "CoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "APP_INTERCEPTOR (UUID: -1146749753)",
+        "subtype": "interceptor",
+        "initTime": 0,
+        "global": true
+      }
+    },
+    "2133316171": {
+      "id": "2133316171",
+      "label": "RequestChainModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-1486320561": {
+      "id": "-1486320561",
+      "label": "ModuleRef",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-651043398": {
+      "id": "-651043398",
+      "label": "ApplicationConfig",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-255469305": {
+      "id": "-255469305",
+      "label": "INQUIRER",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 1,
+        "transient": true,
+        "exported": true,
+        "token": "INQUIRER",
+        "initTime": 0
+      }
+    },
+    "-26938366": {
+      "id": "-26938366",
+      "label": "ModulesContainer",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": true,
+        "token": "ModulesContainer",
+        "initTime": 0
+      }
+    },
+    "-326832201": {
+      "id": "-326832201",
+      "label": "HttpAdapterHost",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": true,
+        "token": "HttpAdapterHost",
+        "initTime": 0
+      }
+    },
+    "-702581189": {
+      "id": "-702581189",
+      "label": "LazyModuleLoader",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": true,
+        "token": "LazyModuleLoader",
+        "initTime": 0
+      }
+    },
+    "-1904419534": {
+      "id": "-1904419534",
+      "label": "SerializedGraph",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": true,
+        "token": "SerializedGraph",
+        "initTime": 0
+      }
+    },
+    "-1251270035": {
+      "id": "-1251270035",
+      "label": "RootTestModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-969610649": {
+      "id": "-969610649",
+      "label": "ModuleRef",
+      "parent": "-1251270035",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RootTestModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-19112576": {
+      "id": "-19112576",
+      "label": "AppModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-2139588960": {
+      "id": "-2139588960",
+      "label": "AppModule",
+      "parent": "-19112576",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "AppModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "AppModule",
+        "initTime": 0
+      }
+    },
+    "-71302842": {
+      "id": "-71302842",
+      "label": "ModuleRef",
+      "parent": "-19112576",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "AppModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-2064622725": {
+      "id": "-2064622725",
+      "label": "ApplicationConfig",
+      "parent": "-19112576",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "AppModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-365265483": {
+      "id": "-365265483",
+      "label": "AppV1Controller",
+      "parent": "-19112576",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "AppModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "AppV1Controller",
+        "initTime": 0
+      }
+    },
+    "-774089708": {
+      "id": "-774089708",
+      "label": "AppV2Controller",
+      "parent": "-19112576",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "AppModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "AppV2Controller",
+        "initTime": 0
+      }
+    },
+    "-1125887048": {
+      "id": "-1125887048",
+      "label": "CoreModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-112192227": {
+      "id": "-112192227",
+      "label": "ApplicationConfig",
+      "parent": "-1125887048",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-2007711503": {
+      "id": "-2007711503",
+      "label": "LoggingInterceptor",
+      "parent": "-1125887048",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "CoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "APP_INTERCEPTOR (UUID: 1780085433)",
+        "subtype": "interceptor",
+        "initTime": 0,
+        "global": true
+      }
+    },
+    "-183456272": {
+      "id": "-183456272",
+      "label": "ModuleRef",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-1846830501": {
+      "id": "-1846830501",
+      "label": "ApplicationConfig",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-593595711": {
+      "id": "-593595711",
+      "label": "CatsService",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "CatsService",
+        "initTime": 0
+      }
+    },
+    "-1550892030": {
+      "id": "-1550892030",
+      "label": "CatsController",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "CatsController",
+        "initTime": 0,
+        "enhancers": [
+          {
+            "id": "208171089",
+            "subtype": "guard"
+          },
+          {
+            "name": "ParseIntPipe",
+            "methodKey": "findOne",
+            "subtype": "pipe"
+          }
+        ]
+      }
+    },
+    "-1378706112": {
+      "id": "-1378706112",
+      "label": "HelloModule",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "HelloModule",
+        "initTime": 0
+      }
+    },
+    "-1166465801": {
+      "id": "-1166465801",
+      "label": "ModuleRef",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-1191459348": {
+      "id": "-1191459348",
+      "label": "ApplicationConfig",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-1758187461": {
+      "id": "-1758187461",
+      "label": "HelloService",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "HelloService",
+        "initTime": 0
+      }
+    },
+    "-2010060263": {
+      "id": "-2010060263",
+      "label": "Guard",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "injectable",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "Guard",
+        "subtype": "guard",
+        "initTime": 0
+      }
+    },
+    "-1124392646": {
+      "id": "-1124392646",
+      "label": "DurableModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-522935456": {
+      "id": "-522935456",
+      "label": "DurableModule",
+      "parent": "-1124392646",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DurableModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "DurableModule",
+        "initTime": 0
+      }
+    },
+    "-1808043520": {
+      "id": "-1808043520",
+      "label": "ModuleRef",
+      "parent": "-1124392646",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DurableModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-57038411": {
+      "id": "-57038411",
+      "label": "ApplicationConfig",
+      "parent": "-1124392646",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DurableModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-1673986099": {
+      "id": "-1673986099",
+      "label": "DurableService",
+      "parent": "-1124392646",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "DurableModule",
+        "durable": true,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "DurableService",
+        "initTime": 0
+      }
+    },
+    "-848516688": {
+      "id": "-848516688",
+      "label": "DurableController",
+      "parent": "-1124392646",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "DurableModule",
+        "durable": true,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "DurableController",
+        "initTime": 0
+      }
+    },
+    "-1096226358": {
+      "id": "-1096226358",
+      "label": "ModuleRef",
+      "parent": "521671888",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DogsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-335387007": {
+      "id": "-335387007",
+      "label": "DogsService",
+      "parent": "521671888",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "DogsModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "DogsService",
+        "initTime": 0
+      }
+    },
+    "-1558907338": {
+      "id": "-1558907338",
+      "label": "DogsController",
+      "parent": "521671888",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "DogsModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "DogsController",
+        "initTime": 0
+      }
+    },
+    "-2003726489": {
+      "id": "-2003726489",
+      "label": "UsersModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-495603840": {
+      "id": "-495603840",
+      "label": "UsersModule",
+      "parent": "-2003726489",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "UsersModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "UsersModule",
+        "initTime": 0
+      }
+    },
+    "-618964563": {
+      "id": "-618964563",
+      "label": "ModuleRef",
+      "parent": "-2003726489",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "UsersModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-643958110": {
+      "id": "-643958110",
+      "label": "ApplicationConfig",
+      "parent": "-2003726489",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "UsersModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-1102473136": {
+      "id": "-1102473136",
+      "label": "UsersController",
+      "parent": "-2003726489",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "UsersModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "UsersController",
+        "initTime": 0
+      }
+    },
+    "-1098322034": {
+      "id": "-1098322034",
+      "label": "DatabaseModule",
+      "parent": "1528017428",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DatabaseModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "DatabaseModule",
+        "initTime": 0
+      }
+    },
+    "-616397055": {
+      "id": "-616397055",
+      "label": "DatabaseService",
+      "parent": "1528017428",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "DatabaseModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "DatabaseService",
+        "initTime": 0
+      }
+    },
+    "-377928898": {
+      "id": "-377928898",
+      "label": "DatabaseController",
+      "parent": "1528017428",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "DatabaseModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "DatabaseController",
+        "initTime": 0
+      }
+    },
+    "-511735264": {
+      "id": "-511735264",
+      "label": "ExternalSvcModule",
+      "parent": "791004148",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ExternalSvcModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ExternalSvcModule",
+        "initTime": 0
+      }
+    },
+    "-660323910": {
+      "id": "-660323910",
+      "label": "ModuleRef",
+      "parent": "791004148",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ExternalSvcModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-217737489": {
+      "id": "-217737489",
+      "label": "ApplicationConfig",
+      "parent": "791004148",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ExternalSvcModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-1902429503": {
+      "id": "-1902429503",
+      "label": "ExternalSvcService",
+      "parent": "791004148",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "ExternalSvcModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "ExternalSvcService",
+        "initTime": 0
+      }
+    },
+    "-349899408": {
+      "id": "-349899408",
+      "label": "ExternalSvcController",
+      "parent": "791004148",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "ExternalSvcModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "ExternalSvcController",
+        "initTime": 0
+      }
+    },
+    "-493958991": {
+      "id": "-493958991",
+      "label": "ChatModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-2111857237": {
+      "id": "-2111857237",
+      "label": "ModuleRef",
+      "parent": "-493958991",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ChatModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-234035039": {
+      "id": "-234035039",
+      "label": "RequestChainService",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "RequestChainService",
+        "initTime": 0
+      }
+    },
+    "-1927427604": {
+      "id": "-1927427604",
+      "label": "RequestChainController",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "RequestChainController",
+        "initTime": 0,
+        "enhancers": [
+          {
+            "id": "18347652",
+            "methodKey": "greeting",
+            "subtype": "interceptor"
+          }
+        ]
+      }
+    },
+    "-162987852": {
+      "id": "-162987852",
+      "label": "HelperModule",
+      "parent": "1142369607",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelperModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "HelperModule",
+        "initTime": 0
+      }
+    },
+    "-1469176692": {
+      "id": "-1469176692",
+      "label": "PropertiesModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-1501313730": {
+      "id": "-1501313730",
+      "label": "PropertiesModule",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "PropertiesModule",
+        "initTime": 0
+      }
+    },
+    "-1377446394": {
+      "id": "-1377446394",
+      "label": "ModuleRef",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-1494077847": {
+      "id": "-1494077847",
+      "label": "DependencyService",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "DependencyService",
+        "initTime": 0
+      }
+    },
+    "-1803759743": {
+      "id": "-1803759743",
+      "label": "PropertiesService",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "PropertiesService",
+        "initTime": 0
+      }
+    },
+    "-1813741655": {
+      "id": "-1813741655",
+      "label": "InputModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-2113121728": {
+      "id": "-2113121728",
+      "label": "InputModule",
+      "parent": "-1813741655",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InputModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "InputModule",
+        "initTime": 0
+      }
+    },
+    "-428979729": {
+      "id": "-428979729",
+      "label": "ModuleRef",
+      "parent": "-1813741655",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InputModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-453973276": {
+      "id": "-453973276",
+      "label": "ApplicationConfig",
+      "parent": "-1813741655",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InputModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-369869768": {
+      "id": "-369869768",
+      "label": "CircularModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-88210382": {
+      "id": "-88210382",
+      "label": "ModuleRef",
+      "parent": "-369869768",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CircularModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-1641626851": {
+      "id": "-1641626851",
+      "label": "ApplicationConfig",
+      "parent": "-369869768",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CircularModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-1721730431": {
+      "id": "-1721730431",
+      "label": "CircularService",
+      "parent": "-369869768",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "CircularModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": true,
+        "token": "CircularService",
+        "initTime": 0
+      }
+    }
+  },
+  "edges": {
+    "22193019": {
+      "source": "-19112576",
+      "target": "521671888",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "DogsModule"
+      },
+      "id": "22193019"
+    },
+    "33333764": {
+      "source": "791004148",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "ExternalSvcModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "33333764"
+    },
+    "40501732": {
+      "source": "521671888",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "DogsModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "40501732"
+    },
+    "73947303": {
+      "source": "-1813741655",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "InputModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "73947303"
+    },
+    "182501115": {
+      "source": "1434441974",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "CatsModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "182501115"
+    },
+    "189694679": {
+      "source": "1434456218",
+      "target": "671882984",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "InternalCoreModule",
+        "sourceClassName": "Reflector",
+        "targetClassName": "Reflector",
+        "sourceClassToken": "Reflector",
+        "targetClassToken": "Reflector",
+        "targetModuleName": "InternalCoreModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor",
+        "internal": true
+      },
+      "id": "189694679"
+    },
+    "231469845": {
+      "source": "-1803759743",
+      "target": "-1494077847",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "PropertiesModule",
+        "sourceClassName": "PropertiesService",
+        "targetClassName": "DependencyService",
+        "sourceClassToken": "PropertiesService",
+        "targetClassToken": "DependencyService",
+        "targetModuleName": "PropertiesModule",
+        "keyOrIndex": "service",
+        "injectionType": "property"
+      },
+      "id": "231469845"
+    },
+    "250652665": {
+      "source": "2133316171",
+      "target": "1142369607",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "RequestChainModule",
+        "targetModuleName": "HelperModule"
+      },
+      "id": "250652665"
+    },
+    "393939926": {
+      "source": "-1813741655",
+      "target": "-369869768",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "InputModule",
+        "targetModuleName": "CircularModule"
+      },
+      "id": "393939926"
+    },
+    "417363164": {
+      "source": "-1251270035",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "RootTestModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "417363164"
+    },
+    "469401997": {
+      "source": "-493958991",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "ChatModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "469401997"
+    },
+    "654001290": {
+      "source": "1472486160",
+      "target": "867482265",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloController",
+        "targetClassName": "Interceptor",
+        "sourceClassToken": "HelloController",
+        "targetClassToken": "Interceptor",
+        "targetModuleName": "HelloModule",
+        "injectionType": "decorator"
+      },
+      "id": "654001290"
+    },
+    "676175891": {
+      "source": "-1251270035",
+      "target": "-19112576",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "RootTestModule",
+        "targetModuleName": "AppModule"
+      },
+      "id": "676175891"
+    },
+    "800268760": {
+      "source": "-1102473136",
+      "target": "603011239",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "UsersModule",
+        "sourceClassName": "UsersController",
+        "targetClassName": "UsersService",
+        "sourceClassToken": "UsersController",
+        "targetClassToken": "UsersService",
+        "targetModuleName": "UsersModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "800268760"
+    },
+    "804987620": {
+      "source": "-19112576",
+      "target": "-1125887048",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "CoreModule"
+      },
+      "id": "804987620"
+    },
+    "807697929": {
+      "source": "-19112576",
+      "target": "1528017428",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "DatabaseModule"
+      },
+      "id": "807697929"
+    },
+    "966350248": {
+      "source": "1131051184",
+      "target": "1074192353",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "ChatModule",
+        "sourceClassName": "ChatGateway",
+        "targetClassName": "ChatService",
+        "sourceClassToken": "ChatGateway",
+        "targetClassToken": "ChatService",
+        "targetModuleName": "ChatModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "966350248"
+    },
+    "987755577": {
+      "source": "-2003726489",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "UsersModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "987755577"
+    },
+    "1056428433": {
+      "source": "-19112576",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "1056428433"
+    },
+    "1059069749": {
+      "source": "-1558907338",
+      "target": "-335387007",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "DogsModule",
+        "sourceClassName": "DogsController",
+        "targetClassName": "DogsService",
+        "sourceClassToken": "DogsController",
+        "targetClassToken": "DogsService",
+        "targetModuleName": "DogsModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1059069749"
+    },
+    "1142343545": {
+      "source": "-1758187461",
+      "target": "1004276345",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloService",
+        "targetClassName": "Meta",
+        "sourceClassToken": "HelloService",
+        "targetClassToken": "META",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1142343545"
+    },
+    "1178436405": {
+      "source": "1893794611",
+      "target": "55510001",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "UserByIdPipe",
+        "targetClassName": "UsersService",
+        "sourceClassToken": "UserByIdPipe",
+        "targetClassToken": "UsersService",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1178436405"
+    },
+    "1195474320": {
+      "source": "-369869768",
+      "target": "-1813741655",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "CircularModule",
+        "targetModuleName": "InputModule"
+      },
+      "id": "1195474320"
+    },
+    "1247743823": {
+      "source": "2133316171",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "RequestChainModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "1247743823"
+    },
+    "1325313063": {
+      "source": "-1927427604",
+      "target": "18347652",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "RequestChainModule",
+        "sourceClassName": "RequestChainController",
+        "targetClassName": "LoggingInterceptor",
+        "sourceClassToken": "RequestChainController",
+        "targetClassToken": "LoggingInterceptor",
+        "targetModuleName": "RequestChainModule",
+        "injectionType": "decorator"
+      },
+      "id": "1325313063"
+    },
+    "1497653915": {
+      "source": "55510001",
+      "target": "1004276345",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "UsersService",
+        "targetClassName": "Meta",
+        "sourceClassToken": "UsersService",
+        "targetClassToken": "META",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1497653915"
+    },
+    "1615322974": {
+      "source": "-1469176692",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "PropertiesModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "1615322974"
+    },
+    "1856016815": {
+      "source": "-1721730431",
+      "target": "594986539",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "CircularModule",
+        "sourceClassName": "CircularService",
+        "targetClassName": "InputService",
+        "sourceClassToken": "CircularService",
+        "targetClassToken": "InputService",
+        "targetModuleName": "InputModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1856016815"
+    },
+    "1900414743": {
+      "source": "1472486160",
+      "target": "1893794611",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloController",
+        "targetClassName": "UserByIdPipe",
+        "sourceClassToken": "HelloController",
+        "targetClassToken": "UserByIdPipe",
+        "targetModuleName": "HelloModule",
+        "injectionType": "decorator"
+      },
+      "id": "1900414743"
+    },
+    "1904579661": {
+      "source": "18347652",
+      "target": "928565345",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "RequestChainModule",
+        "sourceClassName": "LoggingInterceptor",
+        "targetClassName": "HelperService",
+        "sourceClassToken": "LoggingInterceptor",
+        "targetClassToken": "HelperService",
+        "targetModuleName": "HelperModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1904579661"
+    },
+    "1960203007": {
+      "source": "-1803759743",
+      "target": "980514911",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "PropertiesModule",
+        "sourceClassName": "PropertiesService",
+        "targetClassName": "Symbol(token)",
+        "sourceClassToken": "PropertiesService",
+        "targetClassToken": "Symbol(token)",
+        "targetModuleName": "PropertiesModule",
+        "keyOrIndex": "symbolToken",
+        "injectionType": "property"
+      },
+      "id": "1960203007"
+    },
+    "1976848738": {
+      "source": "1528017428",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "DatabaseModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "1976848738"
+    },
+    "-2105726668": {
+      "source": "-1803759743",
+      "target": "1010833816",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "PropertiesModule",
+        "sourceClassName": "PropertiesService",
+        "targetClassName": "token",
+        "sourceClassToken": "PropertiesService",
+        "targetClassToken": "token",
+        "targetModuleName": "PropertiesModule",
+        "keyOrIndex": "token",
+        "injectionType": "property"
+      },
+      "id": "-2105726668"
+    },
+    "-21463590": {
+      "source": "-1378706112",
+      "target": "1004276345",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloModule",
+        "targetClassName": "Meta",
+        "sourceClassToken": "HelloModule",
+        "targetClassToken": "META",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-21463590"
+    },
+    "-1657371464": {
+      "source": "-1673986099",
+      "target": "1919157847",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "DurableModule",
+        "sourceClassName": "DurableService",
+        "targetClassName": "REQUEST",
+        "sourceClassToken": "DurableService",
+        "targetClassToken": "REQUEST",
+        "targetModuleName": "InternalCoreModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor",
+        "internal": true
+      },
+      "id": "-1657371464"
+    },
+    "-1303681274": {
+      "source": "928565345",
+      "target": "1919157847",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelperModule",
+        "sourceClassName": "HelperService",
+        "targetClassName": "REQUEST",
+        "sourceClassToken": "HelperService",
+        "targetClassToken": "REQUEST",
+        "targetModuleName": "InternalCoreModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor",
+        "internal": true
+      },
+      "id": "-1303681274"
+    },
+    "-886102564": {
+      "source": "208171089",
+      "target": "671882984",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "CatsModule",
+        "sourceClassName": "RolesGuard",
+        "targetClassName": "Reflector",
+        "sourceClassToken": "RolesGuard",
+        "targetClassToken": "Reflector",
+        "targetModuleName": "InternalCoreModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor",
+        "internal": true
+      },
+      "id": "-886102564"
+    },
+    "-2003045613": {
+      "source": "-377928898",
+      "target": "-616397055",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "DatabaseModule",
+        "sourceClassName": "DatabaseController",
+        "targetClassName": "DatabaseService",
+        "sourceClassToken": "DatabaseController",
+        "targetClassToken": "DatabaseService",
+        "targetModuleName": "DatabaseModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-2003045613"
+    },
+    "-881420795": {
+      "source": "-349899408",
+      "target": "-1902429503",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "ExternalSvcModule",
+        "sourceClassName": "ExternalSvcController",
+        "targetClassName": "ExternalSvcService",
+        "sourceClassToken": "ExternalSvcController",
+        "targetClassToken": "ExternalSvcService",
+        "targetModuleName": "ExternalSvcModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-881420795"
+    },
+    "-831049991": {
+      "source": "594986539",
+      "target": "-1721730431",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "InputModule",
+        "sourceClassName": "InputService",
+        "targetClassName": "CircularService",
+        "sourceClassToken": "InputService",
+        "targetClassToken": "CircularService",
+        "targetModuleName": "CircularModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-831049991"
+    },
+    "-2146943494": {
+      "source": "-234035039",
+      "target": "928565345",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "RequestChainModule",
+        "sourceClassName": "RequestChainService",
+        "targetClassName": "HelperService",
+        "sourceClassToken": "RequestChainService",
+        "targetClassToken": "HelperService",
+        "targetModuleName": "HelperModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-2146943494"
+    },
+    "-1816180282": {
+      "source": "-848516688",
+      "target": "-1673986099",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "DurableModule",
+        "sourceClassName": "DurableController",
+        "targetClassName": "DurableService",
+        "sourceClassToken": "DurableController",
+        "targetClassToken": "DurableService",
+        "targetModuleName": "DurableModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-1816180282"
+    },
+    "-180350082": {
+      "source": "-1550892030",
+      "target": "-593595711",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "CatsModule",
+        "sourceClassName": "CatsController",
+        "targetClassName": "CatsService",
+        "sourceClassToken": "CatsController",
+        "targetClassToken": "CatsService",
+        "targetModuleName": "CatsModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-180350082"
+    },
+    "-1043628608": {
+      "source": "1472486160",
+      "target": "-1758187461",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloController",
+        "targetClassName": "HelloService",
+        "sourceClassToken": "HelloController",
+        "targetClassToken": "HelloService",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-1043628608"
+    },
+    "-1335121169": {
+      "source": "1472486160",
+      "target": "55510001",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloController",
+        "targetClassName": "UsersService",
+        "sourceClassToken": "HelloController",
+        "targetClassToken": "UsersService",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 1,
+        "injectionType": "constructor"
+      },
+      "id": "-1335121169"
+    },
+    "-296280311": {
+      "source": "-1927427604",
+      "target": "-234035039",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "RequestChainModule",
+        "sourceClassName": "RequestChainController",
+        "targetClassName": "RequestChainService",
+        "sourceClassToken": "RequestChainController",
+        "targetClassToken": "RequestChainService",
+        "targetModuleName": "RequestChainModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-296280311"
+    },
+    "-393224862": {
+      "source": "-19112576",
+      "target": "1434441974",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "CatsModule"
+      },
+      "id": "-393224862"
+    },
+    "-1675983900": {
+      "source": "-19112576",
+      "target": "1743739569",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "HelloModule"
+      },
+      "id": "-1675983900"
+    },
+    "-678699872": {
+      "source": "-19112576",
+      "target": "-1124392646",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "DurableModule"
+      },
+      "id": "-678699872"
+    },
+    "-158970266": {
+      "source": "-19112576",
+      "target": "-2003726489",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "UsersModule"
+      },
+      "id": "-158970266"
+    },
+    "-2086236431": {
+      "source": "-19112576",
+      "target": "791004148",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "ExternalSvcModule"
+      },
+      "id": "-2086236431"
+    },
+    "-192150092": {
+      "source": "-19112576",
+      "target": "-493958991",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "ChatModule"
+      },
+      "id": "-192150092"
+    },
+    "-1609022090": {
+      "source": "-19112576",
+      "target": "2133316171",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "RequestChainModule"
+      },
+      "id": "-1609022090"
+    },
+    "-773455435": {
+      "source": "-19112576",
+      "target": "-1469176692",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "PropertiesModule"
+      },
+      "id": "-773455435"
+    },
+    "-967144236": {
+      "source": "-19112576",
+      "target": "-1813741655",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "InputModule"
+      },
+      "id": "-967144236"
+    },
+    "-528424051": {
+      "source": "-1125887048",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "CoreModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "-528424051"
+    },
+    "-698929209": {
+      "source": "1743739569",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "HelloModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "-698929209"
+    },
+    "-1671708813": {
+      "source": "-1124392646",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "DurableModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "-1671708813"
+    },
+    "-665042842": {
+      "source": "1142369607",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "HelperModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "-665042842"
+    },
+    "-1891610441": {
+      "source": "-369869768",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "CircularModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "-1891610441"
+    },
+    "-878379437": {
+      "source": "-1550892030",
+      "target": "208171089",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "CatsModule",
+        "sourceClassName": "CatsController",
+        "targetClassName": "RolesGuard",
+        "sourceClassToken": "CatsController",
+        "targetClassToken": "RolesGuard",
+        "targetModuleName": "CatsModule",
+        "injectionType": "decorator"
+      },
+      "id": "-878379437"
+    },
+    "-822816169": {
+      "source": "1472486160",
+      "target": "-2010060263",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloController",
+        "targetClassName": "Guard",
+        "sourceClassToken": "HelloController",
+        "targetClassToken": "Guard",
+        "targetModuleName": "HelloModule",
+        "injectionType": "decorator"
+      },
+      "id": "-822816169"
+    }
+  },
+  "entrypoints": {
+    "1131051184": [
+      {
+        "type": "websocket",
+        "methodName": "create",
+        "className": "ChatGateway",
+        "classNodeId": "1131051184",
+        "metadata": {
+          "port": 0,
+          "key": "createChat",
+          "message": "createChat"
+        },
+        "id": "1131051184_create"
+      },
+      {
+        "type": "websocket",
+        "methodName": "findAll",
+        "className": "ChatGateway",
+        "classNodeId": "1131051184",
+        "metadata": {
+          "port": 0,
+          "key": "findAllChat",
+          "message": "findAllChat"
+        },
+        "id": "1131051184_findAll"
+      },
+      {
+        "type": "websocket",
+        "methodName": "findOne",
+        "className": "ChatGateway",
+        "classNodeId": "1131051184",
+        "metadata": {
+          "port": 0,
+          "key": "findOneChat",
+          "message": "findOneChat"
+        },
+        "id": "1131051184_findOne"
+      },
+      {
+        "type": "websocket",
+        "methodName": "update",
+        "className": "ChatGateway",
+        "classNodeId": "1131051184",
+        "metadata": {
+          "port": 0,
+          "key": "updateChat",
+          "message": "updateChat"
+        },
+        "id": "1131051184_update"
+      },
+      {
+        "type": "websocket",
+        "methodName": "remove",
+        "className": "ChatGateway",
+        "classNodeId": "1131051184",
+        "metadata": {
+          "port": 0,
+          "key": "removeChat",
+          "message": "removeChat"
+        },
+        "id": "1131051184_remove"
+      }
+    ],
+    "1472486160": [
+      {
+        "type": "http-endpoint",
+        "methodName": "greeting",
+        "className": "HelloController",
+        "classNodeId": "1472486160",
+        "metadata": {
+          "key": "/hello",
+          "path": "/hello",
+          "requestMethod": "GET"
+        },
+        "id": "1472486160_greeting"
+      }
+    ],
+    "1634859874": [
+      {
+        "type": "middleware",
+        "methodName": "use",
+        "className": "LoggerMiddleware",
+        "classNodeId": "1634859874",
+        "metadata": {
+          "key": "/cats/",
+          "path": "/cats/",
+          "requestMethod": "POST"
+        },
+        "id": "1634859874_use"
+      },
+      {
+        "type": "middleware",
+        "methodName": "use",
+        "className": "LoggerMiddleware",
+        "classNodeId": "1634859874",
+        "metadata": {
+          "key": "/cats/",
+          "path": "/cats/",
+          "requestMethod": "GET"
+        },
+        "id": "1634859874_use"
+      },
+      {
+        "type": "middleware",
+        "methodName": "use",
+        "className": "LoggerMiddleware",
+        "classNodeId": "1634859874",
+        "metadata": {
+          "key": "/cats/:id",
+          "path": "/cats/:id",
+          "requestMethod": "GET"
+        },
+        "id": "1634859874_use"
+      }
+    ],
+    "-349899408": [
+      {
+        "type": "microservice",
+        "methodName": "create",
+        "className": "ExternalSvcController",
+        "classNodeId": "-349899408",
+        "metadata": {
+          "key": "createExternalSvc",
+          "transportId": "TCP",
+          "patterns": [
+            "createExternalSvc"
+          ],
+          "isEventHandler": false,
+          "extras": {}
+        },
+        "id": "-349899408_create"
+      },
+      {
+        "type": "microservice",
+        "methodName": "findAll",
+        "className": "ExternalSvcController",
+        "classNodeId": "-349899408",
+        "metadata": {
+          "key": "findAllExternalSvc",
+          "transportId": "TCP",
+          "patterns": [
+            "findAllExternalSvc"
+          ],
+          "isEventHandler": false,
+          "extras": {}
+        },
+        "id": "-349899408_findAll"
+      },
+      {
+        "type": "microservice",
+        "methodName": "findOne",
+        "className": "ExternalSvcController",
+        "classNodeId": "-349899408",
+        "metadata": {
+          "key": "findOneExternalSvc",
+          "transportId": "TCP",
+          "patterns": [
+            "findOneExternalSvc"
+          ],
+          "isEventHandler": false,
+          "extras": {}
+        },
+        "id": "-349899408_findOne"
+      },
+      {
+        "type": "microservice",
+        "methodName": "update",
+        "className": "ExternalSvcController",
+        "classNodeId": "-349899408",
+        "metadata": {
+          "key": "updateExternalSvc",
+          "transportId": "TCP",
+          "patterns": [
+            "updateExternalSvc"
+          ],
+          "isEventHandler": false,
+          "extras": {}
+        },
+        "id": "-349899408_update"
+      },
+      {
+        "type": "microservice",
+        "methodName": "remove",
+        "className": "ExternalSvcController",
+        "classNodeId": "-349899408",
+        "metadata": {
+          "key": "removeExternalSvc",
+          "transportId": "TCP",
+          "patterns": [
+            "removeExternalSvc"
+          ],
+          "isEventHandler": false,
+          "extras": {}
+        },
+        "id": "-349899408_remove"
+      }
+    ],
+    "-365265483": [
+      {
+        "type": "http-endpoint",
+        "methodName": "helloWorldV1",
+        "className": "AppV1Controller",
+        "classNodeId": "-365265483",
+        "metadata": {
+          "key": "/v1",
+          "path": "/v1",
+          "requestMethod": "GET",
+          "controllerVersion": "1"
+        },
+        "id": "-365265483_helloWorldV1"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "paramV1",
+        "className": "AppV1Controller",
+        "classNodeId": "-365265483",
+        "metadata": {
+          "key": "/v1/:param/hello",
+          "path": "/v1/:param/hello",
+          "requestMethod": "GET",
+          "controllerVersion": "1"
+        },
+        "id": "-365265483_paramV1"
+      }
+    ],
+    "-774089708": [
+      {
+        "type": "http-endpoint",
+        "methodName": "helloWorldV2",
+        "className": "AppV2Controller",
+        "classNodeId": "-774089708",
+        "metadata": {
+          "key": "/v2",
+          "path": "/v2",
+          "requestMethod": "GET",
+          "controllerVersion": "2"
+        },
+        "id": "-774089708_helloWorldV2"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "paramV1",
+        "className": "AppV2Controller",
+        "classNodeId": "-774089708",
+        "metadata": {
+          "key": "/v3/:param/hello",
+          "path": "/v3/:param/hello",
+          "requestMethod": "GET",
+          "methodVersion": "3",
+          "controllerVersion": "2"
+        },
+        "id": "-774089708_paramV1"
+      }
+    ],
+    "-1550892030": [
+      {
+        "type": "http-endpoint",
+        "methodName": "create",
+        "className": "CatsController",
+        "classNodeId": "-1550892030",
+        "metadata": {
+          "key": "/cats",
+          "path": "/cats",
+          "requestMethod": "POST"
+        },
+        "id": "-1550892030_create"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "findAll",
+        "className": "CatsController",
+        "classNodeId": "-1550892030",
+        "metadata": {
+          "key": "/cats",
+          "path": "/cats",
+          "requestMethod": "GET"
+        },
+        "id": "-1550892030_findAll"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "findOne",
+        "className": "CatsController",
+        "classNodeId": "-1550892030",
+        "metadata": {
+          "key": "/cats/:id",
+          "path": "/cats/:id",
+          "requestMethod": "GET"
+        },
+        "id": "-1550892030_findOne"
+      }
+    ],
+    "-848516688": [
+      {
+        "type": "http-endpoint",
+        "methodName": "greeting",
+        "className": "DurableController",
+        "classNodeId": "-848516688",
+        "metadata": {
+          "key": "/durable",
+          "path": "/durable",
+          "requestMethod": "GET"
+        },
+        "id": "-848516688_greeting"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "echo",
+        "className": "DurableController",
+        "classNodeId": "-848516688",
+        "metadata": {
+          "key": "/durable/echo",
+          "path": "/durable/echo",
+          "requestMethod": "GET"
+        },
+        "id": "-848516688_echo"
+      }
+    ],
+    "-1558907338": [
+      {
+        "type": "http-endpoint",
+        "methodName": "create",
+        "className": "DogsController",
+        "classNodeId": "-1558907338",
+        "metadata": {
+          "key": "/dogs",
+          "path": "/dogs",
+          "requestMethod": "POST"
+        },
+        "id": "-1558907338_create"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "findAll",
+        "className": "DogsController",
+        "classNodeId": "-1558907338",
+        "metadata": {
+          "key": "/dogs",
+          "path": "/dogs",
+          "requestMethod": "GET"
+        },
+        "id": "-1558907338_findAll"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "findOne",
+        "className": "DogsController",
+        "classNodeId": "-1558907338",
+        "metadata": {
+          "key": "/dogs/:id",
+          "path": "/dogs/:id",
+          "requestMethod": "GET"
+        },
+        "id": "-1558907338_findOne"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "update",
+        "className": "DogsController",
+        "classNodeId": "-1558907338",
+        "metadata": {
+          "key": "/dogs/:id",
+          "path": "/dogs/:id",
+          "requestMethod": "PATCH"
+        },
+        "id": "-1558907338_update"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "remove",
+        "className": "DogsController",
+        "classNodeId": "-1558907338",
+        "metadata": {
+          "key": "/dogs/:id",
+          "path": "/dogs/:id",
+          "requestMethod": "DELETE"
+        },
+        "id": "-1558907338_remove"
+      }
+    ],
+    "-1102473136": [
+      {
+        "type": "http-endpoint",
+        "methodName": "create",
+        "className": "UsersController",
+        "classNodeId": "-1102473136",
+        "metadata": {
+          "key": "/users",
+          "path": "/users",
+          "requestMethod": "POST"
+        },
+        "id": "-1102473136_create"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "findAll",
+        "className": "UsersController",
+        "classNodeId": "-1102473136",
+        "metadata": {
+          "key": "/users",
+          "path": "/users",
+          "requestMethod": "GET"
+        },
+        "id": "-1102473136_findAll"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "findOne",
+        "className": "UsersController",
+        "classNodeId": "-1102473136",
+        "metadata": {
+          "key": "/users/:id",
+          "path": "/users/:id",
+          "requestMethod": "GET"
+        },
+        "id": "-1102473136_findOne"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "update",
+        "className": "UsersController",
+        "classNodeId": "-1102473136",
+        "metadata": {
+          "key": "/users/:id",
+          "path": "/users/:id",
+          "requestMethod": "PATCH"
+        },
+        "id": "-1102473136_update"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "remove",
+        "className": "UsersController",
+        "classNodeId": "-1102473136",
+        "metadata": {
+          "key": "/users/:id",
+          "path": "/users/:id",
+          "requestMethod": "DELETE"
+        },
+        "id": "-1102473136_remove"
+      }
+    ],
+    "-377928898": [
+      {
+        "type": "http-endpoint",
+        "methodName": "create",
+        "className": "DatabaseController",
+        "classNodeId": "-377928898",
+        "metadata": {
+          "key": "/database",
+          "path": "/database",
+          "requestMethod": "POST"
+        },
+        "id": "-377928898_create"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "findAll",
+        "className": "DatabaseController",
+        "classNodeId": "-377928898",
+        "metadata": {
+          "key": "/database",
+          "path": "/database",
+          "requestMethod": "GET"
+        },
+        "id": "-377928898_findAll"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "findOne",
+        "className": "DatabaseController",
+        "classNodeId": "-377928898",
+        "metadata": {
+          "key": "/database/:id",
+          "path": "/database/:id",
+          "requestMethod": "GET"
+        },
+        "id": "-377928898_findOne"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "update",
+        "className": "DatabaseController",
+        "classNodeId": "-377928898",
+        "metadata": {
+          "key": "/database/:id",
+          "path": "/database/:id",
+          "requestMethod": "PATCH"
+        },
+        "id": "-377928898_update"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "remove",
+        "className": "DatabaseController",
+        "classNodeId": "-377928898",
+        "metadata": {
+          "key": "/database/:id",
+          "path": "/database/:id",
+          "requestMethod": "DELETE"
+        },
+        "id": "-377928898_remove"
+      }
+    ],
+    "-1927427604": [
+      {
+        "type": "http-endpoint",
+        "methodName": "greeting",
+        "className": "RequestChainController",
+        "classNodeId": "-1927427604",
+        "metadata": {
+          "key": "/hello",
+          "path": "/hello",
+          "requestMethod": "GET"
+        },
+        "id": "-1927427604_greeting"
+      }
+    ]
+  },
+  "extras": {
+    "orphanedEnhancers": [
+      {
+        "subtype": "pipe",
+        "ref": "ValidationPipe"
+      },
+      {
+        "subtype": "filter",
+        "ref": "HttpExceptionFilter"
+      },
+      {
+        "subtype": "interceptor",
+        "ref": "TimeoutInterceptor"
+      }
+    ],
+    "attachedEnhancers": [
+      {
+        "nodeId": "2018972420"
+      },
+      {
+        "nodeId": "-2007711503"
+      }
+    ]
+  },
+  "status": "complete"
+}
\ No newline at end of file
diff --git a/integration/inspector/e2e/fixtures/pre-init-graph.json b/integration/inspector/e2e/fixtures/pre-init-graph.json
new file mode 100644
index 000000000..7f35f1153
--- /dev/null
+++ b/integration/inspector/e2e/fixtures/pre-init-graph.json
@@ -0,0 +1,2595 @@
+{
+  "nodes": {
+    "18347652": {
+      "id": "18347652",
+      "label": "LoggingInterceptor",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "injectable",
+        "internal": false,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "LoggingInterceptor",
+        "subtype": "interceptor",
+        "initTime": 0
+      }
+    },
+    "55510001": {
+      "id": "55510001",
+      "label": "UsersService",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "UsersService",
+        "initTime": 0
+      }
+    },
+    "91819333": {
+      "id": "91819333",
+      "label": "ModuleRef",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "203550704": {
+      "id": "203550704",
+      "label": "ExternalContextCreator",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": true,
+        "token": "ExternalContextCreator",
+        "initTime": 0
+      }
+    },
+    "208171089": {
+      "id": "208171089",
+      "label": "RolesGuard",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "injectable",
+        "internal": false,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "RolesGuard",
+        "subtype": "guard",
+        "initTime": 0
+      }
+    },
+    "225063248": {
+      "id": "225063248",
+      "label": "InternalCoreModule",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "InternalCoreModule",
+        "initTime": 0
+      }
+    },
+    "256260345": {
+      "id": "256260345",
+      "label": "ApplicationConfig",
+      "parent": "1528017428",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DatabaseModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "345516396": {
+      "id": "345516396",
+      "label": "ApplicationConfig",
+      "parent": "1142369607",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelperModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "345719894": {
+      "id": "345719894",
+      "label": "CoreModule",
+      "parent": "-1125887048",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "CoreModule",
+        "initTime": 0
+      }
+    },
+    "437945905": {
+      "id": "437945905",
+      "label": "ApplicationConfig",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "519735830": {
+      "id": "519735830",
+      "label": "ApplicationConfig",
+      "parent": "-493958991",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ChatModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "521671888": {
+      "id": "521671888",
+      "label": "DogsModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "555176277": {
+      "id": "555176277",
+      "label": "InternalCoreModule",
+      "metadata": {
+        "type": "module",
+        "global": true,
+        "dynamic": true,
+        "internal": true
+      }
+    },
+    "594986539": {
+      "id": "594986539",
+      "label": "InputService",
+      "parent": "-1813741655",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "InputModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": true,
+        "token": "InputService",
+        "initTime": 0
+      }
+    },
+    "603011239": {
+      "id": "603011239",
+      "label": "UsersService",
+      "parent": "-2003726489",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "UsersModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "UsersService",
+        "initTime": 0
+      }
+    },
+    "671882984": {
+      "id": "671882984",
+      "label": "Reflector",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": true,
+        "token": "Reflector",
+        "initTime": 0
+      }
+    },
+    "791004148": {
+      "id": "791004148",
+      "label": "ExternalSvcModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "867482265": {
+      "id": "867482265",
+      "label": "Interceptor",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "injectable",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "Interceptor",
+        "subtype": "interceptor",
+        "initTime": 0
+      }
+    },
+    "927096496": {
+      "id": "927096496",
+      "label": "ApplicationConfig",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "928565345": {
+      "id": "928565345",
+      "label": "HelperService",
+      "parent": "1142369607",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "HelperModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": true,
+        "token": "HelperService",
+        "initTime": 0
+      }
+    },
+    "941957564": {
+      "id": "941957564",
+      "label": "RequestChainModule",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "RequestChainModule",
+        "initTime": 0
+      }
+    },
+    "980514911": {
+      "id": "980514911",
+      "label": "Symbol(token)",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "Symbol(token)"
+      }
+    },
+    "1004276345": {
+      "id": "1004276345",
+      "label": "Meta",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "META",
+        "initTime": 0
+      }
+    },
+    "1010833816": {
+      "id": "1010833816",
+      "label": "token",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "token"
+      }
+    },
+    "1047229654": {
+      "id": "1047229654",
+      "label": "CircularModule",
+      "parent": "-369869768",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CircularModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "CircularModule",
+        "initTime": 0
+      }
+    },
+    "1074192353": {
+      "id": "1074192353",
+      "label": "ChatService",
+      "parent": "-493958991",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "ChatModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "ChatService",
+        "initTime": 0
+      }
+    },
+    "1120316353": {
+      "id": "1120316353",
+      "label": "ModuleRef",
+      "parent": "1142369607",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelperModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "1131051184": {
+      "id": "1131051184",
+      "label": "ChatGateway",
+      "parent": "-493958991",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "ChatModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "ChatGateway",
+        "initTime": 0
+      }
+    },
+    "1142369607": {
+      "id": "1142369607",
+      "label": "HelperModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "1189153544": {
+      "id": "1189153544",
+      "label": "ChatModule",
+      "parent": "-493958991",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ChatModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ChatModule",
+        "initTime": 0
+      }
+    },
+    "1253818496": {
+      "id": "1253818496",
+      "label": "RootTestModule",
+      "parent": "-1251270035",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RootTestModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "RootTestModule",
+        "initTime": 0
+      }
+    },
+    "1433815174": {
+      "id": "1433815174",
+      "label": "DogsModule",
+      "parent": "521671888",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DogsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "DogsModule",
+        "initTime": 0
+      }
+    },
+    "1434441974": {
+      "id": "1434441974",
+      "label": "CatsModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "1434456218": {
+      "id": "1434456218",
+      "label": "Reflector",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": true,
+        "token": "Reflector",
+        "initTime": 0
+      }
+    },
+    "1472486160": {
+      "id": "1472486160",
+      "label": "HelloController",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "HelloController",
+        "initTime": 0,
+        "enhancers": [
+          {
+            "id": "-2010060263",
+            "methodKey": "greeting",
+            "subtype": "guard"
+          },
+          {
+            "id": "867482265",
+            "methodKey": "greeting",
+            "subtype": "interceptor"
+          },
+          {
+            "id": "1893794611",
+            "methodKey": "greeting",
+            "subtype": "pipe"
+          }
+        ]
+      }
+    },
+    "1528017428": {
+      "id": "1528017428",
+      "label": "DatabaseModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "1535366709": {
+      "id": "1535366709",
+      "label": "ApplicationConfig",
+      "parent": "521671888",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DogsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "1551182002": {
+      "id": "1551182002",
+      "label": "ModuleRef",
+      "parent": "-1125887048",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "1616075090": {
+      "id": "1616075090",
+      "label": "CatsModule",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "CatsModule",
+        "initTime": 0
+      }
+    },
+    "1743739569": {
+      "id": "1743739569",
+      "label": "HelloModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": true,
+        "internal": false
+      }
+    },
+    "1771940178": {
+      "id": "1771940178",
+      "label": "ApplicationConfig",
+      "parent": "-1251270035",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RootTestModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "1809676814": {
+      "id": "1809676814",
+      "label": "ModuleRef",
+      "parent": "1528017428",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DatabaseModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "1893794611": {
+      "id": "1893794611",
+      "label": "UserByIdPipe",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "injectable",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "UserByIdPipe",
+        "subtype": "pipe",
+        "initTime": 0
+      }
+    },
+    "1919157847": {
+      "id": "1919157847",
+      "label": "REQUEST",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": true,
+        "token": "REQUEST",
+        "initTime": 0
+      }
+    },
+    "2018972420": {
+      "id": "2018972420",
+      "label": "TransformInterceptor",
+      "parent": "-1125887048",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "CoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "APP_INTERCEPTOR (UUID: -1146749753)",
+        "subtype": "interceptor",
+        "initTime": 0,
+        "global": true
+      }
+    },
+    "2133316171": {
+      "id": "2133316171",
+      "label": "RequestChainModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-1486320561": {
+      "id": "-1486320561",
+      "label": "ModuleRef",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-651043398": {
+      "id": "-651043398",
+      "label": "ApplicationConfig",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-255469305": {
+      "id": "-255469305",
+      "label": "INQUIRER",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 1,
+        "transient": true,
+        "exported": true,
+        "token": "INQUIRER",
+        "initTime": 0
+      }
+    },
+    "-26938366": {
+      "id": "-26938366",
+      "label": "ModulesContainer",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": true,
+        "token": "ModulesContainer",
+        "initTime": 0
+      }
+    },
+    "-326832201": {
+      "id": "-326832201",
+      "label": "HttpAdapterHost",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": true,
+        "token": "HttpAdapterHost",
+        "initTime": 0
+      }
+    },
+    "-702581189": {
+      "id": "-702581189",
+      "label": "LazyModuleLoader",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": true,
+        "token": "LazyModuleLoader",
+        "initTime": 0
+      }
+    },
+    "-1904419534": {
+      "id": "-1904419534",
+      "label": "SerializedGraph",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": true,
+        "token": "SerializedGraph",
+        "initTime": 0
+      }
+    },
+    "-1251270035": {
+      "id": "-1251270035",
+      "label": "RootTestModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-969610649": {
+      "id": "-969610649",
+      "label": "ModuleRef",
+      "parent": "-1251270035",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RootTestModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-19112576": {
+      "id": "-19112576",
+      "label": "AppModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-2139588960": {
+      "id": "-2139588960",
+      "label": "AppModule",
+      "parent": "-19112576",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "AppModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "AppModule",
+        "initTime": 0
+      }
+    },
+    "-71302842": {
+      "id": "-71302842",
+      "label": "ModuleRef",
+      "parent": "-19112576",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "AppModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-2064622725": {
+      "id": "-2064622725",
+      "label": "ApplicationConfig",
+      "parent": "-19112576",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "AppModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-365265483": {
+      "id": "-365265483",
+      "label": "AppV1Controller",
+      "parent": "-19112576",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "AppModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "AppV1Controller",
+        "initTime": 0
+      }
+    },
+    "-774089708": {
+      "id": "-774089708",
+      "label": "AppV2Controller",
+      "parent": "-19112576",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "AppModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "AppV2Controller",
+        "initTime": 0
+      }
+    },
+    "-1125887048": {
+      "id": "-1125887048",
+      "label": "CoreModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-112192227": {
+      "id": "-112192227",
+      "label": "ApplicationConfig",
+      "parent": "-1125887048",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-2007711503": {
+      "id": "-2007711503",
+      "label": "LoggingInterceptor",
+      "parent": "-1125887048",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "CoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "APP_INTERCEPTOR (UUID: 1780085433)",
+        "subtype": "interceptor",
+        "initTime": 0,
+        "global": true
+      }
+    },
+    "-183456272": {
+      "id": "-183456272",
+      "label": "ModuleRef",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-1846830501": {
+      "id": "-1846830501",
+      "label": "ApplicationConfig",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-593595711": {
+      "id": "-593595711",
+      "label": "CatsService",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "CatsService",
+        "initTime": 0
+      }
+    },
+    "-1550892030": {
+      "id": "-1550892030",
+      "label": "CatsController",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "CatsController",
+        "initTime": 0,
+        "enhancers": [
+          {
+            "id": "208171089",
+            "subtype": "guard"
+          },
+          {
+            "name": "ParseIntPipe",
+            "methodKey": "findOne",
+            "subtype": "pipe"
+          }
+        ]
+      }
+    },
+    "-1378706112": {
+      "id": "-1378706112",
+      "label": "HelloModule",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "HelloModule",
+        "initTime": 0
+      }
+    },
+    "-1166465801": {
+      "id": "-1166465801",
+      "label": "ModuleRef",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-1191459348": {
+      "id": "-1191459348",
+      "label": "ApplicationConfig",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-1758187461": {
+      "id": "-1758187461",
+      "label": "HelloService",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "HelloService",
+        "initTime": 0
+      }
+    },
+    "-2010060263": {
+      "id": "-2010060263",
+      "label": "Guard",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "injectable",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "Guard",
+        "subtype": "guard",
+        "initTime": 0
+      }
+    },
+    "-1124392646": {
+      "id": "-1124392646",
+      "label": "DurableModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-522935456": {
+      "id": "-522935456",
+      "label": "DurableModule",
+      "parent": "-1124392646",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DurableModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "DurableModule",
+        "initTime": 0
+      }
+    },
+    "-1808043520": {
+      "id": "-1808043520",
+      "label": "ModuleRef",
+      "parent": "-1124392646",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DurableModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-57038411": {
+      "id": "-57038411",
+      "label": "ApplicationConfig",
+      "parent": "-1124392646",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DurableModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-1673986099": {
+      "id": "-1673986099",
+      "label": "DurableService",
+      "parent": "-1124392646",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "DurableModule",
+        "durable": true,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "DurableService",
+        "initTime": 0
+      }
+    },
+    "-848516688": {
+      "id": "-848516688",
+      "label": "DurableController",
+      "parent": "-1124392646",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "DurableModule",
+        "durable": true,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "DurableController",
+        "initTime": 0
+      }
+    },
+    "-1096226358": {
+      "id": "-1096226358",
+      "label": "ModuleRef",
+      "parent": "521671888",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DogsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-335387007": {
+      "id": "-335387007",
+      "label": "DogsService",
+      "parent": "521671888",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "DogsModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "DogsService",
+        "initTime": 0
+      }
+    },
+    "-1558907338": {
+      "id": "-1558907338",
+      "label": "DogsController",
+      "parent": "521671888",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "DogsModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "DogsController",
+        "initTime": 0
+      }
+    },
+    "-2003726489": {
+      "id": "-2003726489",
+      "label": "UsersModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-495603840": {
+      "id": "-495603840",
+      "label": "UsersModule",
+      "parent": "-2003726489",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "UsersModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "UsersModule",
+        "initTime": 0
+      }
+    },
+    "-618964563": {
+      "id": "-618964563",
+      "label": "ModuleRef",
+      "parent": "-2003726489",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "UsersModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-643958110": {
+      "id": "-643958110",
+      "label": "ApplicationConfig",
+      "parent": "-2003726489",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "UsersModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-1102473136": {
+      "id": "-1102473136",
+      "label": "UsersController",
+      "parent": "-2003726489",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "UsersModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "UsersController",
+        "initTime": 0
+      }
+    },
+    "-1098322034": {
+      "id": "-1098322034",
+      "label": "DatabaseModule",
+      "parent": "1528017428",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DatabaseModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "DatabaseModule",
+        "initTime": 0
+      }
+    },
+    "-616397055": {
+      "id": "-616397055",
+      "label": "DatabaseService",
+      "parent": "1528017428",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "DatabaseModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "DatabaseService",
+        "initTime": 0
+      }
+    },
+    "-377928898": {
+      "id": "-377928898",
+      "label": "DatabaseController",
+      "parent": "1528017428",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "DatabaseModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "DatabaseController",
+        "initTime": 0
+      }
+    },
+    "-511735264": {
+      "id": "-511735264",
+      "label": "ExternalSvcModule",
+      "parent": "791004148",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ExternalSvcModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ExternalSvcModule",
+        "initTime": 0
+      }
+    },
+    "-660323910": {
+      "id": "-660323910",
+      "label": "ModuleRef",
+      "parent": "791004148",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ExternalSvcModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-217737489": {
+      "id": "-217737489",
+      "label": "ApplicationConfig",
+      "parent": "791004148",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ExternalSvcModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-1902429503": {
+      "id": "-1902429503",
+      "label": "ExternalSvcService",
+      "parent": "791004148",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "ExternalSvcModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "ExternalSvcService",
+        "initTime": 0
+      }
+    },
+    "-349899408": {
+      "id": "-349899408",
+      "label": "ExternalSvcController",
+      "parent": "791004148",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "ExternalSvcModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "ExternalSvcController",
+        "initTime": 0
+      }
+    },
+    "-493958991": {
+      "id": "-493958991",
+      "label": "ChatModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-2111857237": {
+      "id": "-2111857237",
+      "label": "ModuleRef",
+      "parent": "-493958991",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ChatModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-234035039": {
+      "id": "-234035039",
+      "label": "RequestChainService",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "RequestChainService",
+        "initTime": 0
+      }
+    },
+    "-1927427604": {
+      "id": "-1927427604",
+      "label": "RequestChainController",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "RequestChainController",
+        "initTime": 0,
+        "enhancers": [
+          {
+            "id": "18347652",
+            "methodKey": "greeting",
+            "subtype": "interceptor"
+          }
+        ]
+      }
+    },
+    "-162987852": {
+      "id": "-162987852",
+      "label": "HelperModule",
+      "parent": "1142369607",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelperModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "HelperModule",
+        "initTime": 0
+      }
+    },
+    "-1469176692": {
+      "id": "-1469176692",
+      "label": "PropertiesModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-1501313730": {
+      "id": "-1501313730",
+      "label": "PropertiesModule",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "PropertiesModule",
+        "initTime": 0
+      }
+    },
+    "-1377446394": {
+      "id": "-1377446394",
+      "label": "ModuleRef",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-1494077847": {
+      "id": "-1494077847",
+      "label": "DependencyService",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "DependencyService",
+        "initTime": 0
+      }
+    },
+    "-1803759743": {
+      "id": "-1803759743",
+      "label": "PropertiesService",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "PropertiesService",
+        "initTime": 0
+      }
+    },
+    "-1813741655": {
+      "id": "-1813741655",
+      "label": "InputModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-2113121728": {
+      "id": "-2113121728",
+      "label": "InputModule",
+      "parent": "-1813741655",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InputModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "InputModule",
+        "initTime": 0
+      }
+    },
+    "-428979729": {
+      "id": "-428979729",
+      "label": "ModuleRef",
+      "parent": "-1813741655",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InputModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-453973276": {
+      "id": "-453973276",
+      "label": "ApplicationConfig",
+      "parent": "-1813741655",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InputModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-369869768": {
+      "id": "-369869768",
+      "label": "CircularModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-88210382": {
+      "id": "-88210382",
+      "label": "ModuleRef",
+      "parent": "-369869768",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CircularModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-1641626851": {
+      "id": "-1641626851",
+      "label": "ApplicationConfig",
+      "parent": "-369869768",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CircularModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-1721730431": {
+      "id": "-1721730431",
+      "label": "CircularService",
+      "parent": "-369869768",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "CircularModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": true,
+        "token": "CircularService",
+        "initTime": 0
+      }
+    }
+  },
+  "edges": {
+    "22193019": {
+      "source": "-19112576",
+      "target": "521671888",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "DogsModule"
+      },
+      "id": "22193019"
+    },
+    "33333764": {
+      "source": "791004148",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "ExternalSvcModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "33333764"
+    },
+    "40501732": {
+      "source": "521671888",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "DogsModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "40501732"
+    },
+    "73947303": {
+      "source": "-1813741655",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "InputModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "73947303"
+    },
+    "182501115": {
+      "source": "1434441974",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "CatsModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "182501115"
+    },
+    "189694679": {
+      "source": "1434456218",
+      "target": "671882984",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "InternalCoreModule",
+        "sourceClassName": "Reflector",
+        "targetClassName": "Reflector",
+        "sourceClassToken": "Reflector",
+        "targetClassToken": "Reflector",
+        "targetModuleName": "InternalCoreModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor",
+        "internal": true
+      },
+      "id": "189694679"
+    },
+    "231469845": {
+      "source": "-1803759743",
+      "target": "-1494077847",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "PropertiesModule",
+        "sourceClassName": "PropertiesService",
+        "targetClassName": "DependencyService",
+        "sourceClassToken": "PropertiesService",
+        "targetClassToken": "DependencyService",
+        "targetModuleName": "PropertiesModule",
+        "keyOrIndex": "service",
+        "injectionType": "property"
+      },
+      "id": "231469845"
+    },
+    "250652665": {
+      "source": "2133316171",
+      "target": "1142369607",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "RequestChainModule",
+        "targetModuleName": "HelperModule"
+      },
+      "id": "250652665"
+    },
+    "393939926": {
+      "source": "-1813741655",
+      "target": "-369869768",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "InputModule",
+        "targetModuleName": "CircularModule"
+      },
+      "id": "393939926"
+    },
+    "417363164": {
+      "source": "-1251270035",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "RootTestModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "417363164"
+    },
+    "469401997": {
+      "source": "-493958991",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "ChatModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "469401997"
+    },
+    "654001290": {
+      "source": "1472486160",
+      "target": "867482265",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloController",
+        "targetClassName": "Interceptor",
+        "sourceClassToken": "HelloController",
+        "targetClassToken": "Interceptor",
+        "targetModuleName": "HelloModule",
+        "injectionType": "decorator"
+      },
+      "id": "654001290"
+    },
+    "676175891": {
+      "source": "-1251270035",
+      "target": "-19112576",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "RootTestModule",
+        "targetModuleName": "AppModule"
+      },
+      "id": "676175891"
+    },
+    "800268760": {
+      "source": "-1102473136",
+      "target": "603011239",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "UsersModule",
+        "sourceClassName": "UsersController",
+        "targetClassName": "UsersService",
+        "sourceClassToken": "UsersController",
+        "targetClassToken": "UsersService",
+        "targetModuleName": "UsersModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "800268760"
+    },
+    "804987620": {
+      "source": "-19112576",
+      "target": "-1125887048",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "CoreModule"
+      },
+      "id": "804987620"
+    },
+    "807697929": {
+      "source": "-19112576",
+      "target": "1528017428",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "DatabaseModule"
+      },
+      "id": "807697929"
+    },
+    "966350248": {
+      "source": "1131051184",
+      "target": "1074192353",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "ChatModule",
+        "sourceClassName": "ChatGateway",
+        "targetClassName": "ChatService",
+        "sourceClassToken": "ChatGateway",
+        "targetClassToken": "ChatService",
+        "targetModuleName": "ChatModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "966350248"
+    },
+    "987755577": {
+      "source": "-2003726489",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "UsersModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "987755577"
+    },
+    "1056428433": {
+      "source": "-19112576",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "1056428433"
+    },
+    "1059069749": {
+      "source": "-1558907338",
+      "target": "-335387007",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "DogsModule",
+        "sourceClassName": "DogsController",
+        "targetClassName": "DogsService",
+        "sourceClassToken": "DogsController",
+        "targetClassToken": "DogsService",
+        "targetModuleName": "DogsModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1059069749"
+    },
+    "1142343545": {
+      "source": "-1758187461",
+      "target": "1004276345",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloService",
+        "targetClassName": "Meta",
+        "sourceClassToken": "HelloService",
+        "targetClassToken": "META",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1142343545"
+    },
+    "1178436405": {
+      "source": "1893794611",
+      "target": "55510001",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "UserByIdPipe",
+        "targetClassName": "UsersService",
+        "sourceClassToken": "UserByIdPipe",
+        "targetClassToken": "UsersService",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1178436405"
+    },
+    "1195474320": {
+      "source": "-369869768",
+      "target": "-1813741655",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "CircularModule",
+        "targetModuleName": "InputModule"
+      },
+      "id": "1195474320"
+    },
+    "1247743823": {
+      "source": "2133316171",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "RequestChainModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "1247743823"
+    },
+    "1325313063": {
+      "source": "-1927427604",
+      "target": "18347652",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "RequestChainModule",
+        "sourceClassName": "RequestChainController",
+        "targetClassName": "LoggingInterceptor",
+        "sourceClassToken": "RequestChainController",
+        "targetClassToken": "LoggingInterceptor",
+        "targetModuleName": "RequestChainModule",
+        "injectionType": "decorator"
+      },
+      "id": "1325313063"
+    },
+    "1497653915": {
+      "source": "55510001",
+      "target": "1004276345",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "UsersService",
+        "targetClassName": "Meta",
+        "sourceClassToken": "UsersService",
+        "targetClassToken": "META",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1497653915"
+    },
+    "1615322974": {
+      "source": "-1469176692",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "PropertiesModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "1615322974"
+    },
+    "1856016815": {
+      "source": "-1721730431",
+      "target": "594986539",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "CircularModule",
+        "sourceClassName": "CircularService",
+        "targetClassName": "InputService",
+        "sourceClassToken": "CircularService",
+        "targetClassToken": "InputService",
+        "targetModuleName": "InputModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1856016815"
+    },
+    "1900414743": {
+      "source": "1472486160",
+      "target": "1893794611",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloController",
+        "targetClassName": "UserByIdPipe",
+        "sourceClassToken": "HelloController",
+        "targetClassToken": "UserByIdPipe",
+        "targetModuleName": "HelloModule",
+        "injectionType": "decorator"
+      },
+      "id": "1900414743"
+    },
+    "1904579661": {
+      "source": "18347652",
+      "target": "928565345",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "RequestChainModule",
+        "sourceClassName": "LoggingInterceptor",
+        "targetClassName": "HelperService",
+        "sourceClassToken": "LoggingInterceptor",
+        "targetClassToken": "HelperService",
+        "targetModuleName": "HelperModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1904579661"
+    },
+    "1960203007": {
+      "source": "-1803759743",
+      "target": "980514911",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "PropertiesModule",
+        "sourceClassName": "PropertiesService",
+        "targetClassName": "Symbol(token)",
+        "sourceClassToken": "PropertiesService",
+        "targetClassToken": "Symbol(token)",
+        "targetModuleName": "PropertiesModule",
+        "keyOrIndex": "symbolToken",
+        "injectionType": "property"
+      },
+      "id": "1960203007"
+    },
+    "1976848738": {
+      "source": "1528017428",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "DatabaseModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "1976848738"
+    },
+    "-2105726668": {
+      "source": "-1803759743",
+      "target": "1010833816",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "PropertiesModule",
+        "sourceClassName": "PropertiesService",
+        "targetClassName": "token",
+        "sourceClassToken": "PropertiesService",
+        "targetClassToken": "token",
+        "targetModuleName": "PropertiesModule",
+        "keyOrIndex": "token",
+        "injectionType": "property"
+      },
+      "id": "-2105726668"
+    },
+    "-21463590": {
+      "source": "-1378706112",
+      "target": "1004276345",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloModule",
+        "targetClassName": "Meta",
+        "sourceClassToken": "HelloModule",
+        "targetClassToken": "META",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-21463590"
+    },
+    "-1657371464": {
+      "source": "-1673986099",
+      "target": "1919157847",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "DurableModule",
+        "sourceClassName": "DurableService",
+        "targetClassName": "REQUEST",
+        "sourceClassToken": "DurableService",
+        "targetClassToken": "REQUEST",
+        "targetModuleName": "InternalCoreModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor",
+        "internal": true
+      },
+      "id": "-1657371464"
+    },
+    "-1303681274": {
+      "source": "928565345",
+      "target": "1919157847",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelperModule",
+        "sourceClassName": "HelperService",
+        "targetClassName": "REQUEST",
+        "sourceClassToken": "HelperService",
+        "targetClassToken": "REQUEST",
+        "targetModuleName": "InternalCoreModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor",
+        "internal": true
+      },
+      "id": "-1303681274"
+    },
+    "-886102564": {
+      "source": "208171089",
+      "target": "671882984",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "CatsModule",
+        "sourceClassName": "RolesGuard",
+        "targetClassName": "Reflector",
+        "sourceClassToken": "RolesGuard",
+        "targetClassToken": "Reflector",
+        "targetModuleName": "InternalCoreModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor",
+        "internal": true
+      },
+      "id": "-886102564"
+    },
+    "-2003045613": {
+      "source": "-377928898",
+      "target": "-616397055",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "DatabaseModule",
+        "sourceClassName": "DatabaseController",
+        "targetClassName": "DatabaseService",
+        "sourceClassToken": "DatabaseController",
+        "targetClassToken": "DatabaseService",
+        "targetModuleName": "DatabaseModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-2003045613"
+    },
+    "-881420795": {
+      "source": "-349899408",
+      "target": "-1902429503",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "ExternalSvcModule",
+        "sourceClassName": "ExternalSvcController",
+        "targetClassName": "ExternalSvcService",
+        "sourceClassToken": "ExternalSvcController",
+        "targetClassToken": "ExternalSvcService",
+        "targetModuleName": "ExternalSvcModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-881420795"
+    },
+    "-831049991": {
+      "source": "594986539",
+      "target": "-1721730431",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "InputModule",
+        "sourceClassName": "InputService",
+        "targetClassName": "CircularService",
+        "sourceClassToken": "InputService",
+        "targetClassToken": "CircularService",
+        "targetModuleName": "CircularModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-831049991"
+    },
+    "-2146943494": {
+      "source": "-234035039",
+      "target": "928565345",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "RequestChainModule",
+        "sourceClassName": "RequestChainService",
+        "targetClassName": "HelperService",
+        "sourceClassToken": "RequestChainService",
+        "targetClassToken": "HelperService",
+        "targetModuleName": "HelperModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-2146943494"
+    },
+    "-1816180282": {
+      "source": "-848516688",
+      "target": "-1673986099",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "DurableModule",
+        "sourceClassName": "DurableController",
+        "targetClassName": "DurableService",
+        "sourceClassToken": "DurableController",
+        "targetClassToken": "DurableService",
+        "targetModuleName": "DurableModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-1816180282"
+    },
+    "-180350082": {
+      "source": "-1550892030",
+      "target": "-593595711",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "CatsModule",
+        "sourceClassName": "CatsController",
+        "targetClassName": "CatsService",
+        "sourceClassToken": "CatsController",
+        "targetClassToken": "CatsService",
+        "targetModuleName": "CatsModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-180350082"
+    },
+    "-1043628608": {
+      "source": "1472486160",
+      "target": "-1758187461",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloController",
+        "targetClassName": "HelloService",
+        "sourceClassToken": "HelloController",
+        "targetClassToken": "HelloService",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-1043628608"
+    },
+    "-1335121169": {
+      "source": "1472486160",
+      "target": "55510001",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloController",
+        "targetClassName": "UsersService",
+        "sourceClassToken": "HelloController",
+        "targetClassToken": "UsersService",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 1,
+        "injectionType": "constructor"
+      },
+      "id": "-1335121169"
+    },
+    "-296280311": {
+      "source": "-1927427604",
+      "target": "-234035039",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "RequestChainModule",
+        "sourceClassName": "RequestChainController",
+        "targetClassName": "RequestChainService",
+        "sourceClassToken": "RequestChainController",
+        "targetClassToken": "RequestChainService",
+        "targetModuleName": "RequestChainModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-296280311"
+    },
+    "-393224862": {
+      "source": "-19112576",
+      "target": "1434441974",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "CatsModule"
+      },
+      "id": "-393224862"
+    },
+    "-1675983900": {
+      "source": "-19112576",
+      "target": "1743739569",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "HelloModule"
+      },
+      "id": "-1675983900"
+    },
+    "-678699872": {
+      "source": "-19112576",
+      "target": "-1124392646",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "DurableModule"
+      },
+      "id": "-678699872"
+    },
+    "-158970266": {
+      "source": "-19112576",
+      "target": "-2003726489",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "UsersModule"
+      },
+      "id": "-158970266"
+    },
+    "-2086236431": {
+      "source": "-19112576",
+      "target": "791004148",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "ExternalSvcModule"
+      },
+      "id": "-2086236431"
+    },
+    "-192150092": {
+      "source": "-19112576",
+      "target": "-493958991",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "ChatModule"
+      },
+      "id": "-192150092"
+    },
+    "-1609022090": {
+      "source": "-19112576",
+      "target": "2133316171",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "RequestChainModule"
+      },
+      "id": "-1609022090"
+    },
+    "-773455435": {
+      "source": "-19112576",
+      "target": "-1469176692",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "PropertiesModule"
+      },
+      "id": "-773455435"
+    },
+    "-967144236": {
+      "source": "-19112576",
+      "target": "-1813741655",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "InputModule"
+      },
+      "id": "-967144236"
+    },
+    "-528424051": {
+      "source": "-1125887048",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "CoreModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "-528424051"
+    },
+    "-698929209": {
+      "source": "1743739569",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "HelloModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "-698929209"
+    },
+    "-1671708813": {
+      "source": "-1124392646",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "DurableModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "-1671708813"
+    },
+    "-665042842": {
+      "source": "1142369607",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "HelperModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "-665042842"
+    },
+    "-1891610441": {
+      "source": "-369869768",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "CircularModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "-1891610441"
+    },
+    "-878379437": {
+      "source": "-1550892030",
+      "target": "208171089",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "CatsModule",
+        "sourceClassName": "CatsController",
+        "targetClassName": "RolesGuard",
+        "sourceClassToken": "CatsController",
+        "targetClassToken": "RolesGuard",
+        "targetModuleName": "CatsModule",
+        "injectionType": "decorator"
+      },
+      "id": "-878379437"
+    },
+    "-822816169": {
+      "source": "1472486160",
+      "target": "-2010060263",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloController",
+        "targetClassName": "Guard",
+        "sourceClassToken": "HelloController",
+        "targetClassToken": "Guard",
+        "targetModuleName": "HelloModule",
+        "injectionType": "decorator"
+      },
+      "id": "-822816169"
+    }
+  },
+  "entrypoints": {},
+  "extras": {
+    "orphanedEnhancers": [],
+    "attachedEnhancers": [
+      {
+        "nodeId": "2018972420"
+      },
+      {
+        "nodeId": "-2007711503"
+      }
+    ]
+  },
+  "status": "complete"
+}
\ No newline at end of file
diff --git a/integration/inspector/e2e/graph-inspector.spec.ts b/integration/inspector/e2e/graph-inspector.spec.ts
new file mode 100644
index 000000000..9c02de690
--- /dev/null
+++ b/integration/inspector/e2e/graph-inspector.spec.ts
@@ -0,0 +1,69 @@
+import { ValidationPipe } from '@nestjs/common';
+import { Injector } from '@nestjs/core/injector/injector';
+import { SerializedGraph } from '@nestjs/core/inspector/serialized-graph';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
+import { Test, TestingModule } from '@nestjs/testing';
+import { expect } from 'chai';
+import { readFileSync } from 'fs';
+import { join } from 'path';
+import * as sinon from 'sinon';
+import { AppModule } from '../src/app.module';
+import { HttpExceptionFilter } from '../src/common/filters/http-exception.filter';
+import { TimeoutInterceptor } from '../src/common/interceptors/timeout.interceptor';
+
+describe('Graph inspector', () => {
+  let testingModule: TestingModule;
+
+  before(async () => {
+    sinon.stub(Injector.prototype as any, 'getNowTimestamp').callsFake(() => 0);
+
+    testingModule = await Test.createTestingModule({
+      imports: [AppModule],
+    }).compile({ snapshot: true });
+  });
+
+  it('should generate a pre-initialization graph and match snapshot', () => {
+    const graph = testingModule.get(SerializedGraph);
+
+    // Update snapshot:
+    // writeFileSync(
+    //   join(__dirname, 'fixtures', 'pre-init-graph.json'),
+    //   graph.toString(),
+    // );
+
+    const snapshot = readFileSync(
+      join(__dirname, 'fixtures', 'pre-init-graph.json'),
+      'utf-8',
+    );
+
+    expect(JSON.parse(graph.toString())).to.deep.equal(JSON.parse(snapshot));
+  });
+
+  it('should generate a post-initialization graph and match snapshot', async () => {
+    const app = testingModule.createNestApplication({ preview: true });
+    app.useGlobalPipes(new ValidationPipe());
+    app.useGlobalFilters(new HttpExceptionFilter());
+    app.useGlobalInterceptors(new TimeoutInterceptor());
+    app.enableVersioning();
+    app.connectMicroservice<MicroserviceOptions>({
+      transport: Transport.TCP,
+      options: {},
+    });
+    await app.init();
+
+    const graph = testingModule.get(SerializedGraph);
+
+    // Update snapshot:
+    // writeFileSync(
+    //   join(__dirname, 'fixtures', 'post-init-graph.json'),
+    //   graph.toString(),
+    // );
+
+    const snapshot = readFileSync(
+      join(__dirname, 'fixtures', 'post-init-graph.json'),
+      'utf-8',
+    );
+
+    expect(graph.toString()).to.equal(snapshot);
+  });
+});
diff --git a/integration/inspector/src/app-v1.controller.ts b/integration/inspector/src/app-v1.controller.ts
new file mode 100644
index 000000000..90d1dacba
--- /dev/null
+++ b/integration/inspector/src/app-v1.controller.ts
@@ -0,0 +1,16 @@
+import { Controller, Get } from '@nestjs/common';
+
+@Controller({
+  version: '1',
+})
+export class AppV1Controller {
+  @Get('/')
+  helloWorldV1() {
+    return 'Hello World V1!';
+  }
+
+  @Get('/:param/hello')
+  paramV1() {
+    return 'Parameter V1!';
+  }
+}
diff --git a/integration/inspector/src/app-v2.controller.ts b/integration/inspector/src/app-v2.controller.ts
new file mode 100644
index 000000000..5be777871
--- /dev/null
+++ b/integration/inspector/src/app-v2.controller.ts
@@ -0,0 +1,17 @@
+import { Controller, Get, Version } from '@nestjs/common';
+
+@Controller({
+  version: '2',
+})
+export class AppV2Controller {
+  @Get('/')
+  helloWorldV2() {
+    return 'Hello World V2!';
+  }
+
+  @Version('3')
+  @Get('/:param/hello')
+  paramV1() {
+    return 'Parameter V2!';
+  }
+}
diff --git a/integration/inspector/src/app.module.ts b/integration/inspector/src/app.module.ts
new file mode 100644
index 000000000..1d395b9bf
--- /dev/null
+++ b/integration/inspector/src/app.module.ts
@@ -0,0 +1,46 @@
+import { Module, Scope } from '@nestjs/common';
+import { AppV1Controller } from './app-v1.controller';
+import { AppV2Controller } from './app-v2.controller';
+import { CatsModule } from './cats/cats.module';
+import { ChatModule } from './chat/chat.module';
+import { HelloModule as CircularHelloModule } from './circular-hello/hello.module';
+import { HelloService } from './circular-hello/hello.service';
+import { InputModule } from './circular-modules/input.module';
+import { CoreModule } from './core/core.module';
+import { DatabaseModule } from './database/database.module';
+import { DogsModule } from './dogs/dogs.module';
+import { DurableModule } from './durable/durable.module';
+import { ExternalSvcModule } from './external-svc/external-svc.module';
+import { PropertiesModule } from './properties/properties.module';
+import { RequestChainModule } from './request-chain/request-chain.module';
+import { UsersModule } from './users/users.module';
+
+class Meta {
+  static COUNTER = 0;
+  constructor(private readonly helloService: HelloService) {
+    Meta.COUNTER++;
+  }
+}
+
+@Module({
+  imports: [
+    CoreModule,
+    CatsModule,
+    CircularHelloModule.forRoot({
+      provide: 'META',
+      useClass: Meta,
+      scope: Scope.REQUEST,
+    }),
+    DurableModule,
+    DogsModule,
+    UsersModule,
+    DatabaseModule,
+    ExternalSvcModule,
+    ChatModule,
+    RequestChainModule,
+    PropertiesModule,
+    InputModule,
+  ],
+  controllers: [AppV1Controller, AppV2Controller],
+})
+export class AppModule {}
diff --git a/integration/inspector/src/cats/cats.controller.ts b/integration/inspector/src/cats/cats.controller.ts
new file mode 100644
index 000000000..b9f929a21
--- /dev/null
+++ b/integration/inspector/src/cats/cats.controller.ts
@@ -0,0 +1,30 @@
+import { Body, Controller, Get, Param, Post, UseGuards } from '@nestjs/common';
+import { RolesGuard } from '../common/guards/roles.guard';
+import { ParseIntPipe } from '../common/pipes/parse-int.pipe';
+import { CatsService } from './cats.service';
+import { CreateCatDto } from './dto/create-cat.dto';
+import { Cat } from './interfaces/cat.interface';
+
+@UseGuards(RolesGuard)
+@Controller('cats')
+export class CatsController {
+  constructor(private readonly catsService: CatsService) {}
+
+  @Post()
+  async create(@Body() createCatDto: CreateCatDto) {
+    this.catsService.create(createCatDto);
+  }
+
+  @Get()
+  async findAll(): Promise<Cat[]> {
+    return this.catsService.findAll();
+  }
+
+  @Get(':id')
+  findOne(
+    @Param('id', new ParseIntPipe())
+    id: number,
+  ) {
+    // get by ID logic
+  }
+}
diff --git a/integration/inspector/src/cats/cats.module.ts b/integration/inspector/src/cats/cats.module.ts
new file mode 100644
index 000000000..f3291c7d1
--- /dev/null
+++ b/integration/inspector/src/cats/cats.module.ts
@@ -0,0 +1,9 @@
+import { Module } from '@nestjs/common';
+import { CatsController } from './cats.controller';
+import { CatsService } from './cats.service';
+
+@Module({
+  controllers: [CatsController],
+  providers: [CatsService],
+})
+export class CatsModule {}
diff --git a/integration/inspector/src/cats/cats.service.ts b/integration/inspector/src/cats/cats.service.ts
new file mode 100644
index 000000000..2619cd717
--- /dev/null
+++ b/integration/inspector/src/cats/cats.service.ts
@@ -0,0 +1,15 @@
+import { Injectable } from '@nestjs/common';
+import { Cat } from './interfaces/cat.interface';
+
+@Injectable()
+export class CatsService {
+  private readonly cats: Cat[] = [];
+
+  create(cat: Cat) {
+    this.cats.push(cat);
+  }
+
+  findAll(): Cat[] {
+    return this.cats;
+  }
+}
diff --git a/integration/inspector/src/cats/dto/create-cat.dto.ts b/integration/inspector/src/cats/dto/create-cat.dto.ts
new file mode 100644
index 000000000..acd7d288b
--- /dev/null
+++ b/integration/inspector/src/cats/dto/create-cat.dto.ts
@@ -0,0 +1,12 @@
+import { IsInt, IsString } from 'class-validator';
+
+export class CreateCatDto {
+  @IsString()
+  readonly name: string;
+
+  @IsInt()
+  readonly age: number;
+
+  @IsString()
+  readonly breed: string;
+}
diff --git a/integration/inspector/src/cats/interfaces/cat.interface.ts b/integration/inspector/src/cats/interfaces/cat.interface.ts
new file mode 100644
index 000000000..961c97391
--- /dev/null
+++ b/integration/inspector/src/cats/interfaces/cat.interface.ts
@@ -0,0 +1,5 @@
+export interface Cat {
+  name: string;
+  age: number;
+  breed: string;
+}
diff --git a/integration/inspector/src/chat/chat.gateway.ts b/integration/inspector/src/chat/chat.gateway.ts
new file mode 100644
index 000000000..75e6c7c28
--- /dev/null
+++ b/integration/inspector/src/chat/chat.gateway.ts
@@ -0,0 +1,38 @@
+import {
+  WebSocketGateway,
+  SubscribeMessage,
+  MessageBody,
+} from '@nestjs/websockets';
+import { ChatService } from './chat.service';
+import { CreateChatDto } from './dto/create-chat.dto';
+import { UpdateChatDto } from './dto/update-chat.dto';
+
+@WebSocketGateway()
+export class ChatGateway {
+  constructor(private readonly chatService: ChatService) {}
+
+  @SubscribeMessage('createChat')
+  create(@MessageBody() createChatDto: CreateChatDto) {
+    return this.chatService.create(createChatDto);
+  }
+
+  @SubscribeMessage('findAllChat')
+  findAll() {
+    return this.chatService.findAll();
+  }
+
+  @SubscribeMessage('findOneChat')
+  findOne(@MessageBody() id: number) {
+    return this.chatService.findOne(id);
+  }
+
+  @SubscribeMessage('updateChat')
+  update(@MessageBody() updateChatDto: UpdateChatDto) {
+    return this.chatService.update(updateChatDto.id, updateChatDto);
+  }
+
+  @SubscribeMessage('removeChat')
+  remove(@MessageBody() id: number) {
+    return this.chatService.remove(id);
+  }
+}
diff --git a/integration/inspector/src/chat/chat.module.ts b/integration/inspector/src/chat/chat.module.ts
new file mode 100644
index 000000000..d3ad301f5
--- /dev/null
+++ b/integration/inspector/src/chat/chat.module.ts
@@ -0,0 +1,8 @@
+import { Module } from '@nestjs/common';
+import { ChatService } from './chat.service';
+import { ChatGateway } from './chat.gateway';
+
+@Module({
+  providers: [ChatGateway, ChatService],
+})
+export class ChatModule {}
diff --git a/integration/inspector/src/chat/chat.service.ts b/integration/inspector/src/chat/chat.service.ts
new file mode 100644
index 000000000..1fa0676de
--- /dev/null
+++ b/integration/inspector/src/chat/chat.service.ts
@@ -0,0 +1,26 @@
+import { Injectable } from '@nestjs/common';
+import { CreateChatDto } from './dto/create-chat.dto';
+import { UpdateChatDto } from './dto/update-chat.dto';
+
+@Injectable()
+export class ChatService {
+  create(createChatDto: CreateChatDto) {
+    return 'This action adds a new chat';
+  }
+
+  findAll() {
+    return `This action returns all chat`;
+  }
+
+  findOne(id: number) {
+    return `This action returns a #${id} chat`;
+  }
+
+  update(id: number, updateChatDto: UpdateChatDto) {
+    return `This action updates a #${id} chat`;
+  }
+
+  remove(id: number) {
+    return `This action removes a #${id} chat`;
+  }
+}
diff --git a/integration/inspector/src/chat/dto/create-chat.dto.ts b/integration/inspector/src/chat/dto/create-chat.dto.ts
new file mode 100644
index 000000000..d9fd9013a
--- /dev/null
+++ b/integration/inspector/src/chat/dto/create-chat.dto.ts
@@ -0,0 +1 @@
+export class CreateChatDto {}
diff --git a/integration/inspector/src/chat/dto/update-chat.dto.ts b/integration/inspector/src/chat/dto/update-chat.dto.ts
new file mode 100644
index 000000000..0a372f666
--- /dev/null
+++ b/integration/inspector/src/chat/dto/update-chat.dto.ts
@@ -0,0 +1,6 @@
+import { PartialType } from '@nestjs/mapped-types';
+import { CreateChatDto } from './create-chat.dto';
+
+export class UpdateChatDto extends PartialType(CreateChatDto) {
+  id: number;
+}
diff --git a/integration/inspector/src/chat/entities/chat.entity.ts b/integration/inspector/src/chat/entities/chat.entity.ts
new file mode 100644
index 000000000..7e881f92f
--- /dev/null
+++ b/integration/inspector/src/chat/entities/chat.entity.ts
@@ -0,0 +1 @@
+export class Chat {}
diff --git a/integration/inspector/src/circular-hello/dto/test.dto.ts b/integration/inspector/src/circular-hello/dto/test.dto.ts
new file mode 100644
index 000000000..b3a30f671
--- /dev/null
+++ b/integration/inspector/src/circular-hello/dto/test.dto.ts
@@ -0,0 +1,10 @@
+import { IsString, IsNotEmpty, IsNumber } from 'class-validator';
+
+export class TestDto {
+  @IsString()
+  @IsNotEmpty()
+  string: string;
+
+  @IsNumber()
+  number: number;
+}
diff --git a/integration/inspector/src/circular-hello/guards/request-scoped.guard.ts b/integration/inspector/src/circular-hello/guards/request-scoped.guard.ts
new file mode 100644
index 000000000..7e5fe1788
--- /dev/null
+++ b/integration/inspector/src/circular-hello/guards/request-scoped.guard.ts
@@ -0,0 +1,21 @@
+import {
+  CanActivate,
+  ExecutionContext,
+  Injectable,
+  Scope,
+} from '@nestjs/common';
+import { Observable } from 'rxjs';
+
+@Injectable({ scope: Scope.REQUEST })
+export class Guard implements CanActivate {
+  static COUNTER = 0;
+  constructor() {
+    Guard.COUNTER++;
+  }
+
+  canActivate(
+    context: ExecutionContext,
+  ): boolean | Promise<boolean> | Observable<boolean> {
+    return true;
+  }
+}
diff --git a/integration/inspector/src/circular-hello/hello.controller.ts b/integration/inspector/src/circular-hello/hello.controller.ts
new file mode 100644
index 000000000..5b4af7bf2
--- /dev/null
+++ b/integration/inspector/src/circular-hello/hello.controller.ts
@@ -0,0 +1,30 @@
+import {
+  Controller,
+  Get,
+  Param,
+  UseGuards,
+  UseInterceptors,
+} from '@nestjs/common';
+import { Guard } from './guards/request-scoped.guard';
+import { HelloService } from './hello.service';
+import { Interceptor } from './interceptors/logging.interceptor';
+import { UserByIdPipe } from './users/user-by-id.pipe';
+import { UsersService } from './users/users.service';
+
+@Controller('hello')
+export class HelloController {
+  static COUNTER = 0;
+  constructor(
+    private readonly helloService: HelloService,
+    private readonly usersService: UsersService,
+  ) {
+    HelloController.COUNTER++;
+  }
+
+  @UseGuards(Guard)
+  @UseInterceptors(Interceptor)
+  @Get()
+  greeting(@Param('id', UserByIdPipe) id): string {
+    return this.helloService.greeting();
+  }
+}
diff --git a/integration/inspector/src/circular-hello/hello.module.ts b/integration/inspector/src/circular-hello/hello.module.ts
new file mode 100644
index 000000000..1a0d0bbfd
--- /dev/null
+++ b/integration/inspector/src/circular-hello/hello.module.ts
@@ -0,0 +1,19 @@
+import { DynamicModule, Inject, Module, Provider } from '@nestjs/common';
+import { HelloController } from './hello.controller';
+import { HelloService } from './hello.service';
+import { UsersService } from './users/users.service';
+
+@Module({
+  controllers: [HelloController],
+  providers: [HelloService, UsersService],
+})
+export class HelloModule {
+  constructor(@Inject('META') private readonly meta) {}
+
+  static forRoot(meta: Provider): DynamicModule {
+    return {
+      module: HelloModule,
+      providers: [meta],
+    };
+  }
+}
diff --git a/integration/inspector/src/circular-hello/hello.service.ts b/integration/inspector/src/circular-hello/hello.service.ts
new file mode 100644
index 000000000..a0a346ebf
--- /dev/null
+++ b/integration/inspector/src/circular-hello/hello.service.ts
@@ -0,0 +1,13 @@
+import { Inject, Injectable, Scope } from '@nestjs/common';
+
+@Injectable({ scope: Scope.REQUEST })
+export class HelloService {
+  static COUNTER = 0;
+  constructor(@Inject('META') private readonly meta) {
+    HelloService.COUNTER++;
+  }
+
+  greeting(): string {
+    return 'Hello world!';
+  }
+}
diff --git a/integration/inspector/src/circular-hello/interceptors/logging.interceptor.ts b/integration/inspector/src/circular-hello/interceptors/logging.interceptor.ts
new file mode 100644
index 000000000..b8b4e5793
--- /dev/null
+++ b/integration/inspector/src/circular-hello/interceptors/logging.interceptor.ts
@@ -0,0 +1,19 @@
+import {
+  CallHandler,
+  ExecutionContext,
+  Injectable,
+  NestInterceptor,
+  Scope,
+} from '@nestjs/common';
+import { Observable } from 'rxjs';
+
+@Injectable({ scope: Scope.REQUEST })
+export class Interceptor implements NestInterceptor {
+  static COUNTER = 0;
+  constructor() {
+    Interceptor.COUNTER++;
+  }
+  intercept(context: ExecutionContext, call: CallHandler): Observable<any> {
+    return call.handle();
+  }
+}
diff --git a/integration/inspector/src/circular-hello/users/user-by-id.pipe.ts b/integration/inspector/src/circular-hello/users/user-by-id.pipe.ts
new file mode 100644
index 000000000..2b81cb6fb
--- /dev/null
+++ b/integration/inspector/src/circular-hello/users/user-by-id.pipe.ts
@@ -0,0 +1,14 @@
+import { ArgumentMetadata, Injectable, PipeTransform } from '@nestjs/common';
+import { UsersService } from './users.service';
+
+@Injectable()
+export class UserByIdPipe implements PipeTransform<string> {
+  static COUNTER = 0;
+  constructor(private readonly usersService: UsersService) {
+    UserByIdPipe.COUNTER++;
+  }
+
+  transform(value: string, metadata: ArgumentMetadata) {
+    return this.usersService.findById(value);
+  }
+}
diff --git a/integration/inspector/src/circular-hello/users/users.service.ts b/integration/inspector/src/circular-hello/users/users.service.ts
new file mode 100644
index 000000000..f1cb617e1
--- /dev/null
+++ b/integration/inspector/src/circular-hello/users/users.service.ts
@@ -0,0 +1,13 @@
+import { Inject, Injectable, Scope } from '@nestjs/common';
+
+@Injectable({ scope: Scope.REQUEST })
+export class UsersService {
+  static COUNTER = 0;
+  constructor(@Inject('META') private readonly meta) {
+    UsersService.COUNTER++;
+  }
+
+  findById(id: string) {
+    return { id };
+  }
+}
diff --git a/integration/inspector/src/circular-modules/circular.module.ts b/integration/inspector/src/circular-modules/circular.module.ts
new file mode 100644
index 000000000..bb6afb42a
--- /dev/null
+++ b/integration/inspector/src/circular-modules/circular.module.ts
@@ -0,0 +1,10 @@
+import { Module, forwardRef } from '@nestjs/common';
+import { CircularService } from './circular.service';
+import { InputModule } from './input.module';
+
+@Module({
+  imports: [forwardRef(() => InputModule)],
+  providers: [CircularService],
+  exports: [CircularService],
+})
+export class CircularModule {}
diff --git a/integration/inspector/src/circular-modules/circular.service.ts b/integration/inspector/src/circular-modules/circular.service.ts
new file mode 100644
index 000000000..546d63e6e
--- /dev/null
+++ b/integration/inspector/src/circular-modules/circular.service.ts
@@ -0,0 +1,10 @@
+import { Injectable, forwardRef, Inject } from '@nestjs/common';
+import { InputService } from './input.service';
+
+@Injectable()
+export class CircularService {
+  constructor(
+    @Inject(forwardRef(() => InputService))
+    public readonly service: InputService,
+  ) {}
+}
diff --git a/integration/inspector/src/circular-modules/input.module.ts b/integration/inspector/src/circular-modules/input.module.ts
new file mode 100644
index 000000000..c76dcaa85
--- /dev/null
+++ b/integration/inspector/src/circular-modules/input.module.ts
@@ -0,0 +1,10 @@
+import { Module, forwardRef } from '@nestjs/common';
+import { CircularModule } from './circular.module';
+import { InputService } from './input.service';
+
+@Module({
+  imports: [forwardRef(() => CircularModule)],
+  providers: [InputService],
+  exports: [InputService],
+})
+export class InputModule {}
diff --git a/integration/inspector/src/circular-modules/input.service.ts b/integration/inspector/src/circular-modules/input.service.ts
new file mode 100644
index 000000000..342e8bf0d
--- /dev/null
+++ b/integration/inspector/src/circular-modules/input.service.ts
@@ -0,0 +1,10 @@
+import { Injectable, Inject, forwardRef } from '@nestjs/common';
+import { CircularService } from './circular.service';
+
+@Injectable()
+export class InputService {
+  constructor(
+    @Inject(forwardRef(() => CircularService))
+    public readonly service: CircularService,
+  ) {}
+}
diff --git a/integration/inspector/src/common/filters/http-exception.filter.ts b/integration/inspector/src/common/filters/http-exception.filter.ts
new file mode 100644
index 000000000..acabf619c
--- /dev/null
+++ b/integration/inspector/src/common/filters/http-exception.filter.ts
@@ -0,0 +1,22 @@
+import {
+  ArgumentsHost,
+  Catch,
+  ExceptionFilter,
+  HttpException,
+} from '@nestjs/common';
+
+@Catch(HttpException)
+export class HttpExceptionFilter implements ExceptionFilter<HttpException> {
+  catch(exception: HttpException, host: ArgumentsHost) {
+    const ctx = host.switchToHttp();
+    const response = ctx.getResponse();
+    const request = ctx.getRequest();
+    const statusCode = exception.getStatus();
+
+    response.status(statusCode).json({
+      statusCode,
+      timestamp: new Date().toISOString(),
+      path: request.url,
+    });
+  }
+}
diff --git a/integration/inspector/src/common/guards/roles.guard.ts b/integration/inspector/src/common/guards/roles.guard.ts
new file mode 100644
index 000000000..0ae26c41d
--- /dev/null
+++ b/integration/inspector/src/common/guards/roles.guard.ts
@@ -0,0 +1,20 @@
+import { CanActivate, ExecutionContext, Injectable } from '@nestjs/common';
+import { Reflector } from '@nestjs/core';
+
+@Injectable()
+export class RolesGuard implements CanActivate {
+  constructor(private readonly reflector: Reflector) {}
+
+  canActivate(context: ExecutionContext): boolean {
+    const roles = this.reflector.get<string[]>('roles', context.getHandler());
+    if (!roles) {
+      return true;
+    }
+    const request = context.switchToHttp().getRequest();
+    const user = request.user;
+    const hasRole = () =>
+      user.roles.some(role => !!roles.find(item => item === role));
+
+    return user && user.roles && hasRole();
+  }
+}
diff --git a/integration/inspector/src/common/interceptors/timeout.interceptor.ts b/integration/inspector/src/common/interceptors/timeout.interceptor.ts
new file mode 100644
index 000000000..3bd0769ac
--- /dev/null
+++ b/integration/inspector/src/common/interceptors/timeout.interceptor.ts
@@ -0,0 +1,15 @@
+import {
+  CallHandler,
+  ExecutionContext,
+  Injectable,
+  NestInterceptor,
+} from '@nestjs/common';
+import { Observable } from 'rxjs';
+import { timeout } from 'rxjs/operators';
+
+@Injectable()
+export class TimeoutInterceptor implements NestInterceptor {
+  intercept(context: ExecutionContext, next: CallHandler): Observable<any> {
+    return next.handle().pipe(timeout(5000));
+  }
+}
diff --git a/integration/inspector/src/common/middleware/logger.middleware.ts b/integration/inspector/src/common/middleware/logger.middleware.ts
new file mode 100644
index 000000000..5ada9418d
--- /dev/null
+++ b/integration/inspector/src/common/middleware/logger.middleware.ts
@@ -0,0 +1,9 @@
+import { Injectable, NestMiddleware } from '@nestjs/common';
+
+@Injectable()
+export class LoggerMiddleware implements NestMiddleware {
+  use(req: any, res: any, next: () => void) {
+    console.log(`Request...`);
+    next();
+  }
+}
diff --git a/integration/inspector/src/common/pipes/parse-int.pipe.ts b/integration/inspector/src/common/pipes/parse-int.pipe.ts
new file mode 100644
index 000000000..abc041424
--- /dev/null
+++ b/integration/inspector/src/common/pipes/parse-int.pipe.ts
@@ -0,0 +1,17 @@
+import {
+  BadRequestException,
+  PipeTransform,
+  Injectable,
+  ArgumentMetadata,
+} from '@nestjs/common';
+
+@Injectable()
+export class ParseIntPipe implements PipeTransform<string> {
+  async transform(value: string, metadata: ArgumentMetadata) {
+    const val = parseInt(value, 10);
+    if (isNaN(val)) {
+      throw new BadRequestException('Validation failed');
+    }
+    return val;
+  }
+}
diff --git a/integration/inspector/src/core/core.module.ts b/integration/inspector/src/core/core.module.ts
new file mode 100644
index 000000000..5bc1990b1
--- /dev/null
+++ b/integration/inspector/src/core/core.module.ts
@@ -0,0 +1,18 @@
+import { MiddlewareConsumer, Module, NestModule } from '@nestjs/common';
+import { APP_INTERCEPTOR } from '@nestjs/core';
+import { CatsController } from '../cats/cats.controller';
+import { LoggerMiddleware } from '../common/middleware/logger.middleware';
+import { LoggingInterceptor } from './interceptors/logging.interceptor';
+import { TransformInterceptor } from './interceptors/transform.interceptor';
+
+@Module({
+  providers: [
+    { provide: APP_INTERCEPTOR, useClass: TransformInterceptor },
+    { provide: APP_INTERCEPTOR, useClass: LoggingInterceptor },
+  ],
+})
+export class CoreModule implements NestModule {
+  configure(consumer: MiddlewareConsumer) {
+    consumer.apply(LoggerMiddleware).forRoutes(CatsController);
+  }
+}
diff --git a/integration/inspector/src/core/interceptors/logging.interceptor.ts b/integration/inspector/src/core/interceptors/logging.interceptor.ts
new file mode 100644
index 000000000..82ff0baa1
--- /dev/null
+++ b/integration/inspector/src/core/interceptors/logging.interceptor.ts
@@ -0,0 +1,20 @@
+import {
+  CallHandler,
+  ExecutionContext,
+  Injectable,
+  NestInterceptor,
+} from '@nestjs/common';
+import { Observable } from 'rxjs';
+import { tap } from 'rxjs/operators';
+
+@Injectable()
+export class LoggingInterceptor implements NestInterceptor {
+  intercept(context: ExecutionContext, next: CallHandler): Observable<any> {
+    console.log('Before...');
+
+    const now = Date.now();
+    return next
+      .handle()
+      .pipe(tap(() => console.log(`After... ${Date.now() - now}ms`)));
+  }
+}
diff --git a/integration/inspector/src/core/interceptors/transform.interceptor.ts b/integration/inspector/src/core/interceptors/transform.interceptor.ts
new file mode 100644
index 000000000..c84c6428f
--- /dev/null
+++ b/integration/inspector/src/core/interceptors/transform.interceptor.ts
@@ -0,0 +1,24 @@
+import {
+  CallHandler,
+  ExecutionContext,
+  Injectable,
+  NestInterceptor,
+} from '@nestjs/common';
+import { Observable } from 'rxjs';
+import { map } from 'rxjs/operators';
+
+export interface Response<T> {
+  data: T;
+}
+
+@Injectable()
+export class TransformInterceptor<T>
+  implements NestInterceptor<T, Response<T>>
+{
+  intercept(
+    context: ExecutionContext,
+    next: CallHandler<T>,
+  ): Observable<Response<T>> {
+    return next.handle().pipe(map(data => ({ data })));
+  }
+}
diff --git a/integration/inspector/src/database/database.controller.ts b/integration/inspector/src/database/database.controller.ts
new file mode 100644
index 000000000..629762ae0
--- /dev/null
+++ b/integration/inspector/src/database/database.controller.ts
@@ -0,0 +1,45 @@
+import {
+  Controller,
+  Get,
+  Post,
+  Body,
+  Patch,
+  Param,
+  Delete,
+} from '@nestjs/common';
+import { DatabaseService } from './database.service';
+import { CreateDatabaseDto } from './dto/create-database.dto';
+import { UpdateDatabaseDto } from './dto/update-database.dto';
+
+@Controller('database')
+export class DatabaseController {
+  constructor(private readonly databaseService: DatabaseService) {}
+
+  @Post()
+  create(@Body() createDatabaseDto: CreateDatabaseDto) {
+    return this.databaseService.create(createDatabaseDto);
+  }
+
+  @Get()
+  findAll() {
+    return this.databaseService.findAll();
+  }
+
+  @Get(':id')
+  findOne(@Param('id') id: string) {
+    return this.databaseService.findOne(+id);
+  }
+
+  @Patch(':id')
+  update(
+    @Param('id') id: string,
+    @Body() updateDatabaseDto: UpdateDatabaseDto,
+  ) {
+    return this.databaseService.update(+id, updateDatabaseDto);
+  }
+
+  @Delete(':id')
+  remove(@Param('id') id: string) {
+    return this.databaseService.remove(+id);
+  }
+}
diff --git a/integration/inspector/src/database/database.module.ts b/integration/inspector/src/database/database.module.ts
new file mode 100644
index 000000000..2f37f674b
--- /dev/null
+++ b/integration/inspector/src/database/database.module.ts
@@ -0,0 +1,9 @@
+import { Module } from '@nestjs/common';
+import { DatabaseService } from './database.service';
+import { DatabaseController } from './database.controller';
+
+@Module({
+  controllers: [DatabaseController],
+  providers: [DatabaseService],
+})
+export class DatabaseModule {}
diff --git a/integration/inspector/src/database/database.service.ts b/integration/inspector/src/database/database.service.ts
new file mode 100644
index 000000000..845667895
--- /dev/null
+++ b/integration/inspector/src/database/database.service.ts
@@ -0,0 +1,26 @@
+import { Injectable } from '@nestjs/common';
+import { CreateDatabaseDto } from './dto/create-database.dto';
+import { UpdateDatabaseDto } from './dto/update-database.dto';
+
+@Injectable()
+export class DatabaseService {
+  create(createDatabaseDto: CreateDatabaseDto) {
+    return 'This action adds a new database';
+  }
+
+  findAll() {
+    return `This action returns all database`;
+  }
+
+  findOne(id: number) {
+    return `This action returns a #${id} database`;
+  }
+
+  update(id: number, updateDatabaseDto: UpdateDatabaseDto) {
+    return `This action updates a #${id} database`;
+  }
+
+  remove(id: number) {
+    return `This action removes a #${id} database`;
+  }
+}
diff --git a/integration/inspector/src/database/dto/create-database.dto.ts b/integration/inspector/src/database/dto/create-database.dto.ts
new file mode 100644
index 000000000..0b7bc753c
--- /dev/null
+++ b/integration/inspector/src/database/dto/create-database.dto.ts
@@ -0,0 +1 @@
+export class CreateDatabaseDto {}
diff --git a/integration/inspector/src/database/dto/update-database.dto.ts b/integration/inspector/src/database/dto/update-database.dto.ts
new file mode 100644
index 000000000..5cc666665
--- /dev/null
+++ b/integration/inspector/src/database/dto/update-database.dto.ts
@@ -0,0 +1,4 @@
+import { PartialType } from '@nestjs/mapped-types';
+import { CreateDatabaseDto } from './create-database.dto';
+
+export class UpdateDatabaseDto extends PartialType(CreateDatabaseDto) {}
diff --git a/integration/inspector/src/database/entities/database.entity.ts b/integration/inspector/src/database/entities/database.entity.ts
new file mode 100644
index 000000000..144f2990d
--- /dev/null
+++ b/integration/inspector/src/database/entities/database.entity.ts
@@ -0,0 +1 @@
+export class Database {}
diff --git a/integration/inspector/src/defaults/core.service.ts b/integration/inspector/src/defaults/core.service.ts
new file mode 100644
index 000000000..acbb46cc2
--- /dev/null
+++ b/integration/inspector/src/defaults/core.service.ts
@@ -0,0 +1,4 @@
+import { Injectable } from '@nestjs/common';
+
+@Injectable()
+export class CoreService {}
diff --git a/integration/inspector/src/defaults/defaults.module.ts b/integration/inspector/src/defaults/defaults.module.ts
new file mode 100644
index 000000000..f8a7ddb9f
--- /dev/null
+++ b/integration/inspector/src/defaults/defaults.module.ts
@@ -0,0 +1,7 @@
+import { Module } from '@nestjs/common';
+import { DefaultsService } from './defaults.service';
+
+@Module({
+  providers: [DefaultsService],
+})
+export class DefaultsModule {}
diff --git a/integration/inspector/src/defaults/defaults.service.ts b/integration/inspector/src/defaults/defaults.service.ts
new file mode 100644
index 000000000..edc4790f1
--- /dev/null
+++ b/integration/inspector/src/defaults/defaults.service.ts
@@ -0,0 +1,11 @@
+import { Inject, Injectable, Optional } from '@nestjs/common';
+import { CoreService } from './core.service';
+
+@Injectable()
+export class DefaultsService {
+  constructor(
+    @Inject(CoreService)
+    @Optional()
+    public readonly coreService = { default: true },
+  ) {}
+}
diff --git a/integration/inspector/src/dogs/dogs.controller.ts b/integration/inspector/src/dogs/dogs.controller.ts
new file mode 100644
index 000000000..8d5ab7d8a
--- /dev/null
+++ b/integration/inspector/src/dogs/dogs.controller.ts
@@ -0,0 +1,42 @@
+import {
+  Controller,
+  Get,
+  Post,
+  Body,
+  Patch,
+  Param,
+  Delete,
+} from '@nestjs/common';
+import { DogsService } from './dogs.service';
+import { CreateDogDto } from './dto/create-dog.dto';
+import { UpdateDogDto } from './dto/update-dog.dto';
+
+@Controller('dogs')
+export class DogsController {
+  constructor(private readonly dogsService: DogsService) {}
+
+  @Post()
+  create(@Body() createDogDto: CreateDogDto) {
+    return this.dogsService.create(createDogDto);
+  }
+
+  @Get()
+  findAll() {
+    return this.dogsService.findAll();
+  }
+
+  @Get(':id')
+  findOne(@Param('id') id: string) {
+    return this.dogsService.findOne(+id);
+  }
+
+  @Patch(':id')
+  update(@Param('id') id: string, @Body() updateDogDto: UpdateDogDto) {
+    return this.dogsService.update(+id, updateDogDto);
+  }
+
+  @Delete(':id')
+  remove(@Param('id') id: string) {
+    return this.dogsService.remove(+id);
+  }
+}
diff --git a/integration/inspector/src/dogs/dogs.module.ts b/integration/inspector/src/dogs/dogs.module.ts
new file mode 100644
index 000000000..3385a39e3
--- /dev/null
+++ b/integration/inspector/src/dogs/dogs.module.ts
@@ -0,0 +1,9 @@
+import { Module } from '@nestjs/common';
+import { DogsService } from './dogs.service';
+import { DogsController } from './dogs.controller';
+
+@Module({
+  controllers: [DogsController],
+  providers: [DogsService],
+})
+export class DogsModule {}
diff --git a/integration/inspector/src/dogs/dogs.service.ts b/integration/inspector/src/dogs/dogs.service.ts
new file mode 100644
index 000000000..f1f2d9347
--- /dev/null
+++ b/integration/inspector/src/dogs/dogs.service.ts
@@ -0,0 +1,26 @@
+import { Injectable } from '@nestjs/common';
+import { CreateDogDto } from './dto/create-dog.dto';
+import { UpdateDogDto } from './dto/update-dog.dto';
+
+@Injectable()
+export class DogsService {
+  create(createDogDto: CreateDogDto) {
+    return 'This action adds a new dog';
+  }
+
+  findAll() {
+    return `This action returns all dogs`;
+  }
+
+  findOne(id: number) {
+    return `This action returns a #${id} dog`;
+  }
+
+  update(id: number, updateDogDto: UpdateDogDto) {
+    return `This action updates a #${id} dog`;
+  }
+
+  remove(id: number) {
+    return `This action removes a #${id} dog`;
+  }
+}
diff --git a/integration/inspector/src/dogs/dto/create-dog.dto.ts b/integration/inspector/src/dogs/dto/create-dog.dto.ts
new file mode 100644
index 000000000..fd21dff8a
--- /dev/null
+++ b/integration/inspector/src/dogs/dto/create-dog.dto.ts
@@ -0,0 +1 @@
+export class CreateDogDto {}
diff --git a/integration/inspector/src/dogs/dto/update-dog.dto.ts b/integration/inspector/src/dogs/dto/update-dog.dto.ts
new file mode 100644
index 000000000..15d4939c8
--- /dev/null
+++ b/integration/inspector/src/dogs/dto/update-dog.dto.ts
@@ -0,0 +1,4 @@
+import { PartialType } from '@nestjs/mapped-types';
+import { CreateDogDto } from './create-dog.dto';
+
+export class UpdateDogDto extends PartialType(CreateDogDto) {}
diff --git a/integration/inspector/src/dogs/entities/dog.entity.ts b/integration/inspector/src/dogs/entities/dog.entity.ts
new file mode 100644
index 000000000..cbd6231a1
--- /dev/null
+++ b/integration/inspector/src/dogs/entities/dog.entity.ts
@@ -0,0 +1 @@
+export class Dog {}
diff --git a/integration/inspector/src/durable/durable-context-id.strategy.ts b/integration/inspector/src/durable/durable-context-id.strategy.ts
new file mode 100644
index 000000000..d4158f3e2
--- /dev/null
+++ b/integration/inspector/src/durable/durable-context-id.strategy.ts
@@ -0,0 +1,23 @@
+import { ContextId, ContextIdStrategy, HostComponentInfo } from '@nestjs/core';
+import { Request } from 'express';
+
+const tenants = new Map<string, ContextId>();
+
+export class DurableContextIdStrategy implements ContextIdStrategy {
+  attach(contextId: ContextId, request: Request) {
+    const tenantId = request.headers['x-tenant-id'] as string;
+    let tenantSubTreeId: ContextId;
+
+    if (tenants.has(tenantId)) {
+      tenantSubTreeId = tenants.get(tenantId);
+    } else {
+      tenantSubTreeId = { id: +tenantId } as ContextId;
+      tenants.set(tenantId, tenantSubTreeId);
+    }
+    return {
+      resolve: (info: HostComponentInfo) =>
+        info.isTreeDurable ? tenantSubTreeId : contextId,
+      payload: { tenantId },
+    };
+  }
+}
diff --git a/integration/inspector/src/durable/durable.controller.ts b/integration/inspector/src/durable/durable.controller.ts
new file mode 100644
index 000000000..be51ad2df
--- /dev/null
+++ b/integration/inspector/src/durable/durable.controller.ts
@@ -0,0 +1,17 @@
+import { Controller, Get } from '@nestjs/common';
+import { DurableService } from './durable.service';
+
+@Controller('durable')
+export class DurableController {
+  constructor(private readonly durableService: DurableService) {}
+
+  @Get()
+  greeting(): string {
+    return this.durableService.greeting();
+  }
+
+  @Get('echo')
+  echo() {
+    return this.durableService.requestPayload;
+  }
+}
diff --git a/integration/inspector/src/durable/durable.module.ts b/integration/inspector/src/durable/durable.module.ts
new file mode 100644
index 000000000..ed312900f
--- /dev/null
+++ b/integration/inspector/src/durable/durable.module.ts
@@ -0,0 +1,9 @@
+import { Module } from '@nestjs/common';
+import { DurableController } from './durable.controller';
+import { DurableService } from './durable.service';
+
+@Module({
+  controllers: [DurableController],
+  providers: [DurableService],
+})
+export class DurableModule {}
diff --git a/integration/inspector/src/durable/durable.service.ts b/integration/inspector/src/durable/durable.service.ts
new file mode 100644
index 000000000..6e25b01dd
--- /dev/null
+++ b/integration/inspector/src/durable/durable.service.ts
@@ -0,0 +1,14 @@
+import { Inject, Injectable, Scope } from '@nestjs/common';
+import { REQUEST } from '@nestjs/core';
+
+@Injectable({ scope: Scope.REQUEST, durable: true })
+export class DurableService {
+  public instanceCounter = 0;
+
+  constructor(@Inject(REQUEST) public readonly requestPayload: unknown) {}
+
+  greeting() {
+    ++this.instanceCounter;
+    return `Hello world! Counter: ${this.instanceCounter}`;
+  }
+}
diff --git a/integration/inspector/src/external-svc/dto/create-external-svc.dto.ts b/integration/inspector/src/external-svc/dto/create-external-svc.dto.ts
new file mode 100644
index 000000000..b37586bc5
--- /dev/null
+++ b/integration/inspector/src/external-svc/dto/create-external-svc.dto.ts
@@ -0,0 +1 @@
+export class CreateExternalSvcDto {}
diff --git a/integration/inspector/src/external-svc/dto/update-external-svc.dto.ts b/integration/inspector/src/external-svc/dto/update-external-svc.dto.ts
new file mode 100644
index 000000000..95be362d9
--- /dev/null
+++ b/integration/inspector/src/external-svc/dto/update-external-svc.dto.ts
@@ -0,0 +1,6 @@
+import { PartialType } from '@nestjs/mapped-types';
+import { CreateExternalSvcDto } from './create-external-svc.dto';
+
+export class UpdateExternalSvcDto extends PartialType(CreateExternalSvcDto) {
+  id: number;
+}
diff --git a/integration/inspector/src/external-svc/entities/external-svc.entity.ts b/integration/inspector/src/external-svc/entities/external-svc.entity.ts
new file mode 100644
index 000000000..645900058
--- /dev/null
+++ b/integration/inspector/src/external-svc/entities/external-svc.entity.ts
@@ -0,0 +1 @@
+export class ExternalSvc {}
diff --git a/integration/inspector/src/external-svc/external-svc.controller.ts b/integration/inspector/src/external-svc/external-svc.controller.ts
new file mode 100644
index 000000000..e1e9e2247
--- /dev/null
+++ b/integration/inspector/src/external-svc/external-svc.controller.ts
@@ -0,0 +1,38 @@
+import { Controller } from '@nestjs/common';
+import { MessagePattern, Payload } from '@nestjs/microservices';
+import { CreateExternalSvcDto } from './dto/create-external-svc.dto';
+import { UpdateExternalSvcDto } from './dto/update-external-svc.dto';
+import { ExternalSvcService } from './external-svc.service';
+
+@Controller()
+export class ExternalSvcController {
+  constructor(private readonly externalSvcService: ExternalSvcService) {}
+
+  @MessagePattern('createExternalSvc')
+  create(@Payload() createExternalSvcDto: CreateExternalSvcDto) {
+    return this.externalSvcService.create(createExternalSvcDto);
+  }
+
+  @MessagePattern('findAllExternalSvc')
+  findAll() {
+    return this.externalSvcService.findAll();
+  }
+
+  @MessagePattern('findOneExternalSvc')
+  findOne(@Payload() id: number) {
+    return this.externalSvcService.findOne(id);
+  }
+
+  @MessagePattern('updateExternalSvc')
+  update(@Payload() updateExternalSvcDto: UpdateExternalSvcDto) {
+    return this.externalSvcService.update(
+      updateExternalSvcDto.id,
+      updateExternalSvcDto,
+    );
+  }
+
+  @MessagePattern('removeExternalSvc')
+  remove(@Payload() id: number) {
+    return this.externalSvcService.remove(id);
+  }
+}
diff --git a/integration/inspector/src/external-svc/external-svc.module.ts b/integration/inspector/src/external-svc/external-svc.module.ts
new file mode 100644
index 000000000..f4b57fc02
--- /dev/null
+++ b/integration/inspector/src/external-svc/external-svc.module.ts
@@ -0,0 +1,9 @@
+import { Module } from '@nestjs/common';
+import { ExternalSvcService } from './external-svc.service';
+import { ExternalSvcController } from './external-svc.controller';
+
+@Module({
+  controllers: [ExternalSvcController],
+  providers: [ExternalSvcService],
+})
+export class ExternalSvcModule {}
diff --git a/integration/inspector/src/external-svc/external-svc.service.ts b/integration/inspector/src/external-svc/external-svc.service.ts
new file mode 100644
index 000000000..9620630c2
--- /dev/null
+++ b/integration/inspector/src/external-svc/external-svc.service.ts
@@ -0,0 +1,26 @@
+import { Injectable } from '@nestjs/common';
+import { CreateExternalSvcDto } from './dto/create-external-svc.dto';
+import { UpdateExternalSvcDto } from './dto/update-external-svc.dto';
+
+@Injectable()
+export class ExternalSvcService {
+  create(createExternalSvcDto: CreateExternalSvcDto) {
+    return 'This action adds a new externalSvc';
+  }
+
+  findAll() {
+    return `This action returns all externalSvc`;
+  }
+
+  findOne(id: number) {
+    return `This action returns a #${id} externalSvc`;
+  }
+
+  update(id: number, updateExternalSvcDto: UpdateExternalSvcDto) {
+    return `This action updates a #${id} externalSvc`;
+  }
+
+  remove(id: number) {
+    return `This action removes a #${id} externalSvc`;
+  }
+}
diff --git a/integration/inspector/src/properties/dependency.service.ts b/integration/inspector/src/properties/dependency.service.ts
new file mode 100644
index 000000000..cd71d8c80
--- /dev/null
+++ b/integration/inspector/src/properties/dependency.service.ts
@@ -0,0 +1,4 @@
+import { Injectable } from '@nestjs/common';
+
+@Injectable()
+export class DependencyService {}
diff --git a/integration/inspector/src/properties/properties.module.ts b/integration/inspector/src/properties/properties.module.ts
new file mode 100644
index 000000000..b2ad36ff3
--- /dev/null
+++ b/integration/inspector/src/properties/properties.module.ts
@@ -0,0 +1,19 @@
+import { Module } from '@nestjs/common';
+import { DependencyService } from './dependency.service';
+import { PropertiesService, SYMBOL_TOKEN } from './properties.service';
+
+@Module({
+  providers: [
+    DependencyService,
+    PropertiesService,
+    {
+      provide: 'token',
+      useValue: true,
+    },
+    {
+      provide: SYMBOL_TOKEN,
+      useValue: true,
+    },
+  ],
+})
+export class PropertiesModule {}
diff --git a/integration/inspector/src/properties/properties.service.ts b/integration/inspector/src/properties/properties.service.ts
new file mode 100644
index 000000000..cd4507524
--- /dev/null
+++ b/integration/inspector/src/properties/properties.service.ts
@@ -0,0 +1,11 @@
+import { Inject, Injectable } from '@nestjs/common';
+import { DependencyService } from './dependency.service';
+
+export const SYMBOL_TOKEN = Symbol('token');
+
+@Injectable()
+export class PropertiesService {
+  @Inject() service: DependencyService;
+  @Inject('token') token: boolean;
+  @Inject(SYMBOL_TOKEN) symbolToken: boolean;
+}
diff --git a/integration/inspector/src/request-chain/helper/helper.module.ts b/integration/inspector/src/request-chain/helper/helper.module.ts
new file mode 100644
index 000000000..1c154ea44
--- /dev/null
+++ b/integration/inspector/src/request-chain/helper/helper.module.ts
@@ -0,0 +1,8 @@
+import { Module } from '@nestjs/common';
+import { HelperService } from './helper.service';
+
+@Module({
+  providers: [HelperService],
+  exports: [HelperService],
+})
+export class HelperModule {}
diff --git a/integration/inspector/src/request-chain/helper/helper.service.ts b/integration/inspector/src/request-chain/helper/helper.service.ts
new file mode 100644
index 000000000..52efe0eb2
--- /dev/null
+++ b/integration/inspector/src/request-chain/helper/helper.service.ts
@@ -0,0 +1,9 @@
+import { Inject, Injectable, Scope } from '@nestjs/common';
+import { REQUEST } from '@nestjs/core';
+
+@Injectable({ scope: Scope.REQUEST })
+export class HelperService {
+  constructor(@Inject(REQUEST) public readonly request) {}
+
+  public noop() {}
+}
diff --git a/integration/inspector/src/request-chain/interceptors/logging.interceptor.ts b/integration/inspector/src/request-chain/interceptors/logging.interceptor.ts
new file mode 100644
index 000000000..008a69993
--- /dev/null
+++ b/integration/inspector/src/request-chain/interceptors/logging.interceptor.ts
@@ -0,0 +1,21 @@
+import {
+  CallHandler,
+  ExecutionContext,
+  Injectable,
+  NestInterceptor,
+} from '@nestjs/common';
+import { Observable } from 'rxjs';
+import { HelperService } from '../helper/helper.service';
+
+@Injectable()
+export class LoggingInterceptor implements NestInterceptor {
+  constructor(private readonly helperSvc: HelperService) {}
+
+  intercept(context: ExecutionContext, next: CallHandler): Observable<any> {
+    this.helperSvc.noop();
+    if (!this.helperSvc.request) {
+      throw new Error('error');
+    }
+    return next.handle();
+  }
+}
diff --git a/integration/inspector/src/request-chain/request-chain.controller.ts b/integration/inspector/src/request-chain/request-chain.controller.ts
new file mode 100644
index 000000000..03813352d
--- /dev/null
+++ b/integration/inspector/src/request-chain/request-chain.controller.ts
@@ -0,0 +1,14 @@
+import { Controller, Get, UseInterceptors } from '@nestjs/common';
+import { LoggingInterceptor } from './interceptors/logging.interceptor';
+import { RequestChainService } from './request-chain.service';
+
+@Controller('hello')
+export class RequestChainController {
+  constructor(private readonly chainService: RequestChainService) {}
+
+  @UseInterceptors(LoggingInterceptor)
+  @Get()
+  greeting(): void {
+    this.chainService.call();
+  }
+}
diff --git a/integration/inspector/src/request-chain/request-chain.module.ts b/integration/inspector/src/request-chain/request-chain.module.ts
new file mode 100644
index 000000000..eba8f451d
--- /dev/null
+++ b/integration/inspector/src/request-chain/request-chain.module.ts
@@ -0,0 +1,11 @@
+import { Module } from '@nestjs/common';
+import { HelperModule } from './helper/helper.module';
+import { RequestChainController } from './request-chain.controller';
+import { RequestChainService } from './request-chain.service';
+
+@Module({
+  imports: [HelperModule],
+  providers: [RequestChainService],
+  controllers: [RequestChainController],
+})
+export class RequestChainModule {}
diff --git a/integration/inspector/src/request-chain/request-chain.service.ts b/integration/inspector/src/request-chain/request-chain.service.ts
new file mode 100644
index 000000000..c8c00068d
--- /dev/null
+++ b/integration/inspector/src/request-chain/request-chain.service.ts
@@ -0,0 +1,15 @@
+import { Injectable } from '@nestjs/common';
+import { HelperService } from './helper/helper.service';
+
+@Injectable()
+export class RequestChainService {
+  static COUNTER = 0;
+  constructor(private readonly helperService: HelperService) {
+    helperService.noop();
+    RequestChainService.COUNTER += 1;
+  }
+
+  call() {
+    this.helperService.noop();
+  }
+}
diff --git a/integration/inspector/src/users/dto/create-user.dto.ts b/integration/inspector/src/users/dto/create-user.dto.ts
new file mode 100644
index 000000000..0311be138
--- /dev/null
+++ b/integration/inspector/src/users/dto/create-user.dto.ts
@@ -0,0 +1 @@
+export class CreateUserDto {}
diff --git a/integration/inspector/src/users/dto/update-user.dto.ts b/integration/inspector/src/users/dto/update-user.dto.ts
new file mode 100644
index 000000000..dfd37fb1e
--- /dev/null
+++ b/integration/inspector/src/users/dto/update-user.dto.ts
@@ -0,0 +1,4 @@
+import { PartialType } from '@nestjs/mapped-types';
+import { CreateUserDto } from './create-user.dto';
+
+export class UpdateUserDto extends PartialType(CreateUserDto) {}
diff --git a/integration/inspector/src/users/entities/user.entity.ts b/integration/inspector/src/users/entities/user.entity.ts
new file mode 100644
index 000000000..4f82c1457
--- /dev/null
+++ b/integration/inspector/src/users/entities/user.entity.ts
@@ -0,0 +1 @@
+export class User {}
diff --git a/integration/inspector/src/users/users.controller.ts b/integration/inspector/src/users/users.controller.ts
new file mode 100644
index 000000000..d5db3a65e
--- /dev/null
+++ b/integration/inspector/src/users/users.controller.ts
@@ -0,0 +1,42 @@
+import {
+  Controller,
+  Get,
+  Post,
+  Body,
+  Patch,
+  Param,
+  Delete,
+} from '@nestjs/common';
+import { UsersService } from './users.service';
+import { CreateUserDto } from './dto/create-user.dto';
+import { UpdateUserDto } from './dto/update-user.dto';
+
+@Controller('users')
+export class UsersController {
+  constructor(private readonly usersService: UsersService) {}
+
+  @Post()
+  create(@Body() createUserDto: CreateUserDto) {
+    return this.usersService.create(createUserDto);
+  }
+
+  @Get()
+  findAll() {
+    return this.usersService.findAll();
+  }
+
+  @Get(':id')
+  findOne(@Param('id') id: string) {
+    return this.usersService.findOne(+id);
+  }
+
+  @Patch(':id')
+  update(@Param('id') id: string, @Body() updateUserDto: UpdateUserDto) {
+    return this.usersService.update(+id, updateUserDto);
+  }
+
+  @Delete(':id')
+  remove(@Param('id') id: string) {
+    return this.usersService.remove(+id);
+  }
+}
diff --git a/integration/inspector/src/users/users.module.ts b/integration/inspector/src/users/users.module.ts
new file mode 100644
index 000000000..ecca17ad6
--- /dev/null
+++ b/integration/inspector/src/users/users.module.ts
@@ -0,0 +1,9 @@
+import { Module } from '@nestjs/common';
+import { UsersService } from './users.service';
+import { UsersController } from './users.controller';
+
+@Module({
+  controllers: [UsersController],
+  providers: [UsersService],
+})
+export class UsersModule {}
diff --git a/integration/inspector/src/users/users.service.ts b/integration/inspector/src/users/users.service.ts
new file mode 100644
index 000000000..0a55903da
--- /dev/null
+++ b/integration/inspector/src/users/users.service.ts
@@ -0,0 +1,26 @@
+import { Injectable } from '@nestjs/common';
+import { CreateUserDto } from './dto/create-user.dto';
+import { UpdateUserDto } from './dto/update-user.dto';
+
+@Injectable()
+export class UsersService {
+  create(createUserDto: CreateUserDto) {
+    return 'This action adds a new user';
+  }
+
+  findAll() {
+    return `This action returns all users`;
+  }
+
+  findOne(id: number) {
+    return `This action returns a #${id} user`;
+  }
+
+  update(id: number, updateUserDto: UpdateUserDto) {
+    return `This action updates a #${id} user`;
+  }
+
+  remove(id: number) {
+    return `This action removes a #${id} user`;
+  }
+}
diff --git a/integration/inspector/tsconfig.json b/integration/inspector/tsconfig.json
new file mode 100644
index 000000000..4a0f01e0e
--- /dev/null
+++ b/integration/inspector/tsconfig.json
@@ -0,0 +1,41 @@
+{
+  "compilerOptions": {
+    "module": "commonjs",
+    "declaration": false,
+    "noImplicitAny": false,
+    "removeComments": true,
+    "noLib": false,
+    "emitDecoratorMetadata": true,
+    "experimentalDecorators": true,
+    "target": "ES2021",
+    "sourceMap": true,
+    "allowJs": true,
+    "strictNullChecks": true,
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
+  },
+  "include": [
+    "src/**/*",
+    "e2e/**/*"
+  ],
+  "exclude": [
+    "node_modules",
+  ]
+}
\ No newline at end of file
diff --git a/integration/lazy-modules/e2e/lazy-import-global-modules.spec.ts b/integration/lazy-modules/e2e/lazy-import-global-modules.spec.ts
new file mode 100644
index 000000000..7bb41fb4e
--- /dev/null
+++ b/integration/lazy-modules/e2e/lazy-import-global-modules.spec.ts
@@ -0,0 +1,27 @@
+import { INestApplication } from '@nestjs/common';
+import { Test } from '@nestjs/testing';
+import * as chai from 'chai';
+import { expect } from 'chai';
+import { AppModule } from '../src/app.module';
+import chaiAsPromised = require('chai-as-promised');
+chai.use(chaiAsPromised);
+
+describe('Lazy imports', () => {
+  let app: INestApplication;
+
+  beforeEach(async () => {
+    const module = await Test.createTestingModule({
+      imports: [AppModule],
+    }).compile();
+
+    app = module.createNestApplication();
+  });
+
+  it(`should allow imports of global modules`, async () => {
+    await expect(app.init()).to.eventually.be.fulfilled;
+  });
+
+  afterEach(async () => {
+    await app.close();
+  });
+});
diff --git a/integration/lazy-modules/e2e/lazy-import-transient-providers.spec.ts b/integration/lazy-modules/e2e/lazy-import-transient-providers.spec.ts
new file mode 100644
index 000000000..ce34a3347
--- /dev/null
+++ b/integration/lazy-modules/e2e/lazy-import-transient-providers.spec.ts
@@ -0,0 +1,32 @@
+import { INestApplication } from '@nestjs/common';
+import { Test } from '@nestjs/testing';
+import { TransientLazyModule } from '../src/transient.module';
+import { LazyController } from '../src/lazy.controller';
+import * as chai from 'chai';
+import { expect } from 'chai';
+import * as request from 'supertest';
+
+describe('Lazy Transient providers', () => {
+  let app: INestApplication;
+
+  beforeEach(async () => {
+    const module = await Test.createTestingModule({
+      controllers: [LazyController],
+    }).compile();
+
+    app = module.createNestApplication();
+    await app.init();
+  });
+
+  it('should not recreate dependencies for default scope', async () => {
+    const resultOne = await request(app.getHttpServer()).get('/lazy/transient');
+
+    const resultTwo = await request(app.getHttpServer()).get('/lazy/transient');
+
+    expect(resultOne.text).to.be.equal('Hi! Counter is 1');
+    expect(resultOne.statusCode).to.be.equal(200);
+
+    expect(resultTwo.text).to.be.equal('Hi! Counter is 2');
+    expect(resultTwo.statusCode).to.be.equal(200);
+  });
+});
diff --git a/integration/lazy-modules/src/app.module.ts b/integration/lazy-modules/src/app.module.ts
new file mode 100644
index 000000000..65d38dadc
--- /dev/null
+++ b/integration/lazy-modules/src/app.module.ts
@@ -0,0 +1,16 @@
+import { Module } from '@nestjs/common';
+import { LazyModuleLoader } from '@nestjs/core';
+import { EagerModule } from './eager.module';
+import { GlobalModule } from './global.module';
+import { LazyModule } from './lazy.module';
+
+@Module({
+  imports: [GlobalModule, EagerModule],
+})
+export class AppModule {
+  constructor(public loader: LazyModuleLoader) {}
+
+  async onApplicationBootstrap() {
+    await this.loader.load(() => LazyModule);
+  }
+}
diff --git a/integration/lazy-modules/src/eager.module.ts b/integration/lazy-modules/src/eager.module.ts
new file mode 100644
index 000000000..f50669ee9
--- /dev/null
+++ b/integration/lazy-modules/src/eager.module.ts
@@ -0,0 +1,18 @@
+import { Module, Injectable } from '@nestjs/common';
+import { GlobalService } from './global.module';
+
+@Injectable()
+export class EagerService {
+  private counter = 0;
+  constructor(public globalService: GlobalService) {}
+
+  sayHello() {
+    this.counter++;
+    return 'Hi! Counter is ' + this.counter;
+  }
+}
+
+@Module({
+  providers: [EagerService],
+})
+export class EagerModule {}
diff --git a/integration/lazy-modules/src/global.module.ts b/integration/lazy-modules/src/global.module.ts
new file mode 100644
index 000000000..8eaa76cd5
--- /dev/null
+++ b/integration/lazy-modules/src/global.module.ts
@@ -0,0 +1,13 @@
+import { Module, Injectable, Global } from '@nestjs/common';
+
+@Injectable()
+export class GlobalService {
+  constructor() {}
+}
+
+@Global()
+@Module({
+  providers: [GlobalService],
+  exports: [GlobalService],
+})
+export class GlobalModule {}
diff --git a/integration/lazy-modules/src/lazy.controller.ts b/integration/lazy-modules/src/lazy.controller.ts
new file mode 100644
index 000000000..58575d729
--- /dev/null
+++ b/integration/lazy-modules/src/lazy.controller.ts
@@ -0,0 +1,18 @@
+import { Controller, Get } from '@nestjs/common';
+import { LazyModuleLoader } from '@nestjs/core';
+
+@Controller('lazy')
+export class LazyController {
+  constructor(private lazyLoadModule: LazyModuleLoader) {}
+
+  @Get('transient')
+  async exec() {
+    const { TransientLazyModule } = await import('./transient.module');
+    const moduleRef = await this.lazyLoadModule.load(() => TransientLazyModule);
+
+    const { TransientService } = await import('./transient.service');
+    const _service = await moduleRef.resolve(TransientService);
+
+    return _service.eager();
+  }
+}
diff --git a/integration/lazy-modules/src/lazy.module.ts b/integration/lazy-modules/src/lazy.module.ts
new file mode 100644
index 000000000..69c056435
--- /dev/null
+++ b/integration/lazy-modules/src/lazy.module.ts
@@ -0,0 +1,12 @@
+import { Module, Injectable } from '@nestjs/common';
+import { GlobalService } from './global.module';
+
+@Injectable()
+export class LazyService {
+  constructor(public globalService: GlobalService) {}
+}
+
+@Module({
+  providers: [LazyService],
+})
+export class LazyModule {}
diff --git a/integration/lazy-modules/src/main.ts b/integration/lazy-modules/src/main.ts
new file mode 100644
index 000000000..23f3240c2
--- /dev/null
+++ b/integration/lazy-modules/src/main.ts
@@ -0,0 +1,8 @@
+import { NestFactory } from '@nestjs/core';
+import { AppModule } from './app.module';
+
+async function bootstrap() {
+  const app = await NestFactory.create(AppModule);
+  await app.listen(3000);
+}
+void bootstrap();
diff --git a/integration/lazy-modules/src/transient.module.ts b/integration/lazy-modules/src/transient.module.ts
new file mode 100644
index 000000000..b76a686fe
--- /dev/null
+++ b/integration/lazy-modules/src/transient.module.ts
@@ -0,0 +1,11 @@
+import { Module } from '@nestjs/common';
+import { GlobalService } from './global.module';
+import { EagerService } from './eager.module';
+import { TransientService } from './transient.service';
+
+@Module({
+  imports: [],
+  providers: [TransientService, GlobalService, EagerService],
+  exports: [TransientService],
+})
+export class TransientLazyModule {}
diff --git a/integration/lazy-modules/src/transient.service.ts b/integration/lazy-modules/src/transient.service.ts
new file mode 100644
index 000000000..fca763228
--- /dev/null
+++ b/integration/lazy-modules/src/transient.service.ts
@@ -0,0 +1,11 @@
+import { Injectable, Scope } from '@nestjs/common';
+import { EagerService } from './eager.module';
+
+@Injectable({ scope: Scope.TRANSIENT })
+export class TransientService {
+  constructor(private eagerService: EagerService) {}
+
+  eager() {
+    return this.eagerService.sayHello();
+  }
+}
diff --git a/integration/lazy-modules/tsconfig.json b/integration/lazy-modules/tsconfig.json
new file mode 100644
index 000000000..4a0f01e0e
--- /dev/null
+++ b/integration/lazy-modules/tsconfig.json
@@ -0,0 +1,41 @@
+{
+  "compilerOptions": {
+    "module": "commonjs",
+    "declaration": false,
+    "noImplicitAny": false,
+    "removeComments": true,
+    "noLib": false,
+    "emitDecoratorMetadata": true,
+    "experimentalDecorators": true,
+    "target": "ES2021",
+    "sourceMap": true,
+    "allowJs": true,
+    "strictNullChecks": true,
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
+  },
+  "include": [
+    "src/**/*",
+    "e2e/**/*"
+  ],
+  "exclude": [
+    "node_modules",
+  ]
+}
\ No newline at end of file
diff --git a/integration/microservices/e2e/broadcast-mqtt.spec.ts b/integration/microservices/e2e/broadcast-mqtt.spec.ts
index 6ace4d6b5..641bf442a 100644
--- a/integration/microservices/e2e/broadcast-mqtt.spec.ts
+++ b/integration/microservices/e2e/broadcast-mqtt.spec.ts
@@ -1,5 +1,5 @@
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
 import { MqttBroadcastController } from '../src/mqtt/mqtt-broadcast.controller';
@@ -16,13 +16,13 @@ describe('MQTT transport', () => {
     app = module.createNestApplication();
     server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.MQTT,
       options: {
         host: '0.0.0.0',
       },
     });
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.MQTT,
       options: {
         host: '0.0.0.0',
diff --git a/integration/microservices/e2e/broadcast-nats.spec.ts b/integration/microservices/e2e/broadcast-nats.spec.ts
index ecd45cd15..b8cf69b50 100644
--- a/integration/microservices/e2e/broadcast-nats.spec.ts
+++ b/integration/microservices/e2e/broadcast-nats.spec.ts
@@ -1,5 +1,5 @@
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
 import { NatsBroadcastController } from '../src/nats/nats-broadcast.controller';
@@ -16,13 +16,13 @@ describe('NATS transport', () => {
     app = module.createNestApplication();
     server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.NATS,
       options: {
         servers: 'nats://0.0.0.0:4222',
       },
     });
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.NATS,
       options: {
         servers: 'servers://0.0.0.0:4222',
diff --git a/integration/microservices/e2e/broadcast-redis.spec.ts b/integration/microservices/e2e/broadcast-redis.spec.ts
index 2a9106f2f..1cf8690ef 100644
--- a/integration/microservices/e2e/broadcast-redis.spec.ts
+++ b/integration/microservices/e2e/broadcast-redis.spec.ts
@@ -1,5 +1,5 @@
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
 import { RedisBroadcastController } from '../src/redis/redis-broadcast.controller';
@@ -16,16 +16,18 @@ describe('REDIS transport', () => {
     app = module.createNestApplication();
     server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.REDIS,
       options: {
-        url: 'redis://0.0.0.0:6379',
+        host: '0.0.0.0',
+        port: 6379,
       },
     });
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.REDIS,
       options: {
-        url: 'redis://0.0.0.0:6379',
+        host: '0.0.0.0',
+        port: 6379,
       },
     });
     await app.startAllMicroservices();
diff --git a/integration/microservices/e2e/concurrent-kafka.spec.ts b/integration/microservices/e2e/concurrent-kafka.spec.ts
index f50a7b329..11dd0dbb7 100644
--- a/integration/microservices/e2e/concurrent-kafka.spec.ts
+++ b/integration/microservices/e2e/concurrent-kafka.spec.ts
@@ -1,5 +1,5 @@
 import { INestApplication, Logger } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import { Admin, ITopicMetadata, Kafka } from 'kafkajs';
 import * as request from 'supertest';
@@ -37,7 +37,7 @@ describe.skip('Kafka concurrent', function () {
 
     const server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.KAFKA,
       options: {
         client: {
@@ -100,7 +100,7 @@ describe.skip('Kafka concurrent', function () {
       }
     }
 
-    if (topicMetadata && topicMetadata.topics.length > 0) {
+    if (topicMetadata! && topicMetadata.topics.length > 0) {
       // we have topics, how many partitions do they have?
       for (const topic of topicMetadata.topics) {
         if (topic.partitions.length < numbersOfServers) {
diff --git a/integration/microservices/e2e/disconnected-client.spec.ts b/integration/microservices/e2e/disconnected-client.spec.ts
index 39feaeb34..706c2e059 100644
--- a/integration/microservices/e2e/disconnected-client.spec.ts
+++ b/integration/microservices/e2e/disconnected-client.spec.ts
@@ -2,10 +2,11 @@ import { INestApplication } from '@nestjs/common';
 import { Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
+import { App } from 'supertest/types';
 import { DisconnectedClientController } from '../src/disconnected.controller';
 
 describe('Disconnected client', () => {
-  let server;
+  let server: App;
   let app: INestApplication;
 
   beforeEach(async () => {
@@ -34,7 +35,7 @@ describe('Disconnected client', () => {
       .send({
         transport: Transport.REDIS,
         options: {
-          url: 'redis://localhost:3333',
+          port: '3333',
         },
       })
       .expect(408);
diff --git a/integration/microservices/e2e/sum-grpc.spec.ts b/integration/microservices/e2e/math-grpc.spec.ts
similarity index 52%
rename from integration/microservices/e2e/sum-grpc.spec.ts
rename to integration/microservices/e2e/math-grpc.spec.ts
index d292c3c21..8a80ced27 100644
--- a/integration/microservices/e2e/sum-grpc.spec.ts
+++ b/integration/microservices/e2e/math-grpc.spec.ts
@@ -1,14 +1,18 @@
 import * as GRPC from '@grpc/grpc-js';
 import * as ProtoLoader from '@grpc/proto-loader';
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import { fail } from 'assert';
-import { expect } from 'chai';
+import { expect, use } from 'chai';
+import * as chaiAsPromised from 'chai-as-promised';
 import { join } from 'path';
+import * as sinon from 'sinon';
 import * as request from 'supertest';
 import { GrpcController } from '../src/grpc/grpc.controller';
 
+use(chaiAsPromised);
+
 describe('GRPC transport', () => {
   let server;
   let app: INestApplication;
@@ -22,7 +26,7 @@ describe('GRPC transport', () => {
     app = module.createNestApplication();
     server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.GRPC,
       options: {
         package: ['math', 'math2'],
@@ -32,6 +36,7 @@ describe('GRPC transport', () => {
         ],
       },
     });
+
     // Start gRPC microservice
     await app.startAllMicroservices();
     await app.init();
@@ -48,11 +53,28 @@ describe('GRPC transport', () => {
     );
   });
 
-  it(`GRPC Sending and Receiving HTTP POST`, () => {
-    return request(server)
+  it(`GRPC Sending and Receiving HTTP POST`, async () => {
+    await request(server)
       .post('/sum')
       .send([1, 2, 3, 4, 5])
       .expect(200, { result: 15 });
+
+    await request(server)
+      .post('/upperMethod/sum')
+      .send([1, 2, 3, 4, 5])
+      .expect(200, { result: 15 });
+  });
+
+  it(`GRPC Receiving serialized Error`, async () => {
+    await request(server)
+      .post('/error?client=standard')
+      .expect(200)
+      .expect('false');
+
+    await request(server)
+      .post('/error?client=custom')
+      .expect(200)
+      .expect('true');
   });
 
   it(`GRPC Sending and Receiving HTTP POST (multiple proto)`, async () => {
@@ -111,6 +133,71 @@ describe('GRPC transport', () => {
     });
   });
 
+  it(`GRPC with backpressure control`, async function () {
+    // This test hit the gRPC server with 1000 messages, but the server
+    // has to process large (> 1MB) messages, so it will definitely hit
+    // issues where writing to the stream needs to be paused until a drain
+    // event. Prior to this test, a bug existed where the server would
+    // send the incorrect number of messages due to improper backpressure
+    // handling that wrote messages more than once.
+    this.timeout(10000);
+
+    const largeMessages = client.streamLargeMessages();
+    // [0, 1, 2, ..., 999]
+    const expectedIds = Array.from({ length: 1000 }, (_, n) => n);
+    const receivedIds: number[] = [];
+
+    await largeMessages.forEach(msg => {
+      receivedIds.push(msg.id);
+    });
+
+    expect(receivedIds).to.deep.equal(expectedIds);
+  });
+
+  describe('streaming calls that error', () => {
+    // We want to assert that the application does not crash when an error is encountered with an unhandledRejection
+    // the best way to do that is to listen for the unhandledRejection event and fail the test if it is called
+    let processSpy: sinon.SinonSpy;
+
+    beforeEach(() => {
+      processSpy = sinon.spy();
+      process.on('unhandledRejection', processSpy);
+    });
+
+    afterEach(() => {
+      process.off('unhandledRejection', processSpy);
+    });
+
+    it('should not crash when replying with an error', async () => {
+      const call = new Promise<void>((resolve, reject) => {
+        const stream = client.streamDivide({
+          data: [{ dividend: 1, divisor: 0 }],
+        });
+
+        stream.on('data', () => {
+          fail('Stream should not have emitted any data');
+        });
+
+        stream.on('error', err => {
+          if (err.code !== GRPC.status.CANCELLED) {
+            reject(err as Error);
+          }
+        });
+
+        stream.on('end', () => {
+          resolve();
+        });
+      });
+
+      await expect(call).to.eventually.be.rejectedWith(
+        '3 INVALID_ARGUMENT: dividing by 0 is not possible',
+      );
+
+      // if this fails the application has crashed
+      expect(processSpy.called).to.be.false;
+    });
+  });
+
   after(async () => {
     await app.close();
   });
diff --git a/integration/microservices/e2e/mqtt-record-builder.spec.ts b/integration/microservices/e2e/mqtt-record-builder.spec.ts
index 1edfddb2e..94d57d5be 100644
--- a/integration/microservices/e2e/mqtt-record-builder.spec.ts
+++ b/integration/microservices/e2e/mqtt-record-builder.spec.ts
@@ -1,5 +1,5 @@
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
 import { MqttController } from '../src/mqtt/mqtt.controller';
@@ -16,7 +16,7 @@ describe('MQTT transport', () => {
     app = module.createNestApplication();
     server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.MQTT,
       options: {
         url: 'mqtt://0.0.0.0:1883',
diff --git a/integration/microservices/e2e/orders-grpc.spec.ts b/integration/microservices/e2e/orders-grpc.spec.ts
index d3c293ef6..e34864f91 100644
--- a/integration/microservices/e2e/orders-grpc.spec.ts
+++ b/integration/microservices/e2e/orders-grpc.spec.ts
@@ -1,7 +1,7 @@
 import * as GRPC from '@grpc/grpc-js';
 import * as ProtoLoader from '@grpc/proto-loader';
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { ExpressAdapter } from '@nestjs/platform-express';
 import { Test } from '@nestjs/testing';
 import { fail } from 'assert';
@@ -26,7 +26,7 @@ describe('Advanced GRPC transport', () => {
     /*
      *  Create microservice configuration
      */
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.GRPC,
       options: {
         url: 'localhost:5001',
diff --git a/integration/microservices/e2e/sum-kafka.spec.ts b/integration/microservices/e2e/sum-kafka.spec.ts
index 9fee99b9a..945210f87 100644
--- a/integration/microservices/e2e/sum-kafka.spec.ts
+++ b/integration/microservices/e2e/sum-kafka.spec.ts
@@ -1,5 +1,5 @@
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import { expect } from 'chai';
 import * as request from 'supertest';
@@ -29,7 +29,7 @@ describe.skip('Kafka transport', function () {
     app = module.createNestApplication();
     server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.KAFKA,
       options: {
         client: {
@@ -91,7 +91,7 @@ describe.skip('Kafka transport', function () {
   });
 
   it(`/POST (async event notification)`, done => {
-    request(server)
+    void request(server)
       .post('/notify')
       .send()
       .end(() => {
@@ -123,7 +123,7 @@ describe.skip('Kafka transport', function () {
   });
 
   it(`/POST (sync command create user) Concurrency Test`, async () => {
-    const promises = [];
+    const promises = [] as Array<Promise<any>>;
     for (let concurrencyKey = 0; concurrencyKey < 100; concurrencyKey++) {
       const innerUserDto = JSON.parse(JSON.stringify(userDto));
       innerUserDto.name += `+${concurrencyKey}`;
diff --git a/integration/microservices/e2e/sum-mqtt.spec.ts b/integration/microservices/e2e/sum-mqtt.spec.ts
index 7d81b9f1f..d1a457bcd 100644
--- a/integration/microservices/e2e/sum-mqtt.spec.ts
+++ b/integration/microservices/e2e/sum-mqtt.spec.ts
@@ -1,5 +1,5 @@
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import { expect } from 'chai';
 import * as request from 'supertest';
@@ -17,7 +17,7 @@ describe('MQTT transport', () => {
     app = module.createNestApplication();
     server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.MQTT,
       options: {
         url: 'mqtt://0.0.0.0:1883',
@@ -47,7 +47,7 @@ describe('MQTT transport', () => {
       .post('/?command=streamSum')
       .send([1, 2, 3, 4, 5])
       .expect(200, '15');
-  });
+  }).timeout(5000);
 
   it(`/POST (concurrent)`, function () {
     return request(server)
@@ -72,10 +72,10 @@ describe('MQTT transport', () => {
       .post('/stream')
       .send([1, 2, 3, 4, 5])
       .expect(200, '15');
-  });
+  }).timeout(5000);
 
   it(`/POST (event notification)`, done => {
-    request(server)
+    void request(server)
       .post('/notify')
       .send([1, 2, 3, 4, 5])
       .end(() => {
@@ -87,7 +87,7 @@ describe('MQTT transport', () => {
   });
 
   it(`/POST (wildcard EVENT #)`, done => {
-    request(server)
+    void request(server)
       .post('/wildcard-event')
       .send([1, 2, 3, 4, 5])
       .end(() => {
@@ -106,7 +106,7 @@ describe('MQTT transport', () => {
   });
 
   it(`/POST (wildcard EVENT +)`, done => {
-    request(server)
+    void request(server)
       .post('/wildcard-event2')
       .send([1, 2, 3, 4, 5])
       .end(() => {
@@ -124,6 +124,44 @@ describe('MQTT transport', () => {
       .expect(201, '15');
   });
 
+  it(`/POST (shared wildcard EVENT #)`, done => {
+    void request(server)
+      .post('/shared-wildcard-event')
+      .send([1, 2, 3, 4, 5])
+      .end(() => {
+        setTimeout(() => {
+          expect(MqttController.IS_SHARED_WILDCARD_EVENT_RECEIVED).to.be.true;
+          done();
+        }, 1000);
+      });
+  });
+
+  it(`/POST (shared wildcard MESSAGE #)`, () => {
+    return request(server)
+      .post('/shared-wildcard-message')
+      .send([1, 2, 3, 4, 5])
+      .expect(201, '15');
+  });
+
+  it(`/POST (shared wildcard EVENT +)`, done => {
+    void request(server)
+      .post('/shared-wildcard-event2')
+      .send([1, 2, 3, 4, 5])
+      .end(() => {
+        setTimeout(() => {
+          expect(MqttController.IS_SHARED_WILDCARD2_EVENT_RECEIVED).to.be.true;
+          done();
+        }, 1000);
+      });
+  });
+
+  it(`/POST (shared wildcard MESSAGE +)`, () => {
+    return request(server)
+      .post('/shared-wildcard-message2')
+      .send([1, 2, 3, 4, 5])
+      .expect(201, '15');
+  });
+
   afterEach(async () => {
     await app.close();
   });
diff --git a/integration/microservices/e2e/sum-nats.spec.ts b/integration/microservices/e2e/sum-nats.spec.ts
index 6944535ae..99c8548ed 100644
--- a/integration/microservices/e2e/sum-nats.spec.ts
+++ b/integration/microservices/e2e/sum-nats.spec.ts
@@ -1,5 +1,5 @@
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import { expect } from 'chai';
 import * as request from 'supertest';
@@ -19,7 +19,7 @@ describe('NATS transport', () => {
     app = module.createNestApplication();
     server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.NATS,
       options: {
         servers: 'nats://0.0.0.0:4222',
@@ -84,7 +84,7 @@ describe('NATS transport', () => {
   });
 
   it(`/POST (event notification)`, done => {
-    request(server)
+    void request(server)
       .post('/notify')
       .send([1, 2, 3, 4, 5])
       .end(() => {
diff --git a/integration/microservices/e2e/sum-redis.spec.ts b/integration/microservices/e2e/sum-redis.spec.ts
index 15b698573..246c2e270 100644
--- a/integration/microservices/e2e/sum-redis.spec.ts
+++ b/integration/microservices/e2e/sum-redis.spec.ts
@@ -1,5 +1,5 @@
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import { expect } from 'chai';
 import * as request from 'supertest';
@@ -17,10 +17,11 @@ describe('REDIS transport', () => {
     app = module.createNestApplication();
     server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.REDIS,
       options: {
-        url: 'redis://0.0.0.0:6379',
+        host: '0.0.0.0',
+        port: 6379,
       },
     });
     await app.startAllMicroservices();
@@ -77,7 +78,7 @@ describe('REDIS transport', () => {
   });
 
   it(`/POST (event notification)`, done => {
-    request(server)
+    void request(server)
       .post('/notify')
       .send([1, 2, 3, 4, 5])
       .end(() => {
diff --git a/integration/microservices/e2e/sum-rmq.spec.ts b/integration/microservices/e2e/sum-rmq.spec.ts
index f5f0e0a36..02ffa1db8 100644
--- a/integration/microservices/e2e/sum-rmq.spec.ts
+++ b/integration/microservices/e2e/sum-rmq.spec.ts
@@ -1,5 +1,5 @@
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import { expect } from 'chai';
 import * as request from 'supertest';
@@ -17,7 +17,7 @@ describe('RabbitMQ transport', () => {
     app = module.createNestApplication();
     server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.RMQ,
       options: {
         urls: [`amqp://0.0.0.0:5672`],
@@ -77,8 +77,15 @@ describe('RabbitMQ transport', () => {
       .expect(200, '15');
   });
 
+  it(`/POST (multiple-urls)`, () => {
+    return request(server)
+      .post('/multiple-urls')
+      .send([1, 2, 3, 4, 5])
+      .expect(200, '15');
+  }).timeout(10000);
+
   it(`/POST (event notification)`, done => {
-    request(server)
+    void request(server)
       .post('/notify')
       .send([1, 2, 3, 4, 5])
       .end(() => {
diff --git a/integration/microservices/e2e/sum-rpc-async.spec.ts b/integration/microservices/e2e/sum-rpc-async.spec.ts
new file mode 100644
index 000000000..f6ead5b24
--- /dev/null
+++ b/integration/microservices/e2e/sum-rpc-async.spec.ts
@@ -0,0 +1,98 @@
+import {
+  Controller,
+  INestMicroservice,
+  Injectable,
+  Module,
+} from '@nestjs/common';
+import { NestFactory } from '@nestjs/core';
+import {
+  AsyncOptions,
+  ClientTCP,
+  ClientsModule,
+  MessagePattern,
+  MicroserviceOptions,
+  Payload,
+  TcpOptions,
+  Transport,
+} from '@nestjs/microservices';
+import { expect } from 'chai';
+
+let port: number;
+
+do {
+  port = Math.round(Math.random() * 10000);
+} while (port < 1000);
+
+@Injectable()
+class RpcOptionsProvider {
+  getOptions(): TcpOptions {
+    return {
+      transport: Transport.TCP,
+      options: {
+        port,
+        host: '0.0.0.0',
+      },
+    };
+  }
+}
+
+@Controller()
+class RpcController {
+  @MessagePattern({ cmd: 'sum' })
+  sumPayload(@Payload() payload: number[]) {
+    return payload.reduce((a, b) => a + b, 0);
+  }
+}
+
+@Module({
+  imports: [
+    ClientsModule.register([
+      {
+        name: 'RPC_CLIENT',
+        transport: Transport.TCP,
+        options: {
+          port,
+          host: '0.0.0.0',
+        },
+      },
+    ]),
+  ],
+  controllers: [RpcController],
+  providers: [RpcOptionsProvider],
+})
+class RpcModule {}
+
+describe('RPC Async transport', () => {
+  let app: INestMicroservice;
+  let client: ClientTCP;
+
+  beforeEach(async () => {
+    app = await NestFactory.createMicroservice<
+      AsyncOptions<MicroserviceOptions>
+    >(RpcModule, {
+      logger: false,
+      inject: [RpcOptionsProvider],
+      useFactory: (optionsProvider: RpcOptionsProvider) =>
+        optionsProvider.getOptions(),
+    });
+
+    await app.listen();
+    client = app.get('RPC_CLIENT', { strict: false });
+  });
+
+  it(`/POST`, done => {
+    let retData = 0;
+    client.send({ cmd: 'sum' }, [1, 2, 3, 4, 5]).subscribe({
+      next: val => (retData += val),
+      error: done,
+      complete: () => {
+        expect(retData).to.eq(15);
+        done();
+      },
+    });
+  });
+
+  afterEach(async () => {
+    await app.close();
+  });
+});
diff --git a/integration/microservices/e2e/sum-rpc-tls.spec.ts b/integration/microservices/e2e/sum-rpc-tls.spec.ts
new file mode 100644
index 000000000..91c31626d
--- /dev/null
+++ b/integration/microservices/e2e/sum-rpc-tls.spec.ts
@@ -0,0 +1,142 @@
+import { INestApplication } from '@nestjs/common';
+import { Transport } from '@nestjs/microservices';
+import { Test } from '@nestjs/testing';
+import { expect } from 'chai';
+import * as fs from 'fs';
+import * as path from 'path';
+import * as request from 'supertest';
+import { AppController } from '../src/tcp-tls/app.controller';
+import { ApplicationModule } from '../src/tcp-tls/app.module';
+
+describe('RPC TLS transport', () => {
+  let server;
+  let app: INestApplication;
+  let key: string;
+  let cert: string;
+
+  before(() => {
+    // Generate a self-signed key pair
+    key = fs
+      .readFileSync(path.join(__dirname, '../src/tcp-tls/privkey.pem'), 'utf8')
+      .toString();
+    cert = fs
+      .readFileSync(path.join(__dirname, '../src/tcp-tls/ca.cert.pem'), 'utf8')
+      .toString();
+  });
+
+  beforeEach(async () => {
+    const module = await Test.createTestingModule({
+      imports: [ApplicationModule],
+    }).compile();
+
+    app = module.createNestApplication();
+    server = app.getHttpAdapter().getInstance();
+
+    app.connectMicroservice({
+      transport: Transport.TCP,
+      options: {
+        host: '0.0.0.0',
+        tlsOptions: { key: key, cert: cert },
+      },
+    });
+    await app.startAllMicroservices();
+    await app.init();
+  });
+
+  it(`/POST TLS`, () => {
+    return request(server)
+      .post('/?command=sum')
+      .send([1, 2, 3, 4, 5])
+      .expect(200, '15');
+  });
+
+  it(`/POST (Promise/async)`, () => {
+    return request(server)
+      .post('/?command=asyncSum')
+      .send([1, 2, 3, 4, 5])
+      .expect(200)
+      .expect(200, '15');
+  });
+
+  it(`/POST (Observable stream)`, () => {
+    return request(server)
+      .post('/?command=streamSum')
+      .send([1, 2, 3, 4, 5])
+      .expect(200, '15');
+  });
+
+  it(`/POST (useFactory client)`, () => {
+    return request(server)
+      .post('/useFactory?command=sum')
+      .send([1, 2, 3, 4, 5])
+      .expect(200, '15');
+  });
+
+  it(`/POST (useClass client)`, () => {
+    return request(server)
+      .post('/useClass?command=sum')
+      .send([1, 2, 3, 4, 5])
+      .expect(200, '15');
+  });
+
+  it(`/POST (concurrent)`, () => {
+    return request(server)
+      .post('/concurrent')
+      .send([
+        Array.from({ length: 10 }, (v, k) => k + 1),
+        Array.from({ length: 10 }, (v, k) => k + 11),
+        Array.from({ length: 10 }, (v, k) => k + 21),
+        Array.from({ length: 10 }, (v, k) => k + 31),
+        Array.from({ length: 10 }, (v, k) => k + 41),
+        Array.from({ length: 10 }, (v, k) => k + 51),
+        Array.from({ length: 10 }, (v, k) => k + 61),
+        Array.from({ length: 10 }, (v, k) => k + 71),
+        Array.from({ length: 10 }, (v, k) => k + 81),
+        Array.from({ length: 10 }, (v, k) => k + 91),
+      ])
+      .expect(200, 'true');
+  });
+
+  it(`/POST (streaming)`, () => {
+    return request(server)
+      .post('/stream')
+      .send([1, 2, 3, 4, 5])
+      .expect(200, '15');
+  });
+
+  it(`/POST (pattern not found)`, () => {
+    return request(server).post('/?command=test').expect(500);
+  });
+
+  it(`/POST (event notification)`, done => {
+    void request(server)
+      .post('/notify')
+      .send([1, 2, 3, 4, 5])
+      .end(() => {
+        setTimeout(() => {
+          expect(AppController.IS_NOTIFIED).to.be.true;
+          done();
+        }, 1000);
+      });
+  });
+
+  it('/POST (custom client)', () => {
+    return request(server)
+      .post('/error?client=custom')
+      .send({})
+      .expect(200)
+      .expect('true');
+  });
+
+  it('/POST (standard client)', () => {
+    return request(server)
+      .post('/error?client=standard')
+      .send({})
+      .expect(200)
+      .expect('false');
+  });
+
+  afterEach(async () => {
+    await app.close();
+  });
+});
diff --git a/integration/microservices/e2e/sum-rpc.spec.ts b/integration/microservices/e2e/sum-rpc.spec.ts
index 85cf67705..8e98fdceb 100644
--- a/integration/microservices/e2e/sum-rpc.spec.ts
+++ b/integration/microservices/e2e/sum-rpc.spec.ts
@@ -1,10 +1,10 @@
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import { expect } from 'chai';
 import * as request from 'supertest';
 import { AppController } from '../src/app.controller';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 describe('RPC transport', () => {
   let server;
@@ -12,13 +12,13 @@ describe('RPC transport', () => {
 
   beforeEach(async () => {
     const module = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
 
     app = module.createNestApplication();
     server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.TCP,
       options: {
         host: '0.0.0.0',
@@ -94,7 +94,7 @@ describe('RPC transport', () => {
   });
 
   it(`/POST (event notification)`, done => {
-    request(server)
+    void request(server)
       .post('/notify')
       .send([1, 2, 3, 4, 5])
       .end(() => {
diff --git a/integration/microservices/src/app.module.ts b/integration/microservices/src/app.module.ts
index c9ac72909..dacf646e4 100644
--- a/integration/microservices/src/app.module.ts
+++ b/integration/microservices/src/app.module.ts
@@ -72,4 +72,4 @@ class ClientOptionService implements ClientsModuleOptionsFactory {
   ],
   controllers: [AppController],
 })
-export class ApplicationModule {}
+export class AppModule {}
diff --git a/integration/microservices/src/disconnected.controller.ts b/integration/microservices/src/disconnected.controller.ts
index 4239fbeb6..fed84ce6f 100644
--- a/integration/microservices/src/disconnected.controller.ts
+++ b/integration/microservices/src/disconnected.controller.ts
@@ -7,7 +7,7 @@ import {
 } from '@nestjs/common';
 import { ClientProxyFactory } from '@nestjs/microservices';
 import { Observable, throwError } from 'rxjs';
-import { catchError } from 'rxjs/operators';
+import { catchError, tap } from 'rxjs/operators';
 
 @Controller()
 export class DisconnectedClientController {
@@ -24,11 +24,16 @@ export class DisconnectedClientController {
         return throwError(() =>
           code === 'ECONNREFUSED' ||
           code === 'CONN_ERR' ||
-          code === 'CONNECTION_REFUSED'
+          code === 'ENOTFOUND' ||
+          code === 'CONNECTION_REFUSED' ||
+          error.message.includes('Connection is closed.')
             ? new RequestTimeoutException('ECONNREFUSED')
             : new InternalServerErrorException(),
         );
       }),
+      tap({
+        error: () => client.close(),
+      }),
     );
   }
 }
diff --git a/integration/microservices/src/grpc/grpc.controller.ts b/integration/microservices/src/grpc/grpc.controller.ts
index e99d8d6c6..8d435f18b 100644
--- a/integration/microservices/src/grpc/grpc.controller.ts
+++ b/integration/microservices/src/grpc/grpc.controller.ts
@@ -1,17 +1,33 @@
-import { Body, Controller, HttpCode, Post } from '@nestjs/common';
+import { Body, Controller, HttpCode, Post, Query } from '@nestjs/common';
 import {
   Client,
   ClientGrpc,
+  ClientGrpcProxy,
   GrpcMethod,
   GrpcStreamCall,
   GrpcStreamMethod,
+  RpcException,
   Transport,
 } from '@nestjs/microservices';
 import { join } from 'path';
-import { Observable, of } from 'rxjs';
+import { catchError, from, mergeMap, Observable, of } from 'rxjs';
+
+class ErrorHandlingProxy extends ClientGrpcProxy {
+  serializeError(err) {
+    return new RpcException(err);
+  }
+}
 
 @Controller()
 export class GrpcController {
+  private readonly customClient: ClientGrpc;
+  constructor() {
+    this.customClient = new ErrorHandlingProxy({
+      package: 'math',
+      protoPath: join(__dirname, 'math.proto'),
+    });
+  }
+
   @Client({
     transport: Transport.GRPC,
     options: {
@@ -40,6 +56,14 @@ export class GrpcController {
     return svc.sum({ data });
   }
 
+  // Test that getService generate both lower and uppercase method
+  @Post('upperMethod/sum')
+  @HttpCode(200)
+  callWithOptions(@Body() data: number[]): Observable<number> {
+    const svc = this.client.getService<any>('Math');
+    return svc.Sum({ data });
+  }
+
   @GrpcMethod('Math')
   async sum({ data }: { data: number[] }): Promise<any> {
     return of({
@@ -57,7 +81,7 @@ export class GrpcController {
           });
         },
         error: err => {
-          reject(err);
+          reject(err as Error);
         },
       });
     });
@@ -70,6 +94,30 @@ export class GrpcController {
     });
   }
 
+  @GrpcMethod('Math')
+  async divide(request: { dividend: number; divisor: number }): Promise<any> {
+    if (request.divisor === 0) {
+      throw new RpcException({
+        code: 3,
+        message: 'dividing by 0 is not possible',
+      });
+    }
+    return {
+      result: request.dividend / request.divisor,
+    };
+  }
+
+  // contrived example meant to show when an error is encountered, like dividing by zero, the
+  // application does not crash and the error is returned appropriately to the client
+  @GrpcMethod('Math', 'StreamDivide')
+  streamDivide({
+    data,
+  }: {
+    data: { dividend: number; divisor: number }[];
+  }): Observable<any> {
+    return from(data).pipe(mergeMap(request => this.divide(request)));
+  }
+
   @GrpcMethod('Math2')
   async sum2({ data }: { data: number[] }): Promise<any> {
     return of({
@@ -90,4 +138,45 @@ export class GrpcController {
     const svc = this.clientMulti.getService<any>('Math2');
     return svc.sum2({ data });
   }
+
+  @GrpcMethod('Math')
+  streamLargeMessages(_req: unknown, _meta: unknown) {
+    // Send 1000 messages of >1MB each relatively fast
+    // This should be enough to trigger backpressure issues
+    // while writing to the socket.
+    return new Observable(subscriber => {
+      let n = 0;
+      const interval = setInterval(() => {
+        // We'll be checking the ids. The `data` is just to make the
+        // message large enough to trigger backpressure issues.
+        subscriber.next({ id: n++, data: 'a'.repeat(1024 * 1024) });
+        if (n === 1000) {
+          subscriber.complete();
+        }
+      }, 0);
+      return () => {
+        clearInterval(interval);
+      };
+    });
+  }
+
+  @Post('error')
+  @HttpCode(200)
+  serializeError(
+    @Query('client') query: 'custom' | 'standard' = 'standard',
+    @Body() body: Record<string, any>,
+  ): Observable<boolean> {
+    const client = query === 'custom' ? this.customClient : this.client;
+    const svc = client.getService<any>('Math');
+
+    const errorDivideRequest = {
+      dividend: 1,
+      divisor: 0,
+    };
+    return svc.divide(errorDivideRequest).pipe(
+      catchError(err => {
+        return of(err instanceof RpcException);
+      }),
+    );
+  }
 }
diff --git a/integration/microservices/src/grpc/math.proto b/integration/microservices/src/grpc/math.proto
index 43c835cb7..a40a842cb 100644
--- a/integration/microservices/src/grpc/math.proto
+++ b/integration/microservices/src/grpc/math.proto
@@ -6,12 +6,40 @@ service Math {
   rpc Sum (RequestSum) returns (SumResult);
   rpc SumStream(stream RequestSum) returns(stream SumResult);
   rpc SumStreamPass(stream RequestSum) returns(stream SumResult);
+  rpc Divide (RequestDivide) returns (DivideResult);
+  rpc StreamLargeMessages(Empty) returns (stream BackpressureData);
+  /* Given a series of dividend and divisor, stream back the division results for each */
+  rpc StreamDivide (StreamDivideRequest) returns (stream StreamDivideResponse);
 }
 
+message BackpressureData {
+    int32 id = 1;
+    string data = 2;
+}
+
+message Empty {}
+
 message SumResult {
   int32 result = 1;
 }
 
 message RequestSum {
   repeated int32 data = 1;
-}
\ No newline at end of file
+}
+
+message RequestDivide {
+  int32 dividend = 1;
+  int32 divisor = 2 ;
+}
+
+message DivideResult {
+  int32 result = 1;
+}
+
+message StreamDivideRequest {
+  repeated RequestDivide data = 1;
+}
+
+message StreamDivideResponse {
+  DivideResult data = 1;
+}
diff --git a/integration/microservices/src/kafka-concurrent/kafka-concurrent.controller.ts b/integration/microservices/src/kafka-concurrent/kafka-concurrent.controller.ts
index fb3c9f4f2..4816b4f13 100644
--- a/integration/microservices/src/kafka-concurrent/kafka-concurrent.controller.ts
+++ b/integration/microservices/src/kafka-concurrent/kafka-concurrent.controller.ts
@@ -13,11 +13,11 @@ import { Observable } from 'rxjs';
 import { SumDto } from './dto/sum.dto';
 
 /**
- * The following function explicity sends messages to the key representing the partition.
+ * The following function explicitly sends messages to the key representing the partition.
  */
 const explicitPartitioner = () => {
   return ({ message }: PartitionerArgs) => {
-    return parseFloat(message.headers.toPartition.toString());
+    return parseFloat(message.headers!.toPartition!.toString());
   };
 };
 
diff --git a/integration/microservices/src/main.ts b/integration/microservices/src/main.ts
index afb93ba07..cdecc1bb6 100644
--- a/integration/microservices/src/main.ts
+++ b/integration/microservices/src/main.ts
@@ -5,4 +5,4 @@ async function bootstrap() {
   const app = await NestFactory.create(ApplicationModule);
   await app.listen(3000);
 }
-bootstrap();
+void bootstrap();
diff --git a/integration/microservices/src/mqtt/mqtt.controller.ts b/integration/microservices/src/mqtt/mqtt.controller.ts
index c8d813efa..96de341fe 100644
--- a/integration/microservices/src/mqtt/mqtt.controller.ts
+++ b/integration/microservices/src/mqtt/mqtt.controller.ts
@@ -18,6 +18,8 @@ export class MqttController {
   static IS_NOTIFIED = false;
   static IS_WILDCARD_EVENT_RECEIVED = false;
   static IS_WILDCARD2_EVENT_RECEIVED = false;
+  static IS_SHARED_WILDCARD_EVENT_RECEIVED = false;
+  static IS_SHARED_WILDCARD2_EVENT_RECEIVED = false;
 
   @Client({ transport: Transport.MQTT })
   client: ClientProxy;
@@ -93,7 +95,7 @@ export class MqttController {
   @Post('record-builder-duplex')
   @HttpCode(200)
   useRecordBuilderDuplex(@Body() data: Record<string, any>) {
-    const record = new MqttRecordBuilder(data).setQoS(2).build();
+    const record = new MqttRecordBuilder(data).setQoS(1).build();
     return this.client.send('record-builder-duplex', record);
   }
 
@@ -109,8 +111,34 @@ export class MqttController {
     };
   }
 
+  @Post('shared-wildcard-event')
+  async sendSharedWildcardEvent(): Promise<any> {
+    return this.client.emit<number>('shared-wildcard-event/test', true);
+  }
+
+  @Post('shared-wildcard-message')
+  async sendSharedWildcardMessage(
+    @Body() data: number[],
+  ): Promise<Observable<number>> {
+    await this.client.connect();
+    return this.client.send<number>('shared-wildcard-message/test', data);
+  }
+
+  @Post('shared-wildcard-event2')
+  async sendSharedWildcardEvent2(): Promise<any> {
+    return this.client.emit<number>('shared-wildcard-event2/test/test', true);
+  }
+
+  @Post('shared-wildcard-message2')
+  async sendSharedWildcardMessage2(
+    @Body() data: number[],
+  ): Promise<Observable<number>> {
+    await this.client.connect();
+    return this.client.send<number>('shared-wildcard-message2/test/test', data);
+  }
+
   @MessagePattern('wildcard-message/#')
-  wildcardMessageHandler(data: number[]): number {
+  wildcardMessageHandler(data: number[]): number | undefined {
     if ((data as any).response) {
       return;
     }
@@ -156,4 +184,27 @@ export class MqttController {
   streaming(data: number[]): Observable<number> {
     return from(data);
   }
+
+  @MessagePattern('$share/test-group/shared-wildcard-message/#')
+  sharedWildcardMessageHandler(data: number[]): number | undefined {
+    if ((data as any).response) {
+      return;
+    }
+    return (data || []).reduce((a, b) => a + b);
+  }
+
+  @EventPattern('$share/test-group/shared-wildcard-event/#')
+  sharedWildcardEventHandler(data: boolean) {
+    MqttController.IS_SHARED_WILDCARD_EVENT_RECEIVED = data;
+  }
+
+  @MessagePattern('$share/test-group/shared-wildcard-message2/+/test')
+  sharedWildcardMessageHandler2(data: number[]): number {
+    return (data || []).reduce((a, b) => a + b);
+  }
+
+  @EventPattern('$share/test-group/shared-wildcard-event2/+/test')
+  sharedWildcardEventHandler2(data: boolean) {
+    MqttController.IS_SHARED_WILDCARD2_EVENT_RECEIVED = data;
+  }
 }
diff --git a/integration/microservices/src/rmq/rmq.controller.ts b/integration/microservices/src/rmq/rmq.controller.ts
index 932bb46a9..07f8075e6 100644
--- a/integration/microservices/src/rmq/rmq.controller.ts
+++ b/integration/microservices/src/rmq/rmq.controller.ts
@@ -61,6 +61,21 @@ export class RMQController {
       .reduce(async (a, b) => (await a) && b);
   }
 
+  @Post('multiple-urls')
+  @HttpCode(200)
+  multipleUrls(@Body() data: number[]) {
+    const clientWithMultipleUrls = ClientProxyFactory.create({
+      transport: Transport.RMQ,
+      options: {
+        urls: [`amqp://localhost:5671`, `amqp://localhost:5672`],
+        queue: 'test',
+        queueOptions: { durable: false },
+        socketOptions: { noDelay: true },
+      },
+    });
+    return clientWithMultipleUrls.send<number>({ cmd: 'multiple-urls' }, data);
+  }
+
   @Post('record-builder-duplex')
   @HttpCode(200)
   useRecordBuilderDuplex(@Body() data: Record<string, any>) {
@@ -109,6 +124,11 @@ export class RMQController {
     return from(data);
   }
 
+  @MessagePattern({ cmd: 'multiple-urls' })
+  handleMultipleUrls(data: number[]): number {
+    return (data || []).reduce((a, b) => a + b);
+  }
+
   @Post('notify')
   async sendNotification(): Promise<any> {
     return this.client.emit<number>('notification', true);
diff --git a/integration/microservices/src/tcp-tls/app.controller.ts b/integration/microservices/src/tcp-tls/app.controller.ts
new file mode 100644
index 000000000..81101741f
--- /dev/null
+++ b/integration/microservices/src/tcp-tls/app.controller.ts
@@ -0,0 +1,141 @@
+import {
+  Body,
+  Controller,
+  HttpCode,
+  Inject,
+  Post,
+  Query,
+} from '@nestjs/common';
+import {
+  Client,
+  ClientProxy,
+  EventPattern,
+  MessagePattern,
+  RpcException,
+  Transport,
+} from '@nestjs/microservices';
+import { from, lastValueFrom, Observable, of, throwError } from 'rxjs';
+import { catchError, scan } from 'rxjs/operators';
+import * as fs from 'fs';
+import * as path from 'path';
+
+@Controller()
+export class AppController {
+  constructor(
+    @Inject('USE_CLASS_CLIENT') private useClassClient: ClientProxy,
+    @Inject('USE_FACTORY_CLIENT') private useFactoryClient: ClientProxy,
+    @Inject('CUSTOM_PROXY_CLIENT') private customClient: ClientProxy,
+  ) {}
+  static IS_NOTIFIED = false;
+
+  @Client({
+    transport: Transport.TCP,
+    options: {
+      tlsOptions: {
+        ca: [
+          fs
+            .readFileSync(path.join(__dirname, 'ca.cert.pem'), 'utf-8')
+            .toString(),
+        ],
+      },
+    },
+  })
+  client: ClientProxy;
+
+  @Post()
+  @HttpCode(200)
+  call(@Query('command') cmd, @Body() data: number[]): Observable<number> {
+    return this.client.send<number>({ cmd }, data);
+  }
+
+  @Post('useFactory')
+  @HttpCode(200)
+  callWithClientUseFactory(
+    @Query('command') cmd,
+    @Body() data: number[],
+  ): Observable<number> {
+    return this.useFactoryClient.send<number>({ cmd }, data);
+  }
+
+  @Post('useClass')
+  @HttpCode(200)
+  callWithClientUseClass(
+    @Query('command') cmd,
+    @Body() data: number[],
+  ): Observable<number> {
+    return this.useClassClient.send<number>({ cmd }, data);
+  }
+
+  @Post('stream')
+  @HttpCode(200)
+  stream(@Body() data: number[]): Observable<number> {
+    return this.client
+      .send<number>({ cmd: 'streaming' }, data)
+      .pipe(scan((a, b) => a + b));
+  }
+
+  @Post('concurrent')
+  @HttpCode(200)
+  concurrent(@Body() data: number[][]): Promise<boolean> {
+    const send = async (tab: number[]) => {
+      const expected = tab.reduce((a, b) => a + b);
+      const result = await lastValueFrom(
+        this.client.send<number>({ cmd: 'sum' }, tab),
+      );
+
+      return result === expected;
+    };
+    return data
+      .map(async tab => send(tab))
+      .reduce(async (a, b) => (await a) && b);
+  }
+
+  @Post('error')
+  @HttpCode(200)
+  serializeError(
+    @Query('client') query: 'custom' | 'standard' = 'standard',
+    @Body() body: Record<string, any>,
+  ): Observable<boolean> {
+    const client = query === 'custom' ? this.customClient : this.client;
+    return client.send({ cmd: 'err' }, {}).pipe(
+      catchError(err => {
+        return of(err instanceof RpcException);
+      }),
+    );
+  }
+
+  @MessagePattern({ cmd: 'sum' })
+  sum(data: number[]): number {
+    return (data || []).reduce((a, b) => a + b);
+  }
+
+  @MessagePattern({ cmd: 'asyncSum' })
+  async asyncSum(data: number[]): Promise<number> {
+    return (data || []).reduce((a, b) => a + b);
+  }
+
+  @MessagePattern({ cmd: 'streamSum' })
+  streamSum(data: number[]): Observable<number> {
+    return of((data || []).reduce((a, b) => a + b));
+  }
+
+  @MessagePattern({ cmd: 'streaming' })
+  streaming(data: number[]): Observable<number> {
+    return from(data);
+  }
+
+  @MessagePattern({ cmd: 'err' })
+  throwAnError() {
+    return throwError(() => new Error('err'));
+  }
+
+  @Post('notify')
+  async sendNotification(): Promise<any> {
+    return this.client.emit<number>('notification', true);
+  }
+
+  @EventPattern('notification')
+  eventHandler(data: boolean) {
+    AppController.IS_NOTIFIED = data;
+  }
+}
diff --git a/integration/microservices/src/tcp-tls/app.module.ts b/integration/microservices/src/tcp-tls/app.module.ts
new file mode 100644
index 000000000..b3720d2a9
--- /dev/null
+++ b/integration/microservices/src/tcp-tls/app.module.ts
@@ -0,0 +1,90 @@
+import { Injectable, Module } from '@nestjs/common';
+import {
+  ClientOptions,
+  ClientsModule,
+  ClientsModuleOptionsFactory,
+  ClientTCP,
+  RpcException,
+  Transport,
+} from '@nestjs/microservices';
+import { AppController } from './app.controller';
+
+import * as fs from 'fs';
+import * as path from 'path';
+
+const caCert = fs.readFileSync(path.join(__dirname, 'ca.cert.pem')).toString();
+
+class ErrorHandlingProxy extends ClientTCP {
+  constructor() {
+    super({
+      tlsOptions: { ca: caCert },
+    });
+  }
+
+  serializeError(err) {
+    return new RpcException(err);
+  }
+}
+
+@Injectable()
+class ConfigService {
+  private readonly config = {
+    transport: Transport.TCP,
+  };
+  get(key: string, defaultValue?: any) {
+    return this.config[key] || defaultValue;
+  }
+}
+
+@Module({
+  providers: [ConfigService],
+  exports: [ConfigService],
+})
+class ConfigModule {}
+
+@Injectable()
+class ClientOptionService implements ClientsModuleOptionsFactory {
+  constructor(private readonly configService: ConfigService) {}
+  createClientOptions(): Promise<ClientOptions> | ClientOptions {
+    return {
+      transport: this.configService.get('transport'),
+      options: {
+        tlsOptions: { ca: caCert },
+      },
+    };
+  }
+}
+
+@Module({
+  imports: [
+    ClientsModule.registerAsync([
+      {
+        imports: [ConfigModule],
+        name: 'USE_FACTORY_CLIENT',
+        useFactory: (configService: ConfigService) => ({
+          transport: configService.get('transport'),
+          options: {
+            tlsOptions: { ca: caCert },
+          },
+        }),
+        inject: [ConfigService],
+      },
+      {
+        imports: [ConfigModule],
+        name: 'USE_CLASS_CLIENT',
+        useClass: ClientOptionService,
+        inject: [ConfigService],
+      },
+      {
+        imports: [ConfigModule],
+        inject: [ConfigService],
+        name: 'CUSTOM_PROXY_CLIENT',
+        useFactory: (config: ConfigService) => ({
+          customClass: ErrorHandlingProxy,
+        }),
+      },
+    ]),
+  ],
+  controllers: [AppController],
+})
+export class ApplicationModule {}
diff --git a/integration/microservices/src/tcp-tls/ca.cert.pem b/integration/microservices/src/tcp-tls/ca.cert.pem
new file mode 100644
index 000000000..dbc7d8a77
--- /dev/null
+++ b/integration/microservices/src/tcp-tls/ca.cert.pem
@@ -0,0 +1,17 @@
+-----BEGIN CERTIFICATE-----
+MIICpDCCAYwCCQCyP27z3r0PFjANBgkqhkiG9w0BAQsFADAUMRIwEAYDVQQDDAls
+b2NhbGhvc3QwHhcNMjIxMjAyMDQ0NTQ1WhcNMzIxMTI5MDQ0NTQ1WjAUMRIwEAYD
+VQQDDAlsb2NhbGhvc3QwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDZ
+1IdZZXqrwXql4AIOJnlfpoGKOKoIalnK7KaKHTsq1QOF8z2abFuNBVIIrO0etQ/0
+PPAaFGkXl6HHBuA5PrFpsw3V1wSnNs1Cns9NhvypHI2V71lkwBJrEaSicNWL2AOE
+QkQ9cZ4YsTGd0BrM8D5VvgXdrC7gOXfj7Hx3E4K+wFO/Gi4AUXl5CXxleSFcW4U+
+jFulfq/DE8rBZXs29IsGeVkkgUoICjQ4Ey4zE6EY7f3SPKgU8gfgzYyGSd/ZZ/E7
+6M2yakEUX448Nl4BeuNWroBHVm1pSiMo+Cm1g34pJScPrx1yw6qquziCc/2n1M6O
+B4WGIZAmJDWnAOEjjrxFAgMBAAEwDQYJKoZIhvcNAQELBQADggEBAABGByZZUjaq
+ZygICSH2qUGHPPIyrfaCe0qM7de6kYfxxPYQQZb0HDynzv780Lq1002XeT02fNR+
+5sBCVFuKvS8BNvTq6kHzO1FiWIk/E5fQcYNToYSeEcXgWFLhJMty7+R6sIc9y8PH
+2YNehf78Jjm9ukM52sLc4+JWl7AEeqPrOHZdh/ve8M2gTfimFKTrW5cEAVPIOPhp
+2t5BdDKt8ZxgrGC7iRxga+v80VUOHRGfrd3hf3NlDQZO8upVGY8DdJhPRDB72+R0
+kzJ7eyQwlGXM20atiFxPk43h0f273MneIJG8NgGiVU0ND4XnZkAB3KSAu7pB+nEw
+QRYMYDgo/8Q=
+-----END CERTIFICATE-----
diff --git a/integration/microservices/src/tcp-tls/privkey.pem b/integration/microservices/src/tcp-tls/privkey.pem
new file mode 100644
index 000000000..f8a90acff
--- /dev/null
+++ b/integration/microservices/src/tcp-tls/privkey.pem
@@ -0,0 +1,28 @@
+-----BEGIN PRIVATE KEY-----
+MIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQDZ1IdZZXqrwXql
+4AIOJnlfpoGKOKoIalnK7KaKHTsq1QOF8z2abFuNBVIIrO0etQ/0PPAaFGkXl6HH
+BuA5PrFpsw3V1wSnNs1Cns9NhvypHI2V71lkwBJrEaSicNWL2AOEQkQ9cZ4YsTGd
+0BrM8D5VvgXdrC7gOXfj7Hx3E4K+wFO/Gi4AUXl5CXxleSFcW4U+jFulfq/DE8rB
+ZXs29IsGeVkkgUoICjQ4Ey4zE6EY7f3SPKgU8gfgzYyGSd/ZZ/E76M2yakEUX448
+Nl4BeuNWroBHVm1pSiMo+Cm1g34pJScPrx1yw6qquziCc/2n1M6OB4WGIZAmJDWn
+AOEjjrxFAgMBAAECggEANUKZtWnyjHxKGLSkzADsPE7h7YHdUSFvwwYJ0ktDZD2h
+FudacJ994wUiAa0GbTOoKvebXUUQTQxuKdOsj1Kc3lNBVr+0C46CsX9TAIm4zUCF
+/dr/6HpuBm/R6UXdcMvoUDZDqSJWnYL1trhjVSiIlT5ZANJQw9JJVhlEdXj3xtuc
+I9aC+33f9hKO1wzei/mTjIRGyRIeKselZPpA7qJnE4s3hmZxnO/rSqyPIvh1XLfZ
+3Eoyyg+xNpTZ8JqlHB5d7hDSnj8cjboa7IYpHJDXN3r8Aui+R9e/sQkezHbF7fR0
+xHpBVYQvGMuqSnTBkdJfq4qPAR1K49UrpEXB2GHaIQKBgQDs3t/ZUA138AiPIeLd
+aTsEPhf5dWEZynfNvXZ0VcoSr8ckaiaq9OEllprAriYWj+XphTDsBUAh/R7KlOR4
+eb+m6OwH7LseGiLIEr54GGP0LzVXAkfH2/uR1cak8qAmHB00jNEg7sj0eVAsHO3f
+WQm67f+RNP/IgAa+V8JKIkgTwwKBgQDrbAH8eAQsq9rjpxcic1EUI7uFHzr+cKf/
+4Y8ThLUNAzNfAbQWRBYjS1R8GM79Wiuh+WT1ooHKLryuLF7LVukvKHJ5GiNFBmaO
+llf72Zf1y4tBE2RCXQbf6h8+ohSDC/hwYy+w20/i2KzSBKkS0+gQuAX/HzfTpRd3
+q3/uEniXVwKBgDNnElDIbIPQlSrqgZ7mzSXYi79Y15+PLnx5VxFb5KQ1fRPL7WRA
+C/PqQN77a8yNoakRfFJbuVUm5t2zffkfApYoCcCWgOzBYzbjym2pbVd6PysIlacr
+d+Zn69mzxUk/5J6YyHFLIFTdVqacCIrleZUVPNa4F6HdFpmL1d/cnKOdAoGAMDuB
+sKsaF9jh0LBkEf/URa8IdT6vxH9qPAeHW7VdrpvQQ4/CyKkMbBC772zZw5hcxiOl
+Zpnzw2uN5pVamohk3++GfH85aKPmESKGRigPdSFNl3iUmvAaP3flDN0CHNMwBD6d
+/7r/A/fmeGTSCvR1YC+DswA/XNI/G5p8bFdGc6MCgYBd9oQiZlkYMiDGPUAjx+DO
+kqtAmc8DLJEanSbWdIxL2bGL04cgBRPssM4m0UScx4PucvqWEPdN/5Ug0z5TrD77
+2K5nZSBUdy4DunBImz1NHRQEiytkrYX0LesGr02QlzIH4wmwb1TFu7rLkr6KfNuV
+xqWi+JVY8N4vuHAxCeEALw==
+-----END PRIVATE KEY-----
\ No newline at end of file
diff --git a/integration/microservices/tsconfig.json b/integration/microservices/tsconfig.json
index c6354c564..4a0f01e0e 100644
--- a/integration/microservices/tsconfig.json
+++ b/integration/microservices/tsconfig.json
@@ -7,10 +7,29 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "strictNullChecks": true,
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
diff --git a/integration/module-utils/src/integration.module-definition.ts b/integration/module-utils/src/integration.module-definition.ts
new file mode 100644
index 000000000..89d7a9842
--- /dev/null
+++ b/integration/module-utils/src/integration.module-definition.ts
@@ -0,0 +1,17 @@
+import { ConfigurableModuleBuilder } from '@nestjs/common';
+import { IntegrationModuleOptions } from './interfaces/integration-module-options.interface';
+
+export const { ConfigurableModuleClass, MODULE_OPTIONS_TOKEN } =
+  new ConfigurableModuleBuilder<IntegrationModuleOptions>()
+    .setClassMethodName('forRoot')
+    .setFactoryMethodName('construct')
+    .setExtras(
+      {
+        isGlobal: true,
+      },
+      (definition, extras) => ({
+        ...definition,
+        global: extras.isGlobal,
+      }),
+    )
+    .build();
diff --git a/integration/module-utils/src/integration.module.ts b/integration/module-utils/src/integration.module.ts
new file mode 100644
index 000000000..3b994f4bd
--- /dev/null
+++ b/integration/module-utils/src/integration.module.ts
@@ -0,0 +1,16 @@
+import { Inject, Module } from '@nestjs/common';
+import {
+  ConfigurableModuleClass,
+  MODULE_OPTIONS_TOKEN,
+} from './integration.module-definition';
+import { IntegrationModuleOptions } from './interfaces/integration-module-options.interface';
+
+@Module({})
+export class IntegrationModule extends ConfigurableModuleClass {
+  constructor(
+    @Inject(MODULE_OPTIONS_TOKEN)
+    public readonly options: IntegrationModuleOptions,
+  ) {
+    super();
+  }
+}
diff --git a/integration/module-utils/src/interfaces/integration-module-options.interface.ts b/integration/module-utils/src/interfaces/integration-module-options.interface.ts
new file mode 100644
index 000000000..802e02076
--- /dev/null
+++ b/integration/module-utils/src/interfaces/integration-module-options.interface.ts
@@ -0,0 +1,4 @@
+export interface IntegrationModuleOptions {
+  url: string;
+  secure?: boolean;
+}
diff --git a/integration/module-utils/test/integration-module.spec.ts b/integration/module-utils/test/integration-module.spec.ts
new file mode 100644
index 000000000..ea22a71c5
--- /dev/null
+++ b/integration/module-utils/test/integration-module.spec.ts
@@ -0,0 +1,47 @@
+import { Test } from '@nestjs/testing';
+import { expect } from 'chai';
+import { IntegrationModule } from '../src/integration.module';
+
+describe('Module utils (ConfigurableModuleBuilder)', () => {
+  it('should auto-generate "forRoot" method', async () => {
+    const moduleRef = await Test.createTestingModule({
+      imports: [
+        IntegrationModule.forRoot({
+          isGlobal: true,
+          url: 'test_url',
+          secure: false,
+        }),
+      ],
+    }).compile();
+
+    const integrationModule = moduleRef.get(IntegrationModule);
+
+    expect(integrationModule.options).to.deep.equal({
+      url: 'test_url',
+      secure: false,
+    });
+  });
+
+  it('should auto-generate "forRootAsync" method', async () => {
+    const moduleRef = await Test.createTestingModule({
+      imports: [
+        IntegrationModule.forRootAsync({
+          isGlobal: true,
+          useFactory: () => {
+            return {
+              url: 'test_url',
+              secure: false,
+            };
+          },
+        }),
+      ],
+    }).compile();
+
+    const integrationModule = moduleRef.get(IntegrationModule);
+
+    expect(integrationModule.options).to.deep.equal({
+      url: 'test_url',
+      secure: false,
+    });
+  });
+});
diff --git a/integration/module-utils/tsconfig.json b/integration/module-utils/tsconfig.json
new file mode 100644
index 000000000..2d3b89de2
--- /dev/null
+++ b/integration/module-utils/tsconfig.json
@@ -0,0 +1,42 @@
+{
+  "compilerOptions": {
+    "module": "commonjs",
+    "declaration": false,
+    "noImplicitAny": false,
+    "removeComments": true,
+    "noLib": false,
+    "emitDecoratorMetadata": true,
+    "experimentalDecorators": true,
+    "target": "ES2021",
+    "sourceMap": true,
+    "allowJs": true,
+    "strictNullChecks": true,
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
+  },
+  "include": [
+    "src/**/*",
+    "e2e/**/*",
+    "test/**/*"
+  ],
+  "exclude": [
+    "node_modules",
+  ]
+}
\ No newline at end of file
diff --git a/integration/mongoose/src/app.module.ts b/integration/mongoose/src/app.module.ts
index f607cd72e..0368daa98 100644
--- a/integration/mongoose/src/app.module.ts
+++ b/integration/mongoose/src/app.module.ts
@@ -4,9 +4,7 @@ import { CatsModule } from './cats/cats.module';
 
 @Module({
   imports: [
-    MongooseModule.forRoot('mongodb://localhost:27017/test', {
-      useNewUrlParser: true,
-    }),
+    MongooseModule.forRoot('mongodb://localhost:27017/test'),
     CatsModule,
   ],
 })
diff --git a/integration/mongoose/src/async-class-options.module.ts b/integration/mongoose/src/async-class-options.module.ts
index 5e0878857..6e8a20e3f 100644
--- a/integration/mongoose/src/async-class-options.module.ts
+++ b/integration/mongoose/src/async-class-options.module.ts
@@ -10,7 +10,6 @@ class ConfigService implements MongooseOptionsFactory {
   createMongooseOptions(): MongooseModuleOptions {
     return {
       uri: 'mongodb://localhost:27017/test',
-      useNewUrlParser: true,
     };
   }
 }
diff --git a/integration/mongoose/src/async-existing-options.module.ts b/integration/mongoose/src/async-existing-options.module.ts
index 37f5a8b0d..61209d28a 100644
--- a/integration/mongoose/src/async-existing-options.module.ts
+++ b/integration/mongoose/src/async-existing-options.module.ts
@@ -10,7 +10,6 @@ class ConfigService implements MongooseOptionsFactory {
   createMongooseOptions(): MongooseModuleOptions {
     return {
       uri: 'mongodb://localhost:27017/test',
-      useNewUrlParser: true,
     };
   }
 }
diff --git a/integration/mongoose/src/async-options.module.ts b/integration/mongoose/src/async-options.module.ts
index ddc1c6428..d5f0f45d5 100644
--- a/integration/mongoose/src/async-options.module.ts
+++ b/integration/mongoose/src/async-options.module.ts
@@ -6,7 +6,6 @@ import { CatsModule } from './cats/cats.module';
   imports: [
     MongooseModule.forRootAsync({
       useFactory: () => ({
-        useNewUrlParser: true,
         uri: 'mongodb://localhost:27017/test',
       }),
     }),
diff --git a/integration/mongoose/src/main.ts b/integration/mongoose/src/main.ts
index 5847364d6..2699ee9d7 100644
--- a/integration/mongoose/src/main.ts
+++ b/integration/mongoose/src/main.ts
@@ -5,4 +5,4 @@ async function bootstrap() {
   const app = await NestFactory.create(ApplicationModule);
   await app.listen(3001);
 }
-bootstrap();
+void bootstrap();
diff --git a/integration/mongoose/tsconfig.json b/integration/mongoose/tsconfig.json
index ea15af490..4a0f01e0e 100644
--- a/integration/mongoose/tsconfig.json
+++ b/integration/mongoose/tsconfig.json
@@ -7,16 +7,35 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "strictNullChecks": true,
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
-    "src/**/*"
+    "src/**/*",
+    "e2e/**/*"
   ],
   "exclude": [
     "node_modules",
-    "**/*.spec.ts"
   ]
 }
\ No newline at end of file
diff --git a/integration/mosquitto.conf b/integration/mosquitto.conf
new file mode 100644
index 000000000..ba2fbeb43
--- /dev/null
+++ b/integration/mosquitto.conf
@@ -0,0 +1,906 @@
+# Config file for mosquitto
+#
+# See mosquitto.conf(5) for more information.
+#
+# Default values are shown, uncomment to change.
+#
+# Use the # character to indicate a comment, but only if it is the
+# very first character on the line.
+
+# =================================================================
+# General configuration
+# =================================================================
+
+# Use per listener security settings.
+#
+# It is recommended this option be set before any other options.
+#
+# If this option is set to true, then all authentication and access control
+# options are controlled on a per listener basis. The following options are
+# affected:
+#
+# acl_file
+# allow_anonymous
+# allow_zero_length_clientid
+# auto_id_prefix
+# password_file
+# plugin
+# plugin_opt_*
+# psk_file
+#
+# Note that if set to true, then a durable client (i.e. with clean session set
+# to false) that has disconnected will use the ACL settings defined for the
+# listener that it was most recently connected to.
+#
+# The default behaviour is for this to be set to false, which maintains the
+# setting behaviour from previous versions of mosquitto.
+#per_listener_settings false
+
+
+# This option controls whether a client is allowed to connect with a zero
+# length client id or not. This option only affects clients using MQTT v3.1.1
+# and later. If set to false, clients connecting with a zero length client id
+# are disconnected. If set to true, clients will be allocated a client id by
+# the broker. This means it is only useful for clients with clean session set
+# to true.
+#allow_zero_length_clientid true
+
+# If allow_zero_length_clientid is true, this option allows you to set a prefix
+# to automatically generated client ids to aid visibility in logs.
+# Defaults to 'auto-'
+#auto_id_prefix auto-
+
+# This option affects the scenario when a client subscribes to a topic that has
+# retained messages. It is possible that the client that published the retained
+# message to the topic had access at the time they published, but that access
+# has been subsequently removed. If check_retain_source is set to true, the
+# default, the source of a retained message will be checked for access rights
+# before it is republished. When set to false, no check will be made and the
+# retained message will always be published. This affects all listeners.
+#check_retain_source true
+
+# QoS 1 and 2 messages will be allowed inflight per client until this limit
+# is exceeded.  Defaults to 0. (No maximum)
+# See also max_inflight_messages
+#max_inflight_bytes 0
+
+# The maximum number of QoS 1 and 2 messages currently inflight per
+# client.
+# This includes messages that are partway through handshakes and
+# those that are being retried. Defaults to 20. Set to 0 for no
+# maximum. Setting to 1 will guarantee in-order delivery of QoS 1
+# and 2 messages.
+#max_inflight_messages 20
+
+# For MQTT v5 clients, it is possible to have the server send a "server
+# keepalive" value that will override the keepalive value set by the client.
+# This is intended to be used as a mechanism to say that the server will
+# disconnect the client earlier than it anticipated, and that the client should
+# use the new keepalive value. The max_keepalive option allows you to specify
+# that clients may only connect with keepalive less than or equal to this
+# value, otherwise they will be sent a server keepalive telling them to use
+# max_keepalive. This only applies to MQTT v5 clients. The default, and maximum
+# value allowable, is 65535.
+#
+# Set to 0 to allow clients to set keepalive = 0, which means no keepalive
+# checks are made and the client will never be disconnected by the broker if no
+# messages are received. You should be very sure this is the behaviour that you
+# want.
+#
+# For MQTT v3.1.1 and v3.1 clients, there is no mechanism to tell the client
+# what keepalive value they should use. If an MQTT v3.1.1 or v3.1 client
+# specifies a keepalive time greater than max_keepalive they will be sent a
+# CONNACK message with the "identifier rejected" reason code, and disconnected.
+#
+#max_keepalive 65535
+
+# For MQTT v5 clients, it is possible to have the server send a "maximum packet
+# size" value that will instruct the client it will not accept MQTT packets
+# with size greater than max_packet_size bytes. This applies to the full MQTT
+# packet, not just the payload. Setting this option to a positive value will
+# set the maximum packet size to that number of bytes. If a client sends a
+# packet which is larger than this value, it will be disconnected. This applies
+# to all clients regardless of the protocol version they are using, but v3.1.1
+# and earlier clients will of course not have received the maximum packet size
+# information. Defaults to no limit. Setting below 20 bytes is forbidden
+# because it is likely to interfere with ordinary client operation, even with
+# very small payloads.
+#max_packet_size 0
+
+# QoS 1 and 2 messages above those currently in-flight will be queued per
+# client until this limit is exceeded.  Defaults to 0. (No maximum)
+# See also max_queued_messages.
+# If both max_queued_messages and max_queued_bytes are specified, packets will
+# be queued until the first limit is reached.
+#max_queued_bytes 0
+
+# Set the maximum QoS supported. Clients publishing at a QoS higher than
+# specified here will be disconnected.
+#max_qos 2
+
+# The maximum number of QoS 1 and 2 messages to hold in a queue per client
+# above those that are currently in-flight.  Defaults to 1000. Set
+# to 0 for no maximum (not recommended).
+# See also queue_qos0_messages.
+# See also max_queued_bytes.
+#max_queued_messages 1000
+#
+# This option sets the maximum number of heap memory bytes that the broker will
+# allocate, and hence sets a hard limit on memory use by the broker.  Memory
+# requests that exceed this value will be denied. The effect will vary
+# depending on what has been denied. If an incoming message is being processed,
+# then the message will be dropped and the publishing client will be
+# disconnected. If an outgoing message is being sent, then the individual
+# message will be dropped and the receiving client will be disconnected.
+# Defaults to no limit.
+#memory_limit 0
+
+# This option sets the maximum publish payload size that the broker will allow.
+# Received messages that exceed this size will not be accepted by the broker.
+# The default value is 0, which means that all valid MQTT messages are
+# accepted. MQTT imposes a maximum payload size of 268435455 bytes.
+#message_size_limit 0
+
+# This option allows persistent clients (those with clean session set to false)
+# to be removed if they do not reconnect within a certain time frame.
+#
+# This is a non-standard option in MQTT V3.1 but allowed in MQTT v3.1.1.
+#
+# Badly designed clients may set clean session to false whilst using a randomly
+# generated client id. This leads to persistent clients that will never
+# reconnect. This option allows these clients to be removed.
+#
+# The expiration period should be an integer followed by one of h d w m y for
+# hour, day, week, month and year respectively. For example
+#
+# persistent_client_expiration 2m
+# persistent_client_expiration 14d
+# persistent_client_expiration 1y
+#
+# The default if not set is to never expire persistent clients.
+#persistent_client_expiration
+
+# Write process id to a file. Default is a blank string which means
+# a pid file shouldn't be written.
+# This should be set to /var/run/mosquitto/mosquitto.pid if mosquitto is
+# being run automatically on boot with an init script and
+# start-stop-daemon or similar.
+#pid_file
+
+# Set to true to queue messages with QoS 0 when a persistent client is
+# disconnected. These messages are included in the limit imposed by
+# max_queued_messages and max_queued_bytes
+# Defaults to false.
+# This is a non-standard option for the MQTT v3.1 spec but is allowed in
+# v3.1.1.
+#queue_qos0_messages false
+
+# Set to false to disable retained message support. If a client publishes a
+# message with the retain bit set, it will be disconnected if this is set to
+# false.
+#retain_available true
+
+# Disable Nagle's algorithm on client sockets. This has the effect of reducing
+# latency of individual messages at the potential cost of increasing the number
+# of packets being sent.
+#set_tcp_nodelay false
+
+# Time in seconds between updates of the $SYS tree.
+# Set to 0 to disable the publishing of the $SYS tree.
+#sys_interval 10
+
+# The MQTT specification requires that the QoS of a message delivered to a
+# subscriber is never upgraded to match the QoS of the subscription. Enabling
+# this option changes this behaviour. If upgrade_outgoing_qos is set true,
+# messages sent to a subscriber will always match the QoS of its subscription.
+# This is a non-standard option explicitly disallowed by the spec.
+#upgrade_outgoing_qos false
+
+# When run as root, drop privileges to this user and its primary
+# group.
+# Set to root to stay as root, but this is not recommended.
+# If set to "mosquitto", or left unset, and the "mosquitto" user does not exist
+# then it will drop privileges to the "nobody" user instead.
+# If run as a non-root user, this setting has no effect.
+# Note that on Windows this has no effect and so mosquitto should be started by
+# the user you wish it to run as.
+#user mosquitto
+
+# =================================================================
+# Listeners
+# =================================================================
+
+# Listen on a port/ip address combination. By using this variable
+# multiple times, mosquitto can listen on more than one port. If
+# this variable is used and neither bind_address nor port given,
+# then the default listener will not be started.
+# The port number to listen on must be given. Optionally, an ip
+# address or host name may be supplied as a second argument. In
+# this case, mosquitto will attempt to bind the listener to that
+# address and so restrict access to the associated network and
+# interface. By default, mosquitto will listen on all interfaces.
+# Note that for a websockets listener it is not possible to bind to a host
+# name.
+#
+# On systems that support Unix Domain Sockets, it is also possible
+# to create a # Unix socket rather than opening a TCP socket. In
+# this case, the port number should be set to 0 and a unix socket
+# path must be provided, e.g.
+# listener 0 /tmp/mosquitto.sock
+#
+# listener port-number [ip address/host name/unix socket path]
+#listener
+
+# By default, a listener will attempt to listen on all supported IP protocol
+# versions. If you do not have an IPv4 or IPv6 interface you may wish to
+# disable support for either of those protocol versions. In particular, note
+# that due to the limitations of the websockets library, it will only ever
+# attempt to open IPv6 sockets if IPv6 support is compiled in, and so will fail
+# if IPv6 is not available.
+#
+# Set to `ipv4` to force the listener to only use IPv4, or set to `ipv6` to
+# force the listener to only use IPv6. If you want support for both IPv4 and
+# IPv6, then do not use the socket_domain option.
+#
+#socket_domain
+
+# Bind the listener to a specific interface. This is similar to
+# the [ip address/host name] part of the listener definition, but is useful
+# when an interface has multiple addresses or the address may change. If used
+# with the [ip address/host name] part of the listener definition, then the
+# bind_interface option will take priority.
+# Not available on Windows.
+#
+# Example: bind_interface eth0
+#bind_interface
+
+# When a listener is using the websockets protocol, it is possible to serve
+# http data as well. Set http_dir to a directory which contains the files you
+# wish to serve. If this option is not specified, then no normal http
+# connections will be possible.
+#http_dir
+
+# The maximum number of client connections to allow. This is
+# a per listener setting.
+# Default is -1, which means unlimited connections.
+# Note that other process limits mean that unlimited connections
+# are not really possible. Typically the default maximum number of
+# connections possible is around 1024.
+#max_connections -1
+
+# The listener can be restricted to operating within a topic hierarchy using
+# the mount_point option. This is achieved be prefixing the mount_point string
+# to all topics for any clients connected to this listener. This prefixing only
+# happens internally to the broker; the client will not see the prefix.
+#mount_point
+
+# Choose the protocol to use when listening.
+# This can be either mqtt or websockets.
+# Certificate based TLS may be used with websockets, except that only the
+# cafile, certfile, keyfile, ciphers, and ciphers_tls13 options are supported.
+#protocol mqtt
+listener 1883
+protocol mqtt
+
+listener 9001
+protocol websockets
+
+# Set use_username_as_clientid to true to replace the clientid that a client
+# connected with with its username. This allows authentication to be tied to
+# the clientid, which means that it is possible to prevent one client
+# disconnecting another by using the same clientid.
+# If a client connects with no username it will be disconnected as not
+# authorised when this option is set to true.
+# Do not use in conjunction with clientid_prefixes.
+# See also use_identity_as_username.
+#use_username_as_clientid
+
+# Change the websockets headers size. This is a global option, it is not
+# possible to set per listener. This option sets the size of the buffer used in
+# the libwebsockets library when reading HTTP headers. If you are passing large
+# header data such as cookies then you may need to increase this value. If left
+# unset, or set to 0, then the default of 1024 bytes will be used.
+#websockets_headers_size
+
+# -----------------------------------------------------------------
+# Certificate based SSL/TLS support
+# -----------------------------------------------------------------
+# The following options can be used to enable certificate based SSL/TLS support
+# for this listener. Note that the recommended port for MQTT over TLS is 8883,
+# but this must be set manually.
+#
+# See also the mosquitto-tls man page and the "Pre-shared-key based SSL/TLS
+# support" section. Only one of certificate or PSK encryption support can be
+# enabled for any listener.
+
+# Both of certfile and keyfile must be defined to enable certificate based
+# TLS encryption.
+
+# Path to the PEM encoded server certificate.
+#certfile
+
+# Path to the PEM encoded keyfile.
+#keyfile
+
+# If you wish to control which encryption ciphers are used, use the ciphers
+# option. The list of available ciphers can be optained using the "openssl
+# ciphers" command and should be provided in the same format as the output of
+# that command. This applies to TLS 1.2 and earlier versions only. Use
+# ciphers_tls1.3 for TLS v1.3.
+#ciphers
+
+# Choose which TLS v1.3 ciphersuites are used for this listener.
+# Defaults to "TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256"
+#ciphers_tls1.3
+
+# If you have require_certificate set to true, you can create a certificate
+# revocation list file to revoke access to particular client certificates. If
+# you have done this, use crlfile to point to the PEM encoded revocation file.
+#crlfile
+
+# To allow the use of ephemeral DH key exchange, which provides forward
+# security, the listener must load DH parameters. This can be specified with
+# the dhparamfile option. The dhparamfile can be generated with the command
+# e.g. "openssl dhparam -out dhparam.pem 2048"
+#dhparamfile
+
+# By default an TLS enabled listener will operate in a similar fashion to a
+# https enabled web server, in that the server has a certificate signed by a CA
+# and the client will verify that it is a trusted certificate. The overall aim
+# is encryption of the network traffic. By setting require_certificate to true,
+# the client must provide a valid certificate in order for the network
+# connection to proceed. This allows access to the broker to be controlled
+# outside of the mechanisms provided by MQTT.
+#require_certificate false
+
+# cafile and capath define methods of accessing the PEM encoded
+# Certificate Authority certificates that will be considered trusted when
+# checking incoming client certificates.
+# cafile defines the path to a file containing the CA certificates.
+# capath defines a directory that will be searched for files
+# containing the CA certificates. For capath to work correctly, the
+# certificate files must have ".crt" as the file ending and you must run
+# "openssl rehash <path to capath>" each time you add/remove a certificate.
+#cafile
+#capath
+
+
+# If require_certificate is true, you may set use_identity_as_username to true
+# to use the CN value from the client certificate as a username. If this is
+# true, the password_file option will not be used for this listener.
+#use_identity_as_username false
+
+# -----------------------------------------------------------------
+# Pre-shared-key based SSL/TLS support
+# -----------------------------------------------------------------
+# The following options can be used to enable PSK based SSL/TLS support for
+# this listener. Note that the recommended port for MQTT over TLS is 8883, but
+# this must be set manually.
+#
+# See also the mosquitto-tls man page and the "Certificate based SSL/TLS
+# support" section. Only one of certificate or PSK encryption support can be
+# enabled for any listener.
+
+# The psk_hint option enables pre-shared-key support for this listener and also
+# acts as an identifier for this listener. The hint is sent to clients and may
+# be used locally to aid authentication. The hint is a free form string that
+# doesn't have much meaning in itself, so feel free to be creative.
+# If this option is provided, see psk_file to define the pre-shared keys to be
+# used or create a security plugin to handle them.
+#psk_hint
+
+# When using PSK, the encryption ciphers used will be chosen from the list of
+# available PSK ciphers. If you want to control which ciphers are available,
+# use the "ciphers" option.  The list of available ciphers can be optained
+# using the "openssl ciphers" command and should be provided in the same format
+# as the output of that command.
+#ciphers
+
+# Set use_identity_as_username to have the psk identity sent by the client used
+# as its username. Authentication will be carried out using the PSK rather than
+# the MQTT username/password and so password_file will not be used for this
+# listener.
+#use_identity_as_username false
+
+
+# =================================================================
+# Persistence
+# =================================================================
+
+# If persistence is enabled, save the in-memory database to disk
+# every autosave_interval seconds. If set to 0, the persistence
+# database will only be written when mosquitto exits. See also
+# autosave_on_changes.
+# Note that writing of the persistence database can be forced by
+# sending mosquitto a SIGUSR1 signal.
+#autosave_interval 1800
+
+# If true, mosquitto will count the number of subscription changes, retained
+# messages received and queued messages and if the total exceeds
+# autosave_interval then the in-memory database will be saved to disk.
+# If false, mosquitto will save the in-memory database to disk by treating
+# autosave_interval as a time in seconds.
+#autosave_on_changes false
+
+# Save persistent message data to disk (true/false).
+# This saves information about all messages, including
+# subscriptions, currently in-flight messages and retained
+# messages.
+# retained_persistence is a synonym for this option.
+#persistence false
+
+# The filename to use for the persistent database, not including
+# the path.
+#persistence_file mosquitto.db
+
+# Location for persistent database.
+# Default is an empty string (current directory).
+# Set to e.g. /var/lib/mosquitto if running as a proper service on Linux or
+# similar.
+#persistence_location
+
+
+# =================================================================
+# Logging
+# =================================================================
+
+# Places to log to. Use multiple log_dest lines for multiple
+# logging destinations.
+# Possible destinations are: stdout stderr syslog topic file dlt
+#
+# stdout and stderr log to the console on the named output.
+#
+# syslog uses the userspace syslog facility which usually ends up
+# in /var/log/messages or similar.
+#
+# topic logs to the broker topic '$SYS/broker/log/<severity>',
+# where severity is one of D, E, W, N, I, M which are debug, error,
+# warning, notice, information and message. Message type severity is used by
+# the subscribe/unsubscribe log_types and publishes log messages to
+# $SYS/broker/log/M/susbcribe or $SYS/broker/log/M/unsubscribe.
+#
+# The file destination requires an additional parameter which is the file to be
+# logged to, e.g. "log_dest file /var/log/mosquitto.log". The file will be
+# closed and reopened when the broker receives a HUP signal. Only a single file
+# destination may be configured.
+#
+# The dlt destination is for the automotive `Diagnostic Log and Trace` tool.
+# This requires that Mosquitto has been compiled with DLT support.
+#
+# Note that if the broker is running as a Windows service it will default to
+# "log_dest none" and neither stdout nor stderr logging is available.
+# Use "log_dest none" if you wish to disable logging.
+#log_dest stderr
+
+# Types of messages to log. Use multiple log_type lines for logging
+# multiple types of messages.
+# Possible types are: debug, error, warning, notice, information,
+# none, subscribe, unsubscribe, websockets, all.
+# Note that debug type messages are for decoding the incoming/outgoing
+# network packets. They are not logged in "topics".
+#log_type error
+#log_type warning
+#log_type notice
+#log_type information
+
+
+# If set to true, client connection and disconnection messages will be included
+# in the log.
+#connection_messages true
+
+# If using syslog logging (not on Windows), messages will be logged to the
+# "daemon" facility by default. Use the log_facility option to choose which of
+# local0 to local7 to log to instead. The option value should be an integer
+# value, e.g. "log_facility 5" to use local5.
+#log_facility
+
+# If set to true, add a timestamp value to each log message.
+#log_timestamp true
+
+# Set the format of the log timestamp. If left unset, this is the number of
+# seconds since the Unix epoch.
+# This is a free text string which will be passed to the strftime function. To
+# get an ISO 8601 datetime, for example:
+# log_timestamp_format %Y-%m-%dT%H:%M:%S
+#log_timestamp_format
+
+# Change the websockets logging level. This is a global option, it is not
+# possible to set per listener. This is an integer that is interpreted by
+# libwebsockets as a bit mask for its lws_log_levels enum. See the
+# libwebsockets documentation for more details. "log_type websockets" must also
+# be enabled.
+#websockets_log_level 0
+
+
+# =================================================================
+# Security
+# =================================================================
+
+# If set, only clients that have a matching prefix on their
+# clientid will be allowed to connect to the broker. By default,
+# all clients may connect.
+# For example, setting "secure-" here would mean a client "secure-
+# client" could connect but another with clientid "mqtt" couldn't.
+#clientid_prefixes
+
+# Boolean value that determines whether clients that connect
+# without providing a username are allowed to connect. If set to
+# false then a password file should be created (see the
+# password_file option) to control authenticated client access.
+#
+# Defaults to false, unless there are no listeners defined in the configuration
+# file, in which case it is set to true, but connections are only allowed from
+# the local machine.
+allow_anonymous true
+
+# -----------------------------------------------------------------
+# Default authentication and topic access control
+# -----------------------------------------------------------------
+
+# Control access to the broker using a password file. This file can be
+# generated using the mosquitto_passwd utility. If TLS support is not compiled
+# into mosquitto (it is recommended that TLS support should be included) then
+# plain text passwords are used, in which case the file should be a text file
+# with lines in the format:
+# username:password
+# The password (and colon) may be omitted if desired, although this
+# offers very little in the way of security.
+#
+# See the TLS client require_certificate and use_identity_as_username options
+# for alternative authentication options. If a plugin is used as well as
+# password_file, the plugin check will be made first.
+#password_file
+
+# Access may also be controlled using a pre-shared-key file. This requires
+# TLS-PSK support and a listener configured to use it. The file should be text
+# lines in the format:
+# identity:key
+# The key should be in hexadecimal format without a leading "0x".
+# If an plugin is used as well, the plugin check will be made first.
+#psk_file
+
+# Control access to topics on the broker using an access control list
+# file. If this parameter is defined then only the topics listed will
+# have access.
+# If the first character of a line of the ACL file is a # it is treated as a
+# comment.
+# Topic access is added with lines of the format:
+#
+# topic [read|write|readwrite|deny] <topic>
+#
+# The access type is controlled using "read", "write", "readwrite" or "deny".
+# This parameter is optional (unless <topic> contains a space character) - if
+# not given then the access is read/write.  <topic> can contain the + or #
+# wildcards as in subscriptions.
+#
+# The "deny" option can used to explicitly deny access to a topic that would
+# otherwise be granted by a broader read/write/readwrite statement. Any "deny"
+# topics are handled before topics that grant read/write access.
+#
+# The first set of topics are applied to anonymous clients, assuming
+# allow_anonymous is true. User specific topic ACLs are added after a
+# user line as follows:
+#
+# user <username>
+#
+# The username referred to here is the same as in password_file. It is
+# not the clientid.
+#
+#
+# If is also possible to define ACLs based on pattern substitution within the
+# topic. The patterns available for substition are:
+#
+# %c to match the client id of the client
+# %u to match the username of the client
+#
+# The substitution pattern must be the only text for that level of hierarchy.
+#
+# The form is the same as for the topic keyword, but using pattern as the
+# keyword.
+# Pattern ACLs apply to all users even if the "user" keyword has previously
+# been given.
+#
+# If using bridges with usernames and ACLs, connection messages can be allowed
+# with the following pattern:
+# pattern write $SYS/broker/connection/%c/state
+#
+# pattern [read|write|readwrite] <topic>
+#
+# Example:
+#
+# pattern write sensor/%u/data
+#
+# If an plugin is used as well as acl_file, the plugin check will be
+# made first.
+#acl_file
+
+# -----------------------------------------------------------------
+# External authentication and topic access plugin options
+# -----------------------------------------------------------------
+
+# External authentication and access control can be supported with the
+# plugin option. This is a path to a loadable plugin. See also the
+# plugin_opt_* options described below.
+#
+# The plugin option can be specified multiple times to load multiple
+# plugins. The plugins will be processed in the order that they are specified
+# here. If the plugin option is specified alongside either of
+# password_file or acl_file then the plugin checks will be made first.
+#
+# If the per_listener_settings option is false, the plugin will be apply to all
+# listeners. If per_listener_settings is true, then the plugin will apply to
+# the current listener being defined only.
+#
+# This option is also available as `auth_plugin`, but this use is deprecated
+# and will be removed in the future.
+#
+#plugin
+
+# If the plugin option above is used, define options to pass to the
+# plugin here as described by the plugin instructions. All options named
+# using the format plugin_opt_* will be passed to the plugin, for example:
+#
+# This option is also available as `auth_opt_*`, but this use is deprecated
+# and will be removed in the future.
+#
+# plugin_opt_db_host
+# plugin_opt_db_port
+# plugin_opt_db_username
+# plugin_opt_db_password
+
+
+# =================================================================
+# Bridges
+# =================================================================
+
+# A bridge is a way of connecting multiple MQTT brokers together.
+# Create a new bridge using the "connection" option as described below. Set
+# options for the bridges using the remaining parameters. You must specify the
+# address and at least one topic to subscribe to.
+#
+# Each connection must have a unique name.
+#
+# The address line may have multiple host address and ports specified. See
+# below in the round_robin description for more details on bridge behaviour if
+# multiple addresses are used. Note that if you use an IPv6 address, then you
+# are required to specify a port.
+#
+# The direction that the topic will be shared can be chosen by
+# specifying out, in or both, where the default value is out.
+# The QoS level of the bridged communication can be specified with the next
+# topic option. The default QoS level is 0, to change the QoS the topic
+# direction must also be given.
+#
+# The local and remote prefix options allow a topic to be remapped when it is
+# bridged to/from the remote broker. This provides the ability to place a topic
+# tree in an appropriate location.
+#
+# For more details see the mosquitto.conf man page.
+#
+# Multiple topics can be specified per connection, but be careful
+# not to create any loops.
+#
+# If you are using bridges with cleansession set to false (the default), then
+# you may get unexpected behaviour from incoming topics if you change what
+# topics you are subscribing to. This is because the remote broker keeps the
+# subscription for the old topic. If you have this problem, connect your bridge
+# with cleansession set to true, then reconnect with cleansession set to false
+# as normal.
+#connection <name>
+#address <host>[:<port>] [<host>[:<port>]]
+#topic <topic> [[[out | in | both] qos-level] local-prefix remote-prefix]
+
+# If you need to have the bridge connect over a particular network interface,
+# use bridge_bind_address to tell the bridge which local IP address the socket
+# should bind to, e.g. `bridge_bind_address 192.168.1.10`
+#bridge_bind_address
+
+# If a bridge has topics that have "out" direction, the default behaviour is to
+# send an unsubscribe request to the remote broker on that topic. This means
+# that changing a topic direction from "in" to "out" will not keep receiving
+# incoming messages. Sending these unsubscribe requests is not always
+# desirable, setting bridge_attempt_unsubscribe to false will disable sending
+# the unsubscribe request.
+#bridge_attempt_unsubscribe true
+
+# Set the version of the MQTT protocol to use with for this bridge. Can be one
+# of mqttv50, mqttv311 or mqttv31. Defaults to mqttv311.
+#bridge_protocol_version mqttv311
+
+# Set the clean session variable for this bridge.
+# When set to true, when the bridge disconnects for any reason, all
+# messages and subscriptions will be cleaned up on the remote
+# broker. Note that with cleansession set to true, there may be a
+# significant amount of retained messages sent when the bridge
+# reconnects after losing its connection.
+# When set to false, the subscriptions and messages are kept on the
+# remote broker, and delivered when the bridge reconnects.
+#cleansession false
+
+# Set the amount of time a bridge using the lazy start type must be idle before
+# it will be stopped. Defaults to 60 seconds.
+#idle_timeout 60
+
+# Set the keepalive interval for this bridge connection, in
+# seconds.
+#keepalive_interval 60
+
+# Set the clientid to use on the local broker. If not defined, this defaults to
+# 'local.<clientid>'. If you are bridging a broker to itself, it is important
+# that local_clientid and clientid do not match.
+#local_clientid
+
+# If set to true, publish notification messages to the local and remote brokers
+# giving information about the state of the bridge connection. Retained
+# messages are published to the topic $SYS/broker/connection/<clientid>/state
+# unless the notification_topic option is used.
+# If the message is 1 then the connection is active, or 0 if the connection has
+# failed.
+# This uses the last will and testament feature.
+#notifications true
+
+# Choose the topic on which notification messages for this bridge are
+# published. If not set, messages are published on the topic
+# $SYS/broker/connection/<clientid>/state
+#notification_topic
+
+# Set the client id to use on the remote end of this bridge connection. If not
+# defined, this defaults to 'name.hostname' where name is the connection name
+# and hostname is the hostname of this computer.
+# This replaces the old "clientid" option to avoid confusion. "clientid"
+# remains valid for the time being.
+#remote_clientid
+
+# Set the password to use when connecting to a broker that requires
+# authentication. This option is only used if remote_username is also set.
+# This replaces the old "password" option to avoid confusion. "password"
+# remains valid for the time being.
+#remote_password
+
+# Set the username to use when connecting to a broker that requires
+# authentication.
+# This replaces the old "username" option to avoid confusion. "username"
+# remains valid for the time being.
+#remote_username
+
+# Set the amount of time a bridge using the automatic start type will wait
+# until attempting to reconnect.
+# This option can be configured to use a constant delay time in seconds, or to
+# use a backoff mechanism based on "Decorrelated Jitter", which adds a degree
+# of randomness to when the restart occurs.
+#
+# Set a constant timeout of 20 seconds:
+# restart_timeout 20
+#
+# Set backoff with a base (start value) of 10 seconds and a cap (upper limit) of
+# 60 seconds:
+# restart_timeout 10 30
+#
+# Defaults to jitter with a base of 5 and cap of 30
+#restart_timeout 5 30
+
+# If the bridge has more than one address given in the address/addresses
+# configuration, the round_robin option defines the behaviour of the bridge on
+# a failure of the bridge connection. If round_robin is false, the default
+# value, then the first address is treated as the main bridge connection. If
+# the connection fails, the other secondary addresses will be attempted in
+# turn. Whilst connected to a secondary bridge, the bridge will periodically
+# attempt to reconnect to the main bridge until successful.
+# If round_robin is true, then all addresses are treated as equals. If a
+# connection fails, the next address will be tried and if successful will
+# remain connected until it fails
+#round_robin false
+
+# Set the start type of the bridge. This controls how the bridge starts and
+# can be one of three types: automatic, lazy and once. Note that RSMB provides
+# a fourth start type "manual" which isn't currently supported by mosquitto.
+#
+# "automatic" is the default start type and means that the bridge connection
+# will be started automatically when the broker starts and also restarted
+# after a short delay (30 seconds) if the connection fails.
+#
+# Bridges using the "lazy" start type will be started automatically when the
+# number of queued messages exceeds the number set with the "threshold"
+# parameter. It will be stopped automatically after the time set by the
+# "idle_timeout" parameter. Use this start type if you wish the connection to
+# only be active when it is needed.
+#
+# A bridge using the "once" start type will be started automatically when the
+# broker starts but will not be restarted if the connection fails.
+#start_type automatic
+
+# Set the number of messages that need to be queued for a bridge with lazy
+# start type to be restarted. Defaults to 10 messages.
+# Must be less than max_queued_messages.
+#threshold 10
+
+# If try_private is set to true, the bridge will attempt to indicate to the
+# remote broker that it is a bridge not an ordinary client. If successful, this
+# means that loop detection will be more effective and that retained messages
+# will be propagated correctly. Not all brokers support this feature so it may
+# be necessary to set try_private to false if your bridge does not connect
+# properly.
+#try_private true
+
+# Some MQTT brokers do not allow retained messages. MQTT v5 gives a mechanism
+# for brokers to tell clients that they do not support retained messages, but
+# this is not possible for MQTT v3.1.1 or v3.1. If you need to bridge to a
+# v3.1.1 or v3.1 broker that does not support retained messages, set the
+# bridge_outgoing_retain option to false. This will remove the retain bit on
+# all outgoing messages to that bridge, regardless of any other setting.
+#bridge_outgoing_retain true
+
+# If you wish to restrict the size of messages sent to a remote bridge, use the
+# bridge_max_packet_size option. This sets the maximum number of bytes for
+# the total message, including headers and payload.
+# Note that MQTT v5 brokers may provide their own maximum-packet-size property.
+# In this case, the smaller of the two limits will be used.
+# Set to 0 for "unlimited".
+#bridge_max_packet_size 0
+
+
+# -----------------------------------------------------------------
+# Certificate based SSL/TLS support
+# -----------------------------------------------------------------
+# Either bridge_cafile or bridge_capath must be defined to enable TLS support
+# for this bridge.
+# bridge_cafile defines the path to a file containing the
+# Certificate Authority certificates that have signed the remote broker
+# certificate.
+# bridge_capath defines a directory that will be searched for files containing
+# the CA certificates. For bridge_capath to work correctly, the certificate
+# files must have ".crt" as the file ending and you must run "openssl rehash
+# <path to capath>" each time you add/remove a certificate.
+#bridge_cafile
+#bridge_capath
+
+
+# If the remote broker has more than one protocol available on its port, e.g.
+# MQTT and WebSockets, then use bridge_alpn to configure which protocol is
+# requested. Note that WebSockets support for bridges is not yet available.
+#bridge_alpn
+
+# When using certificate based encryption, bridge_insecure disables
+# verification of the server hostname in the server certificate. This can be
+# useful when testing initial server configurations, but makes it possible for
+# a malicious third party to impersonate your server through DNS spoofing, for
+# example. Use this option in testing only. If you need to resort to using this
+# option in a production environment, your setup is at fault and there is no
+# point using encryption.
+#bridge_insecure false
+
+# Path to the PEM encoded client certificate, if required by the remote broker.
+#bridge_certfile
+
+# Path to the PEM encoded client private key, if required by the remote broker.
+#bridge_keyfile
+
+# -----------------------------------------------------------------
+# PSK based SSL/TLS support
+# -----------------------------------------------------------------
+# Pre-shared-key encryption provides an alternative to certificate based
+# encryption. A bridge can be configured to use PSK with the bridge_identity
+# and bridge_psk options. These are the client PSK identity, and pre-shared-key
+# in hexadecimal format with no "0x". Only one of certificate and PSK based
+# encryption can be used on one
+# bridge at once.
+#bridge_identity
+#bridge_psk
+
+
+# =================================================================
+# External config files
+# =================================================================
+
+# External configuration files may be included by using the
+# include_dir option. This defines a directory that will be searched
+# for config files. All files that end in '.conf' will be loaded as
+# a configuration file. It is best to have this as the last option
+# in the main file. This option will only be processed from the main
+# configuration file. The directory specified must not contain the
+# main configuration file.
+# Files within include_dir will be loaded sorted in case-sensitive
+# alphabetical order, with capital letters ordered first. If this option is
+# given multiple times, all of the files from the first instance will be
+# processed before the next instance. See the man page for examples.
+#include_dir
diff --git a/integration/nest-application/app-locals/tsconfig.json b/integration/nest-application/app-locals/tsconfig.json
index 2a0adf369..259f2b525 100644
--- a/integration/nest-application/app-locals/tsconfig.json
+++ b/integration/nest-application/app-locals/tsconfig.json
@@ -7,16 +7,35 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "strictNullChecks": true,
+    "paths": {
+      "@nestjs/common": ["../../../packages/common"],
+      "@nestjs/common/*": ["../../../packages/common/*"],
+      "@nestjs/core": ["../../../packages/core"],
+      "@nestjs/core/*": ["../../../packages/core/*"],
+      "@nestjs/microservices": ["../../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../../packages/websockets/*"],
+      "@nestjs/testing": ["../../../packages/testing"],
+      "@nestjs/testing/*": ["../../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
     "e2e/**/*"
   ],
   "exclude": [
-    "node_modules"
+    "node_modules",
   ]
 }
\ No newline at end of file
diff --git a/integration/nest-application/get-url/tsconfig.json b/integration/nest-application/get-url/tsconfig.json
index 2a0adf369..259f2b525 100644
--- a/integration/nest-application/get-url/tsconfig.json
+++ b/integration/nest-application/get-url/tsconfig.json
@@ -7,16 +7,35 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "strictNullChecks": true,
+    "paths": {
+      "@nestjs/common": ["../../../packages/common"],
+      "@nestjs/common/*": ["../../../packages/common/*"],
+      "@nestjs/core": ["../../../packages/core"],
+      "@nestjs/core/*": ["../../../packages/core/*"],
+      "@nestjs/microservices": ["../../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../../packages/websockets/*"],
+      "@nestjs/testing": ["../../../packages/testing"],
+      "@nestjs/testing/*": ["../../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
     "e2e/**/*"
   ],
   "exclude": [
-    "node_modules"
+    "node_modules",
   ]
 }
\ No newline at end of file
diff --git a/integration/nest-application/global-prefix/e2e/global-prefix.spec.ts b/integration/nest-application/global-prefix/e2e/global-prefix.spec.ts
index b11becd24..76acf7121 100644
--- a/integration/nest-application/global-prefix/e2e/global-prefix.spec.ts
+++ b/integration/nest-application/global-prefix/e2e/global-prefix.spec.ts
@@ -108,15 +108,38 @@ describe('Global prefix', () => {
     server = app.getHttpServer();
     await app.init();
 
-    await request(server).get('/hello/foo').expect(200);
+    await request(server)
+      .get('/hello/foo')
+      .expect(200, 'Hello: Data attached in middleware');
 
     await request(server)
       .get('/middleware/foo')
       .expect(200, MIDDLEWARE_PARAM_VALUE);
 
+    await request(server).get('/api/v1/middleware/foo').expect(404);
+  });
+
+  it(`should get the params in the global prefix`, async () => {
+    app.setGlobalPrefix('/api/:tenantId');
+
+    server = app.getHttpServer();
+    await app.init();
+
+    await request(server)
+      .get('/api/test/params')
+      .expect(200, { '0': 'params', tenantId: 'test' });
+  });
+
+  it(`should execute middleware only once`, async () => {
+    app.setGlobalPrefix('/api', { exclude: ['/'] });
+
+    server = app.getHttpServer();
+    await app.init();
+
     await request(server)
-      .get('/api/v1/middleware/foo')
-      .expect(404);
+      .get('/')
+      .expect(200, 'Extras: Data attached in middleware, Count: 1');
+    await request(server).get('/api/count').expect(200, '2');
   });
 
   afterEach(async () => {
diff --git a/integration/nest-application/global-prefix/src/app.controller.ts b/integration/nest-application/global-prefix/src/app.controller.ts
index 8d1472a2f..416ca649e 100644
--- a/integration/nest-application/global-prefix/src/app.controller.ts
+++ b/integration/nest-application/global-prefix/src/app.controller.ts
@@ -1,10 +1,15 @@
-import { Controller, Get, Post } from '@nestjs/common';
+import { Controller, Get, Post, Req } from '@nestjs/common';
 
 @Controller()
 export class AppController {
   @Get('hello/:name')
-  getHello(): string {
-    return 'hello';
+  getHello(@Req() req): string {
+    return 'Hello: ' + req.extras?.data;
+  }
+
+  @Get('params')
+  getParams(@Req() req): any {
+    return req.middlewareParams;
   }
 
   @Get('health')
@@ -21,4 +26,14 @@ export class AppController {
   postTest(): string {
     return 'test';
   }
+
+  @Get()
+  getHome(@Req() req) {
+    return 'Extras: ' + req.extras?.data + ', Count: ' + req.count;
+  }
+
+  @Get('count')
+  getCount(@Req() req) {
+    return req.count;
+  }
 }
diff --git a/integration/nest-application/global-prefix/src/app.module.ts b/integration/nest-application/global-prefix/src/app.module.ts
index 2123145a8..65ba2236c 100644
--- a/integration/nest-application/global-prefix/src/app.module.ts
+++ b/integration/nest-application/global-prefix/src/app.module.ts
@@ -8,6 +8,7 @@ export const MIDDLEWARE_PARAM_VALUE = 'middleware_param';
   controllers: [AppController],
 })
 export class AppModule {
+  private count = 0;
   configure(consumer: MiddlewareConsumer) {
     consumer
       .apply((req, res, next) => res.end(MIDDLEWARE_VALUE))
@@ -17,6 +18,22 @@ export class AppModule {
       .apply((req, res, next) => res.end(MIDDLEWARE_PARAM_VALUE))
       .forRoutes({ path: MIDDLEWARE_VALUE + '/*', method: RequestMethod.GET })
       .apply((req, res, next) => res.status(201).end(MIDDLEWARE_PARAM_VALUE))
-      .forRoutes({ path: MIDDLEWARE_VALUE + '/*', method: RequestMethod.POST });
+      .forRoutes({ path: MIDDLEWARE_VALUE + '/*', method: RequestMethod.POST })
+      .apply((req, res, next) => {
+        req.extras = { data: 'Data attached in middleware' };
+        next();
+      })
+      .forRoutes({ path: '*', method: RequestMethod.GET })
+      .apply((req, res, next) => {
+        req.middlewareParams = req.params;
+        next();
+      })
+      .forRoutes({ path: '*', method: RequestMethod.GET })
+      .apply((req, res, next) => {
+        this.count += 1;
+        req.count = this.count;
+        next();
+      })
+      .forRoutes('*');
   }
 }
diff --git a/integration/nest-application/global-prefix/tsconfig.json b/integration/nest-application/global-prefix/tsconfig.json
index 2a0adf369..259f2b525 100644
--- a/integration/nest-application/global-prefix/tsconfig.json
+++ b/integration/nest-application/global-prefix/tsconfig.json
@@ -7,16 +7,35 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "strictNullChecks": true,
+    "paths": {
+      "@nestjs/common": ["../../../packages/common"],
+      "@nestjs/common/*": ["../../../packages/common/*"],
+      "@nestjs/core": ["../../../packages/core"],
+      "@nestjs/core/*": ["../../../packages/core/*"],
+      "@nestjs/microservices": ["../../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../../packages/websockets/*"],
+      "@nestjs/testing": ["../../../packages/testing"],
+      "@nestjs/testing/*": ["../../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
     "e2e/**/*"
   ],
   "exclude": [
-    "node_modules"
+    "node_modules",
   ]
 }
\ No newline at end of file
diff --git a/integration/nest-application/listen/e2e/express.spec.ts b/integration/nest-application/listen/e2e/express.spec.ts
index 98e757368..b209fa0c3 100644
--- a/integration/nest-application/listen/e2e/express.spec.ts
+++ b/integration/nest-application/listen/e2e/express.spec.ts
@@ -1,9 +1,9 @@
+import { INestApplication } from '@nestjs/common';
 import { ExpressAdapter } from '@nestjs/platform-express';
 import { Test, TestingModule } from '@nestjs/testing';
 import { expect } from 'chai';
 import * as express from 'express';
 import { AppModule } from '../src/app.module';
-import { INestApplication } from '@nestjs/common';
 
 describe('Listen (Express Application)', () => {
   let testModule: TestingModule;
@@ -17,7 +17,7 @@ describe('Listen (Express Application)', () => {
   });
 
   afterEach(async () => {
-    app.close();
+    await app.close();
   });
 
   it('should resolve with httpServer on success', async () => {
diff --git a/integration/nest-application/listen/e2e/fastify.spec.ts b/integration/nest-application/listen/e2e/fastify.spec.ts
index b779d3557..ba267c8dd 100644
--- a/integration/nest-application/listen/e2e/fastify.spec.ts
+++ b/integration/nest-application/listen/e2e/fastify.spec.ts
@@ -16,7 +16,7 @@ describe('Listen (Fastify Application)', () => {
   });
 
   afterEach(async () => {
-    app.close();
+    await app.close();
   });
 
   it('should resolve with httpServer on success', async () => {
diff --git a/integration/nest-application/listen/tsconfig.json b/integration/nest-application/listen/tsconfig.json
new file mode 100644
index 000000000..259f2b525
--- /dev/null
+++ b/integration/nest-application/listen/tsconfig.json
@@ -0,0 +1,41 @@
+{
+  "compilerOptions": {
+    "module": "commonjs",
+    "declaration": false,
+    "noImplicitAny": false,
+    "removeComments": true,
+    "noLib": false,
+    "emitDecoratorMetadata": true,
+    "experimentalDecorators": true,
+    "target": "ES2021",
+    "sourceMap": true,
+    "allowJs": true,
+    "outDir": "./dist",
+    "strictNullChecks": true,
+    "paths": {
+      "@nestjs/common": ["../../../packages/common"],
+      "@nestjs/common/*": ["../../../packages/common/*"],
+      "@nestjs/core": ["../../../packages/core"],
+      "@nestjs/core/*": ["../../../packages/core/*"],
+      "@nestjs/microservices": ["../../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../../packages/websockets/*"],
+      "@nestjs/testing": ["../../../packages/testing"],
+      "@nestjs/testing/*": ["../../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../../packages/platform-ws/*"]
+    }
+  },
+  "include": [
+    "src/**/*",
+    "e2e/**/*"
+  ],
+  "exclude": [
+    "node_modules",
+  ]
+}
\ No newline at end of file
diff --git a/integration/nest-application/raw-body/e2e/express.spec.ts b/integration/nest-application/raw-body/e2e/express.spec.ts
new file mode 100644
index 000000000..762ecd92c
--- /dev/null
+++ b/integration/nest-application/raw-body/e2e/express.spec.ts
@@ -0,0 +1,77 @@
+import { NestExpressApplication } from '@nestjs/platform-express';
+import { Test } from '@nestjs/testing';
+import { expect } from 'chai';
+import * as request from 'supertest';
+import { ExpressModule } from '../src/express.module';
+
+describe('Raw body (Express Application)', () => {
+  let app: NestExpressApplication;
+
+  beforeEach(async () => {
+    const moduleFixture = await Test.createTestingModule({
+      imports: [ExpressModule],
+    }).compile();
+
+    app = moduleFixture.createNestApplication<NestExpressApplication>({
+      rawBody: true,
+    });
+
+    await app.init();
+  });
+
+  afterEach(async () => {
+    await app.close();
+  });
+
+  describe('application/json', () => {
+    const body = '{ "amount":0.0 }';
+
+    it('should return exact post body', async () => {
+      const response = await request(app.getHttpServer())
+        .post('/')
+        .set('Content-Type', 'application/json')
+        .send(body)
+        .expect(201);
+
+      expect(response.body).to.eql({
+        parsed: {
+          amount: 0,
+        },
+        raw: body,
+      });
+    });
+
+    it('should work if post body is empty', async () => {
+      await request(app.getHttpServer())
+        .post('/')
+        .set('Content-Type', 'application/json')
+        .expect(201);
+    });
+  });
+
+  describe('application/x-www-form-urlencoded', () => {
+    const body = 'content=this is a post\'s content by "Nest"';
+
+    it('should return exact post body', async () => {
+      const response = await request(app.getHttpServer())
+        .post('/')
+        .set('Content-Type', 'application/x-www-form-urlencoded')
+        .send(body)
+        .expect(201);
+
+      expect(response.body).to.eql({
+        parsed: {
+          content: 'this is a post\'s content by "Nest"',
+        },
+        raw: body,
+      });
+    });
+
+    it('should work if post body is empty', async () => {
+      await request(app.getHttpServer())
+        .post('/')
+        .set('Content-Type', 'application/x-www-form-urlencoded')
+        .expect(201);
+    });
+  });
+});
diff --git a/integration/nest-application/raw-body/e2e/fastify.spec.ts b/integration/nest-application/raw-body/e2e/fastify.spec.ts
new file mode 100644
index 000000000..03db3f137
--- /dev/null
+++ b/integration/nest-application/raw-body/e2e/fastify.spec.ts
@@ -0,0 +1,98 @@
+import {
+  NestFastifyApplication,
+  FastifyAdapter,
+} from '@nestjs/platform-fastify';
+import { Test } from '@nestjs/testing';
+import { expect } from 'chai';
+import { FastifyModule } from '../src/fastify.module';
+
+describe('Raw body (Fastify Application)', () => {
+  let app: NestFastifyApplication;
+
+  beforeEach(async () => {
+    const moduleFixture = await Test.createTestingModule({
+      imports: [FastifyModule],
+    }).compile();
+
+    app = moduleFixture.createNestApplication<NestFastifyApplication>(
+      new FastifyAdapter(),
+      {
+        rawBody: true,
+      },
+    );
+
+    await app.init();
+  });
+
+  afterEach(async () => {
+    await app.close();
+  });
+
+  describe('application/json', () => {
+    const body = '{ "amount":0.0 }';
+
+    it('should return exact post body', async () => {
+      const response = await app.inject({
+        method: 'POST',
+        url: '/',
+        headers: { 'content-type': 'application/json' },
+        payload: body,
+      });
+
+      expect(JSON.parse(response.body)).to.eql({
+        parsed: {
+          amount: 0,
+        },
+        raw: body,
+      });
+    });
+
+    it('should fail if post body is empty', async () => {
+      const response = await app.inject({
+        method: 'POST',
+        url: '/',
+        headers: {
+          'content-type': 'application/json',
+          accept: 'application/json',
+        },
+      });
+
+      // Unlike Express, when you send a POST request without a body
+      // with Fastify, Fastify will throw an error because it isn't valid
+      // JSON. See fastify/fastify#297.
+      expect(response.statusCode).to.equal(400);
+    });
+  });
+
+  describe('application/x-www-form-urlencoded', () => {
+    const body = 'content=this is a post\'s content by "Nest"';
+
+    it('should return exact post body', async () => {
+      const response = await app.inject({
+        method: 'POST',
+        url: '/',
+        headers: { 'content-type': 'application/x-www-form-urlencoded' },
+        payload: body,
+      });
+
+      expect(JSON.parse(response.body)).to.eql({
+        parsed: {
+          content: 'this is a post\'s content by "Nest"',
+        },
+        raw: body,
+      });
+    });
+
+    it('should work if post body is empty', async () => {
+      const response = await app.inject({
+        method: 'POST',
+        url: '/',
+        headers: {
+          'content-type': 'application/x-www-form-urlencoded',
+        },
+      });
+
+      expect(response.statusCode).to.equal(201);
+    });
+  });
+});
diff --git a/integration/nest-application/raw-body/src/express.controller.ts b/integration/nest-application/raw-body/src/express.controller.ts
new file mode 100644
index 000000000..58521af2b
--- /dev/null
+++ b/integration/nest-application/raw-body/src/express.controller.ts
@@ -0,0 +1,13 @@
+import { Controller, Post, RawBodyRequest, Req } from '@nestjs/common';
+import { Request } from 'express';
+
+@Controller()
+export class ExpressController {
+  @Post()
+  getRawBody(@Req() req: RawBodyRequest<Request>) {
+    return {
+      parsed: req.body,
+      raw: req.rawBody!.toString(),
+    };
+  }
+}
diff --git a/integration/nest-application/raw-body/src/express.module.ts b/integration/nest-application/raw-body/src/express.module.ts
new file mode 100644
index 000000000..5ddb71426
--- /dev/null
+++ b/integration/nest-application/raw-body/src/express.module.ts
@@ -0,0 +1,7 @@
+import { Module } from '@nestjs/common';
+import { ExpressController } from './express.controller';
+
+@Module({
+  controllers: [ExpressController],
+})
+export class ExpressModule {}
diff --git a/integration/nest-application/raw-body/src/fastify.controller.ts b/integration/nest-application/raw-body/src/fastify.controller.ts
new file mode 100644
index 000000000..1c158985d
--- /dev/null
+++ b/integration/nest-application/raw-body/src/fastify.controller.ts
@@ -0,0 +1,13 @@
+import { Controller, Post, RawBodyRequest, Req } from '@nestjs/common';
+import type { FastifyRequest } from 'fastify';
+
+@Controller()
+export class FastifyController {
+  @Post()
+  getRawBody(@Req() req: RawBodyRequest<FastifyRequest>) {
+    return {
+      parsed: req.body,
+      raw: req.rawBody!.toString(),
+    };
+  }
+}
diff --git a/integration/nest-application/raw-body/src/fastify.module.ts b/integration/nest-application/raw-body/src/fastify.module.ts
new file mode 100644
index 000000000..462f427ba
--- /dev/null
+++ b/integration/nest-application/raw-body/src/fastify.module.ts
@@ -0,0 +1,7 @@
+import { Module } from '@nestjs/common';
+import { FastifyController } from './fastify.controller';
+
+@Module({
+  controllers: [FastifyController],
+})
+export class FastifyModule {}
diff --git a/integration/nest-application/raw-body/tsconfig.json b/integration/nest-application/raw-body/tsconfig.json
new file mode 100644
index 000000000..259f2b525
--- /dev/null
+++ b/integration/nest-application/raw-body/tsconfig.json
@@ -0,0 +1,41 @@
+{
+  "compilerOptions": {
+    "module": "commonjs",
+    "declaration": false,
+    "noImplicitAny": false,
+    "removeComments": true,
+    "noLib": false,
+    "emitDecoratorMetadata": true,
+    "experimentalDecorators": true,
+    "target": "ES2021",
+    "sourceMap": true,
+    "allowJs": true,
+    "outDir": "./dist",
+    "strictNullChecks": true,
+    "paths": {
+      "@nestjs/common": ["../../../packages/common"],
+      "@nestjs/common/*": ["../../../packages/common/*"],
+      "@nestjs/core": ["../../../packages/core"],
+      "@nestjs/core/*": ["../../../packages/core/*"],
+      "@nestjs/microservices": ["../../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../../packages/websockets/*"],
+      "@nestjs/testing": ["../../../packages/testing"],
+      "@nestjs/testing/*": ["../../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../../packages/platform-ws/*"]
+    }
+  },
+  "include": [
+    "src/**/*",
+    "e2e/**/*"
+  ],
+  "exclude": [
+    "node_modules",
+  ]
+}
\ No newline at end of file
diff --git a/integration/nest-application/sse/e2e/express.spec.ts b/integration/nest-application/sse/e2e/express.spec.ts
new file mode 100644
index 000000000..363dc807f
--- /dev/null
+++ b/integration/nest-application/sse/e2e/express.spec.ts
@@ -0,0 +1,79 @@
+import { NestExpressApplication } from '@nestjs/platform-express';
+import { Test } from '@nestjs/testing';
+import { expect } from 'chai';
+import * as EventSource from 'eventsource';
+import { AppModule } from '../src/app.module';
+
+describe('Sse (Express Application)', () => {
+  let app: NestExpressApplication;
+  let eventSource: EventSource;
+
+  describe('without forceCloseConnections', () => {
+    beforeEach(async () => {
+      const moduleFixture = await Test.createTestingModule({
+        imports: [AppModule],
+      }).compile();
+
+      app = moduleFixture.createNestApplication<NestExpressApplication>();
+
+      await app.listen(3000);
+      const url = await app.getUrl();
+
+      eventSource = new EventSource(url + '/sse', {
+        headers: { connection: 'keep-alive' },
+      });
+    });
+
+    // The order of actions is very important here. When not using `forceCloseConnections`,
+    // the SSe eventsource should close the connections in order to signal the server that
+    // the keep-alive connection can be ended.
+    afterEach(async () => {
+      eventSource.close();
+
+      await app.close();
+    });
+
+    it('receives events from server', done => {
+      eventSource.addEventListener('message', event => {
+        expect(JSON.parse(event.data)).to.eql({
+          hello: 'world',
+        });
+        done();
+      });
+    });
+  });
+
+  describe('with forceCloseConnections', () => {
+    beforeEach(async () => {
+      const moduleFixture = await Test.createTestingModule({
+        imports: [AppModule],
+      }).compile();
+
+      app = moduleFixture.createNestApplication<NestExpressApplication>({
+        forceCloseConnections: true,
+      });
+
+      await app.listen(3000);
+      const url = await app.getUrl();
+
+      eventSource = new EventSource(url + '/sse', {
+        headers: { connection: 'keep-alive' },
+      });
+    });
+
+    afterEach(async () => {
+      await app.close();
+
+      eventSource.close();
+    });
+
+    it('receives events from server', done => {
+      eventSource.addEventListener('message', event => {
+        expect(JSON.parse(event.data)).to.eql({
+          hello: 'world',
+        });
+        done();
+      });
+    });
+  });
+});
diff --git a/integration/nest-application/sse/e2e/fastify.spec.ts b/integration/nest-application/sse/e2e/fastify.spec.ts
new file mode 100644
index 000000000..4fc1ebf20
--- /dev/null
+++ b/integration/nest-application/sse/e2e/fastify.spec.ts
@@ -0,0 +1,86 @@
+import {
+  FastifyAdapter,
+  NestFastifyApplication,
+} from '@nestjs/platform-fastify';
+import { Test } from '@nestjs/testing';
+import { expect } from 'chai';
+import * as EventSource from 'eventsource';
+import { AppModule } from '../src/app.module';
+
+describe('Sse (Fastify Application)', () => {
+  let app: NestFastifyApplication;
+  let eventSource: EventSource;
+
+  describe('without forceCloseConnections', () => {
+    beforeEach(async () => {
+      const moduleFixture = await Test.createTestingModule({
+        imports: [AppModule],
+      }).compile();
+
+      app = moduleFixture.createNestApplication<NestFastifyApplication>(
+        new FastifyAdapter(),
+      );
+
+      await app.listen(3000);
+      const url = await app.getUrl();
+
+      eventSource = new EventSource(url + '/sse', {
+        headers: { connection: 'keep-alive' },
+      });
+    });
+
+    // The order of actions is very important here. When not using `forceCloseConnections`,
+    // the SSe eventsource should close the connections in order to signal the server that
+    // the keep-alive connection can be ended.
+    afterEach(async () => {
+      eventSource.close();
+
+      await app.close();
+    });
+
+    it('receives events from server', done => {
+      eventSource.addEventListener('message', event => {
+        expect(JSON.parse(event.data)).to.eql({
+          hello: 'world',
+        });
+        done();
+      });
+    });
+  });
+
+  describe('with forceCloseConnections', () => {
+    beforeEach(async () => {
+      const moduleFixture = await Test.createTestingModule({
+        imports: [AppModule],
+      }).compile();
+
+      app = moduleFixture.createNestApplication<NestFastifyApplication>(
+        new FastifyAdapter({
+          forceCloseConnections: true,
+        }),
+      );
+
+      await app.listen(3000);
+      const url = await app.getUrl();
+
+      eventSource = new EventSource(url + '/sse', {
+        headers: { connection: 'keep-alive' },
+      });
+    });
+
+    afterEach(async () => {
+      await app.close();
+
+      eventSource.close();
+    });
+
+    it('receives events from server', done => {
+      eventSource.addEventListener('message', event => {
+        expect(JSON.parse(event.data)).to.eql({
+          hello: 'world',
+        });
+        done();
+      });
+    });
+  });
+});
diff --git a/integration/nest-application/sse/src/app.controller.ts b/integration/nest-application/sse/src/app.controller.ts
new file mode 100644
index 000000000..e740d542b
--- /dev/null
+++ b/integration/nest-application/sse/src/app.controller.ts
@@ -0,0 +1,12 @@
+import { Controller, MessageEvent, Sse } from '@nestjs/common';
+import { interval, map, Observable } from 'rxjs';
+
+@Controller()
+export class AppController {
+  @Sse('sse')
+  sse(): Observable<MessageEvent> {
+    return interval(1000).pipe(
+      map(() => ({ data: { hello: 'world' } }) as MessageEvent),
+    );
+  }
+}
diff --git a/integration/nest-application/sse/src/app.module.ts b/integration/nest-application/sse/src/app.module.ts
new file mode 100644
index 000000000..848d4aaa7
--- /dev/null
+++ b/integration/nest-application/sse/src/app.module.ts
@@ -0,0 +1,7 @@
+import { Module } from '@nestjs/common';
+import { AppController } from './app.controller';
+
+@Module({
+  controllers: [AppController],
+})
+export class AppModule {}
diff --git a/integration/nest-application/sse/tsconfig.json b/integration/nest-application/sse/tsconfig.json
new file mode 100644
index 000000000..23ca65610
--- /dev/null
+++ b/integration/nest-application/sse/tsconfig.json
@@ -0,0 +1,41 @@
+{
+  "compilerOptions": {
+    "module": "commonjs",
+    "declaration": false,
+    "noImplicitAny": false,
+    "removeComments": true,
+    "noLib": false,
+    "emitDecoratorMetadata": true,
+    "experimentalDecorators": true,
+    "target": "ES2021",
+    "sourceMap": true,
+    "allowJs": true,
+    "lib": ["dom"],
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../../packages/common"],
+      "@nestjs/common/*": ["../../../packages/common/*"],
+      "@nestjs/core": ["../../../packages/core"],
+      "@nestjs/core/*": ["../../../packages/core/*"],
+      "@nestjs/microservices": ["../../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../../packages/websockets/*"],
+      "@nestjs/testing": ["../../../packages/testing"],
+      "@nestjs/testing/*": ["../../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../../packages/platform-ws/*"]
+    }
+  },
+  "include": [
+    "src/**/*",
+    "e2e/**/*"
+  ],
+  "exclude": [
+    "node_modules",
+  ]
+}
\ No newline at end of file
diff --git a/integration/nest-application/use-body-parser/e2e/express.spec.ts b/integration/nest-application/use-body-parser/e2e/express.spec.ts
new file mode 100644
index 000000000..06e77086d
--- /dev/null
+++ b/integration/nest-application/use-body-parser/e2e/express.spec.ts
@@ -0,0 +1,95 @@
+import { NestExpressApplication } from '@nestjs/platform-express';
+import { Test } from '@nestjs/testing';
+import { OptionsUrlencoded } from 'body-parser';
+import { expect } from 'chai';
+import * as request from 'supertest';
+import { AppModule } from '../src/app.module';
+
+describe('Body Parser (Express Application)', () => {
+  const moduleFixture = Test.createTestingModule({
+    imports: [AppModule],
+  });
+  let app: NestExpressApplication;
+
+  afterEach(async () => {
+    await app.close();
+  });
+
+  describe('application/json', () => {
+    const stringLimit = '{ "msg": "Hello, World" }';
+    const stringOverLimit = '{ "msg": "Hello, World!" }';
+
+    beforeEach(async () => {
+      const testFixture = await moduleFixture.compile();
+
+      app = testFixture
+        .createNestApplication<NestExpressApplication>({
+          rawBody: true,
+          logger: false,
+        })
+        .useBodyParser('json', { limit: Buffer.from(stringLimit).byteLength });
+
+      await app.init();
+    });
+
+    it('should allow request with matching body limit', async () => {
+      const response = await request(app.getHttpServer())
+        .post('/')
+        .set('Content-Type', 'application/json')
+        .send(stringLimit)
+        .expect(201);
+
+      expect(response.body).to.eql({
+        raw: stringLimit,
+      });
+    });
+
+    it('should fail if post body is larger than limit', async () => {
+      await request(app.getHttpServer())
+        .post('/')
+        .set('Content-Type', 'application/json')
+        .send(stringOverLimit)
+        .expect(413);
+    });
+  });
+
+  describe('application/x-www-form-urlencoded', () => {
+    const stringLimit = 'msg=Hello, World';
+    const stringOverLimit = 'msg=Hello, World!';
+
+    beforeEach(async () => {
+      const testFixture = await moduleFixture.compile();
+
+      app = testFixture
+        .createNestApplication<NestExpressApplication>({
+          rawBody: true,
+          logger: false,
+        })
+        .useBodyParser<OptionsUrlencoded>('urlencoded', {
+          limit: Buffer.from(stringLimit).byteLength,
+          extended: true,
+        });
+
+      await app.init();
+    });
+    it('should allow request with matching body limit', async () => {
+      const response = await request(app.getHttpServer())
+        .post('/')
+        .set('Content-Type', 'application/x-www-form-urlencoded')
+        .send(stringLimit)
+        .expect(201);
+
+      expect(response.body).to.eql({
+        raw: stringLimit,
+      });
+    });
+
+    it('should fail if post body is larger than limit', async () => {
+      await request(app.getHttpServer())
+        .post('/')
+        .set('Content-Type', 'application/x-www-form-urlencoded')
+        .send(stringOverLimit)
+        .expect(413);
+    });
+  });
+});
diff --git a/integration/nest-application/use-body-parser/e2e/fastify.spec.ts b/integration/nest-application/use-body-parser/e2e/fastify.spec.ts
new file mode 100644
index 000000000..26a9240d2
--- /dev/null
+++ b/integration/nest-application/use-body-parser/e2e/fastify.spec.ts
@@ -0,0 +1,106 @@
+import {
+  FastifyAdapter,
+  NestFastifyApplication,
+} from '@nestjs/platform-fastify';
+import { Test } from '@nestjs/testing';
+import { expect } from 'chai';
+import { AppModule } from '../src/app.module';
+
+describe('Body Parser (Fastify Application)', () => {
+  const moduleFixture = Test.createTestingModule({
+    imports: [AppModule],
+  });
+  let app: NestFastifyApplication;
+
+  afterEach(async () => {
+    await app.close();
+  });
+
+  describe('application/json', () => {
+    const stringLimit = '{ "msg": "Hello, World" }';
+    const stringOverLimit = '{ "msg": "Hello, World!" }';
+
+    beforeEach(async () => {
+      const testFixture = await moduleFixture.compile();
+
+      app = testFixture
+        .createNestApplication<NestFastifyApplication>(new FastifyAdapter(), {
+          rawBody: true,
+          logger: false,
+        })
+        .useBodyParser('application/json', {
+          bodyLimit: Buffer.from(stringLimit).byteLength,
+        });
+
+      await app.init();
+    });
+
+    it('should allow request with matching body limit', async () => {
+      const response = await app.inject({
+        method: 'POST',
+        url: '/',
+        headers: { 'content-type': 'application/json' },
+        payload: stringLimit,
+      });
+
+      expect(JSON.parse(response.body)).to.eql({
+        raw: stringLimit,
+      });
+    });
+
+    it('should fail if post body is larger than limit', async () => {
+      const response = await app.inject({
+        method: 'POST',
+        url: '/',
+        headers: { 'content-type': 'application/json' },
+        payload: stringOverLimit,
+      });
+
+      expect(response.statusCode).to.equal(413);
+    });
+  });
+
+  describe('application/x-www-form-urlencoded', () => {
+    const stringLimit = 'msg=Hello, World';
+    const stringOverLimit = 'msg=Hello, World!';
+
+    beforeEach(async () => {
+      const testFixture = await moduleFixture.compile();
+
+      app = testFixture
+        .createNestApplication<NestFastifyApplication>(new FastifyAdapter(), {
+          rawBody: true,
+          logger: false,
+        })
+        .useBodyParser('application/x-www-form-urlencoded', {
+          bodyLimit: Buffer.from(stringLimit).byteLength,
+        });
+
+      await app.init();
+    });
+
+    it('should allow request with matching body limit', async () => {
+      const response = await app.inject({
+        method: 'POST',
+        url: '/',
+        headers: { 'content-type': 'application/x-www-form-urlencoded' },
+        payload: stringLimit,
+      });
+
+      expect(JSON.parse(response.body)).to.eql({
+        raw: stringLimit,
+      });
+    });
+
+    it('should fail if post body is larger than limit', async () => {
+      const response = await app.inject({
+        method: 'POST',
+        url: '/',
+        headers: { 'content-type': 'application/x-www-form-urlencoded' },
+        payload: stringOverLimit,
+      });
+
+      expect(response.statusCode).to.equal(413);
+    });
+  });
+});
diff --git a/integration/nest-application/use-body-parser/src/app.controller.ts b/integration/nest-application/use-body-parser/src/app.controller.ts
new file mode 100644
index 000000000..8c110580c
--- /dev/null
+++ b/integration/nest-application/use-body-parser/src/app.controller.ts
@@ -0,0 +1,12 @@
+import { Controller, Post, Req, RawBodyRequest } from '@nestjs/common';
+import { IncomingMessage } from 'http';
+
+@Controller()
+export class AppController {
+  @Post()
+  index(@Req() req: RawBodyRequest<IncomingMessage>) {
+    return {
+      raw: req.rawBody?.toString(),
+    };
+  }
+}
diff --git a/integration/nest-application/use-body-parser/src/app.module.ts b/integration/nest-application/use-body-parser/src/app.module.ts
new file mode 100644
index 000000000..848d4aaa7
--- /dev/null
+++ b/integration/nest-application/use-body-parser/src/app.module.ts
@@ -0,0 +1,7 @@
+import { Module } from '@nestjs/common';
+import { AppController } from './app.controller';
+
+@Module({
+  controllers: [AppController],
+})
+export class AppModule {}
diff --git a/integration/cache/src/multi-store/tsconfig.json b/integration/nest-application/use-body-parser/tsconfig.json
similarity index 85%
rename from integration/cache/src/multi-store/tsconfig.json
rename to integration/nest-application/use-body-parser/tsconfig.json
index 567a5c9e6..999ab15b7 100644
--- a/integration/cache/src/multi-store/tsconfig.json
+++ b/integration/nest-application/use-body-parser/tsconfig.json
@@ -4,10 +4,11 @@
     "declaration": false,
     "noImplicitAny": false,
     "removeComments": true,
+    "lib": ["dom"],
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
     "outDir": "./dist"
@@ -17,6 +18,6 @@
     "e2e/**/*"
   ],
   "exclude": [
-    "node_modules",
+    "node_modules"
   ]
 }
diff --git a/integration/repl/e2e/repl.spec.ts b/integration/repl/e2e/repl.spec.ts
new file mode 100644
index 000000000..8ddcc673d
--- /dev/null
+++ b/integration/repl/e2e/repl.spec.ts
@@ -0,0 +1,262 @@
+import { clc } from '@nestjs/common/utils/cli-colors.util';
+import { repl } from '@nestjs/core';
+import {
+  DebugReplFn,
+  GetReplFn,
+  HelpReplFn,
+  MethodsReplFn,
+  ResolveReplFn,
+  SelectReplFn,
+} from '@nestjs/core/repl/native-functions';
+import { ReplContext } from '@nestjs/core/repl/repl-context';
+import { expect } from 'chai';
+import * as sinon from 'sinon';
+import { AppModule } from '../src/app.module';
+
+const PROMPT = '\u001b[1G\u001b[0J> \u001b[3G';
+
+describe('REPL', () => {
+  beforeEach(() => {
+    // To avoid coloring the output:
+    sinon.stub(clc, 'bold').callsFake(text => text);
+    sinon.stub(clc, 'green').callsFake(text => text);
+    sinon.stub(clc, 'yellow').callsFake(text => text);
+    sinon.stub(clc, 'red').callsFake(text => text);
+    sinon.stub(clc, 'magentaBright').callsFake(text => text);
+    sinon.stub(clc, 'cyanBright').callsFake(text => text);
+  });
+  afterEach(() => {
+    sinon.restore();
+  });
+
+  it('get()', async () => {
+    const server = await repl(AppModule);
+    server.context;
+    let outputText = '';
+    sinon.stub(process.stdout, 'write').callsFake(text => {
+      outputText += text as string;
+      return true;
+    });
+    server.emit('line', 'get(UsersService)');
+
+    expect(outputText).to.equal(
+      `UsersService { usersRepository: UsersRepository {} }
+${PROMPT}`,
+    );
+
+    outputText = '';
+    server.emit('line', 'get(UsersService).findAll()');
+
+    expect(outputText).to
+      .equal(`\u001b[32m'This action returns all users'\u001b[39m
+${PROMPT}`);
+
+    outputText = '';
+    server.emit('line', 'get("UsersRepository")');
+
+    expect(outputText).to.equal(`UsersRepository {}
+${PROMPT}`);
+  });
+
+  it('$()', async () => {
+    const server = await repl(AppModule);
+    server.context;
+    let outputText = '';
+    sinon.stub(process.stdout, 'write').callsFake(text => {
+      outputText += text as string;
+      return true;
+    });
+    server.emit('line', '$(UsersService)');
+
+    expect(outputText).to.equal(
+      `UsersService { usersRepository: UsersRepository {} }
+${PROMPT}`,
+    );
+
+    outputText = '';
+    server.emit('line', '$(UsersService).findAll()');
+
+    expect(outputText).to
+      .equal(`\u001b[32m'This action returns all users'\u001b[39m
+${PROMPT}`);
+
+    outputText = '';
+    server.emit('line', '$("UsersRepository")');
+
+    expect(outputText).to.equal(`UsersRepository {}
+${PROMPT}`);
+  });
+
+  it('debug()', async () => {
+    const server = await repl(AppModule);
+
+    let outputText = '';
+    sinon.stub(process.stdout, 'write').callsFake(text => {
+      outputText += text as string;
+      return true;
+    });
+    server.emit('line', 'debug(UsersModule)');
+
+    expect(outputText).to.equal(
+      `
+UsersModule:
+ - controllers:
+  ‚óª UsersController
+ - providers:
+  ‚óª UsersService
+  ‚óª "UsersRepository"
+
+${PROMPT}`,
+    );
+  });
+
+  it('methods()', async () => {
+    const server = await repl(AppModule);
+
+    let outputText = '';
+    sinon.stub(process.stdout, 'write').callsFake(text => {
+      outputText += text as string;
+      return true;
+    });
+    server.emit('line', 'methods("UsersRepository")');
+
+    expect(outputText).to.equal(
+      `
+Methods:
+ ‚óª find
+
+${PROMPT}`,
+    );
+
+    outputText = '';
+    server.emit('line', 'methods(UsersService)');
+
+    expect(outputText).to.equal(
+      `
+Methods:
+ ‚óª create
+ ‚óª findAll
+ ‚óª findOne
+ ‚óª update
+ ‚óª remove
+
+${PROMPT}`,
+    );
+  });
+
+  describe('<native_function>.help', () => {
+    it(`Typing "help.help" should print function's description and interface`, async () => {
+      const replServer = await repl(AppModule);
+
+      const { description, signature } = new HelpReplFn(
+        sinon.stub() as unknown as ReplContext,
+      ).fnDefinition;
+      let outputText = '';
+      sinon.stub(process.stdout, 'write').callsFake(text => {
+        outputText += text as string;
+        return true;
+      });
+
+      replServer.emit('line', 'help.help');
+
+      expect(outputText).to.equal(`${description}
+Interface: help${signature}
+${PROMPT}`);
+    });
+
+    it(`Typing "get.help" should print function's description and interface`, async () => {
+      const replServer = await repl(AppModule);
+
+      const { description, signature } = new GetReplFn(
+        sinon.stub() as unknown as ReplContext,
+      ).fnDefinition;
+      let outputText = '';
+      sinon.stub(process.stdout, 'write').callsFake(text => {
+        outputText += text as string;
+        return true;
+      });
+
+      replServer.emit('line', 'get.help');
+
+      expect(outputText).to.equal(`${description}
+Interface: get${signature}
+${PROMPT}`);
+    });
+
+    it(`Typing "resolve.help" should print function's description and interface`, async () => {
+      const replServer = await repl(AppModule);
+
+      const { description, signature } = new ResolveReplFn(
+        sinon.stub() as unknown as ReplContext,
+      ).fnDefinition;
+      let outputText = '';
+      sinon.stub(process.stdout, 'write').callsFake(text => {
+        outputText += text as string;
+        return true;
+      });
+
+      replServer.emit('line', 'resolve.help');
+
+      expect(outputText).to.equal(`${description}
+Interface: resolve${signature}
+${PROMPT}`);
+    });
+
+    it(`Typing "select.help" should print function's description and interface`, async () => {
+      const replServer = await repl(AppModule);
+
+      const { description, signature } = new SelectReplFn(
+        sinon.stub() as unknown as ReplContext,
+      ).fnDefinition;
+      let outputText = '';
+      sinon.stub(process.stdout, 'write').callsFake(text => {
+        outputText += text as string;
+        return true;
+      });
+
+      replServer.emit('line', 'select.help');
+
+      expect(outputText).to.equal(`${description}
+Interface: select${signature}
+${PROMPT}`);
+    });
+
+    it(`Typing "debug.help" should print function's description and interface`, async () => {
+      const replServer = await repl(AppModule);
+
+      const { description, signature } = new DebugReplFn(
+        sinon.stub() as unknown as ReplContext,
+      ).fnDefinition;
+      let outputText = '';
+      sinon.stub(process.stdout, 'write').callsFake(text => {
+        outputText += text as string;
+        return true;
+      });
+
+      replServer.emit('line', 'debug.help');
+
+      expect(outputText).to.equal(`${description}
+Interface: debug${signature}
+${PROMPT}`);
+    });
+
+    it(`Typing "methods.help" should print function's description and interface`, async () => {
+      const replServer = await repl(AppModule);
+
+      const { description, signature } = new MethodsReplFn(
+        sinon.stub() as unknown as ReplContext,
+      ).fnDefinition;
+      let outputText = '';
+      sinon.stub(process.stdout, 'write').callsFake(text => {
+        outputText += text as string;
+        return true;
+      });
+
+      replServer.emit('line', 'methods.help');
+
+      expect(outputText).to.equal(`${description}
+Interface: methods${signature}
+${PROMPT}`);
+    });
+  });
+});
diff --git a/integration/repl/src/app.module.ts b/integration/repl/src/app.module.ts
new file mode 100644
index 000000000..867c4b1b3
--- /dev/null
+++ b/integration/repl/src/app.module.ts
@@ -0,0 +1,7 @@
+import { Module } from '@nestjs/common';
+import { UsersModule } from './users/users.module';
+
+@Module({
+  imports: [UsersModule],
+})
+export class AppModule {}
diff --git a/integration/repl/src/users/dto/create-user.dto.ts b/integration/repl/src/users/dto/create-user.dto.ts
new file mode 100644
index 000000000..0311be138
--- /dev/null
+++ b/integration/repl/src/users/dto/create-user.dto.ts
@@ -0,0 +1 @@
+export class CreateUserDto {}
diff --git a/integration/repl/src/users/dto/update-user.dto.ts b/integration/repl/src/users/dto/update-user.dto.ts
new file mode 100644
index 000000000..dfd37fb1e
--- /dev/null
+++ b/integration/repl/src/users/dto/update-user.dto.ts
@@ -0,0 +1,4 @@
+import { PartialType } from '@nestjs/mapped-types';
+import { CreateUserDto } from './create-user.dto';
+
+export class UpdateUserDto extends PartialType(CreateUserDto) {}
diff --git a/integration/repl/src/users/entities/user.entity.ts b/integration/repl/src/users/entities/user.entity.ts
new file mode 100644
index 000000000..4f82c1457
--- /dev/null
+++ b/integration/repl/src/users/entities/user.entity.ts
@@ -0,0 +1 @@
+export class User {}
diff --git a/integration/repl/src/users/users.controller.ts b/integration/repl/src/users/users.controller.ts
new file mode 100644
index 000000000..d5db3a65e
--- /dev/null
+++ b/integration/repl/src/users/users.controller.ts
@@ -0,0 +1,42 @@
+import {
+  Controller,
+  Get,
+  Post,
+  Body,
+  Patch,
+  Param,
+  Delete,
+} from '@nestjs/common';
+import { UsersService } from './users.service';
+import { CreateUserDto } from './dto/create-user.dto';
+import { UpdateUserDto } from './dto/update-user.dto';
+
+@Controller('users')
+export class UsersController {
+  constructor(private readonly usersService: UsersService) {}
+
+  @Post()
+  create(@Body() createUserDto: CreateUserDto) {
+    return this.usersService.create(createUserDto);
+  }
+
+  @Get()
+  findAll() {
+    return this.usersService.findAll();
+  }
+
+  @Get(':id')
+  findOne(@Param('id') id: string) {
+    return this.usersService.findOne(+id);
+  }
+
+  @Patch(':id')
+  update(@Param('id') id: string, @Body() updateUserDto: UpdateUserDto) {
+    return this.usersService.update(+id, updateUserDto);
+  }
+
+  @Delete(':id')
+  remove(@Param('id') id: string) {
+    return this.usersService.remove(+id);
+  }
+}
diff --git a/integration/repl/src/users/users.module.ts b/integration/repl/src/users/users.module.ts
new file mode 100644
index 000000000..86d73a3f0
--- /dev/null
+++ b/integration/repl/src/users/users.module.ts
@@ -0,0 +1,16 @@
+import { Module } from '@nestjs/common';
+import { UsersController } from './users.controller';
+import { UsersRepository } from './users.repository';
+import { UsersService } from './users.service';
+
+@Module({
+  controllers: [UsersController],
+  providers: [
+    UsersService,
+    {
+      provide: UsersRepository.name,
+      useValue: new UsersRepository(),
+    },
+  ],
+})
+export class UsersModule {}
diff --git a/integration/repl/src/users/users.repository.ts b/integration/repl/src/users/users.repository.ts
new file mode 100644
index 000000000..4a6166586
--- /dev/null
+++ b/integration/repl/src/users/users.repository.ts
@@ -0,0 +1,8 @@
+import { Injectable } from '@nestjs/common';
+
+@Injectable()
+export class UsersRepository {
+  async find() {
+    return [{ id: 1, email: 'test@nestjs.com' }];
+  }
+}
diff --git a/integration/repl/src/users/users.service.ts b/integration/repl/src/users/users.service.ts
new file mode 100644
index 000000000..ab3191152
--- /dev/null
+++ b/integration/repl/src/users/users.service.ts
@@ -0,0 +1,32 @@
+import { Inject, Injectable } from '@nestjs/common';
+import { CreateUserDto } from './dto/create-user.dto';
+import { UpdateUserDto } from './dto/update-user.dto';
+import { UsersRepository } from './users.repository';
+
+@Injectable()
+export class UsersService {
+  constructor(
+    @Inject('UsersRepository')
+    private readonly usersRepository: UsersRepository,
+  ) {}
+
+  create(createUserDto: CreateUserDto) {
+    return 'This action adds a new user';
+  }
+
+  findAll() {
+    return `This action returns all users`;
+  }
+
+  findOne(id: number) {
+    return `This action returns a #${id} user`;
+  }
+
+  update(id: number, updateUserDto: UpdateUserDto) {
+    return `This action updates a #${id} user`;
+  }
+
+  remove(id: number) {
+    return `This action removes a #${id} user`;
+  }
+}
diff --git a/integration/repl/tsconfig.json b/integration/repl/tsconfig.json
new file mode 100644
index 000000000..4a0f01e0e
--- /dev/null
+++ b/integration/repl/tsconfig.json
@@ -0,0 +1,41 @@
+{
+  "compilerOptions": {
+    "module": "commonjs",
+    "declaration": false,
+    "noImplicitAny": false,
+    "removeComments": true,
+    "noLib": false,
+    "emitDecoratorMetadata": true,
+    "experimentalDecorators": true,
+    "target": "ES2021",
+    "sourceMap": true,
+    "allowJs": true,
+    "strictNullChecks": true,
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
+  },
+  "include": [
+    "src/**/*",
+    "e2e/**/*"
+  ],
+  "exclude": [
+    "node_modules",
+  ]
+}
\ No newline at end of file
diff --git a/integration/scopes/e2e/circular-request-scope.spec.ts b/integration/scopes/e2e/circular-request-scope.spec.ts
index 4676ccf58..72489dc60 100644
--- a/integration/scopes/e2e/circular-request-scope.spec.ts
+++ b/integration/scopes/e2e/circular-request-scope.spec.ts
@@ -48,19 +48,19 @@ describe('Circular request scope', () => {
       await new Promise(resolve => performHttpCall(resolve));
     });
 
-    it(`should create controller for each request`, async () => {
+    it(`should create controller for each request`, () => {
       expect(HelloController.COUNTER).to.be.eql(3);
     });
 
-    it(`should create service for each request`, async () => {
+    it(`should create service for each request`, () => {
       expect(UsersService.COUNTER).to.be.eql(3);
     });
 
-    it(`should create service for each request`, async () => {
+    it(`should create service for each request`, () => {
       expect(HelloService.COUNTER).to.be.eql(3);
     });
 
-    it(`should create provider for each inquirer`, async () => {
+    it(`should create provider for each inquirer`, () => {
       expect(Meta.COUNTER).to.be.eql(3);
     });
   });
diff --git a/integration/scopes/e2e/circular-transient-scope.spec.ts b/integration/scopes/e2e/circular-transient-scope.spec.ts
index 16310a8f3..acfaecbe4 100644
--- a/integration/scopes/e2e/circular-transient-scope.spec.ts
+++ b/integration/scopes/e2e/circular-transient-scope.spec.ts
@@ -39,7 +39,7 @@ describe('Circular transient scope', () => {
       const performHttpCall = end =>
         request(server)
           .get('/hello')
-          .end((err, res) => {
+          .end(err => {
             if (err) return end(err);
             end();
           });
diff --git a/integration/scopes/e2e/durable-providers.spec.ts b/integration/scopes/e2e/durable-providers.spec.ts
new file mode 100644
index 000000000..39573b4e1
--- /dev/null
+++ b/integration/scopes/e2e/durable-providers.spec.ts
@@ -0,0 +1,133 @@
+import { INestApplication } from '@nestjs/common';
+import { ContextIdFactory } from '@nestjs/core';
+import { Test } from '@nestjs/testing';
+import { expect } from 'chai';
+import * as request from 'supertest';
+import { DurableContextIdStrategy } from '../src/durable/durable-context-id.strategy';
+import { DurableModule } from '../src/durable/durable.module';
+
+describe('Durable providers', () => {
+  let server: any;
+  let app: INestApplication;
+
+  before(async () => {
+    const moduleRef = await Test.createTestingModule({
+      imports: [DurableModule],
+    }).compile();
+
+    app = moduleRef.createNestApplication();
+    server = app.getHttpServer();
+    await app.init();
+
+    ContextIdFactory.apply(new DurableContextIdStrategy());
+  });
+
+  describe('when service is durable', () => {
+    const performHttpCall = (
+      tenantId: number,
+      end: (err?: any) => void,
+      endpoint = '/durable',
+      opts: {
+        forceError: boolean;
+      } = { forceError: false },
+    ) =>
+      request(server)
+        .get(endpoint)
+        .set({ ['x-tenant-id']: String(tenantId) })
+        .set({ ['x-force-error']: opts.forceError ? 'true' : 'false' })
+        .end((err, res) => {
+          if (err) return end(err);
+          end(res);
+        });
+
+    it(`should share durable providers per tenant`, async () => {
+      let result: request.Response;
+      result = await new Promise<request.Response>(resolve =>
+        performHttpCall(1, resolve),
+      );
+      expect(result.text).equal('Hello world! Counter: 1');
+
+      result = await new Promise<request.Response>(resolve =>
+        performHttpCall(1, resolve),
+      );
+      expect(result.text).equal('Hello world! Counter: 2');
+
+      result = await new Promise<request.Response>(resolve =>
+        performHttpCall(1, resolve),
+      );
+      expect(result.text).equal('Hello world! Counter: 3');
+    });
+
+    it(`should create per-tenant DI sub-tree`, async () => {
+      let result: request.Response;
+      result = await new Promise<request.Response>(resolve =>
+        performHttpCall(4, resolve),
+      );
+      expect(result.text).equal('Hello world! Counter: 1');
+
+      result = await new Promise<request.Response>(resolve =>
+        performHttpCall(5, resolve),
+      );
+      expect(result.text).equal('Hello world! Counter: 1');
+
+      result = await new Promise<request.Response>(resolve =>
+        performHttpCall(6, resolve),
+      );
+      expect(result.text).equal('Hello world! Counter: 1');
+    });
+
+    it(`should register a custom per-tenant request payload`, async () => {
+      let result: request.Response;
+      result = await new Promise<request.Response>(resolve =>
+        performHttpCall(1, resolve, '/durable/echo'),
+      );
+      expect(result.body).deep.equal({ tenantId: '1' });
+
+      result = await new Promise<request.Response>(resolve =>
+        performHttpCall(3, resolve, '/durable/echo'),
+      );
+      expect(result.body).deep.equal({ tenantId: '3' });
+    });
+
+    it(`should return the same tenantId both from durable request scoped service and non-durable request scoped service`, async () => {
+      let result: request.Response;
+      result = await new Promise<request.Response>(resolve =>
+        performHttpCall(1, resolve, '/durable/request-context'),
+      );
+      expect(result.body).deep.equal({
+        durableService: '1',
+        nonDurableService: '1',
+      });
+
+      result = await new Promise<request.Response>(resolve =>
+        performHttpCall(2, resolve, '/durable/request-context'),
+      );
+      expect(result.body).deep.equal({
+        durableService: '2',
+        nonDurableService: '2',
+      });
+    });
+
+    it(`should not cache durable providers that throw errors`, async () => {
+      let result: request.Response;
+
+      result = await new Promise<request.Response>(resolve =>
+        performHttpCall(10, resolve, '/durable/echo', { forceError: true }),
+      );
+
+      expect(result.statusCode).equal(412);
+
+      // The second request should be successful
+      result = await new Promise<request.Response>(resolve =>
+        performHttpCall(10, resolve, '/durable/echo'),
+      );
+
+      expect(result.body).deep.equal({ tenantId: '10' });
+    });
+  });
+
+  after(async () => {
+    ContextIdFactory['strategy'] = undefined;
+    await app.close();
+  });
+});
diff --git a/integration/scopes/e2e/msvc-request-scope.spec.ts b/integration/scopes/e2e/msvc-request-scope.spec.ts
index b6273c33d..6ce1a6a5a 100644
--- a/integration/scopes/e2e/msvc-request-scope.spec.ts
+++ b/integration/scopes/e2e/msvc-request-scope.spec.ts
@@ -1,5 +1,5 @@
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import { expect } from 'chai';
 import * as request from 'supertest';
@@ -31,7 +31,7 @@ describe('Request scope (microservices)', () => {
     }).compile();
 
     app = module.createNestApplication();
-    app.connectMicroservice({ transport: Transport.TCP });
+    app.connectMicroservice<MicroserviceOptions>({ transport: Transport.TCP });
 
     server = app.getHttpServer();
     await app.init();
@@ -47,29 +47,29 @@ describe('Request scope (microservices)', () => {
             if (err) return end(err);
             end();
           });
-      await new Promise(resolve => performHttpCall(resolve));
-      await new Promise(resolve => performHttpCall(resolve));
-      await new Promise(resolve => performHttpCall(resolve));
+      await new Promise<any>(resolve => performHttpCall(resolve));
+      await new Promise<any>(resolve => performHttpCall(resolve));
+      await new Promise<any>(resolve => performHttpCall(resolve));
     });
 
-    it(`should create controller for each request`, async () => {
+    it(`should create controller for each request`, () => {
       expect(HelloController.COUNTER).to.be.eql(3);
     });
 
-    it(`should create service for each request`, async () => {
+    it(`should create service for each request`, () => {
       expect(UsersService.COUNTER).to.be.eql(3);
     });
 
-    it(`should share static provider across requests`, async () => {
+    it(`should share static provider across requests`, () => {
       expect(Meta.COUNTER).to.be.eql(1);
     });
 
-    it(`should create request scoped interceptor for each request`, async () => {
+    it(`should create request scoped interceptor for each request`, () => {
       expect(Interceptor.COUNTER).to.be.eql(3);
       expect(Interceptor.REQUEST_SCOPED_DATA).to.deep.equal([1, 1, 1]);
     });
 
-    it(`should create request scoped guard for each request`, async () => {
+    it(`should create request scoped guard for each request`, () => {
       expect(Guard.COUNTER).to.be.eql(3);
       expect(Guard.REQUEST_SCOPED_DATA).to.deep.equal([1, 1, 1]);
     });
diff --git a/integration/scopes/e2e/request-modules-scope.spec.ts b/integration/scopes/e2e/request-modules-scope.spec.ts
index d7aea5896..0a7d54ada 100644
--- a/integration/scopes/e2e/request-modules-scope.spec.ts
+++ b/integration/scopes/e2e/request-modules-scope.spec.ts
@@ -24,16 +24,16 @@ describe('Request scope (modules propagation)', () => {
       const performHttpCall = end =>
         request(server)
           .get('/hello')
-          .end((err, res) => {
+          .end(err => {
             if (err) return end(err);
             end();
           });
-      await new Promise(resolve => performHttpCall(resolve));
-      await new Promise(resolve => performHttpCall(resolve));
-      await new Promise(resolve => performHttpCall(resolve));
+      await new Promise<any>(resolve => performHttpCall(resolve));
+      await new Promise<any>(resolve => performHttpCall(resolve));
+      await new Promise<any>(resolve => performHttpCall(resolve));
     });
 
-    it(`should not fail`, async () => {
+    it(`should not fail`, () => {
       expect(RequestChainService.COUNTER).to.be.eql(3);
     });
   });
diff --git a/integration/scopes/e2e/request-scope.spec.ts b/integration/scopes/e2e/request-scope.spec.ts
index df58a5f07..7b146972b 100644
--- a/integration/scopes/e2e/request-scope.spec.ts
+++ b/integration/scopes/e2e/request-scope.spec.ts
@@ -40,38 +40,38 @@ describe('Request scope', () => {
       const performHttpCall = end =>
         request(server)
           .get('/hello')
-          .end((err, res) => {
+          .end(err => {
             if (err) return end(err);
             end();
           });
-      await new Promise(resolve => performHttpCall(resolve));
-      await new Promise(resolve => performHttpCall(resolve));
-      await new Promise(resolve => performHttpCall(resolve));
+      await new Promise<any>(resolve => performHttpCall(resolve));
+      await new Promise<any>(resolve => performHttpCall(resolve));
+      await new Promise<any>(resolve => performHttpCall(resolve));
     });
 
-    it(`should create controller for each request`, async () => {
+    it(`should create controller for each request`, () => {
       expect(HelloController.COUNTER).to.be.eql(3);
     });
 
-    it(`should create service for each request`, async () => {
+    it(`should create service for each request`, () => {
       expect(UsersService.COUNTER).to.be.eql(3);
     });
 
-    it(`should share static provider across requests`, async () => {
+    it(`should share static provider across requests`, () => {
       expect(Meta.COUNTER).to.be.eql(1);
     });
 
-    it(`should create request scoped pipe for each request`, async () => {
+    it(`should create request scoped pipe for each request`, () => {
       expect(UserByIdPipe.COUNTER).to.be.eql(3);
       expect(UserByIdPipe.REQUEST_SCOPED_DATA).to.deep.equal([1, 1, 1]);
     });
 
-    it(`should create request scoped interceptor for each request`, async () => {
+    it(`should create request scoped interceptor for each request`, () => {
       expect(Interceptor.COUNTER).to.be.eql(3);
       expect(Interceptor.REQUEST_SCOPED_DATA).to.deep.equal([1, 1, 1]);
     });
 
-    it(`should create request scoped guard for each request`, async () => {
+    it(`should create request scoped guard for each request`, () => {
       expect(Guard.COUNTER).to.be.eql(3);
       expect(Guard.REQUEST_SCOPED_DATA).to.deep.equal([1, 1, 1]);
     });
diff --git a/integration/scopes/e2e/transient-scope.spec.ts b/integration/scopes/e2e/transient-scope.spec.ts
index 609574e90..8658f932d 100644
--- a/integration/scopes/e2e/transient-scope.spec.ts
+++ b/integration/scopes/e2e/transient-scope.spec.ts
@@ -41,36 +41,36 @@ describe('Transient scope', () => {
       const performHttpCall = end =>
         request(server)
           .get('/hello')
-          .end((err, res) => {
+          .end(err => {
             if (err) return end(err);
             end();
           });
-      await new Promise(resolve => performHttpCall(resolve));
-      await new Promise(resolve => performHttpCall(resolve));
-      await new Promise(resolve => performHttpCall(resolve));
+      await new Promise<any>(resolve => performHttpCall(resolve));
+      await new Promise<any>(resolve => performHttpCall(resolve));
+      await new Promise<any>(resolve => performHttpCall(resolve));
     });
 
-    it(`should create controller for each request`, async () => {
+    it(`should create controller for each request`, () => {
       expect(HelloController.COUNTER).to.be.eql(3);
     });
 
-    it(`should create service for each request`, async () => {
+    it(`should create service for each request`, () => {
       expect(UsersService.COUNTER).to.be.eql(3);
     });
 
-    it(`should create provider for each inquirer`, async () => {
+    it(`should create provider for each inquirer`, () => {
       expect(Meta.COUNTER).to.be.eql(7);
     });
 
-    it(`should create transient pipe for each controller (3 requests, 1 static)`, async () => {
+    it(`should create transient pipe for each controller (3 requests, 1 static)`, () => {
       expect(UserByIdPipe.COUNTER).to.be.eql(4);
     });
 
-    it(`should create transient interceptor for each controller (3 requests, 1 static)`, async () => {
+    it(`should create transient interceptor for each controller (3 requests, 1 static)`, () => {
       expect(Interceptor.COUNTER).to.be.eql(4);
     });
 
-    it(`should create transient guard for each controller (3 requests, 1 static)`, async () => {
+    it(`should create transient guard for each controller (3 requests, 1 static)`, () => {
       expect(Guard.COUNTER).to.be.eql(4);
     });
   });
diff --git a/integration/scopes/src/durable/durable-context-id.strategy.ts b/integration/scopes/src/durable/durable-context-id.strategy.ts
new file mode 100644
index 000000000..495fe90ea
--- /dev/null
+++ b/integration/scopes/src/durable/durable-context-id.strategy.ts
@@ -0,0 +1,35 @@
+import { ContextId, ContextIdStrategy, HostComponentInfo } from '@nestjs/core';
+import { Request } from 'express';
+
+export type TenantContext = {
+  tenantId: string;
+  forceError?: boolean;
+};
+
+const tenants = new Map<string, ContextId>();
+
+export class DurableContextIdStrategy implements ContextIdStrategy {
+  attach(contextId: ContextId, request: Request) {
+    const tenantId = request.headers['x-tenant-id'] as string;
+    const forceError = request.headers['x-force-error'] === 'true';
+
+    let tenantSubTreeId: ContextId;
+
+    if (tenants.has(tenantId)) {
+      tenantSubTreeId = tenants.get(tenantId)!;
+    } else {
+      tenantSubTreeId = { id: +tenantId } as ContextId;
+      tenants.set(tenantId, tenantSubTreeId);
+    }
+
+    const payload: TenantContext = { tenantId };
+    if (forceError) {
+      payload.forceError = true;
+    }
+    return {
+      resolve: (info: HostComponentInfo) =>
+        info.isTreeDurable ? tenantSubTreeId : contextId,
+      payload,
+    };
+  }
+}
diff --git a/integration/scopes/src/durable/durable.controller.ts b/integration/scopes/src/durable/durable.controller.ts
new file mode 100644
index 000000000..fbc33c12c
--- /dev/null
+++ b/integration/scopes/src/durable/durable.controller.ts
@@ -0,0 +1,31 @@
+import { Controller, Get } from '@nestjs/common';
+import { DurableService } from './durable.service';
+import { NonDurableService } from './non-durable.service';
+
+@Controller('durable')
+export class DurableController {
+  constructor(
+    private readonly durableService: DurableService,
+    private readonly nonDurableService: NonDurableService,
+  ) {}
+
+  @Get()
+  greeting(): string {
+    return this.durableService.greeting();
+  }
+
+  @Get('echo')
+  echo() {
+    return {
+      tenantId: this.durableService.getTenantId(),
+    };
+  }
+
+  @Get('request-context')
+  getRequestContext() {
+    return {
+      durableService: this.durableService.getTenantId(),
+      nonDurableService: this.nonDurableService.getTenantId(),
+    };
+  }
+}
diff --git a/integration/scopes/src/durable/durable.guard.ts b/integration/scopes/src/durable/durable.guard.ts
new file mode 100644
index 000000000..8868af809
--- /dev/null
+++ b/integration/scopes/src/durable/durable.guard.ts
@@ -0,0 +1,21 @@
+import {
+  CanActivate,
+  ExecutionContext,
+  Injectable,
+  Scope,
+} from '@nestjs/common';
+import { DurableService } from './durable.service';
+
+@Injectable({ scope: Scope.REQUEST, durable: true })
+export class DurableGuard implements CanActivate {
+  public instanceCounter = 0;
+  constructor(private readonly durableService: DurableService) {}
+
+  public async canActivate(context: ExecutionContext): Promise<boolean> {
+    if (typeof this.durableService === 'undefined') {
+      throw new Error('Durable service is undefined');
+    }
+    this.instanceCounter++;
+    return true;
+  }
+}
diff --git a/integration/scopes/src/durable/durable.module.ts b/integration/scopes/src/durable/durable.module.ts
new file mode 100644
index 000000000..dc91cded6
--- /dev/null
+++ b/integration/scopes/src/durable/durable.module.ts
@@ -0,0 +1,19 @@
+import { Module } from '@nestjs/common';
+import { APP_GUARD } from '@nestjs/core';
+import { DurableController } from './durable.controller';
+import { DurableGuard } from './durable.guard';
+import { DurableService } from './durable.service';
+import { NonDurableService } from './non-durable.service';
+
+@Module({
+  controllers: [DurableController],
+  providers: [
+    DurableService,
+    NonDurableService,
+    {
+      provide: APP_GUARD,
+      useClass: DurableGuard,
+    },
+  ],
+})
+export class DurableModule {}
diff --git a/integration/scopes/src/durable/durable.service.ts b/integration/scopes/src/durable/durable.service.ts
new file mode 100644
index 000000000..15fcafe96
--- /dev/null
+++ b/integration/scopes/src/durable/durable.service.ts
@@ -0,0 +1,28 @@
+import {
+  Inject,
+  Injectable,
+  PreconditionFailedException,
+  Scope,
+} from '@nestjs/common';
+import { REQUEST } from '@nestjs/core';
+import { TenantContext } from './durable-context-id.strategy';
+
+@Injectable({ scope: Scope.REQUEST, durable: true })
+export class DurableService {
+  public instanceCounter = 0;
+
+  constructor(@Inject(REQUEST) private readonly requestPayload: TenantContext) {
+    if (requestPayload.forceError) {
+      throw new PreconditionFailedException('Forced error');
+    }
+  }
+
+  greeting() {
+    ++this.instanceCounter;
+    return `Hello world! Counter: ${this.instanceCounter}`;
+  }
+
+  getTenantId() {
+    return this.requestPayload.tenantId;
+  }
+}
diff --git a/integration/scopes/src/durable/non-durable.service.ts b/integration/scopes/src/durable/non-durable.service.ts
new file mode 100644
index 000000000..add062941
--- /dev/null
+++ b/integration/scopes/src/durable/non-durable.service.ts
@@ -0,0 +1,14 @@
+import { Inject, Injectable, Scope } from '@nestjs/common';
+import { REQUEST } from '@nestjs/core';
+import { TenantContext } from './durable-context-id.strategy';
+
+@Injectable()
+export class NonDurableService {
+  constructor(
+    @Inject(REQUEST) private readonly requestPayload: TenantContext,
+  ) {}
+
+  getTenantId() {
+    return this.requestPayload.tenantId;
+  }
+}
diff --git a/integration/scopes/src/hello/guards/request-scoped.guard.ts b/integration/scopes/src/hello/guards/request-scoped.guard.ts
index 6124eb7d5..591f78adb 100644
--- a/integration/scopes/src/hello/guards/request-scoped.guard.ts
+++ b/integration/scopes/src/hello/guards/request-scoped.guard.ts
@@ -10,7 +10,7 @@ import { Observable } from 'rxjs';
 @Injectable({ scope: Scope.REQUEST })
 export class Guard implements CanActivate {
   static COUNTER = 0;
-  static REQUEST_SCOPED_DATA = [];
+  static REQUEST_SCOPED_DATA = [] as number[];
 
   constructor(@Inject('REQUEST_ID') private readonly requestId: number) {
     Guard.COUNTER++;
diff --git a/integration/scopes/src/hello/interceptors/logging.interceptor.ts b/integration/scopes/src/hello/interceptors/logging.interceptor.ts
index 30fa62d31..2721a9ddc 100644
--- a/integration/scopes/src/hello/interceptors/logging.interceptor.ts
+++ b/integration/scopes/src/hello/interceptors/logging.interceptor.ts
@@ -11,7 +11,7 @@ import { Observable } from 'rxjs';
 @Injectable({ scope: Scope.REQUEST })
 export class Interceptor implements NestInterceptor {
   static COUNTER = 0;
-  static REQUEST_SCOPED_DATA = [];
+  static REQUEST_SCOPED_DATA = [] as number[];
 
   constructor(@Inject('REQUEST_ID') private readonly requestId: number) {
     Interceptor.COUNTER++;
diff --git a/integration/scopes/src/hello/users/user-by-id.pipe.ts b/integration/scopes/src/hello/users/user-by-id.pipe.ts
index 385eedf2d..73d859bfa 100644
--- a/integration/scopes/src/hello/users/user-by-id.pipe.ts
+++ b/integration/scopes/src/hello/users/user-by-id.pipe.ts
@@ -9,7 +9,7 @@ import { UsersService } from './users.service';
 @Injectable()
 export class UserByIdPipe implements PipeTransform<string> {
   static COUNTER = 0;
-  static REQUEST_SCOPED_DATA = [];
+  static REQUEST_SCOPED_DATA = [] as number[];
 
   constructor(
     @Inject('REQUEST_ID') private readonly requestId: number,
diff --git a/integration/scopes/src/main.ts b/integration/scopes/src/main.ts
index afb93ba07..cdecc1bb6 100644
--- a/integration/scopes/src/main.ts
+++ b/integration/scopes/src/main.ts
@@ -5,4 +5,4 @@ async function bootstrap() {
   const app = await NestFactory.create(ApplicationModule);
   await app.listen(3000);
 }
-bootstrap();
+void bootstrap();
diff --git a/integration/scopes/src/msvc/guards/request-scoped.guard.ts b/integration/scopes/src/msvc/guards/request-scoped.guard.ts
index 6124eb7d5..591f78adb 100644
--- a/integration/scopes/src/msvc/guards/request-scoped.guard.ts
+++ b/integration/scopes/src/msvc/guards/request-scoped.guard.ts
@@ -10,7 +10,7 @@ import { Observable } from 'rxjs';
 @Injectable({ scope: Scope.REQUEST })
 export class Guard implements CanActivate {
   static COUNTER = 0;
-  static REQUEST_SCOPED_DATA = [];
+  static REQUEST_SCOPED_DATA = [] as number[];
 
   constructor(@Inject('REQUEST_ID') private readonly requestId: number) {
     Guard.COUNTER++;
diff --git a/integration/scopes/src/msvc/interceptors/logging.interceptor.ts b/integration/scopes/src/msvc/interceptors/logging.interceptor.ts
index 30fa62d31..2721a9ddc 100644
--- a/integration/scopes/src/msvc/interceptors/logging.interceptor.ts
+++ b/integration/scopes/src/msvc/interceptors/logging.interceptor.ts
@@ -11,7 +11,7 @@ import { Observable } from 'rxjs';
 @Injectable({ scope: Scope.REQUEST })
 export class Interceptor implements NestInterceptor {
   static COUNTER = 0;
-  static REQUEST_SCOPED_DATA = [];
+  static REQUEST_SCOPED_DATA = [] as number[];
 
   constructor(@Inject('REQUEST_ID') private readonly requestId: number) {
     Interceptor.COUNTER++;
diff --git a/integration/scopes/src/transient/users/user-by-id.pipe.ts b/integration/scopes/src/transient/users/user-by-id.pipe.ts
index 7d06ff9d5..3e8274038 100644
--- a/integration/scopes/src/transient/users/user-by-id.pipe.ts
+++ b/integration/scopes/src/transient/users/user-by-id.pipe.ts
@@ -1,9 +1,4 @@
-import {
-  ArgumentMetadata,
-  Injectable,
-  PipeTransform,
-  Scope,
-} from '@nestjs/common';
+import { Injectable, PipeTransform, Scope } from '@nestjs/common';
 
 @Injectable({ scope: Scope.TRANSIENT })
 export class UserByIdPipe implements PipeTransform<string> {
@@ -12,7 +7,7 @@ export class UserByIdPipe implements PipeTransform<string> {
     UserByIdPipe.COUNTER++;
   }
 
-  transform(value: string, metadata: ArgumentMetadata) {
+  transform(value: string) {
     return value;
   }
 }
diff --git a/integration/scopes/tsconfig.json b/integration/scopes/tsconfig.json
index c6354c564..4a0f01e0e 100644
--- a/integration/scopes/tsconfig.json
+++ b/integration/scopes/tsconfig.json
@@ -7,10 +7,29 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "strictNullChecks": true,
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
diff --git a/integration/send-files/e2e/express.spec.ts b/integration/send-files/e2e/express.spec.ts
index 425ce6695..c0b8e5661 100644
--- a/integration/send-files/e2e/express.spec.ts
+++ b/integration/send-files/e2e/express.spec.ts
@@ -8,8 +8,14 @@ import { readFileSync } from 'fs';
 import { join } from 'path';
 import * as request from 'supertest';
 import { AppModule } from '../src/app.module';
+import {
+  getHttpBaseOptions,
+  sendCanceledHttpRequest,
+  sendHttpRequest,
+} from './utils';
 
-const readmeString = readFileSync(join(process.cwd(), 'Readme.md')).toString();
+const readme = readFileSync(join(process.cwd(), 'Readme.md'));
+const readmeString = readme.toString();
 
 describe('Express FileSend', () => {
   let app: NestExpressApplication;
@@ -53,14 +59,29 @@ describe('Express FileSend', () => {
         expect(res.body.toString()).to.be.eq(readmeString);
       });
   });
-  it('should return a file with correct content type and disposition', async () => {
+  it('should return a file with correct headers', async () => {
     return request(app.getHttpServer())
       .get('/file/with/headers')
       .expect(200)
       .expect('Content-Type', 'text/markdown')
       .expect('Content-Disposition', 'attachment; filename="Readme.md"')
+      .expect('Content-Length', readme.byteLength.toString())
       .expect(res => {
         expect(res.text).to.be.eq(readmeString);
       });
   });
+  it('should return an error if the file does not exist', async () => {
+    return request(app.getHttpServer()).get('/file/not/exist').expect(400);
+  });
+  // TODO: temporarily turned off (flaky test)
+  it.skip(
+    'should allow for the client to end the response and be able to make another',
+    async () => {
+      await app.listen(0);
+      const url = await getHttpBaseOptions(app);
+      await sendCanceledHttpRequest(new URL('/file/slow', url));
+      const res = await sendHttpRequest(new URL('/file/stream', url));
+      expect(res.statusCode).to.be.eq(200);
+    },
+  ).timeout(5000);
 });
diff --git a/integration/send-files/e2e/fastify.spec.ts b/integration/send-files/e2e/fastify.spec.ts
index 9e7ee5b5e..cec873634 100644
--- a/integration/send-files/e2e/fastify.spec.ts
+++ b/integration/send-files/e2e/fastify.spec.ts
@@ -8,7 +8,8 @@ import { readFileSync } from 'fs';
 import { join } from 'path';
 import { AppModule } from '../src/app.module';
 
-const readmeString = readFileSync(join(process.cwd(), 'Readme.md')).toString();
+const readme = readFileSync(join(process.cwd(), 'Readme.md'));
+const readmeString = readme.toString();
 
 describe('Fastify FileSend', () => {
   let app: NestFastifyApplication;
@@ -67,4 +68,17 @@ describe('Fastify FileSend', () => {
         expect(payload.toString()).to.be.eq(readmeString);
       });
   });
+  it('should return a file with correct headers', async () => {
+    return app
+      .inject({ url: '/file/with/headers', method: 'get' })
+      .then(({ statusCode, headers, payload }) => {
+        expect(statusCode).to.equal(200);
+        expect(headers['content-type']).to.equal('text/markdown');
+        expect(headers['content-disposition']).to.equal(
+          'attachment; filename="Readme.md"',
+        );
+        expect(headers['content-length']).to.equal(`${readme.byteLength}`);
+        expect(payload).to.equal(readmeString);
+      });
+  });
 });
diff --git a/integration/send-files/e2e/utils.ts b/integration/send-files/e2e/utils.ts
new file mode 100644
index 000000000..ac29622b5
--- /dev/null
+++ b/integration/send-files/e2e/utils.ts
@@ -0,0 +1,47 @@
+import { INestApplication } from '@nestjs/common';
+import { IncomingMessage, request } from 'http';
+import { URL } from 'url';
+
+export const getHttpBaseOptions = async (
+  app: INestApplication,
+): Promise<URL> => {
+  const url = await app.getUrl();
+  return new URL(url);
+};
+
+export const sendCanceledHttpRequest = async (url: URL) => {
+  return new Promise(resolve => {
+    const req = request(url, res => {
+      // close the request once we get the first response of data
+      res.on('data', () => {
+        req.destroy();
+      });
+      // response is closed, move on to next request and verify it's doable
+      res.on('close', resolve);
+    });
+    // fire the request
+    req.end();
+  });
+};
+
+export const sendHttpRequest = async (url: URL) => {
+  return new Promise<IncomingMessage>((resolve, reject) => {
+    const req = request(url, res => {
+      // this makes sure that the response actually starts and is read. We could verify this value against the same
+      // that is in an earlier test, but all we care about in _this_ test is that the status code is 200
+      res.on('data', () => {
+        // no op
+      });
+      // fail the test if something goes wrong
+      res.on('error', err => {
+        reject(err);
+      });
+      // pass the response back so we can verify values in the test
+      res.on('end', () => {
+        resolve(res);
+      });
+    });
+    // fire the request
+    req.end();
+  });
+};
diff --git a/integration/send-files/src/app.controller.ts b/integration/send-files/src/app.controller.ts
index 606e2d598..69fa20ec0 100644
--- a/integration/send-files/src/app.controller.ts
+++ b/integration/send-files/src/app.controller.ts
@@ -31,4 +31,14 @@ export class AppController {
   getFileWithHeaders(): StreamableFile {
     return this.appService.getFileWithHeaders();
   }
+
+  @Get('file/not/exist')
+  getNonExistantFile(): StreamableFile {
+    return this.appService.getFileThatDoesNotExist();
+  }
+
+  @Get('/file/slow')
+  getSlowFile(): StreamableFile {
+    return this.appService.getSlowStream();
+  }
 }
diff --git a/integration/send-files/src/app.service.ts b/integration/send-files/src/app.service.ts
index a83e6a4f6..e5f920c48 100644
--- a/integration/send-files/src/app.service.ts
+++ b/integration/send-files/src/app.service.ts
@@ -1,11 +1,16 @@
 import { Injectable, StreamableFile } from '@nestjs/common';
+import { randomBytes } from 'crypto';
 import { createReadStream, readFileSync } from 'fs';
 import { join } from 'path';
 import { Observable, of } from 'rxjs';
+import { Readable } from 'stream';
 import { NonFile } from './non-file';
 
 @Injectable()
 export class AppService {
+  // `randomBytes` has a max value of 2^31 -1. That's all this is
+  private readonly MAX_BITES = Math.pow(2, 31) - 1;
+
   getReadStream(): StreamableFile {
     return new StreamableFile(
       createReadStream(join(process.cwd(), 'Readme.md')),
@@ -25,12 +30,26 @@ export class AppService {
   }
 
   getFileWithHeaders(): StreamableFile {
+    const file = readFileSync(join(process.cwd(), 'Readme.md'));
     return new StreamableFile(
       createReadStream(join(process.cwd(), 'Readme.md')),
       {
         type: 'text/markdown',
         disposition: 'attachment; filename="Readme.md"',
+        length: file.byteLength,
       },
     );
   }
+
+  getFileThatDoesNotExist(): StreamableFile {
+    return new StreamableFile(createReadStream('does-not-exist.txt'));
+  }
+
+  getSlowStream(): StreamableFile {
+    const stream = new Readable();
+    stream.push(Buffer.from(randomBytes(this.MAX_BITES)));
+    // necessary for a `new Readable()`. Doesn't do anything
+    stream._read = () => {};
+    return new StreamableFile(stream);
+  }
 }
diff --git a/integration/send-files/tsconfig.json b/integration/send-files/tsconfig.json
index c6354c564..4a0f01e0e 100644
--- a/integration/send-files/tsconfig.json
+++ b/integration/send-files/tsconfig.json
@@ -7,10 +7,29 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "strictNullChecks": true,
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
diff --git a/integration/testing-module-override/circular-dependency/a.module.ts b/integration/testing-module-override/circular-dependency/a.module.ts
new file mode 100644
index 000000000..6540ded32
--- /dev/null
+++ b/integration/testing-module-override/circular-dependency/a.module.ts
@@ -0,0 +1,12 @@
+import { Injectable, Module, forwardRef } from '@nestjs/common';
+import { BModule } from './b.module';
+
+@Injectable()
+export class AProvider {}
+
+@Module({
+  imports: [forwardRef(() => BModule)],
+  providers: [AProvider],
+  exports: [AProvider],
+})
+export class AModule {}
diff --git a/integration/testing-module-override/circular-dependency/b.module.ts b/integration/testing-module-override/circular-dependency/b.module.ts
new file mode 100644
index 000000000..2f4d5baf6
--- /dev/null
+++ b/integration/testing-module-override/circular-dependency/b.module.ts
@@ -0,0 +1,12 @@
+import { Injectable, Module, forwardRef } from '@nestjs/common';
+import { AModule } from './a.module';
+
+@Injectable()
+export class BProvider {}
+
+@Module({
+  imports: [forwardRef(() => AModule)],
+  providers: [BProvider],
+  exports: [BProvider],
+})
+export class BModule {}
diff --git a/integration/testing-module-override/e2e/modules-override.spec.ts b/integration/testing-module-override/e2e/modules-override.spec.ts
new file mode 100644
index 000000000..234767e18
--- /dev/null
+++ b/integration/testing-module-override/e2e/modules-override.spec.ts
@@ -0,0 +1,308 @@
+import {
+  Controller,
+  DynamicModule,
+  forwardRef,
+  Global,
+  Injectable,
+  Module,
+} from '@nestjs/common';
+import { LazyModuleLoader } from '@nestjs/core';
+import { Test, TestingModule } from '@nestjs/testing';
+import { expect } from 'chai';
+import { AModule, AProvider } from '../circular-dependency/a.module';
+import { BModule, BProvider } from '../circular-dependency/b.module';
+
+describe('Modules overriding', () => {
+  describe('Top-level module', () => {
+    @Controller()
+    class ControllerOverwritten {}
+
+    @Module({
+      controllers: [ControllerOverwritten],
+    })
+    class ModuleToBeOverwritten {}
+
+    @Controller()
+    class ControllerOverride {}
+
+    @Module({
+      controllers: [ControllerOverride],
+    })
+    class ModuleOverride {}
+
+    let testingModule: TestingModule;
+
+    beforeEach(async () => {
+      testingModule = await Test.createTestingModule({
+        imports: [ModuleToBeOverwritten],
+      })
+        .overrideModule(ModuleToBeOverwritten)
+        .useModule(ModuleOverride)
+        .compile();
+    });
+
+    it('should override top-level modules using testing module builder', () => {
+      expect(() =>
+        testingModule.get<ControllerOverwritten>(ControllerOverwritten),
+      ).to.throw();
+      expect(
+        testingModule.get<ControllerOverride>(ControllerOverride),
+      ).to.be.an.instanceof(ControllerOverride);
+    });
+  });
+
+  describe('Dynamic module', () => {
+    @Controller()
+    class ControllerOverwritten {}
+
+    @Module({})
+    class DynamicModuleToBeOverwritten {}
+
+    const dynamicModuleOverwritten: DynamicModule = {
+      module: DynamicModuleToBeOverwritten,
+      controllers: [ControllerOverwritten],
+    };
+
+    @Controller()
+    class ControllerOverride {}
+
+    @Module({})
+    class DynamicModuleOverride {}
+
+    const dynamicModuleOverride: DynamicModule = {
+      module: DynamicModuleOverride,
+      controllers: [ControllerOverride],
+    };
+
+    let testingModule: TestingModule;
+
+    beforeEach(async () => {
+      testingModule = await Test.createTestingModule({
+        imports: [dynamicModuleOverwritten],
+      })
+        .overrideModule(dynamicModuleOverwritten)
+        .useModule(dynamicModuleOverride)
+        .compile();
+    });
+
+    it('should override dynamic modules using testing module builder', () => {
+      expect(() =>
+        testingModule.get<ControllerOverwritten>(ControllerOverwritten),
+      ).to.throw();
+      expect(
+        testingModule.get<ControllerOverride>(ControllerOverride),
+      ).to.be.an.instanceof(ControllerOverride);
+    });
+  });
+
+  describe('Circular dependency module', () => {
+    let testingModule: TestingModule;
+
+    @Injectable()
+    class CProvider {}
+
+    @Module({
+      providers: [CProvider],
+    })
+    class CModule {}
+
+    @Injectable()
+    class BProviderOverride {}
+
+    @Module({
+      imports: [forwardRef(() => AModule), forwardRef(() => CModule)],
+      providers: [BProviderOverride],
+      exports: [BProviderOverride],
+    })
+    class BModuleOverride {}
+
+    beforeEach(async () => {
+      testingModule = await Test.createTestingModule({
+        imports: [AModule],
+      })
+        .overrideModule(BModule)
+        .useModule(BModuleOverride)
+        .compile();
+    });
+
+    it('should override top-level modules using testing module builder', () => {
+      expect(testingModule.get<AProvider>(AProvider)).to.be.an.instanceof(
+        AProvider,
+      );
+      expect(() => testingModule.get<BProvider>(BProvider)).to.throw();
+      expect(testingModule.get<CProvider>(CProvider)).to.be.an.instanceof(
+        CProvider,
+      );
+      expect(
+        testingModule.get<BProviderOverride>(BProviderOverride),
+      ).to.be.an.instanceof(BProviderOverride);
+    });
+  });
+
+  describe('Nested module', () => {
+    let testingModule: TestingModule;
+
+    @Controller()
+    class OverwrittenNestedModuleController {}
+
+    @Module({
+      controllers: [OverwrittenNestedModuleController],
+    })
+    class OverwrittenNestedModule {}
+
+    @Controller()
+    class OverrideNestedModuleController {}
+
+    @Module({
+      controllers: [OverrideNestedModuleController],
+    })
+    class OverrideNestedModule {}
+
+    @Module({
+      imports: [OverwrittenNestedModule],
+    })
+    class AppModule {}
+
+    beforeEach(async () => {
+      testingModule = await Test.createTestingModule({
+        imports: [AppModule],
+      })
+        .overrideModule(OverwrittenNestedModule)
+        .useModule(OverrideNestedModule)
+        .compile();
+    });
+
+    it('should override nested modules using testing module builder', () => {
+      expect(
+        testingModule.get<OverrideNestedModuleController>(
+          OverrideNestedModuleController,
+        ),
+      ).to.be.an.instanceof(OverrideNestedModuleController);
+      expect(() =>
+        testingModule.get<OverwrittenNestedModuleController>(
+          OverwrittenNestedModuleController,
+        ),
+      ).to.throw();
+    });
+  });
+
+  describe('Lazy-loaded module', () => {
+    let testingModule: TestingModule;
+
+    @Injectable()
+    class OverwrittenLazyProvider {
+      value() {
+        return 'overwritten lazy';
+      }
+    }
+
+    @Module({
+      providers: [
+        {
+          provide: 'LAZY_PROVIDER',
+          useClass: OverwrittenLazyProvider,
+        },
+      ],
+    })
+    class OverwrittenLazyModule {}
+
+    @Injectable()
+    class OverrideLazyProvider {
+      value() {
+        return 'override lazy';
+      }
+    }
+
+    @Module({
+      providers: [
+        {
+          provide: 'LAZY_PROVIDER',
+          useClass: OverrideLazyProvider,
+        },
+      ],
+    })
+    class OverrideLazyModule {}
+
+    @Injectable()
+    class AppService {
+      constructor(private lazyModuleLoader: LazyModuleLoader) {}
+
+      async value() {
+        const moduleRef = await this.lazyModuleLoader.load(
+          () => OverwrittenLazyModule,
+        );
+        return moduleRef.get('LAZY_PROVIDER').value();
+      }
+    }
+
+    @Module({
+      imports: [],
+      providers: [AppService],
+    })
+    class AppModule {}
+
+    beforeEach(async () => {
+      testingModule = await Test.createTestingModule({
+        imports: [AppModule],
+      })
+        .overrideModule(OverwrittenLazyModule)
+        .useModule(OverrideLazyModule)
+        .compile();
+    });
+
+    it('should override lazy loaded modules using testing module builder', async () => {
+      const result = await testingModule.get<AppService>(AppService).value();
+      expect(result).to.be.equal('override lazy');
+    });
+  });
+
+  describe('Global module', () => {
+    let testingModule: TestingModule;
+
+    @Injectable()
+    class OverwrittenProvider {
+      value() {
+        return 'overwritten lazy';
+      }
+    }
+
+    @Global()
+    @Module({
+      providers: [OverwrittenProvider],
+      exports: [OverwrittenProvider],
+    })
+    class OverwrittenModule {}
+
+    @Injectable()
+    class OverrideProvider {
+      value() {
+        return 'override lazy';
+      }
+    }
+
+    @Global()
+    @Module({
+      providers: [OverrideProvider],
+      exports: [OverrideProvider],
+    })
+    class OverrideModule {}
+
+    beforeEach(async () => {
+      testingModule = await Test.createTestingModule({
+        imports: [OverwrittenModule],
+      })
+        .overrideModule(OverwrittenModule)
+        .useModule(OverrideModule)
+        .compile();
+    });
+
+    it('should override global modules using testing module builder', () => {
+      expect(
+        testingModule.get<OverrideProvider>(OverrideProvider),
+      ).to.be.an.instanceof(OverrideProvider);
+      expect(() =>
+        testingModule.get<OverwrittenProvider>(OverwrittenProvider),
+      ).to.throw();
+    });
+  });
+});
diff --git a/integration/testing-module-override/tsconfig.json b/integration/testing-module-override/tsconfig.json
new file mode 100644
index 000000000..c43c3d1b1
--- /dev/null
+++ b/integration/testing-module-override/tsconfig.json
@@ -0,0 +1,35 @@
+{
+  "compilerOptions": {
+    "module": "commonjs",
+    "declaration": true,
+    "removeComments": true,
+    "emitDecoratorMetadata": true,
+    "experimentalDecorators": true,
+    "allowSyntheticDefaultImports": true,
+    "target": "ES2021",
+    "sourceMap": true,
+    "outDir": "./dist",
+    "baseUrl": "./",
+    "incremental": true,
+    "skipLibCheck": true,
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
+  },
+  "include": ["src/**/*", "e2e/**/*"],
+}
diff --git a/integration/typeorm/e2e/typeorm.spec.ts b/integration/typeorm/e2e/typeorm.spec.ts
index 60ab18303..958713903 100644
--- a/integration/typeorm/e2e/typeorm.spec.ts
+++ b/integration/typeorm/e2e/typeorm.spec.ts
@@ -1,7 +1,7 @@
 import { INestApplication } from '@nestjs/common';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 describe('TypeOrm', () => {
   let server;
@@ -9,7 +9,7 @@ describe('TypeOrm', () => {
 
   beforeEach(async () => {
     const module = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
 
     app = module.createNestApplication();
diff --git a/integration/typeorm/ormconfig.json b/integration/typeorm/ormconfig.json
index 3dd8d04d3..713564b8a 100644
--- a/integration/typeorm/ormconfig.json
+++ b/integration/typeorm/ormconfig.json
@@ -1,6 +1,6 @@
 {
   "type": "mysql",
-  "host": "localhost",
+  "host": "127.0.0.1",
   "port": 3306,
   "username": "root",
   "password": "root",
diff --git a/integration/typeorm/src/app.module.ts b/integration/typeorm/src/app.module.ts
index 32fbf84fd..6ba462128 100644
--- a/integration/typeorm/src/app.module.ts
+++ b/integration/typeorm/src/app.module.ts
@@ -7,7 +7,7 @@ import { PhotoModule } from './photo/photo.module';
   imports: [
     TypeOrmModule.forRoot({
       type: 'mysql',
-      host: 'localhost',
+      host: '127.0.0.1',
       port: 3306,
       username: 'root',
       password: 'root',
@@ -21,4 +21,4 @@ import { PhotoModule } from './photo/photo.module';
     PhotoModule,
   ],
 })
-export class ApplicationModule {}
+export class AppModule {}
diff --git a/integration/typeorm/src/async-class-options.module.ts b/integration/typeorm/src/async-class-options.module.ts
index ab55ce999..2eda3fb3b 100644
--- a/integration/typeorm/src/async-class-options.module.ts
+++ b/integration/typeorm/src/async-class-options.module.ts
@@ -11,7 +11,7 @@ class ConfigService implements TypeOrmOptionsFactory {
   createTypeOrmOptions(): TypeOrmModuleOptions {
     return {
       type: 'mysql',
-      host: 'localhost',
+      host: '127.0.0.1',
       port: 3306,
       username: 'root',
       password: 'root',
diff --git a/integration/typeorm/src/async-existing-options.module.ts b/integration/typeorm/src/async-existing-options.module.ts
index 132f4bd1c..af4da814f 100644
--- a/integration/typeorm/src/async-existing-options.module.ts
+++ b/integration/typeorm/src/async-existing-options.module.ts
@@ -11,7 +11,7 @@ class ConfigService implements TypeOrmOptionsFactory {
   createTypeOrmOptions(): TypeOrmModuleOptions {
     return {
       type: 'mysql',
-      host: 'localhost',
+      host: '127.0.0.1',
       port: 3306,
       username: 'root',
       password: 'root',
diff --git a/integration/typeorm/src/async-options.module.ts b/integration/typeorm/src/async-options.module.ts
index 047a9ab5e..1733edf04 100644
--- a/integration/typeorm/src/async-options.module.ts
+++ b/integration/typeorm/src/async-options.module.ts
@@ -8,7 +8,7 @@ import { PhotoModule } from './photo/photo.module';
     TypeOrmModule.forRootAsync({
       useFactory: () => ({
         type: 'mysql',
-        host: 'localhost',
+        host: '127.0.0.1',
         port: 3306,
         username: 'root',
         password: 'root',
diff --git a/integration/typeorm/src/database.module.ts b/integration/typeorm/src/database.module.ts
index e3d6763c4..3628233bb 100644
--- a/integration/typeorm/src/database.module.ts
+++ b/integration/typeorm/src/database.module.ts
@@ -11,7 +11,7 @@ export class DatabaseModule {
       imports: [
         TypeOrmModule.forRoot({
           type: 'mysql',
-          host: 'localhost',
+          host: '127.0.0.1',
           port: 3306,
           username: 'root',
           password: 'root',
diff --git a/integration/typeorm/src/main.ts b/integration/typeorm/src/main.ts
index 5847364d6..c7f4a1871 100644
--- a/integration/typeorm/src/main.ts
+++ b/integration/typeorm/src/main.ts
@@ -1,8 +1,8 @@
 import { NestFactory } from '@nestjs/core';
-import { ApplicationModule } from './app.module';
+import { AppModule } from './app.module';
 
 async function bootstrap() {
-  const app = await NestFactory.create(ApplicationModule);
+  const app = await NestFactory.create(AppModule);
   await app.listen(3001);
 }
-bootstrap();
+void bootstrap();
diff --git a/integration/typeorm/tsconfig.json b/integration/typeorm/tsconfig.json
index ea15af490..4a0f01e0e 100644
--- a/integration/typeorm/tsconfig.json
+++ b/integration/typeorm/tsconfig.json
@@ -7,16 +7,35 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "strictNullChecks": true,
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
-    "src/**/*"
+    "src/**/*",
+    "e2e/**/*"
   ],
   "exclude": [
     "node_modules",
-    "**/*.spec.ts"
   ]
 }
\ No newline at end of file
diff --git a/integration/versioning/e2e/custom-versioning-fastify.spec.ts b/integration/versioning/e2e/custom-versioning-fastify.spec.ts
new file mode 100644
index 000000000..a428136a6
--- /dev/null
+++ b/integration/versioning/e2e/custom-versioning-fastify.spec.ts
@@ -0,0 +1,967 @@
+import { INestApplication, VersioningType } from '@nestjs/common';
+import {
+  FastifyAdapter,
+  NestFastifyApplication,
+} from '@nestjs/platform-fastify';
+import { Test } from '@nestjs/testing';
+import { FastifyRequest } from 'fastify';
+import * as request from 'supertest';
+import { AppModule } from '../src/app.module';
+
+describe('Custom Versioning (fastify)', () => {
+  const extractor = (request: FastifyRequest): string | string[] => {
+    const versions = [request.headers['accept'] ?? '']
+      .flatMap(v => v.split(','))
+      .map(header => header.match(/v(\d+\.?\d*)\+json$/))
+      .filter(match => match && match.length)
+      .map(matchArray => matchArray![1])
+      .sort()
+      .reverse();
+
+    return versions;
+  };
+  let app: INestApplication;
+
+  // ======================================================================== //
+  describe('without global default version', () => {
+    before(async () => {
+      const moduleRef = await Test.createTestingModule({
+        imports: [AppModule],
+      }).compile();
+
+      app = moduleRef.createNestApplication<NestFastifyApplication>(
+        new FastifyAdapter(),
+      );
+      app.enableVersioning({
+        type: VersioningType.CUSTOM,
+        extractor,
+      });
+      await app.init();
+      await app.getHttpAdapter().getInstance().ready();
+    });
+
+    describe('GET /', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Hello World V1!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Hello World V2!');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Hello World V2!');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Hello World V2!');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/').expect(404);
+      });
+    });
+
+    describe('GET /:param', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Parameter V1!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Parameter V2!');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Parameter V2!');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Parameter V2!');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: '',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/').expect(404);
+      });
+    });
+
+    describe('GET /multiple', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/multiple').expect(404);
+      });
+    });
+
+    describe('GET /neutral', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .expect(200)
+          .expect('Neutral');
+      });
+    });
+
+    describe('GET /override', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Override Version 1');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Version 2');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Version 2');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Override Version 2');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/override').expect(404);
+      });
+    });
+
+    describe('GET /override-partial', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 1');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 2');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 2');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 2');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .expect(404);
+      });
+    });
+
+    describe('GET /foo/bar', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+    });
+
+    after(async () => {
+      await app.close();
+    });
+  });
+
+  // ======================================================================== //
+  describe('with the global default version: "1"', () => {
+    before(async () => {
+      const moduleRef = await Test.createTestingModule({
+        imports: [AppModule],
+      }).compile();
+
+      app = moduleRef.createNestApplication<NestFastifyApplication>(
+        new FastifyAdapter(),
+      );
+      app.enableVersioning({
+        type: VersioningType.CUSTOM,
+        extractor,
+        defaultVersion: '1',
+      });
+      await app.init();
+      await app.getHttpAdapter().getInstance().ready();
+    });
+
+    describe('GET /', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Hello World V1!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Hello World V2!');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Hello World V2!');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Hello World V2!');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/').expect(404);
+      });
+    });
+
+    describe('GET /:param', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Parameter V1!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Parameter V2!');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Parameter V2!');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Parameter V2!');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: '',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/').expect(404);
+      });
+    });
+
+    describe('GET /multiple', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/multiple').expect(404);
+      });
+    });
+
+    describe('GET /neutral', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .expect(200)
+          .expect('Neutral');
+      });
+    });
+
+    describe('GET /override', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Override Version 1');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Version 2');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Version 2');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Override Version 2');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/override').expect(404);
+      });
+    });
+
+    describe('GET /override-partial', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 1');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 2');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 2');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 2');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .expect(404);
+      });
+    });
+
+    describe('GET /foo/bar', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(404);
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect('Hello FooBar!');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/foo/bar').expect(404);
+      });
+    });
+
+    after(async () => {
+      await app.close();
+    });
+  });
+});
diff --git a/integration/versioning/e2e/custom-versioning.spec.ts b/integration/versioning/e2e/custom-versioning.spec.ts
new file mode 100644
index 000000000..73e56c41c
--- /dev/null
+++ b/integration/versioning/e2e/custom-versioning.spec.ts
@@ -0,0 +1,712 @@
+import { INestApplication, VersioningType } from '@nestjs/common';
+import { Test } from '@nestjs/testing';
+import { Request } from 'express';
+import * as request from 'supertest';
+import { AppModule } from '../src/app.module';
+
+describe('Custom Versioning', () => {
+  const extractor = (request: Request): string | string[] => {
+    const versions = request
+      .header('Accept')
+      ?.split(',')
+      .map(header => header.match(/v(\d+\.?\d*)\+json$/))
+      .filter(match => match && match.length)
+      .map(matchArray => matchArray![1])
+      .sort()
+      .reverse();
+
+    return versions!;
+  };
+  let app: INestApplication;
+
+  // ======================================================================== //
+  describe('without global default version', () => {
+    before(async () => {
+      const moduleRef = await Test.createTestingModule({
+        imports: [AppModule],
+      }).compile();
+
+      app = moduleRef.createNestApplication();
+      app.enableVersioning({
+        type: VersioningType.CUSTOM,
+        extractor,
+      });
+      await app.init();
+    });
+
+    describe('GET /', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Hello World V1!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Hello World V2!');
+      });
+
+      // There's a known limitation of the express-adapter, where
+      // it cannot handle selection of the highest matched version properly.
+      //
+      // it('V2, if two versions are requested, select the highest version', () => {
+      //   return request(app.getHttpServer())
+      //     .get('/')
+      //     .set({
+      //       Accept: 'application/foo.v1+json, application/foo.v2+json',
+      //     })
+      //     .expect(200)
+      //     .expect('Hello World V2!');
+      // });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/').expect(404);
+      });
+    });
+
+    describe('GET /:param', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Parameter V1!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Parameter V2!');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: '',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/').expect(404);
+      });
+    });
+
+    describe('GET /multiple', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V2, if an unsupported version is specified, select the lower supported version', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/multiple').expect(404);
+      });
+    });
+
+    describe('GET /neutral', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .expect(200)
+          .expect('Neutral');
+      });
+    });
+
+    describe('GET /override', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Override Version 1');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Version 2');
+      });
+
+      // There's a known limitation of the express-adapter, where
+      // it cannot handle selection of the highest matched version properly.
+      //
+      // it('V2, if two versions are requested, select the highest version', () => {
+      //   return request(app.getHttpServer())
+      //     .get('/override')
+      //     .set({
+      //       Accept: 'application/foo.v1+json, application/foo.v2+json',
+      //     })
+      //     .expect(200)
+      //     .expect('Override Version 2');
+      // });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/override').expect(404);
+      });
+    });
+
+    describe('GET /override-partial', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 1');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 2');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .expect(404);
+      });
+    });
+
+    describe('GET /foo/bar', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+    });
+
+    after(async () => {
+      await app.close();
+    });
+  });
+
+  // ======================================================================== //
+  describe('with the global default version: "1"', () => {
+    before(async () => {
+      const moduleRef = await Test.createTestingModule({
+        imports: [AppModule],
+      }).compile();
+
+      app = moduleRef.createNestApplication();
+      app.enableVersioning({
+        type: VersioningType.CUSTOM,
+        extractor,
+        defaultVersion: '1',
+      });
+      await app.init();
+    });
+
+    describe('GET /', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Hello World V1!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Hello World V2!');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/').expect(404);
+      });
+    });
+
+    describe('GET /:param', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Parameter V1!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Parameter V2!');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: '',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/').expect(404);
+      });
+    });
+
+    describe('GET /multiple', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/multiple').expect(404);
+      });
+    });
+
+    describe('GET /neutral', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .expect(200)
+          .expect('Neutral');
+      });
+    });
+
+    describe('GET /override', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Override Version 1');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Version 2');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/override').expect(404);
+      });
+    });
+
+    describe('GET /override-partial', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 1');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 2');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .expect(404);
+      });
+    });
+
+    describe('GET /foo/bar', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(404);
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/foo/bar').expect(404);
+      });
+    });
+
+    after(async () => {
+      await app.close();
+    });
+  });
+});
diff --git a/integration/versioning/e2e/default-versioning.spec.ts b/integration/versioning/e2e/default-versioning.spec.ts
new file mode 100644
index 000000000..d1b62e0ec
--- /dev/null
+++ b/integration/versioning/e2e/default-versioning.spec.ts
@@ -0,0 +1,98 @@
+import { INestApplication } from '@nestjs/common';
+import {
+  FastifyAdapter,
+  NestFastifyApplication,
+} from '@nestjs/platform-fastify';
+import { Test } from '@nestjs/testing';
+import * as request from 'supertest';
+import { AppModule } from '../src/app.module';
+
+/**
+ * `.enableVersioning()` uses `VersioningType.URI` type by default
+ * Regression test for #13496
+ * @see [Versioning](https://docs.nestjs.com/techniques/versioning)
+ */
+describe('Default Versioning behavior', () => {
+  // ======================================================================== //
+  describe('Express', () => {
+    let app: INestApplication;
+    before(async () => {
+      const moduleRef = await Test.createTestingModule({
+        imports: [AppModule],
+      }).compile();
+
+      app = moduleRef.createNestApplication();
+      app.enableVersioning();
+      await app.init();
+    });
+
+    describe('GET /', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/v1')
+          .expect(200)
+          .expect('Hello World V1!');
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer()).get('/').expect(404);
+      });
+    });
+
+    describe('GET /neutral', () => {
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .expect(200)
+          .expect('Neutral');
+      });
+    });
+
+    after(async () => {
+      await app.close();
+    });
+  });
+
+  // ======================================================================== //
+  describe('Fastify', () => {
+    let app: INestApplication;
+    before(async () => {
+      const moduleRef = await Test.createTestingModule({
+        imports: [AppModule],
+      }).compile();
+
+      app = moduleRef.createNestApplication<NestFastifyApplication>(
+        new FastifyAdapter(),
+      );
+      app.enableVersioning();
+      await app.init();
+      await app.getHttpAdapter().getInstance().ready();
+    });
+
+    describe('GET /', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/v1')
+          .expect(200)
+          .expect('Hello World V1!');
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer()).get('/').expect(404);
+      });
+    });
+
+    describe('GET /neutral', () => {
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .expect(200)
+          .expect('Neutral');
+      });
+    });
+
+    after(async () => {
+      await app.close();
+    });
+  });
+});
diff --git a/integration/versioning/e2e/uri-versioning.spec.ts b/integration/versioning/e2e/uri-versioning.spec.ts
index c39b95ed0..1bb178eaf 100644
--- a/integration/versioning/e2e/uri-versioning.spec.ts
+++ b/integration/versioning/e2e/uri-versioning.spec.ts
@@ -352,4 +352,133 @@ describe('URI Versioning', () => {
       await app.close();
     });
   });
+
+  // ======================================================================== //
+  describe('with the global prefix enabled and an excluded route', () => {
+    before(async () => {
+      const moduleRef = await Test.createTestingModule({
+        imports: [AppModule],
+      }).compile();
+
+      app = moduleRef.createNestApplication();
+      app.setGlobalPrefix('api', { exclude: ['/foo/bar'] });
+      app.enableVersioning({
+        type: VersioningType.URI,
+        defaultVersion: '1',
+      });
+      await app.init();
+    });
+
+    describe('GET /', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/api/v1')
+          .expect(200)
+          .expect('Hello World V1!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/api/v2')
+          .expect(200)
+          .expect('Hello World V2!');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer()).get('/api/v3').expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer()).get('/api').expect(404);
+      });
+    });
+
+    describe('GET /foo/bar (excluded from the API prefix)', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/v1/foo/bar')
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer()).get('/v2/foo/bar').expect(404);
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer()).get('/v3/foo/bar').expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer()).get('/foo/bar').expect(404);
+      });
+    });
+
+    after(async () => {
+      await app.close();
+    });
+  });
+
+  // ======================================================================== //
+  describe('with middleware applied', () => {
+    before(async () => {
+      const moduleRef = await Test.createTestingModule({
+        imports: [AppModule],
+      }).compile();
+
+      app = moduleRef.createNestApplication();
+      app.enableVersioning({
+        type: VersioningType.URI,
+        defaultVersion: '1',
+      });
+      await app.init();
+    });
+
+    describe('GET /middleware', () => {
+      it('should return "Hello from middleware function!"', () => {
+        return request(app.getHttpServer())
+          .get('/v1/middleware')
+          .expect(200)
+          .expect('Hello from middleware function!');
+      });
+    });
+
+    describe('GET /middleware/override', () => {
+      it('should return "Hello from middleware function!"', () => {
+        return request(app.getHttpServer())
+          .get('/v2/middleware/override')
+          .expect(200)
+          .expect('Hello from middleware function!');
+      });
+    });
+
+    describe('GET /middleware/multiple', () => {
+      it('should return "Hello from middleware function!" (v1)', () => {
+        return request(app.getHttpServer())
+          .get('/v1/middleware/multiple')
+          .expect(200)
+          .expect('Hello from middleware function!');
+      });
+
+      it('should return "Hello from middleware function!" (v2)', () => {
+        return request(app.getHttpServer())
+          .get('/v2/middleware/multiple')
+          .expect(200)
+          .expect('Hello from middleware function!');
+      });
+    });
+
+    describe('GET /middleware/neutral', () => {
+      it('should return "Hello from middleware function!"', () => {
+        return request(app.getHttpServer())
+          .get('/middleware/neutral')
+          .expect(200)
+          .expect('Hello from middleware function!');
+      });
+    });
+
+    after(async () => {
+      await app.close();
+    });
+  });
 });
diff --git a/integration/versioning/src/app.module.ts b/integration/versioning/src/app.module.ts
index aac4b7a58..d1483685a 100644
--- a/integration/versioning/src/app.module.ts
+++ b/integration/versioning/src/app.module.ts
@@ -1,11 +1,14 @@
-import { Module } from '@nestjs/common';
+import { MiddlewareConsumer, Module } from '@nestjs/common';
 import { AppV1Controller } from './app-v1.controller';
 import { AppV2Controller } from './app-v2.controller';
+import { MiddlewareController } from './middleware.controller';
+import { MultipleMiddlewareVersionController } from './multiple-middleware.controller';
 import { MultipleVersionController } from './multiple.controller';
-import { NoVersioningController } from './no-versioning.controller';
+import { VersionNeutralMiddlewareController } from './neutral-middleware.controller';
 import { VersionNeutralController } from './neutral.controller';
-import { OverrideController } from './override.controller';
+import { NoVersioningController } from './no-versioning.controller';
 import { OverridePartialController } from './override-partial.controller';
+import { OverrideController } from './override.controller';
 
 @Module({
   imports: [],
@@ -17,6 +20,19 @@ import { OverridePartialController } from './override-partial.controller';
     VersionNeutralController,
     OverrideController,
     OverridePartialController,
+    MiddlewareController,
+    MultipleMiddlewareVersionController,
+    VersionNeutralMiddlewareController,
   ],
 })
-export class AppModule {}
+export class AppModule {
+  configure(consumer: MiddlewareConsumer) {
+    consumer
+      .apply((req, res) => res.end('Hello from middleware function!'))
+      .forRoutes(
+        MiddlewareController,
+        MultipleMiddlewareVersionController,
+        VersionNeutralMiddlewareController,
+      );
+  }
+}
diff --git a/integration/versioning/src/main.ts b/integration/versioning/src/main.ts
index 01a86abd3..1d316cac8 100644
--- a/integration/versioning/src/main.ts
+++ b/integration/versioning/src/main.ts
@@ -12,4 +12,4 @@ async function bootstrap() {
   await app.listen(3000);
   console.log(`Application is running on: ${await app.getUrl()}`);
 }
-bootstrap();
+void bootstrap();
diff --git a/integration/versioning/src/middleware.controller.ts b/integration/versioning/src/middleware.controller.ts
new file mode 100644
index 000000000..9d0ece0d9
--- /dev/null
+++ b/integration/versioning/src/middleware.controller.ts
@@ -0,0 +1,18 @@
+import { Controller, Get, Version } from '@nestjs/common';
+
+@Controller({
+  path: 'middleware',
+  version: '1',
+})
+export class MiddlewareController {
+  @Get('/')
+  hello() {
+    return 'Hello from "MiddlewareController"!';
+  }
+
+  @Version('2')
+  @Get('/override')
+  hellov2() {
+    return 'Hello from "MiddlewareController"!';
+  }
+}
diff --git a/integration/versioning/src/multiple-middleware.controller.ts b/integration/versioning/src/multiple-middleware.controller.ts
new file mode 100644
index 000000000..f3611568d
--- /dev/null
+++ b/integration/versioning/src/multiple-middleware.controller.ts
@@ -0,0 +1,12 @@
+import { Controller, Get } from '@nestjs/common';
+
+@Controller({
+  version: ['1', '2'],
+  path: 'middleware',
+})
+export class MultipleMiddlewareVersionController {
+  @Get('/multiple')
+  multiple() {
+    return 'Multiple Versions 1 or 2';
+  }
+}
diff --git a/integration/versioning/src/neutral-middleware.controller.ts b/integration/versioning/src/neutral-middleware.controller.ts
new file mode 100644
index 000000000..1daa67746
--- /dev/null
+++ b/integration/versioning/src/neutral-middleware.controller.ts
@@ -0,0 +1,12 @@
+import { Controller, Get, VERSION_NEUTRAL } from '@nestjs/common';
+
+@Controller({
+  path: 'middleware',
+  version: VERSION_NEUTRAL,
+})
+export class VersionNeutralMiddlewareController {
+  @Get('/neutral')
+  neutral() {
+    return 'Neutral';
+  }
+}
diff --git a/integration/versioning/tsconfig.json b/integration/versioning/tsconfig.json
index c6354c564..4a0f01e0e 100644
--- a/integration/versioning/tsconfig.json
+++ b/integration/versioning/tsconfig.json
@@ -7,10 +7,29 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "strictNullChecks": true,
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
diff --git a/integration/websockets/e2e/error-gateway.spec.ts b/integration/websockets/e2e/error-gateway.spec.ts
index 95a7d4d28..5e5335a00 100644
--- a/integration/websockets/e2e/error-gateway.spec.ts
+++ b/integration/websockets/e2e/error-gateway.spec.ts
@@ -11,20 +11,27 @@ describe('ErrorGateway', () => {
     const testingModule = await Test.createTestingModule({
       providers: [ErrorGateway],
     }).compile();
-    app = await testingModule.createNestApplication();
+
+    app = testingModule.createNestApplication();
     await app.listen(3000);
   });
 
   it(`should handle error`, async () => {
     const ws = io('http://localhost:8080');
-    ws.emit('push', {
-      test: 'test',
-    });
+    const pattern = 'push';
+    const data = { test: 'test' };
+
+    ws.emit(pattern, data);
+
     await new Promise<void>(resolve =>
-      ws.on('exception', data => {
-        expect(data).to.be.eql({
+      ws.on('exception', error => {
+        expect(error).to.be.eql({
           status: 'error',
           message: 'test',
+          cause: {
+            pattern,
+            data,
+          },
         });
         resolve();
       }),
diff --git a/integration/websockets/e2e/gateway.spec.ts b/integration/websockets/e2e/gateway.spec.ts
index cde31c4b2..8b46a22ac 100644
--- a/integration/websockets/e2e/gateway.spec.ts
+++ b/integration/websockets/e2e/gateway.spec.ts
@@ -1,7 +1,9 @@
 import { INestApplication } from '@nestjs/common';
 import { Test } from '@nestjs/testing';
 import { expect } from 'chai';
+import * as EventSource from 'eventsource';
 import { io } from 'socket.io-client';
+import { AppController as LongConnectionController } from '../../nest-application/sse/src/app.controller';
 import { ApplicationGateway } from '../src/app.gateway';
 import { NamespaceGateway } from '../src/namespace.gateway';
 import { ServerGateway } from '../src/server.gateway';
@@ -15,7 +17,7 @@ async function createNestApp(...gateways): Promise<INestApplication> {
 }
 
 describe('WebSocketGateway', () => {
-  let ws, app;
+  let ws: ReturnType<typeof io>, app: INestApplication;
 
   it(`should handle message (2nd port)`, async () => {
     app = await createNestApp(ApplicationGateway);
@@ -66,5 +68,110 @@ describe('WebSocketGateway', () => {
     );
   });
 
+  it(`should be able to get the pattern in an interceptor`, async () => {
+    app = await createNestApp(ApplicationGateway);
+    await app.listen(3000);
+
+    ws = io('http://localhost:8080');
+    ws.emit('getClient', {
+      test: 'test',
+    });
+    await new Promise<void>(resolve =>
+      ws.on('popClient', data => {
+        expect(data.path).to.be.eql('getClient');
+        resolve();
+      }),
+    );
+  });
+
+  it(`should be able to get the pattern in a filter (when the error comes from a known handler)`, async () => {
+    app = await createNestApp(ApplicationGateway);
+    await app.listen(3000);
+
+    ws = io('http://localhost:8080');
+    ws.emit('getClientWithError', {
+      test: 'test',
+    });
+    await new Promise<void>(resolve =>
+      ws.on('exception', data => {
+        expect(data.pattern).to.be.eql('getClientWithError');
+        resolve();
+      }),
+    );
+  });
+
+  describe('shared server for WS and Long-Running connections', () => {
+    afterEach(() => {});
+    it('should block application shutdown', function (done) {
+      let eventSource: EventSource;
+
+      void (async () => {
+        this.timeout(30000);
+
+        setTimeout(() => {
+          const instance = testingModule.get(ServerGateway);
+          expect(instance.onApplicationShutdown.called).to.be.false;
+          eventSource.close();
+          done();
+        }, 25000);
+
+        const testingModule = await Test.createTestingModule({
+          providers: [ServerGateway],
+          controllers: [LongConnectionController],
+        }).compile();
+        app = testingModule.createNestApplication();
+
+        await app.listen(3000);
+
+        ws = io(`http://localhost:3000`);
+        eventSource = new EventSource(`http://localhost:3000/sse`);
+
+        await new Promise<void>((resolve, reject) => {
+          ws.on('connect', resolve);
+          ws.on('error', reject);
+        });
+
+        await new Promise((resolve, reject) => {
+          eventSource.onmessage = resolve;
+          eventSource.onerror = reject;
+        });
+
+        await app.close();
+      })();
+    });
+
+    it('should shutdown application immediately when forceCloseConnections is true', async () => {
+      const testingModule = await Test.createTestingModule({
+        providers: [ServerGateway],
+        controllers: [LongConnectionController],
+      }).compile();
+
+      app = testingModule.createNestApplication({
+        forceCloseConnections: true,
+      });
+
+      await app.listen(3000);
+
+      ws = io(`http://localhost:3000`);
+      const eventSource = new EventSource(`http://localhost:3000/sse`);
+
+      await new Promise<void>((resolve, reject) => {
+        ws.on('connect', resolve);
+        ws.on('error', reject);
+      });
+
+      await new Promise((resolve, reject) => {
+        eventSource.onmessage = resolve;
+        eventSource.onerror = reject;
+      });
+
+      await app.close();
+
+      const instance = testingModule.get(ServerGateway);
+      expect(instance.onApplicationShutdown.called).to.be.true;
+      eventSource.close();
+    });
+  });
+
   afterEach(() => app.close());
 });
diff --git a/integration/websockets/e2e/ws-gateway.spec.ts b/integration/websockets/e2e/ws-gateway.spec.ts
index c68883ba3..5a498ea91 100644
--- a/integration/websockets/e2e/ws-gateway.spec.ts
+++ b/integration/websockets/e2e/ws-gateway.spec.ts
@@ -10,17 +10,17 @@ import { ServerGateway } from '../src/server.gateway';
 import { WsPathGateway } from '../src/ws-path.gateway';
 import { WsPathGateway2 } from '../src/ws-path2.gateway';
 
-async function createNestApp(...gateways): Promise<INestApplication> {
+async function createNestApp(...gateways: any[]): Promise<INestApplication> {
   const testingModule = await Test.createTestingModule({
     providers: gateways,
   }).compile();
-  const app = await testingModule.createNestApplication();
+  const app = testingModule.createNestApplication();
   app.useWebSocketAdapter(new WsAdapter(app) as any);
   return app;
 }
 
 describe('WebSocketGateway (WsAdapter)', () => {
-  let ws, ws2, app;
+  let ws: WebSocket, ws2: WebSocket, app: INestApplication;
 
   it(`should handle message (2nd port)`, async () => {
     app = await createNestApp(ApplicationGateway);
@@ -39,7 +39,8 @@ describe('WebSocketGateway (WsAdapter)', () => {
     );
     await new Promise<void>(resolve =>
       ws.on('message', data => {
-        expect(JSON.parse(data).data.test).to.be.eql('test');
+        expect(JSON.parse(data.toString()).data.test).to.be.eql('test');
+        ws.close();
         resolve();
       }),
     );
@@ -62,7 +63,8 @@ describe('WebSocketGateway (WsAdapter)', () => {
     );
     await new Promise<void>(resolve =>
       ws.on('message', data => {
-        expect(JSON.parse(data).data.test).to.be.eql('test');
+        expect(JSON.parse(data.toString()).data.test).to.be.eql('test');
+        ws.close();
         resolve();
       }),
     );
@@ -70,7 +72,7 @@ describe('WebSocketGateway (WsAdapter)', () => {
 
   it(`should handle message on a different path`, async () => {
     app = await createNestApp(WsPathGateway);
-    await app.listenAsync(3000);
+    await app.listen(3000);
     try {
       ws = new WebSocket('ws://localhost:3000/ws-path');
       await new Promise((resolve, reject) => {
@@ -88,7 +90,8 @@ describe('WebSocketGateway (WsAdapter)', () => {
       );
       await new Promise<void>(resolve =>
         ws.on('message', data => {
-          expect(JSON.parse(data).data.test).to.be.eql('test');
+          expect(JSON.parse(data.toString()).data.test).to.be.eql('test');
+          ws.close();
           resolve();
         }),
       );
@@ -101,7 +104,7 @@ describe('WebSocketGateway (WsAdapter)', () => {
     this.retries(10);
 
     app = await createNestApp(ExamplePathGateway, WsPathGateway2);
-    await app.listenAsync(3000);
+    await app.listen(3000);
 
     // open websockets delay
     await new Promise(resolve => setTimeout(resolve, 1000));
@@ -112,7 +115,8 @@ describe('WebSocketGateway (WsAdapter)', () => {
     await new Promise<void>(resolve =>
       ws.on('open', () => {
         ws.on('message', data => {
-          expect(JSON.parse(data).data.test).to.be.eql('test');
+          expect(JSON.parse(data.toString()).data.test).to.be.eql('test');
+          ws.close();
           resolve();
         });
         ws.send(
@@ -128,7 +132,8 @@ describe('WebSocketGateway (WsAdapter)', () => {
 
     await new Promise<void>(resolve => {
       ws2.on('message', data => {
-        expect(JSON.parse(data).data.test).to.be.eql('test');
+        expect(JSON.parse(data.toString()).data.test).to.be.eql('test');
+        ws2.close();
         resolve();
       });
       ws2.send(
@@ -140,7 +145,7 @@ describe('WebSocketGateway (WsAdapter)', () => {
         }),
       );
     });
-  });
+  }).timeout(5000);
 
   it(`should support 2 different gateways running on the same path (but different ports)`, async function () {
     this.retries(10);
@@ -157,7 +162,8 @@ describe('WebSocketGateway (WsAdapter)', () => {
     await new Promise<void>(resolve =>
       ws.on('open', () => {
         ws.on('message', data => {
-          expect(JSON.parse(data).data.test).to.be.eql('test');
+          expect(JSON.parse(data.toString()).data.test).to.be.eql('test');
+          ws.close();
           resolve();
         });
         ws.send(
@@ -173,7 +179,8 @@ describe('WebSocketGateway (WsAdapter)', () => {
 
     await new Promise<void>(resolve => {
       ws2.on('message', data => {
-        expect(JSON.parse(data).data.test).to.be.eql('test');
+        expect(JSON.parse(data.toString()).data.test).to.be.eql('test');
+        ws2.close();
         resolve();
       });
       ws2.send(
@@ -187,5 +194,86 @@ describe('WebSocketGateway (WsAdapter)', () => {
     });
   });
 
-  afterEach(() => app.close());
+  it('should let the execution context have a getPattern() method on getClient()', async () => {
+    app = await createNestApp(ApplicationGateway);
+    await app.listen(3000);
+
+    ws = new WebSocket('ws://localhost:8080');
+    await new Promise(resolve => ws.on('open', resolve));
+
+    ws.send(
+      JSON.stringify({
+        event: 'getClient',
+        data: {
+          test: 'test',
+        },
+      }),
+    );
+    await new Promise<void>(resolve =>
+      ws.on('message', data => {
+        expect(JSON.parse(data.toString()).data.path).to.be.eql('getClient');
+        ws.close();
+        resolve();
+      }),
+    );
+  });
+
+  it('should set messageParser by using setMessageParser method', async () => {
+    const testingModule = await Test.createTestingModule({
+      providers: [ApplicationGateway],
+    }).compile();
+    app = testingModule.createNestApplication();
+
+    const wsAdapter = new WsAdapter(app);
+    wsAdapter.setMessageParser(data => {
+      const [event, payload] = JSON.parse(data.toString());
+      return { event, data: payload };
+    });
+    app.useWebSocketAdapter(wsAdapter);
+    await app.listen(3000);
+
+    ws = new WebSocket('ws://localhost:8080');
+    await new Promise(resolve => ws.on('open', resolve));
+
+    ws.send(JSON.stringify(['push', { test: 'test' }]));
+    await new Promise<void>(resolve =>
+      ws.on('message', data => {
+        expect(JSON.parse(data.toString()).data.test).to.be.eql('test');
+        ws.close();
+        resolve();
+      }),
+    );
+  });
+
+  it('should set messageParser by using constructor options', async () => {
+    const testingModule = await Test.createTestingModule({
+      providers: [ApplicationGateway],
+    }).compile();
+    app = testingModule.createNestApplication();
+
+    const wsAdapter = new WsAdapter(app, {
+      messageParser: data => {
+        const [event, payload] = JSON.parse(data.toString());
+        return { event, data: payload };
+      },
+    });
+    app.useWebSocketAdapter(wsAdapter);
+    await app.listen(3000);
+
+    ws = new WebSocket('ws://localhost:8080');
+    await new Promise(resolve => ws.on('open', resolve));
+
+    ws.send(JSON.stringify(['push', { test: 'test' }]));
+    await new Promise<void>(resolve =>
+      ws.on('message', data => {
+        expect(JSON.parse(data.toString()).data.test).to.be.eql('test');
+        ws.close();
+        resolve();
+      }),
+    );
+  });
+
+  afterEach(async function () {
+    await app.close();
+  });
 });
diff --git a/integration/websockets/src/app.gateway.ts b/integration/websockets/src/app.gateway.ts
index 21b3998b7..30ea2ee22 100644
--- a/integration/websockets/src/app.gateway.ts
+++ b/integration/websockets/src/app.gateway.ts
@@ -1,8 +1,13 @@
+import { UseFilters, UseInterceptors } from '@nestjs/common';
 import {
   MessageBody,
   SubscribeMessage,
   WebSocketGateway,
+  WsException,
 } from '@nestjs/websockets';
+import { RequestInterceptor } from './request.interceptor';
+import { throwError } from 'rxjs';
+import { RequestFilter } from './request.filter';
 
 @WebSocketGateway(8080)
 export class ApplicationGateway {
@@ -13,4 +18,19 @@ export class ApplicationGateway {
       data,
     };
   }
+
+  @UseInterceptors(RequestInterceptor)
+  @SubscribeMessage('getClient')
+  getPathCalled(client, data) {
+    return {
+      event: 'popClient',
+      data: { ...data, path: client.pattern },
+    };
+  }
+
+  @UseFilters(RequestFilter)
+  @SubscribeMessage('getClientWithError')
+  getPathCalledWithError() {
+    return throwError(() => new WsException('This is an error'));
+  }
 }
diff --git a/integration/websockets/src/error.gateway.ts b/integration/websockets/src/error.gateway.ts
index 9daca28da..7bc2c19c1 100644
--- a/integration/websockets/src/error.gateway.ts
+++ b/integration/websockets/src/error.gateway.ts
@@ -8,7 +8,7 @@ import { throwError } from 'rxjs';
 @WebSocketGateway(8080)
 export class ErrorGateway {
   @SubscribeMessage('push')
-  onPush(client, data) {
+  onPush() {
     return throwError(() => new WsException('test'));
   }
 }
diff --git a/integration/websockets/src/request.filter.ts b/integration/websockets/src/request.filter.ts
new file mode 100644
index 000000000..4fe099df3
--- /dev/null
+++ b/integration/websockets/src/request.filter.ts
@@ -0,0 +1,12 @@
+import { ArgumentsHost, Catch, ExceptionFilter } from '@nestjs/common';
+import { WsException } from '@nestjs/websockets';
+
+@Catch(WsException)
+export class RequestFilter implements ExceptionFilter {
+  catch(exception: WsException, host: ArgumentsHost) {
+    const wsCtx = host.switchToWs();
+    const pattern = wsCtx.getPattern();
+    const client = wsCtx.getClient();
+    client.emit('exception', { pattern, message: exception.message });
+  }
+}
diff --git a/integration/websockets/src/request.interceptor.ts b/integration/websockets/src/request.interceptor.ts
new file mode 100644
index 000000000..7dad7e9bf
--- /dev/null
+++ b/integration/websockets/src/request.interceptor.ts
@@ -0,0 +1,11 @@
+import { CallHandler, ExecutionContext, Injectable } from '@nestjs/common';
+
+@Injectable()
+export class RequestInterceptor {
+  intercept(context: ExecutionContext, next: CallHandler) {
+    const client = context.switchToWs().getClient();
+    const pattern = context.switchToWs().getPattern();
+    client.pattern = pattern;
+    return next.handle();
+  }
+}
diff --git a/integration/websockets/src/server.gateway.ts b/integration/websockets/src/server.gateway.ts
index 3add1945a..6955657ca 100644
--- a/integration/websockets/src/server.gateway.ts
+++ b/integration/websockets/src/server.gateway.ts
@@ -1,7 +1,10 @@
+import { OnApplicationShutdown, UseInterceptors } from '@nestjs/common';
 import { SubscribeMessage, WebSocketGateway } from '@nestjs/websockets';
+import * as Sinon from 'sinon';
+import { RequestInterceptor } from './request.interceptor';
 
 @WebSocketGateway()
-export class ServerGateway {
+export class ServerGateway implements OnApplicationShutdown {
   @SubscribeMessage('push')
   onPush(client, data) {
     return {
@@ -9,4 +12,15 @@ export class ServerGateway {
       data,
     };
   }
+
+  @UseInterceptors(RequestInterceptor)
+  @SubscribeMessage('getClient')
+  getPathCalled(client, data) {
+    return {
+      event: 'popClient',
+      data: { ...data, path: client.pattern },
+    };
+  }
+
+  onApplicationShutdown = Sinon.spy();
 }
diff --git a/integration/websockets/tsconfig.json b/integration/websockets/tsconfig.json
index c6354c564..4a0f01e0e 100644
--- a/integration/websockets/tsconfig.json
+++ b/integration/websockets/tsconfig.json
@@ -7,10 +7,29 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "strictNullChecks": true,
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
diff --git a/lerna.json b/lerna.json
index ce2f322ad..eee385437 100644
--- a/lerna.json
+++ b/lerna.json
@@ -3,5 +3,5 @@
   "packages": [
     "packages/*"
   ],
-  "version": "8.2.5"
+  "version": "10.4.11"
 }
diff --git a/package-lock.json b/package-lock.json
index b69988e62..8cdf4dc2e 100644
Binary files a/package-lock.json and b/package-lock.json differ
diff --git a/package.json b/package.json
index 517bb784c..481f24fb4 100644
--- a/package.json
+++ b/package.json
@@ -1,11 +1,11 @@
 {
   "name": "@nestjs/core",
-  "version": "8.2.3",
+  "version": "10.4.5",
   "description": "Modern, fast, powerful node.js web framework",
   "homepage": "https://nestjs.com",
   "repository": {
     "type": "git",
-    "url": "https://github.com/nestjs/nest"
+    "url": "https://github.com/nestjs/nest.git"
   },
   "funding": {
     "type": "opencollective",
@@ -14,161 +14,172 @@
   "license": "MIT",
   "author": "Kamil Mysliwiec",
   "scripts": {
-    "build": "gulp build --dist node_modules/@nestjs",
-    "postbuild": "gulp move",
-    "changelog": "lerna-changelog",
+    "build": "tsc -b -v packages",
+    "postbuild": "npm run move:node_modules",
+    "build:dev": "tsc -b -v packages --watch",
     "prebuild:prod": "npm run clean",
-    "build:prod": "gulp build",
-    "build:samples": "gulp install:samples && npm run build && gulp build:samples && gulp test:samples && gulp test:e2e:samples",
-    "clean": "gulp clean:bundle",
+    "build:prod": "tsc -b -v packages",
+    "changelog": "lerna-changelog",
+    "clean": "tsc -b --clean packages",
+    "move:samples": "gulp move:samples",
+    "move:node_modules": "gulp move:node_modules",
+    "build:samples": "gulp install:samples && npm run build && npm run move:samples && gulp build:samples && gulp test:samples && gulp test:e2e:samples",
     "codechecks:benchmarks": "codechecks ./tools/benchmarks/check-benchmarks.ts",
-    "coverage": "nyc report --reporter=text-lcov | coveralls",
-    "format": "prettier \"**/*.ts\" --ignore-path ./.prettierignore --write && git status",
+    "coverage": "nyc report --reporter=text-lcov | coveralls -v",
+    "format": "prettier \"**/*.ts\" \"packages/**/*.json\" --ignore-path ./.prettierignore --write && git status",
     "postinstall": "opencollective",
-    "test": "nyc --require ts-node/register mocha packages/**/*.spec.ts --reporter spec --require 'node_modules/reflect-metadata/Reflect.js' --exit",
-    "test:integration": "mocha \"integration/*/{,!(node_modules)/**/}/*.spec.ts\" --reporter spec --require ts-node/register --require 'node_modules/reflect-metadata/Reflect.js' --exit",
+    "test": "mocha packages/**/*.spec.ts",
+    "test:dev": "mocha -w --watch-files \"packages\" packages/**/*.spec.ts",
+    "pretest:cov": "npm run clean",
+    "test:cov": "nyc mocha packages/**/*.spec.ts --reporter spec",
+    "test:integration": "mocha --reporter-option maxDiffSize=0 \"integration/*/{,!(node_modules)/**/}/*.spec.ts\"",
     "test:docker:up": "docker-compose -f integration/docker-compose.yml up -d",
     "test:docker:down": "docker-compose -f integration/docker-compose.yml down",
     "lint": "concurrently 'npm run lint:packages' 'npm run lint:integration' 'npm run lint:spec'",
     "lint:fix": "concurrently 'npm run lint:packages -- --fix' 'npm run lint:integration -- --fix' 'npm run lint:spec -- --fix'",
-    "lint:integration": "eslint 'integration/*/{,!(node_modules)/**/}/*.ts' -c '.eslintrc.spec.js'",
-    "lint:packages": "eslint 'packages/**/**.ts' --ignore-pattern 'packages/**/*.spec.ts'",
-    "lint:spec": "eslint 'packages/**/**.spec.ts' -c '.eslintrc.spec.js'",
-    "prerelease": "gulp copy-misc && gulp build --dist node_modules/@nestjs && npm run changelog | pbcopy",
+    "lint:integration": "node --max-old-space-size=4096 ./node_modules/.bin/eslint 'integration/**/*.ts'",
+    "lint:packages": "node --max-old-space-size=4096 ./node_modules/.bin/eslint 'packages/**/**.ts' --ignore-pattern 'packages/**/*.spec.ts'",
+    "lint:spec": "node --max-old-space-size=4096 ./node_modules/.bin/eslint 'packages/**/**.spec.ts'",
+    "lint:ci": "concurrently 'npm run lint:packages' 'npm run lint:spec'",
+    "prerelease": "gulp copy-misc",
     "publish": "npm run prerelease && npm run build:prod && ./node_modules/.bin/lerna publish --force-publish --access public --exact -m \"chore(@nestjs) publish %s release\"",
+    "prepublishOnly": "npm run changelog | pbcopy",
     "publish:beta": "npm run prerelease && npm run build:prod && ./node_modules/.bin/lerna publish --npm-tag=beta --access public -m \"chore(@nestjs) publish %s release\"",
     "publish:next": "npm run prerelease && npm run build:prod && ./node_modules/.bin/lerna publish --npm-tag=next --access public --skip-git -m \"chore(@nestjs) publish %s release\"",
     "publish:rc": "npm run prerelease && npm run build:prod && ./node_modules/.bin/lerna publish --npm-tag=rc --access public -m \"chore(@nestjs) publish %s release\"",
     "publish:test": "npm run prerelease && npm run build:prod && ./node_modules/.bin/lerna publish --force-publish --access public --npm-tag=test --skip-git -m \"chore(@nestjs) publish %s release\"",
-    "prepare": "husky install"
+    "prepare": "husky"
   },
   "lint-staged": {
-    "packages/**/*.{ts,json}": [
+    "**/*.ts": [
+      "prettier --ignore-path ./.prettierignore --write"
+    ],
+    "packages/**/*.json": [
       "prettier --ignore-path ./.prettierignore --write"
     ]
   },
   "dependencies": {
     "@nuxtjs/opencollective": "0.3.2",
-    "axios": "0.24.0",
-    "class-transformer": "0.4.0",
-    "class-validator": "0.13.2",
-    "cli-color": "2.0.1",
+    "ansis": "3.3.2",
+    "class-transformer": "0.5.1",
+    "class-validator": "0.14.1",
     "cors": "2.8.5",
-    "express": "4.17.1",
-    "fast-json-stringify": "2.7.12",
+    "express": "4.21.1",
+    "fast-json-stringify": "6.0.0",
     "fast-safe-stringify": "2.1.1",
-    "graphql-subscriptions": "2.0.0",
     "iterare": "1.2.1",
-    "object-hash": "2.2.0",
+    "object-hash": "3.0.0",
     "path-to-regexp": "3.2.0",
-    "reflect-metadata": "0.1.13",
-    "rxjs": "7.4.0",
-    "socket.io": "4.4.0",
-    "tslib": "2.3.1",
-    "uuid": "8.3.2"
+    "reflect-metadata": "0.2.2",
+    "rxjs": "7.8.1",
+    "socket.io": "4.8.1",
+    "tslib": "2.8.1",
+    "uid": "2.0.2",
+    "uuid": "11.0.3"
   },
   "devDependencies": {
+    "@apollo/server": "4.11.2",
     "@codechecks/client": "0.1.12",
-    "@commitlint/cli": "15.0.0",
-    "@commitlint/config-angular": "16.0.0",
-    "@grpc/grpc-js": "1.5.0",
-    "@grpc/proto-loader": "0.6.9",
-    "@nestjs/graphql": "9.1.2",
-    "@nestjs/mongoose": "9.0.1",
-    "@nestjs/typeorm": "8.0.2",
-    "@types/amqplib": "0.8.2",
-    "@types/bytes": "3.1.1",
-    "@types/cache-manager": "3.4.2",
-    "@types/chai": "4.3.0",
-    "@types/chai-as-promised": "7.1.4",
-    "@types/cors": "2.8.12",
-    "@types/express": "4.17.13",
-    "@types/gulp": "4.0.9",
-    "@types/http-errors": "1.8.2",
-    "@types/mocha": "9.0.0",
-    "@types/node": "16.11.19",
-    "@types/redis": "4.0.11",
-    "@types/reflect-metadata": "0.1.0",
-    "@types/sinon": "10.0.6",
-    "@types/socket.io": "3.0.2",
-    "@types/ws": "8.2.2",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "amqp-connection-manager": "3.7.0",
-    "amqplib": "0.8.0",
-    "apollo-server-core": "3.6.1",
-    "apollo-server-express": "3.6.1",
-    "artillery": "1.7.9",
-    "body-parser": "1.19.1",
-    "bytes": "3.1.1",
-    "cache-manager": "3.6.0",
-    "cache-manager-redis-store": "2.0.0",
-    "chai": "4.3.4",
-    "chai-as-promised": "7.1.1",
-    "clang-format": "1.6.0",
-    "commitlint-circle": "1.0.0",
-    "concurrently": "6.4.0",
-    "conventional-changelog": "3.1.25",
-    "core-js": "3.19.3",
+    "@commitlint/cli": "19.5.0",
+    "@commitlint/config-angular": "19.5.0",
+    "@eslint/eslintrc": "3.2.0",
+    "@eslint/js": "9.15.0",
+    "@fastify/cors": "9.0.1",
+    "@fastify/formbody": "7.4.0",
+    "@fastify/middie": "8.3.1",
+    "@fastify/multipart": "8.3.0",
+    "@fastify/static": "7.0.4",
+    "@fastify/view": "9.1.0",
+    "@grpc/grpc-js": "1.12.2",
+    "@grpc/proto-loader": "0.7.13",
+    "@nestjs/apollo": "12.2.1",
+    "@nestjs/graphql": "12.2.1",
+    "@nestjs/mongoose": "10.1.0",
+    "@nestjs/typeorm": "10.0.2",
+    "@types/amqplib": "0.10.5",
+    "@types/bytes": "3.1.4",
+    "@types/chai": "4.3.16",
+    "@types/chai-as-promised": "7.1.8",
+    "@types/cors": "2.8.17",
+    "@types/eslint__js": "8.42.3",
+    "@types/express": "4.17.21",
+    "@types/gulp": "4.0.17",
+    "@types/http-errors": "2.0.4",
+    "@types/mocha": "10.0.10",
+    "@types/node": "22.9.0",
+    "@types/sinon": "17.0.3",
+    "@types/supertest": "6.0.2",
+    "@types/ws": "8.5.13",
+    "amqp-connection-manager": "4.1.14",
+    "amqplib": "0.10.5",
+    "artillery": "2.0.21",
+    "body-parser": "1.20.3",
+    "bytes": "3.1.2",
+    "cache-manager": "5.7.6",
+    "cache-manager-redis-store": "3.0.1",
+    "chai": "4.5.0",
+    "chai-as-promised": "7.1.2",
+    "clang-format": "1.8.0",
+    "concurrently": "9.1.0",
+    "conventional-changelog": "6.0.0",
+    "core-js": "3.39.0",
     "coveralls": "3.1.1",
     "delete-empty": "3.0.0",
-    "engine.io-client": "6.1.1",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "eventsource": "1.1.0",
-    "fancy-log": "1.3.3",
-    "fastify": "3.24.1",
-    "fastify-cors": "6.0.2",
-    "fastify-formbody": "5.2.0",
-    "fastify-multipart": "5.2.1",
-    "fastify-static": "4.5.0",
-    "graphql": "15.7.2",
-    "graphql-tools": "7.0.5",
-    "gulp": "4.0.2",
+    "engine.io-client": "6.6.2",
+    "eslint": "8.57.1",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-import": "2.31.0",
+    "eslint-plugin-prettier": "5.2.1",
+    "eventsource": "2.0.2",
+    "fancy-log": "2.0.0",
+    "fastify": "4.28.1",
+    "globals": "15.12.0",
+    "graphql": "16.9.0",
+    "graphql-tools": "9.0.3",
+    "graphql-subscriptions": "2.0.0",
+    "gulp": "5.0.0",
     "gulp-clang-format": "1.0.27",
     "gulp-clean": "0.4.0",
     "gulp-sourcemaps": "3.0.0",
     "gulp-typescript": "5.0.1",
     "gulp-watch": "5.0.1",
     "http-errors": "2.0.0",
-    "husky": "7.0.4",
-    "imports-loader": "3.1.1",
+    "husky": "9.1.7",
+    "imports-loader": "5.0.0",
+    "ioredis": "5.4.1",
     "json-loader": "0.5.7",
-    "kafkajs": "1.15.0",
+    "kafkajs": "2.2.4",
     "lerna": "2.11.0",
     "lerna-changelog": "2.2.0",
-    "light-my-request": "4.7.0",
-    "lint-staged": "12.1.3",
+    "light-my-request": "6.3.0",
+    "lint-staged": "15.2.10",
     "markdown-table": "2.0.0",
-    "merge-graphql-schemas": "1.7.8",
-    "middie": "5.3.0",
-    "mocha": "9.1.3",
-    "mongoose": "6.1.6",
-    "mqtt": "4.2.8",
+    "mocha": "10.8.2",
+    "mongoose": "8.8.3",
+    "mqtt": "5.10.2",
     "multer": "1.4.4",
-    "mysql2": "2.3.3",
-    "nats": "2.4.0",
-    "nodemon": "2.0.15",
-    "nyc": "15.1.0",
-    "point-of-view": "5.0.0",
-    "prettier": "2.5.1",
-    "redis": "3.1.2",
+    "mysql2": "3.11.4",
+    "nats": "2.28.2",
+    "nodemon": "3.1.7",
+    "nyc": "17.1.0",
+    "prettier": "3.3.3",
+    "redis": "4.7.0",
     "rxjs-compat": "6.6.7",
-    "sinon": "12.0.1",
-    "sinon-chai": "3.7.0",
-    "socket.io-client": "4.4.0",
+    "sinon": "19.0.2",
+    "sinon-chai": "4.0.0",
+    "socket.io-client": "4.8.1",
     "subscriptions-transport-ws": "0.11.0",
-    "supertest": "6.1.6",
-    "ts-morph": "13.0.2",
-    "ts-node": "10.4.0",
-    "typeorm": "0.2.41",
-    "typescript": "4.3.5",
+    "supertest": "7.0.0",
+    "ts-morph": "24.0.0",
+    "ts-node": "10.9.2",
+    "typeorm": "0.3.20",
+    "typescript": "5.6.3",
+    "typescript-eslint": "8.15.0",
     "wrk": "1.2.1",
-    "ws": "7.5.6"
+    "ws": "8.18.0"
   },
   "engines": {
-    "node": ">= 10.13.0"
+    "node": ">= 20"
   },
   "collective": {
     "type": "opencollective",
@@ -183,6 +194,7 @@
       "type: bug :sob:": "Bug fixes",
       "type: enhancement :wolf:": "Enhancements",
       "type: docs :page_facing_up:": "Docs",
+      "type: code style": "Code style tweaks",
       "dependencies": "Dependencies"
     }
   },
@@ -191,20 +203,23 @@
       "packages/**/*.ts"
     ],
     "exclude": [
-      "packages/**/*.spec.ts",
+      "**/*.js",
+      "**/*.d.ts",
+      "**/*.spec.ts",
       "packages/**/adapters/*.ts",
       "packages/**/nest-*.ts",
       "packages/**/test/**/*.ts",
       "packages/core/errors/**/*",
       "packages/common/exceptions/*.ts",
-      "packages/common/http/*.ts",
       "packages/common/utils/load-package.util.ts",
       "packages/microservices/exceptions/",
       "packages/microservices/microservices-module.ts",
       "packages/core/middleware/middleware-module.ts",
+      "packages/core/discovery/discovery-service.ts",
       "packages/core/injector/module-ref.ts",
       "packages/core/injector/instance-links-host.ts",
       "packages/core/helpers/context-id-factory.ts",
+      "packages/websockets/socket-module.ts",
       "packages/common/cache/**/*",
       "packages/common/serializer/**/*",
       "packages/common/services/*.ts"
@@ -221,5 +236,14 @@
     ],
     "sourceMap": true,
     "instrument": true
+  },
+  "mocha": {
+    "require": [
+      "ts-node/register",
+      "tsconfig-paths/register",
+      "node_modules/reflect-metadata/Reflect.js",
+      "hooks/mocha-init-hook.ts"
+    ],
+    "exit": true
   }
 }
diff --git a/packages/common/CHANGELOG.md b/packages/common/CHANGELOG.md
deleted file mode 100644
index 5d699e1d6..000000000
--- a/packages/common/CHANGELOG.md
+++ /dev/null
@@ -1,18 +0,0 @@
-# Change Log
-
-All notable changes to this project will be documented in this file.
-See [Conventional Commits](https://conventionalcommits.org) for commit guidelines.
-
-<a name="8.2.0"></a>
-# [8.2.0](https://github.com/nestjs/nest/compare/v8.1.2...v8.2.0) (2021-11-08)
-
-
-### Bug Fixes
-
-* **deps:** update dependency axios to v0.24.0 ([fc77e4f](https://github.com/nestjs/nest/commit/fc77e4f))
-
-
-### Features
-
-* **common:** add the ability to set some extra metadata about returned files ([5100573](https://github.com/nestjs/nest/commit/5100573))
-* **common:** allow to swap out class-validator and class-transformer ([2a1cc62](https://github.com/nestjs/nest/commit/2a1cc62))
diff --git a/packages/common/Readme.md b/packages/common/Readme.md
index 85a8c2535..4cac0d5ea 100644
--- a/packages/common/Readme.md
+++ b/packages/common/Readme.md
@@ -1,17 +1,16 @@
 <p align="center">
-  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
+  <a href="https://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
 </p>
 
 [circleci-image]: https://img.shields.io/circleci/build/github/nestjs/nest/master?token=abc123def456
 [circleci-url]: https://circleci.com/gh/nestjs/nest
 
-  <p align="center">A progressive <a href="http://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>
+  <p align="center">A progressive <a href="https://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>
     <p align="center">
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/v/@nestjs/core.svg" alt="NPM Version" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
 <a href="https://circleci.com/gh/nestjs/nest" target="_blank"><img src="https://img.shields.io/circleci/build/github/nestjs/nest/master" alt="CircleCI" /></a>
-<a href="https://coveralls.io/github/nestjs/nest?branch=master" target="_blank"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#9" alt="Coverage" /></a>
 <a href="https://discord.gg/G7Qnnhy" target="_blank"><img src="https://img.shields.io/badge/discord-online-brightgreen.svg" alt="Discord"/></a>
 <a href="https://opencollective.com/nest#backer" target="_blank"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
 <a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
@@ -24,21 +23,21 @@
 
 ## Description
 
-Nest is a framework for building efficient, scalable <a href="http://nodejs.org" target="_blank">Node.js</a> server-side applications. It uses modern JavaScript, is built with  <a href="http://www.typescriptlang.org" target="_blank">TypeScript</a> (preserves compatibility with pure JavaScript) and combines elements of OOP (Object Oriented Programming), FP (Functional Programming), and FRP (Functional Reactive Programming).
+Nest is a framework for building efficient, scalable <a href="https://nodejs.org" target="_blank">Node.js</a> server-side applications. It uses modern JavaScript, is built with <a href="https://www.typescriptlang.org" target="_blank">TypeScript</a> (preserves compatibility with pure JavaScript) and combines elements of OOP (Object Oriented Programming), FP (Functional Programming), and FRP (Functional Reactive Programming).
 
-<p>Under the hood, Nest makes use of <a href="https://expressjs.com/" target="_blank">Express</a>, but also, provides compatibility with a wide range of other libraries, like e.g. <a href="https://github.com/fastify/fastify" target="_blank">Fastify</a>, allowing for easy use of the myriad third-party plugins which are available.</p>
+<p>Under the hood, Nest makes use of <a href="https://expressjs.com/" target="_blank">Express</a>, but also provides compatibility with a wide range of other libraries, like <a href="https://github.com/fastify/fastify" target="_blank">Fastify</a>, allowing for easy use of the myriad of third-party plugins which are available.</p>
 
 ## Philosophy
 
-<p>In recent years, thanks to Node.js, JavaScript has become the ‚Äúlingua franca‚Äù of the web for both front and backend applications, giving rise to awesome projects like <a href="https://angular.io/" target="_blank">Angular</a>, <a href="https://github.com/facebook/react" target="_blank">React</a> and <a href="https://github.com/vuejs/vue" target="_blank">Vue</a> which improve developer productivity and enable the construction of fast, testable, extensible frontend applications. However, on the server-side, while there are a lot of superb libraries, helpers and tools for Node, none of them effectively solve the main problem - the architecture.</p>
-<p>Nest aims to provide an application architecture out of the box which allows for effortless creation of highly testable, scalable, loosely coupled and easily maintainable applications. The architecture is heavily inspired by Angular.</p>
+<p>In recent years, thanks to Node.js, JavaScript has become the ‚Äúlingua franca‚Äù of the web for both front and backend applications, giving rise to awesome projects like <a href="https://angular.io/" target="_blank">Angular</a>, <a href="https://github.com/facebook/react" target="_blank">React</a>, and <a href="https://github.com/vuejs/vue" target="_blank">Vue</a>, which improve developer productivity and enable the construction of fast, testable, and extensible frontend applications. However, on the server-side, while there are a lot of superb libraries, helpers, and tools for Node, none of them effectively solve the main problem - the architecture.</p>
+<p>Nest aims to provide an application architecture out of the box which allows for effortless creation of highly testable, scalable, and loosely coupled and easily maintainable applications. The architecture is heavily inspired by Angular.</p>
 
 ## Getting started
 
-* To check out the [guide](https://docs.nestjs.com), visit [docs.nestjs.com](https://docs.nestjs.com). :books:
-* Ë¶ÅÊü•Áúã‰∏≠Êñá [ÊåáÂçó](readme_zh.md), ËØ∑ËÆøÈóÆ [docs.nestjs.cn](https://docs.nestjs.cn). :books:
-* [Í∞ÄÏù¥Îìú](readme_kr.md)Î•º ÌôïÏù∏ÌïòÎ†§Î©¥, [docs.nestjs.com](https://docs.nestjs.com)Î•º Î∞©Î¨∏ÌïòÏÑ∏Ïöî.:books: 
-* „ÉÅ„Çß„ÉÉ„ÇØ„Åô„Çã„Å´„ÅØ [„Ç¨„Ç§„Éâ](readme_jp.md), Ë©≥„Åó„Åè„ÅØ [docs.nestjs.com](https://docs.nestjs.com). :books: 
+- To check out the [guide](https://docs.nestjs.com), visit [docs.nestjs.com](https://docs.nestjs.com). :books:
+- Ë¶ÅÊü•Áúã‰∏≠Êñá [ÊåáÂçó](readme_zh.md), ËØ∑ËÆøÈóÆ [docs.nestjs.cn](https://docs.nestjs.cn). :books:
+- [Í∞ÄÏù¥Îìú](readme_kr.md) Î¨∏ÏÑúÎäî [docs.nestjs.com](https://docs.nestjs.com)ÏóêÏÑú ÌôïÏù∏ÌïòÏã§ Ïàò ÏûàÏäµÎãàÎã§. :books:
+- [„Ç¨„Ç§„Éâ](readme_jp.md)„ÅØ [docs.nestjs.com](https://docs.nestjs.com)„Åß„ÅîÁ¢∫Ë™ç„Åè„Å†„Åï„ÅÑ„ÄÇ :books:
 
 ## Questions
 
@@ -54,71 +53,88 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
-<table style="text-align:center;"><tr>
-  <td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
-  <td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/red-hat-logo.svg" width="200" valign="middle" /></a></td>
-<td>
-<a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
-<td>
-<a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
-</tr></table>
+
+<table style="text-align:center;">
+<tr>
+<td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
+<td><a href="https://microsoft.com/" target="_blank"><img src="https://nestjs.com/img/logos/microsoft-logo.png" width="180" valign="middle" /></a></td>
+<td><a href="https://mojam.co" target="_blank"><img src="https://nestjs.com/img/logos/mojam-logo.png" width="80" valign="middle" /></a></td>
+<td><a href="https://marblism.com?utm_source=nest" target="_blank"><img src="https://nestjs.com/img/logos/marblism-logo.png" width="180" valign="middle" /></a></td>
+<td><a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
+<td><a href="https://amplication.com/" target="_blank"><img src="https://nestjs.com/img/logos/amplication-logo.svg" width="190" valign="middle" /></a></td>
+</tr>
+</table>
 
 #### Gold Sponsors
 
-<table style="text-align:center;"><tr><td>
-  <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
-  <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
-<td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
+<table style="text-align:center;">
+<tr>
+<td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/logos/red-hat-logo.svg" width="200" valign="middle" /></a></td>
+<td><a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
+<td><a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/logos/nx-logo.png" height="45" valign="middle" /></a></td>
+<td><a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/logos/intrinisic-logo.png" width="210" valign="middle" /></a></td>
+<td><a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/logos/jetbrains-logo.svg" width="90" valign="middle" /></a></td>
+</tr>
+<tr>
+<td><a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/logos/snyk-logo-black.png" width="185" valign="middle" /></a></td>
+<td><a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/logos/fuse-logo.svg" width="105" valign="middle" /></a></td>
+<td><a href="https://ridicorp.com/career/" target="_blank"><img src="https://nestjs.com/img/logos/ridi-logo.svg" width="105" valign="middle" /></a></td>
+<td><a href="https://www.movavi.com/imovie-for-windows.html" target="_blank"><img src="https://nestjs.com/img/logos/movavi-logo.svg" width="105" valign="middle" /></a></td>
+<td><a href="https://skunk.team" target="_blank"><img src="https://nestjs.com/img/logos/skunk-logo.png" height="60" valign="middle" /></a></td>
+</tr>
+</table>
 
 #### Silver Sponsors
 
-<table style="text-align:center;"><tr><td>
-<a href="https://neoteric.eu/" target="_blank"><img src="https://nestjs.com/img/neoteric-cut.png" width="120" valign="middle" /></a> </td><td>
-  <a href="http://gojob.com" target="_blank"><img src="http://nestjs.com/img/gojob-logo.png" valign="middle" width="100" /></a> </td><td>
-<a href="https://www.myleodsc.com/" target="_blank"><img src="https://nestjs.com/img/myleo-logo.png" width="180" valign="middle" /></td><td>
-<a href="https://careers.meetdandy.com/?gh_src=063ba61e3us" target="_blank"><img src="https://nestjs.com/img/dandy-roles-logo.svg" width="150" valign="middle" /></td><td>
-<a href="https://www.castlecraft.in" target="_blank"><img src="https://nestjs.com/img/castlecraft-logo.png" width="150" valign="middle" /></td>
-<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td></tr></table>
+<table style="text-align:center;">
+<tr>
+<td><a href="https://www.mercedes-benz.com/" target="_blank"><img src="https://nestjs.com/img/logos/mercedes-logo.png" width="100" valign="middle" /></a></td>
+<td><a href="https://www.dinii.jp/" target="_blank"><img src="https://nestjs.com/img/logos/dinii-logo.png" width="65" valign="middle" /></a></td>
+<td><a href="https://bloodycase.com/?promocode=NEST" target="_blank"><img src="https://nestjs.com/img/logos/bloodycase-logo.png" width="65" valign="middle" /></a></td>
+<td><a href="https://handsontable.com/docs/react-data-grid/?utm_source=NestJS_GH&utm_medium=sponsorship&utm_campaign=library_sponsorship_2024" target="_blank"><img src="https://nestjs.com/img/logos/handsontable-dark-logo.svg#2" width="150" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.itflashcards.com/" target="_blank"><img src="https://nestjs.com/img/logos/it_flashcards-logo.png" width="170" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://arcjet.com/?ref=nestjs" target="_blank"><img src="https://nestjs.com/img/logos/arcjet-logo.svg" width="170" valign="middle" /></a></td>
+</tr>
+</table>
 
 #### Sponsors
 
-<table><tr><td align="center" valign="middle">
-<a href="https://www.swingdev.io" target="_blank"><img src="https://nestjs.com/img/swingdev-logo.svg#1" width="110" valign="middle" /> </a></td><td align="center" valign="middle">
-<a href="https://www.novologic.com/" target="_blank"><img src="https://nestjs.com/img/novologic.png" width="110" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://ever.co/" target="_blank"><img src="https://nestjs.com/img/ever-logo.png" width="72" valign="middle" /></a>  </td><td align="center" valign="middle">
-<a href="https://blokt.com" target="_blank"><img src="https://nestjs.com/img/blokt-logo.png" width="120" valign="middle" /></a>  </td><td align="center" valign="middle"> 
-  <a href="http://architectnow.net/" target="_blank"><img src="https://nestjs.com/img/architectnow.png" width="125" valign="middle" /></a> </td><td align="center" valign="middle">
-  <a href="https://quander.io/" target="_blank"><img src="https://nestjs.com/img/quander.png" width="100" valign="middle" /></a> </td></tr><tr><td align="center" valign="middle">
-  <a href="https://mantro.net/" target="_blank"><img src="https://nestjs.com/img/mantro-logo.svg" width="95" valign="middle" /></a> </td><td align="center" valign="middle">
-  <a href="https://triplebyte.com/" target="_blank"><img src="https://nestjs.com/img/triplebyte.png" width="107" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://reposit.co.uk/" target="_blank"><img src="https://nestjs.com/img/reposit-logo.png" width="71" valign="middle" /></a></td><td align="center" valign="middle">
-<a href="https://nearpod.com/" target="_blank"><img src="https://nestjs.com/img/nearpod-logo.svg" width="100" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://clay.global/" target="_blank"><img src="https://nestjs.com/img/clay-logo.svg" width="75" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://firesticktricks.com" target="_blank"><img src="https://nestjs.com/img/firesticktricks-logo.png" width="120" valign="middle" /></a></td></tr><tr><td align="center" valign="middle">
-<a href="https://www.codeguesser.co.uk" target="_blank"><img src="https://nestjs.com/img/codeguesser-logo.svg" width="120" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://f-a.nz/" target="_blank"><img src="https://nestjs.com/img/franz.svg" width="80" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://sparkfabrik.com/" target="_blank"><img src="https://nestjs.com/img/sparkfabrik-logo.png" width="120" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://www.thebigphonestore.co.uk/" target="_blank"><img src="https://nestjs.com/img/the-big-phone-store-logo.png" width="65" valign="middle" /></a></td>
-  <td align="center" valign="middle">
-  <a href="https://genuinebee.com/" target="_blank"><img src="https://nestjs.com/img/genuinebee.svg" width="97" valign="middle" /></a> </td>
-<td align="center" valign="middle"><a href="https://sanyodigital.com/" target="_blank"><img src="https://nestjs.com/img/sanyo-digital.png" width="130" valign="middle" /></a></td></tr><tr><td align="center" valign="middle"><a href="https://vpn-review.com/vpn-for-torrenting" target="_blank"><img src="https://nestjs.com/img/vpn-review-logo.png" width="85" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://lambda-it.ch/" target="_blank"><img src="https://nestjs.com/img/lambda-it-logo.svg" width="115" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://pickwriters.com/top-10-translation-services" target="_blank"><img src="https://nestjs.com/img/pickwriters-logo.png" width="40" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://thewordpoint.com/services/localization" target="_blank"><img src="https://nestjs.com/img/thewordpoint-logo.png" width="40" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://meercode.io/" target="_blank"><img src="https://nestjs.com/img/meercode-logo.png" width="60" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://www.najlepszeplatformyforex.pl/blog/broker-xtb/" target="_blank"><img src="https://nestjs.com/img/npf-logo.jpg" width="200" valign="middle" /></a></td></tr><tr>
-<td align="center" valign="middle"><a href="https://thestandarddaily.com/" target="_blank"><img src="https://nestjs.com/img/the-standard-daily-logo.png" width="180" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://houseofangular.io/" target="_blank"><img src="https://nestjs.com/img/house-of-angular.png" width="100" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://rocketech.it/cases/?utm_source=google&utm_medium=badge&utm_campaign=nestjs" target="_blank"><img src="https://nestjs.com/img/rocketech-logo.svg" width="110" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://www.bystored.com/" target="_blank"><img src="https://nestjs.com/img/stored-logo.svg" width="110" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://studyclerk.com/pay-for-research-paper" target="_blank"><img src="https://nestjs.com/img/studyclerk-logo.png" width="125" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://xyndata.com" target="_blank"><img src="https://nestjs.com/img/xyndata-logo.png" width="125" valign="middle" /></a></td></tr><tr>
-  <td align="center" valign="middle"><a href="https://www.anonymistic.com/" target="_blank"><img src="https://nestjs.com/img/anonymistic-logo.png" width="125" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/naologic-logo.svg" width="125" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://messaged.com/" target="_blank"><img src="https://nestjs.com/img/messaged-logo.png" width="50" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/triplecore-logo.svg" width="50" valign="middle" /></a></td>
-  </tr></table>
+<table>
+<tr>
+<td align="center" valign="middle"><a href="https://www.swingdev.io" target="_blank"><img src="https://nestjs.com/img/logos/swingdev-logo.svg#1" width="110" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.novologic.com/" target="_blank"><img src="https://nestjs.com/img/logos/novologic.png" width="110" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://mantro.net/" target="_blank"><img src="https://nestjs.com/img/logos/mantro-logo.svg" width="95" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://triplebyte.com/" target="_blank"><img src="https://nestjs.com/img/logos/triplebyte.png" width="107" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://nearpod.com/" target="_blank"><img src="https://nestjs.com/img/logos/nearpod-logo.svg" width="100" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://genuinebee.com/" target="_blank"><img src="https://nestjs.com/img/logos/genuinebee.svg" width="97" valign="middle" /></a></td>
+</tr>
+<tr>
+<td align="center" valign="middle"><a href="https://vpn-review.com/vpn-for-torrenting" target="_blank"><img src="https://nestjs.com/img/logos/vpn-review-logo.png" width="85" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://lambda-it.ch/" target="_blank"><img src="https://nestjs.com/img/logos/lambda-it-logo.svg" width="115" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://rocketech.it/cases/?utm_source=google&utm_medium=badge&utm_campaign=nestjs" target="_blank"><img src="https://nestjs.com/img/logos/rocketech-logo.svg" width="110" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.anonymistic.com/" target="_blank"><img src="https://nestjs.com/img/logos/anonymistic-logo.png" width="125" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/logos/naologic-logo.svg" width="125" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/logos/triplecore-logo.svg" width="50" valign="middle" /></a></td>
+</tr>
+<tr>
+<td align="center" valign="middle"><a href="https://thecasinowizard.com/bonuses/no-deposit-bonuses/" target="_blank"><img src="https://nestjs.com/img/logos/casinowizard-logo.png" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://polygon-software.ch/" target="_blank"><img src="https://nestjs.com/img/logos/polygon-logo.svg" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/logos/boringowl-logo.svg" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://nordbot.app/" target="_blank"><img src="https://nestjs.com/img/logos/nordbot-logo.png" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://doppio.sh/" target="_blank"><img src="https://nestjs.com/img/logos/dopiosh-logo.png" width="50" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.hingehealth.com/" target="_blank"><img src="https://nestjs.com/img/logos/hinge-health-logo.svg" width="100" valign="middle" /></a></td>
+</tr>
+<tr>
+<td align="center" valign="middle"><a href="https://julienferand.dev/" target="_blank"><img src="https://nestjs.com/img/logos/julienferand-logo.jpeg" width="55" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.tripoffice.com/" target="_blank"><img src="https://nestjs.com/img/logos/tripoffice-logo.png" width="140" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://solcellsforetag.se/" target="_blank"><img src="https://nestjs.com/img/logos/solcellsforetag-logo.svg" width="140" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.route4me.com/" target="_blank"><img src="https://nestjs.com/img/logos/route4me-logo.svg" width="100" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.slotsup.com/" target="_blank"><img src="https://nestjs.com/img/logos/slotsup-logo.png" width="60" valign="middle" /></a></td>
+</tr>
+</table>
 
 ## Backers
 
@@ -126,9 +142,9 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 
 ## Stay in touch
 
-* Author - [Kamil My≈õliwiec](https://twitter.com/kammysliwiec)
-* Website - [https://nestjs.com](https://nestjs.com/)
-* Twitter - [@nestframework](https://twitter.com/nestframework)
+- Author - [Kamil My≈õliwiec](https://x.com/kammysliwiec)
+- Website - [https://nestjs.com](https://nestjs.com/)
+- X - [@nestframework](https://x.com/nestframework)
 
 ## License
 
diff --git a/packages/common/cache/cache.constants.ts b/packages/common/cache/cache.constants.ts
deleted file mode 100644
index 0ecf5c94e..000000000
--- a/packages/common/cache/cache.constants.ts
+++ /dev/null
@@ -1,4 +0,0 @@
-export const CACHE_MANAGER = 'CACHE_MANAGER';
-export const CACHE_MODULE_OPTIONS = 'CACHE_MODULE_OPTIONS';
-export const CACHE_KEY_METADATA = 'cache_module:cache_key';
-export const CACHE_TTL_METADATA = 'cache_module:cache_ttl';
diff --git a/packages/common/cache/cache.module.ts b/packages/common/cache/cache.module.ts
deleted file mode 100644
index 4e2c63d48..000000000
--- a/packages/common/cache/cache.module.ts
+++ /dev/null
@@ -1,94 +0,0 @@
-import { Module } from '../decorators';
-import { DynamicModule, Provider } from '../interfaces';
-import { CACHE_MANAGER, CACHE_MODULE_OPTIONS } from './cache.constants';
-import { createCacheManager } from './cache.providers';
-import {
-  CacheModuleAsyncOptions,
-  CacheModuleOptions,
-  CacheOptionsFactory,
-} from './interfaces/cache-module.interface';
-
-/**
- * Module that provides Nest cache-manager.
- *
- * @see [Caching](https://docs.nestjs.com/techniques/caching)
- *
- * @publicApi
- */
-@Module({
-  providers: [createCacheManager()],
-  exports: [CACHE_MANAGER],
-})
-export class CacheModule {
-  /**
-   * Configure the cache manager statically.
-   *
-   * @param options options to configure the cache manager
-   *
-   * @see [Customize caching](https://docs.nestjs.com/techniques/caching#customize-caching)
-   */
-  static register<StoreConfig extends Record<any, any> = Record<string, any>>(
-    options: CacheModuleOptions<StoreConfig> = {} as any,
-  ): DynamicModule {
-    return {
-      module: CacheModule,
-      global: options.isGlobal,
-      providers: [{ provide: CACHE_MODULE_OPTIONS, useValue: options }],
-    };
-  }
-
-  /**
-   * Configure the cache manager dynamically.
-   *
-   * @param options method for dynamically supplying cache manager configuration
-   * options
-   *
-   * @see [Async configuration](https://docs.nestjs.com/techniques/caching#async-configuration)
-   */
-  static registerAsync<
-    StoreConfig extends Record<any, any> = Record<string, any>,
-  >(options: CacheModuleAsyncOptions<StoreConfig>): DynamicModule {
-    return {
-      module: CacheModule,
-      global: options.isGlobal,
-      imports: options.imports,
-      providers: [
-        ...this.createAsyncProviders<StoreConfig>(options),
-        ...(options.extraProviders || []),
-      ],
-    };
-  }
-
-  private static createAsyncProviders<StoreConfig extends Record<any, any>>(
-    options: CacheModuleAsyncOptions<StoreConfig>,
-  ): Provider[] {
-    if (options.useExisting || options.useFactory) {
-      return [this.createAsyncOptionsProvider(options)];
-    }
-    return [
-      this.createAsyncOptionsProvider(options),
-      {
-        provide: options.useClass,
-        useClass: options.useClass,
-      },
-    ];
-  }
-
-  private static createAsyncOptionsProvider<
-    StoreConfig extends Record<any, any>,
-  >(options: CacheModuleAsyncOptions<StoreConfig>): Provider {
-    if (options.useFactory) {
-      return {
-        provide: CACHE_MODULE_OPTIONS,
-        useFactory: options.useFactory,
-        inject: options.inject || [],
-      };
-    }
-    return {
-      provide: CACHE_MODULE_OPTIONS,
-      useFactory: async (optionsFactory: CacheOptionsFactory<StoreConfig>) =>
-        optionsFactory.createCacheOptions(),
-      inject: [options.useExisting || options.useClass],
-    };
-  }
-}
diff --git a/packages/common/cache/cache.providers.ts b/packages/common/cache/cache.providers.ts
deleted file mode 100644
index 2e6df398d..000000000
--- a/packages/common/cache/cache.providers.ts
+++ /dev/null
@@ -1,36 +0,0 @@
-import { Provider } from '../interfaces';
-import { loadPackage } from '../utils/load-package.util';
-import { CACHE_MANAGER, CACHE_MODULE_OPTIONS } from './cache.constants';
-import { defaultCacheOptions } from './default-options';
-import { CacheManagerOptions } from './interfaces/cache-manager.interface';
-
-/**
- * Creates a CacheManager Provider.
- *
- * @publicApi
- */
-export function createCacheManager(): Provider {
-  return {
-    provide: CACHE_MANAGER,
-    useFactory: (options: CacheManagerOptions) => {
-      const cacheManager = loadPackage('cache-manager', 'CacheModule', () =>
-        require('cache-manager'),
-      );
-
-      return Array.isArray(options)
-        ? cacheManager.multiCaching(
-            options.map(store =>
-              cacheManager.caching({
-                ...defaultCacheOptions,
-                ...(store || {}),
-              }),
-            ),
-          )
-        : cacheManager.caching({
-            ...defaultCacheOptions,
-            ...(options || {}),
-          });
-    },
-    inject: [CACHE_MODULE_OPTIONS],
-  };
-}
diff --git a/packages/common/cache/decorators/cache-key.decorator.ts b/packages/common/cache/decorators/cache-key.decorator.ts
deleted file mode 100644
index b9aa7f3c1..000000000
--- a/packages/common/cache/decorators/cache-key.decorator.ts
+++ /dev/null
@@ -1,17 +0,0 @@
-import { SetMetadata } from '../../decorators';
-import { CACHE_KEY_METADATA } from '../cache.constants';
-
-/**
- * Decorator that sets the caching key used to store/retrieve cached items for
- * Web sockets or Microservice based apps.
- *
- * For example:
- * `@CacheKey('events')`
- *
- * @param key string naming the field to be used as a cache key
- *
- * @see [Caching](https://docs.nestjs.com/techniques/caching)
- *
- * @publicApi
- */
-export const CacheKey = (key: string) => SetMetadata(CACHE_KEY_METADATA, key);
diff --git a/packages/common/cache/decorators/cache-ttl.decorator.ts b/packages/common/cache/decorators/cache-ttl.decorator.ts
deleted file mode 100644
index e6b48ae93..000000000
--- a/packages/common/cache/decorators/cache-ttl.decorator.ts
+++ /dev/null
@@ -1,18 +0,0 @@
-import { SetMetadata } from '../../decorators';
-import { ExecutionContext } from '../../interfaces/features/execution-context.interface';
-import { CACHE_TTL_METADATA } from '../cache.constants';
-
-/**
- * Decorator that sets the cache ttl setting the duration for cache expiration.
- *
- * For example: `@CacheTTL(5)`
- *
- * @param ttl number set the cache expiration time
- *
- * @see [Caching](https://docs.nestjs.com/techniques/caching)
- *
- * @publicApi
- */
-type CacheTTLFactory = (ctx: ExecutionContext) => Promise<number> | number;
-export const CacheTTL = (ttl: number | CacheTTLFactory) =>
-  SetMetadata(CACHE_TTL_METADATA, ttl);
diff --git a/packages/common/cache/decorators/index.ts b/packages/common/cache/decorators/index.ts
deleted file mode 100644
index 9d60a27f5..000000000
--- a/packages/common/cache/decorators/index.ts
+++ /dev/null
@@ -1,2 +0,0 @@
-export * from './cache-key.decorator';
-export * from './cache-ttl.decorator';
diff --git a/packages/common/cache/default-options.ts b/packages/common/cache/default-options.ts
deleted file mode 100644
index cdd262e2d..000000000
--- a/packages/common/cache/default-options.ts
+++ /dev/null
@@ -1,5 +0,0 @@
-export const defaultCacheOptions = {
-  ttl: 5,
-  max: 100,
-  store: 'memory',
-};
diff --git a/packages/common/cache/index.ts b/packages/common/cache/index.ts
deleted file mode 100644
index 1a5dfc371..000000000
--- a/packages/common/cache/index.ts
+++ /dev/null
@@ -1,5 +0,0 @@
-export * from './cache.constants';
-export * from './cache.module';
-export * from './decorators';
-export * from './interceptors';
-export * from './interfaces';
diff --git a/packages/common/cache/interceptors/cache.interceptor.ts b/packages/common/cache/interceptors/cache.interceptor.ts
deleted file mode 100644
index 7a27c9d73..000000000
--- a/packages/common/cache/interceptors/cache.interceptor.ts
+++ /dev/null
@@ -1,89 +0,0 @@
-import { Observable, of } from 'rxjs';
-import { tap } from 'rxjs/operators';
-import { Inject, Injectable, Optional } from '../../decorators';
-import {
-  CallHandler,
-  ExecutionContext,
-  HttpServer,
-  NestInterceptor,
-} from '../../interfaces';
-import { isFunction, isNil } from '../../utils/shared.utils';
-import {
-  CACHE_KEY_METADATA,
-  CACHE_MANAGER,
-  CACHE_TTL_METADATA,
-} from '../cache.constants';
-
-const HTTP_ADAPTER_HOST = 'HttpAdapterHost';
-const REFLECTOR = 'Reflector';
-
-export interface HttpAdapterHost<T extends HttpServer = any> {
-  httpAdapter: T;
-}
-
-@Injectable()
-export class CacheInterceptor implements NestInterceptor {
-  @Optional()
-  @Inject(HTTP_ADAPTER_HOST)
-  protected readonly httpAdapterHost: HttpAdapterHost;
-
-  protected allowedMethods = ['GET'];
-  constructor(
-    @Inject(CACHE_MANAGER) protected readonly cacheManager: any,
-    @Inject(REFLECTOR) protected readonly reflector: any,
-  ) {}
-
-  async intercept(
-    context: ExecutionContext,
-    next: CallHandler,
-  ): Promise<Observable<any>> {
-    const key = this.trackBy(context);
-    const ttlValueOrFactory =
-      this.reflector.get(CACHE_TTL_METADATA, context.getHandler()) ?? null;
-
-    if (!key) {
-      return next.handle();
-    }
-    try {
-      const value = await this.cacheManager.get(key);
-      if (!isNil(value)) {
-        return of(value);
-      }
-      const ttl = isFunction(ttlValueOrFactory)
-        ? await ttlValueOrFactory(context)
-        : ttlValueOrFactory;
-      return next.handle().pipe(
-        tap(response => {
-          const args = isNil(ttl) ? [key, response] : [key, response, { ttl }];
-          this.cacheManager.set(...args);
-        }),
-      );
-    } catch {
-      return next.handle();
-    }
-  }
-
-  protected trackBy(context: ExecutionContext): string | undefined {
-    const httpAdapter = this.httpAdapterHost.httpAdapter;
-    const isHttpApp = httpAdapter && !!httpAdapter.getRequestMethod;
-    const cacheMetadata = this.reflector.get(
-      CACHE_KEY_METADATA,
-      context.getHandler(),
-    );
-
-    if (!isHttpApp || cacheMetadata) {
-      return cacheMetadata;
-    }
-
-    const request = context.getArgByIndex(0);
-    if (!this.isRequestCacheable(context)) {
-      return undefined;
-    }
-    return httpAdapter.getRequestUrl(request);
-  }
-
-  protected isRequestCacheable(context: ExecutionContext): boolean {
-    const req = context.switchToHttp().getRequest();
-    return this.allowedMethods.includes(req.method);
-  }
-}
diff --git a/packages/common/cache/interceptors/index.ts b/packages/common/cache/interceptors/index.ts
deleted file mode 100644
index 474887b1f..000000000
--- a/packages/common/cache/interceptors/index.ts
+++ /dev/null
@@ -1 +0,0 @@
-export * from './cache.interceptor';
diff --git a/packages/common/cache/interfaces/cache-manager.interface.ts b/packages/common/cache/interfaces/cache-manager.interface.ts
deleted file mode 100644
index 13e34127d..000000000
--- a/packages/common/cache/interfaces/cache-manager.interface.ts
+++ /dev/null
@@ -1,83 +0,0 @@
-export interface LiteralObject {
-  [key: string]: any;
-}
-
-/**
- * Interface defining a cache store. Implement this interface to create a custom
- * cache store.
- *
- * @publicApi
- */
-export interface CacheStore {
-  /**
-   * Create a key/value pair in the cache.
-   *
-   * @param key cache key
-   * @param value cache value
-   */
-  set<T>(
-    key: string,
-    value: T,
-    options?: CacheStoreSetOptions<T>,
-  ): Promise<void> | void;
-  /**
-   * Retrieve a key/value pair from the cache.
-   *
-   * @param key cache key
-   */
-  get<T>(key: string): Promise<T | undefined> | T | undefined;
-  /**
-   * Destroy a key/value pair from the cache.
-   *
-   * @param key cache key
-   */
-  del?(key: string): void | Promise<void>;
-}
-
-export interface CacheStoreSetOptions<T> {
-  /**
-   * Time to live - amount of time in seconds that a response is cached before it
-   * is deleted. Defaults based on your cache manager settings.
-   */
-  ttl?: ((value: T) => number) | number;
-}
-
-/**
- * Interface defining a factory to create a cache store.
- *
- * @publicApi
- */
-export interface CacheStoreFactory {
-  /**
-   * Return a configured cache store.
-   *
-   * @param args Cache manager options received from `CacheModule.register()`
-   * or `CacheModule.registerAsync()`
-   */
-  create(args: LiteralObject): CacheStore;
-}
-
-/**
- * Interface defining Cache Manager configuration options.
- *
- * @publicApi
- */
-export interface CacheManagerOptions {
-  /**
-   * Cache storage manager.  Default is `'memory'` (in-memory store).  See
-   * [Different stores](https://docs.nestjs.com/techniques/caching#different-stores)
-   * for more info.
-   */
-  store?: string | CacheStoreFactory | CacheStore;
-  /**
-   * Time to live - amount of time in seconds that a response is cached before it
-   * is deleted. Subsequent request will call through the route handler and refresh
-   * the cache.  Defaults to 5 seconds.
-   */
-  ttl?: number;
-  /**
-   * Maximum number of responses to store in the cache.  Defaults to 100.
-   */
-  max?: number;
-  isCacheableValue?: (value: any) => boolean;
-}
diff --git a/packages/common/cache/interfaces/cache-module.interface.ts b/packages/common/cache/interfaces/cache-module.interface.ts
deleted file mode 100644
index 5beb769c8..000000000
--- a/packages/common/cache/interfaces/cache-module.interface.ts
+++ /dev/null
@@ -1,71 +0,0 @@
-import { ModuleMetadata, Provider, Type } from '../../interfaces';
-import { CacheManagerOptions } from './cache-manager.interface';
-
-export type CacheModuleOptions<
-  StoreConfig extends Record<any, any> = Record<string, any>,
-> =
-  // Store-specfic configuration takes precedence over cache module options due
-  // to how `createCacheManager` is implemented.
-  CacheManagerOptions &
-    StoreConfig & {
-      /**
-       * If "true', register `CacheModule` as a global module.
-       */
-      isGlobal?: boolean;
-    };
-
-/**
- * Interface describing a `CacheOptionsFactory`.  Providers supplying configuration
- * options for the Cache module must implement this interface.
- *
- * @see [Async configuration](https://docs.nestjs.com/techniques/caching#async-configuration)
- *
- * @publicApi
- */
-export interface CacheOptionsFactory<
-  StoreConfig extends Record<any, any> = Record<string, any>,
-> {
-  createCacheOptions():
-    | Promise<CacheModuleOptions<StoreConfig>>
-    | CacheModuleOptions<StoreConfig>;
-}
-
-/**
- * Options for dynamically configuring the Cache module.
- *
- * @see [Async configuration](https://docs.nestjs.com/techniques/caching#async-configuration)
- *
- * @publicApi
- */
-export interface CacheModuleAsyncOptions<
-  StoreConfig extends Record<any, any> = Record<string, any>,
-> extends Pick<ModuleMetadata, 'imports'> {
-  /**
-   * Injection token resolving to an existing provider. The provider must implement
-   * the `CacheOptionsFactory` interface.
-   */
-  useExisting?: Type<CacheOptionsFactory<StoreConfig>>;
-  /**
-   * Injection token resolving to a class that will be instantiated as a provider.
-   * The class must implement the `CacheOptionsFactory` interface.
-   */
-  useClass?: Type<CacheOptionsFactory<StoreConfig>>;
-  /**
-   * Function returning options (or a Promise resolving to options) to configure the
-   * cache module.
-   */
-  useFactory?: (
-    ...args: any[]
-  ) =>
-    | Promise<CacheModuleOptions<StoreConfig>>
-    | CacheModuleOptions<StoreConfig>;
-  /**
-   * Dependencies that a Factory may inject.
-   */
-  inject?: any[];
-  extraProviders?: Provider[];
-  /**
-   * If "true', register `CacheModule` as a global module.
-   */
-  isGlobal?: boolean;
-}
diff --git a/packages/common/cache/interfaces/index.ts b/packages/common/cache/interfaces/index.ts
deleted file mode 100644
index 54aa4c3cb..000000000
--- a/packages/common/cache/interfaces/index.ts
+++ /dev/null
@@ -1,2 +0,0 @@
-export * from './cache-manager.interface';
-export * from './cache-module.interface';
diff --git a/packages/common/constants.ts b/packages/common/constants.ts
index bd18972d5..71f27685d 100644
--- a/packages/common/constants.ts
+++ b/packages/common/constants.ts
@@ -4,6 +4,7 @@ export const MODULE_METADATA = {
   CONTROLLERS: 'controllers',
   EXPORTS: 'exports',
 };
+
 export const GLOBAL_MODULE_METADATA = '__module:global__';
 export const HOST_METADATA = 'host';
 export const PATH_METADATA = 'path';
@@ -15,13 +16,24 @@ export const OPTIONAL_PROPERTY_DEPS_METADATA = 'optional:properties_metadata';
 export const SCOPE_OPTIONS_METADATA = 'scope:options';
 export const METHOD_METADATA = 'method';
 export const ROUTE_ARGS_METADATA = '__routeArguments__';
-export const CUSTOM_ROUTE_AGRS_METADATA = '__customRouteArgs__';
-export const EXCEPTION_FILTERS_METADATA = '__exceptionFilters__';
+export const CUSTOM_ROUTE_ARGS_METADATA = '__customRouteArgs__';
 export const FILTER_CATCH_EXCEPTIONS = '__filterCatchExceptions__';
+
 export const PIPES_METADATA = '__pipes__';
 export const GUARDS_METADATA = '__guards__';
-export const RENDER_METADATA = '__renderTemplate__';
 export const INTERCEPTORS_METADATA = '__interceptors__';
+export const EXCEPTION_FILTERS_METADATA = '__exceptionFilters__';
+export const ENHANCER_KEY_TO_SUBTYPE_MAP = {
+  [GUARDS_METADATA]: 'guard',
+  [INTERCEPTORS_METADATA]: 'interceptor',
+  [PIPES_METADATA]: 'pipe',
+  [EXCEPTION_FILTERS_METADATA]: 'filter',
+} as const;
+
+export type EnhancerSubtype =
+  (typeof ENHANCER_KEY_TO_SUBTYPE_MAP)[keyof typeof ENHANCER_KEY_TO_SUBTYPE_MAP];
+
+export const RENDER_METADATA = '__renderTemplate__';
 export const HTTP_CODE_METADATA = '__httpCode__';
 export const MODULE_PATH = '__module_path__';
 export const HEADERS_METADATA = '__headers__';
@@ -32,3 +44,4 @@ export const VERSION_METADATA = '__version__';
 export const INJECTABLE_WATERMARK = '__injectable__';
 export const CONTROLLER_WATERMARK = '__controller__';
 export const CATCH_WATERMARK = '__catch__';
+export const ENTRY_PROVIDER_WATERMARK = '__entryProvider__';
diff --git a/packages/common/decorators/core/apply-decorators.ts b/packages/common/decorators/core/apply-decorators.ts
index 0d8a22219..bc898c495 100644
--- a/packages/common/decorators/core/apply-decorators.ts
+++ b/packages/common/decorators/core/apply-decorators.ts
@@ -22,8 +22,8 @@ export function applyDecorators(
       }
       (decorator as MethodDecorator | PropertyDecorator)(
         target,
-        propertyKey,
-        descriptor,
+        propertyKey!,
+        descriptor!,
       );
     }
   };
diff --git a/packages/common/decorators/core/catch.decorator.ts b/packages/common/decorators/core/catch.decorator.ts
index fbf7fb698..cd3cdb161 100644
--- a/packages/common/decorators/core/catch.decorator.ts
+++ b/packages/common/decorators/core/catch.decorator.ts
@@ -1,5 +1,5 @@
 import { CATCH_WATERMARK, FILTER_CATCH_EXCEPTIONS } from '../../constants';
-import { Type } from '../../interfaces';
+import { Type, Abstract } from '../../interfaces';
 
 /**
  * Decorator that marks a class as a Nest exception filter. An exception filter
@@ -18,7 +18,9 @@ import { Type } from '../../interfaces';
  *
  * @publicApi
  */
-export function Catch(...exceptions: Type<any>[]): ClassDecorator {
+export function Catch(
+  ...exceptions: Array<Type<any> | Abstract<any>>
+): ClassDecorator {
   return (target: object) => {
     Reflect.defineMetadata(CATCH_WATERMARK, true, target);
     Reflect.defineMetadata(FILTER_CATCH_EXCEPTIONS, exceptions, target);
diff --git a/packages/common/decorators/core/controller.decorator.ts b/packages/common/decorators/core/controller.decorator.ts
index b20c4a741..b89dd6454 100644
--- a/packages/common/decorators/core/controller.decorator.ts
+++ b/packages/common/decorators/core/controller.decorator.ts
@@ -5,8 +5,7 @@ import {
   SCOPE_OPTIONS_METADATA,
   VERSION_METADATA,
 } from '../../constants';
-import { ScopeOptions } from '../../interfaces/scope-options.interface';
-import { VersionOptions } from '../../interfaces/version-options.interface';
+import { ScopeOptions, VersionOptions } from '../../interfaces';
 import { isString, isUndefined } from '../../utils/shared.utils';
 
 /**
@@ -70,7 +69,7 @@ export function Controller(): ClassDecorator;
  * It defines a class that provides a context for one or more message or event
  * handlers.
  *
- * @param {string, Array} prefix string that defines a `route path prefix`.  The prefix
+ * @param {string|Array} prefix string that defines a `route path prefix`.  The prefix
  * is pre-pended to the path specified in any request decorator in the class.
  *
  * @see [Routing](https://docs.nestjs.com/controllers#routing)
@@ -159,15 +158,15 @@ export function Controller(
   )
     ? [defaultPath, undefined, undefined, undefined]
     : isString(prefixOrOptions) || Array.isArray(prefixOrOptions)
-    ? [prefixOrOptions, undefined, undefined, undefined]
-    : [
-        prefixOrOptions.path || defaultPath,
-        prefixOrOptions.host,
-        { scope: prefixOrOptions.scope },
-        Array.isArray(prefixOrOptions.version)
-          ? Array.from(new Set(prefixOrOptions.version))
-          : prefixOrOptions.version,
-      ];
+      ? [prefixOrOptions, undefined, undefined, undefined]
+      : [
+          prefixOrOptions.path || defaultPath,
+          prefixOrOptions.host,
+          { scope: prefixOrOptions.scope, durable: prefixOrOptions.durable },
+          Array.isArray(prefixOrOptions.version)
+            ? Array.from(new Set(prefixOrOptions.version))
+            : prefixOrOptions.version,
+        ];
 
   return (target: object) => {
     Reflect.defineMetadata(CONTROLLER_WATERMARK, true, target);
diff --git a/packages/common/decorators/core/dependencies.decorator.ts b/packages/common/decorators/core/dependencies.decorator.ts
index 984269524..99a60008c 100644
--- a/packages/common/decorators/core/dependencies.decorator.ts
+++ b/packages/common/decorators/core/dependencies.decorator.ts
@@ -3,12 +3,14 @@ import { PARAMTYPES_METADATA } from '../../constants';
 export function flatten<T extends Array<unknown> = any>(
   arr: T,
 ): T extends Array<infer R> ? R : never {
-  const flat = [].concat(...arr);
+  const flat = ([] as any[]).concat(...arr);
   return flat.some(Array.isArray) ? flatten(flat) : flat;
 }
 
 /**
  * Decorator that sets required dependencies (required with a vanilla JavaScript objects)
+ *
+ * @publicApi
  */
 export const Dependencies = (
   ...dependencies: Array<unknown>
diff --git a/packages/common/decorators/core/exception-filters.decorator.ts b/packages/common/decorators/core/exception-filters.decorator.ts
index cf730f84c..27bc387b9 100644
--- a/packages/common/decorators/core/exception-filters.decorator.ts
+++ b/packages/common/decorators/core/exception-filters.decorator.ts
@@ -1,4 +1,3 @@
-/* eslint-disable @typescript-eslint/no-use-before-define */
 import { EXCEPTION_FILTERS_METADATA } from '../../constants';
 import { ExceptionFilter } from '../../index';
 import { extendArrayMetadata } from '../../utils/extend-metadata.util';
@@ -40,9 +39,7 @@ function addExceptionFiltersMetadata(
   ) => {
     const isFilterValid = <T extends Function | Record<string, any>>(
       filter: T,
-    ) =>
-      filter &&
-      (isFunction(filter) || isFunction((filter as Record<string, any>).catch));
+    ) => filter && (isFunction(filter) || isFunction(filter.catch));
 
     if (descriptor) {
       validateEach(
diff --git a/packages/common/decorators/core/inject.decorator.ts b/packages/common/decorators/core/inject.decorator.ts
index 471c77c08..f8bedbd63 100644
--- a/packages/common/decorators/core/inject.decorator.ts
+++ b/packages/common/decorators/core/inject.decorator.ts
@@ -1,7 +1,9 @@
 import {
+  PARAMTYPES_METADATA,
   PROPERTY_DEPS_METADATA,
   SELF_DECLARED_DEPS_METADATA,
 } from '../../constants';
+import { ForwardReference, InjectionToken } from '../../interfaces';
 import { isUndefined } from '../../utils/shared.utils';
 
 /**
@@ -33,9 +35,17 @@ import { isUndefined } from '../../utils/shared.utils';
  *
  * @publicApi
  */
-export function Inject<T = any>(token?: T) {
-  return (target: object, key: string | symbol, index?: number) => {
-    const type = token || Reflect.getMetadata('design:type', target, key);
+export function Inject(
+  token?: InjectionToken | ForwardReference,
+): PropertyDecorator & ParameterDecorator {
+  const injectCallHasArguments = arguments.length > 0;
+
+  return (target: object, key: string | symbol | undefined, index?: number) => {
+    let type = token || Reflect.getMetadata('design:type', target, key!);
+    // Try to infer the token in a constructor-based injection
+    if (!type && !injectCallHasArguments) {
+      type = Reflect.getMetadata(PARAMTYPES_METADATA, target, key!)?.[index!];
+    }
 
     if (!isUndefined(index)) {
       let dependencies =
diff --git a/packages/common/decorators/core/injectable.decorator.ts b/packages/common/decorators/core/injectable.decorator.ts
index 453e7666f..ff7ae143c 100644
--- a/packages/common/decorators/core/injectable.decorator.ts
+++ b/packages/common/decorators/core/injectable.decorator.ts
@@ -1,4 +1,4 @@
-import { v4 as uuid } from 'uuid';
+import { uid } from 'uid';
 import { INJECTABLE_WATERMARK, SCOPE_OPTIONS_METADATA } from '../../constants';
 import { ScopeOptions } from '../../interfaces/scope-options.interface';
 import { Type } from '../../interfaces/type.interface';
@@ -47,9 +47,12 @@ export function Injectable(options?: InjectableOptions): ClassDecorator {
   };
 }
 
+/**
+ * @publicApi
+ */
 export function mixin<T>(mixinClass: Type<T>) {
   Object.defineProperty(mixinClass, 'name', {
-    value: uuid(),
+    value: uid(21),
   });
   Injectable()(mixinClass);
   return mixinClass;
diff --git a/packages/common/decorators/core/optional.decorator.ts b/packages/common/decorators/core/optional.decorator.ts
index 49d80eec1..0d94c20f0 100644
--- a/packages/common/decorators/core/optional.decorator.ts
+++ b/packages/common/decorators/core/optional.decorator.ts
@@ -17,8 +17,8 @@ import { isUndefined } from '../../utils/shared.utils';
  *
  * @publicApi
  */
-export function Optional() {
-  return (target: object, key: string | symbol, index?: number) => {
+export function Optional(): PropertyDecorator & ParameterDecorator {
+  return (target: object, key: string | symbol | undefined, index?: number) => {
     if (!isUndefined(index)) {
       const args = Reflect.getMetadata(OPTIONAL_DEPS_METADATA, target) || [];
       Reflect.defineMetadata(OPTIONAL_DEPS_METADATA, [...args, index], target);
diff --git a/packages/common/decorators/core/set-metadata.decorator.ts b/packages/common/decorators/core/set-metadata.decorator.ts
index be6b38d76..013807d8d 100644
--- a/packages/common/decorators/core/set-metadata.decorator.ts
+++ b/packages/common/decorators/core/set-metadata.decorator.ts
@@ -15,7 +15,7 @@ export type CustomDecorator<TKey = string> = MethodDecorator &
  *
  * Example: `@SetMetadata('roles', ['admin'])`
  *
- * @see [Reflection](https://docs.nestjs.com/guards#reflection)
+ * @see [Reflection](https://docs.nestjs.com/fundamentals/execution-context#reflection-and-metadata)
  *
  * @publicApi
  */
diff --git a/packages/common/decorators/core/use-guards.decorator.ts b/packages/common/decorators/core/use-guards.decorator.ts
index 0e2bde1b4..c3fb7cd2f 100644
--- a/packages/common/decorators/core/use-guards.decorator.ts
+++ b/packages/common/decorators/core/use-guards.decorator.ts
@@ -34,9 +34,7 @@ export function UseGuards(
     descriptor?: TypedPropertyDescriptor<any>,
   ) => {
     const isGuardValid = <T extends Function | Record<string, any>>(guard: T) =>
-      guard &&
-      (isFunction(guard) ||
-        isFunction((guard as Record<string, any>).canActivate));
+      guard && (isFunction(guard) || isFunction(guard.canActivate));
 
     if (descriptor) {
       validateEach(
diff --git a/packages/common/decorators/core/use-interceptors.decorator.ts b/packages/common/decorators/core/use-interceptors.decorator.ts
index 9923bc34c..474c47a6d 100644
--- a/packages/common/decorators/core/use-interceptors.decorator.ts
+++ b/packages/common/decorators/core/use-interceptors.decorator.ts
@@ -37,8 +37,7 @@ export function UseInterceptors(
       interceptor: T,
     ) =>
       interceptor &&
-      (isFunction(interceptor) ||
-        isFunction((interceptor as Record<string, any>).intercept));
+      (isFunction(interceptor) || isFunction(interceptor.intercept));
 
     if (descriptor) {
       validateEach(
diff --git a/packages/common/decorators/core/use-pipes.decorator.ts b/packages/common/decorators/core/use-pipes.decorator.ts
index 03a7bc08d..b9ead653f 100644
--- a/packages/common/decorators/core/use-pipes.decorator.ts
+++ b/packages/common/decorators/core/use-pipes.decorator.ts
@@ -35,8 +35,7 @@ export function UsePipes(
     descriptor?: TypedPropertyDescriptor<any>,
   ) => {
     const isPipeValid = <T extends Function | Record<string, any>>(pipe: T) =>
-      pipe &&
-      (isFunction(pipe) || isFunction((pipe as Record<string, any>).transform));
+      pipe && (isFunction(pipe) || isFunction(pipe.transform));
 
     if (descriptor) {
       extendArrayMetadata(PIPES_METADATA, pipes, descriptor.value);
diff --git a/packages/common/decorators/http/create-route-param-metadata.decorator.ts b/packages/common/decorators/http/create-route-param-metadata.decorator.ts
index f8582bf57..62f90b7f6 100644
--- a/packages/common/decorators/http/create-route-param-metadata.decorator.ts
+++ b/packages/common/decorators/http/create-route-param-metadata.decorator.ts
@@ -1,4 +1,4 @@
-import { v4 as uuid } from 'uuid';
+import { uid } from 'uid';
 import { ROUTE_ARGS_METADATA } from '../../constants';
 import { PipeTransform } from '../../index';
 import { Type } from '../../interfaces';
@@ -12,25 +12,25 @@ export type ParamDecoratorEnhancer = ParameterDecorator;
  * Defines HTTP route param decorator
  *
  * @param factory
+ * @param enhancers
+ *
+ * @publicApi
  */
-export function createParamDecorator<
-  FactoryData = any,
-  FactoryInput = any,
-  FactoryOutput = any,
->(
-  factory: CustomParamFactory<FactoryData, FactoryInput, FactoryOutput>,
+export function createParamDecorator<FactoryData = any, FactoryOutput = any>(
+  factory: CustomParamFactory<FactoryData, FactoryOutput>,
   enhancers: ParamDecoratorEnhancer[] = [],
 ): (
   ...dataOrPipes: (Type<PipeTransform> | PipeTransform | FactoryData)[]
 ) => ParameterDecorator {
-  const paramtype = uuid();
+  const paramtype = uid(21);
   return (
       data?,
       ...pipes: (Type<PipeTransform> | PipeTransform | FactoryData)[]
     ): ParameterDecorator =>
     (target, key, index) => {
       const args =
-        Reflect.getMetadata(ROUTE_ARGS_METADATA, target.constructor, key) || {};
+        Reflect.getMetadata(ROUTE_ARGS_METADATA, target.constructor, key!) ||
+        {};
 
       const isPipe = (pipe: any) =>
         pipe &&
@@ -54,7 +54,7 @@ export function createParamDecorator<
           ...(paramPipes as PipeTransform[]),
         ),
         target.constructor,
-        key,
+        key!,
       );
       enhancers.forEach(fn => fn(target, key, index));
     };
diff --git a/packages/common/decorators/http/header.decorator.ts b/packages/common/decorators/http/header.decorator.ts
index 316a58559..875ce8472 100644
--- a/packages/common/decorators/http/header.decorator.ts
+++ b/packages/common/decorators/http/header.decorator.ts
@@ -6,6 +6,7 @@ import { extendArrayMetadata } from '../../utils/extend-metadata.util';
  *
  * For example:
  * `@Header('Cache-Control', 'none')`
+ * `@Header('Cache-Control', () => 'none')`
  *
  * @param name string to be used for header name
  * @param value string to be used for header value
@@ -14,7 +15,10 @@ import { extendArrayMetadata } from '../../utils/extend-metadata.util';
  *
  * @publicApi
  */
-export function Header(name: string, value: string): MethodDecorator {
+export function Header(
+  name: string,
+  value: string | (() => string),
+): MethodDecorator {
   return (
     target: object,
     key: string | symbol,
diff --git a/packages/common/decorators/http/render.decorator.ts b/packages/common/decorators/http/render.decorator.ts
index 6e9f22a1c..92d2f8d20 100644
--- a/packages/common/decorators/http/render.decorator.ts
+++ b/packages/common/decorators/http/render.decorator.ts
@@ -7,7 +7,7 @@ import { RENDER_METADATA } from '../../constants';
  *
  * @param template name of the render engine template file
  *
- * @see [Model-View-Controller](https://docs.nestjs.com/techniques.mvc)
+ * @see [Model-View-Controller](https://docs.nestjs.com/techniques/mvc)
  *
  * @publicApi
  */
diff --git a/packages/common/decorators/http/request-mapping.decorator.ts b/packages/common/decorators/http/request-mapping.decorator.ts
index 46ebc0d8f..e707883cf 100644
--- a/packages/common/decorators/http/request-mapping.decorator.ts
+++ b/packages/common/decorators/http/request-mapping.decorator.ts
@@ -109,3 +109,75 @@ export const Head = createMappingDecorator(RequestMethod.HEAD);
  * @publicApi
  */
 export const All = createMappingDecorator(RequestMethod.ALL);
+
+/**
+ * Route handler (method) Decorator. Routes HTTP SEARCH requests to the specified path.
+ *
+ * @see [Routing](https://docs.nestjs.com/controllers#routing)
+ *
+ * @publicApi
+ */
+export const Search = createMappingDecorator(RequestMethod.SEARCH);
+
+/**
+ * Route handler (method) Decorator. Routes Webdav PROPFIND requests to the specified path.
+ *
+ * @see [Routing](https://docs.nestjs.com/controllers#routing)
+ *
+ * @publicApi
+ */
+export const Propfind = createMappingDecorator(RequestMethod.PROPFIND);
+
+/**
+ * Route handler (method) Decorator. Routes Webdav PROPPATCH requests to the specified path.
+ *
+ * @see [Routing](https://docs.nestjs.com/controllers#routing)
+ *
+ * @publicApi
+ */
+export const Proppatch = createMappingDecorator(RequestMethod.PROPPATCH);
+
+/**
+ * Route handler (method) Decorator. Routes Webdav MKCOL requests to the specified path.
+ *
+ * @see [Routing](https://docs.nestjs.com/controllers#routing)
+ *
+ * @publicApi
+ */
+export const Mkcol = createMappingDecorator(RequestMethod.MKCOL);
+
+/**
+ * Route handler (method) Decorator. Routes Webdav COPY requests to the specified path.
+ *
+ * @see [Routing](https://docs.nestjs.com/controllers#routing)
+ *
+ * @publicApi
+ */
+export const Copy = createMappingDecorator(RequestMethod.COPY);
+
+/**
+ * Route handler (method) Decorator. Routes Webdav MOVE requests to the specified path.
+ *
+ * @see [Routing](https://docs.nestjs.com/controllers#routing)
+ *
+ * @publicApi
+ */
+export const Move = createMappingDecorator(RequestMethod.MOVE);
+
+/**
+ * Route handler (method) Decorator. Routes Webdav LOCK requests to the specified path.
+ *
+ * @see [Routing](https://docs.nestjs.com/controllers#routing)
+ *
+ * @publicApi
+ */
+export const Lock = createMappingDecorator(RequestMethod.LOCK);
+
+/**
+ * Route handler (method) Decorator. Routes Webdav UNLOCK requests to the specified path.
+ *
+ * @see [Routing](https://docs.nestjs.com/controllers#routing)
+ *
+ * @publicApi
+ */
+export const Unlock = createMappingDecorator(RequestMethod.UNLOCK);
diff --git a/packages/common/decorators/http/route-params.decorator.ts b/packages/common/decorators/http/route-params.decorator.ts
index 778855918..76963ee7b 100644
--- a/packages/common/decorators/http/route-params.decorator.ts
+++ b/packages/common/decorators/http/route-params.decorator.ts
@@ -36,7 +36,7 @@ export function assignMetadata<TParamtype = any, TArgs = any>(
 ) {
   return {
     ...args,
-    [`${paramtype}:${index}`]: {
+    [`${paramtype as string}:${index}`]: {
       index,
       data,
       pipes,
@@ -48,7 +48,8 @@ function createRouteParamDecorator(paramtype: RouteParamtypes) {
   return (data?: ParamData): ParameterDecorator =>
     (target, key, index) => {
       const args =
-        Reflect.getMetadata(ROUTE_ARGS_METADATA, target.constructor, key) || {};
+        Reflect.getMetadata(ROUTE_ARGS_METADATA, target.constructor, key!) ||
+        {};
       Reflect.defineMetadata(
         ROUTE_ARGS_METADATA,
         assignMetadata<RouteParamtypes, Record<number, RouteParamMetadata>>(
@@ -58,7 +59,7 @@ function createRouteParamDecorator(paramtype: RouteParamtypes) {
           data,
         ),
         target.constructor,
-        key,
+        key!,
       );
     };
 }
@@ -71,16 +72,16 @@ const createPipesRouteParamDecorator =
   ): ParameterDecorator =>
   (target, key, index) => {
     const args =
-      Reflect.getMetadata(ROUTE_ARGS_METADATA, target.constructor, key) || {};
+      Reflect.getMetadata(ROUTE_ARGS_METADATA, target.constructor, key!) || {};
     const hasParamData = isNil(data) || isString(data);
     const paramData = hasParamData ? data : undefined;
     const paramPipes = hasParamData ? pipes : [data, ...pipes];
 
     Reflect.defineMetadata(
       ROUTE_ARGS_METADATA,
-      assignMetadata(args, paramtype, index, paramData, ...paramPipes),
+      assignMetadata(args, paramtype, index, paramData!, ...paramPipes),
       target.constructor,
-      key,
+      key!,
     );
   };
 
@@ -117,7 +118,7 @@ export const Response: (
         RESPONSE_PASSTHROUGH_METADATA,
         options?.passthrough,
         target.constructor,
-        key,
+        key!,
       );
     }
     return createRouteParamDecorator(RouteParamtypes.RESPONSE)()(
@@ -508,6 +509,53 @@ export function Body(
   );
 }
 
+/**
+ * Route handler parameter decorator. Extracts the `rawBody` Buffer
+ * property from the `req` object and populates the decorated parameter with that value.
+ *
+ * For example:
+ * ```typescript
+ * async create(@RawBody() rawBody: Buffer | undefined)
+ * ```
+ *
+ * @see [Request object](https://docs.nestjs.com/controllers#request-object)
+ * @see [Raw body](https://docs.nestjs.com/faq/raw-body)
+ *
+ * @publicApi
+ */
+export function RawBody(): ParameterDecorator;
+
+/**
+ * Route handler parameter decorator. Extracts the `rawBody` Buffer
+ * property from the `req` object and populates the decorated parameter with that value.
+ * Also applies pipes to the bound rawBody parameter.
+ *
+ * For example:
+ * ```typescript
+ * async create(@RawBody(new ValidationPipe()) rawBody: Buffer)
+ * ```
+ *
+ * @param pipes one or more pipes - either instances or classes - to apply to
+ * the bound body parameter.
+ *
+ * @see [Request object](https://docs.nestjs.com/controllers#request-object)
+ * @see [Raw body](https://docs.nestjs.com/faq/raw-body)
+ * @see [Working with pipes](https://docs.nestjs.com/custom-decorators#working-with-pipes)
+ *
+ * @publicApi
+ */
+export function RawBody(
+  ...pipes: (
+    | Type<PipeTransform<Buffer | undefined>>
+    | PipeTransform<Buffer | undefined>
+  )[]
+): ParameterDecorator {
+  return createPipesRouteParamDecorator(RouteParamtypes.RAW_BODY)(
+    undefined,
+    ...pipes,
+  );
+}
+
 /**
  * Route handler parameter decorator. Extracts the `params`
  * property from the `req` object and populates the decorated
diff --git a/packages/common/decorators/modules/module.decorator.ts b/packages/common/decorators/modules/module.decorator.ts
index c5df824d9..9ab617a64 100644
--- a/packages/common/decorators/modules/module.decorator.ts
+++ b/packages/common/decorators/modules/module.decorator.ts
@@ -5,7 +5,7 @@ import { validateModuleKeys } from '../../utils/validate-module-keys.util';
  * Decorator that marks a class as a [module](https://docs.nestjs.com/modules).
  *
  * Modules are used by Nest to organize the application structure into scopes. Controllers
- * and Providers are scoped by the module they are declared in.  Modules and their
+ * and Providers are scoped by the module they are declared in. Modules and their
  * classes (Controllers and Providers) form a graph that determines how Nest
  * performs [Dependency Injection (DI)](https://docs.nestjs.com/providers#dependency-injection).
  *
@@ -21,7 +21,7 @@ export function Module(metadata: ModuleMetadata): ClassDecorator {
 
   return (target: Function) => {
     for (const property in metadata) {
-      if (metadata.hasOwnProperty(property)) {
+      if (Object.hasOwnProperty.call(metadata, property)) {
         Reflect.defineMetadata(property, (metadata as any)[property], target);
       }
     }
diff --git a/packages/common/enums/http-status.enum.ts b/packages/common/enums/http-status.enum.ts
index 875597540..8d6da4526 100644
--- a/packages/common/enums/http-status.enum.ts
+++ b/packages/common/enums/http-status.enum.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export enum HttpStatus {
   CONTINUE = 100,
   SWITCHING_PROTOCOLS = 101,
@@ -10,6 +13,9 @@ export enum HttpStatus {
   NO_CONTENT = 204,
   RESET_CONTENT = 205,
   PARTIAL_CONTENT = 206,
+  MULTI_STATUS = 207,
+  ALREADY_REPORTED = 208,
+  CONTENT_DIFFERENT = 210,
   AMBIGUOUS = 300,
   MOVED_PERMANENTLY = 301,
   FOUND = 302,
@@ -38,13 +44,17 @@ export enum HttpStatus {
   I_AM_A_TEAPOT = 418,
   MISDIRECTED = 421,
   UNPROCESSABLE_ENTITY = 422,
+  LOCKED = 423,
   FAILED_DEPENDENCY = 424,
   PRECONDITION_REQUIRED = 428,
   TOO_MANY_REQUESTS = 429,
+  UNRECOVERABLE_ERROR = 456,
   INTERNAL_SERVER_ERROR = 500,
   NOT_IMPLEMENTED = 501,
   BAD_GATEWAY = 502,
   SERVICE_UNAVAILABLE = 503,
   GATEWAY_TIMEOUT = 504,
   HTTP_VERSION_NOT_SUPPORTED = 505,
+  INSUFFICIENT_STORAGE = 507,
+  LOOP_DETECTED = 508,
 }
diff --git a/packages/common/enums/request-method.enum.ts b/packages/common/enums/request-method.enum.ts
index d48f52b4d..9bd12a98c 100644
--- a/packages/common/enums/request-method.enum.ts
+++ b/packages/common/enums/request-method.enum.ts
@@ -7,4 +7,12 @@ export enum RequestMethod {
   ALL,
   OPTIONS,
   HEAD,
+  SEARCH,
+  PROPFIND,
+  PROPPATCH,
+  MKCOL,
+  COPY,
+  MOVE,
+  LOCK,
+  UNLOCK,
 }
diff --git a/packages/common/enums/route-paramtypes.enum.ts b/packages/common/enums/route-paramtypes.enum.ts
index 738532aef..ad6cf450f 100644
--- a/packages/common/enums/route-paramtypes.enum.ts
+++ b/packages/common/enums/route-paramtypes.enum.ts
@@ -1,14 +1,15 @@
 export enum RouteParamtypes {
-  REQUEST,
-  RESPONSE,
-  NEXT,
-  BODY,
-  QUERY,
-  PARAM,
-  HEADERS,
-  SESSION,
-  FILE,
-  FILES,
-  HOST,
-  IP,
+  REQUEST = 0,
+  RESPONSE = 1,
+  NEXT = 2,
+  BODY = 3,
+  QUERY = 4,
+  PARAM = 5,
+  HEADERS = 6,
+  SESSION = 7,
+  FILE = 8,
+  FILES = 9,
+  HOST = 10,
+  IP = 11,
+  RAW_BODY = 12,
 }
diff --git a/packages/common/enums/version-type.enum.ts b/packages/common/enums/version-type.enum.ts
index 981986e87..abe4c6416 100644
--- a/packages/common/enums/version-type.enum.ts
+++ b/packages/common/enums/version-type.enum.ts
@@ -5,4 +5,5 @@ export enum VersioningType {
   URI,
   HEADER,
   MEDIA_TYPE,
+  CUSTOM,
 }
diff --git a/packages/common/exceptions/bad-gateway.exception.ts b/packages/common/exceptions/bad-gateway.exception.ts
index 78667996c..5bb9cd156 100644
--- a/packages/common/exceptions/bad-gateway.exception.ts
+++ b/packages/common/exceptions/bad-gateway.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Bad Gateway* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class BadGatewayException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 502.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 502.
@@ -31,19 +31,23 @@ export class BadGatewayException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
-    objectOrError?: string | object | any,
-    description = 'Bad Gateway',
+    objectOrError?: any,
+    descriptionOrOptions: string | HttpExceptionOptions = 'Bad Gateway',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
-        description,
+        description!,
         HttpStatus.BAD_GATEWAY,
       ),
       HttpStatus.BAD_GATEWAY,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/bad-request.exception.ts b/packages/common/exceptions/bad-request.exception.ts
index b5385d09c..33ad6652b 100644
--- a/packages/common/exceptions/bad-request.exception.ts
+++ b/packages/common/exceptions/bad-request.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Bad Request* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class BadRequestException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 400.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 400.
@@ -31,19 +31,23 @@ export class BadRequestException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
-    objectOrError?: string | object | any,
-    description = 'Bad Request',
+    objectOrError?: any,
+    descriptionOrOptions: string | HttpExceptionOptions = 'Bad Request',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
-        description,
+        description!,
         HttpStatus.BAD_REQUEST,
       ),
       HttpStatus.BAD_REQUEST,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/conflict.exception.ts b/packages/common/exceptions/conflict.exception.ts
index d67cc30f4..27bdda8aa 100644
--- a/packages/common/exceptions/conflict.exception.ts
+++ b/packages/common/exceptions/conflict.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Conflict* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class ConflictException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 409.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 409.
@@ -31,12 +31,23 @@ export class ConflictException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
-  constructor(objectOrError?: string | object | any, description = 'Conflict') {
+  constructor(
+    objectOrError?: any,
+    descriptionOrOptions: string | HttpExceptionOptions = 'Conflict',
+  ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
-      HttpException.createBody(objectOrError, description, HttpStatus.CONFLICT),
+      HttpException.createBody(
+        objectOrError,
+        description!,
+        HttpStatus.CONFLICT,
+      ),
       HttpStatus.CONFLICT,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/forbidden.exception.ts b/packages/common/exceptions/forbidden.exception.ts
index 7c3ae92fb..f04b86bca 100644
--- a/packages/common/exceptions/forbidden.exception.ts
+++ b/packages/common/exceptions/forbidden.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Forbidden* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class ForbiddenException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 403.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 403.
@@ -31,19 +31,23 @@ export class ForbiddenException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
-    objectOrError?: string | object | any,
-    description = 'Forbidden',
+    objectOrError?: any,
+    descriptionOrOptions: string | HttpExceptionOptions = 'Forbidden',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
-        description,
+        description!,
         HttpStatus.FORBIDDEN,
       ),
       HttpStatus.FORBIDDEN,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/gateway-timeout.exception.ts b/packages/common/exceptions/gateway-timeout.exception.ts
index 2648ddfec..49dee4938 100644
--- a/packages/common/exceptions/gateway-timeout.exception.ts
+++ b/packages/common/exceptions/gateway-timeout.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Gateway Timeout* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class GatewayTimeoutException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 504.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 504.
@@ -31,19 +31,23 @@ export class GatewayTimeoutException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
-    objectOrError?: string | object | any,
-    description = 'Gateway Timeout',
+    objectOrError?: any,
+    descriptionOrOptions: string | HttpExceptionOptions = 'Gateway Timeout',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
-        description,
+        description!,
         HttpStatus.GATEWAY_TIMEOUT,
       ),
       HttpStatus.GATEWAY_TIMEOUT,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/gone.exception.ts b/packages/common/exceptions/gone.exception.ts
index 48b141dfe..b1fc0f65b 100644
--- a/packages/common/exceptions/gone.exception.ts
+++ b/packages/common/exceptions/gone.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Gone* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class GoneException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 410.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 410.
@@ -31,12 +31,19 @@ export class GoneException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
-  constructor(objectOrError?: string | object | any, description = 'Gone') {
+  constructor(
+    objectOrError?: any,
+    descriptionOrOptions: string | HttpExceptionOptions = 'Gone',
+  ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
-      HttpException.createBody(objectOrError, description, HttpStatus.GONE),
+      HttpException.createBody(objectOrError, description!, HttpStatus.GONE),
       HttpStatus.GONE,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/http-version-not-supported.exception.ts b/packages/common/exceptions/http-version-not-supported.exception.ts
index 41b340291..23283d343 100644
--- a/packages/common/exceptions/http-version-not-supported.exception.ts
+++ b/packages/common/exceptions/http-version-not-supported.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Http Version Not Supported* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class HttpVersionNotSupportedException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 505.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 505.
@@ -31,19 +31,25 @@ export class HttpVersionNotSupportedException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
-    objectOrError?: string | object | any,
-    description = 'HTTP Version Not Supported',
+    objectOrError?: any,
+    descriptionOrOptions:
+      | string
+      | HttpExceptionOptions = 'HTTP Version Not Supported',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
-        description,
+        description!,
         HttpStatus.HTTP_VERSION_NOT_SUPPORTED,
       ),
       HttpStatus.HTTP_VERSION_NOT_SUPPORTED,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/http.exception.ts b/packages/common/exceptions/http.exception.ts
index e907834c8..8b21b9a39 100644
--- a/packages/common/exceptions/http.exception.ts
+++ b/packages/common/exceptions/http.exception.ts
@@ -1,24 +1,53 @@
-import { isObject, isString } from '../utils/shared.utils';
+import {
+  HttpExceptionBody,
+  HttpExceptionBodyMessage,
+} from '../interfaces/http/http-exception-body.interface';
+import { isNumber, isObject, isString } from '../utils/shared.utils';
+import { IntrinsicException } from './intrinsic.exception';
+
+export interface HttpExceptionOptions {
+  /** original cause of the error */
+  cause?: unknown;
+  description?: string;
+}
+
+export interface DescriptionAndOptions {
+  description?: string;
+  httpExceptionOptions?: HttpExceptionOptions;
+}
 
 /**
  * Defines the base Nest HTTP exception, which is handled by the default
  * Exceptions Handler.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
-export class HttpException extends Error {
+export class HttpException extends IntrinsicException {
+  /**
+   * Exception cause. Indicates the specific original cause of the error.
+   * It is used when catching and re-throwing an error with a more-specific or useful error message in order to still have access to the original error.
+   */
+  public cause: unknown;
+
   /**
    * Instantiate a plain HTTP Exception.
    *
    * @example
-   * `throw new HttpException()`
+   * throw new HttpException('message', HttpStatus.BAD_REQUEST)
+   * throw new HttpException('custom message', HttpStatus.BAD_REQUEST, {
+   *  cause: new Error('Cause Error'),
+   * })
+   *
    *
    * @usageNotes
    * The constructor arguments define the response and the HTTP response status code.
-   * - The `response` argument (required) defines the JSON response body.
+   * - The `response` argument (required) defines the JSON response body. alternatively, it can also be
+   *  an error object that is used to define an error [cause](https://nodejs.org/en/blog/release/v16.9.0/#error-cause).
    * - The `status` argument (required) defines the HTTP Status Code.
+   * - The `options` argument (optional) defines additional error options. Currently, it supports the `cause` attribute,
+   *  and can be used as an alternative way to specify the error cause: `const error = new HttpException('description', 400, { cause: new Error() });`
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: the Http Status Code.
@@ -31,30 +60,43 @@ export class HttpException extends Error {
    * The `status` argument is required, and should be a valid HTTP status code.
    * Best practice is to use the `HttpStatus` enum imported from `nestjs/common`.
    *
-   * @param response string or object describing the error condition.
+   * @param response string, object describing the error condition or the error cause.
    * @param status HTTP response status code.
+   * @param options An object used to add an error cause.
    */
   constructor(
     private readonly response: string | Record<string, any>,
     private readonly status: number,
+    private readonly options?: HttpExceptionOptions,
   ) {
     super();
     this.initMessage();
     this.initName();
+    this.initCause();
+  }
+
+  /**
+   * Configures error chaining support
+   *
+   * @see https://nodejs.org/en/blog/release/v16.9.0/#error-cause
+   * @see https://github.com/microsoft/TypeScript/issues/45167
+   */
+  public initCause(): void {
+    if (this.options?.cause) {
+      this.cause = this.options.cause;
+      return;
+    }
   }
 
   public initMessage() {
     if (isString(this.response)) {
       this.message = this.response;
-    } else if (
-      isObject(this.response) &&
-      isString((this.response as Record<string, any>).message)
-    ) {
-      this.message = (this.response as Record<string, any>).message;
+    } else if (isObject(this.response) && isString(this.response.message)) {
+      this.message = this.response.message;
     } else if (this.constructor) {
-      this.message = this.constructor.name
-        .match(/[A-Z][a-z]+|[0-9]+/g)
-        .join(' ');
+      this.message =
+        this.constructor.name.match(/[A-Z][a-z]+|[0-9]+/g)?.join(' ') ??
+        'Error';
     }
   }
 
@@ -71,15 +113,74 @@ export class HttpException extends Error {
   }
 
   public static createBody(
-    objectOrError: object | string,
-    description?: string,
+    nil: null | '',
+    message: HttpExceptionBodyMessage,
+    statusCode: number,
+  ): HttpExceptionBody;
+  public static createBody(
+    message: HttpExceptionBodyMessage,
+    error: string,
+    statusCode: number,
+  ): HttpExceptionBody;
+  public static createBody<Body extends Record<string, unknown>>(
+    custom: Body,
+  ): Body;
+  public static createBody<Body extends Record<string, unknown>>(
+    arg0: null | HttpExceptionBodyMessage | Body,
+    arg1?: HttpExceptionBodyMessage | string,
     statusCode?: number,
-  ) {
-    if (!objectOrError) {
-      return { statusCode, message: description };
+  ): HttpExceptionBody | Body {
+    if (!arg0) {
+      return {
+        message: arg1!,
+        statusCode: statusCode!,
+      };
+    }
+
+    if (isString(arg0) || Array.isArray(arg0) || isNumber(arg0)) {
+      return {
+        message: arg0,
+        error: arg1 as string,
+        statusCode: statusCode!,
+      };
     }
-    return isObject(objectOrError) && !Array.isArray(objectOrError)
-      ? objectOrError
-      : { statusCode, message: objectOrError, error: description };
+
+    return arg0;
+  }
+
+  public static getDescriptionFrom(
+    descriptionOrOptions: string | HttpExceptionOptions,
+  ): string {
+    return isString(descriptionOrOptions)
+      ? descriptionOrOptions
+      : (descriptionOrOptions?.description as string);
+  }
+
+  public static getHttpExceptionOptionsFrom(
+    descriptionOrOptions: string | HttpExceptionOptions,
+  ): HttpExceptionOptions {
+    return isString(descriptionOrOptions) ? {} : descriptionOrOptions;
+  }
+
+  /**
+   * Utility method used to extract the error description and httpExceptionOptions from the given argument.
+   * This is used by inheriting classes to correctly parse both options.
+   * @returns the error description and the httpExceptionOptions as an object.
+   */
+  public static extractDescriptionAndOptionsFrom(
+    descriptionOrOptions: string | HttpExceptionOptions,
+  ): DescriptionAndOptions {
+    const description = isString(descriptionOrOptions)
+      ? descriptionOrOptions
+      : descriptionOrOptions?.description;
+
+    const httpExceptionOptions = isString(descriptionOrOptions)
+      ? {}
+      : descriptionOrOptions;
+
+    return {
+      description,
+      httpExceptionOptions,
+    };
   }
 }
diff --git a/packages/common/exceptions/im-a-teapot.exception.ts b/packages/common/exceptions/im-a-teapot.exception.ts
index db640cd90..209e32c43 100644
--- a/packages/common/exceptions/im-a-teapot.exception.ts
+++ b/packages/common/exceptions/im-a-teapot.exception.ts
@@ -1,5 +1,5 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *ImATeapotException* type errors.
@@ -7,7 +7,7 @@ import { HttpException } from './http.exception';
  * Any attempt to brew coffee with a teapot should result in the error code
  * "418 I'm a teapot". The resulting entity body MAY be short and stout.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -21,7 +21,7 @@ export class ImATeapotException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 418.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 418.
@@ -34,19 +34,23 @@ export class ImATeapotException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
-    objectOrError?: string | object | any,
-    description = `I'm a teapot`,
+    objectOrError?: any,
+    descriptionOrOptions: string | HttpExceptionOptions = `I'm a teapot`,
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
-        description,
+        description!,
         HttpStatus.I_AM_A_TEAPOT,
       ),
       HttpStatus.I_AM_A_TEAPOT,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/index.ts b/packages/common/exceptions/index.ts
index ab2a948b1..554218336 100644
--- a/packages/common/exceptions/index.ts
+++ b/packages/common/exceptions/index.ts
@@ -1,22 +1,23 @@
+export * from './bad-gateway.exception';
 export * from './bad-request.exception';
-export * from './http.exception';
-export * from './unauthorized.exception';
-export * from './method-not-allowed.exception';
-export * from './not-found.exception';
-export * from './forbidden.exception';
-export * from './not-acceptable.exception';
-export * from './request-timeout.exception';
 export * from './conflict.exception';
+export * from './forbidden.exception';
+export * from './gateway-timeout.exception';
 export * from './gone.exception';
-export * from './payload-too-large.exception';
-export * from './unsupported-media-type.exception';
-export * from './unprocessable-entity.exception';
-export * from './internal-server-error.exception';
-export * from './not-implemented.exception';
 export * from './http-version-not-supported.exception';
-export * from './bad-gateway.exception';
-export * from './service-unavailable.exception';
-export * from './gateway-timeout.exception';
+export * from './http.exception';
 export * from './im-a-teapot.exception';
-export * from './precondition-failed.exception';
+export * from './internal-server-error.exception';
+export * from './intrinsic.exception';
+export * from './method-not-allowed.exception';
 export * from './misdirected.exception';
+export * from './not-acceptable.exception';
+export * from './not-found.exception';
+export * from './not-implemented.exception';
+export * from './payload-too-large.exception';
+export * from './precondition-failed.exception';
+export * from './request-timeout.exception';
+export * from './service-unavailable.exception';
+export * from './unauthorized.exception';
+export * from './unprocessable-entity.exception';
+export * from './unsupported-media-type.exception';
diff --git a/packages/common/exceptions/internal-server-error.exception.ts b/packages/common/exceptions/internal-server-error.exception.ts
index 06a04d7d8..f8955b86a 100644
--- a/packages/common/exceptions/internal-server-error.exception.ts
+++ b/packages/common/exceptions/internal-server-error.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Internal Server Error* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class InternalServerErrorException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 500.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 500.
@@ -31,19 +31,25 @@ export class InternalServerErrorException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
-    objectOrError?: string | object | any,
-    description = 'Internal Server Error',
+    objectOrError?: any,
+    descriptionOrOptions:
+      | string
+      | HttpExceptionOptions = 'Internal Server Error',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
-        description,
+        description!,
         HttpStatus.INTERNAL_SERVER_ERROR,
       ),
       HttpStatus.INTERNAL_SERVER_ERROR,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/intrinsic.exception.ts b/packages/common/exceptions/intrinsic.exception.ts
new file mode 100644
index 000000000..cb09b8e61
--- /dev/null
+++ b/packages/common/exceptions/intrinsic.exception.ts
@@ -0,0 +1,7 @@
+/**
+ * Exception that represents an intrinsic error in the application.
+ * When thrown, the default exception filter will not log the error message.
+ *
+ * @publicApi
+ */
+export class IntrinsicException extends Error {}
diff --git a/packages/common/exceptions/method-not-allowed.exception.ts b/packages/common/exceptions/method-not-allowed.exception.ts
index df7666b00..e6db6198c 100644
--- a/packages/common/exceptions/method-not-allowed.exception.ts
+++ b/packages/common/exceptions/method-not-allowed.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Method Not Allowed* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class MethodNotAllowedException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 405.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 405.
@@ -31,19 +31,23 @@ export class MethodNotAllowedException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
-    objectOrError?: string | object | any,
-    description = 'Method Not Allowed',
+    objectOrError?: any,
+    descriptionOrOptions: string | HttpExceptionOptions = 'Method Not Allowed',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
-        description,
+        description!,
         HttpStatus.METHOD_NOT_ALLOWED,
       ),
       HttpStatus.METHOD_NOT_ALLOWED,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/misdirected.exception.ts b/packages/common/exceptions/misdirected.exception.ts
index 11ae29bae..4ff86459f 100644
--- a/packages/common/exceptions/misdirected.exception.ts
+++ b/packages/common/exceptions/misdirected.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Misdirected* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class MisdirectedException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 421.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 421.
@@ -31,19 +31,23 @@ export class MisdirectedException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
-    objectOrError?: string | object | any,
-    description = 'Misdirected',
+    objectOrError?: any,
+    descriptionOrOptions: string | HttpExceptionOptions = 'Misdirected',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
-        description,
+        description!,
         HttpStatus.MISDIRECTED,
       ),
       HttpStatus.MISDIRECTED,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/not-acceptable.exception.ts b/packages/common/exceptions/not-acceptable.exception.ts
index e836d3447..8b3cf66a0 100644
--- a/packages/common/exceptions/not-acceptable.exception.ts
+++ b/packages/common/exceptions/not-acceptable.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Not Acceptable* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class NotAcceptableException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 406.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 406.
@@ -31,19 +31,23 @@ export class NotAcceptableException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
-    objectOrError?: string | object | any,
-    description = 'Not Acceptable',
+    objectOrError?: any,
+    descriptionOrOptions: string | HttpExceptionOptions = 'Not Acceptable',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
-        description,
+        description!,
         HttpStatus.NOT_ACCEPTABLE,
       ),
       HttpStatus.NOT_ACCEPTABLE,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/not-found.exception.ts b/packages/common/exceptions/not-found.exception.ts
index d8c38ca7f..1213e8dca 100644
--- a/packages/common/exceptions/not-found.exception.ts
+++ b/packages/common/exceptions/not-found.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Not Found* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class NotFoundException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 404.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 404.
@@ -31,19 +31,23 @@ export class NotFoundException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
-    objectOrError?: string | object | any,
-    description = 'Not Found',
+    objectOrError?: any,
+    descriptionOrOptions: string | HttpExceptionOptions = 'Not Found',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
-        description,
+        description!,
         HttpStatus.NOT_FOUND,
       ),
       HttpStatus.NOT_FOUND,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/not-implemented.exception.ts b/packages/common/exceptions/not-implemented.exception.ts
index 4702fe384..206a87333 100644
--- a/packages/common/exceptions/not-implemented.exception.ts
+++ b/packages/common/exceptions/not-implemented.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Not Implemented* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class NotImplementedException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 501.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 501.
@@ -30,20 +30,24 @@ export class NotImplementedException extends HttpException {
    * entire JSON response body, pass an object instead. Nest will serialize the object
    * and return it as the JSON response body.
    *
-   * @param description string or object describing the error condition.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    * @param error a short description of the HTTP error.
    */
   constructor(
-    objectOrError?: string | object | any,
-    description = 'Not Implemented',
+    objectOrError?: any,
+    descriptionOrOptions: string | HttpExceptionOptions = 'Not Implemented',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
-        description,
+        description!,
         HttpStatus.NOT_IMPLEMENTED,
       ),
       HttpStatus.NOT_IMPLEMENTED,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/payload-too-large.exception.ts b/packages/common/exceptions/payload-too-large.exception.ts
index 968b94d3f..4e841a359 100644
--- a/packages/common/exceptions/payload-too-large.exception.ts
+++ b/packages/common/exceptions/payload-too-large.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Payload Too Large* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class PayloadTooLargeException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 413.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 413.
@@ -31,19 +31,23 @@ export class PayloadTooLargeException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
-    objectOrError?: string | object | any,
-    description = 'Payload Too Large',
+    objectOrError?: any,
+    descriptionOrOptions: string | HttpExceptionOptions = 'Payload Too Large',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
-        description,
+        description!,
         HttpStatus.PAYLOAD_TOO_LARGE,
       ),
       HttpStatus.PAYLOAD_TOO_LARGE,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/precondition-failed.exception.ts b/packages/common/exceptions/precondition-failed.exception.ts
index ca9c3a70d..68c3433c7 100644
--- a/packages/common/exceptions/precondition-failed.exception.ts
+++ b/packages/common/exceptions/precondition-failed.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Precondition Failed* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class PreconditionFailedException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 412.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 412.
@@ -31,19 +31,23 @@ export class PreconditionFailedException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
-    objectOrError?: string | object | any,
-    description = 'Precondition Failed',
+    objectOrError?: any,
+    descriptionOrOptions: string | HttpExceptionOptions = 'Precondition Failed',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
-        description,
+        description!,
         HttpStatus.PRECONDITION_FAILED,
       ),
       HttpStatus.PRECONDITION_FAILED,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/request-timeout.exception.ts b/packages/common/exceptions/request-timeout.exception.ts
index 3bcd193ce..f4f6d7955 100644
--- a/packages/common/exceptions/request-timeout.exception.ts
+++ b/packages/common/exceptions/request-timeout.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Request Timeout* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class RequestTimeoutException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 408.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 408.
@@ -31,19 +31,23 @@ export class RequestTimeoutException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
-    objectOrError?: string | object | any,
-    description = 'Request Timeout',
+    objectOrError?: any,
+    descriptionOrOptions: string | HttpExceptionOptions = 'Request Timeout',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
-        description,
+        description!,
         HttpStatus.REQUEST_TIMEOUT,
       ),
       HttpStatus.REQUEST_TIMEOUT,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/service-unavailable.exception.ts b/packages/common/exceptions/service-unavailable.exception.ts
index f0270b7e6..0afca4bdd 100644
--- a/packages/common/exceptions/service-unavailable.exception.ts
+++ b/packages/common/exceptions/service-unavailable.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Service Unavailable* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class ServiceUnavailableException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 503.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 503.
@@ -31,19 +31,23 @@ export class ServiceUnavailableException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
-    objectOrError?: string | object | any,
-    description = 'Service Unavailable',
+    objectOrError?: any,
+    descriptionOrOptions: string | HttpExceptionOptions = 'Service Unavailable',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
-        description,
+        description!,
         HttpStatus.SERVICE_UNAVAILABLE,
       ),
       HttpStatus.SERVICE_UNAVAILABLE,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/unauthorized.exception.ts b/packages/common/exceptions/unauthorized.exception.ts
index 7d9379816..c5be32253 100644
--- a/packages/common/exceptions/unauthorized.exception.ts
+++ b/packages/common/exceptions/unauthorized.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Unauthorized* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class UnauthorizedException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 401.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 401.
@@ -31,19 +31,23 @@ export class UnauthorizedException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
-    objectOrError?: string | object | any,
-    description = 'Unauthorized',
+    objectOrError?: any,
+    descriptionOrOptions: string | HttpExceptionOptions = 'Unauthorized',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
-        description,
+        description!,
         HttpStatus.UNAUTHORIZED,
       ),
       HttpStatus.UNAUTHORIZED,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/unprocessable-entity.exception.ts b/packages/common/exceptions/unprocessable-entity.exception.ts
index f76c8d24e..d6f99aa25 100644
--- a/packages/common/exceptions/unprocessable-entity.exception.ts
+++ b/packages/common/exceptions/unprocessable-entity.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Unprocessable Entity* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class UnprocessableEntityException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 422.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 422.
@@ -31,19 +31,25 @@ export class UnprocessableEntityException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
-    objectOrError?: string | object | any,
-    description = 'Unprocessable Entity',
+    objectOrError?: any,
+    descriptionOrOptions:
+      | string
+      | HttpExceptionOptions = 'Unprocessable Entity',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
-        description,
+        description!,
         HttpStatus.UNPROCESSABLE_ENTITY,
       ),
       HttpStatus.UNPROCESSABLE_ENTITY,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/unsupported-media-type.exception.ts b/packages/common/exceptions/unsupported-media-type.exception.ts
index 49e4ab14f..9d8af94af 100644
--- a/packages/common/exceptions/unsupported-media-type.exception.ts
+++ b/packages/common/exceptions/unsupported-media-type.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Unsupported Media Type* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class UnsupportedMediaTypeException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 415.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 415.
@@ -31,19 +31,25 @@ export class UnsupportedMediaTypeException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
-    objectOrError?: string | object | any,
-    description = 'Unsupported Media Type',
+    objectOrError?: any,
+    descriptionOrOptions:
+      | string
+      | HttpExceptionOptions = 'Unsupported Media Type',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
-        description,
+        description!,
         HttpStatus.UNSUPPORTED_MEDIA_TYPE,
       ),
       HttpStatus.UNSUPPORTED_MEDIA_TYPE,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/file-stream/interfaces/index.ts b/packages/common/file-stream/interfaces/index.ts
new file mode 100644
index 000000000..9be413e21
--- /dev/null
+++ b/packages/common/file-stream/interfaces/index.ts
@@ -0,0 +1,2 @@
+export * from './streamable-options.interface';
+export * from './streamable-handler-response.interface';
diff --git a/packages/common/file-stream/interfaces/streamable-handler-response.interface.ts b/packages/common/file-stream/interfaces/streamable-handler-response.interface.ts
new file mode 100644
index 000000000..c1c77a922
--- /dev/null
+++ b/packages/common/file-stream/interfaces/streamable-handler-response.interface.ts
@@ -0,0 +1,12 @@
+export interface StreamableHandlerResponse {
+  /** `true` if the connection is destroyed, `false` otherwise. */
+  destroyed: boolean;
+  /** `true` if headers were sent, `false` otherwise. */
+  headersSent: boolean;
+  /** The status code that will be sent to the client when the headers get flushed. */
+  statusCode: number;
+  /** Sends the HTTP response. */
+  send: (body: string) => void;
+  /** Signals to the server that all of the response headers and body have been sent. */
+  end: () => void;
+}
diff --git a/packages/common/file-stream/interfaces/streamable-options.interface.ts b/packages/common/file-stream/interfaces/streamable-options.interface.ts
new file mode 100644
index 000000000..fe6b698e4
--- /dev/null
+++ b/packages/common/file-stream/interfaces/streamable-options.interface.ts
@@ -0,0 +1,22 @@
+/**
+ * Options for `StreamableFile`
+ *
+ * @see [Streaming files](https://docs.nestjs.com/techniques/streaming-files)
+ *
+ * @publicApi
+ */
+export interface StreamableFileOptions {
+  /**
+   * The value that will be used for the `Content-Type` response header.
+   * @default `"application/octet-stream"`
+   */
+  type?: string;
+  /**
+   * The value that will be used for the `Content-Disposition` response header.
+   */
+  disposition?: string;
+  /**
+   * The value that will be used for the `Content-Length` response header.
+   */
+  length?: number;
+}
diff --git a/packages/common/file-stream/streamable-file.ts b/packages/common/file-stream/streamable-file.ts
index ded5958ab..6323ca065 100644
--- a/packages/common/file-stream/streamable-file.ts
+++ b/packages/common/file-stream/streamable-file.ts
@@ -1,20 +1,50 @@
 import { Readable } from 'stream';
+import { types } from 'util';
+import { HttpStatus } from '../enums';
+import { Logger } from '../services';
 import { isFunction } from '../utils/shared.utils';
-import { StreamableFileOptions } from './streamable-options.interface';
+import { StreamableFileOptions, StreamableHandlerResponse } from './interfaces';
 
+/**
+ * @see [Streaming files](https://docs.nestjs.com/techniques/streaming-files)
+ *
+ * @publicApi
+ */
 export class StreamableFile {
   private readonly stream: Readable;
+  protected logger = new Logger('StreamableFile');
 
-  constructor(buffer: Buffer, options?: StreamableFileOptions);
+  protected handleError: (
+    err: Error,
+    response: StreamableHandlerResponse,
+  ) => void = (err: Error, res) => {
+    if (res.destroyed) {
+      return;
+    }
+    if (res.headersSent) {
+      res.end();
+      return;
+    }
+
+    res.statusCode = HttpStatus.BAD_REQUEST;
+    res.send(err.message);
+  };
+
+  protected logError: (err: Error) => void = (err: Error) => {
+    this.logger.error(err);
+  };
+
+  constructor(buffer: Uint8Array, options?: StreamableFileOptions);
   constructor(readable: Readable, options?: StreamableFileOptions);
   constructor(
-    bufferOrReadStream: Buffer | Readable,
+    bufferOrReadStream: Uint8Array | Readable,
     readonly options: StreamableFileOptions = {},
   ) {
-    if (Buffer.isBuffer(bufferOrReadStream)) {
+    if (types.isUint8Array(bufferOrReadStream)) {
       this.stream = new Readable();
       this.stream.push(bufferOrReadStream);
       this.stream.push(null);
+      this.options.length ??= bufferOrReadStream.length;
     } else if (bufferOrReadStream.pipe && isFunction(bufferOrReadStream.pipe)) {
       this.stream = bufferOrReadStream;
     }
@@ -25,8 +55,38 @@ export class StreamableFile {
   }
 
   getHeaders() {
-    const { type = 'application/octet-stream', disposition = null } =
-      this.options;
-    return { type, disposition };
+    const {
+      type = 'application/octet-stream',
+      disposition = undefined,
+      length = undefined,
+    } = this.options;
+    return {
+      type,
+      disposition,
+      length,
+    };
+  }
+
+  get errorHandler(): (
+    err: Error,
+    response: StreamableHandlerResponse,
+  ) => void {
+    return this.handleError;
+  }
+
+  setErrorHandler(
+    handler: (err: Error, response: StreamableHandlerResponse) => void,
+  ) {
+    this.handleError = handler;
+    return this;
+  }
+
+  get errorLogger() {
+    return this.logError;
+  }
+
+  setErrorLogger(handler: (err: Error) => void) {
+    this.logError = handler;
+    return this;
   }
 }
diff --git a/packages/common/file-stream/streamable-options.interface.ts b/packages/common/file-stream/streamable-options.interface.ts
deleted file mode 100644
index 4b7bbee4e..000000000
--- a/packages/common/file-stream/streamable-options.interface.ts
+++ /dev/null
@@ -1,4 +0,0 @@
-export interface StreamableFileOptions {
-  type?: string;
-  disposition?: string;
-}
\ No newline at end of file
diff --git a/packages/common/http/http.constants.ts b/packages/common/http/http.constants.ts
deleted file mode 100644
index 21f6d8499..000000000
--- a/packages/common/http/http.constants.ts
+++ /dev/null
@@ -1,3 +0,0 @@
-export const AXIOS_INSTANCE_TOKEN = 'AXIOS_INSTANCE_TOKEN';
-export const HTTP_MODULE_ID = 'HTTP_MODULE_ID';
-export const HTTP_MODULE_OPTIONS = 'HTTP_MODULE_OPTIONS';
diff --git a/packages/common/http/http.module.ts b/packages/common/http/http.module.ts
deleted file mode 100644
index cc0367673..000000000
--- a/packages/common/http/http.module.ts
+++ /dev/null
@@ -1,99 +0,0 @@
-import Axios from 'axios';
-import { Module } from '../decorators/modules/module.decorator';
-import { DynamicModule, Provider } from '../interfaces';
-import { randomStringGenerator } from '../utils/random-string-generator.util';
-import {
-  AXIOS_INSTANCE_TOKEN,
-  HTTP_MODULE_ID,
-  HTTP_MODULE_OPTIONS,
-} from './http.constants';
-import { HttpService } from './http.service';
-import {
-  HttpModuleAsyncOptions,
-  HttpModuleOptions,
-  HttpModuleOptionsFactory,
-} from './interfaces';
-
-/**
- * @deprecated "HttpModule" (from the "@nestjs/common" package) is deprecated and will be removed in the next major release. Please, use the "@nestjs/axios" package instead.
- */
-@Module({
-  providers: [
-    HttpService,
-    {
-      provide: AXIOS_INSTANCE_TOKEN,
-      useValue: Axios,
-    },
-  ],
-  exports: [HttpService],
-})
-export class HttpModule {
-  static register(config: HttpModuleOptions): DynamicModule {
-    return {
-      module: HttpModule,
-      providers: [
-        {
-          provide: AXIOS_INSTANCE_TOKEN,
-          useValue: Axios.create(config),
-        },
-        {
-          provide: HTTP_MODULE_ID,
-          useValue: randomStringGenerator(),
-        },
-      ],
-    };
-  }
-
-  static registerAsync(options: HttpModuleAsyncOptions): DynamicModule {
-    return {
-      module: HttpModule,
-      imports: options.imports,
-      providers: [
-        ...this.createAsyncProviders(options),
-        {
-          provide: AXIOS_INSTANCE_TOKEN,
-          useFactory: (config: HttpModuleOptions) => Axios.create(config),
-          inject: [HTTP_MODULE_OPTIONS],
-        },
-        {
-          provide: HTTP_MODULE_ID,
-          useValue: randomStringGenerator(),
-        },
-        ...(options.extraProviders || []),
-      ],
-    };
-  }
-
-  private static createAsyncProviders(
-    options: HttpModuleAsyncOptions,
-  ): Provider[] {
-    if (options.useExisting || options.useFactory) {
-      return [this.createAsyncOptionsProvider(options)];
-    }
-    return [
-      this.createAsyncOptionsProvider(options),
-      {
-        provide: options.useClass,
-        useClass: options.useClass,
-      },
-    ];
-  }
-
-  private static createAsyncOptionsProvider(
-    options: HttpModuleAsyncOptions,
-  ): Provider {
-    if (options.useFactory) {
-      return {
-        provide: HTTP_MODULE_OPTIONS,
-        useFactory: options.useFactory,
-        inject: options.inject || [],
-      };
-    }
-    return {
-      provide: HTTP_MODULE_OPTIONS,
-      useFactory: async (optionsFactory: HttpModuleOptionsFactory) =>
-        optionsFactory.createHttpOptions(),
-      inject: [options.useExisting || options.useClass],
-    };
-  }
-}
diff --git a/packages/common/http/http.service.ts b/packages/common/http/http.service.ts
deleted file mode 100644
index 7c6e2ded2..000000000
--- a/packages/common/http/http.service.ts
+++ /dev/null
@@ -1,113 +0,0 @@
-import Axios, {
-  AxiosInstance,
-  AxiosPromise,
-  AxiosRequestConfig,
-  AxiosResponse,
-  CancelTokenSource,
-} from 'axios';
-import { Observable } from 'rxjs';
-import { Inject } from '../decorators';
-import { Logger } from '../services';
-import { AXIOS_INSTANCE_TOKEN } from './http.constants';
-
-/**
- * @deprecated "HttpModule" (from the "@nestjs/common" package) is deprecated and will be removed in the next major release. Please, use the "@nestjs/axios" package instead.
- */
-export class HttpService {
-  private readonly logger = new Logger(HttpService.name);
-
-  constructor(
-    @Inject(AXIOS_INSTANCE_TOKEN)
-    private readonly instance: AxiosInstance = Axios,
-  ) {
-    this.logger.warn(
-      'DEPRECATED! "HttpModule" (from the "@nestjs/common" package) is deprecated and will be removed in the next major release. Please, use the "@nestjs/axios" package instead.',
-    );
-  }
-
-  request<T = any>(config: AxiosRequestConfig): Observable<AxiosResponse<T>> {
-    return this.makeObservable<T>(this.instance.request, config);
-  }
-
-  get<T = any>(
-    url: string,
-    config?: AxiosRequestConfig,
-  ): Observable<AxiosResponse<T>> {
-    return this.makeObservable<T>(this.instance.get, url, config);
-  }
-
-  delete<T = any>(
-    url: string,
-    config?: AxiosRequestConfig,
-  ): Observable<AxiosResponse<T>> {
-    return this.makeObservable<T>(this.instance.delete, url, config);
-  }
-
-  head<T = any>(
-    url: string,
-    config?: AxiosRequestConfig,
-  ): Observable<AxiosResponse<T>> {
-    return this.makeObservable<T>(this.instance.head, url, config);
-  }
-
-  post<T = any>(
-    url: string,
-    data?: any,
-    config?: AxiosRequestConfig,
-  ): Observable<AxiosResponse<T>> {
-    return this.makeObservable<T>(this.instance.post, url, data, config);
-  }
-
-  put<T = any>(
-    url: string,
-    data?: any,
-    config?: AxiosRequestConfig,
-  ): Observable<AxiosResponse<T>> {
-    return this.makeObservable<T>(this.instance.put, url, data, config);
-  }
-
-  patch<T = any>(
-    url: string,
-    data?: any,
-    config?: AxiosRequestConfig,
-  ): Observable<AxiosResponse<T>> {
-    return this.makeObservable<T>(this.instance.patch, url, data, config);
-  }
-
-  get axiosRef(): AxiosInstance {
-    return this.instance;
-  }
-
-  private makeObservable<T>(
-    axios: (...args: any[]) => AxiosPromise<T>,
-    ...args: any[]
-  ) {
-    return new Observable<AxiosResponse<T>>(subscriber => {
-      const config: AxiosRequestConfig = { ...(args[args.length - 1] || {}) };
-
-      let cancelSource: CancelTokenSource;
-      if (!config.cancelToken) {
-        cancelSource = Axios.CancelToken.source();
-        config.cancelToken = cancelSource.token;
-      }
-
-      axios(...args)
-        .then(res => {
-          subscriber.next(res);
-          subscriber.complete();
-        })
-        .catch(err => {
-          subscriber.error(err);
-        });
-      return () => {
-        if (config.responseType === 'stream') {
-          return;
-        }
-
-        if (cancelSource) {
-          cancelSource.cancel();
-        }
-      };
-    });
-  }
-}
diff --git a/packages/common/http/index.ts b/packages/common/http/index.ts
deleted file mode 100644
index 2e7a1fead..000000000
--- a/packages/common/http/index.ts
+++ /dev/null
@@ -1,3 +0,0 @@
-export * from './http.module';
-export * from './http.service';
-export * from './interfaces';
diff --git a/packages/common/http/interfaces/http-module.interface.ts b/packages/common/http/interfaces/http-module.interface.ts
deleted file mode 100644
index 794f9385c..000000000
--- a/packages/common/http/interfaces/http-module.interface.ts
+++ /dev/null
@@ -1,19 +0,0 @@
-import { AxiosRequestConfig } from 'axios';
-import { ModuleMetadata, Provider, Type } from '../../interfaces';
-
-export type HttpModuleOptions = AxiosRequestConfig;
-
-export interface HttpModuleOptionsFactory {
-  createHttpOptions(): Promise<HttpModuleOptions> | HttpModuleOptions;
-}
-
-export interface HttpModuleAsyncOptions
-  extends Pick<ModuleMetadata, 'imports'> {
-  useExisting?: Type<HttpModuleOptionsFactory>;
-  useClass?: Type<HttpModuleOptionsFactory>;
-  useFactory?: (
-    ...args: any[]
-  ) => Promise<HttpModuleOptions> | HttpModuleOptions;
-  inject?: any[];
-  extraProviders?: Provider[];
-}
diff --git a/packages/common/http/interfaces/index.ts b/packages/common/http/interfaces/index.ts
deleted file mode 100644
index 692e7247e..000000000
--- a/packages/common/http/interfaces/index.ts
+++ /dev/null
@@ -1 +0,0 @@
-export * from './http-module.interface';
diff --git a/packages/common/index.ts b/packages/common/index.ts
index 6a6107762..d6bc5d8a7 100644
--- a/packages/common/index.ts
+++ b/packages/common/index.ts
@@ -1,17 +1,15 @@
 /*
  * Nest @common
- * Copyright(c) 2017 - 2021 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2023 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
 import 'reflect-metadata';
 
-export * from './cache';
 export * from './decorators';
 export * from './enums';
 export * from './exceptions';
 export * from './file-stream';
-export * from './http';
 export {
   Abstract,
   ArgumentMetadata,
@@ -28,9 +26,13 @@ export {
   FactoryProvider,
   ForwardReference,
   HttpServer,
+  HttpExceptionBody,
+  HttpExceptionBodyMessage,
+  HttpRedirectResponse,
   INestApplication,
   INestApplicationContext,
   INestMicroservice,
+  InjectionToken,
   IntrospectionResult,
   MessageEvent,
   MiddlewareConsumer,
@@ -44,9 +46,11 @@ export {
   OnApplicationShutdown,
   OnModuleDestroy,
   OnModuleInit,
+  OptionalFactoryDependency,
   Paramtype,
   PipeTransform,
   Provider,
+  RawBodyRequest,
   RpcExceptionFilter,
   Scope,
   ScopeOptions,
@@ -59,6 +63,7 @@ export {
   WsExceptionFilter,
   WsMessageHandler,
 } from './interfaces';
+export * from './module-utils';
 export * from './pipes';
 export * from './serializer';
 export * from './services';
diff --git a/packages/common/interfaces/external/cors-options.interface.ts b/packages/common/interfaces/external/cors-options.interface.ts
index bcfed6949..6aada97cd 100644
--- a/packages/common/interfaces/external/cors-options.interface.ts
+++ b/packages/common/interfaces/external/cors-options.interface.ts
@@ -56,7 +56,7 @@ export interface CorsOptions {
 }
 
 export interface CorsOptionsCallback {
-  (error: Error, options: CorsOptions): void;
+  (error: Error | null, options: CorsOptions): void;
 }
 export interface CorsOptionsDelegate<T> {
   (req: T, cb: CorsOptionsCallback): void;
diff --git a/packages/common/interfaces/external/https-options.interface.ts b/packages/common/interfaces/external/https-options.interface.ts
index d2793deff..b54eb1f07 100644
--- a/packages/common/interfaces/external/https-options.interface.ts
+++ b/packages/common/interfaces/external/https-options.interface.ts
@@ -96,4 +96,10 @@ export interface HttpsOptions {
    * the default callback with high-level API will be used.
    */
   SNICallback?: (servername: string, cb: (err: Error, ctx: any) => any) => any;
+  /**
+   * Optionally affect the OpenSSL protocol behavior, which is not usually necessary.
+   * This should be used carefully if at all! Value is a numeric bitmask of the SSL_OP_* options
+   * from OpenSSL Options.
+   */
+  secureOptions?: number;
 }
diff --git a/packages/common/interfaces/external/transformer-package.interface.ts b/packages/common/interfaces/external/transformer-package.interface.ts
index cd08a0552..f13c5fa2e 100644
--- a/packages/common/interfaces/external/transformer-package.interface.ts
+++ b/packages/common/interfaces/external/transformer-package.interface.ts
@@ -2,7 +2,7 @@ import { Type } from '../type.interface';
 import { ClassTransformOptions } from './class-transform-options.interface';
 
 export interface TransformerPackage {
-  plainToClass<T>(
+  plainToInstance<T>(
     cls: Type<T>,
     plain: unknown,
     options?: ClassTransformOptions,
diff --git a/packages/common/interfaces/external/validator-options.interface.ts b/packages/common/interfaces/external/validator-options.interface.ts
index 8146bc189..8d0b73a2a 100644
--- a/packages/common/interfaces/external/validator-options.interface.ts
+++ b/packages/common/interfaces/external/validator-options.interface.ts
@@ -69,7 +69,8 @@ export interface ValidatorOptions {
    */
   forbidUnknownValues?: boolean;
   /**
-   * When set to true, validation of the given property will stop after encountering the first error. Defaults to false.
+   * When set to true, validation of the given property will stop after encountering the first error.
+   * This is enabled by default.
    */
   stopAtFirstError?: boolean;
 }
diff --git a/packages/common/interfaces/features/arguments-host.interface.ts b/packages/common/interfaces/features/arguments-host.interface.ts
index 6ab4da9ca..23ea6c90f 100644
--- a/packages/common/interfaces/features/arguments-host.interface.ts
+++ b/packages/common/interfaces/features/arguments-host.interface.ts
@@ -31,6 +31,10 @@ export interface WsArgumentsHost {
    * Returns the client object.
    */
   getClient<T = any>(): T;
+  /**
+   * Returns the pattern for the event
+   */
+  getPattern(): string;
 }
 
 /**
diff --git a/packages/common/interfaces/features/custom-route-param-factory.interface.ts b/packages/common/interfaces/features/custom-route-param-factory.interface.ts
index 3a6afd910..c63b4b857 100644
--- a/packages/common/interfaces/features/custom-route-param-factory.interface.ts
+++ b/packages/common/interfaces/features/custom-route-param-factory.interface.ts
@@ -1,4 +1,9 @@
-export type CustomParamFactory<TData = any, TInput = any, TOutput = any> = (
+import { ExecutionContext } from './execution-context.interface';
+
+/**
+ * @publicApi
+ */
+export type CustomParamFactory<TData = any, TOutput = any> = (
   data: TData,
-  input: TInput,
+  context: ExecutionContext,
 ) => TOutput;
diff --git a/packages/common/interfaces/features/paramtype.interface.ts b/packages/common/interfaces/features/paramtype.interface.ts
index d2c299dbc..a63184f8c 100644
--- a/packages/common/interfaces/features/paramtype.interface.ts
+++ b/packages/common/interfaces/features/paramtype.interface.ts
@@ -1 +1,4 @@
+/**
+ * @publicApi
+ */
 export type Paramtype = 'body' | 'query' | 'param' | 'custom';
diff --git a/packages/common/interfaces/http/http-exception-body.interface.ts b/packages/common/interfaces/http/http-exception-body.interface.ts
new file mode 100644
index 000000000..b9f4732d6
--- /dev/null
+++ b/packages/common/interfaces/http/http-exception-body.interface.ts
@@ -0,0 +1,7 @@
+export type HttpExceptionBodyMessage = string | string[] | number;
+
+export interface HttpExceptionBody {
+  message: HttpExceptionBodyMessage;
+  error?: string;
+  statusCode: number;
+}
diff --git a/packages/common/interfaces/http/http-redirect-response.interface.ts b/packages/common/interfaces/http/http-redirect-response.interface.ts
new file mode 100644
index 000000000..da3261eba
--- /dev/null
+++ b/packages/common/interfaces/http/http-redirect-response.interface.ts
@@ -0,0 +1,6 @@
+import { HttpStatus } from '../../enums';
+
+export interface HttpRedirectResponse {
+  url: string;
+  statusCode: HttpStatus;
+}
diff --git a/packages/common/interfaces/http/http-server.interface.ts b/packages/common/interfaces/http/http-server.interface.ts
index b85595c41..91494021e 100644
--- a/packages/common/interfaces/http/http-server.interface.ts
+++ b/packages/common/interfaces/http/http-server.interface.ts
@@ -18,7 +18,11 @@ export type RequestHandler<TRequest = any, TResponse = any> = (
   next?: Function,
 ) => any;
 
-export interface HttpServer<TRequest = any, TResponse = any> {
+export interface HttpServer<
+  TRequest = any,
+  TResponse = any,
+  ServerInstance = any,
+> {
   use(
     handler:
       | RequestHandler<TRequest, TResponse>
@@ -30,6 +34,7 @@ export interface HttpServer<TRequest = any, TResponse = any> {
       | RequestHandler<TRequest, TResponse>
       | ErrorHandler<TRequest, TResponse>,
   ): any;
+  useBodyParser?(...args: any[]): any;
   get(handler: RequestHandler<TRequest, TResponse>): any;
   get(path: string, handler: RequestHandler<TRequest, TResponse>): any;
   post(handler: RequestHandler<TRequest, TResponse>): any;
@@ -42,16 +47,34 @@ export interface HttpServer<TRequest = any, TResponse = any> {
   put(path: string, handler: RequestHandler<TRequest, TResponse>): any;
   patch(handler: RequestHandler<TRequest, TResponse>): any;
   patch(path: string, handler: RequestHandler<TRequest, TResponse>): any;
+  propfind?(handler: RequestHandler<TRequest, TResponse>): any;
+  propfind?(path: string, handler: RequestHandler<TRequest, TResponse>): any;
+  proppatch?(handler: RequestHandler<TRequest, TResponse>): any;
+  proppatch?(path: string, handler: RequestHandler<TRequest, TResponse>): any;
+  mkcol?(handler: RequestHandler<TRequest, TResponse>): any;
+  mkcol?(path: string, handler: RequestHandler<TRequest, TResponse>): any;
+  copy?(handler: RequestHandler<TRequest, TResponse>): any;
+  copy?(path: string, handler: RequestHandler<TRequest, TResponse>): any;
+  move?(handler: RequestHandler<TRequest, TResponse>): any;
+  move?(path: string, handler: RequestHandler<TRequest, TResponse>): any;
+  lock?(handler: RequestHandler<TRequest, TResponse>): any;
+  lock?(path: string, handler: RequestHandler<TRequest, TResponse>): any;
+  unlock?(handler: RequestHandler<TRequest, TResponse>): any;
+  unlock?(path: string, handler: RequestHandler<TRequest, TResponse>): any;
   all(path: string, handler: RequestHandler<TRequest, TResponse>): any;
   all(handler: RequestHandler<TRequest, TResponse>): any;
   options(handler: RequestHandler<TRequest, TResponse>): any;
   options(path: string, handler: RequestHandler<TRequest, TResponse>): any;
+  search?(handler: RequestHandler<TRequest, TResponse>): any;
+  search?(path: string, handler: RequestHandler<TRequest, TResponse>): any;
   listen(port: number | string, callback?: () => void): any;
   listen(port: number | string, hostname: string, callback?: () => void): any;
   reply(response: any, body: any, statusCode?: number): any;
   status(response: any, statusCode: number): any;
+  end(response: any, message?: string): any;
   render(response: any, view: string, options: any): any;
   redirect(response: any, statusCode: number, url: string): any;
+  isHeadersSent(response: any): boolean;
   setHeader(response: any, name: string, value: string): any;
   setErrorHandler?(handler: Function, prefix?: string): any;
   setNotFoundHandler?(handler: Function, prefix?: string): any;
@@ -66,21 +89,17 @@ export interface HttpServer<TRequest = any, TResponse = any> {
   getRequestHostname?(request: TRequest): string;
   getRequestMethod?(request: TRequest): string;
   getRequestUrl?(request: TRequest): string;
-  getInstance(): any;
-  registerParserMiddleware(): any;
+  getInstance(): ServerInstance;
+  registerParserMiddleware(...args: any[]): any;
   enableCors(options: CorsOptions | CorsOptionsDelegate<TRequest>): any;
   getHttpServer(): any;
   initHttpServer(options: NestApplicationOptions): void;
   close(): any;
   getType(): string;
   init?(): Promise<void>;
-  applyVersionFilter?(
+  applyVersionFilter(
     handler: Function,
     version: VersionValue,
     versioningOptions: VersioningOptions,
-  ): <TRequest extends Record<string, any> = any, TResponse = any>(
-    req: TRequest,
-    res: TResponse,
-    next: () => void,
-  ) => any;
+  ): (req: TRequest, res: TResponse, next: () => void) => Function;
 }
diff --git a/packages/common/interfaces/http/index.ts b/packages/common/interfaces/http/index.ts
index f57d218dd..ad8ebfc83 100644
--- a/packages/common/interfaces/http/index.ts
+++ b/packages/common/interfaces/http/index.ts
@@ -1,2 +1,5 @@
+export * from './http-exception-body.interface';
+export * from './http-redirect-response.interface';
 export * from './http-server.interface';
 export * from './message-event.interface';
+export * from './raw-body-request.interface';
diff --git a/packages/common/interfaces/http/raw-body-request.interface.ts b/packages/common/interfaces/http/raw-body-request.interface.ts
new file mode 100644
index 000000000..b87229083
--- /dev/null
+++ b/packages/common/interfaces/http/raw-body-request.interface.ts
@@ -0,0 +1,4 @@
+/**
+ * @publicApi
+ */
+export type RawBodyRequest<T> = T & { rawBody?: Buffer };
diff --git a/packages/common/interfaces/microservices/nest-hybrid-application-options.interface.ts b/packages/common/interfaces/microservices/nest-hybrid-application-options.interface.ts
index bc27552c5..5389cf5d1 100644
--- a/packages/common/interfaces/microservices/nest-hybrid-application-options.interface.ts
+++ b/packages/common/interfaces/microservices/nest-hybrid-application-options.interface.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export interface NestHybridApplicationOptions {
   inheritAppConfig?: boolean;
 }
diff --git a/packages/common/interfaces/microservices/nest-microservice-options.interface.ts b/packages/common/interfaces/microservices/nest-microservice-options.interface.ts
index 04057a09d..34f32c9f5 100644
--- a/packages/common/interfaces/microservices/nest-microservice-options.interface.ts
+++ b/packages/common/interfaces/microservices/nest-microservice-options.interface.ts
@@ -1,3 +1,6 @@
 import { NestApplicationContextOptions } from '../nest-application-context-options.interface';
 
+/**
+ * @publicApi
+ */
 export type NestMicroserviceOptions = NestApplicationContextOptions;
diff --git a/packages/common/interfaces/middleware/middleware-config-proxy.interface.ts b/packages/common/interfaces/middleware/middleware-config-proxy.interface.ts
index e23c3cf8a..ca439207b 100644
--- a/packages/common/interfaces/middleware/middleware-config-proxy.interface.ts
+++ b/packages/common/interfaces/middleware/middleware-config-proxy.interface.ts
@@ -2,9 +2,12 @@ import { Type } from '../type.interface';
 import { RouteInfo } from './middleware-configuration.interface';
 import { MiddlewareConsumer } from './middleware-consumer.interface';
 
+/**
+ * @publicApi
+ */
 export interface MiddlewareConfigProxy {
   /**
-   * Excludes routes from the currently processed middleware.
+   * Routes to exclude from the current middleware.
    *
    * @param {(string | RouteInfo)[]} routes
    * @returns {MiddlewareConfigProxy}
@@ -12,8 +15,9 @@ export interface MiddlewareConfigProxy {
   exclude(...routes: (string | RouteInfo)[]): MiddlewareConfigProxy;
 
   /**
-   * Attaches passed either routes or controllers to the currently configured middleware.
-   * If you pass a class, Nest would attach middleware to every path defined within this controller.
+   * Attaches either routes or controllers to the current middleware.
+   * If you pass a controller class, Nest will attach the current middleware to every path
+   * defined within it.
    *
    * @param {(string | Type | RouteInfo)[]} routes
    * @returns {MiddlewareConsumer}
diff --git a/packages/common/interfaces/middleware/middleware-configuration.interface.ts b/packages/common/interfaces/middleware/middleware-configuration.interface.ts
index aef5012ed..15414b6cb 100644
--- a/packages/common/interfaces/middleware/middleware-configuration.interface.ts
+++ b/packages/common/interfaces/middleware/middleware-configuration.interface.ts
@@ -1,9 +1,11 @@
 import { RequestMethod } from '../../enums';
 import { Type } from '../type.interface';
+import { VersionValue } from '../version-options.interface';
 
 export interface RouteInfo {
   path: string;
   method: RequestMethod;
+  version?: VersionValue;
 }
 
 export interface MiddlewareConfiguration<T = any> {
diff --git a/packages/common/interfaces/middleware/nest-middleware.interface.ts b/packages/common/interfaces/middleware/nest-middleware.interface.ts
index d392d052d..748b03a85 100644
--- a/packages/common/interfaces/middleware/nest-middleware.interface.ts
+++ b/packages/common/interfaces/middleware/nest-middleware.interface.ts
@@ -1,3 +1,8 @@
+/**
+ * @see [Middleware](https://docs.nestjs.com/middleware)
+ *
+ * @publicApi
+ */
 export interface NestMiddleware<TRequest = any, TResponse = any> {
-  use(req: TRequest, res: TResponse, next: () => void): any;
+  use(req: TRequest, res: TResponse, next: (error?: any) => void): any;
 }
diff --git a/packages/common/interfaces/modules/index.ts b/packages/common/interfaces/modules/index.ts
index 612adb82b..458f952a3 100644
--- a/packages/common/interfaces/modules/index.ts
+++ b/packages/common/interfaces/modules/index.ts
@@ -1,6 +1,8 @@
 export * from './dynamic-module.interface';
 export * from './forward-reference.interface';
+export * from './injection-token.interface';
 export * from './introspection-result.interface';
 export * from './module-metadata.interface';
 export * from './nest-module.interface';
+export * from './optional-factory-dependency.interface';
 export * from './provider.interface';
diff --git a/packages/common/interfaces/modules/injection-token.interface.ts b/packages/common/interfaces/modules/injection-token.interface.ts
new file mode 100644
index 000000000..ba5c2ce2b
--- /dev/null
+++ b/packages/common/interfaces/modules/injection-token.interface.ts
@@ -0,0 +1,12 @@
+import { Abstract } from '../abstract.interface';
+import { Type } from '../type.interface';
+
+/**
+ * @publicApi
+ */
+export type InjectionToken<T = any> =
+  | string
+  | symbol
+  | Type<T>
+  | Abstract<T>
+  | Function;
diff --git a/packages/common/interfaces/modules/module-metadata.interface.ts b/packages/common/interfaces/modules/module-metadata.interface.ts
index 9d6699cba..2baa7d84f 100644
--- a/packages/common/interfaces/modules/module-metadata.interface.ts
+++ b/packages/common/interfaces/modules/module-metadata.interface.ts
@@ -35,7 +35,6 @@ export interface ModuleMetadata {
    */
   exports?: Array<
     | DynamicModule
-    | Promise<DynamicModule>
     | string
     | symbol
     | Provider
diff --git a/packages/common/interfaces/modules/nest-module.interface.ts b/packages/common/interfaces/modules/nest-module.interface.ts
index bef5810c2..236658017 100644
--- a/packages/common/interfaces/modules/nest-module.interface.ts
+++ b/packages/common/interfaces/modules/nest-module.interface.ts
@@ -1,5 +1,8 @@
 import { MiddlewareConsumer } from '../middleware/middleware-consumer.interface';
 
+/**
+ * @publicApi
+ */
 export interface NestModule {
   configure(consumer: MiddlewareConsumer);
 }
diff --git a/packages/common/interfaces/modules/optional-factory-dependency.interface.ts b/packages/common/interfaces/modules/optional-factory-dependency.interface.ts
new file mode 100644
index 000000000..6c8db900e
--- /dev/null
+++ b/packages/common/interfaces/modules/optional-factory-dependency.interface.ts
@@ -0,0 +1,9 @@
+import { InjectionToken } from './injection-token.interface';
+
+/**
+ * @publicApi
+ */
+export type OptionalFactoryDependency = {
+  token: InjectionToken;
+  optional: boolean;
+};
diff --git a/packages/common/interfaces/modules/provider.interface.ts b/packages/common/interfaces/modules/provider.interface.ts
index c868b3c97..2fd7f85b6 100644
--- a/packages/common/interfaces/modules/provider.interface.ts
+++ b/packages/common/interfaces/modules/provider.interface.ts
@@ -1,6 +1,7 @@
-import { Abstract } from '../abstract.interface';
 import { Scope } from '../scope-options.interface';
 import { Type } from '../type.interface';
+import { InjectionToken } from './injection-token.interface';
+import { OptionalFactoryDependency } from './optional-factory-dependency.interface';
 
 /**
  *
@@ -27,7 +28,7 @@ export type Provider<T = any> =
  * };
  * ```
  *
- * @see [Use class](https://docs.nestjs.com/fundamentals/custom-providers#use-class)
+ * @see [Class providers](https://docs.nestjs.com/fundamentals/custom-providers#class-providers-useclass)
  * @see [Injection scopes](https://docs.nestjs.com/fundamentals/injection-scopes)
  *
  * @publicApi
@@ -36,7 +37,7 @@ export interface ClassProvider<T = any> {
   /**
    * Injection token
    */
-  provide: string | symbol | Type<any> | Abstract<any> | Function;
+  provide: InjectionToken;
   /**
    * Type (class name) of provider (instance to be injected).
    */
@@ -45,6 +46,19 @@ export interface ClassProvider<T = any> {
    * Optional enum defining lifetime of the provider that is injected.
    */
   scope?: Scope;
+  /**
+   * This option is only available on factory providers!
+   *
+   * @see [Use factory](https://docs.nestjs.com/fundamentals/custom-providers#factory-providers-usefactory)
+   */
+  inject?: never;
+  /**
+   * Flags provider as durable. This flag can be used in combination with custom context id
+   * factory strategy to construct lazy DI subtrees.
+   *
+   * This flag can be used only in conjunction with scope = Scope.REQUEST.
+   */
+  durable?: boolean;
 }
 
 /**
@@ -58,7 +72,7 @@ export interface ClassProvider<T = any> {
  * };
  * ```
  *
- * @see [Use value](https://docs.nestjs.com/fundamentals/custom-providers#use-value)
+ * @see [Value providers](https://docs.nestjs.com/fundamentals/custom-providers#value-providers-usevalue)
  *
  * @publicApi
  */
@@ -66,11 +80,17 @@ export interface ValueProvider<T = any> {
   /**
    * Injection token
    */
-  provide: string | symbol | Type<any> | Abstract<any> | Function;
+  provide: InjectionToken;
   /**
    * Instance of a provider to be injected.
    */
   useValue: T;
+  /**
+   * This option is only available on factory providers!
+   *
+   * @see [Use factory](https://docs.nestjs.com/fundamentals/custom-providers#factory-providers-usefactory)
+   */
+  inject?: never;
 }
 
 /**
@@ -88,7 +108,7 @@ export interface ValueProvider<T = any> {
  * };
  * ```
  *
- * @see [Use factory](https://docs.nestjs.com/fundamentals/custom-providers#use-factory)
+ * @see [Factory providers](https://docs.nestjs.com/fundamentals/custom-providers#factory-providers-usefactory)
  * @see [Injection scopes](https://docs.nestjs.com/fundamentals/injection-scopes)
  *
  * @publicApi
@@ -97,19 +117,26 @@ export interface FactoryProvider<T = any> {
   /**
    * Injection token
    */
-  provide: string | symbol | Type<any> | Abstract<any> | Function;
+  provide: InjectionToken;
   /**
    * Factory function that returns an instance of the provider to be injected.
    */
-  useFactory: (...args: any[]) => T;
+  useFactory: (...args: any[]) => T | Promise<T>;
   /**
    * Optional list of providers to be injected into the context of the Factory function.
    */
-  inject?: Array<Type<any> | string | symbol | Abstract<any> | Function>;
+  inject?: Array<InjectionToken | OptionalFactoryDependency>;
   /**
    * Optional enum defining lifetime of the provider that is returned by the Factory function.
    */
   scope?: Scope;
+  /**
+   * Flags provider as durable. This flag can be used in combination with custom context id
+   * factory strategy to construct lazy DI subtrees.
+   *
+   * This flag can be used only in conjunction with scope = Scope.REQUEST.
+   */
+  durable?: boolean;
 }
 
 /**
@@ -123,7 +150,7 @@ export interface FactoryProvider<T = any> {
  * };
  * ```
  *
- * @see [Use existing](https://docs.nestjs.com/fundamentals/custom-providers#use-existing)
+ * @see [Alias providers](https://docs.nestjs.com/fundamentals/custom-providers#alias-providers-useexisting)
  *
  * @publicApi
  */
@@ -131,7 +158,7 @@ export interface ExistingProvider<T = any> {
   /**
    * Injection token
    */
-  provide: string | symbol | Type<any> | Abstract<any> | Function;
+  provide: InjectionToken;
   /**
    * Provider to be aliased by the Injection token.
    */
diff --git a/packages/common/interfaces/nest-application-context-options.interface.ts b/packages/common/interfaces/nest-application-context-options.interface.ts
index 6126a1dc7..db661d953 100644
--- a/packages/common/interfaces/nest-application-context-options.interface.ts
+++ b/packages/common/interfaces/nest-application-context-options.interface.ts
@@ -25,8 +25,32 @@ export class NestApplicationContextOptions {
 
   /**
    * If enabled, logs will be automatically flushed and buffer detached when
-   * application initialisation process either completes or fails.
+   * application initialization process either completes or fails.
    * @default true
    */
   autoFlushLogs?: boolean;
+
+  /**
+   * Whether to run application in the preview mode.
+   * In the preview mode, providers/controllers are not instantiated & resolved.
+   *
+   * @default false
+   */
+  preview?: boolean;
+
+  /**
+   * Whether to generate a serialized graph snapshot.
+   *
+   * @default false
+   */
+  snapshot?: boolean;
+
+  /**
+   * Determines what algorithm use to generate module ids.
+   * When set to `deep-hash`, the module id is generated based on the serialized module definition.
+   * When set to `reference`, each module obtains a unique id based on its reference.
+   *
+   * @default 'reference'
+   */
+  moduleIdGeneratorAlgorithm?: 'deep-hash' | 'reference';
 }
diff --git a/packages/common/interfaces/nest-application-context.interface.ts b/packages/common/interfaces/nest-application-context.interface.ts
index 11888397a..3a8fe4396 100644
--- a/packages/common/interfaces/nest-application-context.interface.ts
+++ b/packages/common/interfaces/nest-application-context.interface.ts
@@ -1,8 +1,25 @@
 import { ShutdownSignal } from '../enums/shutdown-signal.enum';
 import { LoggerService, LogLevel } from '../services/logger.service';
 import { DynamicModule } from './modules';
+import { NestApplicationContextOptions } from './nest-application-context-options.interface';
 import { Type } from './type.interface';
 
+export type SelectOptions = Pick<NestApplicationContextOptions, 'abortOnError'>;
+
+export interface GetOrResolveOptions {
+  /**
+   * If enabled, lookup will only be performed in the host module.
+   * @default false
+   */
+  strict?: boolean;
+  /**
+   * If enabled, instead of returning a first instance registered under a given token,
+   * a list of instances will be returned.
+   * @default false
+   */
+  each?: boolean;
+}
+
 /**
  * Interface defining NestApplicationContext.
  *
@@ -13,7 +30,10 @@ export interface INestApplicationContext {
    * Allows navigating through the modules tree, for example, to pull out a specific instance from the selected module.
    * @returns {INestApplicationContext}
    */
-  select<T>(module: Type<T> | DynamicModule): INestApplicationContext;
+  select<T>(
+    module: Type<T> | DynamicModule,
+    options?: SelectOptions,
+  ): INestApplicationContext;
 
   /**
    * Retrieves an instance of either injectable or controller, otherwise, throws exception.
@@ -21,18 +41,74 @@ export interface INestApplicationContext {
    */
   get<TInput = any, TResult = TInput>(
     typeOrToken: Type<TInput> | Function | string | symbol,
-    options?: { strict: boolean },
   ): TResult;
+  /**
+   * Retrieves an instance of either injectable or controller, otherwise, throws exception.
+   * @returns {TResult}
+   */
+  get<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    options: { strict?: boolean; each?: undefined | false },
+  ): TResult;
+  /**
+   * Retrieves a list of instances of either injectables or controllers, otherwise, throws exception.
+   * @returns {Array<TResult>}
+   */
+  get<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    options: { strict?: boolean; each: true },
+  ): Array<TResult>;
+  /**
+   * Retrieves an instance (or a list of instances) of either injectable or controller, otherwise, throws exception.
+   * @returns {TResult | Array<TResult>}
+   */
+  get<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    options?: GetOrResolveOptions,
+  ): TResult | Array<TResult>;
 
   /**
    * Resolves transient or request-scoped instance of either injectable or controller, otherwise, throws exception.
-   * @returns {Promise<TResult>}
+   * @returns {Array<TResult>}
+   */
+  resolve<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+  ): Promise<TResult>;
+  /**
+   * Resolves transient or request-scoped instance of either injectable or controller, otherwise, throws exception.
+   * @returns {Array<TResult>}
+   */
+  resolve<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    contextId?: { id: number },
+  ): Promise<TResult>;
+  /**
+   * Resolves transient or request-scoped instance of either injectable or controller, otherwise, throws exception.
+   * @returns {Array<TResult>}
    */
   resolve<TInput = any, TResult = TInput>(
     typeOrToken: Type<TInput> | Function | string | symbol,
     contextId?: { id: number },
-    options?: { strict: boolean },
+    options?: { strict?: boolean; each?: undefined | false },
   ): Promise<TResult>;
+  /**
+   * Resolves transient or request-scoped instances of either injectables or controllers, otherwise, throws exception.
+   * @returns {Array<TResult>}
+   */
+  resolve<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    contextId?: { id: number },
+    options?: { strict?: boolean; each: true },
+  ): Promise<Array<TResult>>;
+  /**
+   * Resolves transient or request-scoped instance (or a list of instances) of either injectable or controller, otherwise, throws exception.
+   * @returns {Promise<TResult | Array<TResult>>}
+   */
+  resolve<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    contextId?: { id: number },
+    options?: GetOrResolveOptions,
+  ): Promise<TResult | Array<TResult>>;
 
   /**
    * Registers the request/context object for a given context ID (DI container sub-tree).
@@ -72,7 +148,7 @@ export interface INestApplicationContext {
   enableShutdownHooks(signals?: ShutdownSignal[] | string[]): this;
 
   /**
-   * Initalizes the Nest application.
+   * Initializes the Nest application.
    * Calls the Nest lifecycle events.
    * It isn't mandatory to call this method directly.
    *
diff --git a/packages/common/interfaces/nest-application-options.interface.ts b/packages/common/interfaces/nest-application-options.interface.ts
index a21bfed98..5d4c89cbc 100644
--- a/packages/common/interfaces/nest-application-options.interface.ts
+++ b/packages/common/interfaces/nest-application-options.interface.ts
@@ -21,4 +21,13 @@ export interface NestApplicationOptions extends NestApplicationContextOptions {
    * Set of configurable HTTPS options
    */
   httpsOptions?: HttpsOptions;
+  /**
+   * Whether to register the raw request body on the request. Use `req.rawBody`.
+   */
+  rawBody?: boolean;
+  /**
+   * Force close open HTTP connections. Useful if restarting your application hangs due to
+   * keep-alive connections in the HTTP adapter.
+   */
+  forceCloseConnections?: boolean;
 }
diff --git a/packages/common/interfaces/nest-application.interface.ts b/packages/common/interfaces/nest-application.interface.ts
index ec04c5180..eb2167e64 100644
--- a/packages/common/interfaces/nest-application.interface.ts
+++ b/packages/common/interfaces/nest-application.interface.ts
@@ -21,7 +21,8 @@ import { WebSocketAdapter } from './websockets/web-socket-adapter.interface';
  *
  * @publicApi
  */
-export interface INestApplication extends INestApplicationContext {
+export interface INestApplication<TServer = any>
+  extends INestApplicationContext {
   /**
    * A wrapper function around HTTP adapter method: `adapter.use()`.
    * Example `app.use(cors())`
@@ -61,16 +62,6 @@ export interface INestApplication extends INestApplicationContext {
     callback?: () => void,
   ): Promise<any>;
 
-  /**
-   * Starts the application (can be awaited).
-   * @deprecated use "listen" instead.
-   *
-   * @param {number|string} port
-   * @param {string} [hostname]
-   * @returns {Promise}
-   */
-  listenAsync(port: number | string, hostname?: string): Promise<any>;
-
   /**
    * Returns the url the application is listening at, based on OS and IP version. Returns as an IP value either in IPv6 or IPv4
    *
@@ -120,9 +111,9 @@ export interface INestApplication extends INestApplicationContext {
   /**
    * Returns the underlying native HTTP server.
    *
-   * @returns {*}
+   * @returns {TServer}
    */
-  getHttpServer(): any;
+  getHttpServer(): TServer;
 
   /**
    * Returns the underlying HTTP adapter.
@@ -138,14 +129,6 @@ export interface INestApplication extends INestApplicationContext {
    */
   startAllMicroservices(): Promise<this>;
 
-  /**
-   * Starts all connected microservices and can be awaited.
-   * @deprecated use "startAllMicroservices" instead.
-   *
-   * @returns {Promise}
-   */
-  startAllMicroservicesAsync(): Promise<this>;
-
   /**
    * Registers exception filters as global filters (will be used within
    * every HTTP route handler)
diff --git a/packages/common/interfaces/nest-microservice.interface.ts b/packages/common/interfaces/nest-microservice.interface.ts
index 857f1d66c..efcaa0761 100644
--- a/packages/common/interfaces/nest-microservice.interface.ts
+++ b/packages/common/interfaces/nest-microservice.interface.ts
@@ -1,3 +1,4 @@
+import { Observable } from 'rxjs';
 import { ExceptionFilter } from './exceptions/exception-filter.interface';
 import { CanActivate } from './features/can-activate.interface';
 import { NestInterceptor } from './features/nest-interceptor.interface';
@@ -19,16 +20,8 @@ export interface INestMicroservice extends INestApplicationContext {
   listen(): Promise<any>;
 
   /**
-   * Starts the microservice (can be awaited).
-   * @deprecated use "listen" instead.
-   *
-   * @returns {Promise}
-   */
-  listenAsync(): Promise<any>;
-
-  /**
-   * Register Ws Adapter which will be used inside Gateways.
-   * Use when you want to override default `socket.io` library.
+   * Registers a web socket adapter that will be used for Gateways.
+   * Use to override the default `socket.io` library.
    *
    * @param {WebSocketAdapter} adapter
    * @returns {this}
@@ -36,37 +29,64 @@ export interface INestMicroservice extends INestApplicationContext {
   useWebSocketAdapter(adapter: WebSocketAdapter): this;
 
   /**
-   * Registers exception filters as global filters (will be used within every message pattern handler)
+   * Registers global exception filters (will be used for every pattern handler).
    *
    * @param {...ExceptionFilter} filters
    */
   useGlobalFilters(...filters: ExceptionFilter[]): this;
 
   /**
-   * Registers pipes as global pipes (will be used within every message pattern handler)
+   * Registers global pipes (will be used for every pattern handler).
    *
    * @param {...PipeTransform} pipes
    */
   useGlobalPipes(...pipes: PipeTransform<any>[]): this;
 
   /**
-   * Registers interceptors as global interceptors (will be used within every message pattern handler)
+   * Registers global interceptors (will be used for every pattern handler).
    *
    * @param {...NestInterceptor} interceptors
    */
   useGlobalInterceptors(...interceptors: NestInterceptor[]): this;
 
   /**
-   * Registers guards as global guards (will be used within every message pattern handler)
+   * Registers global guards (will be used for every pattern handler).
    *
    * @param {...CanActivate} guards
    */
   useGlobalGuards(...guards: CanActivate[]): this;
 
   /**
-   * Terminates the application
+   * Terminates the application.
    *
    * @returns {Promise<void>}
    */
   close(): Promise<void>;
+
+  /**
+   * Returns an observable that emits status changes.
+   *
+   * @returns {Observable<string>}
+   */
+  status: Observable<string>;
+
+  /**
+   * Registers an event listener for the given event.
+   * @param event Event name
+   * @param callback Callback to be executed when the event is emitted
+   */
+  on<
+    EventsMap extends Record<string, Function> = Record<string, Function>,
+    EventKey extends keyof EventsMap = keyof EventsMap,
+    EventCallback extends EventsMap[EventKey] = EventsMap[EventKey],
+  >(
+    event: EventKey,
+    callback: EventCallback,
+  ): void;
+
+  /**
+   * Returns an instance of the underlying server/broker instance,
+   * or a group of servers if there are more than one.
+   */
+  unwrap<T>(): T;
 }
diff --git a/packages/common/interfaces/scope-options.interface.ts b/packages/common/interfaces/scope-options.interface.ts
index f958c393b..4cca74275 100644
--- a/packages/common/interfaces/scope-options.interface.ts
+++ b/packages/common/interfaces/scope-options.interface.ts
@@ -28,4 +28,11 @@ export interface ScopeOptions {
    * Specifies the lifetime of an injected Provider or Controller.
    */
   scope?: Scope;
+  /**
+   * Flags provider as durable. This flag can be used in combination with custom context id
+   * factory strategy to construct lazy DI subtrees.
+   *
+   * This flag can be used only in conjunction with scope = Scope.REQUEST.
+   */
+  durable?: boolean;
 }
diff --git a/packages/common/interfaces/version-options.interface.ts b/packages/common/interfaces/version-options.interface.ts
index be03d349d..fc5a53b6e 100644
--- a/packages/common/interfaces/version-options.interface.ts
+++ b/packages/common/interfaces/version-options.interface.ts
@@ -7,6 +7,9 @@ import { VersioningType } from '../enums/version-type.enum';
  */
 export const VERSION_NEUTRAL = Symbol('VERSION_NEUTRAL');
 
+/**
+ * @publicApi
+ */
 export type VersionValue =
   | string
   | typeof VERSION_NEUTRAL
@@ -18,7 +21,7 @@ export type VersionValue =
 export interface VersionOptions {
   /**
    * Specifies an optional API Version. When configured, methods
-   * withing the controller will only be routed if the request version
+   * within the controller will only be routed if the request version
    * matches the specified value.
    *
    * Supported only by HTTP-based applications (does not apply to non-HTTP microservices).
@@ -28,6 +31,9 @@ export interface VersionOptions {
   version?: VersionValue;
 }
 
+/**
+ * @publicApi
+ */
 export interface HeaderVersioningOptions {
   type: VersioningType.HEADER;
   /**
@@ -36,6 +42,9 @@ export interface HeaderVersioningOptions {
   header: string;
 }
 
+/**
+ * @publicApi
+ */
 export interface UriVersioningOptions {
   type: VersioningType.URI;
   /**
@@ -48,6 +57,9 @@ export interface UriVersioningOptions {
   prefix?: string | false;
 }
 
+/**
+ * @publicApi
+ */
 export interface MediaTypeVersioningOptions {
   type: VersioningType.MEDIA_TYPE;
   /**
@@ -58,6 +70,26 @@ export interface MediaTypeVersioningOptions {
   key: string;
 }
 
+/**
+ * @publicApi
+ */
+export interface CustomVersioningOptions {
+  type: VersioningType.CUSTOM;
+
+  /**
+   * A function that accepts a request object (specific to the underlying platform, ie Express or Fastify)
+   * and returns a single version value or an ordered array of versions, in order from HIGHEST to LOWEST.
+   *
+   * Ex. Returned version array = ['3.1', '3.0', '2.5', '2', '1.9']
+   *
+   * Use type assertion or narrowing to identify the specific request type.
+   */
+  extractor: (request: unknown) => string | string[];
+}
+
+/**
+ * @publicApi
+ */
 interface VersioningCommonOptions {
   /**
    * The default version to be used as a fallback when you did not provide some
@@ -70,4 +102,9 @@ interface VersioningCommonOptions {
  * @publicApi
  */
 export type VersioningOptions = VersioningCommonOptions &
-  (HeaderVersioningOptions | UriVersioningOptions | MediaTypeVersioningOptions);
+  (
+    | HeaderVersioningOptions
+    | UriVersioningOptions
+    | MediaTypeVersioningOptions
+    | CustomVersioningOptions
+  );
diff --git a/packages/common/interfaces/websockets/web-socket-adapter.interface.ts b/packages/common/interfaces/websockets/web-socket-adapter.interface.ts
index 4b1585672..e3baa1272 100644
--- a/packages/common/interfaces/websockets/web-socket-adapter.interface.ts
+++ b/packages/common/interfaces/websockets/web-socket-adapter.interface.ts
@@ -1,10 +1,16 @@
 import { Observable } from 'rxjs';
 
+/**
+ * @publicApi
+ */
 export interface WsMessageHandler<T = string> {
   message: T;
   callback: (...args: any[]) => Observable<any> | Promise<any>;
 }
 
+/**
+ * @publicApi
+ */
 export interface WebSocketAdapter<
   TServer = any,
   TClient = any,
diff --git a/packages/common/module-utils/configurable-module.builder.ts b/packages/common/module-utils/configurable-module.builder.ts
new file mode 100644
index 000000000..cec0ea6ae
--- /dev/null
+++ b/packages/common/module-utils/configurable-module.builder.ts
@@ -0,0 +1,351 @@
+/* eslint-disable @typescript-eslint/no-empty-object-type */
+import { DynamicModule, Provider } from '../interfaces';
+import { Logger } from '../services/logger.service';
+import { randomStringGenerator } from '../utils/random-string-generator.util';
+import {
+  ASYNC_METHOD_SUFFIX,
+  CONFIGURABLE_MODULE_ID,
+  DEFAULT_FACTORY_CLASS_METHOD_KEY,
+  DEFAULT_METHOD_KEY,
+} from './constants';
+import {
+  ConfigurableModuleAsyncOptions,
+  ConfigurableModuleCls,
+  ConfigurableModuleHost,
+  ConfigurableModuleOptionsFactory,
+} from './interfaces';
+import { generateOptionsInjectionToken, getInjectionProviders } from './utils';
+
+/**
+ * @publicApi
+ */
+export interface ConfigurableModuleBuilderOptions {
+  /**
+   * Specifies what injection token should be used for the module options provider.
+   * By default, an auto-generated UUID will be used.
+   */
+  optionsInjectionToken?: string | symbol;
+  /**
+   * By default, an UUID will be used as a module options provider token.
+   * Explicitly specifying the "moduleName" will instruct the "ConfigurableModuleBuilder"
+   * to use a more descriptive provider token.
+   *
+   * For example, `moduleName: "Cache"` will auto-generate the provider token: "CACHE_MODULE_OPTIONS".
+   */
+  moduleName?: string;
+  /**
+   * Indicates whether module should always be "transient" - meaning,
+   * every time you call the static method to construct a dynamic module,
+   * regardless of what arguments you pass in, a new "unique" module will be created.
+   *
+   * @default false
+   */
+  alwaysTransient?: boolean;
+}
+
+/**
+ * Factory that lets you create configurable modules and
+ * provides a way to reduce the majority of dynamic module boilerplate.
+ *
+ * @publicApi
+ */
+export class ConfigurableModuleBuilder<
+  ModuleOptions,
+  StaticMethodKey extends string = typeof DEFAULT_METHOD_KEY,
+  FactoryClassMethodKey extends
+    string = typeof DEFAULT_FACTORY_CLASS_METHOD_KEY,
+  ExtraModuleDefinitionOptions = {},
+> {
+  protected staticMethodKey: StaticMethodKey;
+  protected factoryClassMethodKey: FactoryClassMethodKey;
+  protected extras: ExtraModuleDefinitionOptions;
+  protected transformModuleDefinition: (
+    definition: DynamicModule,
+    extraOptions: ExtraModuleDefinitionOptions,
+  ) => DynamicModule;
+
+  protected readonly logger = new Logger(ConfigurableModuleBuilder.name);
+
+  constructor(
+    protected readonly options: ConfigurableModuleBuilderOptions = {},
+    parentBuilder?: ConfigurableModuleBuilder<ModuleOptions>,
+  ) {
+    if (parentBuilder) {
+      this.staticMethodKey = parentBuilder.staticMethodKey as StaticMethodKey;
+      this.factoryClassMethodKey =
+        parentBuilder.factoryClassMethodKey as FactoryClassMethodKey;
+      this.transformModuleDefinition =
+        parentBuilder.transformModuleDefinition as (
+          definition: DynamicModule,
+          extraOptions: ExtraModuleDefinitionOptions,
+        ) => DynamicModule;
+      this.extras = parentBuilder.extras as ExtraModuleDefinitionOptions;
+    }
+  }
+
+  /**
+   * Registers the "extras" object (a set of extra options that can be used to modify the dynamic module definition).
+   * Values you specify within the "extras" object will be used as default values (that can be overridden by module consumers).
+   *
+   * This method also applies the so-called "module definition transform function" that takes the auto-generated
+   * dynamic module object ("DynamicModule") and the actual consumer "extras" object as input parameters.
+   * The "extras" object consists of values explicitly specified by module consumers and default values.
+   *
+   * @example
+   * ```typescript
+   * .setExtras<{ isGlobal?: boolean }>({ isGlobal: false }, (definition, extras) =>
+   *    ({ ...definition, global: extras.isGlobal })
+   * )
+   * ```
+   */
+  setExtras<ExtraModuleDefinitionOptions>(
+    extras: ExtraModuleDefinitionOptions,
+    transformDefinition: (
+      definition: DynamicModule,
+      extras: ExtraModuleDefinitionOptions,
+    ) => DynamicModule = def => def,
+  ) {
+    const builder = new ConfigurableModuleBuilder<
+      ModuleOptions,
+      StaticMethodKey,
+      FactoryClassMethodKey,
+      ExtraModuleDefinitionOptions
+    >(this.options, this as any);
+    builder.extras = extras;
+    builder.transformModuleDefinition = transformDefinition;
+    return builder;
+  }
+
+  /**
+   * Dynamic modules must expose public static methods that let you pass in
+   * configuration parameters (control the module's behavior from the outside).
+   * Some frequently used names that you may have seen in other modules are:
+   * "forRoot", "forFeature", "register", "configure".
+   *
+   * This method "setClassMethodName" lets you specify the name of the
+   * method that will be auto-generated.
+   *
+   * @param key name of the method
+   */
+  setClassMethodName<StaticMethodKey extends string>(key: StaticMethodKey) {
+    const builder = new ConfigurableModuleBuilder<
+      ModuleOptions,
+      StaticMethodKey,
+      FactoryClassMethodKey,
+      ExtraModuleDefinitionOptions
+    >(this.options, this as any);
+    builder.staticMethodKey = key;
+    return builder;
+  }
+
+  /**
+   * Asynchronously configured modules (that rely on other modules, i.e. "ConfigModule")
+   * let you pass the configuration factory class that will be registered and instantiated as a provider.
+   * This provider then will be used to retrieve the module's configuration. To provide the configuration,
+   * the corresponding factory method must be implemented.
+   *
+   * This method ("setFactoryMethodName") lets you control what method name will have to be
+   * implemented by the config factory (default is "create").
+   *
+   * @param key name of the method
+   */
+  setFactoryMethodName<FactoryClassMethodKey extends string>(
+    key: FactoryClassMethodKey,
+  ) {
+    const builder = new ConfigurableModuleBuilder<
+      ModuleOptions,
+      StaticMethodKey,
+      FactoryClassMethodKey,
+      ExtraModuleDefinitionOptions
+    >(this.options, this as any);
+    builder.factoryClassMethodKey = key;
+    return builder;
+  }
+
+  /**
+   * Returns an object consisting of multiple properties that lets you
+   * easily construct dynamic configurable modules. See "ConfigurableModuleHost" interface for more details.
+   */
+  build(): ConfigurableModuleHost<
+    ModuleOptions,
+    StaticMethodKey,
+    FactoryClassMethodKey,
+    ExtraModuleDefinitionOptions
+  > {
+    this.staticMethodKey ??= DEFAULT_METHOD_KEY as StaticMethodKey;
+    this.factoryClassMethodKey ??=
+      DEFAULT_FACTORY_CLASS_METHOD_KEY as FactoryClassMethodKey;
+    this.options.optionsInjectionToken ??= this.options.moduleName
+      ? this.constructInjectionTokenString()
+      : generateOptionsInjectionToken();
+    this.transformModuleDefinition ??= definition => definition;
+
+    return {
+      ConfigurableModuleClass:
+        this.createConfigurableModuleCls<ModuleOptions>(),
+      MODULE_OPTIONS_TOKEN: this.options.optionsInjectionToken,
+      ASYNC_OPTIONS_TYPE: this.createTypeProxy('ASYNC_OPTIONS_TYPE'),
+      OPTIONS_TYPE: this.createTypeProxy('OPTIONS_TYPE'),
+    };
+  }
+
+  private constructInjectionTokenString(): string {
+    const moduleNameInSnakeCase = this.options
+      .moduleName!.trim()
+      .split(/(?=[A-Z])/)
+      .join('_')
+      .toUpperCase();
+    return `${moduleNameInSnakeCase}_MODULE_OPTIONS`;
+  }
+
+  private createConfigurableModuleCls<ModuleOptions>(): ConfigurableModuleCls<
+    ModuleOptions,
+    StaticMethodKey,
+    FactoryClassMethodKey
+  > {
+    // eslint-disable-next-line @typescript-eslint/no-this-alias
+    const self = this;
+    const asyncMethodKey = this.staticMethodKey + ASYNC_METHOD_SUFFIX;
+
+    class InternalModuleClass {
+      static [self.staticMethodKey](
+        options: ModuleOptions & ExtraModuleDefinitionOptions,
+      ): DynamicModule {
+        const providers: Array<Provider> = [
+          {
+            provide: self.options.optionsInjectionToken!,
+            useValue: this.omitExtras(options, self.extras),
+          },
+        ];
+        if (self.options.alwaysTransient) {
+          providers.push({
+            provide: CONFIGURABLE_MODULE_ID,
+            useValue: randomStringGenerator(),
+          });
+        }
+        return self.transformModuleDefinition(
+          {
+            module: this,
+            providers,
+          },
+          {
+            ...self.extras,
+            ...options,
+          },
+        );
+      }
+
+      static [asyncMethodKey](
+        options: ConfigurableModuleAsyncOptions<ModuleOptions> &
+          ExtraModuleDefinitionOptions,
+      ): DynamicModule {
+        const providers = this.createAsyncProviders(options);
+        if (self.options.alwaysTransient) {
+          providers.push({
+            provide: CONFIGURABLE_MODULE_ID,
+            useValue: randomStringGenerator(),
+          });
+        }
+        return self.transformModuleDefinition(
+          {
+            module: this,
+            imports: options.imports || [],
+            providers,
+          },
+          {
+            ...self.extras,
+            ...options,
+          },
+        );
+      }
+
+      private static omitExtras(
+        input: ModuleOptions & ExtraModuleDefinitionOptions,
+        extras: ExtraModuleDefinitionOptions | undefined,
+      ): ModuleOptions {
+        if (!extras) {
+          return input;
+        }
+        const moduleOptions = {};
+        const extrasKeys = Object.keys(extras);
+
+        Object.keys(input as object)
+          .filter(key => !extrasKeys.includes(key))
+          .forEach(key => {
+            moduleOptions[key] = input[key];
+          });
+        return moduleOptions as ModuleOptions;
+      }
+
+      private static createAsyncProviders(
+        options: ConfigurableModuleAsyncOptions<ModuleOptions>,
+      ): Provider[] {
+        if (options.useExisting || options.useFactory) {
+          if (options.inject && options.provideInjectionTokensFrom) {
+            return [
+              this.createAsyncOptionsProvider(options),
+              ...getInjectionProviders(
+                options.provideInjectionTokensFrom,
+                options.inject,
+              ),
+            ];
+          }
+          return [this.createAsyncOptionsProvider(options)];
+        }
+        return [
+          this.createAsyncOptionsProvider(options),
+          {
+            provide: options.useClass!,
+            useClass: options.useClass!,
+          },
+        ];
+      }
+
+      private static createAsyncOptionsProvider(
+        options: ConfigurableModuleAsyncOptions<ModuleOptions>,
+      ): Provider {
+        if (options.useFactory) {
+          return {
+            provide: self.options.optionsInjectionToken!,
+            useFactory: options.useFactory,
+            inject: options.inject || [],
+          };
+        }
+        return {
+          provide: self.options.optionsInjectionToken!,
+          useFactory: async (
+            optionsFactory: ConfigurableModuleOptionsFactory<
+              ModuleOptions,
+              FactoryClassMethodKey
+            >,
+          ) =>
+            await optionsFactory[
+              self.factoryClassMethodKey as keyof typeof optionsFactory
+            ](),
+          inject: [options.useExisting || options.useClass!],
+        };
+      }
+    }
+    return InternalModuleClass as unknown as ConfigurableModuleCls<
+      ModuleOptions,
+      StaticMethodKey,
+      FactoryClassMethodKey
+    >;
+  }
+
+  private createTypeProxy(
+    typeName: 'OPTIONS_TYPE' | 'ASYNC_OPTIONS_TYPE' | 'OptionsFactoryInterface',
+  ) {
+    const proxy = new Proxy(
+      {},
+      {
+        get: () => {
+          throw new Error(
+            `"${typeName}" is not supposed to be used as a value.`,
+          );
+        },
+      },
+    );
+    return proxy as any;
+  }
+}
diff --git a/packages/common/module-utils/constants.ts b/packages/common/module-utils/constants.ts
new file mode 100644
index 000000000..2d97c0c8c
--- /dev/null
+++ b/packages/common/module-utils/constants.ts
@@ -0,0 +1,5 @@
+export const DEFAULT_METHOD_KEY = 'register';
+export const DEFAULT_FACTORY_CLASS_METHOD_KEY = 'create';
+
+export const ASYNC_METHOD_SUFFIX = 'Async';
+export const CONFIGURABLE_MODULE_ID = 'CONFIGURABLE_MODULE_ID';
diff --git a/packages/common/module-utils/index.ts b/packages/common/module-utils/index.ts
new file mode 100644
index 000000000..4393992bd
--- /dev/null
+++ b/packages/common/module-utils/index.ts
@@ -0,0 +1,2 @@
+export * from './configurable-module.builder';
+export * from './interfaces';
diff --git a/packages/common/module-utils/interfaces/configurable-module-async-options.interface.ts b/packages/common/module-utils/interfaces/configurable-module-async-options.interface.ts
new file mode 100644
index 000000000..f87ad6dc4
--- /dev/null
+++ b/packages/common/module-utils/interfaces/configurable-module-async-options.interface.ts
@@ -0,0 +1,63 @@
+import {
+  FactoryProvider,
+  ModuleMetadata,
+  Provider,
+  Type,
+} from '../../interfaces';
+import { DEFAULT_FACTORY_CLASS_METHOD_KEY } from '../constants';
+
+/**
+ * Interface that must be implemented by the module options factory class.
+ * Method key varies depending on the "FactoryClassMethodKey" type argument.
+ *
+ * @publicApi
+ */
+export type ConfigurableModuleOptionsFactory<
+  ModuleOptions,
+  FactoryClassMethodKey extends string,
+> = Record<
+  `${FactoryClassMethodKey}`,
+  () => Promise<ModuleOptions> | ModuleOptions
+>;
+
+/**
+ * Interface that represents the module async options object
+ * Factory method name varies depending on the "FactoryClassMethodKey" type argument.
+ *
+ * @publicApi
+ */
+export interface ConfigurableModuleAsyncOptions<
+  ModuleOptions,
+  FactoryClassMethodKey extends
+    string = typeof DEFAULT_FACTORY_CLASS_METHOD_KEY,
+> extends Pick<ModuleMetadata, 'imports'> {
+  /**
+   * Injection token resolving to an existing provider. The provider must implement
+   * the corresponding interface.
+   */
+  useExisting?: Type<
+    ConfigurableModuleOptionsFactory<ModuleOptions, FactoryClassMethodKey>
+  >;
+  /**
+   * Injection token resolving to a class that will be instantiated as a provider.
+   * The class must implement the corresponding interface.
+   */
+  useClass?: Type<
+    ConfigurableModuleOptionsFactory<ModuleOptions, FactoryClassMethodKey>
+  >;
+  /**
+   * Function returning options (or a Promise resolving to options) to configure the
+   * cache module.
+   */
+  useFactory?: (...args: any[]) => Promise<ModuleOptions> | ModuleOptions;
+  /**
+   * Dependencies that a Factory may inject.
+   */
+  inject?: FactoryProvider['inject'];
+  /**
+   * List of parent module's providers that will be filtered to only provide necessary
+   * providers for the 'inject' array
+   * useful to pass options to nested async modules
+   */
+  provideInjectionTokensFrom?: Provider[];
+}
diff --git a/packages/common/module-utils/interfaces/configurable-module-cls.interface.ts b/packages/common/module-utils/interfaces/configurable-module-cls.interface.ts
new file mode 100644
index 000000000..e88dba8d2
--- /dev/null
+++ b/packages/common/module-utils/interfaces/configurable-module-cls.interface.ts
@@ -0,0 +1,39 @@
+/* eslint-disable @typescript-eslint/no-empty-object-type */
+import { DynamicModule } from '../../interfaces';
+import {
+  DEFAULT_FACTORY_CLASS_METHOD_KEY,
+  DEFAULT_METHOD_KEY,
+} from '../constants';
+import { ConfigurableModuleAsyncOptions } from './configurable-module-async-options.interface';
+
+/**
+ * Class that represents a blueprint/prototype for a configurable Nest module.
+ * This class provides static methods for constructing dynamic modules. Their names
+ * can be controlled through the "MethodKey" type argument.
+ *
+ * @publicApi
+ */
+export type ConfigurableModuleCls<
+  ModuleOptions,
+  MethodKey extends string = typeof DEFAULT_METHOD_KEY,
+  FactoryClassMethodKey extends
+    string = typeof DEFAULT_FACTORY_CLASS_METHOD_KEY,
+  ExtraModuleDefinitionOptions = {},
+> = {
+  new (): any;
+} & Record<
+  `${MethodKey}`,
+  (
+    options: ModuleOptions & Partial<ExtraModuleDefinitionOptions>,
+  ) => DynamicModule
+> &
+  Record<
+    `${MethodKey}Async`,
+    (
+      options: ConfigurableModuleAsyncOptions<
+        ModuleOptions,
+        FactoryClassMethodKey
+      > &
+        Partial<ExtraModuleDefinitionOptions>,
+    ) => DynamicModule
+  >;
diff --git a/packages/common/module-utils/interfaces/configurable-module-host.interface.ts b/packages/common/module-utils/interfaces/configurable-module-host.interface.ts
new file mode 100644
index 000000000..fb23d2d2a
--- /dev/null
+++ b/packages/common/module-utils/interfaces/configurable-module-host.interface.ts
@@ -0,0 +1,78 @@
+/* eslint-disable @typescript-eslint/no-empty-object-type */
+import { ConfigurableModuleAsyncOptions } from './configurable-module-async-options.interface';
+import { ConfigurableModuleCls } from './configurable-module-cls.interface';
+
+/**
+ * Configurable module host. See properties for more details
+ *
+ * @publicApi
+ */
+export interface ConfigurableModuleHost<
+  ModuleOptions = Record<string, unknown>,
+  MethodKey extends string = string,
+  FactoryClassMethodKey extends string = string,
+  ExtraModuleDefinitionOptions = {},
+> {
+  /**
+   * Class that represents a blueprint/prototype for a configurable Nest module.
+   * This class provides static methods for constructing dynamic modules. Their names
+   * can be controlled through the "MethodKey" type argument.
+   *
+   * Your module class should inherit from this class to make the static methods available.
+   *
+   * @example
+   * ```typescript
+   * @Module({})
+   * class IntegrationModule extends ConfigurableModuleCls {
+   *  // ...
+   * }
+   * ```
+   */
+  ConfigurableModuleClass: ConfigurableModuleCls<
+    ModuleOptions,
+    MethodKey,
+    FactoryClassMethodKey,
+    ExtraModuleDefinitionOptions
+  >;
+  /**
+   * Module options provider token. Can be used to inject the "options object" to
+   * providers registered within the host module.
+   */
+  MODULE_OPTIONS_TOKEN: string | symbol;
+  /**
+   * Can be used to auto-infer the compound "async module options" type.
+   * Note: this property is not supposed to be used as a value.
+   *
+   * @example
+   * ```typescript
+   * @Module({})
+   * class IntegrationModule extends ConfigurableModuleCls {
+   *  static module = initializer(IntegrationModule);
+   *
+   * static registerAsync(options: typeof ASYNC_OPTIONS_TYPE): DynamicModule {
+   *  return super.registerAsync(options);
+   * }
+   * ```
+   */
+  ASYNC_OPTIONS_TYPE: ConfigurableModuleAsyncOptions<
+    ModuleOptions,
+    FactoryClassMethodKey
+  > &
+    Partial<ExtraModuleDefinitionOptions>;
+  /**
+   * Can be used to auto-infer the compound "module options" type (options interface + extra module definition options).
+   * Note: this property is not supposed to be used as a value.
+   *
+   * @example
+   * ```typescript
+   * @Module({})
+   * class IntegrationModule extends ConfigurableModuleCls {
+   *  static module = initializer(IntegrationModule);
+   *
+   * static register(options: typeof OPTIONS_TYPE): DynamicModule {
+   *  return super.register(options);
+   * }
+   * ```
+   */
+  OPTIONS_TYPE: ModuleOptions & Partial<ExtraModuleDefinitionOptions>;
+}
diff --git a/packages/common/module-utils/interfaces/index.ts b/packages/common/module-utils/interfaces/index.ts
new file mode 100644
index 000000000..35c523076
--- /dev/null
+++ b/packages/common/module-utils/interfaces/index.ts
@@ -0,0 +1,3 @@
+export * from './configurable-module-async-options.interface';
+export * from './configurable-module-cls.interface';
+export * from './configurable-module-host.interface';
diff --git a/packages/common/module-utils/utils/generate-options-injection-token.util.ts b/packages/common/module-utils/utils/generate-options-injection-token.util.ts
new file mode 100644
index 000000000..259a6afa3
--- /dev/null
+++ b/packages/common/module-utils/utils/generate-options-injection-token.util.ts
@@ -0,0 +1,6 @@
+import { randomStringGenerator } from '../../utils/random-string-generator.util';
+
+export function generateOptionsInjectionToken() {
+  const hash = randomStringGenerator();
+  return `CONFIGURABLE_MODULE_OPTIONS[${hash}]`;
+}
diff --git a/packages/common/module-utils/utils/get-injection-providers.util.ts b/packages/common/module-utils/utils/get-injection-providers.util.ts
new file mode 100644
index 000000000..f4057d203
--- /dev/null
+++ b/packages/common/module-utils/utils/get-injection-providers.util.ts
@@ -0,0 +1,52 @@
+import { isUndefined } from '../../utils/shared.utils';
+import {
+  FactoryProvider,
+  InjectionToken,
+  OptionalFactoryDependency,
+  Provider,
+} from '../../interfaces';
+
+/**
+ * @param value
+ * @returns `true` if value is `OptionalFactoryDependency`
+ */
+function isOptionalFactoryDependency(
+  value: InjectionToken | OptionalFactoryDependency,
+): value is OptionalFactoryDependency {
+  return (
+    !isUndefined((value as OptionalFactoryDependency).token) &&
+    !isUndefined((value as OptionalFactoryDependency).optional) &&
+    !(value as any).prototype
+  );
+}
+
+const mapInjectToTokens = (t: InjectionToken | OptionalFactoryDependency) =>
+  isOptionalFactoryDependency(t) ? t.token : t;
+
+/**
+ *
+ * @param providers List of a module's providers
+ * @param tokens Injection tokens needed for a useFactory function (usually the module's options' token)
+ * @returns All the providers needed for the tokens' injection (searched recursively)
+ */
+export function getInjectionProviders(
+  providers: Provider[],
+  tokens: FactoryProvider['inject'],
+): Provider[] {
+  const result: Provider[] = [];
+  let search: InjectionToken[] = tokens!.map(mapInjectToTokens);
+  while (search.length > 0) {
+    const match = (providers ?? []).filter(
+      p =>
+        !result.includes(p) && // this prevents circular loops and duplication
+        (search.includes(p as any) || search.includes((p as any)?.provide)),
+    );
+    result.push(...match);
+    // get injection tokens of the matched providers, if any
+    search = match
+      .filter(p => (p as any)?.inject)
+      .flatMap(p => (p as FactoryProvider).inject!)
+      .map(mapInjectToTokens);
+  }
+  return result;
+}
diff --git a/packages/common/module-utils/utils/index.ts b/packages/common/module-utils/utils/index.ts
new file mode 100644
index 000000000..7125be0f7
--- /dev/null
+++ b/packages/common/module-utils/utils/index.ts
@@ -0,0 +1,2 @@
+export * from './generate-options-injection-token.util';
+export * from './get-injection-providers.util';
diff --git a/packages/common/package.json b/packages/common/package.json
index 95c5d608a..c9eb94c76 100644
--- a/packages/common/package.json
+++ b/packages/common/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/common",
-  "version": "8.2.5",
+  "version": "10.4.11",
   "description": "Nest - modern, fast, powerful node.js web framework (@common)",
   "author": "Kamil Mysliwiec",
   "homepage": "https://nestjs.com",
@@ -10,29 +10,25 @@
   },
   "repository": {
     "type": "git",
-    "url": "https://github.com/nestjs/nest"
+    "url": "https://github.com/nestjs/nest.git",
+    "directory": "packages/common"
   },
   "publishConfig": {
     "access": "public"
   },
   "license": "MIT",
   "dependencies": {
-    "axios": "0.24.0",
     "iterare": "1.2.1",
-    "tslib": "2.3.1",
-    "uuid": "8.3.2"
+    "tslib": "2.7.0",
+    "uid": "2.0.2"
   },
   "peerDependencies": {
-    "cache-manager": "*",
     "class-transformer": "*",
     "class-validator": "*",
-    "reflect-metadata": "^0.1.12",
+    "reflect-metadata": "^0.1.12 || ^0.2.0",
     "rxjs": "^7.1.0"
   },
   "peerDependenciesMeta": {
-    "cache-manager": {
-      "optional": true
-    },
     "class-validator": {
       "optional": true
     },
diff --git a/packages/common/pipes/default-value.pipe.ts b/packages/common/pipes/default-value.pipe.ts
index 4ce7d9701..65716f497 100644
--- a/packages/common/pipes/default-value.pipe.ts
+++ b/packages/common/pipes/default-value.pipe.ts
@@ -16,7 +16,7 @@ import { isNil, isNumber } from '../utils/shared.utils';
 export class DefaultValuePipe<T = any, R = any>
   implements PipeTransform<T, T | R>
 {
-  constructor(private readonly defaultValue: R) {}
+  constructor(protected readonly defaultValue: R) {}
 
   transform(value?: T, _metadata?: ArgumentMetadata): T | R {
     if (
diff --git a/packages/common/pipes/file/file-type.validator.ts b/packages/common/pipes/file/file-type.validator.ts
new file mode 100644
index 000000000..e18ae1560
--- /dev/null
+++ b/packages/common/pipes/file/file-type.validator.ts
@@ -0,0 +1,38 @@
+import { FileValidator } from './file-validator.interface';
+import { IFile } from './interfaces';
+
+export type FileTypeValidatorOptions = {
+  fileType: string | RegExp;
+};
+
+/**
+ * Defines the built-in FileType File Validator. It validates incoming files mime-type
+ * matching a string or a regular expression. Note that this validator uses a naive strategy
+ * to check the mime-type and could be fooled if the client provided a file with renamed extension.
+ * (for instance, renaming a 'malicious.bat' to 'malicious.jpeg'). To handle such security issues
+ * with more reliability, consider checking against the file's [magic-numbers](https://en.wikipedia.org/wiki/Magic_number_%28programming%29)
+ *
+ * @see [File Validators](https://docs.nestjs.com/techniques/file-upload#validators)
+ *
+ * @publicApi
+ */
+export class FileTypeValidator extends FileValidator<
+  FileTypeValidatorOptions,
+  IFile
+> {
+  buildErrorMessage(): string {
+    return `Validation failed (expected type is ${this.validationOptions.fileType})`;
+  }
+
+  isValid(file?: IFile): boolean {
+    if (!this.validationOptions) {
+      return true;
+    }
+
+    return (
+      !!file &&
+      'mimetype' in file &&
+      !!file.mimetype.match(this.validationOptions.fileType)
+    );
+  }
+}
diff --git a/packages/common/pipes/file/file-validator.interface.ts b/packages/common/pipes/file/file-validator.interface.ts
new file mode 100644
index 000000000..326a55f72
--- /dev/null
+++ b/packages/common/pipes/file/file-validator.interface.ts
@@ -0,0 +1,28 @@
+import { IFile } from './interfaces';
+
+/**
+ * Interface describing FileValidators, which can be added to a ParseFilePipe
+ *
+ * @see {ParseFilePipe}
+ * @publicApi
+ */
+export abstract class FileValidator<
+  TValidationOptions = Record<string, any>,
+  TFile extends IFile = IFile,
+> {
+  constructor(protected readonly validationOptions: TValidationOptions) {}
+
+  /**
+   * Indicates if this file should be considered valid, according to the options passed in the constructor.
+   * @param file the file from the request object
+   */
+  abstract isValid(
+    file?: TFile | TFile[] | Record<string, TFile[]>,
+  ): boolean | Promise<boolean>;
+
+  /**
+   * Builds an error message in case the validation fails.
+   * @param file the file from the request object
+   */
+  abstract buildErrorMessage(file: any): string;
+}
diff --git a/packages/common/pipes/file/index.ts b/packages/common/pipes/file/index.ts
new file mode 100644
index 000000000..11d19e318
--- /dev/null
+++ b/packages/common/pipes/file/index.ts
@@ -0,0 +1,6 @@
+export * from './file-type.validator';
+export * from './file-validator.interface';
+export * from './max-file-size.validator';
+export * from './parse-file-options.interface';
+export * from './parse-file.pipe';
+export * from './parse-file-pipe.builder';
diff --git a/packages/common/pipes/file/interfaces/file.interface.ts b/packages/common/pipes/file/interfaces/file.interface.ts
new file mode 100644
index 000000000..37218734f
--- /dev/null
+++ b/packages/common/pipes/file/interfaces/file.interface.ts
@@ -0,0 +1,4 @@
+export interface IFile {
+  mimetype: string;
+  size: number;
+}
diff --git a/packages/common/pipes/file/interfaces/index.ts b/packages/common/pipes/file/interfaces/index.ts
new file mode 100644
index 000000000..09d8f3ca8
--- /dev/null
+++ b/packages/common/pipes/file/interfaces/index.ts
@@ -0,0 +1 @@
+export * from './file.interface';
diff --git a/packages/common/pipes/file/max-file-size.validator.ts b/packages/common/pipes/file/max-file-size.validator.ts
new file mode 100644
index 000000000..024bc5324
--- /dev/null
+++ b/packages/common/pipes/file/max-file-size.validator.ts
@@ -0,0 +1,39 @@
+import { FileValidator } from './file-validator.interface';
+import { IFile } from './interfaces';
+
+export type MaxFileSizeValidatorOptions = {
+  maxSize: number;
+  message?: string | ((maxSize: number) => string);
+};
+
+/**
+ * Defines the built-in MaxSize File Validator
+ *
+ * @see [File Validators](https://docs.nestjs.com/techniques/file-upload#file-validation)
+ *
+ * @publicApi
+ */
+export class MaxFileSizeValidator extends FileValidator<
+  MaxFileSizeValidatorOptions,
+  IFile
+> {
+  buildErrorMessage(): string {
+    if ('message' in this.validationOptions) {
+      if (typeof this.validationOptions.message === 'function') {
+        return this.validationOptions.message(this.validationOptions.maxSize);
+      }
+
+      return this.validationOptions.message!;
+    }
+
+    return `Validation failed (expected size is less than ${this.validationOptions.maxSize})`;
+  }
+
+  public isValid(file?: IFile): boolean {
+    if (!this.validationOptions || !file) {
+      return true;
+    }
+
+    return 'size' in file && file.size < this.validationOptions.maxSize;
+  }
+}
diff --git a/packages/common/pipes/file/parse-file-options.interface.ts b/packages/common/pipes/file/parse-file-options.interface.ts
new file mode 100644
index 000000000..f9c67daa8
--- /dev/null
+++ b/packages/common/pipes/file/parse-file-options.interface.ts
@@ -0,0 +1,17 @@
+import { ErrorHttpStatusCode } from '../../utils/http-error-by-code.util';
+import { FileValidator } from './file-validator.interface';
+
+/**
+ * @publicApi
+ */
+export interface ParseFileOptions {
+  validators?: FileValidator[];
+  errorHttpStatusCode?: ErrorHttpStatusCode;
+  exceptionFactory?: (error: string) => any;
+
+  /**
+   * Defines if file parameter is required.
+   * @default true
+   */
+  fileIsRequired?: boolean;
+}
diff --git a/packages/common/pipes/file/parse-file-pipe.builder.ts b/packages/common/pipes/file/parse-file-pipe.builder.ts
new file mode 100644
index 000000000..9199fec3d
--- /dev/null
+++ b/packages/common/pipes/file/parse-file-pipe.builder.ts
@@ -0,0 +1,43 @@
+import {
+  FileTypeValidator,
+  FileTypeValidatorOptions,
+} from './file-type.validator';
+import { FileValidator } from './file-validator.interface';
+import {
+  MaxFileSizeValidator,
+  MaxFileSizeValidatorOptions,
+} from './max-file-size.validator';
+import { ParseFileOptions } from './parse-file-options.interface';
+import { ParseFilePipe } from './parse-file.pipe';
+
+/**
+ * @publicApi
+ */
+export class ParseFilePipeBuilder {
+  private validators: FileValidator[] = [];
+
+  addMaxSizeValidator(options: MaxFileSizeValidatorOptions) {
+    return this.addValidator(new MaxFileSizeValidator(options));
+  }
+
+  addFileTypeValidator(options: FileTypeValidatorOptions) {
+    return this.addValidator(new FileTypeValidator(options));
+  }
+
+  addValidator(validator: FileValidator) {
+    this.validators.push(validator);
+    return this;
+  }
+
+  build(
+    additionalOptions?: Omit<ParseFileOptions, 'validators'>,
+  ): ParseFilePipe {
+    const parseFilePipe = new ParseFilePipe({
+      ...additionalOptions,
+      validators: this.validators,
+    });
+
+    this.validators = [];
+    return parseFilePipe;
+  }
+}
diff --git a/packages/common/pipes/file/parse-file.pipe.ts b/packages/common/pipes/file/parse-file.pipe.ts
new file mode 100644
index 000000000..d2ea60e50
--- /dev/null
+++ b/packages/common/pipes/file/parse-file.pipe.ts
@@ -0,0 +1,90 @@
+import { Injectable, Optional } from '../../decorators/core';
+import { HttpStatus } from '../../enums';
+import { PipeTransform } from '../../interfaces/features/pipe-transform.interface';
+import { HttpErrorByCode } from '../../utils/http-error-by-code.util';
+import { isEmpty, isObject, isUndefined } from '../../utils/shared.utils';
+import { FileValidator } from './file-validator.interface';
+import { ParseFileOptions } from './parse-file-options.interface';
+
+/**
+ * Defines the built-in ParseFile Pipe. This pipe can be used to validate incoming files
+ * with `@UploadedFile()` decorator. You can use either other specific built-in validators
+ * or provide one of your own, simply implementing it through FileValidator interface
+ * and adding it to ParseFilePipe's constructor.
+ *
+ * @see [Built-in Pipes](https://docs.nestjs.com/pipes#built-in-pipes)
+ *
+ * @publicApi
+ */
+@Injectable()
+export class ParseFilePipe implements PipeTransform<any> {
+  protected exceptionFactory: (error: string) => any;
+  private readonly validators: FileValidator[];
+  private readonly fileIsRequired: boolean;
+
+  constructor(@Optional() options: ParseFileOptions = {}) {
+    const {
+      exceptionFactory,
+      errorHttpStatusCode = HttpStatus.BAD_REQUEST,
+      validators = [],
+      fileIsRequired,
+    } = options;
+
+    this.exceptionFactory =
+      exceptionFactory ||
+      (error => new HttpErrorByCode[errorHttpStatusCode](error));
+
+    this.validators = validators;
+    this.fileIsRequired = fileIsRequired ?? true;
+  }
+
+  async transform(value: any): Promise<any> {
+    const areThereAnyFilesIn = this.thereAreNoFilesIn(value);
+
+    if (areThereAnyFilesIn && this.fileIsRequired) {
+      throw this.exceptionFactory('File is required');
+    }
+    if (!areThereAnyFilesIn && this.validators.length) {
+      await this.validateFilesOrFile(value);
+    }
+
+    return value;
+  }
+
+  private async validateFilesOrFile(value: any): Promise<void> {
+    if (Array.isArray(value)) {
+      await Promise.all(value.map(f => this.validate(f)));
+    } else {
+      await this.validate(value);
+    }
+  }
+
+  private thereAreNoFilesIn(value: any): boolean {
+    const isEmptyArray = Array.isArray(value) && isEmpty(value);
+    const isEmptyObject = isObject(value) && isEmpty(Object.keys(value));
+    return isUndefined(value) || isEmptyArray || isEmptyObject;
+  }
+
+  protected async validate(file: any): Promise<any> {
+    for (const validator of this.validators) {
+      await this.validateOrThrow(file, validator);
+    }
+    return file;
+  }
+
+  private async validateOrThrow(file: any, validator: FileValidator) {
+    const isValid = await validator.isValid(file);
+
+    if (!isValid) {
+      const errorMessage = validator.buildErrorMessage(file);
+      throw this.exceptionFactory(errorMessage);
+    }
+  }
+
+  /**
+   * @returns list of validators used in this pipe.
+   */
+  getValidators() {
+    return this.validators;
+  }
+}
diff --git a/packages/common/pipes/index.ts b/packages/common/pipes/index.ts
index a69365493..f416b9467 100644
--- a/packages/common/pipes/index.ts
+++ b/packages/common/pipes/index.ts
@@ -1,8 +1,10 @@
 export * from './default-value.pipe';
+export * from './file';
 export * from './parse-array.pipe';
 export * from './parse-bool.pipe';
-export * from './parse-int.pipe';
-export * from './parse-float.pipe';
+export * from './parse-date.pipe';
 export * from './parse-enum.pipe';
+export * from './parse-float.pipe';
+export * from './parse-int.pipe';
 export * from './parse-uuid.pipe';
 export * from './validation.pipe';
diff --git a/packages/common/pipes/parse-array.pipe.ts b/packages/common/pipes/parse-array.pipe.ts
index 6ede5cf0b..349e831be 100644
--- a/packages/common/pipes/parse-array.pipe.ts
+++ b/packages/common/pipes/parse-array.pipe.ts
@@ -7,20 +7,40 @@ import {
   PipeTransform,
 } from '../interfaces/features/pipe-transform.interface';
 import { HttpErrorByCode } from '../utils/http-error-by-code.util';
-import { isNil, isUndefined, isString } from '../utils/shared.utils';
+import { isNil, isString, isUndefined } from '../utils/shared.utils';
 import { ValidationPipe, ValidationPipeOptions } from './validation.pipe';
 
 const VALIDATION_ERROR_MESSAGE = 'Validation failed (parsable array expected)';
 const DEFAULT_ARRAY_SEPARATOR = ',';
 
+/**
+ * @publicApi
+ */
 export interface ParseArrayOptions
   extends Omit<
     ValidationPipeOptions,
     'transform' | 'validateCustomDecorators' | 'exceptionFactory'
   > {
+  /**
+   * Type for items to be converted into
+   */
   items?: Type<unknown>;
+  /**
+   * Items separator to split string by
+   * @default ','
+   */
   separator?: string;
+  /**
+   * If true, the pipe will return null or undefined if the value is not provided
+   * @default false
+   */
   optional?: boolean;
+  /**
+   * A factory function that returns an exception object to be thrown
+   * if validation fails.
+   * @param error Error message or object
+   * @returns The exception object
+   */
   exceptionFactory?: (error: any) => any;
 }
 
@@ -36,7 +56,7 @@ export class ParseArrayPipe implements PipeTransform {
   protected readonly validationPipe: ValidationPipe;
   protected exceptionFactory: (error: string) => any;
 
-  constructor(@Optional() private readonly options: ParseArrayOptions = {}) {
+  constructor(@Optional() protected readonly options: ParseArrayOptions = {}) {
     this.validationPipe = new ValidationPipe({
       transform: true,
       validateCustomDecorators: true,
@@ -85,10 +105,13 @@ export class ParseArrayPipe implements PipeTransform {
 
       const isExpectedTypePrimitive = this.isExpectedTypePrimitive();
       const toClassInstance = (item: any, index?: number) => {
-        try {
-          item = JSON.parse(item);
-        } catch {}
-
+        if (this.options.items !== String) {
+          try {
+            item = JSON.parse(item);
+          } catch {
+            // Do nothing
+          }
+        }
         if (isExpectedTypePrimitive) {
           return this.validatePrimitive(item, index);
         }
@@ -97,16 +120,16 @@ export class ParseArrayPipe implements PipeTransform {
       if (this.options.stopAtFirstError === false) {
         // strict compare to "false" to make sure
         // that this option is disabled by default
-        let errors = [];
+        let errors: string[] = [];
 
         const targetArray = value as Array<unknown>;
         for (let i = 0; i < targetArray.length; i++) {
           try {
             targetArray[i] = await toClassInstance(targetArray[i]);
           } catch (err) {
-            let message: string[] | unknown;
-            if ((err as any).getResponse) {
-              const response = (err as any).getResponse();
+            let message: string[] | string;
+            if (err.getResponse) {
+              const response = err.getResponse();
               if (Array.isArray(response.message)) {
                 message = response.message.map(
                   (item: string) => `[${i}] ${item}`,
diff --git a/packages/common/pipes/parse-bool.pipe.ts b/packages/common/pipes/parse-bool.pipe.ts
index 5876144d9..16296f058 100644
--- a/packages/common/pipes/parse-bool.pipe.ts
+++ b/packages/common/pipes/parse-bool.pipe.ts
@@ -9,10 +9,28 @@ import {
   ErrorHttpStatusCode,
   HttpErrorByCode,
 } from '../utils/http-error-by-code.util';
+import { isNil } from '../utils/shared.utils';
 
+/**
+ * @publicApi
+ */
 export interface ParseBoolPipeOptions {
+  /**
+   * The HTTP status code to be used in the response when the validation fails.
+   */
   errorHttpStatusCode?: ErrorHttpStatusCode;
+  /**
+   * A factory function that returns an exception object to be thrown
+   * if validation fails.
+   * @param error Error message
+   * @returns The exception object
+   */
   exceptionFactory?: (error: string) => any;
+  /**
+   * If true, the pipe will return null or undefined if the value is not provided
+   * @default false
+   */
+  optional?: boolean;
 }
 
 /**
@@ -28,7 +46,7 @@ export class ParseBoolPipe
 {
   protected exceptionFactory: (error: string) => any;
 
-  constructor(@Optional() options?: ParseBoolPipeOptions) {
+  constructor(@Optional() protected readonly options?: ParseBoolPipeOptions) {
     options = options || {};
     const { exceptionFactory, errorHttpStatusCode = HttpStatus.BAD_REQUEST } =
       options;
@@ -48,14 +66,35 @@ export class ParseBoolPipe
     value: string | boolean,
     metadata: ArgumentMetadata,
   ): Promise<boolean> {
-    if (value === true || value === 'true') {
+    if (isNil(value) && this.options?.optional) {
+      return value;
+    }
+    if (this.isTrue(value)) {
       return true;
     }
-    if (value === false || value === 'false') {
+    if (this.isFalse(value)) {
       return false;
     }
     throw this.exceptionFactory(
       'Validation failed (boolean string is expected)',
     );
   }
+
+  /**
+   * @param value currently processed route argument
+   * @returns `true` if `value` is said 'true', ie., if it is equal to the boolean
+   * `true` or the string `"true"`
+   */
+  protected isTrue(value: string | boolean): boolean {
+    return value === true || value === 'true';
+  }
+
+  /**
+   * @param value currently processed route argument
+   * @returns `true` if `value` is said 'false', ie., if it is equal to the boolean
+   * `false` or the string `"false"`
+   */
+  protected isFalse(value: string | boolean): boolean {
+    return value === false || value === 'false';
+  }
 }
diff --git a/packages/common/pipes/parse-date.pipe.ts b/packages/common/pipes/parse-date.pipe.ts
new file mode 100644
index 000000000..c2417b476
--- /dev/null
+++ b/packages/common/pipes/parse-date.pipe.ts
@@ -0,0 +1,74 @@
+import { Injectable } from '../decorators/core/injectable.decorator';
+import { HttpStatus } from '../enums/http-status.enum';
+import { PipeTransform } from '../interfaces/features/pipe-transform.interface';
+import {
+  ErrorHttpStatusCode,
+  HttpErrorByCode,
+} from '../utils/http-error-by-code.util';
+import { isNil } from '../utils/shared.utils';
+
+export interface ParseDatePipeOptions {
+  /**
+   * If true, the pipe will return null or undefined if the value is not provided
+   * @default false
+   */
+  optional?: boolean;
+  /**
+   * Default value for the date
+   */
+  default?: () => Date;
+  /**
+   * The HTTP status code to be used in the response when the validation fails.
+   */
+  errorHttpStatusCode?: ErrorHttpStatusCode;
+  /**
+   * A factory function that returns an exception object to be thrown
+   * if validation fails.
+   * @param error Error message
+   * @returns The exception object
+   */
+  exceptionFactory?: (error: string) => any;
+}
+
+@Injectable()
+export class ParseDatePipe
+  implements PipeTransform<string | number | undefined | null>
+{
+  protected exceptionFactory: (error: string) => any;
+
+  constructor(private readonly options: ParseDatePipeOptions = {}) {
+    const { exceptionFactory, errorHttpStatusCode = HttpStatus.BAD_REQUEST } =
+      options;
+
+    this.exceptionFactory =
+      exceptionFactory ||
+      (error => new HttpErrorByCode[errorHttpStatusCode](error));
+  }
+
+  /**
+   * Method that accesses and performs optional transformation on argument for
+   * in-flight requests.
+   *
+   * @param value currently processed route argument
+   * @param metadata contains metadata about the currently processed route argument
+   */
+  transform(
+    value: string | number | undefined | null,
+  ): Date | null | undefined {
+    if (this.options.optional && isNil(value)) {
+      return this.options.default ? this.options.default() : value;
+    }
+
+    if (!value) {
+      throw this.exceptionFactory('Validation failed (no Date provided)');
+    }
+
+    const transformedValue = new Date(value);
+
+    if (isNaN(transformedValue.getTime())) {
+      throw this.exceptionFactory('Validation failed (invalid date format)');
+    }
+
+    return transformedValue;
+  }
+}
diff --git a/packages/common/pipes/parse-enum.pipe.ts b/packages/common/pipes/parse-enum.pipe.ts
index 406f61727..47f3c263a 100644
--- a/packages/common/pipes/parse-enum.pipe.ts
+++ b/packages/common/pipes/parse-enum.pipe.ts
@@ -1,12 +1,31 @@
-import { ArgumentMetadata, HttpStatus, Injectable, Optional } from '../index';
+import { Injectable, Optional } from '../decorators/core';
+import { ArgumentMetadata, HttpStatus } from '../index';
 import { PipeTransform } from '../interfaces/features/pipe-transform.interface';
 import {
   ErrorHttpStatusCode,
   HttpErrorByCode,
 } from '../utils/http-error-by-code.util';
+import { isNil } from '../utils/shared.utils';
 
+/**
+ * @publicApi
+ */
 export interface ParseEnumPipeOptions {
+  /**
+   * If true, the pipe will return null or undefined if the value is not provided
+   * @default false
+   */
+  optional?: boolean;
+  /**
+   * The HTTP status code to be used in the response when the validation fails.
+   */
   errorHttpStatusCode?: ErrorHttpStatusCode;
+  /**
+   * A factory function that returns an exception object to be thrown
+   * if validation fails.
+   * @param error Error message
+   * @returns The exception object
+   */
   exceptionFactory?: (error: string) => any;
 }
 
@@ -20,10 +39,9 @@ export interface ParseEnumPipeOptions {
 @Injectable()
 export class ParseEnumPipe<T = any> implements PipeTransform<T> {
   protected exceptionFactory: (error: string) => any;
-
   constructor(
     protected readonly enumType: T,
-    @Optional() options?: ParseEnumPipeOptions,
+    @Optional() protected readonly options?: ParseEnumPipeOptions,
   ) {
     if (!enumType) {
       throw new Error(
@@ -47,6 +65,9 @@ export class ParseEnumPipe<T = any> implements PipeTransform<T> {
    * @param metadata contains metadata about the currently processed route argument
    */
   async transform(value: T, metadata: ArgumentMetadata): Promise<T> {
+    if (isNil(value) && this.options?.optional) {
+      return value;
+    }
     if (!this.isEnum(value)) {
       throw this.exceptionFactory(
         'Validation failed (enum string is expected)',
@@ -56,7 +77,7 @@ export class ParseEnumPipe<T = any> implements PipeTransform<T> {
   }
 
   protected isEnum(value: T): boolean {
-    const enumValues = Object.keys(this.enumType).map(
+    const enumValues = Object.keys(this.enumType as object).map(
       item => this.enumType[item],
     );
     return enumValues.includes(value);
diff --git a/packages/common/pipes/parse-float.pipe.ts b/packages/common/pipes/parse-float.pipe.ts
index 086152a9b..04f5e97e2 100644
--- a/packages/common/pipes/parse-float.pipe.ts
+++ b/packages/common/pipes/parse-float.pipe.ts
@@ -1,13 +1,32 @@
-import { ArgumentMetadata, HttpStatus, Injectable, Optional } from '../index';
+import { Injectable, Optional } from '../decorators/core';
+import { ArgumentMetadata, HttpStatus } from '../index';
 import { PipeTransform } from '../interfaces/features/pipe-transform.interface';
 import {
   ErrorHttpStatusCode,
   HttpErrorByCode,
 } from '../utils/http-error-by-code.util';
+import { isNil } from '../utils/shared.utils';
 
+/**
+ * @publicApi
+ */
 export interface ParseFloatPipeOptions {
+  /**
+   * The HTTP status code to be used in the response when the validation fails.
+   */
   errorHttpStatusCode?: ErrorHttpStatusCode;
+  /**
+   * A factory function that returns an exception object to be thrown
+   * if validation fails.
+   * @param error Error message
+   * @returns The exception object
+   */
   exceptionFactory?: (error: string) => any;
+  /**
+   * If true, the pipe will return null or undefined if the value is not provided
+   * @default false
+   */
+  optional?: boolean;
 }
 
 /**
@@ -21,7 +40,7 @@ export interface ParseFloatPipeOptions {
 export class ParseFloatPipe implements PipeTransform<string> {
   protected exceptionFactory: (error: string) => any;
 
-  constructor(@Optional() options?: ParseFloatPipeOptions) {
+  constructor(@Optional() protected readonly options?: ParseFloatPipeOptions) {
     options = options || {};
     const { exceptionFactory, errorHttpStatusCode = HttpStatus.BAD_REQUEST } =
       options;
@@ -39,15 +58,26 @@ export class ParseFloatPipe implements PipeTransform<string> {
    * @param metadata contains metadata about the currently processed route argument
    */
   async transform(value: string, metadata: ArgumentMetadata): Promise<number> {
-    const isNumeric =
-      ['string', 'number'].includes(typeof value) &&
-      !isNaN(parseFloat(value)) &&
-      isFinite(value as any);
-    if (!isNumeric) {
+    if (isNil(value) && this.options?.optional) {
+      return value;
+    }
+    if (!this.isNumeric(value)) {
       throw this.exceptionFactory(
         'Validation failed (numeric string is expected)',
       );
     }
     return parseFloat(value);
   }
+
+  /**
+   * @param value currently processed route argument
+   * @returns `true` if `value` is a valid float number
+   */
+  protected isNumeric(value: string): boolean {
+    return (
+      ['string', 'number'].includes(typeof value) &&
+      !isNaN(parseFloat(value)) &&
+      isFinite(value as any)
+    );
+  }
 }
diff --git a/packages/common/pipes/parse-int.pipe.ts b/packages/common/pipes/parse-int.pipe.ts
index 2ba713f85..d74aa0205 100644
--- a/packages/common/pipes/parse-int.pipe.ts
+++ b/packages/common/pipes/parse-int.pipe.ts
@@ -9,10 +9,28 @@ import {
   ErrorHttpStatusCode,
   HttpErrorByCode,
 } from '../utils/http-error-by-code.util';
+import { isNil } from '../utils/shared.utils';
 
+/**
+ * @publicApi
+ */
 export interface ParseIntPipeOptions {
+  /**
+   * The HTTP status code to be used in the response when the validation fails.
+   */
   errorHttpStatusCode?: ErrorHttpStatusCode;
+  /**
+   * A factory function that returns an exception object to be thrown
+   * if validation fails.
+   * @param error Error message
+   * @returns The exception object
+   */
   exceptionFactory?: (error: string) => any;
+  /**
+   * If true, the pipe will return null or undefined if the value is not provided
+   * @default false
+   */
+  optional?: boolean;
 }
 
 /**
@@ -26,7 +44,7 @@ export interface ParseIntPipeOptions {
 export class ParseIntPipe implements PipeTransform<string> {
   protected exceptionFactory: (error: string) => any;
 
-  constructor(@Optional() options?: ParseIntPipeOptions) {
+  constructor(@Optional() protected readonly options?: ParseIntPipeOptions) {
     options = options || {};
     const { exceptionFactory, errorHttpStatusCode = HttpStatus.BAD_REQUEST } =
       options;
@@ -44,15 +62,26 @@ export class ParseIntPipe implements PipeTransform<string> {
    * @param metadata contains metadata about the currently processed route argument
    */
   async transform(value: string, metadata: ArgumentMetadata): Promise<number> {
-    const isNumeric =
-      ['string', 'number'].includes(typeof value) &&
-      /^-?\d+$/.test(value) &&
-      isFinite(value as any);
-    if (!isNumeric) {
+    if (isNil(value) && this.options?.optional) {
+      return value;
+    }
+    if (!this.isNumeric(value)) {
       throw this.exceptionFactory(
         'Validation failed (numeric string is expected)',
       );
     }
     return parseInt(value, 10);
   }
+
+  /**
+   * @param value currently processed route argument
+   * @returns `true` if `value` is a valid integer number
+   */
+  protected isNumeric(value: string): boolean {
+    return (
+      ['string', 'number'].includes(typeof value) &&
+      /^-?\d+$/.test(value) &&
+      isFinite(value as any)
+    );
+  }
 }
diff --git a/packages/common/pipes/parse-uuid.pipe.ts b/packages/common/pipes/parse-uuid.pipe.ts
index 2679e8f93..1c67860b9 100644
--- a/packages/common/pipes/parse-uuid.pipe.ts
+++ b/packages/common/pipes/parse-uuid.pipe.ts
@@ -9,20 +9,54 @@ import {
   ErrorHttpStatusCode,
   HttpErrorByCode,
 } from '../utils/http-error-by-code.util';
-import { isUUID } from '../utils/is-uuid';
+import { isNil, isString } from '../utils/shared.utils';
 
+/**
+ * @publicApi
+ */
 export interface ParseUUIDPipeOptions {
-  version?: '3' | '4' | '5';
+  /**
+   * UUID version to validate
+   */
+  version?: '3' | '4' | '5' | '7';
+  /**
+   * The HTTP status code to be used in the response when the validation fails.
+   */
   errorHttpStatusCode?: ErrorHttpStatusCode;
+  /**
+   * A factory function that returns an exception object to be thrown
+   * if validation fails.
+   * @param error Error message
+   * @returns The exception object
+   */
   exceptionFactory?: (errors: string) => any;
+  /**
+   * If true, the pipe will return null or undefined if the value is not provided
+   * @default false
+   */
+  optional?: boolean;
 }
 
+/**
+ * Defines the built-in ParseUUID Pipe
+ *
+ * @see [Built-in Pipes](https://docs.nestjs.com/pipes#built-in-pipes)
+ *
+ * @publicApi
+ */
 @Injectable()
 export class ParseUUIDPipe implements PipeTransform<string> {
-  private readonly version: '3' | '4' | '5';
+  protected static uuidRegExps = {
+    3: /^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,
+    4: /^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,
+    5: /^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,
+    7: /^[0-9A-F]{8}-[0-9A-F]{4}-7[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,
+    all: /^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i,
+  };
+  private readonly version: '3' | '4' | '5' | '7' | undefined;
   protected exceptionFactory: (errors: string) => any;
 
-  constructor(@Optional() options?: ParseUUIDPipeOptions) {
+  constructor(@Optional() protected readonly options?: ParseUUIDPipeOptions) {
     options = options || {};
     const {
       exceptionFactory,
@@ -35,14 +69,26 @@ export class ParseUUIDPipe implements PipeTransform<string> {
       exceptionFactory ||
       (error => new HttpErrorByCode[errorHttpStatusCode](error));
   }
+
   async transform(value: string, metadata: ArgumentMetadata): Promise<string> {
-    if (!isUUID(value, this.version)) {
+    if (isNil(value) && this.options?.optional) {
+      return value;
+    }
+    if (!this.isUUID(value, this.version)) {
       throw this.exceptionFactory(
-        `Validation failed (uuid ${
-          this.version ? 'v' + this.version : ''
+        `Validation failed (uuid${
+          this.version ? ` v ${this.version}` : ''
         } is expected)`,
       );
     }
     return value;
   }
+
+  protected isUUID(str: unknown, version = 'all') {
+    if (!isString(str)) {
+      throw this.exceptionFactory('The value passed as UUID is not a string');
+    }
+    const pattern = ParseUUIDPipe.uuidRegExps[version];
+    return pattern?.test(str);
+  }
 }
diff --git a/packages/common/pipes/validation.pipe.ts b/packages/common/pipes/validation.pipe.ts
index 65d88ed4a..a0f1cd7a7 100644
--- a/packages/common/pipes/validation.pipe.ts
+++ b/packages/common/pipes/validation.pipe.ts
@@ -1,4 +1,5 @@
 import { iterate } from 'iterare';
+import { types } from 'util';
 import { Optional } from '../decorators';
 import { Injectable } from '../decorators/core';
 import { HttpStatus } from '../enums/http-status.enum';
@@ -17,8 +18,11 @@ import {
   HttpErrorByCode,
 } from '../utils/http-error-by-code.util';
 import { loadPackage } from '../utils/load-package.util';
-import { isNil, isObject } from '../utils/shared.utils';
+import { isNil, isUndefined } from '../utils/shared.utils';
 
+/**
+ * @publicApi
+ */
 export interface ValidationPipeOptions extends ValidatorOptions {
   transform?: boolean;
   disableErrorMessages?: boolean;
@@ -34,14 +38,19 @@ export interface ValidationPipeOptions extends ValidatorOptions {
 let classValidator: ValidatorPackage = {} as any;
 let classTransformer: TransformerPackage = {} as any;
 
+/**
+ * @see [Validation](https://docs.nestjs.com/techniques/validation)
+ *
+ * @publicApi
+ */
 @Injectable()
 export class ValidationPipe implements PipeTransform<any> {
   protected isTransformEnabled: boolean;
   protected isDetailedOutputDisabled?: boolean;
   protected validatorOptions: ValidatorOptions;
-  protected transformOptions: ClassTransformOptions;
+  protected transformOptions: ClassTransformOptions | undefined;
   protected errorHttpStatusCode: ErrorHttpStatusCode;
-  protected expectedType: Type<any>;
+  protected expectedType: Type<any> | undefined;
   protected exceptionFactory: (errors: ValidationError[]) => any;
   protected validateCustomDecorators: boolean;
 
@@ -57,8 +66,10 @@ export class ValidationPipe implements PipeTransform<any> {
       ...validatorOptions
     } = options;
 
+    // @see https://github.com/nestjs/nest/issues/10683#issuecomment-1413690508
+    this.validatorOptions = { forbidUnknownValues: false, ...validatorOptions };
+
     this.isTransformEnabled = !!transform;
-    this.validatorOptions = validatorOptions;
     this.transformOptions = transformOptions;
     this.isDetailedOutputDisabled = disableErrorMessages;
     this.validateCustomDecorators = validateCustomDecorators || false;
@@ -105,12 +116,12 @@ export class ValidationPipe implements PipeTransform<any> {
         : value;
     }
     const originalValue = value;
-    value = this.toEmptyIfNil(value);
+    value = this.toEmptyIfNil(value, metatype);
 
     const isNil = value !== originalValue;
     const isPrimitive = this.isPrimitive(value);
     this.stripProtoKeys(value);
-    let entity = classTransformer.plainToClass(
+    let entity = classTransformer.plainToInstance(
       metatype,
       value,
       this.transformOptions,
@@ -144,7 +155,11 @@ export class ValidationPipe implements PipeTransform<any> {
       // if the value was originally undefined or null, revert it back
       return originalValue;
     }
-    return Object.keys(this.validatorOptions).length > 0
+    // we check if the number of keys of the "validatorOptions" is higher than 1 (instead of 0)
+    // because the "forbidUnknownValues" now fallbacks to "false" (in case it wasn't explicitly specified)
+    const shouldTransformToPlain =
+      Object.keys(this.validatorOptions).length > 1;
+    return shouldTransformToPlain
       ? classTransformer.classToPlain(entity, this.transformOptions)
       : value;
   }
@@ -164,7 +179,7 @@ export class ValidationPipe implements PipeTransform<any> {
     if (type === 'custom' && !this.validateCustomDecorators) {
       return false;
     }
-    const types = [String, Boolean, Number, Array, Object, Buffer];
+    const types = [String, Boolean, Number, Array, Object, Buffer, Date];
     return !types.some(t => metatype === t) && !isNil(metatype);
   }
 
@@ -178,24 +193,65 @@ export class ValidationPipe implements PipeTransform<any> {
       return value;
     }
     if (metatype === Boolean) {
+      if (isUndefined(value)) {
+        // This is an workaround to deal with optional boolean values since
+        // optional booleans shouldn't be parsed to a valid boolean when
+        // they were not defined
+        return undefined;
+      }
+      // Any fasly value but `undefined` will be parsed to `false`
       return value === true || value === 'true';
     }
     if (metatype === Number) {
+      if (isUndefined(value)) {
+        // This is a workaround to deal with optional numeric values since
+        // optional numerics shouldn't be parsed to a valid number when
+        // they were not defined
+        return undefined;
+      }
       return +value;
     }
     return value;
   }
 
-  protected toEmptyIfNil<T = any, R = any>(value: T): R | {} {
-    return isNil(value) ? {} : value;
+  protected toEmptyIfNil<T = any, R = T>(
+    value: T,
+    metatype: Type<unknown> | object,
+  ): R | object | string {
+    if (!isNil(value)) {
+      return value as any as R;
+    }
+    if (
+      typeof metatype === 'function' ||
+      (metatype && 'prototype' in metatype && metatype.prototype?.constructor)
+    ) {
+      return {} as object;
+    }
+    // Builder like SWC require empty string to be returned instead of an empty object
+    // when the value is nil and the metatype is not a class instance, but a plain object (enum, for example).
+    // Otherwise, the error will be thrown.
+    // @see https://github.com/nestjs/nest/issues/12680
+    return '';
   }
 
-  protected stripProtoKeys(value: Record<string, any>) {
+  protected stripProtoKeys(value: any) {
+    if (
+      value == null ||
+      typeof value !== 'object' ||
+      types.isTypedArray(value)
+    ) {
+      return;
+    }
+    if (Array.isArray(value)) {
+      for (const v of value) {
+        this.stripProtoKeys(v);
+      }
+      return;
+    }
     delete value.__proto__;
-    const keys = Object.keys(value);
-    iterate(keys)
-      .filter(key => isObject(value[key]) && value[key])
-      .forEach(key => this.stripProtoKeys(value[key]));
+    for (const key in value) {
+      this.stripProtoKeys(value[key]);
+    }
   }
 
   protected isPrimitive(value: unknown): boolean {
@@ -216,7 +272,7 @@ export class ValidationPipe implements PipeTransform<any> {
       .map(error => this.mapChildrenToValidationErrors(error))
       .flatten()
       .filter(item => !!item.constraints)
-      .map(item => Object.values(item.constraints))
+      .map(item => Object.values(item.constraints!))
       .flatten()
       .toArray();
   }
@@ -228,7 +284,7 @@ export class ValidationPipe implements PipeTransform<any> {
     if (!(error.children && error.children.length)) {
       return [error];
     }
-    const validationErrors = [];
+    const validationErrors: ValidationError[] = [];
     parentPath = parentPath
       ? `${parentPath}.${error.property}`
       : error.property;
diff --git a/packages/common/serializer/class-serializer.interceptor.ts b/packages/common/serializer/class-serializer.interceptor.ts
index 7513447b0..795147d95 100644
--- a/packages/common/serializer/class-serializer.interceptor.ts
+++ b/packages/common/serializer/class-serializer.interceptor.ts
@@ -1,3 +1,4 @@
+import { ClassSerializerContextOptions } from './class-serializer.interfaces';
 import { Observable } from 'rxjs';
 import { map } from 'rxjs/operators';
 import { Inject, Injectable, Optional } from '../decorators/core';
@@ -20,11 +21,17 @@ export interface PlainLiteralObject {
 // between core and common packages
 const REFLECTOR = 'Reflector';
 
+/**
+ * @publicApi
+ */
 export interface ClassSerializerInterceptorOptions
   extends ClassTransformOptions {
   transformerPackage?: TransformerPackage;
 }
 
+/**
+ * @publicApi
+ */
 @Injectable()
 export class ClassSerializerInterceptor implements NestInterceptor {
   constructor(
@@ -63,7 +70,7 @@ export class ClassSerializerInterceptor implements NestInterceptor {
    */
   serialize(
     response: PlainLiteralObject | Array<PlainLiteralObject>,
-    options: ClassTransformOptions,
+    options: ClassSerializerContextOptions,
   ): PlainLiteralObject | Array<PlainLiteralObject> {
     if (!isObject(response) || response instanceof StreamableFile) {
       return response;
@@ -76,25 +83,31 @@ export class ClassSerializerInterceptor implements NestInterceptor {
 
   transformToPlain(
     plainOrClass: any,
-    options: ClassTransformOptions,
+    options: ClassSerializerContextOptions,
   ): PlainLiteralObject {
-    return plainOrClass
-      ? classTransformer.classToPlain(plainOrClass, options)
-      : plainOrClass;
+    if (!plainOrClass) {
+      return plainOrClass;
+    }
+    if (!options.type) {
+      return classTransformer.classToPlain(plainOrClass, options);
+    }
+    if (plainOrClass instanceof options.type) {
+      return classTransformer.classToPlain(plainOrClass, options);
+    }
+    const instance = classTransformer.plainToInstance(
+      options.type,
+      plainOrClass,
+      options,
+    );
+    return classTransformer.classToPlain(instance, options);
   }
 
   protected getContextOptions(
     context: ExecutionContext,
-  ): ClassTransformOptions | undefined {
-    return (
-      this.reflectSerializeMetadata(context.getHandler()) ||
-      this.reflectSerializeMetadata(context.getClass())
-    );
-  }
-
-  private reflectSerializeMetadata(
-    obj: object | Function,
-  ): ClassTransformOptions | undefined {
-    return this.reflector.get(CLASS_SERIALIZER_OPTIONS, obj);
+  ): ClassSerializerContextOptions | undefined {
+    return this.reflector.getAllAndOverride(CLASS_SERIALIZER_OPTIONS, [
+      context.getHandler(),
+      context.getClass(),
+    ]);
   }
 }
diff --git a/packages/common/serializer/class-serializer.interfaces.ts b/packages/common/serializer/class-serializer.interfaces.ts
new file mode 100644
index 000000000..c5404177c
--- /dev/null
+++ b/packages/common/serializer/class-serializer.interfaces.ts
@@ -0,0 +1,9 @@
+import { ClassTransformOptions } from '../interfaces/external/class-transform-options.interface';
+import { Type } from '../interfaces';
+
+/**
+ * @publicApi
+ */
+export interface ClassSerializerContextOptions extends ClassTransformOptions {
+  type?: Type<any>;
+}
diff --git a/packages/common/serializer/decorators/serialize-options.decorator.ts b/packages/common/serializer/decorators/serialize-options.decorator.ts
index 130dd992d..bd92695fd 100644
--- a/packages/common/serializer/decorators/serialize-options.decorator.ts
+++ b/packages/common/serializer/decorators/serialize-options.decorator.ts
@@ -1,6 +1,9 @@
 import { SetMetadata } from '../../decorators';
-import { ClassTransformOptions } from '../../interfaces/external/class-transform-options.interface';
+import { ClassSerializerContextOptions } from '../class-serializer.interfaces';
 import { CLASS_SERIALIZER_OPTIONS } from '../class-serializer.constants';
 
-export const SerializeOptions = (options: ClassTransformOptions) =>
+/**
+ * @publicApi
+ */
+export const SerializeOptions = (options: ClassSerializerContextOptions) =>
   SetMetadata(CLASS_SERIALIZER_OPTIONS, options);
diff --git a/packages/common/serializer/index.ts b/packages/common/serializer/index.ts
index 682c46707..828c4aec4 100644
--- a/packages/common/serializer/index.ts
+++ b/packages/common/serializer/index.ts
@@ -1,2 +1,3 @@
 export * from './class-serializer.interceptor';
 export * from './decorators';
+export * from './class-serializer.interfaces';
diff --git a/packages/common/services/console-logger.service.ts b/packages/common/services/console-logger.service.ts
index 5ae5c570c..2f9fd396b 100644
--- a/packages/common/services/console-logger.service.ts
+++ b/packages/common/services/console-logger.service.ts
@@ -1,10 +1,17 @@
-import { Injectable } from '../decorators/core/injectable.decorator';
-import { Optional } from '../decorators/core/optional.decorator';
+import { inspect, InspectOptions } from 'util';
+import { Injectable, Optional } from '../decorators/core';
 import { clc, yellow } from '../utils/cli-colors.util';
-import { isPlainObject, isString } from '../utils/shared.utils';
+import {
+  isFunction,
+  isPlainObject,
+  isString,
+  isUndefined,
+} from '../utils/shared.utils';
 import { LoggerService, LogLevel } from './logger.service';
 import { isLogLevelEnabled } from './utils';
 
+const DEFAULT_DEPTH = 5;
+
 export interface ConsoleLoggerOptions {
   /**
    * Enabled log levels.
@@ -12,8 +19,73 @@ export interface ConsoleLoggerOptions {
   logLevels?: LogLevel[];
   /**
    * If enabled, will print timestamp (time difference) between current and previous log message.
+   * Note: This option is not used when `json` is enabled.
    */
   timestamp?: boolean;
+  /**
+   * A prefix to be used for each log message.
+   * Note: This option is not used when `json` is enabled.
+   */
+  prefix?: string;
+  /**
+   * If enabled, will print the log message in JSON format.
+   */
+  json?: boolean;
+  /**
+   * If enabled, will print the log message in color.
+   * Default true if json is disabled, false otherwise
+   */
+  colors?: boolean;
+  /**
+   * The context of the logger.
+   */
+  context?: string;
+  /**
+   * If enabled, will print the log message in a single line, even if it is an object with multiple properties.
+   * If set to a number, the most n inner elements are united on a single line as long as all properties fit into breakLength. Short array elements are also grouped together.
+   * Default true when `json` is enabled, false otherwise.
+   */
+  compact?: boolean | number;
+  /**
+   * Specifies the maximum number of Array, TypedArray, Map, Set, WeakMap, and WeakSet elements to include when formatting.
+   * Set to null or Infinity to show all elements. Set to 0 or negative to show no elements.
+   * Ignored when `json` is enabled, colors are disabled, and `compact` is set to true as it produces a parseable JSON output.
+   * @default 100
+   */
+  maxArrayLength?: number;
+  /**
+   * Specifies the maximum number of characters to include when formatting.
+   * Set to null or Infinity to show all elements. Set to 0 or negative to show no characters.
+   * Ignored when `json` is enabled, colors are disabled, and `compact` is set to true as it produces a parseable JSON output.
+   * @default 10000.
+   */
+  maxStringLength?: number;
+  /**
+   * If enabled, will sort keys while formatting objects.
+   * Can also be a custom sorting function.
+   * Ignored when `json` is enabled, colors are disabled, and `compact` is set to true as it produces a parseable JSON output.
+   * @default false
+   */
+  sorted?: boolean | ((a: string, b: string) => number);
+  /**
+   * Specifies the number of times to recurse while formatting object. T
+   * This is useful for inspecting large objects. To recurse up to the maximum call stack size pass Infinity or null.
+   * Ignored when `json` is enabled, colors are disabled, and `compact` is set to true as it produces a parseable JSON output.
+   * @default 5
+   */
+  depth?: number;
+  /**
+   * If true, object's non-enumerable symbols and properties are included in the formatted result.
+   * WeakMap and WeakSet entries are also included as well as user defined prototype properties
+   * @default false
+   */
+  showHidden?: boolean;
+  /**
+   * The length at which input values are split across multiple lines. Set to Infinity to format the input as a single line (in combination with "compact" set to true).
+   * Default Infinity when "compact" is true, 80 otherwise.
+   * Ignored when `json` is enabled, colors are disabled, and `compact` is set to true as it produces a parseable JSON output.
+   */
+  breakLength?: number;
 }
 
 const DEFAULT_LOG_LEVELS: LogLevel[] = [
@@ -22,26 +94,68 @@ const DEFAULT_LOG_LEVELS: LogLevel[] = [
   'warn',
   'debug',
   'verbose',
+  'fatal',
 ];
 
+const dateTimeFormatter = new Intl.DateTimeFormat(undefined, {
+  year: 'numeric',
+  hour: 'numeric',
+  minute: 'numeric',
+  second: 'numeric',
+  day: '2-digit',
+  month: '2-digit',
+});
+
 @Injectable()
 export class ConsoleLogger implements LoggerService {
-  private static lastTimestampAt?: number;
-  private originalContext?: string;
+  /**
+   * The options of the logger.
+   */
+  protected options: ConsoleLoggerOptions;
+  /**
+   * The context of the logger (can be set manually or automatically inferred).
+   */
+  protected context?: string;
+  /**
+   * The original context of the logger (set in the constructor).
+   */
+  protected originalContext?: string;
+  /**
+   * The options used for the "inspect" method.
+   */
+  protected inspectOptions: InspectOptions;
+  /**
+   * The last timestamp at which the log message was printed.
+   */
+  protected static lastTimestampAt?: number;
 
   constructor();
   constructor(context: string);
+  constructor(options: ConsoleLoggerOptions);
   constructor(context: string, options: ConsoleLoggerOptions);
   constructor(
     @Optional()
-    protected context?: string,
+    contextOrOptions?: string | ConsoleLoggerOptions,
     @Optional()
-    protected options: ConsoleLoggerOptions = {},
+    options?: ConsoleLoggerOptions,
   ) {
-    if (!options.logLevels) {
-      options.logLevels = DEFAULT_LOG_LEVELS;
-    }
+    // eslint-disable-next-line prefer-const
+    let [context, opts] = isString(contextOrOptions)
+      ? [contextOrOptions, options]
+      : options
+        ? [undefined, options]
+        : [contextOrOptions?.context, contextOrOptions];
+
+    opts = opts ?? {};
+    opts.logLevels ??= DEFAULT_LOG_LEVELS;
+    opts.colors ??= opts.colors ?? (opts.json ? false : true);
+    opts.prefix ??= 'Nest';
+
+    this.options = opts;
+    this.inspectOptions = this.getInspectOptions();
+
     if (context) {
+      this.context = context;
       this.originalContext = context;
     }
   }
@@ -67,6 +181,7 @@ export class ConsoleLogger implements LoggerService {
    * Write an 'error' level log, if the configured level allows for it.
    * Prints to `stderr` with newline.
    */
+  error(message: any, stackOrContext?: string): void;
   error(message: any, stack?: string, context?: string): void;
   error(message: any, ...optionalParams: [...any, string?, string?]): void;
   error(message: any, ...optionalParams: any[]) {
@@ -76,8 +191,8 @@ export class ConsoleLogger implements LoggerService {
     const { messages, context, stack } =
       this.getContextAndStackAndMessagesToPrint([message, ...optionalParams]);
 
-    this.printMessages(messages, context, 'error', 'stderr');
-    this.printStackTrace(stack);
+    this.printMessages(messages, context, 'error', 'stderr', stack);
+    this.printStackTrace(stack!);
   }
 
   /**
@@ -131,6 +246,23 @@ export class ConsoleLogger implements LoggerService {
     this.printMessages(messages, context, 'verbose');
   }
 
+  /**
+   * Write a 'fatal' level log, if the configured level allows for it.
+   * Prints to `stdout` with newline.
+   */
+  fatal(message: any, context?: string): void;
+  fatal(message: any, ...optionalParams: [...any, string?]): void;
+  fatal(message: any, ...optionalParams: any[]) {
+    if (!this.isLevelEnabled('fatal')) {
+      return;
+    }
+    const { messages, context } = this.getContextAndMessagesToPrint([
+      message,
+      ...optionalParams,
+    ]);
+    this.printMessages(messages, context, 'fatal');
+  }
+
   /**
    * Set log levels
    * @param levels log levels
@@ -163,18 +295,7 @@ export class ConsoleLogger implements LoggerService {
   }
 
   protected getTimestamp(): string {
-    const localeStringOptions = {
-      year: 'numeric',
-      hour: 'numeric',
-      minute: 'numeric',
-      second: 'numeric',
-      day: '2-digit',
-      month: '2-digit',
-    };
-    return new Date(Date.now()).toLocaleString(
-      undefined,
-      localeStringOptions as Intl.DateTimeFormatOptions,
-    );
+    return dateTimeFormatter.format(Date.now());
   }
 
   protected printMessages(
@@ -182,45 +303,208 @@ export class ConsoleLogger implements LoggerService {
     context = '',
     logLevel: LogLevel = 'log',
     writeStreamType?: 'stdout' | 'stderr',
+    errorStack?: unknown,
   ) {
-    const color = this.getColorByLogLevel(logLevel);
     messages.forEach(message => {
-      const output = isPlainObject(message)
-        ? `${color('Object:')}\n${JSON.stringify(
-            message,
-            (key, value) =>
-              typeof value === 'bigint' ? value.toString() : value,
-            2,
-          )}\n`
-        : color(message as string);
-
-      const pidMessage = color(`[Nest] ${process.pid}  - `);
-      const contextMessage = context ? yellow(`[${context}] `) : '';
+      if (this.options.json) {
+        this.printAsJson(message, {
+          context,
+          logLevel,
+          writeStreamType,
+          errorStack,
+        });
+        return;
+      }
+      const pidMessage = this.formatPid(process.pid);
+      const contextMessage = this.formatContext(context);
       const timestampDiff = this.updateAndGetTimestampDiff();
-      const formattedLogLevel = color(logLevel.toUpperCase().padStart(7, ' '));
-      const computedMessage = `${pidMessage}${this.getTimestamp()} ${formattedLogLevel} ${contextMessage}${output}${timestampDiff}\n`;
+      const formattedLogLevel = logLevel.toUpperCase().padStart(7, ' ');
+      const formattedMessage = this.formatMessage(
+        logLevel,
+        message,
+        pidMessage,
+        formattedLogLevel,
+        contextMessage,
+        timestampDiff,
+      );
 
-      process[writeStreamType ?? 'stdout'].write(computedMessage);
+      process[writeStreamType ?? 'stdout'].write(formattedMessage);
     });
   }
 
+  protected printAsJson(
+    message: unknown,
+    options: {
+      context: string;
+      logLevel: LogLevel;
+      writeStreamType?: 'stdout' | 'stderr';
+      errorStack?: unknown;
+    },
+  ) {
+    type JsonLogObject = {
+      level: LogLevel;
+      pid: number;
+      timestamp: number;
+      message: unknown;
+      context?: string;
+      stack?: unknown;
+    };
+
+    const logObject: JsonLogObject = {
+      level: options.logLevel,
+      pid: process.pid,
+      timestamp: Date.now(),
+      message,
+    };
+
+    if (options.context) {
+      logObject.context = options.context;
+    }
+
+    if (options.errorStack) {
+      logObject.stack = options.errorStack;
+    }
+
+    const formattedMessage =
+      !this.options.colors && this.inspectOptions.compact === true
+        ? JSON.stringify(logObject, this.stringifyReplacer)
+        : inspect(logObject, this.inspectOptions);
+    process[options.writeStreamType ?? 'stdout'].write(`${formattedMessage}\n`);
+  }
+
+  protected formatPid(pid: number) {
+    return `[${this.options.prefix}] ${pid}  - `;
+  }
+
+  protected formatContext(context: string): string {
+    if (!context) {
+      return '';
+    }
+
+    context = `[${context}] `;
+    return this.options.colors ? yellow(context) : context;
+  }
+
+  protected formatMessage(
+    logLevel: LogLevel,
+    message: unknown,
+    pidMessage: string,
+    formattedLogLevel: string,
+    contextMessage: string,
+    timestampDiff: string,
+  ) {
+    const output = this.stringifyMessage(message, logLevel);
+    pidMessage = this.colorize(pidMessage, logLevel);
+    formattedLogLevel = this.colorize(formattedLogLevel, logLevel);
+    return `${pidMessage}${this.getTimestamp()} ${formattedLogLevel} ${contextMessage}${output}${timestampDiff}\n`;
+  }
+
+  protected stringifyMessage(message: unknown, logLevel: LogLevel) {
+    if (isFunction(message)) {
+      const messageAsStr = Function.prototype.toString.call(message);
+      const isClass = messageAsStr.startsWith('class ');
+      if (isClass) {
+        // If the message is a class, we will display the class name.
+        return this.stringifyMessage(message.name, logLevel);
+      }
+      // If the message is a non-class function, call it and re-resolve its value.
+      return this.stringifyMessage(message(), logLevel);
+    }
+
+    if (typeof message === 'string') {
+      return this.colorize(message, logLevel);
+    }
+
+    const outputText = inspect(message, this.inspectOptions);
+    if (isPlainObject(message)) {
+      return `Object(${Object.keys(message).length}) ${outputText}`;
+    }
+    if (Array.isArray(message)) {
+      return `Array(${message.length}) ${outputText}`;
+    }
+    return outputText;
+  }
+
+  protected colorize(message: string, logLevel: LogLevel) {
+    if (!this.options.colors || this.options.json) {
+      return message;
+    }
+    const color = this.getColorByLogLevel(logLevel);
+    return color(message);
+  }
+
   protected printStackTrace(stack: string) {
-    if (!stack) {
+    if (!stack || this.options.json) {
       return;
     }
     process.stderr.write(`${stack}\n`);
   }
 
-  private updateAndGetTimestampDiff(): string {
+  protected updateAndGetTimestampDiff(): string {
     const includeTimestamp =
       ConsoleLogger.lastTimestampAt && this.options?.timestamp;
     const result = includeTimestamp
-      ? yellow(` +${Date.now() - ConsoleLogger.lastTimestampAt}ms`)
+      ? this.formatTimestampDiff(Date.now() - ConsoleLogger.lastTimestampAt!)
       : '';
     ConsoleLogger.lastTimestampAt = Date.now();
     return result;
   }
 
+  protected formatTimestampDiff(timestampDiff: number) {
+    const formattedDiff = ` +${timestampDiff}ms`;
+    return this.options.colors ? yellow(formattedDiff) : formattedDiff;
+  }
+
+  protected getInspectOptions() {
+    let breakLength = this.options.breakLength;
+    if (typeof breakLength === 'undefined') {
+      breakLength = this.options.colors
+        ? this.options.compact
+          ? Infinity
+          : undefined
+        : this.options.compact === false
+          ? undefined
+          : Infinity; // default breakLength to Infinity if inline is not set and colors is false
+    }
+
+    const inspectOptions: InspectOptions = {
+      depth: this.options.depth ?? DEFAULT_DEPTH,
+      sorted: this.options.sorted,
+      showHidden: this.options.showHidden,
+      compact: this.options.compact ?? (this.options.json ? true : false),
+      colors: this.options.colors,
+      breakLength,
+    };
+
+    if (this.options.maxArrayLength) {
+      inspectOptions.maxArrayLength = this.options.maxArrayLength;
+    }
+    if (this.options.maxStringLength) {
+      inspectOptions.maxStringLength = this.options.maxStringLength;
+    }
+
+    return inspectOptions;
+  }
+
+  protected stringifyReplacer(key: string, value: unknown) {
+    // Mimic util.inspect behavior for JSON logger with compact on and colors off
+    if (typeof value === 'bigint') {
+      return value.toString();
+    }
+    if (typeof value === 'symbol') {
+      return value.toString();
+    }
+
+    if (
+      value instanceof Map ||
+      value instanceof Set ||
+      value instanceof Error
+    ) {
+      return `${inspect(value, this.inspectOptions)}`;
+    }
+    return value;
+  }
+
   private getContextAndMessagesToPrint(args: unknown[]) {
     if (args?.length <= 1) {
       return { messages: args, context: this.context };
@@ -231,28 +515,50 @@ export class ConsoleLogger implements LoggerService {
       return { messages: args, context: this.context };
     }
     return {
-      context: lastElement as string,
+      context: lastElement,
       messages: args.slice(0, args.length - 1),
     };
   }
 
   private getContextAndStackAndMessagesToPrint(args: unknown[]) {
+    if (args.length === 2) {
+      return this.isStackFormat(args[1])
+        ? {
+            messages: [args[0]],
+            stack: args[1] as string,
+            context: this.context,
+          }
+        : {
+            messages: [args[0]],
+            context: args[1] as string,
+          };
+    }
+
     const { messages, context } = this.getContextAndMessagesToPrint(args);
     if (messages?.length <= 1) {
       return { messages, context };
     }
     const lastElement = messages[messages.length - 1];
     const isStack = isString(lastElement);
-    if (!isStack) {
+    // https://github.com/nestjs/nest/issues/11074#issuecomment-1421680060
+    if (!isStack && !isUndefined(lastElement)) {
       return { messages, context };
     }
     return {
-      stack: lastElement as string,
+      stack: lastElement,
       messages: messages.slice(0, messages.length - 1),
       context,
     };
   }
 
+  private isStackFormat(stack: unknown) {
+    if (!isString(stack) && !isUndefined(stack)) {
+      return false;
+    }
+
+    return /^(.)+\n\s+at .+:\d+:\d+/.test(stack!);
+  }
+
   private getColorByLogLevel(level: LogLevel) {
     switch (level) {
       case 'debug':
@@ -263,6 +569,8 @@ export class ConsoleLogger implements LoggerService {
         return clc.red;
       case 'verbose':
         return clc.cyanBright;
+      case 'fatal':
+        return clc.bold;
       default:
         return clc.green;
     }
diff --git a/packages/common/services/logger.service.ts b/packages/common/services/logger.service.ts
index 962822b13..3e006cedf 100644
--- a/packages/common/services/logger.service.ts
+++ b/packages/common/services/logger.service.ts
@@ -1,11 +1,16 @@
-import { Injectable } from '../decorators/core/injectable.decorator';
-import { Optional } from '../decorators/core/optional.decorator';
+import { Injectable, Optional } from '../decorators/core';
 import { isObject } from '../utils/shared.utils';
 import { ConsoleLogger } from './console-logger.service';
 import { isLogLevelEnabled } from './utils';
 
-export type LogLevel = 'log' | 'error' | 'warn' | 'debug' | 'verbose';
+/**
+ * @publicApi
+ */
+export type LogLevel = 'log' | 'error' | 'warn' | 'debug' | 'verbose' | 'fatal';
 
+/**
+ * @publicApi
+ */
 export interface LoggerService {
   /**
    * Write a 'log' level log.
@@ -32,6 +37,11 @@ export interface LoggerService {
    */
   verbose?(message: any, ...optionalParams: any[]): any;
 
+  /**
+   * Write a 'fatal' level log.
+   */
+  fatal?(message: any, ...optionalParams: any[]): any;
+
   /**
    * Set log levels.
    * @param levels log levels
@@ -53,6 +63,18 @@ interface LogBufferRecord {
 
 const DEFAULT_LOGGER = new ConsoleLogger();
 
+const dateTimeFormatter = new Intl.DateTimeFormat(undefined, {
+  year: 'numeric',
+  hour: 'numeric',
+  minute: 'numeric',
+  second: 'numeric',
+  day: '2-digit',
+  month: '2-digit',
+});
+
+/**
+ * @publicApi
+ */
 @Injectable()
 export class Logger implements LoggerService {
   protected static logBuffer = new Array<LogBufferRecord>();
@@ -97,7 +119,7 @@ export class Logger implements LoggerService {
         return this.registerLocalInstanceRef();
       }
     }
-    return Logger.staticInstanceRef;
+    return Logger.staticInstanceRef!;
   }
 
   /**
@@ -108,7 +130,9 @@ export class Logger implements LoggerService {
   @Logger.WrapBuffer
   error(message: any, ...optionalParams: any[]) {
     optionalParams = this.context
-      ? optionalParams.concat(this.context)
+      ? (optionalParams.length ? optionalParams : [undefined]).concat(
+          this.context,
+        )
       : optionalParams;
 
     this.localInstance?.error(message, ...optionalParams);
@@ -166,9 +190,23 @@ export class Logger implements LoggerService {
     this.localInstance?.verbose?.(message, ...optionalParams);
   }
 
+  /**
+   * Write a 'fatal' level log.
+   */
+  fatal(message: any, context?: string): void;
+  fatal(message: any, ...optionalParams: [...any, string?]): void;
+  @Logger.WrapBuffer
+  fatal(message: any, ...optionalParams: any[]) {
+    optionalParams = this.context
+      ? optionalParams.concat(this.context)
+      : optionalParams;
+    this.localInstance?.fatal?.(message, ...optionalParams);
+  }
+
   /**
    * Write an 'error' level log.
    */
+  static error(message: any, stackOrContext?: string): void;
   static error(message: any, context?: string): void;
   static error(message: any, stack?: string, context?: string): void;
   static error(
@@ -221,6 +259,16 @@ export class Logger implements LoggerService {
     this.staticInstanceRef?.verbose?.(message, ...optionalParams);
   }
 
+  /**
+   * Write a 'fatal' level log.
+   */
+  static fatal(message: any, context?: string): void;
+  static fatal(message: any, ...optionalParams: [...any, string?]): void;
+  @Logger.WrapBuffer
+  static fatal(message: any, ...optionalParams: any[]) {
+    this.staticInstanceRef?.fatal?.(message, ...optionalParams);
+  }
+
   /**
    * Print buffered logs and detach buffer.
    */
@@ -234,7 +282,7 @@ export class Logger implements LoggerService {
 
   /**
    * Attach buffer.
-   * Turns on initialisation logs buffering.
+   * Turns on initialization logs buffering.
    */
   static attachBuffer() {
     this.isBufferAttached = true;
@@ -242,36 +290,25 @@ export class Logger implements LoggerService {
 
   /**
    * Detach buffer.
-   * Turns off initialisation logs buffering.
+   * Turns off initialization logs buffering.
    */
   static detachBuffer() {
     this.isBufferAttached = false;
   }
 
   static getTimestamp() {
-    const localeStringOptions = {
-      year: 'numeric',
-      hour: 'numeric',
-      minute: 'numeric',
-      second: 'numeric',
-      day: '2-digit',
-      month: '2-digit',
-    };
-    return new Date(Date.now()).toLocaleString(
-      undefined,
-      localeStringOptions as Intl.DateTimeFormatOptions,
-    );
+    return dateTimeFormatter.format(Date.now());
   }
 
   static overrideLogger(logger: LoggerService | LogLevel[] | boolean) {
     if (Array.isArray(logger)) {
       Logger.logLevels = logger;
-      return this.staticInstanceRef?.setLogLevels(logger);
+      return this.staticInstanceRef?.setLogLevels?.(logger);
     }
     if (isObject(logger)) {
       if (logger instanceof Logger && logger.constructor !== Logger) {
-        const errorMessage = `Using the "extends Logger" instruction is not allowed in Nest v8. Please, use "extends ConsoleLogger" instead.`;
-        this.staticInstanceRef.error(errorMessage);
+        const errorMessage = `Using the "extends Logger" instruction is not allowed in Nest v9. Please, use "extends ConsoleLogger" instead.`;
+        this.staticInstanceRef?.error(errorMessage);
         throw new Error(errorMessage);
       }
       this.staticInstanceRef = logger as LoggerService;
@@ -289,7 +326,7 @@ export class Logger implements LoggerService {
     if (this.localInstanceRef) {
       return this.localInstanceRef;
     }
-    this.localInstanceRef = new ConsoleLogger(this.context, {
+    this.localInstanceRef = new ConsoleLogger(this.context!, {
       timestamp: this.options?.timestamp,
       logLevels: Logger.logLevels,
     });
diff --git a/packages/common/services/utils/is-log-level-enabled.util.ts b/packages/common/services/utils/is-log-level-enabled.util.ts
index 745fc05f9..242dd6474 100644
--- a/packages/common/services/utils/is-log-level-enabled.util.ts
+++ b/packages/common/services/utils/is-log-level-enabled.util.ts
@@ -1,11 +1,12 @@
 import { LogLevel } from '../logger.service';
 
 const LOG_LEVEL_VALUES: Record<LogLevel, number> = {
-  debug: 0,
-  verbose: 1,
+  verbose: 0,
+  debug: 1,
   log: 2,
   warn: 3,
   error: 4,
+  fatal: 5,
 };
 
 /**
diff --git a/packages/common/test/decorators/apply-decorators.spec.ts b/packages/common/test/decorators/apply-decorators.spec.ts
index f91526ac4..d804206cc 100644
--- a/packages/common/test/decorators/apply-decorators.spec.ts
+++ b/packages/common/test/decorators/apply-decorators.spec.ts
@@ -1,6 +1,6 @@
 import { expect } from 'chai';
-import { applyDecorators, UseGuards } from '../../decorators';
 import { GUARDS_METADATA } from '../../constants';
+import { applyDecorators, UseGuards } from '../../decorators';
 import { CanActivate } from '../../interfaces';
 
 describe('applyDecorators', () => {
diff --git a/packages/common/test/decorators/cache.decorator.spec.ts b/packages/common/test/decorators/cache.decorator.spec.ts
deleted file mode 100644
index a207b4180..000000000
--- a/packages/common/test/decorators/cache.decorator.spec.ts
+++ /dev/null
@@ -1,47 +0,0 @@
-import { expect } from 'chai';
-import { CacheKey, CacheInterceptor, CacheTTL } from '../../cache';
-import {
-  CACHE_KEY_METADATA,
-  CACHE_TTL_METADATA,
-} from '../../cache/cache.constants';
-import { UseInterceptors } from '../../decorators';
-import { Controller } from '../../decorators/core/controller.decorator';
-
-describe('@Cache', () => {
-  @Controller('test')
-  @CacheKey('/a_different_cache_key')
-  @CacheTTL(99999)
-  @UseInterceptors(CacheInterceptor)
-  class TestAll {}
-
-  @Controller()
-  @UseInterceptors(CacheInterceptor)
-  @CacheKey('/a_different_cache_key')
-  class TestKey {}
-
-  @Controller()
-  @UseInterceptors(CacheInterceptor)
-  @CacheTTL(99999)
-  class TestTTL {}
-
-  it('should override global defaults for CacheKey and CacheTTL', () => {
-    expect(Reflect.getMetadata(CACHE_KEY_METADATA, TestAll)).to.be.eql(
-      '/a_different_cache_key',
-    );
-    expect(Reflect.getMetadata(CACHE_TTL_METADATA, TestAll)).to.be.greaterThan(
-      9999,
-    );
-  });
-
-  it('should override only the TTL', () => {
-    expect(Reflect.getMetadata(CACHE_TTL_METADATA, TestTTL)).to.be.greaterThan(
-      9999,
-    );
-  });
-
-  it('should override only the Key', () => {
-    expect(Reflect.getMetadata(CACHE_KEY_METADATA, TestKey)).to.be.eql(
-      '/a_different_cache_key',
-    );
-  });
-});
diff --git a/packages/common/test/decorators/injectable.decorator.spec.ts b/packages/common/test/decorators/injectable.decorator.spec.ts
index aba23e043..388ecd710 100644
--- a/packages/common/test/decorators/injectable.decorator.spec.ts
+++ b/packages/common/test/decorators/injectable.decorator.spec.ts
@@ -51,7 +51,7 @@ describe('mixin', () => {
     expect(type.name).to.not.eql('Test');
   });
 
-  it('should not lost the design:parmatypes metadata', () => {
+  it('should not lost the design:paramtypes metadata', () => {
     const type = mixin(Test);
     const constructorParams = Reflect.getMetadata('design:paramtypes', type);
 
diff --git a/packages/common/test/decorators/route-params.decorator.spec.ts b/packages/common/test/decorators/route-params.decorator.spec.ts
index b96fcb2c0..da3a85a9a 100644
--- a/packages/common/test/decorators/route-params.decorator.spec.ts
+++ b/packages/common/test/decorators/route-params.decorator.spec.ts
@@ -1,7 +1,24 @@
 import { expect } from 'chai';
-import { Body, HostParam, Param, Query } from '../../decorators';
+import { Body, HostParam, Param, Query, Search } from '../../decorators';
 import { RequestMethod } from '../../enums/request-method.enum';
-import { All, Delete, Get, Patch, Post, Put } from '../../index';
+import {
+  All,
+  Delete,
+  Get,
+  ParseIntPipe,
+  Patch,
+  Post,
+  Put,
+  Propfind,
+  Proppatch,
+  Mkcol,
+  Move,
+  Copy,
+  Lock,
+  Unlock,
+} from '../../index';
+import { ROUTE_ARGS_METADATA } from '../../constants';
+import { RouteParamtypes } from '../../enums/route-paramtypes.enum';
 
 describe('@Get', () => {
   const requestPath = 'test';
@@ -19,18 +36,28 @@ describe('@Get', () => {
   it('should enhance class with expected request metadata', () => {
     class Test {
       @Get(requestPath)
-      public static test(@Param('id') params) {}
+      public static test(@Param('id', ParseIntPipe) params) {}
 
       @Get(requestPathUsingArray)
       public static testUsingArray(@Param('id') params) {}
     }
 
     const path = Reflect.getMetadata('path', Test.test);
+    const args = Reflect.getMetadata(
+      ROUTE_ARGS_METADATA,
+      Test.constructor,
+      'test',
+    );
     const method = Reflect.getMetadata('method', Test.test);
     const pathUsingArray = Reflect.getMetadata('path', Test.testUsingArray);
     const methodUsingArray = Reflect.getMetadata('method', Test.testUsingArray);
 
     expect(path).to.be.eql(requestPath);
+    expect(args[`${RouteParamtypes.PARAM}:0`]).to.be.eql({
+      index: 0,
+      data: 'id',
+      pipes: [ParseIntPipe],
+    });
     expect(method).to.be.eql(requestProps.method);
     expect(pathUsingArray).to.be.eql(requestPathUsingArray);
     expect(methodUsingArray).to.be.eql(requestPropsUsingArray.method);
@@ -311,6 +338,63 @@ describe('@Patch', () => {
   });
 });
 
+describe('@Search', () => {
+  const requestPath = 'test';
+  const requestProps = {
+    path: requestPath,
+    method: RequestMethod.SEARCH,
+  };
+
+  const requestPathUsingArray = ['foo', 'bar'];
+  const requestPropsUsingArray = {
+    path: requestPathUsingArray,
+    method: RequestMethod.SEARCH,
+  };
+
+  it('should enhance class with expected request metadata', () => {
+    class Test {
+      @Search(requestPath)
+      public static test() {}
+
+      @Search(requestPathUsingArray)
+      public static testUsingArray() {}
+    }
+
+    const path = Reflect.getMetadata('path', Test.test);
+    const method = Reflect.getMetadata('method', Test.test);
+    const pathUsingArray = Reflect.getMetadata('path', Test.testUsingArray);
+    const methodUsingArray = Reflect.getMetadata('method', Test.testUsingArray);
+
+    expect(path).to.be.eql(requestPath);
+    expect(method).to.be.eql(requestProps.method);
+    expect(pathUsingArray).to.be.eql(requestPathUsingArray);
+    expect(methodUsingArray).to.be.eql(requestPropsUsingArray.method);
+  });
+
+  it('should set path on "/" by default', () => {
+    class Test {
+      @Search()
+      public static test(
+        @Query() query,
+        @Param() params,
+        @HostParam() hostParams,
+      ) {}
+
+      @Search([])
+      public static testUsingArray(
+        @Query() query,
+        @Param() params,
+        @HostParam() hostParams,
+      ) {}
+    }
+
+    const path = Reflect.getMetadata('path', Test.test);
+    const pathUsingArray = Reflect.getMetadata('path', Test.testUsingArray);
+    expect(path).to.be.eql('/');
+    expect(pathUsingArray).to.be.eql('/');
+  });
+});
+
 describe('Inheritance', () => {
   const requestPath = 'test';
   const requestProps = {
@@ -346,3 +430,409 @@ describe('Inheritance', () => {
     expect(methodUsingArray).to.be.eql(requestPropsUsingArray.method);
   });
 });
+
+describe('@PropFind', () => {
+  const requestPath = 'test';
+  const requestProps = {
+    path: requestPath,
+    method: RequestMethod.PROPFIND,
+  };
+
+  const requestPathUsingArray = ['foo', 'bar'];
+  const requestPropsUsingArray = {
+    path: requestPathUsingArray,
+    method: RequestMethod.PROPFIND,
+  };
+
+  it('should enhance class with expected request metadata', () => {
+    class Test {
+      @Propfind(requestPath)
+      public static test() {}
+
+      @Propfind(requestPathUsingArray)
+      public static testUsingArray() {}
+    }
+
+    const path = Reflect.getMetadata('path', Test.test);
+    const method = Reflect.getMetadata('method', Test.test);
+    const pathUsingArray = Reflect.getMetadata('path', Test.testUsingArray);
+    const methodUsingArray = Reflect.getMetadata('method', Test.testUsingArray);
+
+    expect(path).to.be.eql(requestPath);
+    expect(method).to.be.eql(requestProps.method);
+    expect(pathUsingArray).to.be.eql(requestPathUsingArray);
+    expect(methodUsingArray).to.be.eql(requestPropsUsingArray.method);
+  });
+
+  it('should set path on "/" by default', () => {
+    class Test {
+      @Propfind()
+      public static test(
+        @Query() query,
+        @Param() params,
+        @HostParam() hostParams,
+      ) {}
+
+      @Propfind([])
+      public static testUsingArray(
+        @Query() query,
+        @Param() params,
+        @HostParam() hostParams,
+      ) {}
+    }
+
+    const path = Reflect.getMetadata('path', Test.test);
+    const pathUsingArray = Reflect.getMetadata('path', Test.testUsingArray);
+
+    expect(path).to.be.eql('/');
+    expect(pathUsingArray).to.be.eql('/');
+  });
+});
+
+describe('@PropPatch', () => {
+  const requestPath = 'test';
+  const requestProps = {
+    path: requestPath,
+    method: RequestMethod.PROPPATCH,
+  };
+
+  const requestPathUsingArray = ['foo', 'bar'];
+  const requestPropsUsingArray = {
+    path: requestPathUsingArray,
+    method: RequestMethod.PROPPATCH,
+  };
+
+  it('should enhance class with expected request metadata', () => {
+    class Test {
+      @Proppatch(requestPath)
+      public static test() {}
+
+      @Proppatch(requestPathUsingArray)
+      public static testUsingArray() {}
+    }
+
+    const path = Reflect.getMetadata('path', Test.test);
+    const method = Reflect.getMetadata('method', Test.test);
+    const pathUsingArray = Reflect.getMetadata('path', Test.testUsingArray);
+    const methodUsingArray = Reflect.getMetadata('method', Test.testUsingArray);
+
+    expect(path).to.be.eql(requestPath);
+    expect(method).to.be.eql(requestProps.method);
+    expect(pathUsingArray).to.be.eql(requestPathUsingArray);
+    expect(methodUsingArray).to.be.eql(requestPropsUsingArray.method);
+  });
+
+  it('should set path on "/" by default', () => {
+    class Test {
+      @Proppatch()
+      public static test(
+        @Query() query,
+        @Param() params,
+        @HostParam() hostParams,
+      ) {}
+
+      @Proppatch([])
+      public static testUsingArray(
+        @Query() query,
+        @Param() params,
+        @HostParam() hostParams,
+      ) {}
+    }
+
+    const path = Reflect.getMetadata('path', Test.test);
+    const pathUsingArray = Reflect.getMetadata('path', Test.testUsingArray);
+
+    expect(path).to.be.eql('/');
+    expect(pathUsingArray).to.be.eql('/');
+  });
+});
+
+describe('@MkCol', () => {
+  const requestPath = 'test';
+  const requestProps = {
+    path: requestPath,
+    method: RequestMethod.MKCOL,
+  };
+
+  const requestPathUsingArray = ['foo', 'bar'];
+  const requestPropsUsingArray = {
+    path: requestPathUsingArray,
+    method: RequestMethod.MKCOL,
+  };
+
+  it('should enhance class with expected request metadata', () => {
+    class Test {
+      @Mkcol(requestPath)
+      public static test() {}
+
+      @Mkcol(requestPathUsingArray)
+      public static testUsingArray() {}
+    }
+
+    const path = Reflect.getMetadata('path', Test.test);
+    const method = Reflect.getMetadata('method', Test.test);
+    const pathUsingArray = Reflect.getMetadata('path', Test.testUsingArray);
+    const methodUsingArray = Reflect.getMetadata('method', Test.testUsingArray);
+
+    expect(path).to.be.eql(requestPath);
+    expect(method).to.be.eql(requestProps.method);
+    expect(pathUsingArray).to.be.eql(requestPathUsingArray);
+    expect(methodUsingArray).to.be.eql(requestPropsUsingArray.method);
+  });
+
+  it('should set path on "/" by default', () => {
+    class Test {
+      @Mkcol()
+      public static test(
+        @Query() query,
+        @Param() params,
+        @HostParam() hostParams,
+      ) {}
+
+      @Mkcol([])
+      public static testUsingArray(
+        @Query() query,
+        @Param() params,
+        @HostParam() hostParams,
+      ) {}
+    }
+
+    const path = Reflect.getMetadata('path', Test.test);
+    const pathUsingArray = Reflect.getMetadata('path', Test.testUsingArray);
+
+    expect(path).to.be.eql('/');
+    expect(pathUsingArray).to.be.eql('/');
+  });
+});
+
+describe('@Copy', () => {
+  const requestPath = 'test';
+  const requestProps = {
+    path: requestPath,
+    method: RequestMethod.COPY,
+  };
+
+  const requestPathUsingArray = ['foo', 'bar'];
+  const requestPropsUsingArray = {
+    path: requestPathUsingArray,
+    method: RequestMethod.COPY,
+  };
+
+  it('should enhance class with expected request metadata', () => {
+    class Test {
+      @Copy(requestPath)
+      public static test() {}
+
+      @Copy(requestPathUsingArray)
+      public static testUsingArray() {}
+    }
+
+    const path = Reflect.getMetadata('path', Test.test);
+    const method = Reflect.getMetadata('method', Test.test);
+    const pathUsingArray = Reflect.getMetadata('path', Test.testUsingArray);
+    const methodUsingArray = Reflect.getMetadata('method', Test.testUsingArray);
+
+    expect(path).to.be.eql(requestPath);
+    expect(method).to.be.eql(requestProps.method);
+    expect(pathUsingArray).to.be.eql(requestPathUsingArray);
+    expect(methodUsingArray).to.be.eql(requestPropsUsingArray.method);
+  });
+
+  it('should set path on "/" by default', () => {
+    class Test {
+      @Copy()
+      public static test(
+        @Query() query,
+        @Param() params,
+        @HostParam() hostParams,
+      ) {}
+
+      @Copy([])
+      public static testUsingArray(
+        @Query() query,
+        @Param() params,
+        @HostParam() hostParams,
+      ) {}
+    }
+
+    const path = Reflect.getMetadata('path', Test.test);
+    const pathUsingArray = Reflect.getMetadata('path', Test.testUsingArray);
+
+    expect(path).to.be.eql('/');
+    expect(pathUsingArray).to.be.eql('/');
+  });
+});
+
+describe('@Move', () => {
+  const requestPath = 'test';
+  const requestProps = {
+    path: requestPath,
+    method: RequestMethod.MOVE,
+  };
+
+  const requestPathUsingArray = ['foo', 'bar'];
+  const requestPropsUsingArray = {
+    path: requestPathUsingArray,
+    method: RequestMethod.MOVE,
+  };
+
+  it('should enhance class with expected request metadata', () => {
+    class Test {
+      @Move(requestPath)
+      public static test() {}
+
+      @Move(requestPathUsingArray)
+      public static testUsingArray() {}
+    }
+
+    const path = Reflect.getMetadata('path', Test.test);
+    const method = Reflect.getMetadata('method', Test.test);
+    const pathUsingArray = Reflect.getMetadata('path', Test.testUsingArray);
+    const methodUsingArray = Reflect.getMetadata('method', Test.testUsingArray);
+
+    expect(path).to.be.eql(requestPath);
+    expect(method).to.be.eql(requestProps.method);
+    expect(pathUsingArray).to.be.eql(requestPathUsingArray);
+    expect(methodUsingArray).to.be.eql(requestPropsUsingArray.method);
+  });
+
+  it('should set path on "/" by default', () => {
+    class Test {
+      @Move()
+      public static test(
+        @Query() query,
+        @Param() params,
+        @HostParam() hostParams,
+      ) {}
+
+      @Move([])
+      public static testUsingArray(
+        @Query() query,
+        @Param() params,
+        @HostParam() hostParams,
+      ) {}
+    }
+
+    const path = Reflect.getMetadata('path', Test.test);
+    const pathUsingArray = Reflect.getMetadata('path', Test.testUsingArray);
+
+    expect(path).to.be.eql('/');
+    expect(pathUsingArray).to.be.eql('/');
+  });
+});
+
+describe('@Lock', () => {
+  const requestPath = 'test';
+  const requestProps = {
+    path: requestPath,
+    method: RequestMethod.LOCK,
+  };
+
+  const requestPathUsingArray = ['foo', 'bar'];
+  const requestPropsUsingArray = {
+    path: requestPathUsingArray,
+    method: RequestMethod.LOCK,
+  };
+
+  it('should enhance class with expected request metadata', () => {
+    class Test {
+      @Lock(requestPath)
+      public static test() {}
+
+      @Lock(requestPathUsingArray)
+      public static testUsingArray() {}
+    }
+
+    const path = Reflect.getMetadata('path', Test.test);
+    const method = Reflect.getMetadata('method', Test.test);
+    const pathUsingArray = Reflect.getMetadata('path', Test.testUsingArray);
+    const methodUsingArray = Reflect.getMetadata('method', Test.testUsingArray);
+
+    expect(path).to.be.eql(requestPath);
+    expect(method).to.be.eql(requestProps.method);
+    expect(pathUsingArray).to.be.eql(requestPathUsingArray);
+    expect(methodUsingArray).to.be.eql(requestPropsUsingArray.method);
+  });
+
+  it('should set path on "/" by default', () => {
+    class Test {
+      @Lock()
+      public static test(
+        @Query() query,
+        @Param() params,
+        @HostParam() hostParams,
+      ) {}
+
+      @Lock([])
+      public static testUsingArray(
+        @Query() query,
+        @Param() params,
+        @HostParam() hostParams,
+      ) {}
+    }
+
+    const path = Reflect.getMetadata('path', Test.test);
+    const pathUsingArray = Reflect.getMetadata('path', Test.testUsingArray);
+
+    expect(path).to.be.eql('/');
+    expect(pathUsingArray).to.be.eql('/');
+  });
+});
+
+describe('@Unlock', () => {
+  const requestPath = 'test';
+  const requestProps = {
+    path: requestPath,
+    method: RequestMethod.UNLOCK,
+  };
+
+  const requestPathUsingArray = ['foo', 'bar'];
+  const requestPropsUsingArray = {
+    path: requestPathUsingArray,
+    method: RequestMethod.UNLOCK,
+  };
+
+  it('should enhance class with expected request metadata', () => {
+    class Test {
+      @Unlock(requestPath)
+      public static test() {}
+
+      @Unlock(requestPathUsingArray)
+      public static testUsingArray() {}
+    }
+
+    const path = Reflect.getMetadata('path', Test.test);
+    const method = Reflect.getMetadata('method', Test.test);
+    const pathUsingArray = Reflect.getMetadata('path', Test.testUsingArray);
+    const methodUsingArray = Reflect.getMetadata('method', Test.testUsingArray);
+
+    expect(path).to.be.eql(requestPath);
+    expect(method).to.be.eql(requestProps.method);
+    expect(pathUsingArray).to.be.eql(requestPathUsingArray);
+    expect(methodUsingArray).to.be.eql(requestPropsUsingArray.method);
+  });
+
+  it('should set path on "/" by default', () => {
+    class Test {
+      @Unlock()
+      public static test(
+        @Query() query,
+        @Param() params,
+        @HostParam() hostParams,
+      ) {}
+
+      @Unlock([])
+      public static testUsingArray(
+        @Query() query,
+        @Param() params,
+        @HostParam() hostParams,
+      ) {}
+    }
+
+    const path = Reflect.getMetadata('path', Test.test);
+    const pathUsingArray = Reflect.getMetadata('path', Test.testUsingArray);
+
+    expect(path).to.be.eql('/');
+    expect(pathUsingArray).to.be.eql('/');
+  });
+});
diff --git a/packages/common/test/decorators/use-interceptors.decorator.spec.ts b/packages/common/test/decorators/use-interceptors.decorator.spec.ts
index 527319045..48449e05b 100644
--- a/packages/common/test/decorators/use-interceptors.decorator.spec.ts
+++ b/packages/common/test/decorators/use-interceptors.decorator.spec.ts
@@ -44,7 +44,7 @@ describe('@UseInterceptors', () => {
     try {
       UseInterceptors({
         intercept() {
-          return null;
+          return null!;
         },
       })({ name: 'target' } as any);
     } catch (e) {
diff --git a/packages/common/test/exceptions/http.exception.spec.ts b/packages/common/test/exceptions/http.exception.spec.ts
index c9fbab731..3bcc6d2ae 100644
--- a/packages/common/test/exceptions/http.exception.spec.ts
+++ b/packages/common/test/exceptions/http.exception.spec.ts
@@ -1,56 +1,146 @@
+/* eslint-disable @typescript-eslint/restrict-template-expressions */
 import { expect } from 'chai';
+import { Type } from '../../../common';
 import {
+  BadGatewayException,
   BadRequestException,
+  ConflictException,
+  ForbiddenException,
+  GatewayTimeoutException,
+  GoneException,
   HttpException,
+  HttpVersionNotSupportedException,
+  ImATeapotException,
+  InternalServerErrorException,
+  MethodNotAllowedException,
+  MisdirectedException,
+  NotAcceptableException,
   NotFoundException,
+  NotImplementedException,
+  PayloadTooLargeException,
+  PreconditionFailedException,
+  RequestTimeoutException,
+  ServiceUnavailableException,
+  UnauthorizedException,
+  UnprocessableEntityException,
+  UnsupportedMediaTypeException,
 } from '../../exceptions';
 
 describe('HttpException', () => {
-  it('should return a response as a string when input is a string', () => {
-    const message = 'My error message';
-    expect(new HttpException(message, 404).getResponse()).to.be.eql(
-      'My error message',
-    );
-  });
+  describe('getResponse', () => {
+    it('should return a response as a string when input is a string', () => {
+      const message = 'My error message';
+      expect(new HttpException(message, 404).getResponse()).to.be.eql(
+        'My error message',
+      );
+    });
 
-  it('should return a response as an object when input is an object', () => {
-    const message = {
-      msg: 'My error message',
-      reason: 'this can be a human readable reason',
-      anything: 'else',
-    };
-    expect(new HttpException(message, 404).getResponse()).to.be.eql(message);
-  });
+    it('should return a response as an object when input is an object', () => {
+      const message = {
+        msg: 'My error message',
+        reason: 'this can be a human readable reason',
+        anything: 'else',
+      };
+      expect(new HttpException(message, 404).getResponse()).to.be.eql(message);
+    });
 
-  it('should return a message from a built-in exception as an object', () => {
-    const message = 'My error message';
-    expect(new BadRequestException(message).getResponse()).to.be.eql({
-      statusCode: 400,
-      error: 'Bad Request',
-      message: 'My error message',
+    it('should return a message from a built-in exception as an object', () => {
+      const message = 'My error message';
+      expect(new BadRequestException(message).getResponse()).to.be.eql({
+        statusCode: 400,
+        error: 'Bad Request',
+        message: 'My error message',
+      });
     });
-  });
 
-  it('should return an object even when the message is undefined', () => {
-    expect(new BadRequestException().getResponse()).to.be.eql({
-      statusCode: 400,
-      message: 'Bad Request',
+    it('should return an object even when the message is undefined', () => {
+      expect(new BadRequestException().getResponse()).to.be.eql({
+        statusCode: 400,
+        message: 'Bad Request',
+      });
     });
   });
 
-  it('should return a status code', () => {
-    expect(new BadRequestException().getStatus()).to.be.eql(400);
-    expect(new NotFoundException().getStatus()).to.be.eql(404);
-  });
+  describe('built-in exceptions', () => {
+    describe('getStatus', () => {
+      it('should return given status code', () => {
+        const testCases: [Type<HttpException>, number][] = [
+          [BadRequestException, 400],
+          [UnauthorizedException, 401],
+          [ForbiddenException, 403],
+          [NotFoundException, 404],
+          [MethodNotAllowedException, 405],
+          [NotAcceptableException, 406],
+          [RequestTimeoutException, 408],
+          [ConflictException, 409],
+          [GoneException, 410],
+          [PreconditionFailedException, 412],
+          [PayloadTooLargeException, 413],
+          [UnsupportedMediaTypeException, 415],
+          [ImATeapotException, 418],
+          [MisdirectedException, 421],
+          [UnprocessableEntityException, 422],
+          [InternalServerErrorException, 500],
+          [NotImplementedException, 501],
+          [BadGatewayException, 502],
+          [ServiceUnavailableException, 503],
+          [GatewayTimeoutException, 504],
+          [HttpVersionNotSupportedException, 505],
+        ];
 
-  it('should return a response', () => {
-    expect(new BadRequestException().getResponse()).to.be.eql({
-      message: 'Bad Request',
-      statusCode: 400,
+        testCases.forEach(([ExceptionClass, expectedStatus]) => {
+          expect(new ExceptionClass().getStatus()).to.be.eql(expectedStatus);
+        });
+      });
     });
-    expect(new NotFoundException().getResponse()).to.be.eql({
-      message: 'Not Found',
-      statusCode: 404,
+
+    describe('getResponse', () => {
+      it('should return a response with default message and status code', () => {
+        const testCases: [Type<HttpException>, number, string][] = [
+          [BadRequestException, 400, 'Bad Request'],
+          [UnauthorizedException, 401, 'Unauthorized'],
+          [ForbiddenException, 403, 'Forbidden'],
+          [NotFoundException, 404, 'Not Found'],
+          [MethodNotAllowedException, 405, 'Method Not Allowed'],
+          [NotAcceptableException, 406, 'Not Acceptable'],
+          [RequestTimeoutException, 408, 'Request Timeout'],
+          [ConflictException, 409, 'Conflict'],
+          [GoneException, 410, 'Gone'],
+          [PreconditionFailedException, 412, 'Precondition Failed'],
+          [PayloadTooLargeException, 413, 'Payload Too Large'],
+          [UnsupportedMediaTypeException, 415, 'Unsupported Media Type'],
+          [ImATeapotException, 418, "I'm a teapot"],
+          [MisdirectedException, 421, 'Misdirected'],
+          [UnprocessableEntityException, 422, 'Unprocessable Entity'],
+          [InternalServerErrorException, 500, 'Internal Server Error'],
+          [NotImplementedException, 501, 'Not Implemented'],
+          [BadGatewayException, 502, 'Bad Gateway'],
+          [ServiceUnavailableException, 503, 'Service Unavailable'],
+          [GatewayTimeoutException, 504, 'Gateway Timeout'],
+          [HttpVersionNotSupportedException, 505, 'HTTP Version Not Supported'],
+        ];
+
+        testCases.forEach(
+          ([ExceptionClass, expectedStatus, expectedMessage]) => {
+            expect(new ExceptionClass().getResponse()).to.be.eql({
+              message: expectedMessage,
+              statusCode: expectedStatus,
+            });
+          },
+        );
+      });
+
+      it('should return a response with an "error" attribute when description was provided as the "option" object', () => {
+        const badRequestError = new BadRequestException('ErrorMessage', {
+          description: 'Some error description',
+        });
+
+        expect(badRequestError.getResponse()).to.be.eql({
+          message: 'ErrorMessage',
+          error: 'Some error description',
+          statusCode: 400,
+        });
+      });
     });
   });
 
@@ -59,31 +149,28 @@ describe('HttpException', () => {
     expect(error instanceof Error).to.be.true;
   });
 
-  it('should be serializable', () => {
-    const message = 'Some Error';
-    const error = new HttpException(message, 400);
-    expect(`${error}`).to.be.eql(`HttpException: ${message}`);
-  });
+  describe('when serializing', () => {
+    describe('and "response" parameter is a string', () => {
+      it('should concatenate HttpException with the given message', () => {
+        const responseAsString = 'Some Error';
+        const error = new HttpException(responseAsString, 400);
+        expect(`${error}`).to.be.eql(`HttpException: ${responseAsString}`);
+        expect(`${error}`.includes('[object Object]')).to.not.be.true;
+      });
+    });
 
-  describe('when "response" is an object', () => {
-    it('should use default message', () => {
-      const obj = { foo: 'bar' };
-      const error = new HttpException(obj, 400);
-      const badRequestError = new BadRequestException(obj);
+    describe('and "response" parameter is an object', () => {
+      it('should use default message', () => {
+        const responseAsObject = { foo: 'bar' };
+        const error = new HttpException(responseAsObject, 400);
+        const badRequestError = new BadRequestException(responseAsObject);
 
-      expect(`${error}`).to.be.eql(`HttpException: Http Exception`);
-      expect(`${badRequestError}`).to.be.eql(
-        `BadRequestException: Bad Request Exception`,
-      );
-      expect(`${error}`.includes('[object Object]')).to.not.be.true;
-      expect(`${badRequestError}`.includes('[object Object]')).to.not.be.true;
-    });
-    describe('otherwise', () => {
-      it('should concat strings', () => {
-        const test = 'test message';
-        const error = new HttpException(test, 400);
-        expect(`${error}`).to.be.eql(`HttpException: ${test}`);
+        expect(`${error}`).to.be.eql(`HttpException: Http Exception`);
+        expect(`${badRequestError}`).to.be.eql(
+          `BadRequestException: Bad Request Exception`,
+        );
         expect(`${error}`.includes('[object Object]')).to.not.be.true;
+        expect(`${badRequestError}`.includes('[object Object]')).to.not.be.true;
       });
     });
   });
@@ -129,4 +216,56 @@ describe('HttpException', () => {
       });
     });
   });
+
+  describe('initCause', () => {
+    const errorCause = new Error('An internal error cause');
+    const customDescription = 'custom description';
+
+    it('configures a cause when message is a string and the options object is passed', () => {
+      const error = new HttpException(customDescription, 400, {
+        cause: errorCause,
+      });
+
+      expect(`${error}`).to.be.eql(`HttpException: ${customDescription}`);
+      const { cause } = error;
+
+      expect(cause).to.be.eql(errorCause);
+    });
+
+    it('configures a cause when using a built-in exception with options', () => {
+      const builtInErrorClasses = [
+        BadGatewayException,
+        BadRequestException,
+        ConflictException,
+        ForbiddenException,
+        GatewayTimeoutException,
+        GoneException,
+        HttpVersionNotSupportedException,
+        ImATeapotException,
+        InternalServerErrorException,
+        MethodNotAllowedException,
+        MisdirectedException,
+        NotAcceptableException,
+        NotFoundException,
+        NotImplementedException,
+        PayloadTooLargeException,
+        PreconditionFailedException,
+        RequestTimeoutException,
+        ServiceUnavailableException,
+        UnauthorizedException,
+        UnprocessableEntityException,
+        UnsupportedMediaTypeException,
+      ];
+
+      builtInErrorClasses.forEach(ExceptionClass => {
+        const error = new ExceptionClass(customDescription, {
+          cause: errorCause,
+        });
+
+        const { cause } = error;
+
+        expect(cause).to.be.eql(errorCause);
+      });
+    });
+  });
 });
diff --git a/packages/common/test/file-stream/streamable-file.spec.ts b/packages/common/test/file-stream/streamable-file.spec.ts
index 905e1d179..411e6224d 100644
--- a/packages/common/test/file-stream/streamable-file.spec.ts
+++ b/packages/common/test/file-stream/streamable-file.spec.ts
@@ -4,25 +4,61 @@ import { StreamableFile } from '../../file-stream';
 
 describe('StreamableFile', () => {
   describe('when input is a readable stream', () => {
-    it('should assing it to a stream class property', () => {
+    it('should assign it to a stream class property', () => {
       const stream = new Readable();
       const streamableFile = new StreamableFile(stream);
       expect(streamableFile.getStream()).to.equal(stream);
     });
   });
   describe('when input is an object with "pipe" method', () => {
-    it('should assing it to a stream class property', () => {
+    it('should assign it to a stream class property', () => {
       const stream = { pipe: () => {} };
       const streamableFile = new StreamableFile(stream as any);
       expect(streamableFile.getStream()).to.equal(stream);
     });
   });
+  describe('when options is empty', () => {
+    it('should return application/octet-stream for type and undefined for others', () => {
+      const stream = new Readable();
+      const streamableFile = new StreamableFile(stream);
+      expect(streamableFile.getHeaders()).to.deep.equal({
+        type: 'application/octet-stream',
+        disposition: undefined,
+        length: undefined,
+      });
+    });
+  });
+  describe('when options is defined', () => {
+    it('should pass provided headers', () => {
+      const stream = new Readable();
+      const streamableFile = new StreamableFile(stream, {
+        type: 'application/pdf',
+        disposition: 'inline',
+        length: 100,
+      });
+      expect(streamableFile.getHeaders()).to.deep.equal({
+        type: 'application/pdf',
+        disposition: 'inline',
+        length: 100,
+      });
+    });
+  });
   describe('otherwise', () => {
-    it('should create a readable straem and push the input buffer', () => {
-      const buffer = Buffer.from('test');
-      const streamableFile = new StreamableFile(buffer);
-      const stream = streamableFile.getStream();
-      expect(stream.read()).to.equal(buffer);
+    describe('when input is a Buffer instance', () => {
+      it('should create a readable stream and push the input buffer', () => {
+        const buffer = Buffer.from('test');
+        const streamableFile = new StreamableFile(buffer);
+        const stream = streamableFile.getStream();
+        expect(stream.read()).to.equal(buffer);
+      });
+    });
+    describe('when input is a Uint8Array', () => {
+      it('should create a readable stream and push the input buffer', () => {
+        const buffer = Uint8Array.from([0xab, 0xcd, 0xef, 0x00]);
+        const streamableFile = new StreamableFile(buffer);
+        const stream = streamableFile.getStream();
+        expect(stream.read()).to.deep.equal(Buffer.from(buffer));
+      });
     });
   });
 });
diff --git a/packages/common/test/http/http.service.spec.ts b/packages/common/test/http/http.service.spec.ts
deleted file mode 100644
index f8a6d9540..000000000
--- a/packages/common/test/http/http.service.spec.ts
+++ /dev/null
@@ -1,16 +0,0 @@
-import { AxiosRequestConfig } from 'axios';
-import { expect } from 'chai';
-import { lastValueFrom } from 'rxjs';
-import { HttpService } from '../../http/http.service';
-
-describe('HttpService', () => {
-  it('should not mutate user-given axios options object', done => {
-    const http = new HttpService({ get: () => Promise.resolve() } as any);
-    const options: AxiosRequestConfig = {};
-
-    lastValueFrom(http.get('/', options)).then(() => {
-      expect(options.cancelToken).to.be.undefined;
-      done();
-    });
-  });
-});
diff --git a/packages/common/test/module-utils/configurable-module.builder.spec.ts b/packages/common/test/module-utils/configurable-module.builder.spec.ts
new file mode 100644
index 000000000..756c01d25
--- /dev/null
+++ b/packages/common/test/module-utils/configurable-module.builder.spec.ts
@@ -0,0 +1,137 @@
+import { expect } from 'chai';
+import { Provider } from '../../interfaces';
+import { ConfigurableModuleBuilder } from '../../module-utils';
+
+describe('ConfigurableModuleBuilder', () => {
+  describe('setExtras', () => {
+    it('should apply module definition transformer function and return typed builder', () => {
+      const { ConfigurableModuleClass } = new ConfigurableModuleBuilder()
+        .setExtras(
+          { isGlobal: false },
+          (definition, extras: { isGlobal: boolean }) => ({
+            ...definition,
+            global: extras.isGlobal,
+          }),
+        )
+        .build();
+
+      expect(
+        ConfigurableModuleClass.register({
+          // No type error
+          isGlobal: true,
+        }),
+      ).to.deep.include({
+        global: true,
+      });
+    });
+  });
+  describe('setClassMethodName', () => {
+    it('should set static class method name and return typed builder', () => {
+      const { ConfigurableModuleClass } = new ConfigurableModuleBuilder()
+        .setClassMethodName('forRoot')
+        .build();
+
+      expect(ConfigurableModuleClass.forRoot).to.not.be.undefined;
+      expect(ConfigurableModuleClass.forRootAsync).to.not.be.undefined;
+      expect((ConfigurableModuleClass as any).register).to.be.undefined;
+    });
+  });
+  describe('setFactoryMethodName', () => {
+    it('should set configuration factory class method name and return typed builder', () => {
+      const { ConfigurableModuleClass } = new ConfigurableModuleBuilder()
+        .setFactoryMethodName('createOptions')
+        .build();
+
+      expect(
+        ConfigurableModuleClass.registerAsync({
+          useClass: class {
+            // No type error
+            createOptions() {}
+          },
+        }),
+      ).to.not.be.undefined;
+    });
+  });
+  describe('build', () => {
+    it('should return a fully typed "ConfigurableModuleClass"', () => {
+      type ExtraConfig = { isGlobal?: boolean; extraProviders: Provider[] };
+
+      const {
+        ConfigurableModuleClass,
+        OPTIONS_TYPE,
+        ASYNC_OPTIONS_TYPE,
+        MODULE_OPTIONS_TOKEN,
+      } = new ConfigurableModuleBuilder({
+        moduleName: 'RandomTest',
+        alwaysTransient: true,
+      })
+        .setFactoryMethodName('createOptions')
+        .setClassMethodName('forFeature')
+        .setExtras<ExtraConfig>(
+          { isGlobal: false, extraProviders: [] },
+          (definition, extras) => ({
+            ...definition,
+            global: extras.isGlobal,
+            providers: definition.providers?.concat(extras.extraProviders),
+          }),
+        )
+        .build();
+
+      const provideInjectionTokensFrom: Provider[] = [
+        {
+          provide: 'a',
+          useFactory: () => {},
+          inject: ['b'],
+        },
+        {
+          provide: 'b',
+          useFactory: () => {},
+          inject: ['x'],
+        },
+        {
+          provide: 'c',
+          useFactory: () => {},
+          inject: ['y'],
+        },
+      ];
+      const definition = ConfigurableModuleClass.forFeatureAsync({
+        useFactory: () => {},
+        inject: ['a'],
+        provideInjectionTokensFrom,
+        isGlobal: true,
+        extraProviders: ['test' as any],
+      });
+
+      expect(definition.global).to.equal(true);
+      expect(definition.providers).to.have.length(5);
+      expect(definition.providers).to.deep.contain('test');
+      expect(definition.providers).to.include.members(
+        provideInjectionTokensFrom.slice(0, 2),
+      );
+      expect(definition.providers).not.to.include(
+        provideInjectionTokensFrom[2],
+      );
+      expect(MODULE_OPTIONS_TOKEN).to.equal('RANDOM_TEST_MODULE_OPTIONS');
+      expect((definition.providers![0] as any).provide).to.equal(
+        'RANDOM_TEST_MODULE_OPTIONS',
+      );
+
+      try {
+        expect(ASYNC_OPTIONS_TYPE.imports).to.equal(undefined);
+      } catch (err) {
+        expect(err).to.be.instanceOf(Error);
+        expect(err.message).to.equal(
+          '"ASYNC_OPTIONS_TYPE" is not supposed to be used as a value.',
+        );
+      }
+      try {
+        expect(OPTIONS_TYPE.isGlobal).to.equal(undefined);
+      } catch (err) {
+        expect(err).to.be.instanceOf(Error);
+        expect(err.message).to.equal(
+          '"OPTIONS_TYPE" is not supposed to be used as a value.',
+        );
+      }
+    });
+  });
+});
diff --git a/packages/common/test/module-utils/utils/get-injection-providers.util.spec.ts b/packages/common/test/module-utils/utils/get-injection-providers.util.spec.ts
new file mode 100644
index 000000000..dfa6364cc
--- /dev/null
+++ b/packages/common/test/module-utils/utils/get-injection-providers.util.spec.ts
@@ -0,0 +1,73 @@
+import { expect } from 'chai';
+import { Provider } from '../../../interfaces';
+import { getInjectionProviders } from '../../../module-utils/utils/get-injection-providers.util';
+
+describe('getInjectionProviders', () => {
+  it('should take only required providers', () => {
+    class C {
+      static token = 'anything';
+    }
+    class G {
+      static token = 'anything';
+      static optional = true;
+    }
+    class H {
+      static token = 'anything';
+      static optional = false;
+    }
+    const providers: Provider[] = [
+      {
+        //0
+        provide: 'a',
+        useValue: 'a',
+      },
+      {
+        //1
+        provide: 'b',
+        useValue: 'b',
+      },
+      C, //2
+      {
+        //3
+        provide: 'd',
+        useFactory: (c, b) => [c, b],
+        inject: [
+          C,
+          {
+            token: 'b',
+            optional: true,
+          },
+          'x',
+          G,
+          H,
+        ],
+      },
+      {
+        //4
+        provide: 'e',
+        useFactory: (d, b) => [d, b],
+        inject: ['d', 'b'],
+      },
+      {
+        //5
+        provide: 'f',
+        useValue: 'f',
+      },
+      G, //6
+      H, //7
+    ];
+
+    const expected = [
+      providers[1],
+      providers[2],
+      providers[3],
+      providers[4],
+      providers[6],
+      providers[7],
+    ];
+
+    const result = getInjectionProviders(providers, ['e']);
+
+    expect(result).to.have.members(expected);
+  });
+});
diff --git a/packages/common/test/pipes/file/file-type.validator.spec.ts b/packages/common/test/pipes/file/file-type.validator.spec.ts
new file mode 100644
index 000000000..0daf2b5d2
--- /dev/null
+++ b/packages/common/test/pipes/file/file-type.validator.spec.ts
@@ -0,0 +1,97 @@
+import { expect } from 'chai';
+import { FileTypeValidator } from '../../../pipes';
+
+describe('FileTypeValidator', () => {
+  describe('isValid', () => {
+    it('should return true when the file mimetype is the same as the specified', () => {
+      const fileTypeValidator = new FileTypeValidator({
+        fileType: 'image/jpeg',
+      });
+
+      const requestFile = {
+        mimetype: 'image/jpeg',
+      } as any;
+
+      expect(fileTypeValidator.isValid(requestFile)).to.equal(true);
+    });
+
+    it('should return true when the file mimetype ends with the specified option type', () => {
+      const fileTypeValidator = new FileTypeValidator({
+        fileType: 'jpeg',
+      });
+
+      const requestFile = {
+        mimetype: 'image/jpeg',
+      } as any;
+
+      expect(fileTypeValidator.isValid(requestFile)).to.equal(true);
+    });
+
+    it('should return true when the file mimetype matches the specified regexp', () => {
+      const fileTypeValidator = new FileTypeValidator({
+        fileType: /word/,
+      });
+
+      const requestFile = {
+        mimetype: 'application/msword',
+      } as any;
+
+      expect(fileTypeValidator.isValid(requestFile)).to.equal(true);
+    });
+
+    it('should return false when the file mimetype is different from the specified', () => {
+      const fileTypeValidator = new FileTypeValidator({
+        fileType: 'image/jpeg',
+      });
+
+      const requestFile = {
+        mimetype: 'image/png',
+      } as any;
+
+      expect(fileTypeValidator.isValid(requestFile)).to.equal(false);
+    });
+
+    it('should return false when the file mimetype does not match the provided regexp', () => {
+      const fileTypeValidator = new FileTypeValidator({
+        fileType: /mp4/,
+      });
+
+      const requestFile = {
+        mimetype: 'image/png',
+      } as any;
+
+      expect(fileTypeValidator.isValid(requestFile)).to.equal(false);
+    });
+
+    it('should return false when the file mimetype was not provided', () => {
+      const fileTypeValidator = new FileTypeValidator({
+        fileType: 'image/jpeg',
+      });
+
+      const requestFile = {} as any;
+
+      expect(fileTypeValidator.isValid(requestFile)).to.equal(false);
+    });
+
+    it('should return false when no file provided', () => {
+      const fileTypeValidator = new FileTypeValidator({
+        fileType: 'image/jpeg',
+      });
+
+      expect(fileTypeValidator.isValid()).to.equal(false);
+    });
+  });
+
+  describe('buildErrorMessage', () => {
+    it('should return a string with the format "Validation failed (expected type is #fileType)"', () => {
+      const fileType = 'image/jpeg';
+      const fileTypeValidator = new FileTypeValidator({
+        fileType,
+      });
+
+      expect(fileTypeValidator.buildErrorMessage()).to.equal(
+        `Validation failed (expected type is ${fileType})`,
+      );
+    });
+  });
+});
diff --git a/packages/common/test/pipes/file/max-file-size.validator.spec.ts b/packages/common/test/pipes/file/max-file-size.validator.spec.ts
new file mode 100644
index 000000000..8bc6c2ea1
--- /dev/null
+++ b/packages/common/test/pipes/file/max-file-size.validator.spec.ts
@@ -0,0 +1,64 @@
+import { expect } from 'chai';
+import { MaxFileSizeValidator } from '../../../pipes';
+
+describe('MaxFileSizeValidator', () => {
+  const oneKb = 1024;
+
+  describe('isValid', () => {
+    it('should return true when the file size is less than the maximum size', () => {
+      const maxFileSizeValidator = new MaxFileSizeValidator({
+        maxSize: oneKb,
+      });
+
+      const requestFile = {
+        size: 100,
+      } as any;
+
+      expect(maxFileSizeValidator.isValid(requestFile)).to.equal(true);
+    });
+
+    it('should return false when the file size is greater than the maximum size', () => {
+      const maxFileSizeValidator = new MaxFileSizeValidator({
+        maxSize: oneKb,
+      });
+
+      const requestFile = {
+        size: oneKb + 1,
+      } as any;
+
+      expect(maxFileSizeValidator.isValid(requestFile)).to.equal(false);
+    });
+
+    it('should return false when the file size is equal to the maximum size', () => {
+      const maxFileSizeValidator = new MaxFileSizeValidator({
+        maxSize: oneKb,
+      });
+
+      const requestFile = {
+        size: oneKb,
+      } as any;
+
+      expect(maxFileSizeValidator.isValid(requestFile)).to.equal(false);
+    });
+
+    it('should return true when no file provided', () => {
+      const maxFileSizeValidator = new MaxFileSizeValidator({
+        maxSize: oneKb,
+      });
+
+      expect(maxFileSizeValidator.isValid()).to.equal(true);
+    });
+  });
+
+  describe('buildErrorMessage', () => {
+    it('should return a string with the format "Validation failed (expected size is less than #maxSize")', () => {
+      const maxFileSizeValidator = new MaxFileSizeValidator({
+        maxSize: oneKb,
+      });
+
+      expect(maxFileSizeValidator.buildErrorMessage()).to.equal(
+        `Validation failed (expected size is less than ${oneKb})`,
+      );
+    });
+  });
+});
diff --git a/packages/common/test/pipes/file/parse-file-pipe.builder.spec.ts b/packages/common/test/pipes/file/parse-file-pipe.builder.spec.ts
new file mode 100644
index 000000000..784cea3de
--- /dev/null
+++ b/packages/common/test/pipes/file/parse-file-pipe.builder.spec.ts
@@ -0,0 +1,104 @@
+import { expect } from 'chai';
+import {
+  FileTypeValidator,
+  FileValidator,
+  MaxFileSizeValidator,
+  ParseFilePipeBuilder,
+} from '../../../pipes';
+
+describe('ParseFilePipeBuilder', () => {
+  let parseFilePipeBuilder: ParseFilePipeBuilder;
+
+  beforeEach(() => {
+    parseFilePipeBuilder = new ParseFilePipeBuilder();
+  });
+
+  describe('build', () => {
+    describe('when no validator was passed', () => {
+      it('should return a ParseFilePipe with no validators', () => {
+        const parseFilePipe = parseFilePipeBuilder.build();
+        expect(parseFilePipe.getValidators()).to.be.empty;
+      });
+    });
+
+    describe('when addMaxSizeValidator was chained', () => {
+      it('should return a ParseFilePipe with MaxSizeValidator and given options', () => {
+        const options = {
+          maxSize: 1000,
+        };
+        const parseFilePipe = parseFilePipeBuilder
+          .addMaxSizeValidator(options)
+          .build();
+
+        expect(parseFilePipe.getValidators()).to.deep.include(
+          new MaxFileSizeValidator(options),
+        );
+      });
+    });
+
+    describe('when addFileTypeValidator was chained', () => {
+      it('should return a ParseFilePipe with FileTypeValidator and given options', () => {
+        const options = {
+          fileType: 'image/jpeg',
+        };
+        const parseFilePipe = parseFilePipeBuilder
+          .addFileTypeValidator(options)
+          .build();
+
+        expect(parseFilePipe.getValidators()).to.deep.include(
+          new FileTypeValidator(options),
+        );
+      });
+    });
+
+    describe('when custom validator was chained', () => {
+      it('should return a ParseFilePipe with TestFileValidator and given options', () => {
+        class TestFileValidator extends FileValidator<{ name: string }> {
+          buildErrorMessage(file: any): string {
+            return 'TestFileValidator failed';
+          }
+
+          isValid(file: any): boolean | Promise<boolean> {
+            return true;
+          }
+        }
+
+        const options = {
+          name: 'test',
+        };
+
+        const parseFilePipe = parseFilePipeBuilder
+          .addValidator(new TestFileValidator(options))
+          .build();
+
+        expect(parseFilePipe.getValidators()).to.deep.include(
+          new TestFileValidator(options),
+        );
+      });
+    });
+
+    describe('when it is called twice with different validators', () => {
+      it('should not reuse validators', () => {
+        const maxSizeValidatorOptions = {
+          maxSize: 1000,
+        };
+
+        const pipeWithMaxSizeValidator = parseFilePipeBuilder
+          .addMaxSizeValidator(maxSizeValidatorOptions)
+          .build();
+
+        const fileTypeValidatorOptions = {
+          fileType: 'image/jpeg',
+        };
+
+        const pipeWithFileTypeValidator = parseFilePipeBuilder
+          .addFileTypeValidator(fileTypeValidatorOptions)
+          .build();
+
+        expect(pipeWithFileTypeValidator.getValidators()).not.to.deep.equal(
+          pipeWithMaxSizeValidator.getValidators(),
+        );
+      });
+    });
+  });
+});
diff --git a/packages/common/test/pipes/file/parse-file.pipe.spec.ts b/packages/common/test/pipes/file/parse-file.pipe.spec.ts
new file mode 100644
index 000000000..0eecaf989
--- /dev/null
+++ b/packages/common/test/pipes/file/parse-file.pipe.spec.ts
@@ -0,0 +1,180 @@
+import { HttpStatus } from '../../../enums';
+import { BadRequestException, ConflictException } from '../../../exceptions';
+import { FileValidator, ParseFilePipe } from '../../../pipes';
+import { expect } from 'chai';
+
+class AlwaysValidValidator extends FileValidator {
+  isValid(): boolean {
+    return true;
+  }
+  buildErrorMessage(): string {
+    return '';
+  }
+}
+
+const customErrorMessage = 'Error!';
+
+class AlwaysInvalidValidator extends FileValidator {
+  isValid(): boolean {
+    return false;
+  }
+  buildErrorMessage(): string {
+    return customErrorMessage;
+  }
+}
+
+describe('ParseFilePipe', () => {
+  let parseFilePipe: ParseFilePipe;
+  describe('transform', () => {
+    describe('when there are no validators (explicit)', () => {
+      beforeEach(() => {
+        parseFilePipe = new ParseFilePipe({
+          validators: [],
+        });
+      });
+
+      it('should return the file object', async () => {
+        const requestFile = {
+          path: 'some-path',
+        };
+
+        await expect(parseFilePipe.transform(requestFile)).to.eventually.eql(
+          requestFile,
+        );
+      });
+    });
+
+    describe('when there are no validators (by default constructor)', () => {
+      beforeEach(() => {
+        parseFilePipe = new ParseFilePipe();
+      });
+
+      it('should return the file object', async () => {
+        const requestFile = {
+          path: 'some-path',
+        };
+
+        await expect(parseFilePipe.transform(requestFile)).to.eventually.eql(
+          requestFile,
+        );
+      });
+    });
+
+    describe('when all the validators validate the file', () => {
+      beforeEach(() => {
+        parseFilePipe = new ParseFilePipe({
+          validators: [new AlwaysValidValidator({})],
+        });
+      });
+
+      it('should return the file object', async () => {
+        const requestFile = {
+          path: 'some-path',
+        };
+
+        await expect(parseFilePipe.transform(requestFile)).to.eventually.eql(
+          requestFile,
+        );
+      });
+    });
+
+    describe('when some validator invalidates the file', () => {
+      describe('and the pipe has the default error', () => {
+        beforeEach(() => {
+          parseFilePipe = new ParseFilePipe({
+            validators: [new AlwaysInvalidValidator({})],
+          });
+        });
+
+        it('should throw a BadRequestException', async () => {
+          const requestFile = {
+            path: 'some-path',
+          };
+
+          await expect(parseFilePipe.transform(requestFile)).to.be.rejectedWith(
+            BadRequestException,
+          );
+        });
+      });
+
+      describe('and the pipe has a custom error code', () => {
+        beforeEach(() => {
+          parseFilePipe = new ParseFilePipe({
+            validators: [new AlwaysInvalidValidator({})],
+            errorHttpStatusCode: HttpStatus.CONFLICT,
+          });
+        });
+
+        it('should throw this custom Error', async () => {
+          const requestFile = {
+            path: 'some-path',
+          };
+
+          await expect(parseFilePipe.transform(requestFile)).to.be.rejectedWith(
+            ConflictException,
+          );
+        });
+      });
+    });
+
+    describe('when fileIsRequired is false', () => {
+      beforeEach(() => {
+        parseFilePipe = new ParseFilePipe({
+          validators: [],
+          fileIsRequired: false,
+        });
+      });
+
+      it('should pass validation if no file is provided', async () => {
+        const requestFile = undefined;
+
+        await expect(parseFilePipe.transform(requestFile)).to.eventually.eql(
+          requestFile,
+        );
+      });
+    });
+
+    describe('when fileIsRequired is true', () => {
+      beforeEach(() => {
+        parseFilePipe = new ParseFilePipe({
+          validators: [],
+          fileIsRequired: true,
+        });
+      });
+
+      it('should throw an error if no file is provided', async () => {
+        const requestFile = undefined;
+
+        await expect(parseFilePipe.transform(requestFile)).to.be.rejectedWith(
+          BadRequestException,
+        );
+      });
+
+      it('should pass validation if a file is provided', async () => {
+        const requestFile = {
+          path: 'some-path',
+        };
+
+        await expect(parseFilePipe.transform(requestFile)).to.eventually.eql(
+          requestFile,
+        );
+      });
+    });
+
+    describe('when fileIsRequired is not explicitly provided', () => {
+      beforeEach(() => {
+        parseFilePipe = new ParseFilePipe({
+          validators: [new AlwaysInvalidValidator({})],
+        });
+      });
+
+      it('should throw an error if no file is provided', async () => {
+        const requestFile = undefined;
+
+        await expect(parseFilePipe.transform(requestFile)).to.be.rejectedWith(
+          BadRequestException,
+        );
+      });
+    });
+  });
+});
diff --git a/packages/common/test/pipes/parse-array.pipe.spec.ts b/packages/common/test/pipes/parse-array.pipe.spec.ts
index dd5833002..096ab3f9b 100644
--- a/packages/common/test/pipes/parse-array.pipe.spec.ts
+++ b/packages/common/test/pipes/parse-array.pipe.spec.ts
@@ -78,8 +78,11 @@ describe('ParseArrayPipe', () => {
         target = new ParseArrayPipe();
 
         expect(
-          await target.transform('1,2,3', {} as ArgumentMetadata),
-        ).to.be.deep.equal(['1', '2', '3']);
+          await target.transform(
+            '1,2.0,3,{},true,null,,',
+            {} as ArgumentMetadata,
+          ),
+        ).to.be.deep.equal(['1', '2.0', '3', '{}', 'true', 'null', '', '']);
 
         target = new ParseArrayPipe({ separator: '/' });
 
@@ -151,7 +154,10 @@ describe('ParseArrayPipe', () => {
       class ArrItem {}
 
       it('should validate and transform each item', async () => {
-        target = new ParseArrayPipe({ items: ArrItem });
+        target = new ParseArrayPipe({
+          items: ArrItem,
+          forbidUnknownValues: false,
+        });
 
         let items = await target.transform(
           [{}, {}, {}],
@@ -168,13 +174,16 @@ describe('ParseArrayPipe', () => {
 
         target = new ParseArrayPipe({ items: Number });
         expect(
-          await target.transform('1,2,3', {} as ArgumentMetadata),
+          await target.transform('1,2.0,3', {} as ArgumentMetadata),
         ).to.deep.equal([1, 2, 3]);
 
         target = new ParseArrayPipe({ items: String });
         expect(
-          await target.transform('1,2,3', {} as ArgumentMetadata),
-        ).to.deep.equal(['1', '2', '3']);
+          await target.transform(
+            '1,2.0,3,{},true,null,,',
+            {} as ArgumentMetadata,
+          ),
+        ).to.deep.equal(['1', '2.0', '3', '{}', 'true', 'null', '', '']);
 
         target = new ParseArrayPipe({ items: Boolean });
         expect(
diff --git a/packages/common/test/pipes/parse-bool.pipe.spec.ts b/packages/common/test/pipes/parse-bool.pipe.spec.ts
index 7286db127..25dc5959b 100644
--- a/packages/common/test/pipes/parse-bool.pipe.spec.ts
+++ b/packages/common/test/pipes/parse-bool.pipe.spec.ts
@@ -18,6 +18,15 @@ describe('ParseBoolPipe', () => {
         expect(await target.transform(false, {} as ArgumentMetadata)).to.be
           .false;
       });
+
+      it('should not throw an error if the value is undefined/null and optional is true', async () => {
+        const target = new ParseBoolPipe({ optional: true });
+        const value = await target.transform(
+          undefined!,
+          {} as ArgumentMetadata,
+        );
+        expect(value).to.equal(undefined);
+      });
     });
     describe('when validation fails', () => {
       it('should throw an error', async () => {
diff --git a/packages/common/test/pipes/parse-date.pipe.spec.ts b/packages/common/test/pipes/parse-date.pipe.spec.ts
new file mode 100644
index 000000000..e7f2b7870
--- /dev/null
+++ b/packages/common/test/pipes/parse-date.pipe.spec.ts
@@ -0,0 +1,71 @@
+import { expect } from 'chai';
+import { BadRequestException } from '../../exceptions';
+import { ParseDatePipe } from '../../pipes/parse-date.pipe';
+
+describe('ParseDatePipe', () => {
+  let target: ParseDatePipe;
+
+  beforeEach(() => {
+    target = new ParseDatePipe();
+  });
+
+  describe('transform', () => {
+    describe('when validation passes', () => {
+      it('should return a valid date object', () => {
+        const date = new Date().toISOString();
+
+        const transformedDate = target.transform(date)!;
+        expect(transformedDate).to.be.instanceOf(Date);
+        expect(transformedDate.toISOString()).to.equal(date);
+
+        const asNumber = transformedDate.getTime();
+        const transformedNumber = target.transform(asNumber)!;
+        expect(transformedNumber).to.be.instanceOf(Date);
+        expect(transformedNumber.getTime()).to.equal(asNumber);
+      });
+
+      it('should not throw an error if the value is undefined/null and optional is true', () => {
+        const target = new ParseDatePipe({ optional: true });
+        const value = target.transform(undefined);
+        expect(value).to.equal(undefined);
+      });
+    });
+    describe('when default value is provided', () => {
+      it('should return the default value if the value is undefined/null', () => {
+        const defaultValue = new Date();
+        const target = new ParseDatePipe({
+          optional: true,
+          default: () => defaultValue,
+        });
+        const value = target.transform(undefined);
+        expect(value).to.equal(defaultValue);
+      });
+    });
+    describe('when validation fails', () => {
+      it('should throw an error', () => {
+        try {
+          target.transform('123abc');
+          expect.fail();
+        } catch (error) {
+          expect(error).to.be.instanceOf(BadRequestException);
+          expect(error.message).to.equal(
+            'Validation failed (invalid date format)',
+          );
+        }
+      });
+    });
+    describe('when empty value', () => {
+      it('should throw an error', () => {
+        try {
+          target.transform('');
+          expect.fail();
+        } catch (error) {
+          expect(error).to.be.instanceOf(BadRequestException);
+          expect(error.message).to.equal(
+            'Validation failed (no Date provided)',
+          );
+        }
+      });
+    });
+  });
+});
diff --git a/packages/common/test/pipes/parse-enum.pipe.spec.ts b/packages/common/test/pipes/parse-enum.pipe.spec.ts
index 77b57624e..5182781dc 100644
--- a/packages/common/test/pipes/parse-enum.pipe.spec.ts
+++ b/packages/common/test/pipes/parse-enum.pipe.spec.ts
@@ -14,6 +14,7 @@ describe('ParseEnumPipe', () => {
     Up = 'UP',
   }
   let target: ParseEnumPipe;
+
   beforeEach(() => {
     target = new ParseEnumPipe(Direction, {
       exceptionFactory: (error: any) => new CustomTestError(),
@@ -26,6 +27,15 @@ describe('ParseEnumPipe', () => {
           Direction.Up,
         );
       });
+
+      it('should not throw an error if enumType is undefined/null and optional is true', async () => {
+        const target = new ParseEnumPipe('DOWN', { optional: true });
+        const value = await target.transform(
+          undefined!,
+          {} as ArgumentMetadata,
+        );
+        expect(value).to.equal(undefined);
+      });
     });
     describe('when validation fails', () => {
       it('should throw an error', async () => {
@@ -33,6 +43,16 @@ describe('ParseEnumPipe', () => {
           target.transform('DOWN', {} as ArgumentMetadata),
         ).to.be.rejectedWith(CustomTestError);
       });
+
+      it('should throw an error if enumType is wrong and optional is true', async () => {
+        target = new ParseEnumPipe(Direction, {
+          exceptionFactory: (error: any) => new CustomTestError(),
+          optional: true,
+        });
+        return expect(
+          target.transform('DOWN', {} as ArgumentMetadata),
+        ).to.be.rejectedWith(CustomTestError);
+      });
     });
   });
   describe('constructor', () => {
diff --git a/packages/common/test/pipes/parse-float.pipe.spec.ts b/packages/common/test/pipes/parse-float.pipe.spec.ts
index ba92cba4d..5343c23a6 100644
--- a/packages/common/test/pipes/parse-float.pipe.spec.ts
+++ b/packages/common/test/pipes/parse-float.pipe.spec.ts
@@ -1,8 +1,7 @@
-import * as sinon from 'sinon';
 import { expect } from 'chai';
+import { HttpException } from '../../exceptions';
 import { ArgumentMetadata } from '../../interfaces';
 import { ParseFloatPipe } from '../../pipes/parse-float.pipe';
-import { HttpException } from '../../exceptions';
 
 class CustomTestError extends HttpException {
   constructor() {
@@ -25,6 +24,14 @@ describe('ParseFloatPipe', () => {
           parseFloat(num),
         );
       });
+      it('should not throw an error if the value is undefined/null and optional is true', async () => {
+        const target = new ParseFloatPipe({ optional: true });
+        const value = await target.transform(
+          undefined!,
+          {} as ArgumentMetadata,
+        );
+        expect(value).to.equal(undefined);
+      });
     });
     describe('when validation fails', () => {
       it('should throw an error', async () => {
diff --git a/packages/common/test/pipes/parse-int.pipe.spec.ts b/packages/common/test/pipes/parse-int.pipe.spec.ts
index 3bb7ab185..5c2370a74 100644
--- a/packages/common/test/pipes/parse-int.pipe.spec.ts
+++ b/packages/common/test/pipes/parse-int.pipe.spec.ts
@@ -1,8 +1,7 @@
-import * as sinon from 'sinon';
 import { expect } from 'chai';
+import { HttpException } from '../../exceptions';
 import { ArgumentMetadata } from '../../interfaces';
 import { ParseIntPipe } from '../../pipes/parse-int.pipe';
-import { HttpException } from '../../exceptions';
 
 class CustomTestError extends HttpException {
   constructor() {
@@ -31,6 +30,14 @@ describe('ParseIntPipe', () => {
           -3,
         );
       });
+      it('should not throw an error if the value is undefined/null and optional is true', async () => {
+        const target = new ParseIntPipe({ optional: true });
+        const value = await target.transform(
+          undefined!,
+          {} as ArgumentMetadata,
+        );
+        expect(value).to.equal(undefined);
+      });
     });
     describe('when validation fails', () => {
       it('should throw an error', async () => {
diff --git a/packages/common/test/pipes/parse-uuid.pipe.spec.ts b/packages/common/test/pipes/parse-uuid.pipe.spec.ts
index 3f6cb79fb..a28d1c0b7 100644
--- a/packages/common/test/pipes/parse-uuid.pipe.spec.ts
+++ b/packages/common/test/pipes/parse-uuid.pipe.spec.ts
@@ -1,9 +1,18 @@
 import { expect } from 'chai';
+import { HttpStatus } from '../../enums';
+import { HttpException } from '../../exceptions';
 import { ArgumentMetadata } from '../../interfaces';
 import { ParseUUIDPipe } from '../../pipes/parse-uuid.pipe';
 
+class TestException extends HttpException {
+  constructor() {
+    super('This is a TestException', HttpStatus.I_AM_A_TEAPOT);
+  }
+}
+
 describe('ParseUUIDPipe', () => {
   let target: ParseUUIDPipe;
+  const exceptionFactory = (error: any) => new TestException();
 
   describe('transform', () => {
     const v3 = 'e8b5a51d-11c8-3310-a6ab-367563f20686';
@@ -12,53 +21,88 @@ describe('ParseUUIDPipe', () => {
 
     describe('when validation passes', () => {
       it('should return string if value is uuid v3, v4 or v5', async () => {
-        target = new ParseUUIDPipe();
+        target = new ParseUUIDPipe({ exceptionFactory });
         expect(await target.transform(v3, {} as ArgumentMetadata)).to.equal(v3);
         expect(await target.transform(v4, {} as ArgumentMetadata)).to.equal(v4);
         expect(await target.transform(v5, {} as ArgumentMetadata)).to.equal(v5);
       });
 
       it('should return string if value is uuid v3', async () => {
-        target = new ParseUUIDPipe({ version: '3' });
+        target = new ParseUUIDPipe({ version: '3', exceptionFactory });
         expect(await target.transform(v3, {} as ArgumentMetadata)).to.equal(v3);
       });
 
       it('should return string if value is uuid v4', async () => {
-        target = new ParseUUIDPipe({ version: '4' });
+        target = new ParseUUIDPipe({ version: '4', exceptionFactory });
         expect(await target.transform(v4, {} as ArgumentMetadata)).to.equal(v4);
       });
 
       it('should return string if value is uuid v5', async () => {
-        target = new ParseUUIDPipe({ version: '5' });
+        target = new ParseUUIDPipe({ version: '5', exceptionFactory });
         expect(await target.transform(v5, {} as ArgumentMetadata)).to.equal(v5);
       });
+      it('should not throw an error if the value is undefined/null and optional is true', async () => {
+        const target = new ParseUUIDPipe({ optional: true });
+        const value = await target.transform(
+          undefined!,
+          {} as ArgumentMetadata,
+        );
+        expect(value).to.equal(undefined);
+      });
     });
 
     describe('when validation fails', () => {
       it('should throw an error', async () => {
-        target = new ParseUUIDPipe();
-        expect(target.transform('123a', {} as ArgumentMetadata)).to.be.rejected;
+        target = new ParseUUIDPipe({ exceptionFactory });
+        await expect(
+          target.transform('123a', {} as ArgumentMetadata),
+        ).to.be.rejectedWith(TestException);
+      });
+
+      it('should throw an error - not a string', async () => {
+        target = new ParseUUIDPipe({ exceptionFactory });
+        await expect(
+          target.transform(undefined!, {} as ArgumentMetadata),
+        ).to.be.rejectedWith(TestException);
       });
 
       it('should throw an error - v3', async () => {
-        target = new ParseUUIDPipe({ version: '3' });
-        expect(target.transform('123a', {} as ArgumentMetadata)).to.be.rejected;
-        expect(target.transform(v4, {} as ArgumentMetadata)).to.be.rejected;
-        expect(target.transform(v5, {} as ArgumentMetadata)).to.be.rejected;
+        target = new ParseUUIDPipe({ version: '3', exceptionFactory });
+        await expect(
+          target.transform('123a', {} as ArgumentMetadata),
+        ).to.be.rejectedWith(TestException);
+        await expect(
+          target.transform(v4, {} as ArgumentMetadata),
+        ).to.be.rejectedWith(TestException);
+        await expect(
+          target.transform(v5, {} as ArgumentMetadata),
+        ).to.be.rejectedWith(TestException);
       });
 
       it('should throw an error - v4', async () => {
-        target = new ParseUUIDPipe({ version: '4' });
-        expect(target.transform('123a', {} as ArgumentMetadata)).to.be.rejected;
-        expect(target.transform(v3, {} as ArgumentMetadata)).to.be.rejected;
-        expect(target.transform(v5, {} as ArgumentMetadata)).to.be.rejected;
+        target = new ParseUUIDPipe({ version: '4', exceptionFactory });
+        await expect(
+          target.transform('123a', {} as ArgumentMetadata),
+        ).to.be.rejectedWith(TestException);
+        await expect(
+          target.transform(v3, {} as ArgumentMetadata),
+        ).to.be.rejectedWith(TestException);
+        await expect(
+          target.transform(v5, {} as ArgumentMetadata),
+        ).to.be.rejectedWith(TestException);
       });
 
       it('should throw an error - v5 ', async () => {
-        target = new ParseUUIDPipe({ version: '5' });
-        expect(target.transform('123a', {} as ArgumentMetadata)).to.be.rejected;
-        expect(target.transform(v3, {} as ArgumentMetadata)).to.be.rejected;
-        expect(target.transform(v4, {} as ArgumentMetadata)).to.be.rejected;
+        target = new ParseUUIDPipe({ version: '5', exceptionFactory });
+        await expect(
+          target.transform('123a', {} as ArgumentMetadata),
+        ).to.be.rejectedWith(TestException);
+        await expect(
+          target.transform(v3, {} as ArgumentMetadata),
+        ).to.be.rejectedWith(TestException);
+        await expect(
+          target.transform(v4, {} as ArgumentMetadata),
+        ).to.be.rejectedWith(TestException);
       });
     });
   });
diff --git a/packages/common/test/pipes/validation.pipe.spec.ts b/packages/common/test/pipes/validation.pipe.spec.ts
index 00a69a42d..128658035 100644
--- a/packages/common/test/pipes/validation.pipe.spec.ts
+++ b/packages/common/test/pipes/validation.pipe.spec.ts
@@ -3,12 +3,12 @@ import { expect } from 'chai';
 import * as chaiAsPromised from 'chai-as-promised';
 import { Exclude, Expose, Type } from 'class-transformer';
 import {
+  IsArray,
   IsBoolean,
   IsDefined,
   IsOptional,
   IsString,
   ValidateNested,
-  IsArray,
 } from 'class-validator';
 import { HttpStatus } from '../../enums';
 import { UnprocessableEntityException } from '../../exceptions';
@@ -45,7 +45,7 @@ class TestModel {
   public optionalProp: string;
 }
 
-class TestModelNoValidaton {
+class TestModelNoValidation {
   constructor() {}
 
   public prop1: string;
@@ -205,6 +205,18 @@ describe('ValidationPipe', () => {
             }),
           ).to.be.equal(+value);
         });
+        it('should parse undefined to undefined', async () => {
+          target = new ValidationPipe({ transform: true });
+          const value = undefined;
+
+          expect(
+            await target.transform(value, {
+              metatype: Number,
+              data: 'test',
+              type: 'query',
+            }),
+          ).to.be.undefined;
+        });
       });
       describe('when input is a path parameter (number)', () => {
         it('should parse to number', async () => {
@@ -219,9 +231,21 @@ describe('ValidationPipe', () => {
             }),
           ).to.be.equal(+value);
         });
+        it('should parse undefined to undefined', async () => {
+          target = new ValidationPipe({ transform: true });
+          const value = undefined;
+
+          expect(
+            await target.transform(value, {
+              metatype: Number,
+              data: 'test',
+              type: 'param',
+            }),
+          ).to.be.undefined;
+        });
       });
       describe('when input is a query parameter (boolean)', () => {
-        it('should parse to boolean', async () => {
+        it('should parse the string "true" to the boolean true', async () => {
           target = new ValidationPipe({ transform: true });
           const value = 'true';
 
@@ -233,9 +257,45 @@ describe('ValidationPipe', () => {
             }),
           ).to.be.true;
         });
+        it('should parse the string "false" to the boolean false', async () => {
+          target = new ValidationPipe({ transform: true });
+          const value = 'false';
+
+          expect(
+            await target.transform(value, {
+              metatype: Boolean,
+              data: 'test',
+              type: 'query',
+            }),
+          ).to.be.false;
+        });
+        it('should parse an empty string to false', async () => {
+          target = new ValidationPipe({ transform: true });
+          const value = '';
+
+          expect(
+            await target.transform(value, {
+              metatype: Boolean,
+              data: 'test',
+              type: 'query',
+            }),
+          ).to.be.false;
+        });
+        it('should parse undefined to undefined', async () => {
+          target = new ValidationPipe({ transform: true });
+          const value = undefined;
+
+          expect(
+            await target.transform(value, {
+              metatype: Boolean,
+              data: 'test',
+              type: 'query',
+            }),
+          ).to.be.undefined;
+        });
       });
       describe('when input is a path parameter (boolean)', () => {
-        it('should parse to boolean', async () => {
+        it('should parse the string "true" to boolean true', async () => {
           target = new ValidationPipe({ transform: true });
           const value = 'true';
 
@@ -247,6 +307,42 @@ describe('ValidationPipe', () => {
             }),
           ).to.be.true;
         });
+        it('should parse the string "false" to boolean false', async () => {
+          target = new ValidationPipe({ transform: true });
+          const value = 'false';
+
+          expect(
+            await target.transform(value, {
+              metatype: Boolean,
+              data: 'test',
+              type: 'param',
+            }),
+          ).to.be.false;
+        });
+        it('should parse an empty string to false', async () => {
+          target = new ValidationPipe({ transform: true });
+          const value = '';
+
+          expect(
+            await target.transform(value, {
+              metatype: Boolean,
+              data: 'test',
+              type: 'param',
+            }),
+          ).to.be.false;
+        });
+        it('should parse undefined to undefined', async () => {
+          target = new ValidationPipe({ transform: true });
+          const value = undefined;
+
+          expect(
+            await target.transform(value, {
+              metatype: Boolean,
+              data: 'test',
+              type: 'param',
+            }),
+          ).to.be.undefined;
+        });
       });
       describe('when validation strips', () => {
         it('should return a TestModel without extra properties', async () => {
@@ -367,7 +463,7 @@ describe('ValidationPipe', () => {
         });
       });
     });
-    describe('when type doesnt match', () => {
+    describe("when type doesn't match", () => {
       describe('when validation rules are applied', () => {
         it('should throw an error', async () => {
           target = new ValidationPipe();
@@ -389,7 +485,7 @@ describe('ValidationPipe', () => {
             { prop1: 'value1', prop2: 'value2', prop3: 'value3' },
           ];
 
-          const objMetadata = { ...metadata, metatype: TestModelNoValidaton };
+          const objMetadata = { ...metadata, metatype: TestModelNoValidation };
           const result = await target.transform(testObj, objMetadata);
 
           expect(result).to.not.be.instanceOf(TestModel);
@@ -406,6 +502,56 @@ describe('ValidationPipe', () => {
     });
   });
 
+  describe('option: "validateCustomDecorators" when metadata.type is not `body`', () => {
+    describe('when is set to `true`', () => {
+      it('should transform and validate', async () => {
+        const target = new ValidationPipe({
+          validateCustomDecorators: true,
+        });
+
+        const metadata: ArgumentMetadata = {
+          type: 'custom',
+          metatype: TestModel,
+          data: '',
+        };
+
+        const testObj = { prop1: 'value1', prop2: 'value2' };
+        expect(await target.transform(testObj, metadata)).to.not.be.undefined;
+      });
+    });
+    describe('when is set to `false`', () => {
+      it('should throw an error', async () => {
+        const target = new ValidationPipe({
+          validateCustomDecorators: false,
+        });
+
+        const metadata: ArgumentMetadata = {
+          type: 'custom',
+          metatype: TestModel,
+          data: '',
+        };
+
+        const objNotFollowingTestModel = { prop1: undefined, prop2: 'value2' };
+        expect(await target.transform(objNotFollowingTestModel, metadata)).to
+          .not.be.undefined;
+      });
+    });
+    describe('when is not supplied', () => {
+      it('should transform and validate', async () => {
+        const target = new ValidationPipe({});
+
+        const metadata: ArgumentMetadata = {
+          type: 'custom',
+          metatype: TestModel,
+          data: '',
+        };
+
+        const testObj = { prop1: 'value1', prop2: 'value2' };
+        expect(await target.transform(testObj, metadata)).to.not.be.undefined;
+      });
+    });
+  });
+
   describe('option: "errorHttpStatusCode"', () => {
     describe('when validation fails', () => {
       beforeEach(() => {
@@ -447,7 +593,7 @@ describe('ValidationPipe', () => {
       target = new ValidationPipe({ expectedType: TestModel });
       const testObj = { prop1: 'value1', prop2: 'value2' };
 
-      expect(await target.transform(testObj, m)).to.equal(testObj);
+      expect(await target.transform(testObj, m)).to.deep.equal(testObj);
     });
 
     it('should validate against the expected type if presented and metatype is primitive type', async () => {
@@ -460,7 +606,7 @@ describe('ValidationPipe', () => {
       target = new ValidationPipe({ expectedType: TestModel });
       const testObj = { prop1: 'value1', prop2: 'value2' };
 
-      expect(await target.transform(testObj, m)).to.equal(testObj);
+      expect(await target.transform(testObj, m)).to.deep.equal(testObj);
     });
   });
 });
diff --git a/packages/common/test/services/logger.service.spec.ts b/packages/common/test/services/logger.service.spec.ts
index 5caa83a65..81fff5fde 100644
--- a/packages/common/test/services/logger.service.spec.ts
+++ b/packages/common/test/services/logger.service.spec.ts
@@ -1,7 +1,7 @@
 import { expect } from 'chai';
 import 'reflect-metadata';
 import * as sinon from 'sinon';
-import { ConsoleLogger, Logger, LoggerService } from '../../services';
+import { ConsoleLogger, Logger, LoggerService, LogLevel } from '../../services';
 
 describe('Logger', () => {
   describe('[static methods]', () => {
@@ -70,7 +70,7 @@ describe('Logger', () => {
         );
       });
 
-      it('should print one error to the console', () => {
+      it('should print one error to the console with context', () => {
         const message = 'random error';
         const context = 'RandomContext';
 
@@ -83,6 +83,20 @@ describe('Logger', () => {
         expect(processStderrWriteSpy.firstCall.firstArg).to.include(message);
       });
 
+      it('should print one error to the console with stacktrace', () => {
+        const message = 'random error';
+        const stacktrace = 'Error: message\n    at <anonymous>:1:2';
+
+        Logger.error(message, stacktrace);
+
+        expect(processStderrWriteSpy.calledTwice).to.be.true;
+        expect(processStderrWriteSpy.firstCall.firstArg).to.not.include(`[]`);
+        expect(processStderrWriteSpy.firstCall.firstArg).to.include(message);
+        expect(processStderrWriteSpy.secondCall.firstArg).to.equal(
+          stacktrace + '\n',
+        );
+      });
+
       it('should print one error without context to the console', () => {
         const message = 'random error without context';
 
@@ -111,9 +125,12 @@ describe('Logger', () => {
         Logger.error(error);
 
         expect(processStderrWriteSpy.calledOnce).to.be.true;
-        expect(processStderrWriteSpy.firstCall.firstArg).to.include(`Object:`);
+
+        expect(processStderrWriteSpy.firstCall.firstArg).to.include(
+          `Object(${Object.keys(error).length})`,
+        );
         expect(processStderrWriteSpy.firstCall.firstArg).to.include(
-          `{\n  "randomError": true\n}`,
+          `randomError: \x1b[33mtrue`,
         );
       });
 
@@ -167,6 +184,153 @@ describe('Logger', () => {
         expect(processStderrWriteSpy.thirdCall.firstArg).to.equal(stack + '\n');
       });
     });
+
+    describe('when the default logger is used and json mode is enabled', () => {
+      const logger = new ConsoleLogger({ json: true });
+
+      let processStdoutWriteSpy: sinon.SinonSpy;
+      let processStderrWriteSpy: sinon.SinonSpy;
+
+      beforeEach(() => {
+        processStdoutWriteSpy = sinon.spy(process.stdout, 'write');
+        processStderrWriteSpy = sinon.spy(process.stderr, 'write');
+      });
+
+      afterEach(() => {
+        processStdoutWriteSpy.restore();
+        processStderrWriteSpy.restore();
+      });
+
+      it('should print error with stack as JSON to the console', () => {
+        const errorMessage = 'error message';
+        const error = new Error(errorMessage);
+
+        logger.error(error.message, error.stack);
+
+        const json = JSON.parse(processStderrWriteSpy.firstCall?.firstArg);
+
+        expect(json.pid).to.equal(process.pid);
+        expect(json.level).to.equal('error');
+        expect(json.message).to.equal(errorMessage);
+      });
+      it('should log out to stdout as JSON', () => {
+        const message = 'message 1';
+
+        logger.log(message);
+
+        const json = JSON.parse(processStdoutWriteSpy.firstCall?.firstArg);
+
+        expect(json.pid).to.equal(process.pid);
+        expect(json.level).to.equal('log');
+        expect(json.message).to.equal(message);
+      });
+      it('should log out an error to stderr as JSON', () => {
+        const message = 'message 1';
+
+        logger.error(message);
+
+        const json = JSON.parse(processStderrWriteSpy.firstCall?.firstArg);
+
+        expect(json.pid).to.equal(process.pid);
+        expect(json.level).to.equal('error');
+        expect(json.message).to.equal(message);
+      });
+      it('should log Map object', () => {
+        const map = new Map([
+          ['key1', 'value1'],
+          ['key2', 'value2'],
+        ]);
+
+        logger.log(map);
+
+        const json = JSON.parse(processStdoutWriteSpy.firstCall?.firstArg);
+
+        expect(json.pid).to.equal(process.pid);
+        expect(json.level).to.equal('log');
+        expect(json.message).to.equal(
+          `Map(2) { 'key1' => 'value1', 'key2' => 'value2' }`,
+        );
+      });
+      it('should log Set object', () => {
+        const set = new Set(['value1', 'value2']);
+
+        logger.log(set);
+
+        const json = JSON.parse(processStdoutWriteSpy.firstCall?.firstArg);
+
+        expect(json.pid).to.equal(process.pid);
+        expect(json.level).to.equal('log');
+        expect(json.message).to.equal(`Set(2) { 'value1', 'value2' }`);
+      });
+      it('should log bigint', () => {
+        const bigInt = BigInt(9007199254740991);
+
+        logger.log(bigInt);
+
+        const json = JSON.parse(processStdoutWriteSpy.firstCall?.firstArg);
+
+        expect(json.pid).to.equal(process.pid);
+        expect(json.level).to.equal('log');
+        expect(json.message).to.equal('9007199254740991');
+      });
+      it('should log symbol', () => {
+        const symbol = Symbol('test');
+
+        logger.log(symbol);
+
+        const json = JSON.parse(processStdoutWriteSpy.firstCall?.firstArg);
+
+        expect(json.pid).to.equal(process.pid);
+        expect(json.level).to.equal('log');
+        expect(json.message).to.equal('Symbol(test)');
+      });
+    });
+
+    describe('when the default logger is used, json mode is enabled and compact is false (utils.inspect)', () => {
+      const logger = new ConsoleLogger({ json: true, compact: false });
+
+      let processStdoutWriteSpy: sinon.SinonSpy;
+      let processStderrWriteSpy: sinon.SinonSpy;
+
+      beforeEach(() => {
+        processStdoutWriteSpy = sinon.spy(process.stdout, 'write');
+        processStderrWriteSpy = sinon.spy(process.stderr, 'write');
+      });
+
+      afterEach(() => {
+        processStdoutWriteSpy.restore();
+        processStderrWriteSpy.restore();
+      });
+
+      it('should log out to stdout as JSON (utils.inspect)', () => {
+        const message = 'message 1';
+
+        logger.log(message);
+
+        const json = convertInspectToJSON(
+          processStdoutWriteSpy.firstCall?.firstArg,
+        );
+
+        expect(json.pid).to.equal(process.pid);
+        expect(json.level).to.equal('log');
+        expect(json.message).to.equal(message);
+      });
+
+      it('should log out an error to stderr as JSON (utils.inspect)', () => {
+        const message = 'message 1';
+
+        logger.error(message);
+
+        const json = convertInspectToJSON(
+          processStderrWriteSpy.firstCall?.firstArg,
+        );
+
+        expect(json.pid).to.equal(process.pid);
+        expect(json.level).to.equal('error');
+        expect(json.message).to.equal(message);
+      });
+    });
+
     describe('when logging is disabled', () => {
       let processStdoutWriteSpy: sinon.SinonSpy;
       let previousLoggerRef: LoggerService;
@@ -256,6 +420,61 @@ describe('Logger', () => {
       loggerWithContext.resetContext();
       expect(loggerWithContext['context']).to.equal('context');
     });
+
+    describe('functions for message', () => {
+      let processStdoutWriteSpy: sinon.SinonSpy;
+      const logger = new ConsoleLogger();
+      const message = 'Hello World';
+
+      beforeEach(() => {
+        processStdoutWriteSpy = sinon.spy(process.stdout, 'write');
+      });
+      afterEach(() => {
+        processStdoutWriteSpy.restore();
+      });
+
+      it('works', () => {
+        logger.log(() => message);
+
+        expect(processStdoutWriteSpy.calledOnce).to.be.true;
+        expect(processStdoutWriteSpy.firstCall.firstArg).to.include(message);
+        // Ensure we didn't serialize the function itself.
+        expect(processStdoutWriteSpy.firstCall.firstArg).not.to.include(' => ');
+        expect(processStdoutWriteSpy.firstCall.firstArg).not.to.include(
+          'function',
+        );
+        expect(processStdoutWriteSpy.firstCall.firstArg).not.to.include(
+          'Function',
+        );
+      });
+    });
+
+    describe('classes for message', () => {
+      let processStdoutWriteSpy: sinon.SinonSpy;
+
+      beforeEach(() => {
+        processStdoutWriteSpy = sinon.spy(process.stdout, 'write');
+      });
+      afterEach(() => {
+        processStdoutWriteSpy.restore();
+      });
+
+      it("should display class's name or empty for anonymous classes", () => {
+        const logger = new ConsoleLogger();
+
+        // in-line anonymous class
+        logger.log(class {});
+
+        // named class
+        class Test {
+          publicField = 'public field';
+        }
+        logger.log(Test);
+
+        expect(processStdoutWriteSpy.firstCall.firstArg).to.include('');
+        expect(processStdoutWriteSpy.secondCall.firstArg).to.include(Test.name);
+      });
+    });
   });
 
   describe('[instance methods]', () => {
@@ -326,7 +545,7 @@ describe('Logger', () => {
         );
       });
 
-      it('should print one error to the console', () => {
+      it('should print one error to the console with context', () => {
         const message = 'random error';
         const context = 'RandomContext';
 
@@ -339,6 +558,20 @@ describe('Logger', () => {
         expect(processStderrWriteSpy.firstCall.firstArg).to.include(message);
       });
 
+      it('should print one error to the console with stacktrace', () => {
+        const message = 'random error';
+        const stacktrace = new Error('err').stack;
+
+        logger.error(message, stacktrace);
+
+        expect(processStderrWriteSpy.calledTwice).to.be.true;
+        expect(processStderrWriteSpy.firstCall.firstArg).to.not.include(`[]`);
+        expect(processStderrWriteSpy.firstCall.firstArg).to.include(message);
+        expect(processStderrWriteSpy.secondCall.firstArg).to.equal(
+          stacktrace + '\n',
+        );
+      });
+
       it('should print one error without context to the console', () => {
         const message = 'random error without context';
 
@@ -442,6 +675,17 @@ describe('Logger', () => {
         );
         expect(processStdoutWriteSpy.thirdCall.firstArg).to.include('ms');
       });
+      it('should log out an error to stderr but not include an undefined log', () => {
+        const message = 'message 1';
+
+        logger.error(message);
+
+        expect(processStderrWriteSpy.calledOnce).to.be.true;
+        expect(processStderrWriteSpy.firstCall.firstArg).to.include(
+          `[${globalContext}]`,
+        );
+        expect(processStderrWriteSpy.firstCall.firstArg).to.include(message);
+      });
     });
 
     describe('when logging is disabled', () => {
@@ -473,6 +717,7 @@ describe('Logger', () => {
         expect(processStdoutWriteSpy.called).to.be.false;
       });
     });
+
     describe('when custom logger is being used', () => {
       class CustomLogger implements LoggerService {
         log(message: any, context?: string) {}
@@ -480,44 +725,204 @@ describe('Logger', () => {
         warn(message: any, context?: string) {}
       }
 
-      const customLogger = new CustomLogger();
-      const originalLogger = new Logger();
+      describe('with global context', () => {
+        const customLogger = new CustomLogger();
+        const globalContext = 'RandomContext';
+        const originalLogger = new Logger(globalContext);
 
-      let previousLoggerRef: LoggerService;
+        let previousLoggerRef: LoggerService;
 
-      beforeEach(() => {
-        previousLoggerRef =
-          Logger['localInstanceRef'] || Logger['staticInstanceRef'];
-        Logger.overrideLogger(customLogger);
-      });
+        beforeEach(() => {
+          previousLoggerRef =
+            Logger['localInstanceRef'] || Logger['staticInstanceRef'];
+          Logger.overrideLogger(customLogger);
+        });
 
-      afterEach(() => {
-        Logger.overrideLogger(previousLoggerRef);
-      });
+        afterEach(() => {
+          Logger.overrideLogger(previousLoggerRef);
+        });
 
-      it('should call custom logger "#log()" method', () => {
-        const message = 'random message';
-        const context = 'RandomContext';
+        it('should call custom logger "#log()" method with context as second argument', () => {
+          const message = 'random log message with global context';
 
-        const customLoggerLogSpy = sinon.spy(customLogger, 'log');
+          const customLoggerLogSpy = sinon.spy(customLogger, 'log');
 
-        originalLogger.log(message, context);
+          originalLogger.log(message);
 
-        expect(customLoggerLogSpy.called).to.be.true;
-        expect(customLoggerLogSpy.calledWith(message, context)).to.be.true;
+          expect(customLoggerLogSpy.called).to.be.true;
+          expect(customLoggerLogSpy.calledWith(message, globalContext)).to.be
+            .true;
+        });
+        it('should call custom logger "#error()" method with context as third argument', () => {
+          const message = 'random error message with global context';
+
+          const customLoggerErrorSpy = sinon.spy(customLogger, 'error');
+
+          originalLogger.error(message);
+
+          expect(customLoggerErrorSpy.called).to.be.true;
+          expect(
+            customLoggerErrorSpy.calledWith(message, undefined, globalContext),
+          ).to.be.true;
+        });
       });
+      describe('without global context', () => {
+        const customLogger = new CustomLogger();
+        const originalLogger = new Logger();
 
-      it('should call custom logger "#error()" method', () => {
-        const message = 'random message';
-        const context = 'RandomContext';
+        let previousLoggerRef: LoggerService;
 
-        const customLoggerErrorSpy = sinon.spy(customLogger, 'error');
+        beforeEach(() => {
+          previousLoggerRef =
+            Logger['localInstanceRef'] || Logger['staticInstanceRef'];
+          Logger.overrideLogger(customLogger);
+        });
 
-        originalLogger.error(message, context);
+        afterEach(() => {
+          Logger.overrideLogger(previousLoggerRef);
+        });
 
-        expect(customLoggerErrorSpy.called).to.be.true;
-        expect(customLoggerErrorSpy.calledWith(message, context)).to.be.true;
+        it('should call custom logger "#log()" method', () => {
+          const message = 'random message';
+          const context = 'RandomContext';
+
+          const customLoggerLogSpy = sinon.spy(customLogger, 'log');
+
+          originalLogger.log(message, context);
+
+          expect(customLoggerLogSpy.called).to.be.true;
+          expect(customLoggerLogSpy.calledWith(message, context)).to.be.true;
+        });
+
+        it('should call custom logger "#error()" method', () => {
+          const message = 'random message';
+          const context = 'RandomContext';
+
+          const customLoggerErrorSpy = sinon.spy(customLogger, 'error');
+
+          originalLogger.error(message, undefined, context);
+
+          expect(customLoggerErrorSpy.called).to.be.true;
+          expect(customLoggerErrorSpy.calledWith(message, undefined, context))
+            .to.be.true;
+        });
       });
     });
   });
+  describe('ConsoleLogger', () => {
+    let processStdoutWriteSpy: sinon.SinonSpy;
+
+    beforeEach(() => {
+      processStdoutWriteSpy = sinon.spy(process.stdout, 'write');
+    });
+    afterEach(() => {
+      processStdoutWriteSpy.restore();
+    });
+
+    it('should support custom formatter', () => {
+      class CustomConsoleLogger extends ConsoleLogger {
+        protected formatMessage(
+          logLevel: LogLevel,
+          message: unknown,
+          pidMessage: string,
+          formattedLogLevel: string,
+          contextMessage: string,
+          timestampDiff: string,
+        ) {
+          return `Prefix: ${message as string}`;
+        }
+      }
+
+      const consoleLogger = new CustomConsoleLogger();
+      consoleLogger.debug('test');
+
+      expect(processStdoutWriteSpy.firstCall.firstArg).to.equal(`Prefix: test`);
+    });
+
+    it('should support custom formatter and colorizer', () => {
+      class CustomConsoleLogger extends ConsoleLogger {
+        protected formatMessage(
+          logLevel: LogLevel,
+          message: unknown,
+          pidMessage: string,
+          formattedLogLevel: string,
+          contextMessage: string,
+          timestampDiff: string,
+        ) {
+          const strMessage = this.stringifyMessage(message, logLevel);
+          return `Prefix: ${strMessage}`;
+        }
+
+        protected colorize(message: string, logLevel: LogLevel): string {
+          return `~~~${message}~~~`;
+        }
+      }
+
+      const consoleLogger = new CustomConsoleLogger();
+      consoleLogger.debug('test');
+
+      expect(processStdoutWriteSpy.firstCall.firstArg).to.equal(
+        `Prefix: ~~~test~~~`,
+      );
+    });
+
+    it('should stringify messages', () => {
+      class CustomConsoleLogger extends ConsoleLogger {
+        protected colorize(message: string, _: LogLevel): string {
+          return message;
+        }
+      }
+
+      const consoleLogger = new CustomConsoleLogger({ colors: false });
+      const consoleLoggerSpy = sinon.spy(
+        consoleLogger,
+        'stringifyMessage' as keyof ConsoleLogger,
+      );
+      consoleLogger.debug(
+        'str1',
+        { key: 'str2' },
+        ['str3'],
+        [{ key: 'str4' }],
+        null,
+        1,
+      );
+
+      expect(consoleLoggerSpy.getCall(0).returnValue).to.equal('str1');
+      expect(consoleLoggerSpy.getCall(1).returnValue).to.equal(
+        `Object(1) {
+  key: 'str2'
+}`,
+      );
+      expect(consoleLoggerSpy.getCall(2).returnValue).to.equal(
+        `Array(1) [
+  'str3'
+]`,
+      );
+      expect(consoleLoggerSpy.getCall(3).returnValue).to.equal(
+        `Array(1) [
+  {
+    key: 'str4'
+  }
+]`,
+      );
+      expect(consoleLoggerSpy.getCall(4).returnValue).to.equal('null');
+      expect(consoleLoggerSpy.getCall(5).returnValue).to.equal('1');
+    });
+  });
 });
+
+function convertInspectToJSON(inspectOutput: string) {
+  const jsonLikeString = inspectOutput
+    .replace(/'([^']+)'/g, '"$1"') // single-quoted strings
+    .replace(/([a-zA-Z0-9_]+):/g, '"$1":') // unquoted object keys
+    .replace(/\bundefined\b/g, 'null')
+    .replace(/\[Function(: [^\]]+)?\]/g, '"[Function]"')
+    .replace(/\[Circular\]/g, '"[Circular]"');
+
+  try {
+    return JSON.parse(jsonLikeString);
+  } catch (error) {
+    console.error('Error parsing the modified inspect output:', error);
+    throw error;
+  }
+}
diff --git a/packages/common/test/services/utils/is-log-level-enabled.util.spec.ts b/packages/common/test/services/utils/is-log-level-enabled.util.spec.ts
index 9575d67ef..27d18ea13 100644
--- a/packages/common/test/services/utils/is-log-level-enabled.util.spec.ts
+++ b/packages/common/test/services/utils/is-log-level-enabled.util.spec.ts
@@ -22,8 +22,8 @@ describe('isLogLevelEnabled', () => {
   ];
 
   for (const { inputArgs, expectedReturnValue } of tests) {
-    describe(`when log levels = [${inputArgs[1]}]`, () => {
-      describe(`and target level is "${inputArgs[0]}"`, () => {
+    describe(`when log levels = [${inputArgs[1] as string}]`, () => {
+      describe(`and target level is "${inputArgs[0] as string}"`, () => {
         it('should return true', () => {
           expect(
             isLogLevelEnabled(...(inputArgs as [LogLevel, LogLevel[]])),
diff --git a/packages/common/test/tsconfig.json b/packages/common/test/tsconfig.json
new file mode 100644
index 000000000..50d59661d
--- /dev/null
+++ b/packages/common/test/tsconfig.json
@@ -0,0 +1,3 @@
+{
+  "extends": "../../../tsconfig.spec.json"
+}
diff --git a/packages/common/test/utils/load-package.util.spec.ts b/packages/common/test/utils/load-package.util.spec.ts
index 7ca864409..3126cb3b6 100644
--- a/packages/common/test/utils/load-package.util.spec.ts
+++ b/packages/common/test/utils/load-package.util.spec.ts
@@ -5,7 +5,6 @@ describe('loadPackage', () => {
   describe('when package is available', () => {
     it('should return package', () => {
       expect(loadPackage('reflect-metadata', 'ctx')).to.be.eql(
-        // eslint-disable-next-line @typescript-eslint/no-var-requires
         require('reflect-metadata'),
       );
     });
diff --git a/packages/common/test/utils/select-exception-filter-metadata.util.spec.ts b/packages/common/test/utils/select-exception-filter-metadata.util.spec.ts
new file mode 100644
index 000000000..f2fb5b92f
--- /dev/null
+++ b/packages/common/test/utils/select-exception-filter-metadata.util.spec.ts
@@ -0,0 +1,85 @@
+import { expect } from 'chai';
+import { selectExceptionFilterMetadata } from '../../utils/select-exception-filter-metadata.util';
+
+class FirstError {}
+
+class SecondError {}
+
+class ThirdError {}
+
+class FourthError {}
+
+describe('selectExceptionFilterMetadata', () => {
+  it('should pass error handling to first suitable error handler', () => {
+    const metadataList = [
+      {
+        exceptionMetatypes: [FirstError, SecondError],
+        func: () => {},
+      },
+      {
+        exceptionMetatypes: [ThirdError, FourthError],
+        func: () => {},
+      },
+    ];
+
+    expect(
+      selectExceptionFilterMetadata(metadataList, new FourthError()),
+    ).to.be.equal(metadataList[1]);
+  });
+
+  describe('when multiple exception handlers are accepting error handling', () => {
+    it('should pass exception handling to the first one', () => {
+      const metadataList = [
+        {
+          exceptionMetatypes: [FirstError, SecondError],
+          func: () => {},
+        },
+        {
+          exceptionMetatypes: [FirstError, FourthError],
+          func: () => {},
+        },
+      ];
+
+      expect(
+        selectExceptionFilterMetadata(metadataList, new FirstError()),
+      ).to.be.equal(metadataList[0]);
+    });
+  });
+
+  describe('when no exception handler is accepting error handling', () => {
+    it('should return undefined', () => {
+      const metadataList = [
+        {
+          exceptionMetatypes: [FirstError, SecondError],
+          func: () => {},
+        },
+        {
+          exceptionMetatypes: [FirstError, FourthError],
+          func: () => {},
+        },
+      ];
+
+      expect(selectExceptionFilterMetadata(metadataList, new ThirdError())).to
+        .be.undefined;
+    });
+  });
+
+  describe('when exception handler has empty list of meta types', () => {
+    it('should pass any remaining error handling to it', () => {
+      const metadataList = [
+        {
+          exceptionMetatypes: [FirstError, SecondError],
+          func: () => {},
+        },
+        {
+          exceptionMetatypes: [],
+          func: () => {},
+        },
+      ];
+
+      expect(
+        selectExceptionFilterMetadata(metadataList, new ThirdError()),
+      ).to.be.equal(metadataList[1]);
+    });
+  });
+});
diff --git a/packages/common/test/utils/shared.utils.spec.ts b/packages/common/test/utils/shared.utils.spec.ts
index d37ac4a0f..391838d65 100644
--- a/packages/common/test/utils/shared.utils.spec.ts
+++ b/packages/common/test/utils/shared.utils.spec.ts
@@ -123,7 +123,7 @@ describe('Shared utils', () => {
     });
     it('should return empty path', () => {
       expect(addLeadingSlash('')).to.be.eql('');
-      expect(addLeadingSlash(null)).to.be.eql('');
+      expect(addLeadingSlash(null!)).to.be.eql('');
       expect(addLeadingSlash(undefined)).to.be.eql('');
     });
   });
@@ -140,7 +140,7 @@ describe('Shared utils', () => {
     });
     it('should return / for empty path', () => {
       expect(normalizePath('')).to.be.eql('/');
-      expect(normalizePath(null)).to.be.eql('/');
+      expect(normalizePath(null!)).to.be.eql('/');
       expect(normalizePath(undefined)).to.be.eql('/');
     });
   });
diff --git a/packages/common/tsconfig.build.json b/packages/common/tsconfig.build.json
new file mode 100644
index 000000000..2d16c3a20
--- /dev/null
+++ b/packages/common/tsconfig.build.json
@@ -0,0 +1,10 @@
+{
+  "extends": "../tsconfig.build.json",
+  "compilerOptions": {
+    "outDir": ".",
+    "rootDir": ".",
+    "paths": {}
+  },
+  "exclude": ["node_modules", "dist", "test/**/*", "*.spec.ts"],
+  "references": []
+}
diff --git a/packages/common/tsconfig.json b/packages/common/tsconfig.json
index b238080a4..2ae9e3c90 100644
--- a/packages/common/tsconfig.json
+++ b/packages/common/tsconfig.json
@@ -1,7 +1,13 @@
 {
-  "extends": "./../tsconfig.base.json",
+  "extends": "../tsconfig.build.json",
   "compilerOptions": {
-    "baseUrl": "./"
+    "types": ["node"]
   },
-  "include": ["*.ts", "**/*.ts"]
+  "files": [],
+  "include": [],
+  "references": [
+    {
+      "path": "./tsconfig.build.json"
+    }
+  ]
 }
diff --git a/packages/common/utils/assign-custom-metadata.util.ts b/packages/common/utils/assign-custom-metadata.util.ts
index 3fb311647..38bd926db 100644
--- a/packages/common/utils/assign-custom-metadata.util.ts
+++ b/packages/common/utils/assign-custom-metadata.util.ts
@@ -1,4 +1,4 @@
-import { CUSTOM_ROUTE_AGRS_METADATA } from '../constants';
+import { CUSTOM_ROUTE_ARGS_METADATA } from '../constants';
 import {
   ParamData,
   RouteParamMetadata,
@@ -16,7 +16,7 @@ export function assignCustomParameterMetadata(
 ) {
   return {
     ...args,
-    [`${paramtype}${CUSTOM_ROUTE_AGRS_METADATA}:${index}`]: {
+    [`${paramtype}${CUSTOM_ROUTE_ARGS_METADATA}:${index}`]: {
       index,
       factory,
       data,
diff --git a/packages/common/utils/cli-colors.util.ts b/packages/common/utils/cli-colors.util.ts
index 8efd61670..738fbc6d3 100644
--- a/packages/common/utils/cli-colors.util.ts
+++ b/packages/common/utils/cli-colors.util.ts
@@ -5,6 +5,7 @@ const colorIfAllowed = (colorFn: ColorTextFn) => (text: string) =>
   isColorAllowed() ? colorFn(text) : text;
 
 export const clc = {
+  bold: colorIfAllowed((text: string) => `\x1B[1m${text}\x1B[0m`),
   green: colorIfAllowed((text: string) => `\x1B[32m${text}\x1B[39m`),
   yellow: colorIfAllowed((text: string) => `\x1B[33m${text}\x1B[39m`),
   red: colorIfAllowed((text: string) => `\x1B[31m${text}\x1B[39m`),
diff --git a/packages/common/utils/forward-ref.util.ts b/packages/common/utils/forward-ref.util.ts
index a43ac6df2..1b380c022 100644
--- a/packages/common/utils/forward-ref.util.ts
+++ b/packages/common/utils/forward-ref.util.ts
@@ -1,5 +1,8 @@
 import { ForwardReference } from '../interfaces/modules/forward-reference.interface';
 
+/**
+ * @publicApi
+ */
 export const forwardRef = (fn: () => any): ForwardReference => ({
   forwardRef: fn,
 });
diff --git a/packages/common/utils/is-uuid.ts b/packages/common/utils/is-uuid.ts
deleted file mode 100644
index 0e9572f4d..000000000
--- a/packages/common/utils/is-uuid.ts
+++ /dev/null
@@ -1,17 +0,0 @@
-import { BadRequestException } from '../exceptions';
-import { isString } from './shared.utils';
-
-const uuid = {
-  3: /^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,
-  4: /^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,
-  5: /^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,
-  all: /^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i,
-};
-
-export function isUUID(str: any, version = 'all') {
-  if (!isString(str)) {
-    throw new BadRequestException('The value passed as UUID is not a string');
-  }
-  const pattern = uuid[version];
-  return pattern && pattern.test(str);
-}
diff --git a/packages/common/utils/load-package.util.ts b/packages/common/utils/load-package.util.ts
index 9cf6b23e9..1e0bafbdb 100644
--- a/packages/common/utils/load-package.util.ts
+++ b/packages/common/utils/load-package.util.ts
@@ -1,7 +1,7 @@
 import { Logger } from '../services/logger.service';
 
 const MISSING_REQUIRED_DEPENDENCY = (name: string, reason: string) =>
-  `The "${name}" package is missing. Please, make sure to install this library ($ npm install ${name}) to take advantage of ${reason}.`;
+  `The "${name}" package is missing. Please, make sure to install it to take advantage of ${reason}.`;
 
 const logger = new Logger('PackageLoader');
 
diff --git a/packages/common/utils/merge-with-values.util.ts b/packages/common/utils/merge-with-values.util.ts
index c9c59e27f..7b0d0aab1 100644
--- a/packages/common/utils/merge-with-values.util.ts
+++ b/packages/common/utils/merge-with-values.util.ts
@@ -1,5 +1,6 @@
 export type Constructor<T> = new (...args: any[]) => T;
 
+/* eslint-disable @typescript-eslint/no-empty-object-type */
 export const MergeWithValues = <T extends Constructor<{}>>(data: {
   [param: string]: any;
 }) => {
diff --git a/packages/common/utils/random-string-generator.util.ts b/packages/common/utils/random-string-generator.util.ts
index 6897e6e7d..7e39be7b5 100644
--- a/packages/common/utils/random-string-generator.util.ts
+++ b/packages/common/utils/random-string-generator.util.ts
@@ -1,3 +1,3 @@
-import { v4 as uuid } from 'uuid';
+import { uid } from 'uid';
 
-export const randomStringGenerator = () => uuid();
+export const randomStringGenerator = () => uid(21);
diff --git a/packages/common/utils/select-exception-filter-metadata.util.ts b/packages/common/utils/select-exception-filter-metadata.util.ts
new file mode 100644
index 000000000..e1e1661f5
--- /dev/null
+++ b/packages/common/utils/select-exception-filter-metadata.util.ts
@@ -0,0 +1,13 @@
+import { ExceptionFilterMetadata } from '../interfaces/exceptions';
+
+export const selectExceptionFilterMetadata = <T = any>(
+  filters: ExceptionFilterMetadata[],
+  exception: T,
+): ExceptionFilterMetadata | undefined =>
+  filters.find(
+    ({ exceptionMetatypes }) =>
+      !exceptionMetatypes.length ||
+      exceptionMetatypes.some(
+        ExceptionMetaType => exception instanceof ExceptionMetaType,
+      ),
+  );
diff --git a/packages/common/utils/shared.utils.ts b/packages/common/utils/shared.utils.ts
index cee2e0973..c2582dc0f 100644
--- a/packages/common/utils/shared.utils.ts
+++ b/packages/common/utils/shared.utils.ts
@@ -1,4 +1,3 @@
-/* eslint-disable @typescript-eslint/no-use-before-define */
 export const isUndefined = (obj: any): obj is undefined =>
   typeof obj === 'undefined';
 
@@ -31,12 +30,6 @@ export const addLeadingSlash = (path?: string): string =>
       : path
     : '';
 
-/**
- * Deprecated. Use the "addLeadingSlash" function instead.
- * @deprecated
- */
-export const validatePath = addLeadingSlash;
-
 export const normalizePath = (path?: string): string =>
   path
     ? path.startsWith('/')
@@ -47,7 +40,8 @@ export const normalizePath = (path?: string): string =>
 export const stripEndSlash = (path: string) =>
   path[path.length - 1] === '/' ? path.slice(0, path.length - 1) : path;
 
-export const isFunction = (val: any): boolean => typeof val === 'function';
+export const isFunction = (val: any): val is Function =>
+  typeof val === 'function';
 export const isString = (val: any): val is string => typeof val === 'string';
 export const isNumber = (val: any): val is number => typeof val === 'number';
 export const isConstructor = (val: any): boolean => val === 'constructor';
diff --git a/packages/core/CHANGELOG.md b/packages/core/CHANGELOG.md
deleted file mode 100644
index f16fa8cd1..000000000
--- a/packages/core/CHANGELOG.md
+++ /dev/null
@@ -1,12 +0,0 @@
-# Change Log
-
-All notable changes to this project will be documented in this file.
-See [Conventional Commits](https://conventionalcommits.org) for commit guidelines.
-
-<a name="8.2.0"></a>
-# [8.2.0](https://github.com/nestjs/nest/compare/v8.1.2...v8.2.0) (2021-11-08)
-
-
-
-
-**Note:** Version bump only for package @nestjs/core
diff --git a/packages/core/Readme.md b/packages/core/Readme.md
index 85a8c2535..4cac0d5ea 100644
--- a/packages/core/Readme.md
+++ b/packages/core/Readme.md
@@ -1,17 +1,16 @@
 <p align="center">
-  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
+  <a href="https://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
 </p>
 
 [circleci-image]: https://img.shields.io/circleci/build/github/nestjs/nest/master?token=abc123def456
 [circleci-url]: https://circleci.com/gh/nestjs/nest
 
-  <p align="center">A progressive <a href="http://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>
+  <p align="center">A progressive <a href="https://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>
     <p align="center">
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/v/@nestjs/core.svg" alt="NPM Version" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
 <a href="https://circleci.com/gh/nestjs/nest" target="_blank"><img src="https://img.shields.io/circleci/build/github/nestjs/nest/master" alt="CircleCI" /></a>
-<a href="https://coveralls.io/github/nestjs/nest?branch=master" target="_blank"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#9" alt="Coverage" /></a>
 <a href="https://discord.gg/G7Qnnhy" target="_blank"><img src="https://img.shields.io/badge/discord-online-brightgreen.svg" alt="Discord"/></a>
 <a href="https://opencollective.com/nest#backer" target="_blank"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
 <a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
@@ -24,21 +23,21 @@
 
 ## Description
 
-Nest is a framework for building efficient, scalable <a href="http://nodejs.org" target="_blank">Node.js</a> server-side applications. It uses modern JavaScript, is built with  <a href="http://www.typescriptlang.org" target="_blank">TypeScript</a> (preserves compatibility with pure JavaScript) and combines elements of OOP (Object Oriented Programming), FP (Functional Programming), and FRP (Functional Reactive Programming).
+Nest is a framework for building efficient, scalable <a href="https://nodejs.org" target="_blank">Node.js</a> server-side applications. It uses modern JavaScript, is built with <a href="https://www.typescriptlang.org" target="_blank">TypeScript</a> (preserves compatibility with pure JavaScript) and combines elements of OOP (Object Oriented Programming), FP (Functional Programming), and FRP (Functional Reactive Programming).
 
-<p>Under the hood, Nest makes use of <a href="https://expressjs.com/" target="_blank">Express</a>, but also, provides compatibility with a wide range of other libraries, like e.g. <a href="https://github.com/fastify/fastify" target="_blank">Fastify</a>, allowing for easy use of the myriad third-party plugins which are available.</p>
+<p>Under the hood, Nest makes use of <a href="https://expressjs.com/" target="_blank">Express</a>, but also provides compatibility with a wide range of other libraries, like <a href="https://github.com/fastify/fastify" target="_blank">Fastify</a>, allowing for easy use of the myriad of third-party plugins which are available.</p>
 
 ## Philosophy
 
-<p>In recent years, thanks to Node.js, JavaScript has become the ‚Äúlingua franca‚Äù of the web for both front and backend applications, giving rise to awesome projects like <a href="https://angular.io/" target="_blank">Angular</a>, <a href="https://github.com/facebook/react" target="_blank">React</a> and <a href="https://github.com/vuejs/vue" target="_blank">Vue</a> which improve developer productivity and enable the construction of fast, testable, extensible frontend applications. However, on the server-side, while there are a lot of superb libraries, helpers and tools for Node, none of them effectively solve the main problem - the architecture.</p>
-<p>Nest aims to provide an application architecture out of the box which allows for effortless creation of highly testable, scalable, loosely coupled and easily maintainable applications. The architecture is heavily inspired by Angular.</p>
+<p>In recent years, thanks to Node.js, JavaScript has become the ‚Äúlingua franca‚Äù of the web for both front and backend applications, giving rise to awesome projects like <a href="https://angular.io/" target="_blank">Angular</a>, <a href="https://github.com/facebook/react" target="_blank">React</a>, and <a href="https://github.com/vuejs/vue" target="_blank">Vue</a>, which improve developer productivity and enable the construction of fast, testable, and extensible frontend applications. However, on the server-side, while there are a lot of superb libraries, helpers, and tools for Node, none of them effectively solve the main problem - the architecture.</p>
+<p>Nest aims to provide an application architecture out of the box which allows for effortless creation of highly testable, scalable, and loosely coupled and easily maintainable applications. The architecture is heavily inspired by Angular.</p>
 
 ## Getting started
 
-* To check out the [guide](https://docs.nestjs.com), visit [docs.nestjs.com](https://docs.nestjs.com). :books:
-* Ë¶ÅÊü•Áúã‰∏≠Êñá [ÊåáÂçó](readme_zh.md), ËØ∑ËÆøÈóÆ [docs.nestjs.cn](https://docs.nestjs.cn). :books:
-* [Í∞ÄÏù¥Îìú](readme_kr.md)Î•º ÌôïÏù∏ÌïòÎ†§Î©¥, [docs.nestjs.com](https://docs.nestjs.com)Î•º Î∞©Î¨∏ÌïòÏÑ∏Ïöî.:books: 
-* „ÉÅ„Çß„ÉÉ„ÇØ„Åô„Çã„Å´„ÅØ [„Ç¨„Ç§„Éâ](readme_jp.md), Ë©≥„Åó„Åè„ÅØ [docs.nestjs.com](https://docs.nestjs.com). :books: 
+- To check out the [guide](https://docs.nestjs.com), visit [docs.nestjs.com](https://docs.nestjs.com). :books:
+- Ë¶ÅÊü•Áúã‰∏≠Êñá [ÊåáÂçó](readme_zh.md), ËØ∑ËÆøÈóÆ [docs.nestjs.cn](https://docs.nestjs.cn). :books:
+- [Í∞ÄÏù¥Îìú](readme_kr.md) Î¨∏ÏÑúÎäî [docs.nestjs.com](https://docs.nestjs.com)ÏóêÏÑú ÌôïÏù∏ÌïòÏã§ Ïàò ÏûàÏäµÎãàÎã§. :books:
+- [„Ç¨„Ç§„Éâ](readme_jp.md)„ÅØ [docs.nestjs.com](https://docs.nestjs.com)„Åß„ÅîÁ¢∫Ë™ç„Åè„Å†„Åï„ÅÑ„ÄÇ :books:
 
 ## Questions
 
@@ -54,71 +53,88 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
-<table style="text-align:center;"><tr>
-  <td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
-  <td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/red-hat-logo.svg" width="200" valign="middle" /></a></td>
-<td>
-<a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
-<td>
-<a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
-</tr></table>
+
+<table style="text-align:center;">
+<tr>
+<td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
+<td><a href="https://microsoft.com/" target="_blank"><img src="https://nestjs.com/img/logos/microsoft-logo.png" width="180" valign="middle" /></a></td>
+<td><a href="https://mojam.co" target="_blank"><img src="https://nestjs.com/img/logos/mojam-logo.png" width="80" valign="middle" /></a></td>
+<td><a href="https://marblism.com?utm_source=nest" target="_blank"><img src="https://nestjs.com/img/logos/marblism-logo.png" width="180" valign="middle" /></a></td>
+<td><a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
+<td><a href="https://amplication.com/" target="_blank"><img src="https://nestjs.com/img/logos/amplication-logo.svg" width="190" valign="middle" /></a></td>
+</tr>
+</table>
 
 #### Gold Sponsors
 
-<table style="text-align:center;"><tr><td>
-  <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
-  <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
-<td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
+<table style="text-align:center;">
+<tr>
+<td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/logos/red-hat-logo.svg" width="200" valign="middle" /></a></td>
+<td><a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
+<td><a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/logos/nx-logo.png" height="45" valign="middle" /></a></td>
+<td><a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/logos/intrinisic-logo.png" width="210" valign="middle" /></a></td>
+<td><a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/logos/jetbrains-logo.svg" width="90" valign="middle" /></a></td>
+</tr>
+<tr>
+<td><a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/logos/snyk-logo-black.png" width="185" valign="middle" /></a></td>
+<td><a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/logos/fuse-logo.svg" width="105" valign="middle" /></a></td>
+<td><a href="https://ridicorp.com/career/" target="_blank"><img src="https://nestjs.com/img/logos/ridi-logo.svg" width="105" valign="middle" /></a></td>
+<td><a href="https://www.movavi.com/imovie-for-windows.html" target="_blank"><img src="https://nestjs.com/img/logos/movavi-logo.svg" width="105" valign="middle" /></a></td>
+<td><a href="https://skunk.team" target="_blank"><img src="https://nestjs.com/img/logos/skunk-logo.png" height="60" valign="middle" /></a></td>
+</tr>
+</table>
 
 #### Silver Sponsors
 
-<table style="text-align:center;"><tr><td>
-<a href="https://neoteric.eu/" target="_blank"><img src="https://nestjs.com/img/neoteric-cut.png" width="120" valign="middle" /></a> </td><td>
-  <a href="http://gojob.com" target="_blank"><img src="http://nestjs.com/img/gojob-logo.png" valign="middle" width="100" /></a> </td><td>
-<a href="https://www.myleodsc.com/" target="_blank"><img src="https://nestjs.com/img/myleo-logo.png" width="180" valign="middle" /></td><td>
-<a href="https://careers.meetdandy.com/?gh_src=063ba61e3us" target="_blank"><img src="https://nestjs.com/img/dandy-roles-logo.svg" width="150" valign="middle" /></td><td>
-<a href="https://www.castlecraft.in" target="_blank"><img src="https://nestjs.com/img/castlecraft-logo.png" width="150" valign="middle" /></td>
-<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td></tr></table>
+<table style="text-align:center;">
+<tr>
+<td><a href="https://www.mercedes-benz.com/" target="_blank"><img src="https://nestjs.com/img/logos/mercedes-logo.png" width="100" valign="middle" /></a></td>
+<td><a href="https://www.dinii.jp/" target="_blank"><img src="https://nestjs.com/img/logos/dinii-logo.png" width="65" valign="middle" /></a></td>
+<td><a href="https://bloodycase.com/?promocode=NEST" target="_blank"><img src="https://nestjs.com/img/logos/bloodycase-logo.png" width="65" valign="middle" /></a></td>
+<td><a href="https://handsontable.com/docs/react-data-grid/?utm_source=NestJS_GH&utm_medium=sponsorship&utm_campaign=library_sponsorship_2024" target="_blank"><img src="https://nestjs.com/img/logos/handsontable-dark-logo.svg#2" width="150" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.itflashcards.com/" target="_blank"><img src="https://nestjs.com/img/logos/it_flashcards-logo.png" width="170" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://arcjet.com/?ref=nestjs" target="_blank"><img src="https://nestjs.com/img/logos/arcjet-logo.svg" width="170" valign="middle" /></a></td>
+</tr>
+</table>
 
 #### Sponsors
 
-<table><tr><td align="center" valign="middle">
-<a href="https://www.swingdev.io" target="_blank"><img src="https://nestjs.com/img/swingdev-logo.svg#1" width="110" valign="middle" /> </a></td><td align="center" valign="middle">
-<a href="https://www.novologic.com/" target="_blank"><img src="https://nestjs.com/img/novologic.png" width="110" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://ever.co/" target="_blank"><img src="https://nestjs.com/img/ever-logo.png" width="72" valign="middle" /></a>  </td><td align="center" valign="middle">
-<a href="https://blokt.com" target="_blank"><img src="https://nestjs.com/img/blokt-logo.png" width="120" valign="middle" /></a>  </td><td align="center" valign="middle"> 
-  <a href="http://architectnow.net/" target="_blank"><img src="https://nestjs.com/img/architectnow.png" width="125" valign="middle" /></a> </td><td align="center" valign="middle">
-  <a href="https://quander.io/" target="_blank"><img src="https://nestjs.com/img/quander.png" width="100" valign="middle" /></a> </td></tr><tr><td align="center" valign="middle">
-  <a href="https://mantro.net/" target="_blank"><img src="https://nestjs.com/img/mantro-logo.svg" width="95" valign="middle" /></a> </td><td align="center" valign="middle">
-  <a href="https://triplebyte.com/" target="_blank"><img src="https://nestjs.com/img/triplebyte.png" width="107" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://reposit.co.uk/" target="_blank"><img src="https://nestjs.com/img/reposit-logo.png" width="71" valign="middle" /></a></td><td align="center" valign="middle">
-<a href="https://nearpod.com/" target="_blank"><img src="https://nestjs.com/img/nearpod-logo.svg" width="100" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://clay.global/" target="_blank"><img src="https://nestjs.com/img/clay-logo.svg" width="75" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://firesticktricks.com" target="_blank"><img src="https://nestjs.com/img/firesticktricks-logo.png" width="120" valign="middle" /></a></td></tr><tr><td align="center" valign="middle">
-<a href="https://www.codeguesser.co.uk" target="_blank"><img src="https://nestjs.com/img/codeguesser-logo.svg" width="120" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://f-a.nz/" target="_blank"><img src="https://nestjs.com/img/franz.svg" width="80" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://sparkfabrik.com/" target="_blank"><img src="https://nestjs.com/img/sparkfabrik-logo.png" width="120" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://www.thebigphonestore.co.uk/" target="_blank"><img src="https://nestjs.com/img/the-big-phone-store-logo.png" width="65" valign="middle" /></a></td>
-  <td align="center" valign="middle">
-  <a href="https://genuinebee.com/" target="_blank"><img src="https://nestjs.com/img/genuinebee.svg" width="97" valign="middle" /></a> </td>
-<td align="center" valign="middle"><a href="https://sanyodigital.com/" target="_blank"><img src="https://nestjs.com/img/sanyo-digital.png" width="130" valign="middle" /></a></td></tr><tr><td align="center" valign="middle"><a href="https://vpn-review.com/vpn-for-torrenting" target="_blank"><img src="https://nestjs.com/img/vpn-review-logo.png" width="85" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://lambda-it.ch/" target="_blank"><img src="https://nestjs.com/img/lambda-it-logo.svg" width="115" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://pickwriters.com/top-10-translation-services" target="_blank"><img src="https://nestjs.com/img/pickwriters-logo.png" width="40" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://thewordpoint.com/services/localization" target="_blank"><img src="https://nestjs.com/img/thewordpoint-logo.png" width="40" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://meercode.io/" target="_blank"><img src="https://nestjs.com/img/meercode-logo.png" width="60" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://www.najlepszeplatformyforex.pl/blog/broker-xtb/" target="_blank"><img src="https://nestjs.com/img/npf-logo.jpg" width="200" valign="middle" /></a></td></tr><tr>
-<td align="center" valign="middle"><a href="https://thestandarddaily.com/" target="_blank"><img src="https://nestjs.com/img/the-standard-daily-logo.png" width="180" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://houseofangular.io/" target="_blank"><img src="https://nestjs.com/img/house-of-angular.png" width="100" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://rocketech.it/cases/?utm_source=google&utm_medium=badge&utm_campaign=nestjs" target="_blank"><img src="https://nestjs.com/img/rocketech-logo.svg" width="110" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://www.bystored.com/" target="_blank"><img src="https://nestjs.com/img/stored-logo.svg" width="110" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://studyclerk.com/pay-for-research-paper" target="_blank"><img src="https://nestjs.com/img/studyclerk-logo.png" width="125" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://xyndata.com" target="_blank"><img src="https://nestjs.com/img/xyndata-logo.png" width="125" valign="middle" /></a></td></tr><tr>
-  <td align="center" valign="middle"><a href="https://www.anonymistic.com/" target="_blank"><img src="https://nestjs.com/img/anonymistic-logo.png" width="125" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/naologic-logo.svg" width="125" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://messaged.com/" target="_blank"><img src="https://nestjs.com/img/messaged-logo.png" width="50" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/triplecore-logo.svg" width="50" valign="middle" /></a></td>
-  </tr></table>
+<table>
+<tr>
+<td align="center" valign="middle"><a href="https://www.swingdev.io" target="_blank"><img src="https://nestjs.com/img/logos/swingdev-logo.svg#1" width="110" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.novologic.com/" target="_blank"><img src="https://nestjs.com/img/logos/novologic.png" width="110" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://mantro.net/" target="_blank"><img src="https://nestjs.com/img/logos/mantro-logo.svg" width="95" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://triplebyte.com/" target="_blank"><img src="https://nestjs.com/img/logos/triplebyte.png" width="107" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://nearpod.com/" target="_blank"><img src="https://nestjs.com/img/logos/nearpod-logo.svg" width="100" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://genuinebee.com/" target="_blank"><img src="https://nestjs.com/img/logos/genuinebee.svg" width="97" valign="middle" /></a></td>
+</tr>
+<tr>
+<td align="center" valign="middle"><a href="https://vpn-review.com/vpn-for-torrenting" target="_blank"><img src="https://nestjs.com/img/logos/vpn-review-logo.png" width="85" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://lambda-it.ch/" target="_blank"><img src="https://nestjs.com/img/logos/lambda-it-logo.svg" width="115" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://rocketech.it/cases/?utm_source=google&utm_medium=badge&utm_campaign=nestjs" target="_blank"><img src="https://nestjs.com/img/logos/rocketech-logo.svg" width="110" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.anonymistic.com/" target="_blank"><img src="https://nestjs.com/img/logos/anonymistic-logo.png" width="125" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/logos/naologic-logo.svg" width="125" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/logos/triplecore-logo.svg" width="50" valign="middle" /></a></td>
+</tr>
+<tr>
+<td align="center" valign="middle"><a href="https://thecasinowizard.com/bonuses/no-deposit-bonuses/" target="_blank"><img src="https://nestjs.com/img/logos/casinowizard-logo.png" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://polygon-software.ch/" target="_blank"><img src="https://nestjs.com/img/logos/polygon-logo.svg" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/logos/boringowl-logo.svg" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://nordbot.app/" target="_blank"><img src="https://nestjs.com/img/logos/nordbot-logo.png" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://doppio.sh/" target="_blank"><img src="https://nestjs.com/img/logos/dopiosh-logo.png" width="50" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.hingehealth.com/" target="_blank"><img src="https://nestjs.com/img/logos/hinge-health-logo.svg" width="100" valign="middle" /></a></td>
+</tr>
+<tr>
+<td align="center" valign="middle"><a href="https://julienferand.dev/" target="_blank"><img src="https://nestjs.com/img/logos/julienferand-logo.jpeg" width="55" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.tripoffice.com/" target="_blank"><img src="https://nestjs.com/img/logos/tripoffice-logo.png" width="140" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://solcellsforetag.se/" target="_blank"><img src="https://nestjs.com/img/logos/solcellsforetag-logo.svg" width="140" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.route4me.com/" target="_blank"><img src="https://nestjs.com/img/logos/route4me-logo.svg" width="100" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.slotsup.com/" target="_blank"><img src="https://nestjs.com/img/logos/slotsup-logo.png" width="60" valign="middle" /></a></td>
+</tr>
+</table>
 
 ## Backers
 
@@ -126,9 +142,9 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 
 ## Stay in touch
 
-* Author - [Kamil My≈õliwiec](https://twitter.com/kammysliwiec)
-* Website - [https://nestjs.com](https://nestjs.com/)
-* Twitter - [@nestframework](https://twitter.com/nestframework)
+- Author - [Kamil My≈õliwiec](https://x.com/kammysliwiec)
+- Website - [https://nestjs.com](https://nestjs.com/)
+- X - [@nestframework](https://x.com/nestframework)
 
 ## License
 
diff --git a/packages/core/adapters/http-adapter.ts b/packages/core/adapters/http-adapter.ts
index b5379933a..d36fc2c12 100644
--- a/packages/core/adapters/http-adapter.ts
+++ b/packages/core/adapters/http-adapter.ts
@@ -1,5 +1,5 @@
-import { HttpServer, RequestMethod } from '@nestjs/common';
-import { RequestHandler } from '@nestjs/common/interfaces';
+import { HttpServer, RequestMethod, VersioningOptions } from '@nestjs/common';
+import { RequestHandler, VersionValue } from '@nestjs/common/interfaces';
 import {
   CorsOptions,
   CorsOptionsDelegate,
@@ -19,7 +19,6 @@ export abstract class AbstractHttpAdapter<
 
   constructor(protected instance?: any) {}
 
-  // eslint-disable-next-line @typescript-eslint/no-empty-function
   public async init() {}
 
   public use(...args: any[]) {
@@ -62,12 +61,60 @@ export abstract class AbstractHttpAdapter<
     return this.instance.patch(...args);
   }
 
+  public propfind(handler: RequestHandler);
+  public propfind(path: any, handler: RequestHandler);
+  public propfind(...args: any[]) {
+    return this.instance.propfind(...args);
+  }
+
+  public proppatch(handler: RequestHandler);
+  public proppatch(path: any, handler: RequestHandler);
+  public proppatch(...args: any[]) {
+    return this.instance.proppatch(...args);
+  }
+
+  public mkcol(handler: RequestHandler);
+  public mkcol(path: any, handler: RequestHandler);
+  public mkcol(...args: any[]) {
+    return this.instance.mkcol(...args);
+  }
+
+  public copy(handler: RequestHandler);
+  public copy(path: any, handler: RequestHandler);
+  public copy(...args: any[]) {
+    return this.instance.copy(...args);
+  }
+
+  public move(handler: RequestHandler);
+  public move(path: any, handler: RequestHandler);
+  public move(...args: any[]) {
+    return this.instance.move(...args);
+  }
+
+  public lock(handler: RequestHandler);
+  public lock(path: any, handler: RequestHandler);
+  public lock(...args: any[]) {
+    return this.instance.lock(...args);
+  }
+
+  public unlock(handler: RequestHandler);
+  public unlock(path: any, handler: RequestHandler);
+  public unlock(...args: any[]) {
+    return this.instance.unlock(...args);
+  }
+
   public all(handler: RequestHandler);
   public all(path: any, handler: RequestHandler);
   public all(...args: any[]) {
     return this.instance.all(...args);
   }
 
+  public search(handler: RequestHandler);
+  public search(path: any, handler: RequestHandler);
+  public search(...args: any[]) {
+    return this.instance.search(...args);
+  }
+
   public options(handler: RequestHandler);
   public options(path: any, handler: RequestHandler);
   public options(...args: any[]) {
@@ -81,7 +128,7 @@ export abstract class AbstractHttpAdapter<
   }
 
   public getHttpServer(): TServer {
-    return this.httpServer as TServer;
+    return this.httpServer;
   }
 
   public setHttpServer(httpServer: TServer) {
@@ -100,17 +147,23 @@ export abstract class AbstractHttpAdapter<
   abstract initHttpServer(options: NestApplicationOptions);
   abstract useStaticAssets(...args: any[]);
   abstract setViewEngine(engine: string);
-  abstract getRequestHostname(request);
-  abstract getRequestMethod(request);
-  abstract getRequestUrl(request);
-  abstract status(response, statusCode: number);
-  abstract reply(response, body: any, statusCode?: number);
-  abstract render(response, view: string, options: any);
-  abstract redirect(response, statusCode: number, url: string);
+  abstract getRequestHostname(request: any);
+  abstract getRequestMethod(request: any);
+  abstract getRequestUrl(request: any);
+  abstract status(response: any, statusCode: number);
+  abstract reply(response: any, body: any, statusCode?: number);
+  abstract end(response: any, message?: string);
+  abstract render(response: any, view: string, options: any);
+  abstract redirect(response: any, statusCode: number, url: string);
   abstract setErrorHandler(handler: Function, prefix?: string);
   abstract setNotFoundHandler(handler: Function, prefix?: string);
-  abstract setHeader(response, name: string, value: string);
-  abstract registerParserMiddleware(prefix?: string);
+  abstract isHeadersSent(response: any);
+  // TODO remove optional signature (v11)
+  abstract getHeader?(response: any, name: string);
+  abstract setHeader(response: any, name: string, value: string);
+  // TODO remove optional signature (v11)
+  abstract appendHeader?(response: any, name: string, value: string);
+  abstract registerParserMiddleware(prefix?: string, rawBody?: boolean);
   abstract enableCors(
     options: CorsOptions | CorsOptionsDelegate<TRequest>,
     prefix?: string,
@@ -121,4 +174,9 @@ export abstract class AbstractHttpAdapter<
     | ((path: string, callback: Function) => any)
     | Promise<(path: string, callback: Function) => any>;
   abstract getType(): string;
+  abstract applyVersionFilter(
+    handler: Function,
+    version: VersionValue,
+    versioningOptions: VersioningOptions,
+  ): (req: TRequest, res: TResponse, next: () => void) => Function;
 }
diff --git a/packages/core/application-config.ts b/packages/core/application-config.ts
index 1b6adfa4e..e023e0806 100644
--- a/packages/core/application-config.ts
+++ b/packages/core/application-config.ts
@@ -50,7 +50,7 @@ export class ApplicationConfig {
   }
 
   public getIoAdapter(): WebSocketAdapter {
-    return this.ioAdapter;
+    return this.ioAdapter!;
   }
 
   public addGlobalPipe(pipe: PipeTransform<any>) {
diff --git a/packages/core/constants.ts b/packages/core/constants.ts
index 877226690..6b0f56267 100644
--- a/packages/core/constants.ts
+++ b/packages/core/constants.ts
@@ -1,3 +1,5 @@
+import { EnhancerSubtype } from '@nestjs/common/constants';
+
 export const MESSAGES = {
   APPLICATION_START: `Starting Nest application...`,
   APPLICATION_READY: `Nest application successfully started`,
@@ -12,3 +14,15 @@ export const APP_INTERCEPTOR = 'APP_INTERCEPTOR';
 export const APP_PIPE = 'APP_PIPE';
 export const APP_GUARD = 'APP_GUARD';
 export const APP_FILTER = 'APP_FILTER';
+export const ENHANCER_TOKEN_TO_SUBTYPE_MAP: Record<
+  | typeof APP_GUARD
+  | typeof APP_PIPE
+  | typeof APP_FILTER
+  | typeof APP_INTERCEPTOR,
+  EnhancerSubtype
+> = {
+  [APP_GUARD]: 'guard',
+  [APP_INTERCEPTOR]: 'interceptor',
+  [APP_PIPE]: 'pipe',
+  [APP_FILTER]: 'filter',
+} as const;
diff --git a/packages/core/discovery/discoverable-meta-host-collection.ts b/packages/core/discovery/discoverable-meta-host-collection.ts
new file mode 100644
index 000000000..d59a7ad23
--- /dev/null
+++ b/packages/core/discovery/discoverable-meta-host-collection.ts
@@ -0,0 +1,153 @@
+import { Type } from '@nestjs/common';
+import { InstanceWrapper } from '../injector/instance-wrapper';
+import { ModulesContainer } from '../injector/modules-container';
+
+export class DiscoverableMetaHostCollection {
+  /**
+   * A map of class references to metadata keys.
+   */
+  public static readonly metaHostLinks = new Map<Type | Function, string>();
+
+  /**
+   * A map of metadata keys to instance wrappers (providers) with the corresponding metadata key.
+   * The map is weakly referenced by the modules container (unique per application).
+   */
+  private static readonly providersByMetaKey = new WeakMap<
+    ModulesContainer,
+    Map<string, Set<InstanceWrapper>>
+  >();
+
+  /**
+   * A map of metadata keys to instance wrappers (controllers) with the corresponding metadata key.
+   * The map is weakly referenced by the modules container (unique per application).
+   */
+  private static readonly controllersByMetaKey = new WeakMap<
+    ModulesContainer,
+    Map<string, Set<InstanceWrapper>>
+  >();
+
+  /**
+   * Adds a link between a class reference and a metadata key.
+   * @param target The class reference.
+   * @param metadataKey The metadata key.
+   */
+  public static addClassMetaHostLink(
+    target: Type | Function,
+    metadataKey: string,
+  ) {
+    this.metaHostLinks.set(target, metadataKey);
+  }
+
+  /**
+   * Inspects a provider instance wrapper and adds it to the collection of providers
+   * if it has a metadata key.
+   * @param hostContainerRef A reference to the modules container.
+   * @param instanceWrapper A provider instance wrapper.
+   * @returns void
+   */
+  public static inspectProvider(
+    hostContainerRef: ModulesContainer,
+    instanceWrapper: InstanceWrapper,
+  ) {
+    return this.inspectInstanceWrapper(
+      hostContainerRef,
+      instanceWrapper,
+      this.providersByMetaKey,
+    );
+  }
+
+  /**
+   * Inspects a controller instance wrapper and adds it to the collection of controllers
+   * if it has a metadata key.
+   * @param hostContainerRef A reference to the modules container.
+   * @param instanceWrapper A controller's instance wrapper.
+   * @returns void
+   */
+  public static inspectController(
+    hostContainerRef: ModulesContainer,
+    instanceWrapper: InstanceWrapper,
+  ) {
+    return this.inspectInstanceWrapper(
+      hostContainerRef,
+      instanceWrapper,
+      this.controllersByMetaKey,
+    );
+  }
+
+  public static insertByMetaKey(
+    metaKey: string,
+    instanceWrapper: InstanceWrapper,
+    collection: Map<string, Set<InstanceWrapper>>,
+  ) {
+    if (collection.has(metaKey)) {
+      const wrappers = collection.get(metaKey)!;
+      wrappers.add(instanceWrapper);
+    } else {
+      const wrappers = new Set<InstanceWrapper>();
+      wrappers.add(instanceWrapper);
+      collection.set(metaKey, wrappers);
+    }
+  }
+
+  public static getProvidersByMetaKey(
+    hostContainerRef: ModulesContainer,
+    metaKey: string,
+  ): Set<InstanceWrapper> {
+    const wrappersByMetaKey = this.providersByMetaKey.get(hostContainerRef);
+    return wrappersByMetaKey?.get(metaKey) ?? new Set<InstanceWrapper>();
+  }
+
+  public static getControllersByMetaKey(
+    hostContainerRef: ModulesContainer,
+    metaKey: string,
+  ): Set<InstanceWrapper> {
+    const wrappersByMetaKey = this.controllersByMetaKey.get(hostContainerRef);
+    return wrappersByMetaKey?.get(metaKey) ?? new Set<InstanceWrapper>();
+  }
+
+  private static inspectInstanceWrapper(
+    hostContainerRef: ModulesContainer,
+    instanceWrapper: InstanceWrapper,
+    wrapperByMetaKeyMap: WeakMap<
+      ModulesContainer,
+      Map<string, Set<InstanceWrapper>>
+    >,
+  ) {
+    const metaKey =
+      DiscoverableMetaHostCollection.getMetaKeyByInstanceWrapper(
+        instanceWrapper,
+      );
+    if (!metaKey) {
+      return;
+    }
+
+    let collection: Map<string, Set<InstanceWrapper>>;
+    if (wrapperByMetaKeyMap.has(hostContainerRef)) {
+      collection = wrapperByMetaKeyMap.get(hostContainerRef)!;
+    } else {
+      collection = new Map<string, Set<InstanceWrapper>>();
+      wrapperByMetaKeyMap.set(hostContainerRef, collection);
+    }
+    this.insertByMetaKey(metaKey, instanceWrapper, collection);
+  }
+
+  private static getMetaKeyByInstanceWrapper(
+    instanceWrapper: InstanceWrapper<any>,
+  ) {
+    return this.metaHostLinks.get(
+      // NOTE: Regarding the ternary statement below,
+      // - The condition `!wrapper.metatype` is needed because when we use `useValue`
+      // the value of `wrapper.metatype` will be `null`.
+      // - The condition `wrapper.inject` is needed here because when we use
+      // `useFactory`, the value of `wrapper.metatype` will be the supplied
+      // factory function.
+      // For both cases, we should use `wrapper.instance.constructor` instead
+      // of `wrapper.metatype` to resolve processor's class properly.
+      // But since calling `wrapper.instance` could degrade overall performance
+      // we must defer it as much we can.
+      instanceWrapper.metatype || instanceWrapper.inject
+        ? (instanceWrapper.instance?.constructor ?? instanceWrapper.metatype)
+        : instanceWrapper.metatype,
+    );
+  }
+}
diff --git a/packages/core/discovery/discovery-service.ts b/packages/core/discovery/discovery-service.ts
index dc84033dd..25c6aacb2 100644
--- a/packages/core/discovery/discovery-service.ts
+++ b/packages/core/discovery/discovery-service.ts
@@ -1,15 +1,48 @@
-import { flatten, Injectable } from '@nestjs/common';
+import {
+  CustomDecorator,
+  flatten,
+  Injectable,
+  SetMetadata,
+} from '@nestjs/common';
+import { uid } from 'uid';
 import { InstanceWrapper } from '../injector/instance-wrapper';
 import { Module } from '../injector/module';
 import { ModulesContainer } from '../injector/modules-container';
+import { DiscoverableMetaHostCollection } from './discoverable-meta-host-collection';
 
 /**
  * @publicApi
  */
-export interface DiscoveryOptions {
+export interface FilterByInclude {
+  /**
+   * List of modules to include (whitelist) into the discovery process.
+   */
   include?: Function[];
 }
 
+/**
+ * @publicApi
+ */
+export interface FilterByMetadataKey {
+  /**
+   * A key to filter controllers and providers by.
+   * Only instance wrappers with the specified metadata key will be returned.
+   */
+  metadataKey?: string;
+}
+
+/**
+ * @publicApi
+ */
+export type DiscoveryOptions = FilterByInclude | FilterByMetadataKey;
+
+/**
+ * @publicApi
+ */
+export type DiscoverableDecorator<T> = ((opts?: T) => CustomDecorator) & {
+  KEY: string;
+};
+
 /**
  * @publicApi
  */
@@ -17,28 +50,111 @@ export interface DiscoveryOptions {
 export class DiscoveryService {
   constructor(private readonly modulesContainer: ModulesContainer) {}
 
-  getProviders(
+  /**
+   * Creates a decorator that can be used to decorate classes and methods with metadata.
+   * The decorator will also add the class to the collection of discoverable classes (by metadata key).
+   * Decorated classes can be discovered using the `getProviders` and `getControllers` methods.
+   * @returns A decorator function.
+   */
+  static createDecorator<T>(): DiscoverableDecorator<T> {
+    const metadataKey = uid(21);
+    const decoratorFn =
+      (opts: T) =>
+      (target: object | Function, key?: string | symbol, descriptor?: any) => {
+        if (!descriptor) {
+          DiscoverableMetaHostCollection.addClassMetaHostLink(
+            target as Function,
+            metadataKey,
+          );
+        }
+        SetMetadata(metadataKey, opts ?? {})(target, key!, descriptor);
+      };
+
+    decoratorFn.KEY = metadataKey;
+    return decoratorFn as DiscoverableDecorator<T>;
+  }
+
+  /**
+   * Returns an array of instance wrappers (providers).
+   * Depending on the options, the array will contain either all providers or only providers with the specified metadata key.
+   * @param options Discovery options.
+   * @param modules A list of modules to filter by.
+   * @returns An array of instance wrappers (providers).
+   */
+  public getProviders(
     options: DiscoveryOptions = {},
     modules: Module[] = this.getModules(options),
   ): InstanceWrapper[] {
+    if ('metadataKey' in options) {
+      const providers = DiscoverableMetaHostCollection.getProvidersByMetaKey(
+        this.modulesContainer,
+        options.metadataKey!,
+      );
+      return Array.from(providers);
+    }
+
     const providers = modules.map(item => [...item.providers.values()]);
     return flatten(providers);
   }
 
-  getControllers(
+  /**
+   * Returns an array of instance wrappers (controllers).
+   * Depending on the options, the array will contain either all controllers or only controllers with the specified metadata key.
+   * @param options Discovery options.
+   * @param modules A list of modules to filter by.
+   * @returns An array of instance wrappers (controllers).
+   */
+  public getControllers(
     options: DiscoveryOptions = {},
     modules: Module[] = this.getModules(options),
   ): InstanceWrapper[] {
+    if ('metadataKey' in options) {
+      const controllers =
+        DiscoverableMetaHostCollection.getControllersByMetaKey(
+          this.modulesContainer,
+          options.metadataKey!,
+        );
+      return Array.from(controllers);
+    }
+
     const controllers = modules.map(item => [...item.controllers.values()]);
     return flatten(controllers);
   }
 
+  /**
+   * Retrieves metadata from the specified instance wrapper.
+   * @param decorator The decorator to retrieve metadata of.
+   * @param instanceWrapper Reference to the instance wrapper.
+   * @param methodKey An optional method key to retrieve metadata from.
+   * @returns Discovered metadata.
+   */
+  public getMetadataByDecorator<T extends DiscoverableDecorator<any>>(
+    decorator: T,
+    instanceWrapper: InstanceWrapper,
+    methodKey?: string,
+  ): T extends DiscoverableDecorator<infer R> ? R | undefined : T | undefined {
+    if (methodKey) {
+      return Reflect.getMetadata(
+        decorator.KEY,
+        instanceWrapper.instance[methodKey],
+      );
+    }
+
+    const clsRef =
+      instanceWrapper.instance?.constructor ?? instanceWrapper.metatype;
+    return Reflect.getMetadata(decorator.KEY, clsRef);
+  }
+
+  /**
+   * Returns a list of modules to be used for discovery.
+   */
   protected getModules(options: DiscoveryOptions = {}): Module[] {
-    if (!options.include) {
+    const includeInOpts = 'include' in options;
+    if (!includeInOpts) {
       const moduleRefs = [...this.modulesContainer.values()];
       return moduleRefs;
     }
-    const whitelisted = this.includeWhitelisted(options.include);
+    const whitelisted = this.includeWhitelisted(options.include!);
     return whitelisted;
   }
 
diff --git a/packages/core/errors/exception-handler.ts b/packages/core/errors/exception-handler.ts
index 3b1c47c00..e34358bf2 100644
--- a/packages/core/errors/exception-handler.ts
+++ b/packages/core/errors/exception-handler.ts
@@ -1,14 +1,9 @@
-import { RuntimeException } from './exceptions/runtime.exception';
 import { Logger } from '@nestjs/common/services/logger.service';
 
 export class ExceptionHandler {
   private static readonly logger = new Logger(ExceptionHandler.name);
 
-  public handle(exception: RuntimeException | Error) {
-    if (!(exception instanceof RuntimeException)) {
-      ExceptionHandler.logger.error(exception.message, exception.stack);
-      return;
-    }
-    ExceptionHandler.logger.error(exception.what(), exception.stack);
+  public handle(exception: Error) {
+    ExceptionHandler.logger.error(exception);
   }
 }
diff --git a/packages/core/errors/exceptions-zone.ts b/packages/core/errors/exceptions-zone.ts
index 4e46d4b7f..375e62e36 100644
--- a/packages/core/errors/exceptions-zone.ts
+++ b/packages/core/errors/exceptions-zone.ts
@@ -9,7 +9,7 @@ export class ExceptionsZone {
   public static run(
     callback: () => void,
     teardown: (err: any) => void = DEFAULT_TEARDOWN,
-    autoFlushLogs?: boolean,
+    autoFlushLogs: boolean,
   ) {
     try {
       callback();
@@ -25,7 +25,7 @@ export class ExceptionsZone {
   public static async asyncRun(
     callback: () => Promise<void>,
     teardown: (err: any) => void = DEFAULT_TEARDOWN,
-    autoFlushLogs?: boolean,
+    autoFlushLogs: boolean,
   ) {
     try {
       await callback();
diff --git a/packages/core/errors/exceptions/circular-dependency.exception.ts b/packages/core/errors/exceptions/circular-dependency.exception.ts
index 83f3e68bf..2ca8726ab 100644
--- a/packages/core/errors/exceptions/circular-dependency.exception.ts
+++ b/packages/core/errors/exceptions/circular-dependency.exception.ts
@@ -4,7 +4,7 @@ export class CircularDependencyException extends RuntimeException {
   constructor(context?: string) {
     const ctx = context ? ` inside ${context}` : ``;
     super(
-      `A circular dependency has been detected${ctx}. Please, make sure that each side of a bidirectional relationships are decorated with "forwardRef()".`,
+      `A circular dependency has been detected${ctx}. Please, make sure that each side of a bidirectional relationships are decorated with "forwardRef()". Note that circular relationships between custom providers (e.g., factories) are not supported since functions cannot be called more than once.`,
     );
   }
 }
diff --git a/packages/core/errors/exceptions/index.ts b/packages/core/errors/exceptions/index.ts
new file mode 100644
index 000000000..530968b2f
--- /dev/null
+++ b/packages/core/errors/exceptions/index.ts
@@ -0,0 +1,8 @@
+export * from './circular-dependency.exception';
+export * from './runtime.exception';
+export * from './unknown-element.exception';
+export * from './invalid-class-scope.exception';
+export * from './invalid-class.exception';
+export * from './unknown-export.exception';
+export * from './unknown-module.exception';
+export * from './undefined-forwardref.exception';
diff --git a/packages/core/errors/exceptions/undefined-dependency.exception.ts b/packages/core/errors/exceptions/undefined-dependency.exception.ts
index 0b2e134f2..62d7f61d7 100644
--- a/packages/core/errors/exceptions/undefined-dependency.exception.ts
+++ b/packages/core/errors/exceptions/undefined-dependency.exception.ts
@@ -1,16 +1,16 @@
 import { InjectorDependencyContext } from '../../injector/injector';
+import { Module } from '../../injector/module';
 import { UNKNOWN_DEPENDENCIES_MESSAGE } from '../messages';
 import { RuntimeException } from './runtime.exception';
-import { Module } from '../../injector/module';
 
 export class UndefinedDependencyException extends RuntimeException {
   constructor(
     type: string,
     undefinedDependencyContext: InjectorDependencyContext,
-    module?: Module,
+    moduleRef?: Module,
   ) {
     super(
-      UNKNOWN_DEPENDENCIES_MESSAGE(type, undefinedDependencyContext, module),
+      UNKNOWN_DEPENDENCIES_MESSAGE(type, undefinedDependencyContext, moduleRef),
     );
   }
 }
diff --git a/packages/core/errors/exceptions/unknown-dependencies.exception.ts b/packages/core/errors/exceptions/unknown-dependencies.exception.ts
index d350952cb..57c7207c8 100644
--- a/packages/core/errors/exceptions/unknown-dependencies.exception.ts
+++ b/packages/core/errors/exceptions/unknown-dependencies.exception.ts
@@ -1,14 +1,18 @@
 import { InjectorDependencyContext } from '../../injector/injector';
+import { Module } from '../../injector/module';
 import { UNKNOWN_DEPENDENCIES_MESSAGE } from '../messages';
 import { RuntimeException } from './runtime.exception';
-import { Module } from '../../injector/module';
 
 export class UnknownDependenciesException extends RuntimeException {
+  public readonly moduleRef: { id: string } | undefined;
+
   constructor(
-    type: string | symbol,
-    unknownDependencyContext: InjectorDependencyContext,
-    module?: Module,
+    public readonly type: string | symbol,
+    public readonly context: InjectorDependencyContext,
+    moduleRef?: Module,
+    public readonly metadata?: { id: string },
   ) {
-    super(UNKNOWN_DEPENDENCIES_MESSAGE(type, unknownDependencyContext, module));
+    super(UNKNOWN_DEPENDENCIES_MESSAGE(type, context, moduleRef));
+    this.moduleRef = moduleRef && { id: moduleRef.id };
   }
 }
diff --git a/packages/core/errors/exceptions/unknown-module.exception.ts b/packages/core/errors/exceptions/unknown-module.exception.ts
index ab39aace7..998c484dc 100644
--- a/packages/core/errors/exceptions/unknown-module.exception.ts
+++ b/packages/core/errors/exceptions/unknown-module.exception.ts
@@ -1,9 +1,11 @@
 import { RuntimeException } from './runtime.exception';
 
 export class UnknownModuleException extends RuntimeException {
-  constructor() {
+  constructor(moduleName?: string) {
     super(
-      'Nest could not select the given module (it does not exist in current context)',
+      `Nest could not select the given module (${
+        moduleName ? `"${moduleName}"` : 'it'
+      } does not exist in current context).`,
     );
   }
 }
diff --git a/packages/core/errors/exceptions/unknown-request-mapping.exception.ts b/packages/core/errors/exceptions/unknown-request-mapping.exception.ts
index b0d64b212..561390bd9 100644
--- a/packages/core/errors/exceptions/unknown-request-mapping.exception.ts
+++ b/packages/core/errors/exceptions/unknown-request-mapping.exception.ts
@@ -1,8 +1,9 @@
+import type { Type } from '@nestjs/common';
 import { RuntimeException } from './runtime.exception';
 import { UNKNOWN_REQUEST_MAPPING } from '../messages';
 
 export class UnknownRequestMappingException extends RuntimeException {
-  constructor() {
-    super(UNKNOWN_REQUEST_MAPPING);
+  constructor(metatype: Type) {
+    super(UNKNOWN_REQUEST_MAPPING(metatype));
   }
 }
diff --git a/packages/core/errors/messages.ts b/packages/core/errors/messages.ts
index 209260359..d529b31a5 100644
--- a/packages/core/errors/messages.ts
+++ b/packages/core/errors/messages.ts
@@ -1,4 +1,4 @@
-import type { ForwardReference, Type, DynamicModule } from '@nestjs/common';
+import type { DynamicModule, ForwardReference, Type } from '@nestjs/common';
 import { isNil, isSymbol } from '@nestjs/common/utils/shared.utils';
 import {
   InjectorDependency,
@@ -23,27 +23,38 @@ const getInstanceName = (instance: unknown): string => {
 };
 
 /**
- * Returns the name of the dependency
+ * Returns the name of the dependency.
  * Tries to get the class name, otherwise the string value
- * (= injection token). As fallback it returns '+'
- * @param dependency The dependency whichs name should get displayed
+ * (= injection token). As fallback to any falsy value for `dependency`, it
+ * returns `fallbackValue`
+ * @param dependency The name of the dependency to be displayed
+ * @param fallbackValue The fallback value if the dependency is falsy
+ * @param disambiguated Whether dependency's name is disambiguated with double quotes
  */
-const getDependencyName = (dependency: InjectorDependency): string =>
+const getDependencyName = (
+  dependency: InjectorDependency | undefined,
+  fallbackValue: string,
+  disambiguated = true,
+): string =>
   // use class name
   getInstanceName(dependency) ||
   // use injection token (symbol)
   (isSymbol(dependency) && dependency.toString()) ||
   // use string directly
-  (dependency as string) ||
+  (dependency
+    ? disambiguated
+      ? `"${dependency as string}"`
+      : (dependency as string)
+    : undefined) ||
   // otherwise
-  '+';
+  fallbackValue;
 
 /**
  * Returns the name of the module
  * Tries to get the class name. As fallback it returns 'current'.
  * @param module The module which should get displayed
  */
-const getModuleName = (module: Module) =>
+const getModuleName = (module: Module | undefined) =>
   (module && getInstanceName(module.metatype)) || 'current';
 
 const stringifyScope = (scope: any[]): string =>
@@ -52,40 +63,47 @@ const stringifyScope = (scope: any[]): string =>
 export const UNKNOWN_DEPENDENCIES_MESSAGE = (
   type: string | symbol,
   unknownDependencyContext: InjectorDependencyContext,
-  module: Module,
+  moduleRef: Module | undefined,
 ) => {
-  const {
-    index,
-    name = 'dependency',
-    dependencies,
-    key,
-  } = unknownDependencyContext;
-  const moduleName = getModuleName(module) || 'Module';
-  const dependencyName = getDependencyName(name);
-
-  let message = `Nest can't resolve dependencies of the ${type.toString()}`;
-
-  const potentialSolutions = `\n
+  const { index, name, dependencies, key } = unknownDependencyContext;
+  const moduleName = getModuleName(moduleRef);
+  const dependencyName = getDependencyName(name, 'dependency');
+
+  const potentialSolutions =
+    // If module's name is well defined
+    moduleName !== 'current'
+      ? `\n
 Potential solutions:
+- Is ${moduleName} a valid NestJS module?
 - If ${dependencyName} is a provider, is it part of the current ${moduleName}?
 - If ${dependencyName} is exported from a separate @Module, is that module imported within ${moduleName}?
   @Module({
     imports: [ /* the Module containing ${dependencyName} */ ]
   })
+`
+      : `\n
+Potential solutions:
+- If ${dependencyName} is a provider, is it part of the current Module?
+- If ${dependencyName} is exported from a separate @Module, is that module imported within Module?
+  @Module({
+    imports: [ /* the Module containing ${dependencyName} */ ]
+  })
 `;
 
+  let message = `Nest can't resolve dependencies of the ${type.toString()}`;
+
   if (isNil(index)) {
-    message += `. Please make sure that the "${key.toString()}" property is available in the current context.${potentialSolutions}`;
+    message += `. Please make sure that the "${key!.toString()}" property is available in the current context.${potentialSolutions}`;
     return message;
   }
-  const dependenciesName = (dependencies || []).map(getDependencyName);
+  const dependenciesName = (dependencies || []).map(dependencyName =>
+    getDependencyName(dependencyName, '+', false),
+  );
   dependenciesName[index] = '?';
 
   message += ` (`;
   message += dependenciesName.join(', ');
-  message += `). Please make sure that the argument ${dependencyName} at index [${index}] is available in the ${getModuleName(
-    module,
-  )} context.`;
+  message += `). Please make sure that the argument ${dependencyName} at index [${index}] is available in the ${moduleName} context.`;
   message += potentialSolutions;
 
   return message;
@@ -121,11 +139,10 @@ export const USING_INVALID_CLASS_AS_A_MODULE_MESSAGE = (
   metatypeUsedAsAModule: Type | ForwardReference,
   scope: any[],
 ) => {
-  const metatypeName = getInstanceName(metatypeUsedAsAModule) || 'found';
+  const metatypeNameQuote = `"${getInstanceName(metatypeUsedAsAModule)}"`;
 
-  // TODO(v9): Edit the message below:
-  return `In the next major version, Nest will not allow classes annotated with @Injectable(), @Catch(), and @Controller() decorators to appear in the "imports" array of a module.
-Please remove "${metatypeName}" (including forwarded occurrences, if any) from all of the "imports" arrays.
+  return `Classes annotated with @Injectable(), @Catch(), and @Controller() decorators must not appear in the "imports" array of a module.
+Please remove ${metatypeNameQuote} (including forwarded occurrences, if any) from all of the "imports" arrays.
 
 Scope [${stringifyScope(scope)}]
 `;
@@ -172,8 +189,14 @@ export const INVALID_CLASS_SCOPE_MESSAGE = (
     name || 'This class'
   } is marked as a scoped provider. Request and transient-scoped providers can't be used in combination with "get()" method. Please, use "resolve()" instead.`;
 
+export const UNKNOWN_REQUEST_MAPPING = (metatype: Type) => {
+  const className = metatype.name;
+  return className
+    ? `An invalid controller has been detected. "${className}" does not have the @Controller() decorator but it is being listed in the "controllers" array of some module.`
+    : `An invalid controller has been detected. Perhaps, one of your controllers is missing the @Controller() decorator.`;
+};
+
 export const INVALID_MIDDLEWARE_CONFIGURATION = `An invalid middleware configuration has been passed inside the module 'configure()' method.`;
-export const UNKNOWN_REQUEST_MAPPING = `An invalid controller has been detected. Perhaps, one of your controllers is missing @Controller() decorator.`;
 export const UNHANDLED_RUNTIME_EXCEPTION = `Unhandled Runtime Exception.`;
 export const INVALID_EXCEPTION_FILTER = `Invalid exception filters (@UseFilters()).`;
 export const MICROSERVICES_PACKAGE_NOT_FOUND_EXCEPTION = `Unable to load @nestjs/microservices package. (Please make sure that it's already installed.)`;
diff --git a/packages/core/exceptions/base-exception-filter-context.ts b/packages/core/exceptions/base-exception-filter-context.ts
index aa9971227..332cbb736 100644
--- a/packages/core/exceptions/base-exception-filter-context.ts
+++ b/packages/core/exceptions/base-exception-filter-context.ts
@@ -21,7 +21,7 @@ export class BaseExceptionFilterContext extends ContextCreator {
     inquirerId?: string,
   ): R {
     if (isEmpty(metadata)) {
-      return [] as R;
+      return [] as any[] as R;
     }
     return iterate(metadata)
       .filter(
@@ -30,8 +30,8 @@ export class BaseExceptionFilterContext extends ContextCreator {
       .map(filter => this.getFilterInstance(filter, contextId, inquirerId))
       .filter(item => !!item)
       .map(instance => ({
-        func: instance.catch.bind(instance),
-        exceptionMetatypes: this.reflectCatchExceptions(instance),
+        func: instance!.catch.bind(instance),
+        exceptionMetatypes: this.reflectCatchExceptions(instance!),
       }))
       .toArray() as R;
   }
@@ -41,7 +41,7 @@ export class BaseExceptionFilterContext extends ContextCreator {
     contextId = STATIC_CONTEXT,
     inquirerId?: string,
   ): ExceptionFilter | null {
-    const isObject = (filter as ExceptionFilter).catch;
+    const isObject = !!(filter as ExceptionFilter).catch;
     if (isObject) {
       return filter as ExceptionFilter;
     }
@@ -50,7 +50,7 @@ export class BaseExceptionFilterContext extends ContextCreator {
       return null;
     }
     const instanceHost = instanceWrapper.getInstanceByContextId(
-      contextId,
+      this.getContextId(contextId, instanceWrapper),
       inquirerId,
     );
     return instanceHost && instanceHost.instance;
diff --git a/packages/core/exceptions/base-exception-filter.ts b/packages/core/exceptions/base-exception-filter.ts
index ea360e84a..196661410 100644
--- a/packages/core/exceptions/base-exception-filter.ts
+++ b/packages/core/exceptions/base-exception-filter.ts
@@ -5,6 +5,7 @@ import {
   HttpServer,
   HttpStatus,
   Inject,
+  IntrinsicException,
   Logger,
   Optional,
 } from '@nestjs/common';
@@ -25,7 +26,7 @@ export class BaseExceptionFilter<T = any> implements ExceptionFilter<T> {
   catch(exception: T, host: ArgumentsHost) {
     const applicationRef =
       this.applicationRef ||
-      (this.httpAdapterHost && this.httpAdapterHost.httpAdapter);
+      (this.httpAdapterHost && this.httpAdapterHost.httpAdapter)!;
 
     if (!(exception instanceof HttpException)) {
       return this.handleUnknownError(exception, host, applicationRef);
@@ -38,7 +39,12 @@ export class BaseExceptionFilter<T = any> implements ExceptionFilter<T> {
           message: res,
         };
 
-    applicationRef.reply(host.getArgByIndex(1), message, exception.getStatus());
+    const response = host.getArgByIndex(1);
+    if (!applicationRef.isHeadersSent(response)) {
+      applicationRef.reply(response, message, exception.getStatus());
+    } else {
+      applicationRef.end(response);
+    }
   }
 
   public handleUnknownError(
@@ -55,14 +61,17 @@ export class BaseExceptionFilter<T = any> implements ExceptionFilter<T> {
           statusCode: HttpStatus.INTERNAL_SERVER_ERROR,
           message: MESSAGES.UNKNOWN_EXCEPTION_MESSAGE,
         };
-    applicationRef.reply(host.getArgByIndex(1), body, body.statusCode);
-    if (this.isExceptionObject(exception)) {
-      return BaseExceptionFilter.logger.error(
-        exception.message,
-        exception.stack,
-      );
+
+    const response = host.getArgByIndex(1);
+    if (!applicationRef.isHeadersSent(response)) {
+      applicationRef.reply(response, body, body.statusCode);
+    } else {
+      applicationRef.end(response);
+    }
+
+    if (!(exception instanceof IntrinsicException)) {
+      BaseExceptionFilter.logger.error(exception);
     }
-    return BaseExceptionFilter.logger.error(exception);
   }
 
   public isExceptionObject(err: any): err is Error {
diff --git a/packages/core/exceptions/exceptions-handler.ts b/packages/core/exceptions/exceptions-handler.ts
index af54683ae..36d1b7f22 100644
--- a/packages/core/exceptions/exceptions-handler.ts
+++ b/packages/core/exceptions/exceptions-handler.ts
@@ -1,6 +1,7 @@
-import { HttpException, Type } from '@nestjs/common';
+import { HttpException } from '@nestjs/common';
 import { ExceptionFilterMetadata } from '@nestjs/common/interfaces/exceptions/exception-filter-metadata.interface';
 import { ArgumentsHost } from '@nestjs/common/interfaces/features/arguments-host.interface';
+import { selectExceptionFilterMetadata } from '@nestjs/common/utils/select-exception-filter-metadata.util';
 import { isEmpty } from '@nestjs/common/utils/shared.utils';
 import { InvalidExceptionFilterException } from '../errors/exceptions/invalid-exception-filter.exception';
 import { BaseExceptionFilter } from './base-exception-filter';
@@ -8,7 +9,7 @@ import { BaseExceptionFilter } from './base-exception-filter';
 export class ExceptionsHandler extends BaseExceptionFilter {
   private filters: ExceptionFilterMetadata[] = [];
 
-  public next(exception: Error | HttpException | any, ctx: ArgumentsHost) {
+  public next(exception: Error | HttpException, ctx: ArgumentsHost) {
     if (this.invokeCustomFilters(exception, ctx)) {
       return;
     }
@@ -29,14 +30,8 @@ export class ExceptionsHandler extends BaseExceptionFilter {
     if (isEmpty(this.filters)) {
       return false;
     }
-    const isInstanceOf = (metatype: Type<unknown>) =>
-      exception instanceof metatype;
 
-    const filter = this.filters.find(({ exceptionMetatypes }) => {
-      const typeExists =
-        !exceptionMetatypes.length || exceptionMetatypes.some(isInstanceOf);
-      return typeExists;
-    });
+    const filter = selectExceptionFilterMetadata(this.filters, exception);
     filter && filter.func(exception, ctx);
     return !!filter;
   }
diff --git a/packages/core/exceptions/external-exception-filter-context.ts b/packages/core/exceptions/external-exception-filter-context.ts
index c1aaa2cb9..d763dfe73 100644
--- a/packages/core/exceptions/external-exception-filter-context.ts
+++ b/packages/core/exceptions/external-exception-filter-context.ts
@@ -2,6 +2,7 @@ import { EXCEPTION_FILTERS_METADATA } from '@nestjs/common/constants';
 import { Controller } from '@nestjs/common/interfaces';
 import { ExceptionFilterMetadata } from '@nestjs/common/interfaces/exceptions';
 import { isEmpty } from '@nestjs/common/utils/shared.utils';
+import { iterate } from 'iterare';
 import { ApplicationConfig } from '../application-config';
 import { STATIC_CONTEXT } from '../injector/constants';
 import { NestContainer } from '../injector/container';
@@ -9,7 +10,6 @@ import { InstanceWrapper } from '../injector/instance-wrapper';
 import { RouterProxyCallback } from '../router/router-proxy';
 import { BaseExceptionFilterContext } from './base-exception-filter-context';
 import { ExternalExceptionsHandler } from './external-exceptions-handler';
-import { iterate } from 'iterare';
 
 export class ExternalExceptionFilterContext extends BaseExceptionFilterContext {
   constructor(
@@ -48,7 +48,7 @@ export class ExternalExceptionFilterContext extends BaseExceptionFilterContext {
     inquirerId?: string,
   ): T {
     if (!this.config) {
-      return [] as T;
+      return [] as any[] as T;
     }
     const globalFilters = this.config.getGlobalFilters() as T;
     if (contextId === STATIC_CONTEXT && !inquirerId) {
diff --git a/packages/core/exceptions/external-exception-filter.ts b/packages/core/exceptions/external-exception-filter.ts
index 9c6b2563b..7ee10c669 100644
--- a/packages/core/exceptions/external-exception-filter.ts
+++ b/packages/core/exceptions/external-exception-filter.ts
@@ -1,12 +1,16 @@
-import { ArgumentsHost, HttpException, Logger } from '@nestjs/common';
+import { ArgumentsHost, IntrinsicException, Logger } from '@nestjs/common';
 
 export class ExternalExceptionFilter<T = any, R = any> {
   private static readonly logger = new Logger('ExceptionsHandler');
 
   catch(exception: T, host: ArgumentsHost): R | Promise<R> {
-    if (exception instanceof Error && !(exception instanceof HttpException)) {
-      ExternalExceptionFilter.logger.error(exception.message, exception.stack);
+    if (
+      exception instanceof Error &&
+      !(exception instanceof IntrinsicException)
+    ) {
+      ExternalExceptionFilter.logger.error(exception);
     }
+
     throw exception;
   }
 }
diff --git a/packages/core/exceptions/external-exceptions-handler.ts b/packages/core/exceptions/external-exceptions-handler.ts
index 15a6e6b3c..80cb9dd48 100644
--- a/packages/core/exceptions/external-exceptions-handler.ts
+++ b/packages/core/exceptions/external-exceptions-handler.ts
@@ -1,6 +1,6 @@
-import { Type } from '@nestjs/common';
 import { ExceptionFilterMetadata } from '@nestjs/common/interfaces/exceptions';
 import { ArgumentsHost } from '@nestjs/common/interfaces/features/arguments-host.interface';
+import { selectExceptionFilterMetadata } from '@nestjs/common/utils/select-exception-filter-metadata.util';
 import { isEmpty } from '@nestjs/common/utils/shared.utils';
 import { InvalidExceptionFilterException } from '../errors/exceptions/invalid-exception-filter.exception';
 import { ExternalExceptionFilter } from './external-exception-filter';
@@ -8,7 +8,7 @@ import { ExternalExceptionFilter } from './external-exception-filter';
 export class ExternalExceptionsHandler extends ExternalExceptionFilter {
   private filters: ExceptionFilterMetadata[] = [];
 
-  public next(exception: Error | any, host: ArgumentsHost): Promise<any> {
+  public next(exception: Error, host: ArgumentsHost): Promise<any> {
     const result = this.invokeCustomFilters(exception, host);
     if (result) {
       return result;
@@ -30,14 +30,8 @@ export class ExternalExceptionsHandler extends ExternalExceptionFilter {
     if (isEmpty(this.filters)) {
       return null;
     }
-    const isInstanceOf = (metatype: Type<unknown>) =>
-      exception instanceof metatype;
 
-    const filter = this.filters.find(({ exceptionMetatypes }) => {
-      const typeExists =
-        !exceptionMetatypes.length || exceptionMetatypes.some(isInstanceOf);
-      return typeExists;
-    });
+    const filter = selectExceptionFilterMetadata(this.filters, exception);
     return filter ? filter.func(exception, host) : null;
   }
 }
diff --git a/packages/core/guards/guards-consumer.ts b/packages/core/guards/guards-consumer.ts
index 8cc1b6405..7f3c717e2 100644
--- a/packages/core/guards/guards-consumer.ts
+++ b/packages/core/guards/guards-consumer.ts
@@ -16,7 +16,7 @@ export class GuardsConsumer {
       return true;
     }
     const context = this.createContext(args, instance, callback);
-    context.setType<TContext>(type);
+    context.setType<TContext>(type!);
 
     for (const guard of guards) {
       const result = guard.canActivate(context);
diff --git a/packages/core/guards/guards-context-creator.ts b/packages/core/guards/guards-context-creator.ts
index e82a8fb04..536a4cc0e 100644
--- a/packages/core/guards/guards-context-creator.ts
+++ b/packages/core/guards/guards-context-creator.ts
@@ -42,14 +42,16 @@ export class GuardsContextCreator extends ContextCreator {
     inquirerId?: string,
   ): R {
     if (isEmpty(metadata)) {
-      return [] as R;
+      return [] as unknown[] as R;
     }
     return iterate(metadata)
       .filter((guard: any) => guard && (guard.name || guard.canActivate))
       .map(guard =>
         this.getGuardInstance(guard as Function, contextId, inquirerId),
       )
-      .filter((guard: CanActivate) => guard && isFunction(guard.canActivate))
+      .filter(
+        (guard: CanActivate | null) => !!guard && isFunction(guard.canActivate),
+      )
       .toArray() as R;
   }
 
@@ -58,7 +60,7 @@ export class GuardsContextCreator extends ContextCreator {
     contextId = STATIC_CONTEXT,
     inquirerId?: string,
   ): CanActivate | null {
-    const isObject = (metatype as CanActivate).canActivate;
+    const isObject = !!(metatype as CanActivate).canActivate;
     if (isObject) {
       return metatype as CanActivate;
     }
@@ -69,7 +71,7 @@ export class GuardsContextCreator extends ContextCreator {
       return null;
     }
     const instanceHost = instanceWrapper.getInstanceByContextId(
-      contextId,
+      this.getContextId(contextId, instanceWrapper),
       inquirerId,
     );
     return instanceHost && instanceHost.instance;
@@ -95,7 +97,7 @@ export class GuardsContextCreator extends ContextCreator {
     inquirerId?: string,
   ): T {
     if (!this.config) {
-      return [] as T;
+      return [] as unknown[] as T;
     }
     const globalGuards = this.config.getGlobalGuards() as T;
     if (contextId === STATIC_CONTEXT && !inquirerId) {
@@ -104,7 +106,12 @@ export class GuardsContextCreator extends ContextCreator {
     const scopedGuardWrappers =
       this.config.getGlobalRequestGuards() as InstanceWrapper[];
     const scopedGuards = iterate(scopedGuardWrappers)
-      .map(wrapper => wrapper.getInstanceByContextId(contextId, inquirerId))
+      .map(wrapper =>
+        wrapper.getInstanceByContextId(
+          this.getContextId(contextId, wrapper),
+          inquirerId,
+        ),
+      )
       .filter(host => !!host)
       .map(host => host.instance)
       .toArray();
diff --git a/packages/core/guards/index.ts b/packages/core/guards/index.ts
new file mode 100644
index 000000000..61a8b775a
--- /dev/null
+++ b/packages/core/guards/index.ts
@@ -0,0 +1,3 @@
+export * from './constants';
+export * from './guards-consumer';
+export * from './guards-context-creator';
diff --git a/packages/core/helpers/context-creator.ts b/packages/core/helpers/context-creator.ts
index 5028cc973..17f455c2b 100644
--- a/packages/core/helpers/context-creator.ts
+++ b/packages/core/helpers/context-creator.ts
@@ -1,6 +1,6 @@
 import { Controller } from '@nestjs/common/interfaces';
 import { STATIC_CONTEXT } from '../injector/constants';
-import { ContextId } from '../injector/instance-wrapper';
+import { ContextId, InstanceWrapper } from '../injector/instance-wrapper';
 
 export abstract class ContextCreator {
   public abstract createConcreteContext<T extends any[], R extends any[]>(
@@ -27,7 +27,7 @@ export abstract class ContextCreator {
     const methodMetadata = this.reflectMethodMetadata<T>(callback, metadataKey);
     return [
       ...this.createConcreteContext<T, R>(
-        globalMetadata || ([] as T),
+        globalMetadata || ([] as unknown[] as T),
         contextId,
         inquirerId,
       ),
@@ -51,4 +51,16 @@ export abstract class ContextCreator {
   ): T {
     return Reflect.getMetadata(metadataKey, callback);
   }
+
+  protected getContextId(
+    contextId: ContextId,
+    instanceWrapper: InstanceWrapper,
+  ): ContextId {
+    return contextId.getParent
+      ? contextId.getParent({
+          token: instanceWrapper.token,
+          isTreeDurable: instanceWrapper.isDependencyTreeDurable(),
+        })
+      : contextId;
+  }
 }
diff --git a/packages/core/helpers/context-id-factory.ts b/packages/core/helpers/context-id-factory.ts
index 0cb80d311..fde7f2410 100644
--- a/packages/core/helpers/context-id-factory.ts
+++ b/packages/core/helpers/context-id-factory.ts
@@ -1,4 +1,5 @@
-import { ContextId } from '../injector/instance-wrapper';
+import { isObject } from '@nestjs/common/utils/shared.utils';
+import { ContextId, HostComponentInfo } from '../injector/instance-wrapper';
 import { REQUEST_CONTEXT_ID } from '../router/request/request-constants';
 
 export function createContextId(): ContextId {
@@ -13,7 +14,35 @@ export function createContextId(): ContextId {
   return { id: Math.random() };
 }
 
+export type ContextIdResolverFn = (info: HostComponentInfo) => ContextId;
+
+export interface ContextIdResolver {
+  /**
+   * Payload associated with the custom context id
+   */
+  payload: unknown;
+  /**
+   * A context id resolver function
+   */
+  resolve: ContextIdResolverFn;
+}
+
+export interface ContextIdStrategy<T = any> {
+  /**
+   * Allows to attach a parent context id to the existing child context id.
+   * This lets you construct durable DI sub-trees that can be shared between contexts.
+   * @param contextId auto-generated child context id
+   * @param request request object
+   */
+  attach(
+    contextId: ContextId,
+    request: T,
+  ): ContextIdResolverFn | ContextIdResolver | undefined;
+}
+
 export class ContextIdFactory {
+  private static strategy?: ContextIdStrategy;
+
   /**
    * Generates a context identifier based on the request object.
    */
@@ -27,16 +56,45 @@ export class ContextIdFactory {
    */
   public static getByRequest<T extends Record<any, any> = any>(
     request: T,
+    propsToInspect: string[] = ['raw'],
   ): ContextId {
     if (!request) {
-      return createContextId();
+      return ContextIdFactory.create();
     }
     if (request[REQUEST_CONTEXT_ID as any]) {
       return request[REQUEST_CONTEXT_ID as any];
     }
-    if (request.raw && request.raw[REQUEST_CONTEXT_ID]) {
-      return request.raw[REQUEST_CONTEXT_ID];
+    for (const key of propsToInspect) {
+      if (request[key]?.[REQUEST_CONTEXT_ID]) {
+        return request[key][REQUEST_CONTEXT_ID];
+      }
     }
-    return createContextId();
+    if (!this.strategy) {
+      return ContextIdFactory.create();
+    }
+    const contextId = createContextId();
+    const resolverObjectOrFunction = this.strategy.attach(contextId, request);
+    if (this.isContextIdResolverWithPayload(resolverObjectOrFunction!)) {
+      contextId.getParent = resolverObjectOrFunction.resolve;
+      contextId.payload = resolverObjectOrFunction.payload;
+    } else {
+      contextId.getParent = resolverObjectOrFunction;
+    }
+    return contextId;
+  }
+
+  /**
+   * Registers a custom context id strategy that lets you attach
+   * a parent context id to the existing context id object.
+   * @param strategy strategy instance
+   */
+  public static apply(strategy: ContextIdStrategy) {
+    this.strategy = strategy;
+  }
+
+  private static isContextIdResolverWithPayload(
+    resolverOrResolverFn: ContextIdResolver | ContextIdResolverFn,
+  ): resolverOrResolverFn is ContextIdResolver {
+    return isObject(resolverOrResolverFn);
   }
 }
diff --git a/packages/core/helpers/context-utils.ts b/packages/core/helpers/context-utils.ts
index dc64660f1..7ff661a56 100644
--- a/packages/core/helpers/context-utils.ts
+++ b/packages/core/helpers/context-utils.ts
@@ -50,12 +50,15 @@ export class ContextUtils {
   }
 
   public getArgumentsLength<T>(keys: string[], metadata: T): number {
-    return Math.max(...keys.map(key => metadata[key].index)) + 1;
+    return keys.length
+      ? Math.max(...keys.map(key => metadata[key].index)) + 1
+      : 0;
   }
 
   public createNullArray(length: number): any[] {
-    // eslint-disable-next-line prefer-spread
-    return Array.apply(null, { length } as any).fill(undefined);
+    const a = new Array(length);
+    for (let i = 0; i < length; ++i) a[i] = undefined;
+    return a;
   }
 
   public mergeParamsMetatypes(
@@ -86,15 +89,11 @@ export class ContextUtils {
     instance?: object,
     callback?: Function,
   ): (args: unknown[]) => ExecutionContextHost {
-    const contextFactory = (args: unknown[]) => {
-      const ctx = new ExecutionContextHost(
-        args,
-        instance && (instance.constructor as Type<unknown>),
-        callback,
-      );
+    const type = instance && (instance.constructor as Type<unknown>);
+    return (args: unknown[]) => {
+      const ctx = new ExecutionContextHost(args, type, callback);
       ctx.setType(contextType);
       return ctx;
     };
-    return contextFactory;
   }
 }
diff --git a/packages/core/helpers/execution-context-host.ts b/packages/core/helpers/execution-context-host.ts
index 922b98ed3..f8ac796b6 100644
--- a/packages/core/helpers/execution-context-host.ts
+++ b/packages/core/helpers/execution-context-host.ts
@@ -12,8 +12,8 @@ export class ExecutionContextHost implements ExecutionContext {
 
   constructor(
     private readonly args: any[],
-    private readonly constructorRef: Type<any> = null,
-    private readonly handler: Function = null,
+    private readonly constructorRef: Type<any> | null = null,
+    private readonly handler: Function | null = null,
   ) {}
 
   setType<TContext extends string = ContextType>(type: TContext) {
@@ -25,11 +25,11 @@ export class ExecutionContextHost implements ExecutionContext {
   }
 
   getClass<T = any>(): Type<T> {
-    return this.constructorRef;
+    return this.constructorRef!;
   }
 
   getHandler(): Function {
-    return this.handler;
+    return this.handler!;
   }
 
   getArgs<T extends Array<any> = any[]>(): T {
@@ -59,6 +59,7 @@ export class ExecutionContextHost implements ExecutionContext {
     return Object.assign(this, {
       getClient: () => this.getArgByIndex(0),
       getData: () => this.getArgByIndex(1),
+      getPattern: () => this.getArgByIndex(this.getArgs().length - 1),
     });
   }
 }
diff --git a/packages/core/helpers/external-context-creator.ts b/packages/core/helpers/external-context-creator.ts
index ee9484017..bacc125ba 100644
--- a/packages/core/helpers/external-context-creator.ts
+++ b/packages/core/helpers/external-context-creator.ts
@@ -1,24 +1,24 @@
 import { ForbiddenException, ParamData } from '@nestjs/common';
-import { CUSTOM_ROUTE_AGRS_METADATA } from '@nestjs/common/constants';
+import { CUSTOM_ROUTE_ARGS_METADATA } from '@nestjs/common/constants';
 import {
   ContextType,
   Controller,
   PipeTransform,
 } from '@nestjs/common/interfaces';
-import { isEmpty, isFunction } from '@nestjs/common/utils/shared.utils';
-import { lastValueFrom, isObservable } from 'rxjs';
+import { isEmpty } from '@nestjs/common/utils/shared.utils';
+import { isObservable, lastValueFrom } from 'rxjs';
 import { ExternalExceptionFilterContext } from '../exceptions/external-exception-filter-context';
+import { GuardsConsumer, GuardsContextCreator } from '../guards';
 import { FORBIDDEN_MESSAGE } from '../guards/constants';
-import { GuardsConsumer } from '../guards/guards-consumer';
-import { GuardsContextCreator } from '../guards/guards-context-creator';
 import { STATIC_CONTEXT } from '../injector/constants';
 import { NestContainer } from '../injector/container';
 import { ContextId } from '../injector/instance-wrapper';
 import { ModulesContainer } from '../injector/modules-container';
-import { InterceptorsConsumer } from '../interceptors/interceptors-consumer';
-import { InterceptorsContextCreator } from '../interceptors/interceptors-context-creator';
-import { PipesConsumer } from '../pipes/pipes-consumer';
-import { PipesContextCreator } from '../pipes/pipes-context-creator';
+import {
+  InterceptorsConsumer,
+  InterceptorsContextCreator,
+} from '../interceptors';
+import { PipesConsumer, PipesContextCreator } from '../pipes';
 import { ContextUtils, ParamProperties } from './context-utils';
 import { ExternalErrorProxy } from './external-proxy';
 import { HandlerMetadataStorage } from './handler-metadata-storage';
@@ -106,7 +106,7 @@ export class ExternalContextCreator {
     },
     contextType: TContext = 'http' as TContext,
   ) {
-    const module = this.getContextModuleKey(instance.constructor);
+    const moduleKey = this.getContextModuleKey(instance.constructor);
     const { argsLength, paramtypes, getParamsMetadata } = this.getMetadata<
       TParamsMetadata,
       TContext
@@ -114,21 +114,21 @@ export class ExternalContextCreator {
     const pipes = this.pipesContextCreator.create(
       instance,
       callback,
-      module,
+      moduleKey,
       contextId,
       inquirerId,
     );
     const guards = this.guardsContextCreator.create(
       instance,
       callback,
-      module,
+      moduleKey,
       contextId,
       inquirerId,
     );
     const exceptionFilter = this.filtersContextCreator.create(
       instance,
-      callback,
-      module,
+      callback as (...args: any[]) => any,
+      moduleKey,
       contextId,
       inquirerId,
     );
@@ -136,13 +136,13 @@ export class ExternalContextCreator {
       ? this.interceptorsContextCreator.create(
           instance,
           callback,
-          module,
+          moduleKey,
           contextId,
           inquirerId,
         )
       : [];
 
-    const paramsMetadata = getParamsMetadata(module, contextId, inquirerId);
+    const paramsMetadata = getParamsMetadata(moduleKey, contextId, inquirerId);
     const paramsOptions = paramsMetadata
       ? this.contextUtils.mergeParamsMetatypes(paramsMetadata, paramtypes)
       : [];
@@ -208,7 +208,7 @@ export class ExternalContextCreator {
       methodName,
     );
     const contextFactory = this.contextUtils.getContextFactory<TContext>(
-      contextType,
+      contextType!,
       instance,
       instance[methodName],
     );
@@ -232,7 +232,7 @@ export class ExternalContextCreator {
     const handlerMetadata: ExternalHandlerMetadata = {
       argsLength,
       paramtypes,
-      getParamsMetadata,
+      getParamsMetadata: getParamsMetadata as any,
     };
     this.handlerMetadataStorage.set(instance, methodName, handlerMetadata);
     return handlerMetadata;
@@ -272,7 +272,7 @@ export class ExternalContextCreator {
       );
       const type = this.contextUtils.mapParamType(key);
 
-      if (key.includes(CUSTOM_ROUTE_AGRS_METADATA)) {
+      if (key.includes(CUSTOM_ROUTE_ARGS_METADATA)) {
         const { factory } = metadata[key];
         const customExtractValue = this.contextUtils.getCustomFactory(
           factory,
diff --git a/packages/core/helpers/external-proxy.ts b/packages/core/helpers/external-proxy.ts
index b035d4326..98f1cb777 100644
--- a/packages/core/helpers/external-proxy.ts
+++ b/packages/core/helpers/external-proxy.ts
@@ -13,7 +13,7 @@ export class ExternalErrorProxy {
         return await targetCallback(...args);
       } catch (e) {
         const host = new ExecutionContextHost(args);
-        host.setType<TContext>(type);
+        host.setType<TContext>(type!);
         return exceptionsHandler.next(e, host);
       }
     };
diff --git a/packages/core/helpers/handler-metadata-storage.ts b/packages/core/helpers/handler-metadata-storage.ts
index ef22c9ecc..36e280f2e 100644
--- a/packages/core/helpers/handler-metadata-storage.ts
+++ b/packages/core/helpers/handler-metadata-storage.ts
@@ -1,5 +1,4 @@
-import { Type } from '@nestjs/common';
-import { Controller } from '@nestjs/common/interfaces';
+import { Controller, Type } from '@nestjs/common/interfaces';
 import { IncomingMessage } from 'http';
 import { Observable } from 'rxjs';
 import { CONTROLLER_ID_KEY } from '../injector/constants';
diff --git a/packages/core/helpers/http-adapter-host.ts b/packages/core/helpers/http-adapter-host.ts
index 1909ed9e3..652a8084f 100644
--- a/packages/core/helpers/http-adapter-host.ts
+++ b/packages/core/helpers/http-adapter-host.ts
@@ -1,3 +1,4 @@
+import { Observable, Subject } from 'rxjs';
 import { AbstractHttpAdapter } from '../adapters/http-adapter';
 
 /**
@@ -16,6 +17,8 @@ export class HttpAdapterHost<
   T extends AbstractHttpAdapter = AbstractHttpAdapter,
 > {
   private _httpAdapter?: T;
+  private _listen$ = new Subject<void>();
+  private isListening = false;
 
   /**
    * Accessor for the underlying `HttpAdapter`
@@ -33,6 +36,33 @@ export class HttpAdapterHost<
    * `const httpAdapter = adapterHost.httpAdapter;`
    */
   get httpAdapter(): T {
-    return this._httpAdapter;
+    return this._httpAdapter as T;
+  }
+
+  /**
+   * Observable that allows to subscribe to the `listen` event.
+   * This event is emitted when the HTTP application is listening for incoming requests.
+   */
+  get listen$(): Observable<void> {
+    return this._listen$.asObservable();
+  }
+
+  /**
+   * Sets the listening state of the application.
+   */
+  set listening(listening: boolean) {
+    this.isListening = listening;
+
+    if (listening) {
+      this._listen$.next();
+      this._listen$.complete();
+    }
+  }
+
+  /**
+   * Returns a boolean indicating whether the application is listening for incoming requests.
+   */
+  get listening(): boolean {
+    return this.isListening;
   }
 }
diff --git a/packages/core/helpers/index.ts b/packages/core/helpers/index.ts
index 5319266f1..76f854606 100644
--- a/packages/core/helpers/index.ts
+++ b/packages/core/helpers/index.ts
@@ -1,2 +1,3 @@
 export * from './context-id-factory';
+export * from './external-context-creator';
 export * from './http-adapter-host';
diff --git a/packages/core/helpers/is-durable.ts b/packages/core/helpers/is-durable.ts
new file mode 100644
index 000000000..377c84f18
--- /dev/null
+++ b/packages/core/helpers/is-durable.ts
@@ -0,0 +1,7 @@
+import { SCOPE_OPTIONS_METADATA } from '@nestjs/common/constants';
+import { Type } from '@nestjs/common/interfaces/type.interface';
+
+export function isDurable(provider: Type<unknown>): boolean | undefined {
+  const metadata = Reflect.getMetadata(SCOPE_OPTIONS_METADATA, provider);
+  return metadata && metadata.durable;
+}
diff --git a/packages/core/helpers/router-method-factory.ts b/packages/core/helpers/router-method-factory.ts
index d9b9a5d97..6051303d6 100644
--- a/packages/core/helpers/router-method-factory.ts
+++ b/packages/core/helpers/router-method-factory.ts
@@ -1,28 +1,32 @@
 import { HttpServer } from '@nestjs/common';
 import { RequestMethod } from '@nestjs/common/enums/request-method.enum';
 
+const REQUEST_METHOD_MAP = {
+  [RequestMethod.GET]: 'get',
+  [RequestMethod.POST]: 'post',
+  [RequestMethod.PUT]: 'put',
+  [RequestMethod.DELETE]: 'delete',
+  [RequestMethod.PATCH]: 'patch',
+  [RequestMethod.ALL]: 'all',
+  [RequestMethod.OPTIONS]: 'options',
+  [RequestMethod.HEAD]: 'head',
+  [RequestMethod.SEARCH]: 'search',
+  [RequestMethod.PROPFIND]: 'propfind',
+  [RequestMethod.PROPPATCH]: 'proppatch',
+  [RequestMethod.MKCOL]: 'mkcol',
+  [RequestMethod.COPY]: 'copy',
+  [RequestMethod.MOVE]: 'move',
+  [RequestMethod.LOCK]: 'lock',
+  [RequestMethod.UNLOCK]: 'unlock',
+} as const satisfies Record<RequestMethod, keyof HttpServer>;
+
 export class RouterMethodFactory {
   public get(target: HttpServer, requestMethod: RequestMethod): Function {
-    switch (requestMethod) {
-      case RequestMethod.POST:
-        return target.post;
-      case RequestMethod.ALL:
-        return target.all;
-      case RequestMethod.DELETE:
-        return target.delete;
-      case RequestMethod.PUT:
-        return target.put;
-      case RequestMethod.PATCH:
-        return target.patch;
-      case RequestMethod.OPTIONS:
-        return target.options;
-      case RequestMethod.HEAD:
-        return target.head;
-      case RequestMethod.GET:
-        return target.get;
-      default: {
-        return target.use;
-      }
+    const methodName = REQUEST_METHOD_MAP[requestMethod];
+    const method = target[methodName];
+    if (!method) {
+      return target.use;
     }
+    return method;
   }
 }
diff --git a/packages/core/hooks/before-app-shutdown.hook.ts b/packages/core/hooks/before-app-shutdown.hook.ts
index 8925cb61a..42fbed515 100644
--- a/packages/core/hooks/before-app-shutdown.hook.ts
+++ b/packages/core/hooks/before-app-shutdown.hook.ts
@@ -51,7 +51,7 @@ export async function callBeforeAppShutdownHook(
   signal?: string,
 ): Promise<void> {
   const providers = module.getNonAliasProviders();
-  const [_, moduleClassHost] = providers.shift();
+  const [_, moduleClassHost] = providers.shift()!;
   const instances = [
     ...module.controllers,
     ...providers,
@@ -70,8 +70,6 @@ export async function callBeforeAppShutdownHook(
     hasBeforeApplicationShutdownHook(moduleClassInstance) &&
     moduleClassHost.isDependencyTreeStatic()
   ) {
-    await (
-      moduleClassInstance as BeforeApplicationShutdown
-    ).beforeApplicationShutdown(signal);
+    await moduleClassInstance.beforeApplicationShutdown(signal);
   }
 }
diff --git a/packages/core/hooks/on-app-bootstrap.hook.ts b/packages/core/hooks/on-app-bootstrap.hook.ts
index 10e14d099..9ec8ca6eb 100644
--- a/packages/core/hooks/on-app-bootstrap.hook.ts
+++ b/packages/core/hooks/on-app-bootstrap.hook.ts
@@ -44,7 +44,7 @@ export async function callModuleBootstrapHook(module: Module): Promise<any> {
   const providers = module.getNonAliasProviders();
   // Module (class) instance is the first element of the providers array
   // Lifecycle hook has to be called once all classes are properly initialized
-  const [_, moduleClassHost] = providers.shift();
+  const [_, moduleClassHost] = providers.shift()!;
   const instances = [
     ...module.controllers,
     ...providers,
@@ -64,8 +64,6 @@ export async function callModuleBootstrapHook(module: Module): Promise<any> {
     hasOnAppBootstrapHook(moduleClassInstance) &&
     moduleClassHost.isDependencyTreeStatic()
   ) {
-    await (
-      moduleClassInstance as OnApplicationBootstrap
-    ).onApplicationBootstrap();
+    await moduleClassInstance.onApplicationBootstrap();
   }
 }
diff --git a/packages/core/hooks/on-app-shutdown.hook.ts b/packages/core/hooks/on-app-shutdown.hook.ts
index 50458bc01..3c9b2b900 100644
--- a/packages/core/hooks/on-app-shutdown.hook.ts
+++ b/packages/core/hooks/on-app-shutdown.hook.ts
@@ -40,6 +40,7 @@ function callOperator(
  * (providers / controllers).
  *
  * @param module The module which will be initialized
+ * @param signal
  */
 export async function callAppShutdownHook(
   module: Module,
@@ -48,7 +49,7 @@ export async function callAppShutdownHook(
   const providers = module.getNonAliasProviders();
   // Module (class) instance is the first element of the providers array
   // Lifecycle hook has to be called once all classes are properly initialized
-  const [_, moduleClassHost] = providers.shift();
+  const [_, moduleClassHost] = providers.shift()!;
   const instances = [
     ...module.controllers,
     ...providers,
@@ -68,8 +69,6 @@ export async function callAppShutdownHook(
     hasOnAppShutdownHook(moduleClassInstance) &&
     moduleClassHost.isDependencyTreeStatic()
   ) {
-    await (moduleClassInstance as OnApplicationShutdown).onApplicationShutdown(
-      signal,
-    );
+    await moduleClassInstance.onApplicationShutdown(signal);
   }
 }
diff --git a/packages/core/hooks/on-module-destroy.hook.ts b/packages/core/hooks/on-module-destroy.hook.ts
index a631cbc85..8c2692372 100644
--- a/packages/core/hooks/on-module-destroy.hook.ts
+++ b/packages/core/hooks/on-module-destroy.hook.ts
@@ -42,7 +42,7 @@ export async function callModuleDestroyHook(module: Module): Promise<any> {
   const providers = module.getNonAliasProviders();
   // Module (class) instance is the first element of the providers array
   // Lifecycle hook has to be called once all classes are properly destroyed
-  const [_, moduleClassHost] = providers.shift();
+  const [_, moduleClassHost] = providers.shift()!;
   const instances = [
     ...module.controllers,
     ...providers,
@@ -63,6 +63,6 @@ export async function callModuleDestroyHook(module: Module): Promise<any> {
     hasOnModuleDestroyHook(moduleClassInstance) &&
     moduleClassHost.isDependencyTreeStatic()
   ) {
-    await (moduleClassInstance as OnModuleDestroy).onModuleDestroy();
+    await moduleClassInstance.onModuleDestroy();
   }
 }
diff --git a/packages/core/hooks/on-module-init.hook.ts b/packages/core/hooks/on-module-init.hook.ts
index 52a34cb6a..029eaecad 100644
--- a/packages/core/hooks/on-module-init.hook.ts
+++ b/packages/core/hooks/on-module-init.hook.ts
@@ -38,7 +38,7 @@ export async function callModuleInitHook(module: Module): Promise<void> {
   const providers = module.getNonAliasProviders();
   // Module (class) instance is the first element of the providers array
   // Lifecycle hook has to be called once all classes are properly initialized
-  const [_, moduleClassHost] = providers.shift();
+  const [_, moduleClassHost] = providers.shift()!;
   const instances = [
     ...module.controllers,
     ...providers,
@@ -59,6 +59,6 @@ export async function callModuleInitHook(module: Module): Promise<void> {
     hasOnModuleInitHook(moduleClassInstance) &&
     moduleClassHost.isDependencyTreeStatic()
   ) {
-    await (moduleClassInstance as OnModuleInit).onModuleInit();
+    await moduleClassInstance.onModuleInit();
   }
 }
diff --git a/packages/core/index.ts b/packages/core/index.ts
index 2915304ab..511eac90d 100644
--- a/packages/core/index.ts
+++ b/packages/core/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @core
- * Copyright(c) 2017 - 2021 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2023 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
@@ -13,10 +13,12 @@ export * from './discovery';
 export * from './exceptions';
 export * from './helpers';
 export * from './injector';
+export * from './inspector';
 export * from './metadata-scanner';
 export * from './middleware';
 export * from './nest-application';
 export * from './nest-application-context';
 export { NestFactory } from './nest-factory';
+export * from './repl';
 export * from './router';
 export * from './services';
diff --git a/packages/core/injector/abstract-instance-resolver.ts b/packages/core/injector/abstract-instance-resolver.ts
new file mode 100644
index 000000000..ed78674c7
--- /dev/null
+++ b/packages/core/injector/abstract-instance-resolver.ts
@@ -0,0 +1,86 @@
+import { Abstract, Scope, Type } from '@nestjs/common';
+import { GetOrResolveOptions } from '@nestjs/common/interfaces';
+import {
+  InvalidClassScopeException,
+  UnknownElementException,
+} from '../errors/exceptions';
+import { Injector } from './injector';
+import { InstanceLink, InstanceLinksHost } from './instance-links-host';
+import { ContextId } from './instance-wrapper';
+import { Module } from './module';
+
+export abstract class AbstractInstanceResolver {
+  protected abstract instanceLinksHost: InstanceLinksHost;
+  protected abstract injector: Injector;
+
+  protected abstract get<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    options?: GetOrResolveOptions,
+  ): TResult | Array<TResult>;
+
+  protected find<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Abstract<TInput> | string | symbol,
+    options: { moduleId?: string; each?: boolean },
+  ): TResult | Array<TResult> {
+    const instanceLinkOrArray = this.instanceLinksHost.get<TResult>(
+      typeOrToken,
+      options,
+    );
+    const pluckInstance = ({ wrapperRef }: InstanceLink) => {
+      if (
+        wrapperRef.scope === Scope.REQUEST ||
+        wrapperRef.scope === Scope.TRANSIENT
+      ) {
+        throw new InvalidClassScopeException(typeOrToken);
+      }
+      return wrapperRef.instance;
+    };
+    if (Array.isArray(instanceLinkOrArray)) {
+      return instanceLinkOrArray.map(pluckInstance);
+    }
+    return pluckInstance(instanceLinkOrArray);
+  }
+
+  protected async resolvePerContext<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Abstract<TInput> | string | symbol,
+    contextModule: Module,
+    contextId: ContextId,
+    options?: GetOrResolveOptions,
+  ): Promise<TResult | Array<TResult>> {
+    const instanceLinkOrArray = options?.strict
+      ? this.instanceLinksHost.get(typeOrToken, {
+          moduleId: contextModule.id,
+          each: options.each,
+        })
+      : this.instanceLinksHost.get(typeOrToken, {
+          each: options?.each,
+        });
+
+    const pluckInstance = async (instanceLink: InstanceLink) => {
+      const { wrapperRef, collection } = instanceLink;
+      if (wrapperRef.isDependencyTreeStatic() && !wrapperRef.isTransient) {
+        return this.get(typeOrToken, { strict: options?.strict });
+      }
+
+      const ctorHost = wrapperRef.instance || { constructor: typeOrToken };
+      const instance = await this.injector.loadPerContext(
+        ctorHost,
+        wrapperRef.host!,
+        collection,
+        contextId,
+        wrapperRef,
+      );
+      if (!instance) {
+        throw new UnknownElementException();
+      }
+      return instance;
+    };
+
+    if (Array.isArray(instanceLinkOrArray)) {
+      return Promise.all(
+        instanceLinkOrArray.map(instanceLink => pluckInstance(instanceLink)),
+      );
+    }
+    return pluckInstance(instanceLinkOrArray);
+  }
+}
diff --git a/packages/core/injector/compiler.ts b/packages/core/injector/compiler.ts
index 6c707fd61..075d97bc3 100644
--- a/packages/core/injector/compiler.ts
+++ b/packages/core/injector/compiler.ts
@@ -1,5 +1,9 @@
-import { DynamicModule, Type } from '@nestjs/common/interfaces';
-import { ModuleTokenFactory } from './module-token-factory';
+import {
+  DynamicModule,
+  ForwardReference,
+  Type,
+} from '@nestjs/common/interfaces';
+import { ModuleOpaqueKeyFactory } from './opaque-key-factory/interfaces/module-opaque-key-factory.interface';
 
 export interface ModuleFactory {
   type: Type<any>;
@@ -8,30 +12,59 @@ export interface ModuleFactory {
 }
 
 export class ModuleCompiler {
-  constructor(private readonly moduleTokenFactory = new ModuleTokenFactory()) {}
+  constructor(
+    private readonly _moduleOpaqueKeyFactory: ModuleOpaqueKeyFactory,
+  ) {}
+
+  get moduleOpaqueKeyFactory(): ModuleOpaqueKeyFactory {
+    return this._moduleOpaqueKeyFactory;
+  }
 
   public async compile(
-    metatype: Type<any> | DynamicModule | Promise<DynamicModule>,
+    moduleClsOrDynamic:
+      | Type
+      | DynamicModule
+      | ForwardReference
+      | Promise<DynamicModule>,
   ): Promise<ModuleFactory> {
-    const { type, dynamicMetadata } = this.extractMetadata(await metatype);
-    const token = this.moduleTokenFactory.create(type, dynamicMetadata);
+    moduleClsOrDynamic = await moduleClsOrDynamic;
+
+    const { type, dynamicMetadata } = this.extractMetadata(moduleClsOrDynamic);
+    const token = dynamicMetadata
+      ? this._moduleOpaqueKeyFactory.createForDynamic(
+          type,
+          dynamicMetadata,
+          moduleClsOrDynamic as DynamicModule | ForwardReference,
+        )
+      : this._moduleOpaqueKeyFactory.createForStatic(
+          type,
+          moduleClsOrDynamic as Type,
+        );
+
     return { type, dynamicMetadata, token };
   }
 
-  public extractMetadata(metatype: Type<any> | DynamicModule): {
-    type: Type<any>;
-    dynamicMetadata?: Partial<DynamicModule> | undefined;
+  public extractMetadata(
+    moduleClsOrDynamic: Type | ForwardReference | DynamicModule,
+  ): {
+    type: Type;
+    dynamicMetadata: Omit<DynamicModule, 'module'> | undefined;
   } {
-    if (!this.isDynamicModule(metatype)) {
-      return { type: metatype };
+    if (!this.isDynamicModule(moduleClsOrDynamic)) {
+      return {
+        type: (moduleClsOrDynamic as ForwardReference)?.forwardRef
+          ? (moduleClsOrDynamic as ForwardReference).forwardRef()
+          : moduleClsOrDynamic,
+        dynamicMetadata: undefined,
+      };
     }
-    const { module: type, ...dynamicMetadata } = metatype;
+    const { module: type, ...dynamicMetadata } = moduleClsOrDynamic;
     return { type, dynamicMetadata };
   }
 
   public isDynamicModule(
-    module: Type<any> | DynamicModule,
-  ): module is DynamicModule {
-    return !!(module as DynamicModule).module;
+    moduleClsOrDynamic: Type | DynamicModule | ForwardReference,
+  ): moduleClsOrDynamic is DynamicModule {
+    return !!(moduleClsOrDynamic as DynamicModule).module;
   }
 }
diff --git a/packages/core/injector/container.ts b/packages/core/injector/container.ts
index b50957d38..94e1ad925 100644
--- a/packages/core/injector/container.ts
+++ b/packages/core/injector/container.ts
@@ -1,35 +1,67 @@
 import { DynamicModule, Provider } from '@nestjs/common';
-import { GLOBAL_MODULE_METADATA } from '@nestjs/common/constants';
-import { Injectable } from '@nestjs/common/interfaces/injectable.interface';
-import { Type } from '@nestjs/common/interfaces/type.interface';
+import {
+  EnhancerSubtype,
+  GLOBAL_MODULE_METADATA,
+} from '@nestjs/common/constants';
+import { Injectable, Type } from '@nestjs/common/interfaces';
+import { NestApplicationContextOptions } from '@nestjs/common/interfaces/nest-application-context-options.interface';
 import { ApplicationConfig } from '../application-config';
-import { CircularDependencyException } from '../errors/exceptions/circular-dependency.exception';
-import { UndefinedForwardRefException } from '../errors/exceptions/undefined-forwardref.exception';
-import { UnknownModuleException } from '../errors/exceptions/unknown-module.exception';
+import { DiscoverableMetaHostCollection } from '../discovery/discoverable-meta-host-collection';
+import {
+  CircularDependencyException,
+  UndefinedForwardRefException,
+  UnknownModuleException,
+} from '../errors/exceptions';
+import { InitializeOnPreviewAllowlist } from '../inspector/initialize-on-preview.allowlist';
+import { SerializedGraph } from '../inspector/serialized-graph';
 import { REQUEST } from '../router/request/request-constants';
-import { ModuleCompiler } from './compiler';
+import { ModuleCompiler, ModuleFactory } from './compiler';
 import { ContextId } from './instance-wrapper';
-import { InternalCoreModule } from './internal-core-module';
+import { InternalCoreModule } from './internal-core-module/internal-core-module';
 import { InternalProvidersStorage } from './internal-providers-storage';
 import { Module } from './module';
-import { ModuleTokenFactory } from './module-token-factory';
 import { ModulesContainer } from './modules-container';
+import { ByReferenceModuleOpaqueKeyFactory } from './opaque-key-factory/by-reference-module-opaque-key-factory';
+import { DeepHashedModuleOpaqueKeyFactory } from './opaque-key-factory/deep-hashed-module-opaque-key-factory';
+import { ModuleOpaqueKeyFactory } from './opaque-key-factory/interfaces/module-opaque-key-factory.interface';
+
+type ModuleMetatype = Type<any> | DynamicModule | Promise<DynamicModule>;
+type ModuleScope = Type<any>[];
 
 export class NestContainer {
   private readonly globalModules = new Set<Module>();
-  private readonly moduleTokenFactory = new ModuleTokenFactory();
-  private readonly moduleCompiler = new ModuleCompiler(this.moduleTokenFactory);
   private readonly modules = new ModulesContainer();
   private readonly dynamicModulesMetadata = new Map<
     string,
     Partial<DynamicModule>
   >();
   private readonly internalProvidersStorage = new InternalProvidersStorage();
+  private readonly _serializedGraph = new SerializedGraph();
+  private moduleCompiler: ModuleCompiler;
   private internalCoreModule: Module;
 
   constructor(
-    private readonly _applicationConfig: ApplicationConfig = undefined,
-  ) {}
+    private readonly _applicationConfig:
+      | ApplicationConfig
+      | undefined = undefined,
+    private readonly _contextOptions:
+      | NestApplicationContextOptions
+      | undefined = undefined,
+  ) {
+    const moduleOpaqueKeyFactory =
+      this._contextOptions?.moduleIdGeneratorAlgorithm === 'deep-hash'
+        ? new DeepHashedModuleOpaqueKeyFactory()
+        : new ByReferenceModuleOpaqueKeyFactory({
+            keyGenerationStrategy: this._contextOptions?.snapshot
+              ? 'shallow'
+              : 'random',
+          });
+    this.moduleCompiler = new ModuleCompiler(moduleOpaqueKeyFactory);
+  }
+
+  get serializedGraph(): SerializedGraph {
+    return this._serializedGraph;
+  }
 
   get applicationConfig(): ApplicationConfig | undefined {
     return this._applicationConfig;
@@ -54,33 +86,93 @@ export class NestContainer {
   }
 
   public async addModule(
-    metatype: Type<any> | DynamicModule | Promise<DynamicModule>,
-    scope: Type<any>[],
-  ): Promise<Module | undefined> {
+    metatype: ModuleMetatype,
+    scope: ModuleScope,
+  ): Promise<
+    | {
+        moduleRef: Module;
+        inserted: boolean;
+      }
+    | undefined
+  > {
     // In DependenciesScanner#scanForModules we already check for undefined or invalid modules
     // We still need to catch the edge-case of `forwardRef(() => undefined)`
     if (!metatype) {
       throw new UndefinedForwardRefException(scope);
     }
-    const { type, dynamicMetadata, token } = await this.moduleCompiler.compile(
-      metatype,
-    );
+    const { type, dynamicMetadata, token } =
+      await this.moduleCompiler.compile(metatype);
     if (this.modules.has(token)) {
-      return this.modules.get(token);
+      return {
+        moduleRef: this.modules.get(token)!,
+        inserted: true,
+      };
     }
+
+    return {
+      moduleRef: await this.setModule(
+        {
+          token,
+          type,
+          dynamicMetadata,
+        },
+        scope,
+      ),
+      inserted: true,
+    };
+  }
+
+  public async replaceModule(
+    metatypeToReplace: ModuleMetatype,
+    newMetatype: ModuleMetatype,
+    scope: ModuleScope,
+  ): Promise<
+    | {
+        moduleRef: Module;
+        inserted: boolean;
+      }
+    | undefined
+  > {
+    // In DependenciesScanner#scanForModules we already check for undefined or invalid modules
+    // We still need to catch the edge-case of `forwardRef(() => undefined)`
+    if (!metatypeToReplace || !newMetatype) {
+      throw new UndefinedForwardRefException(scope);
+    }
+
+    const { token } = await this.moduleCompiler.compile(metatypeToReplace);
+    const { type, dynamicMetadata } =
+      await this.moduleCompiler.compile(newMetatype);
+
+    return {
+      moduleRef: await this.setModule(
+        {
+          token,
+          type,
+          dynamicMetadata,
+        },
+        scope,
+      ),
+      inserted: false,
+    };
+  }
+
+  private async setModule(
+    { token, dynamicMetadata, type }: ModuleFactory,
+    scope: ModuleScope,
+  ): Promise<Module> {
     const moduleRef = new Module(type, this);
     moduleRef.token = token;
+    moduleRef.initOnPreview = this.shouldInitOnPreview(type);
     this.modules.set(token, moduleRef);
 
-    await this.addDynamicMetadata(
-      token,
-      dynamicMetadata,
-      [].concat(scope, type),
-    );
+    const updatedScope = ([] as ModuleScope).concat(scope, type);
+    await this.addDynamicMetadata(token, dynamicMetadata!, updatedScope);
 
     if (this.isGlobalModule(type, dynamicMetadata)) {
+      moduleRef.isGlobal = true;
       this.addGlobalModule(moduleRef);
     }
+
     return moduleRef;
   }
 
@@ -95,7 +187,7 @@ export class NestContainer {
     this.dynamicModulesMetadata.set(token, dynamicModuleMetadata);
 
     const { imports } = dynamicModuleMetadata;
-    await this.addDynamicModules(imports, scope);
+    await this.addDynamicModules(imports!, scope);
   }
 
   public async addDynamicModules(modules: any[], scope: Type<any>[]) {
@@ -127,7 +219,7 @@ export class NestContainer {
     return this.moduleCompiler;
   }
 
-  public getModuleByKey(moduleKey: string): Module {
+  public getModuleByKey(moduleKey: string): Module | undefined {
     return this.modules.get(moduleKey);
   }
 
@@ -142,45 +234,51 @@ export class NestContainer {
     if (!this.modules.has(token)) {
       return;
     }
-    const moduleRef = this.modules.get(token);
-    const { token: relatedModuleToken } = await this.moduleCompiler.compile(
-      relatedModule,
-    );
-    const related = this.modules.get(relatedModuleToken);
-    moduleRef.addRelatedModule(related);
+    const moduleRef = this.modules.get(token)!;
+    const { token: relatedModuleToken } =
+      await this.moduleCompiler.compile(relatedModule);
+    const related = this.modules.get(relatedModuleToken)!;
+    moduleRef.addImport(related);
   }
 
   public addProvider(
     provider: Provider,
     token: string,
+    enhancerSubtype?: EnhancerSubtype,
   ): string | symbol | Function {
+    const moduleRef = this.modules.get(token);
     if (!provider) {
-      throw new CircularDependencyException();
+      throw new CircularDependencyException(moduleRef?.metatype.name);
     }
-    if (!this.modules.has(token)) {
+    if (!moduleRef) {
       throw new UnknownModuleException();
     }
-    const moduleRef = this.modules.get(token);
-    return moduleRef.addProvider(provider);
+    const providerKey = moduleRef.addProvider(provider, enhancerSubtype!);
+    const providerRef = moduleRef.getProviderByKey(providerKey);
+
+    DiscoverableMetaHostCollection.inspectProvider(this.modules, providerRef);
+
+    return providerKey as Function;
   }
 
   public addInjectable(
     injectable: Provider,
     token: string,
+    enhancerSubtype: EnhancerSubtype,
     host?: Type<Injectable>,
   ) {
     if (!this.modules.has(token)) {
       throw new UnknownModuleException();
     }
-    const moduleRef = this.modules.get(token);
-    moduleRef.addInjectable(injectable, host);
+    const moduleRef = this.modules.get(token)!;
+    return moduleRef.addInjectable(injectable, enhancerSubtype, host);
   }
 
   public addExportedProvider(provider: Type<any>, token: string) {
     if (!this.modules.has(token)) {
       throw new UnknownModuleException();
     }
-    const moduleRef = this.modules.get(token);
+    const moduleRef = this.modules.get(token)!;
     moduleRef.addExportedProvider(provider);
   }
 
@@ -188,15 +286,21 @@ export class NestContainer {
     if (!this.modules.has(token)) {
       throw new UnknownModuleException();
     }
-    const moduleRef = this.modules.get(token);
+    const moduleRef = this.modules.get(token)!;
     moduleRef.addController(controller);
+
+    const controllerRef = moduleRef.controllers.get(controller)!;
+    DiscoverableMetaHostCollection.inspectController(
+      this.modules,
+      controllerRef,
+    );
   }
 
   public clear() {
     this.modules.clear();
   }
 
-  public replace(toReplace: any, options: any & { scope: any[] | null }) {
+  public replace(toReplace: any, options: { scope: any[] | null }) {
     this.modules.forEach(moduleRef => moduleRef.replace(toReplace, options));
   }
 
@@ -214,18 +318,19 @@ export class NestContainer {
     if (target === globalModule || target === this.internalCoreModule) {
       return;
     }
-    target.addRelatedModule(globalModule);
+    target.addImport(globalModule);
   }
 
+  public getDynamicMetadataByToken(token: string): Partial<DynamicModule>;
+  public getDynamicMetadataByToken<
+    K extends Exclude<keyof DynamicModule, 'global' | 'module'>,
+  >(token: string, metadataKey: K): DynamicModule[K];
   public getDynamicMetadataByToken(
     token: string,
-    metadataKey: keyof DynamicModule,
+    metadataKey?: Exclude<keyof DynamicModule, 'global' | 'module'>,
   ) {
     const metadata = this.dynamicModulesMetadata.get(token);
-    if (metadata && metadata[metadataKey]) {
-      return metadata[metadataKey] as any[];
-    }
-    return [];
+    return metadataKey ? (metadata?.[metadataKey] ?? []) : metadata;
   }
 
   public registerCoreModuleRef(moduleRef: Module) {
@@ -233,8 +338,8 @@ export class NestContainer {
     this.modules[InternalCoreModule.name] = moduleRef;
   }
 
-  public getModuleTokenFactory(): ModuleTokenFactory {
-    return this.moduleTokenFactory;
+  public getModuleTokenFactory(): ModuleOpaqueKeyFactory {
+    return this.moduleCompiler.moduleOpaqueKeyFactory;
   }
 
   public registerRequestProvider<T = any>(request: T, contextId: ContextId) {
@@ -244,4 +349,8 @@ export class NestContainer {
       isResolved: true,
     });
   }
+
+  private shouldInitOnPreview(type: Type) {
+    return InitializeOnPreviewAllowlist.has(type);
+  }
 }
diff --git a/packages/core/injector/helpers/provider-classifier.ts b/packages/core/injector/helpers/provider-classifier.ts
new file mode 100644
index 000000000..b883a4ea8
--- /dev/null
+++ b/packages/core/injector/helpers/provider-classifier.ts
@@ -0,0 +1,26 @@
+import {
+  ClassProvider,
+  FactoryProvider,
+  Provider,
+  ValueProvider,
+} from '@nestjs/common';
+import { isUndefined } from '@nestjs/common/utils/shared.utils';
+
+export function isClassProvider<T = any>(
+  provider: Provider,
+): provider is ClassProvider<T> {
+  return Boolean((provider as ClassProvider<T>)?.useClass);
+}
+
+export function isValueProvider<T = any>(
+  provider: Provider,
+): provider is ValueProvider<T> {
+  const providerValue = (provider as ValueProvider)?.useValue;
+  return !isUndefined(providerValue);
+}
+
+export function isFactoryProvider<T = any>(
+  provider: Provider,
+): provider is FactoryProvider<T> {
+  return Boolean((provider as FactoryProvider).useFactory);
+}
diff --git a/packages/core/injector/helpers/silent-logger.ts b/packages/core/injector/helpers/silent-logger.ts
new file mode 100644
index 000000000..d4de2c7eb
--- /dev/null
+++ b/packages/core/injector/helpers/silent-logger.ts
@@ -0,0 +1,12 @@
+import { Logger } from '@nestjs/common';
+
+const noop = () => {};
+export class SilentLogger extends Logger {
+  log = noop;
+  error = noop;
+  warn = noop;
+  debug = noop;
+  verbose = noop;
+  fatal = noop;
+  setLogLevels = noop;
+}
diff --git a/packages/core/injector/helpers/transient-instances.ts b/packages/core/injector/helpers/transient-instances.ts
index 17287ef80..4e7f4afd6 100644
--- a/packages/core/injector/helpers/transient-instances.ts
+++ b/packages/core/injector/helpers/transient-instances.ts
@@ -1,13 +1,13 @@
+import { InjectionToken } from '@nestjs/common';
 import { iterate } from 'iterare';
 import { InstanceWrapper } from '../instance-wrapper';
-import { InstanceToken } from '../module';
 
 /**
  * Returns the instances which are transient
- * @param instances The instances which should be checked whether they are transcient
+ * @param instances The instances which should be checked whether they are transient
  */
 export function getTransientInstances(
-  instances: [InstanceToken, InstanceWrapper][],
+  instances: [InjectionToken, InstanceWrapper][],
 ): InstanceWrapper[] {
   return iterate(instances)
     .filter(([_, wrapper]) => wrapper.isDependencyTreeStatic())
@@ -20,10 +20,10 @@ export function getTransientInstances(
 
 /**
  * Returns the instances which are not transient
- * @param instances The instances which should be checked whether they are transcient
+ * @param instances The instances which should be checked whether they are transient
  */
 export function getNonTransientInstances(
-  instances: [InstanceToken, InstanceWrapper][],
+  instances: [InjectionToken, InstanceWrapper][],
 ): InstanceWrapper[] {
   return iterate(instances)
     .filter(
diff --git a/packages/core/injector/index.ts b/packages/core/injector/index.ts
index 6eb81c89c..21e406d06 100644
--- a/packages/core/injector/index.ts
+++ b/packages/core/injector/index.ts
@@ -1,6 +1,6 @@
 export * from './container';
 export * from './inquirer';
-export { ContextId } from './instance-wrapper';
-export * from './lazy-module-loader';
+export { ContextId, HostComponentInfo } from './instance-wrapper';
+export * from './lazy-module-loader/lazy-module-loader';
 export * from './module-ref';
 export * from './modules-container';
diff --git a/packages/core/injector/injector.ts b/packages/core/injector/injector.ts
index 67996afb3..d6b5d78a2 100644
--- a/packages/core/injector/injector.ts
+++ b/packages/core/injector/injector.ts
@@ -1,4 +1,9 @@
-import { Logger, LoggerService } from '@nestjs/common';
+import {
+  InjectionToken,
+  Logger,
+  LoggerService,
+  OptionalFactoryDependency,
+} from '@nestjs/common';
 import {
   OPTIONAL_DEPS_METADATA,
   OPTIONAL_PROPERTY_DEPS_METADATA,
@@ -6,18 +11,24 @@ import {
   PROPERTY_DEPS_METADATA,
   SELF_DECLARED_DEPS_METADATA,
 } from '@nestjs/common/constants';
-import { Controller } from '@nestjs/common/interfaces/controllers/controller.interface';
-import { Injectable } from '@nestjs/common/interfaces/injectable.interface';
-import { Type } from '@nestjs/common/interfaces/type.interface';
+import {
+  Controller,
+  ForwardReference,
+  Injectable,
+  Type,
+} from '@nestjs/common/interfaces';
 import { clc } from '@nestjs/common/utils/cli-colors.util';
 import {
   isFunction,
   isNil,
   isObject,
   isString,
+  isSymbol,
   isUndefined,
 } from '@nestjs/common/utils/shared.utils';
 import { iterate } from 'iterare';
+import { performance } from 'perf_hooks';
+import { CircularDependencyException } from '../errors/exceptions';
 import { RuntimeException } from '../errors/exceptions/runtime.exception';
 import { UndefinedDependencyException } from '../errors/exceptions/undefined-dependency.exception';
 import { UnknownDependenciesException } from '../errors/exceptions/unknown-dependencies.exception';
@@ -29,18 +40,19 @@ import {
   InstanceWrapper,
   PropertyMetadata,
 } from './instance-wrapper';
-import { InstanceToken, Module } from './module';
+import { Module } from './module';
+import { SettlementSignal } from './settlement-signal';
 
 /**
  * The type of an injectable dependency
  */
-export type InjectorDependency = Type<any> | Function | string | symbol;
+export type InjectorDependency = InjectionToken;
 
 /**
  * The property-based dependency
  */
 export interface PropertyDependency {
-  key: string;
+  key: symbol | string;
   name: InjectorDependency;
   isOptional?: boolean;
   instance?: any;
@@ -73,15 +85,17 @@ export interface InjectorDependencyContext {
 export class Injector {
   private logger: LoggerService = new Logger('InjectorLogger');
 
+  constructor(private readonly options?: { preview: boolean }) {}
+
   public loadPrototype<T>(
     { token }: InstanceWrapper<T>,
-    collection: Map<InstanceToken, InstanceWrapper<T>>,
+    collection: Map<InjectionToken, InstanceWrapper<T>>,
     contextId = STATIC_CONTEXT,
   ) {
     if (!collection) {
       return;
     }
-    const target = collection.get(token);
+    const target = collection.get(token)!;
     const instance = target.createPrototype(contextId);
     if (instance) {
       const wrapper = new InstanceWrapper({
@@ -94,17 +108,31 @@ export class Injector {
 
   public async loadInstance<T>(
     wrapper: InstanceWrapper<T>,
-    collection: Map<InstanceToken, InstanceWrapper>,
+    collection: Map<InjectionToken, InstanceWrapper>,
     moduleRef: Module,
     contextId = STATIC_CONTEXT,
     inquirer?: InstanceWrapper,
   ) {
     const inquirerId = this.getInquirerId(inquirer);
-    const instanceHost = wrapper.getInstanceByContextId(contextId, inquirerId);
+    const instanceHost = wrapper.getInstanceByContextId(
+      this.getContextId(contextId, wrapper),
+      inquirerId,
+    );
+
     if (instanceHost.isPending) {
-      return instanceHost.donePromise;
+      const settlementSignal = wrapper.settlementSignal;
+      if (inquirer && settlementSignal?.isCycle(inquirer.id)) {
+        throw new CircularDependencyException(`"${wrapper.name}"`);
+      }
+
+      return instanceHost.donePromise!.then((err?: unknown) => {
+        if (err) {
+          throw err;
+        }
+      });
     }
-    const done = this.applyDoneHook(instanceHost);
+
+    const settlementSignal = this.applySettlementSignal(instanceHost, wrapper);
     const token = wrapper.token || wrapper.name;
 
     const { inject } = wrapper;
@@ -113,51 +141,63 @@ export class Injector {
       throw new RuntimeException();
     }
     if (instanceHost.isResolved) {
-      return done();
+      return settlementSignal.complete();
     }
-    const callback = async (instances: unknown[]) => {
-      const properties = await this.resolveProperties(
+    try {
+      const t0 = this.getNowTimestamp();
+      const callback = async (instances: unknown[]) => {
+        const properties = await this.resolveProperties(
+          wrapper,
+          moduleRef,
+          inject as InjectionToken[],
+          contextId,
+          wrapper,
+          inquirer,
+        );
+        const instance = await this.instantiateClass(
+          instances,
+          wrapper,
+          targetWrapper,
+          contextId,
+          inquirer,
+        );
+        this.applyProperties(instance, properties);
+        wrapper.initTime = this.getNowTimestamp() - t0;
+        settlementSignal.complete();
+      };
+      await this.resolveConstructorParams<T>(
         wrapper,
         moduleRef,
-        inject,
+        inject as InjectionToken[],
+        callback,
         contextId,
         wrapper,
         inquirer,
       );
-      const instance = await this.instantiateClass(
-        instances,
-        wrapper,
-        targetWrapper,
-        contextId,
-        inquirer,
+    } catch (err) {
+      wrapper.removeInstanceByContextId(
+        this.getContextId(contextId, wrapper),
+        inquirerId,
       );
-      this.applyProperties(instance, properties);
-      done();
-    };
-    await this.resolveConstructorParams<T>(
-      wrapper,
-      moduleRef,
-      inject,
-      callback,
-      contextId,
-      wrapper,
-      inquirer,
-    );
+
+      settlementSignal.error(err);
+      throw err;
+    }
   }
 
   public async loadMiddleware(
     wrapper: InstanceWrapper,
-    collection: Map<InstanceToken, InstanceWrapper>,
+    collection: Map<InjectionToken, InstanceWrapper>,
     moduleRef: Module,
     contextId = STATIC_CONTEXT,
     inquirer?: InstanceWrapper,
   ) {
     const { metatype, token } = wrapper;
-    const targetWrapper = collection.get(token);
+    const targetWrapper = collection.get(token)!;
     if (!isUndefined(targetWrapper.instance)) {
       return;
     }
-    targetWrapper.instance = Object.create(metatype.prototype);
+    targetWrapper.instance = Object.create(metatype!.prototype);
     await this.loadInstance(
       wrapper,
       collection,
@@ -216,19 +256,22 @@ export class Injector {
     await this.loadEnhancersPerContext(wrapper, contextId, wrapper);
   }
 
-  public applyDoneHook<T>(wrapper: InstancePerContext<T>): () => void {
-    let done: () => void;
-    wrapper.donePromise = new Promise<void>((resolve, reject) => {
-      done = resolve;
-    });
-    wrapper.isPending = true;
-    return done;
+  public applySettlementSignal<T>(
+    instancePerContext: InstancePerContext<T>,
+    host: InstanceWrapper<T>,
+  ) {
+    const settlementSignal = new SettlementSignal();
+    instancePerContext.donePromise = settlementSignal.asPromise();
+    instancePerContext.isPending = true;
+    host.settlementSignal = settlementSignal;
+
+    return settlementSignal;
   }
 
   public async resolveConstructorParams<T>(
     wrapper: InstanceWrapper<T>,
     moduleRef: Module,
-    inject: InjectorDependency[],
+    inject: InjectorDependency[] | undefined,
     callback: (args: unknown[]) => void | Promise<void>,
     contextId = STATIC_CONTEXT,
     inquirer?: InstanceWrapper,
@@ -246,12 +289,11 @@ export class Injector {
       );
       return callback(deps);
     }
-    const dependencies = isNil(inject)
-      ? this.reflectConstructorParams(wrapper.metatype as Type<any>)
-      : inject;
-    const optionalDependenciesIds = isNil(inject)
-      ? this.reflectOptionalParams(wrapper.metatype as Type<any>)
-      : [];
+
+    const isFactoryProvider = !isNil(inject);
+    const [dependencies, optionalDependenciesIds] = isFactoryProvider
+      ? this.getFactoryProviderDependencies(wrapper)
+      : this.getClassDependencies(wrapper);
 
     let isResolved = true;
     const resolveParam = async (param: unknown, index: number) => {
@@ -265,7 +307,7 @@ export class Injector {
         }
         const paramWrapper = await this.resolveSingleParam<T>(
           wrapper,
-          param,
+          param as Type | string | symbol,
           { index, dependencies },
           moduleRef,
           contextId,
@@ -273,7 +315,7 @@ export class Injector {
           index,
         );
         const instanceHost = paramWrapper.getInstanceByContextId(
-          contextId,
+          this.getContextId(contextId, paramWrapper),
           inquirerId,
         );
         if (!instanceHost.isResolved && !paramWrapper.forwardRef) {
@@ -292,8 +334,60 @@ export class Injector {
     isResolved && (await callback(instances));
   }
 
+  public getClassDependencies<T>(
+    wrapper: InstanceWrapper<T>,
+  ): [InjectorDependency[], number[]] {
+    const ctorRef = wrapper.metatype as Type<any>;
+    return [
+      this.reflectConstructorParams(ctorRef),
+      this.reflectOptionalParams(ctorRef),
+    ];
+  }
+
+  public getFactoryProviderDependencies<T>(
+    wrapper: InstanceWrapper<T>,
+  ): [InjectorDependency[], number[]] {
+    const optionalDependenciesIds: number[] = [];
+
+    /**
+     * Same as the internal utility function `isOptionalFactoryDependency` from `@nestjs/common`.
+     * We are duplicating it here because that one is not supposed to be exported.
+     */
+    function isOptionalFactoryDependency(
+      value: InjectionToken | OptionalFactoryDependency,
+    ): value is OptionalFactoryDependency {
+      return (
+        !isUndefined((value as OptionalFactoryDependency).token) &&
+        !isUndefined((value as OptionalFactoryDependency).optional) &&
+        !(value as any).prototype
+      );
+    }
+
+    const mapFactoryProviderInjectArray = (
+      item: InjectionToken | OptionalFactoryDependency,
+      index: number,
+    ): InjectionToken => {
+      if (typeof item !== 'object') {
+        return item;
+      }
+      if (isOptionalFactoryDependency(item)) {
+        if (item.optional) {
+          optionalDependenciesIds.push(index);
+        }
+        return item?.token;
+      }
+      return item;
+    };
+    return [
+      wrapper.inject?.map?.(mapFactoryProviderInjectArray) as any[],
+      optionalDependenciesIds,
+    ];
+  }
+
   public reflectConstructorParams<T>(type: Type<T>): any[] {
-    const paramtypes = Reflect.getMetadata(PARAMTYPES_METADATA, type) || [];
+    const paramtypes = [
+      ...(Reflect.getMetadata(PARAMTYPES_METADATA, type) || []),
+    ];
     const selfParams = this.reflectSelfParams<T>(type);
 
     selfParams.forEach(({ index, param }) => (paramtypes[index] = param));
@@ -310,12 +404,12 @@ export class Injector {
 
   public async resolveSingleParam<T>(
     wrapper: InstanceWrapper<T>,
-    param: Type<any> | string | symbol | any,
+    param: Type<any> | string | symbol,
     dependencyContext: InjectorDependencyContext,
     moduleRef: Module,
     contextId = STATIC_CONTEXT,
     inquirer?: InstanceWrapper,
-    keyOrIndex?: string | number,
+    keyOrIndex?: symbol | string | number,
   ) {
     if (isUndefined(param)) {
       this.logger.log(
@@ -341,23 +435,23 @@ export class Injector {
 
   public resolveParamToken<T>(
     wrapper: InstanceWrapper<T>,
-    param: Type<any> | string | symbol | any,
+    param: Type<any> | string | symbol | ForwardReference,
   ) {
-    if (!param.forwardRef) {
-      return param;
+    if (typeof param === 'object' && 'forwardRef' in param) {
+      wrapper.forwardRef = true;
+      return param.forwardRef();
     }
-    wrapper.forwardRef = true;
-    return param.forwardRef();
+    return param;
   }
 
   public async resolveComponentInstance<T>(
     moduleRef: Module,
-    token: InstanceToken,
+    token: InjectionToken,
     dependencyContext: InjectorDependencyContext,
     wrapper: InstanceWrapper<T>,
     contextId = STATIC_CONTEXT,
     inquirer?: InstanceWrapper,
-    keyOrIndex?: string | number,
+    keyOrIndex?: symbol | string | number,
   ): Promise<InstanceWrapper> {
     this.printResolvingDependenciesLog(token, inquirer);
     this.printLookingForProviderLog(token, moduleRef);
@@ -388,11 +482,18 @@ export class Injector {
   ): Promise<InstanceWrapper> {
     const inquirerId = this.getInquirerId(inquirer);
     const instanceHost = instanceWrapper.getInstanceByContextId(
-      contextId,
+      this.getContextId(contextId, instanceWrapper),
       inquirerId,
     );
     if (!instanceHost.isResolved && !instanceWrapper.forwardRef) {
-      await this.loadProvider(instanceWrapper, moduleRef, contextId, inquirer);
+      inquirer?.settlementSignal?.insertRef(instanceWrapper.id);
+
+      await this.loadProvider(
+        instanceWrapper,
+        instanceWrapper.host ?? moduleRef,
+        contextId,
+        inquirer,
+      );
     } else if (
       !instanceHost.isResolved &&
       instanceWrapper.forwardRef &&
@@ -406,13 +507,13 @@ export class Injector {
        * instantiated beforehand.
        */
       instanceHost.donePromise &&
-        instanceHost.donePromise.then(() =>
+        void instanceHost.donePromise.then(() =>
           this.loadProvider(instanceWrapper, moduleRef, contextId, inquirer),
         );
     }
     if (instanceWrapper.async) {
       const host = instanceWrapper.getInstanceByContextId(
-        contextId,
+        this.getContextId(contextId, instanceWrapper),
         inquirerId,
       );
       host.instance = await host.instance;
@@ -428,20 +529,22 @@ export class Injector {
     wrapper: InstanceWrapper<T>,
     contextId = STATIC_CONTEXT,
     inquirer?: InstanceWrapper,
-    keyOrIndex?: string | number,
+    keyOrIndex?: symbol | string | number,
   ): Promise<InstanceWrapper<T>> {
+    const token = wrapper.token || wrapper.name;
     const { name } = dependencyContext;
-    if (wrapper && wrapper.name === name) {
+    if (wrapper && token === name) {
       throw new UnknownDependenciesException(
         wrapper.name,
         dependencyContext,
         moduleRef,
+        { id: wrapper.id },
       );
     }
-    if (providers.has(name)) {
-      const instanceWrapper = providers.get(name);
+    if (name && providers.has(name)) {
+      const instanceWrapper = providers.get(name)!;
       this.printFoundInModuleLog(name, moduleRef);
-      this.addDependencyMetadata(keyOrIndex, wrapper, instanceWrapper);
+      this.addDependencyMetadata(keyOrIndex!, wrapper, instanceWrapper);
       return instanceWrapper;
     }
     return this.lookupComponentInParentModules(
@@ -460,11 +563,11 @@ export class Injector {
     wrapper: InstanceWrapper<T>,
     contextId = STATIC_CONTEXT,
     inquirer?: InstanceWrapper,
-    keyOrIndex?: string | number,
+    keyOrIndex?: symbol | string | number,
   ) {
     const instanceWrapper = await this.lookupComponentInImports(
       moduleRef,
-      dependencyContext.name,
+      dependencyContext.name!,
       wrapper,
       [],
       contextId,
@@ -476,6 +579,7 @@ export class Injector {
         wrapper.name,
         dependencyContext,
         moduleRef,
+        { id: wrapper.id },
       );
     }
     return instanceWrapper;
@@ -483,15 +587,15 @@ export class Injector {
 
   public async lookupComponentInImports(
     moduleRef: Module,
-    name: InstanceToken,
+    name: InjectionToken,
     wrapper: InstanceWrapper,
     moduleRegistry: any[] = [],
     contextId = STATIC_CONTEXT,
     inquirer?: InstanceWrapper,
-    keyOrIndex?: string | number,
+    keyOrIndex?: symbol | string | number,
     isTraversing?: boolean,
   ): Promise<any> {
-    let instanceWrapperRef: InstanceWrapper = null;
+    let instanceWrapperRef: InstanceWrapper | null = null;
     const imports = moduleRef.imports || new Set<Module>();
     const identity = (item: any) => item;
 
@@ -508,6 +612,7 @@ export class Injector {
       }
       this.printLookingForProviderLog(name, relatedModule);
       moduleRegistry.push(relatedModule.id);
+
       const { providers, exports } = relatedModule;
       if (!exports.has(name) || !providers.has(name)) {
         const instanceRef = await this.lookupComponentInImports(
@@ -521,21 +626,23 @@ export class Injector {
           true,
         );
         if (instanceRef) {
-          this.addDependencyMetadata(keyOrIndex, wrapper, instanceRef);
+          this.addDependencyMetadata(keyOrIndex!, wrapper, instanceRef);
           return instanceRef;
         }
         continue;
       }
       this.printFoundInModuleLog(name, relatedModule);
-      instanceWrapperRef = providers.get(name);
-      this.addDependencyMetadata(keyOrIndex, wrapper, instanceWrapperRef);
+      instanceWrapperRef = providers.get(name)!;
+      this.addDependencyMetadata(keyOrIndex!, wrapper, instanceWrapperRef);
 
       const inquirerId = this.getInquirerId(inquirer);
       const instanceHost = instanceWrapperRef.getInstanceByContextId(
-        contextId,
+        this.getContextId(contextId, instanceWrapperRef),
         inquirerId,
       );
       if (!instanceHost.isResolved && !instanceWrapperRef.forwardRef) {
+        wrapper.settlementSignal?.insertRef(instanceWrapperRef.id);
+
         await this.loadProvider(
           instanceWrapperRef,
           relatedModule,
@@ -576,7 +683,7 @@ export class Injector {
           }
           const paramWrapper = await this.resolveSingleParam<T>(
             wrapper,
-            item.name,
+            item.name as string,
             dependencyContext,
             moduleRef,
             contextId,
@@ -588,7 +695,7 @@ export class Injector {
           }
           const inquirerId = this.getInquirerId(inquirer);
           const instanceHost = paramWrapper.getInstanceByContextId(
-            contextId,
+            this.getContextId(contextId, paramWrapper),
             inquirerId,
           );
           return instanceHost.instance;
@@ -640,7 +747,7 @@ export class Injector {
     const { metatype, inject } = wrapper;
     const inquirerId = this.getInquirerId(inquirer);
     const instanceHost = targetMetatype.getInstanceByContextId(
-      contextId,
+      this.getContextId(contextId, targetMetatype),
       inquirerId,
     );
     const isInContext =
@@ -649,6 +756,11 @@ export class Injector {
       wrapper.isLazyTransient(contextId, inquirer) ||
       wrapper.isExplicitlyRequested(contextId, inquirer);
 
+    if (this.options?.preview && !wrapper.host?.initOnPreview) {
+      instanceHost.isResolved = true;
+      return instanceHost.instance;
+    }
+
     if (isNil(inject) && isInContext) {
       instanceHost.instance = wrapper.forwardRef
         ? Object.assign(
@@ -669,18 +781,21 @@ export class Injector {
   public async loadPerContext<T = any>(
     instance: T,
     moduleRef: Module,
-    collection: Map<InstanceToken, InstanceWrapper>,
+    collection: Map<InjectionToken, InstanceWrapper>,
     ctx: ContextId,
     wrapper?: InstanceWrapper,
   ): Promise<T> {
     if (!wrapper) {
-      const injectionToken = instance.constructor;
+      const injectionToken = (instance as any).constructor!;
       wrapper = collection.get(injectionToken);
     }
-    await this.loadInstance(wrapper, collection, moduleRef, ctx, wrapper);
-    await this.loadEnhancersPerContext(wrapper, ctx, wrapper);
+    await this.loadInstance(wrapper!, collection, moduleRef, ctx, wrapper);
+    await this.loadEnhancersPerContext(wrapper!, ctx, wrapper);
 
-    const host = wrapper.getInstanceByContextId(ctx, wrapper.id);
+    const host = wrapper!.getInstanceByContextId(
+      this.getContextId(ctx, wrapper!),
+      wrapper!.id,
+    );
     return host && (host.instance as T);
   }
 
@@ -691,7 +806,7 @@ export class Injector {
   ) {
     const enhancers = wrapper.getEnhancersMetadata() || [];
     const loadEnhancer = (item: InstanceWrapper) => {
-      const hostModule = item.host;
+      const hostModule = item.host!;
       return this.loadInstance(
         item,
         hostModule.injectables,
@@ -709,7 +824,7 @@ export class Injector {
     inquirer?: InstanceWrapper,
     parentInquirer?: InstanceWrapper,
   ): Promise<any[]> {
-    const hosts = await Promise.all(
+    const hosts: Array<InstanceWrapper<any> | undefined> = await Promise.all(
       metadata.map(async item =>
         this.resolveScopedComponentHost(
           item,
@@ -721,7 +836,11 @@ export class Injector {
     );
     const inquirerId = this.getInquirerId(inquirer);
     return hosts.map(
-      item => item.getInstanceByContextId(contextId, inquirerId).instance,
+      item =>
+        item?.getInstanceByContextId(
+          this.getContextId(contextId, item),
+          inquirerId,
+        ).instance,
     );
   }
 
@@ -734,7 +853,7 @@ export class Injector {
       metadata.map(async ({ wrapper: item, key }) => ({
         key,
         host: await this.resolveComponentHost(
-          item.host,
+          item.host!,
           item,
           contextId,
           inquirer,
@@ -745,12 +864,17 @@ export class Injector {
     return dependenciesHosts.map(({ key, host }) => ({
       key,
       name: key,
-      instance: host.getInstanceByContextId(contextId, inquirerId).instance,
+      instance: host.getInstanceByContextId(
+        this.getContextId(contextId, host),
+        inquirerId,
+      ).instance,
     }));
   }
 
-  private getInquirerId(inquirer: InstanceWrapper | undefined): string {
-    return inquirer && inquirer.id;
+  private getInquirerId(
+    inquirer: InstanceWrapper | undefined,
+  ): string | undefined {
+    return inquirer ? inquirer.id : undefined;
   }
 
   private resolveScopedComponentHost(
@@ -761,7 +885,7 @@ export class Injector {
   ) {
     return this.isInquirerRequest(item, parentInquirer)
       ? parentInquirer
-      : this.resolveComponentHost(item.host, item, contextId, inquirer);
+      : this.resolveComponentHost(item.host!, item, contextId, inquirer);
   }
 
   private isInquirerRequest(
@@ -779,21 +903,23 @@ export class Injector {
   }
 
   protected addDependencyMetadata(
-    keyOrIndex: number | string,
+    keyOrIndex: symbol | string | number,
     hostWrapper: InstanceWrapper,
     instanceWrapper: InstanceWrapper,
   ) {
-    isString(keyOrIndex)
-      ? hostWrapper.addPropertiesMetadata(keyOrIndex, instanceWrapper)
-      : hostWrapper.addCtorMetadata(keyOrIndex, instanceWrapper);
+    if (isSymbol(keyOrIndex) || isString(keyOrIndex)) {
+      hostWrapper.addPropertiesMetadata(keyOrIndex, instanceWrapper);
+    } else {
+      hostWrapper.addCtorMetadata(keyOrIndex, instanceWrapper);
+    }
   }
 
-  private getTokenName(token: InstanceToken): string {
+  private getTokenName(token: InjectionToken): string {
     return isFunction(token) ? (token as Function).name : token.toString();
   }
 
   private printResolvingDependenciesLog(
-    token: InstanceToken,
+    token: InjectionToken,
     inquirer?: InstanceWrapper,
   ): void {
     if (!this.isDebugMode()) {
@@ -814,7 +940,7 @@ export class Injector {
   }
 
   private printLookingForProviderLog(
-    token: InstanceToken,
+    token: InjectionToken,
     moduleRef: Module,
   ): void {
     if (!this.isDebugMode()) {
@@ -829,7 +955,10 @@ export class Injector {
     );
   }
 
-  private printFoundInModuleLog(token: InstanceToken, moduleRef: Module): void {
+  private printFoundInModuleLog(
+    token: InjectionToken,
+    moduleRef: Module,
+  ): void {
     if (!this.isDebugMode()) {
       return;
     }
@@ -845,4 +974,20 @@ export class Injector {
   private isDebugMode(): boolean {
     return !!process.env.NEST_DEBUG;
   }
+
+  private getContextId(
+    contextId: ContextId,
+    instanceWrapper: InstanceWrapper,
+  ): ContextId {
+    return contextId.getParent
+      ? contextId.getParent({
+          token: instanceWrapper.token,
+          isTreeDurable: instanceWrapper.isDependencyTreeDurable(),
+        })
+      : contextId;
+  }
+
+  private getNowTimestamp() {
+    return performance.now();
+  }
 }
diff --git a/packages/core/injector/inquirer/inquirer-providers.ts b/packages/core/injector/inquirer/inquirer-providers.ts
index 3f741802f..20a49d217 100644
--- a/packages/core/injector/inquirer/inquirer-providers.ts
+++ b/packages/core/injector/inquirer/inquirer-providers.ts
@@ -1,7 +1,6 @@
 import { Provider, Scope } from '@nestjs/common';
 import { INQUIRER } from './inquirer-constants';
 
-// eslint-disable-next-line @typescript-eslint/no-empty-function
 const noop = () => {};
 export const inquirerProvider: Provider = {
   provide: INQUIRER,
diff --git a/packages/core/injector/instance-links-host.ts b/packages/core/injector/instance-links-host.ts
index a07617d28..bd6839e30 100644
--- a/packages/core/injector/instance-links-host.ts
+++ b/packages/core/injector/instance-links-host.ts
@@ -1,34 +1,50 @@
+import { InjectionToken } from '@nestjs/common';
 import { isFunction } from '@nestjs/common/utils/shared.utils';
 import { UnknownElementException } from '../errors/exceptions/unknown-element.exception';
 import { NestContainer } from './container';
 import { InstanceWrapper } from './instance-wrapper';
-import { InstanceToken, Module } from './module';
+import { Module } from './module';
 
 type HostCollection = 'providers' | 'controllers' | 'injectables';
 
 export interface InstanceLink<T = any> {
-  token: InstanceToken;
+  token: InjectionToken;
   wrapperRef: InstanceWrapper<T>;
   collection: Map<any, InstanceWrapper>;
   moduleId: string;
 }
 
 export class InstanceLinksHost {
-  private readonly instanceLinks = new Map<InstanceToken, InstanceLink[]>();
+  private readonly instanceLinks = new Map<InjectionToken, InstanceLink[]>();
 
   constructor(private readonly container: NestContainer) {
     this.initialize();
   }
 
-  get<T = any>(token: InstanceToken, moduleId?: string): InstanceLink<T> {
-    const modulesMap = this.instanceLinks.get(token);
+  get<T = any>(token: InjectionToken): InstanceLink<T>;
+  get<T = any>(
+    token: InjectionToken,
+    options?: { moduleId?: string; each?: boolean },
+  ): InstanceLink<T> | Array<InstanceLink<T>>;
+  get<T = any>(
+    token: InjectionToken,
+    options: { moduleId?: string; each?: boolean } = {},
+  ): InstanceLink<T> | Array<InstanceLink<T>> {
+    const instanceLinksForGivenToken = this.instanceLinks.get(token);
 
-    if (!modulesMap) {
+    if (!instanceLinksForGivenToken) {
       throw new UnknownElementException(this.getInstanceNameByToken(token));
     }
-    const instanceLink = moduleId
-      ? modulesMap.find(item => item.moduleId === moduleId)
-      : modulesMap[modulesMap.length - 1];
+
+    if (options.each) {
+      return instanceLinksForGivenToken;
+    }
+
+    const instanceLink = options.moduleId
+      ? instanceLinksForGivenToken.find(
+          item => item.moduleId === options.moduleId,
+        )
+      : instanceLinksForGivenToken[instanceLinksForGivenToken.length - 1];
 
     if (!instanceLink) {
       throw new UnknownElementException(this.getInstanceNameByToken(token));
@@ -54,7 +70,7 @@ export class InstanceLinksHost {
 
   private addLink(
     wrapper: InstanceWrapper,
-    token: InstanceToken,
+    token: InjectionToken,
     moduleRef: Module,
     collectionName: HostCollection,
   ) {
@@ -72,7 +88,7 @@ export class InstanceLinksHost {
     }
   }
 
-  private getInstanceNameByToken(token: InstanceToken): string {
+  private getInstanceNameByToken(token: InjectionToken): string {
     return isFunction(token) ? (token as Function)?.name : (token as string);
   }
 }
diff --git a/packages/core/injector/instance-loader.ts b/packages/core/injector/instance-loader.ts
index 01df482f8..489ffdef4 100644
--- a/packages/core/injector/instance-loader.ts
+++ b/packages/core/injector/instance-loader.ts
@@ -1,26 +1,40 @@
-import { Logger } from '@nestjs/common';
+import { Logger, LoggerService } from '@nestjs/common';
 import { Controller } from '@nestjs/common/interfaces/controllers/controller.interface';
 import { Injectable } from '@nestjs/common/interfaces/injectable.interface';
 import { MODULE_INIT_MESSAGE } from '../helpers/messages';
+import { GraphInspector } from '../inspector/graph-inspector';
 import { NestContainer } from './container';
 import { Injector } from './injector';
-import { InternalCoreModule } from './internal-core-module';
+import { InternalCoreModule } from './internal-core-module/internal-core-module';
 import { Module } from './module';
 
-export class InstanceLoader {
-  protected readonly injector = new Injector();
+export class InstanceLoader<TInjector extends Injector = Injector> {
   constructor(
     protected readonly container: NestContainer,
-    private readonly logger = new Logger(InstanceLoader.name, {
+    protected readonly injector: TInjector,
+    protected readonly graphInspector: GraphInspector,
+    private logger: LoggerService = new Logger(InstanceLoader.name, {
       timestamp: true,
     }),
   ) {}
 
+  public setLogger(logger: Logger) {
+    this.logger = logger;
+  }
+
   public async createInstancesOfDependencies(
     modules: Map<string, Module> = this.container.getModules(),
   ) {
     this.createPrototypes(modules);
-    await this.createInstances(modules);
+
+    try {
+      await this.createInstances(modules);
+    } catch (err) {
+      this.graphInspector.inspectModules(modules);
+      this.graphInspector.registerPartial(err);
+      throw err;
+    }
+    this.graphInspector.inspectModules(modules);
   }
 
   private createPrototypes(modules: Map<string, Module>) {
@@ -38,7 +52,7 @@ export class InstanceLoader {
         await this.createInstancesOfInjectables(moduleRef);
         await this.createInstancesOfControllers(moduleRef);
 
-        const { name } = moduleRef.metatype;
+        const { name } = moduleRef;
         this.isModuleWhitelisted(name) &&
           this.logger.log(MODULE_INIT_MESSAGE`${name}`);
       }),
@@ -56,7 +70,10 @@ export class InstanceLoader {
     const { providers } = moduleRef;
     const wrappers = [...providers.values()];
     await Promise.all(
-      wrappers.map(item => this.injector.loadProvider(item, moduleRef)),
+      wrappers.map(async item => {
+        await this.injector.loadProvider(item, moduleRef);
+        this.graphInspector.inspectInstanceWrapper(item, moduleRef);
+      }),
     );
   }
 
@@ -71,7 +88,10 @@ export class InstanceLoader {
     const { controllers } = moduleRef;
     const wrappers = [...controllers.values()];
     await Promise.all(
-      wrappers.map(item => this.injector.loadController(item, moduleRef)),
+      wrappers.map(async item => {
+        await this.injector.loadController(item, moduleRef);
+        this.graphInspector.inspectInstanceWrapper(item, moduleRef);
+      }),
     );
   }
 
@@ -86,7 +106,10 @@ export class InstanceLoader {
     const { injectables } = moduleRef;
     const wrappers = [...injectables.values()];
     await Promise.all(
-      wrappers.map(item => this.injector.loadInjectable(item, moduleRef)),
+      wrappers.map(async item => {
+        await this.injector.loadInjectable(item, moduleRef);
+        this.graphInspector.inspectInstanceWrapper(item, moduleRef);
+      }),
     );
   }
 
diff --git a/packages/core/injector/instance-wrapper.ts b/packages/core/injector/instance-wrapper.ts
index 9d9d29579..7e55d10ef 100644
--- a/packages/core/injector/instance-wrapper.ts
+++ b/packages/core/injector/instance-wrapper.ts
@@ -1,30 +1,53 @@
-import { Provider, Scope, Type } from '@nestjs/common';
-import {
-  ClassProvider,
-  FactoryProvider,
-  ValueProvider,
-} from '@nestjs/common/interfaces';
+import { Logger, LoggerService, Provider, Scope, Type } from '@nestjs/common';
+import { EnhancerSubtype } from '@nestjs/common/constants';
+import { FactoryProvider, InjectionToken } from '@nestjs/common/interfaces';
+import { clc } from '@nestjs/common/utils/cli-colors.util';
 import { randomStringGenerator } from '@nestjs/common/utils/random-string-generator.util';
-import { isNil, isUndefined } from '@nestjs/common/utils/shared.utils';
+import {
+  isNil,
+  isString,
+  isUndefined,
+} from '@nestjs/common/utils/shared.utils';
 import { iterate } from 'iterare';
+import { UuidFactory } from '../inspector/uuid-factory';
 import { STATIC_CONTEXT } from './constants';
-import { InstanceToken, Module } from './module';
+import {
+  isClassProvider,
+  isFactoryProvider,
+  isValueProvider,
+} from './helpers/provider-classifier';
+import { Module } from './module';
+import { SettlementSignal } from './settlement-signal';
 
 export const INSTANCE_METADATA_SYMBOL = Symbol.for('instance_metadata:cache');
 export const INSTANCE_ID_SYMBOL = Symbol.for('instance_metadata:id');
 
+export interface HostComponentInfo {
+  /**
+   * Injection token (or class reference)
+   */
+  token: InjectionToken;
+  /**
+   * Flag that indicates whether DI subtree is durable
+   */
+  isTreeDurable: boolean;
+}
+
 export interface ContextId {
   readonly id: number;
+  payload?: unknown;
+  getParent?(info: HostComponentInfo): ContextId;
 }
 
 export interface InstancePerContext<T> {
   instance: T;
   isResolved?: boolean;
   isPending?: boolean;
-  donePromise?: Promise<void>;
+  donePromise?: Promise<unknown>;
 }
+
 export interface PropertyMetadata {
-  key: string;
+  key: symbol | string;
   wrapper: InstanceWrapper;
 }
 
@@ -36,15 +59,20 @@ interface InstanceMetadataStore {
 
 export class InstanceWrapper<T = any> {
   public readonly name: any;
-  public readonly token: InstanceToken;
+  public readonly token: InjectionToken;
   public readonly async?: boolean;
   public readonly host?: Module;
   public readonly isAlias: boolean = false;
-
+  public readonly subtype?: EnhancerSubtype;
   public scope?: Scope = Scope.DEFAULT;
-  public metatype: Type<T> | Function;
-  public inject?: (string | symbol | Function | Type<any>)[];
+  public metatype: Type<T> | Function | null;
+  public inject?: FactoryProvider['inject'] | null;
   public forwardRef?: boolean;
+  public durable?: boolean;
+  public initTime?: number;
+  public settlementSignal?: SettlementSignal;
+
+  private static logger: LoggerService = new Logger(InstanceWrapper.name);
 
   private readonly values = new WeakMap<ContextId, InstancePerContext<T>>();
   private readonly [INSTANCE_METADATA_SYMBOL]: InstanceMetadataStore = {};
@@ -53,12 +81,14 @@ export class InstanceWrapper<T = any> {
     | Map<string, WeakMap<ContextId, InstancePerContext<T>>>
     | undefined;
   private isTreeStatic: boolean | undefined;
+  private isTreeDurable: boolean | undefined;
 
   constructor(
     metadata: Partial<InstanceWrapper<T>> & Partial<InstancePerContext<T>> = {},
   ) {
-    this[INSTANCE_ID_SYMBOL] = randomStringGenerator();
     this.initialize(metadata);
+    this[INSTANCE_ID_SYMBOL] =
+      metadata[INSTANCE_ID_SYMBOL] ?? this.generateUuid();
   }
 
   get id(): string {
@@ -75,8 +105,11 @@ export class InstanceWrapper<T = any> {
   }
 
   get isNotMetatype(): boolean {
-    const isFactory = this.metatype && !isNil(this.inject);
-    return !this.metatype || isFactory;
+    return !this.metatype || this.isFactory;
+  }
+
+  get isFactory(): boolean {
+    return !!this.metatype && !isNil(this.inject);
   }
 
   get isTransient(): boolean {
@@ -100,10 +133,10 @@ export class InstanceWrapper<T = any> {
     contextId: ContextId,
     inquirerId: string,
   ): InstancePerContext<T> {
-    let collectionPerContext = this.transientMap.get(inquirerId);
+    let collectionPerContext = this.transientMap!.get(inquirerId);
     if (!collectionPerContext) {
       collectionPerContext = new WeakMap();
-      this.transientMap.set(inquirerId, collectionPerContext);
+      this.transientMap!.set(inquirerId, collectionPerContext);
     }
     const instancePerContext = collectionPerContext.get(contextId);
     return instancePerContext
@@ -127,14 +160,29 @@ export class InstanceWrapper<T = any> {
     inquirerId: string,
     value: InstancePerContext<T>,
   ) {
-    let collection = this.transientMap.get(inquirerId);
+    let collection = this.transientMap!.get(inquirerId);
     if (!collection) {
       collection = new WeakMap();
-      this.transientMap.set(inquirerId, collection);
+      this.transientMap!.set(inquirerId, collection);
     }
     collection.set(contextId, value);
   }
 
+  public removeInstanceByContextId(contextId: ContextId, inquirerId?: string) {
+    if (this.scope === Scope.TRANSIENT && inquirerId) {
+      return this.removeInstanceByInquirerId(contextId, inquirerId);
+    }
+    this.values.delete(contextId);
+  }
+
+  public removeInstanceByInquirerId(contextId: ContextId, inquirerId: string) {
+    const collection = this.transientMap!.get(inquirerId);
+    if (!collection) {
+      return;
+    }
+    collection.delete(contextId);
+  }
+
   public addCtorMetadata(index: number, wrapper: InstanceWrapper) {
     if (!this[INSTANCE_METADATA_SYMBOL].dependencies) {
       this[INSTANCE_METADATA_SYMBOL].dependencies = [];
@@ -143,10 +191,10 @@ export class InstanceWrapper<T = any> {
   }
 
   public getCtorMetadata(): InstanceWrapper[] {
-    return this[INSTANCE_METADATA_SYMBOL].dependencies;
+    return this[INSTANCE_METADATA_SYMBOL].dependencies!;
   }
 
-  public addPropertiesMetadata(key: string, wrapper: InstanceWrapper) {
+  public addPropertiesMetadata(key: symbol | string, wrapper: InstanceWrapper) {
     if (!this[INSTANCE_METADATA_SYMBOL].properties) {
       this[INSTANCE_METADATA_SYMBOL].properties = [];
     }
@@ -157,7 +205,7 @@ export class InstanceWrapper<T = any> {
   }
 
   public getPropertiesMetadata(): PropertyMetadata[] {
-    return this[INSTANCE_METADATA_SYMBOL].properties;
+    return this[INSTANCE_METADATA_SYMBOL].properties!;
   }
 
   public addEnhancerMetadata(wrapper: InstanceWrapper) {
@@ -168,41 +216,94 @@ export class InstanceWrapper<T = any> {
   }
 
   public getEnhancersMetadata(): InstanceWrapper[] {
-    return this[INSTANCE_METADATA_SYMBOL].enhancers;
+    return this[INSTANCE_METADATA_SYMBOL].enhancers!;
   }
 
-  public isDependencyTreeStatic(lookupRegistry: string[] = []): boolean {
-    if (!isUndefined(this.isTreeStatic)) {
-      return this.isTreeStatic;
+  public isDependencyTreeDurable(lookupRegistry: string[] = []): boolean {
+    if (!isUndefined(this.isTreeDurable)) {
+      return this.isTreeDurable;
     }
     if (this.scope === Scope.REQUEST) {
-      this.isTreeStatic = false;
-      return this.isTreeStatic;
+      this.isTreeDurable = this.durable === undefined ? false : this.durable;
+      if (this.isTreeDurable) {
+        this.printIntrospectedAsDurable();
+      }
+      return this.isTreeDurable;
+    }
+    const isStatic = this.isDependencyTreeStatic();
+    if (isStatic) {
+      return false;
     }
+
+    const isTreeNonDurable = this.introspectDepsAttribute(
+      (collection, registry) =>
+        collection.some(
+          (item: InstanceWrapper) =>
+            !item.isDependencyTreeStatic() &&
+            !item.isDependencyTreeDurable(registry),
+        ),
+      lookupRegistry,
+    );
+    this.isTreeDurable = !isTreeNonDurable;
+    if (this.isTreeDurable) {
+      this.printIntrospectedAsDurable();
+    }
+    return this.isTreeDurable;
+  }
+
+  public introspectDepsAttribute(
+    callback: (
+      collection: InstanceWrapper[],
+      lookupRegistry: string[],
+    ) => boolean,
+    lookupRegistry: string[] = [],
+  ): boolean {
     if (lookupRegistry.includes(this[INSTANCE_ID_SYMBOL])) {
-      return true;
+      return false;
     }
     lookupRegistry = lookupRegistry.concat(this[INSTANCE_ID_SYMBOL]);
 
     const { dependencies, properties, enhancers } =
       this[INSTANCE_METADATA_SYMBOL];
-    let isStatic =
-      (dependencies &&
-        this.isWrapperListStatic(dependencies, lookupRegistry)) ||
-      !dependencies;
 
-    if (!isStatic || !(properties || enhancers)) {
-      this.isTreeStatic = isStatic;
+    let introspectionResult = dependencies
+      ? callback(dependencies, lookupRegistry)
+      : false;
+
+    if (introspectionResult || !(properties || enhancers)) {
+      return introspectionResult;
+    }
+    introspectionResult = properties
+      ? callback(
+          properties.map(item => item.wrapper),
+          lookupRegistry,
+        )
+      : false;
+    if (introspectionResult || !enhancers) {
+      return introspectionResult;
+    }
+    return enhancers ? callback(enhancers, lookupRegistry) : false;
+  }
+
+  public isDependencyTreeStatic(lookupRegistry: string[] = []): boolean {
+    if (!isUndefined(this.isTreeStatic)) {
       return this.isTreeStatic;
     }
-    const propertiesHosts = (properties || []).map(item => item.wrapper);
-    isStatic =
-      isStatic && this.isWrapperListStatic(propertiesHosts, lookupRegistry);
-    if (!isStatic || !enhancers) {
-      this.isTreeStatic = isStatic;
+    if (this.scope === Scope.REQUEST) {
+      this.isTreeStatic = false;
+      this.printIntrospectedAsRequestScoped();
       return this.isTreeStatic;
     }
-    this.isTreeStatic = this.isWrapperListStatic(enhancers, lookupRegistry);
+    this.isTreeStatic = !this.introspectDepsAttribute(
+      (collection, registry) =>
+        collection.some(
+          (item: InstanceWrapper) => !item.isDependencyTreeStatic(registry),
+        ),
+      lookupRegistry,
+    );
+    if (!this.isTreeStatic) {
+      this.printIntrospectedAsRequestScoped();
+    }
     return this.isTreeStatic;
   }
 
@@ -213,12 +314,12 @@ export class InstanceWrapper<T = any> {
     }
     const instancePerContext: InstancePerContext<T> = {
       ...staticInstance,
-      instance: undefined,
+      instance: undefined!,
       isResolved: false,
       isPending: false,
     };
     if (this.isNewable()) {
-      instancePerContext.instance = Object.create(this.metatype.prototype);
+      instancePerContext.instance = Object.create(this.metatype!.prototype);
     }
     this.setInstanceByContextId(contextId, instancePerContext);
     return instancePerContext;
@@ -231,12 +332,12 @@ export class InstanceWrapper<T = any> {
     const staticInstance = this.getInstanceByContextId(STATIC_CONTEXT);
     const instancePerContext: InstancePerContext<T> = {
       ...staticInstance,
-      instance: undefined,
+      instance: undefined!,
       isResolved: false,
       isPending: false,
     };
     if (this.isNewable()) {
-      instancePerContext.instance = Object.create(this.metatype.prototype);
+      instancePerContext.instance = Object.create(this.metatype!.prototype);
     }
     this.setInstanceByInquirerId(contextId, inquirerId, instancePerContext);
     return instancePerContext;
@@ -247,12 +348,12 @@ export class InstanceWrapper<T = any> {
     if (!this.isNewable() || host.isResolved) {
       return;
     }
-    return Object.create(this.metatype.prototype);
+    return Object.create(this.metatype!.prototype);
   }
 
   public isInRequestScope(
     contextId: ContextId,
-    inquirer?: InstanceWrapper | undefined,
+    inquirer?: InstanceWrapper,
   ): boolean {
     const isDependencyTreeStatic = this.isDependencyTreeStatic();
 
@@ -267,8 +368,9 @@ export class InstanceWrapper<T = any> {
     contextId: ContextId,
     inquirer: InstanceWrapper | undefined,
   ): boolean {
-    const isInquirerRequestScoped =
-      inquirer && !inquirer.isDependencyTreeStatic();
+    const isInquirerRequestScoped = !!(
+      inquirer && !inquirer.isDependencyTreeStatic()
+    );
 
     return (
       this.isDependencyTreeStatic() &&
@@ -286,7 +388,7 @@ export class InstanceWrapper<T = any> {
     return (
       this.isDependencyTreeStatic() &&
       contextId !== STATIC_CONTEXT &&
-      (isSelfRequested || (inquirer && inquirer.scope === Scope.TRANSIENT))
+      (isSelfRequested || !!(inquirer && inquirer.scope === Scope.TRANSIENT))
     );
   }
 
@@ -318,22 +420,23 @@ export class InstanceWrapper<T = any> {
   }
 
   public mergeWith(provider: Provider) {
-    if (!isUndefined((provider as ValueProvider).useValue)) {
+    if (isValueProvider(provider)) {
       this.metatype = null;
       this.inject = null;
+
       this.scope = Scope.DEFAULT;
 
       this.setInstanceByContextId(STATIC_CONTEXT, {
-        instance: (provider as ValueProvider).useValue,
+        instance: provider.useValue,
         isResolved: true,
         isPending: false,
       });
-    } else if ((provider as ClassProvider).useClass) {
+    } else if (isClassProvider(provider)) {
       this.inject = null;
-      this.metatype = (provider as ClassProvider).useClass;
-    } else if ((provider as FactoryProvider).useFactory) {
-      this.metatype = (provider as FactoryProvider).useFactory;
-      this.inject = (provider as FactoryProvider).inject || [];
+      this.metatype = provider.useClass;
+    } else if (isFactoryProvider(provider)) {
+      this.metatype = provider.useFactory;
+      this.inject = provider.inject || [];
     }
   }
 
@@ -341,15 +444,6 @@ export class InstanceWrapper<T = any> {
     return isNil(this.inject) && this.metatype && this.metatype.prototype;
   }
 
-  private isWrapperListStatic(
-    tree: InstanceWrapper[],
-    lookupRegistry: string[],
-  ): boolean {
-    return tree.every((item: InstanceWrapper) =>
-      item.isDependencyTreeStatic(lookupRegistry),
-    );
-  }
-
   private initialize(
     metadata: Partial<InstanceWrapper<T>> & Partial<InstancePerContext<T>>,
   ) {
@@ -357,9 +451,46 @@ export class InstanceWrapper<T = any> {
     Object.assign(this, wrapperPartial);
 
     this.setInstanceByContextId(STATIC_CONTEXT, {
-      instance,
+      instance: instance as T,
       isResolved,
     });
     this.scope === Scope.TRANSIENT && (this.transientMap = new Map());
   }
+
+  private printIntrospectedAsRequestScoped() {
+    if (!this.isDebugMode() || this.name === 'REQUEST') {
+      return;
+    }
+    if (isString(this.name)) {
+      InstanceWrapper.logger.log(
+        `${clc.cyanBright(this.name)}${clc.green(
+          ' introspected as ',
+        )}${clc.magentaBright('request-scoped')}`,
+      );
+    }
+  }
+
+  private printIntrospectedAsDurable() {
+    if (!this.isDebugMode()) {
+      return;
+    }
+    if (isString(this.name)) {
+      InstanceWrapper.logger.log(
+        `${clc.cyanBright(this.name)}${clc.green(
+          ' introspected as ',
+        )}${clc.magentaBright('durable')}`,
+      );
+    }
+  }
+
+  private isDebugMode(): boolean {
+    return !!process.env.NEST_DEBUG;
+  }
+
+  private generateUuid(): string {
+    let key = this.name?.toString() ?? this.token?.toString();
+    key += this.host?.name ?? '';
+
+    return key ? UuidFactory.get(key) : randomStringGenerator();
+  }
 }
diff --git a/packages/core/injector/internal-core-module-factory.ts b/packages/core/injector/internal-core-module-factory.ts
deleted file mode 100644
index 99ecd589a..000000000
--- a/packages/core/injector/internal-core-module-factory.ts
+++ /dev/null
@@ -1,53 +0,0 @@
-import { Logger } from '@nestjs/common';
-import { ExternalContextCreator } from '../helpers/external-context-creator';
-import { HttpAdapterHost } from '../helpers/http-adapter-host';
-import { DependenciesScanner } from '../scanner';
-import { ModuleCompiler } from './compiler';
-import { NestContainer } from './container';
-import { InstanceLoader } from './instance-loader';
-import { InternalCoreModule } from './internal-core-module';
-import { LazyModuleLoader } from './lazy-module-loader';
-import { ModulesContainer } from './modules-container';
-
-export class InternalCoreModuleFactory {
-  static create(
-    container: NestContainer,
-    scanner: DependenciesScanner,
-    moduleCompiler: ModuleCompiler,
-    httpAdapterHost: HttpAdapterHost,
-  ) {
-    return InternalCoreModule.register([
-      {
-        provide: ExternalContextCreator,
-        useValue: ExternalContextCreator.fromContainer(container),
-      },
-      {
-        provide: ModulesContainer,
-        useValue: container.getModules(),
-      },
-      {
-        provide: HttpAdapterHost,
-        useValue: httpAdapterHost,
-      },
-      {
-        provide: HttpAdapterHost.name,
-        useExisting: HttpAdapterHost,
-      },
-      {
-        provide: LazyModuleLoader,
-        useFactory: () => {
-          const logger = new Logger(LazyModuleLoader.name, {
-            timestamp: false,
-          });
-          const instanceLoader = new InstanceLoader(container, logger);
-          return new LazyModuleLoader(
-            scanner,
-            instanceLoader,
-            moduleCompiler,
-            container.getModules(),
-          );
-        },
-      },
-    ]);
-  }
-}
diff --git a/packages/core/injector/internal-core-module/index.ts b/packages/core/injector/internal-core-module/index.ts
new file mode 100644
index 000000000..a863c2132
--- /dev/null
+++ b/packages/core/injector/internal-core-module/index.ts
@@ -0,0 +1 @@
+export * from './internal-core-module';
diff --git a/packages/core/injector/internal-core-module/internal-core-module-factory.ts b/packages/core/injector/internal-core-module/internal-core-module-factory.ts
new file mode 100644
index 000000000..e0727d18e
--- /dev/null
+++ b/packages/core/injector/internal-core-module/internal-core-module-factory.ts
@@ -0,0 +1,71 @@
+import { Logger } from '@nestjs/common';
+import { ExternalContextCreator } from '../../helpers/external-context-creator';
+import { HttpAdapterHost } from '../../helpers/http-adapter-host';
+import { GraphInspector } from '../../inspector/graph-inspector';
+import { InitializeOnPreviewAllowlist } from '../../inspector/initialize-on-preview.allowlist';
+import { SerializedGraph } from '../../inspector/serialized-graph';
+import { ModuleOverride } from '../../interfaces/module-override.interface';
+import { DependenciesScanner } from '../../scanner';
+import { ModuleCompiler } from '../compiler';
+import { NestContainer } from '../container';
+import { Injector } from '../injector';
+import { InstanceLoader } from '../instance-loader';
+import { LazyModuleLoader } from '../lazy-module-loader/lazy-module-loader';
+import { ModulesContainer } from '../modules-container';
+import { InternalCoreModule } from './internal-core-module';
+
+export class InternalCoreModuleFactory {
+  static create(
+    container: NestContainer,
+    scanner: DependenciesScanner,
+    moduleCompiler: ModuleCompiler,
+    httpAdapterHost: HttpAdapterHost,
+    graphInspector: GraphInspector,
+    moduleOverrides?: ModuleOverride[],
+  ) {
+    const lazyModuleLoaderFactory = () => {
+      const logger = new Logger(LazyModuleLoader.name, {
+        timestamp: false,
+      });
+      const injector = new Injector();
+      const instanceLoader = new InstanceLoader(
+        container,
+        injector,
+        graphInspector,
+        logger,
+      );
+      return new LazyModuleLoader(
+        scanner,
+        instanceLoader,
+        moduleCompiler,
+        container.getModules(),
+        moduleOverrides,
+      );
+    };
+
+    InitializeOnPreviewAllowlist.add(InternalCoreModule);
+
+    return InternalCoreModule.register([
+      {
+        provide: ExternalContextCreator,
+        useFactory: () => ExternalContextCreator.fromContainer(container),
+      },
+      {
+        provide: ModulesContainer,
+        useFactory: () => container.getModules(),
+      },
+      {
+        provide: HttpAdapterHost,
+        useFactory: () => httpAdapterHost,
+      },
+      {
+        provide: LazyModuleLoader,
+        useFactory: lazyModuleLoaderFactory,
+      },
+      {
+        provide: SerializedGraph,
+        useFactory: () => container.serializedGraph,
+      },
+    ]);
+  }
+}
diff --git a/packages/core/injector/internal-core-module.ts b/packages/core/injector/internal-core-module/internal-core-module.ts
similarity index 80%
rename from packages/core/injector/internal-core-module.ts
rename to packages/core/injector/internal-core-module/internal-core-module.ts
index 3e3a6156f..178818337 100644
--- a/packages/core/injector/internal-core-module.ts
+++ b/packages/core/injector/internal-core-module/internal-core-module.ts
@@ -4,9 +4,9 @@ import {
   FactoryProvider,
   ValueProvider,
 } from '@nestjs/common/interfaces';
-import { requestProvider } from '../router/request/request-providers';
-import { Reflector } from '../services';
-import { inquirerProvider } from './inquirer/inquirer-providers';
+import { requestProvider } from '../../router/request/request-providers';
+import { Reflector } from '../../services';
+import { inquirerProvider } from '../inquirer/inquirer-providers';
 
 const ReflectorAliasProvider = {
   provide: Reflector.name,
diff --git a/packages/core/injector/lazy-module-loader/lazy-module-loader-options.interface.ts b/packages/core/injector/lazy-module-loader/lazy-module-loader-options.interface.ts
new file mode 100644
index 000000000..db3a29575
--- /dev/null
+++ b/packages/core/injector/lazy-module-loader/lazy-module-loader-options.interface.ts
@@ -0,0 +1,6 @@
+export interface LazyModuleLoaderLoadOptions {
+  /**
+   * If `false`, no logs will be generated when loading some module lazily.
+   */
+  logger?: boolean;
+}
diff --git a/packages/core/injector/lazy-module-loader.ts b/packages/core/injector/lazy-module-loader/lazy-module-loader.ts
similarity index 60%
rename from packages/core/injector/lazy-module-loader.ts
rename to packages/core/injector/lazy-module-loader/lazy-module-loader.ts
index caba14116..b949a1b74 100644
--- a/packages/core/injector/lazy-module-loader.ts
+++ b/packages/core/injector/lazy-module-loader/lazy-module-loader.ts
@@ -1,10 +1,13 @@
 import { DynamicModule, Type } from '@nestjs/common';
-import { DependenciesScanner } from '../scanner';
-import { ModuleCompiler } from './compiler';
-import { InstanceLoader } from './instance-loader';
-import { Module } from './module';
-import { ModuleRef } from './module-ref';
-import { ModulesContainer } from './modules-container';
+import { ModuleOverride } from '../../interfaces/module-override.interface';
+import { DependenciesScanner } from '../../scanner';
+import { ModuleCompiler } from '../compiler';
+import { SilentLogger } from '../helpers/silent-logger';
+import { InstanceLoader } from '../instance-loader';
+import { Module } from '../module';
+import { ModuleRef } from '../module-ref';
+import { ModulesContainer } from '../modules-container';
+import { LazyModuleLoaderLoadOptions } from './lazy-module-loader-options.interface';
 
 export class LazyModuleLoader {
   constructor(
@@ -12,6 +15,7 @@ export class LazyModuleLoader {
     private readonly instanceLoader: InstanceLoader,
     private readonly moduleCompiler: ModuleCompiler,
     private readonly modulesContainer: ModulesContainer,
+    private readonly moduleOverrides?: ModuleOverride[],
   ) {}
 
   public async load(
@@ -19,18 +23,23 @@ export class LazyModuleLoader {
       | Promise<Type<unknown> | DynamicModule>
       | Type<unknown>
       | DynamicModule,
+    loadOpts?: LazyModuleLoaderLoadOptions,
   ): Promise<ModuleRef> {
+    this.registerLoggerConfiguration(loadOpts);
+
     const moduleClassOrDynamicDefinition = await loaderFn();
-    const moduleInstances = await this.dependenciesScanner.scanForModules(
-      moduleClassOrDynamicDefinition,
-    );
+    const moduleInstances = await this.dependenciesScanner.scanForModules({
+      moduleDefinition: moduleClassOrDynamicDefinition,
+      overrides: this.moduleOverrides,
+      lazy: true,
+    });
     if (moduleInstances.length === 0) {
       // The module has been loaded already. In this case, we must
-      // retrieve a module reference from the exising container.
+      // retrieve a module reference from the existing container.
       const { token } = await this.moduleCompiler.compile(
         moduleClassOrDynamicDefinition,
       );
-      const moduleInstance = this.modulesContainer.get(token);
+      const moduleInstance = this.modulesContainer.get(token)!;
       return moduleInstance && this.getTargetModuleRef(moduleInstance);
     }
     const lazyModulesContainer =
@@ -45,6 +54,12 @@ export class LazyModuleLoader {
     return this.getTargetModuleRef(targetModule);
   }
 
+  private registerLoggerConfiguration(loadOpts?: LazyModuleLoaderLoadOptions) {
+    if (loadOpts?.logger === false) {
+      this.instanceLoader.setLogger(new SilentLogger());
+    }
+  }
+
   private createLazyModulesContainer(
     moduleInstances: Module[],
   ): Map<string, Module> {
diff --git a/packages/core/injector/module-ref.ts b/packages/core/injector/module-ref.ts
index 22fe0f383..85de4b478 100644
--- a/packages/core/injector/module-ref.ts
+++ b/packages/core/injector/module-ref.ts
@@ -1,36 +1,137 @@
 import { IntrospectionResult, Scope, Type } from '@nestjs/common';
-import { InvalidClassScopeException } from '../errors/exceptions/invalid-class-scope.exception';
-import { UnknownElementException } from '../errors/exceptions/unknown-element.exception';
 import { getClassScope } from '../helpers/get-class-scope';
+import { isDurable } from '../helpers/is-durable';
+import { AbstractInstanceResolver } from './abstract-instance-resolver';
 import { NestContainer } from './container';
 import { Injector } from './injector';
 import { InstanceLinksHost } from './instance-links-host';
 import { ContextId, InstanceWrapper } from './instance-wrapper';
 import { Module } from './module';
 
-export abstract class ModuleRef {
-  private readonly injector = new Injector();
+export interface ModuleRefGetOrResolveOpts {
+  /**
+   * If enabled, lookup will only be performed in the host module.
+   * @default true
+   */
+  strict?: boolean;
+  /**
+   * If enabled, instead of returning a first instance registered under a given token,
+   * a list of instances will be returned.
+   * @default false
+   */
+  each?: boolean;
+}
+
+export abstract class ModuleRef extends AbstractInstanceResolver {
+  protected readonly injector = new Injector();
   private _instanceLinksHost: InstanceLinksHost;
 
-  private get instanceLinksHost() {
+  protected get instanceLinksHost() {
     if (!this._instanceLinksHost) {
       this._instanceLinksHost = new InstanceLinksHost(this.container);
     }
     return this._instanceLinksHost;
   }
 
-  constructor(protected readonly container: NestContainer) {}
+  constructor(protected readonly container: NestContainer) {
+    super();
+  }
 
-  public abstract get<TInput = any, TResult = TInput>(
+  /**
+   * Retrieves an instance of either injectable or controller, otherwise, throws exception.
+   * @returns {TResult}
+   */
+  abstract get<TInput = any, TResult = TInput>(
     typeOrToken: Type<TInput> | Function | string | symbol,
-    options?: { strict: boolean },
   ): TResult;
-  public abstract resolve<TInput = any, TResult = TInput>(
+  /**
+   * Retrieves an instance of either injectable or controller, otherwise, throws exception.
+   * @returns {TResult}
+   */
+  abstract get<TInput = any, TResult = TInput>(
     typeOrToken: Type<TInput> | Function | string | symbol,
-    contextId?: ContextId,
-    options?: { strict: boolean },
+    options: {
+      /**
+       * If enabled, lookup will only be performed in the host module.
+       * @default true
+       */
+      strict?: boolean;
+      /** This indicates that only the first instance registered will be returned. */
+      each?: undefined | false;
+    },
+  ): TResult;
+  /**
+   * Retrieves a list of instances of either injectables or controllers, otherwise, throws exception.
+   * @returns {Array<TResult>}
+   */
+  abstract get<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    options: {
+      /**
+       * If enabled, lookup will only be performed in the host module.
+       * @default true
+       */
+      strict?: boolean;
+      /** This indicates that a list of instances will be returned. */
+      each: true;
+    },
+  ): Array<TResult>;
+  /**
+   * Retrieves an instance (or a list of instances) of either injectable or controller, otherwise, throws exception.
+   * @returns {TResult | Array<TResult>}
+   */
+  abstract get<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    options?: ModuleRefGetOrResolveOpts,
+  ): TResult | Array<TResult>;
+
+  /**
+   * Resolves transient or request-scoped instance of either injectable or controller, otherwise, throws exception.
+   * @returns {Array<TResult>}
+   */
+  abstract resolve<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+  ): Promise<TResult>;
+  /**
+   * Resolves transient or request-scoped instance of either injectable or controller, otherwise, throws exception.
+   * @returns {Array<TResult>}
+   */
+  abstract resolve<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    contextId?: { id: number },
   ): Promise<TResult>;
-  public abstract create<T = any>(type: Type<T>): Promise<T>;
+  /**
+   * Resolves transient or request-scoped instance of either injectable or controller, otherwise, throws exception.
+   * @returns {Array<TResult>}
+   */
+  abstract resolve<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    contextId?: { id: number },
+    options?: { strict?: boolean; each?: undefined | false },
+  ): Promise<TResult>;
+  /**
+   * Resolves transient or request-scoped instances of either injectables or controllers, otherwise, throws exception.
+   * @returns {Array<TResult>}
+   */
+  abstract resolve<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    contextId?: { id: number },
+    options?: { strict?: boolean; each: true },
+  ): Promise<Array<TResult>>;
+  /**
+   * Resolves transient or request-scoped instance (or a list of instances) of either injectable or controller, otherwise, throws exception.
+   * @returns {Promise<TResult | Array<TResult>>}
+   */
+  abstract resolve<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    contextId?: { id: number },
+    options?: ModuleRefGetOrResolveOpts,
+  ): Promise<TResult | Array<TResult>>;
+
+  public abstract create<T = any>(
+    type: Type<T>,
+    contextId?: ContextId,
+  ): Promise<T>;
 
   public introspect<T = any>(
     token: Type<T> | string | symbol,
@@ -50,71 +151,29 @@ export abstract class ModuleRef {
     this.container.registerRequestProvider(request, contextId);
   }
 
-  protected find<TInput = any, TResult = TInput>(
-    typeOrToken: Type<TInput> | string | symbol,
-    contextModule?: Module,
-  ): TResult {
-    const moduleId = contextModule && contextModule.id;
-    const { wrapperRef } = this.instanceLinksHost.get<TResult>(
-      typeOrToken,
-      moduleId,
-    );
-    if (
-      wrapperRef.scope === Scope.REQUEST ||
-      wrapperRef.scope === Scope.TRANSIENT
-    ) {
-      throw new InvalidClassScopeException(typeOrToken);
-    }
-    return wrapperRef.instance;
-  }
-
-  protected async resolvePerContext<TInput = any, TResult = TInput>(
-    typeOrToken: Type<TInput> | string | symbol,
-    contextModule: Module,
-    contextId: ContextId,
-    options?: { strict: boolean },
-  ): Promise<TResult> {
-    const isStrictModeEnabled = options && options.strict;
-    const instanceLink = isStrictModeEnabled
-      ? this.instanceLinksHost.get(typeOrToken, contextModule.id)
-      : this.instanceLinksHost.get(typeOrToken);
-
-    const { wrapperRef, collection } = instanceLink;
-    if (wrapperRef.isDependencyTreeStatic() && !wrapperRef.isTransient) {
-      return this.get(typeOrToken, options);
-    }
-
-    const ctorHost = wrapperRef.instance || { constructor: typeOrToken };
-    const instance = await this.injector.loadPerContext(
-      ctorHost,
-      wrapperRef.host,
-      collection,
-      contextId,
-      wrapperRef,
-    );
-    if (!instance) {
-      throw new UnknownElementException();
-    }
-    return instance;
-  }
-
   protected async instantiateClass<T = any>(
     type: Type<T>,
     moduleRef: Module,
+    contextId?: ContextId,
   ): Promise<T> {
     const wrapper = new InstanceWrapper({
       name: type && type.name,
       metatype: type,
       isResolved: false,
       scope: getClassScope(type),
+      durable: isDurable(type),
       host: moduleRef,
     });
+
+    /* eslint-disable-next-line no-async-promise-executor */
     return new Promise<T>(async (resolve, reject) => {
       try {
         const callback = async (instances: any[]) => {
           const properties = await this.injector.resolveProperties(
             wrapper,
             moduleRef,
+            undefined,
+            contextId,
           );
           const instance = new type(...instances);
           this.injector.applyProperties(instance, properties);
@@ -125,6 +184,7 @@ export abstract class ModuleRef {
           moduleRef,
           undefined,
           callback,
+          contextId,
         );
       } catch (err) {
         reject(err);
diff --git a/packages/core/injector/module-token-factory.ts b/packages/core/injector/module-token-factory.ts
deleted file mode 100644
index 65409ad09..000000000
--- a/packages/core/injector/module-token-factory.ts
+++ /dev/null
@@ -1,63 +0,0 @@
-import { DynamicModule } from '@nestjs/common';
-import { Type } from '@nestjs/common/interfaces/type.interface';
-import { randomStringGenerator } from '@nestjs/common/utils/random-string-generator.util';
-import { isFunction, isSymbol } from '@nestjs/common/utils/shared.utils';
-import stringify from 'fast-safe-stringify';
-import * as hash from 'object-hash';
-
-export class ModuleTokenFactory {
-  private readonly moduleIdsCache = new WeakMap<Type<unknown>, string>();
-
-  public create(
-    metatype: Type<unknown>,
-    dynamicModuleMetadata?: Partial<DynamicModule> | undefined,
-  ): string {
-    const moduleId = this.getModuleId(metatype);
-    const opaqueToken = {
-      id: moduleId,
-      module: this.getModuleName(metatype),
-      dynamic: this.getDynamicMetadataToken(dynamicModuleMetadata),
-    };
-    return hash(opaqueToken, { ignoreUnknown: true });
-  }
-
-  public getDynamicMetadataToken(
-    dynamicModuleMetadata: Partial<DynamicModule> | undefined,
-  ): string {
-    // Uses safeStringify instead of JSON.stringify to support circular dynamic modules
-    // The replacer function is also required in order to obtain real class names
-    // instead of the unified "Function" key
-    return dynamicModuleMetadata
-      ? stringify(dynamicModuleMetadata, this.replacer)
-      : '';
-  }
-
-  public getModuleId(metatype: Type<unknown>): string {
-    let moduleId = this.moduleIdsCache.get(metatype);
-    if (moduleId) {
-      return moduleId;
-    }
-    moduleId = randomStringGenerator();
-    this.moduleIdsCache.set(metatype, moduleId);
-    return moduleId;
-  }
-
-  public getModuleName(metatype: Type<any>): string {
-    return metatype.name;
-  }
-
-  private replacer(key: string, value: any) {
-    if (isFunction(value)) {
-      const funcAsString = value.toString();
-      const isClass = /^class\s/.test(funcAsString);
-      if (isClass) {
-        return value.name;
-      }
-      return hash(funcAsString, { ignoreUnknown: true });
-    }
-    if (isSymbol(value)) {
-      return value.toString();
-    }
-    return value;
-  }
-}
diff --git a/packages/core/injector/module.ts b/packages/core/injector/module.ts
index ed3102a01..38dd79df7 100644
--- a/packages/core/injector/module.ts
+++ b/packages/core/injector/module.ts
@@ -1,64 +1,71 @@
 import {
-  Abstract,
+  EnhancerSubtype,
+  ENTRY_PROVIDER_WATERMARK,
+} from '@nestjs/common/constants';
+import {
   ClassProvider,
   Controller,
   DynamicModule,
   ExistingProvider,
   FactoryProvider,
   Injectable,
+  InjectionToken,
   NestModule,
   Provider,
+  Scope,
+  Type,
   ValueProvider,
 } from '@nestjs/common/interfaces';
-import { Type } from '@nestjs/common/interfaces/type.interface';
 import { randomStringGenerator } from '@nestjs/common/utils/random-string-generator.util';
 import {
   isFunction,
   isNil,
+  isObject,
   isString,
   isSymbol,
   isUndefined,
 } from '@nestjs/common/utils/shared.utils';
 import { iterate } from 'iterare';
 import { ApplicationConfig } from '../application-config';
-import { InvalidClassException } from '../errors/exceptions/invalid-class.exception';
-import { RuntimeException } from '../errors/exceptions/runtime.exception';
-import { UnknownExportException } from '../errors/exceptions/unknown-export.exception';
+import {
+  InvalidClassException,
+  RuntimeException,
+  UnknownExportException,
+} from '../errors/exceptions';
 import { createContextId } from '../helpers/context-id-factory';
 import { getClassScope } from '../helpers/get-class-scope';
+import { isDurable } from '../helpers/is-durable';
+import { UuidFactory } from '../inspector/uuid-factory';
 import { CONTROLLER_ID_KEY } from './constants';
 import { NestContainer } from './container';
-import { InstanceWrapper } from './instance-wrapper';
-import { ModuleRef } from './module-ref';
-
-export type InstanceToken =
-  | string
-  | symbol
-  | Type<any>
-  | Abstract<any>
-  | Function;
+import { ContextId, InstanceWrapper } from './instance-wrapper';
+import { ModuleRef, ModuleRefGetOrResolveOpts } from './module-ref';
 
 export class Module {
   private readonly _id: string;
   private readonly _imports = new Set<Module>();
   private readonly _providers = new Map<
-    InstanceToken,
+    InjectionToken,
     InstanceWrapper<Injectable>
   >();
   private readonly _injectables = new Map<
-    InstanceToken,
+    InjectionToken,
     InstanceWrapper<Injectable>
   >();
   private readonly _middlewares = new Map<
-    InstanceToken,
+    InjectionToken,
     InstanceWrapper<Injectable>
   >();
   private readonly _controllers = new Map<
-    InstanceToken,
+    InjectionToken,
     InstanceWrapper<Controller>
   >();
-  private readonly _exports = new Set<InstanceToken>();
+  private readonly _entryProviderKeys = new Set<InjectionToken>();
+  private readonly _exports = new Set<InjectionToken>();
+
   private _distance = 0;
+  private _initOnPreview = false;
+  private _isGlobal = false;
   private _token: string;
 
   constructor(
@@ -66,7 +73,7 @@ export class Module {
     private readonly container: NestContainer,
   ) {
     this.addCoreProviders();
-    this._id = randomStringGenerator();
+    this._id = this.generateUuid();
   }
 
   get id(): string {
@@ -81,48 +88,53 @@ export class Module {
     this._token = token;
   }
 
-  get providers(): Map<InstanceToken, InstanceWrapper<Injectable>> {
-    return this._providers;
+  get name() {
+    return this.metatype.name;
   }
 
-  get middlewares(): Map<InstanceToken, InstanceWrapper<Injectable>> {
-    return this._middlewares;
+  get isGlobal() {
+    return this._isGlobal;
   }
 
-  get imports(): Set<Module> {
-    return this._imports;
+  set isGlobal(global: boolean) {
+    this._isGlobal = global;
   }
 
-  /**
-   * Left for backward-compatibility reasons
-   */
-  get relatedModules(): Set<Module> {
-    return this._imports;
+  get initOnPreview() {
+    return this._initOnPreview;
   }
 
-  /**
-   * Left for backward-compatibility reasons
-   */
-  get components(): Map<InstanceToken, InstanceWrapper<Injectable>> {
+  set initOnPreview(initOnPreview: boolean) {
+    this._initOnPreview = initOnPreview;
+  }
+
+  get providers(): Map<InjectionToken, InstanceWrapper<Injectable>> {
     return this._providers;
   }
 
-  /**
-   * Left for backward-compatibility reasons
-   */
-  get routes(): Map<InstanceToken, InstanceWrapper<Controller>> {
-    return this._controllers;
+  get middlewares(): Map<InjectionToken, InstanceWrapper<Injectable>> {
+    return this._middlewares;
+  }
+
+  get imports(): Set<Module> {
+    return this._imports;
   }
 
-  get injectables(): Map<InstanceToken, InstanceWrapper<Injectable>> {
+  get injectables(): Map<InjectionToken, InstanceWrapper<Injectable>> {
     return this._injectables;
   }
 
-  get controllers(): Map<InstanceToken, InstanceWrapper<Controller>> {
+  get controllers(): Map<InjectionToken, InstanceWrapper<Controller>> {
     return this._controllers;
   }
 
-  get exports(): Set<InstanceToken> {
+  get entryProviders(): Array<InstanceWrapper<Injectable>> {
+    return Array.from(this._entryProviderKeys).map(
+      token => this.providers.get(token)!,
+    );
+  }
+
+  get exports(): Set<InjectionToken> {
     return this._exports;
   }
 
@@ -130,8 +142,8 @@ export class Module {
     if (!this._providers.has(this._metatype)) {
       throw new RuntimeException();
     }
-    const module = this._providers.get(this._metatype);
-    return module.instance as NestModule;
+    const moduleRef = this._providers.get(this._metatype);
+    return moduleRef!.instance as NestModule;
   }
 
   get metatype(): Type<any> {
@@ -196,10 +208,15 @@ export class Module {
 
   public addInjectable<T extends Injectable>(
     injectable: Provider,
+    enhancerSubtype: EnhancerSubtype,
     host?: Type<T>,
   ) {
     if (this.isCustomProvider(injectable)) {
-      return this.addCustomProvider(injectable, this._injectables);
+      return this.addCustomProvider(
+        injectable,
+        this._injectables,
+        enhancerSubtype,
+      );
     }
     let instanceWrapper = this.injectables.get(injectable);
     if (!instanceWrapper) {
@@ -210,6 +227,8 @@ export class Module {
         instance: null,
         isResolved: false,
         scope: getClassScope(injectable),
+        durable: isDurable(injectable),
+        subtype: enhancerSubtype,
         host: this,
       });
       this._injectables.set(injectable, instanceWrapper);
@@ -219,12 +238,27 @@ export class Module {
         this._controllers.get(host) || this._providers.get(host);
       hostWrapper && hostWrapper.addEnhancerMetadata(instanceWrapper);
     }
+    return instanceWrapper;
   }
 
-  public addProvider(provider: Provider) {
+  public addProvider(provider: Provider): InjectionToken;
+  public addProvider(
+    provider: Provider,
+    enhancerSubtype: EnhancerSubtype,
+  ): InjectionToken;
+  public addProvider(provider: Provider, enhancerSubtype?: EnhancerSubtype) {
     if (this.isCustomProvider(provider)) {
-      return this.addCustomProvider(provider, this._providers);
+      if (this.isEntryProvider(provider.provide)) {
+        this._entryProviderKeys.add(provider.provide);
+      }
+      return this.addCustomProvider(provider, this._providers, enhancerSubtype);
     }
+
+    const isAlreadyDeclared = this._providers.has(provider);
+    if (this.isTransientProvider(provider) && isAlreadyDeclared) {
+      return provider;
+    }
+
     this._providers.set(
       provider,
       new InstanceWrapper({
@@ -234,9 +268,15 @@ export class Module {
         instance: null,
         isResolved: false,
         scope: getClassScope(provider),
+        durable: isDurable(provider),
         host: this,
       }),
     );
+
+    if (this.isEntryProvider(provider)) {
+      this._entryProviderKeys.add(provider);
+    }
+
     return provider as Type<Injectable>;
   }
 
@@ -265,15 +305,16 @@ export class Module {
       | ValueProvider
       | ExistingProvider,
     collection: Map<Function | string | symbol, any>,
+    enhancerSubtype?: EnhancerSubtype,
   ) {
     if (this.isCustomClass(provider)) {
-      this.addCustomClass(provider, collection);
+      this.addCustomClass(provider, collection, enhancerSubtype);
     } else if (this.isCustomValue(provider)) {
-      this.addCustomValue(provider, collection);
+      this.addCustomValue(provider, collection, enhancerSubtype);
     } else if (this.isCustomFactory(provider)) {
-      this.addCustomFactory(provider, collection);
+      this.addCustomFactory(provider, collection, enhancerSubtype);
     } else if (this.isCustomUseExisting(provider)) {
-      this.addCustomUseExisting(provider, collection);
+      this.addCustomUseExisting(provider, collection, enhancerSubtype);
     }
     return provider.provide;
   }
@@ -283,7 +324,10 @@ export class Module {
   }
 
   public isCustomValue(provider: any): provider is ValueProvider {
-    return !isUndefined((provider as ValueProvider).useValue);
+    return (
+      isObject(provider) &&
+      Object.prototype.hasOwnProperty.call(provider, 'useValue')
+    );
   }
 
   public isCustomFactory(provider: any): provider is FactoryProvider {
@@ -300,24 +344,32 @@ export class Module {
 
   public addCustomClass(
     provider: ClassProvider,
-    collection: Map<InstanceToken, InstanceWrapper>,
+    collection: Map<InjectionToken, InstanceWrapper>,
+    enhancerSubtype?: EnhancerSubtype,
   ) {
-    let { scope } = provider;
+    let { scope, durable } = provider;
 
     const { useClass } = provider;
     if (isUndefined(scope)) {
       scope = getClassScope(useClass);
     }
+    if (isUndefined(durable)) {
+      durable = isDurable(useClass);
+    }
+
+    const token = provider.provide;
     collection.set(
-      provider.provide,
+      token,
       new InstanceWrapper({
-        token: provider.provide,
+        token,
         name: useClass?.name || useClass,
         metatype: useClass,
         instance: null,
         isResolved: false,
         scope,
+        durable,
         host: this,
+        subtype: enhancerSubtype,
       }),
     );
   }
@@ -325,6 +377,7 @@ export class Module {
   public addCustomValue(
     provider: ValueProvider,
     collection: Map<Function | string | symbol, InstanceWrapper>,
+    enhancerSubtype?: EnhancerSubtype,
   ) {
     const { useValue: value, provide: providerToken } = provider;
     collection.set(
@@ -332,11 +385,12 @@ export class Module {
       new InstanceWrapper({
         token: providerToken,
         name: (providerToken as Function)?.name || providerToken,
-        metatype: null,
+        metatype: null!,
         instance: value,
         isResolved: true,
         async: value instanceof Promise,
         host: this,
+        subtype: enhancerSubtype,
       }),
     );
   }
@@ -344,11 +398,13 @@ export class Module {
   public addCustomFactory(
     provider: FactoryProvider,
     collection: Map<Function | string | symbol, InstanceWrapper>,
+    enhancerSubtype?: EnhancerSubtype,
   ) {
     const {
       useFactory: factory,
       inject,
       scope,
+      durable,
       provide: providerToken,
     } = provider;
 
@@ -362,7 +418,9 @@ export class Module {
         isResolved: false,
         inject: inject || [],
         scope,
+        durable,
         host: this,
+        subtype: enhancerSubtype,
       }),
     );
   }
@@ -370,6 +428,7 @@ export class Module {
   public addCustomUseExisting(
     provider: ExistingProvider,
     collection: Map<Function | string | symbol, InstanceWrapper>,
+    enhancerSubtype?: EnhancerSubtype,
   ) {
     const { useExisting, provide: providerToken } = provider;
     collection.set(
@@ -383,6 +442,7 @@ export class Module {
         inject: [useExisting],
         host: this,
         isAlias: true,
+        subtype: enhancerSubtype,
       }),
     );
   }
@@ -390,7 +450,7 @@ export class Module {
   public addExportedProvider(
     provider: Provider | string | symbol | DynamicModule,
   ) {
-    const addExportedUnit = (token: InstanceToken) =>
+    const addExportedUnit = (token: InjectionToken) =>
       this._exports.add(this.validateExportedProvider(token));
 
     if (this.isCustomProvider(provider as any)) {
@@ -418,7 +478,7 @@ export class Module {
     this._exports.add(this.validateExportedProvider(provide));
   }
 
-  public validateExportedProvider(token: InstanceToken) {
+  public validateExportedProvider(token: InjectionToken) {
     if (this._providers.has(token)) {
       return token;
     }
@@ -443,9 +503,10 @@ export class Module {
         token: controller,
         name: controller.name,
         metatype: controller,
-        instance: null,
+        instance: null!,
         isResolved: false,
         scope: getClassScope(controller),
+        durable: isDurable(controller),
         host: this,
       }),
     );
@@ -462,39 +523,76 @@ export class Module {
     });
   }
 
+  public addImport(moduleRef: Module) {
+    this._imports.add(moduleRef);
+  }
+
+  /**
+   * @deprecated
+   */
   public addRelatedModule(module: Module) {
     this._imports.add(module);
   }
 
-  public replace(toReplace: InstanceToken, options: any) {
+  public replace(toReplace: InjectionToken, options: any) {
     if (options.isProvider && this.hasProvider(toReplace)) {
       const originalProvider = this._providers.get(toReplace);
 
-      return originalProvider.mergeWith({ provide: toReplace, ...options });
+      return originalProvider!.mergeWith({ provide: toReplace, ...options });
     } else if (!options.isProvider && this.hasInjectable(toReplace)) {
       const originalInjectable = this._injectables.get(toReplace);
 
-      return originalInjectable.mergeWith({
+      return originalInjectable!.mergeWith({
         provide: toReplace,
         ...options,
       });
     }
   }
 
-  public hasProvider(token: InstanceToken): boolean {
+  public hasProvider(token: InjectionToken): boolean {
     return this._providers.has(token);
   }
 
-  public hasInjectable(token: InstanceToken): boolean {
+  public hasInjectable(token: InjectionToken): boolean {
     return this._injectables.has(token);
   }
 
-  public getProviderByKey<T = any>(name: InstanceToken): InstanceWrapper<T> {
+  public getProviderByKey<T = any>(name: InjectionToken): InstanceWrapper<T> {
     return this._providers.get(name) as InstanceWrapper<T>;
   }
 
+  public getProviderById<T = any>(id: string): InstanceWrapper<T> | undefined {
+    return Array.from(this._providers.values()).find(
+      item => item.id === id,
+    ) as InstanceWrapper<T>;
+  }
+
+  public getControllerById<T = any>(
+    id: string,
+  ): InstanceWrapper<T> | undefined {
+    return Array.from(this._controllers.values()).find(
+      item => item.id === id,
+    ) as InstanceWrapper<T>;
+  }
+
+  public getInjectableById<T = any>(
+    id: string,
+  ): InstanceWrapper<T> | undefined {
+    return Array.from(this._injectables.values()).find(
+      item => item.id === id,
+    ) as InstanceWrapper<T>;
+  }
+
+  public getMiddlewareById<T = any>(
+    id: string,
+  ): InstanceWrapper<T> | undefined {
+    return Array.from(this._middlewares.values()).find(
+      item => item.id === id,
+    ) as InstanceWrapper<T>;
+  }
+
   public getNonAliasProviders(): Array<
-    [InstanceToken, InstanceWrapper<Injectable>]
+    [InjectionToken, InstanceWrapper<Injectable>]
   > {
     return [...this._providers].filter(([_, wrapper]) => !wrapper.isAlias);
   }
@@ -509,27 +607,68 @@ export class Module {
 
       public get<TInput = any, TResult = TInput>(
         typeOrToken: Type<TInput> | string | symbol,
-        options: { strict: boolean } = { strict: true },
-      ): TResult {
-        return !(options && options.strict)
-          ? this.find<TInput, TResult>(typeOrToken)
-          : this.find<TInput, TResult>(typeOrToken, self);
+        options: ModuleRefGetOrResolveOpts = {},
+      ): TResult | Array<TResult> {
+        options.strict ??= true;
+        options.each ??= false;
+
+        return this.find<TInput, TResult>(
+          typeOrToken,
+          options.strict
+            ? {
+                moduleId: self.id,
+                each: options.each,
+              }
+            : options,
+        );
       }
 
       public resolve<TInput = any, TResult = TInput>(
         typeOrToken: Type<TInput> | string | symbol,
         contextId = createContextId(),
-        options: { strict: boolean } = { strict: true },
-      ): Promise<TResult> {
-        return this.resolvePerContext(typeOrToken, self, contextId, options);
+        options: ModuleRefGetOrResolveOpts = {},
+      ): Promise<TResult | Array<TResult>> {
+        options.strict ??= true;
+        options.each ??= false;
+
+        return this.resolvePerContext<TInput, TResult>(
+          typeOrToken,
+          self,
+          contextId,
+          options,
+        );
       }
 
-      public async create<T = any>(type: Type<T>): Promise<T> {
+      public async create<T = any>(
+        type: Type<T>,
+        contextId?: ContextId,
+      ): Promise<T> {
         if (!(type && isFunction(type) && type.prototype)) {
           throw new InvalidClassException(type);
         }
-        return this.instantiateClass<T>(type, self);
+        return this.instantiateClass<T>(type, self, contextId);
       }
     };
   }
+
+  private isEntryProvider(metatype: InjectionToken): boolean {
+    return typeof metatype === 'function'
+      ? !!Reflect.getMetadata(ENTRY_PROVIDER_WATERMARK, metatype)
+      : false;
+  }
+
+  private generateUuid(): string {
+    const prefix = 'M_';
+    const key = this.token
+      ? this.token.includes(':')
+        ? this.token.split(':')[1]
+        : this.token
+      : this.name;
+
+    return key ? UuidFactory.get(`${prefix}_${key}`) : randomStringGenerator();
+  }
+
+  private isTransientProvider(provider: Type<any>): boolean {
+    return getClassScope(provider) === Scope.TRANSIENT;
+  }
 }
diff --git a/packages/core/injector/modules-container.ts b/packages/core/injector/modules-container.ts
index 8f1d9dec6..31777bec2 100644
--- a/packages/core/injector/modules-container.ts
+++ b/packages/core/injector/modules-container.ts
@@ -1,10 +1,14 @@
-import { v4 as uuid } from 'uuid';
+import { uid } from 'uid';
 import { Module } from './module';
 
 export class ModulesContainer extends Map<string, Module> {
-  private readonly _applicationId = uuid();
+  private readonly _applicationId = uid(21);
 
   get applicationId(): string {
     return this._applicationId;
   }
+
+  public getById(id: string): Module | undefined {
+    return Array.from(this.values()).find(moduleRef => moduleRef.id === id);
+  }
 }
diff --git a/packages/core/injector/opaque-key-factory/by-reference-module-opaque-key-factory.ts b/packages/core/injector/opaque-key-factory/by-reference-module-opaque-key-factory.ts
new file mode 100644
index 000000000..a5721fb32
--- /dev/null
+++ b/packages/core/injector/opaque-key-factory/by-reference-module-opaque-key-factory.ts
@@ -0,0 +1,63 @@
+import { DynamicModule } from '@nestjs/common/interfaces/modules/dynamic-module.interface';
+import { ForwardReference } from '@nestjs/common/interfaces/modules/forward-reference.interface';
+import { Type } from '@nestjs/common/interfaces/type.interface';
+import { randomStringGenerator } from '@nestjs/common/utils/random-string-generator.util';
+import { createHash } from 'crypto';
+import { ModuleOpaqueKeyFactory } from './interfaces/module-opaque-key-factory.interface';
+
+const K_MODULE_ID = Symbol('K_MODULE_ID');
+
+export class ByReferenceModuleOpaqueKeyFactory
+  implements ModuleOpaqueKeyFactory
+{
+  private readonly keyGenerationStrategy: 'random' | 'shallow';
+
+  constructor(options?: { keyGenerationStrategy: 'random' | 'shallow' }) {
+    this.keyGenerationStrategy = options?.keyGenerationStrategy ?? 'random';
+  }
+
+  public createForStatic(
+    moduleCls: Type,
+    originalRef: Type | ForwardReference = moduleCls,
+  ): string {
+    return this.getOrCreateModuleId(moduleCls, undefined, originalRef);
+  }
+
+  public createForDynamic(
+    moduleCls: Type<unknown>,
+    dynamicMetadata: Omit<DynamicModule, 'module'>,
+    originalRef: DynamicModule | ForwardReference,
+  ): string {
+    return this.getOrCreateModuleId(moduleCls, dynamicMetadata, originalRef);
+  }
+
+  private getOrCreateModuleId(
+    moduleCls: Type<unknown>,
+    dynamicMetadata: Partial<DynamicModule> | undefined,
+    originalRef: Type | DynamicModule | ForwardReference,
+  ): string {
+    if (originalRef[K_MODULE_ID]) {
+      return originalRef[K_MODULE_ID];
+    }
+
+    let moduleId: string;
+    if (this.keyGenerationStrategy === 'random') {
+      moduleId = this.generateRandomString();
+    } else {
+      moduleId = dynamicMetadata
+        ? `${this.generateRandomString()}:${this.hashString(moduleCls.name + JSON.stringify(dynamicMetadata))}`
+        : `${this.generateRandomString()}:${this.hashString(moduleCls.toString())}`;
+    }
+
+    originalRef[K_MODULE_ID] = moduleId;
+    return moduleId;
+  }
+
+  private hashString(value: string): string {
+    return createHash('sha256').update(value).digest('hex');
+  }
+
+  private generateRandomString(): string {
+    return randomStringGenerator();
+  }
+}
diff --git a/packages/core/injector/opaque-key-factory/deep-hashed-module-opaque-key-factory.ts b/packages/core/injector/opaque-key-factory/deep-hashed-module-opaque-key-factory.ts
new file mode 100644
index 000000000..52865dc4f
--- /dev/null
+++ b/packages/core/injector/opaque-key-factory/deep-hashed-module-opaque-key-factory.ts
@@ -0,0 +1,100 @@
+import { DynamicModule } from '@nestjs/common/interfaces/modules/dynamic-module.interface';
+import { Type } from '@nestjs/common/interfaces/type.interface';
+import { Logger } from '@nestjs/common/services/logger.service';
+import { randomStringGenerator } from '@nestjs/common/utils/random-string-generator.util';
+import { isFunction, isSymbol } from '@nestjs/common/utils/shared.utils';
+import { createHash } from 'crypto';
+import stringify from 'fast-safe-stringify';
+import { ModuleOpaqueKeyFactory } from './interfaces/module-opaque-key-factory.interface';
+
+const CLASS_STR = 'class ';
+const CLASS_STR_LEN = CLASS_STR.length;
+
+export class DeepHashedModuleOpaqueKeyFactory
+  implements ModuleOpaqueKeyFactory
+{
+  private readonly moduleIdsCache = new WeakMap<Type<unknown>, string>();
+  private readonly moduleTokenCache = new Map<string, string>();
+  private readonly logger = new Logger(DeepHashedModuleOpaqueKeyFactory.name, {
+    timestamp: true,
+  });
+
+  public createForStatic(moduleCls: Type): string {
+    const moduleId = this.getModuleId(moduleCls);
+    const moduleName = this.getModuleName(moduleCls);
+
+    const key = `${moduleId}_${moduleName}`;
+    if (this.moduleTokenCache.has(key)) {
+      return this.moduleTokenCache.get(key)!;
+    }
+
+    const hash = this.hashString(key);
+    this.moduleTokenCache.set(key, hash);
+    return hash;
+  }
+
+  public createForDynamic(
+    moduleCls: Type<unknown>,
+    dynamicMetadata: Omit<DynamicModule, 'module'>,
+  ): string {
+    const moduleId = this.getModuleId(moduleCls);
+    const moduleName = this.getModuleName(moduleCls);
+    const opaqueToken = {
+      id: moduleId,
+      module: moduleName,
+      dynamic: dynamicMetadata,
+    };
+    const start = performance.now();
+    const opaqueTokenString = this.getStringifiedOpaqueToken(opaqueToken);
+    const timeSpentInMs = performance.now() - start;
+
+    if (timeSpentInMs > 10) {
+      const formattedTimeSpent = timeSpentInMs.toFixed(2);
+      this.logger.warn(
+        `The module "${opaqueToken.module}" is taking ${formattedTimeSpent}ms to serialize, this may be caused by larger objects statically assigned to the module. Consider changing the "moduleIdGeneratorAlgorithm" option to "reference" to improve the performance.`,
+      );
+    }
+
+    return this.hashString(opaqueTokenString);
+  }
+
+  public getStringifiedOpaqueToken(opaqueToken: object | undefined): string {
+    // Uses safeStringify instead of JSON.stringify to support circular dynamic modules
+    // The replacer function is also required in order to obtain real class names
+    // instead of the unified "Function" key
+    return opaqueToken ? stringify(opaqueToken, this.replacer) : '';
+  }
+
+  public getModuleId(metatype: Type<unknown>): string {
+    let moduleId = this.moduleIdsCache.get(metatype);
+    if (moduleId) {
+      return moduleId;
+    }
+    moduleId = randomStringGenerator();
+    this.moduleIdsCache.set(metatype, moduleId);
+    return moduleId;
+  }
+
+  public getModuleName(metatype: Type<any>): string {
+    return metatype.name;
+  }
+
+  private hashString(value: string): string {
+    return createHash('sha256').update(value).digest('hex');
+  }
+
+  private replacer(key: string, value: any) {
+    if (isFunction(value)) {
+      const funcAsString = value.toString();
+      const isClass = funcAsString.slice(0, CLASS_STR_LEN) === CLASS_STR;
+      if (isClass) {
+        return value.name;
+      }
+      return funcAsString;
+    }
+    if (isSymbol(value)) {
+      return value.toString();
+    }
+    return value;
+  }
+}
diff --git a/packages/core/injector/opaque-key-factory/interfaces/module-opaque-key-factory.interface.ts b/packages/core/injector/opaque-key-factory/interfaces/module-opaque-key-factory.interface.ts
new file mode 100644
index 000000000..1b58a5fff
--- /dev/null
+++ b/packages/core/injector/opaque-key-factory/interfaces/module-opaque-key-factory.interface.ts
@@ -0,0 +1,26 @@
+import { DynamicModule } from '@nestjs/common/interfaces/modules/dynamic-module.interface';
+import { ForwardReference } from '@nestjs/common/interfaces/modules/forward-reference.interface';
+import { Type } from '@nestjs/common/interfaces/type.interface';
+
+export interface ModuleOpaqueKeyFactory {
+  /**
+   * Creates a unique opaque key for the given static module.
+   * @param moduleCls A static module class.
+   * @param originalRef Original object reference. In most cases, it's the same as `moduleCls`.
+   */
+  createForStatic(
+    moduleCls: Type,
+    originalRef: Type | ForwardReference,
+  ): string;
+  /**
+   * Creates a unique opaque key for the given dynamic module.
+   * @param moduleCls  A dynamic module class reference.
+   * @param dynamicMetadata Dynamic module metadata.
+   * @param originalRef Original object reference.
+   */
+  createForDynamic(
+    moduleCls: Type<unknown>,
+    dynamicMetadata: Omit<DynamicModule, 'module'>,
+    originalRef: DynamicModule | ForwardReference,
+  ): string;
+}
diff --git a/packages/core/injector/settlement-signal.ts b/packages/core/injector/settlement-signal.ts
new file mode 100644
index 000000000..871375a01
--- /dev/null
+++ b/packages/core/injector/settlement-signal.ts
@@ -0,0 +1,59 @@
+/**
+ * SettlementSignal is used to signal the resolution of a provider/instance.
+ * Calling `complete` or `error` will resolve the promise returned by `asPromise`.
+ * Can be used to detect circular dependencies.
+ */
+export class SettlementSignal {
+  private readonly _refs = new Set();
+  private readonly settledPromise: Promise<unknown>;
+  private settleFn!: (err?: unknown) => void;
+  private completed = false;
+
+  constructor() {
+    this.settledPromise = new Promise<unknown>(resolve => {
+      this.settleFn = resolve;
+    });
+  }
+
+  /**
+   * Resolves the promise returned by `asPromise`.
+   */
+  public complete() {
+    this.completed = true;
+    this.settleFn();
+  }
+
+  /**
+   * Rejects the promise returned by `asPromise` with the given error.
+   * @param err Error to reject the promise returned by `asPromise` with.
+   */
+  public error(err: unknown) {
+    this.completed = true;
+    this.settleFn(err);
+  }
+
+  /**
+   * Returns a promise that will be resolved when `complete` or `error` is called.
+   * @returns Promise that will be resolved when `complete` or `error` is called.
+   */
+  public asPromise() {
+    return this.settledPromise;
+  }
+
+  /**
+   * Inserts a wrapper id that the host of this signal depends on.
+   * @param wrapperId Wrapper id to insert.
+   */
+  public insertRef(wrapperId: string) {
+    this._refs.add(wrapperId);
+  }
+
+  /**
+   * Check if relationship is circular.
+   * @param wrapperId Wrapper id to check.
+   * @returns True if relationship is circular, false otherwise.
+   */
+  public isCycle(wrapperId: string) {
+    return !this.completed && this._refs.has(wrapperId);
+  }
+}
diff --git a/packages/core/inspector/deterministic-uuid-registry.ts b/packages/core/inspector/deterministic-uuid-registry.ts
new file mode 100644
index 000000000..352942cde
--- /dev/null
+++ b/packages/core/inspector/deterministic-uuid-registry.ts
@@ -0,0 +1,23 @@
+export class DeterministicUuidRegistry {
+  private static readonly registry = new Map<string, boolean>();
+
+  static get(str: string, inc = 0) {
+    const id = inc ? this.hashCode(`${str}_${inc}`) : this.hashCode(str);
+    if (this.registry.has(id)) {
+      return this.get(str, inc + 1);
+    }
+    this.registry.set(id, true);
+    return id;
+  }
+
+  static clear() {
+    this.registry.clear();
+  }
+
+  private static hashCode(s: string) {
+    let h = 0;
+    for (let i = 0; i < s.length; i++)
+      h = (Math.imul(31, h) + s.charCodeAt(i)) | 0;
+    return h.toString();
+  }
+}
diff --git a/packages/core/inspector/graph-inspector.ts b/packages/core/inspector/graph-inspector.ts
new file mode 100644
index 000000000..bf79028a6
--- /dev/null
+++ b/packages/core/inspector/graph-inspector.ts
@@ -0,0 +1,240 @@
+import { UnknownDependenciesException } from '../errors/exceptions/unknown-dependencies.exception';
+import { NestContainer } from '../injector/container';
+import { InstanceWrapper } from '../injector/instance-wrapper';
+import { Module } from '../injector/module';
+import { DeterministicUuidRegistry } from './deterministic-uuid-registry';
+import { EnhancerMetadataCacheEntry } from './interfaces/enhancer-metadata-cache-entry.interface';
+import { Entrypoint } from './interfaces/entrypoint.interface';
+import { OrphanedEnhancerDefinition } from './interfaces/extras.interface';
+import { ClassNode, Node } from './interfaces/node.interface';
+import { PartialGraphHost } from './partial-graph.host';
+import { SerializedGraph } from './serialized-graph';
+
+export class GraphInspector {
+  private readonly graph: SerializedGraph;
+  private readonly enhancersMetadataCache =
+    new Array<EnhancerMetadataCacheEntry>();
+
+  constructor(private readonly container: NestContainer) {
+    this.graph = container.serializedGraph;
+  }
+
+  public inspectModules(
+    modules: Map<string, Module> = this.container.getModules(),
+  ) {
+    for (const moduleRef of modules.values()) {
+      this.insertModuleNode(moduleRef);
+      this.insertClassNodes(moduleRef);
+      this.insertModuleToModuleEdges(moduleRef);
+    }
+
+    this.enhancersMetadataCache.forEach(entry =>
+      this.insertEnhancerEdge(entry),
+    );
+
+    DeterministicUuidRegistry.clear();
+  }
+
+  public registerPartial(error: unknown) {
+    this.graph.status = 'partial';
+
+    if (error instanceof UnknownDependenciesException) {
+      this.graph.metadata = {
+        cause: {
+          type: 'unknown-dependencies',
+          context: error.context,
+          moduleId: error.moduleRef?.id,
+          nodeId: error.metadata?.id,
+        },
+      };
+    } else {
+      this.graph.metadata = {
+        cause: {
+          type: 'unknown',
+          error,
+        },
+      };
+    }
+    PartialGraphHost.register(this.graph);
+  }
+
+  public inspectInstanceWrapper<T = any>(
+    source: InstanceWrapper<T>,
+    moduleRef: Module,
+  ) {
+    const ctorMetadata = source.getCtorMetadata();
+    ctorMetadata?.forEach((target, index) =>
+      this.insertClassToClassEdge(
+        source,
+        target,
+        moduleRef,
+        index,
+        'constructor',
+      ),
+    );
+
+    const propertiesMetadata = source.getPropertiesMetadata();
+    propertiesMetadata?.forEach(({ key, wrapper: target }) =>
+      this.insertClassToClassEdge(source, target, moduleRef, key, 'property'),
+    );
+  }
+
+  public insertEnhancerMetadataCache(entry: EnhancerMetadataCacheEntry) {
+    this.enhancersMetadataCache.push(entry);
+  }
+
+  public insertOrphanedEnhancer(entry: OrphanedEnhancerDefinition) {
+    this.graph.insertOrphanedEnhancer({
+      ...entry,
+      ref: entry.ref?.constructor?.name ?? 'Object',
+    });
+  }
+
+  public insertAttachedEnhancer(wrapper: InstanceWrapper) {
+    const existingNode = this.graph.getNodeById(wrapper.id)!;
+    existingNode.metadata.global = true;
+
+    this.graph.insertAttachedEnhancer(existingNode.id);
+  }
+
+  public insertEntrypointDefinition<T>(
+    definition: Entrypoint<T>,
+    parentId: string,
+  ) {
+    definition = {
+      ...definition,
+      id: `${definition.classNodeId}_${definition.methodName}`,
+    };
+    this.graph.insertEntrypoint(definition, parentId);
+  }
+
+  public insertClassNode(
+    moduleRef: Module,
+    wrapper: InstanceWrapper,
+    type: Exclude<Node['metadata']['type'], 'module'>,
+  ) {
+    this.graph.insertNode({
+      id: wrapper.id,
+      label: wrapper.name,
+      parent: moduleRef.id,
+      metadata: {
+        type,
+        internal: wrapper.metatype === moduleRef.metatype,
+        sourceModuleName: moduleRef.name,
+        durable: wrapper.isDependencyTreeDurable(),
+        static: wrapper.isDependencyTreeStatic(),
+        scope: wrapper.scope!,
+        transient: wrapper.isTransient,
+        exported: moduleRef.exports.has(wrapper.token),
+        token: wrapper.token,
+        subtype: wrapper.subtype,
+        initTime: wrapper.initTime!,
+      },
+    });
+  }
+
+  private insertModuleNode(moduleRef: Module) {
+    const dynamicMetadata = this.container.getDynamicMetadataByToken(
+      moduleRef.token,
+    );
+    const node: Node = {
+      id: moduleRef.id,
+      label: moduleRef.name,
+      metadata: {
+        type: 'module',
+        global: moduleRef.isGlobal,
+        dynamic: !!dynamicMetadata,
+        internal: moduleRef.name === 'InternalCoreModule',
+      },
+    };
+    this.graph.insertNode(node);
+  }
+
+  private insertModuleToModuleEdges(moduleRef: Module) {
+    for (const targetModuleRef of moduleRef.imports) {
+      this.graph.insertEdge({
+        source: moduleRef.id,
+        target: targetModuleRef.id,
+        metadata: {
+          type: 'module-to-module',
+          sourceModuleName: moduleRef.name,
+          targetModuleName: targetModuleRef.name,
+        },
+      });
+    }
+  }
+
+  private insertEnhancerEdge(entry: EnhancerMetadataCacheEntry) {
+    const moduleRef = this.container.getModuleByKey(entry.moduleToken)!;
+    const sourceInstanceWrapper =
+      moduleRef.controllers.get(entry.classRef) ??
+      moduleRef.providers.get(entry.classRef)!;
+    const existingSourceNode = this.graph.getNodeById(
+      sourceInstanceWrapper.id,
+    ) as ClassNode;
+    const enhancers = existingSourceNode.metadata.enhancers ?? [];
+
+    if (entry.enhancerInstanceWrapper) {
+      this.insertClassToClassEdge(
+        sourceInstanceWrapper,
+        entry.enhancerInstanceWrapper,
+        moduleRef,
+        undefined,
+        'decorator',
+      );
+
+      enhancers.push({
+        id: entry.enhancerInstanceWrapper.id,
+        methodKey: entry.methodKey,
+        subtype: entry.subtype,
+      });
+    } else {
+      const name =
+        entry.enhancerRef!.constructor?.name ??
+        (entry.enhancerRef as Function).name;
+
+      enhancers.push({
+        name,
+        methodKey: entry.methodKey,
+        subtype: entry.subtype,
+      });
+    }
+    existingSourceNode.metadata.enhancers = enhancers;
+  }
+
+  private insertClassToClassEdge<T>(
+    source: InstanceWrapper<T>,
+    target: InstanceWrapper,
+    moduleRef: Module,
+    keyOrIndex: number | string | symbol | undefined,
+    injectionType: 'constructor' | 'property' | 'decorator',
+  ) {
+    this.graph.insertEdge({
+      source: source.id,
+      target: target.id,
+      metadata: {
+        type: 'class-to-class',
+        sourceModuleName: moduleRef.name,
+        sourceClassName: source.name,
+        targetClassName: target.name,
+        sourceClassToken: source.token,
+        targetClassToken: target.token,
+        targetModuleName: target.host?.name as string,
+        keyOrIndex,
+        injectionType,
+      },
+    });
+  }
+
+  private insertClassNodes(moduleRef: Module) {
+    moduleRef.providers.forEach(value =>
+      this.insertClassNode(moduleRef, value, 'provider'),
+    );
+    moduleRef.injectables.forEach(value =>
+      this.insertClassNode(moduleRef, value, 'injectable'),
+    );
+    moduleRef.controllers.forEach(value =>
+      this.insertClassNode(moduleRef, value, 'controller'),
+    );
+  }
+}
diff --git a/packages/core/inspector/index.ts b/packages/core/inspector/index.ts
new file mode 100644
index 000000000..db830f6e7
--- /dev/null
+++ b/packages/core/inspector/index.ts
@@ -0,0 +1,4 @@
+export * from './graph-inspector';
+export * from './initialize-on-preview.allowlist';
+export * from './partial-graph.host';
+export * from './serialized-graph';
diff --git a/packages/core/inspector/initialize-on-preview.allowlist.ts b/packages/core/inspector/initialize-on-preview.allowlist.ts
new file mode 100644
index 000000000..27d6ad593
--- /dev/null
+++ b/packages/core/inspector/initialize-on-preview.allowlist.ts
@@ -0,0 +1,13 @@
+import { Type } from '@nestjs/common';
+
+export class InitializeOnPreviewAllowlist {
+  private static readonly allowlist = new WeakMap<Type, boolean>();
+
+  public static add(type: Type) {
+    this.allowlist.set(type, true);
+  }
+
+  public static has(type: Type) {
+    return this.allowlist.has(type);
+  }
+}
diff --git a/packages/core/inspector/interfaces/edge.interface.ts b/packages/core/inspector/interfaces/edge.interface.ts
new file mode 100644
index 000000000..9151ab43b
--- /dev/null
+++ b/packages/core/inspector/interfaces/edge.interface.ts
@@ -0,0 +1,31 @@
+import { InjectionToken } from '@nestjs/common';
+
+type CommonEdgeMetadata = {
+  sourceModuleName: string;
+  targetModuleName: string;
+};
+
+type ModuleToModuleEdgeMetadata = {
+  type: 'module-to-module';
+} & CommonEdgeMetadata;
+
+type ClassToClassEdgeMetadata = {
+  type: 'class-to-class';
+  sourceClassName: string;
+  targetClassName: string;
+  sourceClassToken: InjectionToken;
+  targetClassToken: InjectionToken;
+  injectionType: 'constructor' | 'property' | 'decorator';
+  keyOrIndex?: string | number | symbol;
+  /**
+   * If true, indicates that this edge represents an internal providers connection
+   */
+  internal?: boolean;
+} & CommonEdgeMetadata;
+
+export interface Edge {
+  id: string;
+  source: string;
+  target: string;
+  metadata: ModuleToModuleEdgeMetadata | ClassToClassEdgeMetadata;
+}
diff --git a/packages/core/inspector/interfaces/enhancer-metadata-cache-entry.interface.ts b/packages/core/inspector/interfaces/enhancer-metadata-cache-entry.interface.ts
new file mode 100644
index 000000000..7f4574d94
--- /dev/null
+++ b/packages/core/inspector/interfaces/enhancer-metadata-cache-entry.interface.ts
@@ -0,0 +1,13 @@
+import { Type } from '@nestjs/common';
+import { EnhancerSubtype } from '@nestjs/common/constants';
+import { InstanceWrapper } from '../../injector/instance-wrapper';
+
+export interface EnhancerMetadataCacheEntry {
+  targetNodeId?: string;
+  moduleToken: string;
+  classRef: Type;
+  methodKey: string | undefined;
+  enhancerRef?: unknown;
+  enhancerInstanceWrapper?: InstanceWrapper;
+  subtype: EnhancerSubtype;
+}
diff --git a/packages/core/inspector/interfaces/entrypoint.interface.ts b/packages/core/inspector/interfaces/entrypoint.interface.ts
new file mode 100644
index 000000000..057c040c3
--- /dev/null
+++ b/packages/core/inspector/interfaces/entrypoint.interface.ts
@@ -0,0 +1,24 @@
+import { RequestMethod } from '@nestjs/common';
+import { VersionValue } from '@nestjs/common/interfaces';
+
+export type HttpEntrypointMetadata = {
+  path: string;
+  requestMethod: keyof typeof RequestMethod;
+  methodVersion?: VersionValue;
+  controllerVersion?: VersionValue;
+};
+
+export type MiddlewareEntrypointMetadata = {
+  path: string;
+  requestMethod: keyof typeof RequestMethod;
+  version?: VersionValue;
+};
+
+export type Entrypoint<T> = {
+  id?: string;
+  type: string;
+  methodName: string;
+  className: string;
+  classNodeId: string;
+  metadata: { key: string } & T;
+};
diff --git a/packages/core/inspector/interfaces/extras.interface.ts b/packages/core/inspector/interfaces/extras.interface.ts
new file mode 100644
index 000000000..37abd639f
--- /dev/null
+++ b/packages/core/inspector/interfaces/extras.interface.ts
@@ -0,0 +1,21 @@
+import { EnhancerSubtype } from '@nestjs/common/constants';
+
+/**
+ * Enhancers attached through APP_PIPE, APP_GUARD, APP_INTERCEPTOR, and APP_FILTER tokens.
+ */
+export interface AttachedEnhancerDefinition {
+  nodeId: string;
+}
+
+/**
+ * Enhancers registered through "app.useGlobalPipes()", "app.useGlobalGuards()", "app.useGlobalInterceptors()", and "app.useGlobalFilters()" methods.
+ */
+export interface OrphanedEnhancerDefinition {
+  subtype: EnhancerSubtype;
+  ref: unknown;
+}
+
+export interface Extras {
+  orphanedEnhancers: Array<OrphanedEnhancerDefinition>;
+  attachedEnhancers: Array<AttachedEnhancerDefinition>;
+}
diff --git a/packages/core/inspector/interfaces/node.interface.ts b/packages/core/inspector/interfaces/node.interface.ts
new file mode 100644
index 000000000..1d8589399
--- /dev/null
+++ b/packages/core/inspector/interfaces/node.interface.ts
@@ -0,0 +1,47 @@
+import { InjectionToken, Scope } from '@nestjs/common';
+import { EnhancerSubtype } from '@nestjs/common/constants';
+
+export type ModuleNode = {
+  metadata: {
+    type: 'module';
+    global: boolean;
+    dynamic: boolean;
+    internal: boolean;
+  };
+};
+
+export type ClassNode = {
+  parent: string;
+  metadata: {
+    type: 'provider' | 'controller' | 'middleware' | 'injectable';
+    subtype?: EnhancerSubtype;
+    sourceModuleName: string;
+    durable: boolean;
+    static: boolean;
+    transient: boolean;
+    exported: boolean;
+    scope: Scope;
+    token: InjectionToken;
+    initTime: number;
+    /**
+     * Enhancers metadata collection
+     */
+    enhancers?: Array<
+      | { id: string; subtype: EnhancerSubtype }
+      | { name: string; methodKey?: string; subtype: EnhancerSubtype }
+    >;
+    /**
+     * If true, node is a globally registered enhancer
+     */
+    global?: boolean;
+    /**
+     * If true, indicates that this node represents an internal provider
+     */
+    internal?: boolean;
+  };
+};
+
+export type Node = {
+  id: string;
+  label: string;
+} & (ClassNode | ModuleNode);
diff --git a/packages/core/inspector/interfaces/serialized-graph-json.interface.ts b/packages/core/inspector/interfaces/serialized-graph-json.interface.ts
new file mode 100644
index 000000000..9cd9d76cf
--- /dev/null
+++ b/packages/core/inspector/interfaces/serialized-graph-json.interface.ts
@@ -0,0 +1,15 @@
+import { SerializedGraphStatus } from '../serialized-graph';
+import { Edge } from './edge.interface';
+import { Entrypoint } from './entrypoint.interface';
+import { Extras } from './extras.interface';
+import { Node } from './node.interface';
+import { SerializedGraphMetadata } from './serialized-graph-metadata.interface';
+
+export interface SerializedGraphJson {
+  nodes: Record<string, Node>;
+  edges: Record<string, Edge>;
+  entrypoints: Record<string, Entrypoint<unknown>[]>;
+  extras: Extras;
+  status?: SerializedGraphStatus;
+  metadata?: SerializedGraphMetadata;
+}
diff --git a/packages/core/inspector/interfaces/serialized-graph-metadata.interface.ts b/packages/core/inspector/interfaces/serialized-graph-metadata.interface.ts
new file mode 100644
index 000000000..c88749d01
--- /dev/null
+++ b/packages/core/inspector/interfaces/serialized-graph-metadata.interface.ts
@@ -0,0 +1,11 @@
+import { InjectorDependencyContext } from '../../injector/injector';
+
+export interface SerializedGraphMetadata {
+  cause: {
+    type: 'unknown-dependencies' | 'unknown';
+    context?: InjectorDependencyContext;
+    moduleId?: string;
+    nodeId?: string;
+    error?: any;
+  };
+}
diff --git a/packages/core/inspector/noop-graph-inspector.ts b/packages/core/inspector/noop-graph-inspector.ts
new file mode 100644
index 000000000..ba48ce5d8
--- /dev/null
+++ b/packages/core/inspector/noop-graph-inspector.ts
@@ -0,0 +1,9 @@
+import { GraphInspector } from './graph-inspector';
+
+const noop = () => {};
+export const NoopGraphInspector: GraphInspector = new Proxy(
+  GraphInspector.prototype,
+  {
+    get: () => noop,
+  },
+);
diff --git a/packages/core/inspector/partial-graph.host.ts b/packages/core/inspector/partial-graph.host.ts
new file mode 100644
index 000000000..84ae71f51
--- /dev/null
+++ b/packages/core/inspector/partial-graph.host.ts
@@ -0,0 +1,17 @@
+import { SerializedGraph } from './serialized-graph';
+
+export class PartialGraphHost {
+  private static partialGraph: SerializedGraph;
+
+  static toJSON() {
+    return this.partialGraph?.toJSON();
+  }
+
+  static toString() {
+    return this.partialGraph?.toString();
+  }
+
+  static register(partialGraph: SerializedGraph) {
+    this.partialGraph = partialGraph;
+  }
+}
diff --git a/packages/core/inspector/serialized-graph.ts b/packages/core/inspector/serialized-graph.ts
new file mode 100644
index 000000000..a42716208
--- /dev/null
+++ b/packages/core/inspector/serialized-graph.ts
@@ -0,0 +1,157 @@
+import { InjectionToken } from '@nestjs/common';
+import { ApplicationConfig } from '../application-config';
+import { ExternalContextCreator } from '../helpers/external-context-creator';
+import { HttpAdapterHost } from '../helpers/http-adapter-host';
+import { INQUIRER } from '../injector/inquirer/inquirer-constants';
+import { LazyModuleLoader } from '../injector/lazy-module-loader/lazy-module-loader';
+import { ModuleRef } from '../injector/module-ref';
+import { ModulesContainer } from '../injector/modules-container';
+import { REQUEST } from '../router/request/request-constants';
+import { Reflector } from '../services/reflector.service';
+import { DeterministicUuidRegistry } from './deterministic-uuid-registry';
+import { Edge } from './interfaces/edge.interface';
+import { Entrypoint } from './interfaces/entrypoint.interface';
+import {
+  Extras,
+  OrphanedEnhancerDefinition,
+} from './interfaces/extras.interface';
+import { Node } from './interfaces/node.interface';
+import { SerializedGraphJson } from './interfaces/serialized-graph-json.interface';
+import { SerializedGraphMetadata } from './interfaces/serialized-graph-metadata.interface';
+
+export type SerializedGraphStatus = 'partial' | 'complete';
+type WithOptionalId<T extends Record<'id', string>> = Omit<T, 'id'> &
+  Partial<Pick<T, 'id'>>;
+
+export class SerializedGraph {
+  private readonly nodes = new Map<string, Node>();
+  private readonly edges = new Map<string, Edge>();
+  private readonly entrypoints = new Map<string, Entrypoint<unknown>[]>();
+  private readonly extras: Extras = {
+    orphanedEnhancers: [],
+    attachedEnhancers: [],
+  };
+  private _status: SerializedGraphStatus = 'complete';
+  private _metadata?: SerializedGraphMetadata;
+
+  private static readonly INTERNAL_PROVIDERS: Array<InjectionToken> = [
+    ApplicationConfig,
+    ModuleRef,
+    HttpAdapterHost,
+    LazyModuleLoader,
+    ExternalContextCreator,
+    ModulesContainer,
+    Reflector,
+    SerializedGraph,
+    HttpAdapterHost.name,
+    Reflector.name,
+    REQUEST,
+    INQUIRER,
+  ];
+
+  set status(status: SerializedGraphStatus) {
+    this._status = status;
+  }
+
+  set metadata(metadata: SerializedGraphMetadata) {
+    this._metadata = metadata;
+  }
+
+  public insertNode(nodeDefinition: Node) {
+    if (
+      nodeDefinition.metadata.type === 'provider' &&
+      SerializedGraph.INTERNAL_PROVIDERS.includes(nodeDefinition.metadata.token)
+    ) {
+      nodeDefinition.metadata = {
+        ...nodeDefinition.metadata,
+        internal: true,
+      };
+    }
+    if (this.nodes.has(nodeDefinition.id)) {
+      return this.nodes.get(nodeDefinition.id);
+    }
+    this.nodes.set(nodeDefinition.id, nodeDefinition);
+    return nodeDefinition;
+  }
+
+  public insertEdge(edgeDefinition: WithOptionalId<Edge>) {
+    if (
+      edgeDefinition.metadata.type === 'class-to-class' &&
+      (SerializedGraph.INTERNAL_PROVIDERS.includes(
+        edgeDefinition.metadata.sourceClassToken,
+      ) ||
+        SerializedGraph.INTERNAL_PROVIDERS.includes(
+          edgeDefinition.metadata.targetClassToken,
+        ))
+    ) {
+      edgeDefinition.metadata = {
+        ...edgeDefinition.metadata,
+        internal: true,
+      };
+    }
+    const id =
+      edgeDefinition.id ?? this.generateUuidByEdgeDefinition(edgeDefinition);
+    const edge = {
+      ...edgeDefinition,
+      id,
+    };
+    this.edges.set(id, edge);
+    return edge;
+  }
+
+  public insertEntrypoint<T>(definition: Entrypoint<T>, parentId: string) {
+    if (this.entrypoints.has(parentId)) {
+      const existingCollection = this.entrypoints.get(parentId)!;
+      existingCollection.push(definition);
+    } else {
+      this.entrypoints.set(parentId, [definition]);
+    }
+  }
+
+  public insertOrphanedEnhancer(entry: OrphanedEnhancerDefinition) {
+    this.extras.orphanedEnhancers.push(entry);
+  }
+
+  public insertAttachedEnhancer(nodeId: string) {
+    this.extras.attachedEnhancers.push({
+      nodeId,
+    });
+  }
+
+  public getNodeById(id: string) {
+    return this.nodes.get(id);
+  }
+
+  public toJSON(): SerializedGraphJson {
+    const json: SerializedGraphJson = {
+      nodes: Object.fromEntries(this.nodes),
+      edges: Object.fromEntries(this.edges),
+      entrypoints: Object.fromEntries(this.entrypoints),
+      extras: this.extras,
+    };
+
+    if (this._status) {
+      json['status'] = this._status;
+    }
+    if (this._metadata) {
+      json['metadata'] = this._metadata;
+    }
+    return json;
+  }
+
+  public toString() {
+    const replacer = (key: string, value: unknown) => {
+      if (typeof value === 'symbol') {
+        return value.toString();
+      }
+      return typeof value === 'function' ? (value.name ?? 'Function') : value;
+    };
+    return JSON.stringify(this.toJSON(), replacer, 2);
+  }
+
+  private generateUuidByEdgeDefinition(
+    edgeDefinition: WithOptionalId<Edge>,
+  ): string {
+    return DeterministicUuidRegistry.get(JSON.stringify(edgeDefinition));
+  }
+}
diff --git a/packages/core/inspector/uuid-factory.ts b/packages/core/inspector/uuid-factory.ts
new file mode 100644
index 000000000..1f89ad13d
--- /dev/null
+++ b/packages/core/inspector/uuid-factory.ts
@@ -0,0 +1,21 @@
+import { randomStringGenerator } from '@nestjs/common/utils/random-string-generator.util';
+import { DeterministicUuidRegistry } from './deterministic-uuid-registry';
+
+export enum UuidFactoryMode {
+  Random = 'random',
+  Deterministic = 'deterministic',
+}
+
+export class UuidFactory {
+  private static _mode = UuidFactoryMode.Random;
+
+  static set mode(value: UuidFactoryMode) {
+    this._mode = value;
+  }
+
+  static get(key = '') {
+    return this._mode === UuidFactoryMode.Deterministic
+      ? DeterministicUuidRegistry.get(key)
+      : randomStringGenerator();
+  }
+}
diff --git a/packages/core/interceptors/index.ts b/packages/core/interceptors/index.ts
new file mode 100644
index 000000000..7835bb29b
--- /dev/null
+++ b/packages/core/interceptors/index.ts
@@ -0,0 +1,2 @@
+export * from './interceptors-consumer';
+export * from './interceptors-context-creator';
diff --git a/packages/core/interceptors/interceptors-consumer.ts b/packages/core/interceptors/interceptors-consumer.ts
index bcf3a5921..5032e9323 100644
--- a/packages/core/interceptors/interceptors-consumer.ts
+++ b/packages/core/interceptors/interceptors-consumer.ts
@@ -5,7 +5,8 @@ import {
   Controller,
 } from '@nestjs/common/interfaces';
 import { isEmpty } from '@nestjs/common/utils/shared.utils';
-import { defer, from as fromPromise, Observable } from 'rxjs';
+import { AsyncResource } from 'async_hooks';
+import { Observable, defer, from as fromPromise } from 'rxjs';
 import { mergeAll, switchMap } from 'rxjs/operators';
 import { ExecutionContextHost } from '../helpers/execution-context-host';
 
@@ -22,21 +23,19 @@ export class InterceptorsConsumer {
       return next();
     }
     const context = this.createContext(args, instance, callback);
-    context.setType<TContext>(type);
+    context.setType<TContext>(type!);
 
-    const start$ = defer(() => this.transformDeferred(next));
-    const nextFn =
-      (i = 0) =>
-      async () => {
-        if (i >= interceptors.length) {
-          return start$;
-        }
-        const handler: CallHandler = {
-          handle: () => fromPromise(nextFn(i + 1)()).pipe(mergeAll()),
-        };
-        return interceptors[i].intercept(context, handler);
+    const nextFn = async (i = 0) => {
+      if (i >= interceptors.length) {
+        return defer(AsyncResource.bind(() => this.transformDeferred(next)));
+      }
+      const handler: CallHandler = {
+        handle: () =>
+          defer(AsyncResource.bind(() => nextFn(i + 1))).pipe(mergeAll()),
       };
-    return nextFn()();
+      return interceptors[i].intercept(context, handler);
+    };
+    return defer(() => nextFn()).pipe(mergeAll());
   }
 
   public createContext(
diff --git a/packages/core/interceptors/interceptors-context-creator.ts b/packages/core/interceptors/interceptors-context-creator.ts
index abc7dc903..a7bebc044 100644
--- a/packages/core/interceptors/interceptors-context-creator.ts
+++ b/packages/core/interceptors/interceptors-context-creator.ts
@@ -41,19 +41,19 @@ export class InterceptorsContextCreator extends ContextCreator {
     inquirerId?: string,
   ): R {
     if (isEmpty(metadata)) {
-      return [] as R;
+      return [] as any[] as R;
     }
     return iterate(metadata)
       .filter(
         interceptor =>
           interceptor && (interceptor.name || interceptor.intercept),
       )
-      .map(interceptor =>
-        this.getInterceptorInstance(interceptor, contextId, inquirerId),
+      .map(
+        interceptor =>
+          this.getInterceptorInstance(interceptor, contextId, inquirerId)!,
       )
-      .filter(
-        (interceptor: NestInterceptor) =>
-          interceptor && isFunction(interceptor.intercept),
+      .filter((interceptor: NestInterceptor) =>
+        interceptor ? isFunction(interceptor.intercept) : false,
       )
       .toArray() as R;
   }
@@ -63,7 +63,7 @@ export class InterceptorsContextCreator extends ContextCreator {
     contextId = STATIC_CONTEXT,
     inquirerId?: string,
   ): NestInterceptor | null {
-    const isObject = (metatype as NestInterceptor).intercept;
+    const isObject = !!(metatype as NestInterceptor).intercept;
     if (isObject) {
       return metatype as NestInterceptor;
     }
@@ -74,7 +74,7 @@ export class InterceptorsContextCreator extends ContextCreator {
       return null;
     }
     const instanceHost = instanceWrapper.getInstanceByContextId(
-      contextId,
+      this.getContextId(contextId, instanceWrapper),
       inquirerId,
     );
     return instanceHost && instanceHost.instance;
@@ -99,7 +99,7 @@ export class InterceptorsContextCreator extends ContextCreator {
     inquirerId?: string,
   ): T {
     if (!this.config) {
-      return [] as T;
+      return [] as unknown[] as T;
     }
     const globalInterceptors = this.config.getGlobalInterceptors() as T;
     if (contextId === STATIC_CONTEXT && !inquirerId) {
@@ -108,7 +108,12 @@ export class InterceptorsContextCreator extends ContextCreator {
     const scopedInterceptorWrappers =
       this.config.getGlobalRequestInterceptors() as InstanceWrapper[];
     const scopedInterceptors = iterate(scopedInterceptorWrappers)
-      .map(wrapper => wrapper.getInstanceByContextId(contextId, inquirerId))
+      .map(wrapper =>
+        wrapper.getInstanceByContextId(
+          this.getContextId(contextId, wrapper),
+          inquirerId,
+        ),
+      )
       .filter(host => !!host)
       .map(host => host.instance)
       .toArray();
diff --git a/packages/core/interfaces/module-definition.interface.ts b/packages/core/interfaces/module-definition.interface.ts
new file mode 100644
index 000000000..edeb8d60e
--- /dev/null
+++ b/packages/core/interfaces/module-definition.interface.ts
@@ -0,0 +1,8 @@
+import { DynamicModule, ForwardReference } from '@nestjs/common';
+import { Type } from '@nestjs/common/interfaces';
+
+export type ModuleDefinition =
+  | ForwardReference
+  | Type<unknown>
+  | DynamicModule
+  | Promise<DynamicModule>;
diff --git a/packages/core/interfaces/module-override.interface.ts b/packages/core/interfaces/module-override.interface.ts
new file mode 100644
index 000000000..c92dffb2d
--- /dev/null
+++ b/packages/core/interfaces/module-override.interface.ts
@@ -0,0 +1,6 @@
+import { ModuleDefinition } from './module-definition.interface';
+
+export interface ModuleOverride {
+  moduleToReplace: ModuleDefinition;
+  newModule: ModuleDefinition;
+}
diff --git a/packages/core/metadata-scanner.ts b/packages/core/metadata-scanner.ts
index 7365a7038..7c6a23266 100644
--- a/packages/core/metadata-scanner.ts
+++ b/packages/core/metadata-scanner.ts
@@ -4,36 +4,118 @@ import {
   isFunction,
   isNil,
 } from '@nestjs/common/utils/shared.utils';
-import { iterate } from 'iterare';
 
 export class MetadataScanner {
+  private readonly cachedScannedPrototypes: Map<object, string[]> = new Map();
+
+  /**
+   * @deprecated
+   * @see {@link getAllMethodNames}
+   * @see getAllMethodNames
+   */
   public scanFromPrototype<T extends Injectable, R = any>(
     instance: T,
-    prototype: object,
+    prototype: object | null,
     callback: (name: string) => R,
   ): R[] {
-    const methodNames = new Set(this.getAllFilteredMethodNames(prototype));
-    return iterate(methodNames)
-      .map(callback)
-      .filter(metadata => !isNil(metadata))
-      .toArray();
-  }
+    if (!prototype) {
+      return [];
+    }
+
+    const visitedNames = new Map<string, boolean>();
+    const result: R[] = [];
+
+    do {
+      for (const property of Object.getOwnPropertyNames(prototype)) {
+        if (visitedNames.has(property)) {
+          continue;
+        }
+
+        visitedNames.set(property, true);
+
+        // reason: https://github.com/nestjs/nest/pull/10821#issuecomment-1411916533
+        const descriptor = Object.getOwnPropertyDescriptor(
+          prototype,
+          property,
+        )!;
 
-  *getAllFilteredMethodNames(prototype: object): IterableIterator<string> {
-    const isMethod = (prop: string) => {
-      const descriptor = Object.getOwnPropertyDescriptor(prototype, prop);
-      if (descriptor.set || descriptor.get) {
-        return false;
+        if (
+          descriptor.set ||
+          descriptor.get ||
+          isConstructor(property) ||
+          !isFunction(prototype[property])
+        ) {
+          continue;
+        }
+
+        const value = callback(property);
+
+        if (isNil(value)) {
+          continue;
+        }
+
+        result.push(value);
       }
-      return !isConstructor(prop) && isFunction(prototype[prop]);
-    };
+    } while (
+      (prototype = Reflect.getPrototypeOf(prototype)) &&
+      prototype !== Object.prototype
+    );
+
+    return result;
+  }
+
+  /**
+   * @deprecated
+   * @see {@link getAllMethodNames}
+   * @see getAllMethodNames
+   */
+  public *getAllFilteredMethodNames(
+    prototype: object,
+  ): IterableIterator<string> {
+    yield* this.getAllMethodNames(prototype);
+  }
+
+  public getAllMethodNames(prototype: object | null): string[] {
+    if (!prototype) {
+      return [];
+    }
+
+    if (this.cachedScannedPrototypes.has(prototype)) {
+      return this.cachedScannedPrototypes.get(prototype)!;
+    }
+
+    const visitedNames = new Map<string, boolean>();
+    const result: string[] = [];
+
+    this.cachedScannedPrototypes.set(prototype, result);
+
     do {
-      yield* iterate(Object.getOwnPropertyNames(prototype))
-        .filter(isMethod)
-        .toArray();
+      for (const property of Object.getOwnPropertyNames(prototype)) {
+        if (visitedNames.has(property)) {
+          continue;
+        }
+
+        visitedNames.set(property, true);
+
+        // reason: https://github.com/nestjs/nest/pull/10821#issuecomment-1411916533
+        const descriptor = Object.getOwnPropertyDescriptor(prototype, property);
+
+        if (
+          descriptor!.set ||
+          descriptor!.get ||
+          isConstructor(property) ||
+          !isFunction(prototype[property])
+        ) {
+          continue;
+        }
+
+        result.push(property);
+      }
     } while (
       (prototype = Reflect.getPrototypeOf(prototype)) &&
       prototype !== Object.prototype
     );
+
+    return result;
   }
 }
diff --git a/packages/core/middleware/builder.ts b/packages/core/middleware/builder.ts
index d9d63f20f..3d423e160 100644
--- a/packages/core/middleware/builder.ts
+++ b/packages/core/middleware/builder.ts
@@ -1,4 +1,3 @@
-import { flatten } from '@nestjs/common/decorators/core/dependencies.decorator';
 import {
   HttpServer,
   MiddlewareConsumer,
@@ -6,10 +5,12 @@ import {
 } from '@nestjs/common/interfaces';
 import {
   MiddlewareConfigProxy,
+  MiddlewareConfiguration,
   RouteInfo,
 } from '@nestjs/common/interfaces/middleware';
-import { MiddlewareConfiguration } from '@nestjs/common/interfaces/middleware/middleware-configuration.interface';
+import { stripEndSlash } from '@nestjs/common/utils/shared.utils';
 import { iterate } from 'iterare';
+import { RouteInfoPathExtractor } from './route-info-path-extractor';
 import { RoutesMapper } from './routes-mapper';
 import { filterMiddleware } from './utils';
 
@@ -19,12 +20,17 @@ export class MiddlewareBuilder implements MiddlewareConsumer {
   constructor(
     private readonly routesMapper: RoutesMapper,
     private readonly httpAdapter: HttpServer,
+    private readonly routeInfoPathExtractor: RouteInfoPathExtractor,
   ) {}
 
   public apply(
-    ...middleware: Array<Type<any> | Function | any>
+    ...middleware: Array<Type<any> | Function | Array<Type<any> | Function>>
   ): MiddlewareConfigProxy {
-    return new MiddlewareBuilder.ConfigProxy(this, flatten(middleware));
+    return new MiddlewareBuilder.ConfigProxy(
+      this,
+      middleware.flat(),
+      this.routeInfoPathExtractor,
+    );
   }
 
   public build(): MiddlewareConfiguration[] {
@@ -40,7 +46,8 @@ export class MiddlewareBuilder implements MiddlewareConsumer {
 
     constructor(
       private readonly builder: MiddlewareBuilder,
-      private readonly middleware: Array<Type<any> | Function | any>,
+      private readonly middleware: Array<Type<any> | Function>,
+      private routeInfoPathExtractor: RouteInfoPathExtractor,
     ) {}
 
     public getExcludedRoutes(): RouteInfo[] {
@@ -50,7 +57,22 @@ export class MiddlewareBuilder implements MiddlewareConsumer {
     public exclude(
       ...routes: Array<string | RouteInfo>
     ): MiddlewareConfigProxy {
-      this.excludedRoutes = this.getRoutesFlatList(routes);
+      this.excludedRoutes = [
+        ...this.excludedRoutes,
+        ...this.getRoutesFlatList(routes).reduce((excludedRoutes, route) => {
+          for (const routePath of this.routeInfoPathExtractor.extractPathFrom(
+            route,
+          )) {
+            excludedRoutes.push({
+              ...route,
+              path: routePath,
+            });
+          }
+
+          return excludedRoutes;
+        }, [] as RouteInfo[]),
+      ];
+
       return this;
     }
 
@@ -59,7 +81,8 @@ export class MiddlewareBuilder implements MiddlewareConsumer {
     ): MiddlewareConsumer {
       const { middlewareCollection } = this.builder;
 
-      const forRoutes = this.getRoutesFlatList(routes);
+      const flattedRoutes = this.getRoutesFlatList(routes);
+      const forRoutes = this.removeOverlappedRoutes(flattedRoutes);
       const configuration = {
         middleware: filterMiddleware(
           this.middleware,
@@ -82,5 +105,35 @@ export class MiddlewareBuilder implements MiddlewareConsumer {
         .flatten()
         .toArray();
     }
+
+    private removeOverlappedRoutes(routes: RouteInfo[]) {
+      const regexMatchParams = /(:[^/]*)/g;
+      const wildcard = '([^/]*)';
+      const routesWithRegex = routes
+        .filter(route => route.path.includes(':'))
+        .map(route => ({
+          method: route.method,
+          path: route.path,
+          regex: new RegExp(
+            '^(' + route.path.replace(regexMatchParams, wildcard) + ')$',
+            'g',
+          ),
+        }));
+
+      return routes.filter(route => {
+        const isOverlapped = (item: { regex: RegExp } & RouteInfo): boolean => {
+          if (route.method !== item.method) {
+            return false;
+          }
+          const normalizedRoutePath = stripEndSlash(route.path);
+          return (
+            normalizedRoutePath !== item.path &&
+            item.regex.test(normalizedRoutePath)
+          );
+        };
+        const routeMatch = routesWithRegex.find(isOverlapped);
+        return routeMatch === undefined;
+      });
+    }
   };
 }
diff --git a/packages/core/middleware/container.ts b/packages/core/middleware/container.ts
index 326fc9089..a30a3fa2d 100644
--- a/packages/core/middleware/container.ts
+++ b/packages/core/middleware/container.ts
@@ -1,14 +1,14 @@
-import { Scope, Type } from '@nestjs/common';
-import { SCOPE_OPTIONS_METADATA } from '@nestjs/common/constants';
+import { InjectionToken, Type } from '@nestjs/common';
 import { MiddlewareConfiguration } from '@nestjs/common/interfaces/middleware/middleware-configuration.interface';
+import { getClassScope } from '../helpers/get-class-scope';
+import { isDurable } from '../helpers/is-durable';
 import { NestContainer } from '../injector/container';
 import { InstanceWrapper } from '../injector/instance-wrapper';
-import { InstanceToken } from '../injector/module';
 
 export class MiddlewareContainer {
   private readonly middleware = new Map<
     string,
-    Map<InstanceToken, InstanceWrapper>
+    Map<InjectionToken, InstanceWrapper>
   >();
   private readonly configurationSets = new Map<
     string,
@@ -19,12 +19,12 @@ export class MiddlewareContainer {
 
   public getMiddlewareCollection(
     moduleKey: string,
-  ): Map<InstanceToken, InstanceWrapper> {
+  ): Map<InjectionToken, InstanceWrapper> {
     if (!this.middleware.has(moduleKey)) {
-      const moduleRef = this.container.getModuleByKey(moduleKey);
+      const moduleRef = this.container.getModuleByKey(moduleKey)!;
       this.middleware.set(moduleKey, moduleRef.middlewares);
     }
-    return this.middleware.get(moduleKey);
+    return this.middleware.get(moduleKey)!;
   }
 
   public getConfigurations(): Map<string, Set<MiddlewareConfiguration>> {
@@ -36,7 +36,7 @@ export class MiddlewareContainer {
     moduleKey: string,
   ) {
     const middleware = this.getMiddlewareCollection(moduleKey);
-    const targetConfig = this.getTargetConfig(moduleKey);
+    const targetConfig = this.getTargetConfig(moduleKey)!;
 
     const configurations = configList || [];
     const insertMiddleware = <T extends Type<unknown>>(metatype: T) => {
@@ -44,8 +44,9 @@ export class MiddlewareContainer {
       middleware.set(
         token,
         new InstanceWrapper({
-          scope: this.getClassScope(metatype),
-          name: token,
+          scope: getClassScope(metatype),
+          durable: isDurable(metatype),
+          name: token?.name ?? token,
           metatype,
           token,
         }),
@@ -66,9 +67,4 @@ export class MiddlewareContainer {
     }
     return this.configurationSets.get(moduleName);
   }
-
-  private getClassScope<T = unknown>(type: Type<T>): Scope {
-    const metadata = Reflect.getMetadata(SCOPE_OPTIONS_METADATA, type);
-    return metadata && metadata.scope;
-  }
 }
diff --git a/packages/core/middleware/middleware-module.ts b/packages/core/middleware/middleware-module.ts
index 748887811..4f7a8796e 100644
--- a/packages/core/middleware/middleware-module.ts
+++ b/packages/core/middleware/middleware-module.ts
@@ -1,15 +1,12 @@
-import { HttpServer } from '@nestjs/common';
+import { HttpServer, InjectionToken, Logger } from '@nestjs/common';
 import { RequestMethod } from '@nestjs/common/enums/request-method.enum';
 import {
   MiddlewareConfiguration,
+  NestMiddleware,
   RouteInfo,
-} from '@nestjs/common/interfaces/middleware/middleware-configuration.interface';
-import { NestMiddleware } from '@nestjs/common/interfaces/middleware/nest-middleware.interface';
-import {
-  addLeadingSlash,
-  isUndefined,
-} from '@nestjs/common/utils/shared.utils';
-import { isRouteExcluded, isRequestMethodAll } from '../router/utils';
+} from '@nestjs/common/interfaces/middleware';
+import { NestApplicationContextOptions } from '@nestjs/common/interfaces/nest-application-context-options.interface';
+import { isUndefined } from '@nestjs/common/utils/shared.utils';
 import { ApplicationConfig } from '../application-config';
 import { InvalidMiddlewareException } from '../errors/exceptions/invalid-middleware.exception';
 import { RuntimeException } from '../errors/exceptions/runtime.exception';
@@ -18,27 +15,40 @@ import { ExecutionContextHost } from '../helpers/execution-context-host';
 import { STATIC_CONTEXT } from '../injector/constants';
 import { NestContainer } from '../injector/container';
 import { Injector } from '../injector/injector';
-import { InstanceWrapper } from '../injector/instance-wrapper';
-import { InstanceToken, Module } from '../injector/module';
+import { ContextId, InstanceWrapper } from '../injector/instance-wrapper';
+import { Module } from '../injector/module';
+import { GraphInspector } from '../inspector/graph-inspector';
+import {
+  Entrypoint,
+  MiddlewareEntrypointMetadata,
+} from '../inspector/interfaces/entrypoint.interface';
 import { REQUEST_CONTEXT_ID } from '../router/request/request-constants';
 import { RouterExceptionFilters } from '../router/router-exception-filters';
 import { RouterProxy } from '../router/router-proxy';
+import { isRequestMethodAll } from '../router/utils';
 import { MiddlewareBuilder } from './builder';
 import { MiddlewareContainer } from './container';
 import { MiddlewareResolver } from './resolver';
+import { RouteInfoPathExtractor } from './route-info-path-extractor';
 import { RoutesMapper } from './routes-mapper';
 
-export class MiddlewareModule {
+export class MiddlewareModule<
+  TAppOptions extends
+    NestApplicationContextOptions = NestApplicationContextOptions,
+> {
   private readonly routerProxy = new RouterProxy();
   private readonly exceptionFiltersCache = new WeakMap();
+  private readonly logger = new Logger(MiddlewareModule.name);
 
   private injector: Injector;
   private routerExceptionFilter: RouterExceptionFilters;
   private routesMapper: RoutesMapper;
   private resolver: MiddlewareResolver;
-  private config: ApplicationConfig;
   private container: NestContainer;
   private httpAdapter: HttpServer;
+  private graphInspector: GraphInspector;
+  private appOptions: TAppOptions;
+  private routeInfoPathExtractor: RouteInfoPathExtractor;
 
   public async register(
     middlewareContainer: MiddlewareContainer,
@@ -46,20 +56,24 @@ export class MiddlewareModule {
     config: ApplicationConfig,
     injector: Injector,
     httpAdapter: HttpServer,
+    graphInspector: GraphInspector,
+    options: TAppOptions,
   ) {
+    this.appOptions = options;
+
     const appRef = container.getHttpAdapterRef();
     this.routerExceptionFilter = new RouterExceptionFilters(
       container,
       config,
       appRef,
     );
-    this.routesMapper = new RoutesMapper(container);
-    this.resolver = new MiddlewareResolver(middlewareContainer);
-
-    this.config = config;
+    this.routesMapper = new RoutesMapper(container, config);
+    this.resolver = new MiddlewareResolver(middlewareContainer, injector);
+    this.routeInfoPathExtractor = new RouteInfoPathExtractor(config);
     this.injector = injector;
     this.container = container;
     this.httpAdapter = httpAdapter;
+    this.graphInspector = graphInspector;
 
     const modules = container.getModules();
     await this.resolveMiddleware(middlewareContainer, modules);
@@ -92,8 +106,19 @@ export class MiddlewareModule {
     const middlewareBuilder = new MiddlewareBuilder(
       this.routesMapper,
       this.httpAdapter,
+      this.routeInfoPathExtractor,
     );
-    await instance.configure(middlewareBuilder);
+    try {
+      await instance.configure(middlewareBuilder);
+    } catch (err) {
+      if (!this.appOptions.preview) {
+        throw err;
+      }
+      const warningMessage =
+        `Warning! "${moduleRef.name}" module exposes a "configure" method that throws an exception in the preview mode` +
+        ` (possibly due to missing dependencies). Note: you can ignore this message, just be aware that some of those conditional middlewares will not be reflected in your graph.`;
+      this.logger.warn(warningMessage);
+    }
 
     if (!(middlewareBuilder instanceof MiddlewareBuilder)) {
       return;
@@ -124,8 +149,8 @@ export class MiddlewareModule {
     const entriesSortedByDistance = [...configs.entries()].sort(
       ([moduleA], [moduleB]) => {
         return (
-          this.container.getModuleByKey(moduleA).distance -
-          this.container.getModuleByKey(moduleB).distance
+          this.container.getModuleByKey(moduleA)!.distance -
+          this.container.getModuleByKey(moduleB)!.distance
         );
       },
     );
@@ -160,22 +185,47 @@ export class MiddlewareModule {
     applicationRef: any,
   ) {
     const middlewareCollection = [].concat(config.middleware);
-    const moduleRef = this.container.getModuleByKey(moduleKey);
+    const moduleRef = this.container.getModuleByKey(moduleKey)!;
 
     for (const metatype of middlewareCollection) {
       const collection = middlewareContainer.getMiddlewareCollection(moduleKey);
       const instanceWrapper = collection.get(metatype);
+
       if (isUndefined(instanceWrapper)) {
         throw new RuntimeException();
       }
       if (instanceWrapper.isTransient) {
         return;
       }
+
+      this.graphInspector.insertClassNode(
+        moduleRef,
+        instanceWrapper,
+        'middleware',
+      );
+      const middlewareDefinition: Entrypoint<MiddlewareEntrypointMetadata> = {
+        type: 'middleware',
+        methodName: 'use',
+        className: instanceWrapper.name,
+        classNodeId: instanceWrapper.id,
+        metadata: {
+          key: routeInfo.path,
+          path: routeInfo.path,
+          requestMethod:
+            (RequestMethod[routeInfo.method] as keyof typeof RequestMethod) ??
+            'ALL',
+          version: routeInfo.version,
+        },
+      };
+      this.graphInspector.insertEntrypointDefinition(
+        middlewareDefinition,
+        instanceWrapper.id,
+      );
+
       await this.bindHandler(
         instanceWrapper,
         applicationRef,
-        routeInfo.method,
-        routeInfo.path,
+        routeInfo,
         moduleRef,
         collection,
       );
@@ -185,40 +235,33 @@ export class MiddlewareModule {
   private async bindHandler(
     wrapper: InstanceWrapper<NestMiddleware>,
     applicationRef: HttpServer,
-    method: RequestMethod,
-    path: string,
+    routeInfo: RouteInfo,
     moduleRef: Module,
-    collection: Map<InstanceToken, InstanceWrapper>,
+    collection: Map<InjectionToken, InstanceWrapper>,
   ) {
     const { instance, metatype } = wrapper;
+
     if (isUndefined(instance?.use)) {
-      throw new InvalidMiddlewareException(metatype.name);
+      throw new InvalidMiddlewareException(metatype!.name);
     }
     const isStatic = wrapper.isDependencyTreeStatic();
     if (isStatic) {
       const proxy = await this.createProxy(instance);
-      return this.registerHandler(applicationRef, method, path, proxy);
+      return this.registerHandler(applicationRef, routeInfo, proxy);
     }
+
+    const isTreeDurable = wrapper.isDependencyTreeDurable();
+
     await this.registerHandler(
       applicationRef,
-      method,
-      path,
+      routeInfo,
       async <TRequest, TResponse>(
         req: TRequest,
         res: TResponse,
         next: () => void,
       ) => {
         try {
-          const contextId = ContextIdFactory.getByRequest(req);
-          if (!req[REQUEST_CONTEXT_ID]) {
-            Object.defineProperty(req, REQUEST_CONTEXT_ID, {
-              value: contextId,
-              enumerable: false,
-              writable: false,
-              configurable: false,
-            });
-            this.container.registerRequestProvider(req, contextId);
-          }
+          const contextId = this.getContextId(req, isTreeDurable);
           const contextInstance = await this.injector.loadPerContext(
             instance,
             moduleRef,
@@ -263,47 +306,52 @@ export class MiddlewareModule {
 
   private async registerHandler(
     applicationRef: HttpServer,
-    method: RequestMethod,
-    path: string,
+    routeInfo: RouteInfo,
     proxy: <TRequest, TResponse>(
       req: TRequest,
       res: TResponse,
       next: () => void,
     ) => void,
   ) {
-    const prefix = this.config.getGlobalPrefix();
-    const excludedRoutes = this.config.getGlobalPrefixOptions().exclude;
-    if (
-      Array.isArray(excludedRoutes) &&
-      isRouteExcluded(excludedRoutes, path, method)
-    ) {
-      path = addLeadingSlash(path);
-    } else {
-      const basePath = addLeadingSlash(prefix);
-      if (basePath?.endsWith('/') && path?.startsWith('/')) {
-        // strip slash when a wildcard is being used
-        // and global prefix has been set
-        path = path?.slice(1);
-      }
-      path = basePath + path;
-    }
+    const { method } = routeInfo;
+    const paths = this.routeInfoPathExtractor.extractPathsFrom(routeInfo);
     const isMethodAll = isRequestMethodAll(method);
     const requestMethod = RequestMethod[method];
     const router = await applicationRef.createMiddlewareFactory(method);
-    router(
-      path,
-      isMethodAll
-        ? proxy
-        : <TRequest, TResponse>(
-            req: TRequest,
-            res: TResponse,
-            next: () => void,
-          ) => {
-            if (applicationRef.getRequestMethod(req) === requestMethod) {
-              return proxy(req, res, next);
-            }
-            return next();
-          },
-    );
+    const middlewareFunction = isMethodAll
+      ? proxy
+      : <TRequest, TResponse>(
+          req: TRequest,
+          res: TResponse,
+          next: () => void,
+        ) => {
+          if (applicationRef.getRequestMethod?.(req) === requestMethod) {
+            return proxy(req, res, next);
+          }
+          return next();
+        };
+    const pathsToApplyMiddleware = [] as string[];
+    paths.some(path => path.match(/^\/?$/))
+      ? pathsToApplyMiddleware.push('/')
+      : pathsToApplyMiddleware.push(...paths);
+    pathsToApplyMiddleware.forEach(path => router(path, middlewareFunction));
+  }
+
+  private getContextId(request: unknown, isTreeDurable: boolean): ContextId {
+    const contextId = ContextIdFactory.getByRequest(request as object);
+    if (!request![REQUEST_CONTEXT_ID]) {
+      Object.defineProperty(request, REQUEST_CONTEXT_ID, {
+        value: contextId,
+        enumerable: false,
+        writable: false,
+        configurable: false,
+      });
+
+      const requestProviderValue = isTreeDurable
+        ? contextId.payload
+        : Object.assign(request as object, contextId.payload);
+      this.container.registerRequestProvider(requestProviderValue, contextId);
+    }
+    return contextId;
   }
 }
diff --git a/packages/core/middleware/resolver.ts b/packages/core/middleware/resolver.ts
index 168cd00c0..99d02f418 100644
--- a/packages/core/middleware/resolver.ts
+++ b/packages/core/middleware/resolver.ts
@@ -1,26 +1,28 @@
+import { InjectionToken } from '@nestjs/common';
 import { Injector } from '../injector/injector';
 import { InstanceWrapper } from '../injector/instance-wrapper';
-import { InstanceToken, Module } from '../injector/module';
+import { Module } from '../injector/module';
 import { MiddlewareContainer } from './container';
 
 export class MiddlewareResolver {
-  private readonly instanceLoader = new Injector();
-
-  constructor(private readonly middlewareContainer: MiddlewareContainer) {}
+  constructor(
+    private readonly middlewareContainer: MiddlewareContainer,
+    private readonly injector: Injector,
+  ) {}
 
   public async resolveInstances(moduleRef: Module, moduleName: string) {
-    const middleware =
+    const middlewareMap =
       this.middlewareContainer.getMiddlewareCollection(moduleName);
     const resolveInstance = async (wrapper: InstanceWrapper) =>
-      this.resolveMiddlewareInstance(wrapper, middleware, moduleRef);
-    await Promise.all([...middleware.values()].map(resolveInstance));
+      this.resolveMiddlewareInstance(wrapper, middlewareMap, moduleRef);
+    await Promise.all([...middlewareMap.values()].map(resolveInstance));
   }
 
   private async resolveMiddlewareInstance(
     wrapper: InstanceWrapper,
-    middleware: Map<InstanceToken, InstanceWrapper>,
+    middlewareMap: Map<InjectionToken, InstanceWrapper>,
     moduleRef: Module,
   ) {
-    await this.instanceLoader.loadMiddleware(wrapper, middleware, moduleRef);
+    await this.injector.loadMiddleware(wrapper, middlewareMap, moduleRef);
   }
 }
diff --git a/packages/core/middleware/route-info-path-extractor.ts b/packages/core/middleware/route-info-path-extractor.ts
new file mode 100644
index 000000000..b8ef7b071
--- /dev/null
+++ b/packages/core/middleware/route-info-path-extractor.ts
@@ -0,0 +1,120 @@
+import { VersioningType } from '@nestjs/common';
+import {
+  RouteInfo,
+  VersioningOptions,
+  VersionValue,
+} from '@nestjs/common/interfaces';
+import {
+  addLeadingSlash,
+  stripEndSlash,
+} from '@nestjs/common/utils/shared.utils';
+import { ApplicationConfig } from '../application-config';
+import { ExcludeRouteMetadata } from '../router/interfaces/exclude-route-metadata.interface';
+import { isRouteExcluded } from '../router/utils';
+import { RoutePathFactory } from './../router/route-path-factory';
+
+export class RouteInfoPathExtractor {
+  private readonly routePathFactory: RoutePathFactory;
+  private readonly prefixPath: string;
+  private readonly excludedGlobalPrefixRoutes: ExcludeRouteMetadata[];
+  private readonly versioningConfig?: VersioningOptions;
+
+  constructor(private readonly applicationConfig: ApplicationConfig) {
+    this.routePathFactory = new RoutePathFactory(applicationConfig);
+    this.prefixPath = stripEndSlash(
+      addLeadingSlash(this.applicationConfig.getGlobalPrefix()),
+    );
+    this.excludedGlobalPrefixRoutes =
+      this.applicationConfig.getGlobalPrefixOptions().exclude!;
+    this.versioningConfig = this.applicationConfig.getVersioning();
+  }
+
+  public extractPathsFrom({ path, method, version }: RouteInfo): string[] {
+    const versionPaths = this.extractVersionPathFrom(version);
+
+    if (this.isAWildcard(path)) {
+      const entries =
+        versionPaths.length > 0
+          ? versionPaths
+              .map(versionPath => [
+                this.prefixPath + versionPath + '$',
+                this.prefixPath + versionPath + addLeadingSlash(path),
+              ])
+              .flat()
+          : this.prefixPath
+            ? [this.prefixPath + '$', this.prefixPath + addLeadingSlash(path)]
+            : [addLeadingSlash(path)];
+
+      return Array.isArray(this.excludedGlobalPrefixRoutes)
+        ? [
+            ...entries,
+            ...this.excludedGlobalPrefixRoutes
+              .map(route =>
+                Array.isArray(versionPaths) && versionPaths.length > 0
+                  ? versionPaths.map(v => v + addLeadingSlash(route.path))
+                  : addLeadingSlash(route.path),
+              )
+              .flat(),
+          ]
+        : entries;
+    }
+
+    return this.extractNonWildcardPathsFrom({ path, method, version });
+  }
+
+  public extractPathFrom(route: RouteInfo): string[] {
+    if (this.isAWildcard(route.path) && !route.version) {
+      return [addLeadingSlash(route.path)];
+    }
+
+    return this.extractNonWildcardPathsFrom(route);
+  }
+
+  private isAWildcard(path: string): boolean {
+    return ['*', '/*', '/*/', '(.*)', '/(.*)'].includes(path);
+  }
+
+  private extractNonWildcardPathsFrom({
+    path,
+    method,
+    version,
+  }: RouteInfo): string[] {
+    const versionPaths = this.extractVersionPathFrom(version);
+
+    if (
+      Array.isArray(this.excludedGlobalPrefixRoutes) &&
+      isRouteExcluded(this.excludedGlobalPrefixRoutes, path, method)
+    ) {
+      if (!versionPaths.length) {
+        return [addLeadingSlash(path)];
+      }
+
+      return versionPaths.map(
+        versionPath => versionPath + addLeadingSlash(path),
+      );
+    }
+
+    if (!versionPaths.length) {
+      return [this.prefixPath + addLeadingSlash(path)];
+    }
+    return versionPaths.map(
+      versionPath => this.prefixPath + versionPath + addLeadingSlash(path),
+    );
+  }
+
+  private extractVersionPathFrom(versionValue?: VersionValue): string[] {
+    if (!versionValue || this.versioningConfig?.type !== VersioningType.URI)
+      return [];
+
+    const versionPrefix = this.routePathFactory.getVersionPrefix(
+      this.versioningConfig,
+    );
+
+    if (Array.isArray(versionValue)) {
+      return versionValue.map(version =>
+        addLeadingSlash(versionPrefix + version.toString()),
+      );
+    }
+    return [addLeadingSlash(versionPrefix + versionValue.toString())];
+  }
+}
diff --git a/packages/core/middleware/routes-mapper.ts b/packages/core/middleware/routes-mapper.ts
index bbb8ea36c..d5155aace 100644
--- a/packages/core/middleware/routes-mapper.ts
+++ b/packages/core/middleware/routes-mapper.ts
@@ -1,69 +1,122 @@
-import { MODULE_PATH, PATH_METADATA } from '@nestjs/common/constants';
-import { RouteInfo, Type } from '@nestjs/common/interfaces';
+import {
+  MODULE_PATH,
+  PATH_METADATA,
+  VERSION_METADATA,
+} from '@nestjs/common/constants';
+import {
+  RouteInfo,
+  Type,
+  VERSION_NEUTRAL,
+  VersionValue,
+} from '@nestjs/common/interfaces';
 import {
   addLeadingSlash,
   isString,
   isUndefined,
 } from '@nestjs/common/utils/shared.utils';
+import { ApplicationConfig } from '../application-config';
 import { NestContainer } from '../injector/container';
 import { Module } from '../injector/module';
 import { MetadataScanner } from '../metadata-scanner';
-import { RouterExplorer } from '../router/router-explorer';
+import { PathsExplorer, RouteDefinition } from '../router/paths-explorer';
 import { targetModulesByContainer } from '../router/router-module';
 
 export class RoutesMapper {
-  private readonly routerExplorer: RouterExplorer;
+  private readonly pathsExplorer: PathsExplorer;
 
-  constructor(private readonly container: NestContainer) {
-    this.routerExplorer = new RouterExplorer(new MetadataScanner(), container);
+  constructor(
+    private readonly container: NestContainer,
+    private readonly applicationConfig: ApplicationConfig,
+  ) {
+    this.pathsExplorer = new PathsExplorer(new MetadataScanner());
   }
 
   public mapRouteToRouteInfo(
-    route: Type<any> | RouteInfo | string,
+    controllerOrRoute: Type<any> | RouteInfo | string,
   ): RouteInfo[] {
-    if (isString(route)) {
-      const defaultRequestMethod = -1;
-      return [
-        {
-          path: addLeadingSlash(route),
-          method: defaultRequestMethod,
-        },
-      ];
+    if (isString(controllerOrRoute)) {
+      return this.getRouteInfoFromPath(controllerOrRoute);
+    }
+    const routePathOrPaths = this.getRoutePath(controllerOrRoute);
+    if (this.isRouteInfo(routePathOrPaths, controllerOrRoute)) {
+      return this.getRouteInfoFromObject(controllerOrRoute);
     }
-    const routePathOrPaths = this.getRoutePath(route);
-    if (this.isRouteInfo(routePathOrPaths, route)) {
-      return [
-        {
-          path: addLeadingSlash(route.path),
-          method: route.method,
-        },
-      ];
+
+    return this.getRouteInfoFromController(
+      controllerOrRoute,
+      routePathOrPaths!,
+    );
+  }
+
+  private getRouteInfoFromPath(routePath: string): RouteInfo[] {
+    const defaultRequestMethod = -1;
+    return [
+      {
+        path: addLeadingSlash(routePath),
+        method: defaultRequestMethod as any,
+      },
+    ];
+  }
+
+  private getRouteInfoFromObject(routeInfoObject: RouteInfo): RouteInfo[] {
+    const routeInfo: RouteInfo = {
+      path: addLeadingSlash(routeInfoObject.path),
+      method: routeInfoObject.method,
+    };
+
+    if (routeInfoObject.version) {
+      routeInfo.version = routeInfoObject.version;
     }
-    const controllerPaths = this.routerExplorer.scanForPaths(
-      Object.create(route),
-      route.prototype,
+    return [routeInfo];
+  }
+
+  private getRouteInfoFromController(
+    controller: Type<any>,
+    routePath: string,
+  ): RouteInfo[] {
+    const controllerPaths = this.pathsExplorer.scanForPaths(
+      Object.create(controller),
+      controller.prototype,
     );
-    const moduleRef = this.getHostModuleOfController(route);
+    const controllerVersion = this.getVersionMetadata(controller);
+    const versioningConfig = this.applicationConfig.getVersioning();
+    const moduleRef = this.getHostModuleOfController(controller);
     const modulePath = this.getModulePath(moduleRef?.metatype);
 
     const concatPaths = <T>(acc: T[], currentValue: T[]) =>
       acc.concat(currentValue);
 
-    return []
-      .concat(routePathOrPaths)
+    const toUndefinedIfNeural = (version: VersionValue) =>
+      version === VERSION_NEUTRAL ? undefined : version;
+
+    const toRouteInfo = (item: RouteDefinition, prefix: string) =>
+      item.path?.flatMap(p => {
+        let endpointPath = modulePath ?? '';
+        endpointPath += this.normalizeGlobalPath(prefix) + addLeadingSlash(p);
+
+        const routeInfo: RouteInfo = {
+          path: endpointPath,
+          method: item.requestMethod,
+        };
+        const version = item.version ?? controllerVersion;
+        if (version && versioningConfig) {
+          if (typeof version !== 'string' && Array.isArray(version)) {
+            return version.map(v => ({
+              ...routeInfo,
+              version: toUndefinedIfNeural(v),
+            }));
+          }
+          routeInfo.version = toUndefinedIfNeural(version);
+        }
+
+        return routeInfo;
+      });
+
+    return ([] as string[])
+      .concat(routePath)
       .map(routePath =>
         controllerPaths
-          .map(item =>
-            item.path?.map(p => {
-              let path = modulePath ?? '';
-              path += this.normalizeGlobalPath(routePath) + addLeadingSlash(p);
-
-              return {
-                path,
-                method: item.requestMethod,
-              };
-            }),
-          )
+          .map(item => toRouteInfo(item, routePath))
           .reduce(concatPaths, []),
       )
       .reduce(concatPaths, []);
@@ -100,7 +153,7 @@ export class RoutesMapper {
     const modules = Array.from(modulesContainer.values()).filter(moduleRef =>
       moduleRefsSet.has(moduleRef),
     );
-    return modules.find(({ routes }) => routes.has(metatype));
+    return modules.find(({ controllers }) => controllers.has(metatype));
   }
 
   private getModulePath(
@@ -116,4 +169,16 @@ export class RoutesMapper {
     );
     return modulePath ?? Reflect.getMetadata(MODULE_PATH, metatype);
   }
+
+  private getVersionMetadata(
+    metatype: Type<unknown> | Function,
+  ): VersionValue | undefined {
+    const versioningConfig = this.applicationConfig.getVersioning();
+    if (versioningConfig) {
+      return (
+        Reflect.getMetadata(VERSION_METADATA, metatype) ??
+        versioningConfig.defaultVersion
+      );
+    }
+  }
 }
diff --git a/packages/core/middleware/utils.ts b/packages/core/middleware/utils.ts
index 19418afc8..87ffb28d5 100644
--- a/packages/core/middleware/utils.ts
+++ b/packages/core/middleware/utils.ts
@@ -1,19 +1,33 @@
 import { RequestMethod } from '@nestjs/common';
 import { HttpServer, RouteInfo, Type } from '@nestjs/common/interfaces';
-import { isFunction } from '@nestjs/common/utils/shared.utils';
+import {
+  addLeadingSlash,
+  isFunction,
+  isString,
+} from '@nestjs/common/utils/shared.utils';
 import { iterate } from 'iterare';
 import * as pathToRegexp from 'path-to-regexp';
-import { v4 as uuid } from 'uuid';
+import { uid } from 'uid';
 import { ExcludeRouteMetadata } from '../router/interfaces/exclude-route-metadata.interface';
 import { isRouteExcluded } from '../router/utils';
 
 export const mapToExcludeRoute = (
-  routes: RouteInfo[],
+  routes: (string | RouteInfo)[],
 ): ExcludeRouteMetadata[] => {
-  return routes.map(({ path, method }) => ({
-    pathRegex: pathToRegexp(path),
-    requestMethod: method,
-  }));
+  return routes.map(route => {
+    if (isString(route)) {
+      return {
+        path: route,
+        requestMethod: RequestMethod.ALL,
+        pathRegex: pathToRegexp(addLeadingSlash(route)),
+      };
+    }
+    return {
+      path: route.path,
+      requestMethod: route.method,
+      pathRegex: pathToRegexp(addLeadingSlash(route.path)),
+    };
+  });
 };
 
 export const filterMiddleware = <T extends Function | Type<any> = any>(
@@ -38,7 +52,7 @@ export const mapToClass = <T extends Function | Type<any>>(
     if (excludedRoutes.length <= 0) {
       return middleware;
     }
-    const MiddlewareHost = class extends (middleware as Type<any>) {
+    const MiddlewareHost = class extends middleware {
       use(...params: unknown[]) {
         const [req, _, next] = params as [Record<string, any>, any, Function];
         const isExcluded = isMiddlewareRouteExcluded(
@@ -85,7 +99,7 @@ export function isMiddlewareClass(middleware: any): middleware is Type<any> {
   );
 }
 
-export function assignToken(metatype: Type<any>, token = uuid()): Type<any> {
+export function assignToken(metatype: Type<any>, token = uid(21)): Type<any> {
   Object.defineProperty(metatype, 'name', { value: token });
   return metatype;
 }
@@ -98,9 +112,9 @@ export function isMiddlewareRouteExcluded(
   if (excludedRoutes.length <= 0) {
     return false;
   }
-  const reqMethod = httpAdapter.getRequestMethod(req);
-  const originalUrl = httpAdapter.getRequestUrl(req);
-  const queryParamsIndex = originalUrl && originalUrl.indexOf('?');
+  const reqMethod = httpAdapter.getRequestMethod!(req);
+  const originalUrl = httpAdapter.getRequestUrl!(req);
+  const queryParamsIndex = originalUrl ? originalUrl.indexOf('?') : -1;
   const pathname =
     queryParamsIndex >= 0
       ? originalUrl.slice(0, queryParamsIndex)
diff --git a/packages/core/nest-application-context.ts b/packages/core/nest-application-context.ts
index a61b9b8b0..b3ba11fef 100644
--- a/packages/core/nest-application-context.ts
+++ b/packages/core/nest-application-context.ts
@@ -5,14 +5,18 @@ import {
   LogLevel,
   ShutdownSignal,
 } from '@nestjs/common';
-import { Abstract, DynamicModule, Scope } from '@nestjs/common/interfaces';
-import { Type } from '@nestjs/common/interfaces/type.interface';
+import {
+  Abstract,
+  DynamicModule,
+  GetOrResolveOptions,
+  SelectOptions,
+  Type,
+} from '@nestjs/common/interfaces';
+import { NestApplicationContextOptions } from '@nestjs/common/interfaces/nest-application-context-options.interface';
 import { isEmpty } from '@nestjs/common/utils/shared.utils';
 import { iterate } from 'iterare';
 import { MESSAGES } from './constants';
-import { InvalidClassScopeException } from './errors/exceptions/invalid-class-scope.exception';
-import { UnknownElementException } from './errors/exceptions/unknown-element.exception';
-import { UnknownModuleException } from './errors/exceptions/unknown-module.exception';
+import { UnknownModuleException } from './errors/exceptions';
 import { createContextId } from './helpers/context-id-factory';
 import {
   callAppShutdownHook,
@@ -21,6 +25,7 @@ import {
   callModuleDestroyHook,
   callModuleInitHook,
 } from './hooks';
+import { AbstractInstanceResolver } from './injector/abstract-instance-resolver';
 import { ModuleCompiler } from './injector/compiler';
 import { NestContainer } from './injector/container';
 import { Injector } from './injector/injector';
@@ -31,18 +36,28 @@ import { Module } from './injector/module';
 /**
  * @publicApi
  */
-export class NestApplicationContext implements INestApplicationContext {
+export class NestApplicationContext<
+    TOptions extends
+      NestApplicationContextOptions = NestApplicationContextOptions,
+  >
+  extends AbstractInstanceResolver
+  implements INestApplicationContext
+{
   protected isInitialized = false;
-  protected readonly injector = new Injector();
+  protected injector: Injector;
+  protected readonly logger = new Logger(NestApplicationContext.name, {
+    timestamp: true,
+  });
 
   private shouldFlushLogsOnOverride = false;
   private readonly activeShutdownSignals = new Array<string>();
-  private readonly moduleCompiler = new ModuleCompiler();
+  private readonly moduleCompiler: ModuleCompiler;
   private shutdownCleanupRef?: (...args: unknown[]) => unknown;
   private _instanceLinksHost: InstanceLinksHost;
-  private _moduleRefsByDistance?: Array<Module>;
+  private _moduleRefsForHooksByDistance?: Array<Module>;
+  private initializationPromise?: Promise<void>;
 
-  private get instanceLinksHost() {
+  protected get instanceLinksHost() {
     if (!this._instanceLinksHost) {
       this._instanceLinksHost = new InstanceLinksHost(this.container);
     }
@@ -51,62 +66,185 @@ export class NestApplicationContext implements INestApplicationContext {
 
   constructor(
     protected readonly container: NestContainer,
+    protected readonly appOptions: TOptions = {} as TOptions,
+    private contextModule: Module | null = null,
     private readonly scope = new Array<Type<any>>(),
-    private contextModule: Module = null,
-  ) {}
+  ) {
+    super();
+    this.injector = new Injector();
+    this.moduleCompiler = container.getModuleCompiler();
+
+    if (this.appOptions.preview) {
+      this.printInPreviewModeWarning();
+    }
+  }
 
   public selectContextModule() {
     const modules = this.container.getModules().values();
-    this.contextModule = modules.next().value;
+    this.contextModule = modules.next().value!;
   }
 
+  /**
+   * Allows navigating through the modules tree, for example, to pull out a specific instance from the selected module.
+   * @returns {INestApplicationContext}
+   */
   public select<T>(
     moduleType: Type<T> | DynamicModule,
+    selectOptions?: SelectOptions,
   ): INestApplicationContext {
     const modulesContainer = this.container.getModules();
-    const contextModuleCtor = this.contextModule.metatype;
+    const contextModuleCtor = this.contextModule!.metatype;
     const scope = this.scope.concat(contextModuleCtor);
 
     const moduleTokenFactory = this.container.getModuleTokenFactory();
     const { type, dynamicMetadata } =
       this.moduleCompiler.extractMetadata(moduleType);
-    const token = moduleTokenFactory.create(type, dynamicMetadata);
+    const token = dynamicMetadata
+      ? moduleTokenFactory.createForDynamic(
+          type,
+          dynamicMetadata,
+          moduleType as DynamicModule,
+        )
+      : moduleTokenFactory.createForStatic(type, moduleType as Type);
 
     const selectedModule = modulesContainer.get(token);
     if (!selectedModule) {
-      throw new UnknownModuleException();
+      throw new UnknownModuleException(type.name);
     }
-    return new NestApplicationContext(this.container, scope, selectedModule);
+
+    const options =
+      typeof selectOptions?.abortOnError !== 'undefined'
+        ? {
+            ...this.appOptions,
+            ...selectOptions,
+          }
+        : this.appOptions;
+
+    return new NestApplicationContext(
+      this.container,
+      options,
+      selectedModule,
+      scope,
+    );
   }
 
+  /**
+   * Retrieves an instance of either injectable or controller, otherwise, throws exception.
+   * @returns {TResult}
+   */
+  public get<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+  ): TResult;
+  /**
+   * Retrieves an instance of either injectable or controller, otherwise, throws exception.
+   * @returns {TResult}
+   */
+  public get<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    options: {
+      strict?: boolean;
+      each?: undefined | false;
+    },
+  ): TResult;
+  /**
+   * Retrieves a list of instances of either injectables or controllers, otherwise, throws exception.
+   * @returns {Array<TResult>}
+   */
+  public get<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    options: {
+      strict?: boolean;
+      each: true;
+    },
+  ): Array<TResult>;
+  /**
+   * Retrieves an instance (or a list of instances) of either injectable or controller, otherwise, throws exception.
+   * @returns {TResult | Array<TResult>}
+   */
   public get<TInput = any, TResult = TInput>(
     typeOrToken: Type<TInput> | Abstract<TInput> | string | symbol,
-    options: { strict: boolean } = { strict: false },
-  ): TResult {
+    options: GetOrResolveOptions = { strict: false },
+  ): TResult | Array<TResult> {
     return !(options && options.strict)
-      ? this.find<TInput, TResult>(typeOrToken)
-      : this.find<TInput, TResult>(typeOrToken, this.contextModule);
+      ? this.find<TInput, TResult>(typeOrToken, options)
+      : this.find<TInput, TResult>(typeOrToken, {
+          moduleId: this.contextModule?.id,
+          each: options.each,
+        });
   }
 
+  /**
+   * Resolves transient or request-scoped instance of either injectable or controller, otherwise, throws exception.
+   * @returns {Array<TResult>}
+   */
+  public resolve<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+  ): Promise<TResult>;
+  /**
+   * Resolves transient or request-scoped instance of either injectable or controller, otherwise, throws exception.
+   * @returns {Array<TResult>}
+   */
+  public resolve<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    contextId?: {
+      id: number;
+    },
+  ): Promise<TResult>;
+  /**
+   * Resolves transient or request-scoped instance of either injectable or controller, otherwise, throws exception.
+   * @returns {Array<TResult>}
+   */
+  public resolve<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    contextId?: {
+      id: number;
+    },
+    options?: {
+      strict?: boolean;
+      each?: undefined | false;
+    },
+  ): Promise<TResult>;
+  /**
+   * Resolves transient or request-scoped instances of either injectables or controllers, otherwise, throws exception.
+   * @returns {Array<TResult>}
+   */
+  public resolve<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    contextId?: {
+      id: number;
+    },
+    options?: {
+      strict?: boolean;
+      each: true;
+    },
+  ): Promise<Array<TResult>>;
+  /**
+   * Resolves transient or request-scoped instance (or a list of instances) of either injectable or controller, otherwise, throws exception.
+   * @returns {Promise<TResult | Array<TResult>>}
+   */
   public resolve<TInput = any, TResult = TInput>(
     typeOrToken: Type<TInput> | Abstract<TInput> | string | symbol,
     contextId = createContextId(),
-    options: { strict: boolean } = { strict: false },
-  ): Promise<TResult> {
-    return this.resolvePerContext(
+    options: GetOrResolveOptions = { strict: false },
+  ): Promise<TResult | Array<TResult>> {
+    return this.resolvePerContext<TInput, TResult>(
       typeOrToken,
-      this.contextModule,
+      this.contextModule!,
       contextId,
       options,
     );
   }
 
+  /**
+   * Registers the request/context object for a given context ID (DI container sub-tree).
+   * @returns {void}
+   */
   public registerRequestByContextId<T = any>(request: T, contextId: ContextId) {
     this.container.registerRequestProvider(request, contextId);
   }
 
   /**
-   * Initalizes the Nest application.
+   * Initializes the Nest application.
    * Calls the Nest lifecycle events.
    *
    * @returns {Promise<this>} The NestApplicationContext instance as Promise
@@ -115,21 +253,40 @@ export class NestApplicationContext implements INestApplicationContext {
     if (this.isInitialized) {
       return this;
     }
-    await this.callInitHook();
-    await this.callBootstrapHook();
+    /* eslint-disable-next-line no-async-promise-executor */
+    this.initializationPromise = new Promise(async (resolve, reject) => {
+      try {
+        await this.callInitHook();
+        await this.callBootstrapHook();
+        resolve();
+      } catch (err) {
+        reject(err);
+      }
+    });
+    await this.initializationPromise;
 
     this.isInitialized = true;
     return this;
   }
 
-  public async close(): Promise<void> {
+  /**
+   * Terminates the application
+   * @returns {Promise<void>}
+   */
+  public async close(signal?: string): Promise<void> {
+    await this.initializationPromise;
     await this.callDestroyHook();
-    await this.callBeforeShutdownHook();
+    await this.callBeforeShutdownHook(signal);
     await this.dispose();
-    await this.callShutdownHook();
+    await this.callShutdownHook(signal);
     this.unsubscribeFromProcessSignals();
   }
 
+  /**
+   * Sets custom logger service.
+   * Flushes buffered logs if auto flush is on.
+   * @returns {void}
+   */
   public useLogger(logger: LoggerService | LogLevel[] | false) {
     Logger.overrideLogger(logger);
 
@@ -138,6 +295,10 @@ export class NestApplicationContext implements INestApplicationContext {
     }
   }
 
+  /**
+   * Prints buffered logs and detaches buffer.
+   * @returns {void}
+   */
   public flushLogs() {
     Logger.flush();
   }
@@ -192,13 +353,21 @@ export class NestApplicationContext implements INestApplicationContext {
    * @param {string[]} signals The system signals it should listen to
    */
   protected listenToShutdownSignals(signals: string[]) {
+    let receivedSignal = false;
     const cleanup = async (signal: string) => {
       try {
-        signals.forEach(sig => process.removeListener(sig, cleanup));
+        if (receivedSignal) {
+          // If we receive another signal while we're waiting
+          // for the server to stop, just ignore it.
+          return;
+        }
+        receivedSignal = true;
+        await this.initializationPromise;
         await this.callDestroyHook();
         await this.callBeforeShutdownHook(signal);
         await this.dispose();
         await this.callShutdownHook(signal);
+        signals.forEach(sig => process.removeListener(sig, cleanup));
         process.kill(process.pid, signal);
       } catch (err) {
         Logger.error(
@@ -225,7 +394,7 @@ export class NestApplicationContext implements INestApplicationContext {
       return;
     }
     this.activeShutdownSignals.forEach(signal => {
-      process.removeListener(signal, this.shutdownCleanupRef);
+      process.removeListener(signal, this.shutdownCleanupRef!);
     });
   }
 
@@ -234,7 +403,7 @@ export class NestApplicationContext implements INestApplicationContext {
    * modules and its children.
    */
   protected async callInitHook(): Promise<void> {
-    const modulesSortedByDistance = this.getModulesSortedByDistance();
+    const modulesSortedByDistance = this.getModulesToTriggerHooksOn();
     for (const module of modulesSortedByDistance) {
       await callModuleInitHook(module);
     }
@@ -245,7 +414,10 @@ export class NestApplicationContext implements INestApplicationContext {
    * modules and its children.
    */
   protected async callDestroyHook(): Promise<void> {
-    const modulesSortedByDistance = this.getModulesSortedByDistance();
+    const modulesSortedByDistance = [
+      ...this.getModulesToTriggerHooksOn(),
+    ].reverse();
+
     for (const module of modulesSortedByDistance) {
       await callModuleDestroyHook(module);
     }
@@ -256,7 +428,7 @@ export class NestApplicationContext implements INestApplicationContext {
    * modules and its children.
    */
   protected async callBootstrapHook(): Promise<void> {
-    const modulesSortedByDistance = this.getModulesSortedByDistance();
+    const modulesSortedByDistance = this.getModulesToTriggerHooksOn();
     for (const module of modulesSortedByDistance) {
       await callModuleBootstrapHook(module);
     }
@@ -267,7 +439,7 @@ export class NestApplicationContext implements INestApplicationContext {
    * modules and children.
    */
   protected async callShutdownHook(signal?: string): Promise<void> {
-    const modulesSortedByDistance = this.getModulesSortedByDistance();
+    const modulesSortedByDistance = this.getModulesToTriggerHooksOn();
     for (const module of modulesSortedByDistance) {
       await callAppShutdownHook(module, signal);
     }
@@ -278,69 +450,40 @@ export class NestApplicationContext implements INestApplicationContext {
    * modules and children.
    */
   protected async callBeforeShutdownHook(signal?: string): Promise<void> {
-    const modulesSortedByDistance = this.getModulesSortedByDistance();
+    const modulesSortedByDistance = this.getModulesToTriggerHooksOn();
     for (const module of modulesSortedByDistance) {
       await callBeforeAppShutdownHook(module, signal);
     }
   }
 
-  protected find<TInput = any, TResult = TInput>(
-    typeOrToken: Type<TInput> | Abstract<TInput> | string | symbol,
-    contextModule?: Module,
-  ): TResult {
-    const moduleId = contextModule && contextModule.id;
-    const { wrapperRef } = this.instanceLinksHost.get<TResult>(
-      typeOrToken,
-      moduleId,
-    );
-    if (
-      wrapperRef.scope === Scope.REQUEST ||
-      wrapperRef.scope === Scope.TRANSIENT
-    ) {
-      throw new InvalidClassScopeException(typeOrToken);
-    }
-    return wrapperRef.instance;
-  }
-
-  protected async resolvePerContext<TInput = any, TResult = TInput>(
-    typeOrToken: Type<TInput> | Abstract<TInput> | string | symbol,
-    contextModule: Module,
-    contextId: ContextId,
-    options?: { strict: boolean },
-  ): Promise<TResult> {
-    const isStrictModeEnabled = options && options.strict;
-    const instanceLink = isStrictModeEnabled
-      ? this.instanceLinksHost.get(typeOrToken, contextModule.id)
-      : this.instanceLinksHost.get(typeOrToken);
-
-    const { wrapperRef, collection } = instanceLink;
-    if (wrapperRef.isDependencyTreeStatic() && !wrapperRef.isTransient) {
-      return this.get(typeOrToken, options);
-    }
-
-    const ctorHost = wrapperRef.instance || { constructor: typeOrToken };
-    const instance = await this.injector.loadPerContext(
-      ctorHost,
-      wrapperRef.host,
-      collection,
-      contextId,
-    );
-    if (!instance) {
-      throw new UnknownElementException();
+  protected assertNotInPreviewMode(methodName: string) {
+    if (this.appOptions.preview) {
+      const error = `Calling the "${methodName}" in the preview mode is not supported.`;
+      this.logger.error(error);
+      throw new Error(error);
     }
-    return instance;
   }
 
-  private getModulesSortedByDistance(): Module[] {
-    if (this._moduleRefsByDistance) {
-      return this._moduleRefsByDistance;
+  private getModulesToTriggerHooksOn(): Module[] {
+    if (this._moduleRefsForHooksByDistance) {
+      return this._moduleRefsForHooksByDistance;
     }
     const modulesContainer = this.container.getModules();
     const compareFn = (a: Module, b: Module) => b.distance - a.distance;
-
-    this._moduleRefsByDistance = Array.from(modulesContainer.values()).sort(
+    const modulesSortedByDistance = Array.from(modulesContainer.values()).sort(
       compareFn,
     );
-    return this._moduleRefsByDistance;
+
+    this._moduleRefsForHooksByDistance = this.appOptions?.preview
+      ? modulesSortedByDistance.filter(moduleRef => moduleRef.initOnPreview)
+      : modulesSortedByDistance;
+    return this._moduleRefsForHooksByDistance;
+  }
+
+  private printInPreviewModeWarning() {
+    this.logger.warn('------------------------------------------------');
+    this.logger.warn('Application is running in the PREVIEW mode!');
+    this.logger.warn('Providers/controllers will not be instantiated.');
+    this.logger.warn('------------------------------------------------');
   }
 }
diff --git a/packages/core/nest-application.ts b/packages/core/nest-application.ts
index 0ecc357cd..d72dcd62a 100644
--- a/packages/core/nest-application.ts
+++ b/packages/core/nest-application.ts
@@ -7,18 +7,18 @@ import {
   NestHybridApplicationOptions,
   NestInterceptor,
   PipeTransform,
-  RequestMethod,
   VersioningOptions,
   VersioningType,
   WebSocketAdapter,
 } from '@nestjs/common';
-import { RouteInfo } from '@nestjs/common/interfaces';
+import {
+  GlobalPrefixOptions,
+  NestApplicationOptions,
+} from '@nestjs/common/interfaces';
 import {
   CorsOptions,
   CorsOptionsDelegate,
 } from '@nestjs/common/interfaces/external/cors-options.interface';
-import { GlobalPrefixOptions } from '@nestjs/common/interfaces/global-prefix-options.interface';
-import { NestApplicationOptions } from '@nestjs/common/interfaces/nest-application-options.interface';
 import { Logger } from '@nestjs/common/services/logger.service';
 import { loadPackage } from '@nestjs/common/utils/load-package.util';
 import {
@@ -29,16 +29,17 @@ import {
 } from '@nestjs/common/utils/shared.utils';
 import { iterate } from 'iterare';
 import { platform } from 'os';
-import * as pathToRegexp from 'path-to-regexp';
 import { AbstractHttpAdapter } from './adapters';
 import { ApplicationConfig } from './application-config';
 import { MESSAGES } from './constants';
 import { optionalRequire } from './helpers/optional-require';
 import { NestContainer } from './injector/container';
+import { Injector } from './injector/injector';
+import { GraphInspector } from './inspector/graph-inspector';
 import { MiddlewareContainer } from './middleware/container';
 import { MiddlewareModule } from './middleware/middleware-module';
+import { mapToExcludeRoute } from './middleware/utils';
 import { NestApplicationContext } from './nest-application-context';
-import { ExcludeRouteMetadata } from './router/interfaces/exclude-route-metadata.interface';
 import { Resolver } from './router/interfaces/resolver.interface';
 import { RoutesResolver } from './router/routes-resolver';
 
@@ -55,13 +56,13 @@ const { MicroservicesModule } = optionalRequire(
  * @publicApi
  */
 export class NestApplication
-  extends NestApplicationContext
+  extends NestApplicationContext<NestApplicationOptions>
   implements INestApplication
 {
-  private readonly logger = new Logger(NestApplication.name, {
+  protected readonly logger = new Logger(NestApplication.name, {
     timestamp: true,
   });
-  private readonly middlewareModule = new MiddlewareModule();
+  private readonly middlewareModule: MiddlewareModule;
   private readonly middlewareContainer = new MiddlewareContainer(
     this.container,
   );
@@ -77,17 +78,20 @@ export class NestApplication
     container: NestContainer,
     private readonly httpAdapter: HttpServer,
     private readonly config: ApplicationConfig,
-    private readonly appOptions: NestApplicationOptions = {},
+    private readonly graphInspector: GraphInspector,
+    appOptions: NestApplicationOptions = {},
   ) {
-    super(container);
+    super(container, appOptions);
 
     this.selectContextModule();
     this.registerHttpServer();
-
+    this.injector = new Injector({ preview: this.appOptions.preview! });
+    this.middlewareModule = new MiddlewareModule();
     this.routesResolver = new RoutesResolver(
       this.container,
       this.config,
       this.injector,
+      this.graphInspector,
     );
   }
 
@@ -139,15 +143,23 @@ export class NestApplication
     this.registerWsModule();
 
     if (this.microservicesModule) {
-      this.microservicesModule.register(this.container, this.config);
+      this.microservicesModule.register(
+        this.container,
+        this.graphInspector,
+        this.config,
+        this.appOptions,
+      );
       this.microservicesModule.setupClients(this.container);
     }
+
     await this.middlewareModule.register(
       this.middlewareContainer,
       this.container,
       this.config,
       this.injector,
       this.httpAdapter,
+      this.graphInspector,
+      this.appOptions,
     );
   }
 
@@ -155,12 +167,22 @@ export class NestApplication
     if (!this.socketModule) {
       return;
     }
-    this.socketModule.register(this.container, this.config, this.httpServer);
+    this.socketModule.register(
+      this.container,
+      this.config,
+      this.graphInspector,
+      this.appOptions,
+      this.httpServer,
+    );
   }
 
   public async init(): Promise<this> {
+    if (this.isInitialized) {
+      return this;
+    }
+
     this.applyOptions();
-    await this.httpAdapter?.init();
+    await this.httpAdapter?.init?.();
 
     const useBodyParser =
       this.appOptions && this.appOptions.bodyParser !== false;
@@ -178,7 +200,9 @@ export class NestApplication
   }
 
   public registerParserMiddleware() {
-    this.httpAdapter.registerParserMiddleware();
+    const prefix = this.config.getGlobalPrefix();
+    const rawBody = !!this.appOptions?.rawBody;
+    this.httpAdapter.registerParserMiddleware(prefix, rawBody);
   }
 
   public async registerRouter() {
@@ -211,6 +235,7 @@ export class NestApplication
     const instance = new NestMicroservice(
       this.container,
       microserviceOptions,
+      this.graphInspector,
       applicationConfig,
     );
     instance.registerListeners();
@@ -230,24 +255,32 @@ export class NestApplication
   }
 
   public async startAllMicroservices(): Promise<this> {
+    this.assertNotInPreviewMode('startAllMicroservices');
     await Promise.all(this.microservices.map(msvc => msvc.listen()));
     return this;
   }
 
-  public startAllMicroservicesAsync(): Promise<this> {
-    this.logger.warn(
-      'DEPRECATED! "startAllMicroservicesAsync" method is deprecated and will be removed in the next major release. Please, use "startAllMicroservices" instead.',
-    );
-    return this.startAllMicroservices();
-  }
-
   public use(...args: [any, any?]): this {
     this.httpAdapter.use(...args);
     return this;
   }
 
+  public useBodyParser(...args: [any, any?]): this {
+    if (!('useBodyParser' in this.httpAdapter)) {
+      this.logger.warn('Your HTTP Adapter does not support `.useBodyParser`.');
+      return this;
+    }
+
+    const [parserType, ...otherArgs] = args;
+    const rawBody = !!this.appOptions.rawBody;
+
+    this.httpAdapter.useBodyParser?.(...[parserType, rawBody, ...otherArgs]);
+
+    return this;
+  }
+
   public enableCors(options?: CorsOptions | CorsOptionsDelegate<any>): void {
-    this.httpAdapter.enableCors(options);
+    this.httpAdapter.enableCors(options!);
   }
 
   public enableVersioning(
@@ -260,8 +293,13 @@ export class NestApplication
   public async listen(port: number | string): Promise<any>;
   public async listen(port: number | string, hostname: string): Promise<any>;
   public async listen(port: number | string, ...args: any[]): Promise<any> {
-    !this.isInitialized && (await this.init());
+    this.assertNotInPreviewMode('listen');
+
+    if (!this.isInitialized) {
+      await this.init();
+    }
 
+    const httpAdapterHost = this.container.getHttpAdapterHostRef();
     return new Promise((resolve, reject) => {
       const errorHandler = (e: any) => {
         this.logger.error(e?.toString?.());
@@ -289,6 +327,8 @@ export class NestApplication
           if (address) {
             this.httpServer.removeListener('error', errorHandler);
             this.isListening = true;
+
+            httpAdapterHost.listening = true;
             resolve(this.httpServer);
           }
           if (isCallbackInOriginalArgs) {
@@ -299,18 +339,12 @@ export class NestApplication
     });
   }
 
-  public listenAsync(port: number | string, ...args: any[]): Promise<any> {
-    this.logger.warn(
-      'DEPRECATED! "listenAsync" method is deprecated and will be removed in the next major release. Please, use "listen" instead.',
-    );
-    return this.listen(port, ...(args as [any]));
-  }
-
   public async getUrl(): Promise<string> {
     return new Promise((resolve, reject) => {
       if (!this.isListening) {
         this.logger.error(MESSAGES.CALL_LISTEN_FIRST);
         reject(MESSAGES.CALL_LISTEN_FIRST);
+        return;
       }
       const address = this.httpServer.address();
       resolve(this.formatAddress(address));
@@ -343,20 +377,9 @@ export class NestApplication
   public setGlobalPrefix(prefix: string, options?: GlobalPrefixOptions): this {
     this.config.setGlobalPrefix(prefix);
     if (options) {
-      const exclude = options?.exclude.map(
-        (route: string | RouteInfo): ExcludeRouteMetadata => {
-          if (isString(route)) {
-            return {
-              requestMethod: RequestMethod.ALL,
-              pathRegex: pathToRegexp(addLeadingSlash(route)),
-            };
-          }
-          return {
-            requestMethod: route.method,
-            pathRegex: pathToRegexp(addLeadingSlash(route.path)),
-          };
-        },
-      );
+      const exclude = options?.exclude
+        ? mapToExcludeRoute(options.exclude)
+        : [];
       this.config.setGlobalPrefixOptions({
         ...options,
         exclude,
@@ -372,21 +395,45 @@ export class NestApplication
 
   public useGlobalFilters(...filters: ExceptionFilter[]): this {
     this.config.useGlobalFilters(...filters);
+    filters.forEach(item =>
+      this.graphInspector.insertOrphanedEnhancer({
+        subtype: 'filter',
+        ref: item,
+      }),
+    );
     return this;
   }
 
   public useGlobalPipes(...pipes: PipeTransform<any>[]): this {
     this.config.useGlobalPipes(...pipes);
+    pipes.forEach(item =>
+      this.graphInspector.insertOrphanedEnhancer({
+        subtype: 'pipe',
+        ref: item,
+      }),
+    );
     return this;
   }
 
   public useGlobalInterceptors(...interceptors: NestInterceptor[]): this {
     this.config.useGlobalInterceptors(...interceptors);
+    interceptors.forEach(item =>
+      this.graphInspector.insertOrphanedEnhancer({
+        subtype: 'interceptor',
+        ref: item,
+      }),
+    );
     return this;
   }
 
   public useGlobalGuards(...guards: CanActivate[]): this {
     this.config.useGlobalGuards(...guards);
+    guards.forEach(item =>
+      this.graphInspector.insertOrphanedEnhancer({
+        subtype: 'guard',
+        ref: item,
+      }),
+    );
     return this;
   }
 
diff --git a/packages/core/nest-factory.ts b/packages/core/nest-factory.ts
index 617b11a97..933d5d658 100644
--- a/packages/core/nest-factory.ts
+++ b/packages/core/nest-factory.ts
@@ -1,8 +1,11 @@
 import {
+  DynamicModule,
+  ForwardReference,
   HttpServer,
   INestApplication,
   INestApplicationContext,
   INestMicroservice,
+  Type,
 } from '@nestjs/common';
 import { NestMicroserviceOptions } from '@nestjs/common/interfaces/microservices/nest-microservice-options.interface';
 import { NestApplicationContextOptions } from '@nestjs/common/interfaces/nest-application-context-options.interface';
@@ -17,12 +20,22 @@ import { ExceptionsZone } from './errors/exceptions-zone';
 import { loadAdapter } from './helpers/load-adapter';
 import { rethrow } from './helpers/rethrow';
 import { NestContainer } from './injector/container';
+import { Injector } from './injector/injector';
 import { InstanceLoader } from './injector/instance-loader';
+import { GraphInspector } from './inspector/graph-inspector';
+import { NoopGraphInspector } from './inspector/noop-graph-inspector';
+import { UuidFactory, UuidFactoryMode } from './inspector/uuid-factory';
 import { MetadataScanner } from './metadata-scanner';
 import { NestApplication } from './nest-application';
 import { NestApplicationContext } from './nest-application-context';
 import { DependenciesScanner } from './scanner';
 
+type IEntryNestModule =
+  | Type<any>
+  | DynamicModule
+  | ForwardReference
+  | Promise<IEntryNestModule>;
+
 /**
  * @publicApi
  */
@@ -43,7 +56,7 @@ export class NestFactoryStatic {
    * contains a reference to the NestApplication instance.
    */
   public async create<T extends INestApplication = INestApplication>(
-    module: any,
+    module: IEntryNestModule,
     options?: NestApplicationOptions,
   ): Promise<T>;
   /**
@@ -58,30 +71,40 @@ export class NestFactoryStatic {
    * contains a reference to the NestApplication instance.
    */
   public async create<T extends INestApplication = INestApplication>(
-    module: any,
+    module: IEntryNestModule,
     httpAdapter: AbstractHttpAdapter,
     options?: NestApplicationOptions,
   ): Promise<T>;
   public async create<T extends INestApplication = INestApplication>(
-    module: any,
+    moduleCls: IEntryNestModule,
     serverOrOptions?: AbstractHttpAdapter | NestApplicationOptions,
     options?: NestApplicationOptions,
   ): Promise<T> {
-    const [httpServer, appOptions] = this.isHttpServer(serverOrOptions)
+    const [httpServer, appOptions] = this.isHttpServer(serverOrOptions!)
       ? [serverOrOptions, options]
       : [this.createHttpAdapter(), serverOrOptions];
 
     const applicationConfig = new ApplicationConfig();
     const container = new NestContainer(applicationConfig);
+    const graphInspector = this.createGraphInspector(appOptions!, container);
+
     this.setAbortOnError(serverOrOptions, options);
     this.registerLoggerConfiguration(appOptions);
 
-    await this.initialize(module, container, applicationConfig, httpServer);
+    await this.initialize(
+      moduleCls,
+      container,
+      graphInspector,
+      applicationConfig,
+      appOptions,
+      httpServer,
+    );
 
     const instance = new NestApplication(
       container,
       httpServer,
       applicationConfig,
+      graphInspector,
       appOptions,
     );
     const target = this.createNestInstance(instance);
@@ -91,14 +114,14 @@ export class NestFactoryStatic {
   /**
    * Creates an instance of NestMicroservice.
    *
-   * @param module Entry (root) application module class
+   * @param moduleCls Entry (root) application module class
    * @param options Optional microservice configuration
    *
    * @returns A promise that, when resolved,
    * contains a reference to the NestMicroservice instance.
    */
   public async createMicroservice<T extends object>(
-    module: any,
+    moduleCls: IEntryNestModule,
     options?: NestMicroserviceOptions & T,
   ): Promise<INestMicroservice> {
     const { NestMicroservice } = loadPackage(
@@ -108,39 +131,61 @@ export class NestFactoryStatic {
     );
     const applicationConfig = new ApplicationConfig();
     const container = new NestContainer(applicationConfig);
+    const graphInspector = this.createGraphInspector(options!, container);
+
     this.setAbortOnError(options);
     this.registerLoggerConfiguration(options);
 
-    await this.initialize(module, container, applicationConfig);
+    await this.initialize(
+      moduleCls,
+      container,
+      graphInspector,
+      applicationConfig,
+      options,
+    );
     return this.createNestInstance<INestMicroservice>(
-      new NestMicroservice(container, options, applicationConfig),
+      new NestMicroservice(
+        container,
+        options,
+        graphInspector,
+        applicationConfig,
+      ),
     );
   }
 
   /**
    * Creates an instance of NestApplicationContext.
    *
-   * @param module Entry (root) application module class
+   * @param moduleCls Entry (root) application module class
    * @param options Optional Nest application configuration
    *
    * @returns A promise that, when resolved,
    * contains a reference to the NestApplicationContext instance.
    */
   public async createApplicationContext(
-    module: any,
+    moduleCls: IEntryNestModule,
     options?: NestApplicationContextOptions,
   ): Promise<INestApplicationContext> {
-    const container = new NestContainer();
+    const applicationConfig = new ApplicationConfig();
+    const container = new NestContainer(applicationConfig);
+    const graphInspector = this.createGraphInspector(options!, container);
+
     this.setAbortOnError(options);
     this.registerLoggerConfiguration(options);
 
-    await this.initialize(module, container);
+    await this.initialize(
+      moduleCls,
+      container,
+      graphInspector,
+      applicationConfig,
+      options,
+    );
 
     const modules = container.getModules().values();
     const root = modules.next().value;
 
     const context = this.createNestInstance<NestApplicationContext>(
-      new NestApplicationContext(container, [], root),
+      new NestApplicationContext(container, options, root),
     );
     if (this.autoFlushLogs) {
       context.flushLogsOnOverride();
@@ -155,20 +200,32 @@ export class NestFactoryStatic {
   private async initialize(
     module: any,
     container: NestContainer,
+    graphInspector: GraphInspector,
     config = new ApplicationConfig(),
-    httpServer: HttpServer = null,
+    options: NestApplicationContextOptions = {},
+    httpServer: HttpServer | null = null,
   ) {
-    const instanceLoader = new InstanceLoader(container);
+    UuidFactory.mode = options.snapshot
+      ? UuidFactoryMode.Deterministic
+      : UuidFactoryMode.Random;
+
+    const injector = new Injector({ preview: options.preview! });
+    const instanceLoader = new InstanceLoader(
+      container,
+      injector,
+      graphInspector,
+    );
     const metadataScanner = new MetadataScanner();
     const dependenciesScanner = new DependenciesScanner(
       container,
       metadataScanner,
+      graphInspector,
       config,
     );
     container.setHttpAdapter(httpServer);
 
     const teardown = this.abortOnError === false ? rethrow : undefined;
-    await httpServer?.init();
+    await httpServer?.init?.();
     try {
       this.logger.log(MESSAGES.APPLICATION_START);
 
@@ -221,9 +278,13 @@ export class NestFactoryStatic {
 
     return (...args: unknown[]) => {
       let result: unknown;
-      ExceptionsZone.run(() => {
-        result = receiver[prop](...args);
-      }, teardown);
+      ExceptionsZone.run(
+        () => {
+          result = receiver[prop](...args);
+        },
+        teardown,
+        this.autoFlushLogs,
+      );
 
       return result;
     };
@@ -266,7 +327,7 @@ export class NestFactoryStatic {
     serverOrOptions?: AbstractHttpAdapter | NestApplicationOptions,
     options?: NestApplicationContextOptions | NestApplicationOptions,
   ) {
-    this.abortOnError = this.isHttpServer(serverOrOptions)
+    this.abortOnError = this.isHttpServer(serverOrOptions!)
       ? !(options && options.abortOnError === false)
       : !(serverOrOptions && serverOrOptions.abortOnError === false);
   }
@@ -278,8 +339,8 @@ export class NestFactoryStatic {
           return result instanceof Promise
             ? result.then(mapToProxy)
             : result instanceof NestApplication
-            ? proxy
-            : result;
+              ? proxy
+              : result;
         };
 
         if (!(prop in receiver) && prop in adapter) {
@@ -299,6 +360,15 @@ export class NestFactoryStatic {
     });
     return proxy as unknown as T;
   }
+
+  private createGraphInspector(
+    appOptions: NestApplicationContextOptions,
+    container: NestContainer,
+  ) {
+    return appOptions?.snapshot
+      ? new GraphInspector(container)
+      : NoopGraphInspector;
+  }
 }
 
 /**
diff --git a/packages/core/package.json b/packages/core/package.json
index 625aeb77b..ba764a123 100644
--- a/packages/core/package.json
+++ b/packages/core/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/core",
-  "version": "8.2.5",
+  "version": "10.4.11",
   "description": "Nest - modern, fast, powerful node.js web framework (@core)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -11,7 +11,8 @@
   },
   "repository": {
     "type": "git",
-    "url": "https://github.com/nestjs/nest"
+    "url": "https://github.com/nestjs/nest.git",
+    "directory": "packages/core"
   },
   "publishConfig": {
     "access": "public"
@@ -30,20 +31,19 @@
     "@nuxtjs/opencollective": "0.3.2",
     "fast-safe-stringify": "2.1.1",
     "iterare": "1.2.1",
-    "object-hash": "2.2.0",
-    "path-to-regexp": "3.2.0",
-    "tslib": "2.3.1",
-    "uuid": "8.3.2"
+    "path-to-regexp": "3.3.0",
+    "tslib": "2.7.0",
+    "uid": "2.0.2"
   },
   "devDependencies": {
-    "@nestjs/common": "8.2.5"
+    "@nestjs/common": "10.4.11"
   },
   "peerDependencies": {
-    "@nestjs/common": "^8.0.0",
-    "@nestjs/microservices": "^8.0.0",
-    "@nestjs/platform-express": "^8.0.0",
-    "@nestjs/websockets": "^8.0.0",
-    "reflect-metadata": "^0.1.12",
+    "@nestjs/common": "^10.0.0",
+    "@nestjs/microservices": "^10.0.0",
+    "@nestjs/platform-express": "^10.0.0",
+    "@nestjs/websockets": "^10.0.0",
+    "reflect-metadata": "^0.1.12 || ^0.2.0",
     "rxjs": "^7.1.0"
   },
   "peerDependenciesMeta": {
diff --git a/packages/core/pipes/index.ts b/packages/core/pipes/index.ts
new file mode 100644
index 000000000..ce7301a1d
--- /dev/null
+++ b/packages/core/pipes/index.ts
@@ -0,0 +1,3 @@
+export * from './params-token-factory';
+export * from './pipes-consumer';
+export * from './pipes-context-creator';
diff --git a/packages/core/pipes/pipes-context-creator.ts b/packages/core/pipes/pipes-context-creator.ts
index 7776f8552..0ea6568cd 100644
--- a/packages/core/pipes/pipes-context-creator.ts
+++ b/packages/core/pipes/pipes-context-creator.ts
@@ -41,12 +41,12 @@ export class PipesContextCreator extends ContextCreator {
     inquirerId?: string,
   ): R {
     if (isEmpty(metadata)) {
-      return [] as R;
+      return [] as any[] as R;
     }
     return iterate(metadata)
       .filter((pipe: any) => pipe && (pipe.name || pipe.transform))
       .map(pipe => this.getPipeInstance(pipe, contextId, inquirerId))
-      .filter(pipe => pipe && pipe.transform && isFunction(pipe.transform))
+      .filter(pipe => !!pipe && pipe.transform && isFunction(pipe.transform))
       .toArray() as R;
   }
 
@@ -55,7 +55,7 @@ export class PipesContextCreator extends ContextCreator {
     contextId = STATIC_CONTEXT,
     inquirerId?: string,
   ): PipeTransform | null {
-    const isObject = (pipe as PipeTransform).transform;
+    const isObject = !!(pipe as PipeTransform).transform;
     if (isObject) {
       return pipe as PipeTransform;
     }
@@ -64,7 +64,7 @@ export class PipesContextCreator extends ContextCreator {
       return null;
     }
     const instanceHost = instanceWrapper.getInstanceByContextId(
-      contextId,
+      this.getContextId(contextId, instanceWrapper),
       inquirerId,
     );
     return instanceHost && instanceHost.instance;
@@ -89,7 +89,7 @@ export class PipesContextCreator extends ContextCreator {
     inquirerId?: string,
   ): T {
     if (!this.config) {
-      return [] as T;
+      return [] as unknown[] as T;
     }
     const globalPipes = this.config.getGlobalPipes() as T;
     if (contextId === STATIC_CONTEXT && !inquirerId) {
@@ -98,7 +98,12 @@ export class PipesContextCreator extends ContextCreator {
     const scopedPipeWrappers =
       this.config.getGlobalRequestPipes() as InstanceWrapper[];
     const scopedPipes = iterate(scopedPipeWrappers)
-      .map(wrapper => wrapper.getInstanceByContextId(contextId, inquirerId))
+      .map(wrapper =>
+        wrapper.getInstanceByContextId(
+          this.getContextId(contextId, wrapper),
+          inquirerId,
+        ),
+      )
       .filter(host => !!host)
       .map(host => host.instance)
       .toArray();
diff --git a/packages/core/repl/assign-to-object.util.ts b/packages/core/repl/assign-to-object.util.ts
new file mode 100644
index 000000000..0ef116b6f
--- /dev/null
+++ b/packages/core/repl/assign-to-object.util.ts
@@ -0,0 +1,17 @@
+/**
+ * Similar to `Object.assign` but copying properties descriptors from `source`
+ * as well.
+ */
+export function assignToObject<T, U extends object>(
+  target: T,
+  source: U,
+): T & U {
+  Object.defineProperties(
+    target,
+    Object.keys(source).reduce((descriptors, key) => {
+      descriptors[key] = Object.getOwnPropertyDescriptor(source, key);
+      return descriptors;
+    }, Object.create(null)),
+  );
+  return target as T & U;
+}
diff --git a/packages/core/repl/constants.ts b/packages/core/repl/constants.ts
new file mode 100644
index 000000000..870e2ec51
--- /dev/null
+++ b/packages/core/repl/constants.ts
@@ -0,0 +1 @@
+export const REPL_INITIALIZED_MESSAGE = 'REPL initialized';
diff --git a/packages/core/repl/index.ts b/packages/core/repl/index.ts
new file mode 100644
index 000000000..8a399bd09
--- /dev/null
+++ b/packages/core/repl/index.ts
@@ -0,0 +1 @@
+export * from './repl';
diff --git a/packages/core/repl/native-functions/debug-repl-fn.ts b/packages/core/repl/native-functions/debug-repl-fn.ts
new file mode 100644
index 000000000..2f1d4a97d
--- /dev/null
+++ b/packages/core/repl/native-functions/debug-repl-fn.ts
@@ -0,0 +1,62 @@
+import type { Type, InjectionToken } from '@nestjs/common';
+import { clc } from '@nestjs/common/utils/cli-colors.util';
+import { ReplFunction } from '../repl-function';
+import type { ModuleDebugEntry } from '../repl-context';
+import type { ReplFnDefinition } from '../repl.interfaces';
+
+export class DebugReplFn extends ReplFunction {
+  public fnDefinition: ReplFnDefinition = {
+    name: 'debug',
+    description:
+      'Print all registered modules as a list together with their controllers and providers.\nIf the argument is passed in, for example, "debug(MyModule)" then it will only print components of this specific module.',
+    signature: '(moduleCls?: ClassRef | string) => void',
+  };
+
+  action(moduleCls?: Type<unknown> | string): void {
+    this.ctx.writeToStdout('\n');
+
+    if (moduleCls) {
+      const token =
+        typeof moduleCls === 'function' ? moduleCls.name : moduleCls;
+      const moduleEntry = this.ctx.debugRegistry[token];
+      if (!moduleEntry) {
+        return this.logger.error(
+          `"${token}" has not been found in the modules registry`,
+        );
+      }
+      this.printCtrlsAndProviders(token, moduleEntry);
+    } else {
+      Object.keys(this.ctx.debugRegistry).forEach(moduleKey => {
+        this.printCtrlsAndProviders(
+          moduleKey,
+          this.ctx.debugRegistry[moduleKey],
+        );
+      });
+    }
+    this.ctx.writeToStdout('\n');
+  }
+
+  private printCtrlsAndProviders(
+    moduleName: string,
+    moduleDebugEntry: ModuleDebugEntry,
+  ) {
+    this.ctx.writeToStdout(`${clc.green(moduleName)}:\n`);
+    this.printCollection('controllers', moduleDebugEntry['controllers']);
+    this.printCollection('providers', moduleDebugEntry['providers']);
+  }
+
+  private printCollection(
+    title: string,
+    collectionValue: Record<string, InjectionToken>,
+  ) {
+    const collectionEntries = Object.keys(collectionValue);
+    if (collectionEntries.length <= 0) {
+      return;
+    }
+
+    this.ctx.writeToStdout(` ${clc.yellow(`- ${title}`)}:\n`);
+    collectionEntries.forEach(provider =>
+      this.ctx.writeToStdout(`  ${clc.green('‚óª')} ${provider}\n`),
+    );
+  }
+}
diff --git a/packages/core/repl/native-functions/get-relp-fn.ts b/packages/core/repl/native-functions/get-relp-fn.ts
new file mode 100644
index 000000000..6de276918
--- /dev/null
+++ b/packages/core/repl/native-functions/get-relp-fn.ts
@@ -0,0 +1,17 @@
+import type { Type } from '@nestjs/common';
+import { ReplFunction } from '../repl-function';
+import type { ReplFnDefinition } from '../repl.interfaces';
+
+export class GetReplFn extends ReplFunction {
+  public fnDefinition: ReplFnDefinition = {
+    name: 'get',
+    signature: '(token: InjectionToken) => any',
+    description:
+      'Retrieves an instance of either injectable or controller, otherwise, throws exception.',
+    aliases: ['$'],
+  };
+
+  action(token: string | symbol | Function | Type<any>): any {
+    return this.ctx.app.get(token);
+  }
+}
diff --git a/packages/core/repl/native-functions/help-repl-fn.ts b/packages/core/repl/native-functions/help-repl-fn.ts
new file mode 100644
index 000000000..913ced7ee
--- /dev/null
+++ b/packages/core/repl/native-functions/help-repl-fn.ts
@@ -0,0 +1,32 @@
+import { iterate } from 'iterare';
+import { clc } from '@nestjs/common/utils/cli-colors.util';
+import { ReplFunction } from '../repl-function';
+import type { ReplFnDefinition } from '../repl.interfaces';
+
+export class HelpReplFn extends ReplFunction {
+  public fnDefinition: ReplFnDefinition = {
+    name: 'help',
+    signature: '() => void',
+    description: 'Display all available REPL native functions.',
+  };
+
+  static buildHelpMessage = ({ name, description }: ReplFnDefinition) =>
+    clc.cyanBright(name) +
+    (description ? ` ${clc.bold('-')} ${description}` : '');
+
+  action(): void {
+    const sortedNativeFunctions = iterate(this.ctx.nativeFunctions)
+      .map(([, nativeFunction]) => nativeFunction.fnDefinition)
+      .toArray()
+      .sort((a, b) => (a.name < b.name ? -1 : 1));
+
+    this.ctx.writeToStdout(
+      `You can call ${clc.bold(
+        '.help',
+      )} on any function listed below (e.g.: ${clc.bold('help.help')}):\n\n` +
+        sortedNativeFunctions.map(HelpReplFn.buildHelpMessage).join('\n') +
+        // Without the following LF the last item won't be displayed
+        '\n',
+    );
+  }
+}
diff --git a/packages/core/repl/native-functions/index.ts b/packages/core/repl/native-functions/index.ts
new file mode 100644
index 000000000..8799e685d
--- /dev/null
+++ b/packages/core/repl/native-functions/index.ts
@@ -0,0 +1,6 @@
+export * from './help-repl-fn';
+export * from './get-relp-fn';
+export * from './resolve-repl-fn';
+export * from './select-relp-fn';
+export * from './debug-repl-fn';
+export * from './methods-repl-fn';
diff --git a/packages/core/repl/native-functions/methods-repl-fn.ts b/packages/core/repl/native-functions/methods-repl-fn.ts
new file mode 100644
index 000000000..f44e1916e
--- /dev/null
+++ b/packages/core/repl/native-functions/methods-repl-fn.ts
@@ -0,0 +1,32 @@
+import type { Type } from '@nestjs/common';
+import { clc } from '@nestjs/common/utils/cli-colors.util';
+import { MetadataScanner } from '../../metadata-scanner';
+import { ReplFunction } from '../repl-function';
+import type { ReplFnDefinition } from '../repl.interfaces';
+
+export class MethodsReplFn extends ReplFunction {
+  public fnDefinition: ReplFnDefinition = {
+    name: 'methods',
+    description:
+      'Display all public methods available on a given provider or controller.',
+    signature: '(token: ClassRef | string) => void',
+  };
+
+  private readonly metadataScanner = new MetadataScanner();
+
+  action(token: Type<unknown> | string): void {
+    const proto =
+      typeof token !== 'function'
+        ? Object.getPrototypeOf(this.ctx.app.get(token))
+        : token?.prototype;
+
+    const methods = this.metadataScanner.getAllMethodNames(proto);
+
+    this.ctx.writeToStdout('\n');
+    this.ctx.writeToStdout(`${clc.green('Methods')}:\n`);
+    methods.forEach(methodName =>
+      this.ctx.writeToStdout(` ${clc.yellow('‚óª')} ${methodName}\n`),
+    );
+    this.ctx.writeToStdout('\n');
+  }
+}
diff --git a/packages/core/repl/native-functions/resolve-repl-fn.ts b/packages/core/repl/native-functions/resolve-repl-fn.ts
new file mode 100644
index 000000000..fe587682d
--- /dev/null
+++ b/packages/core/repl/native-functions/resolve-repl-fn.ts
@@ -0,0 +1,19 @@
+import type { Type } from '@nestjs/common';
+import { ReplFunction } from '../repl-function';
+import type { ReplFnDefinition } from '../repl.interfaces';
+
+export class ResolveReplFn extends ReplFunction {
+  public fnDefinition: ReplFnDefinition = {
+    name: 'resolve',
+    description:
+      'Resolves transient or request-scoped instance of either injectable or controller, otherwise, throws exception.',
+    signature: '(token: InjectionToken, contextId: any) => Promise<any>',
+  };
+
+  action(
+    token: string | symbol | Function | Type<any>,
+    contextId: any,
+  ): Promise<any> {
+    return this.ctx.app.resolve(token, contextId);
+  }
+}
diff --git a/packages/core/repl/native-functions/select-relp-fn.ts b/packages/core/repl/native-functions/select-relp-fn.ts
new file mode 100644
index 000000000..f35346cd1
--- /dev/null
+++ b/packages/core/repl/native-functions/select-relp-fn.ts
@@ -0,0 +1,20 @@
+import type {
+  DynamicModule,
+  INestApplicationContext,
+  Type,
+} from '@nestjs/common';
+import { ReplFunction } from '../repl-function';
+import type { ReplFnDefinition } from '../repl.interfaces';
+
+export class SelectReplFn extends ReplFunction {
+  public fnDefinition: ReplFnDefinition = {
+    name: 'select',
+    description:
+      'Allows navigating through the modules tree, for example, to pull out a specific instance from the selected module.',
+    signature: '(token: DynamicModule | ClassRef) => INestApplicationContext',
+  };
+
+  action(token: DynamicModule | Type<unknown>): INestApplicationContext {
+    return this.ctx.app.select(token);
+  }
+}
diff --git a/packages/core/repl/repl-context.ts b/packages/core/repl/repl-context.ts
new file mode 100644
index 000000000..f4a2fcd91
--- /dev/null
+++ b/packages/core/repl/repl-context.ts
@@ -0,0 +1,186 @@
+import {
+  INestApplicationContext,
+  InjectionToken,
+  Logger,
+} from '@nestjs/common';
+import { ApplicationConfig } from '../application-config';
+import { ModuleRef, NestContainer } from '../injector';
+import { InternalCoreModule } from '../injector/internal-core-module/internal-core-module';
+import { Module } from '../injector/module';
+import {
+  DebugReplFn,
+  GetReplFn,
+  HelpReplFn,
+  MethodsReplFn,
+  ResolveReplFn,
+  SelectReplFn,
+} from './native-functions';
+import { ReplFunction } from './repl-function';
+import type { ReplFunctionClass } from './repl.interfaces';
+
+type ModuleKey = string;
+export type ModuleDebugEntry = {
+  controllers: Record<string, InjectionToken>;
+  providers: Record<string, InjectionToken>;
+};
+
+type ReplScope = Record<string, any>;
+
+export class ReplContext {
+  public readonly logger = new Logger(ReplContext.name);
+  public debugRegistry: Record<ModuleKey, ModuleDebugEntry> = {};
+  public readonly globalScope: ReplScope = Object.create(null);
+  public readonly nativeFunctions = new Map<
+    string,
+    InstanceType<ReplFunctionClass>
+  >();
+  private readonly container: NestContainer;
+
+  constructor(
+    public readonly app: INestApplicationContext,
+    nativeFunctionsClassRefs?: ReplFunctionClass[],
+  ) {
+    this.container = (app as any).container; // Using `any` because `app.container` is not public.
+
+    this.initializeContext();
+    this.initializeNativeFunctions(nativeFunctionsClassRefs || []);
+  }
+
+  public writeToStdout(text: string) {
+    process.stdout.write(text);
+  }
+
+  private initializeContext() {
+    const modules = this.container.getModules();
+
+    modules.forEach(moduleRef => {
+      let moduleName = moduleRef.metatype.name;
+      if (moduleName === InternalCoreModule.name) {
+        return;
+      }
+      if (this.globalScope[moduleName]) {
+        moduleName += ` (${moduleRef.token})`;
+      }
+
+      this.introspectCollection(moduleRef, moduleName, 'providers');
+      this.introspectCollection(moduleRef, moduleName, 'controllers');
+
+      // For in REPL auto-complete functionality
+      Object.defineProperty(this.globalScope, moduleName, {
+        value: moduleRef.metatype,
+        configurable: false,
+        enumerable: true,
+      });
+    });
+  }
+
+  private introspectCollection(
+    moduleRef: Module,
+    moduleKey: ModuleKey,
+    collection: keyof ModuleDebugEntry,
+  ) {
+    const moduleDebugEntry = {};
+    moduleRef[collection].forEach(({ token }) => {
+      const stringifiedToken = this.stringifyToken(token);
+      if (
+        stringifiedToken === ApplicationConfig.name ||
+        stringifiedToken === moduleRef.metatype.name
+      ) {
+        return;
+      }
+
+      if (!this.globalScope[stringifiedToken]) {
+        // For in REPL auto-complete functionality
+        Object.defineProperty(this.globalScope, stringifiedToken, {
+          value: token,
+          configurable: false,
+          enumerable: true,
+        });
+      }
+
+      if (stringifiedToken === ModuleRef.name) {
+        return;
+      }
+
+      moduleDebugEntry[stringifiedToken] = token;
+    });
+
+    this.debugRegistry[moduleKey] = {
+      ...this.debugRegistry?.[moduleKey],
+      [collection]: moduleDebugEntry,
+    };
+  }
+
+  private stringifyToken(token: unknown): string {
+    return typeof token !== 'string'
+      ? typeof token === 'function'
+        ? token.name
+        : (token?.toString() as string)
+      : `"${token}"`;
+  }
+
+  private addNativeFunction(
+    NativeFunctionRef: ReplFunctionClass,
+  ): InstanceType<ReplFunctionClass>[] {
+    const nativeFunction = new NativeFunctionRef(this);
+    const nativeFunctions = [nativeFunction];
+
+    this.nativeFunctions.set(nativeFunction.fnDefinition.name, nativeFunction);
+
+    nativeFunction.fnDefinition.aliases?.forEach(aliasName => {
+      const aliasNativeFunction: InstanceType<ReplFunctionClass> =
+        Object.create(nativeFunction);
+      aliasNativeFunction.fnDefinition = {
+        name: aliasName,
+        description: aliasNativeFunction.fnDefinition.description,
+        signature: aliasNativeFunction.fnDefinition.signature,
+      };
+      this.nativeFunctions.set(aliasName, aliasNativeFunction);
+      nativeFunctions.push(aliasNativeFunction);
+    });
+
+    return nativeFunctions;
+  }
+
+  private registerFunctionIntoGlobalScope(
+    nativeFunction: InstanceType<ReplFunctionClass>,
+  ) {
+    // Bind the method to REPL's context:
+    this.globalScope[nativeFunction.fnDefinition.name] =
+      nativeFunction.action.bind(nativeFunction);
+
+    // Load the help trigger as a `help` getter on each native function:
+    const functionBoundRef: ReplFunction['action'] =
+      this.globalScope[nativeFunction.fnDefinition.name];
+    Object.defineProperty(functionBoundRef, 'help', {
+      enumerable: false,
+      configurable: false,
+      get: () =>
+        // Dynamically builds the help message as will unlikely to be called
+        // several times.
+        this.writeToStdout(nativeFunction.makeHelpMessage()),
+    });
+  }
+
+  private initializeNativeFunctions(
+    nativeFunctionsClassRefs: ReplFunctionClass[],
+  ): void {
+    const builtInFunctionsClassRefs: ReplFunctionClass[] = [
+      HelpReplFn,
+      GetReplFn,
+      ResolveReplFn,
+      SelectReplFn,
+      DebugReplFn,
+      MethodsReplFn,
+    ];
+
+    builtInFunctionsClassRefs
+      .concat(nativeFunctionsClassRefs)
+      .forEach(NativeFunction => {
+        const nativeFunctions = this.addNativeFunction(NativeFunction);
+        nativeFunctions.forEach(nativeFunction => {
+          this.registerFunctionIntoGlobalScope(nativeFunction);
+        });
+      });
+  }
+}
diff --git a/packages/core/repl/repl-function.ts b/packages/core/repl/repl-function.ts
new file mode 100644
index 000000000..aa90972c8
--- /dev/null
+++ b/packages/core/repl/repl-function.ts
@@ -0,0 +1,36 @@
+import { Logger } from '@nestjs/common';
+import { clc } from '@nestjs/common/utils/cli-colors.util';
+import { ReplContext } from './repl-context';
+import type { ReplFnDefinition } from './repl.interfaces';
+
+export abstract class ReplFunction<
+  ActionParams extends Array<unknown> = Array<unknown>,
+  ActionReturn = any,
+> {
+  /** Metadata that describes the built-in function itself. */
+  public abstract fnDefinition: ReplFnDefinition;
+
+  protected readonly logger: Logger;
+
+  constructor(protected readonly ctx: ReplContext) {
+    this.logger = ctx.logger;
+  }
+
+  /**
+   * Method called when the function is invoked from the REPL by the user.
+   */
+  abstract action(...args: ActionParams): ActionReturn;
+
+  /**
+   * @returns A message displayed by calling `<fnName>.help`
+   */
+  public makeHelpMessage(): string {
+    const { description, name, signature } = this.fnDefinition;
+
+    const fnSignatureWithName = `${name}${signature}`;
+
+    return `${clc.yellow(description)}\n${clc.magentaBright(
+      'Interface:',
+    )} ${clc.bold(fnSignatureWithName)}\n`;
+  }
+}
diff --git a/packages/core/repl/repl-logger.ts b/packages/core/repl/repl-logger.ts
new file mode 100644
index 000000000..c68744d29
--- /dev/null
+++ b/packages/core/repl/repl-logger.ts
@@ -0,0 +1,20 @@
+import { ConsoleLogger } from '@nestjs/common';
+import { NestApplication } from '../nest-application';
+import { RouterExplorer } from '../router/router-explorer';
+import { RoutesResolver } from '../router/routes-resolver';
+
+export class ReplLogger extends ConsoleLogger {
+  private static readonly ignoredContexts = [
+    RoutesResolver.name,
+    RouterExplorer.name,
+    NestApplication.name,
+  ];
+
+  log(_message: any, context?: string) {
+    if (ReplLogger.ignoredContexts.includes(context!)) {
+      return;
+    }
+    // eslint-disable-next-line
+    return super.log.apply(this, Array.from(arguments) as [any, string?]);
+  }
+}
diff --git a/packages/core/repl/repl-native-commands.ts b/packages/core/repl/repl-native-commands.ts
new file mode 100644
index 000000000..5cee6d9ff
--- /dev/null
+++ b/packages/core/repl/repl-native-commands.ts
@@ -0,0 +1,50 @@
+import type { REPLServer } from 'repl';
+
+/**
+ * Displays a list of available commands in the REPL alongside with their
+ * descriptions.
+ * (c) This code was inspired by the 'help' command from Node.js core:
+ * {@link https://github.com/nodejs/node/blob/58b60c1393dd65cd228a8b0084a19acd2c1d16aa/lib/repl.js#L1741-L1759}
+ */
+function listAllCommands(replServer: REPLServer) {
+  Object.keys(replServer.commands)
+    .sort()
+    .forEach(name => {
+      const cmd = replServer.commands[name];
+      if (cmd) {
+        replServer.output.write(`${name}\t${cmd.help || ''}\n`);
+      }
+    });
+}
+
+export function defineDefaultCommandsOnRepl(replServer: REPLServer): void {
+  replServer.defineCommand('help', {
+    help: 'Show REPL options',
+    action(name?: string) {
+      this.clearBufferedCommand();
+
+      if (name) {
+        // Considering native commands before native nestjs injected functions.
+        const nativeCommandOrFunction =
+          this.commands[name] || this.context[name];
+        // NOTE: If the command was retrieve from the context, it will have a `help`
+        // getter property that outputs the helper message and returns undefined.
+        // But if the command was retrieve from the `commands` object, it will
+        // have a `help` property that returns the helper message.
+        const helpMessage = nativeCommandOrFunction?.help;
+        if (helpMessage) {
+          this.output.write(`${helpMessage}\n`);
+        }
+      } else {
+        listAllCommands(this);
+        this.output.write('\n\n');
+        this.context.help();
+        this.output.write(
+          '\nPress Ctrl+C to abort current expression, Ctrl+D to exit the REPL\n',
+        );
+      }
+
+      this.displayPrompt();
+    },
+  });
+}
diff --git a/packages/core/repl/repl.interfaces.ts b/packages/core/repl/repl.interfaces.ts
new file mode 100644
index 000000000..ad4b8fd64
--- /dev/null
+++ b/packages/core/repl/repl.interfaces.ts
@@ -0,0 +1,21 @@
+import type { ReplContext } from './repl-context';
+import type { ReplFunction } from './repl-function';
+
+export type ReplFnDefinition = {
+  /** Function's name. Note that this should be a valid JavaScript function name. */
+  name: string;
+
+  /** Alternative names to the function. */
+  aliases?: ReplFnDefinition['name'][];
+
+  /** Function's description to display when `<function>.help` is entered. */
+  description: string;
+
+  /**
+   * Function's signature following TypeScript _function type expression_ syntax.
+   * @example '(token: InjectionToken) => any'
+   */
+  signature: string;
+};
+
+export type ReplFunctionClass = new (replContext: ReplContext) => ReplFunction;
diff --git a/packages/core/repl/repl.ts b/packages/core/repl/repl.ts
new file mode 100644
index 000000000..6bfef3c11
--- /dev/null
+++ b/packages/core/repl/repl.ts
@@ -0,0 +1,36 @@
+import { DynamicModule, Logger, Type } from '@nestjs/common';
+import { clc } from '@nestjs/common/utils/cli-colors.util';
+import { NestFactory } from '../nest-factory';
+import { assignToObject } from './assign-to-object.util';
+import { REPL_INITIALIZED_MESSAGE } from './constants';
+import { ReplContext } from './repl-context';
+import { ReplLogger } from './repl-logger';
+import { defineDefaultCommandsOnRepl } from './repl-native-commands';
+
+import type { ReplOptions } from 'repl';
+
+export async function repl(
+  module: Type | DynamicModule,
+  replOptions: ReplOptions = {},
+) {
+  const app = await NestFactory.createApplicationContext(module, {
+    abortOnError: false,
+    logger: new ReplLogger(),
+  });
+  await app.init();
+
+  const replContext = new ReplContext(app);
+  Logger.log(REPL_INITIALIZED_MESSAGE);
+
+  const _repl = await import('repl');
+  const replServer = _repl.start({
+    prompt: clc.green('> '),
+    ignoreUndefined: true,
+    ...replOptions,
+  });
+  assignToObject(replServer.context, replContext.globalScope);
+
+  defineDefaultCommandsOnRepl(replServer);
+
+  return replServer;
+}
diff --git a/packages/core/router/interfaces/exclude-route-metadata.interface.ts b/packages/core/router/interfaces/exclude-route-metadata.interface.ts
index 1c143512f..b7f93b600 100644
--- a/packages/core/router/interfaces/exclude-route-metadata.interface.ts
+++ b/packages/core/router/interfaces/exclude-route-metadata.interface.ts
@@ -1,6 +1,11 @@
 import { RequestMethod } from '@nestjs/common';
 
 export interface ExcludeRouteMetadata {
+  /**
+   * Route path.
+   */
+  path: string;
+
   /**
    * Regular expression representing the route path.
    */
diff --git a/packages/core/router/interfaces/route-params-factory.interface.ts b/packages/core/router/interfaces/route-params-factory.interface.ts
index 8d1a61c08..5420269fa 100644
--- a/packages/core/router/interfaces/route-params-factory.interface.ts
+++ b/packages/core/router/interfaces/route-params-factory.interface.ts
@@ -9,5 +9,5 @@ export interface IRouteParamsFactory {
     key: RouteParamtypes | string,
     data: any,
     { req, res, next }: { req: TRequest; res: TResponse; next: Function },
-  ): TResult;
+  ): TResult | null;
 }
diff --git a/packages/core/router/interfaces/routes.interface.ts b/packages/core/router/interfaces/routes.interface.ts
index f25475202..0193c6869 100644
--- a/packages/core/router/interfaces/routes.interface.ts
+++ b/packages/core/router/interfaces/routes.interface.ts
@@ -3,7 +3,7 @@ import { Type } from '@nestjs/common';
 export interface RouteTree {
   path: string;
   module?: Type<any>;
-  children?: Routes | Type<any>[];
+  children?: (RouteTree | Type<any>)[];
 }
 
 export type Routes = RouteTree[];
diff --git a/packages/core/router/paths-explorer.ts b/packages/core/router/paths-explorer.ts
new file mode 100644
index 000000000..eec6a7471
--- /dev/null
+++ b/packages/core/router/paths-explorer.ts
@@ -0,0 +1,84 @@
+import {
+  METHOD_METADATA,
+  PATH_METADATA,
+  VERSION_METADATA,
+} from '@nestjs/common/constants';
+import { RequestMethod } from '@nestjs/common/enums';
+import { Controller } from '@nestjs/common/interfaces/controllers/controller.interface';
+import { VersionValue } from '@nestjs/common/interfaces/version-options.interface';
+import {
+  addLeadingSlash,
+  isString,
+  isUndefined,
+} from '@nestjs/common/utils/shared.utils';
+import { MetadataScanner } from '../metadata-scanner';
+import { RouterProxyCallback } from './router-proxy';
+
+export interface RouteDefinition {
+  path: string[];
+  requestMethod: RequestMethod;
+  targetCallback: RouterProxyCallback;
+  methodName: string;
+  version?: VersionValue;
+}
+
+export class PathsExplorer {
+  constructor(private readonly metadataScanner: MetadataScanner) {}
+
+  public scanForPaths(
+    instance: Controller,
+    prototype?: object,
+  ): RouteDefinition[] {
+    const instancePrototype = isUndefined(prototype)
+      ? Object.getPrototypeOf(instance)
+      : prototype;
+
+    return this.metadataScanner
+      .getAllMethodNames(instancePrototype)
+      .reduce((acc, method) => {
+        const route = this.exploreMethodMetadata(
+          instance,
+          instancePrototype,
+          method,
+        );
+
+        if (route) {
+          acc.push(route);
+        }
+
+        return acc;
+      }, [] as RouteDefinition[]);
+  }
+
+  public exploreMethodMetadata(
+    instance: Controller,
+    prototype: object,
+    methodName: string,
+  ): RouteDefinition | null {
+    const instanceCallback = instance[methodName];
+    const prototypeCallback = prototype[methodName];
+    const routePath = Reflect.getMetadata(PATH_METADATA, prototypeCallback);
+    if (isUndefined(routePath)) {
+      return null;
+    }
+    const requestMethod: RequestMethod = Reflect.getMetadata(
+      METHOD_METADATA,
+      prototypeCallback,
+    );
+    const version: VersionValue | undefined = Reflect.getMetadata(
+      VERSION_METADATA,
+      prototypeCallback,
+    );
+    const path = isString(routePath)
+      ? [addLeadingSlash(routePath)]
+      : routePath.map((p: string) => addLeadingSlash(p));
+
+    return {
+      path,
+      requestMethod,
+      targetCallback: instanceCallback,
+      methodName,
+      version,
+    };
+  }
+}
diff --git a/packages/core/router/request/request-providers.ts b/packages/core/router/request/request-providers.ts
index 3334b7c93..308f79065 100644
--- a/packages/core/router/request/request-providers.ts
+++ b/packages/core/router/request/request-providers.ts
@@ -1,7 +1,6 @@
 import { Provider, Scope } from '@nestjs/common';
 import { REQUEST } from './request-constants';
 
-// eslint-disable-next-line @typescript-eslint/no-empty-function
 const noop = () => {};
 export const requestProvider: Provider = {
   provide: REQUEST,
diff --git a/packages/core/router/route-params-factory.ts b/packages/core/router/route-params-factory.ts
index 3192af6d8..200cb780c 100644
--- a/packages/core/router/route-params-factory.ts
+++ b/packages/core/router/route-params-factory.ts
@@ -8,9 +8,9 @@ export class RouteParamsFactory implements IRouteParamsFactory {
     TResult = any,
   >(
     key: RouteParamtypes | string,
-    data: string | object | any,
+    data: string,
     { req, res, next }: { req: TRequest; res: TResponse; next: Function },
-  ): TResult {
+  ): TResult | null {
     switch (key) {
       case RouteParamtypes.NEXT:
         return next as any;
@@ -20,9 +20,12 @@ export class RouteParamsFactory implements IRouteParamsFactory {
         return res as any;
       case RouteParamtypes.BODY:
         return data && req.body ? req.body[data] : req.body;
+      case RouteParamtypes.RAW_BODY:
+        return req.rawBody;
       case RouteParamtypes.PARAM:
         return data ? req.params[data] : req.params;
       case RouteParamtypes.HOST:
+        /* eslint-disable-next-line no-case-declarations */
         const hosts = req.hosts || {};
         return data ? hosts[data] : hosts;
       case RouteParamtypes.QUERY:
diff --git a/packages/core/router/route-path-factory.ts b/packages/core/router/route-path-factory.ts
index 78b674161..159b2ee4e 100644
--- a/packages/core/router/route-path-factory.ts
+++ b/packages/core/router/route-path-factory.ts
@@ -1,10 +1,11 @@
 import {
-  flatten,
   RequestMethod,
+  VERSION_NEUTRAL,
   VersioningOptions,
   VersioningType,
-  VERSION_NEUTRAL,
+  flatten,
 } from '@nestjs/common';
+import { VersionValue } from '@nestjs/common/interfaces';
 import {
   addLeadingSlash,
   isUndefined,
@@ -57,7 +58,14 @@ export class RoutePathFactory {
 
     if (metadata.globalPrefix) {
       paths = paths.map(path => {
-        if (this.isExcludedFromGlobalPrefix(path, requestMethod)) {
+        if (
+          this.isExcludedFromGlobalPrefix(
+            path,
+            requestMethod,
+            versionOrVersions,
+            metadata.versioningOptions,
+          )
+        ) {
           return path;
         }
         return stripEndSlash(metadata.globalPrefix || '') + path;
@@ -109,15 +117,54 @@ export class RoutePathFactory {
   public isExcludedFromGlobalPrefix(
     path: string,
     requestMethod?: RequestMethod,
+    versionOrVersions?: VersionValue,
+    versioningOptions?: VersioningOptions,
   ) {
     if (isUndefined(requestMethod)) {
       return false;
     }
     const options = this.applicationConfig.getGlobalPrefixOptions();
     const excludedRoutes = options.exclude;
+
+    if (
+      versionOrVersions &&
+      versionOrVersions !== VERSION_NEUTRAL &&
+      versioningOptions?.type === VersioningType.URI
+    ) {
+      path = this.truncateVersionPrefixFromPath(
+        path,
+        versionOrVersions,
+        versioningOptions,
+      );
+    }
     return (
       Array.isArray(excludedRoutes) &&
       isRouteExcluded(excludedRoutes, path, requestMethod)
     );
   }
+
+  private truncateVersionPrefixFromPath(
+    path: string,
+    versionValue: Exclude<VersionValue, typeof VERSION_NEUTRAL>,
+    versioningOptions: VersioningOptions,
+  ) {
+    if (typeof versionValue !== 'string') {
+      versionValue.forEach(version => {
+        if (typeof version === 'string') {
+          path = this.truncateVersionPrefixFromPath(
+            path,
+            version,
+            versioningOptions,
+          );
+        }
+      });
+      return path;
+    }
+
+    const prefix = `/${this.getVersionPrefix(
+      versioningOptions,
+    )}${versionValue}`;
+
+    return path.startsWith(prefix) ? path.replace(prefix, '') : path;
+  }
 }
diff --git a/packages/core/router/router-exception-filters.ts b/packages/core/router/router-exception-filters.ts
index 68d7f1c36..67769fa22 100644
--- a/packages/core/router/router-exception-filters.ts
+++ b/packages/core/router/router-exception-filters.ts
@@ -2,6 +2,7 @@ import { HttpServer } from '@nestjs/common';
 import { EXCEPTION_FILTERS_METADATA } from '@nestjs/common/constants';
 import { Controller } from '@nestjs/common/interfaces/controllers/controller.interface';
 import { isEmpty } from '@nestjs/common/utils/shared.utils';
+import { iterate } from 'iterare';
 import { ApplicationConfig } from '../application-config';
 import { BaseExceptionFilterContext } from '../exceptions/base-exception-filter-context';
 import { ExceptionsHandler } from '../exceptions/exceptions-handler';
@@ -9,7 +10,6 @@ import { STATIC_CONTEXT } from '../injector/constants';
 import { NestContainer } from '../injector/container';
 import { InstanceWrapper } from '../injector/instance-wrapper';
 import { RouterProxyCallback } from './router-proxy';
-import { iterate } from 'iterare';
 
 export class RouterExceptionFilters extends BaseExceptionFilterContext {
   constructor(
@@ -23,11 +23,11 @@ export class RouterExceptionFilters extends BaseExceptionFilterContext {
   public create(
     instance: Controller,
     callback: RouterProxyCallback,
-    moduleKey: string,
+    moduleKey: string | undefined,
     contextId = STATIC_CONTEXT,
     inquirerId?: string,
   ): ExceptionsHandler {
-    this.moduleContext = moduleKey;
+    this.moduleContext = moduleKey!;
 
     const exceptionHandler = new ExceptionsHandler(this.applicationRef);
     const filters = this.createContext(
diff --git a/packages/core/router/router-execution-context.ts b/packages/core/router/router-execution-context.ts
index 97e514067..d1e983834 100644
--- a/packages/core/router/router-execution-context.ts
+++ b/packages/core/router/router-execution-context.ts
@@ -7,7 +7,7 @@ import {
   RequestMethod,
 } from '@nestjs/common';
 import {
-  CUSTOM_ROUTE_AGRS_METADATA,
+  CUSTOM_ROUTE_ARGS_METADATA,
   HEADERS_METADATA,
   HTTP_CODE_METADATA,
   REDIRECT_METADATA,
@@ -21,9 +21,11 @@ import { ContextType, Controller } from '@nestjs/common/interfaces';
 import { isEmpty, isString } from '@nestjs/common/utils/shared.utils';
 import { IncomingMessage } from 'http';
 import { Observable } from 'rxjs';
-import { FORBIDDEN_MESSAGE } from '../guards/constants';
-import { GuardsConsumer } from '../guards/guards-consumer';
-import { GuardsContextCreator } from '../guards/guards-context-creator';
+import {
+  FORBIDDEN_MESSAGE,
+  GuardsConsumer,
+  GuardsContextCreator,
+} from '../guards';
 import { ContextUtils } from '../helpers/context-utils';
 import { ExecutionContextHost } from '../helpers/execution-context-host';
 import {
@@ -297,12 +299,12 @@ export class RouterExecutionContext {
       );
       const type = this.contextUtils.mapParamType(key);
 
-      if (key.includes(CUSTOM_ROUTE_AGRS_METADATA)) {
+      if (key.includes(CUSTOM_ROUTE_ARGS_METADATA)) {
         const { factory } = metadata[key];
         const customExtractValue = this.contextUtils.getCustomFactory(
           factory,
           data,
-          contextFactory,
+          contextFactory!,
         );
         return { index, extractValue: customExtractValue, type, data, pipes };
       }
@@ -313,7 +315,7 @@ export class RouterExecutionContext {
         next: Function,
       ) =>
         this.paramsFactory.exchangeKeyForValue(numericType, data, {
-          req,
+          req: req as Record<string, any>,
           res,
           next,
         });
@@ -343,6 +345,7 @@ export class RouterExecutionContext {
   public isPipeable(type: number | string): boolean {
     return (
       type === RouteParamtypes.BODY ||
+      type === RouteParamtypes.RAW_BODY ||
       type === RouteParamtypes.QUERY ||
       type === RouteParamtypes.PARAM ||
       type === RouteParamtypes.FILE ||
@@ -356,7 +359,7 @@ export class RouterExecutionContext {
     instance: Controller,
     callback: (...args: any[]) => any,
     contextType?: TContext,
-  ): (args: any[]) => Promise<void> | null {
+  ): ((args: any[]) => Promise<void>) | null {
     const canActivateFn = async (args: any[]) => {
       const canActivate = await this.guardsConsumer.tryActivate<TContext>(
         guards,
@@ -444,7 +447,7 @@ export class RouterExecutionContext {
           result,
           (res as any).raw || res,
           (req as any).raw || req,
-          { additionalHeaders: res.getHeaders?.() },
+          { additionalHeaders: res.getHeaders?.() as any },
         );
       };
     }
@@ -452,6 +455,7 @@ export class RouterExecutionContext {
       result = await this.responseController.transformToResult(result);
       !isResponseHandled &&
         (await this.responseController.apply(result, res, httpStatusCode));
+      return res;
     };
   }
 
diff --git a/packages/core/router/router-explorer.ts b/packages/core/router/router-explorer.ts
index 153bf29b4..fb6060c0b 100644
--- a/packages/core/router/router-explorer.ts
+++ b/packages/core/router/router-explorer.ts
@@ -1,29 +1,19 @@
 import { HttpServer } from '@nestjs/common';
-import {
-  METHOD_METADATA,
-  PATH_METADATA,
-  VERSION_METADATA,
-} from '@nestjs/common/constants';
-import { RequestMethod } from '@nestjs/common/enums/request-method.enum';
-import { VersioningType } from '@nestjs/common/enums/version-type.enum';
+import { PATH_METADATA } from '@nestjs/common/constants';
+import { RequestMethod, VersioningType } from '@nestjs/common/enums';
 import { InternalServerErrorException } from '@nestjs/common/exceptions';
 import { Controller } from '@nestjs/common/interfaces/controllers/controller.interface';
 import { Type } from '@nestjs/common/interfaces/type.interface';
-import {
-  VersionValue,
-  VERSION_NEUTRAL,
-} from '@nestjs/common/interfaces/version-options.interface';
+import { VersionValue } from '@nestjs/common/interfaces/version-options.interface';
 import { Logger } from '@nestjs/common/services/logger.service';
 import {
   addLeadingSlash,
-  isString,
   isUndefined,
 } from '@nestjs/common/utils/shared.utils';
 import * as pathToRegexp from 'path-to-regexp';
 import { ApplicationConfig } from '../application-config';
 import { UnknownRequestMappingException } from '../errors/exceptions/unknown-request-mapping.exception';
-import { GuardsConsumer } from '../guards/guards-consumer';
-import { GuardsContextCreator } from '../guards/guards-context-creator';
+import { GuardsConsumer, GuardsContextCreator } from '../guards';
 import { ContextIdFactory } from '../helpers/context-id-factory';
 import { ExecutionContextHost } from '../helpers/execution-context-host';
 import {
@@ -36,13 +26,20 @@ import { NestContainer } from '../injector/container';
 import { Injector } from '../injector/injector';
 import { ContextId, InstanceWrapper } from '../injector/instance-wrapper';
 import { Module } from '../injector/module';
-import { InterceptorsConsumer } from '../interceptors/interceptors-consumer';
-import { InterceptorsContextCreator } from '../interceptors/interceptors-context-creator';
+import { GraphInspector } from '../inspector/graph-inspector';
+import {
+  Entrypoint,
+  HttpEntrypointMetadata,
+} from '../inspector/interfaces/entrypoint.interface';
+import {
+  InterceptorsConsumer,
+  InterceptorsContextCreator,
+} from '../interceptors';
 import { MetadataScanner } from '../metadata-scanner';
-import { PipesConsumer } from '../pipes/pipes-consumer';
-import { PipesContextCreator } from '../pipes/pipes-context-creator';
+import { PipesConsumer, PipesContextCreator } from '../pipes';
 import { ExceptionsFilter } from './interfaces/exceptions-filter.interface';
 import { RoutePathMetadata } from './interfaces/route-path-metadata.interface';
+import { PathsExplorer } from './paths-explorer';
 import { REQUEST_CONTEXT_ID } from './request/request-constants';
 import { RouteParamsFactory } from './route-params-factory';
 import { RoutePathFactory } from './route-path-factory';
@@ -59,6 +56,7 @@ export interface RouteDefinition {
 
 export class RouterExplorer {
   private readonly executionContextCreator: RouterExecutionContext;
+  private readonly pathsExplorer: PathsExplorer;
   private readonly routerMethodFactory = new RouterMethodFactory();
   private readonly logger = new Logger(RouterExplorer.name, {
     timestamp: true,
@@ -66,14 +64,17 @@ export class RouterExplorer {
   private readonly exceptionFiltersCache = new WeakMap();
 
   constructor(
-    private readonly metadataScanner: MetadataScanner,
+    metadataScanner: MetadataScanner,
     private readonly container: NestContainer,
-    private readonly injector?: Injector,
-    private readonly routerProxy?: RouterProxy,
-    private readonly exceptionsFilter?: ExceptionsFilter,
-    private readonly config?: ApplicationConfig,
-    private readonly routePathFactory?: RoutePathFactory,
+    private readonly injector: Injector,
+    private readonly routerProxy: RouterProxy,
+    private readonly exceptionsFilter: ExceptionsFilter,
+    config: ApplicationConfig,
+    private readonly routePathFactory: RoutePathFactory,
+    private readonly graphInspector: GraphInspector,
   ) {
+    this.pathsExplorer = new PathsExplorer(metadataScanner);
+
     const routeParamsFactory = new RouteParamsFactory();
     const pipesContextCreator = new PipesContextCreator(container, config);
     const pipesConsumer = new PipesConsumer();
@@ -105,7 +106,7 @@ export class RouterExplorer {
     routePathMetadata: RoutePathMetadata,
   ) {
     const { instance } = instanceWrapper;
-    const routerPaths = this.scanForPaths(instance);
+    const routerPaths = this.pathsExplorer.scanForPaths(instance);
     this.applyPathsToRouterProxy(
       applicationRef,
       routerPaths,
@@ -120,7 +121,7 @@ export class RouterExplorer {
     const path = Reflect.getMetadata(PATH_METADATA, metatype);
 
     if (isUndefined(path)) {
-      throw new UnknownRequestMappingException();
+      throw new UnknownRequestMappingException(metatype);
     }
     if (Array.isArray(path)) {
       return path.map(p => addLeadingSlash(p));
@@ -128,53 +129,6 @@ export class RouterExplorer {
     return [addLeadingSlash(path)];
   }
 
-  public scanForPaths(
-    instance: Controller,
-    prototype?: object,
-  ): RouteDefinition[] {
-    const instancePrototype = isUndefined(prototype)
-      ? Object.getPrototypeOf(instance)
-      : prototype;
-
-    return this.metadataScanner.scanFromPrototype<Controller, RouteDefinition>(
-      instance,
-      instancePrototype,
-      method => this.exploreMethodMetadata(instance, instancePrototype, method),
-    );
-  }
-
-  public exploreMethodMetadata(
-    instance: Controller,
-    prototype: object,
-    methodName: string,
-  ): RouteDefinition {
-    const instanceCallback = instance[methodName];
-    const prototypeCallback = prototype[methodName];
-    const routePath = Reflect.getMetadata(PATH_METADATA, prototypeCallback);
-    if (isUndefined(routePath)) {
-      return null;
-    }
-    const requestMethod: RequestMethod = Reflect.getMetadata(
-      METHOD_METADATA,
-      prototypeCallback,
-    );
-    const version: VersionValue | undefined = Reflect.getMetadata(
-      VERSION_METADATA,
-      prototypeCallback,
-    );
-    const path = isString(routePath)
-      ? [addLeadingSlash(routePath)]
-      : routePath.map((p: string) => addLeadingSlash(p));
-
-    return {
-      path,
-      requestMethod,
-      targetCallback: instanceCallback,
-      methodName,
-      version,
-    };
-  }
-
   public applyPathsToRouterProxy<T extends HttpServer>(
     router: T,
     routeDefinitions: RouteDefinition[],
@@ -223,7 +177,7 @@ export class RouterExplorer {
       ? this.createRequestScopedHandler(
           instanceWrapper,
           requestMethod,
-          this.container.getModuleByKey(moduleKey),
+          this.container.getModuleByKey(moduleKey)!,
           moduleKey,
           methodName,
         )
@@ -244,7 +198,7 @@ export class RouterExplorer {
     paths.forEach(path => {
       if (
         isVersioned &&
-        routePathMetadata.versioningOptions.type !== VersioningType.URI
+        routePathMetadata.versioningOptions!.type !== VersioningType.URI
       ) {
         // All versioning (except for URI Versioning) is done via the "Version Filter"
         routeHandler = this.applyVersionFilter(
@@ -259,7 +213,31 @@ export class RouterExplorer {
         routePathMetadata,
         requestMethod,
       );
-      pathsToRegister.forEach(path => routerMethodRef(path, routeHandler));
+      pathsToRegister.forEach(path => {
+        const entrypointDefinition: Entrypoint<HttpEntrypointMetadata> = {
+          type: 'http-endpoint',
+          methodName,
+          className: instanceWrapper.name,
+          classNodeId: instanceWrapper.id,
+          metadata: {
+            key: path,
+            path,
+            requestMethod: RequestMethod[
+              requestMethod
+            ] as keyof typeof RequestMethod,
+            methodVersion: routePathMetadata.methodVersion,
+            controllerVersion: routePathMetadata.controllerVersion,
+          },
+        };
+
+        this.copyMetadataToCallback(targetCallback, routeHandler);
+        routerMethodRef(path, routeHandler);
+
+        this.graphInspector.insertEntrypointDefinition<HttpEntrypointMetadata>(
+          entrypointDefinition,
+          instanceWrapper.id,
+        );
+      });
 
       const pathsToLog = this.routePathFactory.create(
         {
@@ -272,7 +250,7 @@ export class RouterExplorer {
         if (isVersioned) {
           const version = this.routePathFactory.getVersion(routePathMetadata);
           this.logger.log(
-            VERSIONED_ROUTE_MAPPED_MESSAGE(path, requestMethod, version),
+            VERSIONED_ROUTE_MAPPED_MESSAGE(path, requestMethod, version!),
           );
         } else {
           this.logger.log(ROUTE_MAPPED_MESSAGE(path, requestMethod));
@@ -292,7 +270,7 @@ export class RouterExplorer {
     const httpAdapterRef = this.container.getHttpAdapterRef();
     const hosts = Array.isArray(host) ? host : [host];
     const hostRegExps = hosts.map((host: string | RegExp) => {
-      const keys = [];
+      const keys: any[] = [];
       const regexp = pathToRegexp(host, keys);
       return { regexp, keys };
     });
@@ -314,7 +292,13 @@ export class RouterExplorer {
       for (const exp of hostRegExps) {
         const match = hostname.match(exp.regexp);
         if (match) {
-          exp.keys.forEach((key, i) => (req.hosts[key.name] = match[i + 1]));
+          if (exp.keys.length > 0) {
+            exp.keys.forEach((key, i) => (req.hosts[key.name] = match[i + 1]));
+          } else if (exp.regexp && match.groups) {
+            for (const groupName in match.groups) {
+              req.hosts[groupName] = match.groups[groupName];
+            }
+          }
           return handler(req, res, next);
         }
       }
@@ -332,80 +316,12 @@ export class RouterExplorer {
     routePathMetadata: RoutePathMetadata,
     handler: Function,
   ) {
-    const { versioningOptions } = routePathMetadata;
-    const version = this.routePathFactory.getVersion(routePathMetadata);
-    if (router?.applyVersionFilter) {
-      return router.applyVersionFilter(handler, version, versioningOptions);
-    }
-    /**
-     * This can be removed in the next major release.
-     * Left for backward-compatibility.
-     */
-    return <TRequest extends Record<string, any> = any, TResponse = any>(
-      req: TRequest,
-      res: TResponse,
-      next: () => void,
-    ) => {
-      if (version === VERSION_NEUTRAL) {
-        return handler(req, res, next);
-      }
-      // URL Versioning is done via the path, so the filter continues forward
-      if (versioningOptions.type === VersioningType.URI) {
-        return handler(req, res, next);
-      }
-      // Media Type (Accept Header) Versioning Handler
-      if (versioningOptions.type === VersioningType.MEDIA_TYPE) {
-        const MEDIA_TYPE_HEADER = 'Accept';
-        const acceptHeaderValue: string | undefined =
-          req.headers?.[MEDIA_TYPE_HEADER] ||
-          req.headers?.[MEDIA_TYPE_HEADER.toLowerCase()];
-
-        const acceptHeaderVersionParameter = acceptHeaderValue
-          ? acceptHeaderValue.split(';')[1]
-          : '';
-
-        if (acceptHeaderVersionParameter) {
-          const headerVersion = acceptHeaderVersionParameter.split(
-            versioningOptions.key,
-          )[1];
-
-          if (Array.isArray(version)) {
-            if (version.includes(headerVersion)) {
-              return handler(req, res, next);
-            }
-          } else if (isString(version)) {
-            if (version === headerVersion) {
-              return handler(req, res, next);
-            }
-          }
-        }
-      }
-      // Header Versioning Handler
-      else if (versioningOptions.type === VersioningType.HEADER) {
-        const customHeaderVersionParameter: string | undefined =
-          req.headers?.[versioningOptions.header] ||
-          req.headers?.[versioningOptions.header.toLowerCase()];
-
-        if (customHeaderVersionParameter) {
-          if (Array.isArray(version)) {
-            if (version.includes(customHeaderVersionParameter)) {
-              return handler(req, res, next);
-            }
-          } else if (isString(version)) {
-            if (version === customHeaderVersionParameter) {
-              return handler(req, res, next);
-            }
-          }
-        }
-      }
-
-      if (!next) {
-        throw new InternalServerErrorException(
-          'HTTP adapter does not support filtering on version',
-        );
-      }
-      return next();
-    };
+    const version = this.routePathFactory.getVersion(routePathMetadata)!;
+    return router.applyVersionFilter(
+      handler,
+      version,
+      routePathMetadata.versioningOptions!,
+    );
   }
 
   private createCallbackProxy(
@@ -445,13 +361,16 @@ export class RouterExplorer {
   ) {
     const { instance } = instanceWrapper;
     const collection = moduleRef.controllers;
+
+    const isTreeDurable = instanceWrapper.isDependencyTreeDurable();
+
     return async <TRequest extends Record<any, any>, TResponse>(
       req: TRequest,
       res: TResponse,
       next: () => void,
     ) => {
       try {
-        const contextId = this.getContextId(req);
+        const contextId = this.getContextId(req, isTreeDurable);
         const contextInstance = await this.injector.loadPerContext(
           instance,
           moduleRef,
@@ -487,6 +406,7 @@ export class RouterExplorer {
 
   private getContextId<T extends Record<any, unknown> = any>(
     request: T,
+    isTreeDurable: boolean,
   ): ContextId {
     const contextId = ContextIdFactory.getByRequest(request);
     if (!request[REQUEST_CONTEXT_ID as any]) {
@@ -496,8 +416,25 @@ export class RouterExplorer {
         writable: false,
         configurable: false,
       });
-      this.container.registerRequestProvider(request, contextId);
+
+      const requestProviderValue = isTreeDurable
+        ? contextId.payload
+        : Object.assign(request, contextId.payload);
+      this.container.registerRequestProvider(requestProviderValue, contextId);
     }
     return contextId;
   }
+
+  private copyMetadataToCallback(
+    originalCallback: RouterProxyCallback,
+    targetCallback: Function,
+  ) {
+    for (const key of Reflect.getMetadataKeys(originalCallback)) {
+      Reflect.defineMetadata(
+        key,
+        Reflect.getMetadata(key, originalCallback),
+        targetCallback,
+      );
+    }
+  }
 }
diff --git a/packages/core/router/router-module.ts b/packages/core/router/router-module.ts
index 333ef41ae..72162dcdb 100644
--- a/packages/core/router/router-module.ts
+++ b/packages/core/router/router-module.ts
@@ -39,8 +39,8 @@ export class RouterModule {
   }
 
   private deepCloneRoutes(
-    routes: Routes | Type<any>[],
-  ): Routes | Array<Type<any>> {
+    routes: (RouteTree | Type<any>)[],
+  ): (RouteTree | Type<any>)[] {
     return routes.map((routeOrType: Type<any> | RouteTree) => {
       if (typeof routeOrType === 'function') {
         return routeOrType;
@@ -52,7 +52,7 @@ export class RouterModule {
         };
       }
       return { ...routeOrType };
-    }) as Routes | Array<Type<any>>;
+    });
   }
 
   private initialize() {
@@ -78,7 +78,7 @@ export class RouterModule {
   private updateTargetModulesCache(moduleCtor: Type<unknown>) {
     let moduleClassSet: WeakSet<ModuleClass>;
     if (targetModulesByContainer.has(this.modulesContainer)) {
-      moduleClassSet = targetModulesByContainer.get(this.modulesContainer);
+      moduleClassSet = targetModulesByContainer.get(this.modulesContainer)!;
     } else {
       moduleClassSet = new WeakSet<ModuleClass>();
       targetModulesByContainer.set(this.modulesContainer, moduleClassSet);
diff --git a/packages/core/router/router-proxy.ts b/packages/core/router/router-proxy.ts
index c1384e545..bf60595cd 100644
--- a/packages/core/router/router-proxy.ts
+++ b/packages/core/router/router-proxy.ts
@@ -2,10 +2,10 @@ import { ExceptionsHandler } from '../exceptions/exceptions-handler';
 import { ExecutionContextHost } from '../helpers/execution-context-host';
 
 export type RouterProxyCallback = <TRequest, TResponse>(
-  req?: TRequest,
-  res?: TResponse,
-  next?: () => void,
-) => void;
+  req: TRequest,
+  res: TResponse,
+  next: () => void,
+) => void | Promise<void>;
 
 export class RouterProxy {
   public createProxy(
@@ -22,6 +22,7 @@ export class RouterProxy {
       } catch (e) {
         const host = new ExecutionContextHost([req, res, next]);
         exceptionsHandler.next(e, host);
+        return res;
       }
     };
   }
@@ -32,7 +33,7 @@ export class RouterProxy {
       req: TRequest,
       res: TResponse,
       next: () => void,
-    ) => void,
+    ) => void | Promise<void>,
     exceptionsHandler: ExceptionsHandler,
   ) {
     return async <TError, TRequest, TResponse>(
@@ -46,6 +47,7 @@ export class RouterProxy {
       } catch (e) {
         const host = new ExecutionContextHost([req, res, next]);
         exceptionsHandler.next(e, host);
+        return res;
       }
     };
   }
diff --git a/packages/core/router/router-response-controller.ts b/packages/core/router/router-response-controller.ts
index 008eea5a8..e66544a1d 100644
--- a/packages/core/router/router-response-controller.ts
+++ b/packages/core/router/router-response-controller.ts
@@ -5,10 +5,10 @@ import {
   RequestMethod,
   MessageEvent,
 } from '@nestjs/common';
-import { isFunction, isObject } from '@nestjs/common/utils/shared.utils';
+import { isObject } from '@nestjs/common/utils/shared.utils';
 import { IncomingMessage } from 'http';
-import { EMPTY, lastValueFrom, Observable } from 'rxjs';
-import { catchError, debounce, map } from 'rxjs/operators';
+import { EMPTY, lastValueFrom, Observable, isObservable } from 'rxjs';
+import { catchError, concatMap, map } from 'rxjs/operators';
 import {
   AdditionalHeaders,
   WritableHeaderStream,
@@ -17,7 +17,7 @@ import {
 
 export interface CustomHeader {
   name: string;
-  value: string;
+  value: string | (() => string);
 }
 
 export interface RedirectResponse {
@@ -48,8 +48,8 @@ export class RouterResponseController {
       result && result.statusCode
         ? result.statusCode
         : redirectResponse.statusCode
-        ? redirectResponse.statusCode
-        : HttpStatus.FOUND;
+          ? redirectResponse.statusCode
+          : HttpStatus.FOUND;
     const url = result && result.url ? result.url : redirectResponse.url;
     this.applicationRef.redirect(response, statusCode, url);
   }
@@ -64,7 +64,7 @@ export class RouterResponseController {
   }
 
   public async transformToResult(resultOrDeferred: any) {
-    if (resultOrDeferred && isFunction(resultOrDeferred.subscribe)) {
+    if (isObservable(resultOrDeferred)) {
       return lastValueFrom(resultOrDeferred);
     }
     return resultOrDeferred;
@@ -84,7 +84,11 @@ export class RouterResponseController {
     headers: CustomHeader[],
   ) {
     headers.forEach(({ name, value }) =>
-      this.applicationRef.setHeader(response, name, value),
+      this.applicationRef.setHeader(
+        response,
+        name,
+        typeof value === 'function' ? value() : value,
+      ),
     );
   }
 
@@ -124,7 +128,7 @@ export class RouterResponseController {
 
           return { data: message as object | string };
         }),
-        debounce(
+        concatMap(
           message =>
             new Promise<void>(resolve =>
               stream.writeMessage(message, () => resolve()),
@@ -149,11 +153,14 @@ export class RouterResponseController {
 
     request.on('close', () => {
       subscription.unsubscribe();
+      if (!stream.writableEnded) {
+        stream.end();
+      }
     });
   }
 
-  private assertObservable(result: any) {
-    if (!isFunction(result.subscribe)) {
+  private assertObservable(value: any) {
+    if (!isObservable(value)) {
       throw new ReferenceError(
         'You must return an Observable stream to use Server-Sent Events (SSE).',
       );
diff --git a/packages/core/router/routes-resolver.ts b/packages/core/router/routes-resolver.ts
index f342df916..abc0eb7d4 100644
--- a/packages/core/router/routes-resolver.ts
+++ b/packages/core/router/routes-resolver.ts
@@ -4,9 +4,12 @@ import {
   MODULE_PATH,
   VERSION_METADATA,
 } from '@nestjs/common/constants';
-import { HttpServer, Type } from '@nestjs/common/interfaces';
-import { Controller } from '@nestjs/common/interfaces/controllers/controller.interface';
-import { VersionValue } from '@nestjs/common/interfaces/version-options.interface';
+import {
+  Controller,
+  HttpServer,
+  Type,
+  VersionValue,
+} from '@nestjs/common/interfaces';
 import { Logger } from '@nestjs/common/services/logger.service';
 import { ApplicationConfig } from '../application-config';
 import {
@@ -16,6 +19,7 @@ import {
 import { NestContainer } from '../injector/container';
 import { Injector } from '../injector/injector';
 import { InstanceWrapper } from '../injector/instance-wrapper';
+import { GraphInspector } from '../inspector/graph-inspector';
 import { MetadataScanner } from '../metadata-scanner';
 import { Resolver } from './interfaces/resolver.interface';
 import { RoutePathMetadata } from './interfaces/route-path-metadata.interface';
@@ -37,6 +41,7 @@ export class RoutesResolver implements Resolver {
     private readonly container: NestContainer,
     private readonly applicationConfig: ApplicationConfig,
     private readonly injector: Injector,
+    graphInspector: GraphInspector,
   ) {
     const httpAdapterRef = container.getHttpAdapterRef();
     this.routerExceptionsFilter = new RouterExceptionFilters(
@@ -55,6 +60,7 @@ export class RoutesResolver implements Resolver {
       this.routerExceptionsFilter,
       this.applicationConfig,
       this.routePathFactory,
+      graphInspector,
     );
   }
 
@@ -64,7 +70,7 @@ export class RoutesResolver implements Resolver {
   ) {
     const modules = this.container.getModules();
     modules.forEach(({ controllers, metatype }, moduleName) => {
-      const modulePath = this.getModulePathMetadata(metatype);
+      const modulePath = this.getModulePathMetadata(metatype)!;
       this.registerRouters(
         controllers,
         moduleName,
@@ -85,12 +91,12 @@ export class RoutesResolver implements Resolver {
     routes.forEach(instanceWrapper => {
       const { metatype } = instanceWrapper;
 
-      const host = this.getHostMetadata(metatype);
+      const host = this.getHostMetadata(metatype!);
       const routerPaths = this.routerExplorer.extractRouterPath(
         metatype as Type<any>,
       );
-      const controllerVersion = this.getVersionMetadata(metatype);
-      const controllerName = metatype.name;
+      const controllerVersion = this.getVersionMetadata(metatype!);
+      const controllerName = metatype!.name;
 
       routerPaths.forEach(path => {
         const pathsToLog = this.routePathFactory.create({
@@ -126,7 +132,7 @@ export class RoutesResolver implements Resolver {
           instanceWrapper,
           moduleName,
           applicationRef,
-          host,
+          host!,
           routePathMetadata,
         );
       });
@@ -174,7 +180,10 @@ export class RoutesResolver implements Resolver {
 
   public mapExternalException(err: any) {
     switch (true) {
-      case err instanceof SyntaxError:
+      // SyntaxError is thrown by Express body-parser when given invalid JSON (#422, #430)
+      // URIError is thrown by Express when given a path parameter with an invalid percentage
+      // encoding, e.g. '%FF' (#8915)
+      case err instanceof SyntaxError || err instanceof URIError:
         return new BadRequestException(err.message);
       default:
         return err;
diff --git a/packages/core/router/sse-stream.ts b/packages/core/router/sse-stream.ts
index ec583cb15..a354c8a89 100644
--- a/packages/core/router/sse-stream.ts
+++ b/packages/core/router/sse-stream.ts
@@ -51,7 +51,7 @@ export type HeaderStream = WritableHeaderStream & ReadHeaders;
  * If this stream is piped to an HTTP Response, it will set appropriate headers.
  */
 export class SseStream extends Transform {
-  private lastEventId: number = null;
+  private lastEventId: number | null = null;
 
   constructor(req?: IncomingMessage) {
     super({ objectMode: true });
@@ -83,10 +83,10 @@ export class SseStream extends Transform {
         // NGINX support https://www.nginx.com/resources/wiki/start/topics/examples/x-accel/#x-accel-buffering
         'X-Accel-Buffering': 'no',
       });
-      destination.flushHeaders();
+      destination.flushHeaders?.();
     }
 
-    destination.write(':\n');
+    destination.write('\n');
     return super.pipe(destination, options);
   }
 
@@ -112,11 +112,11 @@ export class SseStream extends Transform {
     cb: (error: Error | null | undefined) => void,
   ) {
     if (!message.id) {
-      this.lastEventId++;
-      message.id = this.lastEventId.toString();
+      this.lastEventId!++;
+      message.id = this.lastEventId!.toString();
     }
 
-    if (!this.write(message, 'utf-8', cb)) {
+    if (!this.write(message, 'utf-8')) {
       this.once('drain', cb);
     } else {
       process.nextTick(cb);
diff --git a/packages/core/router/utils/exclude-route.util.ts b/packages/core/router/utils/exclude-route.util.ts
index 798260bf2..8670f18f4 100644
--- a/packages/core/router/utils/exclude-route.util.ts
+++ b/packages/core/router/utils/exclude-route.util.ts
@@ -1,4 +1,5 @@
 import { RequestMethod } from '@nestjs/common';
+import { addLeadingSlash } from '@nestjs/common/utils/shared.utils';
 import { ExcludeRouteMetadata } from '../interfaces/exclude-route-metadata.interface';
 
 export const isRequestMethodAll = (method: RequestMethod) => {
@@ -15,7 +16,7 @@ export function isRouteExcluded(
       isRequestMethodAll(route.requestMethod) ||
       route.requestMethod === requestMethod
     ) {
-      return route.pathRegex.exec(path);
+      return route.pathRegex.exec(addLeadingSlash(path));
     }
     return false;
   });
diff --git a/packages/core/router/utils/flatten-route-paths.util.ts b/packages/core/router/utils/flatten-route-paths.util.ts
index cbb411f25..fe0cff258 100644
--- a/packages/core/router/utils/flatten-route-paths.util.ts
+++ b/packages/core/router/utils/flatten-route-paths.util.ts
@@ -1,8 +1,12 @@
-import { normalizePath, isString } from '@nestjs/common/utils/shared.utils';
+import { Type } from '@nestjs/common';
+import { isString, normalizePath } from '@nestjs/common/utils/shared.utils';
 import { Routes } from '../interfaces/routes.interface';
 
 export function flattenRoutePaths(routes: Routes) {
-  const result = [];
+  const result: Array<{
+    module: Type;
+    path: string;
+  }> = [];
   routes.forEach(item => {
     if (item.module && item.path) {
       result.push({ module: item.module, path: item.path });
@@ -15,7 +19,7 @@ export function flattenRoutePaths(routes: Routes) {
             normalizePath(item.path) + normalizePath(child.path),
           );
         } else {
-          result.push({ path: item.path, module: child });
+          result.push({ path: item.path, module: child as any as Type });
         }
       });
       result.push(...flattenRoutePaths(childrenRef));
diff --git a/packages/core/scanner.ts b/packages/core/scanner.ts
index c318dba07..e96bc2b6a 100644
--- a/packages/core/scanner.ts
+++ b/packages/core/scanner.ts
@@ -1,18 +1,13 @@
+import { DynamicModule, ForwardReference, Provider } from '@nestjs/common';
 import {
-  Abstract,
-  DynamicModule,
-  flatten,
-  ForwardReference,
-  Provider,
-  Logger,
-} from '@nestjs/common';
-import {
+  CATCH_WATERMARK,
+  CONTROLLER_WATERMARK,
+  ENHANCER_KEY_TO_SUBTYPE_MAP,
   EXCEPTION_FILTERS_METADATA,
+  EnhancerSubtype,
   GUARDS_METADATA,
-  INTERCEPTORS_METADATA,
   INJECTABLE_WATERMARK,
-  CONTROLLER_WATERMARK,
-  CATCH_WATERMARK,
+  INTERCEPTORS_METADATA,
   MODULE_METADATA,
   PIPES_METADATA,
   ROUTE_ARGS_METADATA,
@@ -20,18 +15,18 @@ import {
 import {
   CanActivate,
   ClassProvider,
+  Controller,
   ExceptionFilter,
   ExistingProvider,
   FactoryProvider,
+  Injectable,
+  InjectionToken,
   NestInterceptor,
   PipeTransform,
   Scope,
+  Type,
   ValueProvider,
 } from '@nestjs/common/interfaces';
-import { Controller } from '@nestjs/common/interfaces/controllers/controller.interface';
-import { Injectable } from '@nestjs/common/interfaces/injectable.interface';
-import { Type } from '@nestjs/common/interfaces/type.interface';
-import { randomStringGenerator } from '@nestjs/common/utils/random-string-generator.util';
 import {
   isFunction,
   isNil,
@@ -39,60 +34,90 @@ import {
 } from '@nestjs/common/utils/shared.utils';
 import { iterate } from 'iterare';
 import { ApplicationConfig } from './application-config';
-import { APP_FILTER, APP_GUARD, APP_INTERCEPTOR, APP_PIPE } from './constants';
+import {
+  APP_FILTER,
+  APP_GUARD,
+  APP_INTERCEPTOR,
+  APP_PIPE,
+  ENHANCER_TOKEN_TO_SUBTYPE_MAP,
+} from './constants';
 import { CircularDependencyException } from './errors/exceptions/circular-dependency.exception';
-import { InvalidModuleException } from './errors/exceptions/invalid-module.exception';
 import { InvalidClassModuleException } from './errors/exceptions/invalid-class-module.exception';
+import { InvalidModuleException } from './errors/exceptions/invalid-module.exception';
 import { UndefinedModuleException } from './errors/exceptions/undefined-module.exception';
 import { getClassScope } from './helpers/get-class-scope';
 import { NestContainer } from './injector/container';
 import { InstanceWrapper } from './injector/instance-wrapper';
-import { InternalCoreModuleFactory } from './injector/internal-core-module-factory';
+import { InternalCoreModuleFactory } from './injector/internal-core-module/internal-core-module-factory';
 import { Module } from './injector/module';
+import { GraphInspector } from './inspector/graph-inspector';
+import { UuidFactory } from './inspector/uuid-factory';
+import { ModuleDefinition } from './interfaces/module-definition.interface';
+import { ModuleOverride } from './interfaces/module-override.interface';
 import { MetadataScanner } from './metadata-scanner';
 
 interface ApplicationProviderWrapper {
   moduleKey: string;
   providerKey: string;
-  type: string | symbol | Type<any> | Abstract<any> | Function;
+  type: InjectionToken;
   scope?: Scope;
 }
 
+interface ModulesScanParameters {
+  moduleDefinition: ModuleDefinition;
+  scope?: Type<unknown>[];
+  ctxRegistry?: (ForwardReference | DynamicModule | Type<unknown>)[];
+  overrides?: ModuleOverride[];
+  lazy?: boolean;
+}
+
 export class DependenciesScanner {
-  private readonly logger = new Logger(DependenciesScanner.name);
   private readonly applicationProvidersApplyMap: ApplicationProviderWrapper[] =
     [];
 
   constructor(
     private readonly container: NestContainer,
     private readonly metadataScanner: MetadataScanner,
+    private readonly graphInspector: GraphInspector,
     private readonly applicationConfig = new ApplicationConfig(),
   ) {}
 
-  public async scan(module: Type<any>) {
-    await this.registerCoreModule();
-    await this.scanForModules(module);
+  public async scan(
+    module: Type<any>,
+    options?: { overrides?: ModuleOverride[] },
+  ) {
+    await this.registerCoreModule(options?.overrides);
+    await this.scanForModules({
+      moduleDefinition: module,
+      overrides: options?.overrides,
+    });
     await this.scanModulesForDependencies();
-    this.calculateModulesDistance();
-
     this.addScopedEnhancersMetadata();
     this.container.bindGlobalScope();
+
+    this.calculateModulesDistance();
   }
 
-  public async scanForModules(
-    moduleDefinition:
-      | ForwardReference
-      | Type<unknown>
-      | DynamicModule
-      | Promise<DynamicModule>,
-    scope: Type<unknown>[] = [],
-    ctxRegistry: (ForwardReference | DynamicModule | Type<unknown>)[] = [],
-  ): Promise<Module[]> {
-    const moduleInstance = await this.insertModule(moduleDefinition, scope);
+  public async scanForModules({
+    moduleDefinition,
+    lazy,
+    scope = [],
+    ctxRegistry = [],
+    overrides = [],
+  }: ModulesScanParameters): Promise<Module[]> {
+    const { moduleRef: moduleInstance, inserted: moduleInserted } =
+      (await this.insertOrOverrideModule(moduleDefinition, overrides, scope)) ??
+      {};
+
+    moduleDefinition =
+      this.getOverrideModuleByModule(moduleDefinition, overrides)?.newModule ??
+      moduleDefinition;
+
     moduleDefinition =
       moduleDefinition instanceof Promise
         ? await moduleDefinition
         : moduleDefinition;
+
     ctxRegistry.push(moduleDefinition);
 
     if (this.isForwardReference(moduleDefinition)) {
@@ -102,18 +127,18 @@ export class DependenciesScanner {
       moduleDefinition as Type<any> | DynamicModule,
     )
       ? this.reflectMetadata(
-          moduleDefinition as Type<any>,
           MODULE_METADATA.IMPORTS,
+          moduleDefinition as Type<any>,
         )
       : [
           ...this.reflectMetadata(
-            (moduleDefinition as DynamicModule).module,
             MODULE_METADATA.IMPORTS,
+            (moduleDefinition as DynamicModule).module,
           ),
           ...((moduleDefinition as DynamicModule).imports || []),
         ];
 
-    let registeredModuleRefs = [];
+    let registeredModuleRefs: Module[] = [];
     for (const [index, innerModule] of modules.entries()) {
       // In case of a circular dependency (ES module system), JavaScript will resolve the type to `undefined`.
       if (innerModule === undefined) {
@@ -125,23 +150,35 @@ export class DependenciesScanner {
       if (ctxRegistry.includes(innerModule)) {
         continue;
       }
-      const moduleRefs = await this.scanForModules(
-        innerModule,
-        [].concat(scope, moduleDefinition),
+      const moduleRefs = await this.scanForModules({
+        moduleDefinition: innerModule,
+        scope: ([] as Array<Type>).concat(scope, moduleDefinition as Type),
         ctxRegistry,
-      );
+        overrides,
+        lazy,
+      });
       registeredModuleRefs = registeredModuleRefs.concat(moduleRefs);
     }
     if (!moduleInstance) {
       return registeredModuleRefs;
     }
+
+    if (lazy && moduleInserted) {
+      this.container.bindGlobalsToImports(moduleInstance);
+    }
     return [moduleInstance].concat(registeredModuleRefs);
   }
 
   public async insertModule(
     moduleDefinition: any,
     scope: Type<unknown>[],
-  ): Promise<Module | undefined> {
+  ): Promise<
+    | {
+        moduleRef: Module;
+        inserted: boolean;
+      }
+    | undefined
+  > {
     const moduleToAdd = this.isForwardReference(moduleDefinition)
       ? moduleDefinition.forwardRef()
       : moduleDefinition;
@@ -151,10 +188,7 @@ export class DependenciesScanner {
       this.isController(moduleToAdd) ||
       this.isExceptionFilter(moduleToAdd)
     ) {
-      // TODO(v9): Throw the exception instead of printing a warning
-      this.logger.warn(
-        new InvalidClassModuleException(moduleDefinition, scope).message,
-      );
+      throw new InvalidClassModuleException(moduleDefinition, scope);
     }
 
     return this.container.addModule(moduleToAdd, scope);
@@ -177,11 +211,11 @@ export class DependenciesScanner {
     context: string,
   ) {
     const modules = [
-      ...this.reflectMetadata(module, MODULE_METADATA.IMPORTS),
+      ...this.reflectMetadata(MODULE_METADATA.IMPORTS, module),
       ...this.container.getDynamicMetadataByToken(
         token,
         MODULE_METADATA.IMPORTS as 'imports',
-      ),
+      )!,
     ];
     for (const related of modules) {
       await this.insertImport(related, token, context);
@@ -190,11 +224,11 @@ export class DependenciesScanner {
 
   public reflectProviders(module: Type<any>, token: string) {
     const providers = [
-      ...this.reflectMetadata(module, MODULE_METADATA.PROVIDERS),
+      ...this.reflectMetadata(MODULE_METADATA.PROVIDERS, module),
       ...this.container.getDynamicMetadataByToken(
         token,
         MODULE_METADATA.PROVIDERS as 'providers',
-      ),
+      )!,
     ];
     providers.forEach(provider => {
       this.insertProvider(provider, token);
@@ -204,11 +238,11 @@ export class DependenciesScanner {
 
   public reflectControllers(module: Type<any>, token: string) {
     const controllers = [
-      ...this.reflectMetadata(module, MODULE_METADATA.CONTROLLERS),
+      ...this.reflectMetadata(MODULE_METADATA.CONTROLLERS, module),
       ...this.container.getDynamicMetadataByToken(
         token,
         MODULE_METADATA.CONTROLLERS as 'controllers',
-      ),
+      )!,
     ];
     controllers.forEach(item => {
       this.insertController(item, token);
@@ -216,24 +250,24 @@ export class DependenciesScanner {
     });
   }
 
-  public reflectDynamicMetadata(obj: Type<Injectable>, token: string) {
-    if (!obj || !obj.prototype) {
+  public reflectDynamicMetadata(cls: Type<Injectable>, token: string) {
+    if (!cls || !cls.prototype) {
       return;
     }
-    this.reflectInjectables(obj, token, GUARDS_METADATA);
-    this.reflectInjectables(obj, token, INTERCEPTORS_METADATA);
-    this.reflectInjectables(obj, token, EXCEPTION_FILTERS_METADATA);
-    this.reflectInjectables(obj, token, PIPES_METADATA);
-    this.reflectParamInjectables(obj, token, ROUTE_ARGS_METADATA);
+    this.reflectInjectables(cls, token, GUARDS_METADATA);
+    this.reflectInjectables(cls, token, INTERCEPTORS_METADATA);
+    this.reflectInjectables(cls, token, EXCEPTION_FILTERS_METADATA);
+    this.reflectInjectables(cls, token, PIPES_METADATA);
+    this.reflectParamInjectables(cls, token, ROUTE_ARGS_METADATA);
   }
 
   public reflectExports(module: Type<unknown>, token: string) {
     const exports = [
-      ...this.reflectMetadata(module, MODULE_METADATA.EXPORTS),
+      ...this.reflectMetadata(MODULE_METADATA.EXPORTS, module),
       ...this.container.getDynamicMetadataByToken(
         token,
         MODULE_METADATA.EXPORTS as 'exports',
-      ),
+      )!,
     ];
     exports.forEach(exportedProvider =>
       this.insertExportedProvider(exportedProvider, token),
@@ -245,23 +279,51 @@ export class DependenciesScanner {
     token: string,
     metadataKey: string,
   ) {
-    const controllerInjectables = this.reflectMetadata(component, metadataKey);
-    const methodsInjectables = this.metadataScanner.scanFromPrototype(
-      null,
-      component.prototype,
-      this.reflectKeyMetadata.bind(this, component, metadataKey),
+    const controllerInjectables = this.reflectMetadata<Type<Injectable>>(
+      metadataKey,
+      component,
     );
+    const methodInjectables = this.metadataScanner
+      .getAllMethodNames(component.prototype)
+      .reduce(
+        (acc, method) => {
+          const methodInjectable = this.reflectKeyMetadata(
+            component,
+            metadataKey,
+            method,
+          );
 
-    const flattenMethodsInjectables = this.flatten(methodsInjectables);
-    const combinedInjectables = [
-      ...controllerInjectables,
-      ...flattenMethodsInjectables,
-    ].filter(isFunction);
-    const injectables = Array.from(new Set(combinedInjectables));
+          if (methodInjectable) {
+            acc.push(methodInjectable);
+          }
 
-    injectables.forEach(injectable =>
-      this.insertInjectable(injectable, token, component),
+          return acc;
+        },
+        [] as Array<{
+          methodKey: string;
+          metadata: Type<Injectable>[];
+        }>,
+      );
+
+    controllerInjectables.forEach(injectable =>
+      this.insertInjectable(
+        injectable,
+        token,
+        component,
+        ENHANCER_KEY_TO_SUBTYPE_MAP[metadataKey],
+      ),
     );
+    methodInjectables.forEach(methodInjectable => {
+      methodInjectable.metadata.forEach(injectable =>
+        this.insertInjectable(
+          injectable,
+          token,
+          component,
+          ENHANCER_KEY_TO_SUBTYPE_MAP[metadataKey],
+          methodInjectable.methodKey,
+        ),
+      );
+    });
   }
 
   public reflectParamInjectables(
@@ -269,32 +331,56 @@ export class DependenciesScanner {
     token: string,
     metadataKey: string,
   ) {
-    const paramsMetadata = this.metadataScanner.scanFromPrototype(
-      null,
+    const paramsMethods = this.metadataScanner.getAllMethodNames(
       component.prototype,
-      method => Reflect.getMetadata(metadataKey, component, method),
-    );
-    const paramsInjectables = this.flatten(paramsMetadata).map(
-      (param: Record<string, any>) =>
-        flatten(Object.keys(param).map(k => param[k].pipes)).filter(isFunction),
-    );
-    flatten(paramsInjectables).forEach((injectable: Type<Injectable>) =>
-      this.insertInjectable(injectable, token, component),
     );
+
+    paramsMethods.forEach(methodKey => {
+      const metadata: Record<
+        string,
+        {
+          index: number;
+          data: unknown;
+          pipes: Array<Type<PipeTransform> | PipeTransform>;
+        }
+      > = Reflect.getMetadata(metadataKey, component, methodKey);
+
+      if (!metadata) {
+        return;
+      }
+
+      const params = Object.values(metadata);
+      params
+        .map(item => item.pipes)
+        .flat(1)
+        .forEach(injectable =>
+          this.insertInjectable(
+            injectable,
+            token,
+            component,
+            'pipe',
+            methodKey,
+          ),
+        );
+    });
   }
 
   public reflectKeyMetadata(
     component: Type<Injectable>,
     key: string,
-    method: string,
-  ) {
+    methodKey: string,
+  ): { methodKey: string; metadata: any } | undefined {
     let prototype = component.prototype;
     do {
-      const descriptor = Reflect.getOwnPropertyDescriptor(prototype, method);
+      const descriptor = Reflect.getOwnPropertyDescriptor(prototype, methodKey);
       if (!descriptor) {
         continue;
       }
-      return Reflect.getMetadata(key, descriptor.value);
+      const metadata = Reflect.getMetadata(key, descriptor.value);
+      if (!metadata) {
+        return;
+      }
+      return { methodKey, metadata };
     } while (
       (prototype = Reflect.getPrototypeOf(prototype)) &&
       prototype !== Object.prototype &&
@@ -303,30 +389,36 @@ export class DependenciesScanner {
     return undefined;
   }
 
-  public async calculateModulesDistance() {
+  public calculateModulesDistance() {
     const modulesGenerator = this.container.getModules().values();
 
     // Skip "InternalCoreModule" from calculating distance
     modulesGenerator.next();
 
-    const modulesStack = [];
-    const calculateDistance = (moduleRef: Module, distance = 1) => {
-      if (modulesStack.includes(moduleRef)) {
+    const calculateDistance = (
+      moduleRef: Module,
+      distance = 1,
+      modulesStack: Module[] = [],
+    ) => {
+      const localModulesStack = [...modulesStack];
+      if (!moduleRef || localModulesStack.includes(moduleRef)) {
         return;
       }
-      modulesStack.push(moduleRef);
+      localModulesStack.push(moduleRef);
 
       const moduleImports = moduleRef.imports;
       moduleImports.forEach(importedModuleRef => {
         if (importedModuleRef) {
-          importedModuleRef.distance = distance;
-          calculateDistance(importedModuleRef, distance + 1);
+          if (distance > importedModuleRef.distance) {
+            importedModuleRef.distance = distance;
+          }
+          calculateDistance(importedModuleRef, distance + 1, localModulesStack);
         }
       });
     };
 
-    const rootModule = modulesGenerator.next().value as Module;
-    calculateDistance(rootModule);
+    const rootModule = modulesGenerator.next().value;
+    calculateDistance(rootModule!);
   }
 
   public async insertImport(related: any, token: string, context: string) {
@@ -352,24 +444,17 @@ export class DependenciesScanner {
   public insertProvider(provider: Provider, token: string) {
     const isCustomProvider = this.isCustomProvider(provider);
     if (!isCustomProvider) {
-      return this.container.addProvider(provider as Type<any>, token);
+      return this.container.addProvider(provider, token);
     }
     const applyProvidersMap = this.getApplyProvidersMap();
     const providersKeys = Object.keys(applyProvidersMap);
-    const type = (
-      provider as
-        | ClassProvider
-        | ValueProvider
-        | FactoryProvider
-        | ExistingProvider
-    ).provide;
+    const type = provider.provide;
 
     if (!providersKeys.includes(type as string)) {
       return this.container.addProvider(provider as any, token);
     }
-    const providerToken = `${
-      type as string
-    } (UUID: ${randomStringGenerator()})`;
+    const uuid = UuidFactory.get(type.toString());
+    const providerToken = `${type as string} (UUID: ${uuid})`;
 
     let scope = (provider as ClassProvider | FactoryProvider).scope;
     if (isNil(scope) && (provider as ClassProvider).useClass) {
@@ -388,46 +473,159 @@ export class DependenciesScanner {
       scope,
     } as Provider;
 
+    const enhancerSubtype =
+      ENHANCER_TOKEN_TO_SUBTYPE_MAP[
+        type as
+          | typeof APP_GUARD
+          | typeof APP_PIPE
+          | typeof APP_FILTER
+          | typeof APP_INTERCEPTOR
+      ];
     const factoryOrClassProvider = newProvider as
       | FactoryProvider
       | ClassProvider;
-    if (this.isRequestOrTransient(factoryOrClassProvider.scope)) {
-      return this.container.addInjectable(newProvider, token);
+    if (this.isRequestOrTransient(factoryOrClassProvider.scope!)) {
+      return this.container.addInjectable(newProvider, token, enhancerSubtype);
     }
-    this.container.addProvider(newProvider, token);
+    this.container.addProvider(newProvider, token, enhancerSubtype);
   }
 
   public insertInjectable(
-    injectable: Type<Injectable>,
+    injectable: Type<Injectable> | object,
     token: string,
     host: Type<Injectable>,
+    subtype: EnhancerSubtype,
+    methodKey?: string,
   ) {
-    this.container.addInjectable(injectable, token, host);
+    if (isFunction(injectable)) {
+      const instanceWrapper = this.container.addInjectable(
+        injectable as Type,
+        token,
+        subtype,
+        host,
+      ) as InstanceWrapper;
+
+      this.graphInspector.insertEnhancerMetadataCache({
+        moduleToken: token,
+        classRef: host,
+        enhancerInstanceWrapper: instanceWrapper,
+        targetNodeId: instanceWrapper.id,
+        subtype,
+        methodKey,
+      });
+      return instanceWrapper;
+    } else {
+      this.graphInspector.insertEnhancerMetadataCache({
+        moduleToken: token,
+        classRef: host,
+        enhancerRef: injectable,
+        methodKey,
+        subtype,
+      });
+    }
   }
 
   public insertExportedProvider(
-    exportedProvider: Type<Injectable>,
+    // TODO: improve the type definition below because it doesn't reflects the real usage of this method
+    exportedProvider: Type<Injectable> | ForwardReference,
     token: string,
   ) {
-    this.container.addExportedProvider(exportedProvider, token);
+    const fulfilledProvider = this.isForwardReference(exportedProvider)
+      ? exportedProvider.forwardRef()
+      : exportedProvider;
+    this.container.addExportedProvider(fulfilledProvider, token);
   }
 
   public insertController(controller: Type<Controller>, token: string) {
     this.container.addController(controller, token);
   }
 
-  public reflectMetadata(metatype: Type<any>, metadataKey: string) {
+  private insertOrOverrideModule(
+    moduleDefinition: ModuleDefinition,
+    overrides: ModuleOverride[],
+    scope: Type<unknown>[],
+  ): Promise<
+    | {
+        moduleRef: Module;
+        inserted: boolean;
+      }
+    | undefined
+  > {
+    const overrideModule = this.getOverrideModuleByModule(
+      moduleDefinition,
+      overrides,
+    );
+    if (overrideModule !== undefined) {
+      return this.overrideModule(
+        moduleDefinition,
+        overrideModule.newModule,
+        scope,
+      );
+    }
+
+    return this.insertModule(moduleDefinition, scope);
+  }
+
+  private getOverrideModuleByModule(
+    module: ModuleDefinition,
+    overrides: ModuleOverride[],
+  ): ModuleOverride | undefined {
+    if (this.isForwardReference(module)) {
+      return overrides.find(moduleToOverride => {
+        return (
+          moduleToOverride.moduleToReplace === module.forwardRef() ||
+          (
+            moduleToOverride.moduleToReplace as ForwardReference
+          ).forwardRef?.() === module.forwardRef()
+        );
+      });
+    }
+
+    return overrides.find(
+      moduleToOverride => moduleToOverride.moduleToReplace === module,
+    );
+  }
+
+  private async overrideModule(
+    moduleToOverride: ModuleDefinition,
+    newModule: ModuleDefinition,
+    scope: Type<unknown>[],
+  ): Promise<
+    | {
+        moduleRef: Module;
+        inserted: boolean;
+      }
+    | undefined
+  > {
+    return this.container.replaceModule(
+      this.isForwardReference(moduleToOverride)
+        ? moduleToOverride.forwardRef()
+        : moduleToOverride,
+      this.isForwardReference(newModule) ? newModule.forwardRef() : newModule,
+      scope,
+    );
+  }
+
+  public reflectMetadata<T = any>(
+    metadataKey: string,
+    metatype: Type<any>,
+  ): T[] {
     return Reflect.getMetadata(metadataKey, metatype) || [];
   }
 
-  public async registerCoreModule() {
+  public async registerCoreModule(overrides?: ModuleOverride[]) {
     const moduleDefinition = InternalCoreModuleFactory.create(
       this.container,
       this,
       this.container.getModuleCompiler(),
       this.container.getHttpAdapterHostRef(),
+      this.graphInspector,
+      overrides,
     );
-    const [instance] = await this.scanForModules(moduleDefinition);
+    const [instance] = await this.scanForModules({
+      moduleDefinition,
+      overrides,
+    });
     this.container.registerCoreModuleRef(instance);
   }
 
@@ -437,17 +635,22 @@ export class DependenciesScanner {
    */
   public addScopedEnhancersMetadata() {
     iterate(this.applicationProvidersApplyMap)
-      .filter(wrapper => this.isRequestOrTransient(wrapper.scope))
+      .filter(wrapper => this.isRequestOrTransient(wrapper.scope!))
       .forEach(({ moduleKey, providerKey }) => {
         const modulesContainer = this.container.getModules();
-        const { injectables } = modulesContainer.get(moduleKey);
+        const { injectables } = modulesContainer.get(moduleKey)!;
         const instanceWrapper = injectables.get(providerKey);
 
-        iterate(modulesContainer.values())
-          .map(module => module.controllers.values())
+        const iterableIterator = modulesContainer.values();
+        iterate(iterableIterator)
+          .map(moduleRef =>
+            Array.from<InstanceWrapper>(moduleRef.controllers.values()).concat(
+              moduleRef.entryProviders,
+            ),
+          )
           .flatten()
-          .forEach(controller =>
-            controller.addEnhancerMetadata(instanceWrapper),
+          .forEach(controllerOrEntryProvider =>
+            controllerOrEntryProvider.addEnhancerMetadata(instanceWrapper!),
           );
       });
   }
@@ -462,7 +665,7 @@ export class DependenciesScanner {
       collectionKey: 'providers' | 'injectables',
     ) => {
       const modules = this.container.getModules();
-      const collection = modules.get(moduleKey)[collectionKey];
+      const collection = modules.get(moduleKey)![collectionKey];
       return collection.get(providerKey);
     };
 
@@ -470,19 +673,22 @@ export class DependenciesScanner {
     this.applicationProvidersApplyMap.forEach(
       ({ moduleKey, providerKey, type, scope }) => {
         let instanceWrapper: InstanceWrapper;
-        if (this.isRequestOrTransient(scope)) {
+        if (this.isRequestOrTransient(scope!)) {
           instanceWrapper = getInstanceWrapper(
             moduleKey,
             providerKey,
             'injectables',
-          );
+          )!;
+
+          this.graphInspector.insertAttachedEnhancer(instanceWrapper);
           return applyRequestProvidersMap[type as string](instanceWrapper);
         }
         instanceWrapper = getInstanceWrapper(
           moduleKey,
           providerKey,
           'providers',
-        );
+        )!;
+        this.graphInspector.insertAttachedEnhancer(instanceWrapper);
         applyProvidersMap[type as string](instanceWrapper.instance);
       },
     );
@@ -545,15 +751,11 @@ export class DependenciesScanner {
   }
 
   private isForwardReference(
-    module: Type<any> | DynamicModule | ForwardReference,
+    module: ModuleDefinition,
   ): module is ForwardReference {
     return module && !!(module as ForwardReference).forwardRef;
   }
 
-  private flatten<T = any>(arr: T[][]): T[] {
-    return arr.reduce((a: T[], b: T[]) => a.concat(b), []);
-  }
-
   private isRequestOrTransient(scope: Scope): boolean {
     return scope === Scope.REQUEST || scope === Scope.TRANSIENT;
   }
diff --git a/packages/core/services/reflector.service.ts b/packages/core/services/reflector.service.ts
index fd5a2d77a..be666f9a5 100644
--- a/packages/core/services/reflector.service.ts
+++ b/packages/core/services/reflector.service.ts
@@ -1,5 +1,38 @@
-import { Type } from '@nestjs/common';
+import { CustomDecorator, SetMetadata, Type } from '@nestjs/common';
 import { isEmpty, isObject } from '@nestjs/common/utils/shared.utils';
+import { uid } from 'uid';
+
+/**
+ * @publicApi
+ */
+export interface CreateDecoratorOptions<TParam = any, TTransformed = TParam> {
+  /**
+   * The key for the metadata.
+   * @default uid(21)
+   */
+  key?: string;
+
+  /**
+   * The transform function to apply to the metadata value.
+   * @default value => value
+   */
+  transform?: (value: TParam) => TTransformed;
+}
+
+type CreateDecoratorWithTransformOptions<
+  TParam,
+  TTransformed = TParam,
+> = CreateDecoratorOptions<TParam, TTransformed> &
+  Required<Pick<CreateDecoratorOptions<TParam, TTransformed>, 'transform'>>;
+
+/**
+ * @publicApi
+ */
+export type ReflectableDecorator<TParam, TTransformed = TParam> = ((
+  opts?: TParam,
+) => CustomDecorator) & {
+  KEY: string;
+};
 
 /**
  * Helper class providing Nest reflection capabilities.
@@ -9,6 +42,49 @@ import { isEmpty, isObject } from '@nestjs/common/utils/shared.utils';
  * @publicApi
  */
 export class Reflector {
+  /**
+   * Creates a decorator that can be used to decorate classes and methods with metadata.
+   * Can be used as a strongly-typed alternative to `@SetMetadata`.
+   * @param options Decorator options.
+   * @returns A decorator function.
+   */
+  static createDecorator<TParam>(
+    options?: CreateDecoratorOptions<TParam>,
+  ): ReflectableDecorator<TParam>;
+  static createDecorator<TParam, TTransformed>(
+    options: CreateDecoratorWithTransformOptions<TParam, TTransformed>,
+  ): ReflectableDecorator<TParam, TTransformed>;
+  static createDecorator<TParam, TTransformed = TParam>(
+    options: CreateDecoratorOptions<TParam, TTransformed> = {},
+  ): ReflectableDecorator<TParam, TTransformed> {
+    const metadataKey = options.key ?? uid(21);
+    const decoratorFn =
+      (metadataValue: TParam) =>
+      (target: object | Function, key?: string | symbol, descriptor?: any) => {
+        const value = options.transform
+          ? options.transform(metadataValue)
+          : metadataValue;
+        SetMetadata(metadataKey, value ?? {})(target, key!, descriptor);
+      };
+
+    decoratorFn.KEY = metadataKey;
+    return decoratorFn as ReflectableDecorator<TParam, TTransformed>;
+  }
+
+  /**
+   * Retrieve metadata for a reflectable decorator for a specified target.
+   *
+   * @example
+   * `const roles = this.reflector.get(Roles, context.getHandler());`
+   *
+   * @param decorator reflectable decorator created through `Reflector.createDecorator`
+   * @param target context (decorated object) to retrieve metadata from
+   *
+   */
+  public get<T extends ReflectableDecorator<any>>(
+    decorator: T,
+    target: Type<any> | Function,
+  ): T extends ReflectableDecorator<any, infer R> ? R : unknown;
   /**
    * Retrieve metadata for a specified key for a specified target.
    *
@@ -22,10 +98,39 @@ export class Reflector {
   public get<TResult = any, TKey = any>(
     metadataKey: TKey,
     target: Type<any> | Function,
+  ): TResult;
+  /**
+   * Retrieve metadata for a specified key or decorator for a specified target.
+   *
+   * @example
+   * `const roles = this.reflector.get<string[]>('roles', context.getHandler());`
+   *
+   * @param metadataKey lookup key or decorator for metadata to retrieve
+   * @param target context (decorated object) to retrieve metadata from
+   *
+   */
+  public get<TResult = any, TKey = any>(
+    metadataKeyOrDecorator: TKey,
+    target: Type<any> | Function,
   ): TResult {
-    return Reflect.getMetadata(metadataKey, target) as TResult;
+    const metadataKey =
+      (metadataKeyOrDecorator as ReflectableDecorator<unknown>).KEY ??
+      metadataKeyOrDecorator;
+
+    return Reflect.getMetadata(metadataKey, target);
   }
 
+  /**
+   * Retrieve metadata for a specified decorator for a specified set of targets.
+   *
+   * @param decorator lookup decorator for metadata to retrieve
+   * @param targets context (decorated objects) to retrieve metadata from
+   *
+   */
+  public getAll<TParam = any, TTransformed = TParam>(
+    decorator: ReflectableDecorator<TParam, TTransformed>,
+    targets: (Type<any> | Function)[],
+  ): TTransformed extends Array<any> ? TTransformed : TTransformed[];
   /**
    * Retrieve metadata for a specified key for a specified set of targets.
    *
@@ -36,12 +141,38 @@ export class Reflector {
   public getAll<TResult extends any[] = any[], TKey = any>(
     metadataKey: TKey,
     targets: (Type<any> | Function)[],
+  ): TResult;
+  /**
+   * Retrieve metadata for a specified key or decorator for a specified set of targets.
+   *
+   * @param metadataKeyOrDecorator lookup key or decorator for metadata to retrieve
+   * @param targets context (decorated objects) to retrieve metadata from
+   *
+   */
+  public getAll<TResult extends any[] = any[], TKey = any>(
+    metadataKeyOrDecorator: TKey,
+    targets: (Type<any> | Function)[],
   ): TResult {
     return (targets || []).map(target =>
-      Reflect.getMetadata(metadataKey, target),
+      this.get(metadataKeyOrDecorator, target),
     ) as TResult;
   }
 
+  /**
+   * Retrieve metadata for a specified decorator for a specified set of targets and merge results.
+   *
+   * @param decorator lookup decorator for metadata to retrieve
+   * @param targets context (decorated objects) to retrieve metadata from
+   *
+   */
+  public getAllAndMerge<TParam = any, TTransformed = TParam>(
+    decorator: ReflectableDecorator<TParam, TTransformed>,
+    targets: (Type<any> | Function)[],
+  ): TTransformed extends Array<any>
+    ? TTransformed
+    : TTransformed extends object
+      ? TTransformed
+      : TTransformed[];
   /**
    * Retrieve metadata for a specified key for a specified set of targets and merge results.
    *
@@ -49,18 +180,36 @@ export class Reflector {
    * @param targets context (decorated objects) to retrieve metadata from
    *
    */
-  public getAllAndMerge<TResult extends any[] = any[], TKey = any>(
+  public getAllAndMerge<TResult extends any[] | object = any[], TKey = any>(
     metadataKey: TKey,
     targets: (Type<any> | Function)[],
+  ): TResult;
+  /**
+   * Retrieve metadata for a specified key or decorator for a specified set of targets and merge results.
+   *
+   * @param metadataKeyOrDecorator lookup key for metadata to retrieve
+   * @param targets context (decorated objects) to retrieve metadata from
+   *
+   */
+  public getAllAndMerge<TResult extends any[] | object = any[], TKey = any>(
+    metadataKeyOrDecorator: TKey,
+    targets: (Type<any> | Function)[],
   ): TResult {
-    const metadataCollection = this.getAll<TResult, TKey>(
-      metadataKey,
+    const metadataCollection = this.getAll<any[], TKey>(
+      metadataKeyOrDecorator,
       targets,
     ).filter(item => item !== undefined);
 
     if (isEmpty(metadataCollection)) {
       return metadataCollection as TResult;
     }
+    if (metadataCollection.length === 1) {
+      const value = metadataCollection[0];
+      if (isObject(value)) {
+        return value as TResult;
+      }
+      return metadataCollection as TResult;
+    }
     return metadataCollection.reduce((a, b) => {
       if (Array.isArray(a)) {
         return a.concat(b);
@@ -75,6 +224,17 @@ export class Reflector {
     });
   }
 
+  /**
+   * Retrieve metadata for a specified decorator for a specified set of targets and return a first not undefined value.
+   *
+   * @param decorator lookup decorator for metadata to retrieve
+   * @param targets context (decorated objects) to retrieve metadata from
+   *
+   */
+  public getAllAndOverride<TParam = any, TTransformed = TParam>(
+    decorator: ReflectableDecorator<TParam, TTransformed>,
+    targets: (Type<any> | Function)[],
+  ): TTransformed;
   /**
    * Retrieve metadata for a specified key for a specified set of targets and return a first not undefined value.
    *
@@ -85,10 +245,24 @@ export class Reflector {
   public getAllAndOverride<TResult = any, TKey = any>(
     metadataKey: TKey,
     targets: (Type<any> | Function)[],
-  ): TResult {
-    const metadataCollection = this.getAll(metadataKey, targets).filter(
-      item => item !== undefined,
-    );
-    return metadataCollection[0];
+  ): TResult;
+  /**
+   * Retrieve metadata for a specified key or decorator for a specified set of targets and return a first not undefined value.
+   *
+   * @param metadataKeyOrDecorator lookup key or metadata for metadata to retrieve
+   * @param targets context (decorated objects) to retrieve metadata from
+   *
+   */
+  public getAllAndOverride<TResult = any, TKey = any>(
+    metadataKeyOrDecorator: TKey,
+    targets: (Type<any> | Function)[],
+  ): TResult | undefined {
+    for (const target of targets) {
+      const result = this.get(metadataKeyOrDecorator, target);
+      if (result !== undefined) {
+        return result;
+      }
+    }
+    return undefined;
   }
 }
diff --git a/packages/core/test/application-config.spec.ts b/packages/core/test/application-config.spec.ts
index 9418b13db..73e23f7e3 100644
--- a/packages/core/test/application-config.spec.ts
+++ b/packages/core/test/application-config.spec.ts
@@ -1,8 +1,5 @@
 import { RequestMethod } from '@nestjs/common';
-import {
-  GlobalPrefixOptions,
-  VersioningOptions,
-} from '@nestjs/common/interfaces';
+import { GlobalPrefixOptions } from '@nestjs/common/interfaces';
 import { expect } from 'chai';
 import { ApplicationConfig } from '../application-config';
 import { ExcludeRouteMetadata } from '../router/interfaces/exclude-route-metadata.interface';
@@ -23,7 +20,11 @@ describe('ApplicationConfig', () => {
     it('should set global path options', () => {
       const options: GlobalPrefixOptions<ExcludeRouteMetadata> = {
         exclude: [
-          { pathRegex: new RegExp(/health/), requestMethod: RequestMethod.GET },
+          {
+            path: '/health',
+            pathRegex: new RegExp(/health/),
+            requestMethod: RequestMethod.GET,
+          },
         ],
       };
       appConfig.setGlobalPrefixOptions(options);
@@ -137,7 +138,7 @@ describe('ApplicationConfig', () => {
       const options = { type: 'test', defaultVersion: ['1', '2', '2', '1'] };
       appConfig.enableVersioning(options as any);
 
-      expect(appConfig.getVersioning().defaultVersion).to.be.eql(['1', '2']);
+      expect(appConfig.getVersioning()!.defaultVersion).to.be.eql(['1', '2']);
     });
 
     it('should have undefined as the versioning by default', () => {
diff --git a/packages/core/test/errors/test/exception-handler.spec.ts b/packages/core/test/errors/test/exception-handler.spec.ts
index ca3703a13..3fda223a9 100644
--- a/packages/core/test/errors/test/exception-handler.spec.ts
+++ b/packages/core/test/errors/test/exception-handler.spec.ts
@@ -1,8 +1,7 @@
-import * as sinon from 'sinon';
 import { expect } from 'chai';
+import * as sinon from 'sinon';
 import { ExceptionHandler } from '../../../errors/exception-handler';
 import { RuntimeException } from '../../../errors/exceptions/runtime.exception';
-import { InvalidMiddlewareException } from '../../../errors/exceptions/invalid-middleware.exception';
 
 describe('ExceptionHandler', () => {
   let instance: ExceptionHandler;
@@ -10,7 +9,7 @@ describe('ExceptionHandler', () => {
     instance = new ExceptionHandler();
   });
   describe('handle', () => {
-    let logger;
+    let logger: { error: Function };
     let errorSpy: sinon.SinonSpy;
     beforeEach(() => {
       logger = {
@@ -19,16 +18,10 @@ describe('ExceptionHandler', () => {
       (ExceptionHandler as any).logger = logger;
       errorSpy = sinon.spy(logger, 'error');
     });
-    it('when exception is instanceof RuntimeException', () => {
+    it('should call the logger.error method with the thrown exception passed as an argument', () => {
       const exception = new RuntimeException('msg');
       instance.handle(exception);
-      expect(errorSpy.calledWith(exception.message, exception.stack)).to.be
-        .true;
-    });
-    it('when exception is not instanceof RuntimeException', () => {
-      const exception = new InvalidMiddlewareException('msg');
-      instance.handle(exception);
-      expect(errorSpy.calledWith(exception.what(), exception.stack)).to.be.true;
+      expect(errorSpy.calledWith(exception)).to.be.true;
     });
   });
 });
diff --git a/packages/core/test/errors/test/exceptions-zone.spec.ts b/packages/core/test/errors/test/exceptions-zone.spec.ts
index 9207899ea..e5d6c4140 100644
--- a/packages/core/test/errors/test/exceptions-zone.spec.ts
+++ b/packages/core/test/errors/test/exceptions-zone.spec.ts
@@ -1,5 +1,6 @@
 import { expect } from 'chai';
 import * as sinon from 'sinon';
+import { Logger } from '@nestjs/common';
 import { ExceptionsZone } from '../../../errors/exceptions-zone';
 
 describe('ExceptionsZone', () => {
@@ -13,7 +14,7 @@ describe('ExceptionsZone', () => {
       callback = sinon.spy();
     });
     it('should call callback', () => {
-      ExceptionsZone.run(callback as any, rethrow);
+      ExceptionsZone.run(callback as any, rethrow, false);
       expect(callback.called).to.be.true;
     });
     describe('when callback throws exception', () => {
@@ -21,26 +22,54 @@ describe('ExceptionsZone', () => {
         handle: () => {},
       };
       let handleSpy: sinon.SinonSpy;
+      let LoggerFlushSpy: sinon.SinonSpy;
       before(() => {
         (ExceptionsZone as any).exceptionHandler = exceptionHandler;
         handleSpy = sinon.spy(exceptionHandler, 'handle');
+        LoggerFlushSpy = sinon.spy(Logger, 'flush');
       });
-      it('should call "handle" method of exceptionHandler and rethrows', () => {
-        const throwsCallback = () => {
-          throw new Error('');
-        };
-        expect(() => ExceptionsZone.run(throwsCallback, rethrow)).to.throws();
-        expect(handleSpy.called).to.be.true;
+      after(() => {
+        LoggerFlushSpy.restore();
+      });
+      describe('when callback throws exception and autoFlushLogs is false', () => {
+        it('should call "handle" method of exceptionHandler and rethrows and not flush logs', () => {
+          const throwsCallback = () => {
+            throw new Error('');
+          };
+          expect(() =>
+            ExceptionsZone.run(throwsCallback, rethrow, false),
+          ).to.throws();
+
+          expect(handleSpy.called).to.be.true;
+
+          expect(LoggerFlushSpy.called).to.be.false;
+        });
+      });
+
+      describe('when callback throws exception and autoFlushLogs is true', () => {
+        it('should call "handle" method of exceptionHandler and rethrows and flush logs', () => {
+          const throwsCallback = () => {
+            throw new Error('');
+          };
+          expect(() =>
+            ExceptionsZone.run(throwsCallback, rethrow, true),
+          ).to.throws();
+
+          expect(handleSpy.called).to.be.true;
+
+          expect(LoggerFlushSpy.called).to.be.true;
+        });
       });
     });
   });
+
   describe('asyncRun', () => {
     let callback: sinon.SinonSpy;
     beforeEach(() => {
       callback = sinon.spy();
     });
     it('should call callback', async () => {
-      await ExceptionsZone.asyncRun(callback as any, rethrow);
+      await ExceptionsZone.asyncRun(callback as any, rethrow, false);
       expect(callback.called).to.be.true;
     });
     describe('when callback throws exception', () => {
@@ -48,16 +77,40 @@ describe('ExceptionsZone', () => {
         handle: () => {},
       };
       let handleSpy: sinon.SinonSpy;
+      let LoggerFlushSpy: sinon.SinonSpy;
       before(() => {
         (ExceptionsZone as any).exceptionHandler = exceptionHandler;
         handleSpy = sinon.spy(exceptionHandler, 'handle');
+        LoggerFlushSpy = sinon.spy(Logger, 'flush');
+      });
+      after(() => {
+        LoggerFlushSpy.restore();
       });
-      it('should call "handle" method of exceptionHandler and rethrows error', async () => {
-        const throwsCallback = () => {
-          throw new Error('');
-        };
-        expect(ExceptionsZone.asyncRun(throwsCallback, rethrow)).to.eventually
-          .be.rejected;
+      describe('when callback throws exception and autoFlushLogs is false', () => {
+        it('should call "handle" method of exceptionHandler and rethrows error and not flush logs', async () => {
+          const throwsCallback = () => {
+            throw new Error('');
+          };
+          expect(ExceptionsZone.asyncRun(throwsCallback, rethrow, false)).to
+            .eventually.be.rejected;
+
+          expect(handleSpy.called).to.be.true;
+
+          expect(LoggerFlushSpy.called).to.be.false;
+        });
+      });
+      describe('when callback throws exception and autoFlushLogs is true', () => {
+        it('should call "handle" method of exceptionHandler and rethrows error and flush logs', async () => {
+          const throwsCallback = () => {
+            throw new Error('');
+          };
+          expect(ExceptionsZone.asyncRun(throwsCallback, rethrow, true)).to
+            .eventually.be.rejected;
+
+          expect(handleSpy.called).to.be.true;
+
+          expect(LoggerFlushSpy.called).to.be.true;
+        });
       });
     });
   });
diff --git a/packages/core/test/errors/test/messages.spec.ts b/packages/core/test/errors/test/messages.spec.ts
index 077f0b5cd..19941c08f 100644
--- a/packages/core/test/errors/test/messages.spec.ts
+++ b/packages/core/test/errors/test/messages.spec.ts
@@ -1,11 +1,11 @@
 import { expect } from 'chai';
 import { UnknownDependenciesException } from '../../../errors/exceptions/unknown-dependencies.exception';
-import { Module } from '../../../injector/module';
-import { stringCleaner } from '../../utils/string.cleaner';
 import {
-  UNDEFINED_MODULE_MESSAGE,
   INVALID_MODULE_MESSAGE,
+  UNDEFINED_MODULE_MESSAGE,
 } from '../../../errors/messages';
+import { Module } from '../../../injector/module';
+import { stringCleaner } from '../../utils/string.cleaner';
 
 describe('Error Messages', () => {
   const CatsModule = { name: 'CatsModule' };
@@ -16,10 +16,10 @@ describe('Error Messages', () => {
     it('should display class', () => {
       const expectedResult =
         stringCleaner(`Nest can't resolve dependencies of the CatService (?, CatService). Please make sure that the argument dependency at index [0] is available in the current context.
-  
+
       Potential solutions:
-      - If dependency is a provider, is it part of the current current?
-      - If dependency is exported from a separate @Module, is that module imported within current?
+      - If dependency is a provider, is it part of the current Module?
+      - If dependency is exported from a separate @Module, is that module imported within Module?
       @Module({
         imports: [ /* the Module containing dependency */ ]
       })
@@ -39,10 +39,10 @@ describe('Error Messages', () => {
     it('should display the provide token', () => {
       const expectedResult =
         stringCleaner(`Nest can't resolve dependencies of the CatService (?, MY_TOKEN). Please make sure that the argument dependency at index [0] is available in the current context.
-  
+
       Potential solutions:
-      - If dependency is a provider, is it part of the current current?
-      - If dependency is exported from a separate @Module, is that module imported within current?
+      - If dependency is a provider, is it part of the current Module?
+      - If dependency is exported from a separate @Module, is that module imported within Module?
       @Module({
       imports: [ /* the Module containing dependency */ ]
       })
@@ -57,13 +57,35 @@ describe('Error Messages', () => {
 
       expect(actualMessage).to.equal(expectedResult);
     });
+    it('should display the provide token as double-quoted string for string-based tokens', () => {
+      const expectedResult =
+        stringCleaner(`Nest can't resolve dependencies of the CatService (?). Please make sure that the argument "FooRepository" at index [0] is available in the current context.
+
+      Potential solutions:
+      - If "FooRepository" is a provider, is it part of the current Module?
+      - If "FooRepository" is exported from a separate @Module, is that module imported within Module?
+      @Module({
+      imports: [ /* the Module containing "FooRepository" */ ]
+      })
+      `);
+
+      const actualMessage = stringCleaner(
+        new UnknownDependenciesException('CatService', {
+          index: 0,
+          dependencies: ['FooRepository'],
+          name: 'FooRepository',
+        }).message,
+      );
+
+      expect(actualMessage).to.equal(expectedResult);
+    });
     it('should display the function name', () => {
       const expectedResult =
         stringCleaner(`Nest can't resolve dependencies of the CatService (?, CatFunction). Please make sure that the argument dependency at index [0] is available in the current context.
-  
+
       Potential solutions:
-      - If dependency is a provider, is it part of the current current?
-      - If dependency is exported from a separate @Module, is that module imported within current?
+      - If dependency is a provider, is it part of the current Module?
+      - If dependency is exported from a separate @Module, is that module imported within Module?
       @Module({
         imports: [ /* the Module containing dependency */ ]
       })
@@ -81,10 +103,10 @@ describe('Error Messages', () => {
     it('should use "+" if unknown dependency name', () => {
       const expectedResult =
         stringCleaner(`Nest can't resolve dependencies of the CatService (?, +). Please make sure that the argument dependency at index [0] is available in the current context.
-  
+
       Potential solutions:
-      - If dependency is a provider, is it part of the current current?
-      - If dependency is exported from a separate @Module, is that module imported within current?
+      - If dependency is a provider, is it part of the current Module?
+      - If dependency is exported from a separate @Module, is that module imported within Module?
         @Module({
           imports: [ /* the Module containing dependency */ ]
         })
@@ -93,7 +115,7 @@ describe('Error Messages', () => {
       const actualMessage = stringCleaner(
         new UnknownDependenciesException('CatService', {
           index,
-          dependencies: ['', undefined],
+          dependencies: ['', undefined!],
         }).message,
       );
 
@@ -102,8 +124,9 @@ describe('Error Messages', () => {
     it('should display the module name', () => {
       const expectedResult =
         stringCleaner(`Nest can't resolve dependencies of the CatService (?, MY_TOKEN). Please make sure that the argument dependency at index [0] is available in the TestModule context.
-  
+
       Potential solutions:
+      - Is TestModule a valid NestJS module?
       - If dependency is a provider, is it part of the current TestModule?
       - If dependency is exported from a separate @Module, is that module imported within TestModule?
         @Module({
@@ -135,10 +158,10 @@ describe('Error Messages', () => {
     it('should display the symbol name of the provider', () => {
       const expectedResult =
         stringCleaner(`Nest can't resolve dependencies of the Symbol(CatProvider) (?). Please make sure that the argument dependency at index [0] is available in the current context.
-  
+
       Potential solutions:
-      - If dependency is a provider, is it part of the current current?
-      - If dependency is exported from a separate @Module, is that module imported within current?
+      - If dependency is a provider, is it part of the current Module?
+      - If dependency is exported from a separate @Module, is that module imported within Module?
         @Module({
           imports: [ /* the Module containing dependency */ ]
         })
@@ -156,10 +179,10 @@ describe('Error Messages', () => {
     it('should display the symbol dependency of the provider', () => {
       const expectedResult =
         stringCleaner(`Nest can't resolve dependencies of the CatProvider (?, Symbol(DogProvider)). Please make sure that the argument dependency at index [0] is available in the current context.
-  
+
       Potential solutions:
-      - If dependency is a provider, is it part of the current current?
-      - If dependency is exported from a separate @Module, is that module imported within current?
+      - If dependency is a provider, is it part of the current Module?
+      - If dependency is exported from a separate @Module, is that module imported within Module?
         @Module({
           imports: [ /* the Module containing dependency */ ]
         })
@@ -200,7 +223,7 @@ Scope [AppModule -> CatsModule]`);
     it('should display the module name with the invalid index and scope', () => {
       const expectedMessage =
         stringCleaner(`Nest cannot create the CatsModule instance.
-Received an unexpected value at index [0] of the CatsModule "imports" array. 
+Received an unexpected value at index [0] of the CatsModule "imports" array.
 
 Scope [AppModule -> CatsModule]`);
 
diff --git a/packages/core/test/exceptions/base-exception-filter.spec.ts b/packages/core/test/exceptions/base-exception-filter.spec.ts
index 444e1cb99..f348814c9 100644
--- a/packages/core/test/exceptions/base-exception-filter.spec.ts
+++ b/packages/core/test/exceptions/base-exception-filter.spec.ts
@@ -33,7 +33,7 @@ describe('BaseExceptionFilterContext', () => {
         expect(filter.getFilterInstance(Filter)).to.be.eql(wrapper.instance);
       });
       it('should return null', () => {
-        sinon.stub(filter, 'getInstanceByMetatype').callsFake(() => null);
+        sinon.stub(filter, 'getInstanceByMetatype').callsFake(() => null!);
         expect(filter.getFilterInstance(Filter)).to.be.eql(null);
       });
     });
@@ -43,7 +43,7 @@ describe('BaseExceptionFilterContext', () => {
     describe('when "moduleContext" is nil', () => {
       it('should return undefined', () => {
         (filter as any).moduleContext = undefined;
-        expect(filter.getInstanceByMetatype(null)).to.be.undefined;
+        expect(filter.getInstanceByMetatype(null!)).to.be.undefined;
       });
     });
     describe('when "moduleContext" is not nil', () => {
@@ -54,7 +54,7 @@ describe('BaseExceptionFilterContext', () => {
       describe('and when module exists', () => {
         it('should return undefined', () => {
           sinon.stub(container.getModules(), 'get').callsFake(() => undefined);
-          expect(filter.getInstanceByMetatype(null)).to.be.undefined;
+          expect(filter.getInstanceByMetatype(null!)).to.be.undefined;
         });
       });
 
diff --git a/packages/core/test/exceptions/exceptions-handler.spec.ts b/packages/core/test/exceptions/exceptions-handler.spec.ts
index d74ef9a74..4472a0b36 100644
--- a/packages/core/test/exceptions/exceptions-handler.spec.ts
+++ b/packages/core/test/exceptions/exceptions-handler.spec.ts
@@ -119,8 +119,8 @@ describe('ExceptionsHandler', () => {
       handler.setCustomFilters(filters as any);
       expect((handler as any).filters).to.be.eql(filters);
     });
-    it('should throws exception when passed argument is not an array', () => {
-      expect(() => handler.setCustomFilters(null)).to.throws(
+    it('should throw exception when passed argument is not an array', () => {
+      expect(() => handler.setCustomFilters(null!)).to.throws(
         InvalidExceptionFilterException,
       );
     });
@@ -128,7 +128,7 @@ describe('ExceptionsHandler', () => {
   describe('invokeCustomFilters', () => {
     describe('when filters array is empty', () => {
       it('should return false', () => {
-        expect(handler.invokeCustomFilters(null, null)).to.be.false;
+        expect(handler.invokeCustomFilters(null, null!)).to.be.false;
       });
     });
     describe('when filters array is not empty', () => {
@@ -144,7 +144,7 @@ describe('ExceptionsHandler', () => {
           (handler as any).filters = filters;
         });
         it('should call funcSpy', () => {
-          handler.invokeCustomFilters(new TestException(), null);
+          handler.invokeCustomFilters(new TestException(), null!);
           expect(funcSpy.notCalled).to.be.false;
         });
         it('should call funcSpy with exception and response passed as an arguments', () => {
@@ -155,17 +155,17 @@ describe('ExceptionsHandler', () => {
           expect(funcSpy.calledWith(exception, res)).to.be.true;
         });
         it('should return true', () => {
-          expect(handler.invokeCustomFilters(new TestException(), null)).to.be
+          expect(handler.invokeCustomFilters(new TestException(), null!)).to.be
             .true;
         });
       });
       describe('when filter does not exists in filters array', () => {
         it('should not call funcSpy', () => {
-          handler.invokeCustomFilters(new TestException(), null);
+          handler.invokeCustomFilters(new TestException(), null!);
           expect(funcSpy.notCalled).to.be.true;
         });
         it('should return false', () => {
-          expect(handler.invokeCustomFilters(new TestException(), null)).to.be
+          expect(handler.invokeCustomFilters(new TestException(), null!)).to.be
             .false;
         });
       });
diff --git a/packages/core/test/exceptions/external-exception-filter-context.spec.ts b/packages/core/test/exceptions/external-exception-filter-context.spec.ts
index 755ec3021..db05ca315 100644
--- a/packages/core/test/exceptions/external-exception-filter-context.spec.ts
+++ b/packages/core/test/exceptions/external-exception-filter-context.spec.ts
@@ -13,7 +13,10 @@ describe('ExternalExceptionFilterContext', () => {
 
   class CustomException {}
   @Catch(CustomException)
-  class ExceptionFilter {
+  class ExceptionFilter implements ExceptionFilter {
+    public catch(exc, res) {}
+  }
+  class ClassWithNoMetadata implements ExceptionFilter {
     public catch(exc, res) {}
   }
 
@@ -33,8 +36,8 @@ describe('ExternalExceptionFilterContext', () => {
       it('should return plain ExceptionHandler object', () => {
         const filter = exceptionFilter.create(
           new EmptyMetadata(),
-          () => ({} as any),
-          undefined,
+          () => ({}) as any,
+          undefined!,
         );
         expect((filter as any).filters).to.be.empty;
       });
@@ -46,8 +49,8 @@ describe('ExternalExceptionFilterContext', () => {
       it('should return ExceptionHandler object with exception filters', () => {
         const filter = exceptionFilter.create(
           new WithMetadata(),
-          () => ({} as any),
-          undefined,
+          () => ({}) as any,
+          undefined!,
         );
         expect((filter as any).filters).to.not.be.empty;
       });
@@ -59,6 +62,11 @@ describe('ExternalExceptionFilterContext', () => {
         exceptionFilter.reflectCatchExceptions(new ExceptionFilter()),
       ).to.be.eql([CustomException]);
     });
+    it('should return an empty array when metadata was found', () => {
+      expect(
+        exceptionFilter.reflectCatchExceptions(new ClassWithNoMetadata()),
+      ).to.be.eql([]);
+    });
   });
   describe('createConcreteContext', () => {
     class InvalidFilter {}
@@ -96,7 +104,7 @@ describe('ExternalExceptionFilterContext', () => {
           .callsFake(() => scopedFilterWrappers);
         sinon
           .stub(instanceWrapper, 'getInstanceByContextId')
-          .callsFake(() => ({ instance } as any));
+          .callsFake(() => ({ instance }) as any);
 
         expect(exceptionFilter.getGlobalMetadata({ id: 3 })).to.contains(
           instance,
diff --git a/packages/core/test/exceptions/external-exceptions-handler.spec.ts b/packages/core/test/exceptions/external-exceptions-handler.spec.ts
index 8f39cd76f..cf8ca92a4 100644
--- a/packages/core/test/exceptions/external-exceptions-handler.spec.ts
+++ b/packages/core/test/exceptions/external-exceptions-handler.spec.ts
@@ -1,6 +1,7 @@
 import { expect } from 'chai';
 import { of } from 'rxjs';
 import * as sinon from 'sinon';
+import { ExternalExceptionFilter } from '../../exceptions/external-exception-filter';
 import { ExternalExceptionsHandler } from '../../exceptions/external-exceptions-handler';
 
 describe('ExternalExceptionsHandler', () => {
@@ -8,16 +9,16 @@ describe('ExternalExceptionsHandler', () => {
 
   beforeEach(() => {
     handler = new ExternalExceptionsHandler();
+
+    // eslint-disable-next-line @typescript-eslint/ban-ts-comment
+    // @ts-ignore The 'logger' property is private but we want to avoid showing useless error logs
+    ExternalExceptionFilter.logger.error = () => {};
   });
 
   describe('next', () => {
-    it('should method returns expected stream with message when exception is unknown', async () => {
+    it('should method returns expected stream with message when exception is unknown', () => {
       const error = new Error();
-      try {
-        await handler.next(error, null);
-      } catch (err) {
-        expect(err).to.be.eql(error);
-      }
+      expect(() => handler.next(error, null!)).to.throw(error);
     });
     describe('when "invokeCustomFilters" returns value', () => {
       const observable$ = of(true);
@@ -25,7 +26,7 @@ describe('ExternalExceptionsHandler', () => {
         sinon.stub(handler, 'invokeCustomFilters').returns(observable$ as any);
       });
       it('should return observable', () => {
-        const result = handler.next(new Error(), null);
+        const result = handler.next(new Error(), null!);
         expect(result).to.be.eql(observable$);
       });
     });
@@ -36,19 +37,20 @@ describe('ExternalExceptionsHandler', () => {
       handler.setCustomFilters(filters as any);
       expect((handler as any).filters).to.be.eql(filters);
     });
-    it('should throws exception when passed argument is not an array', () => {
-      expect(() => handler.setCustomFilters(null)).to.throw();
+    it('should throw exception when passed argument is not an array', () => {
+      expect(() => handler.setCustomFilters(null!)).to.throw();
     });
   });
   describe('invokeCustomFilters', () => {
     describe('when filters array is empty', () => {
       it('should return identity', () => {
-        expect(handler.invokeCustomFilters(null, null)).to.be.null;
+        expect(handler.invokeCustomFilters(null, null!)).to.be.null;
       });
     });
     describe('when filters array is not empty', () => {
       let filters, funcSpy;
       class TestException {}
+      class AnotherTestException {}
 
       beforeEach(() => {
         funcSpy = sinon.spy();
@@ -58,27 +60,33 @@ describe('ExternalExceptionsHandler', () => {
           filters = [{ exceptionMetatypes: [TestException], func: funcSpy }];
           (handler as any).filters = filters;
         });
-        it('should call funcSpy', () => {
-          handler.invokeCustomFilters(new TestException(), null);
+        it('should call funcSpy', async () => {
+          await handler.invokeCustomFilters(new TestException(), null!);
           expect(funcSpy.notCalled).to.be.false;
         });
-        it('should call funcSpy with exception and response passed as an arguments', () => {
+        it('should call funcSpy with exception and response passed as an arguments', async () => {
           const exception = new TestException();
-          handler.invokeCustomFilters(exception, null);
+          await handler.invokeCustomFilters(exception, null!);
           expect(funcSpy.calledWith(exception)).to.be.true;
         });
         it('should return stream', () => {
-          expect(handler.invokeCustomFilters(new TestException(), null)).to.be
+          expect(handler.invokeCustomFilters(new TestException(), null!)).to.be
             .not.null;
         });
       });
       describe('when filter does not exists in filters array', () => {
-        it('should not call funcSpy', () => {
-          handler.invokeCustomFilters(new TestException(), null);
+        beforeEach(() => {
+          filters = [
+            { exceptionMetatypes: [AnotherTestException], func: funcSpy },
+          ];
+          (handler as any).filters = filters;
+        });
+        it('should not call funcSpy', async () => {
+          await handler.invokeCustomFilters(new TestException(), null!);
           expect(funcSpy.notCalled).to.be.true;
         });
         it('should return null', () => {
-          expect(handler.invokeCustomFilters(new TestException(), null)).to.be
+          expect(handler.invokeCustomFilters(new TestException(), null!)).to.be
             .null;
         });
       });
diff --git a/packages/core/test/guards/guards-consumer.spec.ts b/packages/core/test/guards/guards-consumer.spec.ts
index b62da0c2a..8ab3049ca 100644
--- a/packages/core/test/guards/guards-consumer.spec.ts
+++ b/packages/core/test/guards/guards-consumer.spec.ts
@@ -16,7 +16,7 @@ describe('GuardsConsumer', () => {
           [],
           [],
           { constructor: null },
-          null,
+          null!,
         );
         expect(canActivate).to.be.true;
       });
@@ -28,7 +28,7 @@ describe('GuardsConsumer', () => {
             [...guards, { canActivate: () => false }],
             [],
             { constructor: null },
-            null,
+            null!,
           );
           expect(canActivate).to.be.false;
         });
@@ -39,7 +39,7 @@ describe('GuardsConsumer', () => {
             guards,
             [],
             { constructor: null },
-            null,
+            null!,
           );
           expect(canActivate).to.be.true;
         });
diff --git a/packages/core/test/guards/guards-context-creator.spec.ts b/packages/core/test/guards/guards-context-creator.spec.ts
index a166a34b6..0597f4fd4 100644
--- a/packages/core/test/guards/guards-context-creator.spec.ts
+++ b/packages/core/test/guards/guards-context-creator.spec.ts
@@ -79,7 +79,7 @@ describe('GuardsContextCreator', () => {
   describe('getGuardInstance', () => {
     describe('when param is an object', () => {
       it('should return instance', () => {
-        const instance = { canActivate: () => null };
+        const instance = { canActivate: () => null! };
         expect(guardsContextCreator.getGuardInstance(instance)).to.be.eql(
           instance,
         );
@@ -101,7 +101,7 @@ describe('GuardsContextCreator', () => {
       it('should return null', () => {
         sinon
           .stub(guardsContextCreator, 'getInstanceByMetatype')
-          .callsFake(() => null);
+          .callsFake(() => null!);
         expect(guardsContextCreator.getGuardInstance(Guard)).to.be.eql(null);
       });
     });
@@ -111,7 +111,7 @@ describe('GuardsContextCreator', () => {
     describe('when "moduleContext" is nil', () => {
       it('should return undefined', () => {
         (guardsContextCreator as any).moduleContext = undefined;
-        expect(guardsContextCreator.getInstanceByMetatype(null)).to.be
+        expect(guardsContextCreator.getInstanceByMetatype(null!)).to.be
           .undefined;
       });
     });
@@ -154,7 +154,7 @@ describe('GuardsContextCreator', () => {
           .callsFake(() => scopedGuardWrappers);
         sinon
           .stub(instanceWrapper, 'getInstanceByContextId')
-          .callsFake(() => ({ instance } as any));
+          .callsFake(() => ({ instance }) as any);
 
         expect(guardsContextCreator.getGlobalMetadata({ id: 3 })).to.contains(
           instance,
diff --git a/packages/core/test/helpers/application-ref-host.spec.ts b/packages/core/test/helpers/application-ref-host.spec.ts
index 21bc1b78e..78704327e 100644
--- a/packages/core/test/helpers/application-ref-host.spec.ts
+++ b/packages/core/test/helpers/application-ref-host.spec.ts
@@ -2,11 +2,27 @@ import { expect } from 'chai';
 import { HttpAdapterHost } from '../../helpers/http-adapter-host';
 
 describe('HttpAdapterHost', () => {
-  const applicationRefHost = new HttpAdapterHost();
+  let applicationRefHost: HttpAdapterHost;
+  beforeEach(() => {
+    applicationRefHost = new HttpAdapterHost();
+  });
+
   it('should wrap application reference', () => {
     const ref = {};
     applicationRefHost.httpAdapter = ref as any;
 
     expect(applicationRefHost.httpAdapter).to.be.eql(ref);
   });
+
+  it('should emit listen event when listening is set to true', done => {
+    applicationRefHost.listen$.subscribe(() => {
+      expect(applicationRefHost.listening).to.be.true;
+      done();
+    });
+    applicationRefHost.listening = true;
+  });
+
+  it('listening should return false if the application isnt listening yet', () => {
+    expect(applicationRefHost.listening).to.be.false;
+  });
 });
diff --git a/packages/core/test/helpers/context-utils.spec.ts b/packages/core/test/helpers/context-utils.spec.ts
index 54111ef6d..0c220f3f4 100644
--- a/packages/core/test/helpers/context-utils.spec.ts
+++ b/packages/core/test/helpers/context-utils.spec.ts
@@ -1,4 +1,4 @@
-import { CUSTOM_ROUTE_AGRS_METADATA } from '@nestjs/common/constants';
+import { CUSTOM_ROUTE_ARGS_METADATA } from '@nestjs/common/constants';
 import { Body, createParamDecorator, Request } from '@nestjs/common/decorators';
 import { RouteParamtypes } from '@nestjs/common/enums/route-paramtypes.enum';
 import { expect } from 'chai';
@@ -40,7 +40,7 @@ describe('ContextUtils', () => {
           data: undefined,
           pipes: [],
         },
-        [`custom${CUSTOM_ROUTE_AGRS_METADATA}:2`]: {
+        [`custom${CUSTOM_ROUTE_ARGS_METADATA}:2`]: {
           index: 2,
           factory: () => {},
           data: undefined,
@@ -54,7 +54,9 @@ describe('ContextUtils', () => {
       );
 
       const keys = Object.keys(metadata);
-      const custom = keys.find(key => key.includes(CUSTOM_ROUTE_AGRS_METADATA));
+      const custom = keys.find(key =>
+        key.includes(CUSTOM_ROUTE_ARGS_METADATA),
+      )!;
 
       expect(metadata[custom]).to.be.an('object');
       expect(metadata[custom].index).to.be.eq(2);
@@ -87,10 +89,10 @@ describe('ContextUtils', () => {
     });
   });
   describe('mergeParamsMetatypes', () => {
-    it('should return "paramsProperties" when paramtypes array doesnt exists', () => {
+    it('should return "paramsProperties" when paramtypes array doesn\'t exists', () => {
       const paramsProperties = ['1'];
       expect(
-        contextUtils.mergeParamsMetatypes(paramsProperties as any, null),
+        contextUtils.mergeParamsMetatypes(paramsProperties as any, null!),
       ).to.be.eql(paramsProperties);
     });
   });
@@ -113,7 +115,7 @@ describe('ContextUtils', () => {
         const customFactory = undefined;
         expect(
           contextUtils.getCustomFactory(
-            customFactory,
+            customFactory!,
             undefined,
             contextFactory,
           )(),
diff --git a/packages/core/test/helpers/external-context-creator.spec.ts b/packages/core/test/helpers/external-context-creator.spec.ts
index 98c098eab..7a87aa4ce 100644
--- a/packages/core/test/helpers/external-context-creator.spec.ts
+++ b/packages/core/test/helpers/external-context-creator.spec.ts
@@ -1,5 +1,5 @@
 import { ForbiddenException } from '@nestjs/common';
-import { CUSTOM_ROUTE_AGRS_METADATA } from '@nestjs/common/constants';
+import { CUSTOM_ROUTE_ARGS_METADATA } from '@nestjs/common/constants';
 import { RouteParamtypes } from '@nestjs/common/enums/route-paramtypes.enum';
 import { expect } from 'chai';
 import { of } from 'rxjs';
@@ -55,7 +55,7 @@ describe('ExternalContextCreator', () => {
         contextCreator,
         'getContextModuleKey',
       );
-      contextCreator.create({ foo: 'bar' }, callback as any, '', '', null);
+      contextCreator.create({ foo: 'bar' }, callback, '', '', null!);
       expect(getContextModuleKeySpy.called).to.be.true;
       done();
     });
@@ -65,13 +65,7 @@ describe('ExternalContextCreator', () => {
 
       beforeEach(() => {
         instance = { foo: 'bar' };
-        proxyContext = contextCreator.create(
-          instance,
-          callback as any,
-          '',
-          '',
-          null,
-        );
+        proxyContext = contextCreator.create(instance, callback, '', '', null!);
       });
       it('should be a function', () => {
         expect(proxyContext).to.be.a('function');
@@ -138,7 +132,7 @@ describe('ExternalContextCreator', () => {
       const metadata = {
         [RouteParamtypes.REQUEST]: { index: 0, data: 'test', pipes: [] },
         [RouteParamtypes.BODY]: { index: 2, data: 'test', pipes: [] },
-        [`key${CUSTOM_ROUTE_AGRS_METADATA}`]: {
+        [`key${CUSTOM_ROUTE_ARGS_METADATA}`]: {
           index: 3,
           data: 'custom',
           pipes: [],
@@ -154,7 +148,7 @@ describe('ExternalContextCreator', () => {
       const expectedValues = [
         { index: 0, type: RouteParamtypes.REQUEST, data: 'test' },
         { index: 2, type: RouteParamtypes.BODY, data: 'test' },
-        { index: 3, type: `key${CUSTOM_ROUTE_AGRS_METADATA}`, data: 'custom' },
+        { index: 3, type: `key${CUSTOM_ROUTE_ARGS_METADATA}`, data: 'custom' },
       ];
       expect(values[0]).to.deep.include(expectedValues[0]);
       expect(values[1]).to.deep.include(expectedValues[1]);
@@ -169,8 +163,8 @@ describe('ExternalContextCreator', () => {
     beforeEach(() => {
       consumerApplySpy = sinon.spy(pipesConsumer, 'apply');
     });
-    it('should call "consumer.apply"', () => {
-      contextCreator.getParamValue(
+    it('should call "consumer.apply"', async () => {
+      await contextCreator.getParamValue(
         value,
         { metatype, type: RouteParamtypes.NEXT, data: null },
         transforms,
@@ -193,12 +187,12 @@ describe('ExternalContextCreator', () => {
             {
               index: 1,
               type: 'test',
-              data: null,
+              data: null!,
               pipes: [],
               extractValue: () => null,
             },
           ],
-        );
+        )!;
         await pipesFn([]);
         expect(pipesFn).to.be.a('function');
       });
diff --git a/packages/core/test/helpers/external-proxy.spec.ts b/packages/core/test/helpers/external-proxy.spec.ts
index 4152d8902..200ee2322 100644
--- a/packages/core/test/helpers/external-proxy.spec.ts
+++ b/packages/core/test/helpers/external-proxy.spec.ts
@@ -21,26 +21,24 @@ describe('ExternalErrorProxy', () => {
       expect(typeof proxy === 'function').to.be.true;
     });
 
-    it('should method encapsulate callback passed as argument', () => {
+    it('should method encapsulate callback passed as argument', async () => {
       const expectation = handlerMock.expects('next').once();
       const proxy = externalErrorProxy.createProxy((req, res, next) => {
         throw new HttpException('test', 500);
       }, handler);
-      proxy(null, null, null);
+      await proxy(null, null, null);
       expectation.verify();
     });
 
-    it('should method encapsulate async callback passed as argument', done => {
+    it('should method encapsulate async callback passed as argument', async () => {
       const expectation = handlerMock.expects('next').once();
       const proxy = externalErrorProxy.createProxy(async (req, res, next) => {
         throw new HttpException('test', 500);
       }, handler);
-      proxy(null, null, null);
 
-      setTimeout(() => {
-        expectation.verify();
-        done();
-      }, 0);
+      await proxy(null, null, null);
+
+      expectation.verify();
     });
   });
 });
diff --git a/packages/core/test/helpers/router-method-factory.spec.ts b/packages/core/test/helpers/router-method-factory.spec.ts
index 242fc51a3..6b3edfad5 100644
--- a/packages/core/test/helpers/router-method-factory.spec.ts
+++ b/packages/core/test/helpers/router-method-factory.spec.ts
@@ -14,6 +14,13 @@ describe('RouterMethodFactory', () => {
     patch: () => {},
     options: () => {},
     head: () => {},
+    propfind: () => {},
+    proppatch: () => {},
+    mkcol: () => {},
+    copy: () => {},
+    move: () => {},
+    lock: () => {},
+    unlock: () => {},
     all: () => {},
   };
   beforeEach(() => {
@@ -29,6 +36,17 @@ describe('RouterMethodFactory', () => {
     expect(factory.get(target, RequestMethod.PATCH)).to.equal(target.patch);
     expect(factory.get(target, RequestMethod.OPTIONS)).to.equal(target.options);
     expect(factory.get(target, RequestMethod.HEAD)).to.equal(target.head);
-    expect(factory.get(target, -1)).to.equal(target.use);
+    expect(factory.get(target, RequestMethod.PROPFIND)).to.equal(
+      target.propfind,
+    );
+    expect(factory.get(target, RequestMethod.PROPPATCH)).to.equal(
+      target.proppatch,
+    );
+    expect(factory.get(target, RequestMethod.MKCOL)).to.equal(target.mkcol);
+    expect(factory.get(target, RequestMethod.COPY)).to.equal(target.copy);
+    expect(factory.get(target, RequestMethod.MOVE)).to.equal(target.move);
+    expect(factory.get(target, RequestMethod.LOCK)).to.equal(target.lock);
+    expect(factory.get(target, RequestMethod.UNLOCK)).to.equal(target.unlock);
+    expect(factory.get(target, -1 as any)).to.equal(target.use);
   });
 });
diff --git a/packages/core/test/injector/compiler.spec.ts b/packages/core/test/injector/compiler.spec.ts
index c4cb35b20..2929c49e1 100644
--- a/packages/core/test/injector/compiler.spec.ts
+++ b/packages/core/test/injector/compiler.spec.ts
@@ -1,28 +1,30 @@
 import { expect } from 'chai';
 import { ModuleCompiler } from '../../injector/compiler';
+import { ByReferenceModuleOpaqueKeyFactory } from '../../injector/opaque-key-factory/by-reference-module-opaque-key-factory';
 
 describe('ModuleCompiler', () => {
   let compiler: ModuleCompiler;
   beforeEach(() => {
-    compiler = new ModuleCompiler();
+    compiler = new ModuleCompiler(new ByReferenceModuleOpaqueKeyFactory());
   });
 
   describe('extractMetadata', () => {
     describe('when module is a dynamic module', () => {
-      it('should return object with "type" and "dynamicMetadata" property', async () => {
+      it('should return object with "type" and "dynamicMetadata" property', () => {
         const obj = { module: 'test', providers: [] };
         const { module, ...dynamicMetadata } = obj;
-        expect(await compiler.extractMetadata(obj as any)).to.be.deep.equal({
+        expect(compiler.extractMetadata(obj as any)).to.be.deep.equal({
           type: module,
           dynamicMetadata,
         });
       });
     });
     describe('when module is a not dynamic module', () => {
-      it('should return object with "type" property', async () => {
+      it('should return object with "type" property', () => {
         const type = 'test';
-        expect(await compiler.extractMetadata(type as any)).to.be.deep.equal({
+        expect(compiler.extractMetadata(type as any)).to.be.deep.equal({
           type,
+          dynamicMetadata: undefined,
         });
       });
     });
diff --git a/packages/core/test/injector/container.spec.ts b/packages/core/test/injector/container.spec.ts
index 0d7f181c5..3083ed6b7 100644
--- a/packages/core/test/injector/container.spec.ts
+++ b/packages/core/test/injector/container.spec.ts
@@ -9,6 +9,7 @@ import { NoopHttpAdapter } from '../utils/noop-adapter.spec';
 
 describe('NestContainer', () => {
   let container: NestContainer;
+  let untypedContainer: any;
 
   @Module({})
   class TestModule {}
@@ -19,6 +20,7 @@ describe('NestContainer', () => {
 
   beforeEach(() => {
     container = new NestContainer();
+    untypedContainer = container as any;
   });
 
   it('should "addProvider" throw "UnknownModuleException" when module is not stored in collection', () => {
@@ -28,32 +30,32 @@ describe('NestContainer', () => {
   });
 
   it('should "addProvider" throw "CircularDependencyException" when provider is nil', () => {
-    expect(() => container.addProvider(null, 'TestModule')).throw(
+    expect(() => container.addProvider(null!, 'TestModule')).throw(
       CircularDependencyException,
     );
   });
 
   it('should "addController" throw "UnknownModuleException" when module is not stored in collection', () => {
-    expect(() => container.addController(null, 'TestModule')).throw(
+    expect(() => container.addController(null!, 'TestModule')).throw(
       UnknownModuleException,
     );
   });
 
   it('should "addExportedProvider" throw "UnknownModuleException" when module is not stored in collection', () => {
-    expect(() => container.addExportedProvider(null, 'TestModule')).throw(
+    expect(() => container.addExportedProvider(null!, 'TestModule')).throw(
       UnknownModuleException,
     );
   });
 
   it('should "addInjectable" throw "UnknownModuleException" when module is not stored in collection', () => {
-    expect(() => container.addInjectable(null, 'TestModule', null)).throw(
+    expect(() => container.addInjectable(null!, 'TestModule', null!)).throw(
       UnknownModuleException,
     );
   });
 
   describe('clear', () => {
     it('should call `clear` on modules collection', () => {
-      const clearSpy = sinon.spy((container as any).modules, 'clear');
+      const clearSpy = sinon.spy(untypedContainer.modules, 'clear');
       container.clear();
       expect(clearSpy.called).to.be.true;
     });
@@ -63,7 +65,7 @@ describe('NestContainer', () => {
     it('should not add module if already exists in collection', async () => {
       const modules = new Map();
       const setSpy = sinon.spy(modules, 'set');
-      (container as any).modules = modules;
+      untypedContainer.modules = modules;
 
       await container.addModule(TestModule as any, []);
       await container.addModule(TestModule as any, []);
@@ -71,8 +73,8 @@ describe('NestContainer', () => {
       expect(setSpy.calledOnce).to.be.true;
     });
 
-    it('should throws an exception when metatype is not defined', () => {
-      expect(container.addModule(undefined, [])).to.eventually.throws();
+    it('should throw an exception when metatype is not defined', () => {
+      expect(container.addModule(undefined!, [])).to.eventually.throws();
     });
 
     it('should add global module when module is global', async () => {
@@ -81,6 +83,37 @@ describe('NestContainer', () => {
       expect(addGlobalModuleSpy.calledOnce).to.be.true;
     });
   });
+
+  describe('replaceModule', () => {
+    it('should replace module if already exists in collection', async () => {
+      @Module({})
+      class ReplaceTestModule {}
+
+      const modules = new Map();
+      const setSpy = sinon.spy(modules, 'set');
+      untypedContainer.modules = modules;
+
+      await container.addModule(TestModule as any, []);
+      await container.replaceModule(
+        TestModule as any,
+        ReplaceTestModule as any,
+        [],
+      );
+
+      expect(setSpy.calledTwice).to.be.true;
+    });
+
+    it('should throw an exception when metatype is not defined', () => {
+      expect(container.addModule(undefined!, [])).to.eventually.throws();
+    });
+
+    it('should add global module when module is global', async () => {
+      const addGlobalModuleSpy = sinon.spy(container, 'addGlobalModule');
+      await container.addModule(GlobalTestModule as any, []);
+      expect(addGlobalModuleSpy.calledOnce).to.be.true;
+    });
+  });
+
   describe('isGlobalModule', () => {
     describe('when module is not globally scoped', () => {
       it('should return false', () => {
@@ -113,7 +146,7 @@ describe('NestContainer', () => {
         'bindGlobalModuleToModule',
       );
       container.bindGlobalsToImports({
-        addRelatedModule: sinon.spy(),
+        addImport: sinon.spy(),
       } as any);
       expect(bindGlobalModuleToModuleSpy.calledTwice).to.be.true;
     });
@@ -121,17 +154,17 @@ describe('NestContainer', () => {
 
   describe('bindGlobalModuleToModule', () => {
     describe('when "module" is not "globalModule"', () => {
-      it('should call "addRelatedModule"', () => {
-        const module = { addRelatedModule: sinon.spy() };
-        container.bindGlobalModuleToModule(module as any, null);
-        expect(module.addRelatedModule.calledOnce).to.be.true;
+      it('should call "addImport"', () => {
+        const module = { addImport: sinon.spy() };
+        container.bindGlobalModuleToModule(module as any, null!);
+        expect(module.addImport.calledOnce).to.be.true;
       });
     });
     describe('when "module" is "globalModule"', () => {
-      it('should not call "addRelatedModule"', () => {
-        const module = { addRelatedModule: sinon.spy() };
+      it('should not call "addImport"', () => {
+        const module = { addImport: sinon.spy() };
         container.bindGlobalModuleToModule(module as any, module as any);
-        expect(module.addRelatedModule.calledOnce).to.be.false;
+        expect(module.addImport.calledOnce).to.be.false;
       });
     });
   });
@@ -143,21 +176,21 @@ describe('NestContainer', () => {
     beforeEach(() => {
       token = 'token';
       collection = new Map();
-      (container as any).dynamicModulesMetadata = collection;
+      untypedContainer.dynamicModulesMetadata = collection;
     });
     describe('when dynamic metadata exists', () => {
-      it('should add to the dynamic metadata collection', () => {
+      it('should add to the dynamic metadata collection', async () => {
         const addSpy = sinon.spy(collection, 'set');
-        const dynamicMetadata = { module: null };
+        const dynamicMetadata = { module: null! };
 
-        container.addDynamicMetadata(token, dynamicMetadata, []);
+        await container.addDynamicMetadata(token, dynamicMetadata, []);
         expect(addSpy.calledWith(token, dynamicMetadata)).to.be.true;
       });
     });
     describe('when dynamic metadata does not exists', () => {
-      it('should not add to the dynamic metadata collection', () => {
+      it('should not add to the dynamic metadata collection', async () => {
         const addSpy = sinon.spy(collection, 'set');
-        container.addDynamicMetadata(token, null, []);
+        await container.addDynamicMetadata(token, null!, []);
         expect(addSpy.called).to.be.false;
       });
     });
@@ -166,16 +199,16 @@ describe('NestContainer', () => {
   class Test {}
   describe('addDynamicModules', () => {
     describe('when array is empty/undefined', () => {
-      it('should not call "addModule"', () => {
+      it('should not call "addModule"', async () => {
         const addModuleSpy = sinon.spy(container, 'addModule');
-        container.addDynamicModules(undefined, []);
+        await container.addDynamicModules(undefined!, []);
         expect(addModuleSpy.called).to.be.false;
       });
     });
     describe('when array is not empty/undefined', () => {
-      it('should call "addModule"', () => {
+      it('should call "addModule"', async () => {
         const addModuleSpy = sinon.spy(container, 'addModule');
-        container.addDynamicModules([Test] as any, []);
+        await container.addDynamicModules([Test] as any, []);
         expect(addModuleSpy.called).to.be.true;
       });
     });
@@ -184,7 +217,7 @@ describe('NestContainer', () => {
   describe('get applicationConfig', () => {
     it('should return ApplicationConfig instance', () => {
       expect(container.applicationConfig).to.be.eql(
-        (container as any)._applicationConfig,
+        untypedContainer._applicationConfig,
       );
     });
   });
@@ -194,7 +227,7 @@ describe('NestContainer', () => {
       const httpAdapter = new NoopHttpAdapter({});
       container.setHttpAdapter(httpAdapter);
 
-      const internalStorage = (container as any).internalProvidersStorage;
+      const internalStorage = untypedContainer.internalProvidersStorage;
       expect(internalStorage.httpAdapter).to.be.eql(httpAdapter);
     });
   });
@@ -213,7 +246,7 @@ describe('NestContainer', () => {
     it('should register core module ref', () => {
       const ref = {} as any;
       container.registerCoreModuleRef(ref);
-      expect((container as any).internalCoreModule).to.be.eql(ref);
+      expect(untypedContainer.internalCoreModule).to.be.eql(ref);
     });
   });
 });
diff --git a/packages/core/test/injector/helpers/provider-classifier.spec.ts b/packages/core/test/injector/helpers/provider-classifier.spec.ts
new file mode 100644
index 000000000..cd7e9a6b1
--- /dev/null
+++ b/packages/core/test/injector/helpers/provider-classifier.spec.ts
@@ -0,0 +1,132 @@
+import { ClassProvider, FactoryProvider, ValueProvider } from '@nestjs/common';
+import { expect } from 'chai';
+import {
+  isClassProvider,
+  isFactoryProvider,
+  isValueProvider,
+} from '../../../injector/helpers/provider-classifier';
+
+describe('provider classifier', () => {
+  describe('isClassProvider', () => {
+    it('should return true if useClass is present', () => {
+      const classProvider: ClassProvider = {
+        useClass: class TestClass {},
+        provide: 'token',
+      };
+
+      expect(isClassProvider(classProvider)).to.be.true;
+    });
+
+    it('should return false if useClass is undefined', () => {
+      const classProvider: ClassProvider = {
+        useClass: undefined!,
+        provide: 'token',
+      };
+
+      expect(isClassProvider(classProvider)).to.be.false;
+    });
+
+    it('should return false if useClass is not present', () => {
+      const classProvider = {
+        provide: 'token',
+      };
+
+      expect(isClassProvider(classProvider as ClassProvider)).to.be.false;
+    });
+
+    it('should return false if provider is undefined', () => {
+      const classProvider = undefined!;
+
+      expect(isClassProvider(classProvider)).to.be.false;
+    });
+  });
+
+  describe('isValueProvider', () => {
+    it('should return true if useValue is not undefined', () => {
+      const valueProvider: ValueProvider = {
+        useValue: 'value',
+        provide: 'token',
+      };
+
+      expect(isValueProvider(valueProvider)).to.be.true;
+    });
+
+    it('should return true if useValue is "false"', () => {
+      const valueProvider: ValueProvider = {
+        useValue: false,
+        provide: 'token',
+      };
+
+      expect(isValueProvider(valueProvider)).to.be.true;
+    });
+
+    it('should return true if useValue is "null"', () => {
+      const valueProvider: ValueProvider = {
+        useValue: null,
+        provide: 'token',
+      };
+
+      expect(isValueProvider(valueProvider)).to.be.true;
+    });
+
+    it('should return true if useValue is an empty string', () => {
+      const valueProvider: ValueProvider = {
+        useValue: null,
+        provide: '',
+      };
+
+      expect(isValueProvider(valueProvider)).to.be.true;
+    });
+
+    it('should return false if useValue is undefined', () => {
+      const valueProvider: ValueProvider = {
+        useValue: undefined,
+        provide: 'token',
+      };
+
+      expect(isValueProvider(valueProvider)).to.be.false;
+    });
+
+    it('should return false if useValue is not present', () => {
+      const valueProvider = {
+        provide: 'token',
+      };
+
+      expect(isValueProvider(valueProvider as ValueProvider)).to.be.false;
+    });
+
+    it('should return false if provider is undefined', () => {
+      const valueProvider = undefined!;
+
+      expect(isValueProvider(valueProvider as ValueProvider)).to.be.false;
+    });
+  });
+
+  describe('isFactoryProvider', () => {
+    it('should return true if useFactory is present', () => {
+      const factoryProvider: FactoryProvider = {
+        provide: 'token',
+        useFactory: () => {},
+      };
+
+      expect(isFactoryProvider(factoryProvider)).to.be.true;
+    });
+
+    it('should return false if useFactory is not present', () => {
+      const factoryProvider = {
+        provide: 'token',
+      };
+
+      expect(isFactoryProvider(factoryProvider as FactoryProvider)).to.be.false;
+    });
+
+    it('should return false if useFactory is undefined', () => {
+      const factoryProvider: FactoryProvider = {
+        provide: 'token',
+        useFactory: undefined!,
+      };
+
+      expect(isFactoryProvider(factoryProvider)).to.be.false;
+    });
+  });
+});
diff --git a/packages/core/test/injector/injector.spec.ts b/packages/core/test/injector/injector.spec.ts
index 8c7d54c2e..3b28e14fa 100644
--- a/packages/core/test/injector/injector.spec.ts
+++ b/packages/core/test/injector/injector.spec.ts
@@ -1,3 +1,5 @@
+import { Optional } from '@nestjs/common';
+import { PARAMTYPES_METADATA } from '@nestjs/common/constants';
 import * as chai from 'chai';
 import { expect } from 'chai';
 import * as chaiAsPromised from 'chai-as-promised';
@@ -9,6 +11,7 @@ import { NestContainer } from '../../injector/container';
 import { Injector, PropertyDependency } from '../../injector/injector';
 import { InstanceWrapper } from '../../injector/instance-wrapper';
 import { Module } from '../../injector/module';
+
 chai.use(chaiAsPromised);
 
 describe('Injector', () => {
@@ -29,7 +32,10 @@ describe('Injector', () => {
     class MainTest {
       @Inject() property: DependencyOne;
 
-      constructor(public one: DependencyOne, public two: DependencyTwo) {}
+      constructor(
+        public one: DependencyOne,
+        @Inject() public two: DependencyTwo,
+      ) {}
     }
 
     let moduleDeps: Module;
@@ -55,7 +61,7 @@ describe('Injector', () => {
         name: DependencyTwo,
         token: DependencyTwo,
         metatype: DependencyTwo,
-        instance: Object.create(DependencyOne.prototype),
+        instance: Object.create(DependencyTwo.prototype),
         isResolved: false,
       });
       moduleDeps.providers.set('MainTest', mainTest);
@@ -92,8 +98,7 @@ describe('Injector', () => {
       ).to.eventually.be.rejected;
     });
 
-    it('should await done$ when "isPending"', async () => {
-      const value = 'test';
+    it('should await done$ when "isPending"', () => {
       const wrapper = new InstanceWrapper({
         name: 'MainTest',
         metatype: MainTest,
@@ -101,15 +106,29 @@ describe('Injector', () => {
         isResolved: false,
       });
       const host = wrapper.getInstanceByContextId(STATIC_CONTEXT);
-      host.donePromise = Promise.resolve(value) as any;
+      host.donePromise = Promise.resolve();
       host.isPending = true;
 
-      const result = await injector.loadInstance(
-        wrapper,
-        moduleDeps.providers,
-        moduleDeps,
-      );
-      expect(result).to.be.eql(value);
+      expect(
+        injector.loadInstance(wrapper, moduleDeps.providers, moduleDeps),
+      ).to.eventually.not.throw();
+    });
+
+    it('should await done$ when "isPending" and rethrow an exception (if thrown)', () => {
+      const error = new Error('Test error');
+      const wrapper = new InstanceWrapper({
+        name: 'MainTest',
+        metatype: MainTest,
+        instance: Object.create(MainTest.prototype),
+        isResolved: false,
+      });
+      const host = wrapper.getInstanceByContextId(STATIC_CONTEXT);
+      host.donePromise = Promise.resolve(error);
+      host.isPending = true;
+
+      expect(
+        injector.loadInstance(wrapper, moduleDeps.providers, moduleDeps),
+      ).to.eventually.throw(error);
     });
 
     it('should return undefined when metatype is resolved', async () => {
@@ -148,13 +167,13 @@ describe('Injector', () => {
 
     it('should create prototype of instance', () => {
       injector.loadPrototype(test, moduleDeps.providers);
-      expect(moduleDeps.providers.get('Test').instance).to.deep.equal(
+      expect(moduleDeps.providers.get('Test')!.instance).to.deep.equal(
         Object.create(Test.prototype),
       );
     });
 
     it('should return undefined when collection is nil', () => {
-      const result = injector.loadPrototype(test, null);
+      const result = injector.loadPrototype(test, null!);
       expect(result).to.be.undefined;
     });
 
@@ -182,10 +201,10 @@ describe('Injector', () => {
     it('should throw "RuntimeException" when param is undefined', async () => {
       return expect(
         injector.resolveSingleParam(
-          null,
-          undefined,
+          null!,
+          undefined!,
           { index: 0, dependencies: [] },
-          null,
+          null!,
         ),
       ).to.eventually.be.rejected;
     });
@@ -199,21 +218,21 @@ describe('Injector', () => {
       injector.loadInstance = loadInstanceSpy;
     });
 
-    it('should call "loadInstance" when instance is not resolved', () => {
+    it('should call "loadInstance" when instance is not resolved', async () => {
       const collection = {
         get: (...args) => ({}),
         set: (...args) => {},
       };
 
-      injector.loadMiddleware(
+      await injector.loadMiddleware(
         { metatype: { name: '', prototype: {} } } as any,
         collection as any,
-        null,
+        null!,
       );
       expect(loadInstanceSpy.called).to.be.true;
     });
 
-    it('should not call "loadInstanceSpy" when instance is not resolved', () => {
+    it('should not call "loadInstanceSpy" when instance is not resolved', async () => {
       const collection = {
         get: (...args) => ({
           instance: {},
@@ -221,10 +240,10 @@ describe('Injector', () => {
         set: (...args) => {},
       };
 
-      injector.loadMiddleware(
+      await injector.loadMiddleware(
         { metatype: { name: '' } } as any,
         collection as any,
-        null,
+        null!,
       );
       expect(loadInstanceSpy.called).to.be.false;
     });
@@ -288,7 +307,7 @@ describe('Injector', () => {
       };
       const result = await injector.lookupComponent(
         collection as any,
-        null,
+        null!,
         { name: metatype.name, index: 0, dependencies: [] },
         wrapper,
       );
@@ -304,7 +323,7 @@ describe('Injector', () => {
       };
       const result = injector.lookupComponent(
         collection as any,
-        null,
+        null!,
         { name, index: 0, dependencies: [] },
         Object.assign(wrapper, {
           name,
@@ -320,7 +339,7 @@ describe('Injector', () => {
       };
       await injector.lookupComponent(
         collection as any,
-        null,
+        null!,
         { name: metatype.name, index: 0, dependencies: [] },
         wrapper,
       );
@@ -401,7 +420,7 @@ describe('Injector', () => {
         injector.lookupComponentInImports(
           moduleFixture as any,
           metatype as any,
-          null,
+          null!,
         ),
       ).to.be.eventually.eq(null);
 
@@ -424,7 +443,7 @@ describe('Injector', () => {
         injector.lookupComponentInImports(
           moduleFixture as any,
           metatype as any,
-          null,
+          null!,
         ),
       ).to.eventually.be.eq(null);
     });
@@ -481,7 +500,7 @@ describe('Injector', () => {
       await injector.lookupComponentInImports(
         moduleFixture as any,
         metatype as any,
-        null,
+        null!,
       );
       expect(loadProvider.called).to.be.false;
     });
@@ -527,7 +546,7 @@ describe('Injector', () => {
   });
 
   describe('resolveComponentInstance', () => {
-    let module;
+    let module: any;
     beforeEach(() => {
       module = {
         providers: [],
@@ -540,7 +559,7 @@ describe('Injector', () => {
 
         const loadStub = sinon
           .stub(injector, 'loadProvider')
-          .callsFake(() => null);
+          .callsFake(() => null!);
         sinon
           .stub(injector, 'lookupComponent')
           .returns(Promise.resolve(wrapper));
@@ -557,7 +576,7 @@ describe('Injector', () => {
         const wrapper = new InstanceWrapper({ isResolved: true });
         const loadStub = sinon
           .stub(injector, 'loadProvider')
-          .callsFake(() => null);
+          .callsFake(() => null!);
 
         sinon
           .stub(injector, 'lookupComponent')
@@ -578,7 +597,7 @@ describe('Injector', () => {
         });
         const loadStub = sinon
           .stub(injector, 'loadProvider')
-          .callsFake(() => null);
+          .callsFake(() => null!);
 
         sinon
           .stub(injector, 'lookupComponent')
@@ -594,9 +613,9 @@ describe('Injector', () => {
       });
     });
 
-    describe('when instanceWraper has async property', () => {
+    describe('when instanceWrapper has async property', () => {
       it('should await instance', async () => {
-        sinon.stub(injector, 'loadProvider').callsFake(() => null);
+        sinon.stub(injector, 'loadProvider').callsFake(() => null!);
 
         const instance = Promise.resolve(true);
         const wrapper = new InstanceWrapper({
@@ -694,17 +713,17 @@ describe('Injector', () => {
       const container = new NestContainer();
       const moduleCtor = class TestModule {};
       const ctx = STATIC_CONTEXT;
-      const module = await container.addModule(moduleCtor, []);
+      const { moduleRef } = (await container.addModule(moduleCtor, []))!;
 
-      module.addProvider({
+      moduleRef.addProvider({
         provide: TestClass,
         useClass: TestClass,
       });
 
       const instance = await injector.loadPerContext(
         new TestClass(),
-        module,
-        module.providers,
+        moduleRef,
+        moduleRef.providers,
         ctx,
       );
       expect(instance).to.be.instanceOf(TestClass);
@@ -727,7 +746,7 @@ describe('Injector', () => {
 
       const loadInstanceStub = sinon
         .stub(injector, 'loadInstance')
-        .callsFake(async () => ({} as any));
+        .callsFake(async () => ({}) as any);
 
       await injector.loadEnhancersPerContext(wrapper, STATIC_CONTEXT);
       expect(loadInstanceStub.calledTwice).to.be.true;
@@ -779,7 +798,7 @@ describe('Injector', () => {
       const loadCtorMetadataSpy = sinon.spy(injector, 'loadCtorMetadata');
       await injector.resolveConstructorParams(
         wrapper,
-        null,
+        null!,
         [],
         () => {
           expect(loadCtorMetadataSpy.called).to.be.true;
@@ -799,8 +818,127 @@ describe('Injector', () => {
         injector,
         'loadPropertiesMetadata',
       );
-      await injector.resolveProperties(wrapper, null, null, { id: 2 });
+      await injector.resolveProperties(wrapper, null!, null!, { id: 2 });
       expect(loadPropertiesMetadataSpy.called).to.be.true;
     });
   });
+
+  describe('getClassDependencies', () => {
+    it('should return an array that consists of deps and optional dep ids', async () => {
+      class FixtureDep1 {}
+      class FixtureDep2 {}
+
+      @Injectable()
+      class FixtureClass {
+        constructor(
+          private dep1: FixtureDep1,
+          @Optional() private dep2: FixtureDep2,
+        ) {}
+      }
+
+      const wrapper = new InstanceWrapper({ metatype: FixtureClass });
+      const [dependencies, optionalDependenciesIds] =
+        injector.getClassDependencies(wrapper);
+
+      expect(dependencies).to.deep.eq([FixtureDep1, FixtureDep2]);
+      expect(optionalDependenciesIds).to.deep.eq([1]);
+    });
+
+    it('should not mutate the constructor metadata', async () => {
+      class FixtureDep1 {}
+      /** This needs to be something other than FixtureDep1 so the test can ensure that the metadata was not mutated */
+      const injectionToken = 'test_token';
+
+      @Injectable()
+      class FixtureClass {
+        constructor(@Inject(injectionToken) private dep1: FixtureDep1) {}
+      }
+
+      const wrapper = new InstanceWrapper({ metatype: FixtureClass });
+      const [dependencies] = injector.getClassDependencies(wrapper);
+      expect(dependencies).to.deep.eq([injectionToken]);
+
+      const paramtypes = Reflect.getMetadata(PARAMTYPES_METADATA, FixtureClass);
+      expect(paramtypes).to.deep.eq([FixtureDep1]);
+    });
+  });
+
+  describe('getFactoryProviderDependencies', () => {
+    it('should return an array that consists of deps and optional dep ids', async () => {
+      class FixtureDep1 {}
+      class FixtureDep2 {}
+
+      const wrapper = new InstanceWrapper({
+        inject: [
+          FixtureDep1,
+          { token: FixtureDep2, optional: true },
+          { token: FixtureDep2, optional: false },
+          {} as any,
+        ],
+      });
+      const [dependencies, optionalDependenciesIds] =
+        injector.getFactoryProviderDependencies(wrapper);
+
+      expect(dependencies).to.deep.eq([
+        FixtureDep1,
+        FixtureDep2,
+        FixtureDep2,
+        {},
+      ]);
+      expect(optionalDependenciesIds).to.deep.eq([1]);
+    });
+  });
+
+  describe('addDependencyMetadata', () => {
+    interface IInjector extends Omit<Injector, 'addDependencyMetadata'> {
+      addDependencyMetadata: (
+        keyOrIndex: symbol | string | number,
+        hostWrapper: InstanceWrapper,
+        instanceWrapper: InstanceWrapper,
+      ) => void;
+    }
+
+    let exposedInjector: IInjector;
+    let hostWrapper: InstanceWrapper;
+    let instanceWrapper: InstanceWrapper;
+
+    beforeEach(() => {
+      exposedInjector = injector as unknown as IInjector;
+      hostWrapper = new InstanceWrapper();
+      instanceWrapper = new InstanceWrapper();
+    });
+
+    it('should add dependency metadata to PropertiesMetadata when key is symbol', async () => {
+      const addPropertiesMetadataSpy = sinon.spy(
+        hostWrapper,
+        'addPropertiesMetadata',
+      );
+
+      const key = Symbol.for('symbol');
+      exposedInjector.addDependencyMetadata(key, hostWrapper, instanceWrapper);
+
+      expect(addPropertiesMetadataSpy.called).to.be.true;
+    });
+
+    it('should add dependency metadata to PropertiesMetadata when key is string', async () => {
+      const addPropertiesMetadataSpy = sinon.spy(
+        hostWrapper,
+        'addPropertiesMetadata',
+      );
+
+      const key = 'string';
+      exposedInjector.addDependencyMetadata(key, hostWrapper, instanceWrapper);
+
+      expect(addPropertiesMetadataSpy.called).to.be.true;
+    });
+
+    it('should add dependency metadata to CtorMetadata when key is number', async () => {
+      const addCtorMetadataSpy = sinon.spy(hostWrapper, 'addCtorMetadata');
+
+      const key = 0;
+      exposedInjector.addDependencyMetadata(key, hostWrapper, instanceWrapper);
+
+      expect(addCtorMetadataSpy.called).to.be.true;
+    });
+  });
 });
diff --git a/packages/core/test/injector/instance-loader.spec.ts b/packages/core/test/injector/instance-loader.spec.ts
index 8c34354eb..5ee507cdf 100644
--- a/packages/core/test/injector/instance-loader.spec.ts
+++ b/packages/core/test/injector/instance-loader.spec.ts
@@ -6,51 +6,64 @@ import { NestContainer } from '../../injector/container';
 import { Injector } from '../../injector/injector';
 import { InstanceLoader } from '../../injector/instance-loader';
 import { InstanceWrapper } from '../../injector/instance-wrapper';
+import { GraphInspector } from '../../inspector/graph-inspector';
 
 describe('InstanceLoader', () => {
-  let loader: InstanceLoader;
-  let container: NestContainer;
-  let mockContainer: sinon.SinonMock;
-
   @Controller('')
-  class TestRoute {}
+  class TestCtrl {}
 
   @Injectable()
   class TestProvider {}
 
+  let loader: InstanceLoader;
+  let injector: Injector;
+  let container: NestContainer;
+  let graphInspector: GraphInspector;
+  let inspectInstanceWrapperStub: sinon.SinonStub;
+  let mockContainer: sinon.SinonMock;
+  let moduleMock: Record<string, any>;
+
   beforeEach(() => {
     container = new NestContainer();
-    loader = new InstanceLoader(container);
-    mockContainer = sinon.mock(container);
-  });
+    graphInspector = new GraphInspector(container);
 
-  it('should call "loadPrototype" for each provider and route in each module', async () => {
-    const injector = new Injector();
-    (loader as any).injector = injector;
+    inspectInstanceWrapperStub = sinon.stub(
+      graphInspector,
+      'inspectInstanceWrapper',
+    );
 
-    const module = {
+    injector = new Injector();
+    loader = new InstanceLoader(container, injector, graphInspector);
+    mockContainer = sinon.mock(container);
+
+    moduleMock = {
+      imports: new Set(),
       providers: new Map(),
       controllers: new Map(),
       injectables: new Map(),
+      exports: new Set(),
       metatype: { name: 'test' },
     };
-    const providerWrapper: InstanceWrapper = {
+
+    const modules = new Map();
+    modules.set('Test', moduleMock);
+    mockContainer.expects('getModules').returns(modules);
+  });
+
+  it('should call "loadPrototype" for every provider and controller in every module', async () => {
+    const providerWrapper = new InstanceWrapper({
       instance: null,
       metatype: TestProvider,
       token: 'TestProvider',
-    } as any;
-    const routeWrapper: InstanceWrapper = {
+    });
+    const ctrlWrapper = new InstanceWrapper({
       instance: null,
-      metatype: TestRoute,
+      metatype: TestCtrl,
       token: 'TestRoute',
-    } as any;
+    });
 
-    module.providers.set('TestProvider', providerWrapper);
-    module.controllers.set('TestRoute', routeWrapper);
-
-    const modules = new Map();
-    modules.set('Test', module);
-    mockContainer.expects('getModules').returns(modules);
+    moduleMock.providers.set('TestProvider', providerWrapper);
+    moduleMock.controllers.set('TestRoute', ctrlWrapper);
 
     const loadProviderPrototypeStub = sinon.stub(injector, 'loadPrototype');
 
@@ -58,113 +71,125 @@ describe('InstanceLoader', () => {
     sinon.stub(injector, 'loadProvider');
 
     await loader.createInstancesOfDependencies();
+
     expect(
-      loadProviderPrototypeStub.calledWith(providerWrapper, module.providers),
+      loadProviderPrototypeStub.calledWith(
+        providerWrapper,
+        moduleMock.providers,
+      ),
     ).to.be.true;
     expect(
-      loadProviderPrototypeStub.calledWith(routeWrapper, module.controllers),
+      loadProviderPrototypeStub.calledWith(ctrlWrapper, moduleMock.controllers),
     ).to.be.true;
   });
 
-  it('should call "loadProvider" for each provider in each module', async () => {
-    const injector = new Injector();
-    (loader as any).injector = injector;
+  describe('for every provider in every module', () => {
+    const testProviderToken = 'TestProvider';
 
-    const module = {
-      providers: new Map(),
-      controllers: new Map(),
-      injectables: new Map(),
-      metatype: { name: 'test' },
-    };
-    const testComp = new InstanceWrapper({
-      instance: null,
-      metatype: TestProvider,
-      name: 'TestProvider',
-      token: 'TestProvider',
-    });
-    module.providers.set('TestProvider', testComp);
+    let loadProviderStub: sinon.SinonStub;
 
-    const modules = new Map();
-    modules.set('Test', module);
-    mockContainer.expects('getModules').returns(modules);
+    beforeEach(async () => {
+      const testProviderWrapper = new InstanceWrapper({
+        instance: null,
+        metatype: TestProvider,
+        name: testProviderToken,
+        token: testProviderToken,
+      });
+      moduleMock.providers.set(testProviderToken, testProviderWrapper);
 
-    const loadProviderStub = sinon.stub(injector, 'loadProvider');
-    sinon.stub(injector, 'loadController');
+      loadProviderStub = sinon.stub(injector, 'loadProvider');
+      sinon.stub(injector, 'loadController');
 
-    await loader.createInstancesOfDependencies();
-    expect(
-      loadProviderStub.calledWith(
-        module.providers.get('TestProvider'),
-        module as any,
-      ),
-    ).to.be.true;
-  });
+      await loader.createInstancesOfDependencies();
+    });
 
-  it('should call "loadController" for each route in each module', async () => {
-    const injector = new Injector();
-    (loader as any).injector = injector;
+    it('should call "loadProvider"', async () => {
+      expect(
+        loadProviderStub.calledWith(
+          moduleMock.providers.get(testProviderToken),
+          moduleMock as any,
+        ),
+      ).to.be.true;
+    });
 
-    const module = {
-      providers: new Map(),
-      controllers: new Map(),
-      injectables: new Map(),
-      metatype: { name: 'test' },
-    };
-    const wrapper = new InstanceWrapper({
-      name: 'TestRoute',
-      token: 'TestRoute',
-      instance: null,
-      metatype: TestRoute,
+    it('should call "inspectInstanceWrapper"', async () => {
+      expect(
+        inspectInstanceWrapperStub.calledWith(
+          moduleMock.providers.get(testProviderToken),
+          moduleMock as any,
+        ),
+      ).to.be.true;
     });
-    module.controllers.set('TestRoute', wrapper);
+  });
 
-    const modules = new Map();
-    modules.set('Test', module);
-    mockContainer.expects('getModules').returns(modules);
+  describe('for every controller in every module', () => {
+    let loadControllerStub: sinon.SinonStub;
 
-    sinon.stub(injector, 'loadProvider');
-    const loadRoutesStub = sinon.stub(injector, 'loadController');
+    beforeEach(async () => {
+      const wrapper = new InstanceWrapper({
+        name: 'TestRoute',
+        token: 'TestRoute',
+        instance: null,
+        metatype: TestCtrl,
+      });
+      moduleMock.controllers.set('TestRoute', wrapper);
 
-    await loader.createInstancesOfDependencies();
-    expect(
-      loadRoutesStub.calledWith(
-        module.controllers.get('TestRoute'),
-        module as any,
-      ),
-    ).to.be.true;
+      sinon.stub(injector, 'loadProvider');
+      loadControllerStub = sinon.stub(injector, 'loadController');
+
+      await loader.createInstancesOfDependencies();
+    });
+    it('should call "loadController"', async () => {
+      expect(
+        loadControllerStub.calledWith(
+          moduleMock.controllers.get('TestRoute'),
+          moduleMock as any,
+        ),
+      ).to.be.true;
+    });
+    it('should call "inspectInstanceWrapper"', async () => {
+      expect(
+        inspectInstanceWrapperStub.calledWith(
+          moduleMock.controllers.get('TestRoute'),
+          moduleMock as any,
+        ),
+      ).to.be.true;
+    });
   });
 
-  it('should call "loadInjectable" for each injectable in each module', async () => {
-    const injector = new Injector();
-    (loader as any).injector = injector;
+  describe('for every injectable in every module', () => {
+    let loadInjectableStub: sinon.SinonStub;
 
-    const module = {
-      providers: new Map(),
-      controllers: new Map(),
-      injectables: new Map(),
-      metatype: { name: 'test' },
-    };
-    const testComp = new InstanceWrapper({
-      instance: null,
-      metatype: TestProvider,
-      name: 'TestProvider',
-      token: 'TestProvider',
-    });
-    module.injectables.set('TestProvider', testComp);
+    beforeEach(async () => {
+      const testInjectable = new InstanceWrapper({
+        instance: null,
+        metatype: TestProvider,
+        name: 'TestProvider',
+        token: 'TestProvider',
+      });
+      moduleMock.injectables.set('TestProvider', testInjectable);
 
-    const modules = new Map();
-    modules.set('Test', module);
-    mockContainer.expects('getModules').returns(modules);
+      loadInjectableStub = sinon.stub(injector, 'loadInjectable');
+      sinon.stub(injector, 'loadController');
 
-    const loadInjectableStub = sinon.stub(injector, 'loadInjectable');
-    sinon.stub(injector, 'loadController');
+      await loader.createInstancesOfDependencies();
+    });
 
-    await loader.createInstancesOfDependencies();
-    expect(
-      loadInjectableStub.calledWith(
-        module.injectables.get('TestProvider'),
-        module as any,
-      ),
-    ).to.be.true;
+    it('should call "loadInjectable"', async () => {
+      expect(
+        loadInjectableStub.calledWith(
+          moduleMock.injectables.get('TestProvider'),
+          moduleMock as any,
+        ),
+      ).to.be.true;
+    });
+    it('should call "inspectInstanceWrapper"', async () => {
+      expect(
+        inspectInstanceWrapperStub.calledWith(
+          moduleMock.injectables.get('TestProvider'),
+          moduleMock as any,
+        ),
+      ).to.be.true;
+    });
   });
 });
diff --git a/packages/core/test/injector/instance-wrapper.spec.ts b/packages/core/test/injector/instance-wrapper.spec.ts
index b94cf4e1d..9516ed584 100644
--- a/packages/core/test/injector/instance-wrapper.spec.ts
+++ b/packages/core/test/injector/instance-wrapper.spec.ts
@@ -1,6 +1,7 @@
 import { Scope } from '@nestjs/common';
 import { expect } from 'chai';
 import * as sinon from 'sinon';
+import { createContextId } from '../../helpers';
 import { STATIC_CONTEXT } from '../../injector/constants';
 import { InstanceWrapper } from '../../injector/instance-wrapper';
 
@@ -31,6 +32,39 @@ describe('InstanceWrapper', () => {
   });
 
   describe('isDependencyTreeStatic', () => {
+    describe('when circular reference', () => {
+      it('should return true', () => {
+        const wrapper = new InstanceWrapper();
+        const otherWrapper = new InstanceWrapper();
+        wrapper.addCtorMetadata(0, otherWrapper);
+        otherWrapper.addCtorMetadata(0, wrapper);
+        expect(wrapper.isDependencyTreeStatic()).to.be.true;
+        expect(otherWrapper.isDependencyTreeStatic()).to.be.true;
+      });
+    });
+    describe('when circular reference and one non static', () => {
+      it('should return false', () => {
+        const wrapper = new InstanceWrapper();
+        const otherWrapper = new InstanceWrapper({ scope: Scope.REQUEST });
+        wrapper.addCtorMetadata(0, otherWrapper);
+        otherWrapper.addCtorMetadata(0, wrapper);
+        expect(wrapper.isDependencyTreeStatic()).to.be.false;
+        expect(otherWrapper.isDependencyTreeStatic()).to.be.false;
+      });
+    });
+    describe('when circular reference and one durable', () => {
+      it('should return false', () => {
+        const wrapper = new InstanceWrapper();
+        const otherWrapper = new InstanceWrapper({
+          scope: Scope.REQUEST,
+          durable: true,
+        });
+        wrapper.addCtorMetadata(0, otherWrapper);
+        otherWrapper.addCtorMetadata(0, wrapper);
+        expect(wrapper.isDependencyTreeStatic()).to.be.false;
+        expect(otherWrapper.isDependencyTreeStatic()).to.be.false;
+      });
+    });
     describe('when request scoped', () => {
       it('should return false', () => {
         const wrapper = new InstanceWrapper({
@@ -39,7 +73,68 @@ describe('InstanceWrapper', () => {
         expect(wrapper.isDependencyTreeStatic()).to.be.false;
       });
     });
+    describe('when request scoped durable', () => {
+      it('should return false', () => {
+        const wrapper = new InstanceWrapper({
+          scope: Scope.REQUEST,
+          durable: true,
+        });
+        expect(wrapper.isDependencyTreeStatic()).to.be.false;
+      });
+    });
+    describe('when request scoped explicit non durable', () => {
+      it('should return false', () => {
+        const wrapper = new InstanceWrapper({
+          scope: Scope.REQUEST,
+          durable: false,
+        });
+        expect(wrapper.isDependencyTreeStatic()).to.be.false;
+      });
+    });
+    describe('when default', () => {
+      it('should return true', () => {
+        const wrapper = new InstanceWrapper({});
+        expect(wrapper.isDependencyTreeStatic()).to.be.true;
+      });
+    });
     describe('when statically scoped', () => {
+      describe('dependencies, properties, enhancers', () => {
+        describe('dependencies non static, properties static, enhancers static', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addCtorMetadata(
+              0,
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            wrapper.addPropertiesMetadata('key1', new InstanceWrapper());
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            expect(wrapper.isDependencyTreeStatic()).to.be.false;
+          });
+        });
+        describe('dependencies static, properties non static, enhancers static', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addCtorMetadata(0, new InstanceWrapper());
+            wrapper.addPropertiesMetadata(
+              'key1',
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            expect(wrapper.isDependencyTreeStatic()).to.be.false;
+          });
+        });
+        describe('dependencies static, properties static, enhancers non static', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addCtorMetadata(0, new InstanceWrapper());
+            wrapper.addPropertiesMetadata('key1', new InstanceWrapper());
+            wrapper.addEnhancerMetadata(
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            expect(wrapper.isDependencyTreeStatic()).to.be.false;
+          });
+        });
+      });
       describe('dependencies', () => {
         describe('when each is static', () => {
           it('should return true', () => {
@@ -106,6 +201,450 @@ describe('InstanceWrapper', () => {
     });
   });
 
+  describe('isDependencyTreeDurable', () => {
+    describe('when circular reference and default scope', () => {
+      it('should return false', () => {
+        const wrapper = new InstanceWrapper();
+        const otherWrapper = new InstanceWrapper();
+        wrapper.addCtorMetadata(0, otherWrapper);
+        otherWrapper.addCtorMetadata(0, wrapper);
+        expect(wrapper.isDependencyTreeDurable()).to.be.false;
+        expect(otherWrapper.isDependencyTreeDurable()).to.be.false;
+      });
+    });
+    describe('when circular reference and one non durable', () => {
+      it('should return false', () => {
+        const wrapper = new InstanceWrapper();
+        const otherWrapper = new InstanceWrapper({ scope: Scope.REQUEST });
+        wrapper.addCtorMetadata(0, otherWrapper);
+        otherWrapper.addCtorMetadata(0, wrapper);
+        expect(wrapper.isDependencyTreeDurable()).to.be.false;
+        expect(otherWrapper.isDependencyTreeDurable()).to.be.false;
+      });
+    });
+    describe('when circular reference and one durable', () => {
+      it('should return true', () => {
+        const wrapper = new InstanceWrapper();
+        const otherWrapper = new InstanceWrapper({
+          scope: Scope.REQUEST,
+          durable: true,
+        });
+        wrapper.addCtorMetadata(0, otherWrapper);
+        otherWrapper.addCtorMetadata(0, wrapper);
+        expect(wrapper.isDependencyTreeDurable()).to.be.true;
+        expect(otherWrapper.isDependencyTreeDurable()).to.be.true;
+      });
+    });
+    describe('when request scoped and durable', () => {
+      it('should return true', () => {
+        const wrapper = new InstanceWrapper({
+          scope: Scope.REQUEST,
+          durable: true,
+        });
+        expect(wrapper.isDependencyTreeDurable()).to.be.true;
+      });
+    });
+    describe('when request scoped and non durable', () => {
+      it('should return false', () => {
+        const wrapper = new InstanceWrapper({
+          scope: Scope.REQUEST,
+        });
+        expect(wrapper.isDependencyTreeDurable()).to.be.false;
+      });
+    });
+    describe('when request scoped and explicit non durable', () => {
+      it('should return false', () => {
+        const wrapper = new InstanceWrapper({
+          scope: Scope.REQUEST,
+          durable: false,
+        });
+        expect(wrapper.isDependencyTreeDurable()).to.be.false;
+      });
+    });
+    describe('when default scope', () => {
+      it('should return false', () => {
+        const wrapper = new InstanceWrapper();
+        expect(wrapper.isDependencyTreeDurable()).to.be.false;
+      });
+    });
+    describe('when statically scoped', () => {
+      describe('dependencies, properties, enhancers', () => {
+        describe('dependencies non durable, properties non durable, enhancers durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addCtorMetadata(
+              0,
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            wrapper.addCtorMetadata(1, new InstanceWrapper());
+            wrapper.addPropertiesMetadata('key1', new InstanceWrapper());
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('dependencies non durable, properties durable, enhancers durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addCtorMetadata(
+              0,
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            wrapper.addCtorMetadata(1, new InstanceWrapper());
+            wrapper.addPropertiesMetadata(
+              'key1',
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('dependencies non durable, properties durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addCtorMetadata(
+              0,
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            wrapper.addCtorMetadata(1, new InstanceWrapper());
+            wrapper.addPropertiesMetadata('key1', new InstanceWrapper());
+            wrapper.addPropertiesMetadata(
+              'key2',
+              new InstanceWrapper({ scope: Scope.REQUEST, durable: true }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('properties durable, enhancers non durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addPropertiesMetadata('key1', new InstanceWrapper());
+            wrapper.addPropertiesMetadata(
+              'key2',
+              new InstanceWrapper({ scope: Scope.REQUEST, durable: true }),
+            );
+            wrapper.addEnhancerMetadata(
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('dependencies durable, enhancers non durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addCtorMetadata(
+              0,
+              new InstanceWrapper({ scope: Scope.REQUEST, durable: true }),
+            );
+            wrapper.addEnhancerMetadata(
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+      });
+      describe('dependencies', () => {
+        describe('when wrapper is non durable and dependency is static', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper({ scope: Scope.REQUEST });
+            wrapper.addCtorMetadata(0, new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when wrapper is durable and dependency is static', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+              durable: true,
+            });
+            wrapper.addCtorMetadata(0, new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
+        describe('when wrapper is non durable and dependency is durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+            });
+            wrapper.addCtorMetadata(
+              0,
+              new InstanceWrapper({ scope: Scope.REQUEST, durable: true }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when wrapper is durable and dependency is static', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+              durable: true,
+            });
+            wrapper.addCtorMetadata(0, new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
+        describe('when wrapper is durable and dependency is non durable', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+              durable: true,
+            });
+            wrapper.addCtorMetadata(
+              0,
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
+        describe('when each is static', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addCtorMetadata(0, new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when one is not static and non-durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addCtorMetadata(0, new InstanceWrapper());
+            wrapper.addCtorMetadata(
+              1,
+              new InstanceWrapper({
+                scope: Scope.REQUEST,
+              }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when one is not static and durable', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addCtorMetadata(0, new InstanceWrapper());
+            wrapper.addCtorMetadata(
+              1,
+              new InstanceWrapper({
+                scope: Scope.REQUEST,
+                durable: true,
+              }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
+        describe('when one is not static, durable and non durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addCtorMetadata(0, new InstanceWrapper());
+            wrapper.addCtorMetadata(
+              1,
+              new InstanceWrapper({
+                scope: Scope.REQUEST,
+                durable: true,
+              }),
+            );
+            wrapper.addCtorMetadata(
+              2,
+              new InstanceWrapper({
+                scope: Scope.REQUEST,
+              }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+      });
+      describe('properties', () => {
+        describe('when wrapper is non durable and dependency is static', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper({ scope: Scope.REQUEST });
+            wrapper.addPropertiesMetadata('key1', new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when wrapper is durable and dependency is static', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+              durable: true,
+            });
+            wrapper.addPropertiesMetadata('key1', new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
+        describe('when wrapper is non durable and dependency is durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+            });
+            wrapper.addPropertiesMetadata(
+              'key1',
+              new InstanceWrapper({ scope: Scope.REQUEST, durable: true }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when wrapper is durable and dependency is static', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+              durable: true,
+            });
+            wrapper.addPropertiesMetadata('key1', new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
+        describe('when wrapper is durable and dependency is non durable', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+              durable: true,
+            });
+            wrapper.addPropertiesMetadata(
+              'key1',
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
+        describe('when each is static', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addPropertiesMetadata('key1', new InstanceWrapper());
+            wrapper.addPropertiesMetadata('key2', new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when one is not static and non-durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addPropertiesMetadata(
+              'key1',
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            wrapper.addPropertiesMetadata('key2', new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when one is not static and durable', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addPropertiesMetadata(
+              'key1',
+              new InstanceWrapper({ scope: Scope.REQUEST, durable: true }),
+            );
+            wrapper.addPropertiesMetadata('key2', new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
+        describe('when one is not static, non durable and durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addPropertiesMetadata(
+              'key1',
+              new InstanceWrapper({ scope: Scope.REQUEST, durable: true }),
+            );
+            wrapper.addPropertiesMetadata('key2', new InstanceWrapper());
+            wrapper.addPropertiesMetadata(
+              'key3',
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+      });
+      describe('enhancers', () => {
+        describe('when wrapper is non durable and dependency is static', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper({ scope: Scope.REQUEST });
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when wrapper is durable and dependency is static', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+              durable: true,
+            });
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
+        describe('when wrapper is non durable and dependency is durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+            });
+            wrapper.addEnhancerMetadata(
+              new InstanceWrapper({ scope: Scope.REQUEST, durable: true }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when wrapper is durable and dependency is static', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+              durable: true,
+            });
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
+        describe('when wrapper is durable and dependency is non durable', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+              durable: true,
+            });
+            wrapper.addEnhancerMetadata(
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
+        describe('when each is static', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when one is not static and non-durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addEnhancerMetadata(
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when one is not static and durable', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addEnhancerMetadata(
+              new InstanceWrapper({ scope: Scope.REQUEST, durable: true }),
+            );
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
+        describe('when one is not static, non durable and durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addEnhancerMetadata(
+              new InstanceWrapper({ scope: Scope.REQUEST, durable: true }),
+            );
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            wrapper.addEnhancerMetadata(
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+      });
+    });
+  });
+
   describe('isNotMetatype', () => {
     describe('when metatype is nil', () => {
       it('should return true', () => {
@@ -199,6 +738,53 @@ describe('InstanceWrapper', () => {
     });
   });
 
+  describe('removeInstanceByContextId', () => {
+    describe('without inquirer', () => {
+      it('should remove instance for given context', () => {
+        const wrapper = new InstanceWrapper({
+          scope: Scope.TRANSIENT,
+        });
+
+        const contextId = createContextId();
+        wrapper.setInstanceByContextId(contextId, { instance: {} });
+
+        const existingContext = wrapper.getInstanceByContextId(contextId);
+        expect(existingContext.instance).to.be.not.undefined;
+        wrapper.removeInstanceByContextId(contextId);
+
+        const removedContext = wrapper.getInstanceByContextId(contextId);
+        expect(removedContext.instance).to.be.undefined;
+      });
+    });
+
+    describe('when transient and inquirer has been passed', () => {
+      it('should remove instance for given context', () => {
+        const wrapper = new InstanceWrapper({
+          scope: Scope.TRANSIENT,
+        });
+
+        wrapper.setInstanceByContextId(
+          STATIC_CONTEXT,
+          { instance: {} },
+          'inquirerId',
+        );
+
+        const existingContext = wrapper.getInstanceByContextId(
+          STATIC_CONTEXT,
+          'inquirerId',
+        );
+        expect(existingContext.instance).to.be.not.undefined;
+        wrapper.removeInstanceByContextId(STATIC_CONTEXT, 'inquirerId');
+
+        const removedContext = wrapper.getInstanceByContextId(
+          STATIC_CONTEXT,
+          'inquirerId',
+        );
+        expect(removedContext.instance).to.be.undefined;
+      });
+    });
+  });
+
   describe('isInRequestScope', () => {
     describe('when tree and context are not static and is not transient', () => {
       it('should return true', () => {
@@ -322,4 +908,68 @@ describe('InstanceWrapper', () => {
       });
     });
   });
+
+  describe('mergeWith', () => {
+    describe('when provider is a ValueProvider', () => {
+      it('should provide the given value in the STATIC_CONTEXT', () => {
+        const wrapper = new InstanceWrapper();
+        wrapper.mergeWith({
+          useValue: 'value',
+          provide: 'token',
+        });
+
+        expect(
+          wrapper.getInstanceByContextId(STATIC_CONTEXT).instance,
+        ).to.be.equal('value');
+      });
+    });
+
+    describe('when provider is a ClassProvider', () => {
+      it('should alter the instance wrapper metatype with the given class', () => {
+        const wrapper = new InstanceWrapper();
+
+        wrapper.mergeWith({
+          useClass: TestClass,
+          provide: 'token',
+        });
+
+        expect(wrapper.metatype).to.be.eql(TestClass);
+      });
+    });
+
+    describe('when provider is a FactoryProvider', () => {
+      describe('and it has injected dependencies', () => {
+        it('should alter the instance wrapper metatype and inject attributes with the given values', () => {
+          const wrapper = new InstanceWrapper();
+
+          const factory = (_dependency1: any, _dependency2: any) => {};
+          const injectedDependencies = ['dependency1', 'dependency2'];
+
+          wrapper.mergeWith({
+            provide: 'token',
+            useFactory: factory,
+            inject: injectedDependencies,
+          });
+
+          expect(wrapper.metatype).to.be.eql(factory);
+          expect(wrapper.inject).to.be.eq(injectedDependencies);
+        });
+      });
+
+      describe('and it has no injected dependencies', () => {
+        it('should alter the instance wrapper metatype with the given values', () => {
+          const wrapper = new InstanceWrapper();
+          const factory = (_dependency1: any, _dependency2: any) => {};
+
+          wrapper.mergeWith({
+            provide: 'token',
+            useFactory: factory,
+          });
+
+          expect(wrapper.metatype).to.be.eql(factory);
+          expect(wrapper.inject).to.be.eql([]);
+        });
+      });
+    });
+  });
 });
diff --git a/packages/core/test/injector/internal-core-module-factory.spec.ts b/packages/core/test/injector/internal-core-module-factory.spec.ts
deleted file mode 100644
index 85cf9cfe5..000000000
--- a/packages/core/test/injector/internal-core-module-factory.spec.ts
+++ /dev/null
@@ -1,39 +0,0 @@
-import { ClassProvider, FactoryProvider } from '@nestjs/common';
-import { expect } from 'chai';
-import { ExternalContextCreator } from '../../helpers/external-context-creator';
-import { HttpAdapterHost } from '../../helpers/http-adapter-host';
-import { LazyModuleLoader, ModulesContainer } from '../../injector';
-import { NestContainer } from '../../injector/container';
-import { InternalCoreModule } from '../../injector/internal-core-module';
-import { InternalCoreModuleFactory } from '../../injector/internal-core-module-factory';
-
-describe('InternalCoreModuleFactory', () => {
-  it('should return the interal core module definition', () => {
-    const moduleDefinition = InternalCoreModuleFactory.create(
-      new NestContainer(),
-      null,
-      null,
-      null,
-    );
-
-    expect(moduleDefinition.module).to.equal(InternalCoreModule);
-
-    const providedInjectables = moduleDefinition.providers.map(
-      item => (item as ClassProvider | FactoryProvider).provide,
-    );
-    expect(providedInjectables).to.deep.equal([
-      ExternalContextCreator,
-      ModulesContainer,
-      HttpAdapterHost,
-      HttpAdapterHost.name,
-      LazyModuleLoader,
-    ]);
-
-    const lazyModuleLoaderProvider = moduleDefinition.providers.find(
-      item => (item as FactoryProvider)?.provide === LazyModuleLoader,
-    ) as FactoryProvider;
-    expect(lazyModuleLoaderProvider.useFactory()).to.be.instanceOf(
-      LazyModuleLoader,
-    );
-  });
-});
diff --git a/packages/core/test/injector/internal-core-module/internal-core-module-factory.spec.ts b/packages/core/test/injector/internal-core-module/internal-core-module-factory.spec.ts
new file mode 100644
index 000000000..b5bfcd32e
--- /dev/null
+++ b/packages/core/test/injector/internal-core-module/internal-core-module-factory.spec.ts
@@ -0,0 +1,41 @@
+import { ClassProvider, FactoryProvider } from '@nestjs/common';
+import { expect } from 'chai';
+import { ExternalContextCreator } from '../../../helpers/external-context-creator';
+import { HttpAdapterHost } from '../../../helpers/http-adapter-host';
+import { LazyModuleLoader, ModulesContainer } from '../../../injector';
+import { NestContainer } from '../../../injector/container';
+import { InternalCoreModule } from '../../../injector/internal-core-module/internal-core-module';
+import { InternalCoreModuleFactory } from '../../../injector/internal-core-module/internal-core-module-factory';
+import { SerializedGraph } from '../../../inspector/serialized-graph';
+
+describe('InternalCoreModuleFactory', () => {
+  it('should return the internal core module definition', () => {
+    const moduleDefinition = InternalCoreModuleFactory.create(
+      new NestContainer(),
+      null!,
+      null!,
+      null!,
+      null!,
+    );
+
+    expect(moduleDefinition.module).to.equal(InternalCoreModule);
+
+    const providedInjectables = moduleDefinition.providers!.map(
+      item => (item as ClassProvider | FactoryProvider).provide,
+    );
+    expect(providedInjectables).to.deep.equal([
+      ExternalContextCreator,
+      ModulesContainer,
+      HttpAdapterHost,
+      LazyModuleLoader,
+      SerializedGraph,
+    ]);
+
+    const lazyModuleLoaderProvider = moduleDefinition.providers!.find(
+      item => (item as FactoryProvider)?.provide === LazyModuleLoader,
+    ) as FactoryProvider;
+    expect(lazyModuleLoaderProvider.useFactory()).to.be.instanceOf(
+      LazyModuleLoader,
+    );
+  });
+});
diff --git a/packages/core/test/injector/lazy-module-loader.spec.ts b/packages/core/test/injector/lazy-module-loader/lazy-module-loader.spec.ts
similarity index 74%
rename from packages/core/test/injector/lazy-module-loader.spec.ts
rename to packages/core/test/injector/lazy-module-loader/lazy-module-loader.spec.ts
index 35b0f8a45..4f2645272 100644
--- a/packages/core/test/injector/lazy-module-loader.spec.ts
+++ b/packages/core/test/injector/lazy-module-loader/lazy-module-loader.spec.ts
@@ -5,10 +5,12 @@ import {
   ModuleRef,
   ModulesContainer,
   NestContainer,
-} from '../../injector';
-import { InstanceLoader } from '../../injector/instance-loader';
-import { MetadataScanner } from '../../metadata-scanner';
-import { DependenciesScanner } from '../../scanner';
+} from '../../../injector';
+import { Injector } from '../../../injector/injector';
+import { InstanceLoader } from '../../../injector/instance-loader';
+import { GraphInspector } from '../../../inspector/graph-inspector';
+import { MetadataScanner } from '../../../metadata-scanner';
+import { DependenciesScanner } from '../../../scanner';
 
 describe('LazyModuleLoader', () => {
   let lazyModuleLoader: LazyModuleLoader;
@@ -18,15 +20,26 @@ describe('LazyModuleLoader', () => {
 
   class NoopLogger {
     log() {}
+    error() {}
+    warn() {}
   }
 
   beforeEach(() => {
     const nestContainer = new NestContainer();
+    const graphInspector = new GraphInspector(nestContainer);
     dependenciesScanner = new DependenciesScanner(
       nestContainer,
       new MetadataScanner(),
+      graphInspector,
+    );
+
+    const injector = new Injector();
+    instanceLoader = new InstanceLoader(
+      nestContainer,
+      injector,
+      graphInspector,
+      new NoopLogger(),
     );
-    instanceLoader = new InstanceLoader(nestContainer, new NoopLogger() as any);
     modulesContainer = nestContainer.getModules();
     lazyModuleLoader = new LazyModuleLoader(
       dependenciesScanner,
diff --git a/packages/core/test/injector/module.spec.ts b/packages/core/test/injector/module.spec.ts
index 04581b726..784c247c7 100644
--- a/packages/core/test/injector/module.spec.ts
+++ b/packages/core/test/injector/module.spec.ts
@@ -11,7 +11,8 @@ import { InstanceWrapper } from '../../injector/instance-wrapper';
 import { Module } from '../../injector/module';
 
 describe('Module', () => {
-  let module: Module;
+  let moduleRef: Module;
+  let untypedModuleRef: any;
   let container: NestContainer;
 
   @ModuleDecorator({})
@@ -22,27 +23,29 @@ describe('Module', () => {
 
   beforeEach(() => {
     container = new NestContainer();
-    module = new Module(TestModule, container);
+    moduleRef = new Module(TestModule, container);
+    untypedModuleRef = moduleRef as any;
   });
 
   it('should add controller', () => {
     const collection = new Map();
     const setSpy = sinon.spy(collection, 'set');
-    (module as any)._controllers = collection;
+    untypedModuleRef._controllers = collection;
 
-    @Controller({ scope: Scope.REQUEST })
+    @Controller({ scope: Scope.REQUEST, durable: true })
     class Test {}
 
-    module.addController(Test);
+    moduleRef.addController(Test);
     expect(
       setSpy.calledWith(
         Test,
         new InstanceWrapper({
-          host: module,
+          host: moduleRef,
           token: Test,
           name: 'Test',
           scope: Scope.REQUEST,
           metatype: Test,
+          durable: true,
           instance: null,
           isResolved: false,
         }),
@@ -53,20 +56,22 @@ describe('Module', () => {
   it('should add injectable', () => {
     const collection = new Map();
     const setSpy = sinon.spy(collection, 'set');
-    (module as any)._injectables = collection;
+    untypedModuleRef._injectables = collection;
 
-    module.addInjectable(TestProvider, TestModule);
+    moduleRef.addInjectable(TestProvider, 'interceptor', TestModule);
     expect(
       setSpy.calledWith(
         TestProvider,
         new InstanceWrapper({
-          host: module,
+          host: moduleRef,
           name: 'TestProvider',
           token: TestProvider,
           scope: undefined,
           metatype: TestProvider,
           instance: null,
+          durable: undefined,
           isResolved: false,
+          subtype: 'interceptor',
         }),
       ),
     ).to.be.true;
@@ -74,9 +79,9 @@ describe('Module', () => {
 
   describe('when injectable is custom provided', () => {
     it('should call `addCustomProvider`', () => {
-      const addCustomProviderSpy = sinon.spy(module, 'addCustomProvider');
+      const addCustomProviderSpy = sinon.spy(moduleRef, 'addCustomProvider');
 
-      module.addInjectable({ provide: 'test' } as any);
+      moduleRef.addInjectable({ provide: 'test' } as any, 'guard');
       expect(addCustomProviderSpy.called).to.be.true;
     });
   });
@@ -84,18 +89,19 @@ describe('Module', () => {
   it('should add provider', () => {
     const collection = new Map();
     const setSpy = sinon.spy(collection, 'set');
-    (module as any)._providers = collection;
+    untypedModuleRef._providers = collection;
 
-    module.addProvider(TestProvider);
+    moduleRef.addProvider(TestProvider);
     expect(
       setSpy.calledWith(
         TestProvider,
         new InstanceWrapper({
-          host: module,
+          host: moduleRef,
           name: 'TestProvider',
           token: TestProvider,
           scope: undefined,
           metatype: TestProvider,
+          durable: undefined,
           instance: null,
           isResolved: false,
         }),
@@ -105,77 +111,89 @@ describe('Module', () => {
 
   it('should call "addCustomProvider" when "provide" property exists', () => {
     const addCustomProvider = sinon.spy();
-    module.addCustomProvider = addCustomProvider;
+    moduleRef.addCustomProvider = addCustomProvider;
 
     const provider = { provide: 'test', useValue: 'test' };
 
-    module.addProvider(provider as any);
-    expect((addCustomProvider as sinon.SinonSpy).called).to.be.true;
+    moduleRef.addProvider(provider as any);
+    expect(addCustomProvider.called).to.be.true;
   });
 
   it('should call "addCustomClass" when "useClass" property exists', () => {
     const addCustomClass = sinon.spy();
-    module.addCustomClass = addCustomClass;
+    moduleRef.addCustomClass = addCustomClass;
 
     const provider = { provide: 'test', useClass: () => null };
 
-    module.addCustomProvider(provider as any, new Map());
-    expect((addCustomClass as sinon.SinonSpy).called).to.be.true;
+    moduleRef.addCustomProvider(provider as any, new Map());
+    expect(addCustomClass.called).to.be.true;
   });
 
   it('should call "addCustomValue" when "useValue" property exists', () => {
     const addCustomValue = sinon.spy();
-    module.addCustomValue = addCustomValue;
+    moduleRef.addCustomValue = addCustomValue;
 
     const provider = { provide: 'test', useValue: () => null };
 
-    module.addCustomProvider(provider as any, new Map());
-    expect((addCustomValue as sinon.SinonSpy).called).to.be.true;
+    moduleRef.addCustomProvider(provider as any, new Map());
+    expect(addCustomValue.called).to.be.true;
+  });
+
+  it('should call "addCustomValue" when "useValue" property exists but its value is `undefined`', () => {
+    const addCustomValue = sinon.spy();
+    moduleRef.addCustomValue = addCustomValue;
+
+    const provider = { provide: 'test', useValue: undefined };
+
+    moduleRef.addCustomProvider(provider as any, new Map());
+    expect(addCustomValue.called).to.be.true;
   });
 
   it('should call "addCustomFactory" when "useFactory" property exists', () => {
     const addCustomFactory = sinon.spy();
-    module.addCustomFactory = addCustomFactory;
+    moduleRef.addCustomFactory = addCustomFactory;
 
     const provider = { provide: 'test', useFactory: () => null };
 
-    module.addCustomProvider(provider as any, new Map());
-    expect((addCustomFactory as sinon.SinonSpy).called).to.be.true;
+    moduleRef.addCustomProvider(provider as any, new Map());
+    expect(addCustomFactory.called).to.be.true;
   });
 
   it('should call "addCustomUseExisting" when "useExisting" property exists', () => {
     const addCustomUseExisting = sinon.spy();
-    module.addCustomUseExisting = addCustomUseExisting;
+    moduleRef.addCustomUseExisting = addCustomUseExisting;
 
     const provider = { provide: 'test', useExisting: () => null };
 
-    module.addCustomUseExisting(provider as any, new Map());
-    expect((addCustomUseExisting as sinon.SinonSpy).called).to.be.true;
+    moduleRef.addCustomUseExisting(provider as any, new Map());
+    expect(addCustomUseExisting.called).to.be.true;
   });
 
   describe('addCustomClass', () => {
     const type = { name: 'TypeTest' };
-    const provider = { provide: type, useClass: type };
-    let setSpy;
+    const provider = { provide: type, useClass: type, durable: true };
+    let setSpy: sinon.SinonSpy;
 
     beforeEach(() => {
       const collection = new Map();
       setSpy = sinon.spy(collection, 'set');
-      (module as any)._providers = collection;
+      untypedModuleRef._providers = collection;
     });
     it('should store provider', () => {
-      module.addCustomClass(provider as any, (module as any)._providers);
+      moduleRef.addCustomClass(provider as any, untypedModuleRef._providers);
       expect(
         setSpy.calledWith(
           provider.provide,
           new InstanceWrapper({
-            host: module,
+            host: moduleRef,
             token: type as any,
             name: provider.provide.name,
             scope: undefined,
             metatype: type as any,
+            durable: true,
             instance: null,
             isResolved: false,
+            subtype: undefined,
           }),
         ),
       ).to.be.true;
@@ -183,23 +201,23 @@ describe('Module', () => {
   });
 
   describe('addCustomValue', () => {
-    let setSpy;
+    let setSpy: sinon.SinonSpy;
     const value = () => ({});
     const provider = { provide: value, useValue: value };
 
     beforeEach(() => {
       const collection = new Map();
       setSpy = sinon.spy(collection, 'set');
-      (module as any)._providers = collection;
+      untypedModuleRef._providers = collection;
     });
 
     it('should store provider', () => {
-      module.addCustomValue(provider as any, (module as any)._providers);
+      moduleRef.addCustomValue(provider as any, untypedModuleRef._providers);
       expect(
         setSpy.calledWith(
           provider.provide,
           new InstanceWrapper({
-            host: module,
+            host: moduleRef,
             token: provider.provide,
             name: provider.provide.name,
             scope: Scope.DEFAULT,
@@ -207,6 +225,7 @@ describe('Module', () => {
             instance: value,
             isResolved: true,
             async: false,
+            subtype: undefined,
           }),
         ),
       ).to.be.true;
@@ -216,29 +235,31 @@ describe('Module', () => {
   describe('addCustomFactory', () => {
     const type = { name: 'TypeTest' };
     const inject = [1, 2, 3];
-    const provider = { provide: type, useFactory: type, inject };
+    const provider = { provide: type, useFactory: type, inject, durable: true };
 
-    let setSpy;
+    let setSpy: sinon.SinonSpy;
     beforeEach(() => {
       const collection = new Map();
       setSpy = sinon.spy(collection, 'set');
-      (module as any)._providers = collection;
+      untypedModuleRef._providers = collection;
     });
     it('should store provider', () => {
-      module.addCustomFactory(provider as any, (module as any)._providers);
+      moduleRef.addCustomFactory(provider as any, untypedModuleRef._providers);
 
       expect(
         setSpy.calledWith(
           provider.provide,
           new InstanceWrapper({
-            host: module,
+            host: moduleRef,
             token: provider.provide as any,
             name: provider.provide.name,
             scope: undefined,
             metatype: type as any,
+            durable: true,
             instance: null,
             isResolved: false,
             inject: inject as any,
+            subtype: undefined,
           }),
         ),
       ).to.be.true;
@@ -249,15 +270,18 @@ describe('Module', () => {
     const type = { name: 'TypeTest' };
     const provider = { provide: type, useExisting: type };
 
-    let setSpy;
+    let setSpy: sinon.SinonSpy;
     beforeEach(() => {
       const collection = new Map();
       setSpy = sinon.spy(collection, 'set');
-      (module as any)._providers = collection;
+      untypedModuleRef._providers = collection;
     });
     it('should store provider', () => {
-      module.addCustomUseExisting(provider as any, (module as any)._providers);
-      const factoryFn = (module as any)._providers.get(
+      moduleRef.addCustomUseExisting(
+        provider as any,
+        untypedModuleRef._providers,
+      );
+      const factoryFn = untypedModuleRef._providers.get(
         provider.provide,
       ).metatype;
 
@@ -266,7 +290,7 @@ describe('Module', () => {
         setSpy.calledWith(
           token,
           new InstanceWrapper({
-            host: module,
+            host: moduleRef,
             token,
             name: provider.provide.name,
             metatype: factoryFn,
@@ -274,6 +298,7 @@ describe('Module', () => {
             inject: [provider.useExisting as any],
             isResolved: false,
             isAlias: true,
+            subtype: undefined,
           }),
         ),
       ).to.be.true;
@@ -284,41 +309,41 @@ describe('Module', () => {
   describe('when get instance', () => {
     describe('when metatype does not exists in providers collection', () => {
       beforeEach(() => {
-        sinon.stub((module as any)._providers, 'has').returns(false);
+        sinon.stub(untypedModuleRef._providers, 'has').returns(false);
       });
-      it('should throws RuntimeException', () => {
-        expect(() => module.instance).to.throws(RuntimeException);
+      it('should throw RuntimeException', () => {
+        expect(() => moduleRef.instance).to.throws(RuntimeException);
       });
     });
     describe('when metatype exists in providers collection', () => {
       it('should return null', () => {
-        expect(module.instance).to.be.eql(null);
+        expect(moduleRef.instance).to.be.eql(null);
       });
     });
   });
 
   describe('when exported provider is custom provided', () => {
     beforeEach(() => {
-      sinon.stub(module, 'validateExportedProvider').callsFake(o => o);
+      sinon.stub(moduleRef, 'validateExportedProvider').callsFake(o => o);
     });
     it('should call `addCustomExportedProvider`', () => {
       const addCustomExportedProviderSpy = sinon.spy(
-        module,
+        moduleRef,
         'addCustomExportedProvider',
       );
 
-      module.addExportedProvider({ provide: 'test' } as any);
+      moduleRef.addExportedProvider({ provide: 'test' } as any);
       expect(addCustomExportedProviderSpy.called).to.be.true;
     });
     it('should support symbols', () => {
       const addCustomExportedProviderSpy = sinon.spy(
-        module,
+        moduleRef,
         'addCustomExportedProvider',
       );
       const symb = Symbol('test');
-      module.addExportedProvider({ provide: symb } as any);
+      moduleRef.addExportedProvider({ provide: symb } as any);
       expect(addCustomExportedProviderSpy.called).to.be.true;
-      expect((module as any)._exports.has(symb)).to.be.true;
+      expect(untypedModuleRef._exports.has(symb)).to.be.true;
     });
   });
 
@@ -328,10 +353,10 @@ describe('Module', () => {
         const wrapper = {
           mergeWith: sinon.spy(),
         };
-        sinon.stub(module, 'hasProvider').callsFake(() => true);
-        sinon.stub(module.providers, 'get').callsFake(() => wrapper as any);
+        sinon.stub(moduleRef, 'hasProvider').callsFake(() => true);
+        sinon.stub(moduleRef.providers, 'get').callsFake(() => wrapper as any);
 
-        module.replace(null, { isProvider: true });
+        moduleRef.replace(null!, { isProvider: true });
         expect(wrapper.mergeWith.called).to.be.true;
       });
     });
@@ -341,10 +366,12 @@ describe('Module', () => {
           mergeWith: sinon.spy(),
           isProvider: true,
         };
-        sinon.stub(module, 'hasInjectable').callsFake(() => true);
-        sinon.stub(module.injectables, 'get').callsFake(() => wrapper as any);
+        sinon.stub(moduleRef, 'hasInjectable').callsFake(() => true);
+        sinon
+          .stub(moduleRef.injectables, 'get')
+          .callsFake(() => wrapper as any);
 
-        module.replace(null, {});
+        moduleRef.replace(null!, {});
         expect(wrapper.mergeWith.called).to.be.true;
       });
     });
@@ -353,66 +380,63 @@ describe('Module', () => {
   describe('imports', () => {
     it('should return relatedModules', () => {
       const test = ['test'];
-      (module as any)._imports = test;
+      untypedModuleRef._imports = test;
 
-      expect(module.imports).to.be.eql(test);
-      expect(module.relatedModules).to.be.eql(test);
+      expect(moduleRef.imports).to.be.eql(test);
     });
   });
 
   describe('injectables', () => {
     it('should return injectables', () => {
       const test = ['test'];
-      (module as any)._injectables = test;
-      expect(module.injectables).to.be.eql(test);
+      untypedModuleRef._injectables = test;
+      expect(moduleRef.injectables).to.be.eql(test);
     });
   });
 
   describe('controllers', () => {
     it('should return controllers', () => {
       const test = ['test'];
-      (module as any)._controllers = test;
+      untypedModuleRef._controllers = test;
 
-      expect(module.controllers).to.be.eql(test);
-      expect(module.routes).to.be.eql(test);
+      expect(moduleRef.controllers).to.be.eql(test);
     });
   });
 
   describe('exports', () => {
     it('should return exports', () => {
       const test = ['test'];
-      (module as any)._exports = test;
+      untypedModuleRef._exports = test;
 
-      expect(module.exports).to.be.eql(test);
+      expect(moduleRef.exports).to.be.eql(test);
     });
   });
 
   describe('providers', () => {
     it('should return providers', () => {
       const test = ['test'];
-      (module as any)._providers = test;
+      untypedModuleRef._providers = test;
 
-      expect(module.providers).to.be.eql(test);
-      expect(module.components).to.be.eql(test);
+      expect(moduleRef.providers).to.be.eql(test);
     });
   });
 
   describe('createModuleReferenceType', () => {
-    let moduleRef;
-
-    class SimpleClass {}
+    let customModuleRef: any;
 
     beforeEach(() => {
-      const Class = module.createModuleReferenceType();
-      moduleRef = new Class();
+      const Class = moduleRef.createModuleReferenceType();
+      customModuleRef = new Class();
     });
 
     it('should return metatype with "get" method', () => {
-      expect(!!moduleRef.get).to.be.true;
+      expect(!!customModuleRef.get).to.be.true;
     });
     describe('get', () => {
       it('should throw exception if not exists', () => {
-        expect(() => moduleRef.get('fail')).to.throws(UnknownElementException);
+        expect(() => customModuleRef.get('fail')).to.throws(
+          UnknownElementException,
+        );
       });
     });
   });
@@ -421,22 +445,22 @@ describe('Module', () => {
 
     describe('when unit exists in provider collection', () => {
       it('should behave as identity', () => {
-        (module as any)._providers = new Map([[token, true]]);
-        expect(module.validateExportedProvider(token)).to.be.eql(token);
+        untypedModuleRef._providers = new Map([[token, true]]);
+        expect(moduleRef.validateExportedProvider(token)).to.be.eql(token);
       });
     });
     describe('when unit exists in related modules collection', () => {
       it('should behave as identity', () => {
         class Random {}
-        (module as any)._imports = new Set([
+        untypedModuleRef._imports = new Set([
           new Module(Random, new NestContainer()),
         ]);
-        expect(module.validateExportedProvider(Random)).to.be.eql(Random);
+        expect(moduleRef.validateExportedProvider(Random)).to.be.eql(Random);
       });
     });
     describe('when unit does not exist in both provider and related modules collections', () => {
       it('should throw UnknownExportException', () => {
-        expect(() => module.validateExportedProvider(token)).to.throws(
+        expect(() => moduleRef.validateExportedProvider(token)).to.throws(
           UnknownExportException,
         );
       });
@@ -447,13 +471,13 @@ describe('Module', () => {
     describe('when module has provider', () => {
       it('should return true', () => {
         const token = 'test';
-        module.providers.set(token, new InstanceWrapper());
-        expect(module.hasProvider(token)).to.be.true;
+        moduleRef.providers.set(token, new InstanceWrapper());
+        expect(moduleRef.hasProvider(token)).to.be.true;
       });
     });
     describe('otherwise', () => {
       it('should return false', () => {
-        expect(module.hasProvider('_')).to.be.false;
+        expect(moduleRef.hasProvider('_')).to.be.false;
       });
     });
   });
@@ -462,33 +486,33 @@ describe('Module', () => {
     describe('when module has injectable', () => {
       it('should return true', () => {
         const token = 'test';
-        module.injectables.set(token, new InstanceWrapper());
-        expect(module.hasInjectable(token)).to.be.true;
+        moduleRef.injectables.set(token, new InstanceWrapper());
+        expect(moduleRef.hasInjectable(token)).to.be.true;
       });
     });
     describe('otherwise', () => {
       it('should return false', () => {
-        expect(module.hasInjectable('_')).to.be.false;
+        expect(moduleRef.hasInjectable('_')).to.be.false;
       });
     });
   });
 
   describe('getter "id"', () => {
     it('should return module id', () => {
-      expect(module.id).to.be.equal(module['_id']);
+      expect(moduleRef.id).to.be.equal(moduleRef['_id']);
     });
   });
 
   describe('getProviderByKey', () => {
     describe('when does not exist', () => {
       it('should return undefined', () => {
-        expect(module.getProviderByKey('test')).to.be.undefined;
+        expect(moduleRef.getProviderByKey('test')).to.be.undefined;
       });
     });
     describe('otherwise', () => {
       it('should return instance wrapper', () => {
-        module.addProvider(TestProvider);
-        expect(module.getProviderByKey(TestProvider)).to.not.be.undefined;
+        moduleRef.addProvider(TestProvider);
+        expect(moduleRef.getProviderByKey(TestProvider)).to.not.be.undefined;
       });
     });
   });
diff --git a/packages/core/test/injector/opaque-key-factory/by-reference-module-opaque-key-factory.spec.ts b/packages/core/test/injector/opaque-key-factory/by-reference-module-opaque-key-factory.spec.ts
new file mode 100644
index 000000000..2d9db42eb
--- /dev/null
+++ b/packages/core/test/injector/opaque-key-factory/by-reference-module-opaque-key-factory.spec.ts
@@ -0,0 +1,111 @@
+import { expect } from 'chai';
+import * as sinon from 'sinon';
+import { ByReferenceModuleOpaqueKeyFactory } from '../../../injector/opaque-key-factory/by-reference-module-opaque-key-factory';
+
+describe('ByReferenceModuleOpaqueKeyFactory', () => {
+  const moduleId = 'constId';
+  let factory: ByReferenceModuleOpaqueKeyFactory;
+
+  describe('when generating algorithm is random', () => {
+    beforeEach(() => {
+      factory = new ByReferenceModuleOpaqueKeyFactory();
+      sinon.stub(factory as any, 'generateRandomString').returns(moduleId);
+    });
+
+    describe('createForStatic', () => {
+      class Module {}
+
+      it('should return expected token', () => {
+        const type = Module;
+        const token1 = factory.createForStatic(type);
+        const token2 = factory.createForStatic(type);
+        expect(token1).to.be.deep.eq(token2);
+      });
+    });
+
+    describe('createForDynamic', () => {
+      class Module {}
+
+      it('should include dynamic metadata', () => {
+        const dynamicModule = {
+          module: Module,
+          providers: [
+            {
+              provide: 'test',
+              useValue: 'test',
+            },
+          ],
+        };
+        const token1 = factory.createForDynamic(
+          dynamicModule.module,
+          {
+            providers: dynamicModule.providers,
+          },
+          dynamicModule,
+        );
+        const token2 = factory.createForDynamic(
+          dynamicModule.module,
+          {
+            providers: dynamicModule.providers,
+          },
+          dynamicModule,
+        );
+
+        expect(token1).to.be.deep.eq(token2);
+      });
+    });
+  });
+  describe('when generating algorithm is shallow', () => {
+    beforeEach(() => {
+      factory = new ByReferenceModuleOpaqueKeyFactory({
+        keyGenerationStrategy: 'shallow',
+      });
+      sinon.stub(factory as any, 'generateRandomString').returns(moduleId);
+    });
+
+    describe('createForStatic', () => {
+      class Module {}
+
+      it('should return expected token', () => {
+        const type = Module;
+        const token1 = factory.createForStatic(type);
+        const token2 = factory.createForStatic(type);
+
+        expect(token1).to.be.deep.eq(token2);
+      });
+    });
+
+    describe('createForDynamic', () => {
+      class Module {}
+
+      it('should include dynamic metadata', () => {
+        const dynamicModule = {
+          module: Module,
+          providers: [
+            {
+              provide: 'test',
+              useValue: 'test',
+            },
+          ],
+        };
+
+        const token1 = factory.createForDynamic(
+          dynamicModule.module,
+          {
+            providers: dynamicModule.providers,
+          },
+          dynamicModule,
+        );
+        const token2 = factory.createForDynamic(
+          dynamicModule.module,
+          {
+            providers: dynamicModule.providers,
+          },
+          dynamicModule,
+        );
+
+        expect(token1).to.be.deep.eq(token2);
+      });
+    });
+  });
+});
diff --git a/packages/core/test/injector/module-token-factory.spec.ts b/packages/core/test/injector/opaque-key-factory/deep-hashed-module-opaque-key-factory.spec.ts
similarity index 62%
rename from packages/core/test/injector/module-token-factory.spec.ts
rename to packages/core/test/injector/opaque-key-factory/deep-hashed-module-opaque-key-factory.spec.ts
index 9f753773c..28d05a6cb 100644
--- a/packages/core/test/injector/module-token-factory.spec.ts
+++ b/packages/core/test/injector/opaque-key-factory/deep-hashed-module-opaque-key-factory.spec.ts
@@ -1,65 +1,60 @@
 import { expect } from 'chai';
-import stringify from 'fast-safe-stringify';
-import * as hash from 'object-hash';
 import * as sinon from 'sinon';
-import { ModuleTokenFactory } from '../../injector/module-token-factory';
+import { DeepHashedModuleOpaqueKeyFactory } from '../../../injector/opaque-key-factory/deep-hashed-module-opaque-key-factory';
 
-describe('ModuleTokenFactory', () => {
+describe('DeepHashedModuleOpaqueKeyFactory', () => {
   const moduleId = 'constId';
-  let factory: ModuleTokenFactory;
+  let factory: DeepHashedModuleOpaqueKeyFactory;
 
   beforeEach(() => {
-    factory = new ModuleTokenFactory();
+    factory = new DeepHashedModuleOpaqueKeyFactory();
     sinon.stub(factory, 'getModuleId').returns(moduleId);
   });
-  describe('create', () => {
+  describe('createForStatic', () => {
     class Module {}
+
     it('should return expected token', () => {
       const type = Module;
-      const token = factory.create(type, undefined);
-      expect(token).to.be.deep.eq(
-        hash({
-          id: moduleId,
-          module: Module.name,
-          dynamic: '',
-        }),
-      );
+      const token1 = factory.createForStatic(type);
+      const token2 = factory.createForStatic(type);
+      expect(token1).to.be.deep.eq(token2);
     });
+  });
+  describe('createForDynamic', () => {
+    class Module {}
+
     it('should include dynamic metadata', () => {
       const type = Module;
-      const token = factory.create(type, {
+      const token1 = factory.createForDynamic(type, {
+        providers: [{}],
+      } as any);
+      const token2 = factory.createForDynamic(type, {
         providers: [{}],
       } as any);
 
-      expect(token).to.be.deep.eq(
-        hash({
-          id: moduleId,
-          module: Module.name,
-          dynamic: stringify({
-            providers: [{}],
-          }),
-        }),
-      );
+      expect(token1).to.be.deep.eq(token2);
     });
   });
+
   describe('getModuleName', () => {
     it('should map module metatype to name', () => {
       const metatype = () => {};
       expect(factory.getModuleName(metatype as any)).to.be.eql(metatype.name);
     });
   });
-  describe('getDynamicMetadataToken', () => {
+
+  describe('getStringifiedOpaqueToken', () => {
     describe('when metadata exists', () => {
       it('should return hash', () => {
         const metadata = { providers: ['', {}] };
-        expect(factory.getDynamicMetadataToken(metadata as any)).to.be.eql(
+        expect(factory.getStringifiedOpaqueToken(metadata as any)).to.be.eql(
           JSON.stringify(metadata),
         );
       });
       it('should return hash with class', () => {
         class Provider {}
         const metadata = { providers: [Provider], exports: [Provider] };
-        expect(factory.getDynamicMetadataToken(metadata)).to.be.eql(
+        expect(factory.getStringifiedOpaqueToken(metadata)).to.be.eql(
           '{"providers":["Provider"],"exports":["Provider"]}',
         );
       });
@@ -69,10 +64,8 @@ describe('ModuleTokenFactory', () => {
           useValue: function Provider() {},
         };
         const metadata = { providers: [provider] };
-        expect(factory.getDynamicMetadataToken(metadata)).to.be.eql(
-          `{"providers":[{"provide":"ProvideValue","useValue":"${hash(
-            provider.useValue.toString(),
-          )}"}]}`,
+        expect(factory.getStringifiedOpaqueToken(metadata)).to.be.eql(
+          `{"providers":[{"provide":"ProvideValue","useValue":"${provider.useValue.toString()}"}]}`,
         );
       });
       it('should serialize symbols in a dynamic metadata object', () => {
@@ -89,14 +82,15 @@ describe('ModuleTokenFactory', () => {
           ],
         };
 
-        expect(factory.getDynamicMetadataToken(metadata)).to.be.eql(
+        expect(factory.getStringifiedOpaqueToken(metadata)).to.be.eql(
           '{"providers":[{"provide":"Symbol(a)","useValue":"a"},{"provide":"Symbol(b)","useValue":"b"}]}',
         );
       });
     });
+
     describe('when metadata does not exist', () => {
       it('should return empty string', () => {
-        expect(factory.getDynamicMetadataToken(undefined)).to.be.eql('');
+        expect(factory.getStringifiedOpaqueToken(undefined)).to.be.eql('');
       });
     });
   });
diff --git a/packages/core/test/inspector/graph-inspector.spec.ts b/packages/core/test/inspector/graph-inspector.spec.ts
new file mode 100644
index 000000000..d24780341
--- /dev/null
+++ b/packages/core/test/inspector/graph-inspector.spec.ts
@@ -0,0 +1,219 @@
+import { Scope } from '@nestjs/common';
+import { expect } from 'chai';
+import * as sinon from 'sinon';
+import { NestContainer } from '../../injector/container';
+import { InstanceWrapper } from '../../injector/instance-wrapper';
+import { Module } from '../../injector/module';
+import { GraphInspector } from '../../inspector/graph-inspector';
+import { EnhancerMetadataCacheEntry } from '../../inspector/interfaces/enhancer-metadata-cache-entry.interface';
+import { SerializedGraph } from '../../inspector/serialized-graph';
+
+describe('GraphInspector', () => {
+  let graphInspector: GraphInspector;
+  let enhancersMetadataCache: Array<EnhancerMetadataCacheEntry>;
+  let graph: SerializedGraph;
+  let container: NestContainer;
+
+  beforeEach(() => {
+    container = new NestContainer();
+    graphInspector = new GraphInspector(container);
+
+    enhancersMetadataCache = graphInspector['enhancersMetadataCache'];
+    graph = graphInspector['graph'];
+  });
+
+  describe('insertEnhancerMetadataCache', () => {
+    it('should insert an enhancer metadata cache entry', () => {
+      const entry = {
+        moduleToken: 'moduleToken',
+        classRef: class AppService {},
+        methodKey: undefined,
+        subtype: 'guard' as const,
+      };
+      graphInspector.insertEnhancerMetadataCache(entry);
+      expect(enhancersMetadataCache).includes(entry);
+    });
+  });
+
+  describe('inspectInstanceWrapper', () => {
+    class AppService {}
+
+    it('should inspect given instance wrapper and insert appropriate edges', () => {
+      const moduleRef = new Module(class TestModule {}, container);
+      const instanceWrapper = new InstanceWrapper({
+        token: AppService,
+        name: AppService.name,
+        metatype: AppService,
+      });
+
+      const param1 = new InstanceWrapper({
+        token: 'PARAM_1',
+        metatype: class A {},
+        host: new Module(class AModule {}, container),
+      });
+      const param2 = new InstanceWrapper({
+        token: 'PARAM_2',
+        metatype: class B {},
+        host: new Module(class BModule {}, container),
+      });
+      const dependency = new InstanceWrapper({
+        name: 'PROPERTY',
+        token: 'PROPERTY',
+        metatype: class C {},
+        host: new Module(class CModule {}, container),
+      });
+
+      instanceWrapper.addCtorMetadata(0, param1);
+      instanceWrapper.addCtorMetadata(1, param2);
+      instanceWrapper.addCtorMetadata(2, dependency);
+
+      graphInspector.inspectInstanceWrapper(instanceWrapper, moduleRef);
+
+      const edgesArr = [...graph['edges'].values()];
+      expect(edgesArr).to.deep.equal([
+        {
+          id: edgesArr[0].id,
+          metadata: {
+            injectionType: 'constructor',
+            keyOrIndex: 0,
+            sourceClassName: instanceWrapper.metatype!.name,
+            sourceClassToken: instanceWrapper.token,
+            sourceModuleName: 'TestModule',
+            targetClassName: param1.name,
+            targetClassToken: 'PARAM_1',
+            targetModuleName: 'AModule',
+            type: 'class-to-class',
+          },
+          source: instanceWrapper.id,
+          target: param1.id,
+        },
+        {
+          id: edgesArr[1].id,
+          metadata: {
+            injectionType: 'constructor',
+            keyOrIndex: 1,
+            sourceClassName: instanceWrapper.metatype!.name,
+            sourceClassToken: instanceWrapper.token,
+            sourceModuleName: 'TestModule',
+            targetClassName: param2.name,
+            targetClassToken: 'PARAM_2',
+            targetModuleName: 'BModule',
+            type: 'class-to-class',
+          },
+          source: instanceWrapper.id,
+          target: param2.id,
+        },
+        {
+          id: edgesArr[2].id,
+          metadata: {
+            injectionType: 'constructor',
+            keyOrIndex: 2,
+            sourceClassName: 'AppService',
+            sourceClassToken: AppService,
+            sourceModuleName: 'TestModule',
+            targetClassName: dependency.name,
+            targetClassToken: 'PROPERTY',
+            targetModuleName: 'CModule',
+            type: 'class-to-class',
+          },
+          source: instanceWrapper.id,
+          target: dependency.id,
+        },
+      ]);
+    });
+  });
+
+  describe('inspectModules', () => {
+    class TestModule {}
+    class AController {}
+    class RandomPipe {}
+
+    it('should inspect all modules', async () => {
+      const { moduleRef } = (await container.addModule(TestModule, []))!;
+      moduleRef.addController(AController);
+
+      const subtype = 'interceptor';
+      const enhancerInstanceWrapper = moduleRef.addInjectable(
+        class Enhancer {},
+        subtype,
+      ) as InstanceWrapper;
+
+      const methodKey = 'findOne';
+      enhancersMetadataCache.push(
+        {
+          moduleToken: moduleRef.token,
+          classRef: AController,
+          enhancerRef: new RandomPipe(),
+          methodKey,
+          subtype,
+        },
+        {
+          moduleToken: moduleRef.token,
+          classRef: AController,
+          enhancerRef: function test() {},
+          methodKey,
+          subtype,
+        },
+        {
+          moduleToken: moduleRef.token,
+          classRef: AController,
+          enhancerInstanceWrapper,
+          methodKey: undefined,
+          subtype,
+        },
+      );
+
+      const serializedNode = { metadata: {} };
+      sinon.stub(graph, 'getNodeById').callsFake(() => serializedNode as any);
+
+      graphInspector.inspectModules();
+
+      expect(serializedNode).to.deep.equal({
+        metadata: {
+          enhancers: [
+            { methodKey, name: RandomPipe.name, subtype },
+            { methodKey, name: 'Function', subtype },
+            { methodKey: undefined, id: enhancerInstanceWrapper.id, subtype },
+          ],
+        },
+      });
+    });
+  });
+
+  describe('insertAttachedEnhancer', () => {
+    it('should upsert existing node (update metadata) and add node to "attachedEnhancers" array', () => {
+      const instanceWrapper = new InstanceWrapper({
+        metatype: class A {},
+        token: 'A',
+      });
+
+      const nodeDefinition = {
+        id: instanceWrapper.id,
+        label: 'A',
+        parent: '2c989d11-2731-4828-a2eb-c86d10c73621',
+        metadata: {
+          type: 'provider' as const,
+          sourceModuleName: 'AppModule',
+          durable: false,
+          static: true,
+          scope: Scope.DEFAULT,
+          transient: false,
+          token: class A {},
+          exported: false,
+          initTime: 100,
+        },
+      };
+      const insertedNode = graph.insertNode(nodeDefinition)!;
+
+      graphInspector.insertAttachedEnhancer(instanceWrapper);
+
+      expect(insertedNode.metadata).to.deep.equal({
+        ...nodeDefinition.metadata,
+        global: true,
+      });
+      expect(graph['extras'].attachedEnhancers).to.deep.contain({
+        nodeId: insertedNode.id,
+      });
+    });
+  });
+});
diff --git a/packages/core/test/inspector/serialized-graph.spec.ts b/packages/core/test/inspector/serialized-graph.spec.ts
new file mode 100644
index 000000000..25c5bd15a
--- /dev/null
+++ b/packages/core/test/inspector/serialized-graph.spec.ts
@@ -0,0 +1,160 @@
+import { Scope } from '@nestjs/common';
+import { expect } from 'chai';
+import { ApplicationConfig } from '../../application-config';
+import { Edge } from '../../inspector/interfaces/edge.interface';
+import { Node } from '../../inspector/interfaces/node.interface';
+import { SerializedGraph } from '../../inspector/serialized-graph';
+
+describe('SerializedGraph', () => {
+  let serializedGraph: SerializedGraph;
+  let nodesCollection: Map<string, Node>;
+  let edgesCollection: Map<string, Edge>;
+
+  beforeEach(() => {
+    serializedGraph = new SerializedGraph();
+    nodesCollection = serializedGraph['nodes'];
+    edgesCollection = serializedGraph['edges'];
+  });
+
+  describe('insertNode', () => {
+    describe('when node definition represents an internal provider', () => {
+      it('should insert a node with the expected schema (internal: true)', () => {
+        const nodeDefinition = {
+          id: '11430093-e992-4ae6-8ba4-c7db80419de8',
+          label: 'ApplicationConfig',
+          parent: '2c989d11-2731-4828-a2eb-c86d10c73621',
+          metadata: {
+            type: 'provider' as const,
+            sourceModuleName: 'AppModule',
+            durable: false,
+            static: true,
+            transient: false,
+            token: ApplicationConfig,
+            scope: Scope.DEFAULT,
+            exported: false,
+            initTime: 100,
+          },
+        };
+        serializedGraph.insertNode(nodeDefinition);
+
+        expect(nodesCollection.get(nodeDefinition.id)).to.deep.equal({
+          ...nodeDefinition,
+          metadata: {
+            ...nodeDefinition.metadata,
+            internal: true,
+          },
+        });
+      });
+    });
+    describe('otherwise', () => {
+      it('should insert a node with the expected schema', () => {
+        class AppService {}
+
+        const nodeDefinition = {
+          id: '11430093-e992-4ae6-8ba4-c7db80419de8',
+          label: 'AppService',
+          parent: '2c989d11-2731-4828-a2eb-c86d10c73621',
+          metadata: {
+            type: 'provider' as const,
+            sourceModuleName: 'AppModule',
+            durable: false,
+            static: true,
+            transient: false,
+            token: AppService,
+            scope: Scope.DEFAULT,
+            exported: false,
+            initTime: 100,
+          },
+        };
+        serializedGraph.insertNode(nodeDefinition);
+
+        expect(nodesCollection.get(nodeDefinition.id)).to.equal(nodeDefinition);
+      });
+    });
+  });
+
+  describe('insertEdge', () => {
+    describe('when edge definition represents internal providers connection', () => {
+      it('should insert an edge with the expected schema (internal: true)', () => {
+        const edgeDefinition = {
+          source: '8920252f-4e7d-4f9e-9eeb-71da467a35cc',
+          target: 'c97bc04d-cfcf-41b1-96ec-db729f33676e',
+          metadata: {
+            type: 'class-to-class' as const,
+            sourceModuleName: 'UtilsExceptionsModule',
+            sourceClassName: 'AllExceptionsFilter',
+            targetClassName: 'HttpAdapterHost',
+            sourceClassToken:
+              'APP_FILTER (UUID: 4187828c-5c76-4aed-a29f-a6eb40054b9d)',
+            targetClassToken: 'HttpAdapterHost',
+            targetModuleName: 'InternalCoreModule',
+            keyOrIndex: 0,
+            injectionType: 'constructor' as const,
+          },
+        };
+        const edge = serializedGraph.insertEdge(edgeDefinition);
+
+        expect(edgesCollection.get(edge.id)).to.deep.equal({
+          ...edgeDefinition,
+          metadata: {
+            ...edgeDefinition.metadata,
+            internal: true,
+          },
+          id: edge.id,
+        });
+      });
+    });
+    describe('otherwise', () => {
+      it('should insert an edge with the expected schema', () => {
+        const edgeDefinition = {
+          source: '8920252f-4e7d-4f9e-9eeb-71da467a35cc',
+          target: 'c97bc04d-cfcf-41b1-96ec-db729f33676e',
+          metadata: {
+            type: 'class-to-class' as const,
+            sourceModuleName: 'UtilsExceptionsModule',
+            sourceClassName: 'AllExceptionsFilter',
+            targetClassName: 'AppService',
+            sourceClassToken:
+              'APP_FILTER (UUID: 4187828c-5c76-4aed-a29f-a6eb40054b9d)',
+            targetClassToken: 'AppService',
+            targetModuleName: 'InternalCoreModule',
+            keyOrIndex: 0,
+            injectionType: 'constructor' as const,
+          },
+        };
+        const edge = serializedGraph.insertEdge(edgeDefinition);
+
+        expect(edgesCollection.get(edge.id)).to.deep.equal({
+          ...edgeDefinition,
+          id: edge.id,
+        });
+      });
+    });
+  });
+
+  describe('getNodeById', () => {
+    it('should return a given node', () => {
+      const nodeDefinition = {
+        id: '11430093-e992-4ae6-8ba4-c7db80419de8',
+        label: 'AppService',
+        parent: '2c989d11-2731-4828-a2eb-c86d10c73621',
+        metadata: {
+          type: 'provider' as const,
+          sourceModuleName: 'AppModule',
+          durable: false,
+          static: true,
+          transient: false,
+          scope: Scope.DEFAULT,
+          token: 'AppService',
+          exported: true,
+          initTime: 100,
+        },
+      };
+
+      nodesCollection.set(nodeDefinition.id, nodeDefinition);
+      expect(serializedGraph.getNodeById(nodeDefinition.id)).to.eq(
+        nodeDefinition,
+      );
+    });
+  });
+});
diff --git a/packages/core/test/interceptors/interceptors-consumer.spec.ts b/packages/core/test/interceptors/interceptors-consumer.spec.ts
index d2efbcaf4..e560be19f 100644
--- a/packages/core/test/interceptors/interceptors-consumer.spec.ts
+++ b/packages/core/test/interceptors/interceptors-consumer.spec.ts
@@ -1,5 +1,7 @@
+import { CallHandler, ExecutionContext, NestInterceptor } from '@nestjs/common';
+import { AsyncLocalStorage } from 'async_hooks';
 import { expect } from 'chai';
-import { lastValueFrom, of } from 'rxjs';
+import { Observable, defer, lastValueFrom, merge, of, retry } from 'rxjs';
 import * as sinon from 'sinon';
 import { InterceptorsConsumer } from '../../interceptors/interceptors-consumer';
 
@@ -26,7 +28,7 @@ describe('InterceptorsConsumer', () => {
         next = sinon.spy();
       });
       it('should call next()', async () => {
-        await consumer.intercept([], null, { constructor: null }, null, next);
+        await consumer.intercept([], null!, { constructor: null }, null!, next);
         expect(next.calledOnce).to.be.true;
       });
     });
@@ -35,49 +37,108 @@ describe('InterceptorsConsumer', () => {
       beforeEach(() => {
         next = sinon.stub().returns(Promise.resolve(''));
       });
-      it('should call every `intercept` method', async () => {
+      it('does not call `intercept` (lazy evaluation)', async () => {
         await consumer.intercept(
           interceptors,
-          null,
+          null!,
           { constructor: null },
-          null,
+          null!,
           next,
         );
 
+        expect(interceptors[0].intercept.called).to.be.false;
+        expect(interceptors[1].intercept.called).to.be.false;
+      });
+      it('should call every `intercept` method when subscribe', async () => {
+        const intercepted = await consumer.intercept(
+          interceptors,
+          null!,
+          { constructor: null },
+          null!,
+          next,
+        );
+        await transformToResult(intercepted);
+
         expect(interceptors[0].intercept.calledOnce).to.be.true;
         expect(interceptors[1].intercept.calledOnce).to.be.true;
       });
       it('should not call `next` (lazy evaluation)', async () => {
         await consumer.intercept(
           interceptors,
-          null,
+          null!,
           { constructor: null },
-          null,
+          null!,
           next,
         );
         expect(next.called).to.be.false;
       });
       it('should call `next` when subscribe', async () => {
-        async function transformToResult(resultOrDeferred: any) {
-          if (
-            resultOrDeferred &&
-            typeof resultOrDeferred.subscribe === 'function'
-          ) {
-            return lastValueFrom(resultOrDeferred);
-          }
-          return resultOrDeferred;
-        }
         const intercepted = await consumer.intercept(
           interceptors,
-          null,
+          null!,
           { constructor: null },
-          null,
+          null!,
           next,
         );
         await transformToResult(intercepted);
         expect(next.called).to.be.true;
       });
     });
+
+    describe('when AsyncLocalStorage is used', () => {
+      it('should allow an interceptor to set values in AsyncLocalStorage that are accessible from the controller', async () => {
+        const storage = new AsyncLocalStorage<Record<string, any>>();
+        class StorageInterceptor implements NestInterceptor {
+          intercept(
+            _context: ExecutionContext,
+            next: CallHandler<any>,
+          ): Observable<any> | Promise<Observable<any>> {
+            return storage.run({ value: 'hello' }, () => next.handle());
+          }
+        }
+        const next = () => {
+          return Promise.resolve(storage.getStore()!.value);
+        };
+        const intercepted = await consumer.intercept(
+          [new StorageInterceptor()],
+          null!,
+          { constructor: null },
+          null!,
+          next,
+        );
+        const result = await transformToResult(intercepted);
+        expect(result).to.equal('hello');
+      });
+    });
+
+    describe('when retrying is enabled', () => {
+      it('should retry a specified amount of times', async () => {
+        let count = 0;
+        const next = () => {
+          count++;
+          if (count < 3) {
+            return Promise.reject(new Error('count not reached'));
+          }
+          return Promise.resolve(count);
+        };
+        class RetryInterceptor implements NestInterceptor {
+          intercept(
+            _context: ExecutionContext,
+            next: CallHandler<any>,
+          ): Observable<any> | Promise<Observable<any>> {
+            return next.handle().pipe(retry(4));
+          }
+        }
+        const intercepted = await consumer.intercept(
+          [new RetryInterceptor()],
+          null!,
+          { constructor: null },
+          null!,
+          next,
+        );
+        expect(await transformToResult(intercepted)).to.equal(3);
+      });
+    });
   });
   describe('createContext', () => {
     it('should return execution context object', () => {
@@ -113,9 +174,60 @@ describe('InterceptorsConsumer', () => {
         const val = 3;
         const next = async () => of(val);
         expect(
-          await await lastValueFrom(consumer.transformDeferred(next) as any),
+          await lastValueFrom(consumer.transformDeferred(next) as any),
         ).to.be.eql(val);
       });
     });
   });
+  describe('deferred promise conversion', () => {
+    it('should convert promise to observable deferred', async () => {
+      class TestError extends Error {}
+      const testInterceptors = [
+        {
+          intercept: sinon.stub().callsFake(async (ctx, handler) => {
+            return merge(
+              handler.handle(),
+              defer(() => {
+                throw new TestError();
+              }),
+            );
+          }),
+        },
+        {
+          intercept: sinon
+            .stub()
+            .callsFake(async (ctx, handler) => handler.handle()),
+        },
+        {
+          intercept: sinon
+            .stub()
+            .callsFake(async (ctx, handler) => handler.handle()),
+        },
+      ];
+
+      const observable = await consumer.intercept(
+        testInterceptors,
+        null!,
+        { constructor: null },
+        null!,
+        async () => 1,
+      );
+
+      try {
+        await transformToResult(observable);
+      } catch (error) {
+        if (!(error instanceof TestError)) {
+          throw error;
+        }
+      }
+      expect(testInterceptors[2].intercept.called).to.be.false;
+    });
+  });
 });
+
+async function transformToResult(resultOrDeferred: any) {
+  if (resultOrDeferred && typeof resultOrDeferred.subscribe === 'function') {
+    return lastValueFrom(resultOrDeferred);
+  }
+  return resultOrDeferred;
+}
diff --git a/packages/core/test/interceptors/interceptors-context-creator.spec.ts b/packages/core/test/interceptors/interceptors-context-creator.spec.ts
index 09c3f8b78..8e9bd5ce9 100644
--- a/packages/core/test/interceptors/interceptors-context-creator.spec.ts
+++ b/packages/core/test/interceptors/interceptors-context-creator.spec.ts
@@ -53,7 +53,7 @@ describe('InterceptorsContextCreator', () => {
     };
     applicationConfig = new ApplicationConfig();
     interceptorsContextCreator = new InterceptorsContextCreator(
-      container as any,
+      container,
       applicationConfig,
     );
   });
@@ -84,7 +84,7 @@ describe('InterceptorsContextCreator', () => {
   describe('getInterceptorInstance', () => {
     describe('when param is an object', () => {
       it('should return instance', () => {
-        const instance = { intercept: () => null };
+        const instance = { intercept: () => null! };
         expect(
           interceptorsContextCreator.getInterceptorInstance(instance),
         ).to.be.eql(instance);
@@ -106,7 +106,7 @@ describe('InterceptorsContextCreator', () => {
       it('should return null', () => {
         sinon
           .stub(interceptorsContextCreator, 'getInstanceByMetatype')
-          .callsFake(() => null);
+          .callsFake(() => null!);
         expect(
           interceptorsContextCreator.getInterceptorInstance(Interceptor),
         ).to.be.eql(null);
@@ -118,7 +118,7 @@ describe('InterceptorsContextCreator', () => {
     describe('when "moduleContext" is nil', () => {
       it('should return undefined', () => {
         (interceptorsContextCreator as any).moduleContext = undefined;
-        expect(interceptorsContextCreator.getInstanceByMetatype(null)).to.be
+        expect(interceptorsContextCreator.getInstanceByMetatype(null!)).to.be
           .undefined;
       });
     });
@@ -160,7 +160,7 @@ describe('InterceptorsContextCreator', () => {
           .callsFake(() => scopedInterceptorWrappers);
         sinon
           .stub(instanceWrapper, 'getInstanceByContextId')
-          .callsFake(() => ({ instance } as any));
+          .callsFake(() => ({ instance }) as any);
 
         expect(
           interceptorsContextCreator.getGlobalMetadata({ id: 3 }),
diff --git a/packages/core/test/metadata-scanner.spec.ts b/packages/core/test/metadata-scanner.spec.ts
index f0a51b6d0..dd2c78b3f 100644
--- a/packages/core/test/metadata-scanner.spec.ts
+++ b/packages/core/test/metadata-scanner.spec.ts
@@ -30,12 +30,32 @@ describe('MetadataScanner', () => {
     }
 
     it('should return only methods', () => {
-      const methods = scanner.scanFromPrototype(
+      const methods = scanner.getAllMethodNames(Test.prototype);
+      expect(methods).to.eql(['test', 'test2', 'testParent', 'testParent2']);
+    });
+
+    it('should return the same instance for the same prototype', () => {
+      const methods1 = scanner.getAllMethodNames(Test.prototype);
+      const methods2 = scanner.getAllMethodNames(Test.prototype);
+      expect(methods1 === methods2).to.eql(true);
+    });
+
+    it('should keep compatibility with older methods', () => {
+      const methods1 = scanner.getAllMethodNames(Test.prototype).map(m => m[0]);
+      const methods2 = scanner.scanFromPrototype(
         new Test(),
         Test.prototype,
-        a => a,
+        r => r[0],
       );
-      expect(methods).to.eql(['test', 'test2', 'testParent', 'testParent2']);
+
+      expect(methods1).to.eql(methods2);
+
+      const methods3 = scanner.getAllMethodNames(Test.prototype);
+      const methods4 = [
+        ...new Set(scanner.getAllFilteredMethodNames(Test.prototype)),
+      ];
+
+      expect(methods3).to.eql(methods4);
     });
   });
 });
diff --git a/packages/core/test/middleware/builder.spec.ts b/packages/core/test/middleware/builder.spec.ts
index 1cc6e144d..0f625f714 100644
--- a/packages/core/test/middleware/builder.spec.ts
+++ b/packages/core/test/middleware/builder.spec.ts
@@ -1,7 +1,22 @@
 import { expect } from 'chai';
-import { Controller, Get } from '../../../common';
+import {
+  Controller,
+  Delete,
+  Get,
+  Head,
+  Options,
+  Patch,
+  Post,
+  Put,
+  RequestMethod,
+  Version,
+  VersioningType,
+} from '../../../common';
+import { MiddlewareConfigProxy } from '../../../common/interfaces';
+import { ApplicationConfig } from '../../application-config';
 import { NestContainer } from '../../injector/container';
 import { MiddlewareBuilder } from '../../middleware/builder';
+import { RouteInfoPathExtractor } from '../../middleware/route-info-path-extractor';
 import { RoutesMapper } from '../../middleware/routes-mapper';
 import { NoopHttpAdapter } from './../utils/noop-adapter.spec';
 
@@ -10,28 +25,38 @@ describe('MiddlewareBuilder', () => {
 
   beforeEach(() => {
     const container = new NestContainer();
+    const appConfig = new ApplicationConfig();
+    appConfig.enableVersioning({ type: VersioningType.URI });
     builder = new MiddlewareBuilder(
-      new RoutesMapper(container),
+      new RoutesMapper(container, appConfig),
       new NoopHttpAdapter({}),
+      new RouteInfoPathExtractor(appConfig),
     );
   });
   describe('apply', () => {
-    let configProxy;
-    beforeEach(() => {
-      configProxy = builder.apply([]);
-    });
     it('should return configuration proxy', () => {
+      const configProxy = builder.apply([]);
       const metatype = (MiddlewareBuilder as any).ConfigProxy;
       expect(configProxy instanceof metatype).to.be.true;
     });
+
     describe('configuration proxy', () => {
       describe('when "forRoutes()" called', () => {
+        let configProxy: MiddlewareConfigProxy;
+        beforeEach(() => {
+          configProxy = builder.apply([]);
+        });
         @Controller('path')
         class Test {
           @Get('route')
           public getAll() {}
+
+          @Version('1')
+          @Get('versioned')
+          public getAllVersioned() {}
         }
-        const route = { path: '/test', method: 0 };
+        const route = { path: '/test', method: RequestMethod.GET };
+
         it('should store configuration passed as argument', () => {
           configProxy.forRoutes(route, Test);
 
@@ -40,13 +65,118 @@ describe('MiddlewareBuilder', () => {
               middleware: [],
               forRoutes: [
                 {
-                  method: 0,
+                  method: RequestMethod.GET,
                   path: route.path,
                 },
                 {
-                  method: 0,
+                  method: RequestMethod.GET,
                   path: '/path/route',
                 },
+                {
+                  method: RequestMethod.GET,
+                  path: '/path/versioned',
+                  version: '1',
+                },
+              ],
+            },
+          ]);
+        });
+
+        @Controller('users')
+        class UsersController {
+          @Head('rsvp')
+          hRsvp() {}
+
+          @Options('rsvp')
+          oRsvp() {}
+
+          @Get('rsvp')
+          gRsvp() {}
+
+          @Post('rsvp')
+          pRsvp() {}
+
+          @Put('rsvp')
+          puRsvp() {}
+
+          @Patch('rsvp')
+          ptRsvp() {}
+
+          @Delete('rsvp')
+          dRsvp() {}
+
+          @Post()
+          create() {}
+
+          @Get()
+          findAll() {}
+
+          @Get(':id')
+          findOne() {}
+
+          @Patch(':id')
+          update() {}
+
+          @Delete(':id')
+          remove() {}
+        }
+
+        it('should remove overlapping routes', () => {
+          configProxy.forRoutes(UsersController);
+
+          expect(builder.build()).to.deep.equal([
+            {
+              middleware: [],
+              forRoutes: [
+                {
+                  method: RequestMethod.HEAD,
+                  path: '/users/rsvp',
+                },
+                {
+                  method: RequestMethod.OPTIONS,
+                  path: '/users/rsvp',
+                },
+                {
+                  method: RequestMethod.POST,
+                  path: '/users/rsvp',
+                },
+                {
+                  method: RequestMethod.PUT,
+                  path: '/users/rsvp',
+                },
+                {
+                  method: RequestMethod.POST,
+                  path: '/users/',
+                },
+                {
+                  method: RequestMethod.GET,
+                  path: '/users/',
+                },
+                {
+                  method: RequestMethod.GET,
+                  path: '/users/:id',
+                },
+                {
+                  method: RequestMethod.PATCH,
+                  path: '/users/:id',
+                },
+                {
+                  method: RequestMethod.DELETE,
+                  path: '/users/:id',
+                },
+                // Overlapping:
+                // {
+                //   method: RequestMethod.GET,
+                //   path: '/users/rsvp',
+                // },
+                // {
+                //   method: RequestMethod.PATCH,
+                //   path: '/users/rsvp',
+                // },
+                // {
+                //   method: RequestMethod.DELETE,
+                //   path: '/users/rsvp',
+                // },
               ],
             },
           ]);
diff --git a/packages/core/test/middleware/container.spec.ts b/packages/core/test/middleware/container.spec.ts
index dcdd2a8b7..1cf312ae0 100644
--- a/packages/core/test/middleware/container.spec.ts
+++ b/packages/core/test/middleware/container.spec.ts
@@ -47,7 +47,7 @@ describe('MiddlewareContainer', () => {
       },
     ];
     container.insertConfig(config, 'Module');
-    expect([...container.getConfigurations().get('Module')]).to.deep.equal(
+    expect([...container.getConfigurations().get('Module')!]).to.deep.equal(
       config,
     );
   });
@@ -68,7 +68,7 @@ describe('MiddlewareContainer', () => {
 
     expect(collection.size).to.eql(config.length);
     expect(insertedMiddleware).to.be.instanceOf(InstanceWrapper);
-    expect(insertedMiddleware.scope).to.be.undefined;
-    expect(insertedMiddleware.metatype).to.be.eql(TestMiddleware);
+    expect(insertedMiddleware!.scope).to.be.undefined;
+    expect(insertedMiddleware!.metatype).to.be.eql(TestMiddleware);
   });
 });
diff --git a/packages/core/test/middleware/middleware-module.spec.ts b/packages/core/test/middleware/middleware-module.spec.ts
index 0b8d44f44..0b0453a25 100644
--- a/packages/core/test/middleware/middleware-module.spec.ts
+++ b/packages/core/test/middleware/middleware-module.spec.ts
@@ -1,5 +1,8 @@
 import { Injectable } from '@nestjs/common';
+import { RouteInfoPathExtractor } from '@nestjs/core/middleware/route-info-path-extractor';
+import * as chai from 'chai';
 import { expect } from 'chai';
+import * as chaiAsPromised from 'chai-as-promised';
 import * as sinon from 'sinon';
 import { Controller } from '../../../common/decorators/core/controller.decorator';
 import { RequestMapping } from '../../../common/decorators/http/request-mapping.decorator';
@@ -11,14 +14,18 @@ import { RuntimeException } from '../../errors/exceptions/runtime.exception';
 import { NestContainer } from '../../injector/container';
 import { InstanceWrapper } from '../../injector/instance-wrapper';
 import { Module } from '../../injector/module';
+import { GraphInspector } from '../../inspector/graph-inspector';
 import { MiddlewareBuilder } from '../../middleware/builder';
 import { MiddlewareContainer } from '../../middleware/container';
 import { MiddlewareModule } from '../../middleware/middleware-module';
 import { RouterExceptionFilters } from '../../router/router-exception-filters';
 import { NoopHttpAdapter } from '../utils/noop-adapter.spec';
 
+chai.use(chaiAsPromised);
+
 describe('MiddlewareModule', () => {
   let middlewareModule: MiddlewareModule;
+  let graphInspector: GraphInspector;
 
   @Controller('test')
   class BasicController {}
@@ -38,15 +45,24 @@ describe('MiddlewareModule', () => {
   }
 
   beforeEach(() => {
+    const container = new NestContainer();
     const appConfig = new ApplicationConfig();
+    graphInspector = new GraphInspector(container);
     middlewareModule = new MiddlewareModule();
-    (middlewareModule as any).routerExceptionFilter =
-      new RouterExceptionFilters(
-        new NestContainer(),
-        appConfig,
-        new NoopHttpAdapter({}),
-      );
-    (middlewareModule as any).config = appConfig;
+    middlewareModule['routerExceptionFilter'] = new RouterExceptionFilters(
+      new NestContainer(),
+      appConfig,
+      new NoopHttpAdapter({}),
+    );
+    middlewareModule['routeInfoPathExtractor'] = new RouteInfoPathExtractor(
+      appConfig,
+    );
+    middlewareModule['routerExceptionFilter'] = new RouterExceptionFilters(
+      container,
+      appConfig,
+      new NoopHttpAdapter({}),
+    );
+    middlewareModule['graphInspector'] = graphInspector;
   });
 
   describe('loadConfiguration', () => {
@@ -75,7 +91,8 @@ describe('MiddlewareModule', () => {
         configureSpy.calledWith(
           new MiddlewareBuilder(
             (middlewareModule as any).routesMapper,
-            undefined,
+            undefined!,
+            new RouteInfoPathExtractor(new ApplicationConfig()),
           ),
         ),
       ).to.be.true;
@@ -194,5 +211,69 @@ describe('MiddlewareModule', () => {
       );
       expect(createMiddlewareFactoryStub.calledOnce).to.be.true;
     });
+
+    it('should insert the expected middleware definition', async () => {
+      const route = 'testPath';
+      const configuration = {
+        middleware: [TestMiddleware],
+        forRoutes: ['test', BasicController, BaseController],
+      };
+      const instance = new TestMiddleware();
+      const instanceWrapper = new InstanceWrapper({
+        metatype: TestMiddleware,
+        instance,
+        name: TestMiddleware.name,
+      });
+      const createMiddlewareFactoryStub = sinon
+        .stub()
+        .callsFake(() => () => null);
+      const app = {
+        createMiddlewareFactory: createMiddlewareFactoryStub,
+      };
+
+      const stubContainer = new NestContainer();
+      stubContainer
+        .getModules()
+        .set('Test', new Module(TestModule, stubContainer));
+      const container = new MiddlewareContainer(stubContainer);
+      const moduleKey = 'Test';
+      container.insertConfig([configuration], moduleKey);
+      container
+        .getMiddlewareCollection(moduleKey)
+        .set(TestMiddleware, instanceWrapper);
+      sinon
+        .stub(stubContainer, 'getModuleByKey')
+        .callsFake(() => new Module(class {}, stubContainer));
+      middlewareModule['container'] = stubContainer;
+
+      const insertEntrypointDefinitionSpy = sinon.spy(
+        graphInspector,
+        'insertEntrypointDefinition',
+      );
+
+      await middlewareModule.registerRouteMiddleware(
+        container,
+        { path: route, method: RequestMethod.ALL },
+        configuration,
+        moduleKey,
+        app,
+      );
+
+      expect(createMiddlewareFactoryStub.calledOnce).to.be.true;
+      expect(
+        insertEntrypointDefinitionSpy.calledWith({
+          type: 'middleware',
+          methodName: 'use',
+          className: instanceWrapper.name,
+          classNodeId: instanceWrapper.id,
+          metadata: {
+            key: route,
+            path: route,
+            requestMethod: 'ALL',
+            version: undefined,
+          } as any,
+        }),
+      ).to.be.true;
+    });
   });
 });
diff --git a/packages/core/test/middleware/resolver.spec.ts b/packages/core/test/middleware/resolver.spec.ts
index 870e1ecfc..3641da2d0 100644
--- a/packages/core/test/middleware/resolver.spec.ts
+++ b/packages/core/test/middleware/resolver.spec.ts
@@ -3,6 +3,7 @@ import * as sinon from 'sinon';
 import { Injectable } from '../../../common';
 import { NestMiddleware } from '../../../common/interfaces/middleware/nest-middleware.interface';
 import { NestContainer } from '../../injector';
+import { Injector } from '../../injector/injector';
 import { MiddlewareContainer } from '../../middleware/container';
 import { MiddlewareResolver } from '../../middleware/resolver';
 
@@ -17,16 +18,14 @@ describe('MiddlewareResolver', () => {
   let mockContainer: sinon.SinonMock;
 
   beforeEach(() => {
+    const injector = new Injector();
     container = new MiddlewareContainer(new NestContainer());
-    resolver = new MiddlewareResolver(container);
+    resolver = new MiddlewareResolver(container, injector);
     mockContainer = sinon.mock(container);
   });
 
-  it('should resolve middleware instances from container', () => {
-    const loadMiddleware = sinon.stub(
-      resolver['instanceLoader'],
-      'loadMiddleware',
-    );
+  it('should resolve middleware instances from container', async () => {
+    const loadMiddleware = sinon.stub(resolver['injector'], 'loadMiddleware');
     const middleware = new Map();
     const wrapper = {
       instance: { metatype: {} },
@@ -36,7 +35,7 @@ describe('MiddlewareResolver', () => {
 
     const module = { metatype: { name: '' } } as any;
     mockContainer.expects('getMiddlewareCollection').returns(middleware);
-    resolver.resolveInstances(module, null);
+    await resolver.resolveInstances(module, null!);
 
     expect(loadMiddleware.callCount).to.be.equal(middleware.size);
     expect(loadMiddleware.calledWith(wrapper as any, middleware, module)).to.be
diff --git a/packages/core/test/middleware/route-info-path-extractor.spec.ts b/packages/core/test/middleware/route-info-path-extractor.spec.ts
new file mode 100644
index 000000000..62bfb5fc8
--- /dev/null
+++ b/packages/core/test/middleware/route-info-path-extractor.spec.ts
@@ -0,0 +1,185 @@
+import { RequestMethod, VersioningType } from '@nestjs/common';
+import { ApplicationConfig } from '@nestjs/core';
+import { mapToExcludeRoute } from '@nestjs/core/middleware/utils';
+import { expect } from 'chai';
+import { RouteInfoPathExtractor } from './../../middleware/route-info-path-extractor';
+
+describe('RouteInfoPathExtractor', () => {
+  describe('extractPathsFrom', () => {
+    let appConfig: ApplicationConfig;
+    let routeInfoPathExtractor: RouteInfoPathExtractor;
+
+    beforeEach(() => {
+      appConfig = new ApplicationConfig();
+      appConfig.enableVersioning({
+        type: VersioningType.URI,
+      });
+      routeInfoPathExtractor = new RouteInfoPathExtractor(appConfig);
+    });
+
+    it(`should return correct paths`, () => {
+      expect(
+        routeInfoPathExtractor.extractPathsFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+        }),
+      ).to.eql(['/*']);
+
+      expect(
+        routeInfoPathExtractor.extractPathsFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+          version: '1',
+        }),
+      ).to.eql(['/v1$', '/v1/*']);
+    });
+
+    it(`should return correct paths when set global prefix`, () => {
+      Reflect.set(routeInfoPathExtractor, 'prefixPath', '/api');
+
+      expect(
+        routeInfoPathExtractor.extractPathsFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+        }),
+      ).to.eql(['/api$', '/api/*']);
+
+      expect(
+        routeInfoPathExtractor.extractPathsFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+          version: '1',
+        }),
+      ).to.eql(['/api/v1$', '/api/v1/*']);
+    });
+
+    it(`should return correct paths when set global prefix and global prefix options`, () => {
+      Reflect.set(routeInfoPathExtractor, 'prefixPath', '/api');
+      Reflect.set(
+        routeInfoPathExtractor,
+        'excludedGlobalPrefixRoutes',
+        mapToExcludeRoute(['foo']),
+      );
+
+      expect(
+        routeInfoPathExtractor.extractPathsFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+        }),
+      ).to.eql(['/api$', '/api/*', '/foo']);
+
+      expect(
+        routeInfoPathExtractor.extractPathsFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+          version: '1',
+        }),
+      ).to.eql(['/api/v1$', '/api/v1/*', '/v1/foo']);
+
+      expect(
+        routeInfoPathExtractor.extractPathsFrom({
+          path: 'foo',
+          method: RequestMethod.ALL,
+          version: '1',
+        }),
+      ).to.eql(['/v1/foo']);
+
+      expect(
+        routeInfoPathExtractor.extractPathsFrom({
+          path: 'bar',
+          method: RequestMethod.ALL,
+          version: '1',
+        }),
+      ).to.eql(['/api/v1/bar']);
+    });
+  });
+
+  describe('extractPathFrom', () => {
+    let appConfig: ApplicationConfig;
+    let routeInfoPathExtractor: RouteInfoPathExtractor;
+
+    beforeEach(() => {
+      appConfig = new ApplicationConfig();
+      appConfig.enableVersioning({
+        type: VersioningType.URI,
+      });
+      routeInfoPathExtractor = new RouteInfoPathExtractor(appConfig);
+    });
+
+    it(`should return correct path`, () => {
+      expect(
+        routeInfoPathExtractor.extractPathFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+        }),
+      ).to.eql(['/*']);
+
+      expect(
+        routeInfoPathExtractor.extractPathFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+          version: '1',
+        }),
+      ).to.eql(['/v1/*']);
+    });
+
+    it(`should return correct path when set global prefix`, () => {
+      Reflect.set(routeInfoPathExtractor, 'prefixPath', '/api');
+
+      expect(
+        routeInfoPathExtractor.extractPathFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+        }),
+      ).to.eql(['/*']);
+
+      expect(
+        routeInfoPathExtractor.extractPathFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+          version: '1',
+        }),
+      ).to.eql(['/api/v1/*']);
+    });
+
+    it(`should return correct path when set global prefix and global prefix options`, () => {
+      Reflect.set(routeInfoPathExtractor, 'prefixPath', '/api');
+      Reflect.set(
+        routeInfoPathExtractor,
+        'excludedGlobalPrefixRoutes',
+        mapToExcludeRoute(['foo']),
+      );
+
+      expect(
+        routeInfoPathExtractor.extractPathFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+        }),
+      ).to.eql(['/*']);
+
+      expect(
+        routeInfoPathExtractor.extractPathFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+          version: '1',
+        }),
+      ).to.eql(['/api/v1/*']);
+
+      expect(
+        routeInfoPathExtractor.extractPathFrom({
+          path: 'foo',
+          method: RequestMethod.ALL,
+          version: '1',
+        }),
+      ).to.eql(['/v1/foo']);
+
+      expect(
+        routeInfoPathExtractor.extractPathFrom({
+          path: 'bar',
+          method: RequestMethod.ALL,
+          version: '1',
+        }),
+      ).to.eql(['/api/v1/bar']);
+    });
+  });
+});
diff --git a/packages/core/test/middleware/routes-mapper.spec.ts b/packages/core/test/middleware/routes-mapper.spec.ts
index 7c1aabd51..e64a17d47 100644
--- a/packages/core/test/middleware/routes-mapper.spec.ts
+++ b/packages/core/test/middleware/routes-mapper.spec.ts
@@ -1,7 +1,13 @@
 import { expect } from 'chai';
+import { Version, VersioningType } from '../../../common';
 import { Controller } from '../../../common/decorators/core/controller.decorator';
-import { RequestMapping } from '../../../common/decorators/http/request-mapping.decorator';
+import {
+  Get,
+  RequestMapping,
+} from '../../../common/decorators/http/request-mapping.decorator';
 import { RequestMethod } from '../../../common/enums/request-method.enum';
+import { MiddlewareConfiguration } from '../../../common/interfaces';
+import { ApplicationConfig } from '../../application-config';
 import { NestContainer } from '../../injector/container';
 import { RoutesMapper } from '../../middleware/routes-mapper';
 
@@ -13,25 +19,41 @@ describe('RoutesMapper', () => {
 
     @RequestMapping({ path: 'another', method: RequestMethod.DELETE })
     public getAnother() {}
+
+    @Version('1')
+    @Get('versioned')
+    public getVersioned() {}
   }
 
   let mapper: RoutesMapper;
   beforeEach(() => {
-    mapper = new RoutesMapper(new NestContainer());
+    const appConfig = new ApplicationConfig();
+    appConfig.enableVersioning({ type: VersioningType.URI });
+    mapper = new RoutesMapper(new NestContainer(), appConfig);
   });
 
   it('should map @Controller() to "ControllerMetadata" in forRoutes', () => {
-    const config = {
+    const config: MiddlewareConfiguration = {
       middleware: 'Test',
-      forRoutes: [{ path: 'test', method: RequestMethod.GET }, TestRoute],
+      forRoutes: [
+        { path: 'test', method: RequestMethod.GET },
+        { path: 'versioned', version: '1', method: RequestMethod.GET },
+        TestRoute,
+      ],
     };
 
     expect(mapper.mapRouteToRouteInfo(config.forRoutes[0])).to.deep.equal([
       { path: '/test', method: RequestMethod.GET },
     ]);
+
     expect(mapper.mapRouteToRouteInfo(config.forRoutes[1])).to.deep.equal([
+      { path: '/versioned', version: '1', method: RequestMethod.GET },
+    ]);
+
+    expect(mapper.mapRouteToRouteInfo(config.forRoutes[2])).to.deep.equal([
       { path: '/test/test', method: RequestMethod.GET },
       { path: '/test/another', method: RequestMethod.DELETE },
+      { path: '/test/versioned', method: RequestMethod.GET, version: '1' },
     ]);
   });
   @Controller(['test', 'test2'])
@@ -62,4 +84,47 @@ describe('RoutesMapper', () => {
       { path: '/test2/another', method: RequestMethod.DELETE },
     ]);
   });
+
+  @Controller({
+    version: '1',
+    path: 'versioned',
+  })
+  class VersionedController {
+    @Get()
+    hello() {
+      return 'Hello from "VersionedController"!';
+    }
+
+    @Version('2')
+    @Get('/override')
+    override() {
+      return 'Hello from "VersionedController"!';
+    }
+  }
+
+  @Controller({
+    version: ['1', '2'],
+  })
+  class MultipleVersionController {
+    @Get('multiple')
+    multiple() {
+      return 'Multiple Versions 1 or 2';
+    }
+  }
+
+  it('should map a versioned controller to the corresponding route info objects (single version)', () => {
+    expect(mapper.mapRouteToRouteInfo(VersionedController)).to.deep.equal([
+      { path: '/versioned/', version: '1', method: RequestMethod.GET },
+      { path: '/versioned/override', version: '2', method: RequestMethod.GET },
+    ]);
+  });
+
+  it('should map a versioned controller to the corresponding route info objects (multiple versions)', () => {
+    expect(mapper.mapRouteToRouteInfo(MultipleVersionController)).to.deep.equal(
+      [
+        { path: '/multiple', version: '1', method: RequestMethod.GET },
+        { path: '/multiple', version: '2', method: RequestMethod.GET },
+      ],
+    );
+  });
 });
diff --git a/packages/core/test/middleware/utils.spec.ts b/packages/core/test/middleware/utils.spec.ts
index 754878c22..927d40d27 100644
--- a/packages/core/test/middleware/utils.spec.ts
+++ b/packages/core/test/middleware/utils.spec.ts
@@ -1,4 +1,5 @@
 import { RequestMethod, Type } from '@nestjs/common';
+import { addLeadingSlash } from '@nestjs/common/utils/shared.utils';
 import { expect } from 'chai';
 import * as sinon from 'sinon';
 import {
@@ -10,6 +11,7 @@ import {
   mapToExcludeRoute,
 } from '../../middleware/utils';
 import { NoopHttpAdapter } from '../utils/noop-adapter.spec';
+import * as pathToRegexp from 'path-to-regexp';
 
 describe('middleware utils', () => {
   const noopAdapter = new NoopHttpAdapter({});
@@ -17,6 +19,27 @@ describe('middleware utils', () => {
   class Test {}
   function fnMiddleware(req, res, next) {}
 
+  describe('mapToExcludeRoute', () => {
+    it('should return exclude route metadata', () => {
+      const stringRoute = 'foo';
+      const routeInfo = {
+        path: 'bar',
+        method: RequestMethod.GET,
+      };
+      expect(mapToExcludeRoute([stringRoute, routeInfo])).to.eql([
+        {
+          path: stringRoute,
+          requestMethod: RequestMethod.ALL,
+          pathRegex: pathToRegexp(addLeadingSlash(stringRoute)),
+        },
+        {
+          path: routeInfo.path,
+          requestMethod: routeInfo.method,
+          pathRegex: pathToRegexp(addLeadingSlash(routeInfo.path)),
+        },
+      ]);
+    });
+  });
   describe('filterMiddleware', () => {
     let middleware: any[];
     beforeEach(() => {
@@ -52,12 +75,12 @@ describe('middleware utils', () => {
         expect(metatype).to.not.eql(fnMiddleware);
       });
       it('should define a `use` method', () => {
-        const metatype = mapToClass(fnMiddleware, [], noopAdapter) as Type<any>;
+        const metatype = mapToClass(fnMiddleware, [], noopAdapter);
         expect(new metatype().use).to.exist;
       });
       it('should encapsulate a function', () => {
         const spy = sinon.spy();
-        const metatype = mapToClass(spy, [], noopAdapter) as Type<any>;
+        const metatype = mapToClass(spy, [], noopAdapter);
         new metatype().use();
         expect(spy.called).to.be.true;
       });
diff --git a/packages/core/test/nest-application-context.spec.ts b/packages/core/test/nest-application-context.spec.ts
new file mode 100644
index 000000000..4fd31794a
--- /dev/null
+++ b/packages/core/test/nest-application-context.spec.ts
@@ -0,0 +1,378 @@
+import { InjectionToken, Provider, Scope } from '@nestjs/common';
+import { expect } from 'chai';
+import * as sinon from 'sinon';
+import { setTimeout } from 'timers/promises';
+import { ContextIdFactory } from '../helpers/context-id-factory';
+import { NestContainer } from '../injector/container';
+import { Injector } from '../injector/injector';
+import { InstanceLoader } from '../injector/instance-loader';
+import { GraphInspector } from '../inspector/graph-inspector';
+import { NestApplicationContext } from '../nest-application-context';
+
+describe('NestApplicationContext', () => {
+  class A {}
+
+  async function testHelper(
+    injectionKey: InjectionToken,
+    scope: Scope,
+    additionalProviders: Array<Provider> = [],
+  ): Promise<NestApplicationContext> {
+    const nestContainer = new NestContainer();
+    const injector = new Injector();
+    const instanceLoader = new InstanceLoader(
+      nestContainer,
+      injector,
+      new GraphInspector(nestContainer),
+    );
+    const { moduleRef } = (await nestContainer.addModule(class T {}, []))!;
+
+    nestContainer.addProvider(
+      {
+        provide: injectionKey,
+        useClass: A,
+        scope,
+      },
+      moduleRef.token,
+    );
+
+    for (const provider of additionalProviders) {
+      nestContainer.addProvider(provider, moduleRef.token);
+    }
+
+    nestContainer.addInjectable(
+      {
+        provide: injectionKey,
+        useClass: A,
+        scope,
+      },
+      moduleRef.token,
+      'interceptor',
+    );
+
+    const modules = nestContainer.getModules();
+    await instanceLoader.createInstancesOfDependencies(modules);
+
+    const applicationContext = new NestApplicationContext(nestContainer);
+    return applicationContext;
+  }
+
+  describe('listenToShutdownSignals', () => {
+    it('shutdown process should not be interrupted by another handler', async () => {
+      const signal = 'SIGTERM';
+      let processUp = true;
+      let promisesResolved = false;
+      const applicationContext = await testHelper(A, Scope.DEFAULT);
+      applicationContext.enableShutdownHooks([signal]);
+
+      const waitProcessDown = new Promise(resolve => {
+        const shutdownCleanupRef = applicationContext['shutdownCleanupRef'];
+        const handler = () => {
+          if (
+            !process
+              .listeners(signal)
+              .find(handler => handler == shutdownCleanupRef)
+          ) {
+            processUp = false;
+            process.removeListener(signal, handler);
+            resolve(undefined);
+          }
+          return undefined;
+        };
+        process.on(signal, handler);
+      });
+
+      // add some third party handler
+      process.on(signal, signal => {
+        // do some work
+        process.kill(process.pid, signal);
+      });
+
+      const hookStub = sinon
+        .stub(applicationContext as any, 'callShutdownHook')
+        .callsFake(async () => {
+          // run some async code
+          await new Promise(resolve => setImmediate(() => resolve(undefined)));
+          if (processUp) {
+            promisesResolved = true;
+          }
+        });
+      process.kill(process.pid, signal);
+      await waitProcessDown;
+      hookStub.restore();
+      expect(processUp).to.be.false;
+      expect(promisesResolved).to.be.true;
+    });
+
+    it('should defer shutdown until all init hooks are resolved', async () => {
+      const clock = sinon.useFakeTimers({
+        toFake: ['setTimeout'],
+      });
+      const signal = 'SIGTERM';
+
+      const onModuleInitStub = sinon.stub();
+      const onApplicationShutdownStub = sinon.stub();
+
+      class B {
+        async onModuleInit() {
+          await setTimeout(5000);
+          onModuleInitStub();
+        }
+
+        async onApplicationShutdown() {
+          await setTimeout(1000);
+          onApplicationShutdownStub();
+        }
+      }
+
+      const applicationContext = await testHelper(A, Scope.DEFAULT, [
+        { provide: B, useClass: B, scope: Scope.DEFAULT },
+      ]);
+      applicationContext.enableShutdownHooks([signal]);
+
+      const ignoreProcessSignal = () => {
+        // noop to prevent process from exiting
+      };
+      process.on(signal, ignoreProcessSignal);
+
+      const deferredShutdown = async () => {
+        await setTimeout(1);
+        process.kill(process.pid, signal);
+      };
+      void Promise.all([applicationContext.init(), deferredShutdown()]);
+
+      await clock.nextAsync();
+      expect(onModuleInitStub.called).to.be.false;
+      expect(onApplicationShutdownStub.called).to.be.false;
+
+      await clock.nextAsync();
+      expect(onModuleInitStub.called).to.be.true;
+      expect(onApplicationShutdownStub.called).to.be.false;
+
+      await clock.nextAsync();
+      expect(onModuleInitStub.called).to.be.true;
+      expect(onApplicationShutdownStub.called).to.be.true;
+
+      clock.restore();
+    });
+  });
+
+  describe('get', () => {
+    describe('when scope = DEFAULT', () => {
+      it('should get value with function injection key', async () => {
+        const key = A;
+        const applicationContext = await testHelper(key, Scope.DEFAULT);
+
+        const a1: A = await applicationContext.get(key);
+        const a2: A = await applicationContext.get(key);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).equal(a2);
+      });
+
+      it('should get value with string injection key', async () => {
+        const key = 'KEY_A';
+        const applicationContext = await testHelper(key, Scope.DEFAULT);
+
+        const a1: A = await applicationContext.get(key);
+        const a2: A = await applicationContext.get(key);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).equal(a2);
+      });
+
+      it('should get value with symbol injection key', async () => {
+        const key = Symbol('KEY_A');
+        const applicationContext = await testHelper(key, Scope.DEFAULT);
+
+        const a1: A = await applicationContext.get(key);
+        const a2: A = await applicationContext.get(key);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).equal(a2);
+      });
+    });
+
+    describe('when scope = REQUEST', () => {
+      it('should throw error when use function injection key', async () => {
+        const key = A;
+        const applicationContext = await testHelper(key, Scope.REQUEST);
+
+        expect(() => applicationContext.get(key)).to.be.throw;
+      });
+
+      it('should throw error when use string injection key', async () => {
+        const key = 'KEY_A';
+        const applicationContext = await testHelper(key, Scope.REQUEST);
+
+        expect(() => applicationContext.get(key)).to.be.throw;
+      });
+
+      it('should throw error when use symbol injection key', async () => {
+        const key = Symbol('KEY_A');
+        const applicationContext = await testHelper(key, Scope.REQUEST);
+
+        expect(() => applicationContext.get(key)).to.be.throw;
+      });
+    });
+
+    describe('when scope = TRANSIENT', () => {
+      it('should throw error when use function injection key', async () => {
+        const key = A;
+        const applicationContext = await testHelper(key, Scope.TRANSIENT);
+
+        expect(() => applicationContext.get(key)).to.be.throw;
+      });
+
+      it('should throw error when use string injection key', async () => {
+        const key = 'KEY_A';
+        const applicationContext = await testHelper(key, Scope.TRANSIENT);
+
+        expect(() => applicationContext.get(key)).to.be.throw;
+      });
+
+      it('should throw error when use symbol injection key', async () => {
+        const key = Symbol('KEY_A');
+        const applicationContext = await testHelper(key, Scope.TRANSIENT);
+
+        expect(() => applicationContext.get(key)).to.be.throw;
+      });
+    });
+  });
+
+  describe('resolve', () => {
+    describe('when scope = DEFAULT', () => {
+      it('should resolve value with function injection key', async () => {
+        const key = A;
+        const applicationContext = await testHelper(key, Scope.DEFAULT);
+
+        const a1: A = await applicationContext.resolve(key);
+        const a2: A = await applicationContext.resolve(key);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).equal(a2);
+      });
+
+      it('should resolve value with string injection key', async () => {
+        const key = 'KEY_A';
+        const applicationContext = await testHelper(key, Scope.DEFAULT);
+
+        const a1: A = await applicationContext.resolve(key);
+        const a2: A = await applicationContext.resolve(key);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).equal(a2);
+      });
+
+      it('should resolve value with symbol injection key', async () => {
+        const key = Symbol('KEY_A');
+        const applicationContext = await testHelper(key, Scope.DEFAULT);
+
+        const a1: A = await applicationContext.resolve(key);
+        const a2: A = await applicationContext.resolve(key);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).equal(a2);
+      });
+    });
+
+    describe('when scope = REQUEST', () => {
+      it('should resolve value with function injection key', async () => {
+        const key = A;
+        const applicationContext = await testHelper(key, Scope.REQUEST);
+
+        const contextId = ContextIdFactory.create();
+        const a1: A = await applicationContext.resolve(key);
+        const a2: A = await applicationContext.resolve(key, contextId);
+        const a3: A = await applicationContext.resolve(key, contextId);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).not.equal(a2);
+        expect(a2).equal(a3);
+      });
+
+      it('should resolve value with string injection key', async () => {
+        const key = 'KEY_A';
+        const applicationContext = await testHelper(key, Scope.REQUEST);
+
+        const contextId = ContextIdFactory.create();
+        const a1: A = await applicationContext.resolve(key);
+        const a2: A = await applicationContext.resolve(key, contextId);
+        const a3: A = await applicationContext.resolve(key, contextId);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).not.equal(a2);
+        expect(a2).equal(a3);
+      });
+
+      it('should resolve value with symbol injection key', async () => {
+        const key = Symbol('KEY_A');
+        const applicationContext = await testHelper(key, Scope.REQUEST);
+
+        const contextId = ContextIdFactory.create();
+        const a1: A = await applicationContext.resolve(key);
+        const a2: A = await applicationContext.resolve(key, contextId);
+        const a3: A = await applicationContext.resolve(key, contextId);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).not.equal(a2);
+        expect(a2).equal(a3);
+      });
+    });
+
+    describe('when scope = TRANSIENT', () => {
+      it('should resolve value with function injection key', async () => {
+        const key = A;
+        const applicationContext = await testHelper(key, Scope.TRANSIENT);
+
+        const contextId = ContextIdFactory.create();
+        const a1: A = await applicationContext.resolve(key);
+        const a2: A = await applicationContext.resolve(key, contextId);
+        const a3: A = await applicationContext.resolve(key, contextId);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).not.equal(a2);
+        expect(a2).equal(a3);
+      });
+
+      it('should resolve value with string injection key', async () => {
+        const key = 'KEY_A';
+        const applicationContext = await testHelper(key, Scope.TRANSIENT);
+
+        const contextId = ContextIdFactory.create();
+        const a1: A = await applicationContext.resolve(key);
+        const a2: A = await applicationContext.resolve(key, contextId);
+        const a3: A = await applicationContext.resolve(key, contextId);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).not.equal(a2);
+        expect(a2).equal(a3);
+      });
+
+      it('should resolve value with symbol injection key', async () => {
+        const key = Symbol('KEY_A');
+        const applicationContext = await testHelper(key, Scope.TRANSIENT);
+
+        const contextId = ContextIdFactory.create();
+        const a1: A = await applicationContext.resolve(key);
+        const a2: A = await applicationContext.resolve(key, contextId);
+        const a3: A = await applicationContext.resolve(key, contextId);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).not.equal(a2);
+        expect(a2).equal(a3);
+      });
+    });
+  });
+});
diff --git a/packages/core/test/nest-application.spec.ts b/packages/core/test/nest-application.spec.ts
index 19f9825b3..fefd38d5f 100644
--- a/packages/core/test/nest-application.spec.ts
+++ b/packages/core/test/nest-application.spec.ts
@@ -1,8 +1,13 @@
+import { RequestMethod } from '@nestjs/common';
 import { expect } from 'chai';
 import { ApplicationConfig } from '../application-config';
 import { NestContainer } from '../injector/container';
+import { GraphInspector } from '../inspector/graph-inspector';
 import { NestApplication } from '../nest-application';
+import { mapToExcludeRoute } from './../middleware/utils';
 import { NoopHttpAdapter } from './utils/noop-adapter.spec';
+import { MicroserviceOptions } from '@nestjs/microservices';
+import * as sinon from 'sinon';
 
 describe('NestApplication', () => {
   describe('Hybrid Application', () => {
@@ -18,10 +23,13 @@ describe('NestApplication', () => {
         container,
         new NoopHttpAdapter({}),
         applicationConfig,
+        new GraphInspector(container),
         {},
       );
       instance.useGlobalInterceptors(new Interceptor());
-      const microservice = instance.connectMicroservice({});
+      const microservice = instance.connectMicroservice<MicroserviceOptions>(
+        {},
+      );
       expect((instance as any).config.getGlobalInterceptors().length).to.equal(
         1,
       );
@@ -36,10 +44,11 @@ describe('NestApplication', () => {
         container,
         new NoopHttpAdapter({}),
         applicationConfig,
+        new GraphInspector(container),
         {},
       );
       instance.useGlobalInterceptors(new Interceptor());
-      const microservice = instance.connectMicroservice(
+      const microservice = instance.connectMicroservice<MicroserviceOptions>(
         {},
         { inheritAppConfig: true },
       );
@@ -51,4 +60,48 @@ describe('NestApplication', () => {
       ).to.equal(1);
     });
   });
+  describe('Global Prefix', () => {
+    it('should get correct global prefix options', () => {
+      const applicationConfig = new ApplicationConfig();
+      const container = new NestContainer(applicationConfig);
+      const instance = new NestApplication(
+        container,
+        new NoopHttpAdapter({}),
+        applicationConfig,
+        new GraphInspector(container),
+        {},
+      );
+      const excludeRoute = ['foo', { path: 'bar', method: RequestMethod.GET }];
+      instance.setGlobalPrefix('api', {
+        exclude: excludeRoute,
+      });
+      expect(applicationConfig.getGlobalPrefixOptions()).to.eql({
+        exclude: mapToExcludeRoute(excludeRoute),
+      });
+    });
+  });
+  describe('Double initialization', () => {
+    it('should initialize application only once', async () => {
+      const noopHttpAdapter = new NoopHttpAdapter({});
+      const httpAdapterSpy = sinon.spy(noopHttpAdapter);
+
+      const applicationConfig = new ApplicationConfig();
+
+      const container = new NestContainer(applicationConfig);
+      container.setHttpAdapter(noopHttpAdapter);
+
+      const instance = new NestApplication(
+        container,
+        noopHttpAdapter,
+        applicationConfig,
+        new GraphInspector(container),
+        {},
+      );
+
+      await instance.init();
+      await instance.init();
+
+      expect(httpAdapterSpy.init.calledOnce).to.be.true;
+    });
+  });
 });
diff --git a/packages/core/test/pipes/params-token-factory.spec.ts b/packages/core/test/pipes/params-token-factory.spec.ts
index 752f118de..6bc83aadd 100644
--- a/packages/core/test/pipes/params-token-factory.spec.ts
+++ b/packages/core/test/pipes/params-token-factory.spec.ts
@@ -32,7 +32,7 @@ describe('ParamsTokenFactory', () => {
       });
       describe('not available', () => {
         it('should return "custom"', () => {
-          expect(factory.exchangeEnumForString(-1)).to.be.eql('custom');
+          expect(factory.exchangeEnumForString(-1 as any)).to.be.eql('custom');
         });
       });
     });
diff --git a/packages/core/test/pipes/pipes-consumer.spec.ts b/packages/core/test/pipes/pipes-consumer.spec.ts
index d6bf927a9..08771997c 100644
--- a/packages/core/test/pipes/pipes-consumer.spec.ts
+++ b/packages/core/test/pipes/pipes-consumer.spec.ts
@@ -24,6 +24,7 @@ describe('PipesConsumer', () => {
       ];
     });
     it('should call all transform functions', done => {
+      /* eslint-disable-next-line @typescript-eslint/no-floating-promises */
       consumer.apply(value, { metatype, type, data }, transforms).then(() => {
         expect(
           transforms.reduce(
@@ -31,11 +32,13 @@ describe('PipesConsumer', () => {
             true,
           ),
         ).to.be.true;
+
         done();
       });
     });
     it('should return expected result', done => {
       const expectedResult = 3;
+      /* eslint-disable-next-line @typescript-eslint/no-floating-promises */
       consumer
         .apply(value, { metatype, type, data }, transforms)
         .then(result => {
diff --git a/packages/core/test/pipes/pipes-context-creator.spec.ts b/packages/core/test/pipes/pipes-context-creator.spec.ts
index 21b2348c6..63b7cc0c4 100644
--- a/packages/core/test/pipes/pipes-context-creator.spec.ts
+++ b/packages/core/test/pipes/pipes-context-creator.spec.ts
@@ -20,7 +20,7 @@ describe('PipesContextCreator', () => {
   describe('createConcreteContext', () => {
     describe('when metadata is empty or undefined', () => {
       it('should return empty array', () => {
-        expect(creator.createConcreteContext(undefined)).to.be.deep.equal([]);
+        expect(creator.createConcreteContext(undefined!)).to.be.deep.equal([]);
         expect(creator.createConcreteContext([])).to.be.deep.equal([]);
       });
     });
@@ -49,7 +49,7 @@ describe('PipesContextCreator', () => {
         expect(creator.getPipeInstance(Pipe)).to.be.eql(wrapper.instance);
       });
       it('should return null', () => {
-        sinon.stub(creator, 'getInstanceByMetatype').callsFake(() => null);
+        sinon.stub(creator, 'getInstanceByMetatype').callsFake(() => null!);
         expect(creator.getPipeInstance(Pipe)).to.be.eql(null);
       });
     });
@@ -59,7 +59,7 @@ describe('PipesContextCreator', () => {
     describe('when "moduleContext" is nil', () => {
       it('should return undefined', () => {
         (creator as any).moduleContext = undefined;
-        expect(creator.getInstanceByMetatype(null)).to.be.undefined;
+        expect(creator.getInstanceByMetatype(null!)).to.be.undefined;
       });
     });
     describe('when "moduleContext" is not nil', () => {
@@ -70,7 +70,7 @@ describe('PipesContextCreator', () => {
       describe('and when module exists', () => {
         it('should return undefined', () => {
           sinon.stub(container.getModules(), 'get').callsFake(() => undefined);
-          expect(creator.getInstanceByMetatype(null)).to.be.undefined;
+          expect(creator.getInstanceByMetatype(null!)).to.be.undefined;
         });
       });
 
@@ -111,7 +111,7 @@ describe('PipesContextCreator', () => {
           .callsFake(() => scopedPipeWrappers);
         sinon
           .stub(instanceWrapper, 'getInstanceByContextId')
-          .callsFake(() => ({ instance } as any));
+          .callsFake(() => ({ instance }) as any);
 
         expect(creator.getGlobalMetadata({ id: 3 })).to.contains(
           instance,
diff --git a/packages/core/test/repl/assign-to-object.util.spec.ts b/packages/core/test/repl/assign-to-object.util.spec.ts
new file mode 100644
index 000000000..0a7a58bf5
--- /dev/null
+++ b/packages/core/test/repl/assign-to-object.util.spec.ts
@@ -0,0 +1,36 @@
+import { expect } from 'chai';
+import { assignToObject } from '../../repl/assign-to-object.util';
+
+describe('assignToObject', () => {
+  it('should copy all enumerable properties and their descriptors', () => {
+    const sourceObj = {};
+    Object.defineProperty(sourceObj, 'foo', {
+      value: 123,
+      configurable: true,
+      enumerable: true,
+      writable: true,
+    });
+    Object.defineProperty(sourceObj, 'bar', {
+      value: 456,
+      configurable: true,
+      enumerable: true,
+      writable: false,
+    });
+    const targetObj = {};
+
+    assignToObject(targetObj, sourceObj);
+
+    expect(Object.getOwnPropertyDescriptor(targetObj, 'foo')).to.be.eql({
+      value: 123,
+      configurable: true,
+      enumerable: true,
+      writable: true,
+    });
+    expect(Object.getOwnPropertyDescriptor(targetObj, 'bar')).to.be.eql({
+      value: 456,
+      configurable: true,
+      enumerable: true,
+      writable: false,
+    });
+  });
+});
diff --git a/packages/core/test/repl/native-functions/debug-repl-fn.spec.ts b/packages/core/test/repl/native-functions/debug-repl-fn.spec.ts
new file mode 100644
index 000000000..cfda9b51a
--- /dev/null
+++ b/packages/core/test/repl/native-functions/debug-repl-fn.spec.ts
@@ -0,0 +1,141 @@
+import { clc } from '@nestjs/common/utils/cli-colors.util';
+import { expect } from 'chai';
+import * as sinon from 'sinon';
+import { NestContainer } from '../../../injector/container';
+import { DebugReplFn } from '../../../repl/native-functions';
+import { ReplContext } from '../../../repl/repl-context';
+
+describe('DebugReplFn', () => {
+  let debugReplFn: DebugReplFn;
+
+  let replContext: ReplContext;
+  let mockApp: {
+    container: NestContainer;
+    get: sinon.SinonStub;
+    resolve: sinon.SinonSpy;
+    select: sinon.SinonSpy;
+  };
+
+  before(async () => {
+    const container = new NestContainer();
+    const { moduleRef: aModuleRef } = (await container.addModule(
+      class ModuleA {},
+      [],
+    ))!;
+    const { moduleRef: bModuleRef } = (await container.addModule(
+      class ModuleB {},
+      [],
+    ))!;
+
+    container.addController(class ControllerA {}, aModuleRef.token);
+    container.addProvider(class ProviderA1 {}, aModuleRef.token);
+    container.addProvider(class ProviderA2 {}, aModuleRef.token);
+    container.addProvider(class SharedProvider {}, aModuleRef.token);
+    container.addProvider(
+      { provide: 'StringToken', useValue: 123 },
+      aModuleRef.token,
+    );
+
+    container.addProvider(class ProviderB1 {}, bModuleRef.token);
+    container.addProvider(class ProviderB2 {}, bModuleRef.token);
+    container.addProvider(class SharedProvider {}, bModuleRef.token);
+
+    mockApp = {
+      container,
+      get: sinon.stub(),
+      resolve: sinon.spy(),
+      select: sinon.spy(),
+    };
+    replContext = new ReplContext(mockApp as any);
+  });
+
+  beforeEach(() => {
+    debugReplFn = replContext.nativeFunctions.get('debug') as DebugReplFn;
+
+    // To avoid coloring the output:
+    sinon.stub(clc, 'yellow').callsFake(text => text);
+    sinon.stub(clc, 'green').callsFake(text => text);
+  });
+  afterEach(() => sinon.restore());
+
+  it('the function name should be "debug"', () => {
+    expect(debugReplFn).to.not.be.undefined;
+    expect(debugReplFn.fnDefinition.name).to.eql('debug');
+  });
+
+  describe('action', () => {
+    it('should print all modules along with their controllers and providers', () => {
+      let outputText = '';
+
+      sinon
+        .stub(replContext, 'writeToStdout')
+        .callsFake(text => (outputText += text));
+
+      debugReplFn.action();
+
+      expect(outputText).to.equal(`
+ModuleA:
+ - controllers:
+  ‚óª ControllerA
+ - providers:
+  ‚óª ProviderA1
+  ‚óª ProviderA2
+  ‚óª SharedProvider
+  ‚óª "StringToken"
+ModuleB:
+ - providers:
+  ‚óª ProviderB1
+  ‚óª ProviderB2
+  ‚óª SharedProvider
+
+`);
+    });
+
+    describe('when module passed as a class reference', () => {
+      it("should print a specified module's controllers and providers", () => {
+        let outputText = '';
+
+        sinon
+          .stub(replContext, 'writeToStdout')
+          .callsFake(text => (outputText += text));
+
+        debugReplFn.action(class ModuleA {});
+
+        expect(outputText).to.equal(`
+ModuleA:
+ - controllers:
+  ‚óª ControllerA
+ - providers:
+  ‚óª ProviderA1
+  ‚óª ProviderA2
+  ‚óª SharedProvider
+  ‚óª "StringToken"
+
+`);
+      });
+    });
+    describe("when module passed as a string (module's key)", () => {
+      it("should print a specified module's controllers and providers", () => {
+        let outputText = '';
+
+        sinon
+          .stub(replContext, 'writeToStdout')
+          .callsFake(text => (outputText += text));
+
+        debugReplFn.action('ModuleA');
+
+        expect(outputText).to.equal(`
+ModuleA:
+ - controllers:
+  ‚óª ControllerA
+ - providers:
+  ‚óª ProviderA1
+  ‚óª ProviderA2
+  ‚óª SharedProvider
+  ‚óª "StringToken"
+
+`);
+      });
+    });
+  });
+});
diff --git a/packages/core/test/repl/native-functions/get-repl-fn.spec.ts b/packages/core/test/repl/native-functions/get-repl-fn.spec.ts
new file mode 100644
index 000000000..aec8f335f
--- /dev/null
+++ b/packages/core/test/repl/native-functions/get-repl-fn.spec.ts
@@ -0,0 +1,47 @@
+import { expect } from 'chai';
+import * as sinon from 'sinon';
+import { GetReplFn } from '../../../repl/native-functions';
+import { ReplContext } from '../../../repl/repl-context';
+import { NestContainer } from '../../../injector/container';
+
+describe('GetReplFn', () => {
+  let getReplFn: GetReplFn;
+
+  let replContext: ReplContext;
+  let mockApp: {
+    container: NestContainer;
+    get: sinon.SinonStub;
+    resolve: sinon.SinonSpy;
+    select: sinon.SinonSpy;
+  };
+
+  before(async () => {
+    const container = new NestContainer();
+
+    mockApp = {
+      container,
+      get: sinon.stub(),
+      resolve: sinon.spy(),
+      select: sinon.spy(),
+    };
+    replContext = new ReplContext(mockApp as any);
+  });
+
+  beforeEach(() => {
+    getReplFn = replContext.nativeFunctions.get('get') as GetReplFn;
+  });
+  afterEach(() => sinon.restore());
+
+  it('the function name should be "get"', () => {
+    expect(getReplFn).to.not.be.undefined;
+    expect(getReplFn.fnDefinition.name).to.eql('get');
+  });
+
+  describe('action', () => {
+    it('should pass arguments down to the application context', () => {
+      const token = 'test';
+      getReplFn.action(token);
+      expect(mockApp.get.calledWith(token)).to.be.true;
+    });
+  });
+});
diff --git a/packages/core/test/repl/native-functions/help-repl-fn.spec.ts b/packages/core/test/repl/native-functions/help-repl-fn.spec.ts
new file mode 100644
index 000000000..09f041153
--- /dev/null
+++ b/packages/core/test/repl/native-functions/help-repl-fn.spec.ts
@@ -0,0 +1,68 @@
+import { expect } from 'chai';
+import * as sinon from 'sinon';
+import { clc } from '@nestjs/common/utils/cli-colors.util';
+import { HelpReplFn } from '../../../repl/native-functions';
+import { ReplContext } from '../../../repl/repl-context';
+import { NestContainer } from '../../../injector/container';
+
+describe('HelpReplFn', () => {
+  let helpReplFn: HelpReplFn;
+
+  let replContext: ReplContext;
+  let mockApp: {
+    container: NestContainer;
+    get: sinon.SinonStub;
+    resolve: sinon.SinonSpy;
+    select: sinon.SinonSpy;
+  };
+
+  before(async () => {
+    const container = new NestContainer();
+
+    mockApp = {
+      container,
+      get: sinon.stub(),
+      resolve: sinon.spy(),
+      select: sinon.spy(),
+    };
+    replContext = new ReplContext(mockApp as any);
+  });
+
+  beforeEach(() => {
+    helpReplFn = replContext.nativeFunctions.get('help') as HelpReplFn;
+
+    // To avoid coloring the output:
+    sinon.stub(clc, 'bold').callsFake(text => text);
+    sinon.stub(clc, 'cyanBright').callsFake(text => text);
+  });
+  afterEach(() => sinon.restore());
+
+  it('the function name should be "help"', () => {
+    expect(helpReplFn).to.not.be.undefined;
+    expect(helpReplFn.fnDefinition.name).to.eql('help');
+  });
+
+  describe('action', () => {
+    it('should print all available native functions and their description', () => {
+      let outputText = '';
+      sinon
+        .stub(replContext, 'writeToStdout')
+        .callsFake(text => (outputText += text));
+
+      helpReplFn.action();
+
+      expect(outputText).to
+        .equal(`You can call .help on any function listed below (e.g.: help.help):
+
+$ - Retrieves an instance of either injectable or controller, otherwise, throws exception.
+debug - Print all registered modules as a list together with their controllers and providers.
+If the argument is passed in, for example, "debug(MyModule)" then it will only print components of this specific module.
+get - Retrieves an instance of either injectable or controller, otherwise, throws exception.
+help - Display all available REPL native functions.
+methods - Display all public methods available on a given provider or controller.
+resolve - Resolves transient or request-scoped instance of either injectable or controller, otherwise, throws exception.
+select - Allows navigating through the modules tree, for example, to pull out a specific instance from the selected module.
+`);
+    });
+  });
+});
diff --git a/packages/core/test/repl/native-functions/methods-repl-fn.spec.ts b/packages/core/test/repl/native-functions/methods-repl-fn.spec.ts
new file mode 100644
index 000000000..6cf7c60e3
--- /dev/null
+++ b/packages/core/test/repl/native-functions/methods-repl-fn.spec.ts
@@ -0,0 +1,114 @@
+import { clc } from '@nestjs/common/utils/cli-colors.util';
+import { expect } from 'chai';
+import * as sinon from 'sinon';
+import { NestContainer } from '../../../injector/container';
+import { MethodsReplFn } from '../../../repl/native-functions';
+import { ReplContext } from '../../../repl/repl-context';
+
+describe('MethodsReplFn', () => {
+  let methodsReplFn: MethodsReplFn;
+
+  let replContext: ReplContext;
+  let mockApp: {
+    container: NestContainer;
+    get: sinon.SinonStub;
+    resolve: sinon.SinonSpy;
+    select: sinon.SinonSpy;
+  };
+
+  before(async () => {
+    const container = new NestContainer();
+    const { moduleRef: aModuleRef } = (await container.addModule(
+      class ModuleA {},
+      [],
+    ))!;
+    const { moduleRef: bModuleRef } = (await container.addModule(
+      class ModuleB {},
+      [],
+    ))!;
+
+    container.addController(class ControllerA {}, aModuleRef.token);
+    container.addProvider(class ProviderA1 {}, aModuleRef.token);
+    container.addProvider(class ProviderA2 {}, aModuleRef.token);
+
+    container.addProvider(class ProviderB1 {}, bModuleRef.token);
+    container.addProvider(class ProviderB2 {}, bModuleRef.token);
+
+    mockApp = {
+      container,
+      get: sinon.stub(),
+      resolve: sinon.spy(),
+      select: sinon.spy(),
+    };
+    replContext = new ReplContext(mockApp as any);
+  });
+
+  beforeEach(() => {
+    methodsReplFn = replContext.nativeFunctions.get('methods') as MethodsReplFn;
+
+    // To avoid coloring the output:
+    sinon.stub(clc, 'yellow').callsFake(text => text);
+    sinon.stub(clc, 'green').callsFake(text => text);
+  });
+  afterEach(() => sinon.restore());
+
+  it('the function name should be "methods"', () => {
+    expect(methodsReplFn).to.not.be.undefined;
+    expect(methodsReplFn.fnDefinition.name).to.eql('methods');
+  });
+
+  describe('action', () => {
+    describe('when token is a class reference', () => {
+      it('should print all class methods', () => {
+        class BaseService {
+          create() {}
+        }
+        class TestService extends BaseService {
+          findAll() {}
+          findOne() {}
+        }
+
+        let outputText = '';
+
+        sinon
+          .stub(replContext, 'writeToStdout')
+          .callsFake(text => (outputText += text));
+
+        methodsReplFn.action(TestService);
+
+        expect(outputText).to.equal(`
+Methods:
+ ‚óª findAll
+ ‚óª findOne
+ ‚óª create
+
+`);
+      });
+    });
+
+    describe('when token is a string', () => {
+      it('should grab provider from the container and print its all methods', () => {
+        class ProviderA1 {
+          findAll() {}
+          findOne() {}
+        }
+        let outputText = '';
+
+        sinon
+          .stub(replContext, 'writeToStdout')
+          .callsFake(text => (outputText += text));
+
+        mockApp.get.callsFake(() => new ProviderA1());
+
+        methodsReplFn.action('ProviderA1');
+
+        expect(outputText).to.equal(`
+Methods:
+ ‚óª findAll
+ ‚óª findOne
+
+`);
+      });
+    });
+  });
+});
diff --git a/packages/core/test/repl/native-functions/resolve-repl-fn.spec.ts b/packages/core/test/repl/native-functions/resolve-repl-fn.spec.ts
new file mode 100644
index 000000000..cf78bbd40
--- /dev/null
+++ b/packages/core/test/repl/native-functions/resolve-repl-fn.spec.ts
@@ -0,0 +1,49 @@
+import { expect } from 'chai';
+import * as sinon from 'sinon';
+import { ResolveReplFn } from '../../../repl/native-functions';
+import { ReplContext } from '../../../repl/repl-context';
+import { NestContainer } from '../../../injector/container';
+
+describe('ResolveReplFn', () => {
+  let resolveReplFn: ResolveReplFn;
+
+  let replContext: ReplContext;
+  let mockApp: {
+    container: NestContainer;
+    get: sinon.SinonStub;
+    resolve: sinon.SinonSpy;
+    select: sinon.SinonSpy;
+  };
+
+  before(async () => {
+    const container = new NestContainer();
+
+    mockApp = {
+      container,
+      get: sinon.stub(),
+      resolve: sinon.spy(),
+      select: sinon.spy(),
+    };
+    replContext = new ReplContext(mockApp as any);
+  });
+
+  beforeEach(() => {
+    resolveReplFn = replContext.nativeFunctions.get('resolve') as ResolveReplFn;
+  });
+  afterEach(() => sinon.restore());
+
+  it('the function name should be "resolve"', () => {
+    expect(resolveReplFn).to.not.be.undefined;
+    expect(resolveReplFn.fnDefinition.name).to.eql('resolve');
+  });
+
+  describe('action', () => {
+    it('should pass arguments down to the application context', async () => {
+      const token = 'test';
+      const contextId = {};
+
+      await resolveReplFn.action(token, contextId);
+      expect(mockApp.resolve.calledWith(token, contextId)).to.be.true;
+    });
+  });
+});
diff --git a/packages/core/test/repl/native-functions/select-repl-fn.spec.ts b/packages/core/test/repl/native-functions/select-repl-fn.spec.ts
new file mode 100644
index 000000000..22a033e54
--- /dev/null
+++ b/packages/core/test/repl/native-functions/select-repl-fn.spec.ts
@@ -0,0 +1,47 @@
+import { expect } from 'chai';
+import * as sinon from 'sinon';
+import { SelectReplFn } from '../../../repl/native-functions';
+import { ReplContext } from '../../../repl/repl-context';
+import { NestContainer } from '../../../injector/container';
+
+describe('SelectReplFn', () => {
+  let selectReplFn: SelectReplFn;
+
+  let replContext: ReplContext;
+  let mockApp: {
+    container: NestContainer;
+    get: sinon.SinonStub;
+    resolve: sinon.SinonSpy;
+    select: sinon.SinonSpy;
+  };
+
+  before(async () => {
+    const container = new NestContainer();
+
+    mockApp = {
+      container,
+      get: sinon.stub(),
+      resolve: sinon.spy(),
+      select: sinon.spy(),
+    };
+    replContext = new ReplContext(mockApp as any);
+  });
+
+  beforeEach(() => {
+    selectReplFn = replContext.nativeFunctions.get('select') as SelectReplFn;
+  });
+  afterEach(() => sinon.restore());
+
+  it('the function name should be "select"', () => {
+    expect(selectReplFn).to.not.be.undefined;
+    expect(selectReplFn.fnDefinition.name).to.eql('select');
+  });
+
+  describe('action', () => {
+    it('should pass arguments down to the application context', () => {
+      const moduleCls = class TestModule {};
+      selectReplFn.action(moduleCls);
+      expect(mockApp.select.calledWith(moduleCls)).to.be.true;
+    });
+  });
+});
diff --git a/packages/core/test/repl/repl-context.spec.ts b/packages/core/test/repl/repl-context.spec.ts
new file mode 100644
index 000000000..9654dfce5
--- /dev/null
+++ b/packages/core/test/repl/repl-context.spec.ts
@@ -0,0 +1,38 @@
+import { expect } from 'chai';
+import * as sinon from 'sinon';
+import { NestContainer } from '../../injector/container';
+import { ReplContext } from '../../repl/repl-context';
+
+describe('ReplContext', () => {
+  let replContext: ReplContext;
+  let mockApp: {
+    container: NestContainer;
+    get: sinon.SinonStub;
+    resolve: sinon.SinonSpy;
+    select: sinon.SinonSpy;
+  };
+
+  before(async () => {
+    const container = new NestContainer();
+
+    mockApp = {
+      container,
+      get: sinon.stub(),
+      resolve: sinon.spy(),
+      select: sinon.spy(),
+    };
+    replContext = new ReplContext(mockApp as any);
+  });
+
+  afterEach(() => sinon.restore());
+
+  it('writeToStdout', () => {
+    const stdOutWrite = sinon.stub(process.stdout, 'write');
+    const text = sinon.stub() as unknown as string;
+
+    replContext.writeToStdout(text);
+
+    expect(stdOutWrite.calledOnce).to.be.true;
+    expect(stdOutWrite.calledWith(text)).to.be.true;
+  });
+});
diff --git a/packages/core/test/router/paths-explorer.spec.ts b/packages/core/test/router/paths-explorer.spec.ts
new file mode 100644
index 000000000..053a566a6
--- /dev/null
+++ b/packages/core/test/router/paths-explorer.spec.ts
@@ -0,0 +1,218 @@
+import { expect } from 'chai';
+import { Controller } from '../../../common/decorators/core/controller.decorator';
+import {
+  All,
+  Get,
+  Post,
+} from '../../../common/decorators/http/request-mapping.decorator';
+import { RequestMethod } from '../../../common/enums/request-method.enum';
+import { MetadataScanner } from '../../metadata-scanner';
+import { PathsExplorer } from '../../router/paths-explorer';
+
+describe('PathsExplorer', () => {
+  @Controller('global')
+  class TestRoute {
+    @Get('test')
+    public getTest() {}
+
+    @Post('test')
+    public postTest() {}
+
+    @All('another-test')
+    public anotherTest() {}
+
+    @Get(['foo', 'bar'])
+    public getTestUsingArray() {}
+  }
+
+  @Controller(['global', 'global-alias'])
+  class TestRouteAlias {
+    @Get('test')
+    public getTest() {}
+
+    @Post('test')
+    public postTest() {}
+
+    @All('another-test')
+    public anotherTest() {}
+
+    @Get(['foo', 'bar'])
+    public getTestUsingArray() {}
+  }
+
+  let pathsExplorer: PathsExplorer;
+
+  beforeEach(() => {
+    pathsExplorer = new PathsExplorer(new MetadataScanner());
+  });
+
+  describe('scanForPaths', () => {
+    it('should method return expected list of route paths', () => {
+      const paths = pathsExplorer.scanForPaths(new TestRoute());
+
+      expect(paths).to.have.length(4);
+
+      expect(paths[0].path).to.eql(['/test']);
+      expect(paths[1].path).to.eql(['/test']);
+      expect(paths[2].path).to.eql(['/another-test']);
+      expect(paths[3].path).to.eql(['/foo', '/bar']);
+
+      expect(paths[0].requestMethod).to.eql(RequestMethod.GET);
+      expect(paths[1].requestMethod).to.eql(RequestMethod.POST);
+      expect(paths[2].requestMethod).to.eql(RequestMethod.ALL);
+      expect(paths[3].requestMethod).to.eql(RequestMethod.GET);
+    });
+
+    it('should method return expected list of route paths alias', () => {
+      const paths = pathsExplorer.scanForPaths(new TestRouteAlias());
+
+      expect(paths).to.have.length(4);
+
+      expect(paths[0].path).to.eql(['/test']);
+      expect(paths[1].path).to.eql(['/test']);
+      expect(paths[2].path).to.eql(['/another-test']);
+      expect(paths[3].path).to.eql(['/foo', '/bar']);
+
+      expect(paths[0].requestMethod).to.eql(RequestMethod.GET);
+      expect(paths[1].requestMethod).to.eql(RequestMethod.POST);
+      expect(paths[2].requestMethod).to.eql(RequestMethod.ALL);
+      expect(paths[3].requestMethod).to.eql(RequestMethod.GET);
+    });
+  });
+
+  describe('exploreMethodMetadata', () => {
+    it('should method return expected object which represent single route', () => {
+      const instance = new TestRoute();
+      const instanceProto = Object.getPrototypeOf(instance);
+
+      const route = pathsExplorer.exploreMethodMetadata(
+        instance,
+        instanceProto,
+        'getTest',
+      )!;
+
+      expect(route.path).to.eql(['/test']);
+      expect(route.requestMethod).to.eql(RequestMethod.GET);
+      expect(route.targetCallback).to.eq(instance.getTest);
+    });
+
+    it('should method return expected object which represent single route with alias', () => {
+      const instance = new TestRouteAlias();
+      const instanceProto = Object.getPrototypeOf(instance);
+
+      const route = pathsExplorer.exploreMethodMetadata(
+        instance,
+        instanceProto,
+        'getTest',
+      )!;
+
+      expect(route.path).to.eql(['/test']);
+      expect(route.requestMethod).to.eql(RequestMethod.GET);
+      expect(route.targetCallback).to.eq(instance.getTest);
+    });
+
+    it('should method return expected object which represent multiple routes', () => {
+      const instance = new TestRoute();
+      const instanceProto = Object.getPrototypeOf(instance);
+
+      const route = pathsExplorer.exploreMethodMetadata(
+        instance,
+        instanceProto,
+        'getTestUsingArray',
+      )!;
+
+      expect(route.path).to.eql(['/foo', '/bar']);
+      expect(route.requestMethod).to.eql(RequestMethod.GET);
+      expect(route.targetCallback).to.eq(instance.getTestUsingArray);
+    });
+
+    it('should method return expected object which represent multiple routes with alias', () => {
+      const instance = new TestRouteAlias();
+      const instanceProto = Object.getPrototypeOf(instance);
+
+      const route = pathsExplorer.exploreMethodMetadata(
+        instance,
+        instanceProto,
+        'getTestUsingArray',
+      )!;
+
+      expect(route.path).to.eql(['/foo', '/bar']);
+      expect(route.requestMethod).to.eql(RequestMethod.GET);
+      expect(route.targetCallback).to.eq(instance.getTestUsingArray);
+    });
+
+    describe('when new implementation is injected into router', () => {
+      it('should method return changed impl of single route', () => {
+        const instance = new TestRoute();
+        const instanceProto = Object.getPrototypeOf(instance);
+
+        const newImpl = function () {};
+        instance.getTest = newImpl;
+
+        const route = pathsExplorer.exploreMethodMetadata(
+          instance,
+          instanceProto,
+          'getTest',
+        )!;
+
+        expect(route.targetCallback).to.eq(newImpl);
+        expect(route.path).to.eql(['/test']);
+        expect(route.requestMethod).to.eql(RequestMethod.GET);
+      });
+
+      it('should method return changed impl of single route which alias applied', () => {
+        const instance = new TestRouteAlias();
+        const instanceProto = Object.getPrototypeOf(instance);
+
+        const newImpl = function () {};
+        instance.getTest = newImpl;
+
+        const route = pathsExplorer.exploreMethodMetadata(
+          instance,
+          instanceProto,
+          'getTest',
+        )!;
+
+        expect(route.targetCallback).to.eq(newImpl);
+        expect(route.path).to.eql(['/test']);
+        expect(route.requestMethod).to.eql(RequestMethod.GET);
+      });
+
+      it('should method return changed impl of multiple routes', () => {
+        const instance = new TestRoute();
+        const instanceProto = Object.getPrototypeOf(instance);
+
+        const newImpl = function () {};
+        instance.getTestUsingArray = newImpl;
+
+        const route = pathsExplorer.exploreMethodMetadata(
+          instance,
+          instanceProto,
+          'getTestUsingArray',
+        )!;
+
+        expect(route.targetCallback).to.eq(newImpl);
+        expect(route.path).to.eql(['/foo', '/bar']);
+        expect(route.requestMethod).to.eql(RequestMethod.GET);
+      });
+
+      it('should method return changed impl of multiple routes which alias applied', () => {
+        const instance = new TestRouteAlias();
+        const instanceProto = Object.getPrototypeOf(instance);
+
+        const newImpl = function () {};
+        instance.getTestUsingArray = newImpl;
+
+        const route = pathsExplorer.exploreMethodMetadata(
+          instance,
+          instanceProto,
+          'getTestUsingArray',
+        )!;
+
+        expect(route.targetCallback).to.eq(newImpl);
+        expect(route.path).to.eql(['/foo', '/bar']);
+        expect(route.requestMethod).to.eql(RequestMethod.GET);
+      });
+    });
+  });
+});
diff --git a/packages/core/test/router/route-params-factory.spec.ts b/packages/core/test/router/route-params-factory.spec.ts
index 39dd22574..3768dc9ab 100644
--- a/packages/core/test/router/route-params-factory.spec.ts
+++ b/packages/core/test/router/route-params-factory.spec.ts
@@ -4,15 +4,20 @@ import { RouteParamsFactory } from '../../router/route-params-factory';
 
 describe('RouteParamsFactory', () => {
   let factory: RouteParamsFactory;
+  let untypedFactory: any;
+
   beforeEach(() => {
     factory = new RouteParamsFactory();
+    untypedFactory = factory as any;
   });
+
   describe('exchangeKeyForValue', () => {
     const res = {};
     const next = () => ({});
     const req = {
       ip: 'ip',
       session: null,
+      rawBody: Buffer.from('{"foo":"bar"}'),
       body: {
         foo: 'bar',
       },
@@ -36,14 +41,14 @@ describe('RouteParamsFactory', () => {
       describe(`RouteParamtypes.NEXT`, () => {
         it('should return next object', () => {
           expect(
-            (factory as any).exchangeKeyForValue(RouteParamtypes.NEXT, ...args),
+            untypedFactory.exchangeKeyForValue(RouteParamtypes.NEXT, ...args),
           ).to.be.eql(next);
         });
       });
       describe(`RouteParamtypes.RESPONSE`, () => {
         it('should return response object', () => {
           expect(
-            (factory as any).exchangeKeyForValue(
+            untypedFactory.exchangeKeyForValue(
               RouteParamtypes.RESPONSE,
               ...args,
             ),
@@ -53,7 +58,7 @@ describe('RouteParamsFactory', () => {
       describe(`RouteParamtypes.REQUEST`, () => {
         it('should return request object', () => {
           expect(
-            (factory as any).exchangeKeyForValue(
+            untypedFactory.exchangeKeyForValue(
               RouteParamtypes.REQUEST,
               ...args,
             ),
@@ -63,14 +68,24 @@ describe('RouteParamsFactory', () => {
       describe(`RouteParamtypes.BODY`, () => {
         it('should return body object', () => {
           expect(
-            (factory as any).exchangeKeyForValue(RouteParamtypes.BODY, ...args),
+            untypedFactory.exchangeKeyForValue(RouteParamtypes.BODY, ...args),
           ).to.be.eql(req.body);
         });
       });
+      describe(`RouteParamtypes.RAW_BODY`, () => {
+        it('should return rawBody buffer', () => {
+          expect(
+            untypedFactory.exchangeKeyForValue(
+              RouteParamtypes.RAW_BODY,
+              ...args,
+            ),
+          ).to.be.eql(req.rawBody);
+        });
+      });
       describe(`RouteParamtypes.HEADERS`, () => {
         it('should return headers object', () => {
           expect(
-            (factory as any).exchangeKeyForValue(
+            untypedFactory.exchangeKeyForValue(
               RouteParamtypes.HEADERS,
               ...args,
             ),
@@ -80,14 +95,14 @@ describe('RouteParamsFactory', () => {
       describe(`RouteParamtypes.IP`, () => {
         it('should return ip property', () => {
           expect(
-            (factory as any).exchangeKeyForValue(RouteParamtypes.IP, ...args),
+            untypedFactory.exchangeKeyForValue(RouteParamtypes.IP, ...args),
           ).to.be.equal(req.ip);
         });
       });
       describe(`RouteParamtypes.SESSION`, () => {
         it('should return session object', () => {
           expect(
-            (factory as any).exchangeKeyForValue(
+            untypedFactory.exchangeKeyForValue(
               RouteParamtypes.SESSION,
               ...args,
             ),
@@ -97,50 +112,41 @@ describe('RouteParamsFactory', () => {
       describe(`RouteParamtypes.QUERY`, () => {
         it('should return query object', () => {
           expect(
-            (factory as any).exchangeKeyForValue(
-              RouteParamtypes.QUERY,
-              ...args,
-            ),
+            untypedFactory.exchangeKeyForValue(RouteParamtypes.QUERY, ...args),
           ).to.be.eql(req.query);
         });
       });
       describe(`RouteParamtypes.PARAM`, () => {
         it('should return params object', () => {
           expect(
-            (factory as any).exchangeKeyForValue(
-              RouteParamtypes.PARAM,
-              ...args,
-            ),
+            untypedFactory.exchangeKeyForValue(RouteParamtypes.PARAM, ...args),
           ).to.be.eql(req.params);
         });
       });
       describe(`RouteParamtypes.HOST`, () => {
         it('should return hosts object', () => {
           expect(
-            (factory as any).exchangeKeyForValue(RouteParamtypes.HOST, ...args),
+            untypedFactory.exchangeKeyForValue(RouteParamtypes.HOST, ...args),
           ).to.be.eql(req.hosts);
         });
       });
       describe(`RouteParamtypes.FILE`, () => {
         it('should return file object', () => {
           expect(
-            (factory as any).exchangeKeyForValue(RouteParamtypes.FILE, ...args),
+            untypedFactory.exchangeKeyForValue(RouteParamtypes.FILE, ...args),
           ).to.be.eql(req.file);
         });
       });
       describe(`RouteParamtypes.FILES`, () => {
         it('should return files object', () => {
           expect(
-            (factory as any).exchangeKeyForValue(
-              RouteParamtypes.FILES,
-              ...args,
-            ),
+            untypedFactory.exchangeKeyForValue(RouteParamtypes.FILES, ...args),
           ).to.be.eql(req.files);
         });
       });
       describe('not available', () => {
         it('should return null', () => {
-          expect((factory as any).exchangeKeyForValue(-1, ...args)).to.be.eql(
+          expect(untypedFactory.exchangeKeyForValue(-1, ...args)).to.be.eql(
             null,
           );
         });
diff --git a/packages/core/test/router/route-path-factory.spec.ts b/packages/core/test/router/route-path-factory.spec.ts
index 84b9275a7..4c110651d 100644
--- a/packages/core/test/router/route-path-factory.spec.ts
+++ b/packages/core/test/router/route-path-factory.spec.ts
@@ -247,6 +247,7 @@ describe('RoutePathFactory', () => {
           sinon.stub(applicationConfig, 'getGlobalPrefixOptions').returns({
             exclude: [
               {
+                path: '/random',
                 pathRegex: pathToRegexp('/random'),
                 requestMethod: RequestMethod.ALL,
               },
@@ -265,6 +266,7 @@ describe('RoutePathFactory', () => {
           sinon.stub(applicationConfig, 'getGlobalPrefixOptions').returns({
             exclude: [
               {
+                path: '/cats',
                 pathRegex: pathToRegexp('/cats'),
                 requestMethod: RequestMethod.ALL,
               },
@@ -283,6 +285,7 @@ describe('RoutePathFactory', () => {
             sinon.stub(applicationConfig, 'getGlobalPrefixOptions').returns({
               exclude: [
                 {
+                  path: '/cats',
                   pathRegex: pathToRegexp('/cats'),
                   requestMethod: RequestMethod.GET,
                 },
diff --git a/packages/core/test/router/router-exception-filters.spec.ts b/packages/core/test/router/router-exception-filters.spec.ts
index f506786e2..f0e9afbd7 100644
--- a/packages/core/test/router/router-exception-filters.spec.ts
+++ b/packages/core/test/router/router-exception-filters.spec.ts
@@ -35,7 +35,7 @@ describe('RouterExceptionFilters', () => {
       it('should return plain ExceptionHandler object', () => {
         const filter = exceptionFilter.create(
           new EmptyMetadata(),
-          () => ({} as any),
+          () => ({}) as any,
           undefined,
         );
         expect((filter as any).filters).to.be.empty;
@@ -48,7 +48,7 @@ describe('RouterExceptionFilters', () => {
       it('should return ExceptionHandler object with exception filters', () => {
         const filter = exceptionFilter.create(
           new WithMetadata(),
-          () => ({} as any),
+          () => ({}) as any,
           undefined,
         );
         expect((filter as any).filters).to.not.be.empty;
@@ -97,7 +97,7 @@ describe('RouterExceptionFilters', () => {
           .callsFake(() => scopedFilterWrappers);
         sinon
           .stub(instanceWrapper, 'getInstanceByContextId')
-          .callsFake(() => ({ instance } as any));
+          .callsFake(() => ({ instance }) as any);
 
         expect(exceptionFilter.getGlobalMetadata({ id: 3 })).to.contains(
           instance,
diff --git a/packages/core/test/router/router-execution-context.spec.ts b/packages/core/test/router/router-execution-context.spec.ts
index 8bd3b150b..ee7499dd5 100644
--- a/packages/core/test/router/router-execution-context.spec.ts
+++ b/packages/core/test/router/router-execution-context.spec.ts
@@ -4,7 +4,7 @@ import { of } from 'rxjs';
 import * as sinon from 'sinon';
 import { PassThrough } from 'stream';
 import { HttpException, HttpStatus, RouteParamMetadata } from '../../../common';
-import { CUSTOM_ROUTE_AGRS_METADATA } from '../../../common/constants';
+import { CUSTOM_ROUTE_ARGS_METADATA } from '../../../common/constants';
 import { RouteParamtypes } from '../../../common/enums/route-paramtypes.enum';
 import { AbstractHttpAdapter } from '../../adapters';
 import { ApplicationConfig } from '../../application-config';
@@ -84,7 +84,7 @@ describe('RouterExecutionContext', () => {
       it('should call "exchangeKeysForValues" with expected arguments', done => {
         const keys = Object.keys(metadata);
 
-        contextCreator.create({ foo: 'bar' }, callback as any, '', '', 0);
+        contextCreator.create({ foo: 'bar' }, callback, '', '', 0);
         expect(exchangeKeysForValuesSpy.called).to.be.true;
         expect(exchangeKeysForValuesSpy.calledWith(keys, metadata)).to.be.true;
         done();
@@ -98,20 +98,14 @@ describe('RouterExecutionContext', () => {
 
           const canActivateFn = contextCreator.createGuardsFn(
             [1] as any,
-            null,
-            null,
+            null!,
+            null!,
           );
           sinon.stub(contextCreator, 'createGuardsFn').returns(canActivateFn);
           tryActivateStub = sinon
             .stub(guardsConsumer, 'tryActivate')
             .callsFake(async () => true);
-          proxyContext = contextCreator.create(
-            instance,
-            callback as any,
-            '',
-            '',
-            0,
-          );
+          proxyContext = contextCreator.create(instance, callback, '', '', 0);
         });
         it('should be a function', () => {
           expect(proxyContext).to.be.a('function');
@@ -150,9 +144,9 @@ describe('RouterExecutionContext', () => {
             } catch (e) {
               error = e;
             }
-            expect(error).to.be.instanceOf(ForbiddenException);
-            expect(error.message).to.be.eql('Forbidden resource');
-            expect(error.getResponse()).to.be.eql({
+            expect(error!).to.be.instanceOf(ForbiddenException);
+            expect(error!.message).to.be.eql('Forbidden resource');
+            expect(error!.getResponse()).to.be.eql({
               statusCode: HttpStatus.FORBIDDEN,
               error: 'Forbidden',
               message: FORBIDDEN_MESSAGE,
@@ -183,7 +177,7 @@ describe('RouterExecutionContext', () => {
       const metadata = {
         [RouteParamtypes.REQUEST]: { index: 0, data: 'test', pipes: [] },
         [RouteParamtypes.BODY]: { index: 2, data: 'test', pipes: [] },
-        [`key${CUSTOM_ROUTE_AGRS_METADATA}`]: {
+        [`key${CUSTOM_ROUTE_ARGS_METADATA}`]: {
           index: 3,
           data: 'custom',
           pipes: [],
@@ -194,7 +188,7 @@ describe('RouterExecutionContext', () => {
       const expectedValues = [
         { index: 0, type: RouteParamtypes.REQUEST, data: 'test' },
         { index: 2, type: RouteParamtypes.BODY, data: 'test' },
-        { index: 3, type: `key${CUSTOM_ROUTE_AGRS_METADATA}`, data: 'custom' },
+        { index: 3, type: `key${CUSTOM_ROUTE_ARGS_METADATA}`, data: 'custom' },
       ];
       expect(values[0]).to.deep.include(expectedValues[0]);
       expect(values[1]).to.deep.include(expectedValues[1]);
@@ -210,9 +204,9 @@ describe('RouterExecutionContext', () => {
     beforeEach(() => {
       consumerApplySpy = sinon.spy(consumer, 'apply');
     });
-    describe('when paramtype is query, body or param', () => {
-      it('should call "consumer.apply" with expected arguments', () => {
-        contextCreator.getParamValue(
+    describe('when paramtype is query, body, rawBody or param', () => {
+      it('should call "consumer.apply" with expected arguments', async () => {
+        await contextCreator.getParamValue(
           value,
           { metatype, type: RouteParamtypes.QUERY, data: null },
           transforms,
@@ -225,7 +219,7 @@ describe('RouterExecutionContext', () => {
           ),
         ).to.be.true;
 
-        contextCreator.getParamValue(
+        await contextCreator.getParamValue(
           value,
           { metatype, type: RouteParamtypes.BODY, data: null },
           transforms,
@@ -238,7 +232,20 @@ describe('RouterExecutionContext', () => {
           ),
         ).to.be.true;
 
-        contextCreator.getParamValue(
+        await contextCreator.getParamValue(
+          value,
+          { metatype, type: RouteParamtypes.RAW_BODY, data: null },
+          transforms,
+        );
+        expect(
+          consumerApplySpy.calledWith(
+            value,
+            { metatype, type: RouteParamtypes.RAW_BODY, data: null },
+            transforms,
+          ),
+        ).to.be.true;
+
+        await contextCreator.getParamValue(
           value,
           { metatype, type: RouteParamtypes.PARAM, data: null },
           transforms,
@@ -261,6 +268,7 @@ describe('RouterExecutionContext', () => {
       });
       it('otherwise', () => {
         expect(contextCreator.isPipeable(RouteParamtypes.BODY)).to.be.true;
+        expect(contextCreator.isPipeable(RouteParamtypes.RAW_BODY)).to.be.true;
         expect(contextCreator.isPipeable(RouteParamtypes.QUERY)).to.be.true;
         expect(contextCreator.isPipeable(RouteParamtypes.PARAM)).to.be.true;
         expect(contextCreator.isPipeable(RouteParamtypes.FILE)).to.be.true;
@@ -279,7 +287,7 @@ describe('RouterExecutionContext', () => {
   });
   describe('createGuardsFn', () => {
     it('should throw ForbiddenException when "tryActivate" returns false', async () => {
-      const guardsFn = contextCreator.createGuardsFn([null], null, null);
+      const guardsFn = contextCreator.createGuardsFn([null!], null!, null!)!;
       sinon.stub(guardsConsumer, 'tryActivate').callsFake(async () => false);
 
       let error: ForbiddenException;
@@ -289,9 +297,9 @@ describe('RouterExecutionContext', () => {
         error = e;
       }
 
-      expect(error).to.be.instanceOf(ForbiddenException);
-      expect(error.message).to.be.eql('Forbidden resource');
-      expect(error.getResponse()).to.be.eql({
+      expect(error!).to.be.instanceOf(ForbiddenException);
+      expect(error!.message).to.be.eql('Forbidden resource');
+      expect(error!.getResponse()).to.be.eql({
         statusCode: HttpStatus.FORBIDDEN,
         message: FORBIDDEN_MESSAGE,
         error: 'Forbidden',
@@ -315,7 +323,7 @@ describe('RouterExecutionContext', () => {
         sinon.stub(contextCreator, 'reflectRenderTemplate').returns(template);
 
         const handler = contextCreator.createHandleResponseFn(
-          null,
+          null!,
           true,
           undefined,
           200,
@@ -331,11 +339,11 @@ describe('RouterExecutionContext', () => {
         const response = { render: sinon.spy() };
 
         sinon.stub(contextCreator, 'reflectResponseHeaders').returns([]);
-        sinon.stub(contextCreator, 'reflectRenderTemplate').returns(undefined);
-        sinon.stub(contextCreator, 'reflectSse').returns(undefined);
+        sinon.stub(contextCreator, 'reflectRenderTemplate').returns(undefined!);
+        sinon.stub(contextCreator, 'reflectSse').returns(undefined!);
 
         const handler = contextCreator.createHandleResponseFn(
-          null,
+          null!,
           true,
           undefined,
           200,
@@ -383,11 +391,11 @@ describe('RouterExecutionContext', () => {
         const response = { redirect: sinon.spy() };
 
         sinon.stub(contextCreator, 'reflectResponseHeaders').returns([]);
-        sinon.stub(contextCreator, 'reflectRenderTemplate').returns(undefined);
-        sinon.stub(contextCreator, 'reflectSse').returns(undefined);
+        sinon.stub(contextCreator, 'reflectRenderTemplate').returns(undefined!);
+        sinon.stub(contextCreator, 'reflectSse').returns(undefined!);
 
         const handler = contextCreator.createHandleResponseFn(
-          null,
+          null!,
           true,
           undefined,
           200,
@@ -403,11 +411,11 @@ describe('RouterExecutionContext', () => {
         const result = Promise.resolve('test');
         const response = {};
 
-        sinon.stub(contextCreator, 'reflectRenderTemplate').returns(undefined);
-        sinon.stub(contextCreator, 'reflectSse').returns(undefined);
+        sinon.stub(contextCreator, 'reflectRenderTemplate').returns(undefined!);
+        sinon.stub(contextCreator, 'reflectSse').returns(undefined!);
 
         const handler = contextCreator.createHandleResponseFn(
-          null,
+          null!,
           false,
           undefined,
           1234,
@@ -433,11 +441,11 @@ describe('RouterExecutionContext', () => {
         const request = new PassThrough();
         request.on = sinon.spy();
 
-        sinon.stub(contextCreator, 'reflectRenderTemplate').returns(undefined);
+        sinon.stub(contextCreator, 'reflectRenderTemplate').returns(undefined!);
         sinon.stub(contextCreator, 'reflectSse').returns('/');
 
         const handler = contextCreator.createHandleResponseFn(
-          null,
+          null!,
           true,
           undefined,
           200,
@@ -453,11 +461,11 @@ describe('RouterExecutionContext', () => {
         const response = new PassThrough();
         const request = new PassThrough();
 
-        sinon.stub(contextCreator, 'reflectRenderTemplate').returns(undefined);
+        sinon.stub(contextCreator, 'reflectRenderTemplate').returns(undefined!);
         sinon.stub(contextCreator, 'reflectSse').returns('/');
 
         const handler = contextCreator.createHandleResponseFn(
-          null,
+          null!,
           true,
           undefined,
           200,
@@ -485,11 +493,11 @@ describe('RouterExecutionContext', () => {
         const request = new PassThrough();
         request.on = sinon.spy();
 
-        sinon.stub(contextCreator, 'reflectRenderTemplate').returns(undefined);
+        sinon.stub(contextCreator, 'reflectRenderTemplate').returns(undefined!);
         sinon.stub(contextCreator, 'reflectSse').returns('/');
 
         const handler = contextCreator.createHandleResponseFn(
-          null,
+          null!,
           true,
           undefined,
           200,
diff --git a/packages/core/test/router/router-explorer.spec.ts b/packages/core/test/router/router-explorer.spec.ts
index f8da6c375..a5d32ad0a 100644
--- a/packages/core/test/router/router-explorer.spec.ts
+++ b/packages/core/test/router/router-explorer.spec.ts
@@ -1,5 +1,3 @@
-import { VERSION_NEUTRAL } from '@nestjs/common';
-import { VersionValue } from '@nestjs/common/interfaces';
 import { expect } from 'chai';
 import * as sinon from 'sinon';
 import { Controller } from '../../../common/decorators/core/controller.decorator';
@@ -10,17 +8,19 @@ import {
 } from '../../../common/decorators/http/request-mapping.decorator';
 import { RequestMethod } from '../../../common/enums/request-method.enum';
 import { VersioningType } from '../../../common/enums/version-type.enum';
-import { VersioningOptions } from '../../../common/interfaces/version-options.interface';
 import { Injector } from '../../../core/injector/injector';
 import { ApplicationConfig } from '../../application-config';
+import { UnknownRequestMappingException } from '../../errors/exceptions/unknown-request-mapping.exception';
 import { ExecutionContextHost } from '../../helpers/execution-context-host';
 import { NestContainer } from '../../injector/container';
 import { InstanceWrapper } from '../../injector/instance-wrapper';
+import { GraphInspector } from '../../inspector/graph-inspector';
 import { MetadataScanner } from '../../metadata-scanner';
 import { RoutePathMetadata } from '../../router/interfaces/route-path-metadata.interface';
 import { RoutePathFactory } from '../../router/route-path-factory';
 import { RouterExceptionFilters } from '../../router/router-exception-filters';
 import { RouterExplorer } from '../../router/router-explorer';
+import { NoopHttpAdapter } from '../utils/noop-adapter.spec';
 
 describe('RouterExplorer', () => {
   @Controller('global')
@@ -53,11 +53,14 @@ describe('RouterExplorer', () => {
     public getTestUsingArray() {}
   }
 
+  class ClassWithMissingControllerDecorator {}
+
   let routerBuilder: RouterExplorer;
   let injector: Injector;
   let exceptionsFilter: RouterExceptionFilters;
   let applicationConfig: ApplicationConfig;
   let routePathFactory: RoutePathFactory;
+  let graphInspector: GraphInspector;
 
   beforeEach(() => {
     const container = new NestContainer();
@@ -65,192 +68,24 @@ describe('RouterExplorer', () => {
     applicationConfig = new ApplicationConfig();
     injector = new Injector();
     routePathFactory = new RoutePathFactory(applicationConfig);
+    graphInspector = new GraphInspector(container);
     exceptionsFilter = new RouterExceptionFilters(
       container,
       applicationConfig,
-      null,
+      null!,
     );
     routerBuilder = new RouterExplorer(
       new MetadataScanner(),
       container,
       injector,
-      null,
+      null!,
       exceptionsFilter,
       applicationConfig,
       routePathFactory,
+      graphInspector,
     );
   });
 
-  describe('scanForPaths', () => {
-    it('should method return expected list of route paths', () => {
-      const paths = routerBuilder.scanForPaths(new TestRoute());
-
-      expect(paths).to.have.length(4);
-
-      expect(paths[0].path).to.eql(['/test']);
-      expect(paths[1].path).to.eql(['/test']);
-      expect(paths[2].path).to.eql(['/another-test']);
-      expect(paths[3].path).to.eql(['/foo', '/bar']);
-
-      expect(paths[0].requestMethod).to.eql(RequestMethod.GET);
-      expect(paths[1].requestMethod).to.eql(RequestMethod.POST);
-      expect(paths[2].requestMethod).to.eql(RequestMethod.ALL);
-      expect(paths[3].requestMethod).to.eql(RequestMethod.GET);
-    });
-
-    it('should method return expected list of route paths alias', () => {
-      const paths = routerBuilder.scanForPaths(new TestRouteAlias());
-
-      expect(paths).to.have.length(4);
-
-      expect(paths[0].path).to.eql(['/test']);
-      expect(paths[1].path).to.eql(['/test']);
-      expect(paths[2].path).to.eql(['/another-test']);
-      expect(paths[3].path).to.eql(['/foo', '/bar']);
-
-      expect(paths[0].requestMethod).to.eql(RequestMethod.GET);
-      expect(paths[1].requestMethod).to.eql(RequestMethod.POST);
-      expect(paths[2].requestMethod).to.eql(RequestMethod.ALL);
-      expect(paths[3].requestMethod).to.eql(RequestMethod.GET);
-    });
-  });
-
-  describe('exploreMethodMetadata', () => {
-    it('should method return expected object which represent single route', () => {
-      const instance = new TestRoute();
-      const instanceProto = Object.getPrototypeOf(instance);
-
-      const route = routerBuilder.exploreMethodMetadata(
-        instance,
-        instanceProto,
-        'getTest',
-      );
-
-      expect(route.path).to.eql(['/test']);
-      expect(route.requestMethod).to.eql(RequestMethod.GET);
-      expect(route.targetCallback).to.eq(instance.getTest);
-    });
-
-    it('should method return expected object which represent single route with alias', () => {
-      const instance = new TestRouteAlias();
-      const instanceProto = Object.getPrototypeOf(instance);
-
-      const route = routerBuilder.exploreMethodMetadata(
-        instance,
-        instanceProto,
-        'getTest',
-      );
-
-      expect(route.path).to.eql(['/test']);
-      expect(route.requestMethod).to.eql(RequestMethod.GET);
-      expect(route.targetCallback).to.eq(instance.getTest);
-    });
-
-    it('should method return expected object which represent multiple routes', () => {
-      const instance = new TestRoute();
-      const instanceProto = Object.getPrototypeOf(instance);
-
-      const route = routerBuilder.exploreMethodMetadata(
-        instance,
-        instanceProto,
-        'getTestUsingArray',
-      );
-
-      expect(route.path).to.eql(['/foo', '/bar']);
-      expect(route.requestMethod).to.eql(RequestMethod.GET);
-      expect(route.targetCallback).to.eq(instance.getTestUsingArray);
-    });
-
-    it('should method return expected object which represent multiple routes with alias', () => {
-      const instance = new TestRouteAlias();
-      const instanceProto = Object.getPrototypeOf(instance);
-
-      const route = routerBuilder.exploreMethodMetadata(
-        instance,
-        instanceProto,
-        'getTestUsingArray',
-      );
-
-      expect(route.path).to.eql(['/foo', '/bar']);
-      expect(route.requestMethod).to.eql(RequestMethod.GET);
-      expect(route.targetCallback).to.eq(instance.getTestUsingArray);
-    });
-
-    describe('when new implementation is injected into router', () => {
-      it('should method return changed impl of single route', () => {
-        const instance = new TestRoute();
-        const instanceProto = Object.getPrototypeOf(instance);
-
-        const newImpl = function () {};
-        instance.getTest = newImpl;
-
-        const route = routerBuilder.exploreMethodMetadata(
-          instance,
-          instanceProto,
-          'getTest',
-        );
-
-        expect(route.targetCallback).to.eq(newImpl);
-        expect(route.path).to.eql(['/test']);
-        expect(route.requestMethod).to.eql(RequestMethod.GET);
-      });
-
-      it('should method return changed impl of single route which alias applied', () => {
-        const instance = new TestRouteAlias();
-        const instanceProto = Object.getPrototypeOf(instance);
-
-        const newImpl = function () {};
-        instance.getTest = newImpl;
-
-        const route = routerBuilder.exploreMethodMetadata(
-          instance,
-          instanceProto,
-          'getTest',
-        );
-
-        expect(route.targetCallback).to.eq(newImpl);
-        expect(route.path).to.eql(['/test']);
-        expect(route.requestMethod).to.eql(RequestMethod.GET);
-      });
-
-      it('should method return changed impl of multiple routes', () => {
-        const instance = new TestRoute();
-        const instanceProto = Object.getPrototypeOf(instance);
-
-        const newImpl = function () {};
-        instance.getTestUsingArray = newImpl;
-
-        const route = routerBuilder.exploreMethodMetadata(
-          instance,
-          instanceProto,
-          'getTestUsingArray',
-        );
-
-        expect(route.targetCallback).to.eq(newImpl);
-        expect(route.path).to.eql(['/foo', '/bar']);
-        expect(route.requestMethod).to.eql(RequestMethod.GET);
-      });
-
-      it('should method return changed impl of multiple routes which alias applied', () => {
-        const instance = new TestRouteAlias();
-        const instanceProto = Object.getPrototypeOf(instance);
-
-        const newImpl = function () {};
-        instance.getTestUsingArray = newImpl;
-
-        const route = routerBuilder.exploreMethodMetadata(
-          instance,
-          instanceProto,
-          'getTestUsingArray',
-        );
-
-        expect(route.targetCallback).to.eq(newImpl);
-        expect(route.path).to.eql(['/foo', '/bar']);
-        expect(route.requestMethod).to.eql(RequestMethod.GET);
-      });
-    });
-  });
-
   describe('applyPathsToRouterProxy', () => {
     it('should method return expected object which represent single route', () => {
       const bindStub = sinon.stub(
@@ -264,9 +99,9 @@ describe('RouterExplorer', () => {
       ];
 
       routerBuilder.applyPathsToRouterProxy(
-        null,
+        null!,
         paths as any,
-        null,
+        null!,
         '',
         {},
         '',
@@ -291,9 +126,9 @@ describe('RouterExplorer', () => {
         versioningOptions: { type: VersioningType.URI },
       };
       routerBuilder.applyPathsToRouterProxy(
-        null,
+        null!,
         paths as any,
-        null,
+        null!,
         '',
         routePathMetadata,
         '1',
@@ -317,6 +152,15 @@ describe('RouterExplorer', () => {
         '/global-alias',
       ]);
     });
+
+    it("should throw UnknownRequestMappingException when missing the `@Controller()` decorator in the class, displaying class's name", () => {
+      expect(() =>
+        routerBuilder.extractRouterPath(ClassWithMissingControllerDecorator),
+      ).to.throw(
+        UnknownRequestMappingException,
+        /ClassWithMissingControllerDecorator/,
+      );
+    });
   });
 
   describe('createRequestScopedHandler', () => {
@@ -331,7 +175,7 @@ describe('RouterExplorer', () => {
         () =>
           ({
             next: nextSpy,
-          } as any),
+          }) as any,
       );
     });
 
@@ -345,7 +189,7 @@ describe('RouterExplorer', () => {
         instance: { [methodKey]: {} },
       });
 
-      it('should delegete error to exception filters', async () => {
+      it('should delegate error to exception filters', async () => {
         const handler = routerBuilder.createRequestScopedHandler(
           wrapper,
           RequestMethod.ALL,
@@ -353,7 +197,7 @@ describe('RouterExplorer', () => {
           moduleKey,
           methodKey,
         );
-        await handler(null, null, null);
+        await handler(null!, null, null!);
 
         expect(nextSpy.called).to.be.true;
         expect(nextSpy.getCall(0).args[0]).to.be.instanceOf(Error);
@@ -365,449 +209,57 @@ describe('RouterExplorer', () => {
   });
 
   describe('applyVersionFilter', () => {
-    describe('when the version is VERSION_NEUTRAL', () => {
-      it('should return the handler', () => {
-        const version = VERSION_NEUTRAL as VersionValue;
-        const versioningOptions: VersioningOptions = {
-          type: VersioningType.URI,
-        };
-        const handler = sinon.stub();
-
-        const routePathMetadata: RoutePathMetadata = {
-          methodVersion: version,
-          versioningOptions,
-        };
-        const versionFilter = (routerBuilder as any).applyVersionFilter(
-          null,
-          routePathMetadata,
-          handler,
-        );
-
-        const req = {};
-        const res = {};
-        const next = sinon.stub();
-
-        versionFilter(req, res, next);
-
-        expect(handler.calledWith(req, res, next)).to.be.true;
-      });
-    });
-
-    describe('when the versioning type is URI', () => {
-      it('should return the handler', () => {
-        const version = '1';
-        const versioningOptions: VersioningOptions = {
-          type: VersioningType.URI,
-        };
-        const handler = sinon.stub();
-
-        const routePathMetadata: RoutePathMetadata = {
-          methodVersion: version,
-          versioningOptions,
-        };
-        const versionFilter = (routerBuilder as any).applyVersionFilter(
-          null,
-          routePathMetadata,
-          handler,
-        );
-
-        const req = {};
-        const res = {};
-        const next = sinon.stub();
-
-        versionFilter(req, res, next);
-        expect(handler.calledWith(req, res, next)).to.be.true;
-      });
-    });
-
-    describe('when the versioning type is MEDIA_TYPE', () => {
-      it('should return next if there is no Media Type header', () => {
-        const version = '1';
-        const versioningOptions: VersioningOptions = {
-          type: VersioningType.MEDIA_TYPE,
-          key: 'v=',
-        };
-        const handler = sinon.stub();
-
-        const routePathMetadata: RoutePathMetadata = {
-          methodVersion: version,
-          versioningOptions,
-        };
-        const versionFilter = (routerBuilder as any).applyVersionFilter(
-          null,
-          routePathMetadata,
-          handler,
-        );
-
-        const req = { headers: {} };
-        const res = {};
-        const next = sinon.stub();
-
-        versionFilter(req, res, next);
-
-        expect(next.called).to.be.true;
-      });
-
-      it('should return next if there is no version in the Media Type header', () => {
-        const version = '1';
-        const versioningOptions: VersioningOptions = {
-          type: VersioningType.MEDIA_TYPE,
-          key: 'v=',
-        };
-        const handler = sinon.stub();
-
-        const routePathMetadata: RoutePathMetadata = {
-          methodVersion: version,
-          versioningOptions,
-        };
-        const versionFilter = (routerBuilder as any).applyVersionFilter(
-          null,
-          routePathMetadata,
-          handler,
-        );
-
-        const req = { headers: { accept: 'application/json;' } };
-        const res = {};
-        const next = sinon.stub();
-
-        versionFilter(req, res, next);
-
-        expect(next.called).to.be.true;
-      });
-
-      describe('when the handler version is an array', () => {
-        it('should return next if the version in the Media Type header does not match the handler version', () => {
-          const version = ['1', '2'];
-          const versioningOptions: VersioningOptions = {
-            type: VersioningType.MEDIA_TYPE,
-            key: 'v=',
-          };
-          const handler = sinon.stub();
-
-          const routePathMetadata: RoutePathMetadata = {
-            methodVersion: version,
-            versioningOptions,
-          };
-          const versionFilter = (routerBuilder as any).applyVersionFilter(
-            null,
-            routePathMetadata,
-            handler,
-          );
-
-          const req = { headers: { accept: 'application/json;v=3' } };
-          const res = {};
-          const next = sinon.stub();
-
-          versionFilter(req, res, next);
-
-          expect(next.called).to.be.true;
-        });
-
-        it('should return the handler if the version in the Media Type header matches the handler version', () => {
-          const version = ['1', '2'];
-          const versioningOptions: VersioningOptions = {
-            type: VersioningType.MEDIA_TYPE,
-            key: 'v=',
-          };
-          const handler = sinon.stub();
-
-          const routePathMetadata: RoutePathMetadata = {
-            methodVersion: version,
-            versioningOptions,
-          };
-          const versionFilter = (routerBuilder as any).applyVersionFilter(
-            null,
-            routePathMetadata,
-            handler,
-          );
-
-          const req = { headers: { accept: 'application/json;v=1' } };
-          const res = {};
-          const next = sinon.stub();
-
-          versionFilter(req, res, next);
-
-          expect(handler.calledWith(req, res, next)).to.be.true;
-        });
-      });
-
-      describe('when the handler version is a string', () => {
-        it('should return next if the version in the Media Type header does not match the handler version', () => {
-          const version = '1';
-          const versioningOptions: VersioningOptions = {
-            type: VersioningType.MEDIA_TYPE,
-            key: 'v=',
-          };
-          const handler = sinon.stub();
-
-          const routePathMetadata: RoutePathMetadata = {
-            methodVersion: version,
-            versioningOptions,
-          };
-          const versionFilter = (routerBuilder as any).applyVersionFilter(
-            null,
-            routePathMetadata,
-            handler,
-          );
-
-          const req = { headers: { accept: 'application/json;v=3' } };
-          const res = {};
-          const next = sinon.stub();
-
-          versionFilter(req, res, next);
-
-          expect(next.called).to.be.true;
-        });
-
-        it('should return the handler if the version in the Media Type header matches the handler version', () => {
-          const version = '1';
-          const versioningOptions: VersioningOptions = {
-            type: VersioningType.MEDIA_TYPE,
-            key: 'v=',
-          };
-          const handler = sinon.stub();
-
-          const routePathMetadata: RoutePathMetadata = {
-            methodVersion: version,
-            versioningOptions,
-          };
-          const versionFilter = (routerBuilder as any).applyVersionFilter(
-            null,
-            routePathMetadata,
-            handler,
-          );
-
-          const req = { headers: { accept: 'application/json;v=1' } };
-          const res = {};
-          const next = sinon.stub();
-
-          versionFilter(req, res, next);
-
-          expect(handler.calledWith(req, res, next)).to.be.true;
-        });
-      });
-    });
-
-    describe('when the versioning type is HEADER', () => {
-      it('should return next if there is no Custom Header', () => {
-        const version = '1';
-        const versioningOptions: VersioningOptions = {
-          type: VersioningType.HEADER,
-          header: 'X-API-Version',
-        };
-        const handler = sinon.stub();
-
-        const routePathMetadata: RoutePathMetadata = {
-          methodVersion: version,
-          versioningOptions,
-        };
-        const versionFilter = (routerBuilder as any).applyVersionFilter(
-          null,
-          routePathMetadata,
-          handler,
-        );
-
-        const req = { headers: {} };
-        const res = {};
-        const next = sinon.stub();
-
-        versionFilter(req, res, next);
+    it('should call and return the `applyVersionFilter` from the underlying http server', () => {
+      const router = sinon.spy(new NoopHttpAdapter({}));
+      const routePathMetadata: RoutePathMetadata = {
+        methodVersion:
+          sinon.fake() as unknown as RoutePathMetadata['methodVersion'],
+        versioningOptions:
+          sinon.fake() as unknown as RoutePathMetadata['versioningOptions'],
+      };
+      const handler = sinon.stub();
 
-        expect(next.called).to.be.true;
-      });
+      // We're using type assertion here because `applyVersionFilter` is private
+      const versionFilter = (routerBuilder as any).applyVersionFilter(
+        router,
+        routePathMetadata,
+        handler,
+      );
 
-      it('should return next if there is no version in the Custom Header', () => {
-        const version = '1';
-        const versioningOptions: VersioningOptions = {
-          type: VersioningType.HEADER,
-          header: 'X-API-Version',
-        };
-        const handler = sinon.stub();
-
-        const routePathMetadata: RoutePathMetadata = {
-          methodVersion: version,
-          versioningOptions,
-        };
-        const versionFilter = (routerBuilder as any).applyVersionFilter(
-          null,
-          routePathMetadata,
+      expect(
+        router.applyVersionFilter.calledOnceWithExactly(
           handler,
-        );
-
-        const req = { headers: { 'X-API-Version': '' } };
-        const res = {};
-        const next = sinon.stub();
-
-        versionFilter(req, res, next);
-
-        expect(next.called).to.be.true;
-      });
-
-      describe('when the handler version is an array', () => {
-        it('should return next if the version in the Custom Header does not match the handler version', () => {
-          const version = ['1', '2'];
-          const versioningOptions: VersioningOptions = {
-            type: VersioningType.HEADER,
-            header: 'X-API-Version',
-          };
-          const handler = sinon.stub();
-
-          const routePathMetadata: RoutePathMetadata = {
-            methodVersion: version,
-            versioningOptions,
-          };
-          const versionFilter = (routerBuilder as any).applyVersionFilter(
-            null,
-            routePathMetadata,
-            handler,
-          );
-
-          const req = { headers: { 'X-API-Version': '3' } };
-          const res = {};
-          const next = sinon.stub();
-
-          versionFilter(req, res, next);
-
-          expect(next.called).to.be.true;
-        });
-
-        it('should return the handler if the version in the Custom Header matches the handler version', () => {
-          const version = ['1', '2'];
-          const versioningOptions: VersioningOptions = {
-            type: VersioningType.HEADER,
-            header: 'X-API-Version',
-          };
-          const handler = sinon.stub();
-
-          const routePathMetadata: RoutePathMetadata = {
-            methodVersion: version,
-            versioningOptions,
-          };
-          const versionFilter = (routerBuilder as any).applyVersionFilter(
-            null,
-            routePathMetadata,
-            handler,
-          );
-
-          const req = { headers: { 'X-API-Version': '1' } };
-          const res = {};
-          const next = sinon.stub();
-
-          versionFilter(req, res, next);
-
-          expect(handler.calledWith(req, res, next)).to.be.true;
-        });
-      });
+          routePathMetadata.methodVersion!,
+          routePathMetadata.versioningOptions!,
+        ),
+      ).to.be.true;
 
-      describe('when the handler version is a string', () => {
-        it('should return next if the version in the Custom Header does not match the handler version', () => {
-          const version = '1';
-          const versioningOptions: VersioningOptions = {
-            type: VersioningType.HEADER,
-            header: 'X-API-Version',
-          };
-          const handler = sinon.stub();
-
-          const routePathMetadata: RoutePathMetadata = {
-            methodVersion: version,
-            versioningOptions,
-          };
-          const versionFilter = (routerBuilder as any).applyVersionFilter(
-            null,
-            routePathMetadata,
-            handler,
-          );
-
-          const req = { headers: { 'X-API-Version': '3' } };
-          const res = {};
-          const next = sinon.stub();
-
-          versionFilter(req, res, next);
-
-          expect(next.called).to.be.true;
-        });
-
-        it('should return the handler if the version in the Custom Header matches the handler version', () => {
-          const version = '1';
-          const versioningOptions: VersioningOptions = {
-            type: VersioningType.HEADER,
-            header: 'X-API-Version',
-          };
-          const handler = sinon.stub();
-
-          const routePathMetadata: RoutePathMetadata = {
-            methodVersion: version,
-            versioningOptions,
-          };
-          const versionFilter = (routerBuilder as any).applyVersionFilter(
-            null,
-            routePathMetadata,
-            handler,
-          );
-
-          const req = { headers: { 'X-API-Version': '1' } };
-          const res = {};
-          const next = sinon.stub();
-
-          versionFilter(req, res, next);
-
-          expect(handler.calledWith(req, res, next)).to.be.true;
-        });
-      });
+      expect(router.applyVersionFilter.returnValues[0]).to.be.equal(
+        versionFilter,
+      );
     });
+  });
 
-    describe('when versioning type is unrecognized', () => {
-      it('should throw an error if there is no next function', () => {
-        const version = '1';
-        const versioningOptions: any = {
-          type: 'UNKNOWN',
-        };
-        const handler = sinon.stub();
-
-        const routePathMetadata: RoutePathMetadata = {
-          methodVersion: version,
-          versioningOptions,
-        };
-        const versionFilter = (routerBuilder as any).applyVersionFilter(
-          null,
-          routePathMetadata,
-          handler,
-        );
-
-        const req = {};
-        const res = {};
-        const next = null;
-
-        expect(() => versionFilter(req, res, next)).to.throw(
-          'HTTP adapter does not support filtering on version',
-        );
-      });
-
-      it('should return next', () => {
-        const version = '1';
-        const versioningOptions: any = {
-          type: 'UNKNOWN',
-        };
-        const handler = sinon.stub();
-
-        const routePathMetadata: RoutePathMetadata = {
-          methodVersion: version,
-          versioningOptions,
-        };
-        const versionFilter = (routerBuilder as any).applyVersionFilter(
-          null,
-          routePathMetadata,
-          handler,
-        );
+  describe('copyMetadataToCallback', () => {
+    it('should then copy the metadata from the original callback to the target callback', () => {
+      const originalCallback = () => {};
+      Reflect.defineMetadata(
+        'test_metadata_key',
+        'test_metadata_value',
+        originalCallback,
+      );
 
-        const req = {};
-        const res = {};
-        const next = sinon.stub();
+      const targetCallback = () => {};
 
-        versionFilter(req, res, next);
+      // We're using type assertion here because `copyMetadataToCallback` is private
+      (routerBuilder as any).copyMetadataToCallback(
+        originalCallback,
+        targetCallback,
+      );
 
-        expect(next.called).to.be.true;
-      });
+      expect(
+        Reflect.getMetadata('test_metadata_key', targetCallback),
+      ).to.be.equal('test_metadata_value');
     });
   });
 });
diff --git a/packages/core/test/router/router-module.spec.ts b/packages/core/test/router/router-module.spec.ts
index 5b7223196..8049d8b96 100644
--- a/packages/core/test/router/router-module.spec.ts
+++ b/packages/core/test/router/router-module.spec.ts
@@ -28,7 +28,7 @@ describe('RouterModule', () => {
   });
   describe('when instantiated', () => {
     it('should update the "targetModulesByContainer" weak map', () => {
-      const moduleRef = new Module(TestModuleClass, new NestContainer(null));
+      const moduleRef = new Module(TestModuleClass, new NestContainer(null!));
       const container = new ModulesContainer([
         [TestModuleClass.name, moduleRef],
       ]);
@@ -44,7 +44,8 @@ describe('RouterModule', () => {
         },
       ]);
 
-      expect(targetModulesByContainer.get(container).has(moduleRef)).to.be.true;
+      expect(targetModulesByContainer.get(container)!.has(moduleRef)).to.be
+        .true;
     });
   });
 });
diff --git a/packages/core/test/router/router-proxy.spec.ts b/packages/core/test/router/router-proxy.spec.ts
index 7822a7f13..8b85bcd39 100644
--- a/packages/core/test/router/router-proxy.spec.ts
+++ b/packages/core/test/router/router-proxy.spec.ts
@@ -2,10 +2,9 @@ import { expect } from 'chai';
 import * as sinon from 'sinon';
 import { HttpException } from '../../../common/exceptions/http.exception';
 import { ExceptionsHandler } from '../../exceptions/exceptions-handler';
+import { ExecutionContextHost } from '../../helpers/execution-context-host';
 import { RouterProxy } from '../../router/router-proxy';
 import { NoopHttpAdapter } from '../utils/noop-adapter.spec';
-import { SinonSpy } from 'sinon';
-import { ExecutionContextHost } from '../../helpers/execution-context-host';
 
 describe('RouterProxy', () => {
   let routerProxy: RouterProxy;
@@ -24,11 +23,11 @@ describe('RouterProxy', () => {
       expect(typeof proxy === 'function').to.be.true;
     });
 
-    it('should method encapsulate callback passed as argument', () => {
+    it('should method encapsulate callback passed as argument', async () => {
       const proxy = routerProxy.createProxy((req, res, next) => {
         throw httpException;
       }, handler);
-      proxy(null, null, null);
+      await proxy(null, null, null!);
 
       expect(nextStub.calledOnce).to.be.true;
       expect(
@@ -39,22 +38,20 @@ describe('RouterProxy', () => {
       ).to.be.true;
     });
 
-    it('should method encapsulate async callback passed as argument', done => {
+    it('should method encapsulate async callback passed as argument', async () => {
       const proxy = routerProxy.createProxy(async (req, res, next) => {
         throw httpException;
       }, handler);
-      proxy(null, null, null);
 
-      setTimeout(() => {
-        expect(nextStub.calledOnce).to.be.true;
-        expect(
-          nextStub.calledWith(
-            httpException,
-            new ExecutionContextHost([null, null, null]),
-          ),
-        ).to.be.true;
-        done();
-      }, 0);
+      await proxy(null, null, null!);
+
+      expect(nextStub.calledOnce).to.be.true;
+      expect(
+        nextStub.calledWith(
+          httpException,
+          new ExecutionContextHost([null, null, null]),
+        ),
+      ).to.be.true;
     });
   });
 
@@ -64,14 +61,14 @@ describe('RouterProxy', () => {
       expect(typeof proxy === 'function').to.be.true;
     });
 
-    it('should method encapsulate callback passed as argument', () => {
+    it('should method encapsulate callback passed as argument', async () => {
       const proxy = routerProxy.createExceptionLayerProxy(
         (err, req, res, next) => {
           throw httpException;
         },
         handler,
       );
-      proxy(null, null, null, null);
+      await proxy(null, null, null, null!);
 
       expect(nextStub.calledOnce).to.be.true;
       expect(
@@ -82,25 +79,23 @@ describe('RouterProxy', () => {
       ).to.be.true;
     });
 
-    it('should method encapsulate async callback passed as argument', done => {
+    it('should method encapsulate async callback passed as argument', async () => {
       const proxy = routerProxy.createExceptionLayerProxy(
         async (err, req, res, next) => {
           throw httpException;
         },
         handler,
       );
-      proxy(null, null, null, null);
 
-      setTimeout(() => {
-        expect(nextStub.calledOnce).to.be.true;
-        expect(
-          nextStub.calledWith(
-            httpException,
-            new ExecutionContextHost([null, null, null]),
-          ),
-        ).to.be.true;
-        done();
-      }, 0);
+      await proxy(null, null, null, null!);
+
+      expect(nextStub.calledOnce).to.be.true;
+      expect(
+        nextStub.calledWith(
+          httpException,
+          new ExecutionContextHost([null, null, null]),
+        ),
+      ).to.be.true;
     });
   });
 });
diff --git a/packages/core/test/router/router-response-controller.spec.ts b/packages/core/test/router/router-response-controller.spec.ts
index ecbbc7c36..20c4ed8ba 100644
--- a/packages/core/test/router/router-response-controller.spec.ts
+++ b/packages/core/test/router/router-response-controller.spec.ts
@@ -6,6 +6,7 @@ import * as sinon from 'sinon';
 import { PassThrough, Writable } from 'stream';
 import { HttpStatus, RequestMethod } from '../../../common';
 import { RouterResponseController } from '../../router/router-response-controller';
+import { SseStream } from '../../router/sse-stream';
 import { NoopHttpAdapter } from '../utils/noop-adapter.spec';
 
 describe('RouterResponseController', () => {
@@ -71,13 +72,13 @@ describe('RouterResponseController', () => {
   describe('transformToResult', () => {
     describe('when resultOrDeferred', () => {
       describe('is Promise', () => {
-        it('should return Promise', async () => {
+        it('should return Promise that resolves to the value resolved by the input Promise', async () => {
           const value = 100;
           expect(
             await routerResponseController.transformToResult(
               Promise.resolve(value),
             ),
-          ).to.be.eq(100);
+          ).to.be.eq(value);
         });
       });
 
@@ -88,16 +89,25 @@ describe('RouterResponseController', () => {
             await routerResponseController.transformToResult(
               of(1, 2, 3, lastValue),
             ),
-          ).to.be.eq(100);
+          ).to.be.eq(lastValue);
         });
       });
 
-      describe('is value', () => {
-        it('should return Promise', async () => {
+      describe('is an object that has the method `subscribe`', () => {
+        it('should return a Promise that resolves to the input value', async () => {
+          const value = { subscribe() {} };
+          expect(
+            await routerResponseController.transformToResult(value),
+          ).to.equal(value);
+        });
+      });
+
+      describe('is an ordinary value', () => {
+        it('should return a Promise that resolves to the input value', async () => {
           const value = 100;
           expect(
             await routerResponseController.transformToResult(value),
-          ).to.be.eq(100);
+          ).to.be.eq(value);
         });
       });
     });
@@ -179,7 +189,7 @@ describe('RouterResponseController', () => {
         .stub(routerResponseController, 'transformToResult')
         .returns(Promise.resolve({ statusCode: 123, url: 'redirect url' }));
       const result = {};
-      await routerResponseController.redirect(result, null, null);
+      await routerResponseController.redirect(result, null, null!);
       expect(transformToResultSpy.firstCall.args[0]).to.be.equal(result);
     });
     it('should pass the response to redirect', async () => {
@@ -188,7 +198,7 @@ describe('RouterResponseController', () => {
         .returns(Promise.resolve({ statusCode: 123, url: 'redirect url' }));
       const redirectSpy = sinon.spy(adapter, 'redirect');
       const response = {};
-      await routerResponseController.redirect(null, response, null);
+      await routerResponseController.redirect(null, response, null!);
       expect(redirectSpy.firstCall.args[0]).to.be.equal(response);
     });
     describe('status code', () => {
@@ -253,7 +263,7 @@ describe('RouterResponseController', () => {
     it('should accept only observables', async () => {
       const result = Promise.resolve('test');
       try {
-        await routerResponseController.sse(
+        routerResponseController.sse(
           result as unknown as any,
           {} as unknown as ServerResponse,
           {} as unknown as IncomingMessage,
@@ -299,7 +309,7 @@ describe('RouterResponseController', () => {
       request.destroy();
       await written(response);
       expect(response.content).to.eql(
-        `:
+        `
 id: 1
 data: test
 
@@ -310,7 +320,7 @@ data: test
     it('should close on request close', done => {
       const result = of('test');
       const response = new Writable();
-      response.end = () => done();
+      response.end = () => done() as any;
       response._write = () => {};
 
       const request = new Writable();
@@ -327,7 +337,7 @@ data: test
     it('should close the request when observable completes', done => {
       const result = of('test');
       const response = new Writable();
-      response.end = done;
+      response.end = done as any;
       response._write = () => {};
 
       const request = new Writable();
@@ -356,7 +366,7 @@ data: test
           request as unknown as IncomingMessage,
         );
       } catch {
-        // Wether an error is thrown or not
+        // Whether an error is thrown or not
         // is not relevant, so long as
         // result is not called
       }
@@ -365,11 +375,76 @@ data: test
       done();
     });
 
+    describe('when writing data too densely', () => {
+      const DEFAULT_MAX_LISTENERS = SseStream.defaultMaxListeners;
+      const MAX_LISTENERS = 1;
+      const sandbox = sinon.createSandbox();
+
+      beforeEach(() => {
+        // Can't access to the internal sseStream,
+        // as a workaround, set `defaultMaxListeners` of `SseStream` and reset the max listeners of `process`
+        const PROCESS_MAX_LISTENERS = process.getMaxListeners();
+        SseStream.defaultMaxListeners = MAX_LISTENERS;
+        process.setMaxListeners(PROCESS_MAX_LISTENERS);
+
+        const sseStream = sinon.createStubInstance(SseStream);
+        const originalWrite = SseStream.prototype.write;
+        // Make `.write()` always return false, so as to listen `drain` event
+        sseStream.write.callsFake(function (...args: any[]) {
+          originalWrite.apply(this, args);
+          return false;
+        });
+        sandbox.replace(SseStream.prototype, 'write', sseStream.write);
+      });
+
+      afterEach(() => {
+        sandbox.restore();
+        SseStream.defaultMaxListeners = DEFAULT_MAX_LISTENERS;
+      });
+
+      it('should not cause memory leak', async () => {
+        let maxDrainListenersExceededWarning = null;
+        process.on('warning', (warning: any) => {
+          if (
+            warning.name === 'MaxListenersExceededWarning' &&
+            warning.emitter instanceof SseStream &&
+            warning.type === 'drain' &&
+            warning.count === MAX_LISTENERS + 1
+          ) {
+            maxDrainListenersExceededWarning = warning;
+          }
+        });
+
+        const result = new Subject();
+
+        const response = new Writable();
+        response._write = () => {};
+
+        const request = new Writable();
+        request._write = () => {};
+
+        routerResponseController.sse(
+          result,
+          response as unknown as ServerResponse,
+          request as unknown as IncomingMessage,
+        );
+
+        // Send multiple messages simultaneously
+        Array.from({ length: MAX_LISTENERS + 1 }).forEach((_, i) =>
+          result.next(String(i)),
+        );
+
+        await new Promise(resolve => process.nextTick(resolve));
+
+        expect(maxDrainListenersExceededWarning).to.equal(null);
+      });
+    });
+
     describe('when there is an error', () => {
       it('should close the request', done => {
         const result = new Subject();
         const response = new Writable();
-        response.end = done;
+        response.end = done as any;
         response._write = () => {};
 
         const request = new Writable();
@@ -421,7 +496,7 @@ data: test
 
         await written(response);
         expect(response.content).to.eql(
-          `:
+          `
 event: error
 id: 1
 data: Some error
diff --git a/packages/core/test/router/routes-resolver.spec.ts b/packages/core/test/router/routes-resolver.spec.ts
index 1b88cee5f..a4a1cc866 100644
--- a/packages/core/test/router/routes-resolver.spec.ts
+++ b/packages/core/test/router/routes-resolver.spec.ts
@@ -13,6 +13,8 @@ import { ApplicationConfig } from '../../application-config';
 import { NestContainer } from '../../injector';
 import { Injector } from '../../injector/injector';
 import { InstanceWrapper } from '../../injector/instance-wrapper';
+import { GraphInspector } from '../../inspector/graph-inspector';
+import { SerializedGraph } from '../../inspector/serialized-graph';
 import { RoutesResolver } from '../../router/routes-resolver';
 import { NoopHttpAdapter } from '../utils/noop-adapter.spec';
 
@@ -50,6 +52,7 @@ describe('RoutesResolver', () => {
 
   let router: any;
   let routesResolver: RoutesResolver;
+  let untypedRoutesResolver: any;
   let container: NestContainer;
   let modules: Map<string, any>;
   let applicationRef: any;
@@ -65,6 +68,7 @@ describe('RoutesResolver', () => {
       getModules: () => modules,
       getModuleByKey: (key: string) => modules.get(key),
       getHttpAdapterRef: () => applicationRef,
+      serializedGraph: new SerializedGraph(),
     } as any;
     router = {
       get() {},
@@ -77,7 +81,9 @@ describe('RoutesResolver', () => {
       container,
       new ApplicationConfig(),
       new Injector(),
+      new GraphInspector(container),
     );
+    untypedRoutesResolver = routesResolver as any;
   });
 
   describe('registerRouters', () => {
@@ -91,14 +97,14 @@ describe('RoutesResolver', () => {
 
       const appInstance = new NoopHttpAdapter(router);
       const exploreSpy = sinon.spy(
-        (routesResolver as any).routerExplorer,
+        untypedRoutesResolver.routerExplorer,
         'explore',
       );
       const moduleName = '';
       modules.set(moduleName, {});
 
       sinon
-        .stub((routesResolver as any).routerExplorer, 'extractRouterPath')
+        .stub(untypedRoutesResolver.routerExplorer, 'extractRouterPath')
         .callsFake(() => ['']);
       routesResolver.registerRouters(routes, moduleName, '', '', appInstance);
 
@@ -133,14 +139,14 @@ describe('RoutesResolver', () => {
 
       const appInstance = new NoopHttpAdapter(router);
       const exploreSpy = sinon.spy(
-        (routesResolver as any).routerExplorer,
+        untypedRoutesResolver.routerExplorer,
         'explore',
       );
       const moduleName = '';
       modules.set(moduleName, {});
 
       sinon
-        .stub((routesResolver as any).routerExplorer, 'extractRouterPath')
+        .stub(untypedRoutesResolver.routerExplorer, 'extractRouterPath')
         .callsFake(() => ['']);
       routesResolver.registerRouters(routes, moduleName, '', '', appInstance);
 
@@ -175,7 +181,9 @@ describe('RoutesResolver', () => {
         container,
         applicationConfig,
         new Injector(),
+        new GraphInspector(container),
       );
+      untypedRoutesResolver = routesResolver as any;
 
       const routes = new Map();
       const routeWrapper = new InstanceWrapper({
@@ -186,14 +194,14 @@ describe('RoutesResolver', () => {
 
       const appInstance = new NoopHttpAdapter(router);
       const exploreSpy = sinon.spy(
-        (routesResolver as any).routerExplorer,
+        untypedRoutesResolver.routerExplorer,
         'explore',
       );
       const moduleName = '';
       modules.set(moduleName, {});
 
       sinon
-        .stub((routesResolver as any).routerExplorer, 'extractRouterPath')
+        .stub(untypedRoutesResolver.routerExplorer, 'extractRouterPath')
         .callsFake(() => ['']);
       routesResolver.registerRouters(routes, moduleName, '', '', appInstance);
 
@@ -319,6 +327,13 @@ describe('RoutesResolver', () => {
           expect(outputErr).to.be.instanceof(BadRequestException);
         });
       });
+      describe('URIError', () => {
+        it('should map to BadRequestException', () => {
+          const err = new URIError();
+          const outputErr = routesResolver.mapExternalException(err);
+          expect(outputErr).to.be.instanceof(BadRequestException);
+        });
+      });
       describe('other', () => {
         it('should behave as an identity', () => {
           const err = new Error();
diff --git a/packages/core/test/router/sse-stream.spec.ts b/packages/core/test/router/sse-stream.spec.ts
index b4ccdf191..173a522fe 100644
--- a/packages/core/test/router/sse-stream.spec.ts
+++ b/packages/core/test/router/sse-stream.spec.ts
@@ -43,6 +43,7 @@ describe('SseStream', () => {
     const sse = new SseStream();
     const sink = new Sink();
     sse.pipe(sink);
+
     sse.writeMessage(
       {
         data: 'hello\nworld',
@@ -57,8 +58,9 @@ describe('SseStream', () => {
     );
     sse.end();
     await written(sink);
+
     expect(sink.content).to.equal(
-      `:
+      `
 id: 1
 data: hello
 data: world
@@ -75,6 +77,7 @@ data: monde
     const sse = new SseStream();
     const sink = new Sink();
     sse.pipe(sink);
+
     sse.writeMessage(
       {
         data: { hello: 'world' },
@@ -83,8 +86,9 @@ data: monde
     );
     sse.end();
     await written(sink);
+
     expect(sink.content).to.equal(
-      `:
+      `
 id: 1
 data: {"hello":"world"}
 
@@ -96,6 +100,7 @@ data: {"hello":"world"}
     const sse = new SseStream();
     const sink = new Sink();
     sse.pipe(sink);
+
     sse.writeMessage(
       {
         type: 'tea-time',
@@ -107,8 +112,9 @@ data: {"hello":"world"}
     );
     sse.end();
     await written(sink);
+
     expect(sink.content).to.equal(
-      `:
+      `
 event: tea-time
 id: the-id
 retry: 222
@@ -148,6 +154,7 @@ data: hello
         return sink;
       },
     );
+
     sse.pipe(sink, {
       additionalHeaders: { 'access-control-headers': 'some-cors-value' },
     });
@@ -159,6 +166,7 @@ data: hello
       sse = new SseStream(req);
       sse.pipe(res);
     });
+
     server.listen(() => {
       const es = new EventSource(
         `http://localhost:${(server.address() as AddressInfo).port}`,
diff --git a/packages/core/test/router/utils/flat-routes.spec.ts b/packages/core/test/router/utils/flat-routes.spec.ts
index 2cd739b07..fa0f13904 100644
--- a/packages/core/test/router/utils/flat-routes.spec.ts
+++ b/packages/core/test/router/utils/flat-routes.spec.ts
@@ -13,6 +13,10 @@ describe('flattenRoutePaths', () => {
     @Module({})
     class ChildModule2 {}
     @Module({})
+    class ChildModule3 {}
+    @Module({})
+    class ChildModule4 {}
+    @Module({})
     class ParentChildModule {}
     @Module({})
     class ChildChildModule2 {}
@@ -56,6 +60,16 @@ describe('flattenRoutePaths', () => {
               },
             ],
           },
+          {
+            path: '/child2',
+            children: [
+              {
+                path: 'child',
+                module: ChildModule3,
+              },
+              ChildModule4,
+            ],
+          },
         ],
       },
       { path: '/v1', children: [AuthModule, CatsModule, DogsModule] },
@@ -75,6 +89,8 @@ describe('flattenRoutePaths', () => {
         path: '/parent/child/parentchild/childchild/child2child',
         module: ChildChildModule2,
       },
+      { path: '/parent/child2', module: ChildModule4 },
+      { path: '/parent/child2/child', module: ChildModule3 },
       { path: '/v1', module: AuthModule },
       { path: '/v1', module: CatsModule },
       { path: '/v1', module: DogsModule },
diff --git a/packages/core/test/scanner.spec.ts b/packages/core/test/scanner.spec.ts
index 2fdad2cc2..cbc8f9eb8 100644
--- a/packages/core/test/scanner.spec.ts
+++ b/packages/core/test/scanner.spec.ts
@@ -1,4 +1,4 @@
-import { Catch, Injectable, Logger } from '@nestjs/common';
+import { Catch, Injectable } from '@nestjs/common';
 import { expect } from 'chai';
 import * as sinon from 'sinon';
 import { GUARDS_METADATA } from '../../common/constants';
@@ -8,12 +8,16 @@ import { Module } from '../../common/decorators/modules/module.decorator';
 import { Scope } from '../../common/interfaces';
 import { ApplicationConfig } from '../application-config';
 import { APP_FILTER, APP_GUARD, APP_INTERCEPTOR, APP_PIPE } from '../constants';
+import { InvalidClassModuleException } from '../errors/exceptions/invalid-class-module.exception';
 import { InvalidModuleException } from '../errors/exceptions/invalid-module.exception';
 import { UndefinedModuleException } from '../errors/exceptions/undefined-module.exception';
 import { NestContainer } from '../injector/container';
 import { InstanceWrapper } from '../injector/instance-wrapper';
+import { GraphInspector } from '../inspector/graph-inspector';
+import { ModuleOverride } from '../interfaces/module-override.interface';
 import { MetadataScanner } from '../metadata-scanner';
 import { DependenciesScanner } from '../scanner';
+import Sinon = require('sinon');
 
 describe('DependenciesScanner', () => {
   class Guard {}
@@ -42,28 +46,33 @@ describe('DependenciesScanner', () => {
   class TestModule {}
 
   @Module({
-    imports: [undefined],
+    imports: [undefined!],
   })
   class UndefinedModule {}
 
   @Module({
-    imports: [null],
+    imports: [null!],
   })
   class InvalidModule {}
 
   let scanner: DependenciesScanner;
+  let untypedScanner: any;
   let mockContainer: sinon.SinonMock;
   let container: NestContainer;
+  let graphInspector: GraphInspector;
 
   beforeEach(() => {
     container = new NestContainer();
     mockContainer = sinon.mock(container);
+    graphInspector = new GraphInspector(container);
 
     scanner = new DependenciesScanner(
       container,
       new MetadataScanner(),
+      graphInspector,
       new ApplicationConfig(),
     );
+    untypedScanner = scanner as any;
     sinon.stub(scanner, 'registerCoreModule').callsFake(async () => {});
   });
 
@@ -71,34 +80,172 @@ describe('DependenciesScanner', () => {
     mockContainer.restore();
   });
 
-  it('should "insertModule" call twice (2 modules) container method "addModule"', async () => {
-    const expectation = mockContainer.expects('addModule').twice();
-
-    await scanner.scan(TestModule as any);
-    expectation.verify();
+  it('should "insertOrOverrideModule" call twice (2 modules) container method "addModule"', async () => {
+    const expectationCountAddModule = mockContainer
+      .expects('addModule')
+      .twice();
+    const expectationCountReplaceModule = mockContainer
+      .expects('replaceModule')
+      .never();
+
+    await scanner.scan(TestModule);
+    expectationCountAddModule.verify();
+    expectationCountReplaceModule.verify();
   });
 
   it('should "insertProvider" call twice (2 components) container method "addProvider"', async () => {
     const expectation = mockContainer.expects('addProvider').twice();
     const stub = sinon.stub(scanner, 'insertExportedProvider');
 
-    await scanner.scan(TestModule as any);
+    await scanner.scan(TestModule);
     expectation.verify();
     stub.restore();
   });
 
   it('should "insertController" call twice (2 components) container method "addController"', async () => {
     const expectation = mockContainer.expects('addController').twice();
-    await scanner.scan(TestModule as any);
+    await scanner.scan(TestModule);
     expectation.verify();
   });
 
   it('should "insertExportedProvider" call once (1 component) container method "addExportedProvider"', async () => {
     const expectation = mockContainer.expects('addExportedProvider').once();
-    await scanner.scan(TestModule as any);
+    await scanner.scan(TestModule);
     expectation.verify();
   });
 
+  describe('when there is modules overrides', () => {
+    @Injectable()
+    class OverwrittenTestComponent {}
+
+    @Controller('')
+    class OverwrittenControlerOne {}
+
+    @Controller('')
+    class OverwrittenControllerTwo {}
+
+    @Module({
+      controllers: [OverwrittenControlerOne],
+      providers: [OverwrittenTestComponent],
+    })
+    class OverwrittenModuleOne {}
+
+    @Module({
+      controllers: [OverwrittenControllerTwo],
+    })
+    class OverwrittenModuleTwo {}
+
+    @Module({
+      imports: [OverwrittenModuleOne, OverwrittenModuleTwo],
+    })
+    class OverrideTestModule {}
+
+    @Injectable()
+    class OverrideTestComponent {}
+
+    @Controller('')
+    class OverrideControllerOne {}
+
+    @Controller('')
+    class OverrideControllerTwo {}
+
+    @Module({
+      controllers: [OverwrittenControlerOne],
+      providers: [OverrideTestComponent],
+    })
+    class OverrideModuleOne {}
+
+    @Module({
+      controllers: [OverrideControllerTwo],
+    })
+    class OverrideModuleTwo {}
+
+    const modulesToOverride: ModuleOverride[] = [
+      { moduleToReplace: OverwrittenModuleOne, newModule: OverrideModuleOne },
+      { moduleToReplace: OverwrittenModuleTwo, newModule: OverrideModuleTwo },
+    ];
+
+    it('should "putModule" call twice (2 modules) container method "replaceModule"', async () => {
+      const expectationReplaceModuleFirst = mockContainer
+        .expects('replaceModule')
+        .once()
+        .withArgs(OverwrittenModuleOne, OverrideModuleOne, sinon.match.array);
+      const expectationReplaceModuleSecond = mockContainer
+        .expects('replaceModule')
+        .once()
+        .withArgs(OverwrittenModuleTwo, OverrideModuleTwo, sinon.match.array);
+      const expectationCountAddModule = mockContainer
+        .expects('addModule')
+        .once();
+
+      await scanner.scan(OverrideTestModule, {
+        overrides: modulesToOverride,
+      });
+
+      expectationReplaceModuleFirst.verify();
+      expectationReplaceModuleSecond.verify();
+      expectationCountAddModule.verify();
+    });
+
+    it('should "insertProvider" call once container method "addProvider"', async () => {
+      const expectation = mockContainer.expects('addProvider').once();
+
+      await scanner.scan(OverrideTestModule);
+      expectation.verify();
+    });
+
+    it('should "insertController" call twice (2 components) container method "addController"', async () => {
+      const expectation = mockContainer.expects('addController').twice();
+      await scanner.scan(OverrideTestModule);
+      expectation.verify();
+    });
+
+    it('should "putModule" call container method "replaceModule" with forwardRef() when forwardRef property exists', async () => {
+      const overwrittenForwardRefSpy = sinon.spy();
+
+      @Module({})
+      class OverwrittenForwardRef {}
+
+      @Module({})
+      class Overwritten {
+        public static forwardRef() {
+          overwrittenForwardRefSpy();
+          return OverwrittenForwardRef;
+        }
+      }
+
+      const overrideForwardRefSpy = sinon.spy();
+
+      @Module({})
+      class OverrideForwardRef {}
+
+      @Module({})
+      class Override {
+        public static forwardRef() {
+          overrideForwardRefSpy();
+          return OverrideForwardRef;
+        }
+      }
+
+      @Module({
+        imports: [Overwritten],
+      })
+      class OverrideForwardRefTestModule {}
+
+      await scanner.scan(OverrideForwardRefTestModule, {
+        overrides: [
+          {
+            moduleToReplace: Overwritten,
+            newModule: Override,
+          },
+        ],
+      });
+
+      expect(overwrittenForwardRefSpy.called).to.be.true;
+      expect(overrideForwardRefSpy.called).to.be.true;
+    });
+  });
+
   describe('reflectDynamicMetadata', () => {
     describe('when param has prototype', () => {
       it('should call "reflectParamInjectables" and "reflectInjectables"', () => {
@@ -133,76 +280,147 @@ describe('DependenciesScanner', () => {
   });
 
   describe('insertInjectable', () => {
-    it('should call "addInjectable"', () => {
-      const addInjectable = sinon
-        .stub((scanner as any).container, 'addInjectable')
+    class InjectableCls {}
+    class HostCls {}
+
+    const instanceWrapper = { id: 'random_id' };
+    const token = 'token';
+    const methodKey = 'methodKey';
+
+    let addInjectableStub: Sinon.SinonStub;
+    let insertEnhancerMetadataCacheStub: Sinon.SinonStub;
+
+    beforeEach(() => {
+      addInjectableStub = sinon
+        .stub(untypedScanner.container, 'addInjectable')
+        .callsFake(() => instanceWrapper);
+      insertEnhancerMetadataCacheStub = sinon
+        .stub(graphInspector, 'insertEnhancerMetadataCache')
         .callsFake(() => undefined);
-      const comp = {};
-      const token = 'token';
+    });
+
+    describe('when injectable is of type function', () => {
+      const subtype = 'filter';
+      beforeEach(() => {
+        scanner.insertInjectable(
+          InjectableCls,
+          token,
+          HostCls,
+          subtype,
+          methodKey,
+        );
+      });
+
+      it('should call "addInjectable"', () => {
+        expect(addInjectableStub.calledWith(InjectableCls, token)).to.be.true;
+      });
+
+      it('should call "insertEnhancerMetadataCache"', () => {
+        expect(
+          insertEnhancerMetadataCacheStub.calledWith({
+            moduleToken: token,
+            classRef: HostCls,
+            enhancerInstanceWrapper: instanceWrapper,
+            targetNodeId: instanceWrapper.id,
+            methodKey,
+            subtype,
+          }),
+        ).to.be.true;
+      });
+    });
+    describe('when injectable is not of type function', () => {
+      const injectableRef = new InjectableCls();
+      const subtype = 'interceptor';
+
+      beforeEach(() => {
+        scanner.insertInjectable(
+          injectableRef,
+          token,
+          HostCls,
+          subtype,
+          methodKey,
+        );
+      });
 
-      scanner.insertInjectable(comp as any, token, null);
-      expect(addInjectable.calledWith(comp, token)).to.be.true;
+      it('should not call "addInjectable"', () => {
+        expect(addInjectableStub.notCalled).to.be.true;
+      });
+
+      it('should call "insertEnhancerMetadataCache"', () => {
+        expect(
+          insertEnhancerMetadataCacheStub.calledWith({
+            moduleToken: token,
+            classRef: HostCls,
+            enhancerRef: injectableRef,
+            methodKey,
+            subtype,
+          }),
+        ).to.be.true;
+      });
     });
   });
 
   class CompMethod {
     @UseGuards(Guard)
     public method() {}
+
+    @UseGuards(Guard, Guard)
+    public method2() {}
   }
   describe('reflectKeyMetadata', () => {
     it('should return undefined', () => {
       const result = scanner.reflectKeyMetadata(TestComponent, 'key', 'method');
       expect(result).to.be.undefined;
     });
-    it('should return array', () => {
+    it('should return an array that consists of 1 element', () => {
+      const methodKey = 'method';
+      const result = scanner.reflectKeyMetadata(
+        CompMethod,
+        GUARDS_METADATA,
+        methodKey,
+      );
+      expect(result).to.be.deep.equal({ methodKey, metadata: [Guard] });
+    });
+    it('should return an array that consists of 2 elements', () => {
+      const methodKey = 'method2';
       const result = scanner.reflectKeyMetadata(
         CompMethod,
         GUARDS_METADATA,
-        'method',
+        methodKey,
       );
-      expect(result).to.be.eql([Guard]);
+      expect(result).to.be.deep.equal({ methodKey, metadata: [Guard, Guard] });
     });
   });
 
   describe('insertModule', () => {
-    let LoggerWarnSpy: sinon.SinonSpy;
-
-    beforeEach(() => {
-      LoggerWarnSpy = sinon.stub(Logger.prototype, 'warn');
-    });
-
-    afterEach(() => {
-      LoggerWarnSpy.restore();
-    });
-
-    it('should call forwardRef() when forwardRef property exists', () => {
+    it('should call forwardRef() when forwardRef property exists', async () => {
       sinon.stub(container, 'addModule').returns({} as any);
 
-      const module = { forwardRef: sinon.spy() };
-      scanner.insertModule(module, []);
+      const module = { forwardRef: sinon.stub().returns(class {}) };
+      await scanner.insertModule(module, []);
 
       expect(module.forwardRef.called).to.be.true;
     });
-    it('should logs an warning when passing a class annotated with `@Injectable()` decorator', () => {
+    it('should throw "InvalidClassModuleException" exception when supplying a class annotated with `@Injectable()` decorator', () => {
       sinon.stub(container, 'addModule').returns({} as any);
 
-      scanner.insertModule(TestComponent, []);
-
-      expect(LoggerWarnSpy.calledOnce).to.be.true;
+      expect(scanner.insertModule(TestComponent, [])).to.be.rejectedWith(
+        InvalidClassModuleException,
+      );
     });
-    it('should logs an warning when passing a class annotated with `@Controller()` decorator', () => {
+    it('should throw "InvalidClassModuleException" exception when supplying a class annotated with `@Controller()` decorator', () => {
       sinon.stub(container, 'addModule').returns({} as any);
 
-      scanner.insertModule(TestController, []);
-
-      expect(LoggerWarnSpy.calledOnce).to.be.true;
+      expect(scanner.insertModule(TestController, [])).to.be.rejectedWith(
+        InvalidClassModuleException,
+      );
     });
-    it('should logs an warning when passing a class annotated with `@Catch()` (only) decorator', () => {
+    it('should throw "InvalidClassModuleException" exception when supplying a class annotated with (only) `@Catch()` decorator', () => {
       sinon.stub(container, 'addModule').returns({} as any);
 
-      scanner.insertModule(TestExceptionFilterWithoutInjectable, []);
-
-      expect(LoggerWarnSpy.calledOnce).to.be.true;
+      expect(
+        scanner.insertModule(TestExceptionFilterWithoutInjectable, []),
+      ).to.be.rejectedWith(InvalidClassModuleException);
     });
   });
 
@@ -211,7 +429,7 @@ describe('DependenciesScanner', () => {
       const module = { forwardRef: sinon.stub().returns({}) };
 
       sinon.stub(container, 'addImport').returns({} as any);
-      await scanner.insertImport(module as any, [] as any, 'test');
+      await scanner.insertImport(module, [] as any, 'test');
       expect(module.forwardRef.called).to.be.true;
     });
     describe('when "related" is nil', () => {
@@ -261,7 +479,7 @@ describe('DependenciesScanner', () => {
         it('should push new object to "applicationProvidersApplyMap" array', () => {
           mockContainer.expects('addProvider').callsFake(() => false);
           scanner.insertProvider(provider, token);
-          const applyMap = (scanner as any).applicationProvidersApplyMap;
+          const applyMap = untypedScanner.applicationProvidersApplyMap;
 
           expect(applyMap).to.have.length(1);
           expect(applyMap[0].moduleKey).to.be.eql(token);
@@ -298,15 +516,11 @@ describe('DependenciesScanner', () => {
           expectation.verify();
         });
         it('should not push new object to "applicationProvidersApplyMap" array', () => {
-          expect((scanner as any).applicationProvidersApplyMap).to.have.length(
-            0,
-          );
+          expect(untypedScanner.applicationProvidersApplyMap).to.have.length(0);
 
           mockContainer.expects('addProvider').callsFake(() => false);
           scanner.insertProvider(component, token);
-          expect((scanner as any).applicationProvidersApplyMap).to.have.length(
-            0,
-          );
+          expect(untypedScanner.applicationProvidersApplyMap).to.have.length(0);
         });
       });
     });
@@ -318,21 +532,33 @@ describe('DependenciesScanner', () => {
         providerKey: 'providerToken',
         type: APP_GUARD,
       };
-      (scanner as any).applicationProvidersApplyMap = [provider];
+      untypedScanner.applicationProvidersApplyMap = [provider];
 
       const expectedInstance = {};
+      const instanceWrapper = {
+        instance: expectedInstance,
+      } as unknown as InstanceWrapper;
       mockContainer.expects('getModules').callsFake(() => ({
         get: () => ({
-          providers: { get: () => ({ instance: expectedInstance }) },
+          providers: { get: () => instanceWrapper },
         }),
       }));
+
       const applySpy = sinon.spy();
       sinon.stub(scanner, 'getApplyProvidersMap').callsFake(() => ({
         [provider.type]: applySpy,
       }));
+
+      const insertAttachedEnhancerStub = sinon.stub(
+        graphInspector,
+        'insertAttachedEnhancer',
+      );
+
       scanner.applyApplicationProviders();
+
       expect(applySpy.called).to.be.true;
       expect(applySpy.calledWith(expectedInstance)).to.be.true;
+      expect(insertAttachedEnhancerStub.calledWith(instanceWrapper)).to.be.true;
     });
     it('should apply each globally scoped provider', () => {
       const provider = {
@@ -341,7 +567,7 @@ describe('DependenciesScanner', () => {
         type: APP_GUARD,
         scope: Scope.REQUEST,
       };
-      (scanner as any).applicationProvidersApplyMap = [provider];
+      untypedScanner.applicationProvidersApplyMap = [provider];
 
       const expectedInstanceWrapper = new InstanceWrapper();
       mockContainer.expects('getModules').callsFake(() => ({
@@ -349,13 +575,23 @@ describe('DependenciesScanner', () => {
           injectables: { get: () => expectedInstanceWrapper },
         }),
       }));
+
       const applySpy = sinon.spy();
       sinon.stub(scanner, 'getApplyRequestProvidersMap').callsFake(() => ({
         [provider.type]: applySpy,
       }));
+
+      const insertAttachedEnhancerStub = sinon.stub(
+        graphInspector,
+        'insertAttachedEnhancer',
+      );
+
       scanner.applyApplicationProviders();
+
       expect(applySpy.called).to.be.true;
       expect(applySpy.calledWith(expectedInstanceWrapper)).to.be.true;
+      expect(insertAttachedEnhancerStub.calledWith(expectedInstanceWrapper)).to
+        .be.true;
     });
   });
 
@@ -367,31 +603,45 @@ describe('DependenciesScanner', () => {
       scope: Scope.REQUEST,
     };
 
-    it('should add enhancers metadata to every controller', () => {
-      (scanner as any).applicationProvidersApplyMap = [provider];
+    it('should add enhancers metadata to every controller and every entry provider', () => {
+      untypedScanner.applicationProvidersApplyMap = [provider];
 
       const instance = new InstanceWrapper({ name: 'test' });
       const controllers = new Map();
-      const mockController = new InstanceWrapper();
+      const providers = new Map();
+
+      const fakeController = new InstanceWrapper();
+      const fakeProvider = new InstanceWrapper();
+
+      const providerToken = 'entryProvider';
+      controllers.set('test', fakeController);
+      providers.set(providerToken, fakeProvider);
 
-      controllers.set('test', mockController);
       mockContainer.expects('getModules').callsFake(() => ({
         get: () => ({
           injectables: { get: () => instance },
           controllers,
+          entryProviders: Array.from(providers.values()),
         }),
         values() {
           return [this.get()];
         },
       }));
-      const addEnhancerMetadataSpy = sinon.spy(
-        mockController,
+
+      const addEnhancerMetadataControllerSpy = sinon.spy(
+        fakeController,
+        'addEnhancerMetadata',
+      );
+      const addEnhancerMetadataProviderSpy = sinon.spy(
+        fakeProvider,
         'addEnhancerMetadata',
       );
       scanner.addScopedEnhancersMetadata();
 
-      expect(addEnhancerMetadataSpy.called).to.be.true;
-      expect(addEnhancerMetadataSpy.calledWith(instance)).to.be.true;
+      expect(addEnhancerMetadataControllerSpy.called).to.be.true;
+      expect(addEnhancerMetadataControllerSpy.calledWith(instance)).to.be.true;
+      expect(addEnhancerMetadataProviderSpy.called).to.be.true;
+      expect(addEnhancerMetadataProviderSpy.calledWith(instance)).to.be.true;
     });
   });
 
@@ -399,7 +649,7 @@ describe('DependenciesScanner', () => {
     describe(`when token is ${APP_INTERCEPTOR}`, () => {
       it('call "addGlobalInterceptor"', () => {
         const addSpy = sinon.spy(
-          (scanner as any).applicationConfig,
+          untypedScanner.applicationConfig,
           'addGlobalInterceptor',
         );
         scanner.getApplyProvidersMap()[APP_INTERCEPTOR](null);
@@ -409,7 +659,7 @@ describe('DependenciesScanner', () => {
     describe(`when token is ${APP_GUARD}`, () => {
       it('call "addGlobalGuard"', () => {
         const addSpy = sinon.spy(
-          (scanner as any).applicationConfig,
+          untypedScanner.applicationConfig,
           'addGlobalGuard',
         );
         scanner.getApplyProvidersMap()[APP_GUARD](null);
@@ -419,7 +669,7 @@ describe('DependenciesScanner', () => {
     describe(`when token is ${APP_PIPE}`, () => {
       it('call "addGlobalPipe"', () => {
         const addSpy = sinon.spy(
-          (scanner as any).applicationConfig,
+          untypedScanner.applicationConfig,
           'addGlobalPipe',
         );
         scanner.getApplyProvidersMap()[APP_PIPE](null);
@@ -429,7 +679,7 @@ describe('DependenciesScanner', () => {
     describe(`when token is ${APP_FILTER}`, () => {
       it('call "addGlobalFilter"', () => {
         const addSpy = sinon.spy(
-          (scanner as any).applicationConfig,
+          untypedScanner.applicationConfig,
           'addGlobalFilter',
         );
         scanner.getApplyProvidersMap()[APP_FILTER](null);
@@ -441,7 +691,7 @@ describe('DependenciesScanner', () => {
     describe(`when token is ${APP_INTERCEPTOR}`, () => {
       it('call "addGlobalRequestInterceptor"', () => {
         const addSpy = sinon.spy(
-          (scanner as any).applicationConfig,
+          untypedScanner.applicationConfig,
           'addGlobalRequestInterceptor',
         );
         scanner.getApplyRequestProvidersMap()[APP_INTERCEPTOR](null);
@@ -451,7 +701,7 @@ describe('DependenciesScanner', () => {
     describe(`when token is ${APP_GUARD}`, () => {
       it('call "addGlobalRequestGuard"', () => {
         const addSpy = sinon.spy(
-          (scanner as any).applicationConfig,
+          untypedScanner.applicationConfig,
           'addGlobalRequestGuard',
         );
         scanner.getApplyRequestProvidersMap()[APP_GUARD](null);
@@ -461,7 +711,7 @@ describe('DependenciesScanner', () => {
     describe(`when token is ${APP_PIPE}`, () => {
       it('call "addGlobalRequestPipe"', () => {
         const addSpy = sinon.spy(
-          (scanner as any).applicationConfig,
+          untypedScanner.applicationConfig,
           'addGlobalRequestPipe',
         );
         scanner.getApplyRequestProvidersMap()[APP_PIPE](null);
@@ -471,7 +721,7 @@ describe('DependenciesScanner', () => {
     describe(`when token is ${APP_FILTER}`, () => {
       it('call "addGlobalRequestFilter"', () => {
         const addSpy = sinon.spy(
-          (scanner as any).applicationConfig,
+          untypedScanner.applicationConfig,
           'addGlobalRequestFilter',
         );
         scanner.getApplyRequestProvidersMap()[APP_FILTER](null);
@@ -480,16 +730,22 @@ describe('DependenciesScanner', () => {
     });
   });
   describe('scanForModules', () => {
-    it('should throw an exception when the imports array includes undefined', () => {
+    it('should throw an exception when the imports array includes undefined', async () => {
       try {
-        scanner.scanForModules(UndefinedModule, [UndefinedModule]);
+        await scanner.scanForModules({
+          moduleDefinition: UndefinedModule,
+          scope: [UndefinedModule],
+        });
       } catch (exception) {
         expect(exception instanceof UndefinedModuleException).to.be.true;
       }
     });
-    it('should throw an exception when the imports array includes an invalid value', () => {
+    it('should throw an exception when the imports array includes an invalid value', async () => {
       try {
-        scanner.scanForModules(InvalidModule, [InvalidModule]);
+        await scanner.scanForModules({
+          moduleDefinition: InvalidModule,
+          scope: [InvalidModule],
+        });
       } catch (exception) {
         expect(exception instanceof InvalidModuleException).to.be.true;
       }
diff --git a/packages/core/test/services/reflector.service.spec.ts b/packages/core/test/services/reflector.service.spec.ts
index 20e7b5102..000c931ad 100644
--- a/packages/core/test/services/reflector.service.spec.ts
+++ b/packages/core/test/services/reflector.service.spec.ts
@@ -1,69 +1,201 @@
 import { expect } from 'chai';
 import { Reflector } from '../../services/reflector.service';
 
+const transformDecorator = Reflector.createDecorator<string[], number>({
+  transform: value => value.length,
+});
+
+type TestObject = {
+  only1?: string;
+  only2?: string;
+  both: string;
+};
+
 describe('Reflector', () => {
+  const key = 'key';
   let reflector: Reflector;
+
+  @transformDecorator(['a', 'b', 'c'])
+  class TestTransform {}
   class Test {}
+  class Test1 {}
+  class Test2 {}
+
   beforeEach(() => {
+    Reflect.deleteMetadata(key, Test1);
+    Reflect.deleteMetadata(key, Test2);
     reflector = new Reflector();
   });
+
   describe('get', () => {
-    it('should reflect metadata', () => {
-      const key = 'key';
+    it('should reflect metadata by key', () => {
       const value = 'value';
-      Reflect.defineMetadata(key, value, Test);
-      expect(reflector.get(key, Test)).to.eql(value);
+      Reflect.defineMetadata(key, value, Test1);
+      expect(reflector.get(key, Test1)).to.eql(value);
+    });
+
+    it('should reflect metadata by decorator', () => {
+      const decorator = Reflector.createDecorator<string>();
+      const value = 'value';
+      Reflect.defineMetadata(decorator.KEY, value, Test1);
+
+      // string
+      let reflectedValue = reflector.get(decorator, Test1);
+      expect(reflectedValue).to.eql(value);
+
+      // @ts-expect-error 'value' is not assignable to parameter of type 'string'
+      reflectedValue = true;
+
+      reflectedValue satisfies string;
+    });
+
+    it('should reflect metadata by decorator (custom key)', () => {
+      const decorator = Reflector.createDecorator<string[]>({ key: 'custom' });
+      const value = ['value'];
+      Reflect.defineMetadata('custom', value, Test1);
+
+      // string[]
+      let reflectedValue = reflector.get(decorator, Test1);
+      expect(reflectedValue).to.eql(value);
+
+      // @ts-expect-error 'value' is not assignable to parameter of type 'string[]'
+      reflectedValue = true;
+
+      reflectedValue satisfies string[];
+    });
+
+    it('should reflect metadata by decorator (with transform option)', () => {
+      let reflectedValue = reflector.get(transformDecorator, TestTransform);
+      expect(reflectedValue).to.eql(3);
+
+      // @ts-expect-error 'value' is not assignable to type 'number'
+      reflectedValue = [];
+
+      reflectedValue satisfies number;
+    });
+
+    it('should require transform option when second generic type is provided', () => {
+      // @ts-expect-error Property 'transform' is missing in type {} but required in type
+      const decorator = Reflector.createDecorator<string[], number>({});
     });
   });
 
   describe('getAll', () => {
-    it('should reflect metadata of all targets', () => {
-      const key = 'key';
-      const value = 'value';
-      Reflect.defineMetadata(key, value, Test);
-      expect(reflector.getAll(key, [Test])).to.eql([value]);
+    it('should reflect metadata of all targets by key', () => {
+      const value1 = 'value1';
+      const value2 = 'value2';
+      Reflect.defineMetadata(key, value1, Test1);
+      Reflect.defineMetadata(key, value2, Test2);
+      expect(reflector.getAll(key, [Test1, Test2])).to.eql([value1, value2]);
+    });
+    it('should reflect metadata of all targets by decorator', () => {
+      const decorator = Reflector.createDecorator<string>();
+      const value1 = 'value1';
+      const value2 = 'value2';
+      Reflect.defineMetadata(decorator.KEY, value1, Test1);
+      Reflect.defineMetadata(decorator.KEY, value2, Test2);
+
+      // string[]
+      const reflectedValue = reflector.getAll(decorator, [Test1, Test2]);
+      expect(reflectedValue).to.eql([value1, value2]);
+
+      reflectedValue satisfies string[];
     });
   });
 
   describe('getAllAndMerge', () => {
     it('should return an empty array when there are no targets', () => {
-      const key = 'key';
       expect(reflector.getAllAndMerge(key, [])).to.be.empty;
     });
     it('should reflect metadata of all targets and concat arrays', () => {
-      const key = 'key';
+      const decorator = Reflector.createDecorator<string[]>();
       const value = 'value';
-      Reflect.defineMetadata(key, [value], Test);
-      expect(reflector.getAllAndMerge(key, [Test, Test])).to.eql([
-        value,
-        value,
+      Reflect.defineMetadata(decorator.KEY, [value], Test1);
+
+      // string[]
+      const reflectedValue = reflector.getAllAndMerge(decorator, [
+        Test1,
+        Test1,
       ]);
+      expect(reflectedValue).to.eql([value, value]);
+
+      reflectedValue satisfies string[];
+    });
+    it('should reflect metadata of all targets and concat boolean arrays', () => {
+      const decorator = Reflector.createDecorator<boolean>();
+      const value = true;
+      Reflect.defineMetadata(decorator.KEY, [value], Test1);
+
+      // string[]
+      const reflectedValue = reflector.getAllAndMerge(decorator, [
+        Test1,
+        Test1,
+      ]);
+      expect(reflectedValue).to.eql([value, value]);
+
+      reflectedValue satisfies boolean[];
     });
     it('should reflect metadata of all targets and create an array', () => {
-      const key = 'key';
+      const decorator = Reflector.createDecorator<string>();
       const value = 'value';
-      Reflect.defineMetadata(key, value, Test);
-      expect(reflector.getAllAndMerge(key, [Test, Test])).to.eql([
-        value,
-        value,
+      Reflect.defineMetadata(decorator.KEY, value, Test1);
+
+      // string[]
+      const reflectedValue = reflector.getAllAndMerge(decorator, [
+        Test1,
+        Test1,
       ]);
+      expect(reflectedValue).to.eql([value, value]);
+
+      reflectedValue satisfies string[];
     });
-    it('should reflect metadata of all targets and merge an object', () => {
-      const key = 'key';
-      const value = { test: 'test' };
-      Reflect.defineMetadata(key, value, Test);
-      expect(reflector.getAllAndMerge(key, [Test, Test])).to.eql({
-        ...value,
+    it('should reflect metadata of all targets and merge objects', () => {
+      const decorator = Reflector.createDecorator<TestObject>();
+      const value1: TestObject = { only1: 'test1', both: 'overriden' };
+      const value2: TestObject = { only2: 'test2', both: 'test' };
+      Reflect.defineMetadata(decorator.KEY, value1, Test1);
+      Reflect.defineMetadata(decorator.KEY, value2, Test2);
+
+      // TestObject
+      const reflectedValue = reflector.getAllAndMerge(decorator, [
+        Test1,
+        Test2,
+      ]);
+      expect(reflectedValue).to.eql({
+        ...value1,
+        ...value2,
       });
+
+      reflectedValue satisfies TestObject;
+    });
+    it('should reflect metadata of all targets and create an array from a single value', () => {
+      const value = 'value';
+      Reflect.defineMetadata(key, value, Test1);
+
+      const result = reflector.getAllAndMerge(key, [Test1, Test2]);
+      expect(result).to.eql([value]);
+
+      result satisfies string[];
+    });
+    it('should reflect metadata of all targets and return a single array unmodified', () => {
+      const value = ['value'];
+      Reflect.defineMetadata(key, value, Test1);
+      expect(reflector.getAllAndMerge(key, [Test1, Test2])).to.eql(value);
+    });
+    it('should reflect metadata of all targets and return a single object unmodified', () => {
+      const value = { test: 'value' };
+      Reflect.defineMetadata(key, value, Test1);
+      expect(reflector.getAllAndMerge(key, [Test1, Test2])).to.eql(value);
     });
   });
 
   describe('getAllAndOverride', () => {
     it('should reflect metadata of all targets and return a first not undefined value', () => {
-      const key = 'key';
-      const value = 'value';
-      Reflect.defineMetadata(key, value, Test);
-      expect(reflector.getAllAndOverride(key, [Test, Test])).to.eql(value);
+      const value1 = 'value1';
+      const value2 = 'value2';
+      Reflect.defineMetadata(key, value1, Test1);
+      Reflect.defineMetadata(key, value2, Test2);
+      expect(reflector.getAllAndOverride(key, [Test1, Test2])).to.eql(value1);
     });
   });
 });
diff --git a/packages/core/test/tsconfig.json b/packages/core/test/tsconfig.json
new file mode 100644
index 000000000..50d59661d
--- /dev/null
+++ b/packages/core/test/tsconfig.json
@@ -0,0 +1,3 @@
+{
+  "extends": "../../../tsconfig.spec.json"
+}
diff --git a/packages/core/test/utils/noop-adapter.spec.ts b/packages/core/test/utils/noop-adapter.spec.ts
index c2e73d09f..274b6e5d0 100644
--- a/packages/core/test/utils/noop-adapter.spec.ts
+++ b/packages/core/test/utils/noop-adapter.spec.ts
@@ -1,4 +1,5 @@
-import { RequestMethod } from '@nestjs/common';
+import { RequestMethod, VersioningOptions } from '@nestjs/common';
+import { VersionValue } from '@nestjs/common/interfaces';
 import { AbstractHttpAdapter } from '../../adapters';
 
 export class NoopHttpAdapter extends AbstractHttpAdapter {
@@ -13,16 +14,29 @@ export class NoopHttpAdapter extends AbstractHttpAdapter {
   getRequestMethod(request: any): any {}
   getRequestUrl(request: any): any {}
   reply(response: any, body: any): any {}
+  end(response: any, message?: any): any {}
   status(response: any, statusCode: number): any {}
   render(response: any, view: string, options: any): any {}
   redirect(response: any, statusCode: number, url: string) {}
   setErrorHandler(handler: Function, prefix = '/'): any {}
   setNotFoundHandler(handler: Function, prefix = '/'): any {}
+  isHeadersSent(response: any): any {}
+  getHeader?(response: any, name: string) {}
   setHeader(response: any, name: string, value: string): any {}
+  appendHeader?(response: any, name: string, value: string) {}
   registerParserMiddleware(): any {}
   enableCors(options: any): any {}
   createMiddlewareFactory(requestMethod: RequestMethod): any {}
   getType() {
     return '';
   }
+  applyVersionFilter(
+    handler: Function,
+    version: VersionValue,
+    versioningOptions: VersioningOptions,
+  ) {
+    return (req, res, next) => {
+      return () => {};
+    };
+  }
 }
diff --git a/packages/core/tsconfig.build.json b/packages/core/tsconfig.build.json
new file mode 100644
index 000000000..99c13372d
--- /dev/null
+++ b/packages/core/tsconfig.build.json
@@ -0,0 +1,21 @@
+{
+  "extends": "../tsconfig.build.json",
+  "compilerOptions": {
+    "outDir": ".",
+    "rootDir": ".",
+    "paths": {
+      "@nestjs/common": ["../common"],
+      "@nestjs/common/*": ["../common/*"],
+      "@nestjs/microservices": ["../microservices"],
+      "@nestjs/microservices/*": ["../microservices/*"],
+      "@nestjs/websockets": ["../websockets"],
+      "@nestjs/websockets/*": ["../websockets/*"]
+    }
+  },
+  "exclude": ["node_modules", "dist", "test/**/*", "*.spec.ts"],
+  "references": [
+    {
+      "path": "../common/tsconfig.build.json"
+    }
+  ]
+}
diff --git a/packages/core/tsconfig.json b/packages/core/tsconfig.json
index b238080a4..2ae9e3c90 100644
--- a/packages/core/tsconfig.json
+++ b/packages/core/tsconfig.json
@@ -1,7 +1,13 @@
 {
-  "extends": "./../tsconfig.base.json",
+  "extends": "../tsconfig.build.json",
   "compilerOptions": {
-    "baseUrl": "./"
+    "types": ["node"]
   },
-  "include": ["*.ts", "**/*.ts"]
+  "files": [],
+  "include": [],
+  "references": [
+    {
+      "path": "./tsconfig.build.json"
+    }
+  ]
 }
diff --git a/packages/index.ts b/packages/index.ts
deleted file mode 100644
index f12c2a5d1..000000000
--- a/packages/index.ts
+++ /dev/null
@@ -1,6 +0,0 @@
-/*
- * Nest
- * Copyright(c) 2017 - 2021 Kamil Mysliwiec
- * https://nestjs.com
- * MIT Licensed
- */
diff --git a/packages/microservices/CHANGELOG.md b/packages/microservices/CHANGELOG.md
deleted file mode 100644
index f455b343b..000000000
--- a/packages/microservices/CHANGELOG.md
+++ /dev/null
@@ -1,18 +0,0 @@
-# Change Log
-
-All notable changes to this project will be documented in this file.
-See [Conventional Commits](https://conventionalcommits.org) for commit guidelines.
-
-<a name="8.2.0"></a>
-# [8.2.0](https://github.com/nestjs/nest/compare/v8.1.2...v8.2.0) (2021-11-08)
-
-
-### Bug Fixes
-
-* **microservices:** npm run format ([fdf11a5](https://github.com/nestjs/nest/commit/fdf11a5))
-
-
-### Features
-
-* **microservices:** adds packageDefinition option to ClientGrpc ([76f2918](https://github.com/nestjs/nest/commit/76f2918)), closes [#8457](https://github.com/nestjs/nest/issues/8457)
-* **microservices:** removes [@grpc](https://github.com/grpc)/grpc-js import ([3b74293](https://github.com/nestjs/nest/commit/3b74293))
diff --git a/packages/microservices/Readme.md b/packages/microservices/Readme.md
index 85a8c2535..4cac0d5ea 100644
--- a/packages/microservices/Readme.md
+++ b/packages/microservices/Readme.md
@@ -1,17 +1,16 @@
 <p align="center">
-  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
+  <a href="https://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
 </p>
 
 [circleci-image]: https://img.shields.io/circleci/build/github/nestjs/nest/master?token=abc123def456
 [circleci-url]: https://circleci.com/gh/nestjs/nest
 
-  <p align="center">A progressive <a href="http://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>
+  <p align="center">A progressive <a href="https://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>
     <p align="center">
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/v/@nestjs/core.svg" alt="NPM Version" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
 <a href="https://circleci.com/gh/nestjs/nest" target="_blank"><img src="https://img.shields.io/circleci/build/github/nestjs/nest/master" alt="CircleCI" /></a>
-<a href="https://coveralls.io/github/nestjs/nest?branch=master" target="_blank"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#9" alt="Coverage" /></a>
 <a href="https://discord.gg/G7Qnnhy" target="_blank"><img src="https://img.shields.io/badge/discord-online-brightgreen.svg" alt="Discord"/></a>
 <a href="https://opencollective.com/nest#backer" target="_blank"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
 <a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
@@ -24,21 +23,21 @@
 
 ## Description
 
-Nest is a framework for building efficient, scalable <a href="http://nodejs.org" target="_blank">Node.js</a> server-side applications. It uses modern JavaScript, is built with  <a href="http://www.typescriptlang.org" target="_blank">TypeScript</a> (preserves compatibility with pure JavaScript) and combines elements of OOP (Object Oriented Programming), FP (Functional Programming), and FRP (Functional Reactive Programming).
+Nest is a framework for building efficient, scalable <a href="https://nodejs.org" target="_blank">Node.js</a> server-side applications. It uses modern JavaScript, is built with <a href="https://www.typescriptlang.org" target="_blank">TypeScript</a> (preserves compatibility with pure JavaScript) and combines elements of OOP (Object Oriented Programming), FP (Functional Programming), and FRP (Functional Reactive Programming).
 
-<p>Under the hood, Nest makes use of <a href="https://expressjs.com/" target="_blank">Express</a>, but also, provides compatibility with a wide range of other libraries, like e.g. <a href="https://github.com/fastify/fastify" target="_blank">Fastify</a>, allowing for easy use of the myriad third-party plugins which are available.</p>
+<p>Under the hood, Nest makes use of <a href="https://expressjs.com/" target="_blank">Express</a>, but also provides compatibility with a wide range of other libraries, like <a href="https://github.com/fastify/fastify" target="_blank">Fastify</a>, allowing for easy use of the myriad of third-party plugins which are available.</p>
 
 ## Philosophy
 
-<p>In recent years, thanks to Node.js, JavaScript has become the ‚Äúlingua franca‚Äù of the web for both front and backend applications, giving rise to awesome projects like <a href="https://angular.io/" target="_blank">Angular</a>, <a href="https://github.com/facebook/react" target="_blank">React</a> and <a href="https://github.com/vuejs/vue" target="_blank">Vue</a> which improve developer productivity and enable the construction of fast, testable, extensible frontend applications. However, on the server-side, while there are a lot of superb libraries, helpers and tools for Node, none of them effectively solve the main problem - the architecture.</p>
-<p>Nest aims to provide an application architecture out of the box which allows for effortless creation of highly testable, scalable, loosely coupled and easily maintainable applications. The architecture is heavily inspired by Angular.</p>
+<p>In recent years, thanks to Node.js, JavaScript has become the ‚Äúlingua franca‚Äù of the web for both front and backend applications, giving rise to awesome projects like <a href="https://angular.io/" target="_blank">Angular</a>, <a href="https://github.com/facebook/react" target="_blank">React</a>, and <a href="https://github.com/vuejs/vue" target="_blank">Vue</a>, which improve developer productivity and enable the construction of fast, testable, and extensible frontend applications. However, on the server-side, while there are a lot of superb libraries, helpers, and tools for Node, none of them effectively solve the main problem - the architecture.</p>
+<p>Nest aims to provide an application architecture out of the box which allows for effortless creation of highly testable, scalable, and loosely coupled and easily maintainable applications. The architecture is heavily inspired by Angular.</p>
 
 ## Getting started
 
-* To check out the [guide](https://docs.nestjs.com), visit [docs.nestjs.com](https://docs.nestjs.com). :books:
-* Ë¶ÅÊü•Áúã‰∏≠Êñá [ÊåáÂçó](readme_zh.md), ËØ∑ËÆøÈóÆ [docs.nestjs.cn](https://docs.nestjs.cn). :books:
-* [Í∞ÄÏù¥Îìú](readme_kr.md)Î•º ÌôïÏù∏ÌïòÎ†§Î©¥, [docs.nestjs.com](https://docs.nestjs.com)Î•º Î∞©Î¨∏ÌïòÏÑ∏Ïöî.:books: 
-* „ÉÅ„Çß„ÉÉ„ÇØ„Åô„Çã„Å´„ÅØ [„Ç¨„Ç§„Éâ](readme_jp.md), Ë©≥„Åó„Åè„ÅØ [docs.nestjs.com](https://docs.nestjs.com). :books: 
+- To check out the [guide](https://docs.nestjs.com), visit [docs.nestjs.com](https://docs.nestjs.com). :books:
+- Ë¶ÅÊü•Áúã‰∏≠Êñá [ÊåáÂçó](readme_zh.md), ËØ∑ËÆøÈóÆ [docs.nestjs.cn](https://docs.nestjs.cn). :books:
+- [Í∞ÄÏù¥Îìú](readme_kr.md) Î¨∏ÏÑúÎäî [docs.nestjs.com](https://docs.nestjs.com)ÏóêÏÑú ÌôïÏù∏ÌïòÏã§ Ïàò ÏûàÏäµÎãàÎã§. :books:
+- [„Ç¨„Ç§„Éâ](readme_jp.md)„ÅØ [docs.nestjs.com](https://docs.nestjs.com)„Åß„ÅîÁ¢∫Ë™ç„Åè„Å†„Åï„ÅÑ„ÄÇ :books:
 
 ## Questions
 
@@ -54,71 +53,88 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
-<table style="text-align:center;"><tr>
-  <td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
-  <td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/red-hat-logo.svg" width="200" valign="middle" /></a></td>
-<td>
-<a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
-<td>
-<a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
-</tr></table>
+
+<table style="text-align:center;">
+<tr>
+<td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
+<td><a href="https://microsoft.com/" target="_blank"><img src="https://nestjs.com/img/logos/microsoft-logo.png" width="180" valign="middle" /></a></td>
+<td><a href="https://mojam.co" target="_blank"><img src="https://nestjs.com/img/logos/mojam-logo.png" width="80" valign="middle" /></a></td>
+<td><a href="https://marblism.com?utm_source=nest" target="_blank"><img src="https://nestjs.com/img/logos/marblism-logo.png" width="180" valign="middle" /></a></td>
+<td><a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
+<td><a href="https://amplication.com/" target="_blank"><img src="https://nestjs.com/img/logos/amplication-logo.svg" width="190" valign="middle" /></a></td>
+</tr>
+</table>
 
 #### Gold Sponsors
 
-<table style="text-align:center;"><tr><td>
-  <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
-  <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
-<td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
+<table style="text-align:center;">
+<tr>
+<td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/logos/red-hat-logo.svg" width="200" valign="middle" /></a></td>
+<td><a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
+<td><a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/logos/nx-logo.png" height="45" valign="middle" /></a></td>
+<td><a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/logos/intrinisic-logo.png" width="210" valign="middle" /></a></td>
+<td><a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/logos/jetbrains-logo.svg" width="90" valign="middle" /></a></td>
+</tr>
+<tr>
+<td><a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/logos/snyk-logo-black.png" width="185" valign="middle" /></a></td>
+<td><a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/logos/fuse-logo.svg" width="105" valign="middle" /></a></td>
+<td><a href="https://ridicorp.com/career/" target="_blank"><img src="https://nestjs.com/img/logos/ridi-logo.svg" width="105" valign="middle" /></a></td>
+<td><a href="https://www.movavi.com/imovie-for-windows.html" target="_blank"><img src="https://nestjs.com/img/logos/movavi-logo.svg" width="105" valign="middle" /></a></td>
+<td><a href="https://skunk.team" target="_blank"><img src="https://nestjs.com/img/logos/skunk-logo.png" height="60" valign="middle" /></a></td>
+</tr>
+</table>
 
 #### Silver Sponsors
 
-<table style="text-align:center;"><tr><td>
-<a href="https://neoteric.eu/" target="_blank"><img src="https://nestjs.com/img/neoteric-cut.png" width="120" valign="middle" /></a> </td><td>
-  <a href="http://gojob.com" target="_blank"><img src="http://nestjs.com/img/gojob-logo.png" valign="middle" width="100" /></a> </td><td>
-<a href="https://www.myleodsc.com/" target="_blank"><img src="https://nestjs.com/img/myleo-logo.png" width="180" valign="middle" /></td><td>
-<a href="https://careers.meetdandy.com/?gh_src=063ba61e3us" target="_blank"><img src="https://nestjs.com/img/dandy-roles-logo.svg" width="150" valign="middle" /></td><td>
-<a href="https://www.castlecraft.in" target="_blank"><img src="https://nestjs.com/img/castlecraft-logo.png" width="150" valign="middle" /></td>
-<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td></tr></table>
+<table style="text-align:center;">
+<tr>
+<td><a href="https://www.mercedes-benz.com/" target="_blank"><img src="https://nestjs.com/img/logos/mercedes-logo.png" width="100" valign="middle" /></a></td>
+<td><a href="https://www.dinii.jp/" target="_blank"><img src="https://nestjs.com/img/logos/dinii-logo.png" width="65" valign="middle" /></a></td>
+<td><a href="https://bloodycase.com/?promocode=NEST" target="_blank"><img src="https://nestjs.com/img/logos/bloodycase-logo.png" width="65" valign="middle" /></a></td>
+<td><a href="https://handsontable.com/docs/react-data-grid/?utm_source=NestJS_GH&utm_medium=sponsorship&utm_campaign=library_sponsorship_2024" target="_blank"><img src="https://nestjs.com/img/logos/handsontable-dark-logo.svg#2" width="150" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.itflashcards.com/" target="_blank"><img src="https://nestjs.com/img/logos/it_flashcards-logo.png" width="170" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://arcjet.com/?ref=nestjs" target="_blank"><img src="https://nestjs.com/img/logos/arcjet-logo.svg" width="170" valign="middle" /></a></td>
+</tr>
+</table>
 
 #### Sponsors
 
-<table><tr><td align="center" valign="middle">
-<a href="https://www.swingdev.io" target="_blank"><img src="https://nestjs.com/img/swingdev-logo.svg#1" width="110" valign="middle" /> </a></td><td align="center" valign="middle">
-<a href="https://www.novologic.com/" target="_blank"><img src="https://nestjs.com/img/novologic.png" width="110" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://ever.co/" target="_blank"><img src="https://nestjs.com/img/ever-logo.png" width="72" valign="middle" /></a>  </td><td align="center" valign="middle">
-<a href="https://blokt.com" target="_blank"><img src="https://nestjs.com/img/blokt-logo.png" width="120" valign="middle" /></a>  </td><td align="center" valign="middle"> 
-  <a href="http://architectnow.net/" target="_blank"><img src="https://nestjs.com/img/architectnow.png" width="125" valign="middle" /></a> </td><td align="center" valign="middle">
-  <a href="https://quander.io/" target="_blank"><img src="https://nestjs.com/img/quander.png" width="100" valign="middle" /></a> </td></tr><tr><td align="center" valign="middle">
-  <a href="https://mantro.net/" target="_blank"><img src="https://nestjs.com/img/mantro-logo.svg" width="95" valign="middle" /></a> </td><td align="center" valign="middle">
-  <a href="https://triplebyte.com/" target="_blank"><img src="https://nestjs.com/img/triplebyte.png" width="107" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://reposit.co.uk/" target="_blank"><img src="https://nestjs.com/img/reposit-logo.png" width="71" valign="middle" /></a></td><td align="center" valign="middle">
-<a href="https://nearpod.com/" target="_blank"><img src="https://nestjs.com/img/nearpod-logo.svg" width="100" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://clay.global/" target="_blank"><img src="https://nestjs.com/img/clay-logo.svg" width="75" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://firesticktricks.com" target="_blank"><img src="https://nestjs.com/img/firesticktricks-logo.png" width="120" valign="middle" /></a></td></tr><tr><td align="center" valign="middle">
-<a href="https://www.codeguesser.co.uk" target="_blank"><img src="https://nestjs.com/img/codeguesser-logo.svg" width="120" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://f-a.nz/" target="_blank"><img src="https://nestjs.com/img/franz.svg" width="80" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://sparkfabrik.com/" target="_blank"><img src="https://nestjs.com/img/sparkfabrik-logo.png" width="120" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://www.thebigphonestore.co.uk/" target="_blank"><img src="https://nestjs.com/img/the-big-phone-store-logo.png" width="65" valign="middle" /></a></td>
-  <td align="center" valign="middle">
-  <a href="https://genuinebee.com/" target="_blank"><img src="https://nestjs.com/img/genuinebee.svg" width="97" valign="middle" /></a> </td>
-<td align="center" valign="middle"><a href="https://sanyodigital.com/" target="_blank"><img src="https://nestjs.com/img/sanyo-digital.png" width="130" valign="middle" /></a></td></tr><tr><td align="center" valign="middle"><a href="https://vpn-review.com/vpn-for-torrenting" target="_blank"><img src="https://nestjs.com/img/vpn-review-logo.png" width="85" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://lambda-it.ch/" target="_blank"><img src="https://nestjs.com/img/lambda-it-logo.svg" width="115" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://pickwriters.com/top-10-translation-services" target="_blank"><img src="https://nestjs.com/img/pickwriters-logo.png" width="40" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://thewordpoint.com/services/localization" target="_blank"><img src="https://nestjs.com/img/thewordpoint-logo.png" width="40" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://meercode.io/" target="_blank"><img src="https://nestjs.com/img/meercode-logo.png" width="60" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://www.najlepszeplatformyforex.pl/blog/broker-xtb/" target="_blank"><img src="https://nestjs.com/img/npf-logo.jpg" width="200" valign="middle" /></a></td></tr><tr>
-<td align="center" valign="middle"><a href="https://thestandarddaily.com/" target="_blank"><img src="https://nestjs.com/img/the-standard-daily-logo.png" width="180" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://houseofangular.io/" target="_blank"><img src="https://nestjs.com/img/house-of-angular.png" width="100" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://rocketech.it/cases/?utm_source=google&utm_medium=badge&utm_campaign=nestjs" target="_blank"><img src="https://nestjs.com/img/rocketech-logo.svg" width="110" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://www.bystored.com/" target="_blank"><img src="https://nestjs.com/img/stored-logo.svg" width="110" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://studyclerk.com/pay-for-research-paper" target="_blank"><img src="https://nestjs.com/img/studyclerk-logo.png" width="125" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://xyndata.com" target="_blank"><img src="https://nestjs.com/img/xyndata-logo.png" width="125" valign="middle" /></a></td></tr><tr>
-  <td align="center" valign="middle"><a href="https://www.anonymistic.com/" target="_blank"><img src="https://nestjs.com/img/anonymistic-logo.png" width="125" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/naologic-logo.svg" width="125" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://messaged.com/" target="_blank"><img src="https://nestjs.com/img/messaged-logo.png" width="50" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/triplecore-logo.svg" width="50" valign="middle" /></a></td>
-  </tr></table>
+<table>
+<tr>
+<td align="center" valign="middle"><a href="https://www.swingdev.io" target="_blank"><img src="https://nestjs.com/img/logos/swingdev-logo.svg#1" width="110" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.novologic.com/" target="_blank"><img src="https://nestjs.com/img/logos/novologic.png" width="110" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://mantro.net/" target="_blank"><img src="https://nestjs.com/img/logos/mantro-logo.svg" width="95" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://triplebyte.com/" target="_blank"><img src="https://nestjs.com/img/logos/triplebyte.png" width="107" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://nearpod.com/" target="_blank"><img src="https://nestjs.com/img/logos/nearpod-logo.svg" width="100" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://genuinebee.com/" target="_blank"><img src="https://nestjs.com/img/logos/genuinebee.svg" width="97" valign="middle" /></a></td>
+</tr>
+<tr>
+<td align="center" valign="middle"><a href="https://vpn-review.com/vpn-for-torrenting" target="_blank"><img src="https://nestjs.com/img/logos/vpn-review-logo.png" width="85" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://lambda-it.ch/" target="_blank"><img src="https://nestjs.com/img/logos/lambda-it-logo.svg" width="115" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://rocketech.it/cases/?utm_source=google&utm_medium=badge&utm_campaign=nestjs" target="_blank"><img src="https://nestjs.com/img/logos/rocketech-logo.svg" width="110" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.anonymistic.com/" target="_blank"><img src="https://nestjs.com/img/logos/anonymistic-logo.png" width="125" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/logos/naologic-logo.svg" width="125" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/logos/triplecore-logo.svg" width="50" valign="middle" /></a></td>
+</tr>
+<tr>
+<td align="center" valign="middle"><a href="https://thecasinowizard.com/bonuses/no-deposit-bonuses/" target="_blank"><img src="https://nestjs.com/img/logos/casinowizard-logo.png" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://polygon-software.ch/" target="_blank"><img src="https://nestjs.com/img/logos/polygon-logo.svg" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/logos/boringowl-logo.svg" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://nordbot.app/" target="_blank"><img src="https://nestjs.com/img/logos/nordbot-logo.png" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://doppio.sh/" target="_blank"><img src="https://nestjs.com/img/logos/dopiosh-logo.png" width="50" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.hingehealth.com/" target="_blank"><img src="https://nestjs.com/img/logos/hinge-health-logo.svg" width="100" valign="middle" /></a></td>
+</tr>
+<tr>
+<td align="center" valign="middle"><a href="https://julienferand.dev/" target="_blank"><img src="https://nestjs.com/img/logos/julienferand-logo.jpeg" width="55" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.tripoffice.com/" target="_blank"><img src="https://nestjs.com/img/logos/tripoffice-logo.png" width="140" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://solcellsforetag.se/" target="_blank"><img src="https://nestjs.com/img/logos/solcellsforetag-logo.svg" width="140" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.route4me.com/" target="_blank"><img src="https://nestjs.com/img/logos/route4me-logo.svg" width="100" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.slotsup.com/" target="_blank"><img src="https://nestjs.com/img/logos/slotsup-logo.png" width="60" valign="middle" /></a></td>
+</tr>
+</table>
 
 ## Backers
 
@@ -126,9 +142,9 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 
 ## Stay in touch
 
-* Author - [Kamil My≈õliwiec](https://twitter.com/kammysliwiec)
-* Website - [https://nestjs.com](https://nestjs.com/)
-* Twitter - [@nestframework](https://twitter.com/nestframework)
+- Author - [Kamil My≈õliwiec](https://x.com/kammysliwiec)
+- Website - [https://nestjs.com](https://nestjs.com/)
+- X - [@nestframework](https://x.com/nestframework)
 
 ## License
 
diff --git a/packages/microservices/client/client-grpc.ts b/packages/microservices/client/client-grpc.ts
index 298a9e152..d0ae9e41c 100644
--- a/packages/microservices/client/client-grpc.ts
+++ b/packages/microservices/client/client-grpc.ts
@@ -6,21 +6,44 @@ import { GRPC_DEFAULT_PROTO_LOADER, GRPC_DEFAULT_URL } from '../constants';
 import { InvalidGrpcPackageException } from '../errors/invalid-grpc-package.exception';
 import { InvalidGrpcServiceException } from '../errors/invalid-grpc-service.exception';
 import { InvalidProtoDefinitionException } from '../errors/invalid-proto-definition.exception';
+import { ChannelOptions } from '../external/grpc-options.interface';
+import { getGrpcPackageDefinition } from '../helpers';
 import { ClientGrpc, GrpcOptions } from '../interfaces';
 import { ClientProxy } from './client-proxy';
-import { GRPC_CANCELLED } from './constants';
-import { ChannelOptions } from '../external/grpc-options.interface';
-
-let grpcPackage: any = {};
-let grpcProtoLoaderPackage: any = {};
 
-export class ClientGrpcProxy extends ClientProxy implements ClientGrpc {
+const GRPC_CANCELLED = 'Cancelled';
+
+// To enable type safety for gRPC. This cant be uncommented by default
+// because it would require the user to install the @grpc/grpc-js package even if they dont use gRPC
+// Otherwise, TypeScript would fail to compile the code.
+//
+// type GrpcClient = import('@grpc/grpc-js').Client;
+// let grpcPackage = {} as typeof import('@grpc/grpc-js');
+// let grpcProtoLoaderPackage = {} as typeof import('@grpc/proto-loader');
+
+type GrpcClient = any;
+let grpcPackage = {} as any;
+let grpcProtoLoaderPackage = {} as any;
+
+/**
+ * @publicApi
+ */
+export class ClientGrpcProxy
+  extends ClientProxy<never, never>
+  implements ClientGrpc
+{
   protected readonly logger = new Logger(ClientProxy.name);
   protected readonly clients = new Map<string, any>();
   protected readonly url: string;
-  protected grpcClients = [];
+  protected grpcClients: GrpcClient[] = [];
+
+  get status(): never {
+    throw new Error(
+      'The "status" attribute is not supported by the gRPC transport',
+    );
+  }
 
-  constructor(protected readonly options: GrpcOptions['options']) {
+  constructor(protected readonly options: Required<GrpcOptions>['options']) {
     super();
     this.url = this.getOptionsProp(options, 'url') || GRPC_DEFAULT_URL;
 
@@ -42,19 +65,18 @@ export class ClientGrpcProxy extends ClientProxy implements ClientGrpc {
     this.grpcClients = this.createClients();
   }
 
-  public getService<T extends {}>(name: string): T {
+  public getService<T extends object>(name: string): T {
     const grpcClient = this.createClientByServiceName(name);
     const clientRef = this.getClient(name);
     if (!clientRef) {
-      throw new InvalidGrpcServiceException();
+      throw new InvalidGrpcServiceException(name);
     }
 
     const protoMethods = Object.keys(clientRef[name].prototype);
     const grpcService = {} as T;
 
     protoMethods.forEach(m => {
-      const key = m[0].toLowerCase() + m.slice(1, m.length);
-      grpcService[key] = this.createServiceMethod(grpcClient, m);
+      grpcService[m] = this.createServiceMethod(grpcClient, m);
     });
     return grpcService;
   }
@@ -66,7 +88,7 @@ export class ClientGrpcProxy extends ClientProxy implements ClientGrpc {
   public createClientByServiceName(name: string) {
     const clientRef = this.getClient(name);
     if (!clientRef) {
-      throw new InvalidGrpcServiceException();
+      throw new InvalidGrpcServiceException(name);
     }
 
     const channelOptions: ChannelOptions =
@@ -144,10 +166,10 @@ export class ClientGrpcProxy extends ClientProxy implements ClientGrpc {
     methodName: string,
   ): (...args: any[]) => Observable<any> {
     return (...args: any[]) => {
-      const isRequestStream = client[methodName].requestStream;
+      const isRequestStream = client![methodName].requestStream;
       const stream = new Observable(observer => {
         let isClientCanceled = false;
-        let upstreamSubscription: Subscription;
+        let upstreamSubscription: Subscription | null = null;
 
         const upstreamSubjectOrData = args[0];
         const maybeMetadata = args[1];
@@ -157,8 +179,8 @@ export class ClientGrpcProxy extends ClientProxy implements ClientGrpc {
 
         const call =
           isRequestStream && isUpstreamSubject
-            ? client[methodName](maybeMetadata)
-            : client[methodName](...args);
+            ? client![methodName](maybeMetadata)
+            : client![methodName](...args);
 
         if (isRequestStream && isUpstreamSubject) {
           upstreamSubscription = upstreamSubjectOrData.subscribe(
@@ -175,7 +197,7 @@ export class ClientGrpcProxy extends ClientProxy implements ClientGrpc {
               return;
             }
           }
-          observer.error(error);
+          observer.error(this.serializeError(error));
         });
         call.on('end', () => {
           if (upstreamSubscription) {
@@ -214,10 +236,17 @@ export class ClientGrpcProxy extends ClientProxy implements ClientGrpc {
 
       if (isRequestStream && isUpstreamSubject) {
         return new Observable(observer => {
+          let isClientCanceled = false;
           const callArgs = [
-            (error: unknown, data: unknown) => {
+            (error: any, data: unknown) => {
               if (error) {
-                return observer.error(error);
+                if (error.details === GRPC_CANCELLED || error.code === 1) {
+                  call.destroy();
+                  if (isClientCanceled) {
+                    return;
+                  }
+                }
+                return observer.error(this.serializeError(error));
               }
               observer.next(data);
               observer.complete();
@@ -238,17 +267,27 @@ export class ClientGrpcProxy extends ClientProxy implements ClientGrpc {
 
           return () => {
             upstreamSubscription.unsubscribe();
+            if (!call.finished) {
+              isClientCanceled = true;
+              call.cancel();
+            }
           };
         });
       }
       return new Observable(observer => {
-        client[methodName](...args, (error: any, data: any) => {
+        const call = client[methodName](...args, (error: any, data: any) => {
           if (error) {
-            return observer.error(error);
+            return observer.error(this.serializeError(error));
           }
           observer.next(data);
           observer.complete();
         });
+
+        return () => {
+          if (!call.finished) {
+            call.cancel();
+          }
+        };
       });
     };
   }
@@ -256,7 +295,7 @@ export class ClientGrpcProxy extends ClientProxy implements ClientGrpc {
   public createClients(): any[] {
     const grpcContext = this.loadProto();
     const packageOption = this.getOptionsProp(this.options, 'package');
-    const grpcPackages = [];
+    const grpcPackages: any[] = [];
     const packageNames = Array.isArray(packageOption)
       ? packageOption
       : [packageOption];
@@ -265,7 +304,9 @@ export class ClientGrpcProxy extends ClientProxy implements ClientGrpc {
       const grpcPkg = this.lookupPackage(grpcContext, packageName);
 
       if (!grpcPkg) {
-        const invalidPackageError = new InvalidGrpcPackageException();
+        const invalidPackageError = new InvalidGrpcPackageException(
+          packageName,
+        );
         this.logger.error(
           invalidPackageError.message,
           invalidPackageError.stack,
@@ -279,18 +320,13 @@ export class ClientGrpcProxy extends ClientProxy implements ClientGrpc {
 
   public loadProto(): any {
     try {
-      const file = this.getOptionsProp(this.options, 'protoPath');
-      const loader = this.getOptionsProp(this.options, 'loader');
-
-      const packageDefinition =
-        this.getOptionsProp(this.options, 'packageDefinition') ||
-        grpcProtoLoaderPackage.loadSync(file, loader);
-
-      const packageObject =
-        grpcPackage.loadPackageDefinition(packageDefinition);
-      return packageObject;
+      const packageDefinition = getGrpcPackageDefinition(
+        this.options,
+        grpcProtoLoaderPackage,
+      );
+      return grpcPackage.loadPackageDefinition(packageDefinition);
     } catch (err) {
-      const invalidProtoError = new InvalidProtoDefinitionException();
+      const invalidProtoError = new InvalidProtoDefinitionException(err.path);
       const message =
         err && err.message ? err.message : invalidProtoError.message;
 
@@ -313,9 +349,12 @@ export class ClientGrpcProxy extends ClientProxy implements ClientGrpc {
   }
 
   public close() {
-    this.grpcClients
-      .filter(client => client && isFunction(client.close))
-      .forEach(client => client.close());
+    this.clients.forEach(client => {
+      if (client && isFunction(client.close)) {
+        client.close();
+      }
+    });
+    this.clients.clear();
     this.grpcClients = [];
   }
 
@@ -333,7 +372,9 @@ export class ClientGrpcProxy extends ClientProxy implements ClientGrpc {
   }
 
   protected getClient(name: string): any {
-    return this.grpcClients.find(client => client.hasOwnProperty(name));
+    return this.grpcClients.find(client =>
+      Object.hasOwnProperty.call(client, name),
+    );
   }
 
   protected publish(packet: any, callback: (packet: any) => any): any {
@@ -347,4 +388,15 @@ export class ClientGrpcProxy extends ClientProxy implements ClientGrpc {
       'Method is not supported in gRPC mode. Use ClientGrpc instead (learn more in the documentation).',
     );
   }
+
+  public on<EventKey extends never = never, EventCallback = any>(
+    event: EventKey,
+    callback: EventCallback,
+  ) {
+    throw new Error('Method is not supported in gRPC mode.');
+  }
+
+  public unwrap<T>(): T {
+    throw new Error('Method is not supported in gRPC mode.');
+  }
 }
diff --git a/packages/microservices/client/client-kafka.ts b/packages/microservices/client/client-kafka.ts
index 1900336e4..eaffbca55 100644
--- a/packages/microservices/client/client-kafka.ts
+++ b/packages/microservices/client/client-kafka.ts
@@ -1,6 +1,14 @@
 import { Logger } from '@nestjs/common/services/logger.service';
 import { loadPackage } from '@nestjs/common/utils/load-package.util';
-import { isUndefined } from '@nestjs/common/utils/shared.utils';
+import { isNil, isUndefined } from '@nestjs/common/utils/shared.utils';
+import {
+  throwError as _throw,
+  connectable,
+  defer,
+  Observable,
+  Subject,
+} from 'rxjs';
+import { mergeMap } from 'rxjs/operators';
 import {
   KAFKA_DEFAULT_BROKER,
   KAFKA_DEFAULT_CLIENT,
@@ -9,6 +17,8 @@ import {
 import { KafkaResponseDeserializer } from '../deserializers/kafka-response.deserializer';
 import { KafkaHeaders } from '../enums';
 import { InvalidKafkaClientTopicException } from '../errors/invalid-kafka-client-topic.exception';
+import { InvalidMessageException } from '../errors/invalid-message.exception';
+import { KafkaStatus } from '../events';
 import {
   BrokersFunction,
   Consumer,
@@ -19,6 +29,7 @@ import {
   KafkaConfig,
   KafkaMessage,
   Producer,
+  TopicPartitionOffsetAndMetadata,
 } from '../external/kafka.interface';
 import {
   KafkaLogger,
@@ -26,7 +37,9 @@ import {
   KafkaReplyPartitionAssigner,
 } from '../helpers';
 import {
+  ClientKafkaProxy,
   KafkaOptions,
+  MsPattern,
   OutgoingEvent,
   ReadPacket,
   WritePacket,
@@ -39,28 +52,63 @@ import { ClientProxy } from './client-proxy';
 
 let kafkaPackage: any = {};
 
-export class ClientKafka extends ClientProxy {
+/**
+ * @publicApi
+ */
+export class ClientKafka
+  extends ClientProxy<never, KafkaStatus>
+  implements ClientKafkaProxy
+{
   protected logger = new Logger(ClientKafka.name);
-  protected client: Kafka = null;
-  protected consumer: Consumer = null;
-  protected producer: Producer = null;
-  protected parser: KafkaParser = null;
+  protected client: Kafka | null = null;
+  protected parser: KafkaParser | null = null;
+  protected initialized: Promise<void> | null = null;
   protected responsePatterns: string[] = [];
   protected consumerAssignments: { [key: string]: number } = {};
-
   protected brokers: string[] | BrokersFunction;
   protected clientId: string;
   protected groupId: string;
+  protected producerOnlyMode: boolean;
+  protected _consumer: Consumer | null = null;
+  protected _producer: Producer | null = null;
+
+  get consumer(): Consumer {
+    if (!this._consumer) {
+      throw new Error(
+        'No consumer initialized. Please, call the "connect" method first.',
+      );
+    }
+    return this._consumer;
+  }
 
-  constructor(protected readonly options: KafkaOptions['options']) {
+  get producer(): Producer {
+    if (!this._producer) {
+      throw new Error(
+        'No producer initialized. Please, call the "connect" method first.',
+      );
+    }
+    return this._producer;
+  }
+
+  constructor(protected readonly options: Required<KafkaOptions>['options']) {
     super();
 
-    const clientOptions =
-      this.getOptionsProp(this.options, 'client') || ({} as KafkaConfig);
-    const consumerOptions =
-      this.getOptionsProp(this.options, 'consumer') || ({} as ConsumerConfig);
-    const postfixId =
-      this.getOptionsProp(this.options, 'postfixId') || '-client';
+    const clientOptions = this.getOptionsProp(
+      this.options,
+      'client',
+      {} as KafkaConfig,
+    );
+    const consumerOptions = this.getOptionsProp(
+      this.options,
+      'consumer',
+      {} as ConsumerConfig,
+    );
+    const postfixId = this.getOptionsProp(this.options, 'postfixId', '-client');
+    this.producerOnlyMode = this.getOptionsProp(
+      this.options,
+      'producerOnlyMode',
+      false,
+    );
 
     this.brokers = clientOptions.brokers || [KAFKA_DEFAULT_BROKER];
 
@@ -80,64 +128,86 @@ export class ClientKafka extends ClientProxy {
     this.initializeDeserializer(options);
   }
 
-  public subscribeToResponseOf(pattern: any): void {
-    const request = this.normalizePattern(pattern);
+  public subscribeToResponseOf(pattern: unknown): void {
+    const request = this.normalizePattern(pattern as MsPattern);
     this.responsePatterns.push(this.getResponsePatternName(request));
   }
 
   public async close(): Promise<void> {
-    this.producer && (await this.producer.disconnect());
-    this.consumer && (await this.consumer.disconnect());
-    this.producer = null;
-    this.consumer = null;
+    this._producer && (await this._producer.disconnect());
+    this._consumer && (await this._consumer.disconnect());
+    this._producer = null;
+    this._consumer = null;
+    this.initialized = null;
     this.client = null;
   }
 
   public async connect(): Promise<Producer> {
-    if (this.client) {
-      return this.producer;
+    if (this.initialized) {
+      return this.initialized.then(() => this._producer!);
     }
-    this.client = this.createClient();
-
-    const partitionAssigners = [
-      (config: ConstructorParameters<typeof KafkaReplyPartitionAssigner>[1]) =>
-        new KafkaReplyPartitionAssigner(this, config),
-    ] as any[];
-
-    const consumerOptions = Object.assign(
-      {
-        partitionAssigners,
-      },
-      this.options.consumer || {},
-      {
-        groupId: this.groupId,
-      },
-    );
-    this.producer = this.client.producer(this.options.producer || {});
-    this.consumer = this.client.consumer(consumerOptions);
-
-    // set member assignments on join and rebalance
-    this.consumer.on(
-      this.consumer.events.GROUP_JOIN,
-      this.setConsumerAssignments.bind(this),
-    );
-
-    await this.producer.connect();
-    await this.consumer.connect();
-    await this.bindTopics();
-    return this.producer;
+    /* eslint-disable-next-line no-async-promise-executor */
+    this.initialized = new Promise(async (resolve, reject) => {
+      try {
+        this.client = this.createClient();
+        if (!this.producerOnlyMode) {
+          const partitionAssigners = [
+            (
+              config: ConstructorParameters<
+                typeof KafkaReplyPartitionAssigner
+              >[1],
+            ) => new KafkaReplyPartitionAssigner(this, config),
+          ];
+
+          const consumerOptions = Object.assign(
+            {
+              partitionAssigners,
+            },
+            this.options.consumer || {},
+            {
+              groupId: this.groupId,
+            },
+          );
+
+          this._consumer = this.client!.consumer(consumerOptions);
+          this.registerConsumerEventListeners();
+
+          // Set member assignments on join and rebalance
+          this._consumer.on(
+            this._consumer.events.GROUP_JOIN,
+            this.setConsumerAssignments.bind(this),
+          );
+          await this._consumer.connect();
+          await this.bindTopics();
+        }
+
+        this._producer = this.client!.producer(this.options.producer || {});
+        this.registerProducerEventListeners();
+        await this._producer.connect();
+
+        resolve();
+      } catch (err) {
+        reject(err);
+      }
+    });
+    return this.initialized.then(() => this._producer!);
   }
 
   public async bindTopics(): Promise<void> {
+    if (!this._consumer) {
+      throw Error('No consumer initialized');
+    }
+
     const consumerSubscribeOptions = this.options.subscribe || {};
-    const subscribeTo = async (responsePattern: string) =>
-      this.consumer.subscribe({
-        topic: responsePattern,
+
+    if (this.responsePatterns.length > 0) {
+      await this._consumer.subscribe({
         ...consumerSubscribeOptions,
+        topics: this.responsePatterns,
       });
-    await Promise.all(this.responsePatterns.map(subscribeTo));
+    }
 
-    await this.consumer.run(
+    await this._consumer.run(
       Object.assign(this.options.run || {}, {
         eachMessage: this.createResponseCallback(),
       }),
@@ -156,13 +226,13 @@ export class ClientKafka extends ClientProxy {
 
   public createResponseCallback(): (payload: EachMessagePayload) => any {
     return async (payload: EachMessagePayload) => {
-      const rawMessage = this.parser.parse<KafkaMessage>(
+      const rawMessage = this.parser!.parse<KafkaMessage>(
         Object.assign(payload.message, {
           topic: payload.topic,
           partition: payload.partition,
         }),
       );
-      if (isUndefined(rawMessage.headers[KafkaHeaders.CORRELATION_ID])) {
+      if (isUndefined(rawMessage.headers![KafkaHeaders.CORRELATION_ID])) {
         return;
       }
       const { err, response, isDisposed, id } =
@@ -189,9 +259,112 @@ export class ClientKafka extends ClientProxy {
     return this.consumerAssignments;
   }
 
-  protected dispatchEvent(packet: OutgoingEvent): Promise<any> {
+  public emitBatch<TResult = any, TInput = any>(
+    pattern: any,
+    data: { messages: TInput[] },
+  ): Observable<TResult> {
+    if (isNil(pattern) || isNil(data)) {
+      return _throw(() => new InvalidMessageException());
+    }
+    const source = defer(async () => this.connect()).pipe(
+      mergeMap(() => this.dispatchBatchEvent({ pattern, data })),
+    );
+    const connectableSource = connectable(source, {
+      connector: () => new Subject(),
+      resetOnDisconnect: false,
+    });
+    connectableSource.connect();
+    return connectableSource;
+  }
+
+  public commitOffsets(
+    topicPartitions: TopicPartitionOffsetAndMetadata[],
+  ): Promise<void> {
+    if (this._consumer) {
+      return this._consumer.commitOffsets(topicPartitions);
+    } else {
+      throw new Error('No consumer initialized');
+    }
+  }
+
+  public unwrap<T>(): T {
+    if (!this.client) {
+      throw new Error(
+        'Not initialized. Please call the "connect" method first.',
+      );
+    }
+    return this.client as T;
+  }
+
+  public on<
+    EventKey extends string | number | symbol = string | number | symbol,
+    EventCallback = any,
+  >(event: EventKey, callback: EventCallback) {
+    throw new Error('Method is not supported for Kafka client');
+  }
+
+  protected registerConsumerEventListeners() {
+    if (!this._consumer) {
+      return;
+    }
+    this._consumer.on(this._consumer.events.CONNECT, () =>
+      this._status$.next(KafkaStatus.CONNECTED),
+    );
+    this._consumer.on(this._consumer.events.DISCONNECT, () =>
+      this._status$.next(KafkaStatus.DISCONNECTED),
+    );
+    this._consumer.on(this._consumer.events.REBALANCING, () =>
+      this._status$.next(KafkaStatus.REBALANCING),
+    );
+    this._consumer.on(this._consumer.events.STOP, () =>
+      this._status$.next(KafkaStatus.STOPPED),
+    );
+    this.consumer.on(this._consumer.events.CRASH, () =>
+      this._status$.next(KafkaStatus.CRASHED),
+    );
+  }
+
+  protected registerProducerEventListeners() {
+    if (!this._producer) {
+      return;
+    }
+    this._producer.on(this._producer.events.CONNECT, () =>
+      this._status$.next(KafkaStatus.CONNECTED),
+    );
+    this._producer.on(this._producer.events.DISCONNECT, () =>
+      this._status$.next(KafkaStatus.DISCONNECTED),
+    );
+  }
+
+  protected async dispatchBatchEvent<TInput = any>(
+    packets: ReadPacket<{ messages: TInput[] }>,
+  ): Promise<any> {
+    if (packets.data.messages.length === 0) {
+      return;
+    }
+    const pattern = this.normalizePattern(packets.pattern);
+    const outgoingEvents = await Promise.all(
+      packets.data.messages.map(message => {
+        return this.serializer.serialize(message as any, { pattern });
+      }),
+    );
+
+    const message = Object.assign(
+      {
+        topic: pattern,
+        messages: outgoingEvents,
+      },
+      this.options.send || {},
+    );
+
+    return this.producer.send(message);
+  }
+
+  protected async dispatchEvent(packet: OutgoingEvent): Promise<any> {
     const pattern = this.normalizePattern(packet.pattern);
-    const outgoingEvent = this.serializer.serialize(packet.data);
+    const outgoingEvent = await this.serializer.serialize(packet.data, {
+      pattern,
+    });
     const message = Object.assign(
       {
         topic: pattern,
@@ -199,7 +372,8 @@ export class ClientKafka extends ClientProxy {
       },
       this.options.send || {},
     );
-    return this.producer.send(message);
+
+    return this._producer!.send(message);
   }
 
   protected getReplyTopicPartition(topic: string): string {
@@ -208,7 +382,7 @@ export class ClientKafka extends ClientProxy {
       throw new InvalidKafkaClientTopicException(topic);
     }
 
-    // get the minimum partition
+    // Get the minimum partition
     return minimumPartition.toString();
   }
 
@@ -216,33 +390,43 @@ export class ClientKafka extends ClientProxy {
     partialPacket: ReadPacket,
     callback: (packet: WritePacket) => any,
   ): () => void {
+    const packet = this.assignPacketId(partialPacket);
+    this.routingMap.set(packet.id, callback);
+
+    const cleanup = () => this.routingMap.delete(packet.id);
+    const errorCallback = (err: unknown) => {
+      cleanup();
+      callback({ err });
+    };
+
     try {
-      const packet = this.assignPacketId(partialPacket);
       const pattern = this.normalizePattern(partialPacket.pattern);
       const replyTopic = this.getResponsePatternName(pattern);
       const replyPartition = this.getReplyTopicPartition(replyTopic);
 
-      const serializedPacket: KafkaRequest = this.serializer.serialize(
-        packet.data,
-      );
-      serializedPacket.headers[KafkaHeaders.CORRELATION_ID] = packet.id;
-      serializedPacket.headers[KafkaHeaders.REPLY_TOPIC] = replyTopic;
-      serializedPacket.headers[KafkaHeaders.REPLY_PARTITION] = replyPartition;
-
-      this.routingMap.set(packet.id, callback);
-
-      const message = Object.assign(
-        {
-          topic: pattern,
-          messages: [serializedPacket],
-        },
-        this.options.send || {},
-      );
-      this.producer.send(message).catch(err => callback({ err }));
-
-      return () => this.routingMap.delete(packet.id);
+      Promise.resolve(this.serializer.serialize(packet.data, { pattern }))
+        .then((serializedPacket: KafkaRequest) => {
+          serializedPacket.headers[KafkaHeaders.CORRELATION_ID] = packet.id;
+          serializedPacket.headers[KafkaHeaders.REPLY_TOPIC] = replyTopic;
+          serializedPacket.headers[KafkaHeaders.REPLY_PARTITION] =
+            replyPartition;
+
+          const message = Object.assign(
+            {
+              topic: pattern,
+              messages: [serializedPacket],
+            },
+            this.options.send || {},
+          );
+
+          return this._producer!.send(message);
+        })
+        .catch(err => errorCallback(err));
+
+      return cleanup;
     } catch (err) {
-      callback({ err });
+      errorCallback(err);
+      return () => null;
     }
   }
 
@@ -253,13 +437,13 @@ export class ClientKafka extends ClientProxy {
   protected setConsumerAssignments(data: ConsumerGroupJoinEvent): void {
     const consumerAssignments: { [key: string]: number } = {};
 
-    // only need to set the minimum
-    Object.keys(data.payload.memberAssignment).forEach(memberId => {
-      const minimumPartition = Math.min(
-        ...data.payload.memberAssignment[memberId],
-      );
+    // Only need to set the minimum
+    Object.keys(data.payload.memberAssignment).forEach(topic => {
+      const memberPartitions = data.payload.memberAssignment[topic];
 
-      consumerAssignments[memberId] = minimumPartition;
+      if (memberPartitions.length) {
+        consumerAssignments[topic] = Math.min(...memberPartitions);
+      }
     });
 
     this.consumerAssignments = consumerAssignments;
diff --git a/packages/microservices/client/client-mqtt.ts b/packages/microservices/client/client-mqtt.ts
index 4a20ebf97..6d3a49a74 100644
--- a/packages/microservices/client/client-mqtt.ts
+++ b/packages/microservices/client/client-mqtt.ts
@@ -1,16 +1,9 @@
 import { Logger } from '@nestjs/common/services/logger.service';
-import { isObject } from '@nestjs/common/utils/shared.utils';
 import { loadPackage } from '@nestjs/common/utils/load-package.util';
 import { EmptyError, fromEvent, lastValueFrom, merge, Observable } from 'rxjs';
 import { first, map, share, tap } from 'rxjs/operators';
-import {
-  CLOSE_EVENT,
-  ECONNREFUSED,
-  ERROR_EVENT,
-  MESSAGE_EVENT,
-  MQTT_DEFAULT_URL,
-} from '../constants';
-import { MqttClient } from '../external/mqtt-client.interface';
+import { ECONNREFUSED, ENOTFOUND, MQTT_DEFAULT_URL } from '../constants';
+import { MqttEvents, MqttEventsMap, MqttStatus } from '../events/mqtt.events';
 import { MqttOptions, ReadPacket, WritePacket } from '../interfaces';
 import {
   MqttRecord,
@@ -21,16 +14,32 @@ import { ClientProxy } from './client-proxy';
 
 let mqttPackage: any = {};
 
-export class ClientMqtt extends ClientProxy {
+// To enable type safety for MQTT. This cant be uncommented by default
+// because it would require the user to install the mqtt package even if they dont use MQTT
+// Otherwise, TypeScript would fail to compile the code.
+//
+type MqttClient = import('mqtt').MqttClient;
+// type MqttClient = any;
+
+/**
+ * @publicApi
+ */
+export class ClientMqtt extends ClientProxy<MqttEvents, MqttStatus> {
   protected readonly logger = new Logger(ClientProxy.name);
   protected readonly subscriptionsCount = new Map<string, number>();
   protected readonly url: string;
-  protected mqttClient: MqttClient;
-  protected connection: Promise<any>;
+  protected mqttClient: MqttClient | null = null;
+  protected connectionPromise: Promise<any> | null = null;
+  protected isInitialConnection = false;
+  protected isReconnecting = false;
+  protected pendingEventListeners: Array<{
+    event: keyof MqttEvents;
+    callback: MqttEvents[keyof MqttEvents];
+  }> = [];
 
-  constructor(protected readonly options: MqttOptions['options']) {
+  constructor(protected readonly options: Required<MqttOptions>['options']) {
     super();
-    this.url = this.getOptionsProp(this.options, 'url') || MQTT_DEFAULT_URL;
+    this.url = this.getOptionsProp(this.options, 'url') ?? MQTT_DEFAULT_URL;
 
     mqttPackage = loadPackage('mqtt', ClientMqtt.name, () => require('mqtt'));
 
@@ -46,41 +55,54 @@ export class ClientMqtt extends ClientProxy {
     return `${pattern}/reply`;
   }
 
-  public close() {
-    this.mqttClient && this.mqttClient.end();
+  public async close() {
+    if (this.mqttClient) {
+      await this.mqttClient.endAsync();
+    }
     this.mqttClient = null;
-    this.connection = null;
+    this.connectionPromise = null;
+    this.pendingEventListeners = [];
   }
 
   public connect(): Promise<any> {
     if (this.mqttClient) {
-      return this.connection;
+      return this.connectionPromise!;
     }
     this.mqttClient = this.createClient();
-    this.handleError(this.mqttClient);
+    this.registerErrorListener(this.mqttClient);
+    this.registerOfflineListener(this.mqttClient);
+    this.registerReconnectListener(this.mqttClient);
+    this.registerConnectListener(this.mqttClient);
+    this.registerDisconnectListener(this.mqttClient);
+    this.registerCloseListener(this.mqttClient);
+
+    this.pendingEventListeners.forEach(({ event, callback }) =>
+      this.mqttClient!.on(event, callback),
+    );
+    this.pendingEventListeners = [];
 
     const connect$ = this.connect$(this.mqttClient);
-    this.connection = lastValueFrom(
-      this.mergeCloseEvent(this.mqttClient, connect$).pipe(
-        tap(() =>
-          this.mqttClient.on(MESSAGE_EVENT, this.createResponseCallback()),
-        ),
-        share(),
-      ),
+    this.connectionPromise = lastValueFrom(
+      this.mergeCloseEvent(this.mqttClient, connect$).pipe(share()),
     ).catch(err => {
       if (err instanceof EmptyError) {
         return;
       }
       throw err;
     });
-    return this.connection;
+    return this.connectionPromise;
   }
 
   public mergeCloseEvent<T = any>(
     instance: MqttClient,
     source$: Observable<T>,
   ): Observable<T> {
-    const close$ = fromEvent(instance, CLOSE_EVENT).pipe(
+    const close$ = fromEvent(instance, MqttEventsMap.CLOSE).pipe(
+      tap({
+        next: () => {
+          this._status$.next(MqttStatus.CLOSED);
+        },
+      }),
       map((err: any) => {
         throw err;
       }),
@@ -92,11 +114,81 @@ export class ClientMqtt extends ClientProxy {
     return mqttPackage.connect(this.url, this.options as MqttOptions);
   }
 
-  public handleError(client: MqttClient) {
-    client.addListener(
-      ERROR_EVENT,
-      (err: any) => err.code !== ECONNREFUSED && this.logger.error(err),
-    );
+  public registerErrorListener(client: MqttClient) {
+    client.on(MqttEventsMap.ERROR, (err: any) => {
+      if (err.code === ECONNREFUSED || err.code === ENOTFOUND) {
+        return;
+      }
+      this.logger.error(err);
+    });
+  }
+
+  public registerOfflineListener(client: MqttClient) {
+    client.on(MqttEventsMap.OFFLINE, () => {
+      this.connectionPromise = Promise.reject(
+        'Error: Connection lost. Trying to reconnect...',
+      );
+
+      // Prevent unhandled rejections
+      this.connectionPromise.catch(() => {});
+      this.logger.error('MQTT broker went offline.');
+    });
+  }
+
+  public registerReconnectListener(client: MqttClient) {
+    client.on(MqttEventsMap.RECONNECT, () => {
+      this.isReconnecting = true;
+      this._status$.next(MqttStatus.RECONNECTING);
+
+      this.logger.log('MQTT connection lost. Trying to reconnect...');
+    });
+  }
+
+  public registerDisconnectListener(client: MqttClient) {
+    client.on(MqttEventsMap.DISCONNECT, () => {
+      this._status$.next(MqttStatus.DISCONNECTED);
+    });
+  }
+
+  public registerCloseListener(client: MqttClient) {
+    client.on(MqttEventsMap.CLOSE, () => {
+      this._status$.next(MqttStatus.CLOSED);
+    });
+  }
+
+  public registerConnectListener(client: MqttClient) {
+    client.on(MqttEventsMap.CONNECT, () => {
+      this.isReconnecting = false;
+      this._status$.next(MqttStatus.CONNECTED);
+
+      this.logger.log('Connected to MQTT broker');
+      this.connectionPromise = Promise.resolve();
+
+      if (!this.isInitialConnection) {
+        this.isInitialConnection = true;
+        client.on('message', this.createResponseCallback());
+      }
+    });
+  }
+
+  public on<
+    EventKey extends keyof MqttEvents = keyof MqttEvents,
+    EventCallback extends MqttEvents[EventKey] = MqttEvents[EventKey],
+  >(event: EventKey, callback: EventCallback) {
+    if (this.mqttClient) {
+      this.mqttClient.on(event, callback as any);
+    } else {
+      this.pendingEventListeners.push({ event, callback });
+    }
+  }
+
+  public unwrap<T>(): T {
+    if (!this.mqttClient) {
+      throw new Error(
+        'Not initialized. Please call the "connect" method first.',
+      );
+    }
+    return this.mqttClient as T;
   }
 
   public createResponseCallback(): (channel: string, buffer: Buffer) => any {
@@ -130,8 +222,10 @@ export class ClientMqtt extends ClientProxy {
     try {
       const packet = this.assignPacketId(partialPacket);
       const pattern = this.normalizePattern(partialPacket.pattern);
-      const responseChannel = this.getResponsePattern(pattern);
+      const serializedPacket: ReadPacket & Partial<MqttRecord> =
+        this.serializer.serialize(packet);
 
+      const responseChannel = this.getResponsePattern(pattern);
       let subscriptionsCount =
         this.subscriptionsCount.get(responseChannel) || 0;
 
@@ -139,22 +233,19 @@ export class ClientMqtt extends ClientProxy {
         subscriptionsCount = this.subscriptionsCount.get(responseChannel) || 0;
         this.subscriptionsCount.set(responseChannel, subscriptionsCount + 1);
         this.routingMap.set(packet.id, callback);
-        const options =
-          isObject(packet?.data) && packet.data instanceof MqttRecord
-            ? (packet.data as MqttRecord)?.options
-            : undefined;
-        delete packet?.data?.options;
-        const serializedPacket: string | Buffer =
-          this.serializer.serialize(packet);
-        this.mqttClient.publish(
+
+        const options = serializedPacket.options;
+        delete serializedPacket.options;
+
+        this.mqttClient!.publish(
           this.getRequestPattern(pattern),
-          serializedPacket,
+          JSON.stringify(serializedPacket),
           this.mergePacketOptions(options),
         );
       };
 
       if (subscriptionsCount <= 0) {
-        this.mqttClient.subscribe(
+        this.mqttClient!.subscribe(
           responseChannel,
           (err: any) => !err && publishPacket(),
         );
@@ -168,23 +259,22 @@ export class ClientMqtt extends ClientProxy {
       };
     } catch (err) {
       callback({ err });
+      return () => {};
     }
   }
 
   protected dispatchEvent(packet: ReadPacket): Promise<any> {
     const pattern = this.normalizePattern(packet.pattern);
-    const options =
-      isObject(packet?.data) && packet.data instanceof MqttRecord
-        ? (packet.data as MqttRecord)?.options
-        : undefined;
-    delete packet?.data?.options;
+    const serializedPacket: ReadPacket & Partial<MqttRecord> =
+      this.serializer.serialize(packet);
 
-    const serializedPacket: string | Buffer = this.serializer.serialize(packet);
+    const options = serializedPacket.options;
+    delete serializedPacket.options;
 
     return new Promise<void>((resolve, reject) =>
-      this.mqttClient.publish(
+      this.mqttClient!.publish(
         pattern,
-        serializedPacket,
+        JSON.stringify(serializedPacket),
         this.mergePacketOptions(options),
         (err: any) => (err ? reject(err) : resolve()),
       ),
@@ -192,11 +282,11 @@ export class ClientMqtt extends ClientProxy {
   }
 
   protected unsubscribeFromChannel(channel: string) {
-    const subscriptionCount = this.subscriptionsCount.get(channel);
+    const subscriptionCount = this.subscriptionsCount.get(channel)!;
     this.subscriptionsCount.set(channel, subscriptionCount - 1);
 
     if (subscriptionCount - 1 <= 0) {
-      this.mqttClient.unsubscribe(channel);
+      this.mqttClient!.unsubscribe(channel);
     }
   }
 
@@ -211,15 +301,22 @@ export class ClientMqtt extends ClientProxy {
       return undefined;
     }
 
-    return {
-      ...requestOptions,
-      properties: {
-        ...requestOptions?.properties,
+    // Cant just spread objects as MQTT won't deliver
+    // any message with empty object as "userProperties" field
+    // @url https://github.com/nestjs/nest/issues/14079
+    let options: MqttRecordOptions = {};
+    if (requestOptions) {
+      options = { ...requestOptions };
+    }
+    if (this.options?.userProperties) {
+      options.properties = {
+        ...options.properties,
         userProperties: {
           ...this.options?.userProperties,
-          ...requestOptions?.properties?.userProperties,
+          ...options.properties?.userProperties,
         },
-      },
-    };
+      };
+    }
+    return options;
   }
 }
diff --git a/packages/microservices/client/client-nats.ts b/packages/microservices/client/client-nats.ts
index f85bf2e83..665666e3d 100644
--- a/packages/microservices/client/client-nats.ts
+++ b/packages/microservices/client/client-nats.ts
@@ -1,10 +1,11 @@
 import { Logger } from '@nestjs/common/services/logger.service';
 import { loadPackage } from '@nestjs/common/utils/load-package.util';
 import { isObject } from '@nestjs/common/utils/shared.utils';
+import { EventEmitter } from 'stream';
 import { NATS_DEFAULT_URL } from '../constants';
 import { NatsResponseJSONDeserializer } from '../deserializers/nats-response-json.deserializer';
 import { EmptyResponseException } from '../errors/empty-response.exception';
-import { Client, NatsMsg } from '../external/nats-client.interface';
+import { NatsEvents, NatsEventsMap, NatsStatus } from '../events/nats.events';
 import { NatsOptions, PacketId, ReadPacket, WritePacket } from '../interfaces';
 import { NatsRecord } from '../record-builders';
 import { NatsRecordSerializer } from '../serializers/nats-record.serializer';
@@ -12,11 +13,29 @@ import { ClientProxy } from './client-proxy';
 
 let natsPackage = {} as any;
 
-export class ClientNats extends ClientProxy {
+// To enable type safety for Nats. This cant be uncommented by default
+// because it would require the user to install the nats package even if they dont use Nats
+// Otherwise, TypeScript would fail to compile the code.
+//
+// type Client = import('nats').NatsConnection;
+// type NatsMsg = import('nats').Msg;
+
+type Client = Record<string, any>;
+type NatsMsg = Record<string, any>;
+
+/**
+ * @publicApi
+ */
+export class ClientNats extends ClientProxy<NatsEvents, NatsStatus> {
   protected readonly logger = new Logger(ClientNats.name);
-  protected natsClient: Client;
 
-  constructor(protected readonly options: NatsOptions['options']) {
+  protected natsClient: Client | null = null;
+  protected connectionPromise: Promise<Client> | null = null;
+  protected statusEventEmitter = new EventEmitter<{
+    [key in keyof NatsEvents]: Parameters<NatsEvents[key]>;
+  }>();
+
+  constructor(protected readonly options: Required<NatsOptions>['options']) {
     super();
     natsPackage = loadPackage('nats', ClientNats.name, () => require('nats'));
 
@@ -26,20 +45,29 @@ export class ClientNats extends ClientProxy {
 
   public async close() {
     await this.natsClient?.close();
+    this.statusEventEmitter.removeAllListeners();
+
     this.natsClient = null;
+    this.connectionPromise = null;
   }
 
   public async connect(): Promise<any> {
-    if (this.natsClient) {
-      return this.natsClient;
+    if (this.connectionPromise) {
+      return this.connectionPromise;
     }
-    this.natsClient = await this.createClient();
-    this.handleStatusUpdates(this.natsClient);
+    this.connectionPromise = this.createClient();
+    this.natsClient = await this.connectionPromise.catch(err => {
+      this.connectionPromise = null;
+      throw err;
+    });
+
+    this._status$.next(NatsStatus.CONNECTED);
+    void this.handleStatusUpdates(this.natsClient);
     return this.natsClient;
   }
 
   public createClient(): Promise<Client> {
-    const options: any = this.options || ({} as NatsOptions);
+    const options = this.options || ({} as NatsOptions);
     return natsPackage.connect({
       servers: NATS_DEFAULT_URL,
       ...options,
@@ -52,26 +80,94 @@ export class ClientNats extends ClientProxy {
         status.data && isObject(status.data)
           ? JSON.stringify(status.data)
           : status.data;
-      if (status.type === 'disconnect' || status.type === 'error') {
-        this.logger.error(
-          `NatsError: type: "${status.type}", data: "${data}".`,
-        );
-      } else {
-        const message = `NatsStatus: type: "${status.type}", data: "${data}".`;
-        if (status.type === 'pingTimer') {
-          this.logger.debug(message);
-        } else {
-          this.logger.log(message);
-        }
+
+      switch (status.type) {
+        case 'error':
+          this.logger.error(
+            `NatsError: type: "${status.type}", data: "${data}".`,
+          );
+          break;
+
+        case 'disconnect':
+          this.connectionPromise = Promise.reject(
+            'Error: Connection lost. Trying to reconnect...',
+          );
+          // Prevent unhandled promise rejection
+          this.connectionPromise.catch(() => {});
+
+          this.logger.error(
+            `NatsError: type: "${status.type}", data: "${data}".`,
+          );
+
+          this._status$.next(NatsStatus.DISCONNECTED);
+          this.statusEventEmitter.emit(
+            NatsEventsMap.DISCONNECT,
+            status.data as string,
+          );
+          break;
+
+        case 'reconnecting':
+          this._status$.next(NatsStatus.RECONNECTING);
+          break;
+
+        case 'reconnect':
+          this.connectionPromise = Promise.resolve(client);
+          this.logger.log(
+            `NatsStatus: type: "${status.type}", data: "${data}".`,
+          );
+
+          this._status$.next(NatsStatus.CONNECTED);
+          this.statusEventEmitter.emit(
+            NatsEventsMap.RECONNECT,
+            status.data as string,
+          );
+          break;
+
+        case 'pingTimer':
+          if (this.options.debug) {
+            this.logger.debug(
+              `NatsStatus: type: "${status.type}", data: "${data}".`,
+            );
+          }
+          break;
+
+        case 'update':
+          this.logger.log(
+            `NatsStatus: type: "${status.type}", data: "${data}".`,
+          );
+          this.statusEventEmitter.emit(NatsEventsMap.UPDATE, status.data);
+          break;
+
+        default:
+          this.logger.log(
+            `NatsStatus: type: "${status.type}", data: "${data}".`,
+          );
+          break;
       }
     }
   }
 
+  public on<
+    EventKey extends keyof NatsEvents = keyof NatsEvents,
+    EventCallback extends NatsEvents[EventKey] = NatsEvents[EventKey],
+  >(event: EventKey, callback: EventCallback) {
+    this.statusEventEmitter.on(event, callback as any);
+  }
+
+  public unwrap<T>(): T {
+    if (!this.natsClient) {
+      throw new Error(
+        'Not initialized. Please call the "connect" method first.',
+      );
+    }
+    return this.natsClient as T;
+  }
+
   public createSubscriptionHandler(
     packet: ReadPacket & PacketId,
     callback: (packet: WritePacket) => any,
   ) {
-    return async (error: unknown | undefined, natsMsg: NatsMsg) => {
+    return async (error: string | Error | undefined, natsMsg: NatsMsg) => {
       if (error) {
         return callback({
           err: error,
@@ -113,19 +209,19 @@ export class ClientNats extends ClientProxy {
       const packet = this.assignPacketId(partialPacket);
       const channel = this.normalizePattern(partialPacket.pattern);
       const serializedPacket: NatsRecord = this.serializer.serialize(packet);
-      const inbox = natsPackage.createInbox();
+      const inbox = natsPackage.createInbox(this.options.inboxPrefix);
 
       const subscriptionHandler = this.createSubscriptionHandler(
         packet,
         callback,
       );
 
-      const subscription = this.natsClient.subscribe(inbox, {
+      const subscription = this.natsClient!.subscribe(inbox, {
         callback: subscriptionHandler,
       });
 
       const headers = this.mergeHeaders(serializedPacket.headers);
-      this.natsClient.publish(channel, serializedPacket.data, {
+      this.natsClient!.publish(channel, serializedPacket.data, {
         reply: inbox,
         headers,
       });
@@ -133,6 +229,7 @@ export class ClientNats extends ClientProxy {
       return () => subscription.unsubscribe();
     } catch (err) {
       callback({ err });
+      return () => {};
     }
   }
 
@@ -143,7 +240,7 @@ export class ClientNats extends ClientProxy {
 
     return new Promise<void>((resolve, reject) => {
       try {
-        this.natsClient.publish(pattern, serializedPacket.data, {
+        this.natsClient!.publish(pattern, serializedPacket.data, {
           headers,
         });
         resolve();
diff --git a/packages/microservices/client/client-proxy-factory.ts b/packages/microservices/client/client-proxy-factory.ts
index f6bd89227..ab7abccb0 100644
--- a/packages/microservices/client/client-proxy-factory.ts
+++ b/packages/microservices/client/client-proxy-factory.ts
@@ -1,10 +1,10 @@
 import { Transport } from '../enums/transport.enum';
+import { ClientKafkaProxy } from '../interfaces';
 import {
   ClientOptions,
   CustomClientOptions,
   TcpClientOptions,
 } from '../interfaces/client-metadata.interface';
-import { Closeable } from '../interfaces/closeable.interface';
 import {
   GrpcOptions,
   KafkaOptions,
@@ -23,40 +23,54 @@ import { ClientRMQ } from './client-rmq';
 import { ClientTCP } from './client-tcp';
 
 export interface IClientProxyFactory {
-  create(clientOptions: ClientOptions): ClientProxy & Closeable;
+  create(clientOptions: ClientOptions): ClientProxy;
 }
 
+/**
+ * @publicApi
+ */
 export class ClientProxyFactory {
   public static create(
     clientOptions: { transport: Transport.GRPC } & ClientOptions,
   ): ClientGrpcProxy;
-  public static create(clientOptions: ClientOptions): ClientProxy & Closeable;
   public static create(
-    clientOptions: CustomClientOptions,
-  ): ClientProxy & Closeable;
+    clientOptions: { transport: Transport.KAFKA } & ClientOptions,
+  ): ClientKafkaProxy;
+  public static create(clientOptions: ClientOptions): ClientProxy;
+  public static create(clientOptions: CustomClientOptions): ClientProxy;
   public static create(
     clientOptions: ClientOptions | CustomClientOptions,
-  ): ClientProxy & Closeable {
+  ): ClientProxy | ClientGrpcProxy | ClientKafkaProxy {
     if (this.isCustomClientOptions(clientOptions)) {
       const { customClass, options } = clientOptions;
       return new customClass(options);
     }
-    const { transport, options } = clientOptions || {};
+    const { transport, options = {} } = clientOptions ?? { options: {} };
     switch (transport) {
       case Transport.REDIS:
-        return new ClientRedis(options as RedisOptions['options']);
+        return new ClientRedis(
+          options as Required<RedisOptions>['options'],
+        ) as ClientProxy;
       case Transport.NATS:
-        return new ClientNats(options as NatsOptions['options']);
+        return new ClientNats(
+          options as Required<NatsOptions>['options'],
+        ) as ClientProxy;
       case Transport.MQTT:
-        return new ClientMqtt(options as MqttOptions['options']);
+        return new ClientMqtt(
+          options as Required<MqttOptions>['options'],
+        ) as ClientProxy;
       case Transport.GRPC:
         return new ClientGrpcProxy(options as GrpcOptions['options']);
       case Transport.RMQ:
-        return new ClientRMQ(options as RmqOptions['options']);
+        return new ClientRMQ(
+          options as Required<RmqOptions>['options'],
+        ) as ClientProxy;
       case Transport.KAFKA:
-        return new ClientKafka(options as KafkaOptions['options']);
+        return new ClientKafka(options as Required<KafkaOptions>['options']);
       default:
-        return new ClientTCP(options as TcpClientOptions['options']);
+        return new ClientTCP(
+          options as Required<TcpClientOptions>['options'],
+        ) as ClientProxy;
     }
   }
 
diff --git a/packages/microservices/client/client-proxy.ts b/packages/microservices/client/client-proxy.ts
index bdd3484d7..e2d12463e 100644
--- a/packages/microservices/client/client-proxy.ts
+++ b/packages/microservices/client/client-proxy.ts
@@ -1,17 +1,17 @@
 import { randomStringGenerator } from '@nestjs/common/utils/random-string-generator.util';
 import { isNil } from '@nestjs/common/utils/shared.utils';
 import {
+  throwError as _throw,
   connectable,
   defer,
   fromEvent,
   merge,
   Observable,
   Observer,
+  ReplaySubject,
   Subject,
-  throwError as _throw,
 } from 'rxjs';
-import { map, mergeMap, take } from 'rxjs/operators';
-import { CONNECT_EVENT, ERROR_EVENT } from '../constants';
+import { distinctUntilChanged, map, mergeMap, take } from 'rxjs/operators';
 import { IncomingResponseDeserializer } from '../deserializers/incoming-response.deserializer';
 import { InvalidMessageException } from '../errors/invalid-message.exception';
 import {
@@ -32,14 +32,57 @@ import { ProducerSerializer } from '../interfaces/serializer.interface';
 import { IdentitySerializer } from '../serializers/identity.serializer';
 import { transformPatternToRoute } from '../utils';
 
-export abstract class ClientProxy {
-  public abstract connect(): Promise<any>;
-  public abstract close(): any;
-
+/**
+ * @publicApi
+ */
+export abstract class ClientProxy<
+  EventsMap extends Record<never, Function> = Record<never, Function>,
+  Status extends string = string,
+> {
   protected routingMap = new Map<string, Function>();
   protected serializer: ProducerSerializer;
   protected deserializer: ProducerDeserializer;
+  protected _status$ = new ReplaySubject<Status>(1);
+
+  /**
+   * Returns an observable that emits status changes.
+   */
+  public get status(): Observable<Status> {
+    return this._status$.asObservable().pipe(distinctUntilChanged());
+  }
 
+  /**
+   * Establishes the connection to the underlying server/broker.
+   */
+  public abstract connect(): Promise<any>;
+  /**
+   * Closes the underlying connection to the server/broker.
+   */
+  public abstract close(): any;
+  /**
+   * Registers an event listener for the given event.
+   * @param event Event name
+   * @param callback Callback to be executed when the event is emitted
+   */
+  public on<
+    EventKey extends keyof EventsMap = keyof EventsMap,
+    EventCallback extends EventsMap[EventKey] = EventsMap[EventKey],
+  >(event: EventKey, callback: EventCallback) {
+    throw new Error('Method not implemented.');
+  }
+  /**
+   * Returns an instance of the underlying server/broker instance,
+   * or a group of servers if there are more than one.
+   */
+  public abstract unwrap<T>(): T;
+
+  /**
+   * Send a message to the server/broker.
+   * Used for message-driven communication style between microservices.
+   * @param pattern Pattern to identify the message
+   * @param data Data to be sent
+   * @returns Observable with the result
+   */
   public send<TResult = any, TInput = any>(
     pattern: any,
     data: TInput,
@@ -58,6 +101,13 @@ export abstract class ClientProxy {
     );
   }
 
+  /**
+   * Emits an event to the server/broker.
+   * Used for event-driven communication style between microservices.
+   * @param pattern Pattern to identify the event
+   * @param data Data to be sent
+   * @returns Observable that completes when the event is successfully emitted
+   */
   public emit<TResult = any, TInput = any>(
     pattern: any,
     data: TInput,
@@ -114,8 +164,8 @@ export abstract class ClientProxy {
 
   protected connect$(
     instance: any,
-    errorEvent = ERROR_EVENT,
-    connectEvent = CONNECT_EVENT,
+    errorEvent = 'error',
+    connectEvent = 'connect',
   ): Observable<any> {
     const error$ = fromEvent(instance, errorEvent).pipe(
       map((err: any) => {
@@ -127,10 +177,28 @@ export abstract class ClientProxy {
   }
 
   protected getOptionsProp<
-    T extends ClientOptions['options'],
-    K extends keyof T,
-  >(obj: T, prop: K, defaultValue: T[K] = undefined) {
-    return (obj && obj[prop]) || defaultValue;
+    Options extends ClientOptions['options'],
+    Attribute extends keyof Options,
+  >(obj: Options, prop: Attribute): Options[Attribute];
+  protected getOptionsProp<
+    Options extends ClientOptions['options'],
+    Attribute extends keyof Options,
+    DefaultValue extends Options[Attribute] = Options[Attribute],
+  >(
+    obj: Options,
+    prop: Attribute,
+    defaultValue: DefaultValue,
+  ): Required<Options>[Attribute];
+  protected getOptionsProp<
+    Options extends ClientOptions['options'],
+    Attribute extends keyof Options,
+    DefaultValue extends Options[Attribute] = Options[Attribute],
+  >(
+    obj: Options,
+    prop: Attribute,
+    defaultValue: DefaultValue = undefined as DefaultValue,
+  ) {
+    return obj && prop in obj ? (obj as any)[prop] : defaultValue;
   }
 
   protected normalizePattern(pattern: MsPattern): string {
@@ -140,30 +208,26 @@ export abstract class ClientProxy {
   protected initializeSerializer(options: ClientOptions['options']) {
     this.serializer =
       (options &&
-        (
-          options as
-            | RedisOptions['options']
-            | NatsOptions['options']
-            | MqttOptions['options']
-            | TcpClientOptions['options']
-            | RmqOptions['options']
-            | KafkaOptions['options']
-        ).serializer) ||
+        (options as
+          | RedisOptions['options']
+          | NatsOptions['options']
+          | MqttOptions['options']
+          | TcpClientOptions['options']
+          | RmqOptions['options']
+          | KafkaOptions['options'])!.serializer) ||
       new IdentitySerializer();
   }
 
   protected initializeDeserializer(options: ClientOptions['options']) {
     this.deserializer =
       (options &&
-        (
-          options as
-            | RedisOptions['options']
-            | NatsOptions['options']
-            | MqttOptions['options']
-            | TcpClientOptions['options']
-            | RmqOptions['options']
-            | KafkaOptions['options']
-        ).deserializer) ||
+        (options as
+          | RedisOptions['options']
+          | NatsOptions['options']
+          | MqttOptions['options']
+          | TcpClientOptions['options']
+          | RmqOptions['options']
+          | KafkaOptions['options'])!.deserializer) ||
       new IncomingResponseDeserializer();
   }
 }
diff --git a/packages/microservices/client/client-redis.ts b/packages/microservices/client/client-redis.ts
index 8b42ce6a0..f0b5bc5e8 100644
--- a/packages/microservices/client/client-redis.ts
+++ b/packages/microservices/client/client-redis.ts
@@ -1,48 +1,44 @@
 import { Logger } from '@nestjs/common/services/logger.service';
 import { loadPackage } from '@nestjs/common/utils/load-package.util';
+import { REDIS_DEFAULT_HOST, REDIS_DEFAULT_PORT } from '../constants';
 import {
-  EmptyError,
-  fromEvent,
-  lastValueFrom,
-  merge,
-  Subject,
-  zip,
-} from 'rxjs';
-import { share, take, tap } from 'rxjs/operators';
-import {
-  CONNECT_EVENT,
-  ECONNREFUSED,
-  ERROR_EVENT,
-  MESSAGE_EVENT,
-  REDIS_DEFAULT_URL,
-} from '../constants';
-import {
-  ClientOpts,
-  RedisClient,
-  RetryStrategyOptions,
-} from '../external/redis.interface';
+  RedisEvents,
+  RedisEventsMap,
+  RedisStatus,
+} from '../events/redis.events';
 import { ReadPacket, RedisOptions, WritePacket } from '../interfaces';
 import { ClientProxy } from './client-proxy';
 
-let redisPackage: any = {};
+// To enable type safety for Redis. This cant be uncommented by default
+// because it would require the user to install the ioredis package even if they dont use Redis
+// Otherwise, TypeScript would fail to compile the code.
+//
+// type Redis = import('ioredis').Redis;
+type Redis = any;
+
+let redisPackage = {} as any;
 
-export class ClientRedis extends ClientProxy {
+/**
+ * @publicApi
+ */
+export class ClientRedis extends ClientProxy<RedisEvents, RedisStatus> {
   protected readonly logger = new Logger(ClientProxy.name);
   protected readonly subscriptionsCount = new Map<string, number>();
-  protected readonly url: string;
-  protected pubClient: RedisClient;
-  protected subClient: RedisClient;
-  protected connection: Promise<any>;
-  protected isExplicitlyTerminated = false;
+  protected pubClient: Redis;
+  protected subClient: Redis;
+  protected connectionPromise: Promise<any>;
+  protected isManuallyClosed = false;
+  protected wasInitialConnectionSuccessful = false;
+  protected pendingEventListeners: Array<{
+    event: keyof RedisEvents;
+    callback: RedisEvents[keyof RedisEvents];
+  }> = [];
 
-  constructor(protected readonly options: RedisOptions['options']) {
+  constructor(protected readonly options: Required<RedisOptions>['options']) {
     super();
-    this.url =
-      this.getOptionsProp(options, 'url') ||
-      (!this.getOptionsProp(options, 'host') && REDIS_DEFAULT_URL);
 
-    redisPackage = loadPackage('redis', ClientRedis.name, () =>
-      require('redis'),
+    redisPackage = loadPackage('ioredis', ClientRedis.name, () =>
+      require('ioredis'),
     );
 
     this.initializeSerializer(options);
@@ -61,78 +57,163 @@ export class ClientRedis extends ClientProxy {
     this.pubClient && this.pubClient.quit();
     this.subClient && this.subClient.quit();
     this.pubClient = this.subClient = null;
-    this.isExplicitlyTerminated = true;
+    this.isManuallyClosed = true;
+    this.pendingEventListeners = [];
   }
 
-  public connect(): Promise<any> {
+  public async connect(): Promise<any> {
     if (this.pubClient && this.subClient) {
-      return this.connection;
+      return this.connectionPromise;
     }
-    const error$ = new Subject<Error>();
-
-    this.pubClient = this.createClient(error$);
-    this.subClient = this.createClient(error$);
-    this.handleError(this.pubClient);
-    this.handleError(this.subClient);
-
-    const pubConnect$ = fromEvent(this.pubClient, CONNECT_EVENT);
-    const subClient$ = fromEvent(this.subClient, CONNECT_EVENT);
-
-    this.connection = lastValueFrom(
-      merge(error$, zip(pubConnect$, subClient$)).pipe(
-        take(1),
-        tap(() =>
-          this.subClient.on(MESSAGE_EVENT, this.createResponseCallback()),
-        ),
-        share(),
-      ),
-    ).catch(err => {
-      if (err instanceof EmptyError) {
+    this.pubClient = this.createClient();
+    this.subClient = this.createClient();
+
+    [this.pubClient, this.subClient].forEach((client, index) => {
+      const type = index === 0 ? 'pub' : 'sub';
+      this.registerErrorListener(client);
+      this.registerReconnectListener(client);
+      this.registerReadyListener(client);
+      this.registerEndListener(client);
+      this.pendingEventListeners.forEach(({ event, callback }) =>
+        client.on(event, (...args: [any]) => callback(type, ...args)),
+      );
+    });
+    this.pendingEventListeners = [];
+
+    this.connectionPromise = Promise.all([
+      this.subClient.connect(),
+      this.pubClient.connect(),
+    ]);
+    await this.connectionPromise;
+    return this.connectionPromise;
+  }
+
+  public createClient(): Redis {
+    return new redisPackage({
+      host: REDIS_DEFAULT_HOST,
+      port: REDIS_DEFAULT_PORT,
+      ...this.getClientOptions(),
+      lazyConnect: true,
+    });
+  }
+
+  public registerErrorListener(client: Redis) {
+    client.addListener(RedisEventsMap.ERROR, (err: any) =>
+      this.logger.error(err),
+    );
+  }
+
+  public registerReconnectListener(client: {
+    on: (event: string, fn: () => void) => void;
+  }) {
+    client.on(RedisEventsMap.RECONNECTING, () => {
+      if (this.isManuallyClosed) {
         return;
       }
-      throw err;
+
+      this.connectionPromise = Promise.reject(
+        'Error: Connection lost. Trying to reconnect...',
+      );
+
+      // Prevent unhandled rejections
+      this.connectionPromise.catch(() => {});
+
+      this._status$.next(RedisStatus.RECONNECTING);
+
+      if (this.wasInitialConnectionSuccessful) {
+        this.logger.log('Reconnecting to Redis...');
+      }
     });
-    return this.connection;
   }
 
-  public createClient(error$: Subject<Error>): RedisClient {
-    return redisPackage.createClient({
-      ...this.getClientOptions(error$),
-      url: this.url,
+  public registerReadyListener(client: {
+    on: (event: string, fn: () => void) => void;
+  }) {
+    client.on(RedisEventsMap.READY, () => {
+      this.connectionPromise = Promise.resolve();
+      this._status$.next(RedisStatus.CONNECTED);
+
+      this.logger.log('Connected to Redis. Subscribing to channels...');
+
+      if (!this.wasInitialConnectionSuccessful) {
+        this.wasInitialConnectionSuccessful = true;
+        this.subClient.on('message', this.createResponseCallback());
+      }
     });
   }
 
-  public handleError(client: RedisClient) {
-    client.addListener(ERROR_EVENT, (err: any) => this.logger.error(err));
+  public registerEndListener(client: {
+    on: (event: string, fn: () => void) => void;
+  }) {
+    client.on('end', () => {
+      if (this.isManuallyClosed) {
+        return;
+      }
+      this._status$.next(RedisStatus.DISCONNECTED);
+
+      if (this.getOptionsProp(this.options, 'retryAttempts') === undefined) {
+        // When retryAttempts is not specified, the connection will not be re-established
+        this.logger.error('Disconnected from Redis.');
+
+        // Clean up client instances and just recreate them when connect is called
+        this.pubClient = this.subClient = null;
+      } else {
+        this.logger.error('Disconnected from Redis.');
+        this.connectionPromise = Promise.reject(
+          'Error: Connection lost. Trying to reconnect...',
+        );
+
+        // Prevent unhandled rejections
+        this.connectionPromise.catch(() => {});
+      }
+    });
   }
 
-  public getClientOptions(error$: Subject<Error>): Partial<ClientOpts> {
-    const retry_strategy = (options: RetryStrategyOptions) =>
-      this.createRetryStrategy(options, error$);
+  public getClientOptions(): Partial<RedisOptions['options']> {
+    const retryStrategy = (times: number) => this.createRetryStrategy(times);
 
     return {
       ...(this.options || {}),
-      retry_strategy,
+      retryStrategy,
     };
   }
 
-  public createRetryStrategy(
-    options: RetryStrategyOptions,
-    error$: Subject<Error>,
-  ): undefined | number | Error {
-    if (options.error && (options.error as any).code === ECONNREFUSED) {
-      error$.error(options.error);
+  public on<
+    EventKey extends keyof RedisEvents = keyof RedisEvents,
+    EventCallback extends RedisEvents[EventKey] = RedisEvents[EventKey],
+  >(event: EventKey, callback: EventCallback) {
+    if (this.subClient && this.pubClient) {
+      this.subClient.on(event, (...args: [any]) => callback('sub', ...args));
+      this.pubClient.on(event, (...args: [any]) => callback('pub', ...args));
+    } else {
+      this.pendingEventListeners.push({ event, callback });
     }
-    if (this.isExplicitlyTerminated) {
+  }
+
+  public unwrap<T>(): T {
+    if (!this.pubClient || !this.subClient) {
+      throw new Error(
+        'Not initialized. Please call the "connect" method first.',
+      );
+    }
+    return [this.pubClient, this.subClient] as T;
+  }
+
+  public createRetryStrategy(times: number): undefined | number {
+    if (this.isManuallyClosed) {
       return undefined;
     }
-    if (
-      !this.getOptionsProp(this.options, 'retryAttempts') ||
-      options.attempt > this.getOptionsProp(this.options, 'retryAttempts')
-    ) {
-      return new Error('Retry time exhausted');
+    if (!this.getOptionsProp(this.options, 'retryAttempts')) {
+      this.logger.error(
+        'Redis connection closed and retry attempts not specified',
+      );
+      return;
+    }
+    if (times > this.getOptionsProp(this.options, 'retryAttempts', 0)) {
+      this.logger.error('Retry time exhausted');
+      return;
     }
-    return this.getOptionsProp(this.options, 'retryDelay') || 0;
+    return this.getOptionsProp(this.options, 'retryDelay', 5000);
   }
 
   public createResponseCallback(): (
@@ -199,6 +280,7 @@ export class ClientRedis extends ClientProxy {
       };
     } catch (err) {
       callback({ err });
+      return () => {};
     }
   }
 
@@ -214,7 +296,7 @@ export class ClientRedis extends ClientProxy {
   }
 
   protected unsubscribeFromChannel(channel: string) {
-    const subscriptionCount = this.subscriptionsCount.get(channel);
+    const subscriptionCount = this.subscriptionsCount.get(channel)!;
     this.subscriptionsCount.set(channel, subscriptionCount - 1);
 
     if (subscriptionCount - 1 <= 0) {
diff --git a/packages/microservices/client/client-rmq.ts b/packages/microservices/client/client-rmq.ts
index 945b7d6d1..fa75d0fc3 100644
--- a/packages/microservices/client/client-rmq.ts
+++ b/packages/microservices/client/client-rmq.ts
@@ -1,15 +1,21 @@
 import { Logger } from '@nestjs/common/services/logger.service';
 import { loadPackage } from '@nestjs/common/utils/load-package.util';
 import { randomStringGenerator } from '@nestjs/common/utils/random-string-generator.util';
+import { isFunction } from '@nestjs/common/utils/shared.utils';
 import { EventEmitter } from 'events';
-import { EmptyError, fromEvent, lastValueFrom, merge, Observable } from 'rxjs';
-import { first, map, share, switchMap } from 'rxjs/operators';
 import {
-  CONNECT_FAILED_EVENT,
+  EmptyError,
+  firstValueFrom,
+  fromEvent,
+  merge,
+  Observable,
+  ReplaySubject,
+} from 'rxjs';
+import { first, map, retryWhen, scan, skip, switchMap } from 'rxjs/operators';
+import {
   DISCONNECTED_RMQ_MESSAGE,
-  DISCONNECT_EVENT,
-  ERROR_EVENT,
   RQM_DEFAULT_IS_GLOBAL_PREFETCH_COUNT,
+  RQM_DEFAULT_NO_ASSERT,
   RQM_DEFAULT_NOACK,
   RQM_DEFAULT_PERSISTENT,
   RQM_DEFAULT_PREFETCH_COUNT,
@@ -17,42 +23,71 @@ import {
   RQM_DEFAULT_QUEUE_OPTIONS,
   RQM_DEFAULT_URL,
 } from '../constants';
-import { RmqUrl } from '../external/rmq-url.interface';
+import { RmqEvents, RmqEventsMap, RmqStatus } from '../events/rmq.events';
 import { ReadPacket, RmqOptions, WritePacket } from '../interfaces';
 import { RmqRecord } from '../record-builders';
 import { RmqRecordSerializer } from '../serializers/rmq-record.serializer';
 import { ClientProxy } from './client-proxy';
 
-let rqmPackage: any = {};
+// To enable type safety for RMQ. This cant be uncommented by default
+// because it would require the user to install the amqplib package even if they dont use RabbitMQ
+// Otherwise, TypeScript would fail to compile the code.
+//
+// type AmqpConnectionManager =
+//   import('amqp-connection-manager').AmqpConnectionManager;
+// type ChannelWrapper = import('amqp-connection-manager').ChannelWrapper;
+// type Channel = import('amqplib').Channel;
+// type ConsumeMessage = import('amqplib').ConsumeMessage;
+
+type Channel = any;
+type ChannelWrapper = any;
+type ConsumeMessage = any;
+type AmqpConnectionManager = any;
+
+let rmqPackage = {} as any; // typeof import('amqp-connection-manager');
 
 const REPLY_QUEUE = 'amq.rabbitmq.reply-to';
 
-export class ClientRMQ extends ClientProxy {
+/**
+ * @publicApi
+ */
+export class ClientRMQ extends ClientProxy<RmqEvents, RmqStatus> {
   protected readonly logger = new Logger(ClientProxy.name);
-  protected connection: Promise<any>;
-  protected client: any = null;
-  protected channel: any = null;
-  protected urls: string[] | RmqUrl[];
-  protected queue: string;
-  protected queueOptions: any;
+  protected connection$: ReplaySubject<any>;
+  protected connectionPromise: Promise<void>;
+  protected client: AmqpConnectionManager = null;
+  protected channel: ChannelWrapper = null;
+  protected pendingEventListeners: Array<{
+    event: keyof RmqEvents;
+    callback: RmqEvents[keyof RmqEvents];
+  }> = [];
+  protected isInitialConnect = true;
   protected responseEmitter: EventEmitter;
+  protected queue: string;
+  protected queueOptions: Record<string, any>;
   protected replyQueue: string;
-  protected persistent: boolean;
+  protected noAssert: boolean;
 
-  constructor(protected readonly options: RmqOptions['options']) {
+  constructor(protected readonly options: Required<RmqOptions>['options']) {
     super();
-    this.urls = this.getOptionsProp(this.options, 'urls') || [RQM_DEFAULT_URL];
-    this.queue =
-      this.getOptionsProp(this.options, 'queue') || RQM_DEFAULT_QUEUE;
-    this.queueOptions =
-      this.getOptionsProp(this.options, 'queueOptions') ||
-      RQM_DEFAULT_QUEUE_OPTIONS;
-    this.replyQueue =
-      this.getOptionsProp(this.options, 'replyQueue') || REPLY_QUEUE;
-    this.persistent =
-      this.getOptionsProp(this.options, 'persistent') || RQM_DEFAULT_PERSISTENT;
+    this.queue = this.getOptionsProp(this.options, 'queue', RQM_DEFAULT_QUEUE);
+    this.queueOptions = this.getOptionsProp(
+      this.options,
+      'queueOptions',
+      RQM_DEFAULT_QUEUE_OPTIONS,
+    );
+    this.replyQueue = this.getOptionsProp(
+      this.options,
+      'replyQueue',
+      REPLY_QUEUE,
+    );
+    this.noAssert =
+      this.getOptionsProp(this.options, 'noAssert') ??
+      this.queueOptions.noAssert ??
+      RQM_DEFAULT_NO_ASSERT;
+
     loadPackage('amqplib', ClientRMQ.name, () => require('amqplib'));
-    rqmPackage = loadPackage('amqp-connection-manager', ClientRMQ.name, () =>
+    rmqPackage = loadPackage('amqp-connection-manager', ClientRMQ.name, () =>
       require('amqp-connection-manager'),
     );
 
@@ -65,46 +100,57 @@ export class ClientRMQ extends ClientProxy {
     this.client && this.client.close();
     this.channel = null;
     this.client = null;
+    this.pendingEventListeners = [];
   }
 
   public connect(): Promise<any> {
     if (this.client) {
-      return this.connection;
+      return this.connectionPromise;
     }
     this.client = this.createClient();
-    this.handleError(this.client);
-    this.handleDisconnectError(this.client);
+
+    this.registerErrorListener(this.client);
+    this.registerDisconnectListener(this.client);
+    this.registerConnectListener(this.client);
+    this.pendingEventListeners.forEach(({ event, callback }) =>
+      this.client.on(event, callback),
+    );
+    this.pendingEventListeners = [];
+
+    this.responseEmitter = new EventEmitter();
+    this.responseEmitter.setMaxListeners(0);
 
     const connect$ = this.connect$(this.client);
-    this.connection = lastValueFrom(
-      this.mergeDisconnectEvent(this.client, connect$).pipe(
-        switchMap(() => this.createChannel()),
-        share(),
-      ),
-    ).catch(err => {
-      if (err instanceof EmptyError) {
-        return;
-      }
-      throw err;
-    });
+    const withDisconnect$ = this.mergeDisconnectEvent(
+      this.client,
+      connect$,
+    ).pipe(switchMap(() => this.createChannel()));
+
+    const withReconnect$ = fromEvent(this.client, RmqEventsMap.CONNECT).pipe(
+      skip(1),
+    );
+    const source$ = merge(withDisconnect$, withReconnect$);
 
-    return this.connection;
+    this.connection$ = new ReplaySubject(1);
+    source$.subscribe(this.connection$);
+    this.connectionPromise = this.convertConnectionToPromise();
+
+    return this.connectionPromise;
   }
 
   public createChannel(): Promise<void> {
     return new Promise(resolve => {
       this.channel = this.client.createChannel({
         json: false,
-        setup: (channel: any) => this.setupChannel(channel, resolve),
+        setup: (channel: Channel) => this.setupChannel(channel, resolve),
       });
     });
   }
 
-  public createClient<T = any>(): T {
+  public createClient(): AmqpConnectionManager {
     const socketOptions = this.getOptionsProp(this.options, 'socketOptions');
-    return rqmPackage.connect(this.urls, {
-      connectionOptions: socketOptions,
-    }) as T;
+    const urls = this.getOptionsProp(this.options, 'urls') || [RQM_DEFAULT_URL];
+    return rmqPackage.connect(urls, socketOptions);
   }
 
   public mergeDisconnectEvent<T = any>(
@@ -113,16 +159,43 @@ export class ClientRMQ extends ClientProxy {
   ): Observable<T> {
     const eventToError = (eventType: string) =>
       fromEvent(instance, eventType).pipe(
-        map((err: any) => {
+        map((err: unknown) => {
           throw err;
         }),
       );
-    const disconnect$ = eventToError(DISCONNECT_EVENT);
-    const connectFailed$ = eventToError(CONNECT_FAILED_EVENT);
+    const disconnect$ = eventToError(RmqEventsMap.DISCONNECT);
+
+    const urls = this.getOptionsProp(this.options, 'urls', []);
+    const connectFailedEventKey = 'connectFailed';
+    const connectFailed$ = eventToError(connectFailedEventKey).pipe(
+      retryWhen(e =>
+        e.pipe(
+          scan((errorCount, error: any) => {
+            if (urls.indexOf(error.url) >= urls.length - 1) {
+              throw error;
+            }
+            return errorCount + 1;
+          }, 0),
+        ),
+      ),
+    );
+    // If we ever decide to propagate all disconnect errors & re-emit them through
+    // the "connection" stream then comment out "first()" operator.
     return merge(source$, disconnect$, connectFailed$).pipe(first());
   }
 
-  public async setupChannel(channel: any, resolve: Function) {
+  public async convertConnectionToPromise() {
+    try {
+      return await firstValueFrom(this.connection$);
+    } catch (err) {
+      if (err instanceof EmptyError) {
+        return;
+      }
+      throw err;
+    }
+  }
+
+  public async setupChannel(channel: Channel, resolve: Function) {
     const prefetchCount =
       this.getOptionsProp(this.options, 'prefetchCount') ||
       RQM_DEFAULT_PREFETCH_COUNT;
@@ -130,20 +203,28 @@ export class ClientRMQ extends ClientProxy {
       this.getOptionsProp(this.options, 'isGlobalPrefetchCount') ||
       RQM_DEFAULT_IS_GLOBAL_PREFETCH_COUNT;
 
-    await channel.assertQueue(this.queue, this.queueOptions);
-    await channel.prefetch(prefetchCount, isGlobalPrefetchCount);
+    if (!this.noAssert) {
+      await channel.assertQueue(this.queue, this.queueOptions);
+    }
 
-    this.responseEmitter = new EventEmitter();
-    this.responseEmitter.setMaxListeners(0);
+    if (this.options.exchange && this.options.routingKey) {
+      await channel.bindQueue(
+        this.queue,
+        this.options.exchange,
+        this.options.routingKey,
+      );
+    }
+
+    await channel.prefetch(prefetchCount, isGlobalPrefetchCount);
     await this.consumeChannel(channel);
     resolve();
   }
 
-  public async consumeChannel(channel: any) {
+  public async consumeChannel(channel: Channel) {
     const noAck = this.getOptionsProp(this.options, 'noAck', RQM_DEFAULT_NOACK);
     await channel.consume(
       this.replyQueue,
-      (msg: any) =>
+      (msg: ConsumeMessage) =>
         this.responseEmitter.emit(msg.properties.correlationId, msg),
       {
         noAck,
@@ -151,34 +232,101 @@ export class ClientRMQ extends ClientProxy {
     );
   }
 
-  public handleError(client: any): void {
-    client.addListener(ERROR_EVENT, (err: any) => this.logger.error(err));
+  public registerErrorListener(client: AmqpConnectionManager): void {
+    client.addListener(RmqEventsMap.ERROR, (err: any) =>
+      this.logger.error(err),
+    );
   }
 
-  public handleDisconnectError(client: any): void {
-    client.addListener(DISCONNECT_EVENT, (err: any) => {
+  public registerDisconnectListener(client: AmqpConnectionManager): void {
+    client.addListener(RmqEventsMap.DISCONNECT, (err: any) => {
+      this._status$.next(RmqStatus.DISCONNECTED);
+
+      if (!this.isInitialConnect) {
+        this.connectionPromise = Promise.reject(
+          'Error: Connection lost. Trying to reconnect...',
+        );
+
+        // Prevent unhandled promise rejection
+        this.connectionPromise.catch(() => {});
+      }
+
       this.logger.error(DISCONNECTED_RMQ_MESSAGE);
       this.logger.error(err);
+    });
+  }
+
+  private registerConnectListener(client: AmqpConnectionManager): void {
+    client.addListener(RmqEventsMap.CONNECT, () => {
+      this._status$.next(RmqStatus.CONNECTED);
+      this.logger.log('Successfully connected to RMQ broker');
 
-      this.close();
+      if (this.isInitialConnect) {
+        this.isInitialConnect = false;
+
+        if (!this.channel) {
+          this.connectionPromise = this.createChannel();
+        }
+      } else {
+        this.connectionPromise = Promise.resolve();
+      }
     });
   }
 
+  public on<
+    EventKey extends keyof RmqEvents = keyof RmqEvents,
+    EventCallback extends RmqEvents[EventKey] = RmqEvents[EventKey],
+  >(event: EventKey, callback: EventCallback) {
+    if (this.client) {
+      this.client.addListener(event, callback);
+    } else {
+      this.pendingEventListeners.push({ event, callback });
+    }
+  }
+
+  public unwrap<T>(): T {
+    if (!this.client) {
+      throw new Error(
+        'Not initialized. Please call the "connect" method first.',
+      );
+    }
+    return this.client as T;
+  }
+
   public async handleMessage(
     packet: unknown,
     callback: (packet: WritePacket) => any,
-  ) {
+  ): Promise<void>;
+  public async handleMessage(
+    packet: unknown,
+    options: Record<string, unknown>,
+    callback: (packet: WritePacket) => any,
+  ): Promise<void>;
+  public async handleMessage(
+    packet: unknown,
+    options:
+      | Record<string, unknown>
+      | ((packet: WritePacket) => any)
+      | undefined,
+    callback?: (packet: WritePacket) => any,
+  ): Promise<void> {
+    if (isFunction(options)) {
+      callback = options as (packet: WritePacket) => any;
+      options = undefined;
+    }
+
     const { err, response, isDisposed } = await this.deserializer.deserialize(
       packet,
+      options,
     );
     if (isDisposed || err) {
-      callback({
+      callback?.({
         err,
         response,
         isDisposed: true,
       });
     }
-    callback({
+    callback?.({
       err,
       response,
     });
@@ -190,8 +338,18 @@ export class ClientRMQ extends ClientProxy {
   ): () => void {
     try {
       const correlationId = randomStringGenerator();
-      const listener = ({ content }: { content: any }) =>
-        this.handleMessage(JSON.parse(content.toString()), callback);
+      const listener = ({
+        content,
+        options,
+      }: {
+        content: Buffer;
+        options: Record<string, unknown>;
+      }) =>
+        this.handleMessage(
+          this.parseMessageContent(content),
+          options,
+          callback,
+        );
 
       Object.assign(message, { id: correlationId });
       const serializedPacket: ReadPacket & Partial<RmqRecord> =
@@ -201,20 +359,27 @@ export class ClientRMQ extends ClientProxy {
       delete serializedPacket.options;
 
       this.responseEmitter.on(correlationId, listener);
-      this.channel.sendToQueue(
-        this.queue,
-        Buffer.from(JSON.stringify(serializedPacket)),
-        {
-          replyTo: this.replyQueue,
-          persistent: this.persistent,
-          ...options,
-          headers: this.mergeHeaders(options?.headers),
-          correlationId,
-        },
-      );
+      this.channel
+        .sendToQueue(
+          this.queue,
+          Buffer.from(JSON.stringify(serializedPacket)),
+          {
+            replyTo: this.replyQueue,
+            persistent: this.getOptionsProp(
+              this.options,
+              'persistent',
+              RQM_DEFAULT_PERSISTENT,
+            ),
+            ...options,
+            headers: this.mergeHeaders(options?.headers),
+            correlationId,
+          },
+        )
+        .catch(err => callback({ err }));
       return () => this.responseEmitter.removeListener(correlationId, listener);
     } catch (err) {
       callback({ err });
+      return () => {};
     }
   }
 
@@ -222,16 +387,23 @@ export class ClientRMQ extends ClientProxy {
     const serializedPacket: ReadPacket & Partial<RmqRecord> =
       this.serializer.serialize(packet);
 
+    const options = serializedPacket.options;
+    delete serializedPacket.options;
+
     return new Promise<void>((resolve, reject) =>
       this.channel.sendToQueue(
         this.queue,
         Buffer.from(JSON.stringify(serializedPacket)),
         {
-          persistent: this.persistent,
-          ...serializedPacket.options,
-          headers: this.mergeHeaders(serializedPacket.options?.headers),
+          persistent: this.getOptionsProp(
+            this.options,
+            'persistent',
+            RQM_DEFAULT_PERSISTENT,
+          ),
+          ...options,
+          headers: this.mergeHeaders(options?.headers),
         },
-        (err: unknown) => (err ? reject(err) : resolve()),
+        (err: unknown) => (err ? reject(err as Error) : resolve()),
       ),
     );
   }
@@ -252,4 +424,13 @@ export class ClientRMQ extends ClientProxy {
       ...requestHeaders,
     };
   }
+
+  protected parseMessageContent(content: Buffer) {
+    const rawContent = content.toString();
+    try {
+      return JSON.parse(rawContent);
+    } catch {
+      return rawContent;
+    }
+  }
 }
diff --git a/packages/microservices/client/client-tcp.ts b/packages/microservices/client/client-tcp.ts
index f16c6407c..f8df2edff 100644
--- a/packages/microservices/client/client-tcp.ts
+++ b/packages/microservices/client/client-tcp.ts
@@ -1,63 +1,77 @@
-import { Logger } from '@nestjs/common';
+import { Logger, Type } from '@nestjs/common';
 import * as net from 'net';
 import { EmptyError, lastValueFrom } from 'rxjs';
 import { share, tap } from 'rxjs/operators';
-import {
-  CLOSE_EVENT,
-  ECONNREFUSED,
-  ERROR_EVENT,
-  MESSAGE_EVENT,
-  TCP_DEFAULT_HOST,
-  TCP_DEFAULT_PORT,
-} from '../constants';
-import { JsonSocket } from '../helpers/json-socket';
+import { ConnectionOptions, connect as tlsConnect, TLSSocket } from 'tls';
+import { ECONNREFUSED, TCP_DEFAULT_HOST, TCP_DEFAULT_PORT } from '../constants';
+import { TcpEvents, TcpEventsMap, TcpStatus } from '../events/tcp.events';
+import { JsonSocket, TcpSocket } from '../helpers';
 import { PacketId, ReadPacket, WritePacket } from '../interfaces';
 import { TcpClientOptions } from '../interfaces/client-metadata.interface';
 import { ClientProxy } from './client-proxy';
 
-export class ClientTCP extends ClientProxy {
-  protected connection: Promise<any>;
-  private readonly logger = new Logger(ClientTCP.name);
-  private readonly port: number;
-  private readonly host: string;
-  private isConnected = false;
-  private socket: JsonSocket;
-
-  constructor(options: TcpClientOptions['options']) {
+/**
+ * @publicApi
+ */
+export class ClientTCP extends ClientProxy<TcpEvents, TcpStatus> {
+  protected readonly logger = new Logger(ClientTCP.name);
+  protected readonly port: number;
+  protected readonly host: string;
+  protected readonly socketClass: Type<TcpSocket>;
+  protected readonly tlsOptions?: ConnectionOptions;
+  protected socket: TcpSocket | null = null;
+  protected connectionPromise: Promise<any> | null = null;
+  protected pendingEventListeners: Array<{
+    event: keyof TcpEvents;
+    callback: TcpEvents[keyof TcpEvents];
+  }> = [];
+
+  constructor(options: Required<TcpClientOptions>['options']) {
     super();
-    this.port = this.getOptionsProp(options, 'port') || TCP_DEFAULT_PORT;
-    this.host = this.getOptionsProp(options, 'host') || TCP_DEFAULT_HOST;
+    this.port = this.getOptionsProp(options, 'port', TCP_DEFAULT_PORT);
+    this.host = this.getOptionsProp(options, 'host', TCP_DEFAULT_HOST);
+    this.socketClass = this.getOptionsProp(options, 'socketClass', JsonSocket);
+    this.tlsOptions = this.getOptionsProp(options, 'tlsOptions');
 
     this.initializeSerializer(options);
     this.initializeDeserializer(options);
   }
 
   public connect(): Promise<any> {
-    if (this.isConnected && this.connection) {
-      return this.connection;
+    if (this.connectionPromise) {
+      return this.connectionPromise;
     }
     this.socket = this.createSocket();
-    this.bindEvents(this.socket);
+    this.registerConnectListener(this.socket);
+    this.registerCloseListener(this.socket);
+    this.registerErrorListener(this.socket);
+
+    this.pendingEventListeners.forEach(({ event, callback }) =>
+      this.socket!.on(event, callback as any),
+    );
+    this.pendingEventListeners = [];
 
     const source$ = this.connect$(this.socket.netSocket).pipe(
       tap(() => {
-        this.isConnected = true;
-        this.socket.on(MESSAGE_EVENT, (buffer: WritePacket & PacketId) =>
+        this.socket!.on('message', (buffer: WritePacket & PacketId) =>
           this.handleResponse(buffer),
         );
       }),
       share(),
     );
 
-    this.socket.connect(this.port, this.host);
-    this.connection = lastValueFrom(source$).catch(err => {
+    // For TLS connections, the connection is initiated when the socket is created
+    if (!this.tlsOptions) {
+      this.socket.connect(this.port, this.host);
+    }
+    this.connectionPromise = lastValueFrom(source$).catch(err => {
       if (err instanceof EmptyError) {
         return;
       }
       throw err;
     });
 
-    return this.connection;
+    return this.connectionPromise;
   }
 
   public async handleResponse(buffer: unknown): Promise<void> {
@@ -80,21 +94,50 @@ export class ClientTCP extends ClientProxy {
     });
   }
 
-  public createSocket(): JsonSocket {
-    return new JsonSocket(new net.Socket());
+  public createSocket(): TcpSocket {
+    let socket: net.Socket | TLSSocket;
+    /**
+     * TLS enabled, "upgrade" the TCP Socket to TLS
+     */
+    if (this.tlsOptions) {
+      socket = tlsConnect({
+        ...this.tlsOptions,
+        port: this.port,
+        host: this.host,
+      });
+    } else {
+      socket = new net.Socket();
+    }
+    return new this.socketClass(socket);
   }
 
   public close() {
     this.socket && this.socket.end();
     this.handleClose();
+    this.pendingEventListeners = [];
   }
 
-  public bindEvents(socket: JsonSocket) {
-    socket.on(
-      ERROR_EVENT,
-      (err: any) => err.code !== ECONNREFUSED && this.handleError(err),
-    );
-    socket.on(CLOSE_EVENT, () => this.handleClose());
+  public registerConnectListener(socket: TcpSocket) {
+    socket.on(TcpEventsMap.CONNECT, () => {
+      this._status$.next(TcpStatus.CONNECTED);
+    });
+  }
+
+  public registerErrorListener(socket: TcpSocket) {
+    socket.on(TcpEventsMap.ERROR, err => {
+      if (err.code !== ECONNREFUSED) {
+        this.handleError(err);
+      } else {
+        this._status$.next(TcpStatus.DISCONNECTED);
+      }
+    });
+  }
+
+  public registerCloseListener(socket: TcpSocket) {
+    socket.on(TcpEventsMap.CLOSE, () => {
+      this._status$.next(TcpStatus.DISCONNECTED);
+      this.handleClose();
+    });
   }
 
   public handleError(err: any) {
@@ -102,8 +145,36 @@ export class ClientTCP extends ClientProxy {
   }
 
   public handleClose() {
-    this.isConnected = false;
     this.socket = null;
+    this.connectionPromise = null;
+
+    if (this.routingMap.size > 0) {
+      const err = new Error('Connection closed');
+      for (const callback of this.routingMap.values()) {
+        callback({ err });
+      }
+      this.routingMap.clear();
+    }
+  }
+
+  public on<
+    EventKey extends keyof TcpEvents = keyof TcpEvents,
+    EventCallback extends TcpEvents[EventKey] = TcpEvents[EventKey],
+  >(event: EventKey, callback: EventCallback) {
+    if (this.socket) {
+      this.socket.on(event, callback as any);
+    } else {
+      this.pendingEventListeners.push({ event, callback });
+    }
+  }
+
+  public unwrap<T>(): T {
+    if (!this.socket) {
+      throw new Error(
+        'Not initialized. Please call the "connect" method first.',
+      );
+    }
+    return this.socket.netSocket as T;
   }
 
   protected publish(
@@ -115,11 +186,12 @@ export class ClientTCP extends ClientProxy {
       const serializedPacket = this.serializer.serialize(packet);
 
       this.routingMap.set(packet.id, callback);
-      this.socket.sendMessage(serializedPacket);
+      this.socket!.sendMessage(serializedPacket);
 
       return () => this.routingMap.delete(packet.id);
     } catch (err) {
       callback({ err });
+      return () => {};
     }
   }
 
@@ -129,6 +201,6 @@ export class ClientTCP extends ClientProxy {
       ...packet,
       pattern,
     });
-    return this.socket.sendMessage(serializedPacket);
+    return this.socket!.sendMessage(serializedPacket);
   }
 }
diff --git a/packages/microservices/client/constants.ts b/packages/microservices/client/constants.ts
deleted file mode 100644
index 4975f18d8..000000000
--- a/packages/microservices/client/constants.ts
+++ /dev/null
@@ -1,2 +0,0 @@
-export const GRPC_CANCELLED = 'Cancelled';
-export const RABBITMQ_REPLY_QUEUE = 'amq.rabbitmq.reply-to';
diff --git a/packages/microservices/constants.ts b/packages/microservices/constants.ts
index 4483930d9..8344cf1c2 100644
--- a/packages/microservices/constants.ts
+++ b/packages/microservices/constants.ts
@@ -2,52 +2,58 @@ import { ROUTE_ARGS_METADATA } from '@nestjs/common/constants';
 
 export const TCP_DEFAULT_PORT = 3000;
 export const TCP_DEFAULT_HOST = 'localhost';
-export const REDIS_DEFAULT_URL = 'redis://localhost:6379';
+export const REDIS_DEFAULT_PORT = 6379;
+export const REDIS_DEFAULT_HOST = 'localhost';
 export const NATS_DEFAULT_URL = 'nats://localhost:4222';
 export const MQTT_DEFAULT_URL = 'mqtt://localhost:1883';
 export const GRPC_DEFAULT_URL = 'localhost:5000';
 export const RQM_DEFAULT_URL = 'amqp://localhost';
 export const KAFKA_DEFAULT_BROKER = 'localhost:9092';
+export const KAFKA_DEFAULT_CLIENT = 'nestjs-consumer';
+export const KAFKA_DEFAULT_GROUP = 'nestjs-group';
+export const MQTT_SEPARATOR = '/';
+export const MQTT_WILDCARD_SINGLE = '+';
+export const MQTT_WILDCARD_ALL = '#';
+export const RQM_DEFAULT_QUEUE = 'default';
+export const RQM_DEFAULT_PREFETCH_COUNT = 0;
+export const RQM_DEFAULT_IS_GLOBAL_PREFETCH_COUNT = false;
+export const RQM_DEFAULT_QUEUE_OPTIONS = {};
+export const RQM_DEFAULT_NOACK = true;
+export const RQM_DEFAULT_PERSISTENT = false;
+export const RQM_DEFAULT_NO_ASSERT = false;
 
-export const CONNECT_EVENT = 'connect';
-export const DISCONNECT_EVENT = 'disconnect';
-export const CONNECT_FAILED_EVENT = 'connectFailed';
-export const MESSAGE_EVENT = 'message';
-export const DATA_EVENT = 'data';
-export const ERROR_EVENT = 'error';
-export const CLOSE_EVENT = 'close';
-export const SUBSCRIBE = 'subscribe';
-export const CANCEL_EVENT = 'cancelled';
+export const ECONNREFUSED = 'ECONNREFUSED';
+export const CONN_ERR = 'CONN_ERR';
+export const EADDRINUSE = 'EADDRINUSE';
+export const ENOTFOUND = 'ENOTFOUND';
 
 export const PATTERN_METADATA = 'microservices:pattern';
+export const PATTERN_EXTRAS_METADATA = 'microservices:pattern_extras';
 export const TRANSPORT_METADATA = 'microservices:transport';
 export const CLIENT_CONFIGURATION_METADATA = 'microservices:client';
 export const PATTERN_HANDLER_METADATA = 'microservices:handler_type';
 export const CLIENT_METADATA = 'microservices:is_client_instance';
 export const PARAM_ARGS_METADATA = ROUTE_ARGS_METADATA;
-
 export const REQUEST_PATTERN_METADATA = 'microservices:request_pattern';
 export const REPLY_PATTERN_METADATA = 'microservices:reply_pattern';
 
-export const RQM_DEFAULT_QUEUE = 'default';
-export const RQM_DEFAULT_PREFETCH_COUNT = 0;
-export const RQM_DEFAULT_IS_GLOBAL_PREFETCH_COUNT = false;
-export const RQM_DEFAULT_QUEUE_OPTIONS = {};
-export const RQM_DEFAULT_NOACK = true;
-export const RQM_DEFAULT_PERSISTENT = false;
+export const RQM_NO_EVENT_HANDLER = (
+  text: TemplateStringsArray,
+  pattern: string,
+) =>
+  `An unsupported event was received. It has been negative acknowledged, so it will not be re-delivered. Pattern: ${pattern}`;
+export const RQM_NO_MESSAGE_HANDLER = (
+  text: TemplateStringsArray,
+  pattern: string,
+) =>
+  `An unsupported message was received. It has been negative acknowledged, so it will not be re-delivered. Pattern: ${pattern}`;
 export const GRPC_DEFAULT_PROTO_LOADER = '@grpc/proto-loader';
 
+export const NO_EVENT_HANDLER = (text: TemplateStringsArray, pattern: string) =>
+  `There is no matching event handler defined in the remote service. Event pattern: ${pattern}`;
 export const NO_MESSAGE_HANDLER = `There is no matching message handler defined in the remote service.`;
-export const NO_EVENT_HANDLER = `There is no matching event handler defined in the remote service.`;
 export const DISCONNECTED_RMQ_MESSAGE = `Disconnected from RMQ. Trying to reconnect.`;
+export const CONNECTION_FAILED_MESSAGE =
+  'Connection to transport failed. Trying to reconnect...';
 
-export const KAFKA_DEFAULT_CLIENT = 'nestjs-consumer';
-export const KAFKA_DEFAULT_GROUP = 'nestjs-group';
-
-export const MQTT_SEPARATOR = '/';
-export const MQTT_WILDCARD_SINGLE = '+';
-export const MQTT_WILDCARD_ALL = '#';
-
-export const ECONNREFUSED = 'ECONNREFUSED';
-export const CONN_ERR = 'CONN_ERR';
-export const EADDRINUSE = 'EADDRINUSE';
+export const NATS_DEFAULT_GRACE_PERIOD = 10000;
diff --git a/packages/microservices/container.ts b/packages/microservices/container.ts
index 8ab9cb325..87812833d 100644
--- a/packages/microservices/container.ts
+++ b/packages/microservices/container.ts
@@ -1,16 +1,13 @@
 import { ClientProxy } from './client/client-proxy';
-import { Closeable } from './interfaces/closeable.interface';
-
-export type CloseableClient = Closeable & ClientProxy;
 
 export class ClientsContainer {
-  private clients: CloseableClient[] = [];
+  private clients: ClientProxy[] = [];
 
-  public getAllClients(): CloseableClient[] {
+  public getAllClients(): ClientProxy[] {
     return this.clients;
   }
 
-  public addClient(client: CloseableClient) {
+  public addClient(client: ClientProxy) {
     this.clients.push(client);
   }
 
diff --git a/packages/microservices/context/exception-filters-context.ts b/packages/microservices/context/exception-filters-context.ts
index 3f8ab49bd..14d42da91 100644
--- a/packages/microservices/context/exception-filters-context.ts
+++ b/packages/microservices/context/exception-filters-context.ts
@@ -6,10 +6,13 @@ import { BaseExceptionFilterContext } from '@nestjs/core/exceptions/base-excepti
 import { STATIC_CONTEXT } from '@nestjs/core/injector/constants';
 import { NestContainer } from '@nestjs/core/injector/container';
 import { InstanceWrapper } from '@nestjs/core/injector/instance-wrapper';
+import { iterate } from 'iterare';
 import { Observable } from 'rxjs';
 import { RpcExceptionsHandler } from '../exceptions/rpc-exceptions-handler';
-import { iterate } from 'iterare';
 
+/**
+ * @publicApi
+ */
 export class ExceptionFiltersContext extends BaseExceptionFilterContext {
   constructor(
     container: NestContainer,
@@ -53,7 +56,12 @@ export class ExceptionFiltersContext extends BaseExceptionFilterContext {
     const scopedFilterWrappers =
       this.config.getGlobalRequestFilters() as InstanceWrapper[];
     const scopedFilters = iterate(scopedFilterWrappers)
-      .map(wrapper => wrapper.getInstanceByContextId(contextId, inquirerId))
+      .map(wrapper =>
+        wrapper.getInstanceByContextId(
+          this.getContextId(contextId, wrapper),
+          inquirerId,
+        ),
+      )
       .filter(host => !!host)
       .map(host => host.instance)
       .toArray();
diff --git a/packages/microservices/context/request-context-host.ts b/packages/microservices/context/request-context-host.ts
index 2d221cca7..f15eb29d8 100644
--- a/packages/microservices/context/request-context-host.ts
+++ b/packages/microservices/context/request-context-host.ts
@@ -1,6 +1,9 @@
 import { BaseRpcContext } from '../ctx-host/base-rpc.context';
 import { RequestContext } from '../interfaces';
 
+/**
+ * @publicApi
+ */
 export class RequestContextHost<
   TData = any,
   TContext extends BaseRpcContext = any,
diff --git a/packages/microservices/context/rpc-context-creator.ts b/packages/microservices/context/rpc-context-creator.ts
index 003cd646c..a7ee74e02 100644
--- a/packages/microservices/context/rpc-context-creator.ts
+++ b/packages/microservices/context/rpc-context-creator.ts
@@ -1,5 +1,5 @@
 import {
-  CUSTOM_ROUTE_AGRS_METADATA,
+  CUSTOM_ROUTE_ARGS_METADATA,
   PARAMTYPES_METADATA,
 } from '@nestjs/common/constants';
 import {
@@ -225,7 +225,7 @@ export class RpcContextCreator {
         this.pipesContextCreator.createConcreteContext(pipesCollection);
       const type = this.contextUtils.mapParamType(key);
 
-      if (key.includes(CUSTOM_ROUTE_AGRS_METADATA)) {
+      if (key.includes(CUSTOM_ROUTE_ARGS_METADATA)) {
         const { factory } = metadata[key];
         const customExtractValue = this.contextUtils.getCustomFactory(
           factory,
diff --git a/packages/microservices/context/rpc-proxy.ts b/packages/microservices/context/rpc-proxy.ts
index 081167f62..0e90b8e83 100644
--- a/packages/microservices/context/rpc-proxy.ts
+++ b/packages/microservices/context/rpc-proxy.ts
@@ -1,5 +1,5 @@
 import { ExecutionContextHost } from '@nestjs/core/helpers/execution-context-host';
-import { Observable, isObservable } from 'rxjs';
+import { isObservable, Observable } from 'rxjs';
 import { catchError } from 'rxjs/operators';
 import { RpcExceptionsHandler } from '../exceptions/rpc-exceptions-handler';
 
@@ -31,6 +31,6 @@ export class RpcProxy {
   ): Observable<unknown> {
     const host = new ExecutionContextHost(args);
     host.setType('rpc');
-    return exceptionsHandler.handle(error, host);
+    return exceptionsHandler.handle(error as Error, host);
   }
 }
diff --git a/packages/microservices/ctx-host/base-rpc.context.ts b/packages/microservices/ctx-host/base-rpc.context.ts
index 0c8d4703a..0f51ab077 100644
--- a/packages/microservices/ctx-host/base-rpc.context.ts
+++ b/packages/microservices/ctx-host/base-rpc.context.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export class BaseRpcContext<T = unknown[]> {
   constructor(protected readonly args: T) {}
 
diff --git a/packages/microservices/ctx-host/index.ts b/packages/microservices/ctx-host/index.ts
index 923346e48..9d871dee2 100644
--- a/packages/microservices/ctx-host/index.ts
+++ b/packages/microservices/ctx-host/index.ts
@@ -4,3 +4,4 @@ export * from './nats.context';
 export * from './redis.context';
 export * from './rmq.context';
 export * from './tcp.context';
+export * from './base-rpc.context';
diff --git a/packages/microservices/ctx-host/kafka.context.ts b/packages/microservices/ctx-host/kafka.context.ts
index 922ccb9c5..5361ae53d 100644
--- a/packages/microservices/ctx-host/kafka.context.ts
+++ b/packages/microservices/ctx-host/kafka.context.ts
@@ -1,8 +1,18 @@
-import { KafkaMessage } from '../external/kafka.interface';
+import { Consumer, KafkaMessage, Producer } from '../external/kafka.interface';
 import { BaseRpcContext } from './base-rpc.context';
 
-type KafkaContextArgs = [KafkaMessage, number, string];
+type KafkaContextArgs = [
+  message: KafkaMessage,
+  partition: number,
+  topic: string,
+  consumer: Consumer,
+  heartbeat: () => Promise<void>,
+  producer: Producer,
+];
 
+/**
+ * @publicApi
+ */
 export class KafkaContext extends BaseRpcContext<KafkaContextArgs> {
   constructor(args: KafkaContextArgs) {
     super(args);
@@ -28,4 +38,25 @@ export class KafkaContext extends BaseRpcContext<KafkaContextArgs> {
   getTopic() {
     return this.args[2];
   }
+
+  /**
+   * Returns the Kafka consumer reference.
+   */
+  getConsumer() {
+    return this.args[3];
+  }
+
+  /**
+   * Returns the Kafka heartbeat callback.
+   */
+  getHeartbeat() {
+    return this.args[4];
+  }
+
+  /**
+   * Returns the Kafka producer reference,
+   */
+  getProducer() {
+    return this.args[5];
+  }
 }
diff --git a/packages/microservices/ctx-host/mqtt.context.ts b/packages/microservices/ctx-host/mqtt.context.ts
index 0693c35d3..e9919b11c 100644
--- a/packages/microservices/ctx-host/mqtt.context.ts
+++ b/packages/microservices/ctx-host/mqtt.context.ts
@@ -2,6 +2,9 @@ import { BaseRpcContext } from './base-rpc.context';
 
 type MqttContextArgs = [string, Record<string, any>];
 
+/**
+ * @publicApi
+ */
 export class MqttContext extends BaseRpcContext<MqttContextArgs> {
   constructor(args: MqttContextArgs) {
     super(args);
@@ -15,7 +18,7 @@ export class MqttContext extends BaseRpcContext<MqttContextArgs> {
   }
 
   /**
-   * Returns the refernce to the original MQTT packet.
+   * Returns the reference to the original MQTT packet.
    */
   getPacket() {
     return this.args[1];
diff --git a/packages/microservices/ctx-host/nats.context.ts b/packages/microservices/ctx-host/nats.context.ts
index c67c16966..dc3fe92d8 100644
--- a/packages/microservices/ctx-host/nats.context.ts
+++ b/packages/microservices/ctx-host/nats.context.ts
@@ -2,6 +2,9 @@ import { BaseRpcContext } from './base-rpc.context';
 
 type NatsContextArgs = [string, any];
 
+/**
+ * @publicApi
+ */
 export class NatsContext extends BaseRpcContext<NatsContextArgs> {
   constructor(args: NatsContextArgs) {
     super(args);
diff --git a/packages/microservices/ctx-host/redis.context.ts b/packages/microservices/ctx-host/redis.context.ts
index d84225619..ad5fa7e3f 100644
--- a/packages/microservices/ctx-host/redis.context.ts
+++ b/packages/microservices/ctx-host/redis.context.ts
@@ -2,6 +2,9 @@ import { BaseRpcContext } from './base-rpc.context';
 
 type RedisContextArgs = [string];
 
+/**
+ * @publicApi
+ */
 export class RedisContext extends BaseRpcContext<RedisContextArgs> {
   constructor(args: RedisContextArgs) {
     super(args);
diff --git a/packages/microservices/ctx-host/rmq.context.ts b/packages/microservices/ctx-host/rmq.context.ts
index 38abefe7f..da791a64f 100644
--- a/packages/microservices/ctx-host/rmq.context.ts
+++ b/packages/microservices/ctx-host/rmq.context.ts
@@ -2,6 +2,9 @@ import { BaseRpcContext } from './base-rpc.context';
 
 type RmqContextArgs = [Record<string, any>, any, string];
 
+/**
+ * @publicApi
+ */
 export class RmqContext extends BaseRpcContext<RmqContextArgs> {
   constructor(args: RmqContextArgs) {
     super(args);
diff --git a/packages/microservices/ctx-host/tcp.context.ts b/packages/microservices/ctx-host/tcp.context.ts
index a858ea442..2b74dc899 100644
--- a/packages/microservices/ctx-host/tcp.context.ts
+++ b/packages/microservices/ctx-host/tcp.context.ts
@@ -1,8 +1,11 @@
-import { JsonSocket } from '../helpers/json-socket';
+import { TcpSocket } from '../helpers';
 import { BaseRpcContext } from './base-rpc.context';
 
-type TcpContextArgs = [JsonSocket, string];
+type TcpContextArgs = [TcpSocket, string];
 
+/**
+ * @publicApi
+ */
 export class TcpContext extends BaseRpcContext<TcpContextArgs> {
   constructor(args: TcpContextArgs) {
     super(args);
diff --git a/packages/microservices/decorators/client.decorator.ts b/packages/microservices/decorators/client.decorator.ts
index 53d99d4fb..48848b6a4 100644
--- a/packages/microservices/decorators/client.decorator.ts
+++ b/packages/microservices/decorators/client.decorator.ts
@@ -5,6 +5,9 @@ import { ClientOptions } from '../interfaces/client-metadata.interface';
  * Attaches the `ClientProxy` instance to the given property
  *
  * @param  {ClientOptions} metadata optional client metadata
+ *
+ * @publicApi
+ *
  */
 export function Client(metadata?: ClientOptions): PropertyDecorator {
   return (target: object, propertyKey: string | symbol): void => {
diff --git a/packages/microservices/decorators/event-pattern.decorator.ts b/packages/microservices/decorators/event-pattern.decorator.ts
index 5fe9561df..f4973d741 100644
--- a/packages/microservices/decorators/event-pattern.decorator.ts
+++ b/packages/microservices/decorators/event-pattern.decorator.ts
@@ -1,30 +1,74 @@
 import {
+  isNil,
+  isNumber,
+  isObject,
+  isSymbol,
+} from '@nestjs/common/utils/shared.utils';
+import {
+  PATTERN_EXTRAS_METADATA,
   PATTERN_HANDLER_METADATA,
   PATTERN_METADATA,
   TRANSPORT_METADATA,
 } from '../constants';
-import { PatternHandler } from '../enums/pattern-handler.enum';
 import { Transport } from '../enums';
+import { PatternHandler } from '../enums/pattern-handler.enum';
 
 /**
  * Subscribes to incoming events which fulfils chosen pattern.
+ *
+ * @publicApi
  */
-export const EventPattern = <T = string>(
+export const EventPattern: {
+  <T = string>(metadata?: T): MethodDecorator;
+  <T = string>(metadata?: T, transport?: Transport | symbol): MethodDecorator;
+  <T = string>(metadata?: T, extras?: Record<string, any>): MethodDecorator;
+  <T = string>(
+    metadata?: T,
+    transport?: Transport | symbol,
+    extras?: Record<string, any>,
+  ): MethodDecorator;
+} = <T = string>(
   metadata?: T,
-  transport?: Transport,
+  transportOrExtras?: Transport | symbol | Record<string, any>,
+  maybeExtras?: Record<string, any>,
 ): MethodDecorator => {
+  let transport: Transport | symbol;
+  let extras: Record<string, any>;
+  if (
+    (isNumber(transportOrExtras) || isSymbol(transportOrExtras)) &&
+    isNil(maybeExtras)
+  ) {
+    transport = transportOrExtras;
+  } else if (isObject(transportOrExtras) && isNil(maybeExtras)) {
+    extras = transportOrExtras;
+  } else {
+    transport = transportOrExtras as Transport | symbol;
+    extras = maybeExtras!;
+  }
   return (
     target: object,
     key: string | symbol,
     descriptor: PropertyDescriptor,
   ) => {
-    Reflect.defineMetadata(PATTERN_METADATA, metadata, descriptor.value);
+    Reflect.defineMetadata(
+      PATTERN_METADATA,
+      ([] as any[]).concat(metadata),
+      descriptor.value,
+    );
     Reflect.defineMetadata(
       PATTERN_HANDLER_METADATA,
       PatternHandler.EVENT,
       descriptor.value,
     );
     Reflect.defineMetadata(TRANSPORT_METADATA, transport, descriptor.value);
+    Reflect.defineMetadata(
+      PATTERN_EXTRAS_METADATA,
+      {
+        ...Reflect.getMetadata(PATTERN_EXTRAS_METADATA, descriptor.value),
+        ...extras,
+      },
+      descriptor.value,
+    );
     return descriptor;
   };
 };
diff --git a/packages/microservices/decorators/message-pattern.decorator.ts b/packages/microservices/decorators/message-pattern.decorator.ts
index 936d76703..6ffbfde46 100644
--- a/packages/microservices/decorators/message-pattern.decorator.ts
+++ b/packages/microservices/decorators/message-pattern.decorator.ts
@@ -1,12 +1,23 @@
-/* eslint-disable @typescript-eslint/no-use-before-define */
 import {
+  isNil,
+  isNumber,
+  isObject,
+  isSymbol,
+} from '@nestjs/common/utils/shared.utils';
+
+import {
+  PATTERN_EXTRAS_METADATA,
   PATTERN_HANDLER_METADATA,
   PATTERN_METADATA,
   TRANSPORT_METADATA,
 } from '../constants';
+import { Transport } from '../enums';
 import { PatternHandler } from '../enums/pattern-handler.enum';
+import {
+  InvalidGrpcDecoratorException,
+  RpcDecoratorMetadata,
+} from '../errors/invalid-grpc-message-decorator.exception';
 import { PatternMetadata } from '../interfaces/pattern-metadata.interface';
-import { Transport } from '../enums';
 
 export enum GrpcMethodStreamingType {
   NO_STREAMING = 'no_stream',
@@ -16,24 +27,72 @@ export enum GrpcMethodStreamingType {
 
 /**
  * Subscribes to incoming messages which fulfils chosen pattern.
+ *
+ * @publicApi
  */
-export const MessagePattern = <T = PatternMetadata | string>(
+export const MessagePattern: {
+  <T = PatternMetadata | string>(metadata?: T): MethodDecorator;
+  <T = PatternMetadata | string>(
+    metadata?: T,
+    transport?: Transport | symbol,
+  ): MethodDecorator;
+  <T = PatternMetadata | string>(
+    metadata?: T,
+    extras?: Record<string, any>,
+  ): MethodDecorator;
+  <T = PatternMetadata | string>(
+    metadata?: T,
+    transport?: Transport | symbol,
+    extras?: Record<string, any>,
+  ): MethodDecorator;
+} = <T = PatternMetadata | string>(
   metadata?: T,
-  transport?: Transport,
+  transportOrExtras?: Transport | symbol | Record<string, any>,
+  maybeExtras?: Record<string, any>,
 ): MethodDecorator => {
+  let transport: Transport | symbol;
+  let extras: Record<string, any>;
+  if (
+    (isNumber(transportOrExtras) || isSymbol(transportOrExtras)) &&
+    isNil(maybeExtras)
+  ) {
+    transport = transportOrExtras;
+  } else if (isObject(transportOrExtras) && isNil(maybeExtras)) {
+    extras = transportOrExtras;
+  } else {
+    transport = transportOrExtras as Transport | symbol;
+    extras = maybeExtras!;
+  }
+
   return (
     target: object,
     key: string | symbol,
     descriptor: PropertyDescriptor,
   ) => {
-    Reflect.defineMetadata(PATTERN_METADATA, metadata, descriptor.value);
-    Reflect.defineMetadata(
-      PATTERN_HANDLER_METADATA,
-      PatternHandler.MESSAGE,
-      descriptor.value,
-    );
-    Reflect.defineMetadata(TRANSPORT_METADATA, transport, descriptor.value);
-    return descriptor;
+    try {
+      Reflect.defineMetadata(
+        PATTERN_METADATA,
+        ([] as any[]).concat(metadata),
+        descriptor.value,
+      );
+      Reflect.defineMetadata(
+        PATTERN_HANDLER_METADATA,
+        PatternHandler.MESSAGE,
+        descriptor.value,
+      );
+      Reflect.defineMetadata(TRANSPORT_METADATA, transport, descriptor.value);
+      Reflect.defineMetadata(
+        PATTERN_EXTRAS_METADATA,
+        {
+          ...Reflect.getMetadata(PATTERN_EXTRAS_METADATA, descriptor.value),
+          ...extras,
+        },
+        descriptor.value,
+      );
+      return descriptor;
+    } catch (err) {
+      throw new InvalidGrpcDecoratorException(metadata as RpcDecoratorMetadata);
+    }
   };
 };
 
@@ -42,7 +101,10 @@ export const MessagePattern = <T = PatternMetadata | string>(
  */
 export function GrpcMethod(service?: string): MethodDecorator;
 export function GrpcMethod(service: string, method?: string): MethodDecorator;
-export function GrpcMethod(service: string, method?: string): MethodDecorator {
+export function GrpcMethod(
+  service: string | undefined,
+  method?: string,
+): MethodDecorator {
   return (
     target: object,
     key: string | symbol,
@@ -68,7 +130,7 @@ export function GrpcStreamMethod(
   method?: string,
 ): MethodDecorator;
 export function GrpcStreamMethod(
-  service: string,
+  service: string | undefined,
   method?: string,
 ): MethodDecorator {
   return (
@@ -83,7 +145,35 @@ export function GrpcStreamMethod(
       method,
       GrpcMethodStreamingType.RX_STREAMING,
     );
-    return MessagePattern(metadata, Transport.GRPC)(target, key, descriptor);
+
+    MessagePattern(metadata, Transport.GRPC)(target, key, descriptor);
+
+    const originalMethod = descriptor.value;
+
+    // Override original method to call the "drainBuffer" method on the first parameter
+    // This is required to avoid premature message emission
+    descriptor.value = async function (
+      this: any,
+      observable: any,
+      ...args: any[]
+    ) {
+      const result = await Promise.resolve(
+        originalMethod.apply(this, [observable, ...args]),
+      );
+
+      // Drain buffer if "drainBuffer" method is available
+      if (observable && observable.drainBuffer) {
+        observable.drainBuffer();
+      }
+      return result;
+    };
+
+    // Copy all metadata from the original method to the new one
+    const metadataKeys = Reflect.getMetadataKeys(originalMethod);
+    metadataKeys.forEach(metadataKey => {
+      const metadataValue = Reflect.getMetadata(metadataKey, originalMethod);
+      Reflect.defineMetadata(metadataKey, metadataValue, descriptor.value);
+    });
   };
 }
 
@@ -102,7 +192,7 @@ export function GrpcStreamCall(
   method?: string,
 ): MethodDecorator;
 export function GrpcStreamCall(
-  service: string,
+  service: string | undefined,
   method?: string,
 ): MethodDecorator {
   return (
diff --git a/packages/microservices/deserializers/identity.deserializer.ts b/packages/microservices/deserializers/identity.deserializer.ts
index 9eccb6621..7a6d1e0d4 100644
--- a/packages/microservices/deserializers/identity.deserializer.ts
+++ b/packages/microservices/deserializers/identity.deserializer.ts
@@ -1,5 +1,8 @@
 import { Deserializer } from '../interfaces/deserializer.interface';
 
+/**
+ * @publicApi
+ */
 export class IdentityDeserializer implements Deserializer {
   deserialize(value: any) {
     return value;
diff --git a/packages/microservices/deserializers/incoming-request.deserializer.ts b/packages/microservices/deserializers/incoming-request.deserializer.ts
index 3e3a6f6f0..537e9b715 100644
--- a/packages/microservices/deserializers/incoming-request.deserializer.ts
+++ b/packages/microservices/deserializers/incoming-request.deserializer.ts
@@ -5,6 +5,9 @@ import {
   IncomingRequest,
 } from '../interfaces';
 
+/**
+ * @publicApi
+ */
 export class IncomingRequestDeserializer implements ConsumerDeserializer {
   deserialize(
     value: any,
diff --git a/packages/microservices/deserializers/incoming-response.deserializer.ts b/packages/microservices/deserializers/incoming-response.deserializer.ts
index 5ea343b1f..55ecc4684 100644
--- a/packages/microservices/deserializers/incoming-response.deserializer.ts
+++ b/packages/microservices/deserializers/incoming-response.deserializer.ts
@@ -1,6 +1,9 @@
 import { isUndefined } from '@nestjs/common/utils/shared.utils';
 import { IncomingResponse, ProducerDeserializer } from '../interfaces';
 
+/**
+ * @publicApi
+ */
 export class IncomingResponseDeserializer implements ProducerDeserializer {
   deserialize(value: any, options?: Record<string, any>): IncomingResponse {
     return this.isExternal(value) ? this.mapToSchema(value) : value;
diff --git a/packages/microservices/deserializers/index.ts b/packages/microservices/deserializers/index.ts
new file mode 100644
index 000000000..21fdbeb26
--- /dev/null
+++ b/packages/microservices/deserializers/index.ts
@@ -0,0 +1,7 @@
+export * from './identity.deserializer';
+export * from './incoming-request.deserializer';
+export * from './incoming-response.deserializer';
+export * from './kafka-request.deserializer';
+export * from './kafka-response.deserializer';
+export * from './nats-request-json.deserializer';
+export * from './nats-response-json.deserializer';
diff --git a/packages/microservices/deserializers/kafka-request.deserializer.ts b/packages/microservices/deserializers/kafka-request.deserializer.ts
new file mode 100644
index 000000000..359321728
--- /dev/null
+++ b/packages/microservices/deserializers/kafka-request.deserializer.ts
@@ -0,0 +1,24 @@
+import { IncomingEvent, IncomingRequest } from '../interfaces';
+import { KafkaRequest } from '../serializers/kafka-request.serializer';
+import { IncomingRequestDeserializer } from './incoming-request.deserializer';
+
+/**
+ * @publicApi
+ */
+export class KafkaRequestDeserializer extends IncomingRequestDeserializer {
+  mapToSchema(
+    data: KafkaRequest,
+    options?: Record<string, any>,
+  ): IncomingRequest | IncomingEvent {
+    if (!options) {
+      return {
+        pattern: undefined,
+        data: undefined,
+      };
+    }
+    return {
+      pattern: options.channel,
+      data: data?.value ?? data,
+    };
+  }
+}
diff --git a/packages/microservices/deserializers/kafka-response.deserializer.ts b/packages/microservices/deserializers/kafka-response.deserializer.ts
index 2b5385458..93d2977b2 100644
--- a/packages/microservices/deserializers/kafka-response.deserializer.ts
+++ b/packages/microservices/deserializers/kafka-response.deserializer.ts
@@ -2,6 +2,9 @@ import { isUndefined } from '@nestjs/common/utils/shared.utils';
 import { KafkaHeaders } from '../enums/kafka-headers.enum';
 import { Deserializer, IncomingResponse } from '../interfaces';
 
+/**
+ * @publicApi
+ */
 export class KafkaResponseDeserializer
   implements Deserializer<any, IncomingResponse>
 {
diff --git a/packages/microservices/deserializers/nats-request-json.deserializer.ts b/packages/microservices/deserializers/nats-request-json.deserializer.ts
index e46851751..e0311041a 100644
--- a/packages/microservices/deserializers/nats-request-json.deserializer.ts
+++ b/packages/microservices/deserializers/nats-request-json.deserializer.ts
@@ -1,10 +1,13 @@
 import { loadPackage } from '@nestjs/common/utils/load-package.util';
-import { NatsCodec } from '../external/nats-client.interface';
+import { NatsCodec } from '../external/nats-codec.interface';
 import { IncomingEvent, IncomingRequest } from '../interfaces';
 import { IncomingRequestDeserializer } from './incoming-request.deserializer';
 
 let natsPackage = {} as any;
 
+/**
+ * @publicApi
+ */
 export class NatsRequestJSONDeserializer extends IncomingRequestDeserializer {
   private readonly jsonCodec: NatsCodec<unknown>;
 
diff --git a/packages/microservices/deserializers/nats-response-json.deserializer.ts b/packages/microservices/deserializers/nats-response-json.deserializer.ts
index 70787afc7..5b81f7512 100644
--- a/packages/microservices/deserializers/nats-response-json.deserializer.ts
+++ b/packages/microservices/deserializers/nats-response-json.deserializer.ts
@@ -1,11 +1,14 @@
 import { loadPackage } from '@nestjs/common/utils/load-package.util';
-import { NatsCodec } from '../external/nats-client.interface';
+import { NatsCodec } from '../external/nats-codec.interface';
 import { IncomingResponse } from '../interfaces';
 import { IncomingResponseDeserializer } from './incoming-response.deserializer';
 import { NatsRequestJSONDeserializer } from './nats-request-json.deserializer';
 
 let natsPackage = {} as any;
 
+/**
+ * @publicApi
+ */
 export class NatsResponseJSONDeserializer extends IncomingResponseDeserializer {
   private readonly jsonCodec: NatsCodec<unknown>;
 
diff --git a/packages/microservices/enums/kafka-headers.enum.ts b/packages/microservices/enums/kafka-headers.enum.ts
index c4c622873..82d5eead2 100644
--- a/packages/microservices/enums/kafka-headers.enum.ts
+++ b/packages/microservices/enums/kafka-headers.enum.ts
@@ -1,5 +1,7 @@
 /**
  * @see https://docs.spring.io/spring-kafka/api/org/springframework/kafka/support/KafkaHeaders.html
+ *
+ * @publicApi
  */
 export enum KafkaHeaders {
   ACKNOWLEDGMENT = 'kafka_acknowledgment',
diff --git a/packages/microservices/enums/rpc-paramtype.enum.ts b/packages/microservices/enums/rpc-paramtype.enum.ts
index 7703df5df..c857e9b49 100644
--- a/packages/microservices/enums/rpc-paramtype.enum.ts
+++ b/packages/microservices/enums/rpc-paramtype.enum.ts
@@ -1,5 +1,7 @@
+import { RouteParamtypes } from '@nestjs/common/enums/route-paramtypes.enum';
+
 export enum RpcParamtype {
-  PAYLOAD = 3,
-  CONTEXT = 6,
-  GRPC_CALL = 9,
+  PAYLOAD = RouteParamtypes.BODY,
+  CONTEXT = RouteParamtypes.HEADERS,
+  GRPC_CALL = RouteParamtypes.FILES,
 }
diff --git a/packages/microservices/errors/corrupted-packet-length.exception.ts b/packages/microservices/errors/corrupted-packet-length.exception.ts
index c00e20a6e..8dea792c5 100644
--- a/packages/microservices/errors/corrupted-packet-length.exception.ts
+++ b/packages/microservices/errors/corrupted-packet-length.exception.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export class CorruptedPacketLengthException extends Error {
   constructor(rawContentLength: string) {
     super(`Corrupted length value "${rawContentLength}" supplied in a packet`);
diff --git a/packages/microservices/errors/empty-response.exception.ts b/packages/microservices/errors/empty-response.exception.ts
index d0b0d7330..1151f8dc4 100644
--- a/packages/microservices/errors/empty-response.exception.ts
+++ b/packages/microservices/errors/empty-response.exception.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export class EmptyResponseException extends Error {
   constructor(pattern: string) {
     super(
diff --git a/packages/microservices/errors/invalid-grpc-message-decorator.exception.ts b/packages/microservices/errors/invalid-grpc-message-decorator.exception.ts
new file mode 100644
index 000000000..ffb4c4534
--- /dev/null
+++ b/packages/microservices/errors/invalid-grpc-message-decorator.exception.ts
@@ -0,0 +1,18 @@
+import { RuntimeException } from '@nestjs/core/errors/exceptions/runtime.exception';
+
+export interface RpcDecoratorMetadata {
+  service: string;
+  rpc: string;
+  streaming: string;
+}
+
+/**
+ * @publicApi
+ */
+export class InvalidGrpcDecoratorException extends RuntimeException {
+  constructor(metadata: RpcDecoratorMetadata) {
+    super(
+      `The invalid gRPC decorator (method "${metadata.rpc}" in service "${metadata.service}")`,
+    );
+  }
+}
diff --git a/packages/microservices/errors/invalid-grpc-package-definition-missing-package-definition.exception.ts b/packages/microservices/errors/invalid-grpc-package-definition-missing-package-definition.exception.ts
new file mode 100644
index 000000000..c5483358e
--- /dev/null
+++ b/packages/microservices/errors/invalid-grpc-package-definition-missing-package-definition.exception.ts
@@ -0,0 +1,9 @@
+import { RuntimeException } from '@nestjs/core/errors/exceptions/runtime.exception';
+
+export class InvalidGrpcPackageDefinitionMissingPackageDefinitionException extends RuntimeException {
+  constructor() {
+    super(
+      `Invalid gRPC configuration. protoPath or packageDefinition must be defined.`,
+    );
+  }
+}
diff --git a/packages/microservices/errors/invalid-grpc-package-definition-mutex.exception.ts b/packages/microservices/errors/invalid-grpc-package-definition-mutex.exception.ts
new file mode 100644
index 000000000..baa4f8be7
--- /dev/null
+++ b/packages/microservices/errors/invalid-grpc-package-definition-mutex.exception.ts
@@ -0,0 +1,9 @@
+import { RuntimeException } from '@nestjs/core/errors/exceptions/runtime.exception';
+
+export class InvalidGrpcPackageDefinitionMutexException extends RuntimeException {
+  constructor() {
+    super(
+      `Invalid gRPC configuration. Both protoPath and packageDefinition cannot be defined at the same time.`,
+    );
+  }
+}
diff --git a/packages/microservices/errors/invalid-grpc-package.exception.ts b/packages/microservices/errors/invalid-grpc-package.exception.ts
index d9f044f33..a0599e457 100644
--- a/packages/microservices/errors/invalid-grpc-package.exception.ts
+++ b/packages/microservices/errors/invalid-grpc-package.exception.ts
@@ -1,7 +1,10 @@
 import { RuntimeException } from '@nestjs/core/errors/exceptions/runtime.exception';
 
+/**
+ * @publicApi
+ */
 export class InvalidGrpcPackageException extends RuntimeException {
-  constructor() {
-    super('The invalid gRPC package (package not found)');
+  constructor(name: string) {
+    super(`The invalid gRPC package (package "${name}" not found)`);
   }
 }
diff --git a/packages/microservices/errors/invalid-grpc-service.exception.ts b/packages/microservices/errors/invalid-grpc-service.exception.ts
index 0a0a1d489..1da6a18c8 100644
--- a/packages/microservices/errors/invalid-grpc-service.exception.ts
+++ b/packages/microservices/errors/invalid-grpc-service.exception.ts
@@ -1,7 +1,10 @@
 import { RuntimeException } from '@nestjs/core/errors/exceptions/runtime.exception';
 
+/**
+ * @publicApi
+ */
 export class InvalidGrpcServiceException extends RuntimeException {
-  constructor() {
-    super(`The invalid gRPC service (service not found)`);
+  constructor(name: string) {
+    super(`The invalid gRPC service (service "${name}" not found)`);
   }
 }
diff --git a/packages/microservices/errors/invalid-json-format.exception.ts b/packages/microservices/errors/invalid-json-format.exception.ts
index ef7f69108..ac830a49b 100644
--- a/packages/microservices/errors/invalid-json-format.exception.ts
+++ b/packages/microservices/errors/invalid-json-format.exception.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export class InvalidJSONFormatException extends Error {
   constructor(err: Error, data: string) {
     super(`Could not parse JSON: ${err.message}\nRequest data: ${data}`);
diff --git a/packages/microservices/errors/invalid-kafka-client-topic.exception.ts b/packages/microservices/errors/invalid-kafka-client-topic.exception.ts
index aa0062569..12871369f 100644
--- a/packages/microservices/errors/invalid-kafka-client-topic.exception.ts
+++ b/packages/microservices/errors/invalid-kafka-client-topic.exception.ts
@@ -1,5 +1,8 @@
 import { RuntimeException } from '@nestjs/core/errors/exceptions/runtime.exception';
 
+/**
+ * @publicApi
+ */
 export class InvalidKafkaClientTopicException extends RuntimeException {
   constructor(topic?: string) {
     super(
diff --git a/packages/microservices/errors/invalid-message.exception.ts b/packages/microservices/errors/invalid-message.exception.ts
index cc1627b87..6b8c0e9ee 100644
--- a/packages/microservices/errors/invalid-message.exception.ts
+++ b/packages/microservices/errors/invalid-message.exception.ts
@@ -1,5 +1,8 @@
 import { RuntimeException } from '@nestjs/core/errors/exceptions/runtime.exception';
 
+/**
+ * @publicApi
+ */
 export class InvalidMessageException extends RuntimeException {
   constructor() {
     super(`The invalid data or message pattern (undefined/null)`);
diff --git a/packages/microservices/errors/invalid-proto-definition.exception.ts b/packages/microservices/errors/invalid-proto-definition.exception.ts
index ac2d2c8f8..28ce445a0 100644
--- a/packages/microservices/errors/invalid-proto-definition.exception.ts
+++ b/packages/microservices/errors/invalid-proto-definition.exception.ts
@@ -1,7 +1,10 @@
 import { RuntimeException } from '@nestjs/core/errors/exceptions/runtime.exception';
 
+/**
+ * @publicApi
+ */
 export class InvalidProtoDefinitionException extends RuntimeException {
-  constructor() {
-    super('The invalid .proto definition (file not found)');
+  constructor(path: string) {
+    super(`The invalid .proto definition (file at "${path}" not found)`);
   }
 }
diff --git a/packages/microservices/errors/max-packet-length-exceeded.exception.ts b/packages/microservices/errors/max-packet-length-exceeded.exception.ts
new file mode 100644
index 000000000..5d2ccd3c7
--- /dev/null
+++ b/packages/microservices/errors/max-packet-length-exceeded.exception.ts
@@ -0,0 +1,8 @@
+/**
+ * @publicApi
+ */
+export class MaxPacketLengthExceededException extends Error {
+  constructor(length: number) {
+    super(`The packet length (${length}) exceeds the maximum allowed length`);
+  }
+}
diff --git a/packages/microservices/errors/net-socket-closed.exception.ts b/packages/microservices/errors/net-socket-closed.exception.ts
index 3453aaaa7..9f20bbd0d 100644
--- a/packages/microservices/errors/net-socket-closed.exception.ts
+++ b/packages/microservices/errors/net-socket-closed.exception.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export class NetSocketClosedException extends Error {
   constructor() {
     super(`The net socket is closed.`);
diff --git a/packages/microservices/events/index.ts b/packages/microservices/events/index.ts
new file mode 100644
index 000000000..df8d4959f
--- /dev/null
+++ b/packages/microservices/events/index.ts
@@ -0,0 +1,6 @@
+export { KafkaStatus } from './kafka.events';
+export { MqttEvents, MqttStatus } from './mqtt.events';
+export { NatsEvents, NatsStatus } from './nats.events';
+export { RedisEvents, RedisStatus } from './redis.events';
+export { RmqEvents, RmqStatus } from './rmq.events';
+export { TcpEvents, TcpStatus } from './tcp.events';
diff --git a/packages/microservices/events/kafka.events.ts b/packages/microservices/events/kafka.events.ts
new file mode 100644
index 000000000..614964f87
--- /dev/null
+++ b/packages/microservices/events/kafka.events.ts
@@ -0,0 +1,7 @@
+export const enum KafkaStatus {
+  DISCONNECTED = 'disconnected',
+  CONNECTED = 'connected',
+  CRASHED = 'crashed',
+  STOPPED = 'stopped',
+  REBALANCING = 'rebalancing',
+}
diff --git a/packages/microservices/events/mqtt.events.ts b/packages/microservices/events/mqtt.events.ts
new file mode 100644
index 000000000..f1d935e3f
--- /dev/null
+++ b/packages/microservices/events/mqtt.events.ts
@@ -0,0 +1,39 @@
+type VoidCallback = () => void;
+type OnPacketCallback = (packet: any) => void;
+type OnErrorCallback = (error: Error) => void;
+
+export const enum MqttStatus {
+  DISCONNECTED = 'disconnected',
+  RECONNECTING = 'reconnecting',
+  CONNECTED = 'connected',
+  CLOSED = 'closed',
+}
+
+export const enum MqttEventsMap {
+  CONNECT = 'connect',
+  RECONNECT = 'reconnect',
+  DISCONNECT = 'disconnect',
+  CLOSE = 'close',
+  OFFLINE = 'offline',
+  END = 'end',
+  ERROR = 'error',
+  PACKETRECEIVE = 'packetreceive',
+  PACKETSEND = 'packetsend',
+}
+
+/**
+ * MQTT events map for the MQTT client.
+ * Key is the event name and value is the corresponding callback function.
+ * @publicApi
+ */
+export type MqttEvents = {
+  connect: OnPacketCallback;
+  reconnect: VoidCallback;
+  disconnect: OnPacketCallback;
+  close: VoidCallback;
+  offline: VoidCallback;
+  end: VoidCallback;
+  error: OnErrorCallback;
+  packetreceive: OnPacketCallback;
+  packetsend: OnPacketCallback;
+};
diff --git a/packages/microservices/events/nats.events.ts b/packages/microservices/events/nats.events.ts
new file mode 100644
index 000000000..30cc734e8
--- /dev/null
+++ b/packages/microservices/events/nats.events.ts
@@ -0,0 +1,29 @@
+type DefaultCallback = (data?: string | number) => any;
+
+export type ServersChangedEvent = {
+  added: string[];
+  deleted: string[];
+};
+
+export const enum NatsStatus {
+  DISCONNECTED = 'disconnected',
+  RECONNECTING = 'reconnecting',
+  CONNECTED = 'connected',
+}
+
+export const enum NatsEventsMap {
+  DISCONNECT = 'disconnect',
+  RECONNECT = 'reconnect',
+  UPDATE = 'update',
+}
+
+/**
+ * Nats events map for the Nats client.
+ * Key is the event name and value is the corresponding callback function.
+ * @publicApi
+ */
+export type NatsEvents = {
+  disconnect: DefaultCallback;
+  reconnect: DefaultCallback;
+  update: (data?: string | number | ServersChangedEvent) => any;
+};
diff --git a/packages/microservices/events/redis.events.ts b/packages/microservices/events/redis.events.ts
new file mode 100644
index 000000000..c89b46955
--- /dev/null
+++ b/packages/microservices/events/redis.events.ts
@@ -0,0 +1,34 @@
+type VoidCallback = (client: 'pub' | 'sub') => void;
+type OnErrorCallback = (client: 'pub' | 'sub', error: Error) => void;
+type OnWarningCallback = (client: 'pub' | 'sub', warning: any) => void;
+
+export const enum RedisStatus {
+  DISCONNECTED = 'disconnected',
+  RECONNECTING = 'reconnecting',
+  CONNECTED = 'connected',
+}
+
+export const enum RedisEventsMap {
+  CONNECT = 'connect',
+  READY = 'ready',
+  ERROR = 'error',
+  CLOSE = 'close',
+  RECONNECTING = 'reconnecting',
+  END = 'end',
+  WARNING = 'warning',
+}
+
+/**
+ * Redis events map for the Redis client.
+ * Key is the event name and value is the corresponding callback function.
+ * @publicApi
+ */
+export type RedisEvents = {
+  connect: VoidCallback;
+  ready: VoidCallback;
+  error: OnErrorCallback;
+  close: VoidCallback;
+  reconnecting: VoidCallback;
+  end: VoidCallback;
+  warning: OnWarningCallback;
+};
diff --git a/packages/microservices/events/rmq.events.ts b/packages/microservices/events/rmq.events.ts
new file mode 100644
index 000000000..aba888901
--- /dev/null
+++ b/packages/microservices/events/rmq.events.ts
@@ -0,0 +1,24 @@
+type VoidCallback = () => void;
+type OnErrorCallback = (error: Error) => void;
+
+export const enum RmqStatus {
+  DISCONNECTED = 'disconnected',
+  CONNECTED = 'connected',
+}
+
+export const enum RmqEventsMap {
+  ERROR = 'error',
+  DISCONNECT = 'disconnect',
+  CONNECT = 'connect',
+}
+
+/**
+ * RabbitMQ events map for the ampqlip client.
+ * Key is the event name and value is the corresponding callback function.
+ * @publicApi
+ */
+export type RmqEvents = {
+  error: OnErrorCallback;
+  disconnect: VoidCallback;
+  connect: VoidCallback;
+};
diff --git a/packages/microservices/events/tcp.events.ts b/packages/microservices/events/tcp.events.ts
new file mode 100644
index 000000000..3ba328855
--- /dev/null
+++ b/packages/microservices/events/tcp.events.ts
@@ -0,0 +1,39 @@
+type VoidCallback = () => void;
+type OnErrorCallback = (error: Error) => void;
+type OnLookupCallback = (
+  err: Error,
+  address: string,
+  family: string,
+  host: string,
+) => void;
+
+export const enum TcpStatus {
+  DISCONNECTED = 'disconnected',
+  CONNECTED = 'connected',
+}
+
+export const enum TcpEventsMap {
+  ERROR = 'error',
+  CONNECT = 'connect',
+  END = 'end',
+  CLOSE = 'close',
+  TIMEOUT = 'timeout',
+  DRAIN = 'drain',
+  LOOKUP = 'lookup',
+  LISTENING = 'listening',
+}
+
+/**
+ * TCP events map for the net TCP socket.
+ * Key is the event name and value is the corresponding callback function.
+ * @publicApi
+ */
+export type TcpEvents = {
+  error: OnErrorCallback;
+  connect: VoidCallback;
+  end: VoidCallback;
+  close: VoidCallback;
+  timeout: VoidCallback;
+  drain: VoidCallback;
+  lookup: OnLookupCallback;
+};
diff --git a/packages/microservices/exceptions/base-rpc-exception-filter.ts b/packages/microservices/exceptions/base-rpc-exception-filter.ts
index 1c42d24b6..5773502a5 100644
--- a/packages/microservices/exceptions/base-rpc-exception-filter.ts
+++ b/packages/microservices/exceptions/base-rpc-exception-filter.ts
@@ -1,10 +1,17 @@
-/* eslint-disable prefer-spread */
-import { ArgumentsHost, Logger, RpcExceptionFilter } from '@nestjs/common';
+import {
+  ArgumentsHost,
+  IntrinsicException,
+  Logger,
+  RpcExceptionFilter,
+} from '@nestjs/common';
 import { isObject } from '@nestjs/common/utils/shared.utils';
 import { MESSAGES } from '@nestjs/core/constants';
 import { Observable, throwError as _throw } from 'rxjs';
 import { RpcException } from './rpc-exception';
 
+/**
+ * @publicApi
+ */
 export class BaseRpcExceptionFilter<T = any, R = any>
   implements RpcExceptionFilter<T>
 {
@@ -23,11 +30,10 @@ export class BaseRpcExceptionFilter<T = any, R = any>
   public handleUnknownError(exception: T, status: string) {
     const errorMessage = MESSAGES.UNKNOWN_EXCEPTION_MESSAGE;
 
-    const loggerArgs = this.isError(exception)
-      ? [exception.message, exception.stack]
-      : [exception];
-    const logger = BaseRpcExceptionFilter.logger;
-    logger.error.apply(logger, loggerArgs as any);
+    if (!(exception instanceof IntrinsicException)) {
+      const logger = BaseRpcExceptionFilter.logger;
+      logger.error(exception);
+    }
 
     return _throw(() => ({ status, message: errorMessage }));
   }
diff --git a/packages/microservices/exceptions/index.ts b/packages/microservices/exceptions/index.ts
index dd6e4d298..73e4c3176 100644
--- a/packages/microservices/exceptions/index.ts
+++ b/packages/microservices/exceptions/index.ts
@@ -1,2 +1,3 @@
 export * from './base-rpc-exception-filter';
+export * from './kafka-retriable-exception';
 export * from './rpc-exception';
diff --git a/packages/microservices/exceptions/kafka-retriable-exception.ts b/packages/microservices/exceptions/kafka-retriable-exception.ts
new file mode 100644
index 000000000..c62194a2e
--- /dev/null
+++ b/packages/microservices/exceptions/kafka-retriable-exception.ts
@@ -0,0 +1,17 @@
+import { RpcException } from './rpc-exception';
+
+/**
+ * Exception that instructs Kafka driver to instead of introspecting
+ * error processing flow and sending serialized error message to the consumer,
+ * force bubble it up to the "eachMessage" callback of the underlying "kafkajs" package
+ * (even if interceptors are applied, or an observable stream is returned from the message handler).
+ *
+ * A transient exception that if retried may succeed.
+ *
+ * @publicApi
+ */
+export class KafkaRetriableException extends RpcException {
+  public getError(): string | object {
+    return this;
+  }
+}
diff --git a/packages/microservices/exceptions/rpc-exception.ts b/packages/microservices/exceptions/rpc-exception.ts
index 1d59c61c7..107574a74 100644
--- a/packages/microservices/exceptions/rpc-exception.ts
+++ b/packages/microservices/exceptions/rpc-exception.ts
@@ -1,5 +1,8 @@
 import { isObject, isString } from '@nestjs/common/utils/shared.utils';
 
+/**
+ * @publicApi
+ */
 export class RpcException extends Error {
   constructor(private readonly error: string | object) {
     super();
@@ -16,7 +19,7 @@ export class RpcException extends Error {
       this.message = (this.error as Record<string, any>).message;
     } else if (this.constructor) {
       this.message = this.constructor.name
-        .match(/[A-Z][a-z]+|[0-9]+/g)
+        .match(/[A-Z][a-z]+|[0-9]+/g)!
         .join(' ');
     }
   }
diff --git a/packages/microservices/exceptions/rpc-exceptions-handler.ts b/packages/microservices/exceptions/rpc-exceptions-handler.ts
index 7815c80d1..f551bd953 100644
--- a/packages/microservices/exceptions/rpc-exceptions-handler.ts
+++ b/packages/microservices/exceptions/rpc-exceptions-handler.ts
@@ -1,16 +1,20 @@
 import { RpcExceptionFilterMetadata } from '@nestjs/common/interfaces/exceptions';
 import { ArgumentsHost } from '@nestjs/common/interfaces/features/arguments-host.interface';
+import { selectExceptionFilterMetadata } from '@nestjs/common/utils/select-exception-filter-metadata.util';
 import { isEmpty } from '@nestjs/common/utils/shared.utils';
 import { InvalidExceptionFilterException } from '@nestjs/core/errors/exceptions/invalid-exception-filter.exception';
 import { Observable } from 'rxjs';
 import { BaseRpcExceptionFilter } from './base-rpc-exception-filter';
 import { RpcException } from './rpc-exception';
 
+/**
+ * @publicApi
+ */
 export class RpcExceptionsHandler extends BaseRpcExceptionFilter {
   private filters: RpcExceptionFilterMetadata[] = [];
 
   public handle(
-    exception: Error | RpcException | any,
+    exception: Error | RpcException,
     host: ArgumentsHost,
   ): Observable<any> {
     const filterResult$ = this.invokeCustomFilters(exception, host);
@@ -34,14 +38,8 @@ export class RpcExceptionsHandler extends BaseRpcExceptionFilter {
     if (isEmpty(this.filters)) {
       return null;
     }
-    const filter = this.filters.find(({ exceptionMetatypes }) => {
-      const hasMetatype =
-        !exceptionMetatypes.length ||
-        exceptionMetatypes.some(
-          ExceptionMetatype => exception instanceof ExceptionMetatype,
-        );
-      return hasMetatype;
-    });
+
+    const filter = selectExceptionFilterMetadata(this.filters, exception);
     return filter ? filter.func(exception, host) : null;
   }
 }
diff --git a/packages/microservices/external/grpc-options.interface.ts b/packages/microservices/external/grpc-options.interface.ts
index f00fb4cb7..51ceac477 100644
--- a/packages/microservices/external/grpc-options.interface.ts
+++ b/packages/microservices/external/grpc-options.interface.ts
@@ -1,6 +1,8 @@
 /**
  * An interface that contains options used when initializing a Channel instance.
  * This listing is incomplete. Full reference: https://grpc.github.io/grpc/core/group__grpc__arg__keys.html
+ *
+ * @publicApi
  */
 export interface ChannelOptions {
   'grpc.max_send_message_length'?: number;
@@ -16,5 +18,5 @@ export interface ChannelOptions {
   'grpc.max_reconnect_backoff_ms'?: number;
   'grpc.use_local_subchannel_pool'?: number;
   'grpc-node.max_session_memory'?: number;
-  [key: string]: string | number | undefined;
+  [key: string]: any;
 }
diff --git a/packages/microservices/external/kafka.interface.ts b/packages/microservices/external/kafka.interface.ts
index ea7a29a4c..e0baefa74 100644
--- a/packages/microservices/external/kafka.interface.ts
+++ b/packages/microservices/external/kafka.interface.ts
@@ -2,10 +2,12 @@
  * Do NOT add NestJS logic to this interface.  It is meant to ONLY represent the types for the kafkajs package.
  *
  * @see https://github.com/tulios/kafkajs/blob/master/types/index.d.ts
+ *
+ * @publicApi
+ *
  */
 
 /// <reference types="node" />
-
 import * as net from 'net';
 import * as tls from 'tls';
 
@@ -17,17 +19,48 @@ type XOR<T, U> = T | U extends object
 export declare class Kafka {
   constructor(config: KafkaConfig);
   producer(config?: ProducerConfig): Producer;
-  consumer(config?: ConsumerConfig): Consumer;
+  consumer(config: ConsumerConfig): Consumer;
   admin(config?: AdminConfig): Admin;
   logger(): Logger;
 }
 
 export type BrokersFunction = () => string[] | Promise<string[]>;
 
+type SaslAuthenticationRequest = {
+  encode: () => Buffer | Promise<Buffer>;
+};
+type SaslAuthenticationResponse<ParseResult> = {
+  decode: (rawResponse: Buffer) => Buffer | Promise<Buffer>;
+  parse: (data: Buffer) => ParseResult;
+};
+
+type Authenticator = {
+  authenticate: () => Promise<void>;
+};
+
+export type SaslAuthenticateArgs<ParseResult> = {
+  request: SaslAuthenticationRequest;
+  response?: SaslAuthenticationResponse<ParseResult>;
+};
+
+type AuthenticationProviderArgs = {
+  host: string;
+  port: number;
+  logger: Logger;
+  saslAuthenticate: <ParseResult>(
+    args: SaslAuthenticateArgs<ParseResult>,
+  ) => Promise<ParseResult | void>;
+};
+
+type Mechanism = {
+  mechanism: string;
+  authenticationProvider: (args: AuthenticationProviderArgs) => Authenticator;
+};
+
 export interface KafkaConfig {
   brokers: string[] | BrokersFunction;
   ssl?: tls.ConnectionOptions | boolean;
-  sasl?: SASLOptions;
+  sasl?: SASLOptions | Mechanism;
   clientId?: string;
   connectionTimeout?: number;
   authenticationTimeout?: number;
@@ -101,11 +134,18 @@ export interface PartitionerArgs {
 
 export type ICustomPartitioner = () => (args: PartitionerArgs) => number;
 export type DefaultPartitioner = ICustomPartitioner;
-export type JavaCompatiblePartitioner = ICustomPartitioner;
+export type LegacyPartitioner = ICustomPartitioner;
 
 export let Partitioners: {
   DefaultPartitioner: DefaultPartitioner;
-  JavaCompatiblePartitioner: JavaCompatiblePartitioner;
+  LegacyPartitioner: LegacyPartitioner;
+  /**
+   * @deprecated Use DefaultPartitioner instead
+   *
+   * The JavaCompatiblePartitioner was renamed DefaultPartitioner
+   * and made to be the default in 2.0.0.
+   */
+  JavaCompatiblePartitioner: DefaultPartitioner;
 };
 
 export type PartitionMetadata = {
@@ -118,7 +158,7 @@ export type PartitionMetadata = {
 };
 
 export interface IHeaders {
-  [key: string]: Buffer | string | undefined;
+  [key: string]: Buffer | string | (Buffer | string)[] | undefined;
 }
 
 export interface ConsumerConfig {
@@ -141,7 +181,11 @@ export interface ConsumerConfig {
   rackId?: string;
 }
 
-export type PartitionAssigner = (config: { cluster: Cluster }) => Assigner;
+export type PartitionAssigner = (config: {
+  cluster: Cluster;
+  groupId: string;
+  logger: Logger;
+}) => Assigner;
 
 export interface CoordinatorMetadata {
   errorCode: number;
@@ -153,6 +197,10 @@ export interface CoordinatorMetadata {
 }
 
 export type Cluster = {
+  getNodeIds(): number[];
+  metadata(): Promise<BrokerMetadata>;
+  removeBroker(options: { host: string; port: number }): void;
+  addMultipleTargetTopics(topics: string[]): Promise<void>;
   isConnected(): boolean;
   connect(): Promise<void>;
   disconnect(): Promise<void>;
@@ -178,10 +226,7 @@ export type Cluster = {
         partitions: Array<{ partition: number }>;
       } & XOR<{ fromBeginning: boolean }, { fromTimestamp: number }>
     >,
-  ): Promise<{
-    topic: string;
-    partitions: Array<{ partition: number; offset: string }>;
-  }>;
+  ): Promise<TopicOffsets[]>;
 };
 
 export type Assignment = { [topic: string]: number[] };
@@ -211,6 +256,7 @@ export interface RetryOptions {
   factor?: number;
   multiplier?: number;
   retries?: number;
+  restartOnFailure?: (e: Error) => Promise<boolean>;
 }
 
 export interface AdminConfig {
@@ -222,7 +268,7 @@ export interface ITopicConfig {
   numPartitions?: number;
   replicationFactor?: number;
   replicaAssignment?: object[];
-  configEntries?: object[];
+  configEntries?: IResourceConfigEntry[];
 }
 
 export interface ITopicPartitionConfig {
@@ -236,20 +282,6 @@ export interface ITopicMetadata {
   partitions: PartitionMetadata[];
 }
 
-/**
- * @deprecated
- * Use ConfigResourceTypes or AclResourceTypes
- */
-export enum ResourceTypes {
-  UNKNOWN = 0,
-  ANY = 1,
-  TOPIC = 2,
-  GROUP = 3,
-  CLUSTER = 4,
-  TRANSACTIONAL_ID = 5,
-  DELEGATION_TOKEN = 6,
-}
-
 export enum AclResourceTypes {
   UNKNOWN = 0,
   ANY = 1,
@@ -267,6 +299,16 @@ export enum ConfigResourceTypes {
   BROKER_LOGGER = 8,
 }
 
+export enum ConfigSource {
+  UNKNOWN = 0,
+  TOPIC_CONFIG = 1,
+  DYNAMIC_BROKER_CONFIG = 2,
+  DYNAMIC_DEFAULT_BROKER_CONFIG = 3,
+  STATIC_BROKER_CONFIG = 4,
+  DEFAULT_CONFIG = 5,
+  DYNAMIC_BROKER_LOGGER_CONFIG = 6,
+}
+
 export enum AclPermissionTypes {
   UNKNOWN = 0,
   ANY = 1,
@@ -299,7 +341,7 @@ export enum ResourcePatternTypes {
 }
 
 export interface ResourceConfigQuery {
-  type: ResourceTypes | ConfigResourceTypes;
+  type: ConfigResourceTypes;
   name: string;
   configNames?: string[];
 }
@@ -308,6 +350,7 @@ export interface ConfigEntries {
   configName: string;
   configValue: string;
   isDefault: boolean;
+  configSource: ConfigSource;
   isSensitive: boolean;
   readOnly: boolean;
   configSynonyms: ConfigSynonyms[];
@@ -316,7 +359,7 @@ export interface ConfigEntries {
 export interface ConfigSynonyms {
   configName: string;
   configValue: string;
-  configSource: number;
+  configSource: ConfigSource;
 }
 
 export interface DescribeConfigResponse {
@@ -325,15 +368,20 @@ export interface DescribeConfigResponse {
     errorCode: number;
     errorMessage: string;
     resourceName: string;
-    resourceType: ResourceTypes | ConfigResourceTypes;
+    resourceType: ConfigResourceTypes;
   }[];
   throttleTime: number;
 }
 
+export interface IResourceConfigEntry {
+  name: string;
+  value: string;
+}
+
 export interface IResourceConfig {
-  type: ResourceTypes | ConfigResourceTypes;
+  type: ConfigResourceTypes;
   name: string;
-  configEntries: { name: string; value: string }[];
+  configEntries: IResourceConfigEntry[];
 }
 
 type ValueOf<T> = T[keyof T];
@@ -387,11 +435,11 @@ export type RequestQueueSizeEvent = InstrumentationEvent<{
   queueSize: number;
 }>;
 
-export interface SeekEntry {
-  partition: number;
-  offset: string;
-}
+export type SeekEntry = PartitionOffset;
 
+export type FetchOffsetsPartition = PartitionOffset & {
+  metadata: string | null;
+};
 export interface Acl {
   principal: string;
   host: string;
@@ -408,7 +456,7 @@ export interface AclResource {
 export type AclEntry = Acl & AclResource;
 
 export type DescribeAclResource = AclResource & {
-  acl: Acl[];
+  acls: Acl[];
 };
 
 export interface DescribeAclResponse {
@@ -472,9 +520,9 @@ export type Admin = {
   }): Promise<{ topics: Array<ITopicMetadata> }>;
   fetchOffsets(options: {
     groupId: string;
-    topic: string;
+    topics?: string[];
     resolveOffsets?: boolean;
-  }): Promise<Array<SeekEntry & { metadata: string | null }>>;
+  }): Promise<Array<{ topic: string; partitions: FetchOffsetsPartition[] }>>;
   fetchTopicOffsets(
     topic: string,
   ): Promise<Array<SeekEntry & { high: string; low: string }>>;
@@ -516,11 +564,31 @@ export type Admin = {
     partitions: SeekEntry[];
   }): Promise<void>;
   logger(): Logger;
+  on(
+    eventName: AdminEvents['CONNECT'],
+    listener: (event: ConnectEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: AdminEvents['DISCONNECT'],
+    listener: (event: DisconnectEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: AdminEvents['REQUEST'],
+    listener: (event: RequestEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: AdminEvents['REQUEST_QUEUE_SIZE'],
+    listener: (event: RequestQueueSizeEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: AdminEvents['REQUEST_TIMEOUT'],
+    listener: (event: RequestTimeoutEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
   on(
     eventName: ValueOf<AdminEvents>,
-    listener: (...args: any[]) => void,
+    listener: (event: InstrumentationEvent<any>) => void,
   ): RemoveInstrumentationEventListener<typeof eventName>;
-  events: AdminEvents;
+  readonly events: AdminEvents;
 };
 
 export let PartitionAssigners: { roundRobin: PartitionAssigner };
@@ -563,7 +631,7 @@ export interface LogEntry {
 }
 
 export interface LoggerEntryContent {
-  readonly timestamp: Date;
+  readonly timestamp: string;
   readonly message: string;
   [key: string]: any;
 }
@@ -575,38 +643,44 @@ export type Logger = {
   error: (message: string, extra?: object) => void;
   warn: (message: string, extra?: object) => void;
   debug: (message: string, extra?: object) => void;
+
+  namespace: (namespace: string, logLevel?: logLevel) => Logger;
+  setLogLevel: (logLevel: logLevel) => void;
 };
 
+export interface BrokerMetadata {
+  brokers: Array<{ nodeId: number; host: string; port: number; rack?: string }>;
+  topicMetadata: Array<{
+    topicErrorCode: number;
+    topic: string;
+    partitionMetadata: PartitionMetadata[];
+  }>;
+}
+
+export interface ApiVersions {
+  [apiKey: number]: {
+    minVersion: number;
+    maxVersion: number;
+  };
+}
+
 export type Broker = {
   isConnected(): boolean;
   connect(): Promise<void>;
   disconnect(): Promise<void>;
-  apiVersions(): Promise<{
-    [apiKey: number]: { minVersion: number; maxVersion: number };
-  }>;
-  metadata(topics: string[]): Promise<{
-    brokers: Array<{
-      nodeId: number;
-      host: string;
-      port: number;
-      rack?: string;
-    }>;
-    topicMetadata: Array<{
-      topicErrorCode: number;
-      topic: number;
-      partitionMetadata: PartitionMetadata[];
-    }>;
-  }>;
+  apiVersions(): Promise<ApiVersions>;
+  metadata(topics: string[]): Promise<BrokerMetadata>;
+  describeGroups: (options: { groupIds: string[] }) => Promise<any>;
   offsetCommit(request: {
     groupId: string;
     groupGenerationId: number;
     memberId: string;
     retentionTime?: number;
-    topics: Array<{
-      topic: string;
-      partitions: Array<{ partition: number; offset: string }>;
-    }>;
+    topics: TopicOffsets[];
   }): Promise<any>;
+  offsetFetch(request: { groupId: string; topics: TopicOffsets[] }): Promise<{
+    responses: TopicOffsets[];
+  }>;
   fetch(request: {
     replicaId?: number;
     isolationLevel?: number;
@@ -623,17 +697,45 @@ export type Broker = {
     }>;
     rackId?: string;
   }): Promise<any>;
+  produce(request: {
+    topicData: Array<{
+      topic: string;
+      partitions: Array<{
+        partition: number;
+        firstSequence?: number;
+        messages: Message[];
+      }>;
+    }>;
+    transactionalId?: string;
+    producerId?: number;
+    producerEpoch?: number;
+    acks?: number;
+    timeout?: number;
+    compression?: CompressionTypes;
+  }): Promise<any>;
 };
 
-export type KafkaMessage = {
-  key: Buffer;
+interface MessageSetEntry {
+  key: Buffer | null;
   value: Buffer | null;
   timestamp: string;
+  attributes: number;
+  offset: string;
   size: number;
+  headers?: never;
+}
+
+interface RecordBatchEntry {
+  key: Buffer | null;
+  value: Buffer | null;
+  timestamp: string;
   attributes: number;
   offset: string;
-  headers?: IHeaders;
-};
+  headers: IHeaders;
+  size?: never;
+}
+
+export type KafkaMessage = MessageSetEntry | RecordBatchEntry;
 
 export interface ProducerRecord {
   topic: string;
@@ -697,10 +799,30 @@ export type Producer = Sender & {
   connect(): Promise<void>;
   disconnect(): Promise<void>;
   isIdempotent(): boolean;
-  events: ProducerEvents;
+  readonly events: ProducerEvents;
+  on(
+    eventName: ProducerEvents['CONNECT'],
+    listener: (event: ConnectEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ProducerEvents['DISCONNECT'],
+    listener: (event: DisconnectEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ProducerEvents['REQUEST'],
+    listener: (event: RequestEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ProducerEvents['REQUEST_QUEUE_SIZE'],
+    listener: (event: RequestQueueSizeEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ProducerEvents['REQUEST_TIMEOUT'],
+    listener: (event: RequestTimeoutEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
   on(
     eventName: ValueOf<ProducerEvents>,
-    listener: (...args: any[]) => void,
+    listener: (event: InstrumentationEvent<any>) => void,
   ): RemoveInstrumentationEventListener<typeof eventName>;
   transaction(): Promise<Transaction>;
   logger(): Logger;
@@ -750,16 +872,18 @@ export type GroupDescriptions = {
 };
 
 export type TopicPartitions = { topic: string; partitions: number[] };
-export type TopicPartitionOffsetAndMetadata = {
+
+export type TopicPartition = {
   topic: string;
   partition: number;
+};
+export type TopicPartitionOffset = TopicPartition & {
   offset: string;
+};
+export type TopicPartitionOffsetAndMetadata = TopicPartitionOffset & {
   metadata?: string | null;
 };
 
-// TODO: Remove with 2.x
-export type TopicPartitionOffsetAndMedata = TopicPartitionOffsetAndMetadata;
-
 export type Batch = {
   topic: string;
   partition: number;
@@ -795,6 +919,7 @@ export type ConsumerEvents = {
   DISCONNECT: 'consumer.disconnect';
   STOP: 'consumer.stop';
   CRASH: 'consumer.crash';
+  REBALANCING: 'consumer.rebalancing';
   RECEIVED_UNSUBSCRIBED_TOPICS: 'consumer.received_unsubscribed_topics';
   REQUEST: 'consumer.network.request';
   REQUEST_TIMEOUT: 'consumer.network.request_timeout';
@@ -809,13 +934,7 @@ export type ConsumerCommitOffsetsEvent = InstrumentationEvent<{
   groupId: string;
   memberId: string;
   groupGenerationId: number;
-  topics: {
-    topic: string;
-    partitions: {
-      offset: string;
-      partition: string;
-    }[];
-  }[];
+  topics: TopicOffsets[];
 }>;
 export interface IMemberAssignment {
   [key: string]: number[];
@@ -829,9 +948,11 @@ export type ConsumerGroupJoinEvent = InstrumentationEvent<{
   memberId: string;
   memberAssignment: IMemberAssignment;
 }>;
+export type ConsumerFetchStartEvent = InstrumentationEvent<{ nodeId: number }>;
 export type ConsumerFetchEvent = InstrumentationEvent<{
   numberOfBatches: number;
   duration: number;
+  nodeId: number;
 }>;
 interface IBatchProcessEvent {
   topic: string;
@@ -853,7 +974,11 @@ export type ConsumerCrashEvent = InstrumentationEvent<{
   groupId: string;
   restart: boolean;
 }>;
-export type ConsumerReceivedUnsubcribedTopicsEvent = InstrumentationEvent<{
+export type ConsumerRebalancingEvent = InstrumentationEvent<{
+  groupId: string;
+  memberId: string;
+}>;
+export type ConsumerReceivedUnsubscribedTopicsEvent = InstrumentationEvent<{
   groupId: string;
   generationId: number;
   memberId: string;
@@ -870,12 +995,15 @@ export interface EachMessagePayload {
   topic: string;
   partition: number;
   message: KafkaMessage;
+  heartbeat(): Promise<void>;
+  pause(): () => void;
 }
 
 export interface EachBatchPayload {
   batch: Batch;
   resolveOffset(offset: string): void;
   heartbeat(): Promise<void>;
+  pause(): () => void;
   commitOffsetsIfNecessary(offsets?: Offsets): Promise<void>;
   uncommittedOffsets(): OffsetsByTopicPartition;
   isRunning(): boolean;
@@ -894,45 +1022,117 @@ export type ConsumerEachMessagePayload = EachMessagePayload;
  */
 export type ConsumerEachBatchPayload = EachBatchPayload;
 
+export type EachBatchHandler = (payload: EachBatchPayload) => Promise<void>;
+export type EachMessageHandler = (payload: EachMessagePayload) => Promise<void>;
+
 export type ConsumerRunConfig = {
   autoCommit?: boolean;
   autoCommitInterval?: number | null;
   autoCommitThreshold?: number | null;
   eachBatchAutoResolve?: boolean;
   partitionsConsumedConcurrently?: number;
-  eachBatch?: (payload: EachBatchPayload) => Promise<void>;
-  eachMessage?: (payload: EachMessagePayload) => Promise<void>;
+  eachBatch?: EachBatchHandler;
+  eachMessage?: EachMessageHandler;
 };
 
+/**
+ * @deprecated Replaced by ConsumerSubscribeTopics
+ */
 export type ConsumerSubscribeTopic = {
   topic: string | RegExp;
   fromBeginning?: boolean;
 };
+export type ConsumerSubscribeTopics = {
+  topics: (string | RegExp)[];
+  fromBeginning?: boolean;
+};
 
 export type Consumer = {
   connect(): Promise<void>;
   disconnect(): Promise<void>;
-  subscribe(topic: ConsumerSubscribeTopic): Promise<void>;
+  subscribe(
+    subscription: ConsumerSubscribeTopics | ConsumerSubscribeTopic,
+  ): Promise<void>;
   stop(): Promise<void>;
   run(config?: ConsumerRunConfig): Promise<void>;
   commitOffsets(
     topicPartitions: Array<TopicPartitionOffsetAndMetadata>,
   ): Promise<void>;
-  seek(topicPartition: {
-    topic: string;
-    partition: number;
-    offset: string;
-  }): void;
+  seek(topicPartitionOffset: TopicPartitionOffset): void;
   describeGroup(): Promise<GroupDescription>;
   pause(topics: Array<{ topic: string; partitions?: number[] }>): void;
   paused(): TopicPartitions[];
   resume(topics: Array<{ topic: string; partitions?: number[] }>): void;
+  on(
+    eventName: ConsumerEvents['HEARTBEAT'],
+    listener: (event: ConsumerHeartbeatEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ConsumerEvents['COMMIT_OFFSETS'],
+    listener: (event: ConsumerCommitOffsetsEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ConsumerEvents['GROUP_JOIN'],
+    listener: (event: ConsumerGroupJoinEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ConsumerEvents['FETCH_START'],
+    listener: (event: ConsumerFetchStartEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ConsumerEvents['FETCH'],
+    listener: (event: ConsumerFetchEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ConsumerEvents['START_BATCH_PROCESS'],
+    listener: (event: ConsumerStartBatchProcessEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ConsumerEvents['END_BATCH_PROCESS'],
+    listener: (event: ConsumerEndBatchProcessEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ConsumerEvents['CONNECT'],
+    listener: (event: ConnectEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ConsumerEvents['DISCONNECT'],
+    listener: (event: DisconnectEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ConsumerEvents['STOP'],
+    listener: (event: InstrumentationEvent<null>) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ConsumerEvents['CRASH'],
+    listener: (event: ConsumerCrashEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ConsumerEvents['REBALANCING'],
+    listener: (event: ConsumerRebalancingEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ConsumerEvents['RECEIVED_UNSUBSCRIBED_TOPICS'],
+    listener: (event: ConsumerReceivedUnsubscribedTopicsEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ConsumerEvents['REQUEST'],
+    listener: (event: RequestEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ConsumerEvents['REQUEST_TIMEOUT'],
+    listener: (event: RequestTimeoutEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ConsumerEvents['REQUEST_QUEUE_SIZE'],
+    listener: (event: RequestQueueSizeEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
   on(
     eventName: ValueOf<ConsumerEvents>,
-    listener: (...args: any[]) => void,
+    listener: (event: InstrumentationEvent<any>) => void,
   ): RemoveInstrumentationEventListener<typeof eventName>;
   logger(): Logger;
-  events: ConsumerEvents;
+  readonly events: ConsumerEvents;
 };
 
 export enum CompressionTypes {
@@ -955,6 +1155,7 @@ export declare class KafkaJSError extends Error {
   readonly name: string;
   readonly retriable: boolean;
   readonly helpUrl?: string;
+  readonly cause?: Error;
 
   constructor(e: Error | string, metadata?: KafkaJSErrorMetadata);
 }
@@ -977,7 +1178,6 @@ export declare class KafkaJSOffsetOutOfRange extends KafkaJSProtocolError {
 
 export declare class KafkaJSNumberOfRetriesExceeded extends KafkaJSNonRetriableError {
   readonly stack: string;
-  readonly originalError: Error;
   readonly retryCount: number;
   readonly retryTime: number;
   constructor(
diff --git a/packages/microservices/external/mqtt-client.interface.ts b/packages/microservices/external/mqtt-client.interface.ts
deleted file mode 100644
index 506081338..000000000
--- a/packages/microservices/external/mqtt-client.interface.ts
+++ /dev/null
@@ -1,138 +0,0 @@
-import { EventEmitter } from 'events';
-
-/**
- * @see https://github.com/mqttjs/MQTT.js/
- */
-export declare class MqttClient extends EventEmitter {
-  public connected: boolean;
-  public disconnecting: boolean;
-  public disconnected: boolean;
-  public reconnecting: boolean;
-  public incomingStore: any;
-  public outgoingStore: any;
-  public options: any;
-  public queueQoSZero: boolean;
-
-  constructor(streamBuilder: (client: MqttClient) => any, options: any);
-
-  public on(event: 'message', cb: any): this;
-  public on(event: 'packetsend' | 'packetreceive', cb: any): this;
-  public on(event: 'error', cb: any): this;
-  public on(event: string, cb: Function): this;
-
-  public once(event: 'message', cb: any): this;
-  public once(event: 'packetsend' | 'packetreceive', cb: any): this;
-  public once(event: 'error', cb: any): this;
-  public once(event: string, cb: Function): this;
-
-  /**
-   * publish - publish <message> to <topic>
-   *
-   * @param {String} topic - topic to publish to
-   * @param {(String|Buffer)} message - message to publish
-   *
-   * @param {Object}    [opts] - publish options, includes:
-   *   @param {Number}  [opts.qos] - qos level to publish on
-   *   @param {Boolean} [opts.retain] - whether or not to retain the message
-   *
-   * @param {Function} [callback] - function(err){}
-   *    called when publish succeeds or fails
-   * @returns {Client} this - for chaining
-   * @api public
-   *
-   * @example client.publish('topic', 'message')
-   * @example
-   *     client.publish('topic', 'message', {qos: 1, retain: true})
-   * @example client.publish('topic', 'message', console.log)
-   */
-  public publish(
-    topic: string,
-    message: string | Buffer,
-    opts: any,
-    callback?: any,
-  ): this;
-  public publish(topic: string, message: string | Buffer, callback?: any): this;
-
-  /**
-   * subscribe - subscribe to <topic>
-   *
-   * @param {String, Array, Object} topic - topic(s) to subscribe to, supports objects in the form {'topic': qos}
-   * @param {Object} [opts] - optional subscription options, includes:
-   * @param  {Number} [opts.qos] - subscribe qos level
-   * @param {Function} [callback] - function(err, granted){} where:
-   *    {Error} err - subscription error (none at the moment!)
-   *    {Array} granted - array of {topic: 't', qos: 0}
-   * @returns {MqttClient} this - for chaining
-   * @api public
-   * @example client.subscribe('topic')
-   * @example client.subscribe('topic', {qos: 1})
-   * @example client.subscribe({'topic': 0, 'topic2': 1}, console.log)
-   * @example client.subscribe('topic', console.log)
-   */
-  public subscribe(topic: string | string[], opts: any, callback?: any): this;
-  public subscribe(topic: string | string[] | any, callback?: any): this;
-
-  /**
-   * unsubscribe - unsubscribe from topic(s)
-   *
-   * @param {String, Array} topic - topics to unsubscribe from
-   * @param {Function} [callback] - callback fired on unsuback
-   * @returns {MqttClient} this - for chaining
-   * @api public
-   * @example client.unsubscribe('topic')
-   * @example client.unsubscribe('topic', console.log)
-   */
-  public unsubscribe(topic: string | string[], callback?: any): this;
-
-  /**
-   * end - close connection
-   *
-   * @returns {MqttClient} this - for chaining
-   * @param {Boolean} force - do not wait for all in-flight messages to be acked
-   * @param {Function} cb - called when the client has been closed
-   *
-   * @api public
-   */
-  public end(force?: boolean, cb?: any): this;
-
-  /**
-   * removeOutgoingMessage - remove a message in outgoing store
-   * the outgoing callback will be called withe Error('Message removed') if the message is removed
-   *
-   * @param {Number} mid - messageId to remove message
-   * @returns {MqttClient} this - for chaining
-   * @api public
-   *
-   * @example client.removeOutgoingMessage(client.getLastMessageId());
-   */
-  public removeOutgoingMessage(mid: number): this;
-
-  /**
-   * reconnect - connect again using the same options as connect()
-   *
-   * @param {Object} [opts] - optional reconnect options, includes:
-   *    {any} incomingStore - a store for the incoming packets
-   *    {any} outgoingStore - a store for the outgoing packets
-   *    if opts is not given, current stores are used
-   *
-   * @returns {MqttClient} this - for chaining
-   *
-   * @api public
-   */
-  public reconnect(opts?: any): this;
-
-  /**
-   * Handle messages with backpressure support, one at a time.
-   * Override at will.
-   *
-   * @param packet packet the packet
-   * @param callback callback call when finished
-   * @api public
-   */
-  public handleMessage(packet: any, callback: any): void;
-
-  /**
-   * getLastMessageId
-   */
-  public getLastMessageId(): number;
-}
diff --git a/packages/microservices/external/mqtt-options.interface.ts b/packages/microservices/external/mqtt-options.interface.ts
index 47c0d12b8..cc834b6ae 100644
--- a/packages/microservices/external/mqtt-options.interface.ts
+++ b/packages/microservices/external/mqtt-options.interface.ts
@@ -1,5 +1,7 @@
 /**
  * @see https://github.com/mqttjs/MQTT.js/
+ *
+ * @publicApi
  */
 export declare type QoS = 0 | 1 | 2;
 
@@ -58,6 +60,47 @@ export interface MqttClientOptions extends ISecureClientOptions {
    */
   outgoingStore?: any;
   queueQoSZero?: boolean;
+  /**
+   *  properties MQTT 5.0.
+   */
+  properties?: {
+    /**
+     * representing the Session Expiry Interval in seconds
+     */
+    sessionExpiryInterval?: number;
+    /**
+     * representing the Receive Maximum
+     */
+    receiveMaximum?: number;
+    /**
+     * representing the Maximum Packet Size the Client is willing to accept
+     */
+    maximumPacketSize?: number;
+    /**
+     * representing the Topic Alias Maximum value indicates the highest value that the Client will accept as a Topic Alias sent by the Server
+     */
+    topicAliasMaximum?: number;
+    /**
+     * The Client uses this value to request the Server to return Response Information in the CONNACK
+     */
+    requestResponseInformation?: boolean;
+    /**
+     * The Client uses this value to indicate whether the Reason String or User Properties are sent in the case of failures
+     */
+    requestProblemInformation?: boolean;
+    /**
+     * The User Property is allowed to appear multiple times to represent multiple name, value pairs
+     */
+    userProperties?: object;
+    /**
+     * the name of the authentication method used for extended authentication
+     */
+    authenticationMethod?: string;
+    /**
+     * * Binary Data containing authentication data (binary type)
+     * */
+    authenticationData?: any;
+  };
   reschedulePings?: boolean;
   servers?: Array<{
     host: string;
diff --git a/packages/microservices/external/nats-client.interface.ts b/packages/microservices/external/nats-client.interface.ts
deleted file mode 100644
index b40cd679e..000000000
--- a/packages/microservices/external/nats-client.interface.ts
+++ /dev/null
@@ -1,91 +0,0 @@
-/**
- * @see https://github.com/nats-io/nats.js
- */
-export interface NatsCodec<T> {
-  encode(d: T): Uint8Array;
-  decode(a: Uint8Array): T;
-}
-
-interface RequestOptions {
-  timeout: number;
-  headers?: any;
-  noMux?: boolean;
-  reply?: string;
-}
-interface PublishOptions {
-  reply?: string;
-  headers?: any;
-}
-interface SubOpts<T> {
-  queue?: string;
-  max?: number;
-  timeout?: number;
-  callback?: (err: object | null, msg: T) => void;
-}
-
-declare type SubscriptionOptions = SubOpts<NatsMsg>;
-
-export interface NatsMsg {
-  subject: string;
-  sid: number;
-  reply?: string;
-  data: Uint8Array;
-  headers?: any;
-  respond(data?: Uint8Array, opts?: PublishOptions): boolean;
-}
-
-interface Sub<T> extends AsyncIterable<T> {
-  unsubscribe(max?: number): void;
-  drain(): Promise<void>;
-  isDraining(): boolean;
-  isClosed(): boolean;
-  callback(err: object | null, msg: NatsMsg): void;
-  getSubject(): string;
-  getReceived(): number;
-  getProcessed(): number;
-  getPending(): number;
-  getID(): number;
-  getMax(): number | undefined;
-}
-
-declare type Subscription = Sub<NatsMsg>;
-
-declare enum Events {
-  Disconnect = 'disconnect',
-  Reconnect = 'reconnect',
-  Update = 'update',
-  LDM = 'ldm',
-  Error = 'error',
-}
-interface Status {
-  type: Events | DebugEvents;
-  data: string | number;
-}
-
-declare enum DebugEvents {
-  Reconnecting = 'reconnecting',
-  PingTimer = 'pingTimer',
-  StaleConnection = 'staleConnection',
-}
-
-export declare class Client {
-  info?: Record<string, any>;
-  closed(): Promise<void | Error>;
-  close(): Promise<void>;
-  publish(subject: string, data?: Uint8Array, options?: PublishOptions): void;
-  subscribe(subject: string, opts?: SubscriptionOptions): Subscription;
-  request(
-    subject: string,
-    data?: Uint8Array,
-    opts?: RequestOptions,
-  ): Promise<NatsMsg>;
-  flush(): Promise<void>;
-  drain(): Promise<void>;
-  isClosed(): boolean;
-  isDraining(): boolean;
-  getServer(): string;
-  status(): AsyncIterable<Status>;
-  stats(): Record<string, any>;
-  jetstreamManager(opts?: Record<string, any>): Promise<any>;
-  jetstream(opts?: Record<string, any>): any;
-}
diff --git a/packages/microservices/external/nats-codec.interface.ts b/packages/microservices/external/nats-codec.interface.ts
new file mode 100644
index 000000000..76a3b8d55
--- /dev/null
+++ b/packages/microservices/external/nats-codec.interface.ts
@@ -0,0 +1,9 @@
+/**
+ * @see https://github.com/nats-io/nats.js
+ *
+ * @publicApi
+ */
+export interface NatsCodec<T> {
+  encode(d: T): Uint8Array;
+  decode(a: Uint8Array): T;
+}
diff --git a/packages/microservices/external/redis.interface.ts b/packages/microservices/external/redis.interface.ts
index 00ae1bba7..506d3669c 100644
--- a/packages/microservices/external/redis.interface.ts
+++ b/packages/microservices/external/redis.interface.ts
@@ -1,383 +1,215 @@
-/* eslint-disable @typescript-eslint/adjacent-overload-signatures */
+import { ConnectionOptions } from 'tls';
 
-export interface RetryStrategyOptions {
-  error: Error;
-  total_retry_time: number;
-  times_connected: number;
-  attempt: number;
-}
+/**
+ * @see https://github.dev/luin/ioredis/blob/df04dd8d87a44d3b64b385c86581915248554508/lib/redis/RedisOptions.ts#L184
+ *
+ * @publicApi
+ */
+export interface IORedisOptions {
+  Connector?: any;
+  retryStrategy?: (times: number) => number | void | null;
+
+  /**
+   * If a command does not return a reply within a set number of milliseconds,
+   * a "Command timed out" error will be thrown.
+   */
+  commandTimeout?: number;
+  /**
+   * Enable/disable keep-alive functionality.
+   * @link https://nodejs.org/api/net.html#socketsetkeepaliveenable-initialdelay
+   * @default 0
+   */
+  keepAlive?: number;
+
+  /**
+   * Enable/disable the use of Nagle's algorithm.
+   * @link https://nodejs.org/api/net.html#socketsetnodelaynodelay
+   * @default true
+   */
+  noDelay?: boolean;
+
+  /**
+   * Set the name of the connection to make it easier to identity the connection
+   * in client list.
+   * @link https://redis.io/commands/client-setname
+   */
+  connectionName?: string;
+
+  /**
+   * If set, client will send AUTH command with the value of this option as the first argument when connected.
+   * This is supported since Redis 6.
+   */
+  username?: string;
 
-export interface ClientOpts {
-  auth_pass?: string;
-  command_queue_high_water?: number;
-  command_queue_low_water?: number;
-  connect_timeout?: number;
-  db?: string;
-  detect_buffers?: boolean;
-  disable_resubscribing?: boolean;
-  enable_offline_queue?: boolean;
-  family?: string;
-  host?: string;
-  max_attempts?: number;
-  no_ready_check?: boolean;
-  parser?: string;
+  /**
+   * If set, client will send AUTH command with the value of this option when connected.
+   */
   password?: string;
-  path?: string;
-  port?: number;
-  prefix?: string;
-  rename_commands?: any;
-  retry_max_delay?: number;
-  retry_strategy?: any;
-  retry_unfulfilled_commands?: boolean;
-  return_buffers?: boolean;
-  socket_keepalive?: boolean;
-  socket_nodelay?: boolean;
-  string_numbers?: boolean;
-  tls?: any;
-  url?: string;
-}
 
-export interface RedisClient {
-  // event: connect
-  // event: error
-  // event: message
-  // event: pmessage
-  // event: subscribe
-  // event: psubscribe
-  // event: unsubscribe
-  // event: punsubscribe
+  /**
+   * Database index to use.
+   *
+   * @default 0
+   */
+  db?: number;
 
-  connected: boolean;
-  retry_delay: number;
-  retry_backoff: number;
-  command_queue: any[];
-  offline_queue: any[];
-  server_info: any;
+  /**
+   * When the client reconnects, channels subscribed in the previous connection will be
+   * resubscribed automatically if `autoResubscribe` is `true`.
+   * @default true
+   */
+  autoResubscribe?: boolean;
 
   /**
-   * Forcibly close the connection to the Redis server. Note that this does not wait until all replies have been parsed. If you want to exit cleanly, call client.quit()
+   * Whether or not to resend unfulfilled commands on reconnect.
+   * Unfulfilled commands are most likely to be blocking commands such as `brpop` or `blpop`.
+   * @default true
+   */
+  autoResendUnfulfilledCommands?: boolean;
+  /**
+   * Whether or not to reconnect on certain Redis errors.
+   * This options by default is `null`, which means it should never reconnect on Redis errors.
+   * You can pass a function that accepts an Redis error, and returns:
+   * - `true` or `1` to trigger a reconnection.
+   * - `false` or `0` to not reconnect.
+   * - `2` to reconnect and resend the failed command (who triggered the error) after reconnection.
+   * @example
+   * ```js
+   * const redis = new Redis({
+   *   reconnectOnError(err) {
+   *     const targetError = "READONLY";
+   *     if (err.message.includes(targetError)) {
+   *       // Only reconnect when the error contains "READONLY"
+   *       return true; // or `return 1;`
+   *     }
+   *   },
+   * });
+   * ```
+   * @default null
+   */
+  reconnectOnError?: ((err: Error) => boolean | 1 | 2) | null;
+
+  /**
+   * @default false
+   */
+  readOnly?: boolean;
+  /**
+   * When enabled, numbers returned by Redis will be converted to JavaScript strings instead of numbers.
+   * This is necessary if you want to handle big numbers (above `Number.MAX_SAFE_INTEGER` === 2^53).
+   * @default false
+   */
+  stringNumbers?: boolean;
+
+  /**
+   * How long the client will wait before killing a socket due to inactivity during initial connection.
+   * @default 10000
+   */
+  connectTimeout?: number;
+
+  /**
+   * This option is used internally when you call `redis.monitor()` to tell Redis
+   * to enter the monitor mode when the connection is established.
    *
-   * @param {boolean} flush You should set flush to true, if you are not absolutely sure you do not care about any other commands. If you set flush to false all still running commands will silently fail.
+   * @default false
    */
-  end(flush: boolean): void;
-  unref(): void;
+  monitor?: boolean;
 
   /**
-   * Stop sending commands and queue the commands.
+   * The commands that don't get a reply due to the connection to the server is lost are
+   * put into a queue and will be resent on reconnect (if allowed by the `retryStrategy` option).
+   * This option is used to configure how many reconnection attempts should be allowed before
+   * the queue is flushed with a `MaxRetriesPerRequestError` error.
+   * Set this options to `null` instead of a number to let commands wait forever
+   * until the connection is alive again.
+   *
+   * @default 20
    */
-  cork(): void;
+  maxRetriesPerRequest?: number | null;
 
   /**
-   * Resume and send the queued commands at once.
+   * @default 10000
    */
-  uncork(): void;
+  maxLoadingRetryTime?: number;
+  /**
+   * @default false
+   */
+  enableAutoPipelining?: boolean;
+  /**
+   * @default []
+   */
+  autoPipeliningIgnoredCommands?: string[];
+  offlineQueue?: boolean;
+  commandQueue?: boolean;
 
-  // Low level command execution
-  send_command(command: string, ...args: any[]): boolean;
+  /**
+   *
+   * By default, if the connection to Redis server has not been established, commands are added to a queue
+   * and are executed once the connection is "ready" (when `enableReadyCheck` is true, "ready" means
+   * the Redis server has loaded the database from disk, otherwise means the connection to the Redis
+   * server has been established). If this option is false, when execute the command when the connection
+   * isn't ready, an error will be returned.
+   *
+   * @default true
+   */
+  enableOfflineQueue?: boolean;
 
-  // Connection (http://redis.io/commands#connection)
-  auth(password: string, callback?: any): boolean;
-  ping(callback?: any): boolean;
+  /**
+   * The client will sent an INFO command to check whether the server is still loading data from the disk (
+   * which happens when the server is just launched) when the connection is established, and only wait until
+   * the loading process is finished before emitting the `ready` event.
+   *
+   * @default true
+   */
+  enableReadyCheck?: boolean;
 
-  // Strings (http://redis.io/commands#strings)
-  append(key: string, value: string, callback?: any): boolean;
-  bitcount(key: string, callback?: any): boolean;
-  bitcount(key: string, start: number, end: number, callback?: any): boolean;
-  set(key: string, value: string, callback?: any): boolean;
-  get(key: string, callback?: any): boolean;
-  exists(key: string, value: string, callback?: any): boolean;
+  /**
+   * When a Redis instance is initialized, a connection to the server is immediately established. Set this to
+   * true will delay the connection to the server until the first command is sent or `redis.connect()` is called
+   * explicitly.
+   *
+   * @default false
+   */
 
-  publish(channel: string, value: any): boolean;
-  subscribe(channel: string): boolean;
-  on(event: string, callback: Function): any;
-  off(event: string, callback: Function): any;
-  addListener(event: string, callback: Function): any;
+  lazyConnect?: boolean;
 
-  /*
-   commands = set_union([
-   "get", "set", "setnx", "setex", "append", "strlen", "del", "exists", "setbit", "getbit", "setrange", "getrange", "substr",
-   "incr", "decr", "mget", "rpush", "lpush", "rpushx", "lpushx", "linsert", "rpop", "lpop", "brpop", "brpoplpush", "blpop", "llen", "lindex",
-   "lset", "lrange", "ltrim", "lrem", "rpoplpush", "sadd", "srem", "smove", "sismember", "scard", "spop", "srandmember", "sinter", "sinterstore",
-   "sunion", "sunionstore", "sdiff", "sdiffstore", "smembers", "zadd", "zincrby", "zrem", "zremrangebyscore", "zremrangebyrank", "zunionstore",
-   "zinterstore", "zrange", "zrangebyscore", "zrevrangebyscore", "zcount", "zrevrange", "zcard", "zscore", "zrank", "zrevrank", "hset", "hsetnx",
-   "hget", "hmset", "hmget", "hincrby", "hincrbyfloat", "hdel", "hlen", "hkeys", "hvals", "hgetall", "hexists", "incrby", "decrby", "getset", "mset", "msetnx",
-   "randomkey", "select", "move", "rename", "renamenx", "expire", "expireat", "keys", "dbsize", "auth", "ping", "echo", "save", "bgsave",
-   "bgrewriteaof", "shutdown", "lastsave", "type", "any", "exec", "discard", "sync", "flushdb", "flushall", "sort", "info", "monitor", "ttl",
-   "persist", "slaveof", "debug", "config", "subscribe", "unsubscribe", "psubscribe", "punsubscribe", "publish", "watch", "unwatch", "cluster",
-   "restore", "migrate", "dump", "object", "client", "eval", "evalsha"], require("./lib/commands"));
+  /**
+   * @default undefined
    */
+  scripts?: Record<
+    string,
+    { lua: string; numberOfKeys?: number; readOnly?: boolean }
+  >;
 
-  get(args: any[], callback?: any): boolean;
-  get(...args: any[]): boolean;
-  set(args: any[], callback?: any): boolean;
-  set(...args: any[]): boolean;
-  setnx(args: any[], callback?: any): boolean;
-  setnx(...args: any[]): boolean;
-  setex(args: any[], callback?: any): boolean;
-  setex(...args: any[]): boolean;
-  append(args: any[], callback?: any): boolean;
-  append(...args: any[]): boolean;
-  strlen(args: any[], callback?: any): boolean;
-  strlen(...args: any[]): boolean;
-  del(args: any[], callback?: any): boolean;
-  del(...args: any[]): boolean;
-  exists(args: any[], callback?: any): boolean;
-  exists(...args: any[]): boolean;
-  setbit(args: any[], callback?: any): boolean;
-  setbit(...args: any[]): boolean;
-  getbit(args: any[], callback?: any): boolean;
-  getbit(...args: any[]): boolean;
-  setrange(args: any[], callback?: any): boolean;
-  setrange(...args: any[]): boolean;
-  getrange(args: any[], callback?: any): boolean;
-  getrange(...args: any[]): boolean;
-  substr(args: any[], callback?: any): boolean;
-  substr(...args: any[]): boolean;
-  incr(args: any[], callback?: any): boolean;
-  incr(...args: any[]): boolean;
-  decr(args: any[], callback?: any): boolean;
-  decr(...args: any[]): boolean;
-  mget(args: any[], callback?: any): boolean;
-  mget(...args: any[]): boolean;
-  rpush(...args: any[]): boolean;
-  lpush(args: any[], callback?: any): boolean;
-  lpush(...args: any[]): boolean;
-  rpushx(args: any[], callback?: any): boolean;
-  rpushx(...args: any[]): boolean;
-  lpushx(args: any[], callback?: any): boolean;
-  lpushx(...args: any[]): boolean;
-  linsert(args: any[], callback?: any): boolean;
-  linsert(...args: any[]): boolean;
-  rpop(args: any[], callback?: any): boolean;
-  rpop(...args: any[]): boolean;
-  lpop(args: any[], callback?: any): boolean;
-  lpop(...args: any[]): boolean;
-  brpop(args: any[], callback?: any): boolean;
-  brpop(...args: any[]): boolean;
-  brpoplpush(args: any[], callback?: any): boolean;
-  brpoplpush(...args: any[]): boolean;
-  blpop(args: any[], callback?: any): boolean;
-  blpop(...args: any[]): boolean;
-  llen(args: any[], callback?: any): boolean;
-  llen(...args: any[]): boolean;
-  lindex(args: any[], callback?: any): boolean;
-  lindex(...args: any[]): boolean;
-  lset(args: any[], callback?: any): boolean;
-  lset(...args: any[]): boolean;
-  lrange(args: any[], callback?: any): boolean;
-  lrange(...args: any[]): boolean;
-  ltrim(args: any[], callback?: any): boolean;
-  ltrim(...args: any[]): boolean;
-  lrem(args: any[], callback?: any): boolean;
-  lrem(...args: any[]): boolean;
-  rpoplpush(args: any[], callback?: any): boolean;
-  rpoplpush(...args: any[]): boolean;
-  sadd(args: any[], callback?: any): boolean;
-  sadd(...args: any[]): boolean;
-  srem(args: any[], callback?: any): boolean;
-  srem(...args: any[]): boolean;
-  smove(args: any[], callback?: any): boolean;
-  smove(...args: any[]): boolean;
-  sismember(args: any[], callback?: any): boolean;
-  sismember(...args: any[]): boolean;
-  scard(args: any[], callback?: any): boolean;
-  scard(...args: any[]): boolean;
-  spop(args: any[], callback?: any): boolean;
-  spop(...args: any[]): boolean;
-  srandmember(args: any[], callback?: any): boolean;
-  srandmember(...args: any[]): boolean;
-  sinter(args: any[], callback?: any): boolean;
-  sinter(...args: any[]): boolean;
-  sinterstore(args: any[], callback?: any): boolean;
-  sinterstore(...args: any[]): boolean;
-  sunion(args: any[], callback?: any): boolean;
-  sunion(...args: any[]): boolean;
-  sunionstore(args: any[], callback?: any): boolean;
-  sunionstore(...args: any[]): boolean;
-  sdiff(args: any[], callback?: any): boolean;
-  sdiff(...args: any[]): boolean;
-  sdiffstore(args: any[], callback?: any): boolean;
-  sdiffstore(...args: any[]): boolean;
-  smembers(args: any[], callback?: any): boolean;
-  smembers(...args: any[]): boolean;
-  zadd(args: any[], callback?: any): boolean;
-  zadd(...args: any[]): boolean;
-  zincrby(args: any[], callback?: any): boolean;
-  zincrby(...args: any[]): boolean;
-  zrem(args: any[], callback?: any): boolean;
-  zrem(...args: any[]): boolean;
-  zremrangebyscore(args: any[], callback?: any): boolean;
-  zremrangebyscore(...args: any[]): boolean;
-  zremrangebyrank(args: any[], callback?: any): boolean;
-  zremrangebyrank(...args: any[]): boolean;
-  zunionstore(args: any[], callback?: any): boolean;
-  zunionstore(...args: any[]): boolean;
-  zinterstore(args: any[], callback?: any): boolean;
-  zinterstore(...args: any[]): boolean;
-  zrange(args: any[], callback?: any): boolean;
-  zrange(...args: any[]): boolean;
-  zrangebyscore(args: any[], callback?: any): boolean;
-  zrangebyscore(...args: any[]): boolean;
-  zrevrangebyscore(args: any[], callback?: any): boolean;
-  zrevrangebyscore(...args: any[]): boolean;
-  zcount(args: any[], callback?: any): boolean;
-  zcount(...args: any[]): boolean;
-  zrevrange(args: any[], callback?: any): boolean;
-  zrevrange(...args: any[]): boolean;
-  zcard(args: any[], callback?: any): boolean;
-  zcard(...args: any[]): boolean;
-  zscore(args: any[], callback?: any): boolean;
-  zscore(...args: any[]): boolean;
-  zrank(args: any[], callback?: any): boolean;
-  zrank(...args: any[]): boolean;
-  zrevrank(args: any[], callback?: any): boolean;
-  zrevrank(...args: any[]): boolean;
-  hset(args: any[], callback?: any): boolean;
-  hset(...args: any[]): boolean;
-  hsetnx(args: any[], callback?: any): boolean;
-  hsetnx(...args: any[]): boolean;
-  hget(args: any[], callback?: any): boolean;
-  hget(...args: any[]): boolean;
-  hmset(args: any[], callback?: any): boolean;
-  hmset(key: string, hash: any, callback?: any): boolean;
-  hmset(...args: any[]): boolean;
-  hmget(args: any[], callback?: any): boolean;
-  hmget(...args: any[]): boolean;
-  hincrby(args: any[], callback?: any): boolean;
-  hincrby(...args: any[]): boolean;
-  hincrbyfloat(args: any[], callback?: any): boolean;
-  hincrbyfloat(...args: any[]): boolean;
-  hdel(args: any[], callback?: any): boolean;
-  hdel(...args: any[]): boolean;
-  hlen(args: any[], callback?: any): boolean;
-  hlen(...args: any[]): boolean;
-  hkeys(args: any[], callback?: any): boolean;
-  hkeys(...args: any[]): boolean;
-  hvals(args: any[], callback?: any): boolean;
-  hvals(...args: any[]): boolean;
-  hgetall(args: any[], callback?: any): boolean;
-  hgetall(...args: any[]): boolean;
-  hgetall(key: string, callback?: any): boolean;
-  hexists(args: any[], callback?: any): boolean;
-  hexists(...args: any[]): boolean;
-  incrby(args: any[], callback?: any): boolean;
-  incrby(...args: any[]): boolean;
-  decrby(args: any[], callback?: any): boolean;
-  decrby(...args: any[]): boolean;
-  getset(args: any[], callback?: any): boolean;
-  getset(...args: any[]): boolean;
-  mset(args: any[], callback?: any): boolean;
-  mset(...args: any[]): boolean;
-  msetnx(args: any[], callback?: any): boolean;
-  msetnx(...args: any[]): boolean;
-  randomkey(args: any[], callback?: any): boolean;
-  randomkey(...args: any[]): boolean;
-  select(args: any[], callback?: any): void;
-  select(...args: any[]): void;
-  move(args: any[], callback?: any): boolean;
-  move(...args: any[]): boolean;
-  rename(args: any[], callback?: any): boolean;
-  rename(...args: any[]): boolean;
-  renamenx(args: any[], callback?: any): boolean;
-  renamenx(...args: any[]): boolean;
-  expire(args: any[], callback?: any): boolean;
-  expire(...args: any[]): boolean;
-  expireat(args: any[], callback?: any): boolean;
-  expireat(...args: any[]): boolean;
-  keys(args: any[], callback?: any): boolean;
-  keys(...args: any[]): boolean;
-  dbsize(args: any[], callback?: any): boolean;
-  dbsize(...args: any[]): boolean;
-  auth(args: any[], callback?: any): void;
-  auth(...args: any[]): void;
-  ping(args: any[], callback?: any): boolean;
-  ping(...args: any[]): boolean;
-  echo(args: any[], callback?: any): boolean;
-  echo(...args: any[]): boolean;
-  save(args: any[], callback?: any): boolean;
-  save(...args: any[]): boolean;
-  bgsave(args: any[], callback?: any): boolean;
-  bgsave(...args: any[]): boolean;
-  bgrewriteaof(args: any[], callback?: any): boolean;
-  bgrewriteaof(...args: any[]): boolean;
-  shutdown(args: any[], callback?: any): boolean;
-  shutdown(...args: any[]): boolean;
-  lastsave(args: any[], callback?: any): boolean;
-  lastsave(...args: any[]): boolean;
-  type(args: any[], callback?: any): boolean;
-  type(...args: any[]): boolean;
-  any(args: any[], callback?: any): any;
-  any(...args: any[]): any;
-  exec(args: any[], callback?: any): boolean;
-  exec(...args: any[]): boolean;
-  discard(args: any[], callback?: any): boolean;
-  discard(...args: any[]): boolean;
-  sync(args: any[], callback?: any): boolean;
-  sync(...args: any[]): boolean;
-  flushdb(args: any[], callback?: any): boolean;
-  flushdb(...args: any[]): boolean;
-  flushall(args: any[], callback?: any): boolean;
-  flushall(...args: any[]): boolean;
-  sort(args: any[], callback?: any): boolean;
-  sort(...args: any[]): boolean;
-  info(args: any[], callback?: any): boolean;
-  info(...args: any[]): boolean;
-  monitor(args: any[], callback?: any): boolean;
-  monitor(...args: any[]): boolean;
-  ttl(args: any[], callback?: any): boolean;
-  ttl(...args: any[]): boolean;
-  persist(args: any[], callback?: any): boolean;
-  persist(...args: any[]): boolean;
-  slaveof(args: any[], callback?: any): boolean;
-  slaveof(...args: any[]): boolean;
-  debug(args: any[], callback?: any): boolean;
-  debug(...args: any[]): boolean;
-  config(args: any[], callback?: any): boolean;
-  config(...args: any[]): boolean;
-  subscribe(args: any[], callback?: any): boolean;
-  subscribe(...args: any[]): boolean;
-  unsubscribe(args: any[], callback?: any): boolean;
-  unsubscribe(...args: any[]): boolean;
-  psubscribe(args: any[], callback?: any): boolean;
-  psubscribe(...args: any[]): boolean;
-  punsubscribe(args: any[], callback?: any): boolean;
-  punsubscribe(...args: any[]): boolean;
-  publish(args: any[], callback?: any): boolean;
-  publish(...args: any[]): boolean;
-  watch(args: any[], callback?: any): boolean;
-  watch(...args: any[]): boolean;
-  unwatch(args: any[], callback?: any): boolean;
-  unwatch(...args: any[]): boolean;
-  cluster(args: any[], callback?: any): boolean;
-  cluster(...args: any[]): boolean;
-  restore(args: any[], callback?: any): boolean;
-  restore(...args: any[]): boolean;
-  migrate(args: any[], callback?: any): boolean;
-  migrate(...args: any[]): boolean;
-  dump(args: any[], callback?: any): boolean;
-  dump(...args: any[]): boolean;
-  object(args: any[], callback?: any): boolean;
-  object(...args: any[]): boolean;
-  client(args: any[], callback?: any): boolean;
-  client(...args: any[]): boolean;
-  eval(args: any[], callback?: any): boolean;
-  eval(...args: any[]): boolean;
-  evalsha(args: any[], callback?: any): boolean;
-  evalsha(...args: any[]): boolean;
-  script(args: any[], callback?: any): boolean;
-  script(...args: any[]): boolean;
-  script(key: string, callback?: any): boolean;
-  quit(args: any[], callback?: any): boolean;
-  quit(...args: any[]): boolean;
-  sscan(...args: any[]): boolean;
-  sscan(args: any[], callback?: any): boolean;
-  scan(...args: any[]): boolean;
-  scan(args: any[], callback?: any): boolean;
-  hscan(...args: any[]): boolean;
-  hscan(args: any[], callback?: any): boolean;
-  zscan(...args: any[]): boolean;
-  zscan(args: any[], callback?: any): boolean;
+  keyPrefix?: string;
+  showFriendlyErrorStack?: boolean;
 
-  // Extras
-  duplicate(options?: any[], callback?: any): RedisClient;
+  // StandaloneConnectionOptions
+  disconnectTimeout?: number;
+  tls?: ConnectionOptions;
+
+  // SentinelConnectionOptions
+  /**
+   * Master group name of the Sentinel
+   */
+  name?: string;
+  /**
+   * @default "master"
+   */
+  role?: 'master' | 'slave';
+  sentinelUsername?: string;
+  sentinelPassword?: string;
+  sentinels?: Array<Partial<any>>;
+  sentinelRetryStrategy?: (retryAttempts: number) => number | void | null;
+  sentinelReconnectStrategy?: (retryAttempts: number) => number | void | null;
+  preferredSlaves?: any;
+  sentinelCommandTimeout?: number;
+  enableTLSForSentinelMode?: boolean;
+  sentinelTLS?: ConnectionOptions;
+  natMap?: any;
+  updateSentinels?: boolean;
+  /**
+   * @default 10
+   */
+  sentinelMaxConnections?: number;
+  failoverDetector?: boolean;
 }
diff --git a/packages/microservices/external/rmq-url.interface.ts b/packages/microservices/external/rmq-url.interface.ts
index c19501e59..4d812350f 100644
--- a/packages/microservices/external/rmq-url.interface.ts
+++ b/packages/microservices/external/rmq-url.interface.ts
@@ -1,3 +1,9 @@
+import { ConnectionOptions } from 'tls';
+import { TcpSocketConnectOpts } from 'net';
+
+/**
+ * @publicApi
+ */
 export interface RmqUrl {
   protocol?: string;
   hostname?: string;
@@ -10,13 +16,46 @@ export interface RmqUrl {
   vhost?: string;
 }
 
+interface ClientProperties {
+  connectionName?: string;
+  [key: string]: any;
+}
+
+type AmqpConnectionOptions = (ConnectionOptions | TcpSocketConnectOpts) & {
+  noDelay?: boolean;
+  timeout?: number;
+  keepAlive?: boolean;
+  keepAliveDelay?: number;
+  clientProperties?: any;
+  credentials?:
+    | {
+        mechanism: string;
+        username: string;
+        password: string;
+        response: () => Buffer;
+      }
+    | {
+        mechanism: string;
+        response: () => Buffer;
+      }
+    | undefined;
+};
+
+/**
+ * @publicApi
+ */
 export interface AmqpConnectionManagerSocketOptions {
   reconnectTimeInSeconds?: number;
   heartbeatIntervalInSeconds?: number;
   findServers?: () => string | string[];
-  connectionOptions?: any;
+  connectionOptions?: AmqpConnectionOptions;
+  clientProperties?: ClientProperties;
+  [key: string]: any;
 }
 
+/**
+ * @publicApi
+ */
 export interface AmqplibQueueOptions {
   durable?: boolean;
   autoDelete?: boolean;
@@ -27,4 +66,5 @@ export interface AmqplibQueueOptions {
   deadLetterRoutingKey?: string;
   maxLength?: number;
   maxPriority?: number;
+  [key: string]: any;
 }
diff --git a/packages/microservices/helpers/grpc-helpers.ts b/packages/microservices/helpers/grpc-helpers.ts
new file mode 100644
index 000000000..56bf9ad24
--- /dev/null
+++ b/packages/microservices/helpers/grpc-helpers.ts
@@ -0,0 +1,23 @@
+import { InvalidGrpcPackageDefinitionMissingPackageDefinitionException } from '../errors/invalid-grpc-package-definition-missing-package-definition.exception';
+import { InvalidGrpcPackageDefinitionMutexException } from '../errors/invalid-grpc-package-definition-mutex.exception';
+import { GrpcOptions } from '../interfaces';
+
+export function getGrpcPackageDefinition(
+  options: GrpcOptions['options'],
+  grpcProtoLoaderPackage: any,
+) {
+  const file = options['protoPath'];
+  const packageDefinition = options['packageDefinition'];
+
+  if (file && packageDefinition) {
+    throw new InvalidGrpcPackageDefinitionMutexException();
+  }
+  if (!file && !packageDefinition) {
+    throw new InvalidGrpcPackageDefinitionMissingPackageDefinitionException();
+  }
+
+  return (
+    packageDefinition ||
+    grpcProtoLoaderPackage.loadSync(file, options['loader'])
+  );
+}
diff --git a/packages/microservices/helpers/index.ts b/packages/microservices/helpers/index.ts
index a02fe778e..e395ce7dc 100644
--- a/packages/microservices/helpers/index.ts
+++ b/packages/microservices/helpers/index.ts
@@ -2,3 +2,5 @@ export * from './json-socket';
 export * from './kafka-logger';
 export * from './kafka-parser';
 export * from './kafka-reply-partition-assigner';
+export * from './tcp-socket';
+export * from './grpc-helpers';
diff --git a/packages/microservices/helpers/json-socket.ts b/packages/microservices/helpers/json-socket.ts
index 0320e0dbc..574d5f267 100644
--- a/packages/microservices/helpers/json-socket.ts
+++ b/packages/microservices/helpers/json-socket.ts
@@ -1,83 +1,37 @@
-import { Socket } from 'net';
+import { Buffer } from 'buffer';
 import { StringDecoder } from 'string_decoder';
-import {
-  CLOSE_EVENT,
-  CONNECT_EVENT,
-  DATA_EVENT,
-  ERROR_EVENT,
-  MESSAGE_EVENT,
-} from '../constants';
 import { CorruptedPacketLengthException } from '../errors/corrupted-packet-length.exception';
-import { InvalidJSONFormatException } from '../errors/invalid-json-format.exception';
-import { NetSocketClosedException } from '../errors/net-socket-closed.exception';
+import { MaxPacketLengthExceededException } from '../errors/max-packet-length-exceeded.exception';
+import { TcpSocket } from './tcp-socket';
 
-export class JsonSocket {
+const MAX_BUFFER_SIZE = (512 * 1024 * 1024) / 4; // 512 MBs in characters with 4 bytes per character (32-bit)
+
+export class JsonSocket extends TcpSocket {
   private contentLength: number | null = null;
-  private isClosed = false;
   private buffer = '';
 
   private readonly stringDecoder = new StringDecoder();
-  private readonly delimeter = '#';
-
-  public get netSocket() {
-    return this.socket;
-  }
-
-  constructor(public readonly socket: Socket) {
-    this.socket.on(DATA_EVENT, this.onData.bind(this));
-    this.socket.on(CONNECT_EVENT, () => (this.isClosed = false));
-    this.socket.on(CLOSE_EVENT, () => (this.isClosed = true));
-    this.socket.on(ERROR_EVENT, () => (this.isClosed = true));
-  }
-
-  public connect(port: number, host: string) {
-    this.socket.connect(port, host);
-    return this;
-  }
-
-  public on(event: string, callback: (err?: any) => void) {
-    this.socket.on(event, callback);
-    return this;
-  }
-
-  public once(event: string, callback: (err?: any) => void) {
-    this.socket.once(event, callback);
-    return this;
-  }
+  private readonly delimiter = '#';
 
-  public end() {
-    this.socket.end();
-    return this;
-  }
-
-  public sendMessage(message: any, callback?: (err?: any) => void) {
-    if (this.isClosed) {
-      callback && callback(new NetSocketClosedException());
-      return;
-    }
+  protected handleSend(message: any, callback?: (err?: any) => void) {
     this.socket.write(this.formatMessageData(message), 'utf-8', callback);
   }
 
-  private onData(dataRaw: Buffer | string) {
+  protected handleData(dataRaw: Buffer | string) {
     const data = Buffer.isBuffer(dataRaw)
       ? this.stringDecoder.write(dataRaw)
       : dataRaw;
+    this.buffer += data;
 
-    try {
-      this.handleData(data);
-    } catch (e) {
-      this.socket.emit(ERROR_EVENT, e.message);
-      this.socket.end();
+    if (this.buffer.length > MAX_BUFFER_SIZE) {
+      this.buffer = '';
+      throw new MaxPacketLengthExceededException(this.buffer.length);
     }
-  }
 
-  private handleData(data: string) {
-    this.buffer += data;
-
-    if (this.contentLength == null) {
-      const i = this.buffer.indexOf(this.delimeter);
+    if (this.contentLength === null) {
+      const i = this.buffer.indexOf(this.delimiter);
       /**
-       * Check if the buffer has the delimeter (#),
+       * Check if the buffer has the delimiter (#),
        * if not, the end of the buffer string might be in the middle of a content length string
        */
       if (i !== -1) {
@@ -95,36 +49,27 @@ export class JsonSocket {
 
     if (this.contentLength !== null) {
       const length = this.buffer.length;
-
       if (length === this.contentLength) {
         this.handleMessage(this.buffer);
       } else if (length > this.contentLength) {
         const message = this.buffer.substring(0, this.contentLength);
         const rest = this.buffer.substring(this.contentLength);
         this.handleMessage(message);
-        this.onData(rest);
+        this.handleData(rest);
       }
     }
   }
 
-  private handleMessage(data: string) {
+  private handleMessage(message: any) {
     this.contentLength = null;
     this.buffer = '';
-
-    let message: Record<string, unknown>;
-    try {
-      message = JSON.parse(data);
-    } catch (e) {
-      throw new InvalidJSONFormatException(e, data);
-    }
-    message = message || {};
-    this.socket.emit(MESSAGE_EVENT, message);
+    this.emitMessage(message);
   }
 
   private formatMessageData(message: any) {
     const messageData = JSON.stringify(message);
     const length = messageData.length;
-    const data = length + this.delimeter + messageData;
+    const data = length + this.delimiter + messageData;
     return data;
   }
 }
diff --git a/packages/microservices/helpers/kafka-parser.ts b/packages/microservices/helpers/kafka-parser.ts
index 781217ff8..1d40e94d1 100644
--- a/packages/microservices/helpers/kafka-parser.ts
+++ b/packages/microservices/helpers/kafka-parser.ts
@@ -9,22 +9,28 @@ export class KafkaParser {
   }
 
   public parse<T = any>(data: any): T {
+    // Clone object to as modifying the original one would break KafkaJS retries
+    const result = {
+      ...data,
+      headers: { ...data.headers },
+    };
+
     if (!this.keepBinary) {
-      data.value = this.decode(data.value);
+      result.value = this.decode(data.value);
     }
 
     if (!isNil(data.key)) {
-      data.key = this.decode(data.key);
+      result.key = this.decode(data.key);
     }
     if (!isNil(data.headers)) {
       const decodeHeaderByKey = (key: string) => {
-        data.headers[key] = this.decode(data.headers[key]);
+        result.headers[key] = this.decode(data.headers[key]);
       };
       Object.keys(data.headers).forEach(decodeHeaderByKey);
     } else {
-      data.headers = {};
+      result.headers = {};
     }
-    return data;
+    return result;
   }
 
   public decode(value: Buffer): object | string | null | Buffer {
@@ -44,11 +50,13 @@ export class KafkaParser {
     let result = value.toString();
     const startChar = result.charAt(0);
 
-    // only try to parse objects and arrays
+    // Only try to parse objects and arrays
     if (startChar === '{' || startChar === '[') {
       try {
         result = JSON.parse(value.toString());
-      } catch (e) {}
+      } catch (e) {
+        // Do nothing
+      }
     }
     return result;
   }
diff --git a/packages/microservices/helpers/tcp-socket.ts b/packages/microservices/helpers/tcp-socket.ts
new file mode 100644
index 000000000..cd4988fc1
--- /dev/null
+++ b/packages/microservices/helpers/tcp-socket.ts
@@ -0,0 +1,75 @@
+import { Buffer } from 'buffer';
+import { Socket } from 'net';
+import { InvalidJSONFormatException } from '../errors/invalid-json-format.exception';
+import { NetSocketClosedException } from '../errors/net-socket-closed.exception';
+import { TcpEventsMap } from '../events/tcp.events';
+
+export abstract class TcpSocket {
+  private isClosed = false;
+
+  public get netSocket() {
+    return this.socket;
+  }
+
+  constructor(public readonly socket: Socket) {
+    this.socket.on('data', this.onData.bind(this));
+    this.socket.on(TcpEventsMap.CONNECT, () => (this.isClosed = false));
+    this.socket.on(TcpEventsMap.CLOSE, () => (this.isClosed = true));
+    this.socket.on(TcpEventsMap.ERROR, () => (this.isClosed = true));
+  }
+
+  public connect(port: number, host: string) {
+    this.socket.connect(port, host);
+    return this;
+  }
+
+  public on(event: string, callback: (err?: any) => void) {
+    this.socket.on(event, callback);
+    return this;
+  }
+
+  public once(event: string, callback: (err?: any) => void) {
+    this.socket.once(event, callback);
+    return this;
+  }
+
+  public end() {
+    this.socket.end();
+    return this;
+  }
+
+  public sendMessage(message: any, callback?: (err?: any) => void) {
+    if (this.isClosed) {
+      callback && callback(new NetSocketClosedException());
+      return;
+    }
+    this.handleSend(message, callback);
+  }
+
+  protected abstract handleSend(
+    message: any,
+    callback?: (err?: any) => void,
+  ): any;
+
+  private onData(data: Buffer) {
+    try {
+      this.handleData(data);
+    } catch (e) {
+      this.socket.emit(TcpEventsMap.ERROR, e.message);
+      this.socket.end();
+    }
+  }
+
+  protected abstract handleData(data: Buffer | string): any;
+
+  protected emitMessage(data: string) {
+    let message: Record<string, unknown>;
+    try {
+      message = JSON.parse(data);
+    } catch (e) {
+      throw new InvalidJSONFormatException(e, data);
+    }
+    message = message || {};
+    this.socket.emit('message', message);
+  }
+}
diff --git a/packages/microservices/index.ts b/packages/microservices/index.ts
index 81f4992ef..02bbed3f6 100644
--- a/packages/microservices/index.ts
+++ b/packages/microservices/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @microservices
- * Copyright(c) 2017 - 2021 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2023 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
@@ -10,6 +10,7 @@ export * from './client';
 export * from './ctx-host';
 export * from './decorators';
 export * from './enums';
+export * from './events';
 export * from './exceptions';
 export * from './helpers';
 export * from './interfaces';
diff --git a/packages/microservices/interfaces/client-grpc.interface.ts b/packages/microservices/interfaces/client-grpc.interface.ts
index ebb73f466..2eefbac2e 100644
--- a/packages/microservices/interfaces/client-grpc.interface.ts
+++ b/packages/microservices/interfaces/client-grpc.interface.ts
@@ -1,4 +1,17 @@
+/**
+ * @publicApi
+ */
 export interface ClientGrpc {
-  getService<T extends {}>(name: string): T;
+  /**
+   * Returns an instance of the given gRPC service.
+   * @param name Service name
+   * @returns gRPC service
+   */
+  getService<T extends object>(name: string): T;
+  /**
+   * Returns an instance of the given gRPC client.
+   * @param name Service name
+   * @returns gRPC client
+   */
   getClientByServiceName<T = any>(name: string): T;
 }
diff --git a/packages/microservices/interfaces/client-kafka-proxy.interface.ts b/packages/microservices/interfaces/client-kafka-proxy.interface.ts
new file mode 100644
index 000000000..6047ecf2d
--- /dev/null
+++ b/packages/microservices/interfaces/client-kafka-proxy.interface.ts
@@ -0,0 +1,33 @@
+import { ClientProxy } from '../client';
+import { KafkaStatus } from '../events';
+import {
+  Consumer,
+  Producer,
+  TopicPartitionOffsetAndMetadata,
+} from '../external/kafka.interface';
+
+export interface ClientKafkaProxy
+  extends Omit<ClientProxy<never, KafkaStatus>, 'on'> {
+  /**
+   * Reference to the Kafka consumer instance.
+   */
+  consumer: Consumer | null;
+  /**
+   * Reference to the Kafka producer instance.
+   */
+  producer: Producer | null;
+  /**
+   * Subscribes to messages that match the pattern.
+   * Required for message-driven communication style between microservices.
+   * You can't use `send` without subscribing to the message pattern first.
+   * @param pattern Pattern to subscribe to
+   */
+  subscribeToResponseOf(pattern: unknown): void;
+  /**
+   * Commits the given offsets.
+   * @param topicPartitions Array of topic partitions with their offsets and metadata
+   */
+  commitOffsets(
+    topicPartitions: TopicPartitionOffsetAndMetadata[],
+  ): Promise<void>;
+}
diff --git a/packages/microservices/interfaces/client-metadata.interface.ts b/packages/microservices/interfaces/client-metadata.interface.ts
index 4962eecc1..26b68e36c 100644
--- a/packages/microservices/interfaces/client-metadata.interface.ts
+++ b/packages/microservices/interfaces/client-metadata.interface.ts
@@ -1,6 +1,8 @@
 import { Type } from '@nestjs/common';
+import { ConnectionOptions } from 'tls';
 import { ClientProxy } from '../client';
 import { Transport } from '../enums/transport.enum';
+import { TcpSocket } from '../helpers';
 import { Deserializer } from './deserializer.interface';
 import {
   GrpcOptions,
@@ -21,11 +23,17 @@ export type ClientOptions =
   | TcpClientOptions
   | RmqOptions;
 
+/**
+ * @publicApi
+ */
 export interface CustomClientOptions {
   customClass: Type<ClientProxy>;
   options?: Record<string, any>;
 }
 
+/**
+ * @publicApi
+ */
 export interface TcpClientOptions {
   transport: Transport.TCP;
   options?: {
@@ -33,5 +41,7 @@ export interface TcpClientOptions {
     port?: number;
     serializer?: Serializer;
     deserializer?: Deserializer;
+    tlsOptions?: ConnectionOptions;
+    socketClass?: Type<TcpSocket>;
   };
 }
diff --git a/packages/microservices/interfaces/closeable.interface.ts b/packages/microservices/interfaces/closeable.interface.ts
deleted file mode 100644
index a5cc2c694..000000000
--- a/packages/microservices/interfaces/closeable.interface.ts
+++ /dev/null
@@ -1,3 +0,0 @@
-export interface Closeable {
-  close(): void;
-}
diff --git a/packages/microservices/interfaces/custom-transport-strategy.interface.ts b/packages/microservices/interfaces/custom-transport-strategy.interface.ts
index b5d5b2760..56886df41 100644
--- a/packages/microservices/interfaces/custom-transport-strategy.interface.ts
+++ b/packages/microservices/interfaces/custom-transport-strategy.interface.ts
@@ -1,7 +1,20 @@
 import { Transport } from '../enums';
 
+/**
+ * @publicApi
+ */
 export interface CustomTransportStrategy {
-  readonly transportId?: Transport;
+  /**
+   * Unique transport identifier.
+   */
+  readonly transportId?: Transport | symbol;
+  /**
+   * Method called when the transport is being initialized.
+   * @param callback Function to be called upon initialization
+   */
   listen(callback: (...optionalParams: unknown[]) => any): any;
+  /**
+   * Method called when the transport is being terminated.
+   */
   close(): any;
 }
diff --git a/packages/microservices/interfaces/deserializer.interface.ts b/packages/microservices/interfaces/deserializer.interface.ts
index 69d3af4ad..d5529b697 100644
--- a/packages/microservices/interfaces/deserializer.interface.ts
+++ b/packages/microservices/interfaces/deserializer.interface.ts
@@ -4,6 +4,9 @@ import {
   IncomingResponse,
 } from './packet.interface';
 
+/**
+ * @publicApi
+ */
 export interface Deserializer<TInput = any, TOutput = any> {
   deserialize(
     value: TInput,
diff --git a/packages/microservices/interfaces/index.ts b/packages/microservices/interfaces/index.ts
index 6916a6c10..71718b8e1 100644
--- a/packages/microservices/interfaces/index.ts
+++ b/packages/microservices/interfaces/index.ts
@@ -1,6 +1,6 @@
 export * from './client-grpc.interface';
+export * from './client-kafka-proxy.interface';
 export * from './client-metadata.interface';
-export * from './closeable.interface';
 export * from './custom-transport-strategy.interface';
 export * from './deserializer.interface';
 export * from './message-handler.interface';
diff --git a/packages/microservices/interfaces/message-handler.interface.ts b/packages/microservices/interfaces/message-handler.interface.ts
index f93896d78..197fdad46 100644
--- a/packages/microservices/interfaces/message-handler.interface.ts
+++ b/packages/microservices/interfaces/message-handler.interface.ts
@@ -1,7 +1,17 @@
 import { Observable } from 'rxjs';
 
+/**
+ * @publicApi
+ */
 export interface MessageHandler<TInput = any, TContext = any, TResult = any> {
-  (data: TInput, ctx?: TContext): Promise<Observable<TResult>>;
-  next?: (data: TInput, ctx?: TContext) => Promise<Observable<TResult>>;
+  (
+    data: TInput,
+    ctx?: TContext,
+  ): Promise<Observable<TResult>> | Promise<TResult>;
+  next?: (
+    data: TInput,
+    ctx?: TContext,
+  ) => Promise<Observable<TResult>> | Promise<TResult>;
   isEventHandler?: boolean;
+  extras?: Record<string, any>;
 }
diff --git a/packages/microservices/interfaces/microservice-configuration.interface.ts b/packages/microservices/interfaces/microservice-configuration.interface.ts
index 9942b8b55..0c371076b 100644
--- a/packages/microservices/interfaces/microservice-configuration.interface.ts
+++ b/packages/microservices/interfaces/microservice-configuration.interface.ts
@@ -1,16 +1,23 @@
+import { InjectionToken, Type } from '@nestjs/common';
+import { TlsOptions } from 'tls';
 import { Transport } from '../enums/transport.enum';
 import { ChannelOptions } from '../external/grpc-options.interface';
 import {
   ConsumerConfig,
   ConsumerRunConfig,
-  ConsumerSubscribeTopic,
+  ConsumerSubscribeTopics,
   KafkaConfig,
   ProducerConfig,
   ProducerRecord,
 } from '../external/kafka.interface';
 import { MqttClientOptions, QoS } from '../external/mqtt-options.interface';
-import { ClientOpts } from '../external/redis.interface';
-import { RmqUrl } from '../external/rmq-url.interface';
+import { IORedisOptions } from '../external/redis.interface';
+import {
+  AmqpConnectionManagerSocketOptions,
+  AmqplibQueueOptions,
+  RmqUrl,
+} from '../external/rmq-url.interface';
+import { TcpSocket } from '../helpers';
 import { CustomTransportStrategy } from './custom-transport-strategy.interface';
 import { Deserializer } from './deserializer.interface';
 import { Serializer } from './serializer.interface';
@@ -25,17 +32,30 @@ export type MicroserviceOptions =
   | KafkaOptions
   | CustomStrategy;
 
+export type AsyncMicroserviceOptions = {
+  inject: InjectionToken[];
+  useFactory: (...args: any[]) => MicroserviceOptions;
+};
+
+export type AsyncOptions<T extends object> = {
+  inject: InjectionToken[];
+  useFactory: (...args: any[]) => T;
+};
+
+/**
+ * @publicApi
+ */
 export interface CustomStrategy {
   strategy: CustomTransportStrategy;
-  options?: {};
+  options?: Record<string, any>;
 }
 
+/**
+ * @publicApi
+ */
 export interface GrpcOptions {
   transport?: Transport.GRPC;
   options: {
-    interceptors?: Array<
-      (options: any, nextCall: (options: any) => any) => any
-    >;
     url?: string;
     maxSendMessageLength?: number;
     maxReceiveMessageLength?: number;
@@ -51,10 +71,12 @@ export interface GrpcOptions {
     };
     channelOptions?: ChannelOptions;
     credentials?: any;
-    protoPath: string | string[];
+    protoPath?: string | string[];
     package: string | string[];
     protoLoader?: string;
     packageDefinition?: any;
+    gracefulShutdown?: boolean;
+    onLoadPackageDefinition?: (pkg: any, server: any) => void;
     loader?: {
       keepCase?: boolean;
       alternateCommentMode?: boolean;
@@ -71,6 +93,9 @@ export interface GrpcOptions {
   };
 }
 
+/**
+ * @publicApi
+ */
 export interface TcpOptions {
   transport?: Transport.TCP;
   options?: {
@@ -79,21 +104,34 @@ export interface TcpOptions {
     retryAttempts?: number;
     retryDelay?: number;
     serializer?: Serializer;
+    tlsOptions?: TlsOptions;
     deserializer?: Deserializer;
+    socketClass?: Type<TcpSocket>;
   };
 }
 
+/**
+ * @publicApi
+ */
 export interface RedisOptions {
   transport?: Transport.REDIS;
   options?: {
-    url?: string;
+    host?: string;
+    port?: number;
     retryAttempts?: number;
     retryDelay?: number;
+    /**
+     * Use `psubscribe`/`pmessage` to enable wildcards in the patterns
+     */
+    wildcards?: boolean;
     serializer?: Serializer;
     deserializer?: Deserializer;
-  } & ClientOpts;
+  } & IORedisOptions;
 }
 
+/**
+ * @publicApi
+ */
 export interface MqttOptions {
   transport?: Transport.MQTT;
   options?: MqttClientOptions & {
@@ -122,6 +160,9 @@ export interface MqttOptions {
   };
 }
 
+/**
+ * @publicApi
+ */
 export interface NatsOptions {
   transport?: Transport.NATS;
   options?: {
@@ -162,10 +203,15 @@ export interface NatsOptions {
     token?: string;
     yieldTime?: number;
     tokenHandler?: any;
+    gracefulShutdown?: boolean;
+    gracePeriod?: number;
     [key: string]: any;
   };
 }
 
+/**
+ * @publicApi
+ */
 export interface RmqOptions {
   transport?: Transport.RMQ;
   options?: {
@@ -173,33 +219,54 @@ export interface RmqOptions {
     queue?: string;
     prefetchCount?: number;
     isGlobalPrefetchCount?: boolean;
-    queueOptions?: any; // AmqplibQueueOptions;
-    socketOptions?: any; // AmqpConnectionManagerSocketOptions;
+    queueOptions?: AmqplibQueueOptions;
+    socketOptions?: AmqpConnectionManagerSocketOptions;
+    exchange?: string;
+    routingKey?: string;
     noAck?: boolean;
+    consumerTag?: string;
     serializer?: Serializer;
     deserializer?: Deserializer;
     replyQueue?: string;
     persistent?: boolean;
     headers?: Record<string, string>;
+    noAssert?: boolean;
+    /**
+     * Maximum number of connection attempts.
+     * Applies only to the consumer configuration.
+     * -1 === infinite
+     * @default -1
+     */
+    maxConnectionAttempts?: number;
   };
 }
 
+/**
+ * @publicApi
+ */
 export interface KafkaParserConfig {
   keepBinary?: boolean;
 }
 
+/**
+ * @publicApi
+ */
 export interface KafkaOptions {
   transport?: Transport.KAFKA;
   options?: {
+    /**
+     * Defaults to `"-server"` on server side and `"-client"` on client side.
+     */
     postfixId?: string;
     client?: KafkaConfig;
     consumer?: ConsumerConfig;
     run?: Omit<ConsumerRunConfig, 'eachBatch' | 'eachMessage'>;
-    subscribe?: Omit<ConsumerSubscribeTopic, 'topic'>;
+    subscribe?: Omit<ConsumerSubscribeTopics, 'topics'>;
     producer?: ProducerConfig;
     send?: Omit<ProducerRecord, 'topic' | 'messages'>;
     serializer?: Serializer;
     deserializer?: Deserializer;
     parser?: KafkaParserConfig;
+    producerOnlyMode?: boolean;
   };
 }
diff --git a/packages/microservices/interfaces/microservice-entrypoint-metadata.interface.ts b/packages/microservices/interfaces/microservice-entrypoint-metadata.interface.ts
new file mode 100644
index 000000000..9993c7d77
--- /dev/null
+++ b/packages/microservices/interfaces/microservice-entrypoint-metadata.interface.ts
@@ -0,0 +1,9 @@
+import { Transport } from '../enums';
+import { PatternMetadata } from './pattern-metadata.interface';
+
+export type MicroserviceEntrypointMetadata = {
+  transportId: keyof typeof Transport | symbol;
+  patterns: PatternMetadata[];
+  isEventHandler: boolean;
+  extras?: Record<string, any>;
+};
diff --git a/packages/microservices/interfaces/serializer.interface.ts b/packages/microservices/interfaces/serializer.interface.ts
index 6674cd6b1..4c090467c 100644
--- a/packages/microservices/interfaces/serializer.interface.ts
+++ b/packages/microservices/interfaces/serializer.interface.ts
@@ -4,8 +4,11 @@ import {
   OutgoingResponse,
 } from './packet.interface';
 
+/**
+ * @publicApi
+ */
 export interface Serializer<TInput = any, TOutput = any> {
-  serialize(value: TInput): TOutput;
+  serialize(value: TInput, options?: Record<string, any>): TOutput;
 }
 
 export type ProducerSerializer = Serializer<
diff --git a/packages/microservices/listener-metadata-explorer.ts b/packages/microservices/listener-metadata-explorer.ts
index 322780ad5..e0fdd9c03 100644
--- a/packages/microservices/listener-metadata-explorer.ts
+++ b/packages/microservices/listener-metadata-explorer.ts
@@ -4,14 +4,14 @@ import { MetadataScanner } from '@nestjs/core/metadata-scanner';
 import {
   CLIENT_CONFIGURATION_METADATA,
   CLIENT_METADATA,
+  PATTERN_EXTRAS_METADATA,
   PATTERN_HANDLER_METADATA,
   PATTERN_METADATA,
   TRANSPORT_METADATA,
 } from './constants';
 import { Transport } from './enums';
 import { PatternHandler } from './enums/pattern-handler.enum';
-import { ClientOptions } from './interfaces/client-metadata.interface';
-import { PatternMetadata } from './interfaces/pattern-metadata.interface';
+import { ClientOptions, PatternMetadata } from './interfaces';
 
 export interface ClientProperties {
   property: string;
@@ -19,11 +19,12 @@ export interface ClientProperties {
 }
 
 export interface EventOrMessageListenerDefinition {
-  pattern: PatternMetadata;
+  patterns: PatternMetadata[];
   methodKey: string;
   isEventHandler: boolean;
   targetCallback: (...args: any[]) => any;
   transport?: Transport;
+  extras?: Record<string, any>;
 }
 
 export interface MessageRequestProperties {
@@ -36,33 +37,45 @@ export class ListenerMetadataExplorer {
 
   public explore(instance: Controller): EventOrMessageListenerDefinition[] {
     const instancePrototype = Object.getPrototypeOf(instance);
-    return this.metadataScanner.scanFromPrototype<
-      Controller,
-      EventOrMessageListenerDefinition
-    >(instance, instancePrototype, method =>
-      this.exploreMethodMetadata(instancePrototype, method),
-    );
+    return this.metadataScanner
+      .getAllMethodNames(instancePrototype)
+      .map(
+        method =>
+          this.exploreMethodMetadata(instance, instancePrototype, method)!,
+      )
+      .filter(metadata => metadata);
   }
 
   public exploreMethodMetadata(
+    instance: Controller,
     instancePrototype: object,
     methodKey: string,
-  ): EventOrMessageListenerDefinition {
-    const targetCallback = instancePrototype[methodKey];
+  ): EventOrMessageListenerDefinition | undefined {
+    const prototypeCallback = instancePrototype[methodKey];
     const handlerType = Reflect.getMetadata(
       PATTERN_HANDLER_METADATA,
-      targetCallback,
+      prototypeCallback,
     );
     if (isUndefined(handlerType)) {
       return;
     }
-    const pattern = Reflect.getMetadata(PATTERN_METADATA, targetCallback);
-    const transport = Reflect.getMetadata(TRANSPORT_METADATA, targetCallback);
+    const patterns = Reflect.getMetadata(PATTERN_METADATA, prototypeCallback);
+    const transport = Reflect.getMetadata(
+      TRANSPORT_METADATA,
+      prototypeCallback,
+    );
+    const extras = Reflect.getMetadata(
+      PATTERN_EXTRAS_METADATA,
+      prototypeCallback,
+    );
+
+    const targetCallback = instance[methodKey];
     return {
       methodKey,
       targetCallback,
-      pattern,
+      patterns,
       transport,
+      extras,
       isEventHandler: handlerType === PatternHandler.EVENT,
     };
   }
diff --git a/packages/microservices/listeners-controller.ts b/packages/microservices/listeners-controller.ts
index 1f3c307a8..86f556e33 100644
--- a/packages/microservices/listeners-controller.ts
+++ b/packages/microservices/listeners-controller.ts
@@ -1,4 +1,3 @@
-import { Injectable } from '@nestjs/common/interfaces';
 import { Controller } from '@nestjs/common/interfaces/controllers/controller.interface';
 import { isUndefined } from '@nestjs/common/utils/shared.utils';
 import { ContextIdFactory } from '@nestjs/core/helpers/context-id-factory';
@@ -11,9 +10,18 @@ import {
   InstanceWrapper,
 } from '@nestjs/core/injector/instance-wrapper';
 import { Module } from '@nestjs/core/injector/module';
+import { GraphInspector } from '@nestjs/core/inspector/graph-inspector';
 import { MetadataScanner } from '@nestjs/core/metadata-scanner';
 import { REQUEST_CONTEXT_ID } from '@nestjs/core/router/request/request-constants';
-import { connectable, Observable, Subject } from 'rxjs';
+import {
+  forkJoin,
+  from as fromPromise,
+  isObservable,
+  mergeMap,
+  Observable,
+  ObservedValueOf,
+  of,
+} from 'rxjs';
 import { IClientProxyFactory } from './client/client-proxy-factory';
 import { ClientsContainer } from './container';
 import { ExceptionFiltersContext } from './context/exception-filters-context';
@@ -24,13 +32,13 @@ import {
   DEFAULT_GRPC_CALLBACK_METADATA,
 } from './context/rpc-metadata-constants';
 import { BaseRpcContext } from './ctx-host/base-rpc.context';
+import { Transport } from './enums';
+import { MessageHandler, PatternMetadata, RequestContext } from './interfaces';
+import { MicroserviceEntrypointMetadata } from './interfaces/microservice-entrypoint-metadata.interface';
 import {
-  CustomTransportStrategy,
-  MessageHandler,
-  PatternMetadata,
-  RequestContext,
-} from './interfaces';
-import { ListenerMetadataExplorer } from './listener-metadata-explorer';
+  EventOrMessageListenerDefinition,
+  ListenerMetadataExplorer,
+} from './listener-metadata-explorer';
 import { ServerGrpc } from './server';
 import { Server } from './server/server';
 
@@ -47,20 +55,21 @@ export class ListenersController {
     private readonly injector: Injector,
     private readonly clientFactory: IClientProxyFactory,
     private readonly exceptionFiltersContext: ExceptionFiltersContext,
+    private readonly graphInspector: GraphInspector,
   ) {}
 
   public registerPatternHandlers(
-    instanceWrapper: InstanceWrapper<Controller | Injectable>,
-    server: Server & CustomTransportStrategy,
+    instanceWrapper: InstanceWrapper<Controller>,
+    serverInstance: Server,
     moduleKey: string,
   ) {
     const { instance } = instanceWrapper;
 
     const isStatic = instanceWrapper.isDependencyTreeStatic();
-    const patternHandlers = this.metadataExplorer.explore(instance as object);
+    const patternHandlers = this.metadataExplorer.explore(instance);
     const moduleRef = this.container.getModuleByKey(moduleKey);
     const defaultCallMetadata =
-      server instanceof ServerGrpc
+      serverInstance instanceof ServerGrpc
         ? DEFAULT_GRPC_CALLBACK_METADATA
         : DEFAULT_CALLBACK_METADATA;
 
@@ -68,13 +77,33 @@ export class ListenersController {
       .filter(
         ({ transport }) =>
           isUndefined(transport) ||
-          isUndefined(server.transportId) ||
-          transport === server.transportId,
+          isUndefined(serverInstance.transportId) ||
+          transport === serverInstance.transportId,
       )
-      .forEach(({ pattern, targetCallback, methodKey, isEventHandler }) => {
+      .reduce((acc, handler) => {
+        handler.patterns.forEach(pattern =>
+          acc.push({ ...handler, patterns: [pattern] }),
+        );
+        return acc;
+      }, [] as EventOrMessageListenerDefinition[])
+      .forEach((definition: EventOrMessageListenerDefinition) => {
+        const {
+          patterns: [pattern],
+          targetCallback,
+          methodKey,
+          extras,
+          isEventHandler,
+        } = definition;
+
+        this.insertEntrypointDefinition(
+          instanceWrapper,
+          definition,
+          serverInstance.transportId!,
+        );
+
         if (isStatic) {
           const proxy = this.contextCreator.create(
-            instance as object,
+            instance,
             targetCallback,
             moduleKey,
             methodKey,
@@ -83,56 +112,113 @@ export class ListenersController {
             defaultCallMetadata,
           );
           if (isEventHandler) {
-            const eventHandler: MessageHandler = (...args: unknown[]) => {
+            const eventHandler: MessageHandler = async (...args: unknown[]) => {
               const originalArgs = args;
               const [dataOrContextHost] = originalArgs;
               if (dataOrContextHost instanceof RequestContextHost) {
                 args = args.slice(1, args.length);
               }
-              const originalReturnValue = proxy(...args);
-              const returnedValueWrapper = eventHandler.next?.(
-                ...(originalArgs as Parameters<MessageHandler>),
+              const returnValue = proxy(...args);
+              return this.forkJoinHandlersIfAttached(
+                returnValue,
+                originalArgs,
+                eventHandler,
               );
-              returnedValueWrapper?.then(returnedValue =>
-                this.connectIfStream(returnedValue as Observable<unknown>),
-              );
-              return originalReturnValue;
             };
-            return server.addHandler(pattern, eventHandler, isEventHandler);
+            return serverInstance.addHandler(
+              pattern,
+              eventHandler,
+              isEventHandler,
+              extras,
+            );
           } else {
-            return server.addHandler(pattern, proxy, isEventHandler);
+            return serverInstance.addHandler(
+              pattern,
+              proxy,
+              isEventHandler,
+              extras,
+            );
           }
         }
         const asyncHandler = this.createRequestScopedHandler(
           instanceWrapper,
           pattern,
-          moduleRef,
+          moduleRef!,
           moduleKey,
           methodKey,
           defaultCallMetadata,
+          isEventHandler,
+        );
+        serverInstance.addHandler(
+          pattern,
+          asyncHandler,
+          isEventHandler,
+          extras,
         );
-        server.addHandler(pattern, asyncHandler, isEventHandler);
       });
   }
 
-  public assignClientsToProperties(instance: Controller | Injectable) {
+  public insertEntrypointDefinition(
+    instanceWrapper: InstanceWrapper,
+    definition: EventOrMessageListenerDefinition,
+    transportId: Transport | symbol,
+  ) {
+    this.graphInspector.insertEntrypointDefinition<MicroserviceEntrypointMetadata>(
+      {
+        type: 'microservice',
+        methodName: definition.methodKey,
+        className: instanceWrapper.metatype?.name as string,
+        classNodeId: instanceWrapper.id,
+        metadata: {
+          key: definition.patterns.toString(),
+          transportId:
+            typeof transportId === 'number'
+              ? (Transport[transportId] as keyof typeof Transport)
+              : transportId,
+          patterns: definition.patterns,
+          isEventHandler: definition.isEventHandler,
+          extras: definition.extras,
+        },
+      },
+      instanceWrapper.id,
+    );
+  }
+
+  public forkJoinHandlersIfAttached(
+    currentReturnValue: Promise<unknown> | Observable<unknown>,
+    originalArgs: unknown[],
+    handlerRef: MessageHandler,
+  ) {
+    if (handlerRef.next) {
+      const returnedValueWrapper = handlerRef.next(
+        ...(originalArgs as Parameters<MessageHandler>),
+      );
+      return forkJoin({
+        current: this.transformToObservable(currentReturnValue),
+        next: this.transformToObservable(returnedValueWrapper),
+      });
+    }
+    return currentReturnValue;
+  }
+
+  public assignClientsToProperties(instance: Controller) {
     for (const {
       property,
       metadata,
-    } of this.metadataExplorer.scanForClientHooks(instance as object)) {
+    } of this.metadataExplorer.scanForClientHooks(instance)) {
       const client = this.clientFactory.create(metadata);
       this.clientsContainer.addClient(client);
 
-      this.assignClientToInstance(instance as object, property, client);
+      this.assignClientToInstance(instance, property, client);
     }
   }
 
   public assignClientToInstance<T = any>(
-    instance: Controller | Injectable,
+    instance: Controller,
     property: string,
     client: T,
   ) {
-    Reflect.set(instance as object, property, client);
+    Reflect.set(instance, property, client);
   }
 
   public createRequestScopedHandler(
@@ -142,17 +228,20 @@ export class ListenersController {
     moduleKey: string,
     methodKey: string,
     defaultCallMetadata: Record<string, any> = DEFAULT_CALLBACK_METADATA,
+    isEventHandler = false,
   ) {
     const collection = moduleRef.controllers;
     const { instance } = wrapper;
 
+    const isTreeDurable = wrapper.isDependencyTreeDurable();
+
     const requestScopedHandler: MessageHandler = async (...args: unknown[]) => {
       try {
         let contextId: ContextId;
 
         let [dataOrContextHost] = args;
         if (dataOrContextHost instanceof RequestContextHost) {
-          contextId = this.getContextId(dataOrContextHost);
+          contextId = this.getContextId(dataOrContextHost, isTreeDurable);
           args.shift();
         } else {
           const [data, reqCtx] = args;
@@ -161,10 +250,10 @@ export class ListenersController {
             data,
             reqCtx as BaseRpcContext,
           );
-          contextId = this.getContextId(request);
-          this.container.registerRequestProvider(request, contextId);
+          contextId = this.getContextId(request, isTreeDurable);
           dataOrContextHost = request;
         }
+
         const contextInstance = await this.injector.loadPerContext(
           instance,
           moduleRef,
@@ -180,8 +269,16 @@ export class ListenersController {
           wrapper.id,
           defaultCallMetadata,
         );
-        requestScopedHandler.next?.(dataOrContextHost, ...args);
-        return proxy(...args);
+
+        const returnValue = proxy(...args);
+        if (isEventHandler) {
+          return this.forkJoinHandlersIfAttached(
+            returnValue,
+            [dataOrContextHost, ...args],
+            requestScopedHandler,
+          );
+        }
+        return returnValue;
       } catch (err) {
         let exceptionFilter = this.exceptionFiltersCache.get(
           instance[methodKey],
@@ -202,7 +299,10 @@ export class ListenersController {
     return requestScopedHandler;
   }
 
-  private getContextId<T extends RequestContext = any>(request: T): ContextId {
+  private getContextId<T extends RequestContext = any>(
+    request: T,
+    isTreeDurable: boolean,
+  ): ContextId {
     const contextId = ContextIdFactory.getByRequest(request);
     if (!request[REQUEST_CONTEXT_ID as any]) {
       Object.defineProperty(request, REQUEST_CONTEXT_ID, {
@@ -211,19 +311,34 @@ export class ListenersController {
         writable: false,
         configurable: false,
       });
-      this.container.registerRequestProvider(request, contextId);
+
+      const requestProviderValue = isTreeDurable
+        ? contextId.payload
+        : Object.assign(request, contextId.payload);
+      this.container.registerRequestProvider(requestProviderValue, contextId);
     }
     return contextId;
   }
 
-  private connectIfStream(source: Observable<unknown>) {
-    if (!source) {
-      return;
+  public transformToObservable<T>(
+    resultOrDeferred: Observable<T> | Promise<T>,
+  ): Observable<T>;
+  public transformToObservable<T>(
+    resultOrDeferred: T,
+  ): never extends Observable<ObservedValueOf<T>>
+    ? Observable<T>
+    : Observable<ObservedValueOf<T>>;
+  public transformToObservable(resultOrDeferred: any) {
+    if (resultOrDeferred instanceof Promise) {
+      return fromPromise(resultOrDeferred).pipe(
+        mergeMap(val => (isObservable(val) ? val : of(val))),
+      );
     }
-    const connectableSource = connectable(source, {
-      connector: () => new Subject(),
-      resetOnDisconnect: false,
-    });
-    connectableSource.connect();
+
+    if (isObservable(resultOrDeferred)) {
+      return resultOrDeferred;
+    }
+
+    return of(resultOrDeferred);
   }
 }
diff --git a/packages/microservices/microservices-module.ts b/packages/microservices/microservices-module.ts
index 735fda9fe..fe56e5092 100644
--- a/packages/microservices/microservices-module.ts
+++ b/packages/microservices/microservices-module.ts
@@ -1,36 +1,46 @@
 import { Controller } from '@nestjs/common/interfaces/controllers/controller.interface';
+import { NestApplicationContextOptions } from '@nestjs/common/interfaces/nest-application-context-options.interface';
 import { ApplicationConfig } from '@nestjs/core/application-config';
 import { RuntimeException } from '@nestjs/core/errors/exceptions/runtime.exception';
-import { GuardsConsumer } from '@nestjs/core/guards/guards-consumer';
-import { GuardsContextCreator } from '@nestjs/core/guards/guards-context-creator';
+import { GuardsConsumer, GuardsContextCreator } from '@nestjs/core/guards';
 import { NestContainer } from '@nestjs/core/injector/container';
 import { Injector } from '@nestjs/core/injector/injector';
 import { InstanceWrapper } from '@nestjs/core/injector/instance-wrapper';
-import { InterceptorsConsumer } from '@nestjs/core/interceptors/interceptors-consumer';
-import { InterceptorsContextCreator } from '@nestjs/core/interceptors/interceptors-context-creator';
-import { PipesConsumer } from '@nestjs/core/pipes/pipes-consumer';
-import { PipesContextCreator } from '@nestjs/core/pipes/pipes-context-creator';
+import { GraphInspector } from '@nestjs/core/inspector/graph-inspector';
+import {
+  InterceptorsConsumer,
+  InterceptorsContextCreator,
+} from '@nestjs/core/interceptors';
+import { PipesConsumer, PipesContextCreator } from '@nestjs/core/pipes';
 import { ClientProxyFactory } from './client';
 import { ClientsContainer } from './container';
 import { ExceptionFiltersContext } from './context/exception-filters-context';
 import { RpcContextCreator } from './context/rpc-context-creator';
 import { RpcProxy } from './context/rpc-proxy';
-import { CustomTransportStrategy } from './interfaces';
 import { ListenersController } from './listeners-controller';
 import { Server } from './server/server';
 
-export class MicroservicesModule {
+export class MicroservicesModule<
+  TAppOptions extends
+    NestApplicationContextOptions = NestApplicationContextOptions,
+> {
   private readonly clientsContainer = new ClientsContainer();
   private listenersController: ListenersController;
+  private appOptions: TAppOptions;
 
-  public register(container: NestContainer, config: ApplicationConfig) {
-    const rpcProxy = new RpcProxy();
+  public register(
+    container: NestContainer,
+    graphInspector: GraphInspector,
+    config: ApplicationConfig,
+    options: TAppOptions,
+  ) {
+    this.appOptions = options;
     const exceptionFiltersContext = new ExceptionFiltersContext(
       container,
       config,
     );
     const contextCreator = new RpcContextCreator(
-      rpcProxy,
+      new RpcProxy(),
       exceptionFiltersContext,
       new PipesContextCreator(container, config),
       new PipesConsumer(),
@@ -48,19 +58,17 @@ export class MicroservicesModule {
       injector,
       ClientProxyFactory,
       exceptionFiltersContext,
+      graphInspector,
     );
   }
 
-  public setupListeners(
-    container: NestContainer,
-    server: Server & CustomTransportStrategy,
-  ) {
+  public setupListeners(container: NestContainer, serverInstance: Server) {
     if (!this.listenersController) {
       throw new RuntimeException();
     }
     const modules = container.getModules();
     modules.forEach(({ controllers }, moduleRef) =>
-      this.bindListeners(controllers, server, moduleRef),
+      this.bindListeners(controllers, serverInstance, moduleRef),
     );
   }
 
@@ -68,6 +76,9 @@ export class MicroservicesModule {
     if (!this.listenersController) {
       throw new RuntimeException();
     }
+    if (this.appOptions?.preview) {
+      return;
+    }
     const modules = container.getModules();
     modules.forEach(({ controllers, providers }) => {
       this.bindClients(controllers);
@@ -77,13 +88,13 @@ export class MicroservicesModule {
 
   public bindListeners(
     controllers: Map<string | symbol | Function, InstanceWrapper<Controller>>,
-    server: Server & CustomTransportStrategy,
+    serverInstance: Server,
     moduleName: string,
   ) {
     controllers.forEach(wrapper =>
       this.listenersController.registerPatternHandlers(
         wrapper,
-        server,
+        serverInstance,
         moduleName,
       ),
     );
@@ -94,7 +105,7 @@ export class MicroservicesModule {
   ) {
     items.forEach(({ instance, isNotMetatype }) => {
       !isNotMetatype &&
-        this.listenersController.assignClientsToProperties(instance);
+        this.listenersController.assignClientsToProperties(instance as object);
     });
   }
 
diff --git a/packages/microservices/module/clients.module.ts b/packages/microservices/module/clients.module.ts
index 20f93ca10..4ed9f2eb9 100644
--- a/packages/microservices/module/clients.module.ts
+++ b/packages/microservices/module/clients.module.ts
@@ -1,11 +1,12 @@
 import {
   DynamicModule,
+  ForwardReference,
   Module,
   OnApplicationShutdown,
   Provider,
+  Type,
 } from '@nestjs/common';
 import { ClientProxy, ClientProxyFactory } from '../client';
-import { Closeable } from '../interfaces';
 import {
   ClientsModuleAsyncOptions,
   ClientsModuleOptions,
@@ -16,34 +17,47 @@ import {
 @Module({})
 export class ClientsModule {
   static register(options: ClientsModuleOptions): DynamicModule {
-    const clients = (options || []).map(item => ({
-      provide: item.name,
-      useValue: this.assignOnAppShutdownHook(ClientProxyFactory.create(item)),
-    }));
+    const clientsOptions = !Array.isArray(options) ? options.clients : options;
+    const clients = (clientsOptions || []).map(item => {
+      return {
+        provide: item.name,
+        useValue: this.assignOnAppShutdownHook(ClientProxyFactory.create(item)),
+      };
+    });
     return {
       module: ClientsModule,
+      global: !Array.isArray(options) && options.isGlobal,
       providers: clients,
       exports: clients,
     };
   }
 
   static registerAsync(options: ClientsModuleAsyncOptions): DynamicModule {
-    const providers: Provider[] = options.reduce(
+    const clientsOptions = !Array.isArray(options) ? options.clients : options;
+    const providers: Provider[] = clientsOptions.reduce(
       (accProviders: Provider[], item) =>
         accProviders
           .concat(this.createAsyncProviders(item))
           .concat(item.extraProviders || []),
       [],
     );
-    const imports = options.reduce(
-      (accImports, option) =>
-        option.imports && !accImports.includes(option.imports)
-          ? accImports.concat(option.imports)
-          : accImports,
-      [],
+    const imports = clientsOptions.reduce(
+      (accImports, option) => {
+        if (!option.imports) {
+          return accImports;
+        }
+        const toInsert = option.imports.filter(
+          item => !accImports.includes(item),
+        );
+        return accImports.concat(toInsert);
+      },
+      [] as Array<
+        DynamicModule | Promise<DynamicModule> | ForwardReference | Type
+      >,
     );
     return {
       module: ClientsModule,
+      global: !Array.isArray(options) && options.isGlobal,
       imports,
       providers: providers,
       exports: providers,
@@ -59,8 +73,8 @@ export class ClientsModule {
     return [
       this.createAsyncOptionsProvider(options),
       {
-        provide: options.useClass,
-        useClass: options.useClass,
+        provide: options.useClass!,
+        useClass: options.useClass!,
       },
     ];
   }
@@ -81,7 +95,7 @@ export class ClientsModule {
         (optionsFactory: ClientsModuleOptionsFactory) =>
           optionsFactory.createClientOptions(),
       ),
-      inject: [options.useExisting || options.useClass],
+      inject: [options.useExisting || options.useClass!],
     };
   }
 
@@ -89,13 +103,13 @@ export class ClientsModule {
     useFactory: ClientsProviderAsyncOptions['useFactory'],
   ) {
     return async (...args: any[]) => {
-      const clientOptions = await useFactory(...args);
+      const clientOptions = await useFactory!(...args);
       const clientProxyRef = ClientProxyFactory.create(clientOptions);
       return this.assignOnAppShutdownHook(clientProxyRef);
     };
   }
 
-  private static assignOnAppShutdownHook(client: ClientProxy & Closeable) {
+  private static assignOnAppShutdownHook(client: ClientProxy) {
     (client as unknown as OnApplicationShutdown).onApplicationShutdown =
       client.close;
     return client;
diff --git a/packages/microservices/module/interfaces/clients-module.interface.ts b/packages/microservices/module/interfaces/clients-module.interface.ts
index 37e5a2e1b..f4cd29c5a 100644
--- a/packages/microservices/module/interfaces/clients-module.interface.ts
+++ b/packages/microservices/module/interfaces/clients-module.interface.ts
@@ -7,7 +7,12 @@ export type ClientProviderOptions = ClientProvider & {
   name: string | symbol;
 };
 
-export type ClientsModuleOptions = Array<ClientProviderOptions>;
+export type ClientsModuleOptions =
+  | Array<ClientProviderOptions>
+  | {
+      clients: Array<ClientProviderOptions>;
+      isGlobal?: boolean;
+    };
 
 export interface ClientsModuleOptionsFactory {
   createClientOptions(): Promise<ClientProvider> | ClientProvider;
@@ -23,4 +28,9 @@ export interface ClientsProviderAsyncOptions
   name: string | symbol;
 }
 
-export type ClientsModuleAsyncOptions = Array<ClientsProviderAsyncOptions>;
+export type ClientsModuleAsyncOptions =
+  | Array<ClientsProviderAsyncOptions>
+  | {
+      clients: Array<ClientsProviderAsyncOptions>;
+      isGlobal?: boolean;
+    };
diff --git a/packages/microservices/nest-microservice.ts b/packages/microservices/nest-microservice.ts
index be5a79c5f..ea299121c 100644
--- a/packages/microservices/nest-microservice.ts
+++ b/packages/microservices/nest-microservice.ts
@@ -12,10 +12,14 @@ import { ApplicationConfig } from '@nestjs/core/application-config';
 import { MESSAGES } from '@nestjs/core/constants';
 import { optionalRequire } from '@nestjs/core/helpers/optional-require';
 import { NestContainer } from '@nestjs/core/injector/container';
+import { Injector } from '@nestjs/core/injector/injector';
+import { GraphInspector } from '@nestjs/core/inspector/graph-inspector';
 import { NestApplicationContext } from '@nestjs/core/nest-application-context';
 import { Transport } from './enums/transport.enum';
-import { CustomTransportStrategy } from './interfaces/custom-transport-strategy.interface';
-import { MicroserviceOptions } from './interfaces/microservice-configuration.interface';
+import {
+  AsyncMicroserviceOptions,
+  MicroserviceOptions,
+} from './interfaces/microservice-configuration.interface';
 import { MicroservicesModule } from './microservices-module';
 import { Server } from './server/server';
 import { ServerFactory } from './server/server-factory';
@@ -25,42 +29,71 @@ const { SocketModule } = optionalRequire(
   () => require('@nestjs/websockets/socket-module'),
 );
 
+type CompleteMicroserviceOptions = NestMicroserviceOptions &
+  (MicroserviceOptions | AsyncMicroserviceOptions);
+
 export class NestMicroservice
-  extends NestApplicationContext
+  extends NestApplicationContext<NestMicroserviceOptions>
   implements INestMicroservice
 {
-  private readonly logger = new Logger(NestMicroservice.name, {
+  protected readonly logger = new Logger(NestMicroservice.name, {
     timestamp: true,
   });
   private readonly microservicesModule = new MicroservicesModule();
   private readonly socketModule = SocketModule ? new SocketModule() : null;
-  private microserviceConfig: NestMicroserviceOptions & MicroserviceOptions;
-  private server: Server & CustomTransportStrategy;
+  private microserviceConfig: Exclude<
+    CompleteMicroserviceOptions,
+    AsyncMicroserviceOptions
+  >;
+  private serverInstance: Server;
   private isTerminated = false;
-  private isInitHookCalled = false;
+  private wasInitHookCalled = false;
+
+  /**
+   * Returns an observable that emits status changes.
+   */
+  get status() {
+    return this.serverInstance.status;
+  }
 
   constructor(
     container: NestContainer,
-    config: NestMicroserviceOptions & MicroserviceOptions = {},
+    config: CompleteMicroserviceOptions = {},
+    private readonly graphInspector: GraphInspector,
     private readonly applicationConfig: ApplicationConfig,
   ) {
-    super(container);
+    super(container, config);
 
-    this.microservicesModule.register(container, this.applicationConfig);
+    this.injector = new Injector({ preview: config.preview! });
+    this.microservicesModule.register(
+      container,
+      this.graphInspector,
+      this.applicationConfig,
+      this.appOptions,
+    );
     this.createServer(config);
     this.selectContextModule();
   }
 
-  public createServer(config: NestMicroserviceOptions & MicroserviceOptions) {
+  public createServer(config: CompleteMicroserviceOptions) {
     try {
-      this.microserviceConfig = {
-        transport: Transport.TCP,
-        ...config,
-      } as any;
-      const { strategy } = config as any;
-      this.server = strategy
-        ? strategy
-        : ServerFactory.create(this.microserviceConfig);
+      if ('useFactory' in config) {
+        this.microserviceConfig = this.resolveAsyncOptions(config);
+      } else {
+        this.microserviceConfig = {
+          transport: Transport.TCP,
+          ...config,
+        } as MicroserviceOptions;
+      }
+
+      if ('strategy' in config) {
+        this.serverInstance = config.strategy as Server;
+        return;
+      } else {
+        this.serverInstance = ServerFactory.create(
+          this.microserviceConfig,
+        ) as Server;
+      }
     } catch (e) {
       this.logger.error(e);
       throw e;
@@ -69,44 +102,101 @@ export class NestMicroservice
 
   public async registerModules(): Promise<any> {
     this.socketModule &&
-      this.socketModule.register(this.container, this.applicationConfig);
-    this.microservicesModule.setupClients(this.container);
+      this.socketModule.register(
+        this.container,
+        this.applicationConfig,
+        this.graphInspector,
+        this.appOptions,
+      );
+
+    if (!this.appOptions.preview) {
+      this.microservicesModule.setupClients(this.container);
+      this.registerListeners();
+    }
 
-    this.registerListeners();
     this.setIsInitialized(true);
 
-    if (!this.isInitHookCalled) {
+    if (!this.wasInitHookCalled) {
       await this.callInitHook();
       await this.callBootstrapHook();
     }
   }
 
   public registerListeners() {
-    this.microservicesModule.setupListeners(this.container, this.server);
+    this.microservicesModule.setupListeners(
+      this.container,
+      this.serverInstance,
+    );
   }
 
+  /**
+   * Registers a web socket adapter that will be used for Gateways.
+   * Use to override the default `socket.io` library.
+   *
+   * @param {WebSocketAdapter} adapter
+   * @returns {this}
+   */
   public useWebSocketAdapter(adapter: WebSocketAdapter): this {
     this.applicationConfig.setIoAdapter(adapter);
     return this;
   }
 
+  /**
+   * Registers global exception filters (will be used for every pattern handler).
+   *
+   * @param {...ExceptionFilter} filters
+   */
   public useGlobalFilters(...filters: ExceptionFilter[]): this {
     this.applicationConfig.useGlobalFilters(...filters);
+    filters.forEach(item =>
+      this.graphInspector.insertOrphanedEnhancer({
+        subtype: 'filter',
+        ref: item,
+      }),
+    );
     return this;
   }
 
+  /**
+   * Registers global pipes (will be used for every pattern handler).
+   *
+   * @param {...PipeTransform} pipes
+   */
   public useGlobalPipes(...pipes: PipeTransform<any>[]): this {
     this.applicationConfig.useGlobalPipes(...pipes);
+    pipes.forEach(item =>
+      this.graphInspector.insertOrphanedEnhancer({
+        subtype: 'pipe',
+        ref: item,
+      }),
+    );
     return this;
   }
 
+  /**
+   * Registers global interceptors (will be used for every pattern handler).
+   *
+   * @param {...NestInterceptor} interceptors
+   */
   public useGlobalInterceptors(...interceptors: NestInterceptor[]): this {
     this.applicationConfig.useGlobalInterceptors(...interceptors);
+    interceptors.forEach(item =>
+      this.graphInspector.insertOrphanedEnhancer({
+        subtype: 'interceptor',
+        ref: item,
+      }),
+    );
     return this;
   }
 
   public useGlobalGuards(...guards: CanActivate[]): this {
     this.applicationConfig.useGlobalGuards(...guards);
+    guards.forEach(item =>
+      this.graphInspector.insertOrphanedEnhancer({
+        subtype: 'guard',
+        ref: item,
+      }),
+    );
     return this;
   }
 
@@ -119,16 +209,22 @@ export class NestMicroservice
     return this;
   }
 
-  public async listen() {
+  /**
+   * Starts the microservice.
+   *
+   * @returns {void}
+   */
+  public async listen(): Promise<any> {
+    this.assertNotInPreviewMode('listen');
     !this.isInitialized && (await this.registerModules());
 
     return new Promise<any>((resolve, reject) => {
-      this.server.listen((err, info) => {
+      this.serverInstance.listen((err, info) => {
         if (this.microserviceConfig?.autoFlushLogs ?? true) {
           this.flushLogs();
         }
         if (err) {
-          return reject(err);
+          return reject(err as Error);
         }
         this.logger.log(MESSAGES.MICROSERVICE_READY);
         resolve(info);
@@ -136,15 +232,13 @@ export class NestMicroservice
     });
   }
 
-  public async listenAsync(): Promise<any> {
-    this.logger.warn(
-      'DEPRECATED! "listenAsync" method is deprecated and will be removed in the next major release. Please, use "listen" instead.',
-    );
-    return this.listen();
-  }
-
+  /**
+   * Terminates the application.
+   *
+   * @returns {Promise<void>}
+   */
   public async close(): Promise<any> {
-    await this.server.close();
+    await this.serverInstance.close();
     if (this.isTerminated) {
       return;
     }
@@ -152,16 +246,51 @@ export class NestMicroservice
     await this.closeApplication();
   }
 
+  /**
+   * Sets the flag indicating that the application is initialized.
+   * @param isInitialized Value to set
+   */
   public setIsInitialized(isInitialized: boolean) {
     this.isInitialized = isInitialized;
   }
 
+  /**
+   * Sets the flag indicating that the application is terminated.
+   * @param isTerminated Value to set
+   */
   public setIsTerminated(isTerminated: boolean) {
     this.isTerminated = isTerminated;
   }
 
+  /**
+   * Sets the flag indicating that the init hook was called.
+   * @param isInitHookCalled Value to set
+   */
   public setIsInitHookCalled(isInitHookCalled: boolean) {
-    this.isInitHookCalled = isInitHookCalled;
+    this.wasInitHookCalled = isInitHookCalled;
+  }
+
+  /**
+   * Registers an event listener for the given event.
+   * @param event Event name
+   * @param callback Callback to be executed when the event is emitted
+   */
+  public on(event: string | number | symbol, callback: Function) {
+    if ('on' in this.serverInstance) {
+      return this.serverInstance.on(event as string, callback);
+    }
+    throw new Error('"on" method not supported by the underlying server');
+  }
+
+  /**
+   * Returns an instance of the underlying server/broker instance,
+   * or a group of servers if there are more than one.
+   */
+  public unwrap<T>(): T {
+    if ('unwrap' in this.serverInstance) {
+      return this.serverInstance.unwrap();
+    }
+    throw new Error('"unwrap" method not supported by the underlying server');
   }
 
   protected async closeApplication(): Promise<any> {
@@ -173,11 +302,18 @@ export class NestMicroservice
   }
 
   protected async dispose(): Promise<void> {
-    await this.server.close();
     if (this.isTerminated) {
       return;
     }
+    await this.serverInstance.close();
     this.socketModule && (await this.socketModule.close());
     this.microservicesModule && (await this.microservicesModule.close());
   }
+
+  protected resolveAsyncOptions(config: AsyncMicroserviceOptions) {
+    const args = config.inject?.map(token =>
+      this.get(token, { strict: false }),
+    );
+    return config.useFactory(...args);
+  }
 }
diff --git a/packages/microservices/package.json b/packages/microservices/package.json
index 169149706..766a090db 100644
--- a/packages/microservices/package.json
+++ b/packages/microservices/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/microservices",
-  "version": "8.2.5",
+  "version": "10.4.11",
   "description": "Nest - modern, fast, powerful node.js web framework (@microservices)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -11,33 +11,33 @@
   },
   "repository": {
     "type": "git",
-    "url": "https://github.com/nestjs/nest"
+    "url": "https://github.com/nestjs/nest.git",
+    "directory": "packages/microservices"
   },
   "publishConfig": {
     "access": "public"
   },
   "dependencies": {
     "iterare": "1.2.1",
-    "json-socket": "0.3.0",
-    "tslib": "2.3.1"
+    "tslib": "2.7.0"
   },
   "devDependencies": {
-    "@nestjs/common": "8.2.5",
-    "@nestjs/core": "8.2.5"
+    "@nestjs/common": "10.4.11",
+    "@nestjs/core": "10.4.11"
   },
   "peerDependencies": {
     "@grpc/grpc-js": "*",
-    "@nestjs/common": "^8.0.0",
-    "@nestjs/core": "^8.0.0",
-    "@nestjs/websockets": "^8.0.0",
+    "@nestjs/common": "^10.0.0",
+    "@nestjs/core": "^10.0.0",
+    "@nestjs/websockets": "^10.0.0",
     "amqp-connection-manager": "*",
     "amqplib": "*",
     "cache-manager": "*",
+    "ioredis": "*",
     "kafkajs": "*",
     "mqtt": "*",
     "nats": "*",
-    "redis": "*",
-    "reflect-metadata": "^0.1.12",
+    "reflect-metadata": "^0.1.12 || ^0.2.0",
     "rxjs": "^7.1.0"
   },
   "peerDependenciesMeta": {
@@ -59,7 +59,7 @@
     "nats": {
       "optional": true
     },
-    "redis": {
+    "ioredis": {
       "optional": true
     },
     "amqplib": {
diff --git a/packages/microservices/record-builders/mqtt.record-builder.ts b/packages/microservices/record-builders/mqtt.record-builder.ts
index b21c4ccbe..5754d8a10 100644
--- a/packages/microservices/record-builders/mqtt.record-builder.ts
+++ b/packages/microservices/record-builders/mqtt.record-builder.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export interface MqttRecordOptions {
   /**
    * The QoS
@@ -15,9 +18,9 @@ export interface MqttRecordOptions {
    *  MQTT 5.0 properties object
    */
   properties?: {
-    payloadFormatIndicator?: number;
+    payloadFormatIndicator?: boolean;
     messageExpiryInterval?: number;
-    topicAlias?: string;
+    topicAlias?: number;
     responseTopic?: string;
     correlationData?: Buffer;
     userProperties?: Record<string, string | string[]>;
@@ -26,6 +29,9 @@ export interface MqttRecordOptions {
   };
 }
 
+/**
+ * @publicApi
+ */
 export class MqttRecord<TData = any> {
   constructor(
     public readonly data: TData,
@@ -33,6 +39,9 @@ export class MqttRecord<TData = any> {
   ) {}
 }
 
+/**
+ * @publicApi
+ */
 export class MqttRecordBuilder<TData> {
   private options?: MqttRecordOptions;
 
diff --git a/packages/microservices/record-builders/nats.record-builder.ts b/packages/microservices/record-builders/nats.record-builder.ts
index 249241f1f..6d6c14642 100644
--- a/packages/microservices/record-builders/nats.record-builder.ts
+++ b/packages/microservices/record-builders/nats.record-builder.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export class NatsRecord<TData = any, THeaders = any> {
   constructor(
     public readonly data: TData,
@@ -5,6 +8,9 @@ export class NatsRecord<TData = any, THeaders = any> {
   ) {}
 }
 
+/**
+ * @publicApi
+ */
 export class NatsRecordBuilder<TData> {
   private headers?: any;
 
diff --git a/packages/microservices/record-builders/rmq.record-builder.ts b/packages/microservices/record-builders/rmq.record-builder.ts
index 227bf1772..2cbbdbd55 100644
--- a/packages/microservices/record-builders/rmq.record-builder.ts
+++ b/packages/microservices/record-builders/rmq.record-builder.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export interface RmqRecordOptions {
   expiration?: string | number;
   userId?: string;
@@ -16,10 +19,19 @@ export interface RmqRecordOptions {
   appId?: string;
 }
 
+/**
+ * @publicApi
+ */
 export class RmqRecord<TData = any> {
-  constructor(public readonly data: TData, public options?: RmqRecordOptions) {}
+  constructor(
+    public readonly data: TData,
+    public options?: RmqRecordOptions,
+  ) {}
 }
 
+/**
+ * @publicApi
+ */
 export class RmqRecordBuilder<TData> {
   private options?: RmqRecordOptions;
 
diff --git a/packages/microservices/serializers/index.ts b/packages/microservices/serializers/index.ts
new file mode 100644
index 000000000..b58734cf1
--- /dev/null
+++ b/packages/microservices/serializers/index.ts
@@ -0,0 +1,5 @@
+export * from './identity.serializer';
+export * from './kafka-request.serializer';
+export * from './mqtt-record.serializer';
+export * from './nats-record.serializer';
+export * from './rmq-record.serializer';
diff --git a/packages/microservices/serializers/kafka-request.serializer.ts b/packages/microservices/serializers/kafka-request.serializer.ts
index cfe73b2ab..7c519c458 100644
--- a/packages/microservices/serializers/kafka-request.serializer.ts
+++ b/packages/microservices/serializers/kafka-request.serializer.ts
@@ -13,8 +13,13 @@ export interface KafkaRequest<T = any> {
   headers: Record<string, any>;
 }
 
-export class KafkaRequestSerializer implements Serializer<any, KafkaRequest> {
-  serialize(value: any): KafkaRequest {
+/**
+ * @publicApi
+ */
+export class KafkaRequestSerializer
+  implements Serializer<any, KafkaRequest | Promise<KafkaRequest>>
+{
+  serialize(value: any) {
     const isNotKafkaMessage =
       isNil(value) ||
       !isObject(value) ||
diff --git a/packages/microservices/serializers/mqtt-record.serializer.ts b/packages/microservices/serializers/mqtt-record.serializer.ts
index 24f5c747e..026ddca26 100644
--- a/packages/microservices/serializers/mqtt-record.serializer.ts
+++ b/packages/microservices/serializers/mqtt-record.serializer.ts
@@ -1,17 +1,23 @@
 import { isObject } from '@nestjs/common/utils/shared.utils';
-import { ReadPacket } from '../interfaces';
-import { Serializer } from '../interfaces/serializer.interface';
+import { ReadPacket, Serializer } from '../interfaces';
 import { MqttRecord } from '../record-builders';
 
-export class MqttRecordSerializer implements Serializer<ReadPacket, string> {
-  serialize(packet: ReadPacket | any): string {
-    if (isObject(packet?.data) && packet.data instanceof MqttRecord) {
-      const record = packet.data as MqttRecord;
-      return JSON.stringify({
+export class MqttRecordSerializer
+  implements Serializer<ReadPacket, ReadPacket & Partial<MqttRecord>>
+{
+  serialize(packet: ReadPacket): ReadPacket & Partial<MqttRecord> {
+    if (
+      packet?.data &&
+      isObject(packet.data) &&
+      packet.data instanceof MqttRecord
+    ) {
+      const record = packet.data;
+      return {
         ...packet,
         data: record.data,
-      });
+        options: record.options,
+      };
     }
-    return JSON.stringify(packet);
+    return packet;
   }
 }
diff --git a/packages/microservices/serializers/nats-record.serializer.ts b/packages/microservices/serializers/nats-record.serializer.ts
index 77f9a4bab..b00f3969a 100644
--- a/packages/microservices/serializers/nats-record.serializer.ts
+++ b/packages/microservices/serializers/nats-record.serializer.ts
@@ -1,6 +1,6 @@
 import { loadPackage } from '@nestjs/common/utils/load-package.util';
 import { isObject } from '@nestjs/common/utils/shared.utils';
-import { NatsCodec } from '../external/nats-client.interface';
+import { NatsCodec } from '../external/nats-codec.interface';
 import { ReadPacket } from '../interfaces';
 import { Serializer } from '../interfaces/serializer.interface';
 import { NatsRecord, NatsRecordBuilder } from '../record-builders';
@@ -19,10 +19,10 @@ export class NatsRecordSerializer
     this.jsonCodec = natsPackage.JSONCodec();
   }
 
-  serialize(packet: ReadPacket | any): NatsRecord {
+  serialize(packet: any): NatsRecord {
     const natsMessage =
       packet?.data && isObject(packet.data) && packet.data instanceof NatsRecord
-        ? (packet.data as NatsRecord)
+        ? packet.data
         : new NatsRecordBuilder(packet?.data).build();
 
     return {
diff --git a/packages/microservices/serializers/rmq-record.serializer.ts b/packages/microservices/serializers/rmq-record.serializer.ts
index 8039c2f1c..767cdc7a2 100644
--- a/packages/microservices/serializers/rmq-record.serializer.ts
+++ b/packages/microservices/serializers/rmq-record.serializer.ts
@@ -6,13 +6,13 @@ import { RmqRecord } from '../record-builders';
 export class RmqRecordSerializer
   implements Serializer<ReadPacket, ReadPacket & Partial<RmqRecord>>
 {
-  serialize(packet: ReadPacket | any): ReadPacket & Partial<RmqRecord> {
+  serialize(packet: ReadPacket): ReadPacket & Partial<RmqRecord> {
     if (
       packet?.data &&
       isObject(packet.data) &&
       packet.data instanceof RmqRecord
     ) {
-      const record = packet.data as RmqRecord;
+      const record = packet.data;
       return {
         ...packet,
         data: record.data,
diff --git a/packages/microservices/server/server-factory.ts b/packages/microservices/server/server-factory.ts
index 6429a36e6..5376fbd22 100644
--- a/packages/microservices/server/server-factory.ts
+++ b/packages/microservices/server/server-factory.ts
@@ -1,34 +1,44 @@
 import { Transport } from '../enums/transport.enum';
-import { CustomTransportStrategy, MicroserviceOptions } from '../interfaces';
-import { Server } from './server';
+import {
+  CustomStrategy,
+  GrpcOptions,
+  KafkaOptions,
+  MicroserviceOptions,
+  MqttOptions,
+  NatsOptions,
+  RedisOptions,
+  RmqOptions,
+  TcpOptions,
+} from '../interfaces';
 import { ServerGrpc } from './server-grpc';
 import { ServerKafka } from './server-kafka';
 import { ServerMqtt } from './server-mqtt';
 import { ServerNats } from './server-nats';
 import { ServerRedis } from './server-redis';
-import { ServerTCP } from './server-tcp';
 import { ServerRMQ } from './server-rmq';
+import { ServerTCP } from './server-tcp';
 
 export class ServerFactory {
-  public static create(
-    microserviceOptions: MicroserviceOptions,
-  ): Server & CustomTransportStrategy {
-    const { transport, options } = microserviceOptions as any;
+  public static create(microserviceOptions: MicroserviceOptions) {
+    const { transport, options } = microserviceOptions as Exclude<
+      MicroserviceOptions,
+      CustomStrategy
+    >;
     switch (transport) {
       case Transport.REDIS:
-        return new ServerRedis(options);
+        return new ServerRedis(options as Required<RedisOptions>['options']);
       case Transport.NATS:
-        return new ServerNats(options);
+        return new ServerNats(options as Required<NatsOptions>['options']);
       case Transport.MQTT:
-        return new ServerMqtt(options);
+        return new ServerMqtt(options as Required<MqttOptions>['options']);
       case Transport.GRPC:
         return new ServerGrpc(options);
       case Transport.KAFKA:
-        return new ServerKafka(options);
+        return new ServerKafka(options as Required<KafkaOptions>['options']);
       case Transport.RMQ:
-        return new ServerRMQ(options);
+        return new ServerRMQ(options as Required<RmqOptions>['options']);
       default:
-        return new ServerTCP(options);
+        return new ServerTCP(options as Required<TcpOptions>['options']);
     }
   }
 }
diff --git a/packages/microservices/server/server-grpc.ts b/packages/microservices/server/server-grpc.ts
index f88154cf1..6f6f273c7 100644
--- a/packages/microservices/server/server-grpc.ts
+++ b/packages/microservices/server/server-grpc.ts
@@ -3,24 +3,41 @@ import {
   isString,
   isUndefined,
 } from '@nestjs/common/utils/shared.utils';
-import { EMPTY, fromEvent, lastValueFrom, Subject } from 'rxjs';
-import { catchError, takeUntil } from 'rxjs/operators';
 import {
-  CANCEL_EVENT,
-  GRPC_DEFAULT_PROTO_LOADER,
-  GRPC_DEFAULT_URL,
-} from '../constants';
+  EMPTY,
+  Observable,
+  ReplaySubject,
+  Subject,
+  Subscription,
+  defaultIfEmpty,
+  fromEvent,
+  lastValueFrom,
+} from 'rxjs';
+import { catchError, takeUntil } from 'rxjs/operators';
+import { GRPC_DEFAULT_PROTO_LOADER, GRPC_DEFAULT_URL } from '../constants';
 import { GrpcMethodStreamingType } from '../decorators';
 import { Transport } from '../enums';
 import { InvalidGrpcPackageException } from '../errors/invalid-grpc-package.exception';
 import { InvalidProtoDefinitionException } from '../errors/invalid-proto-definition.exception';
-import { CustomTransportStrategy, MessageHandler } from '../interfaces';
+import { ChannelOptions } from '../external/grpc-options.interface';
+import { getGrpcPackageDefinition } from '../helpers';
+import { MessageHandler } from '../interfaces';
 import { GrpcOptions } from '../interfaces/microservice-configuration.interface';
 import { Server } from './server';
-import { ChannelOptions } from '../external/grpc-options.interface';
 
-let grpcPackage: any = {};
-let grpcProtoLoaderPackage: any = {};
+const CANCELLED_EVENT = 'cancelled';
+
+// To enable type safety for gRPC. This cant be uncommented by default
+// because it would require the user to install the @grpc/grpc-js package even if they dont use gRPC
+// Otherwise, TypeScript would fail to compile the code.
+//
+// type GrpcServer = import('@grpc/grpc-js').Server;
+// let grpcPackage = {} as typeof import('@grpc/grpc-js');
+// let grpcProtoLoaderPackage = {} as typeof import('@grpc/proto-loader');
+
+type GrpcServer = any;
+let grpcPackage = {} as any;
+let grpcProtoLoaderPackage = {} as any;
 
 interface GrpcCall<TRequest = any, TMetadata = any> {
   request: TRequest;
@@ -29,16 +46,25 @@ interface GrpcCall<TRequest = any, TMetadata = any> {
   end: Function;
   write: Function;
   on: Function;
+  off: Function;
   emit: Function;
 }
 
-export class ServerGrpc extends Server implements CustomTransportStrategy {
+/**
+ * @publicApi
+ */
+export class ServerGrpc extends Server<never, never> {
   public readonly transportId = Transport.GRPC;
+  protected readonly url: string;
+  protected grpcClient: GrpcServer;
 
-  private readonly url: string;
-  private grpcClient: any;
+  get status(): never {
+    throw new Error(
+      'The "status" attribute is not supported by the gRPC transport',
+    );
+  }
 
-  constructor(private readonly options: GrpcOptions['options']) {
+  constructor(private readonly options: Readonly<GrpcOptions>['options']) {
     super();
     this.url = this.getOptionsProp(options, 'url') || GRPC_DEFAULT_URL;
 
@@ -71,8 +97,7 @@ export class ServerGrpc extends Server implements CustomTransportStrategy {
 
   public async start(callback?: () => void) {
     await this.bindEvents();
-    this.grpcClient.start();
-    callback();
+    callback?.();
   }
 
   public async bindEvents() {
@@ -84,7 +109,7 @@ export class ServerGrpc extends Server implements CustomTransportStrategy {
 
     for (const packageName of packageNames) {
       const grpcPkg = this.lookupPackage(grpcContext, packageName);
-      await this.createServices(grpcPkg);
+      await this.createServices(grpcPkg, packageName);
     }
   }
 
@@ -112,8 +137,7 @@ export class ServerGrpc extends Server implements CustomTransportStrategy {
     const service = {};
 
     for (const methodName in grpcService.prototype) {
-      let pattern = '';
-      let methodHandler = null;
+      let methodHandler: MessageHandler | null = null;
       let streamingType = GrpcMethodStreamingType.NO_STREAMING;
 
       const methodFunction = grpcService.prototype[methodName];
@@ -122,38 +146,38 @@ export class ServerGrpc extends Server implements CustomTransportStrategy {
       if (!isUndefined(methodReqStreaming) && methodReqStreaming) {
         // Try first pattern to be presented, RX streaming pattern would be
         // a preferable pattern to select among a few defined
-        pattern = this.createPattern(
+        methodHandler = this.getMessageHandler(
           name,
           methodName,
           GrpcMethodStreamingType.RX_STREAMING,
+          methodFunction,
         );
-        methodHandler = this.messageHandlers.get(pattern);
         streamingType = GrpcMethodStreamingType.RX_STREAMING;
         // If first pattern didn't match to any of handlers then try
         // pass-through handler to be presented
         if (!methodHandler) {
-          pattern = this.createPattern(
+          methodHandler = this.getMessageHandler(
             name,
             methodName,
             GrpcMethodStreamingType.PT_STREAMING,
+            methodFunction,
           );
-          methodHandler = this.messageHandlers.get(pattern);
           streamingType = GrpcMethodStreamingType.PT_STREAMING;
         }
       } else {
-        pattern = this.createPattern(
+        // Select handler if any presented for No-Streaming pattern
+        methodHandler = this.getMessageHandler(
           name,
           methodName,
           GrpcMethodStreamingType.NO_STREAMING,
+          methodFunction,
         );
-        // Select handler if any presented for No-Streaming pattern
-        methodHandler = this.messageHandlers.get(pattern);
         streamingType = GrpcMethodStreamingType.NO_STREAMING;
       }
       if (!methodHandler) {
         continue;
       }
-      service[methodName] = await this.createServiceMethod(
+      service[methodName] = this.createServiceMethod(
         methodHandler,
         grpcService.prototype[methodName],
         streamingType,
@@ -162,6 +186,22 @@ export class ServerGrpc extends Server implements CustomTransportStrategy {
     return service;
   }
 
+  public getMessageHandler(
+    serviceName: string,
+    methodName: string,
+    streaming: GrpcMethodStreamingType,
+    grpcMethod: { path?: string },
+  ): MessageHandler {
+    let pattern = this.createPattern(serviceName, methodName, streaming);
+    let methodHandler = this.messageHandlers.get(pattern)!;
+    if (!methodHandler) {
+      const packageServiceName = grpcMethod.path?.split?.('/')[1];
+      pattern = this.createPattern(packageServiceName!, methodName, streaming);
+      methodHandler = this.messageHandlers.get(pattern)!;
+    }
+    return methodHandler;
+  }
+
   /**
    * Will create a string of a JSON serialized format
    *
@@ -188,6 +228,7 @@ export class ServerGrpc extends Server implements CustomTransportStrategy {
    *
    * @param methodHandler
    * @param protoNativeHandler
+   * @param streamType
    */
   public createServiceMethod(
     methodHandler: Function,
@@ -221,7 +262,7 @@ export class ServerGrpc extends Server implements CustomTransportStrategy {
     return async (call: GrpcCall, callback: Function) => {
       const handler = methodHandler(call.request, call.metadata, call);
       this.transformToObservable(await handler).subscribe({
-        next: data => callback(null, data),
+        next: async data => callback(null, await data),
         error: (err: any) => callback(err),
       });
     };
@@ -231,19 +272,129 @@ export class ServerGrpc extends Server implements CustomTransportStrategy {
     return async (call: GrpcCall, callback: Function) => {
       const handler = methodHandler(call.request, call.metadata, call);
       const result$ = this.transformToObservable(await handler);
-      await result$
-        .pipe(
-          takeUntil(fromEvent(call as any, CANCEL_EVENT)),
-          catchError(err => {
-            call.emit('error', err);
-            return EMPTY;
-          }),
-        )
-        .forEach(data => call.write(data));
-      call.end();
+      await this.writeObservableToGrpc(result$, call);
     };
   }
 
+  public unwrap<T>(): T {
+    throw new Error('Method is not supported for gRPC transport');
+  }
+
+  public on<
+    EventKey extends string | number | symbol = string | number | symbol,
+    EventCallback = any,
+  >(event: EventKey, callback: EventCallback) {
+    throw new Error('Method is not supported in gRPC mode.');
+  }
+
+  /**
+   * Writes an observable to a GRPC call.
+   *
+   * This function will ensure that backpressure is managed while writing values
+   * that come from an observable to a GRPC call.
+   *
+   * @param source The observable we want to write out to the GRPC call.
+   * @param call The GRPC call we want to write to.
+   * @returns A promise that resolves when we're done writing to the call.
+   */
+  private writeObservableToGrpc<T>(
+    source: Observable<T>,
+    call: GrpcCall<T>,
+  ): Promise<void> {
+    // This promise should **not** reject, as we're handling errors in the observable for the Call
+    // the promise is only needed to signal when writing/draining has been completed
+    return new Promise((resolve, _doNotUse) => {
+      const valuesWaitingToBeDrained: T[] = [];
+      let shouldErrorAfterDraining = false;
+      let error: any;
+      let shouldResolveAfterDraining = false;
+      let writing = true;
+
+      // Used to manage finalization
+      const subscription = new Subscription();
+
+      // If the call is cancelled, unsubscribe from the source
+      const cancelHandler = () => {
+        subscription.unsubscribe();
+        // Calls that are cancelled by the client should be successfully resolved here
+        resolve();
+      };
+      call.on(CANCELLED_EVENT, cancelHandler);
+      subscription.add(() => call.off(CANCELLED_EVENT, cancelHandler));
+
+      // In all cases, when we finalize, end the writable stream
+      // being careful that errors and writes must be emitted _before_ this call is ended
+      subscription.add(() => call.end());
+
+      const drain = () => {
+        writing = true;
+        while (valuesWaitingToBeDrained.length > 0) {
+          const value = valuesWaitingToBeDrained.shift();
+          if (writing) {
+            // The first time `call.write` returns false, we need to stop.
+            // It wrote the value, but it won't write anything else.
+            writing = call.write(value);
+            if (!writing) {
+              // We can't write anymore so we need to wait for the drain event
+              return;
+            }
+          }
+        }
+
+        if (shouldResolveAfterDraining) {
+          subscription.unsubscribe();
+          resolve();
+        } else if (shouldErrorAfterDraining) {
+          call.emit('error', error);
+          subscription.unsubscribe();
+          resolve();
+        }
+      };
+
+      call.on('drain', drain);
+      subscription.add(() => call.off('drain', drain));
+
+      subscription.add(
+        source.subscribe({
+          next(value) {
+            if (writing) {
+              writing = call.write(value);
+            } else {
+              // If we can't write, that's because we need to
+              // wait for the drain event before we can write again
+              // buffer the value and wait for the drain event
+              valuesWaitingToBeDrained.push(value);
+            }
+          },
+          error(err) {
+            if (valuesWaitingToBeDrained.length === 0) {
+              // We're not waiting for a drain event, so we can just
+              // reject and teardown.
+              call.emit('error', err);
+              subscription.unsubscribe();
+              resolve();
+            } else {
+              // We're waiting for a drain event, record the
+              // error so it can be handled after everything is drained.
+              shouldErrorAfterDraining = true;
+              error = err;
+            }
+          },
+          complete() {
+            if (valuesWaitingToBeDrained.length === 0) {
+              // We're not waiting for a drain event, so we can just
+              // resolve and teardown.
+              subscription.unsubscribe();
+              resolve();
+            } else {
+              shouldResolveAfterDraining = true;
+            }
+          },
+        }),
+      );
+    });
+  }
+
   public createRequestStreamMethod(
     methodHandler: Function,
     isResponseStream: boolean,
@@ -252,8 +403,11 @@ export class ServerGrpc extends Server implements CustomTransportStrategy {
       call: GrpcCall,
       callback: (err: unknown, value: unknown) => void,
     ) => {
-      const req = new Subject<any>();
-      call.on('data', (m: any) => req.next(m));
+      // Needs to be a Proxy in order to buffer messages that come before handler is executed
+      // This could happen if handler has any async guards or interceptors registered that would delay
+      // the execution.
+      const { subject, next, error, complete } = this.bufferUntilDrained();
+      call.on('data', (m: any) => next(m));
       call.on('error', (e: any) => {
         // Check if error means that stream ended on other end
         const isCancelledError = String(e).toLowerCase().indexOf('cancelled');
@@ -263,32 +417,27 @@ export class ServerGrpc extends Server implements CustomTransportStrategy {
           return;
         }
         // If another error then just pass it along
-        req.error(e);
+        error(e);
       });
-      call.on('end', () => req.complete());
+      call.on('end', () => complete());
 
-      const handler = methodHandler(req.asObservable(), call.metadata, call);
+      const handler = methodHandler(
+        subject.asObservable(),
+        call.metadata,
+        call,
+      );
       const res = this.transformToObservable(await handler);
       if (isResponseStream) {
-        await res
-          .pipe(
-            takeUntil(fromEvent(call as any, CANCEL_EVENT)),
-            catchError(err => {
-              call.emit('error', err);
-              return EMPTY;
-            }),
-          )
-          .forEach(m => call.write(m));
-
-        call.end();
+        await this.writeObservableToGrpc(res, call);
       } else {
         const response = await lastValueFrom(
           res.pipe(
-            takeUntil(fromEvent(call as any, CANCEL_EVENT)),
+            takeUntil(fromEvent(call as any, CANCELLED_EVENT)),
             catchError(err => {
               callback(err, null);
               return EMPTY;
             }),
+            defaultIfEmpty(undefined),
           ),
         );
 
@@ -307,16 +456,32 @@ export class ServerGrpc extends Server implements CustomTransportStrategy {
       call: GrpcCall,
       callback: (err: unknown, value: unknown) => void,
     ) => {
+      let handlerStream: Observable<any>;
       if (isResponseStream) {
-        methodHandler(call);
+        handlerStream = this.transformToObservable(await methodHandler(call));
       } else {
-        methodHandler(call, callback);
+        handlerStream = this.transformToObservable(
+          await methodHandler(call, callback),
+        );
       }
+      await lastValueFrom(handlerStream);
     };
   }
 
-  public close() {
-    this.grpcClient && this.grpcClient.forceShutdown();
+  public async close(): Promise<void> {
+    if (this.grpcClient) {
+      const graceful = this.getOptionsProp(this.options, 'gracefulShutdown');
+      if (graceful) {
+        await new Promise<void>((resolve, reject) => {
+          this.grpcClient.tryShutdown((error: Error) => {
+            if (error) reject(error);
+            else resolve();
+          });
+        });
+      } else {
+        this.grpcClient.forceShutdown();
+      }
+    }
     this.grpcClient = null;
   }
 
@@ -338,7 +503,7 @@ export class ServerGrpc extends Server implements CustomTransportStrategy {
     this.messageHandlers.set(route, callback);
   }
 
-  public async createClient(): Promise<any> {
+  public async createClient() {
     const channelOptions: ChannelOptions =
       this.options && this.options.channelOptions
         ? this.options.channelOptions
@@ -380,20 +545,26 @@ export class ServerGrpc extends Server implements CustomTransportStrategy {
 
   public loadProto(): any {
     try {
-      const file = this.getOptionsProp(this.options, 'protoPath');
-      const loader = this.getOptionsProp(this.options, 'loader');
+      const packageDefinition = getGrpcPackageDefinition(
+        this.options,
+        grpcProtoLoaderPackage,
+      );
+
+      if (this.options.onLoadPackageDefinition) {
+        this.options.onLoadPackageDefinition(
+          packageDefinition,
+          this.grpcClient,
+        );
+      }
 
-      const packageDefinition = grpcProtoLoaderPackage.loadSync(file, loader);
-      const packageObject =
-        grpcPackage.loadPackageDefinition(packageDefinition);
-      return packageObject;
+      return grpcPackage.loadPackageDefinition(packageDefinition);
     } catch (err) {
-      const invalidProtoError = new InvalidProtoDefinitionException();
+      const invalidProtoError = new InvalidProtoDefinitionException(err.path);
       const message =
         err && err.message ? err.message : invalidProtoError.message;
 
       this.logger.error(message, invalidProtoError.stack);
-      throw err;
+      throw invalidProtoError;
     }
   }
 
@@ -430,14 +601,19 @@ export class ServerGrpc extends Server implements CustomTransportStrategy {
         ? deepDefinition.service !== false
         : false;
 
+      // grpc namespace object does not have 'format' or 'service' properties defined
+      const isFormatDefined =
+        deepDefinition && !isUndefined(deepDefinition.format);
+
       if (isServiceDefined && isServiceBoolean) {
         accumulator.push({
           name: nameExtended,
           service: deepDefinition,
         });
-      }
-      // Continue recursion until objects end or service definition found
-      else {
+      } else if (isFormatDefined) {
+        // Do nothing
+      } else {
+        // Continue recursion for namespace object until objects end or service definition found
         this.collectDeepServices(nameExtended, deepDefinition, accumulator);
       }
     }
@@ -452,10 +628,10 @@ export class ServerGrpc extends Server implements CustomTransportStrategy {
     return name + '.' + key;
   }
 
-  private async createServices(grpcPkg: any) {
+  private async createServices(grpcPkg: any, packageName: string) {
     if (!grpcPkg) {
-      const invalidPackageError = new InvalidGrpcPackageException();
-      this.logger.error(invalidPackageError.message, invalidPackageError.stack);
+      const invalidPackageError = new InvalidGrpcPackageException(packageName);
+      this.logger.error(invalidPackageError);
       throw invalidPackageError;
     }
 
@@ -470,4 +646,70 @@ export class ServerGrpc extends Server implements CustomTransportStrategy {
       );
     }
   }
+
+  private bufferUntilDrained<T>() {
+    type DrainableSubject<T> = Subject<T> & { drainBuffer: () => void };
+
+    const subject = new Subject<T>();
+    const replayBuffer = new ReplaySubject<T>();
+    let hasDrained = false;
+
+    function drainBuffer(this: DrainableSubject<T>) {
+      if (hasDrained) {
+        return;
+      }
+      hasDrained = true;
+
+      // Replay buffered values to the new subscriber
+      setImmediate(() => {
+        replayBuffer.subscribe(subject);
+        replayBuffer.complete();
+      });
+    }
+
+    return {
+      subject: new Proxy<DrainableSubject<T>>(subject as DrainableSubject<T>, {
+        get(target, prop, receiver) {
+          if (prop === 'asObservable') {
+            return () => {
+              const stream = subject.asObservable();
+
+              // "drainBuffer" will be called before the evaluation of the handler
+              // but after any enhancers have been applied (e.g., `interceptors`)
+              Object.defineProperty(stream, drainBuffer.name, {
+                value: drainBuffer,
+              });
+              return stream;
+            };
+          }
+          if (hasDrained) {
+            return Reflect.get(target, prop, receiver);
+          }
+          return Reflect.get(replayBuffer, prop, receiver);
+        },
+      }),
+      next: (value: T) => {
+        if (!hasDrained) {
+          replayBuffer.next(value);
+        }
+        subject.next(value);
+      },
+      error: (err: any) => {
+        if (!hasDrained) {
+          replayBuffer.error(err);
+        }
+        subject.error(err);
+      },
+      complete: () => {
+        if (!hasDrained) {
+          replayBuffer.complete();
+          // Replay buffer is no longer needed
+          // Return early to allow subject to complete later, after the replay buffer
+          // has been drained
+          return;
+        }
+        subject.complete();
+      },
+    };
+  }
 }
diff --git a/packages/microservices/server/server-kafka.ts b/packages/microservices/server/server-kafka.ts
index 8f21abff6..4b7b50b7f 100644
--- a/packages/microservices/server/server-kafka.ts
+++ b/packages/microservices/server/server-kafka.ts
@@ -1,14 +1,18 @@
 import { Logger } from '@nestjs/common/services/logger.service';
 import { isNil } from '@nestjs/common/utils/shared.utils';
-import { Observable } from 'rxjs';
+import { isObservable, lastValueFrom, Observable, ReplaySubject } from 'rxjs';
 import {
   KAFKA_DEFAULT_BROKER,
   KAFKA_DEFAULT_CLIENT,
   KAFKA_DEFAULT_GROUP,
+  NO_EVENT_HANDLER,
   NO_MESSAGE_HANDLER,
 } from '../constants';
 import { KafkaContext } from '../ctx-host';
+import { KafkaRequestDeserializer } from '../deserializers/kafka-request.deserializer';
 import { KafkaHeaders, Transport } from '../enums';
+import { KafkaStatus } from '../events';
+import { KafkaRetriableException } from '../exceptions';
 import {
   BrokersFunction,
   Consumer,
@@ -22,42 +26,45 @@ import {
   RecordMetadata,
 } from '../external/kafka.interface';
 import { KafkaLogger, KafkaParser } from '../helpers';
-import {
-  CustomTransportStrategy,
-  KafkaOptions,
-  OutgoingResponse,
-} from '../interfaces';
+import { KafkaOptions, OutgoingResponse, ReadPacket } from '../interfaces';
 import { KafkaRequestSerializer } from '../serializers/kafka-request.serializer';
 import { Server } from './server';
 
 let kafkaPackage: any = {};
 
-export class ServerKafka extends Server implements CustomTransportStrategy {
+/**
+ * @publicApi
+ */
+export class ServerKafka extends Server<never, KafkaStatus> {
   public readonly transportId = Transport.KAFKA;
 
   protected logger = new Logger(ServerKafka.name);
-  protected client: Kafka = null;
-  protected consumer: Consumer = null;
-  protected producer: Producer = null;
-  protected parser: KafkaParser = null;
-
+  protected client: Kafka | null = null;
+  protected consumer: Consumer | null = null;
+  protected producer: Producer | null = null;
+  protected parser: KafkaParser | null = null;
   protected brokers: string[] | BrokersFunction;
   protected clientId: string;
   protected groupId: string;
 
-  constructor(protected readonly options: KafkaOptions['options']) {
+  constructor(protected readonly options: Required<KafkaOptions>['options']) {
     super();
 
-    const clientOptions =
-      this.getOptionsProp(this.options, 'client') || ({} as KafkaConfig);
-    const consumerOptions =
-      this.getOptionsProp(this.options, 'consumer') || ({} as ConsumerConfig);
-    const postfixId =
-      this.getOptionsProp(this.options, 'postfixId') || '-server';
+    const clientOptions = this.getOptionsProp(
+      this.options,
+      'client',
+      {} as KafkaConfig,
+    );
+    const consumerOptions = this.getOptionsProp(
+      this.options,
+      'consumer',
+      {} as ConsumerConfig,
+    );
+    const postfixId = this.getOptionsProp(this.options, 'postfixId', '-server');
 
     this.brokers = clientOptions.brokers || [KAFKA_DEFAULT_BROKER];
 
-    // append a unique id to the clientId and groupId
+    // Append a unique id to the clientId and groupId
     // so they don't collide with a microservices client
     this.clientId =
       (clientOptions.clientId || KAFKA_DEFAULT_CLIENT) + postfixId;
@@ -96,8 +103,10 @@ export class ServerKafka extends Server implements CustomTransportStrategy {
     const consumerOptions = Object.assign(this.options.consumer || {}, {
       groupId: this.groupId,
     });
-    this.consumer = this.client.consumer(consumerOptions);
-    this.producer = this.client.producer(this.options.producer);
+    this.consumer = this.client!.consumer(consumerOptions);
+    this.producer = this.client!.producer(this.options.producer);
+    this.registerConsumerEventListeners();
+    this.registerProducerEventListeners();
 
     await this.consumer.connect();
     await this.producer.connect();
@@ -105,6 +114,39 @@ export class ServerKafka extends Server implements CustomTransportStrategy {
     callback();
   }
 
+  protected registerConsumerEventListeners() {
+    if (!this.consumer) {
+      return;
+    }
+    this.consumer.on(this.consumer.events.CONNECT, () =>
+      this._status$.next(KafkaStatus.CONNECTED),
+    );
+    this.consumer.on(this.consumer.events.DISCONNECT, () =>
+      this._status$.next(KafkaStatus.DISCONNECTED),
+    );
+    this.consumer.on(this.consumer.events.REBALANCING, () =>
+      this._status$.next(KafkaStatus.REBALANCING),
+    );
+    this.consumer.on(this.consumer.events.STOP, () =>
+      this._status$.next(KafkaStatus.STOPPED),
+    );
+    this.consumer.on(this.consumer.events.CRASH, () =>
+      this._status$.next(KafkaStatus.CRASHED),
+    );
+  }
+
+  protected registerProducerEventListeners() {
+    if (!this.producer) {
+      return;
+    }
+    this.producer.on(this.producer.events.CONNECT, () =>
+      this._status$.next(KafkaStatus.CONNECTED),
+    );
+    this.producer.on(this.producer.events.DISCONNECT, () =>
+      this._status$.next(KafkaStatus.DISCONNECTED),
+    );
+  }
+
   public createClient<T = any>(): T {
     return new kafkaPackage.Kafka(
       Object.assign(
@@ -118,12 +160,13 @@ export class ServerKafka extends Server implements CustomTransportStrategy {
   public async bindEvents(consumer: Consumer) {
     const registeredPatterns = [...this.messageHandlers.keys()];
     const consumerSubscribeOptions = this.options.subscribe || {};
-    const subscribeToPattern = async (pattern: string) =>
-      consumer.subscribe({
-        topic: pattern,
+
+    if (registeredPatterns.length > 0) {
+      await this.consumer!.subscribe({
         ...consumerSubscribeOptions,
+        topics: registeredPatterns,
       });
-    await Promise.all(registeredPatterns.map(subscribeToPattern));
+    }
 
     const consumerRunOptions = Object.assign(this.options.run || {}, {
       eachMessage: this.getMessageHandler(),
@@ -146,7 +189,7 @@ export class ServerKafka extends Server implements CustomTransportStrategy {
 
   public async handleMessage(payload: EachMessagePayload) {
     const channel = payload.topic;
-    const rawMessage = this.parser.parse<KafkaMessage>(
+    const rawMessage = this.parser!.parse<KafkaMessage>(
       Object.assign(payload.message, {
         topic: payload.topic,
         partition: payload.partition,
@@ -162,10 +205,14 @@ export class ServerKafka extends Server implements CustomTransportStrategy {
       rawMessage,
       payload.partition,
       payload.topic,
+      this.consumer!,
+      payload.heartbeat,
+      this.producer!,
     ]);
+    const handler = this.getHandlerByPattern(packet.pattern);
     // if the correlation id or reply topic is not set
     // then this is an event (events could still have correlation id)
-    if (!correlationId || !replyTopic) {
+    if (handler?.isEventHandler || !correlationId || !replyTopic) {
       return this.handleEvent(packet.pattern, packet, kafkaContext);
     }
 
@@ -174,7 +221,7 @@ export class ServerKafka extends Server implements CustomTransportStrategy {
       replyPartition,
       correlationId,
     );
-    const handler = this.getHandlerByPattern(packet.pattern);
+
     if (!handler) {
       return publish({
         id: correlationId,
@@ -183,18 +230,66 @@ export class ServerKafka extends Server implements CustomTransportStrategy {
     }
 
     const response$ = this.transformToObservable(
-      await handler(packet.data, kafkaContext),
+      handler(packet.data, kafkaContext),
     );
-    response$ && this.send(response$, publish);
+
+    const replayStream$ = new ReplaySubject();
+    await this.combineStreamsAndThrowIfRetriable(response$, replayStream$);
+
+    this.send(replayStream$, publish);
+  }
+
+  public unwrap<T>(): T {
+    if (!this.client) {
+      throw new Error(
+        'Not initialized. Please call the "listen"/"startAllMicroservices" method before accessing the server.',
+      );
+    }
+    return this.client as T;
   }
 
-  public sendMessage(
+  public on<
+    EventKey extends string | number | symbol = string | number | symbol,
+    EventCallback = any,
+  >(event: EventKey, callback: EventCallback) {
+    throw new Error('Method is not supported for Kafka server');
+  }
+
+  private combineStreamsAndThrowIfRetriable(
+    response$: Observable<any>,
+    replayStream$: ReplaySubject<unknown>,
+  ) {
+    return new Promise<void>((resolve, reject) => {
+      let isPromiseResolved = false;
+      response$.subscribe({
+        next: val => {
+          replayStream$.next(val);
+          if (!isPromiseResolved) {
+            isPromiseResolved = true;
+            resolve();
+          }
+        },
+        error: err => {
+          if (err instanceof KafkaRetriableException && !isPromiseResolved) {
+            isPromiseResolved = true;
+            reject(err);
+          } else {
+            resolve();
+          }
+          replayStream$.error(err);
+        },
+        complete: () => replayStream$.complete(),
+      });
+    });
+  }
+
+  public async sendMessage(
     message: OutgoingResponse,
     replyTopic: string,
-    replyPartition: string,
+    replyPartition: string | undefined | null,
     correlationId: string,
   ): Promise<RecordMetadata[]> {
-    const outgoingMessage = this.serializer.serialize(message.response);
+    const outgoingMessage = await this.serializer.serialize(message.response);
     this.assignReplyPartition(replyPartition, outgoingMessage);
     this.assignCorrelationIdHeader(correlationId, outgoingMessage);
     this.assignErrorHeader(message, outgoingMessage);
@@ -207,7 +302,7 @@ export class ServerKafka extends Server implements CustomTransportStrategy {
       },
       this.options.send || {},
     );
-    return this.producer.send(replyMessage);
+    return this.producer!.send(replyMessage);
   }
 
   public assignIsDisposedHeader(
@@ -217,7 +312,7 @@ export class ServerKafka extends Server implements CustomTransportStrategy {
     if (!outgoingResponse.isDisposed) {
       return;
     }
-    outgoingMessage.headers[KafkaHeaders.NEST_IS_DISPOSED] = Buffer.alloc(1);
+    outgoingMessage.headers![KafkaHeaders.NEST_IS_DISPOSED] = Buffer.alloc(1);
   }
 
   public assignErrorHeader(
@@ -227,21 +322,24 @@ export class ServerKafka extends Server implements CustomTransportStrategy {
     if (!outgoingResponse.err) {
       return;
     }
-    outgoingMessage.headers[KafkaHeaders.NEST_ERR] = Buffer.from(
-      outgoingResponse.err,
-    );
+    const stringifiedError =
+      typeof outgoingResponse.err === 'object'
+        ? JSON.stringify(outgoingResponse.err)
+        : outgoingResponse.err;
+    outgoingMessage.headers![KafkaHeaders.NEST_ERR] =
+      Buffer.from(stringifiedError);
   }
 
   public assignCorrelationIdHeader(
     correlationId: string,
     outgoingMessage: Message,
   ) {
-    outgoingMessage.headers[KafkaHeaders.CORRELATION_ID] =
+    outgoingMessage.headers![KafkaHeaders.CORRELATION_ID] =
       Buffer.from(correlationId);
   }
 
   public assignReplyPartition(
-    replyPartition: string,
+    replyPartition: string | null | undefined,
     outgoingMessage: Message,
   ) {
     if (isNil(replyPartition)) {
@@ -250,8 +348,27 @@ export class ServerKafka extends Server implements CustomTransportStrategy {
     outgoingMessage.partition = parseFloat(replyPartition);
   }
 
+  public async handleEvent(
+    pattern: string,
+    packet: ReadPacket,
+    context: KafkaContext,
+  ): Promise<any> {
+    const handler = this.getHandlerByPattern(pattern);
+    if (!handler) {
+      return this.logger.error(NO_EVENT_HANDLER`${pattern}`);
+    }
+    const resultOrStream = await handler(packet.data, context);
+    if (isObservable(resultOrStream)) {
+      await lastValueFrom(resultOrStream);
+    }
+  }
+
   protected initializeSerializer(options: KafkaOptions['options']) {
     this.serializer =
       (options && options.serializer) || new KafkaRequestSerializer();
   }
+
+  protected initializeDeserializer(options: KafkaOptions['options']) {
+    this.deserializer = options?.deserializer ?? new KafkaRequestDeserializer();
+  }
 }
diff --git a/packages/microservices/server/server-mqtt.ts b/packages/microservices/server/server-mqtt.ts
index 0f8f88e7c..b1befe051 100644
--- a/packages/microservices/server/server-mqtt.ts
+++ b/packages/microservices/server/server-mqtt.ts
@@ -1,9 +1,5 @@
-import { isUndefined, isObject } from '@nestjs/common/utils/shared.utils';
-import { Observable } from 'rxjs';
+import { isUndefined } from '@nestjs/common/utils/shared.utils';
 import {
-  CONNECT_EVENT,
-  ERROR_EVENT,
-  MESSAGE_EVENT,
   MQTT_DEFAULT_URL,
   MQTT_SEPARATOR,
   MQTT_WILDCARD_ALL,
@@ -12,9 +8,8 @@ import {
 } from '../constants';
 import { MqttContext } from '../ctx-host/mqtt.context';
 import { Transport } from '../enums';
-import { MqttClient } from '../external/mqtt-client.interface';
+import { MqttEvents, MqttEventsMap, MqttStatus } from '../events/mqtt.events';
 import {
-  CustomTransportStrategy,
   IncomingRequest,
   MessageHandler,
   PacketId,
@@ -27,15 +22,28 @@ import { Server } from './server';
 
 let mqttPackage: any = {};
 
-export class ServerMqtt extends Server implements CustomTransportStrategy {
-  public readonly transportId = Transport.MQTT;
+// To enable type safety for MQTT. This cant be uncommented by default
+// because it would require the user to install the mqtt package even if they dont use MQTT
+// Otherwise, TypeScript would fail to compile the code.
+//
+// type MqttClient = import('mqtt').MqttClient;
+type MqttClient = any;
 
-  private readonly url: string;
-  private mqttClient: MqttClient;
+/**
+ * @publicApi
+ */
+export class ServerMqtt extends Server<MqttEvents, MqttStatus> {
+  public readonly transportId = Transport.MQTT;
+  protected readonly url: string;
+  protected mqttClient: MqttClient;
+  protected pendingEventListeners: Array<{
+    event: keyof MqttEvents;
+    callback: MqttEvents[keyof MqttEvents];
+  }> = [];
 
-  constructor(private readonly options: MqttOptions['options']) {
+  constructor(private readonly options: Required<MqttOptions>['options']) {
     super();
-    this.url = this.getOptionsProp(options, 'url') || MQTT_DEFAULT_URL;
+    this.url = this.getOptionsProp(options, 'url', MQTT_DEFAULT_URL);
 
     mqttPackage = this.loadPackage('mqtt', ServerMqtt.name, () =>
       require('mqtt'),
@@ -59,17 +67,27 @@ export class ServerMqtt extends Server implements CustomTransportStrategy {
   public start(
     callback: (err?: unknown, ...optionalParams: unknown[]) => void,
   ) {
-    this.handleError(this.mqttClient);
+    this.registerErrorListener(this.mqttClient);
+    this.registerReconnectListener(this.mqttClient);
+    this.registerDisconnectListener(this.mqttClient);
+    this.registerCloseListener(this.mqttClient);
+    this.registerConnectListener(this.mqttClient);
+
+    this.pendingEventListeners.forEach(({ event, callback }) =>
+      this.mqttClient.on(event, callback),
+    );
+    this.pendingEventListeners = [];
     this.bindEvents(this.mqttClient);
 
-    this.mqttClient.on(CONNECT_EVENT, () => callback());
+    this.mqttClient.on(MqttEventsMap.CONNECT, () => callback());
   }
 
   public bindEvents(mqttClient: MqttClient) {
-    mqttClient.on(MESSAGE_EVENT, this.getMessageHandler(mqttClient).bind(this));
+    mqttClient.on('message', this.getMessageHandler(mqttClient).bind(this));
+
     const registeredPatterns = [...this.messageHandlers.keys()];
     registeredPatterns.forEach(pattern => {
-      const { isEventHandler } = this.messageHandlers.get(pattern);
+      const { isEventHandler } = this.messageHandlers.get(pattern)!;
       mqttClient.subscribe(
         isEventHandler ? pattern : this.getRequestPattern(pattern),
         this.getOptionsProp(this.options, 'subscribeOptions'),
@@ -79,13 +97,14 @@ export class ServerMqtt extends Server implements CustomTransportStrategy {
 
   public close() {
     this.mqttClient && this.mqttClient.end();
+    this.pendingEventListeners = [];
   }
 
   public createMqttClient(): MqttClient {
     return mqttPackage.connect(this.url, this.options as MqttOptions);
   }
 
-  public getMessageHandler(pub: MqttClient): Function {
+  public getMessageHandler(pub: MqttClient) {
     return async (
       channel: string,
       buffer: Buffer,
@@ -101,7 +120,7 @@ export class ServerMqtt extends Server implements CustomTransportStrategy {
   ): Promise<any> {
     const rawPacket = this.parseMessage(buffer.toString());
     const packet = await this.deserializer.deserialize(rawPacket, { channel });
-    const mqttContext = new MqttContext([channel, originalPacket]);
+    const mqttContext = new MqttContext([channel, originalPacket!]);
     if (isUndefined((packet as IncomingRequest).id)) {
       return this.handleEvent(channel, packet, mqttContext);
     }
@@ -130,16 +149,14 @@ export class ServerMqtt extends Server implements CustomTransportStrategy {
   public getPublisher(client: MqttClient, pattern: any, id: string): any {
     return (response: any) => {
       Object.assign(response, { id });
-      const options =
-        isObject(response?.data) && response.data instanceof MqttRecord
-          ? (response.data as MqttRecord)?.options
-          : {};
-      delete response?.data?.options;
-      const outgoingResponse: string | Buffer =
+      const outgoingResponse: Partial<MqttRecord> =
         this.serializer.serialize(response);
+      const options = outgoingResponse.options;
+      delete outgoingResponse.options;
+
       return client.publish(
         this.getReplyPattern(pattern),
-        outgoingResponse,
+        JSON.stringify(outgoingResponse),
         options,
       );
     };
@@ -192,19 +209,20 @@ export class ServerMqtt extends Server implements CustomTransportStrategy {
     }
 
     for (const [key, value] of this.messageHandlers) {
-      if (
-        !key.includes(MQTT_WILDCARD_SINGLE) &&
-        !key.includes(MQTT_WILDCARD_ALL)
-      ) {
-        continue;
-      }
-      if (this.matchMqttPattern(key, route)) {
+      const keyWithoutSharedPrefix = this.removeHandlerKeySharedPrefix(key);
+      if (this.matchMqttPattern(keyWithoutSharedPrefix, route)) {
         return value;
       }
     }
     return null;
   }
 
+  public removeHandlerKeySharedPrefix(handlerKey: string) {
+    return handlerKey && handlerKey.startsWith('$share')
+      ? handlerKey.split('/').slice(2).join('/')
+      : handlerKey;
+  }
+
   public getRequestPattern(pattern: string): string {
     return pattern;
   }
@@ -213,8 +231,54 @@ export class ServerMqtt extends Server implements CustomTransportStrategy {
     return `${pattern}/reply`;
   }
 
-  public handleError(stream: any) {
-    stream.on(ERROR_EVENT, (err: any) => this.logger.error(err));
+  public registerErrorListener(client: MqttClient) {
+    client.on(MqttEventsMap.ERROR, (err: unknown) => this.logger.error(err));
+  }
+
+  public registerReconnectListener(client: MqttClient) {
+    client.on(MqttEventsMap.RECONNECT, () => {
+      this._status$.next(MqttStatus.RECONNECTING);
+
+      this.logger.log('MQTT connection lost. Trying to reconnect...');
+    });
+  }
+
+  public registerDisconnectListener(client: MqttClient) {
+    client.on(MqttEventsMap.DISCONNECT, () => {
+      this._status$.next(MqttStatus.DISCONNECTED);
+    });
+  }
+
+  public registerCloseListener(client: MqttClient) {
+    client.on(MqttEventsMap.CLOSE, () => {
+      this._status$.next(MqttStatus.CLOSED);
+    });
+  }
+
+  public registerConnectListener(client: MqttClient) {
+    client.on(MqttEventsMap.CONNECT, () => {
+      this._status$.next(MqttStatus.CONNECTED);
+    });
+  }
+
+  public unwrap<T>(): T {
+    if (!this.mqttClient) {
+      throw new Error(
+        'Not initialized. Please call the "listen"/"startAllMicroservices" method before accessing the server.',
+      );
+    }
+    return this.mqttClient as T;
+  }
+
+  public on<
+    EventKey extends keyof MqttEvents = keyof MqttEvents,
+    EventCallback extends MqttEvents[EventKey] = MqttEvents[EventKey],
+  >(event: EventKey, callback: EventCallback) {
+    if (this.mqttClient) {
+      this.mqttClient.on(event, callback as any);
+    } else {
+      this.pendingEventListeners.push({ event, callback });
+    }
   }
 
   protected initializeSerializer(options: MqttOptions['options']) {
diff --git a/packages/microservices/server/server-nats.ts b/packages/microservices/server/server-nats.ts
index 768fe3664..121a0ad19 100644
--- a/packages/microservices/server/server-nats.ts
+++ b/packages/microservices/server/server-nats.ts
@@ -1,11 +1,14 @@
-import { isUndefined, isObject } from '@nestjs/common/utils/shared.utils';
-import { Observable } from 'rxjs';
-import { NATS_DEFAULT_URL, NO_MESSAGE_HANDLER } from '../constants';
+import { isObject, isUndefined } from '@nestjs/common/utils/shared.utils';
+import { EventEmitter } from 'events';
+import {
+  NATS_DEFAULT_GRACE_PERIOD,
+  NATS_DEFAULT_URL,
+  NO_MESSAGE_HANDLER,
+} from '../constants';
 import { NatsContext } from '../ctx-host/nats.context';
 import { NatsRequestJSONDeserializer } from '../deserializers/nats-request-json.deserializer';
 import { Transport } from '../enums';
-import { Client, NatsMsg } from '../external/nats-client.interface';
-import { CustomTransportStrategy } from '../interfaces';
+import { NatsEvents, NatsEventsMap, NatsStatus } from '../events/nats.events';
 import { NatsOptions } from '../interfaces/microservice-configuration.interface';
 import { IncomingRequest } from '../interfaces/packet.interface';
 import { NatsRecord } from '../record-builders';
@@ -14,12 +17,34 @@ import { Server } from './server';
 
 let natsPackage = {} as any;
 
-export class ServerNats extends Server implements CustomTransportStrategy {
+// To enable type safety for Nats. This cant be uncommented by default
+// because it would require the user to install the nats package even if they dont use Nats
+// Otherwise, TypeScript would fail to compile the code.
+//
+// type Client = import('nats').NatsConnection;
+// type NatsMsg = import('nats').Msg;
+// type Subscription = import('nats').Subscription;
+
+type Client = any;
+type NatsMsg = any;
+type Subscription = any;
+
+/**
+ * @publicApi
+ */
+export class ServerNats<
+  E extends NatsEvents = NatsEvents,
+  S extends NatsStatus = NatsStatus,
+> extends Server<E, S> {
   public readonly transportId = Transport.NATS;
 
   private natsClient: Client;
+  protected statusEventEmitter = new EventEmitter<{
+    [key in keyof NatsEvents]: Parameters<NatsEvents[key]>;
+  }>();
+  private readonly subscriptions: Subscription[] = [];
 
-  constructor(private readonly options: NatsOptions['options']) {
+  constructor(private readonly options: Required<NatsOptions>['options']) {
     super();
 
     natsPackage = this.loadPackage('nats', ServerNats.name, () =>
@@ -35,7 +60,9 @@ export class ServerNats extends Server implements CustomTransportStrategy {
   ) {
     try {
       this.natsClient = await this.createNatsClient();
-      this.handleStatusUpdates(this.natsClient);
+
+      this._status$.next(NatsStatus.CONNECTED as S);
+      void this.handleStatusUpdates(this.natsClient);
       this.start(callback);
     } catch (err) {
       callback(err);
@@ -50,19 +77,46 @@ export class ServerNats extends Server implements CustomTransportStrategy {
   }
 
   public bindEvents(client: Client) {
-    const queue = this.getOptionsProp(this.options, 'queue');
-    const subscribe = (channel: string) =>
+    const subscribe = (channel: string, queue: string) =>
       client.subscribe(channel, {
         queue,
         callback: this.getMessageHandler(channel).bind(this),
       });
 
+    const defaultQueue = this.getOptionsProp(this.options, 'queue');
     const registeredPatterns = [...this.messageHandlers.keys()];
-    registeredPatterns.forEach(channel => subscribe(channel));
+    for (const channel of registeredPatterns) {
+      const handlerRef = this.messageHandlers.get(channel)!;
+      const queue = handlerRef.extras?.queue ?? defaultQueue;
+      const sub = subscribe(channel, queue);
+      this.subscriptions.push(sub);
+    }
+  }
+
+  private async waitForGracePeriod() {
+    const gracePeriod = this.getOptionsProp(
+      this.options,
+      'gracePeriod',
+      NATS_DEFAULT_GRACE_PERIOD,
+    );
+    await new Promise<void>(res => {
+      setTimeout(() => {
+        res();
+      }, gracePeriod);
+    });
   }
 
   public async close() {
+    if (!this.natsClient) {
+      return;
+    }
+    const graceful = this.getOptionsProp(this.options, 'gracefulShutdown');
+    if (graceful) {
+      this.subscriptions.forEach(sub => sub.unsubscribe());
+      await this.waitForGracePeriod();
+    }
     await this.natsClient?.close();
+    this.statusEventEmitter.removeAllListeners();
     this.natsClient = null;
   }
 
@@ -127,7 +181,7 @@ export class ServerNats extends Server implements CustomTransportStrategy {
 
     // In case the "reply" topic is not provided, there's no need for a reply.
     // Method returns a noop function instead
-    // eslint-disable-next-line @typescript-eslint/no-empty-function
+
     return () => {};
   }
 
@@ -137,21 +191,82 @@ export class ServerNats extends Server implements CustomTransportStrategy {
         status.data && isObject(status.data)
           ? JSON.stringify(status.data)
           : status.data;
-      if (status.type === 'disconnect' || status.type === 'error') {
-        this.logger.error(
-          `NatsError: type: "${status.type}", data: "${data}".`,
-        );
-      } else {
-        const message = `NatsStatus: type: "${status.type}", data: "${data}".`;
-        if (status.type === 'pingTimer') {
-          this.logger.debug(message);
-        } else {
-          this.logger.log(message);
-        }
+
+      switch (status.type) {
+        case 'error':
+          this.logger.error(
+            `NatsError: type: "${status.type}", data: "${data}".`,
+          );
+          break;
+
+        case 'disconnect':
+          this.logger.error(
+            `NatsError: type: "${status.type}", data: "${data}".`,
+          );
+
+          this._status$.next(NatsStatus.DISCONNECTED as S);
+          this.statusEventEmitter.emit(
+            NatsEventsMap.DISCONNECT,
+            status.data as string,
+          );
+          break;
+
+        case 'pingTimer':
+          if (this.options.debug) {
+            this.logger.debug!(
+              `NatsStatus: type: "${status.type}", data: "${data}".`,
+            );
+          }
+          break;
+
+        case 'reconnecting':
+          this._status$.next(NatsStatus.RECONNECTING as S);
+          break;
+
+        case 'reconnect':
+          this.logger.log(
+            `NatsStatus: type: "${status.type}", data: "${data}".`,
+          );
+
+          this._status$.next(NatsStatus.CONNECTED as S);
+          this.statusEventEmitter.emit(
+            NatsEventsMap.RECONNECT,
+            status.data as string,
+          );
+          break;
+
+        case 'update':
+          this.logger.log(
+            `NatsStatus: type: "${status.type}", data: "${data}".`,
+          );
+          this.statusEventEmitter.emit(NatsEventsMap.UPDATE, status.data);
+          break;
+
+        default:
+          this.logger.log(
+            `NatsStatus: type: "${status.type}", data: "${data}".`,
+          );
+          break;
       }
     }
   }
 
+  public unwrap<T>(): T {
+    if (!this.natsClient) {
+      throw new Error(
+        'Not initialized. Please call the "listen"/"startAllMicroservices" method before accessing the server.',
+      );
+    }
+    return this.natsClient as T;
+  }
+
+  public on<
+    EventKey extends keyof E = keyof E,
+    EventCallback extends E[EventKey] = E[EventKey],
+  >(event: EventKey, callback: EventCallback) {
+    this.statusEventEmitter.on(event, callback as any);
+  }
+
   protected initializeSerializer(options: NatsOptions['options']) {
     this.serializer = options?.serializer ?? new NatsRecordSerializer();
   }
diff --git a/packages/microservices/server/server-redis.ts b/packages/microservices/server/server-redis.ts
index beaf02f85..f355f5fa3 100644
--- a/packages/microservices/server/server-redis.ts
+++ b/packages/microservices/server/server-redis.ts
@@ -1,41 +1,48 @@
 import { isUndefined } from '@nestjs/common/utils/shared.utils';
-import { Observable } from 'rxjs';
 import {
-  CONNECT_EVENT,
-  ERROR_EVENT,
-  MESSAGE_EVENT,
   NO_MESSAGE_HANDLER,
-  REDIS_DEFAULT_URL,
+  REDIS_DEFAULT_HOST,
+  REDIS_DEFAULT_PORT,
 } from '../constants';
 import { RedisContext } from '../ctx-host';
 import { Transport } from '../enums';
 import {
-  ClientOpts,
-  RedisClient,
-  RetryStrategyOptions,
-} from '../external/redis.interface';
-import { CustomTransportStrategy, IncomingRequest } from '../interfaces';
-import { RedisOptions } from '../interfaces/microservice-configuration.interface';
+  RedisEvents,
+  RedisEventsMap,
+  RedisStatus,
+} from '../events/redis.events';
+import { IncomingRequest, RedisOptions } from '../interfaces';
 import { Server } from './server';
 
-let redisPackage: any = {};
+// To enable type safety for Redis. This cant be uncommented by default
+// because it would require the user to install the ioredis package even if they dont use Redis
+// Otherwise, TypeScript would fail to compile the code.
+//
+// type Redis = import('ioredis').Redis;
+type Redis = any;
 
-export class ServerRedis extends Server implements CustomTransportStrategy {
+let redisPackage = {} as any;
+
+/**
+ * @publicApi
+ */
+export class ServerRedis extends Server<RedisEvents, RedisStatus> {
   public readonly transportId = Transport.REDIS;
 
-  private readonly url: string;
-  private subClient: RedisClient;
-  private pubClient: RedisClient;
-  private isExplicitlyTerminated = false;
+  protected subClient: Redis;
+  protected pubClient: Redis;
+  protected isManuallyClosed = false;
+  protected wasInitialConnectionSuccessful = false;
+  protected pendingEventListeners: Array<{
+    event: keyof RedisEvents;
+    callback: RedisEvents[keyof RedisEvents];
+  }> = [];
 
-  constructor(private readonly options: RedisOptions['options']) {
+  constructor(protected readonly options: Required<RedisOptions>['options']) {
     super();
-    this.url =
-      this.getOptionsProp(options, 'url') ||
-      (!this.getOptionsProp(options, 'host') && REDIS_DEFAULT_URL);
 
-    redisPackage = this.loadPackage('redis', ServerRedis.name, () =>
-      require('redis'),
+    redisPackage = this.loadPackage('ioredis', ServerRedis.name, () =>
+      require('ioredis'),
     );
 
     this.initializeSerializer(options);
@@ -49,8 +56,18 @@ export class ServerRedis extends Server implements CustomTransportStrategy {
       this.subClient = this.createRedisClient();
       this.pubClient = this.createRedisClient();
 
-      this.handleError(this.pubClient);
-      this.handleError(this.subClient);
+      [this.subClient, this.pubClient].forEach((client, index) => {
+        const type = index === 0 ? 'pub' : 'sub';
+        this.registerErrorListener(client);
+        this.registerReconnectListener(client);
+        this.registerReadyListener(client);
+        this.registerEndListener(client);
+        this.pendingEventListeners.forEach(({ event, callback }) =>
+          client.on(event, (...args: [any]) => callback(type, ...args)),
+        );
+      });
+      this.pendingEventListeners = [];
+
       this.start(callback);
     } catch (err) {
       callback(err);
@@ -58,47 +75,68 @@ export class ServerRedis extends Server implements CustomTransportStrategy {
   }
 
   public start(callback?: () => void) {
-    this.bindEvents(this.subClient, this.pubClient);
-    this.subClient.on(CONNECT_EVENT, callback);
+    void Promise.all([this.subClient.connect(), this.pubClient.connect()])
+      .then(() => {
+        this.bindEvents(this.subClient, this.pubClient);
+        callback?.();
+      })
+      .catch(callback);
   }
 
-  public bindEvents(subClient: RedisClient, pubClient: RedisClient) {
-    subClient.on(MESSAGE_EVENT, this.getMessageHandler(pubClient).bind(this));
+  public bindEvents(subClient: Redis, pubClient: Redis) {
+    subClient.on(
+      this.options?.wildcards ? 'pmessage' : 'message',
+      this.getMessageHandler(pubClient).bind(this),
+    );
     const subscribePatterns = [...this.messageHandlers.keys()];
     subscribePatterns.forEach(pattern => {
-      const { isEventHandler } = this.messageHandlers.get(pattern);
-      subClient.subscribe(
-        isEventHandler ? pattern : this.getRequestPattern(pattern),
-      );
+      const { isEventHandler } = this.messageHandlers.get(pattern)!;
+
+      const channel = isEventHandler
+        ? pattern
+        : this.getRequestPattern(pattern);
+
+      if (this.options?.wildcards) {
+        subClient.psubscribe(channel);
+      } else {
+        subClient.subscribe(channel);
+      }
     });
   }
 
   public close() {
-    this.isExplicitlyTerminated = true;
+    this.isManuallyClosed = true;
     this.pubClient && this.pubClient.quit();
     this.subClient && this.subClient.quit();
+    this.pendingEventListeners = [];
   }
 
-  public createRedisClient(): RedisClient {
-    return redisPackage.createClient({
+  public createRedisClient(): Redis {
+    return new redisPackage({
+      port: REDIS_DEFAULT_PORT,
+      host: REDIS_DEFAULT_HOST,
       ...this.getClientOptions(),
-      url: this.url,
+      lazyConnect: true,
     });
   }
 
-  public getMessageHandler(pub: RedisClient) {
-    return async (channel: string, buffer: string | any) =>
-      this.handleMessage(channel, buffer, pub);
+  public getMessageHandler(pub: Redis) {
+    return this.options?.wildcards
+      ? (channel: string, pattern: string, buffer: string) =>
+          this.handleMessage(channel, buffer, pub, pattern)
+      : (channel: string, buffer: string) =>
+          this.handleMessage(channel, buffer, pub, channel);
   }
 
   public async handleMessage(
     channel: string,
-    buffer: string | any,
-    pub: RedisClient,
+    buffer: string,
+    pub: Redis,
+    pattern: string,
   ) {
     const rawMessage = this.parseMessage(buffer);
     const packet = await this.deserializer.deserialize(rawMessage, { channel });
-    const redisCtx = new RedisContext([channel]);
+    const redisCtx = new RedisContext([pattern]);
 
     if (isUndefined((packet as IncomingRequest).id)) {
       return this.handleEvent(channel, packet, redisCtx);
@@ -125,7 +163,7 @@ export class ServerRedis extends Server implements CustomTransportStrategy {
     response$ && this.send(response$, publish);
   }
 
-  public getPublisher(pub: RedisClient, pattern: any, id: string) {
+  public getPublisher(pub: Redis, pattern: any, id: string) {
     return (response: any) => {
       Object.assign(response, { id });
       const outgoingResponse = this.serializer.serialize(response);
@@ -153,36 +191,98 @@ export class ServerRedis extends Server implements CustomTransportStrategy {
     return `${pattern}.reply`;
   }
 
-  public handleError(stream: any) {
-    stream.on(ERROR_EVENT, (err: any) => this.logger.error(err));
+  public registerErrorListener(client: any) {
+    client.on(RedisEventsMap.ERROR, (err: any) => this.logger.error(err));
+  }
+
+  public registerReconnectListener(client: {
+    on: (event: string, fn: () => void) => void;
+  }) {
+    client.on(RedisEventsMap.RECONNECTING, () => {
+      if (this.isManuallyClosed) {
+        return;
+      }
+      this._status$.next(RedisStatus.RECONNECTING);
+
+      if (this.wasInitialConnectionSuccessful) {
+        this.logger.log('Reconnecting to Redis...');
+      }
+    });
+  }
+
+  public registerReadyListener(client: {
+    on: (event: string, fn: () => void) => void;
+  }) {
+    client.on(RedisEventsMap.READY, () => {
+      this._status$.next(RedisStatus.CONNECTED);
+
+      this.logger.log('Connected to Redis. Subscribing to channels...');
+
+      if (!this.wasInitialConnectionSuccessful) {
+        this.wasInitialConnectionSuccessful = true;
+      }
+    });
+  }
+
+  public registerEndListener(client: {
+    on: (event: string, fn: () => void) => void;
+  }) {
+    client.on('end', () => {
+      if (this.isManuallyClosed) {
+        return;
+      }
+      this._status$.next(RedisStatus.DISCONNECTED);
+
+      this.logger.error(
+        'Disconnected from Redis. No further reconnection attempts will be made.',
+      );
+    });
   }
 
-  public getClientOptions(): Partial<ClientOpts> {
-    const retry_strategy = (options: RetryStrategyOptions) =>
-      this.createRetryStrategy(options);
+  public getClientOptions(): Partial<RedisOptions['options']> {
+    const retryStrategy = (times: number) => this.createRetryStrategy(times);
 
     return {
       ...(this.options || {}),
-      retry_strategy,
+      retryStrategy,
     };
   }
 
-  public createRetryStrategy(
-    options: RetryStrategyOptions,
-  ): undefined | number | void {
-    if (options.error && (options.error as any).code === 'ECONNREFUSED') {
-      this.logger.error(`Error ECONNREFUSED: ${this.url}`);
-    }
-    if (this.isExplicitlyTerminated) {
+  public createRetryStrategy(times: number): undefined | number | void {
+    if (this.isManuallyClosed) {
       return undefined;
     }
-    if (
-      !this.getOptionsProp(this.options, 'retryAttempts') ||
-      options.attempt > this.getOptionsProp(this.options, 'retryAttempts')
-    ) {
-      this.logger.error(`Retry time exhausted: ${this.url}`);
-      throw new Error('Retry time exhausted');
+    if (!this.getOptionsProp(this.options, 'retryAttempts')) {
+      this.logger.error(
+        'Redis connection closed and retry attempts not specified',
+      );
+      return;
+    }
+    if (times > this.getOptionsProp(this.options, 'retryAttempts', 0)) {
+      this.logger.error(`Retry time exhausted`);
+      return;
+    }
+    return this.getOptionsProp(this.options, 'retryDelay', 5000);
+  }
+
+  public unwrap<T>(): T {
+    if (!this.pubClient || !this.subClient) {
+      throw new Error(
+        'Not initialized. Please call the "listen"/"startAllMicroservices" method before accessing the server.',
+      );
+    }
+    return [this.pubClient, this.subClient] as T;
+  }
+
+  public on<
+    EventKey extends keyof RedisEvents = keyof RedisEvents,
+    EventCallback extends RedisEvents[EventKey] = RedisEvents[EventKey],
+  >(event: EventKey, callback: EventCallback) {
+    if (this.subClient && this.pubClient) {
+      this.subClient.on(event, (...args: [any]) => callback('sub', ...args));
+      this.pubClient.on(event, (...args: [any]) => callback('pub', ...args));
+    } else {
+      this.pendingEventListeners.push({ event, callback });
     }
-    return this.getOptionsProp(this.options, 'retryDelay') || 0;
   }
 }
diff --git a/packages/microservices/server/server-rmq.ts b/packages/microservices/server/server-rmq.ts
index becc255bd..20fdea33e 100644
--- a/packages/microservices/server/server-rmq.ts
+++ b/packages/microservices/server/server-rmq.ts
@@ -4,58 +4,79 @@ import {
   isUndefined,
 } from '@nestjs/common/utils/shared.utils';
 import {
-  CONNECT_EVENT,
+  CONNECTION_FAILED_MESSAGE,
   DISCONNECTED_RMQ_MESSAGE,
-  DISCONNECT_EVENT,
   NO_MESSAGE_HANDLER,
   RQM_DEFAULT_IS_GLOBAL_PREFETCH_COUNT,
   RQM_DEFAULT_NOACK,
+  RQM_DEFAULT_NO_ASSERT,
   RQM_DEFAULT_PREFETCH_COUNT,
   RQM_DEFAULT_QUEUE,
   RQM_DEFAULT_QUEUE_OPTIONS,
   RQM_DEFAULT_URL,
+  RQM_NO_EVENT_HANDLER,
+  RQM_NO_MESSAGE_HANDLER,
 } from '../constants';
 import { RmqContext } from '../ctx-host';
 import { Transport } from '../enums';
+import { RmqEvents, RmqEventsMap, RmqStatus } from '../events/rmq.events';
 import { RmqUrl } from '../external/rmq-url.interface';
-import { CustomTransportStrategy, RmqOptions } from '../interfaces';
+import { RmqOptions } from '../interfaces';
 import {
   IncomingRequest,
   OutgoingResponse,
+  ReadPacket,
 } from '../interfaces/packet.interface';
 import { RmqRecordSerializer } from '../serializers/rmq-record.serializer';
 import { Server } from './server';
 
-let rqmPackage: any = {};
+// To enable type safety for RMQ. This cant be uncommented by default
+// because it would require the user to install the amqplib package even if they dont use RabbitMQ
+// Otherwise, TypeScript would fail to compile the code.
+//
+// type AmqpConnectionManager =
+//   import('amqp-connection-manager').AmqpConnectionManager;
+// type ChannelWrapper = import('amqp-connection-manager').ChannelWrapper;
+// type Message = import('amqplib').Message;
 
-export class ServerRMQ extends Server implements CustomTransportStrategy {
+type AmqpConnectionManager = any;
+type ChannelWrapper = any;
+type Message = any;
+
+let rmqPackage = {} as any; // as typeof import('amqp-connection-manager');
+
+const INFINITE_CONNECTION_ATTEMPTS = -1;
+
+/**
+ * @publicApi
+ */
+export class ServerRMQ extends Server<RmqEvents, RmqStatus> {
   public readonly transportId = Transport.RMQ;
 
-  protected server: any = null;
-  protected channel: any = null;
+  protected server: AmqpConnectionManager = null;
+  protected channel: ChannelWrapper = null;
+  protected connectionAttempts = 0;
   protected readonly urls: string[] | RmqUrl[];
   protected readonly queue: string;
-  protected readonly prefetchCount: number;
+  protected readonly noAck: boolean;
   protected readonly queueOptions: any;
-  protected readonly isGlobalPrefetchCount: boolean;
+  protected pendingEventListeners: Array<{
+    event: keyof RmqEvents;
+    callback: RmqEvents[keyof RmqEvents];
+  }> = [];
 
-  constructor(protected readonly options: RmqOptions['options']) {
+  constructor(protected readonly options: Required<RmqOptions>['options']) {
     super();
     this.urls = this.getOptionsProp(this.options, 'urls') || [RQM_DEFAULT_URL];
     this.queue =
       this.getOptionsProp(this.options, 'queue') || RQM_DEFAULT_QUEUE;
-    this.prefetchCount =
-      this.getOptionsProp(this.options, 'prefetchCount') ||
-      RQM_DEFAULT_PREFETCH_COUNT;
-    this.isGlobalPrefetchCount =
-      this.getOptionsProp(this.options, 'isGlobalPrefetchCount') ||
-      RQM_DEFAULT_IS_GLOBAL_PREFETCH_COUNT;
+    this.noAck = this.getOptionsProp(this.options, 'noAck', RQM_DEFAULT_NOACK);
     this.queueOptions =
       this.getOptionsProp(this.options, 'queueOptions') ||
       RQM_DEFAULT_QUEUE_OPTIONS;
 
     this.loadPackage('amqplib', ServerRMQ.name, () => require('amqplib'));
-    rqmPackage = this.loadPackage(
+    rmqPackage = this.loadPackage(
       'amqp-connection-manager',
       ServerRMQ.name,
       () => require('amqp-connection-manager'),
@@ -78,44 +99,125 @@ export class ServerRMQ extends Server implements CustomTransportStrategy {
   public close(): void {
     this.channel && this.channel.close();
     this.server && this.server.close();
+    this.pendingEventListeners = [];
   }
 
-  public async start(callback?: () => void) {
+  public async start(
+    callback?: (err?: unknown, ...optionalParams: unknown[]) => void,
+  ) {
     this.server = this.createClient();
-    this.server.on(CONNECT_EVENT, () => {
+    this.server.once(RmqEventsMap.CONNECT, () => {
       if (this.channel) {
         return;
       }
+      this._status$.next(RmqStatus.CONNECTED);
       this.channel = this.server.createChannel({
         json: false,
-        setup: (channel: any) => this.setupChannel(channel, callback),
+        setup: (channel: any) => this.setupChannel(channel, callback!),
       });
     });
-    this.server.on(DISCONNECT_EVENT, (err: any) => {
-      this.logger.error(DISCONNECTED_RMQ_MESSAGE);
-      this.logger.error(err);
+
+    const maxConnectionAttempts = this.getOptionsProp(
+      this.options,
+      'maxConnectionAttempts',
+      INFINITE_CONNECTION_ATTEMPTS,
+    );
+
+    this.registerConnectListener();
+    this.registerDisconnectListener();
+    this.pendingEventListeners.forEach(({ event, callback }) =>
+      this.server.on(event, callback),
+    );
+    this.pendingEventListeners = [];
+
+    const connectFailedEvent = 'connectFailed';
+    this.server.once(connectFailedEvent, (error: Record<string, unknown>) => {
+      this._status$.next(RmqStatus.DISCONNECTED);
+
+      this.logger.error(CONNECTION_FAILED_MESSAGE);
+      if (error?.err) {
+        this.logger.error(error.err);
+      }
+      const isReconnecting = !!this.channel;
+      if (
+        maxConnectionAttempts === INFINITE_CONNECTION_ATTEMPTS ||
+        isReconnecting
+      ) {
+        return;
+      }
+      if (++this.connectionAttempts === maxConnectionAttempts) {
+        this.close();
+        callback?.(error.err ?? new Error(CONNECTION_FAILED_MESSAGE));
+      }
     });
   }
 
   public createClient<T = any>(): T {
     const socketOptions = this.getOptionsProp(this.options, 'socketOptions');
-    return rqmPackage.connect(this.urls, {
-      connectionOptions: socketOptions,
+    return rmqPackage.connect(this.urls, {
+      connectionOptions: socketOptions?.connectionOptions,
       heartbeatIntervalInSeconds: socketOptions?.heartbeatIntervalInSeconds,
       reconnectTimeInSeconds: socketOptions?.reconnectTimeInSeconds,
     });
   }
 
+  private registerConnectListener() {
+    this.server.on(RmqEventsMap.CONNECT, (err: any) => {
+      this._status$.next(RmqStatus.CONNECTED);
+    });
+  }
+
+  private registerDisconnectListener() {
+    this.server.on(RmqEventsMap.DISCONNECT, (err: any) => {
+      this._status$.next(RmqStatus.DISCONNECTED);
+      this.logger.error(DISCONNECTED_RMQ_MESSAGE);
+      this.logger.error(err);
+    });
+  }
+
   public async setupChannel(channel: any, callback: Function) {
-    const noAck = this.getOptionsProp(this.options, 'noAck', RQM_DEFAULT_NOACK);
+    const noAssert =
+      this.getOptionsProp(this.options, 'noAssert') ??
+      this.queueOptions.noAssert ??
+      RQM_DEFAULT_NO_ASSERT;
+
+    if (!noAssert) {
+      await channel.assertQueue(this.queue, this.queueOptions);
+    }
+
+    const isGlobalPrefetchCount = this.getOptionsProp(
+      this.options,
+      'isGlobalPrefetchCount',
+      RQM_DEFAULT_IS_GLOBAL_PREFETCH_COUNT,
+    );
+    const prefetchCount = this.getOptionsProp(
+      this.options,
+      'prefetchCount',
+      RQM_DEFAULT_PREFETCH_COUNT,
+    );
+
+    if (this.options.exchange && this.options.routingKey) {
+      await channel.assertExchange(this.options.exchange, 'topic', {
+        durable: true,
+      });
+      await channel.bindQueue(
+        this.queue,
+        this.options.exchange,
+        this.options.routingKey,
+      );
+    }
 
-    await channel.assertQueue(this.queue, this.queueOptions);
-    await channel.prefetch(this.prefetchCount, this.isGlobalPrefetchCount);
+    await channel.prefetch(prefetchCount, isGlobalPrefetchCount);
     channel.consume(
       this.queue,
       (msg: Record<string, any>) => this.handleMessage(msg, channel),
       {
-        noAck,
+        noAck: this.noAck,
+        consumerTag: this.getOptionsProp(
+          this.options,
+          'consumerTag',
+          undefined,
+        ),
       },
     );
     callback();
@@ -129,8 +231,8 @@ export class ServerRMQ extends Server implements CustomTransportStrategy {
       return;
     }
     const { content, properties } = message;
-    const rawMessage = JSON.parse(content.toString());
-    const packet = await this.deserializer.deserialize(rawMessage);
+    const rawMessage = this.parseMessageContent(content);
+    const packet = await this.deserializer.deserialize(rawMessage, properties);
     const pattern = isString(packet.pattern)
       ? packet.pattern
       : JSON.stringify(packet.pattern);
@@ -142,6 +244,10 @@ export class ServerRMQ extends Server implements CustomTransportStrategy {
     const handler = this.getHandlerByPattern(pattern);
 
     if (!handler) {
+      if (!this.noAck) {
+        this.logger.warn(RQM_NO_MESSAGE_HANDLER`${pattern}`);
+        this.channel.nack(rmqContext.getMessage() as Message, false, false);
+      }
       const status = 'error';
       const noHandlerPacket = {
         id: (packet as IncomingRequest).id,
@@ -164,6 +270,19 @@ export class ServerRMQ extends Server implements CustomTransportStrategy {
     response$ && this.send(response$, publish);
   }
 
+  public async handleEvent(
+    pattern: string,
+    packet: ReadPacket,
+    context: RmqContext,
+  ): Promise<any> {
+    const handler = this.getHandlerByPattern(pattern);
+    if (!handler && !this.noAck) {
+      this.channel.nack(context.getMessage() as Message, false, false);
+      return this.logger.warn(RQM_NO_EVENT_HANDLER`${pattern}`);
+    }
+    return super.handleEvent(pattern, packet, context);
+  }
+
   public sendMessage<T = any>(
     message: T,
     replyTo: any,
@@ -179,7 +298,35 @@ export class ServerRMQ extends Server implements CustomTransportStrategy {
     this.channel.sendToQueue(replyTo, buffer, { correlationId, ...options });
   }
 
+  public unwrap<T>(): T {
+    if (!this.server) {
+      throw new Error(
+        'Not initialized. Please call the "listen"/"startAllMicroservices" method before accessing the server.',
+      );
+    }
+    return this.server as T;
+  }
+
+  public on<
+    EventKey extends keyof RmqEvents = keyof RmqEvents,
+    EventCallback extends RmqEvents[EventKey] = RmqEvents[EventKey],
+  >(event: EventKey, callback: EventCallback) {
+    if (this.server) {
+      this.server.addListener(event, callback);
+    } else {
+      this.pendingEventListeners.push({ event, callback });
+    }
+  }
+
   protected initializeSerializer(options: RmqOptions['options']) {
     this.serializer = options?.serializer ?? new RmqRecordSerializer();
   }
+
+  private parseMessageContent(content: Buffer) {
+    try {
+      return JSON.parse(content.toString());
+    } catch {
+      return content.toString();
+    }
+  }
 }
diff --git a/packages/microservices/server/server-tcp.ts b/packages/microservices/server/server-tcp.ts
index 067a3b19a..c78926ef6 100644
--- a/packages/microservices/server/server-tcp.ts
+++ b/packages/microservices/server/server-tcp.ts
@@ -1,22 +1,20 @@
+import { Type } from '@nestjs/common';
 import { isString, isUndefined } from '@nestjs/common/utils/shared.utils';
 import * as net from 'net';
 import { Server as NetSocket, Socket } from 'net';
-import { Observable } from 'rxjs';
+import { createServer as tlsCreateServer, TlsOptions } from 'tls';
 import {
-  CLOSE_EVENT,
   EADDRINUSE,
   ECONNREFUSED,
-  ERROR_EVENT,
-  MESSAGE_EVENT,
   NO_MESSAGE_HANDLER,
   TCP_DEFAULT_HOST,
   TCP_DEFAULT_PORT,
 } from '../constants';
 import { TcpContext } from '../ctx-host/tcp.context';
 import { Transport } from '../enums';
-import { JsonSocket } from '../helpers/json-socket';
+import { TcpEvents, TcpEventsMap, TcpStatus } from '../events/tcp.events';
+import { JsonSocket, TcpSocket } from '../helpers';
 import {
-  CustomTransportStrategy,
   IncomingRequest,
   PacketId,
   ReadPacket,
@@ -25,19 +23,30 @@ import {
 import { TcpOptions } from '../interfaces/microservice-configuration.interface';
 import { Server } from './server';
 
-export class ServerTCP extends Server implements CustomTransportStrategy {
+/**
+ * @publicApi
+ */
+export class ServerTCP extends Server<TcpEvents, TcpStatus> {
   public readonly transportId = Transport.TCP;
 
-  private readonly port: number;
-  private readonly host: string;
-  private server: NetSocket;
-  private isExplicitlyTerminated = false;
-  private retryAttemptsCount = 0;
+  protected server: NetSocket;
+  protected readonly port: number;
+  protected readonly host: string;
+  protected readonly socketClass: Type<TcpSocket>;
+  protected isManuallyTerminated = false;
+  protected retryAttemptsCount = 0;
+  protected tlsOptions?: TlsOptions;
+  protected pendingEventListeners: Array<{
+    event: keyof TcpEvents;
+    callback: TcpEvents[keyof TcpEvents];
+  }> = [];
 
-  constructor(private readonly options: TcpOptions['options']) {
+  constructor(private readonly options: Required<TcpOptions>['options']) {
     super();
-    this.port = this.getOptionsProp(options, 'port') || TCP_DEFAULT_PORT;
-    this.host = this.getOptionsProp(options, 'host') || TCP_DEFAULT_HOST;
+    this.port = this.getOptionsProp(options, 'port', TCP_DEFAULT_PORT);
+    this.host = this.getOptionsProp(options, 'host', TCP_DEFAULT_HOST);
+    this.socketClass = this.getOptionsProp(options, 'socketClass', JsonSocket);
+    this.tlsOptions = this.getOptionsProp(options, 'tlsOptions');
 
     this.init();
     this.initializeSerializer(options);
@@ -47,8 +56,10 @@ export class ServerTCP extends Server implements CustomTransportStrategy {
   public listen(
     callback: (err?: unknown, ...optionalParams: unknown[]) => void,
   ) {
-    this.server.once(ERROR_EVENT, (err: Record<string, unknown>) => {
+    this.server.once(TcpEventsMap.ERROR, (err: Record<string, unknown>) => {
       if (err?.code === EADDRINUSE || err?.code === ECONNREFUSED) {
+        this._status$.next(TcpStatus.DISCONNECTED);
+
         return callback(err);
       }
     });
@@ -56,19 +67,21 @@ export class ServerTCP extends Server implements CustomTransportStrategy {
   }
 
   public close() {
-    this.isExplicitlyTerminated = true;
+    this.isManuallyTerminated = true;
+
     this.server.close();
+    this.pendingEventListeners = [];
   }
 
   public bindHandler(socket: Socket) {
     const readSocket = this.getSocketInstance(socket);
-    readSocket.on(MESSAGE_EVENT, async (msg: ReadPacket & PacketId) =>
+    readSocket.on('message', async (msg: ReadPacket & PacketId) =>
       this.handleMessage(readSocket, msg),
     );
-    readSocket.on(ERROR_EVENT, this.handleError.bind(this));
+    readSocket.on(TcpEventsMap.ERROR, this.handleError.bind(this));
   }
 
-  public async handleMessage(socket: JsonSocket, rawMessage: unknown) {
+  public async handleMessage(socket: TcpSocket, rawMessage: unknown) {
     const packet = await this.deserializer.deserialize(rawMessage);
     const pattern = !isString(packet.pattern)
       ? JSON.stringify(packet.pattern)
@@ -78,6 +91,7 @@ export class ServerTCP extends Server implements CustomTransportStrategy {
     if (isUndefined((packet as IncomingRequest).id)) {
       return this.handleEvent(pattern, packet, tcpContext);
     }
+
     const handler = this.getHandlerByPattern(pattern);
     if (!handler) {
       const status = 'error';
@@ -104,27 +118,84 @@ export class ServerTCP extends Server implements CustomTransportStrategy {
 
   public handleClose(): undefined | number | NodeJS.Timer {
     if (
-      this.isExplicitlyTerminated ||
+      this.isManuallyTerminated ||
       !this.getOptionsProp(this.options, 'retryAttempts') ||
       this.retryAttemptsCount >=
-        this.getOptionsProp(this.options, 'retryAttempts')
+        this.getOptionsProp(this.options, 'retryAttempts', 0)
     ) {
       return undefined;
     }
     ++this.retryAttemptsCount;
     return setTimeout(
-      () => this.server.listen(this.port),
-      this.getOptionsProp(this.options, 'retryDelay') || 0,
+      () => this.server.listen(this.port, this.host),
+      this.getOptionsProp(this.options, 'retryDelay', 0),
+    );
+  }
+
+  public unwrap<T>(): T {
+    if (!this.server) {
+      throw new Error(
+        'Not initialized. Please call the "listen"/"startAllMicroservices" method before accessing the server.',
+      );
+    }
+    return this.server as T;
+  }
+
+  public on<
+    EventKey extends keyof TcpEvents = keyof TcpEvents,
+    EventCallback extends TcpEvents[EventKey] = TcpEvents[EventKey],
+  >(event: EventKey, callback: EventCallback) {
+    if (this.server) {
+      this.server.on(event, callback as any);
+    } else {
+      this.pendingEventListeners.push({ event, callback });
+    }
+  }
+
+  protected init() {
+    if (this.tlsOptions) {
+      // TLS enabled, use tls server
+      this.server = tlsCreateServer(
+        this.tlsOptions,
+        this.bindHandler.bind(this),
+      );
+    } else {
+      // TLS disabled, use net server
+      this.server = net.createServer(this.bindHandler.bind(this));
+    }
+    this.registerListeningListener(this.server);
+    this.registerErrorListener(this.server);
+    this.registerCloseListener(this.server);
+
+    this.pendingEventListeners.forEach(({ event, callback }) =>
+      this.server.on(event, callback),
     );
+    this.pendingEventListeners = [];
+  }
+
+  protected registerListeningListener(socket: net.Server) {
+    socket.on(TcpEventsMap.LISTENING, () => {
+      this._status$.next(TcpStatus.CONNECTED);
+    });
   }
 
-  private init() {
-    this.server = net.createServer(this.bindHandler.bind(this));
-    this.server.on(ERROR_EVENT, this.handleError.bind(this));
-    this.server.on(CLOSE_EVENT, this.handleClose.bind(this));
+  protected registerErrorListener(socket: net.Server) {
+    socket.on(TcpEventsMap.ERROR, err => {
+      if ('code' in err && err.code === ECONNREFUSED) {
+        this._status$.next(TcpStatus.DISCONNECTED);
+      }
+      this.handleError(err as any);
+    });
+  }
+
+  protected registerCloseListener(socket: net.Server) {
+    socket.on(TcpEventsMap.CLOSE, () => {
+      this._status$.next(TcpStatus.DISCONNECTED);
+      this.handleClose();
+    });
   }
 
-  private getSocketInstance(socket: Socket): JsonSocket {
-    return new JsonSocket(socket);
+  protected getSocketInstance(socket: Socket): TcpSocket {
+    return new this.socketClass(socket);
   }
 }
diff --git a/packages/microservices/server/server.ts b/packages/microservices/server/server.ts
index 0bfa7e93d..dfa448381 100644
--- a/packages/microservices/server/server.ts
+++ b/packages/microservices/server/server.ts
@@ -8,13 +8,20 @@ import {
   Observable,
   ObservedValueOf,
   of,
+  ReplaySubject,
   Subject,
   Subscription,
 } from 'rxjs';
-import { catchError, finalize } from 'rxjs/operators';
+import {
+  catchError,
+  distinctUntilChanged,
+  finalize,
+  mergeMap,
+} from 'rxjs/operators';
 import { NO_EVENT_HANDLER } from '../constants';
 import { BaseRpcContext } from '../ctx-host/base-rpc.context';
 import { IncomingRequestDeserializer } from '../deserializers/incoming-request.deserializer';
+import { Transport } from '../enums';
 import {
   ClientOptions,
   KafkaOptions,
@@ -34,22 +41,68 @@ import { ConsumerSerializer } from '../interfaces/serializer.interface';
 import { IdentitySerializer } from '../serializers/identity.serializer';
 import { transformPatternToRoute } from '../utils';
 
-export abstract class Server {
+/**
+ * @publicApi
+ */
+export abstract class Server<
+  EventsMap extends Record<string, Function> = Record<string, Function>,
+  Status extends string = string,
+> {
+  /**
+   * Unique transport identifier.
+   */
+  readonly transportId?: Transport | symbol;
+
   protected readonly messageHandlers = new Map<string, MessageHandler>();
   protected readonly logger: LoggerService = new Logger(Server.name);
   protected serializer: ConsumerSerializer;
   protected deserializer: ConsumerDeserializer;
+  protected _status$ = new ReplaySubject<Status>(1);
+
+  /**
+   * Returns an observable that emits status changes.
+   */
+  public get status(): Observable<Status> {
+    return this._status$.asObservable().pipe(distinctUntilChanged());
+  }
+
+  /**
+   * Registers an event listener for the given event.
+   * @param event Event name
+   * @param callback Callback to be executed when the event is emitted
+   */
+  public abstract on<
+    EventKey extends keyof EventsMap = keyof EventsMap,
+    EventCallback extends EventsMap[EventKey] = EventsMap[EventKey],
+  >(event: EventKey, callback: EventCallback): any;
+  /**
+   * Returns an instance of the underlying server/broker instance,
+   * or a group of servers if there are more than one.
+   */
+  public abstract unwrap<T>(): T;
+
+  /**
+   * Method called when server is being initialized.
+   * @param callback Function to be called upon initialization
+   */
+  public abstract listen(callback: (...optionalParams: unknown[]) => any): any;
+  /**
+   * Method called when server is being terminated.
+   */
+  public abstract close(): any;
 
   public addHandler(
     pattern: any,
     callback: MessageHandler,
     isEventHandler = false,
+    extras: Record<string, any> = {},
   ) {
     const normalizedPattern = this.normalizePattern(pattern);
     callback.isEventHandler = isEventHandler;
+    callback.extras = extras;
 
     if (this.messageHandlers.has(normalizedPattern) && isEventHandler) {
-      const headRef = this.messageHandlers.get(normalizedPattern);
+      const headRef = this.messageHandlers.get(normalizedPattern)!;
       const getTail = (handler: MessageHandler) =>
         handler?.next ? getTail(handler.next) : handler;
 
@@ -67,20 +120,21 @@ export abstract class Server {
   public getHandlerByPattern(pattern: string): MessageHandler | null {
     const route = this.getRouteFromPattern(pattern);
     return this.messageHandlers.has(route)
-      ? this.messageHandlers.get(route)
+      ? this.messageHandlers.get(route)!
       : null;
   }
 
   public send(
     stream$: Observable<any>,
-    respond: (data: WritePacket) => unknown | Promise<unknown>,
+    respond: (data: WritePacket) => Promise<unknown> | void,
   ): Subscription {
-    let dataBuffer: WritePacket[] = null;
+    let dataBuffer: WritePacket[] | null = null;
+
     const scheduleOnNextTick = (data: WritePacket) => {
       if (!dataBuffer) {
         dataBuffer = [data];
         process.nextTick(async () => {
-          for (const item of dataBuffer) {
+          for (const item of dataBuffer!) {
             await respond(item);
           }
           dataBuffer = null;
@@ -109,9 +163,7 @@ export abstract class Server {
   ): Promise<any> {
     const handler = this.getHandlerByPattern(pattern);
     if (!handler) {
-      return this.logger.error(
-        `${NO_EVENT_HANDLER} Event pattern: ${JSON.stringify(pattern)}.`,
-      );
+      return this.logger.error(NO_EVENT_HANDLER`${pattern}`);
     }
     const resultOrStream = await handler(packet.data, context);
     if (isObservable(resultOrStream)) {
@@ -133,7 +185,9 @@ export abstract class Server {
     : Observable<ObservedValueOf<T>>;
   public transformToObservable(resultOrDeferred: any) {
     if (resultOrDeferred instanceof Promise) {
-      return fromPromise(resultOrDeferred);
+      return fromPromise(resultOrDeferred).pipe(
+        mergeMap(val => (isObservable(val) ? val : of(val))),
+      );
     }
 
     if (isObservable(resultOrDeferred)) {
@@ -144,10 +198,28 @@ export abstract class Server {
   }
 
   public getOptionsProp<
-    T extends MicroserviceOptions['options'],
-    K extends keyof T,
-  >(obj: T, prop: K, defaultValue: T[K] = undefined) {
-    return obj && prop in obj ? obj[prop] : defaultValue;
+    Options extends MicroserviceOptions['options'],
+    Attribute extends keyof Options,
+  >(obj: Options, prop: Attribute): Options[Attribute];
+  public getOptionsProp<
+    Options extends MicroserviceOptions['options'],
+    Attribute extends keyof Options,
+    DefaultValue extends Options[Attribute] = Options[Attribute],
+  >(
+    obj: Options,
+    prop: Attribute,
+    defaultValue: DefaultValue,
+  ): Required<Options>[Attribute];
+  public getOptionsProp<
+    Options extends MicroserviceOptions['options'],
+    Attribute extends keyof Options,
+    DefaultValue extends Options[Attribute] = Options[Attribute],
+  >(
+    obj: Options,
+    prop: Attribute,
+    defaultValue: DefaultValue = undefined as DefaultValue,
+  ) {
+    return obj && prop in obj ? (obj as any)[prop] : defaultValue;
   }
 
   protected handleError(error: string) {
@@ -165,30 +237,26 @@ export abstract class Server {
   protected initializeSerializer(options: ClientOptions['options']) {
     this.serializer =
       (options &&
-        (
-          options as
-            | RedisOptions['options']
-            | NatsOptions['options']
-            | MqttOptions['options']
-            | TcpOptions['options']
-            | RmqOptions['options']
-            | KafkaOptions['options']
-        ).serializer) ||
+        (options as
+          | RedisOptions['options']
+          | NatsOptions['options']
+          | MqttOptions['options']
+          | TcpOptions['options']
+          | RmqOptions['options']
+          | KafkaOptions['options'])!.serializer) ||
       new IdentitySerializer();
   }
 
   protected initializeDeserializer(options: ClientOptions['options']) {
     this.deserializer =
-      (options &&
-        (
-          options as
-            | RedisOptions['options']
-            | NatsOptions['options']
-            | MqttOptions['options']
-            | TcpOptions['options']
-            | RmqOptions['options']
-            | KafkaOptions['options']
-        ).deserializer) ||
+      (options! &&
+        (options as
+          | RedisOptions['options']
+          | NatsOptions['options']
+          | MqttOptions['options']
+          | TcpOptions['options']
+          | RmqOptions['options']
+          | KafkaOptions['options'])!.deserializer) ||
       new IncomingRequestDeserializer();
   }
 
diff --git a/packages/microservices/test/client/client-grpc.spec.ts b/packages/microservices/test/client/client-grpc.spec.ts
index ae041fa99..bb91f8479 100644
--- a/packages/microservices/test/client/client-grpc.spec.ts
+++ b/packages/microservices/test/client/client-grpc.spec.ts
@@ -3,10 +3,11 @@ import { expect } from 'chai';
 import { join } from 'path';
 import { Observable, Subject } from 'rxjs';
 import * as sinon from 'sinon';
-import { ClientGrpcProxy } from '../../client/client-grpc';
+import { ClientGrpcProxy } from '../../client';
 import { InvalidGrpcPackageException } from '../../errors/invalid-grpc-package.exception';
 import { InvalidGrpcServiceException } from '../../errors/invalid-grpc-service.exception';
 import { InvalidProtoDefinitionException } from '../../errors/invalid-proto-definition.exception';
+import * as grpcHelpers from '../../helpers/grpc-helpers';
 
 class NoopLogger extends Logger {
   log(message: any, context?: string): void {}
@@ -21,6 +22,7 @@ class GrpcService {
 
 describe('ClientGrpcProxy', () => {
   let client: ClientGrpcProxy;
+  let untypedClient: any;
   let clientMulti: ClientGrpcProxy;
 
   beforeEach(() => {
@@ -28,6 +30,7 @@ describe('ClientGrpcProxy', () => {
       protoPath: join(__dirname, './test.proto'),
       package: 'test',
     });
+    untypedClient = client as any;
 
     clientMulti = new ClientGrpcProxy({
       protoPath: ['test.proto', 'test2.proto'],
@@ -41,7 +44,7 @@ describe('ClientGrpcProxy', () => {
   describe('getService', () => {
     describe('when "grpcClient[name]" is nil', () => {
       it('should throw "InvalidGrpcServiceException"', () => {
-        (client as any).grpcClient = {};
+        untypedClient.grpcClient = {};
         expect(() => client.getService('test')).to.throw(
           InvalidGrpcServiceException,
         );
@@ -61,7 +64,7 @@ describe('ClientGrpcProxy', () => {
     });
     describe('when "grpcClient[name]" is not nil', () => {
       it('should create grpcService', () => {
-        (client as any).grpcClients[0] = {
+        untypedClient.grpcClients[0] = {
           test: GrpcService,
         };
         expect(() => client.getService('test')).to.not.throw(
@@ -257,7 +260,15 @@ describe('ClientGrpcProxy', () => {
     });
     describe('on subscribe', () => {
       const methodName = 'm';
-      const obj = { [methodName]: callback => callback(null, {}) };
+      const obj = {
+        [methodName]: callback => {
+          callback(null, {});
+
+          return {
+            finished: true,
+          };
+        },
+      };
 
       let stream$: Observable<any>;
 
@@ -282,12 +293,17 @@ describe('ClientGrpcProxy', () => {
       ) => void;
       const writeSpy = sinon.spy();
       const methodName = 'm';
+
+      const callMock = {
+        cancel: sinon.spy(),
+        finished: false,
+        write: writeSpy,
+      };
+
       const obj = {
         [methodName]: callback => {
           clientCallback = callback;
-          return {
-            write: writeSpy,
-          };
+          return callMock;
         },
       };
 
@@ -301,7 +317,6 @@ describe('ClientGrpcProxy', () => {
       });
 
       afterEach(() => {
-        // invoke client callback to allow resources to be cleaned up
         clientCallback(null, {});
       });
 
@@ -317,13 +332,107 @@ describe('ClientGrpcProxy', () => {
         expect(upstreamSubscribe.called).to.be.true;
       });
     });
+
+    describe('flow-control', () => {
+      it('should cancel call on client unsubscribe', () => {
+        const methodName = 'm';
+
+        const dataSpy = sinon.spy();
+        const errorSpy = sinon.spy();
+        const completeSpy = sinon.spy();
+
+        const callMock = {
+          cancel: sinon.spy(),
+          finished: false,
+        };
+
+        let handler: (error: any, data: any) => void;
+
+        const obj = {
+          [methodName]: (callback, ...args) => {
+            handler = callback;
+
+            return callMock;
+          },
+        };
+
+        const stream$ = client.createUnaryServiceMethod(obj, methodName)();
+
+        const subscription = stream$.subscribe({
+          next: dataSpy,
+          error: errorSpy,
+          complete: completeSpy,
+        });
+
+        subscription.unsubscribe();
+        handler!(null, 'a');
+
+        expect(dataSpy.called).to.be.false;
+        expect(errorSpy.called).to.be.false;
+        expect(completeSpy.called).to.be.false;
+        expect(callMock.cancel.called).to.be.true;
+      });
+
+      it('should cancel call on client unsubscribe case client streaming', () => {
+        const methodName = 'm';
+
+        const dataSpy = sinon.spy();
+        const errorSpy = sinon.spy();
+        const completeSpy = sinon.spy();
+        const writeSpy = sinon.spy();
+
+        const callMock = {
+          cancel: sinon.spy(),
+          finished: false,
+          write: writeSpy,
+        };
+
+        let handler: (error: any, data: any) => void;
+        const obj = {
+          [methodName]: callback => {
+            handler = callback;
+            return callMock;
+          },
+        };
+
+        (obj[methodName] as any).requestStream = true;
+        const upstream: Subject<unknown> = new Subject();
+        const stream$: Observable<any> = client.createUnaryServiceMethod(
+          obj,
+          methodName,
+        )(upstream);
+
+        const upstreamSubscribe = sinon.spy(upstream, 'subscribe');
+        stream$.subscribe({
+          next: () => ({}),
+          error: () => ({}),
+        });
+        upstream.next({ test: true });
+
+        const subscription = stream$.subscribe({
+          next: dataSpy,
+          error: errorSpy,
+          complete: completeSpy,
+        });
+
+        subscription.unsubscribe();
+        handler!(null, 'a');
+
+        expect(dataSpy.called).to.be.false;
+        expect(writeSpy.called).to.be.true;
+        expect(errorSpy.called).to.be.false;
+        expect(completeSpy.called).to.be.false;
+        expect(callMock.cancel.called).to.be.true;
+        expect(upstreamSubscribe.called).to.be.true;
+      });
+    });
   });
 
   describe('createClients', () => {
     describe('when package does not exist', () => {
       it('should throw "InvalidGrpcPackageException"', () => {
         sinon.stub(client, 'lookupPackage').callsFake(() => null);
-        (client as any).logger = new NoopLogger();
+        untypedClient.logger = new NoopLogger();
 
         try {
           client.createClients();
@@ -337,29 +446,37 @@ describe('ClientGrpcProxy', () => {
   describe('loadProto', () => {
     describe('when proto is invalid', () => {
       it('should throw InvalidProtoDefinitionException', () => {
-        sinon.stub(client, 'getOptionsProp' as any).callsFake(() => {
+        const getPackageDefinitionStub = sinon.stub(
+          grpcHelpers,
+          'getGrpcPackageDefinition' as any,
+        );
+        getPackageDefinitionStub.callsFake(() => {
           throw new Error();
         });
-        (client as any).logger = new NoopLogger();
+        untypedClient.logger = new NoopLogger();
         expect(() => client.loadProto()).to.throws(
           InvalidProtoDefinitionException,
         );
+        getPackageDefinitionStub.restore();
       });
     });
   });
   describe('close', () => {
     it('should call "close" method', () => {
       const grpcClient = { close: sinon.spy() };
-      (client as any).grpcClients[0] = grpcClient;
+      untypedClient.clients.set('test', grpcClient);
+      untypedClient.grpcClients[0] = {};
 
       client.close();
       expect(grpcClient.close.called).to.be.true;
+      expect(untypedClient.clients.size).to.be.eq(0);
+      expect(untypedClient.grpcClients.length).to.be.eq(0);
     });
   });
 
   describe('publish', () => {
     it('should throw exception', () => {
-      expect(() => client['publish'](null, null)).to.throws(Error);
+      expect(() => client['publish'](null, null!)).to.throws(Error);
     });
   });
 
@@ -387,7 +504,7 @@ describe('ClientGrpcProxy', () => {
     it('should return root package in case package name is not defined', () => {
       const root = {};
 
-      expect(client.lookupPackage(root, undefined)).to.be.equal(root);
+      expect(client.lookupPackage(root, undefined!)).to.be.equal(root);
       expect(client.lookupPackage(root, '')).to.be.equal(root);
     });
   });
diff --git a/packages/microservices/test/client/client-kafka.spec.ts b/packages/microservices/test/client/client-kafka.spec.ts
index d5af20a8c..773a98590 100644
--- a/packages/microservices/test/client/client-kafka.spec.ts
+++ b/packages/microservices/test/client/client-kafka.spec.ts
@@ -1,4 +1,6 @@
 import { expect } from 'chai';
+import { Producer } from 'kafkajs';
+import { Observable } from 'rxjs';
 import * as sinon from 'sinon';
 import { ClientKafka } from '../../client/client-kafka';
 import { NO_MESSAGE_HANDLER } from '../../constants';
@@ -11,7 +13,6 @@ import {
 } from '../../external/kafka.interface';
 
 describe('ClientKafka', () => {
-  // static
   const topic = 'test.topic';
   const partition = 0;
   const replyTopic = 'test.topic.reply';
@@ -22,8 +23,9 @@ describe('ClientKafka', () => {
   const timestamp = new Date().toISOString();
   const attributes = 1;
   const messageValue = 'test-message';
+  const heartbeat = async () => {};
+  const pause = () => () => {};
 
-  // message
   const message: KafkaMessage = {
     key: Buffer.from(key),
     offset,
@@ -33,7 +35,6 @@ describe('ClientKafka', () => {
     attributes,
   };
 
-  // deserialized message
   const deserializedMessage: any = {
     key,
     offset,
@@ -45,7 +46,6 @@ describe('ClientKafka', () => {
     partition,
   };
 
-  // payloads
   const payload: EachMessagePayload = {
     topic,
     partition,
@@ -57,6 +57,8 @@ describe('ClientKafka', () => {
       },
       message,
     ),
+    heartbeat,
+    pause,
   };
 
   const payloadDisposed: EachMessagePayload = {
@@ -72,9 +74,11 @@ describe('ClientKafka', () => {
       message,
       {
         size: 0,
-        value: { test: true },
+        value: Buffer.from(JSON.stringify({ test: true })),
       },
     ),
+    heartbeat,
+    pause,
   };
 
   const payloadError: EachMessagePayload = {
@@ -93,6 +97,8 @@ describe('ClientKafka', () => {
         value: null,
       },
     ),
+    heartbeat,
+    pause,
   };
 
   const payloadWithoutCorrelation: EachMessagePayload = {
@@ -104,6 +110,8 @@ describe('ClientKafka', () => {
       },
       message,
     ),
+    heartbeat,
+    pause,
   };
 
   // deserialized payload
@@ -118,6 +126,8 @@ describe('ClientKafka', () => {
       },
       deserializedMessage,
     ),
+    heartbeat,
+    pause,
   };
 
   const deserializedPayloadDisposed: EachMessagePayload = {
@@ -136,27 +146,12 @@ describe('ClientKafka', () => {
         value: { test: true },
       },
     ),
-  };
-
-  const deserializedPayloadError: EachMessagePayload = {
-    topic,
-    partition,
-    message: Object.assign(
-      {
-        headers: {
-          [KafkaHeaders.CORRELATION_ID]: correlationId,
-          [KafkaHeaders.NEST_ERR]: NO_MESSAGE_HANDLER,
-        },
-      },
-      deserializedMessage,
-      {
-        size: 0,
-        value: null,
-      },
-    ),
+    heartbeat,
+    pause,
   };
 
   let client: ClientKafka;
+  let untypedClient: any;
   let callback: sinon.SinonSpy;
   let connect: sinon.SinonSpy;
   let subscribe: sinon.SinonSpy;
@@ -166,10 +161,12 @@ describe('ClientKafka', () => {
   let consumerStub: sinon.SinonStub;
   let producerStub: sinon.SinonStub;
   let createClientStub: sinon.SinonStub;
-  let kafkaClient;
+  let kafkaClient: any;
 
   beforeEach(() => {
     client = new ClientKafka({});
+    untypedClient = client as any;
+
     callback = sinon.spy();
     connect = sinon.spy();
     subscribe = sinon.spy();
@@ -184,6 +181,21 @@ describe('ClientKafka', () => {
         run,
         events: {
           GROUP_JOIN: 'consumer.group_join',
+          HEARTBEAT: 'consumer.heartbeat',
+          COMMIT_OFFSETS: 'consumer.commit_offsets',
+          FETCH_START: 'consumer.fetch_start',
+          FETCH: 'consumer.fetch',
+          START_BATCH_PROCESS: 'consumer.start_batch_process',
+          END_BATCH_PROCESS: 'consumer.end_batch_process',
+          CONNECT: 'consumer.connect',
+          DISCONNECT: 'consumer.disconnect',
+          STOP: 'consumer.stop',
+          CRASH: 'consumer.crash',
+          REBALANCING: 'consumer.rebalancing',
+          RECEIVED_UNSUBSCRIBED_TOPICS: 'consumer.received_unsubscribed_topics',
+          REQUEST: 'consumer.network.request',
+          REQUEST_TIMEOUT: 'consumer.network.request_timeout',
+          REQUEST_QUEUE_SIZE: 'consumer.network.request_queue_size',
         },
         on,
       };
@@ -192,6 +204,14 @@ describe('ClientKafka', () => {
       return {
         connect,
         send,
+        events: {
+          CONNECT: 'producer.connect',
+          DISCONNECT: 'producer.disconnect',
+          REQUEST: 'producer.network.request',
+          REQUEST_TIMEOUT: 'producer.network.request_timeout',
+          REQUEST_QUEUE_SIZE: 'producer.network.request_queue_size',
+        },
+        on,
       };
     });
     kafkaClient = {
@@ -258,66 +278,111 @@ describe('ClientKafka', () => {
     const consumer = { disconnect: sinon.stub().resolves() };
     const producer = { disconnect: sinon.stub().resolves() };
     beforeEach(() => {
-      (client as any).consumer = consumer;
-      (client as any).producer = producer;
+      untypedClient._consumer = consumer;
+      untypedClient._producer = producer;
     });
     it('should close server', async () => {
       await client.close();
 
       expect(consumer.disconnect.calledOnce).to.be.true;
       expect(producer.disconnect.calledOnce).to.be.true;
-      expect((client as any).consumer).to.be.null;
-      expect((client as any).producer).to.be.null;
-      expect((client as any).client).to.be.null;
+      expect(untypedClient._consumer).to.be.null;
+      expect(untypedClient._producer).to.be.null;
+      expect(untypedClient.client).to.be.null;
     });
   });
 
   describe('connect', () => {
     let consumerAssignmentsStub: sinon.SinonStub;
     let bindTopicsStub: sinon.SinonStub;
-    // let handleErrorsSpy: sinon.SinonSpy;
 
-    beforeEach(() => {
-      consumerAssignmentsStub = sinon.stub(
-        client as any,
-        'consumerAssignments',
-      );
-      bindTopicsStub = sinon
-        .stub(client, 'bindTopics')
-        .callsFake(async () => {});
-    });
+    describe('consumer and producer', () => {
+      beforeEach(() => {
+        consumerAssignmentsStub = sinon.stub(
+          client as any,
+          'consumerAssignments',
+        );
+        bindTopicsStub = sinon
+          .stub(client, 'bindTopics')
+          .callsFake(async () => {});
+      });
 
-    it('should expect the connection to be created', async () => {
-      const connection = await client.connect();
+      it('should expect the connection to be created', async () => {
+        const connection = await client.connect();
+
+        expect(createClientStub.calledOnce).to.be.true;
+        expect(producerStub.calledOnce).to.be.true;
+        expect(consumerStub.calledOnce).to.be.true;
+        expect(on.called).to.be.true;
+        expect(client['consumerAssignments']).to.be.empty;
+        expect(connect.calledTwice).to.be.true;
+        expect(bindTopicsStub.calledOnce).to.be.true;
+        expect(connection).to.deep.equal(producerStub());
+      });
+
+      it('should expect the connection to be reused', async () => {
+        untypedClient.initialized = Promise.resolve({});
 
-      expect(createClientStub.calledOnce).to.be.true;
-      expect(producerStub.calledOnce).to.be.true;
+        await client.connect();
 
-      expect(consumerStub.calledOnce).to.be.true;
+        expect(createClientStub.calledOnce).to.be.false;
+        expect(producerStub.calledOnce).to.be.false;
+        expect(consumerStub.calledOnce).to.be.false;
 
-      expect(on.calledOnce).to.be.true;
-      expect(client['consumerAssignments']).to.be.empty;
+        expect(on.calledOnce).to.be.false;
+        expect(client['consumerAssignments']).to.be.empty;
 
-      expect(connect.calledTwice).to.be.true;
+        expect(connect.calledTwice).to.be.false;
 
-      expect(bindTopicsStub.calledOnce).to.be.true;
-      expect(connection).to.deep.equal(producerStub());
+        expect(bindTopicsStub.calledOnce).to.be.false;
+      });
     });
 
-    it('should expect the connection to be reused', async () => {
-      (client as any).client = kafkaClient;
-      await client.connect();
+    describe('producer only mode', () => {
+      beforeEach(() => {
+        consumerAssignmentsStub = sinon.stub(
+          client as any,
+          'consumerAssignments',
+        );
+        bindTopicsStub = sinon
+          .stub(client, 'bindTopics')
+          .callsFake(async () => {});
+        client['producerOnlyMode'] = true;
+      });
 
-      expect(createClientStub.calledOnce).to.be.false;
-      expect(producerStub.calledOnce).to.be.false;
-      expect(consumerStub.calledOnce).to.be.false;
+      it('should expect the connection to be created', async () => {
+        const connection = await client.connect();
 
-      expect(on.calledOnce).to.be.false;
-      expect(client['consumerAssignments']).to.be.empty;
+        expect(createClientStub.calledOnce).to.be.true;
+        expect(producerStub.calledOnce).to.be.true;
 
-      expect(connect.calledTwice).to.be.false;
+        expect(consumerStub.calledOnce).to.be.false;
+
+        expect(on.calledOnce).to.be.false;
+        expect(client['consumerAssignments']).to.be.empty;
+
+        expect(connect.calledOnce).to.be.true;
+
+        expect(bindTopicsStub.calledOnce).to.be.false;
+        expect(connection).to.deep.equal(producerStub());
+      });
 
-      expect(bindTopicsStub.calledOnce).to.be.false;
+      it('should expect the connection to be reused', async () => {
+        untypedClient.initialized = Promise.resolve({});
+
+        await client.connect();
+
+        expect(createClientStub.calledOnce).to.be.false;
+        expect(producerStub.calledOnce).to.be.false;
+        expect(consumerStub.calledOnce).to.be.false;
+
+        expect(on.calledOnce).to.be.false;
+        expect(client['consumerAssignments']).to.be.empty;
+
+        expect(connect.calledTwice).to.be.false;
+
+        expect(bindTopicsStub.calledOnce).to.be.false;
+      });
     });
   });
 
@@ -353,36 +418,64 @@ describe('ClientKafka', () => {
         },
       );
     });
+
+    it('should not update consumer assignments if there are no partitions assigned to consumer', async () => {
+      await client.connect();
+
+      const consumerAssignments: ConsumerGroupJoinEvent = {
+        id: 'id',
+        type: 'type',
+        timestamp: 1234567890,
+        payload: {
+          duration: 20,
+          groupId: 'group-id',
+          isLeader: true,
+          leaderId: 'member-1',
+          groupProtocol: 'RoundRobin',
+          memberId: 'member-1',
+          memberAssignment: {
+            'topic-a': [],
+            'topic-b': [3, 4, 5],
+          },
+        },
+      };
+
+      client['setConsumerAssignments'](consumerAssignments);
+
+      expect(client['consumerAssignments']).to.deep.eq({
+        'topic-b': 3,
+      });
+    });
   });
 
   describe('bindTopics', () => {
     it('should bind topics from response patterns', async () => {
-      (client as any).responsePatterns = [replyTopic];
-      (client as any).consumer = kafkaClient.consumer();
+      untypedClient.responsePatterns = [replyTopic];
+      untypedClient._consumer = kafkaClient.consumer();
 
       await client.bindTopics();
 
       expect(subscribe.calledOnce).to.be.true;
       expect(
         subscribe.calledWith({
-          topic: replyTopic,
+          topics: [replyTopic],
         }),
       ).to.be.true;
       expect(run.calledOnce).to.be.true;
     });
 
     it('should bind topics from response patterns with options', async () => {
-      (client as any).responsePatterns = [replyTopic];
-      (client as any).consumer = kafkaClient.consumer();
-      (client as any).options.subscribe = {};
-      (client as any).options.subscribe.fromBeginning = true;
+      untypedClient.responsePatterns = [replyTopic];
+      untypedClient._consumer = kafkaClient.consumer();
+      untypedClient.options.subscribe = {};
+      untypedClient.options.subscribe.fromBeginning = true;
 
       await client.bindTopics();
 
       expect(subscribe.calledOnce).to.be.true;
       expect(
         subscribe.calledWith({
-          topic: replyTopic,
+          topics: [replyTopic],
           fromBeginning: true,
         }),
       ).to.be.true;
@@ -424,7 +517,7 @@ describe('ClientKafka', () => {
         expect(
           callback.calledWith({
             isDisposed: true,
-            response: payloadDisposed.message.value,
+            response: deserializedPayloadDisposed.message.value,
             err: undefined,
           }),
         ).to.be.true;
@@ -479,6 +572,77 @@ describe('ClientKafka', () => {
     });
   });
 
+  describe('emitBatch', () => {
+    it(`should return an observable stream`, () => {
+      const stream$ = client.emitBatch(
+        {},
+        {
+          messages: [],
+        },
+      );
+      expect(stream$ instanceof Observable).to.be.true;
+    });
+
+    it(`should call "connect" immediately`, () => {
+      const connectSpy = sinon.spy(client, 'connect');
+      client.emitBatch(
+        {},
+        {
+          messages: [],
+        },
+      );
+      expect(connectSpy.calledOnce).to.be.true;
+    });
+
+    describe('when "connect" throws', () => {
+      it('should return Observable with error', () => {
+        sinon.stub(client, 'connect').callsFake(() => {
+          throw new Error();
+        });
+
+        const stream$ = client.emitBatch(
+          {},
+          {
+            messages: [],
+          },
+        );
+
+        stream$.subscribe({
+          next: () => {},
+          error: err => {
+            expect(err).to.be.instanceof(Error);
+          },
+        });
+      });
+    });
+
+    describe('when is connected', () => {
+      beforeEach(() => {
+        sinon
+          .stub(client, 'connect')
+          .callsFake(() => Promise.resolve({} as Producer));
+      });
+
+      it(`should call dispatchBatchEvent`, () => {
+        const pattern = { test: 3 };
+        const data = { messages: [] };
+        const dispatchBatchEventSpy = sinon
+          .stub()
+          .callsFake(() => Promise.resolve(true));
+        const stream$ = client.emitBatch(pattern, data);
+        client['dispatchBatchEvent'] = dispatchBatchEventSpy;
+        stream$.subscribe(() => {
+          expect(dispatchBatchEventSpy.calledOnce).to.be.true;
+        });
+      });
+    });
+
+    it('should return Observable with error', () => {
+      const err$ = client.emitBatch(null, null!);
+      expect(err$).to.be.instanceOf(Observable);
+    });
+  });
+
   describe('dispatchEvent', () => {
     const eventMessage = {
       id: undefined,
@@ -497,7 +661,7 @@ describe('ClientKafka', () => {
     });
 
     it('should publish packet', async () => {
-      sinon.stub(client as any, 'producer').value({
+      sinon.stub(client as any, '_producer').value({
         send: sendSpy,
       });
 
@@ -556,7 +720,7 @@ describe('ClientKafka', () => {
 
     it('should throw error when the topic is not being consumed', () => {
       client['consumerAssignments'] = {
-        [topic]: undefined,
+        [topic]: undefined!,
       };
 
       expect(() => client['getReplyTopicPartition'](replyTopic)).to.throw(
@@ -566,13 +730,14 @@ describe('ClientKafka', () => {
   });
 
   describe('publish', () => {
+    const waitForNextTick = async () =>
+      await new Promise(resolve => process.nextTick(resolve));
     const readPacket = {
       pattern: topic,
       data: messageValue,
     };
 
     let assignPacketIdStub: sinon.SinonStub;
-
     let normalizePatternSpy: sinon.SinonSpy;
     let getResponsePatternNameSpy: sinon.SinonSpy;
     let getReplyTopicPartitionSpy: sinon.SinonSpy;
@@ -580,7 +745,6 @@ describe('ClientKafka', () => {
     let sendSpy: sinon.SinonSpy;
 
     beforeEach(() => {
-      // spy
       normalizePatternSpy = sinon.spy(client as any, 'normalizePattern');
       getResponsePatternNameSpy = sinon.spy(
         client as any,
@@ -590,57 +754,72 @@ describe('ClientKafka', () => {
         client as any,
         'getReplyTopicPartition',
       );
-      routingMapSetSpy = sinon.spy((client as any).routingMap, 'set');
+      routingMapSetSpy = sinon.spy(untypedClient.routingMap, 'set');
       sendSpy = sinon.spy(() => Promise.resolve());
 
-      // stub
       assignPacketIdStub = sinon
         .stub(client as any, 'assignPacketId')
         .callsFake(packet =>
-          Object.assign(packet, {
+          Object.assign(packet as object, {
             id: correlationId,
           }),
         );
 
-      sinon.stub(client as any, 'producer').value({
+      sinon.stub(client as any, '_producer').value({
         send: sendSpy,
       });
 
-      // set
       client['consumerAssignments'] = {
         [replyTopic]: parseFloat(replyPartition),
       };
     });
 
     it('should assign a packet id', async () => {
-      await client['publish'](readPacket, callback);
+      client['publish'](readPacket, callback);
+
+      await waitForNextTick();
+
       expect(assignPacketIdStub.calledWith(readPacket)).to.be.true;
     });
 
     it('should normalize the pattern', async () => {
-      await client['publish'](readPacket, callback);
+      client['publish'](readPacket, callback);
+
+      await waitForNextTick();
+
       expect(normalizePatternSpy.calledWith(topic)).to.be.true;
     });
 
     it('should get the reply pattern', async () => {
-      await client['publish'](readPacket, callback);
+      client['publish'](readPacket, callback);
+
+      await waitForNextTick();
+
       expect(getResponsePatternNameSpy.calledWith(topic)).to.be.true;
     });
 
     it('should get the reply partition', async () => {
-      await client['publish'](readPacket, callback);
+      client['publish'](readPacket, callback);
+
+      await waitForNextTick();
+
       expect(getReplyTopicPartitionSpy.calledWith(replyTopic)).to.be.true;
     });
 
     it('should add the callback to the routing map', async () => {
-      await client['publish'](readPacket, callback);
+      client['publish'](readPacket, callback);
+
+      await waitForNextTick();
+
       expect(routingMapSetSpy.calledOnce).to.be.true;
       expect(routingMapSetSpy.args[0][0]).to.eq(correlationId);
       expect(routingMapSetSpy.args[0][1]).to.eq(callback);
     });
 
     it('should send the message with headers', async () => {
-      await client['publish'](readPacket, callback);
+      client['publish'](readPacket, callback);
+
+      await waitForNextTick();
 
       expect(sendSpy.calledOnce).to.be.true;
       expect(sendSpy.args[0][0].topic).to.eq(topic);
@@ -659,6 +838,15 @@ describe('ClientKafka', () => {
       );
     });
 
+    it('should remove callback from routing map when unsubscribe', async () => {
+      client['publish'](readPacket, callback)();
+
+      await waitForNextTick();
+
+      expect(client['routingMap'].has(correlationId)).to.be.false;
+      expect(client['routingMap'].size).to.eq(0);
+    });
+
     describe('on error', () => {
       let clientProducerStub: sinon.SinonStub;
       let sendStub: sinon.SinonStub;
@@ -668,7 +856,7 @@ describe('ClientKafka', () => {
           throw new Error();
         });
 
-        clientProducerStub = sinon.stub(client as any, 'producer').value({
+        clientProducerStub = sinon.stub(client as any, '_producer').value({
           send: sendStub,
         });
       });
@@ -678,10 +866,12 @@ describe('ClientKafka', () => {
       });
 
       it('should call callback', async () => {
-        await client['publish'](readPacket, callback);
-
-        expect(callback.called).to.be.true;
-        expect(callback.getCall(0).args[0].err).to.be.instanceof(Error);
+        /* eslint-disable-next-line no-async-promise-executor */
+        return new Promise(async resolve => {
+          return client['publish'](readPacket, ({ err }) => resolve(err));
+        }).then(err => {
+          expect(err).to.be.instanceof(Error);
+        });
       });
     });
 
@@ -703,7 +893,7 @@ describe('ClientKafka', () => {
           .stub(client as any, 'getReplyTopicPartition')
           .callsFake(() => '0');
 
-        subscription = await client['publish'](readPacket, callback);
+        subscription = client['publish'](readPacket, callback);
         subscription(payloadDisposed);
       });
 
diff --git a/packages/microservices/test/client/client-mqtt.spec.ts b/packages/microservices/test/client/client-mqtt.spec.ts
index a5dc9032f..35845b668 100644
--- a/packages/microservices/test/client/client-mqtt.spec.ts
+++ b/packages/microservices/test/client/client-mqtt.spec.ts
@@ -2,13 +2,14 @@ import { expect } from 'chai';
 import { EMPTY } from 'rxjs';
 import * as sinon from 'sinon';
 import { ClientMqtt } from '../../client/client-mqtt';
-import { ERROR_EVENT } from '../../constants';
+import { MqttEventsMap } from '../../events/mqtt.events';
 import { ReadPacket } from '../../interfaces';
 import { MqttRecord } from '../../record-builders';
 
 describe('ClientMqtt', () => {
   const test = 'test';
   let client: ClientMqtt = new ClientMqtt({});
+  let untypedClient = client as any;
 
   describe('getRequestPattern', () => {
     it(`should leave pattern as it is`, () => {
@@ -31,11 +32,13 @@ describe('ClientMqtt', () => {
       unsubscribeSpy: sinon.SinonSpy,
       connectSpy: sinon.SinonStub,
       assignStub: sinon.SinonStub,
-      mqttClient;
+      mqttClient: any;
 
     const id = '1';
     beforeEach(() => {
       client = new ClientMqtt({});
+      untypedClient = client as any;
+
       msg = { pattern, data: 'data' };
       subscribeSpy = sinon.spy((name, fn) => fn());
       publishSpy = sinon.spy();
@@ -51,26 +54,26 @@ describe('ClientMqtt', () => {
         publish: publishSpy,
         addListener: () => ({}),
       };
-      (client as any).mqttClient = mqttClient;
+      untypedClient.mqttClient = mqttClient;
       connectSpy = sinon.stub(client, 'connect');
       assignStub = sinon
         .stub(client, 'assignPacketId' as any)
-        .callsFake(packet => Object.assign(packet, { id }));
+        .callsFake(packet => Object.assign(packet as object, { id }));
     });
     afterEach(() => {
       connectSpy.restore();
       assignStub.restore();
     });
     it('should subscribe to response pattern name', async () => {
-      await client['publish'](msg, () => {});
+      client['publish'](msg, () => {});
       expect(subscribeSpy.calledWith(`${pattern}/reply`)).to.be.true;
     });
     it('should publish stringified message to request pattern name', async () => {
-      await client['publish'](msg, () => {});
+      client['publish'](msg, () => {});
       expect(publishSpy.calledWith(pattern, JSON.stringify(msg))).to.be.true;
     });
     it('should add callback to routing map', async () => {
-      await client['publish'](msg, () => {});
+      client['publish'](msg, () => {});
       expect(client['routingMap'].has(id)).to.be.true;
     });
     describe('on error', () => {
@@ -100,7 +103,7 @@ describe('ClientMqtt', () => {
         getResponsePatternStub = sinon
           .stub(client, 'getResponsePattern')
           .callsFake(() => channel);
-        subscription = await client['publish'](msg, callback);
+        subscription = client['publish'](msg, callback);
         subscription(channel, JSON.stringify({ isDisposed: true, id }));
       });
       afterEach(() => {
@@ -110,13 +113,13 @@ describe('ClientMqtt', () => {
       it('should unsubscribe to response pattern name', () => {
         expect(unsubscribeSpy.calledWith(channel)).to.be.true;
       });
-      it('should remove callback from routin map', () => {
+      it('should remove callback from routing map', () => {
         expect(client['routingMap'].has(id)).to.be.false;
       });
     });
     describe('headers', () => {
       it('should not generate headers if none are configured', async () => {
-        await client['publish'](msg, () => {});
+        client['publish'](msg, () => {});
         expect(publishSpy.getCall(0).args[2]).to.be.undefined;
       });
       it('should send packet headers', async () => {
@@ -125,21 +128,21 @@ describe('ClientMqtt', () => {
           properties: { userProperties: requestHeaders },
         });
 
-        await client['publish'](msg, () => {});
+        client['publish'](msg, () => {});
         expect(publishSpy.getCall(0).args[2].properties.userProperties).to.eql(
           requestHeaders,
         );
       });
       it('should combine packet and static headers', async () => {
         const staticHeaders = { 'client-id': 'some-client-id' };
-        (client as any).options.userProperties = staticHeaders;
+        untypedClient.options.userProperties = staticHeaders;
 
         const requestHeaders = { '1': '123' };
         msg.data = new MqttRecord('data', {
           properties: { userProperties: requestHeaders },
         });
 
-        await client['publish'](msg, () => {});
+        client['publish'](msg, () => {});
         expect(publishSpy.getCall(0).args[2].properties.userProperties).to.eql({
           ...staticHeaders,
           ...requestHeaders,
@@ -147,14 +150,14 @@ describe('ClientMqtt', () => {
       });
       it('should prefer packet headers over static headers', async () => {
         const staticHeaders = { 'client-id': 'some-client-id' };
-        (client as any).options.headers = staticHeaders;
+        untypedClient.options.headers = staticHeaders;
 
         const requestHeaders = { 'client-id': 'override-client-id' };
         msg.data = new MqttRecord('data', {
           properties: { userProperties: requestHeaders },
         });
 
-        await client['publish'](msg, () => {});
+        client['publish'](msg, () => {});
         expect(publishSpy.getCall(0).args[2].properties.userProperties).to.eql(
           requestHeaders,
         );
@@ -231,21 +234,21 @@ describe('ClientMqtt', () => {
     let endSpy: sinon.SinonSpy;
     beforeEach(() => {
       endSpy = sinon.spy();
-      (client as any).mqttClient = { end: endSpy };
+      untypedClient.mqttClient = { endAsync: endSpy };
     });
-    it('should close "pub" when it is not null', () => {
-      client.close();
+    it('should close "pub" when it is not null', async () => {
+      await client.close();
       expect(endSpy.called).to.be.true;
     });
-    it('should not close "pub" when it is null', () => {
-      (client as any).mqttClient = null;
-      client.close();
+    it('should not close "pub" when it is null', async () => {
+      untypedClient.mqttClient = null;
+      await client.close();
       expect(endSpy.called).to.be.false;
     });
   });
   describe('connect', () => {
     let createClientStub: sinon.SinonStub;
-    let handleErrorsSpy: sinon.SinonSpy;
+    let registerErrorListenerSpy: sinon.SinonSpy;
     let connect$Stub: sinon.SinonStub;
     let mergeCloseEvent: sinon.SinonStub;
 
@@ -255,9 +258,10 @@ describe('ClientMqtt', () => {
           ({
             addListener: () => ({}),
             removeListener: () => ({}),
-          } as any),
+            on: () => ({}),
+          }) as any,
       );
-      handleErrorsSpy = sinon.spy(client, 'handleError');
+      registerErrorListenerSpy = sinon.spy(client, 'registerErrorListener');
       connect$Stub = sinon.stub(client, 'connect$' as any).callsFake(() => ({
         subscribe: ({ complete }) => complete(),
         pipe() {
@@ -270,7 +274,7 @@ describe('ClientMqtt', () => {
     });
     afterEach(() => {
       createClientStub.restore();
-      handleErrorsSpy.restore();
+      registerErrorListenerSpy.restore();
       connect$Stub.restore();
       mergeCloseEvent.restore();
     });
@@ -279,8 +283,8 @@ describe('ClientMqtt', () => {
         client['mqttClient'] = null;
         await client.connect();
       });
-      it('should call "handleError" once', async () => {
-        expect(handleErrorsSpy.called).to.be.true;
+      it('should call "registerErrorListener" once', async () => {
+        expect(registerErrorListenerSpy.called).to.be.true;
       });
       it('should call "createClient" once', async () => {
         expect(createClientStub.called).to.be.true;
@@ -296,8 +300,8 @@ describe('ClientMqtt', () => {
       it('should not call "createClient"', () => {
         expect(createClientStub.called).to.be.false;
       });
-      it('should not call "handleError"', () => {
-        expect(handleErrorsSpy.called).to.be.false;
+      it('should not call "registerErrorListener"', () => {
+        expect(registerErrorListenerSpy.called).to.be.false;
       });
       it('should not call "connect$"', () => {
         expect(connect$Stub.called).to.be.false;
@@ -311,19 +315,59 @@ describe('ClientMqtt', () => {
         on: (ev, callback) => callback(error),
         off: () => ({}),
       };
-      client.mergeCloseEvent(instance as any, EMPTY).subscribe({
+      client.mergeCloseEvent(instance, EMPTY).subscribe({
         error: (err: any) => expect(err).to.be.eql(error),
       });
     });
   });
-  describe('handleError', () => {
+  describe('registerErrorListener', () => {
     it('should bind error event handler', () => {
       const callback = sinon.stub().callsFake((_, fn) => fn({ code: 'test' }));
       const emitter = {
-        addListener: callback,
+        on: callback,
+      };
+      client.registerErrorListener(emitter as any);
+      expect(callback.getCall(0).args[0]).to.be.eql(MqttEventsMap.ERROR);
+    });
+  });
+  describe('registerConnectListener', () => {
+    it('should bind connect event handler', () => {
+      const callback = sinon.stub().callsFake((_, fn) => fn({ code: 'test' }));
+      const emitter = {
+        on: callback,
+      };
+      client.registerConnectListener(emitter as any);
+      expect(callback.getCall(0).args[0]).to.be.eql(MqttEventsMap.CONNECT);
+    });
+  });
+  describe('registerDisconnectListener', () => {
+    it('should bind disconnect event handler', () => {
+      const callback = sinon.stub().callsFake((_, fn) => fn({ code: 'test' }));
+      const emitter = {
+        on: callback,
       };
-      client.handleError(emitter as any);
-      expect(callback.getCall(0).args[0]).to.be.eql(ERROR_EVENT);
+      client.registerDisconnectListener(emitter as any);
+      expect(callback.getCall(0).args[0]).to.be.eql(MqttEventsMap.DISCONNECT);
+    });
+  });
+  describe('registerOfflineListener', () => {
+    it('should bind offline event handler', () => {
+      const callback = sinon.stub().callsFake((_, fn) => fn({ code: 'test' }));
+      const emitter = {
+        on: callback,
+      };
+      client.registerOfflineListener(emitter as any);
+      expect(callback.getCall(0).args[0]).to.be.eql(MqttEventsMap.OFFLINE);
+    });
+  });
+  describe('registerCloseListener', () => {
+    it('should bind close event handler', () => {
+      const callback = sinon.stub().callsFake((_, fn) => fn({ code: 'test' }));
+      const emitter = {
+        on: callback,
+      };
+      client.registerCloseListener(emitter as any);
+      expect(callback.getCall(0).args[0]).to.be.eql(MqttEventsMap.CLOSE);
     });
   });
   describe('dispatchEvent', () => {
@@ -332,12 +376,14 @@ describe('ClientMqtt', () => {
 
     beforeEach(() => {
       client = new ClientMqtt({});
+      untypedClient = client as any;
+
       msg = { pattern: 'pattern', data: 'data' };
       publishStub = sinon.stub();
       mqttClient = {
         publish: publishStub,
       };
-      (client as any).mqttClient = mqttClient;
+      untypedClient.mqttClient = mqttClient;
     });
 
     it('should publish packet', async () => {
@@ -373,7 +419,7 @@ describe('ClientMqtt', () => {
       it('should combine packet and static headers', async () => {
         publishStub.callsFake((a, b, c, d) => d());
         const staticHeaders = { 'client-id': 'some-client-id' };
-        (client as any).options.userProperties = staticHeaders;
+        untypedClient.options.userProperties = staticHeaders;
 
         const requestHeaders = { '1': '123' };
         msg.data = new MqttRecord('data', {
@@ -391,7 +437,7 @@ describe('ClientMqtt', () => {
       it('should prefer packet headers over static headers', async () => {
         publishStub.callsFake((a, b, c, d) => d());
         const staticHeaders = { 'client-id': 'some-client-id' };
-        (client as any).options.headers = staticHeaders;
+        untypedClient.options.headers = staticHeaders;
 
         const requestHeaders = { 'client-id': 'override-client-id' };
         msg.data = new MqttRecord('data', {
diff --git a/packages/microservices/test/client/client-nats.spec.ts b/packages/microservices/test/client/client-nats.spec.ts
index df917b4b6..c818351fe 100644
--- a/packages/microservices/test/client/client-nats.spec.ts
+++ b/packages/microservices/test/client/client-nats.spec.ts
@@ -7,6 +7,7 @@ import { NatsRecord } from '../../record-builders';
 
 describe('ClientNats', () => {
   let client: ClientNats;
+  let untypedClient: any;
 
   describe('publish', () => {
     let msg: ReadPacket;
@@ -24,6 +25,8 @@ describe('ClientNats', () => {
 
     beforeEach(() => {
       client = new ClientNats({});
+      untypedClient = client as any;
+
       msg = { pattern, data: 'data' };
       unsubscribeSpy = sinon.spy();
       subscription = {
@@ -39,14 +42,14 @@ describe('ClientNats', () => {
         addListener: () => ({}),
         publish: publishSpy,
       };
-      (client as any).natsClient = natsClient;
+      untypedClient.natsClient = natsClient;
 
       connectSpy = sinon.stub(client, 'connect').callsFake(async () => {
-        (client as any).natsClient = natsClient;
+        untypedClient.natsClient = natsClient;
       });
       createClient = sinon
         .stub(client, 'createClient')
-        .callsFake(() => client as any);
+        .callsFake(() => untypedClient);
     });
     afterEach(() => {
       connectSpy.restore();
@@ -85,7 +88,7 @@ describe('ClientNats', () => {
         callback = sinon.spy();
         assignStub = sinon
           .stub(client, 'assignPacketId' as any)
-          .callsFake(packet => Object.assign(packet, { id }));
+          .callsFake(packet => Object.assign(packet as object, { id }));
 
         subscription = client['publish'](msg, callback);
         subscription();
@@ -117,7 +120,7 @@ describe('ClientNats', () => {
       });
       it('should combine packet and static headers', () => {
         const staticHeaders = { 'client-id': 'some-client-id' };
-        (client as any).options.headers = staticHeaders;
+        untypedClient.options.headers = staticHeaders;
 
         const requestHeaders = createHeaders();
         requestHeaders.set('1', '123');
@@ -132,7 +135,7 @@ describe('ClientNats', () => {
 
       it('should prefer packet headers over static headers', () => {
         const staticHeaders = { 'client-id': 'some-client-id' };
-        (client as any).options.headers = staticHeaders;
+        untypedClient.options.headers = staticHeaders;
 
         const requestHeaders = createHeaders();
         requestHeaders.set('client-id', 'override-client-id');
@@ -223,14 +226,15 @@ describe('ClientNats', () => {
   });
   describe('close', () => {
     let natsClose: sinon.SinonSpy;
-    let natsClient;
+    let natsClient: any;
+
     beforeEach(() => {
       natsClose = sinon.spy();
       natsClient = { close: natsClose };
-      (client as any).natsClient = natsClient;
+      untypedClient.natsClient = natsClient;
     });
-    it('should close "natsClient" when it is not null', () => {
-      client.close();
+    it('should close "natsClient" when it is not null', async () => {
+      await client.close();
       expect(natsClose.called).to.be.true;
     });
   });
@@ -241,7 +245,7 @@ describe('ClientNats', () => {
     beforeEach(async () => {
       createClientSpy = sinon
         .stub(client, 'createClient')
-        .callsFake(() => ({} as any));
+        .callsFake(() => Promise.resolve({}));
       handleStatusUpdatesSpy = sinon.spy(client, 'handleStatusUpdates');
 
       await client.connect();
@@ -253,6 +257,7 @@ describe('ClientNats', () => {
     describe('when is not connected', () => {
       beforeEach(async () => {
         client['natsClient'] = null;
+        client['connectionPromise'] = null;
         await client.connect();
       });
       it('should call "handleStatusUpdatesSpy" once', async () => {
@@ -282,12 +287,12 @@ describe('ClientNats', () => {
           [Symbol.asyncIterator]: [],
         }),
       };
-      client.handleStatusUpdates(clientMock as any);
+      void client.handleStatusUpdates(clientMock as any);
       expect(clientMock.status.called).to.be.true;
     });
 
     it('should log "disconnect" and "error" statuses as "errors"', async () => {
-      const logErrorSpy = sinon.spy((client as any).logger, 'error');
+      const logErrorSpy = sinon.spy(untypedClient.logger, 'error');
       const clientMock = {
         status: sinon.stub().returns({
           async *[Symbol.asyncIterator]() {
@@ -308,7 +313,7 @@ describe('ClientNats', () => {
       );
     });
     it('should log other statuses as "logs"', async () => {
-      const logSpy = sinon.spy((client as any).logger, 'log');
+      const logSpy = sinon.spy(untypedClient.logger, 'log');
       const clientMock = {
         status: sinon.stub().returns({
           async *[Symbol.asyncIterator]() {
@@ -333,6 +338,8 @@ describe('ClientNats', () => {
 
     beforeEach(() => {
       client = new ClientNats({});
+      untypedClient = client as any;
+
       msg = { pattern: 'pattern', data: 'data' };
       subscribeStub = sinon
         .stub()
@@ -341,7 +348,7 @@ describe('ClientNats', () => {
         publish: sinon.spy(),
         subscribe: subscribeStub,
       };
-      (client as any).natsClient = natsClient;
+      untypedClient.natsClient = natsClient;
     });
 
     it('should publish packet', async () => {
@@ -354,37 +361,37 @@ describe('ClientNats', () => {
       subscribeStub.callsFake((channel, options) =>
         options.callback(new Error()),
       );
-      client['dispatchEvent'](msg).catch(err =>
+      await client['dispatchEvent'](msg).catch(err =>
         expect(err).to.be.instanceOf(Error),
       );
     });
 
     describe('headers', () => {
-      it('should not generate headers if none are configured', () => {
-        client['dispatchEvent'](msg);
+      it('should not generate headers if none are configured', async () => {
+        await client['dispatchEvent'](msg);
         expect(natsClient.publish.getCall(0).args[2].headers).to.be.undefined;
       });
 
-      it('should send packet headers', () => {
+      it('should send packet headers', async () => {
         const requestHeaders = createHeaders();
         requestHeaders.set('1', '123');
         msg.data = new NatsRecord('data', requestHeaders);
 
-        client['dispatchEvent'](msg);
+        await client['dispatchEvent'](msg);
         expect(natsClient.publish.getCall(0).args[2].headers.get('1')).to.eql(
           '123',
         );
       });
 
-      it('should combine packet and static headers', () => {
+      it('should combine packet and static headers', async () => {
         const staticHeaders = { 'client-id': 'some-client-id' };
-        (client as any).options.headers = staticHeaders;
+        untypedClient.options.headers = staticHeaders;
 
         const requestHeaders = createHeaders();
         requestHeaders.set('1', '123');
         msg.data = new NatsRecord('data', requestHeaders);
 
-        client['dispatchEvent'](msg);
+        await client['dispatchEvent'](msg);
         expect(
           natsClient.publish.getCall(0).args[2].headers.get('client-id'),
         ).to.eql('some-client-id');
@@ -393,15 +400,15 @@ describe('ClientNats', () => {
         );
       });
 
-      it('should prefer packet headers over static headers', () => {
+      it('should prefer packet headers over static headers', async () => {
         const staticHeaders = { 'client-id': 'some-client-id' };
-        (client as any).options.headers = staticHeaders;
+        untypedClient.options.headers = staticHeaders;
 
         const requestHeaders = createHeaders();
         requestHeaders.set('client-id', 'override-client-id');
         msg.data = new NatsRecord('data', requestHeaders);
 
-        client['dispatchEvent'](msg);
+        await client['dispatchEvent'](msg);
         expect(
           natsClient.publish.getCall(0).args[2].headers.get('client-id'),
         ).to.eql('override-client-id');
diff --git a/packages/microservices/test/client/client-proxy.spec.ts b/packages/microservices/test/client/client-proxy.spec.ts
index ea1a912dc..e0afccdb0 100644
--- a/packages/microservices/test/client/client-proxy.spec.ts
+++ b/packages/microservices/test/client/client-proxy.spec.ts
@@ -8,9 +8,15 @@ class TestClientProxy extends ClientProxy {
   protected async dispatchEvent<T = any>(
     packet: ReadPacket<any>,
   ): Promise<any> {}
+
   public async connect() {
     return Promise.resolve();
   }
+
+  public unwrap<T>(): T {
+    throw new Error('Method not implemented.');
+  }
+
   public publish(pattern, callback): any {}
   public async close() {}
 }
diff --git a/packages/microservices/test/client/client-redis.spec.ts b/packages/microservices/test/client/client-redis.spec.ts
index 8045f90a5..149f8da9b 100644
--- a/packages/microservices/test/client/client-redis.spec.ts
+++ b/packages/microservices/test/client/client-redis.spec.ts
@@ -1,13 +1,12 @@
 import { expect } from 'chai';
-import { Subject } from 'rxjs';
 import * as sinon from 'sinon';
 import { ClientRedis } from '../../client/client-redis';
-import { ERROR_EVENT } from '../../constants';
-import { Client } from '../../external/nats-client.interface';
+import { RedisEventsMap } from '../../events/redis.events';
 
 describe('ClientRedis', () => {
   const test = 'test';
   const client = new ClientRedis({});
+  const untypedClient = client as any;
 
   describe('getRequestPattern', () => {
     it(`should leave pattern as it is`, () => {
@@ -30,8 +29,8 @@ describe('ClientRedis', () => {
       removeListenerSpy: sinon.SinonSpy,
       unsubscribeSpy: sinon.SinonSpy,
       connectSpy: sinon.SinonSpy,
-      sub,
-      pub;
+      sub: Record<string, Function>,
+      pub: Record<string, Function>;
 
     beforeEach(() => {
       subscribeSpy = sinon.spy((name, fn) => fn());
@@ -45,11 +44,10 @@ describe('ClientRedis', () => {
         on: (type, handler) => (type === 'subscribe' ? handler() : onSpy()),
         removeListener: removeListenerSpy,
         unsubscribe: unsubscribeSpy,
-        addListener: () => ({}),
       };
       pub = { publish: publishSpy };
-      (client as any).subClient = sub;
-      (client as any).pubClient = pub;
+      untypedClient.subClient = sub;
+      untypedClient.pubClient = pub;
       connectSpy = sinon.spy(client, 'connect');
     });
     afterEach(() => {
@@ -59,8 +57,8 @@ describe('ClientRedis', () => {
       client['publish'](msg, () => {});
       expect(subscribeSpy.calledWith(`${pattern}.reply`)).to.be.true;
     });
-    it('should publish stringified message to request pattern name', async () => {
-      await client['publish'](msg, () => {});
+    it('should publish stringified message to request pattern name', () => {
+      client['publish'](msg, () => {});
       expect(publishSpy.calledWith(pattern, JSON.stringify(msg))).to.be.true;
     });
     describe('on error', () => {
@@ -95,12 +93,12 @@ describe('ClientRedis', () => {
         callback = sinon.spy();
         assignStub = sinon
           .stub(client, 'assignPacketId' as any)
-          .callsFake(packet => Object.assign(packet, { id }));
+          .callsFake(packet => Object.assign(packet as object, { id }));
 
         getReplyPatternStub = sinon
           .stub(client, 'getReplyPattern')
           .callsFake(() => channel);
-        subscription = await client['publish'](msg, callback);
+        subscription = client['publish'](msg, callback);
         subscription(channel, JSON.stringify({ isDisposed: true, id }));
       });
       afterEach(() => {
@@ -183,23 +181,26 @@ describe('ClientRedis', () => {
     });
   });
   describe('close', () => {
+    const untypedClient = client as any;
+
     let pubClose: sinon.SinonSpy;
     let subClose: sinon.SinonSpy;
-    let pub, sub;
+    let pub: any, sub: any;
+
     beforeEach(() => {
       pubClose = sinon.spy();
       subClose = sinon.spy();
       pub = { quit: pubClose };
       sub = { quit: subClose };
-      (client as any).pubClient = pub;
-      (client as any).subClient = sub;
+      untypedClient.pubClient = pub;
+      untypedClient.subClient = sub;
     });
     it('should close "pub" when it is not null', () => {
       client.close();
       expect(pubClose.called).to.be.true;
     });
     it('should not close "pub" when it is null', () => {
-      (client as any).pubClient = null;
+      untypedClient.pubClient = null;
       client.close();
       expect(pubClose.called).to.be.false;
     });
@@ -208,110 +209,129 @@ describe('ClientRedis', () => {
       expect(subClose.called).to.be.true;
     });
     it('should not close "sub" when it is null', () => {
-      (client as any).subClient = null;
+      untypedClient.subClient = null;
       client.close();
       expect(subClose.called).to.be.false;
     });
   });
   describe('connect', () => {
     let createClientSpy: sinon.SinonSpy;
-    let handleErrorsSpy: sinon.SinonSpy;
+    let registerErrorListenerSpy: sinon.SinonSpy;
 
-    beforeEach(() => {
+    beforeEach(async () => {
       createClientSpy = sinon.stub(client, 'createClient').callsFake(
         () =>
           ({
+            on: () => null,
             addListener: () => null,
             removeListener: () => null,
-          } as any),
+            connect: () => Promise.resolve(),
+          }) as any,
       );
-      handleErrorsSpy = sinon.spy(client, 'handleError');
+      registerErrorListenerSpy = sinon.spy(client, 'registerErrorListener');
 
-      client.connect();
+      await client.connect();
       client['pubClient'] = null;
     });
     afterEach(() => {
       createClientSpy.restore();
-      handleErrorsSpy.restore();
+      registerErrorListenerSpy.restore();
     });
     it('should call "createClient" twice', () => {
       expect(createClientSpy.calledTwice).to.be.true;
     });
-    it('should call "handleError" twice', () => {
-      expect(handleErrorsSpy.calledTwice).to.be.true;
+    it('should call "registerErrorListener" twice', () => {
+      expect(registerErrorListenerSpy.calledTwice).to.be.true;
     });
   });
-  describe('handleError', () => {
+  describe('registerErrorListener', () => {
     it('should bind error event handler', () => {
       const callback = sinon.stub().callsFake((_, fn) => fn({ code: 'test' }));
       const emitter = {
         addListener: callback,
       };
-      client.handleError(emitter as any);
-      expect(callback.getCall(0).args[0]).to.be.eql(ERROR_EVENT);
+      client.registerErrorListener(emitter as any);
+      expect(callback.getCall(0).args[0]).to.be.eql(RedisEventsMap.ERROR);
+    });
+  });
+  describe('registerEndListener', () => {
+    it('should bind end event handler', () => {
+      const callback = sinon.stub().callsFake((_, fn) => fn({ code: 'test' }));
+      const emitter = {
+        on: callback,
+      };
+      client.registerEndListener(emitter as any);
+      expect(callback.getCall(0).args[0]).to.be.eql(RedisEventsMap.END);
+    });
+  });
+  describe('registerReadyListener', () => {
+    it('should bind ready event handler', () => {
+      const callback = sinon.stub().callsFake((_, fn) => fn({ code: 'test' }));
+      const emitter = {
+        on: callback,
+      };
+      client.registerReadyListener(emitter as any);
+      expect(callback.getCall(0).args[0]).to.be.eql(RedisEventsMap.READY);
+    });
+  });
+  describe('registerReconnectListener', () => {
+    it('should bind reconnect event handler', () => {
+      const callback = sinon.stub().callsFake((_, fn) => fn({ code: 'test' }));
+      const emitter = {
+        on: callback,
+      };
+      client.registerReconnectListener(emitter as any);
+      expect(callback.getCall(0).args[0]).to.be.eql(
+        RedisEventsMap.RECONNECTING,
+      );
     });
   });
   describe('getClientOptions', () => {
-    it('should return options object with "retry_strategy" and call "createRetryStrategy"', () => {
+    it('should return options object with "retryStrategy" and call "createRetryStrategy"', () => {
       const createSpy = sinon.spy(client, 'createRetryStrategy');
-      const { retry_strategy } = client.getClientOptions(new Subject());
+      const { retryStrategy } = client.getClientOptions()!;
       try {
-        retry_strategy({} as any);
-      } catch {}
+        retryStrategy!({} as any);
+      } catch {
+        // No empty
+      }
       expect(createSpy.called).to.be.true;
     });
   });
   describe('createRetryStrategy', () => {
-    const subject = new Subject<Error>();
     describe('when is terminated', () => {
       it('should return undefined', () => {
-        (client as any).isExplicitlyTerminated = true;
-        const result = client.createRetryStrategy({} as any, subject);
+        untypedClient.isManuallyClosed = true;
+        const result = client.createRetryStrategy(0);
         expect(result).to.be.undefined;
       });
     });
     describe('when "retryAttempts" does not exist', () => {
-      it('should return an error', () => {
-        (client as any).isExplicitlyTerminated = false;
-        (client as any).options.options = {};
-        (client as any).options.options.retryAttempts = undefined;
-        const result = client.createRetryStrategy({} as any, subject);
-        expect(result).to.be.instanceOf(Error);
+      it('should return undefined', () => {
+        untypedClient.isManuallyClosed = false;
+        untypedClient.options.options = {};
+        untypedClient.options.options.retryAttempts = undefined;
+        const result = client.createRetryStrategy(1);
+        expect(result).to.be.undefined;
       });
     });
     describe('when "attempts" count is max', () => {
-      it('should return an error', () => {
-        (client as any).isExplicitlyTerminated = false;
-        (client as any).options.options = {};
-        (client as any).options.options.retryAttempts = 3;
-        const result = client.createRetryStrategy(
-          { attempt: 4 } as any,
-          subject,
-        );
-        expect(result).to.be.instanceOf(Error);
-      });
-    });
-    describe('when ECONNREFUSED', () => {
-      it('should return error', () => {
-        (client as any).options.options = {};
-        (client as any).options.options.retryAttempts = 10;
-
-        const error = { code: 'ECONNREFUSED' };
-        const result = client.createRetryStrategy({ error } as any, subject);
-        expect(result).to.be.instanceOf(Error);
+      it('should return undefined', () => {
+        untypedClient.isManuallyClosed = false;
+        untypedClient.options.options = {};
+        untypedClient.options.options.retryAttempts = 3;
+        const result = client.createRetryStrategy(4);
+        expect(result).to.be.undefined;
       });
     });
     describe('otherwise', () => {
       it('should return delay (ms)', () => {
-        (client as any).options = {};
-        (client as any).isExplicitlyTerminated = false;
-        (client as any).options.retryAttempts = 3;
-        (client as any).options.retryDelay = 3;
-        const result = client.createRetryStrategy(
-          { attempt: 2 } as any,
-          subject,
-        );
-        expect(result).to.be.eql((client as any).options.retryDelay);
+        untypedClient.options = {};
+        untypedClient.isManuallyClosed = false;
+        untypedClient.options.retryAttempts = 3;
+        untypedClient.options.retryDelay = 3;
+        const result = client.createRetryStrategy(2);
+        expect(result).to.be.eql(untypedClient.options.retryDelay);
       });
     });
   });
@@ -324,7 +344,7 @@ describe('ClientRedis', () => {
       pubClient = {
         publish: publishStub,
       };
-      (client as any).pubClient = pubClient;
+      untypedClient.pubClient = pubClient;
     });
 
     it('should publish packet', async () => {
diff --git a/packages/microservices/test/client/client-rmq.spec.ts b/packages/microservices/test/client/client-rmq.spec.ts
index 2c764b57f..8ba1db458 100644
--- a/packages/microservices/test/client/client-rmq.spec.ts
+++ b/packages/microservices/test/client/client-rmq.spec.ts
@@ -10,20 +10,22 @@ describe('ClientRMQ', function () {
   this.retries(10);
 
   let client: ClientRMQ;
+  let untypedClient: any;
 
   describe('connect', () => {
     let createClientStub: sinon.SinonStub;
-    let handleErrorsSpy: sinon.SinonSpy;
+    let registerErrorListenerSpy: sinon.SinonSpy;
     let connect$Stub: sinon.SinonStub;
-    let mergeDisconnectEvent: sinon.SinonStub;
 
     beforeEach(async () => {
       client = new ClientRMQ({});
+      untypedClient = client as any;
+
       createClientStub = sinon.stub(client, 'createClient').callsFake(() => ({
         addListener: () => ({}),
         removeListener: () => ({}),
       }));
-      handleErrorsSpy = sinon.spy(client, 'handleError');
+      registerErrorListenerSpy = sinon.spy(client, 'registerErrorListener');
       connect$Stub = sinon.stub(client, 'connect$' as any).callsFake(() => ({
         subscribe: resolve => resolve(),
         toPromise() {
@@ -33,7 +35,7 @@ describe('ClientRMQ', function () {
           return this;
         },
       }));
-      mergeDisconnectEvent = sinon
+      sinon
         .stub(client, 'mergeDisconnectEvent')
         .callsFake((_, source) => source);
     });
@@ -42,10 +44,12 @@ describe('ClientRMQ', function () {
         try {
           client['client'] = null;
           await client.connect();
-        } catch {}
+        } catch {
+          // Ignore
+        }
       });
-      it('should call "handleError" once', async () => {
-        expect(handleErrorsSpy.called).to.be.true;
+      it('should call "registerErrorListener" once', async () => {
+        expect(registerErrorListenerSpy.called).to.be.true;
       });
       it('should call "createClient" once', async () => {
         expect(createClientStub.called).to.be.true;
@@ -62,8 +66,8 @@ describe('ClientRMQ', function () {
       it('should not call "createClient"', () => {
         expect(createClientStub.called).to.be.false;
       });
-      it('should not call "handleError"', () => {
-        expect(handleErrorsSpy.called).to.be.false;
+      it('should not call "registerErrorListener"', () => {
+        expect(registerErrorListenerSpy.called).to.be.false;
       });
       it('should not call "connect$"', () => {
         expect(connect$Stub.called).to.be.false;
@@ -125,21 +129,29 @@ describe('ClientRMQ', function () {
     beforeEach(() => {
       client['queue'] = queue;
       client['queueOptions'] = queueOptions;
-      (client as any)['options'] = { isGlobalPrefetchCount, prefetchCount };
+      untypedClient['options'] = { isGlobalPrefetchCount, prefetchCount };
 
       channel = {
         assertQueue: sinon.spy(() => ({})),
         prefetch: sinon.spy(),
       };
-      consumeStub = sinon.stub(client, 'consumeChannel').callsFake(() => null);
+      consumeStub = sinon.stub(client, 'consumeChannel').callsFake(() => null!);
     });
     afterEach(() => {
       consumeStub.restore();
     });
-    it('should call "assertQueue" with queue and queue options', async () => {
+    it('should call "assertQueue" with queue and queue options when noAssert is false', async () => {
+      client['noAssert'] = false;
+
       await client.setupChannel(channel, () => null);
       expect(channel.assertQueue.calledWith(queue, queueOptions)).to.be.true;
     });
+    it('should not call "assertQueue" when noAssert is true', async () => {
+      client['noAssert'] = true;
+
+      await client.setupChannel(channel, () => null);
+      expect(channel.assertQueue.called).not.to.be.true;
+    });
     it('should call "prefetch" with prefetchCount and "isGlobalPrefetchCount"', async () => {
       await client.setupChannel(channel, () => null);
       expect(channel.prefetch.calledWith(prefetchCount, isGlobalPrefetchCount))
@@ -164,7 +176,7 @@ describe('ClientRMQ', function () {
         off: () => ({}),
       };
       client
-        .mergeDisconnectEvent(instance as any, EMPTY)
+        .mergeDisconnectEvent(instance, EMPTY)
         .subscribe({ error: (err: any) => expect(err).to.be.eql(error) });
     });
   });
@@ -173,18 +185,20 @@ describe('ClientRMQ', function () {
     const pattern = 'test';
     let msg: ReadPacket;
     let connectSpy: sinon.SinonSpy,
-      sendToQueueSpy: sinon.SinonSpy,
+      sendToQueueStub: sinon.SinonStub,
       eventSpy: sinon.SinonSpy;
 
     beforeEach(() => {
       client = new ClientRMQ({});
+      untypedClient = client as any;
+
       msg = { pattern, data: 'data' };
       connectSpy = sinon.spy(client, 'connect');
       eventSpy = sinon.spy();
-      sendToQueueSpy = sinon.spy();
+      sendToQueueStub = sinon.stub().callsFake(() => ({ catch: sinon.spy() }));
 
       client['channel'] = {
-        sendToQueue: sendToQueueSpy,
+        sendToQueue: sendToQueueStub,
       };
       client['responseEmitter'] = new EventEmitter();
       client['responseEmitter'].on(pattern, eventSpy);
@@ -196,15 +210,15 @@ describe('ClientRMQ', function () {
 
     it('should send message to a proper queue', () => {
       client['publish'](msg, () => {
-        expect(sendToQueueSpy.called).to.be.true;
-        expect(sendToQueueSpy.getCall(0).args[0]).to.be.eql(client['queue']);
+        expect(sendToQueueStub.called).to.be.true;
+        expect(sendToQueueStub.getCall(0).args[0]).to.be.eql(client['queue']);
       });
     });
 
     it('should send buffer from stringified message', () => {
       client['publish'](msg, () => {
-        expect(sendToQueueSpy.called).to.be.true;
-        expect(sendToQueueSpy.getCall(1).args[1]).to.be.eql(
+        expect(sendToQueueStub.called).to.be.true;
+        expect(sendToQueueStub.getCall(1).args[1]).to.be.eql(
           Buffer.from(JSON.stringify(msg)),
         );
       });
@@ -220,7 +234,7 @@ describe('ClientRMQ', function () {
           on: sinon.spy(),
         } as any as EventEmitter;
 
-        subscription = await client['publish'](msg, sinon.spy());
+        subscription = client['publish'](msg, sinon.spy());
         subscription();
       });
       it('should unsubscribe', () => {
@@ -231,7 +245,7 @@ describe('ClientRMQ', function () {
     describe('headers', () => {
       it('should not generate headers if none are configured', () => {
         client['publish'](msg, () => {
-          expect(sendToQueueSpy.getCall(0).args[2].headers).to.be.undefined;
+          expect(sendToQueueStub.getCall(0).args[2].headers).to.be.undefined;
         });
       });
 
@@ -240,7 +254,7 @@ describe('ClientRMQ', function () {
         msg.data = new RmqRecord('data', { headers: requestHeaders });
 
         client['publish'](msg, () => {
-          expect(sendToQueueSpy.getCall(0).args[2].headers).to.eql(
+          expect(sendToQueueStub.getCall(0).args[2].headers).to.eql(
             requestHeaders,
           );
         });
@@ -248,13 +262,13 @@ describe('ClientRMQ', function () {
 
       it('should combine packet and static headers', () => {
         const staticHeaders = { 'client-id': 'some-client-id' };
-        (client as any).options.headers = staticHeaders;
+        untypedClient.options.headers = staticHeaders;
 
         const requestHeaders = { '1': '123' };
         msg.data = new RmqRecord('data', { headers: requestHeaders });
 
         client['publish'](msg, () => {
-          expect(sendToQueueSpy.getCall(0).args[2].headers).to.eql({
+          expect(sendToQueueStub.getCall(0).args[2].headers).to.eql({
             ...staticHeaders,
             ...requestHeaders,
           });
@@ -263,13 +277,13 @@ describe('ClientRMQ', function () {
 
       it('should prefer packet headers over static headers', () => {
         const staticHeaders = { 'client-id': 'some-client-id' };
-        (client as any).options.headers = staticHeaders;
+        untypedClient.options.headers = staticHeaders;
 
         const requestHeaders = { 'client-id': 'override-client-id' };
         msg.data = new RmqRecord('data', { headers: requestHeaders });
 
         client['publish'](msg, () => {
-          expect(sendToQueueSpy.getCall(0).args[2].headers).to.eql(
+          expect(sendToQueueStub.getCall(0).args[2].headers).to.eql(
             requestHeaders,
           );
         });
@@ -350,8 +364,8 @@ describe('ClientRMQ', function () {
     beforeEach(() => {
       channelCloseSpy = sinon.spy();
       clientCloseSpy = sinon.spy();
-      (client as any).channel = { close: channelCloseSpy };
-      (client as any).client = { close: clientCloseSpy };
+      untypedClient.channel = { close: channelCloseSpy };
+      untypedClient.client = { close: clientCloseSpy };
     });
 
     it('should close channel when it is not null', () => {
@@ -370,12 +384,14 @@ describe('ClientRMQ', function () {
 
     beforeEach(() => {
       client = new ClientRMQ({});
+      untypedClient = client as any;
+
       msg = { pattern: 'pattern', data: 'data' };
       sendToQueueStub = sinon.stub();
       channel = {
         sendToQueue: sendToQueueStub,
       };
-      (client as any).channel = channel;
+      untypedClient.channel = channel;
     });
 
     it('should publish packet', async () => {
@@ -412,7 +428,7 @@ describe('ClientRMQ', function () {
       it('should combine packet and static headers', async () => {
         sendToQueueStub.callsFake((a, b, c, d) => d());
         const staticHeaders = { 'client-id': 'some-client-id' };
-        (client as any).options.headers = staticHeaders;
+        untypedClient.options.headers = staticHeaders;
 
         const requestHeaders = { '1': '123' };
         msg.data = new RmqRecord('data', { headers: requestHeaders });
@@ -427,7 +443,7 @@ describe('ClientRMQ', function () {
       it('should prefer packet headers over static headers', async () => {
         sendToQueueStub.callsFake((a, b, c, d) => d());
         const staticHeaders = { 'client-id': 'some-client-id' };
-        (client as any).options.headers = staticHeaders;
+        untypedClient.options.headers = staticHeaders;
 
         const requestHeaders = { 'client-id': 'override-client-id' };
         msg.data = new RmqRecord('data', { headers: requestHeaders });
diff --git a/packages/microservices/test/client/client-tcp.spec.ts b/packages/microservices/test/client/client-tcp.spec.ts
index 51cc34a54..7a9449700 100644
--- a/packages/microservices/test/client/client-tcp.spec.ts
+++ b/packages/microservices/test/client/client-tcp.spec.ts
@@ -1,15 +1,20 @@
 import { expect } from 'chai';
+import { Socket as NetSocket } from 'net';
 import * as sinon from 'sinon';
+import { TLSSocket } from 'tls';
 import { ClientTCP } from '../../client/client-tcp';
-import { ERROR_EVENT } from '../../constants';
+import { TcpEventsMap } from '../../events/tcp.events';
 
 describe('ClientTCP', () => {
   let client: ClientTCP;
-  let socket;
+  let untypedClient: any;
+  let socket: any;
   let createSocketStub: sinon.SinonStub;
 
   beforeEach(() => {
     client = new ClientTCP({});
+    untypedClient = client as any;
+
     const onFakeCallback = (event, callback) =>
       event !== 'error' && event !== 'close' && callback({});
 
@@ -61,7 +66,7 @@ describe('ClientTCP', () => {
     });
   });
   describe('handleResponse', () => {
-    let callback;
+    let callback: sinon.SinonSpy;
     const id = '1';
 
     describe('when disposed', () => {
@@ -104,14 +109,20 @@ describe('ClientTCP', () => {
     });
   });
   describe('connect', () => {
-    let bindEventsSpy: sinon.SinonSpy;
+    let registerConnectListenerSpy: sinon.SinonSpy;
+    let registerErrorListenerSpy: sinon.SinonSpy;
+    let registerCloseListenerSpy: sinon.SinonSpy;
     let connect$Stub: sinon.SinonStub;
 
     beforeEach(async () => {
-      bindEventsSpy = sinon.spy(client, 'bindEvents');
+      registerConnectListenerSpy = sinon.spy(client, 'registerConnectListener');
+      registerErrorListenerSpy = sinon.spy(client, 'registerErrorListener');
+      registerCloseListenerSpy = sinon.spy(client, 'registerCloseListener');
     });
     afterEach(() => {
-      bindEventsSpy.restore();
+      registerConnectListenerSpy.restore();
+      registerErrorListenerSpy.restore();
+      registerCloseListenerSpy.restore;
     });
     describe('when is not connected', () => {
       beforeEach(async () => {
@@ -128,8 +139,14 @@ describe('ClientTCP', () => {
       afterEach(() => {
         connect$Stub.restore();
       });
-      it('should call "bindEvents" once', async () => {
-        expect(bindEventsSpy.called).to.be.true;
+      it('should call "registerConnectListener" once', async () => {
+        expect(registerConnectListenerSpy.called).to.be.true;
+      });
+      it('should call "registerErrorListener" once', async () => {
+        expect(registerErrorListenerSpy.called).to.be.true;
+      });
+      it('should call "registerCloseListener" once', async () => {
+        expect(registerCloseListenerSpy.called).to.be.true;
       });
       it('should call "createSocket" once', async () => {
         expect(createSocketStub.called).to.be.true;
@@ -149,34 +166,68 @@ describe('ClientTCP', () => {
         expect(createSocketStub.called).to.be.false;
       });
       it('should not call "bindEvents"', () => {
-        expect(bindEventsSpy.called).to.be.false;
+        expect(registerConnectListenerSpy.called).to.be.false;
       });
     });
   });
   describe('close', () => {
+    let routingMap: Map<string, Function>;
+    let callback: sinon.SinonSpy;
+
     beforeEach(() => {
-      (client as any).socket = socket;
-      (client as any).isConnected = true;
+      routingMap = new Map<string, Function>();
+      callback = sinon.spy();
+      routingMap.set('some id', callback);
+
+      untypedClient.socket = socket;
+      untypedClient.routingMap = routingMap;
       client.close();
     });
     it('should end() socket', () => {
       expect(socket.end.called).to.be.true;
     });
-    it('should set "isConnected" to false', () => {
-      expect((client as any).isConnected).to.be.false;
-    });
     it('should set "socket" to null', () => {
-      expect((client as any).socket).to.be.null;
+      expect(untypedClient.socket).to.be.null;
+    });
+    it('should clear out the routing map', () => {
+      expect(untypedClient.routingMap.size).to.be.eq(0);
+    });
+    it('should call callbacks', () => {
+      expect(
+        callback.calledWith({
+          err: sinon.match({ message: 'Connection closed' }),
+        }),
+      ).to.be.true;
     });
   });
-  describe('bindEvents', () => {
+  describe('registerErrorListener', () => {
     it('should bind error event handler', () => {
       const callback = sinon.stub().callsFake((_, fn) => fn({ code: 'test' }));
       const emitter = {
         on: callback,
       };
-      client.bindEvents(emitter as any);
-      expect(callback.getCall(0).args[0]).to.be.eql(ERROR_EVENT);
+      client.registerErrorListener(emitter as any);
+      expect(callback.getCall(0).args[0]).to.be.eql(TcpEventsMap.ERROR);
+    });
+  });
+  describe('registerCloseListener', () => {
+    it('should bind close event handler', () => {
+      const callback = sinon.stub().callsFake((_, fn) => fn({ code: 'test' }));
+      const emitter = {
+        on: callback,
+      };
+      client.registerCloseListener(emitter as any);
+      expect(callback.getCall(0).args[0]).to.be.eql(TcpEventsMap.CLOSE);
+    });
+  });
+  describe('registerConnectListener', () => {
+    it('should bind connect event handler', () => {
+      const callback = sinon.stub().callsFake((_, fn) => fn({ code: 'test' }));
+      const emitter = {
+        on: callback,
+      };
+      client.registerConnectListener(emitter as any);
+      expect(callback.getCall(0).args[0]).to.be.eql(TcpEventsMap.CONNECT);
     });
   });
   describe('dispatchEvent', () => {
@@ -188,7 +239,7 @@ describe('ClientTCP', () => {
       internalSocket = {
         sendMessage: sendMessageStub,
       };
-      (client as any).socket = internalSocket;
+      untypedClient.socket = internalSocket;
     });
 
     it('should publish packet', async () => {
@@ -197,4 +248,16 @@ describe('ClientTCP', () => {
       expect(sendMessageStub.called).to.be.true;
     });
   });
+
+  describe('tls', () => {
+    it('should upgrade to TLS', () => {
+      const client = new ClientTCP({ tlsOptions: {} });
+      const jsonSocket = client.createSocket();
+      expect(jsonSocket.socket).instanceOf(TLSSocket);
+    });
+    it('should not upgrade to TLS, if not requested', () => {
+      const jsonSocket = new ClientTCP({}).createSocket();
+      expect(jsonSocket.socket).instanceOf(NetSocket);
+    });
+  });
 });
diff --git a/packages/microservices/test/context/exception-filters-context.spec.ts b/packages/microservices/test/context/exception-filters-context.spec.ts
index 0fdec7798..f55c4019e 100644
--- a/packages/microservices/test/context/exception-filters-context.spec.ts
+++ b/packages/microservices/test/context/exception-filters-context.spec.ts
@@ -33,8 +33,8 @@ describe('ExceptionFiltersContext', () => {
       it('should return plain ExceptionHandler object', () => {
         const filter = exceptionFilter.create(
           new EmptyMetadata(),
-          () => ({} as any),
-          undefined,
+          () => ({}) as any,
+          undefined!,
         );
         expect((filter as any).filters).to.be.empty;
       });
@@ -46,8 +46,8 @@ describe('ExceptionFiltersContext', () => {
       it('should return ExceptionHandler object with exception filters', () => {
         const filter = exceptionFilter.create(
           new WithMetadata(),
-          () => ({} as any),
-          undefined,
+          () => ({}) as any,
+          undefined!,
         );
         expect((filter as any).filters).to.not.be.empty;
       });
@@ -76,7 +76,7 @@ describe('ExceptionFiltersContext', () => {
           .callsFake(() => scopedFilterWrappers);
         sinon
           .stub(instanceWrapper, 'getInstanceByContextId')
-          .callsFake(() => ({ instance } as any));
+          .callsFake(() => ({ instance }) as any);
 
         expect(exceptionFilter.getGlobalMetadata({ id: 3 })).to.contains(
           instance,
diff --git a/packages/microservices/test/context/rpc-context-creator.spec.ts b/packages/microservices/test/context/rpc-context-creator.spec.ts
index 6de5a5ca4..8b9f11d23 100644
--- a/packages/microservices/test/context/rpc-context-creator.spec.ts
+++ b/packages/microservices/test/context/rpc-context-creator.spec.ts
@@ -3,7 +3,7 @@ import { expect } from 'chai';
 import { of } from 'rxjs';
 import * as sinon from 'sinon';
 import { Injectable, UseGuards, UsePipes } from '../../../common';
-import { CUSTOM_ROUTE_AGRS_METADATA } from '../../../common/constants';
+import { CUSTOM_ROUTE_ARGS_METADATA } from '../../../common/constants';
 import { ApplicationConfig } from '../../../core/application-config';
 import { GuardsConsumer } from '../../../core/guards/guards-consumer';
 import { GuardsContextCreator } from '../../../core/guards/guards-context-creator';
@@ -104,7 +104,7 @@ describe('RpcContextCreator', () => {
         sinon
           .stub(guardsContextCreator, 'create')
           .callsFake(() => [{ canActivate: () => true }]);
-        const proxy = await contextCreator.create(
+        const proxy = contextCreator.create(
           instance,
           instance.test,
           module,
@@ -116,12 +116,12 @@ describe('RpcContextCreator', () => {
         expect(tryActivateSpy.called).to.be.true;
       });
       describe('when can not activate', () => {
-        it('should throws forbidden exception', async () => {
+        it('should throw forbidden exception', async () => {
           sinon
             .stub(guardsConsumer, 'tryActivate')
             .callsFake(async () => false);
 
-          const proxy = await contextCreator.create(
+          const proxy = contextCreator.create(
             instance,
             instance.test,
             module,
@@ -149,7 +149,7 @@ describe('RpcContextCreator', () => {
 
   describe('createGuardsFn', () => {
     it('should throw exception when "tryActivate" returns false', () => {
-      const guardsFn = contextCreator.createGuardsFn([null], null, null);
+      const guardsFn = contextCreator.createGuardsFn([null], null!, null!)!;
       sinon.stub(guardsConsumer, 'tryActivate').callsFake(async () => false);
       guardsFn([]).catch(err => expect(err).to.not.be.undefined);
     });
@@ -160,7 +160,7 @@ describe('RpcContextCreator', () => {
       const metadata = {
         [RpcParamtype.PAYLOAD]: { index: 0, data: 'test', pipes: [] },
         [RpcParamtype.CONTEXT]: { index: 2, data: 'test', pipes: [] },
-        [`key${CUSTOM_ROUTE_AGRS_METADATA}`]: {
+        [`key${CUSTOM_ROUTE_ARGS_METADATA}`]: {
           index: 3,
           data: 'custom',
           pipes: [],
@@ -177,7 +177,7 @@ describe('RpcContextCreator', () => {
       const expectedValues = [
         { index: 0, type: RpcParamtype.PAYLOAD, data: 'test' },
         { index: 2, type: RpcParamtype.CONTEXT, data: 'test' },
-        { index: 3, type: `key${CUSTOM_ROUTE_AGRS_METADATA}`, data: 'custom' },
+        { index: 3, type: `key${CUSTOM_ROUTE_ARGS_METADATA}`, data: 'custom' },
       ];
       expect(values[0]).to.deep.include(expectedValues[0]);
       expect(values[1]).to.deep.include(expectedValues[1]);
@@ -193,8 +193,8 @@ describe('RpcContextCreator', () => {
     beforeEach(() => {
       consumerApplySpy = sinon.spy(pipesConsumer, 'apply');
     });
-    it('should call "consumer.apply"', () => {
-      contextCreator.getParamValue(
+    it('should call "consumer.apply"', async () => {
+      await contextCreator.getParamValue(
         value,
         { metatype, type: RpcParamtype.PAYLOAD, data: null },
         transforms,
@@ -217,12 +217,12 @@ describe('RpcContextCreator', () => {
             {
               index: 1,
               type: 'test',
-              data: null,
+              data: null!,
               pipes: [],
               extractValue: () => null,
             },
           ],
-        );
+        )!;
         await pipesFn([]);
         expect(pipesFn).to.be.a('function');
       });
diff --git a/packages/microservices/test/context/rpc-proxy.spec.ts b/packages/microservices/test/context/rpc-proxy.spec.ts
index dbfe7f0b1..ccfac6d2d 100644
--- a/packages/microservices/test/context/rpc-proxy.spec.ts
+++ b/packages/microservices/test/context/rpc-proxy.spec.ts
@@ -18,7 +18,7 @@ describe('RpcProxy', () => {
 
   describe('create', () => {
     it('should method return thunk', async () => {
-      const proxy = await routerProxy.create(async data => of(true), handler);
+      const proxy = routerProxy.create(async data => of(true), handler);
       expect(typeof proxy === 'function').to.be.true;
     });
 
diff --git a/packages/microservices/test/ctx-host/kafka.context.spec.ts b/packages/microservices/test/ctx-host/kafka.context.spec.ts
index 9c0c1b312..11ba73456 100644
--- a/packages/microservices/test/ctx-host/kafka.context.spec.ts
+++ b/packages/microservices/test/ctx-host/kafka.context.spec.ts
@@ -1,13 +1,33 @@
 import { expect } from 'chai';
 import { KafkaContext } from '../../ctx-host';
-import { KafkaMessage } from '../../external/kafka.interface';
+import {
+  Consumer,
+  KafkaMessage,
+  Producer,
+} from '../../external/kafka.interface';
 
 describe('KafkaContext', () => {
-  const args = ['test', { test: true }];
+  const args = [
+    'test',
+    { test: true },
+    undefined,
+    { test: 'consumer' },
+    () => {},
+    { test: 'producer' },
+  ];
   let context: KafkaContext;
 
   beforeEach(() => {
-    context = new KafkaContext(args as [KafkaMessage, number, string]);
+    context = new KafkaContext(
+      args as [
+        KafkaMessage,
+        number,
+        string,
+        Consumer,
+        () => Promise<void>,
+        Producer,
+      ],
+    );
   });
   describe('getTopic', () => {
     it('should return topic', () => {
@@ -24,4 +44,19 @@ describe('KafkaContext', () => {
       expect(context.getMessage()).to.be.eql(args[0]);
     });
   });
+  describe('getConsumer', () => {
+    it('should return consumer instance', () => {
+      expect(context.getConsumer()).to.deep.eq({ test: 'consumer' });
+    });
+  });
+  describe('getHeartbeat', () => {
+    it('should return heartbeat callback', () => {
+      expect(context.getHeartbeat()).to.be.eql(args[4]);
+    });
+  });
+  describe('getProducer', () => {
+    it('should return producer instance', () => {
+      expect(context.getProducer()).to.deep.eq({ test: 'producer' });
+    });
+  });
 });
diff --git a/packages/microservices/test/decorators/event-pattern.decorator.spec.ts b/packages/microservices/test/decorators/event-pattern.decorator.spec.ts
index d1cb0df25..13cbb2684 100644
--- a/packages/microservices/test/decorators/event-pattern.decorator.spec.ts
+++ b/packages/microservices/test/decorators/event-pattern.decorator.spec.ts
@@ -1,15 +1,182 @@
 import { expect } from 'chai';
-import { PATTERN_METADATA } from '../../constants';
+import {
+  PATTERN_EXTRAS_METADATA,
+  PATTERN_METADATA,
+  TRANSPORT_METADATA,
+} from '../../constants';
 import { EventPattern } from '../../decorators/event-pattern.decorator';
+import { Transport } from '../../enums/transport.enum';
 
 describe('@EventPattern', () => {
   const pattern = { role: 'test' };
+  const patternSecond = { role: 'test2' };
+  const patternThird = { role: 'test3' };
+  const extras = { param: 'value' };
   class TestComponent {
-    @EventPattern(pattern)
+    @EventPattern(pattern, undefined, extras)
     public static test() {}
+
+    @EventPattern(patternSecond, undefined, extras)
+    @EventPattern(patternThird, undefined, extras)
+    public static testOnlyThird() {}
+
+    @EventPattern([patternSecond, patternThird], undefined, extras)
+    public static testBoth() {}
   }
   it(`should enhance method with ${PATTERN_METADATA} metadata`, () => {
     const metadata = Reflect.getMetadata(PATTERN_METADATA, TestComponent.test);
-    expect(metadata).to.be.eql(pattern);
+    expect(metadata.length).to.equal(1);
+    expect(metadata[0]).to.be.eql(pattern);
+  });
+  it(`should enhance method with ${PATTERN_EXTRAS_METADATA} metadata`, () => {
+    const metadata = Reflect.getMetadata(
+      PATTERN_EXTRAS_METADATA,
+      TestComponent.test,
+    );
+    expect(metadata).to.be.deep.equal(extras);
+  });
+  it(`should enhance method with last ${PATTERN_METADATA} metadata`, () => {
+    const metadata = Reflect.getMetadata(
+      PATTERN_METADATA,
+      TestComponent.testOnlyThird,
+    );
+    expect(metadata.length).to.equal(1);
+    expect(metadata[0]).to.be.eql(patternSecond);
+  });
+  it(`should enhance method with both ${PATTERN_METADATA} metadata`, () => {
+    const metadata = Reflect.getMetadata(
+      PATTERN_METADATA,
+      TestComponent.testBoth,
+    );
+    expect(metadata.length).to.equal(2);
+    expect(metadata[0]).to.be.eql(patternSecond);
+    expect(metadata[1]).to.be.eql(patternThird);
+  });
+
+  describe('decorator overloads', () => {
+    const additionalExtras = { foo: 'bar' };
+
+    class TestComponent1 {
+      @EventPattern(pattern)
+      public static test() {}
+    }
+    class TestComponent2 {
+      @EventPattern(pattern, Transport.TCP)
+      public static test() {}
+    }
+    class TestComponent3 {
+      @EventPattern(pattern, extras)
+      public static test() {}
+    }
+    class TestComponent4 {
+      @EventPattern(pattern, Transport.TCP, extras)
+      public static test() {}
+    }
+    class TestComponent5 {
+      @EventPattern(pattern, Transport.TCP, extras)
+      @((
+        (): MethodDecorator => (_target, _key, descriptor) =>
+          Reflect.defineMetadata(
+            PATTERN_EXTRAS_METADATA,
+            additionalExtras,
+            descriptor.value!,
+          )
+      )())
+      public static test() {}
+    }
+
+    it(`should enhance method with ${PATTERN_METADATA} metadata`, () => {
+      const [metadataArg] = Reflect.getMetadata(
+        PATTERN_METADATA,
+        TestComponent1.test,
+      );
+      const transportArg = Reflect.getMetadata(
+        TRANSPORT_METADATA,
+        TestComponent1.test,
+      );
+      const extrasArg = Reflect.getMetadata(
+        PATTERN_EXTRAS_METADATA,
+        TestComponent1.test,
+      );
+      expect(metadataArg).to.be.eql(pattern);
+      expect(transportArg).to.be.undefined;
+      expect(extrasArg).to.be.eql({});
+    });
+
+    it(`should enhance method with ${PATTERN_METADATA}, ${TRANSPORT_METADATA} metadata`, () => {
+      const [metadataArg] = Reflect.getMetadata(
+        PATTERN_METADATA,
+        TestComponent2.test,
+      );
+      const transportArg = Reflect.getMetadata(
+        TRANSPORT_METADATA,
+        TestComponent2.test,
+      );
+      const extrasArg = Reflect.getMetadata(
+        PATTERN_EXTRAS_METADATA,
+        TestComponent2.test,
+      );
+      expect(metadataArg).to.be.eql(pattern);
+      expect(transportArg).to.be.eql(Transport.TCP);
+      expect(extrasArg).to.be.eql({});
+    });
+
+    it(`should enhance method with ${PATTERN_METADATA}, ${PATTERN_EXTRAS_METADATA} metadata`, () => {
+      const [metadataArg] = Reflect.getMetadata(
+        PATTERN_METADATA,
+        TestComponent3.test,
+      );
+      const transportArg = Reflect.getMetadata(
+        TRANSPORT_METADATA,
+        TestComponent3.test,
+      );
+      const extrasArg = Reflect.getMetadata(
+        PATTERN_EXTRAS_METADATA,
+        TestComponent3.test,
+      );
+      expect(metadataArg).to.be.eql(pattern);
+      expect(transportArg).to.be.undefined;
+      expect(extrasArg).to.be.eql(extras);
+    });
+
+    it(`should enhance method with ${PATTERN_METADATA}, ${TRANSPORT_METADATA} and \
+${PATTERN_EXTRAS_METADATA} metadata`, () => {
+      const [metadataArg] = Reflect.getMetadata(
+        PATTERN_METADATA,
+        TestComponent4.test,
+      );
+      const transportArg = Reflect.getMetadata(
+        TRANSPORT_METADATA,
+        TestComponent4.test,
+      );
+      const extrasArg = Reflect.getMetadata(
+        PATTERN_EXTRAS_METADATA,
+        TestComponent4.test,
+      );
+      expect(metadataArg).to.be.eql(pattern);
+      expect(transportArg).to.be.eql(Transport.TCP);
+      expect(extrasArg).to.be.eql(extras);
+    });
+
+    it(`should merge with existing ${PATTERN_EXTRAS_METADATA} metadata`, () => {
+      const [metadataArg] = Reflect.getMetadata(
+        PATTERN_METADATA,
+        TestComponent5.test,
+      );
+      const transportArg = Reflect.getMetadata(
+        TRANSPORT_METADATA,
+        TestComponent5.test,
+      );
+      const extrasArg = Reflect.getMetadata(
+        PATTERN_EXTRAS_METADATA,
+        TestComponent5.test,
+      );
+      expect(metadataArg).to.be.eql(pattern);
+      expect(transportArg).to.be.eql(Transport.TCP);
+      expect(extrasArg).to.be.eql({
+        ...additionalExtras,
+        ...extras,
+      });
+    });
   });
 });
diff --git a/packages/microservices/test/decorators/message-pattern.decorator.spec.ts b/packages/microservices/test/decorators/message-pattern.decorator.spec.ts
index b3500e106..23b291d6b 100644
--- a/packages/microservices/test/decorators/message-pattern.decorator.spec.ts
+++ b/packages/microservices/test/decorators/message-pattern.decorator.spec.ts
@@ -1,5 +1,9 @@
 import { expect } from 'chai';
-import { PATTERN_METADATA } from '../../constants';
+import {
+  PATTERN_EXTRAS_METADATA,
+  PATTERN_METADATA,
+  TRANSPORT_METADATA,
+} from '../../constants';
 import {
   GrpcMethod,
   GrpcMethodStreamingType,
@@ -7,17 +11,156 @@ import {
   GrpcStreamMethod,
   MessagePattern,
 } from '../../decorators/message-pattern.decorator';
+import { Transport } from '../../enums/transport.enum';
 
 describe('@MessagePattern', () => {
   const pattern = { role: 'test' };
+  const extras = { param: 'value' };
   class TestComponent {
-    @MessagePattern(pattern)
+    @MessagePattern(pattern, undefined, extras)
     public static test() {}
   }
   it(`should enhance method with ${PATTERN_METADATA} metadata`, () => {
-    const metadata = Reflect.getMetadata(PATTERN_METADATA, TestComponent.test);
+    const [metadata] = Reflect.getMetadata(
+      PATTERN_METADATA,
+      TestComponent.test,
+    );
     expect(metadata).to.be.eql(pattern);
   });
+  it(`should enhance method with ${PATTERN_EXTRAS_METADATA} metadata`, () => {
+    const metadata = Reflect.getMetadata(
+      PATTERN_EXTRAS_METADATA,
+      TestComponent.test,
+    );
+    expect(metadata).to.be.deep.equal(extras);
+  });
+
+  describe('decorator overloads', () => {
+    const additionalExtras = { foo: 'bar' };
+
+    class TestComponent1 {
+      @MessagePattern(pattern)
+      public static test() {}
+    }
+    class TestComponent2 {
+      @MessagePattern(pattern, Transport.TCP)
+      public static test() {}
+    }
+    class TestComponent3 {
+      @MessagePattern(pattern, extras)
+      public static test() {}
+    }
+    class TestComponent4 {
+      @MessagePattern(pattern, Transport.TCP, extras)
+      public static test() {}
+    }
+    class TestComponent5 {
+      @MessagePattern(pattern, Transport.TCP, extras)
+      @((
+        (): MethodDecorator => (_target, _key, descriptor) =>
+          Reflect.defineMetadata(
+            PATTERN_EXTRAS_METADATA,
+            additionalExtras,
+            descriptor.value!,
+          )
+      )())
+      public static test() {}
+    }
+
+    it(`should enhance method with ${PATTERN_METADATA} metadata`, () => {
+      const [metadataArg] = Reflect.getMetadata(
+        PATTERN_METADATA,
+        TestComponent1.test,
+      );
+      const transportArg = Reflect.getMetadata(
+        TRANSPORT_METADATA,
+        TestComponent1.test,
+      );
+      const extrasArg = Reflect.getMetadata(
+        PATTERN_EXTRAS_METADATA,
+        TestComponent1.test,
+      );
+      expect(metadataArg).to.be.eql(pattern);
+      expect(transportArg).to.be.undefined;
+      expect(extrasArg).to.be.eql({});
+    });
+
+    it(`should enhance method with ${PATTERN_METADATA}, ${TRANSPORT_METADATA} metadata`, () => {
+      const [metadataArg] = Reflect.getMetadata(
+        PATTERN_METADATA,
+        TestComponent2.test,
+      );
+      const transportArg = Reflect.getMetadata(
+        TRANSPORT_METADATA,
+        TestComponent2.test,
+      );
+      const extrasArg = Reflect.getMetadata(
+        PATTERN_EXTRAS_METADATA,
+        TestComponent2.test,
+      );
+      expect(metadataArg).to.be.eql(pattern);
+      expect(transportArg).to.be.eql(Transport.TCP);
+      expect(extrasArg).to.be.eql({});
+    });
+
+    it(`should enhance method with ${PATTERN_METADATA}, ${PATTERN_EXTRAS_METADATA} metadata`, () => {
+      const [metadataArg] = Reflect.getMetadata(
+        PATTERN_METADATA,
+        TestComponent3.test,
+      );
+      const transportArg = Reflect.getMetadata(
+        TRANSPORT_METADATA,
+        TestComponent3.test,
+      );
+      const extrasArg = Reflect.getMetadata(
+        PATTERN_EXTRAS_METADATA,
+        TestComponent3.test,
+      );
+      expect(metadataArg).to.be.eql(pattern);
+      expect(transportArg).to.be.undefined;
+      expect(extrasArg).to.be.eql(extras);
+    });
+
+    it(`should enhance method with ${PATTERN_METADATA}, ${TRANSPORT_METADATA} and \
+${PATTERN_EXTRAS_METADATA} metadata`, () => {
+      const [metadataArg] = Reflect.getMetadata(
+        PATTERN_METADATA,
+        TestComponent4.test,
+      );
+      const transportArg = Reflect.getMetadata(
+        TRANSPORT_METADATA,
+        TestComponent4.test,
+      );
+      const extrasArg = Reflect.getMetadata(
+        PATTERN_EXTRAS_METADATA,
+        TestComponent4.test,
+      );
+      expect(metadataArg).to.be.eql(pattern);
+      expect(transportArg).to.be.eql(Transport.TCP);
+      expect(extrasArg).to.be.eql(extras);
+    });
+
+    it(`should merge with existing ${PATTERN_EXTRAS_METADATA} metadata`, () => {
+      const [metadataArg] = Reflect.getMetadata(
+        PATTERN_METADATA,
+        TestComponent5.test,
+      );
+      const transportArg = Reflect.getMetadata(
+        TRANSPORT_METADATA,
+        TestComponent5.test,
+      );
+      const extrasArg = Reflect.getMetadata(
+        PATTERN_EXTRAS_METADATA,
+        TestComponent5.test,
+      );
+      expect(metadataArg).to.be.eql(pattern);
+      expect(transportArg).to.be.eql(Transport.TCP);
+      expect(extrasArg).to.be.eql({
+        ...additionalExtras,
+        ...extras,
+      });
+    });
+  });
 });
 
 describe('@GrpcMethod', () => {
@@ -34,7 +177,7 @@ describe('@GrpcMethod', () => {
 
   it('should derive method and service name', () => {
     const svc = new TestService();
-    const metadata = Reflect.getMetadata(PATTERN_METADATA, svc.test);
+    const [metadata] = Reflect.getMetadata(PATTERN_METADATA, svc.test);
     expect(metadata).to.be.eql({
       service: TestService.name,
       rpc: 'Test',
@@ -44,7 +187,7 @@ describe('@GrpcMethod', () => {
 
   it('should derive method', () => {
     const svc = new TestService();
-    const metadata = Reflect.getMetadata(PATTERN_METADATA, svc.test2);
+    const [metadata] = Reflect.getMetadata(PATTERN_METADATA, svc.test2);
     expect(metadata).to.be.eql({
       service: 'TestService2',
       rpc: 'Test2',
@@ -54,7 +197,7 @@ describe('@GrpcMethod', () => {
 
   it('should override both method and service', () => {
     const svc = new TestService();
-    const metadata = Reflect.getMetadata(PATTERN_METADATA, svc.test3);
+    const [metadata] = Reflect.getMetadata(PATTERN_METADATA, svc.test3);
     expect(metadata).to.be.eql({
       service: 'TestService2',
       rpc: 'Test2',
@@ -77,7 +220,7 @@ describe('@GrpcStreamMethod', () => {
 
   it('should derive method and service name', () => {
     const svc = new TestService();
-    const metadata = Reflect.getMetadata(PATTERN_METADATA, svc.test);
+    const [metadata] = Reflect.getMetadata(PATTERN_METADATA, svc.test);
     expect(metadata).to.be.eql({
       service: TestService.name,
       rpc: 'Test',
@@ -87,7 +230,7 @@ describe('@GrpcStreamMethod', () => {
 
   it('should derive method', () => {
     const svc = new TestService();
-    const metadata = Reflect.getMetadata(PATTERN_METADATA, svc.test2);
+    const [metadata] = Reflect.getMetadata(PATTERN_METADATA, svc.test2);
     expect(metadata).to.be.eql({
       service: 'TestService2',
       rpc: 'Test2',
@@ -97,7 +240,7 @@ describe('@GrpcStreamMethod', () => {
 
   it('should override both method and service', () => {
     const svc = new TestService();
-    const metadata = Reflect.getMetadata(PATTERN_METADATA, svc.test3);
+    const [metadata] = Reflect.getMetadata(PATTERN_METADATA, svc.test3);
     expect(metadata).to.be.eql({
       service: 'TestService2',
       rpc: 'Test2',
@@ -120,7 +263,7 @@ describe('@GrpcStreamCall', () => {
 
   it('should derive method and service name', () => {
     const svc = new TestService();
-    const metadata = Reflect.getMetadata(PATTERN_METADATA, svc.test);
+    const [metadata] = Reflect.getMetadata(PATTERN_METADATA, svc.test);
     expect(metadata).to.be.eql({
       service: TestService.name,
       rpc: 'Test',
@@ -130,7 +273,7 @@ describe('@GrpcStreamCall', () => {
 
   it('should derive method', () => {
     const svc = new TestService();
-    const metadata = Reflect.getMetadata(PATTERN_METADATA, svc.test2);
+    const [metadata] = Reflect.getMetadata(PATTERN_METADATA, svc.test2);
     expect(metadata).to.be.eql({
       service: 'TestService2',
       rpc: 'Test2',
@@ -140,7 +283,7 @@ describe('@GrpcStreamCall', () => {
 
   it('should override both method and service', () => {
     const svc = new TestService();
-    const metadata = Reflect.getMetadata(PATTERN_METADATA, svc.test3);
+    const [metadata] = Reflect.getMetadata(PATTERN_METADATA, svc.test3);
     expect(metadata).to.be.eql({
       service: 'TestService2',
       rpc: 'Test2',
diff --git a/packages/microservices/test/deserializers/kafka-response.deserializer.spec.ts b/packages/microservices/test/deserializers/kafka-response.deserializer.spec.ts
index 2941c6875..30b327642 100644
--- a/packages/microservices/test/deserializers/kafka-response.deserializer.spec.ts
+++ b/packages/microservices/test/deserializers/kafka-response.deserializer.spec.ts
@@ -26,7 +26,7 @@ describe('KafkaResponseDeserializer', () => {
       });
     });
     describe('when is disposed header is present', () => {
-      it('should return an objet with "isDisposed"', () => {
+      it('should return an object with "isDisposed"', () => {
         const value = 'test';
         const packet = instance.deserialize({
           headers: {
diff --git a/packages/microservices/test/exceptions/rpc-exceptions-handler.spec.ts b/packages/microservices/test/exceptions/rpc-exceptions-handler.spec.ts
index a3ffb69b7..8765f7346 100644
--- a/packages/microservices/test/exceptions/rpc-exceptions-handler.spec.ts
+++ b/packages/microservices/test/exceptions/rpc-exceptions-handler.spec.ts
@@ -14,7 +14,7 @@ describe('RpcExceptionsHandler', () => {
 
   describe('handle', () => {
     it('should method returns expected stream with message when exception is unknown', done => {
-      const stream$ = handler.handle(new Error(), null);
+      const stream$ = handler.handle(new Error(), null!);
       stream$
         .pipe(
           catchError((err: any) => {
@@ -33,7 +33,7 @@ describe('RpcExceptionsHandler', () => {
         const message = {
           custom: 'Unauthorized',
         };
-        const stream$ = handler.handle(new RpcException(message), null);
+        const stream$ = handler.handle(new RpcException(message), null!);
         stream$
           .pipe(
             catchError((err: any) => {
@@ -47,7 +47,7 @@ describe('RpcExceptionsHandler', () => {
       it('should method emit expected status and transform message to json', done => {
         const message = 'Unauthorized';
 
-        const stream$ = handler.handle(new RpcException(message), null);
+        const stream$ = handler.handle(new RpcException(message), null!);
         stream$
           .pipe(
             catchError((err: any) => {
@@ -65,7 +65,7 @@ describe('RpcExceptionsHandler', () => {
         sinon.stub(handler, 'invokeCustomFilters').returns(observable$);
       });
       it('should return observable', () => {
-        const result = handler.handle(new RpcException(''), null);
+        const result = handler.handle(new RpcException(''), null!);
         expect(result).to.be.eql(observable$);
       });
     });
@@ -76,14 +76,14 @@ describe('RpcExceptionsHandler', () => {
       handler.setCustomFilters(filters as any);
       expect((handler as any).filters).to.be.eql(filters);
     });
-    it('should throws exception when passed argument is not an array', () => {
-      expect(() => handler.setCustomFilters(null)).to.throw();
+    it('should throw exception when passed argument is not an array', () => {
+      expect(() => handler.setCustomFilters(null!)).to.throw();
     });
   });
   describe('invokeCustomFilters', () => {
     describe('when filters array is empty', () => {
       it('should return identity', () => {
-        expect(handler.invokeCustomFilters(null, null)).to.be.null;
+        expect(handler.invokeCustomFilters(null, null!)).to.be.null;
       });
     });
     describe('when filters array is not empty', () => {
@@ -99,26 +99,26 @@ describe('RpcExceptionsHandler', () => {
           (handler as any).filters = filters;
         });
         it('should call funcSpy', () => {
-          handler.invokeCustomFilters(new TestException(), null);
+          handler.invokeCustomFilters(new TestException(), null!);
           expect(funcSpy.notCalled).to.be.false;
         });
         it('should call funcSpy with exception and response passed as an arguments', () => {
           const exception = new TestException();
-          handler.invokeCustomFilters(exception, null);
+          handler.invokeCustomFilters(exception, null!);
           expect(funcSpy.calledWith(exception)).to.be.true;
         });
         it('should return stream', () => {
-          expect(handler.invokeCustomFilters(new TestException(), null)).to.be
+          expect(handler.invokeCustomFilters(new TestException(), null!)).to.be
             .not.null;
         });
       });
       describe('when filter does not exists in filters array', () => {
         it('should not call funcSpy', () => {
-          handler.invokeCustomFilters(new TestException(), null);
+          handler.invokeCustomFilters(new TestException(), null!);
           expect(funcSpy.notCalled).to.be.true;
         });
         it('should return null', () => {
-          expect(handler.invokeCustomFilters(new TestException(), null)).to.be
+          expect(handler.invokeCustomFilters(new TestException(), null!)).to.be
             .null;
         });
       });
diff --git a/packages/microservices/test/factories/rpc-params-factory.spec.ts b/packages/microservices/test/factories/rpc-params-factory.spec.ts
index ca1fe7ff1..406580776 100644
--- a/packages/microservices/test/factories/rpc-params-factory.spec.ts
+++ b/packages/microservices/test/factories/rpc-params-factory.spec.ts
@@ -16,7 +16,7 @@ describe('RpcParamsFactory', () => {
       describe(`RpcParamtype.PAYLOAD`, () => {
         it('should return a message payload object', () => {
           expect(
-            factory.exchangeKeyForValue(RpcParamtype.PAYLOAD, null, args),
+            factory.exchangeKeyForValue(RpcParamtype.PAYLOAD, null!, args),
           ).to.be.eql(payload);
         });
         it('should return a message payload object with parameter extraction', () => {
@@ -28,19 +28,21 @@ describe('RpcParamsFactory', () => {
       describe(`RpcParamtype.CONTEXT`, () => {
         it('should return a ctx object', () => {
           expect(
-            factory.exchangeKeyForValue(RpcParamtype.CONTEXT, null, args),
+            factory.exchangeKeyForValue(RpcParamtype.CONTEXT, null!, args),
           ).to.be.eql(ctx);
         });
       });
     });
     describe('when key is not available', () => {
       it('should return null', () => {
-        expect(factory.exchangeKeyForValue(-1, null, [])).to.be.eql(null);
+        expect(factory.exchangeKeyForValue(-1, null!, [])).to.be.eql(null);
       });
     });
     describe('when args are not available', () => {
       it('should return null', () => {
-        expect(factory.exchangeKeyForValue(null, null, null)).to.be.eql(null);
+        expect(factory.exchangeKeyForValue(null!, null!, null!)).to.be.eql(
+          null,
+        );
       });
     });
   });
diff --git a/packages/microservices/test/helpers/grpc-helpers.spec.ts b/packages/microservices/test/helpers/grpc-helpers.spec.ts
new file mode 100644
index 000000000..e8844a1f9
--- /dev/null
+++ b/packages/microservices/test/helpers/grpc-helpers.spec.ts
@@ -0,0 +1,64 @@
+import { expect } from 'chai';
+import { InvalidGrpcPackageDefinitionMissingPackageDefinitionException } from '../../errors/invalid-grpc-package-definition-missing-package-definition.exception';
+import { InvalidGrpcPackageDefinitionMutexException } from '../../errors/invalid-grpc-package-definition-mutex.exception';
+import { getGrpcPackageDefinition } from '../../helpers/grpc-helpers';
+
+const grpcProtoLoaderPackage = { loadSync: (a, b) => 'withLoader' };
+
+describe('getGrpcPackageDefinition', () => {
+  describe('when missing both protoPath and packageDefinition', () => {
+    it('should throw InvalidGrpcPackageDefinitionMissingPackageDefinitionException', () => {
+      expect(() =>
+        getGrpcPackageDefinition(
+          {
+            package: 'somePackage',
+          },
+          grpcProtoLoaderPackage,
+        ),
+      ).to.throw(InvalidGrpcPackageDefinitionMissingPackageDefinitionException);
+    });
+  });
+
+  describe('when both protoPath and packageDefinition are defined', () => {
+    it('should throw InvalidGrpcPackageDefinitionMutexException', () => {
+      expect(() =>
+        getGrpcPackageDefinition(
+          {
+            package: 'somePackage',
+            protoPath: 'some/path',
+            packageDefinition: {},
+          },
+          grpcProtoLoaderPackage,
+        ),
+      ).to.throw(InvalidGrpcPackageDefinitionMutexException);
+    });
+  });
+
+  describe('when only protoPath is defined', () => {
+    it('should not throw any exception', () => {
+      expect(() =>
+        getGrpcPackageDefinition(
+          {
+            package: 'somePackage',
+            protoPath: 'some/path',
+          },
+          grpcProtoLoaderPackage,
+        ),
+      ).to.not.throw(Error);
+    });
+  });
+
+  describe('when only packageDefinition is defined', () => {
+    it('should not throw any exception', () => {
+      expect(() =>
+        getGrpcPackageDefinition(
+          {
+            package: 'somePackage',
+            packageDefinition: {},
+          },
+          grpcProtoLoaderPackage,
+        ),
+      ).to.not.throw(Error);
+    });
+  });
+});
diff --git a/packages/microservices/test/helpers/kafka-parser.spec.ts b/packages/microservices/test/helpers/kafka-parser.spec.ts
index 91c698d1b..e4f8babcd 100644
--- a/packages/microservices/test/helpers/kafka-parser.spec.ts
+++ b/packages/microservices/test/helpers/kafka-parser.spec.ts
@@ -126,5 +126,35 @@ describe('KafkaParser', () => {
         },
       });
     });
+
+    it('parse message multiple times (simulate retry)', () => {
+      const message = {
+        headers: {
+          [KafkaHeaders.CORRELATION_ID]: Buffer.from('correlation-id'),
+        },
+        value: Buffer.from(JSON.stringify({ prop: 'value' })),
+        key: Buffer.from('1'),
+      };
+      const expectedParsedMessage = {
+        key: '1',
+        value: {
+          prop: 'value',
+        },
+        headers: {
+          [KafkaHeaders.CORRELATION_ID]: 'correlation-id',
+        },
+      };
+      expect(kafkaParser.parse(message)).to.deep.eq(expectedParsedMessage);
+      // Parse message again and verify it still works correctly
+      expect(kafkaParser.parse(message)).to.deep.eq(expectedParsedMessage);
+      // Verify message was not modified
+      expect(message).to.deep.eq({
+        headers: {
+          [KafkaHeaders.CORRELATION_ID]: Buffer.from('correlation-id'),
+        },
+        value: Buffer.from(JSON.stringify({ prop: 'value' })),
+        key: Buffer.from('1'),
+      });
+    });
   });
 });
diff --git a/packages/microservices/test/helpers/kafka-reply-partition-assigner.spec.ts b/packages/microservices/test/helpers/kafka-reply-partition-assigner.spec.ts
index 93ab12f73..1004deb5c 100644
--- a/packages/microservices/test/helpers/kafka-reply-partition-assigner.spec.ts
+++ b/packages/microservices/test/helpers/kafka-reply-partition-assigner.spec.ts
@@ -21,7 +21,7 @@ describe('kafka reply partition assigner', () => {
     getPreviousAssignment = sinon.spy(assigner, 'getPreviousAssignment');
 
     // reset previous assignments
-    (client as any).consumerAssignments = {};
+    client.consumerAssignments = {};
   });
 
   describe('assign', () => {
@@ -259,7 +259,7 @@ describe('kafka reply partition assigner', () => {
   describe('protocol', () => {
     it('returns the assigner name and metadata', () => {
       // set previous assignments
-      (client as any).consumerAssignments = {
+      client.consumerAssignments = {
         'topic-A': 0,
         'topic-B': 1,
       };
@@ -276,7 +276,7 @@ describe('kafka reply partition assigner', () => {
           topics,
           userData: Buffer.from(
             JSON.stringify({
-              previousAssignment: (client as any).consumerAssignments,
+              previousAssignment: client.consumerAssignments,
             }),
           ),
         }),
diff --git a/packages/microservices/test/json-socket/connection.spec.ts b/packages/microservices/test/json-socket/connection.spec.ts
index df95cbbcc..195788c84 100644
--- a/packages/microservices/test/json-socket/connection.spec.ts
+++ b/packages/microservices/test/json-socket/connection.spec.ts
@@ -1,11 +1,13 @@
 import { expect } from 'chai';
 import { AddressInfo, createServer, Socket } from 'net';
-import { CONNECT_EVENT, MESSAGE_EVENT } from '../../constants';
+import { TcpEventsMap } from '../../events/tcp.events';
 import { JsonSocket } from '../../helpers/json-socket';
 import { longPayload } from './data/long-payload-with-special-chars';
 import * as helpers from './helpers';
 import { ip } from './helpers';
 
+const MESSAGE_EVENT = 'message';
+
 describe('JsonSocket connection', () => {
   it('should connect, send and receive message', done => {
     helpers.createServerAndClient(
@@ -14,31 +16,31 @@ describe('JsonSocket connection', () => {
           return done(error);
         }
 
-        expect(clientSocket['isClosed']).to.be.false;
-        expect(serverSocket['isClosed']).to.be.false;
+        expect(clientSocket!['isClosed']).to.be.false;
+        expect(serverSocket!['isClosed']).to.be.false;
 
         Promise.all([
           new Promise(callback => {
-            clientSocket.sendMessage({ type: 'ping' }, callback);
+            clientSocket!.sendMessage({ type: 'ping' }, callback);
           }),
           new Promise<void>(callback => {
-            clientSocket.on(MESSAGE_EVENT, (message: string) => {
+            clientSocket!.on(MESSAGE_EVENT, (message: string) => {
               expect(message).to.deep.equal({ type: 'pong' });
               callback();
             });
           }),
           new Promise(callback => {
-            serverSocket.on(MESSAGE_EVENT, (message: string) => {
+            serverSocket!.on(MESSAGE_EVENT, (message: string) => {
               expect(message).to.deep.equal({ type: 'ping' });
-              serverSocket.sendMessage({ type: 'pong' }, callback);
+              serverSocket!.sendMessage({ type: 'pong' }, callback);
             });
           }),
         ])
           .then(() => {
-            expect(clientSocket['isClosed']).to.equal(false);
-            expect(serverSocket['isClosed']).to.equal(false);
-            clientSocket.end();
-            server.close(done);
+            expect(clientSocket!['isClosed']).to.equal(false);
+            expect(serverSocket!['isClosed']).to.equal(false);
+            clientSocket!.end();
+            server!.close(done);
           })
           .catch(e => done(e));
       },
@@ -50,30 +52,30 @@ describe('JsonSocket connection', () => {
       if (err) {
         return done(err);
       }
-      expect(clientSocket['isClosed']).to.equal(false);
-      expect(serverSocket['isClosed']).to.equal(false);
+      expect(clientSocket!['isClosed']).to.equal(false);
+      expect(serverSocket!['isClosed']).to.equal(false);
       Promise.all([
         new Promise<void>(callback => {
-          clientSocket.sendMessage(longPayload, callback);
+          clientSocket!.sendMessage(longPayload, callback);
         }),
         new Promise<void>(callback => {
-          clientSocket.on(MESSAGE_EVENT, (message: { type: 'pong' }) => {
+          clientSocket!.on(MESSAGE_EVENT, (message: { type: 'pong' }) => {
             expect(message).to.deep.equal({ type: 'pong' });
             callback();
           });
         }),
         new Promise<void>(callback => {
-          serverSocket.on(MESSAGE_EVENT, (message: { type: 'pong' }) => {
+          serverSocket!.on(MESSAGE_EVENT, (message: { type: 'pong' }) => {
             expect(message).to.deep.equal(longPayload);
-            serverSocket.sendMessage({ type: 'pong' }, callback);
+            serverSocket!.sendMessage({ type: 'pong' }, callback);
           });
         }),
       ])
         .then(() => {
-          expect(clientSocket['isClosed']).to.equal(false);
-          expect(serverSocket['isClosed']).to.equal(false);
-          clientSocket.end();
-          server.close(done);
+          expect(clientSocket!['isClosed']).to.equal(false);
+          expect(serverSocket!['isClosed']).to.equal(false);
+          clientSocket!.end();
+          server!.close(done);
         })
         .catch(e => done(e));
     });
@@ -92,14 +94,14 @@ describe('JsonSocket connection', () => {
               .map(
                 i =>
                   new Promise(resolve =>
-                    clientSocket.sendMessage({ number: i }, resolve),
+                    clientSocket!.sendMessage({ number: i }, resolve),
                   ),
               ),
           ).then(_ => callback()),
         ),
         new Promise<void>(callback => {
           let lastNumber = 0;
-          serverSocket.on(MESSAGE_EVENT, (message: { number: number }) => {
+          serverSocket!.on(MESSAGE_EVENT, (message: { number: number }) => {
             expect(message.number).to.deep.equal(lastNumber + 1);
             lastNumber = message.number;
             if (lastNumber === 100) {
@@ -109,8 +111,8 @@ describe('JsonSocket connection', () => {
         }),
       ])
         .then(() => {
-          clientSocket.end();
-          server.close(done);
+          clientSocket!.end();
+          server!.close(done);
         })
         .catch(e => done(e));
     });
@@ -123,20 +125,20 @@ describe('JsonSocket connection', () => {
       }
 
       new Promise(callback => {
-        serverSocket.end();
+        serverSocket!.end();
         setTimeout(callback, 10);
       })
         .then(
           () =>
             new Promise<void>(callback => {
-              expect(clientSocket['isClosed']).to.equal(true);
-              expect(serverSocket['isClosed']).to.equal(true);
+              expect(clientSocket!['isClosed']).to.equal(true);
+              expect(serverSocket!['isClosed']).to.equal(true);
               callback();
             }),
         )
         .then(() => {
-          clientSocket.end();
-          server.close(done);
+          clientSocket!.end();
+          server!.close(done);
         })
         .catch(e => done(e));
     });
@@ -149,18 +151,18 @@ describe('JsonSocket connection', () => {
       }
 
       new Promise(callback => {
-        clientSocket.end();
+        clientSocket!.end();
         setTimeout(callback, 10);
       })
         .then(
           () =>
             new Promise<void>(callback => {
-              expect(clientSocket['isClosed']).to.equal(true);
-              expect(serverSocket['isClosed']).to.equal(true);
+              expect(clientSocket!['isClosed']).to.equal(true);
+              expect(serverSocket!['isClosed']).to.equal(true);
               callback();
             }),
         )
-        .then(() => server.close(done))
+        .then(() => server!.close(done))
         .catch(e => done(e));
     });
   });
@@ -179,7 +181,7 @@ describe('JsonSocket connection', () => {
             expect(serverSocket['isClosed']).to.equal(true);
             expect(clientSocket['isClosed']).to.equal(true);
 
-            clientSocket.on(CONNECT_EVENT, () => {
+            clientSocket.on(TcpEventsMap.CONNECT, () => {
               setTimeout(() => {
                 expect(clientSocket['isClosed']).to.equal(false);
 
diff --git a/packages/microservices/test/json-socket/helpers.ts b/packages/microservices/test/json-socket/helpers.ts
index acaf339d8..d09fcf279 100644
--- a/packages/microservices/test/json-socket/helpers.ts
+++ b/packages/microservices/test/json-socket/helpers.ts
@@ -4,7 +4,7 @@ import {
   Server,
   Socket,
 } from 'net';
-import { ERROR_EVENT } from '../../constants';
+import { TcpEventsMap } from '../../events/tcp.events';
 import { JsonSocket } from '../../helpers/json-socket';
 
 export const ip = '127.0.0.1';
@@ -17,7 +17,7 @@ export function createServer(callback: (err?: any, server?: Server) => void) {
     callback(null, server);
   });
 
-  server.on(ERROR_EVENT, (err: any) => {
+  server.on(TcpEventsMap.ERROR, (err: any) => {
     callback(err);
   });
 }
@@ -40,7 +40,7 @@ export function createClient(
 
   clientSocket.connect(port, ip);
 
-  clientSocket.on(ERROR_EVENT, (err: any) => {
+  clientSocket.on(TcpEventsMap.ERROR, (err: any) => {
     callback(err);
   });
 
@@ -63,7 +63,7 @@ export function createServerAndClient(
       return callback(serverErr);
     }
 
-    createClient(server, (clientErr, clientSocket, serverSocket) => {
+    createClient(server!, (clientErr, clientSocket, serverSocket) => {
       if (clientErr) {
         return callback(clientErr);
       }
@@ -74,7 +74,7 @@ export function createServerAndClient(
 }
 
 export function range(start: number, end: number) {
-  const r = [];
+  const r = [] as number[];
   for (let i = start; i <= end; i++) {
     r.push(i);
   }
diff --git a/packages/microservices/test/json-socket/listener-chaining.spec.ts b/packages/microservices/test/json-socket/listener-chaining.spec.ts
index fe0794547..24f920618 100644
--- a/packages/microservices/test/json-socket/listener-chaining.spec.ts
+++ b/packages/microservices/test/json-socket/listener-chaining.spec.ts
@@ -1,7 +1,9 @@
-import { CONNECT_EVENT, MESSAGE_EVENT } from '../../constants';
+import { expect } from 'chai';
+import { TcpEventsMap } from '../../events/tcp.events';
 import { JsonSocket } from '../../helpers/json-socket';
 import * as helpers from './helpers';
-import { expect } from 'chai';
+
+const MESSAGE_EVENT = 'message';
 
 describe('JsonSocket chaining', () => {
   it('should return the instance when subscribing to event', done => {
@@ -10,18 +12,18 @@ describe('JsonSocket chaining', () => {
         return done(err);
       }
 
-      expect(clientSocket.on(MESSAGE_EVENT, () => {})).to.be.instanceof(
+      expect(clientSocket!.on(MESSAGE_EVENT, () => {})).to.be.instanceof(
         JsonSocket,
       );
-      expect(clientSocket.on(CONNECT_EVENT, () => {})).to.deep.equal(
+      expect(clientSocket!.on(TcpEventsMap.CONNECT, () => {})).to.deep.equal(
         clientSocket,
       );
       expect(
-        clientSocket.on(MESSAGE_EVENT, () => {}).on('end', () => {}),
+        clientSocket!.on(MESSAGE_EVENT, () => {}).on('end', () => {}),
       ).to.deep.equal(clientSocket);
 
-      clientSocket.end();
-      server.close(done);
+      clientSocket!.end();
+      server!.close(done);
     });
   });
 });
diff --git a/packages/microservices/test/json-socket/message-parsing.spec.ts b/packages/microservices/test/json-socket/message-parsing.spec.ts
index 853ddff2b..e42fa42a5 100644
--- a/packages/microservices/test/json-socket/message-parsing.spec.ts
+++ b/packages/microservices/test/json-socket/message-parsing.spec.ts
@@ -1,9 +1,11 @@
 import { expect } from 'chai';
 import { Socket } from 'net';
 import * as sinon from 'sinon';
-import { ERROR_EVENT, MESSAGE_EVENT } from '../../constants';
+import { TcpEventsMap } from '../../events/tcp.events';
 import { JsonSocket } from '../../helpers/json-socket';
 
+const MESSAGE_EVENT = 'message';
+
 describe('JsonSocket message parsing', () => {
   const socket = new JsonSocket(new Socket());
   let messages: string[] = [];
@@ -107,21 +109,22 @@ describe('JsonSocket message parsing', () => {
 
   describe('Error handling', () => {
     describe('JSON Error', () => {
-      const errorMsg = `Could not parse JSON: Unexpected end of JSON input\nRequest data: "Hel`;
-      const packetStrin = '4#"Hel';
-      const packet = Buffer.from(packetStrin);
+      const errorMsgNodeAboveV20 = `Could not parse JSON: Unterminated string in JSON at position 4 (line 1 column 5)\nRequest data: "Hel`;
+      const errorMsg = `Could not parse JSON: Unterminated string in JSON at position 4\nRequest data: "Hel`;
+      const packetString = '4#"Hel';
+      const packet = Buffer.from(packetString);
 
       it('should fail to parse invalid JSON', () => {
         try {
           socket['handleData']('4#"Hel');
         } catch (err) {
-          expect(err.message).to.deep.equal(errorMsg);
+          expect([errorMsgNodeAboveV20, errorMsg]).to.include(err.message);
         }
         expect(messages.length).to.deep.equal(0);
         expect(socket['buffer']).to.deep.equal('');
       });
 
-      it(`should emit ${ERROR_EVENT} event on socket`, () => {
+      it(`should emit ${TcpEventsMap.ERROR} event on socket`, () => {
         const socketEmitSpy: sinon.SinonSpy<any, any> = sinon.spy(
           socket['socket'],
           'emit',
@@ -129,9 +132,20 @@ describe('JsonSocket message parsing', () => {
 
         socket['onData'](packet);
 
-        expect(socketEmitSpy.calledOnceWithExactly(ERROR_EVENT, errorMsg)).to.be
-          .true;
-        socketEmitSpy.restore();
+        try {
+          expect(
+            socketEmitSpy.calledOnceWithExactly(TcpEventsMap.ERROR, errorMsg),
+          ).to.be.true;
+        } catch (err) {
+          expect(
+            socketEmitSpy.calledWithExactly(
+              TcpEventsMap.ERROR,
+              errorMsgNodeAboveV20,
+            ),
+          ).to.be.true;
+        } finally {
+          socketEmitSpy.restore();
+        }
       });
 
       it(`should send a FIN packet`, () => {
@@ -146,12 +160,12 @@ describe('JsonSocket message parsing', () => {
 
     describe('Corrupted length value', () => {
       const errorMsg = `Corrupted length value "wtf" supplied in a packet`;
-      const packetStrin = 'wtf#"Hello"';
-      const packet = Buffer.from(packetStrin);
+      const packetString = 'wtf#"Hello"';
+      const packet = Buffer.from(packetString);
 
       it('should not accept invalid content length', () => {
         try {
-          socket['handleData'](packetStrin);
+          socket['handleData'](packetString);
         } catch (err) {
           expect(err.message).to.deep.equal(errorMsg);
         }
@@ -159,7 +173,7 @@ describe('JsonSocket message parsing', () => {
         expect(socket['buffer']).to.deep.equal('');
       });
 
-      it(`should emit ${ERROR_EVENT} event on socket`, () => {
+      it(`should emit ${TcpEventsMap.ERROR} event on socket`, () => {
         const socketEmitSpy: sinon.SinonSpy<any, any> = sinon.spy(
           socket['socket'],
           'emit',
@@ -167,9 +181,15 @@ describe('JsonSocket message parsing', () => {
 
         socket['onData'](packet);
 
-        expect(socketEmitSpy.calledOnceWithExactly(ERROR_EVENT, errorMsg)).to.be
-          .true;
-        socketEmitSpy.restore();
+        try {
+          expect(
+            socketEmitSpy.calledOnceWithExactly(TcpEventsMap.ERROR, errorMsg),
+          ).to.be.true;
+        } catch {
+          // Do nothing
+        } finally {
+          socketEmitSpy.restore();
+        }
       });
 
       it(`should send a FIN packet`, () => {
diff --git a/packages/microservices/test/listeners-controller.spec.ts b/packages/microservices/test/listeners-controller.spec.ts
index 9b9f67f94..18fc28dd2 100644
--- a/packages/microservices/test/listeners-controller.spec.ts
+++ b/packages/microservices/test/listeners-controller.spec.ts
@@ -6,13 +6,17 @@ import { Injector } from '@nestjs/core/injector/injector';
 import { InstanceWrapper } from '@nestjs/core/injector/instance-wrapper';
 import { expect } from 'chai';
 import * as sinon from 'sinon';
+import { GraphInspector } from '../../core/inspector/graph-inspector';
 import { MetadataScanner } from '../../core/metadata-scanner';
 import { ClientProxyFactory } from '../client';
 import { ClientsContainer } from '../container';
 import { ExceptionFiltersContext } from '../context/exception-filters-context';
 import { RpcContextCreator } from '../context/rpc-context-creator';
 import { Transport } from '../enums/transport.enum';
-import { ListenerMetadataExplorer } from '../listener-metadata-explorer';
+import {
+  EventOrMessageListenerDefinition,
+  ListenerMetadataExplorer,
+} from '../listener-metadata-explorer';
 import { ListenersController } from '../listeners-controller';
 
 describe('ListenersController', () => {
@@ -21,10 +25,14 @@ describe('ListenersController', () => {
     metadataExplorer: ListenerMetadataExplorer,
     server: any,
     serverTCP: any,
+    serverCustom: any,
+    customTransport: symbol,
     addSpy: sinon.SinonSpy,
     addSpyTCP: sinon.SinonSpy,
+    addSpyCustom: sinon.SinonSpy,
     proxySpy: sinon.SinonSpy,
     container: NestContainer,
+    graphInspector: GraphInspector,
     injector: Injector,
     rpcContextCreator: RpcContextCreator,
     exceptionFiltersContext: ExceptionFiltersContext;
@@ -35,6 +43,7 @@ describe('ListenersController', () => {
   });
   beforeEach(() => {
     container = new NestContainer();
+    graphInspector = new GraphInspector(container);
     injector = new Injector();
     exceptionFiltersContext = new ExceptionFiltersContext(
       container,
@@ -43,6 +52,7 @@ describe('ListenersController', () => {
     rpcContextCreator = sinon.createStubInstance(RpcContextCreator) as any;
     proxySpy = sinon.spy();
     (rpcContextCreator as any).create.callsFake(() => proxySpy);
+
     instance = new ListenersController(
       new ClientsContainer(),
       rpcContextCreator,
@@ -50,6 +60,7 @@ describe('ListenersController', () => {
       injector,
       ClientProxyFactory,
       exceptionFiltersContext,
+      graphInspector,
     );
     (instance as any).metadataExplorer = metadataExplorer;
     addSpy = sinon.spy();
@@ -61,16 +72,22 @@ describe('ListenersController', () => {
       addHandler: addSpyTCP,
       transportId: Transport.TCP,
     };
+    addSpyCustom = sinon.spy();
+    customTransport = Symbol();
+    serverCustom = {
+      addHandler: addSpyCustom,
+      transportId: customTransport,
+    };
   });
 
   describe('registerPatternHandlers', () => {
     const handlers = [
-      { pattern: 'test', targetCallback: 'tt' },
-      { pattern: 'test2', targetCallback: '2', isEventHandler: true },
+      { patterns: ['test'], targetCallback: 'tt' },
+      { patterns: ['test2'], targetCallback: '2', isEventHandler: true },
     ];
 
     beforeEach(() => {
-      sinon.stub(container, 'getModuleByKey').callsFake(() => ({} as any));
+      sinon.stub(container, 'getModuleByKey').callsFake(() => ({}) as any);
     });
     it(`should call "addHandler" method of server for each pattern handler`, () => {
       explorer.expects('explore').returns(handlers);
@@ -80,7 +97,7 @@ describe('ListenersController', () => {
     it(`should call "addHandler" method of server for each pattern handler with same transport`, () => {
       const serverHandlers = [
         {
-          pattern: { cmd: 'test' },
+          patterns: [{ cmd: 'test' }],
           targetCallback: 'tt',
           transport: Transport.TCP,
         },
@@ -92,8 +109,12 @@ describe('ListenersController', () => {
     });
     it(`should call "addHandler" method of server without transportID for each pattern handler with any transport value`, () => {
       const serverHandlers = [
-        { pattern: { cmd: 'test' }, targetCallback: 'tt' },
-        { pattern: 'test2', targetCallback: '2', transport: Transport.KAFKA },
+        { patterns: [{ cmd: 'test' }], targetCallback: 'tt' },
+        {
+          patterns: ['test2'],
+          targetCallback: '2',
+          transport: Transport.KAFKA,
+        },
       ];
       explorer.expects('explore').returns(serverHandlers);
       instance.registerPatternHandlers(new InstanceWrapper(), server, '');
@@ -101,10 +122,14 @@ describe('ListenersController', () => {
     });
     it(`should call "addHandler" method of server with transportID for each pattern handler with self transport and without transport`, () => {
       const serverHandlers = [
-        { pattern: 'test', targetCallback: 'tt' },
-        { pattern: 'test2', targetCallback: '2', transport: Transport.KAFKA },
+        { patterns: ['test'], targetCallback: 'tt' },
+        {
+          patterns: ['test2'],
+          targetCallback: '2',
+          transport: Transport.KAFKA,
+        },
         {
-          pattern: { cmd: 'test3' },
+          patterns: [{ cmd: 'test3' }],
           targetCallback: '3',
           transport: Transport.TCP,
         },
@@ -118,6 +143,44 @@ describe('ListenersController', () => {
       instance.registerPatternHandlers(new InstanceWrapper(), serverTCP, '');
       expect(addSpyTCP.calledTwice).to.be.true;
     });
+    it(`should call "addHandler" method of server with custom transportID for pattern handler with the same custom token`, () => {
+      const serverHandlers = [
+        {
+          patterns: [{ cmd: 'test' }],
+          targetCallback: 'tt',
+          transport: customTransport,
+        },
+        {
+          patterns: ['test2'],
+          targetCallback: '2',
+          transport: Transport.KAFKA,
+        },
+      ];
+
+      explorer.expects('explore').returns(serverHandlers);
+      instance.registerPatternHandlers(new InstanceWrapper(), serverCustom, '');
+      expect(addSpyCustom.calledOnce).to.be.true;
+    });
+    it(`should call "addHandler" method of server with extras data`, () => {
+      const serverHandlers = [
+        {
+          patterns: ['test'],
+          targetCallback: 'tt',
+          extras: { param: 'value' },
+        },
+      ];
+      explorer.expects('explore').returns(serverHandlers);
+      instance.registerPatternHandlers(new InstanceWrapper(), serverTCP, '');
+      expect(addSpyTCP.calledOnce).to.be.true;
+      expect(
+        addSpyTCP.calledWith(
+          sinon.match.any,
+          sinon.match.any,
+          sinon.match.any,
+          sinon.match({ param: 'value' }),
+        ),
+      ).to.be.true;
+    });
     describe('when request scoped', () => {
       it(`should call "addHandler" with deferred proxy`, () => {
         explorer.expects('explore').returns(handlers);
@@ -140,12 +203,12 @@ describe('ListenersController', () => {
         () =>
           ({
             handle: handleSpy,
-          } as any),
+          }) as any,
       );
 
       sinon
         .stub((instance as any).container, 'registerRequestProvider')
-        .callsFake(() => ({} as any));
+        .callsFake(() => ({}) as any);
     });
 
     describe('when "loadPerContext" resolves', () => {
@@ -154,7 +217,7 @@ describe('ListenersController', () => {
       const module = {
         controllers: new Map(),
       } as any;
-      const pattern = {};
+      const patterns = [{}];
       const wrapper = new InstanceWrapper({ instance: { [methodKey]: {} } });
 
       it('should pass all arguments to the proxy chain', async () => {
@@ -163,7 +226,7 @@ describe('ListenersController', () => {
           .callsFake(() => Promise.resolve({}));
         const handler = instance.createRequestScopedHandler(
           wrapper,
-          pattern,
+          patterns,
           module,
           moduleKey,
           methodKey,
@@ -182,16 +245,16 @@ describe('ListenersController', () => {
       const module = {
         controllers: new Map(),
       } as any;
-      const pattern = {};
+      const patterns = [{}];
       const wrapper = new InstanceWrapper({ instance: { [methodKey]: {} } });
 
-      it('should delegete error to exception filters', async () => {
+      it('should delegate error to exception filters', async () => {
         sinon.stub(injector, 'loadPerContext').callsFake(() => {
           throw new Error();
         });
         const handler = instance.createRequestScopedHandler(
           wrapper,
-          pattern,
+          patterns,
           module,
           moduleKey,
           methodKey,
@@ -207,8 +270,51 @@ describe('ListenersController', () => {
     });
   });
 
+  describe('insertEntrypointDefinition', () => {
+    it('should inspect & insert corresponding entrypoint definitions', () => {
+      class TestCtrl {}
+      const instanceWrapper = new InstanceWrapper({
+        metatype: TestCtrl,
+        name: TestCtrl.name,
+      });
+      const definition: EventOrMessageListenerDefinition = {
+        patterns: ['findOne'],
+        methodKey: 'find',
+        isEventHandler: false,
+        targetCallback: null!,
+        extras: { qos: 2 },
+      };
+      const transportId = Transport.MQTT;
+
+      const insertEntrypointDefinitionSpy = sinon.spy(
+        graphInspector,
+        'insertEntrypointDefinition',
+      );
+      instance.insertEntrypointDefinition(
+        instanceWrapper,
+        definition,
+        transportId,
+      );
+      expect(
+        insertEntrypointDefinitionSpy.calledWith({
+          type: 'microservice',
+          methodName: definition.methodKey,
+          className: 'TestCtrl',
+          classNodeId: instanceWrapper.id,
+          metadata: {
+            key: definition.patterns.toString(),
+            transportId: 'MQTT',
+            patterns: definition.patterns,
+            isEventHandler: definition.isEventHandler,
+            extras: definition.extras,
+          } as any,
+        }),
+      ).to.be.true;
+    });
+  });
+
   describe('assignClientToInstance', () => {
-    it('should assing client to instance', () => {
+    it('should assign client to instance', () => {
       const propertyKey = 'key';
       const object = {};
       const client = { test: true };
diff --git a/packages/microservices/test/listeners-metadata-explorer.spec.ts b/packages/microservices/test/listeners-metadata-explorer.spec.ts
index 01b63413a..079beeffb 100644
--- a/packages/microservices/test/listeners-metadata-explorer.spec.ts
+++ b/packages/microservices/test/listeners-metadata-explorer.spec.ts
@@ -2,15 +2,20 @@ import { expect } from 'chai';
 import * as sinon from 'sinon';
 import { MetadataScanner } from '../../core/metadata-scanner';
 import { Client } from '../decorators/client.decorator';
+import { EventPattern } from '../decorators/event-pattern.decorator';
 import { MessagePattern } from '../decorators/message-pattern.decorator';
 import { Transport } from '../enums/transport.enum';
 import { ListenerMetadataExplorer } from '../listener-metadata-explorer';
 
 describe('ListenerMetadataExplorer', () => {
-  const pattern = { pattern: 'test' };
-  const secPattern = { role: '2', cmd: 'm' };
+  const msgPattern = { pattern: 'testMsg' };
+  const firstMultipleMsgPattern = { pattern: 'testMultipleMsg1' };
+  const secondMultipleMsgPattern = { pattern: 'testMultipleMsg2' };
   const clientMetadata = {};
   const clientSecMetadata = { transport: Transport.REDIS };
+  const evtPattern = { role: 'testEvt' };
+  const firstMultipleEvtPattern = { role: 'testMultipleEvt1' };
+  const secondMultipleEvtPattern = { role: 'testMultipleEvt2' };
 
   class Test {
     @Client(clientMetadata as any)
@@ -25,11 +30,17 @@ describe('ListenerMetadataExplorer', () => {
 
     constructor() {}
 
-    @MessagePattern(pattern)
-    public test() {}
+    @MessagePattern(msgPattern)
+    public testMessage() {}
 
-    @MessagePattern(secPattern)
-    public testSec() {}
+    @MessagePattern([firstMultipleMsgPattern, secondMultipleMsgPattern])
+    public testMultipleMessage() {}
+
+    @EventPattern(evtPattern)
+    public testEvent() {}
+
+    @EventPattern([firstMultipleEvtPattern, secondMultipleEvtPattern])
+    public testMultipleEvent() {}
 
     public noPattern() {}
   }
@@ -41,17 +52,16 @@ describe('ListenerMetadataExplorer', () => {
     instance = new ListenerMetadataExplorer(scanner);
   });
   describe('explore', () => {
-    let scanFromPrototype: sinon.SinonSpy;
+    let getAllMethodNames: sinon.SinonSpy;
     beforeEach(() => {
-      scanFromPrototype = sinon.spy(scanner, 'scanFromPrototype');
+      getAllMethodNames = sinon.spy(scanner, 'getAllMethodNames');
     });
     it(`should call "scanFromPrototype" with expected arguments`, () => {
       const obj = new Test();
       instance.explore(obj);
 
-      const { args } = scanFromPrototype.getCall(0);
-      expect(args[0]).to.be.eql(obj);
-      expect(args[1]).to.be.eql(Object.getPrototypeOf(obj));
+      const { args } = getAllMethodNames.getCall(0);
+      expect(args[0]).to.be.eql(Object.getPrototypeOf(obj));
     });
   });
   describe('exploreMethodMetadata', () => {
@@ -61,24 +71,87 @@ describe('ListenerMetadataExplorer', () => {
     });
     it(`should return undefined when "handlerType" metadata is undefined`, () => {
       const metadata = instance.exploreMethodMetadata(
+        test,
         Object.getPrototypeOf(test),
         'noPattern',
       );
       expect(metadata).to.eq(undefined);
     });
-    it(`should return pattern properties when "handlerType" metadata is not undefined`, () => {
-      const metadata = instance.exploreMethodMetadata(
-        Object.getPrototypeOf(test),
-        'test',
-      );
-      expect(metadata).to.have.keys([
-        'isEventHandler',
-        'methodKey',
-        'targetCallback',
-        'pattern',
-        'transport',
-      ]);
-      expect(metadata.pattern).to.eql(pattern);
+
+    describe('@MessagePattern', () => {
+      it(`should return pattern properties when "handlerType" metadata is not undefined`, () => {
+        const metadata = instance.exploreMethodMetadata(
+          test,
+          Object.getPrototypeOf(test),
+          'testMessage',
+        )!;
+        expect(metadata).to.have.keys([
+          'isEventHandler',
+          'methodKey',
+          'targetCallback',
+          'patterns',
+          'transport',
+          'extras',
+        ]);
+        expect(metadata.patterns.length).to.eql(1);
+        expect(metadata.patterns[0]).to.eql(msgPattern);
+      });
+      it(`should return multiple patterns when more than one is declared`, () => {
+        const metadata = instance.exploreMethodMetadata(
+          test,
+          Object.getPrototypeOf(test),
+          'testMultipleMessage',
+        )!;
+        expect(metadata).to.have.keys([
+          'isEventHandler',
+          'methodKey',
+          'targetCallback',
+          'patterns',
+          'transport',
+          'extras',
+        ]);
+        expect(metadata.patterns.length).to.eql(2);
+        expect(metadata.patterns[0]).to.eql(firstMultipleMsgPattern);
+        expect(metadata.patterns[1]).to.eql(secondMultipleMsgPattern);
+      });
+    });
+
+    describe('@EventPattern', () => {
+      it(`should return pattern properties when "handlerType" metadata is not undefined`, () => {
+        const metadata = instance.exploreMethodMetadata(
+          test,
+          Object.getPrototypeOf(test),
+          'testEvent',
+        )!;
+        expect(metadata).to.have.keys([
+          'isEventHandler',
+          'methodKey',
+          'targetCallback',
+          'patterns',
+          'transport',
+          'extras',
+        ]);
+        expect(metadata.patterns.length).to.eql(1);
+        expect(metadata.patterns[0]).to.eql(evtPattern);
+      });
+      it(`should return multiple patterns when more than one is declared`, () => {
+        const metadata = instance.exploreMethodMetadata(
+          test,
+          Object.getPrototypeOf(test),
+          'testMultipleEvent',
+        )!;
+        expect(metadata).to.have.keys([
+          'isEventHandler',
+          'methodKey',
+          'targetCallback',
+          'patterns',
+          'transport',
+          'extras',
+        ]);
+        expect(metadata.patterns.length).to.eql(2);
+        expect(metadata.patterns[0]).to.eql(firstMultipleEvtPattern);
+        expect(metadata.patterns[1]).to.eql(secondMultipleEvtPattern);
+      });
     });
   });
   describe('scanForClientHooks', () => {
diff --git a/packages/microservices/test/module/clients.module.spec.ts b/packages/microservices/test/module/clients.module.spec.ts
index 5b2ef509e..454b8f280 100644
--- a/packages/microservices/test/module/clients.module.spec.ts
+++ b/packages/microservices/test/module/clients.module.spec.ts
@@ -1,4 +1,9 @@
-import { DynamicModule, FactoryProvider, Injectable } from '@nestjs/common';
+import {
+  DynamicModule,
+  FactoryProvider,
+  Injectable,
+  ValueProvider,
+} from '@nestjs/common';
 import { expect } from 'chai';
 import * as sinon from 'sinon';
 import { ClientProxyFactory } from '../../client';
@@ -21,14 +26,13 @@ describe('ClientsModule', () => {
       expect(dynamicModule.module).to.be.eql(ClientsModule);
     });
     it('should return an expected providers array', () => {
-      expect(dynamicModule.providers).to.be.deep.eq([
-        {
-          provide: 'test',
-          useValue: ClientsModule['assignOnAppShutdownHook'](
-            ClientProxyFactory.create({}),
-          ),
-        },
-      ]);
+      const provider = dynamicModule.providers!.find(
+        p => 'useValue' in p && p.provide === 'test',
+      ) as ValueProvider;
+      expect(provider).to.not.be.undefined;
+      expect(provider.useValue).to.be.deep.eq(
+        ClientsModule['assignOnAppShutdownHook'](ClientProxyFactory.create({})),
+      );
     });
   });
   describe('registerAsync', () => {
@@ -52,7 +56,7 @@ describe('ClientsModule', () => {
         expect(dynamicModule.exports).to.be.eq(dynamicModule.providers);
         expect(dynamicModule.providers).to.be.have.length(1);
 
-        const provider = dynamicModule.providers[0] as FactoryProvider;
+        const provider = dynamicModule.providers![0] as FactoryProvider;
         expect(provider.provide).to.be.eql('test');
         expect(provider.inject).to.be.deep.eq([]);
         expect(provider.useFactory).to.be.an.instanceOf(Function);
@@ -78,7 +82,8 @@ describe('ClientsModule', () => {
         expect(dynamicModule.imports).to.be.deep.eq([]);
         expect(dynamicModule.providers).to.be.have.length(2);
 
-        const classTestProvider = dynamicModule.providers[0] as FactoryProvider;
+        const classTestProvider = dynamicModule
+          .providers![0] as FactoryProvider;
         expect(classTestProvider.provide).to.be.eql('classTest');
         expect(classTestProvider.inject).to.be.deep.eq([ClientOptionService]);
         expect(classTestProvider.useFactory).to.be.an.instanceOf(Function);
@@ -94,9 +99,7 @@ describe('ClientsModule', () => {
           createClientOptions: sinon.spy(),
         };
         try {
-          await ((dynamicModule.providers[0] as any).useFactory as any)(
-            optionsFactory,
-          );
+          await (dynamicModule.providers![0] as any).useFactory(optionsFactory);
         } catch (e) {
           console.log(e);
         }
@@ -112,7 +115,8 @@ describe('ClientsModule', () => {
         dynamicModule = ClientsModule.registerAsync([asyncOptions as any]);
         expect(dynamicModule.providers).to.have.length(1);
         expect(dynamicModule.imports).to.be.deep.eq([]);
-        const classTestProvider = dynamicModule.providers[0] as FactoryProvider;
+        const classTestProvider = dynamicModule
+          .providers![0] as FactoryProvider;
         expect(classTestProvider.useFactory).to.be.an.instanceOf(Function);
       });
     });
diff --git a/packages/microservices/test/serializers/kafka-request.serializer.spec.ts b/packages/microservices/test/serializers/kafka-request.serializer.spec.ts
index 5cde5292e..566e86d95 100644
--- a/packages/microservices/test/serializers/kafka-request.serializer.spec.ts
+++ b/packages/microservices/test/serializers/kafka-request.serializer.spec.ts
@@ -8,51 +8,51 @@ describe('KafkaRequestSerializer', () => {
     instance = new KafkaRequestSerializer();
   });
   describe('serialize', () => {
-    it('undefined', () => {
-      expect(instance.serialize(undefined)).to.deep.eq({
+    it('undefined', async () => {
+      expect(await instance.serialize(undefined)).to.deep.eq({
         headers: {},
         value: null,
       });
     });
 
-    it('null', () => {
-      expect(instance.serialize(null)).to.deep.eq({
+    it('null', async () => {
+      expect(await instance.serialize(null)).to.deep.eq({
         headers: {},
         value: null,
       });
     });
 
-    it('string', () => {
-      expect(instance.serialize('string')).to.deep.eq({
+    it('string', async () => {
+      expect(await instance.serialize('string')).to.deep.eq({
         headers: {},
         value: 'string',
       });
     });
 
-    it('number', () => {
-      expect(instance.serialize(12345)).to.deep.eq({
+    it('number', async () => {
+      expect(await instance.serialize(12345)).to.deep.eq({
         headers: {},
         value: '12345',
       });
     });
 
-    it('buffer', () => {
-      expect(instance.serialize(Buffer.from('buffer'))).to.deep.eq({
+    it('buffer', async () => {
+      expect(await instance.serialize(Buffer.from('buffer'))).to.deep.eq({
         headers: {},
         value: Buffer.from('buffer'),
       });
     });
 
-    it('array', () => {
-      expect(instance.serialize([1, 2, 3, 4, 5])).to.deep.eq({
+    it('array', async () => {
+      expect(await instance.serialize([1, 2, 3, 4, 5])).to.deep.eq({
         headers: {},
         value: '[1,2,3,4,5]',
       });
     });
 
-    it('object', () => {
+    it('object', async () => {
       expect(
-        instance.serialize({
+        await instance.serialize({
           prop: 'value',
         }),
       ).to.deep.eq({
@@ -61,7 +61,7 @@ describe('KafkaRequestSerializer', () => {
       });
     });
 
-    it('complex object with .toString()', () => {
+    it('complex object with .toString()', async () => {
       class Complex {
         private readonly name = 'complex';
         public toString(): string {
@@ -69,28 +69,30 @@ describe('KafkaRequestSerializer', () => {
         }
       }
 
-      expect(instance.serialize(new Complex())).to.deep.eq({
+      expect(await instance.serialize(new Complex())).to.deep.eq({
         headers: {},
         value: 'complex',
       });
     });
 
-    it('complex object without .toString()', () => {
+    it('complex object without .toString()', async () => {
       class ComplexWithOutToString {
         private readonly name = 'complex';
       }
 
-      expect(instance.serialize(new ComplexWithOutToString())).to.deep.eq({
-        headers: {},
-        value: '[object Object]',
-      });
+      expect(await instance.serialize(new ComplexWithOutToString())).to.deep.eq(
+        {
+          headers: {},
+          value: '[object Object]',
+        },
+      );
     });
   });
 
   describe('serialize kafka message', () => {
-    it('kafka message without key', () => {
+    it('kafka message without key', async () => {
       expect(
-        instance.serialize({
+        await instance.serialize({
           value: 'string',
         }),
       ).to.deep.eq({
@@ -99,9 +101,9 @@ describe('KafkaRequestSerializer', () => {
       });
     });
 
-    it('kafka message with key', () => {
+    it('kafka message with key', async () => {
       expect(
-        instance.serialize({
+        await instance.serialize({
           key: '1',
           value: 'string',
         }),
@@ -112,9 +114,9 @@ describe('KafkaRequestSerializer', () => {
       });
     });
 
-    it('kafka message with headers', () => {
+    it('kafka message with headers', async () => {
       expect(
-        instance.serialize({
+        await instance.serialize({
           key: '1',
           value: 'string',
           headers: {
diff --git a/packages/microservices/test/serializers/mqtt-record.serializer.spec.ts b/packages/microservices/test/serializers/mqtt-record.serializer.spec.ts
index 3ba488841..d95d96643 100644
--- a/packages/microservices/test/serializers/mqtt-record.serializer.spec.ts
+++ b/packages/microservices/test/serializers/mqtt-record.serializer.spec.ts
@@ -8,7 +8,7 @@ describe('MqttRecordSerializer', () => {
     instance = new MqttRecordSerializer();
   });
   describe('serialize', () => {
-    it('should parse mqtt record instance to a string, ignoring options', () => {
+    it('should parse mqtt record instance', () => {
       const mqttMessage = new MqttRecordBuilder()
         .setData({ value: 'string' })
         .setQoS(1)
@@ -19,19 +19,21 @@ describe('MqttRecordSerializer', () => {
 
       expect(
         instance.serialize({
+          pattern: 'pattern',
           data: mqttMessage,
         }),
-      ).to.eq(
-        JSON.stringify({
-          data: { value: 'string' },
-        }),
-      );
+      ).to.deep.eq({
+        pattern: 'pattern',
+        options: { qos: 1, retain: true, dup: true, properties: {} },
+        data: { value: 'string' },
+      });
     });
-    it('should act as an stringified indentity function if msg is not an instance of MqttRecord class', () => {
+    it('should act as an identity function if msg is not an instance of MqttRecord class', () => {
       const packet = {
+        pattern: 'pattern',
         data: { random: true },
       };
-      expect(instance.serialize(packet)).to.eq(JSON.stringify(packet));
+      expect(instance.serialize(packet)).to.eq(packet);
     });
   });
 });
diff --git a/packages/microservices/test/serializers/rmq-record.serializer.spec.ts b/packages/microservices/test/serializers/rmq-record.serializer.spec.ts
index 8551d823f..b9dc42028 100644
--- a/packages/microservices/test/serializers/rmq-record.serializer.spec.ts
+++ b/packages/microservices/test/serializers/rmq-record.serializer.spec.ts
@@ -3,6 +3,8 @@ import { RmqRecordBuilder } from '../../record-builders';
 import { RmqRecordSerializer } from '../../serializers/rmq-record.serializer';
 
 describe('RmqRecordSerializer', () => {
+  const pattern = 'test';
+
   let instance: RmqRecordSerializer;
   beforeEach(() => {
     instance = new RmqRecordSerializer();
@@ -16,16 +18,19 @@ describe('RmqRecordSerializer', () => {
 
       expect(
         instance.serialize({
+          pattern,
           data: rmqMessage,
         }),
       ).to.deep.eq({
+        pattern,
         options: { appId: 'app', persistent: true },
         data: { value: 'string' },
       });
     });
 
-    it('should act as an indentity function if msg is not an instance of RmqRecord class', () => {
+    it('should act as an identity function if msg is not an instance of RmqRecord class', () => {
       const packet = {
+        pattern,
         data: { random: true },
       };
       expect(instance.serialize(packet)).to.eq(packet);
diff --git a/packages/microservices/test/server/server-grpc.spec.ts b/packages/microservices/test/server/server-grpc.spec.ts
index 8f9f8dd6f..6f1e40888 100644
--- a/packages/microservices/test/server/server-grpc.spec.ts
+++ b/packages/microservices/test/server/server-grpc.spec.ts
@@ -1,12 +1,15 @@
 import { Logger } from '@nestjs/common';
 import { expect } from 'chai';
 import { join } from 'path';
-import { of } from 'rxjs';
+import { ReplaySubject, Subject, throwError } from 'rxjs';
 import * as sinon from 'sinon';
-import { CANCEL_EVENT } from '../../constants';
 import { InvalidGrpcPackageException } from '../../errors/invalid-grpc-package.exception';
+import { InvalidProtoDefinitionException } from '../../errors/invalid-proto-definition.exception';
+import * as grpcHelpers from '../../helpers/grpc-helpers';
 import { GrpcMethodStreamingType } from '../../index';
-import { ServerGrpc } from '../../server/server-grpc';
+import { ServerGrpc } from '../../server';
+
+const CANCELLED_EVENT = 'cancelled';
 
 class NoopLogger extends Logger {
   log(message: any, context?: string): void {}
@@ -16,13 +19,15 @@ class NoopLogger extends Logger {
 
 describe('ServerGrpc', () => {
   let server: ServerGrpc;
+  let untypedServer: any;
   let serverMulti: ServerGrpc;
 
   beforeEach(() => {
     server = new ServerGrpc({
       protoPath: join(__dirname, './test.proto'),
       package: 'test',
-    } as any);
+    });
+    untypedServer = server as any;
 
     serverMulti = new ServerGrpc({
       protoPath: ['test.proto', 'test2.proto'],
@@ -41,24 +46,17 @@ describe('ServerGrpc', () => {
       callback = sinon.spy();
       bindEventsStub = sinon
         .stub(server, 'bindEvents')
-        .callsFake(() => ({} as any));
+        .callsFake(() => ({}) as any);
     });
 
     it('should call "bindEvents"', async () => {
       await server.listen(callback);
-      server.close();
+      await server.close();
       expect(bindEventsStub.called).to.be.true;
     });
-    it('should call "client.start"', async () => {
-      const client = { start: sinon.spy() };
-      sinon.stub(server, 'createClient').callsFake(async () => client);
-
-      await server.listen(callback);
-      expect(client.start.called).to.be.true;
-    });
     it('should call callback', async () => {
       await server.listen(callback);
-      server.close();
+      await server.close();
       expect(callback.called).to.be.true;
     });
     describe('when "start" throws an exception', () => {
@@ -85,23 +83,17 @@ describe('ServerGrpc', () => {
       callback = sinon.spy();
       bindEventsStub = sinon
         .stub(serverMulti, 'bindEvents')
-        .callsFake(() => ({} as any));
+        .callsFake(() => ({}) as any);
     });
 
     it('should call "bindEvents"', async () => {
       await serverMulti.listen(callback);
-      serverMulti.close();
+      await serverMulti.close();
       expect(bindEventsStub.called).to.be.true;
     });
-    it('should call "client.start"', async () => {
-      const client = { start: sinon.spy() };
-      sinon.stub(serverMulti, 'createClient').callsFake(async () => client);
-      await serverMulti.listen(callback);
-      expect(client.start.called).to.be.true;
-    });
     it('should call callback', async () => {
       await serverMulti.listen(callback);
-      serverMulti.close();
+      await serverMulti.close();
       expect(callback.called).to.be.true;
     });
   });
@@ -113,7 +105,7 @@ describe('ServerGrpc', () => {
     describe('when package does not exist', () => {
       it('should throw "InvalidGrpcPackageException"', async () => {
         sinon.stub(server, 'lookupPackage').callsFake(() => null);
-        (server as any).logger = new NoopLogger();
+        untypedServer.logger = new NoopLogger();
         try {
           await server.bindEvents();
         } catch (err) {
@@ -138,10 +130,10 @@ describe('ServerGrpc', () => {
           test2: { service: true },
         }));
         sinon.stub(server, 'getServiceNames').callsFake(() => serviceNames);
-        (server as any).grpcClient = { addService: sinon.spy() };
+        untypedServer.grpcClient = { addService: sinon.spy() };
 
         await server.bindEvents();
-        expect((server as any).grpcClient.addService.calledTwice).to.be.true;
+        expect(untypedServer.grpcClient.addService.calledTwice).to.be.true;
       });
     });
   });
@@ -224,8 +216,8 @@ describe('ServerGrpc', () => {
 
       const spy = sinon
         .stub(server, 'createServiceMethod')
-        .callsFake(() => ({} as any));
-      (server as any).messageHandlers = handlers;
+        .callsFake(() => ({}) as any);
+      untypedServer.messageHandlers = handlers;
       await server.createService(
         {
           prototype: { test: true, test2: true },
@@ -246,8 +238,8 @@ describe('ServerGrpc', () => {
           .onFirstCall()
           .returns('test2');
 
-        sinon.stub(server, 'createServiceMethod').callsFake(() => ({} as any));
-        (server as any).messageHandlers = handlers;
+        sinon.stub(server, 'createServiceMethod').callsFake(() => ({}) as any);
+        untypedServer.messageHandlers = handlers;
         await server.createService(
           {
             prototype: {
@@ -279,10 +271,12 @@ describe('ServerGrpc', () => {
           .onFirstCall()
           .returns('_invalid')
           .onSecondCall()
+          .returns('_invalid')
+          .onThirdCall()
           .returns('test2');
 
-        sinon.stub(server, 'createServiceMethod').callsFake(() => ({} as any));
-        (server as any).messageHandlers = handlers;
+        sinon.stub(server, 'createServiceMethod').callsFake(() => ({}) as any);
+        untypedServer.messageHandlers = handlers;
         await server.createService(
           {
             prototype: {
@@ -304,6 +298,69 @@ describe('ServerGrpc', () => {
     });
   });
 
+  describe('getMessageHandler', () => {
+    it('should return handler when service name specified', () => {
+      const testPattern = server.createPattern(
+        'test',
+        'TestMethod',
+        GrpcMethodStreamingType.NO_STREAMING,
+      );
+      const handlers = new Map([[testPattern, () => ({})]]);
+      console.log(handlers.entries());
+      untypedServer.messageHandlers = handlers;
+
+      expect(
+        server.getMessageHandler(
+          'test',
+          'TestMethod',
+          GrpcMethodStreamingType.NO_STREAMING,
+          {},
+        ),
+      ).not.to.be.undefined;
+    });
+    it('should return handler when package name specified with service name', () => {
+      const testPattern = server.createPattern(
+        'package.example.test',
+        'TestMethod',
+        GrpcMethodStreamingType.NO_STREAMING,
+      );
+      const handlers = new Map([[testPattern, () => ({})]]);
+      untypedServer.messageHandlers = handlers;
+
+      expect(
+        server.getMessageHandler(
+          'test',
+          'TestMethod',
+          GrpcMethodStreamingType.NO_STREAMING,
+          {
+            path: '/package.example.test/TestMethod',
+          },
+        ),
+      ).not.to.be.undefined;
+    });
+
+    it('should return undefined when method name is unknown', () => {
+      const testPattern = server.createPattern(
+        'package.example.test',
+        'unknown',
+        GrpcMethodStreamingType.NO_STREAMING,
+      );
+      const handlers = new Map([[testPattern, () => ({})]]);
+      untypedServer.messageHandlers = handlers;
+
+      expect(
+        server.getMessageHandler(
+          'test',
+          'TestMethod',
+          GrpcMethodStreamingType.NO_STREAMING,
+          {
+            path: '/package.example.test/TestMethod',
+          },
+        ),
+      ).to.be.undefined;
+    });
+  });
+
   describe('createPattern', () => {
     it('should return pattern', () => {
       const service = 'test';
@@ -386,43 +443,89 @@ describe('ServerGrpc', () => {
       const fn = server.createStreamServiceMethod(sinon.spy());
       expect(fn).to.be.a('function');
     });
+
     describe('on call', () => {
       it('should call native method', async () => {
         const call = {
-          write: sinon.spy(),
+          write: sinon.spy(() => true),
           end: sinon.spy(),
-          addListener: sinon.spy(),
-          removeListener: sinon.spy(),
+          on: sinon.spy(),
+          off: sinon.spy(),
         };
         const callback = sinon.spy();
         const native = sinon.spy();
 
         await server.createStreamServiceMethod(native)(call, callback);
         expect(native.called).to.be.true;
-        expect(call.addListener.calledWith('cancelled')).to.be.true;
-        expect(call.removeListener.calledWith('cancelled')).to.be.true;
+        expect(call.on.calledWith('cancelled')).to.be.true;
+        expect(call.off.calledWith('cancelled')).to.be.true;
       });
 
-      it(`should close the result observable when receiving an 'cancelled' event from the client`, async () => {
-        let cancelCb: () => void;
+      it('should handle error thrown in handler', async () => {
         const call = {
-          write: sinon
-            .stub()
-            .onSecondCall()
-            .callsFake(() => cancelCb()),
+          write: sinon.spy(() => true),
           end: sinon.spy(),
-          addListener: (name, cb) => (cancelCb = cb),
-          removeListener: sinon.spy(),
+          on: sinon.spy(),
+          off: sinon.spy(),
+          emit: sinon.spy(),
         };
-        const result$ = of(1, 2, 3);
+
         const callback = sinon.spy();
-        const native = sinon
-          .stub()
-          .returns(new Promise((resolve, reject) => resolve(result$)));
+        const error = new Error('handler threw');
+        const native = sinon.spy(() => throwError(() => error));
 
+        // implicit assertion that this will never throw when call.emit emits an error event
         await server.createStreamServiceMethod(native)(call, callback);
-        expect(call.write.calledTwice).to.be.true;
+        expect(native.called).to.be.true;
+        expect(call.emit.calledWith('error', error)).to.be.ok;
+        expect(call.end.called).to.be.true;
+      });
+
+      it(`should close the result observable when receiving an 'cancelled' event from the client`, async () => {
+        const et = new EventTarget();
+        const cancel = () => et.dispatchEvent(new Event('cancelled'));
+
+        const written: any[] = [];
+        const call = {
+          write: sinon.spy((value: any) => {
+            written.push(value);
+            return true;
+          }),
+          end: sinon.spy(() => written.push('end')),
+          on: sinon.spy((name, cb) => {
+            et.addEventListener(name, cb);
+          }),
+          off: sinon.spy((name, cb) => {
+            et.removeEventListener(name, cb);
+          }),
+        };
+
+        const result$ = new Subject<number>();
+        const resolvedObservable = Promise.resolve(result$);
+        const callback = sinon.spy();
+        const native = sinon.stub().returns(resolvedObservable);
+
+        const result = server.createStreamServiceMethod(native)(call, callback);
+
+        await resolvedObservable;
+
+        result$.next(1);
+        expect(written).to.deep.equal([1]);
+        result$.next(2);
+        expect(written).to.deep.equal([1, 2]);
+        result$.next(3);
+        expect(written).to.deep.equal([1, 2, 3]);
+        cancel();
+        result$.next(4);
+        expect(written).to.deep.equal([1, 2, 3, 'end']);
+
         expect(call.end.called).to.be.true;
+        expect(call.on.calledWith('cancelled')).to.be.true;
+        expect(call.on.calledWith('drain')).to.be.true;
+        expect(call.off.calledWith('cancelled')).to.be.true;
+        expect(call.off.calledWith('drain')).to.be.true;
+
+        await result;
       });
     });
   });
@@ -442,11 +545,34 @@ describe('ServerGrpc', () => {
         expect(native.called).to.be.true;
         expect(callback.called).to.be.true;
       });
+
+      it('should await when a promise is return by the native', async () => {
+        const call = { write: sinon.spy(), end: sinon.spy() };
+        const callback = sinon.spy();
+
+        const original = { native: Function };
+        const mock = sinon.mock(original);
+
+        mock
+          .expects('native')
+          .once()
+          .returns(
+            (() => {
+              const sub = new ReplaySubject<any>(1);
+              sub.next(new Promise(resolve => resolve({ foo: 'bar' })));
+              return sub.asObservable();
+            })(),
+          );
+
+        await server.createUnaryServiceMethod(original.native)(call, callback);
+        mock.verify();
+        expect(callback.calledWith(null, { foo: 'bar' })).to.be.true;
+      });
     });
   });
 
   describe('createRequestStreamMethod', () => {
-    it('should wrap call into Subject', () => {
+    it('should wrap call into Subject', async () => {
       const handler = sinon.spy();
       const fn = server.createRequestStreamMethod(handler, false);
       const call = {
@@ -455,12 +581,12 @@ describe('ServerGrpc', () => {
         end: sinon.spy(),
         write: sinon.spy(),
       };
-      fn(call as any, sinon.spy());
+      await fn(call as any, sinon.spy());
 
       expect(handler.called).to.be.true;
     });
 
-    it('should wrap call into Subject with metadata', () => {
+    it('should wrap call into Subject with metadata', async () => {
       const handler = sinon.spy();
       const fn = server.createRequestStreamMethod(handler, false);
       const call = {
@@ -472,24 +598,25 @@ describe('ServerGrpc', () => {
           test: '123',
         },
       };
-      fn(call as any, sinon.spy());
+      await fn(call as any, sinon.spy());
 
       expect(handler.called).to.be.true;
       expect(handler.args[0][1]).to.eq(call.metadata);
     });
+
     describe('when response is not a stream', () => {
       it('should call callback', async () => {
         const handler = async () => ({ test: true });
         const fn = server.createRequestStreamMethod(handler, false);
         const call = {
           on: (event, callback) => {
-            if (event !== CANCEL_EVENT) {
+            if (event !== CANCELLED_EVENT) {
               callback();
             }
           },
           off: sinon.spy(),
           end: sinon.spy(),
-          write: sinon.spy(),
+          write: sinon.spy(() => false),
         };
 
         const responseCallback = sinon.spy();
@@ -497,47 +624,283 @@ describe('ServerGrpc', () => {
 
         expect(responseCallback.called).to.be.true;
       });
+
+      it('should handle error thrown in handler', async () => {
+        const error = new Error('Error');
+        const handler = async () => throwError(() => error);
+        const fn = server.createRequestStreamMethod(handler, false);
+        const call = {
+          on: (event, callback) => {
+            if (event !== CANCELLED_EVENT) {
+              callback();
+            }
+          },
+          off: sinon.spy(),
+          end: sinon.spy(),
+          write: sinon.spy(),
+        };
+
+        const responseCallback = sinon.spy();
+        await fn(call as any, responseCallback);
+
+        expect(responseCallback.calledOnce).to.be.true;
+        expect(responseCallback.firstCall.args).to.eql([error, null]);
+      });
+
       describe('when response is a stream', () => {
-        it('should call write() and end()', async () => {
+        /**
+         * A helper to create a repeated fixture to test streaming writes against.
+         */
+        async function createCall() {
+          const emitter = new EventTarget();
+
+          // If we write more than this number, the call will become unwritable.
+          const highwaterMark = 2;
+          let writeCounter = 0;
+
+          // What has been "written" so far.
+          const written: any[] = [];
+
+          const drain = () => {
+            writeCounter = 0;
+            emitter.dispatchEvent(new Event('drain'));
+          };
+
+          const cancel = () => {
+            emitter.dispatchEvent(new Event(CANCELLED_EVENT));
+          };
+
+          const call = {
+            write: sinon.spy(value => {
+              // Simulating a writable stream becoming overwhelmed.
+              if (writeCounter++ < highwaterMark) {
+                // We can write this value to the stream.
+                written.push(value);
+              }
+              // But as soon as we pass the highwater mark, we can't write anymore.
+              return writeCounter < highwaterMark;
+            }),
+            end: sinon.spy(() => {
+              written.push('end');
+            }),
+            emit: sinon.spy(),
+            request: sinon.spy(),
+            metadata: sinon.spy(),
+            sendMetadata: sinon.spy(),
+            on: (name, cb) => {
+              emitter.addEventListener(name, cb);
+            },
+            off: (name, cb) => {
+              emitter.removeEventListener(name, cb);
+            },
+            fire: {
+              drain,
+              cancel,
+            },
+          };
+
+          const callback = sinon.spy();
+
+          const subject = new Subject<string>();
+          const handlerResult = Promise.resolve(subject);
+          const methodHandler = () => handlerResult;
+
+          const serviceMethod = server.createRequestStreamMethod(
+            methodHandler,
+            true,
+          );
+
+          const result = serviceMethod(call, callback);
+
+          await handlerResult;
+
+          return { call, written, result, subject };
+        }
+
+        it('should call write() and end() for streams from promises', async () => {
           const handler = async () => ({ test: true });
           const fn = server.createRequestStreamMethod(handler, true);
           const call = {
             on: (event, callback) => {
-              if (event !== CANCEL_EVENT) {
+              if (event !== CANCELLED_EVENT) {
                 callback();
               }
             },
             off: sinon.spy(),
             end: sinon.spy(),
-            write: sinon.spy(),
+            write: sinon.spy(() => true),
           };
 
-          await fn(call as any, null);
+          await fn(call as any, null!);
 
           expect(call.write.called).to.be.true;
           expect(call.end.called).to.be.true;
         });
+
+        it('should drain all values emitted from the observable while waiting for the drain event from the call', async () => {
+          const { call, written, result, subject } = await createCall();
+
+          subject.next('a');
+          subject.next('b');
+          expect(written).to.deep.equal(['a', 'b']);
+          subject.next('c'); // can't be written yet.
+          expect(written).to.deep.equal(['a', 'b']);
+          call.fire.drain();
+          subject.next('d');
+          expect(written).to.deep.equal(['a', 'b', 'c', 'd']);
+          subject.next('e'); // can't be written yet.
+          expect(written).to.deep.equal(['a', 'b', 'c', 'd']);
+          call.fire.drain();
+          expect(written).to.deep.equal(['a', 'b', 'c', 'd', 'e']);
+          subject.next('f');
+          expect(written).to.deep.equal(['a', 'b', 'c', 'd', 'e', 'f']);
+          subject.complete();
+          expect(written).to.deep.equal(['a', 'b', 'c', 'd', 'e', 'f', 'end']);
+
+          return result;
+        });
+
+        it(
+          'should drain all values emitted from the observable while waiting for the drain event from the call ' +
+            'even if the call becomes unwritable during draining',
+          async () => {
+            const { call, written, result, subject } = await createCall();
+
+            subject.next('a');
+            subject.next('b');
+            subject.next('c');
+            subject.next('d');
+            subject.next('e');
+            expect(written).to.deep.equal(['a', 'b']);
+            call.fire.drain();
+            expect(written).to.deep.equal(['a', 'b', 'c', 'd']);
+            call.fire.drain();
+            expect(written).to.deep.equal(['a', 'b', 'c', 'd', 'e']);
+            subject.complete();
+            expect(written).to.deep.equal(['a', 'b', 'c', 'd', 'e', 'end']);
+
+            return result;
+          },
+        );
+
+        it('should wait to end until after the internal buffer has drained', async () => {
+          const { call, written, result, subject } = await createCall();
+
+          subject.next('a');
+          subject.next('b');
+          subject.next('c');
+          subject.next('d');
+          subject.next('e');
+          subject.complete();
+          expect(written).to.deep.equal(['a', 'b']);
+          call.fire.drain();
+          expect(written).to.deep.equal(['a', 'b', 'c', 'd']);
+          call.fire.drain();
+          expect(written).to.deep.equal(['a', 'b', 'c', 'd', 'e', 'end']);
+
+          return result;
+        });
+
+        it('should end the subscription to the source if the call is cancelled', async () => {
+          const { call, subject, result } = await createCall();
+
+          expect(subject.observed).to.be.true;
+          call.fire.cancel();
+          expect(subject.observed).to.be.false;
+          expect(call.end.called).to.be.true;
+
+          return result;
+        });
+
+        it('should wait to throw errors from the observable source until after the internal buffer has drained', async () => {
+          const { call, written, result, subject } = await createCall();
+          const error = new Error('test');
+          subject.next('a');
+          subject.next('b');
+          subject.next('c');
+          subject.next('d');
+          subject.next('e');
+          subject.error(error);
+          expect(written).to.deep.equal(['a', 'b']);
+          call.fire.drain();
+          expect(written).to.deep.equal(['a', 'b', 'c', 'd']);
+          call.fire.drain();
+          expect(written).to.deep.equal(['a', 'b', 'c', 'd', 'e', 'end']);
+
+          try {
+            await result;
+          } catch (err) {
+            expect(err).to.equal(error);
+          }
+        });
       });
     });
   });
 
   describe('createStreamCallMethod', () => {
-    it('should pass through to "methodHandler"', () => {
+    it('should pass through to "methodHandler"', async () => {
       const handler = sinon.spy();
       const fn = server.createStreamCallMethod(handler, false);
       const args = [1, 2, 3];
-      fn(args as any, sinon.spy());
+      await fn(args as any, sinon.spy());
 
       expect(handler.calledWith(args)).to.be.true;
     });
   });
 
+  describe('loadProto', () => {
+    describe('when proto is invalid', () => {
+      it('should throw InvalidProtoDefinitionException', () => {
+        const getPackageDefinitionStub = sinon.stub(
+          grpcHelpers,
+          'getGrpcPackageDefinition' as any,
+        );
+        getPackageDefinitionStub.callsFake(() => {
+          throw new Error();
+        });
+        untypedServer.logger = new NoopLogger();
+        expect(() => server.loadProto()).to.throws(
+          InvalidProtoDefinitionException,
+        );
+        getPackageDefinitionStub.restore();
+      });
+    });
+  });
+
   describe('close', () => {
-    it('should call "forceShutdown"', () => {
-      const grpcClient = { forceShutdown: sinon.spy() };
-      (server as any).grpcClient = grpcClient;
-      server.close();
+    it('should call "forceShutdown" by default', async () => {
+      const grpcClient = {
+        forceShutdown: sinon.spy(),
+        tryShutdown: sinon.stub().yields(),
+      };
+      untypedServer.grpcClient = grpcClient;
+      await server.close();
+      expect(grpcClient.forceShutdown.called).to.be.true;
+      expect(grpcClient.tryShutdown.called).to.be.false;
+    });
+
+    it('should call "forceShutdown" when "gracefulShutdown" is false', async () => {
+      const grpcClient = {
+        forceShutdown: sinon.spy(),
+        tryShutdown: sinon.stub().yields(),
+      };
+      untypedServer.grpcClient = grpcClient;
+      untypedServer.options.gracefulShutdown = false;
+      await server.close();
       expect(grpcClient.forceShutdown.called).to.be.true;
+      expect(grpcClient.tryShutdown.called).to.be.false;
+    });
+
+    it('should call "tryShutdown" when "gracefulShutdown" is true', async () => {
+      const grpcClient = {
+        forceShutdown: sinon.spy(),
+        tryShutdown: sinon.stub().yields(),
+      };
+      untypedServer.grpcClient = grpcClient;
+      untypedServer.options.gracefulShutdown = true;
+      await server.close();
+      expect(grpcClient.forceShutdown.called).to.be.false;
+      expect(grpcClient.tryShutdown.called).to.be.true;
     });
   });
 
@@ -613,7 +976,7 @@ describe('ServerGrpc', () => {
       sinon.stub(server as any, 'messageHandlers').value({ set() {} });
 
       const messageHandlersSetSpy = sinon.spy(
-        (server as any).messageHandlers,
+        untypedServer.messageHandlers,
         'set',
       );
       server.addHandler(pattern, callback as any);
diff --git a/packages/microservices/test/server/server-kafka.spec.ts b/packages/microservices/test/server/server-kafka.spec.ts
index 4d086581b..5878e33be 100644
--- a/packages/microservices/test/server/server-kafka.spec.ts
+++ b/packages/microservices/test/server/server-kafka.spec.ts
@@ -1,5 +1,5 @@
 import { Logger } from '@nestjs/common';
-import { expect } from 'chai';
+import { AssertionError, expect } from 'chai';
 import * as sinon from 'sinon';
 import { NO_MESSAGE_HANDLER } from '../../constants';
 import { KafkaHeaders } from '../../enums';
@@ -8,6 +8,7 @@ import {
   KafkaMessage,
 } from '../../external/kafka.interface';
 import { ServerKafka } from '../../server';
+import { objectToMap } from './utils/object-to-map';
 
 class NoopLogger extends Logger {
   log(message: any, context?: string): void {}
@@ -16,9 +17,6 @@ class NoopLogger extends Logger {
 }
 
 describe('ServerKafka', () => {
-  const objectToMap = obj =>
-    new Map(Object.keys(obj).map(i => [i, obj[i]]) as any);
-
   const topic = 'test.topic';
   const replyTopic = 'test.topic.reply';
   const replyPartition = '0';
@@ -26,6 +24,8 @@ describe('ServerKafka', () => {
   const key = '1';
   const timestamp = new Date().toISOString();
   const messageValue = 'test-message';
+  const heartbeat = async () => {};
+  const pause = () => () => {};
 
   const eventMessage: KafkaMessage = {
     key: Buffer.from(key),
@@ -44,6 +44,8 @@ describe('ServerKafka', () => {
       },
       eventMessage,
     ),
+    heartbeat,
+    pause,
   };
 
   const eventWithCorrelationIdPayload: EachMessagePayload = {
@@ -57,6 +59,8 @@ describe('ServerKafka', () => {
       },
       eventMessage,
     ),
+    heartbeat,
+    pause,
   };
 
   const message: KafkaMessage = Object.assign(
@@ -73,38 +77,72 @@ describe('ServerKafka', () => {
     topic,
     partition: 0,
     message,
+    heartbeat,
+    pause,
   };
 
   let server: ServerKafka;
+  let untypedServer: any;
   let callback: sinon.SinonSpy;
   let bindEventsStub: sinon.SinonStub;
   let connect: sinon.SinonSpy;
   let subscribe: sinon.SinonSpy;
   let run: sinon.SinonSpy;
   let send: sinon.SinonSpy;
+  let on: sinon.SinonSpy;
   let consumerStub: sinon.SinonStub;
   let producerStub: sinon.SinonStub;
-  let client;
+  let client: any;
 
   beforeEach(() => {
     server = new ServerKafka({});
+    untypedServer = server as any;
+
     callback = sinon.spy();
     connect = sinon.spy();
     subscribe = sinon.spy();
     run = sinon.spy();
     send = sinon.spy();
+    on = sinon.spy();
 
     consumerStub = sinon.stub(server as any, 'consumer').callsFake(() => {
       return {
         connect,
         subscribe,
         run,
+        on,
+        events: {
+          GROUP_JOIN: 'consumer.group_join',
+          HEARTBEAT: 'consumer.heartbeat',
+          COMMIT_OFFSETS: 'consumer.commit_offsets',
+          FETCH_START: 'consumer.fetch_start',
+          FETCH: 'consumer.fetch',
+          START_BATCH_PROCESS: 'consumer.start_batch_process',
+          END_BATCH_PROCESS: 'consumer.end_batch_process',
+          CONNECT: 'consumer.connect',
+          DISCONNECT: 'consumer.disconnect',
+          STOP: 'consumer.stop',
+          CRASH: 'consumer.crash',
+          REBALANCING: 'consumer.rebalancing',
+          RECEIVED_UNSUBSCRIBED_TOPICS: 'consumer.received_unsubscribed_topics',
+          REQUEST: 'consumer.network.request',
+          REQUEST_TIMEOUT: 'consumer.network.request_timeout',
+          REQUEST_QUEUE_SIZE: 'consumer.network.request_queue_size',
+        },
       };
     });
     producerStub = sinon.stub(server as any, 'producer').callsFake(() => {
       return {
         connect,
         send,
+        on,
+        events: {
+          CONNECT: 'producer.connect',
+          DISCONNECT: 'producer.disconnect',
+          REQUEST: 'producer.network.request',
+          REQUEST_TIMEOUT: 'producer.network.request_timeout',
+          REQUEST_QUEUE_SIZE: 'producer.network.request_queue_size',
+        },
       };
     });
     client = {
@@ -112,14 +150,17 @@ describe('ServerKafka', () => {
       producer: producerStub,
     };
     sinon.stub(server, 'createClient').callsFake(() => client);
+
+    untypedServer = server as any;
   });
 
   describe('listen', () => {
     it('should call "bindEvents"', async () => {
       bindEventsStub = sinon
         .stub(server, 'bindEvents')
-        .callsFake(() => ({} as any));
-      await server.listen(callback);
+        .callsFake(() => ({}) as any);
+
+      await server.listen(err => console.log(err));
       expect(bindEventsStub.called).to.be.true;
     });
     it('should call callback', async () => {
@@ -127,14 +168,14 @@ describe('ServerKafka', () => {
       expect(callback.called).to.be.true;
     });
     describe('when "start" throws an exception', () => {
-      it('should call callback with a thrown error as an argument', () => {
+      it('should call callback with a thrown error as an argument', async () => {
         const error = new Error('random error');
 
         const callbackSpy = sinon.spy();
         sinon.stub(server, 'start').callsFake(() => {
           throw error;
         });
-        server.listen(callbackSpy);
+        await server.listen(callbackSpy);
         expect(callbackSpy.calledWith(error)).to.be.true;
       });
     });
@@ -144,45 +185,45 @@ describe('ServerKafka', () => {
     const consumer = { disconnect: sinon.spy() };
     const producer = { disconnect: sinon.spy() };
     beforeEach(() => {
-      (server as any).consumer = consumer;
-      (server as any).producer = producer;
+      untypedServer.consumer = consumer;
+      untypedServer.producer = producer;
     });
     it('should close server', async () => {
       await server.close();
 
       expect(consumer.disconnect.calledOnce).to.be.true;
       expect(producer.disconnect.calledOnce).to.be.true;
-      expect((server as any).consumer).to.be.null;
-      expect((server as any).producer).to.be.null;
-      expect((server as any).client).to.be.null;
+      expect(untypedServer.consumer).to.be.null;
+      expect(untypedServer.producer).to.be.null;
+      expect(untypedServer.client).to.be.null;
     });
   });
 
   describe('bindEvents', () => {
     it('should not call subscribe nor run on consumer when there are no messageHandlers', async () => {
-      (server as any).logger = new NoopLogger();
+      untypedServer.logger = new NoopLogger();
       await server.listen(callback);
-      await server.bindEvents((server as any).consumer);
+      await server.bindEvents(untypedServer.consumer);
       expect(subscribe.called).to.be.false;
       expect(run.called).to.be.true;
       expect(connect.called).to.be.true;
     });
     it('should call subscribe and run on consumer when there are messageHandlers', async () => {
-      (server as any).logger = new NoopLogger();
+      untypedServer.logger = new NoopLogger();
       await server.listen(callback);
 
       const pattern = 'test';
       const handler = sinon.spy();
-      (server as any).messageHandlers = objectToMap({
+      untypedServer.messageHandlers = objectToMap({
         [pattern]: handler,
       });
 
-      await server.bindEvents((server as any).consumer);
+      await server.bindEvents(untypedServer.consumer);
 
       expect(subscribe.called).to.be.true;
       expect(
         subscribe.calledWith({
-          topic: pattern,
+          topics: [pattern],
         }),
       ).to.be.true;
 
@@ -190,23 +231,23 @@ describe('ServerKafka', () => {
       expect(connect.called).to.be.true;
     });
     it('should call subscribe with options and run on consumer when there are messageHandlers', async () => {
-      (server as any).logger = new NoopLogger();
-      (server as any).options.subscribe = {};
-      (server as any).options.subscribe.fromBeginning = true;
+      untypedServer.logger = new NoopLogger();
+      untypedServer.options.subscribe = {};
+      untypedServer.options.subscribe.fromBeginning = true;
       await server.listen(callback);
 
       const pattern = 'test';
       const handler = sinon.spy();
-      (server as any).messageHandlers = objectToMap({
+      untypedServer.messageHandlers = objectToMap({
         [pattern]: handler,
       });
 
-      await server.bindEvents((server as any).consumer);
+      await server.bindEvents(untypedServer.consumer);
 
       expect(subscribe.called).to.be.true;
       expect(
         subscribe.calledWith({
-          topic: pattern,
+          topics: [pattern],
           fromBeginning: true,
         }),
       ).to.be.true;
@@ -224,8 +265,8 @@ describe('ServerKafka', () => {
       it('should call "handleMessage"', async () => {
         const handleMessageStub = sinon
           .stub(server, 'handleMessage')
-          .callsFake(() => null);
-        (await server.getMessageHandler())(null);
+          .callsFake(() => null!);
+        await server.getMessageHandler()(null!);
         expect(handleMessageStub.called).to.be.true;
       });
     });
@@ -246,7 +287,7 @@ describe('ServerKafka', () => {
         .callsFake(async () => []);
     });
     it(`should return function`, () => {
-      expect(typeof server.getPublisher(null, null, correlationId)).to.be.eql(
+      expect(typeof server.getPublisher(null!, null!, correlationId)).to.be.eql(
         'function',
       );
     });
@@ -277,30 +318,90 @@ describe('ServerKafka', () => {
 
       sinon.stub(server, 'getPublisher').callsFake(() => getPublisherSpy);
     });
+
     it('should call "handleEvent" if correlation identifier is not present', async () => {
       const handleEventSpy = sinon.spy(server, 'handleEvent');
       await server.handleMessage(eventPayload);
       expect(handleEventSpy.called).to.be.true;
     });
 
-    it('should call "handleEvent" if correlation identifier is present by the reply topic is not present', async () => {
+    it('should call "handleEvent" if correlation identifier is present but the reply topic is not present', async () => {
       const handleEventSpy = sinon.spy(server, 'handleEvent');
       await server.handleMessage(eventWithCorrelationIdPayload);
       expect(handleEventSpy.called).to.be.true;
     });
 
+    it('should call event handler when "handleEvent" is called', async () => {
+      const messageHandler = sinon.mock();
+      const context = { test: true } as any;
+      const messageData = 'some data';
+      sinon.stub(server, 'getHandlerByPattern').callsFake(() => messageHandler);
+
+      await server.handleEvent(
+        topic,
+        { data: messageData, pattern: topic },
+        context,
+      );
+      expect(messageHandler.calledWith(messageData, context)).to.be.true;
+    });
+
+    it('should not catch error thrown by event handler as part of "handleEvent"', async () => {
+      const error = new Error('handler error');
+      const messageHandler = sinon.mock().throwsException(error);
+      sinon.stub(server, 'getHandlerByPattern').callsFake(() => messageHandler);
+
+      try {
+        await server.handleEvent(
+          topic,
+          { data: 'some data', pattern: topic },
+          {} as any,
+        );
+
+        // code should not be executed
+        expect(true).to.be.false;
+      } catch (e) {
+        if (e instanceof AssertionError) {
+          throw e;
+        }
+        expect(e).to.be.eq(error);
+      }
+    });
+
+    it('should call "handleEvent" if correlation identifier and reply topic are present but the handler is of type eventHandler', async () => {
+      const handler = sinon.spy();
+      (handler as any).isEventHandler = true;
+      untypedServer.messageHandlers = objectToMap({
+        [topic]: handler,
+      });
+      const handleEventSpy = sinon.spy(server, 'handleEvent');
+      await server.handleMessage(payload);
+      expect(handleEventSpy.called).to.be.true;
+    });
+
+    it('should NOT call "handleEvent" if correlation identifier and reply topic are present but the handler is not of type eventHandler', async () => {
+      const handler = sinon.spy();
+      (handler as any).isEventHandler = false;
+      untypedServer.messageHandlers = objectToMap({
+        [topic]: handler,
+      });
+      const handleEventSpy = sinon.spy(server, 'handleEvent');
+      await server.handleMessage(payload);
+      expect(handleEventSpy.called).to.be.false;
+    });
+
     it(`should publish NO_MESSAGE_HANDLER if pattern not exists in messageHandlers object`, async () => {
       await server.handleMessage(payload);
       expect(
         getPublisherSpy.calledWith({
-          id: payload.message.headers[KafkaHeaders.CORRELATION_ID].toString(),
+          id: payload.message.headers![KafkaHeaders.CORRELATION_ID]!.toString(),
           err: NO_MESSAGE_HANDLER,
         }),
       ).to.be.true;
     });
+
     it(`should call handler with expected arguments`, async () => {
       const handler = sinon.spy();
-      (server as any).messageHandlers = objectToMap({
+      untypedServer.messageHandlers = objectToMap({
         [topic]: handler,
       });
 
@@ -319,8 +420,8 @@ describe('ServerKafka', () => {
       });
     });
 
-    it('should send message', () => {
-      server.sendMessage(
+    it('should send message', async () => {
+      await server.sendMessage(
         {
           id: correlationId,
           response: messageValue,
@@ -345,8 +446,8 @@ describe('ServerKafka', () => {
         }),
       ).to.be.true;
     });
-    it('should send message without reply partition', () => {
-      server.sendMessage(
+    it('should send message without reply partition', async () => {
+      await server.sendMessage(
         {
           id: correlationId,
           response: messageValue,
@@ -370,8 +471,8 @@ describe('ServerKafka', () => {
         }),
       ).to.be.true;
     });
-    it('should send error message', () => {
-      server.sendMessage(
+    it('should send error message', async () => {
+      await server.sendMessage(
         {
           id: correlationId,
           err: NO_MESSAGE_HANDLER,
@@ -397,8 +498,8 @@ describe('ServerKafka', () => {
         }),
       ).to.be.true;
     });
-    it('should send `isDisposed` message', () => {
-      server.sendMessage(
+    it('should send `isDisposed` message', async () => {
+      await server.sendMessage(
         {
           id: correlationId,
           isDisposed: true,
diff --git a/packages/microservices/test/server/server-mqtt.spec.ts b/packages/microservices/test/server/server-mqtt.spec.ts
index c5a0e30f2..aa601021d 100644
--- a/packages/microservices/test/server/server-mqtt.spec.ts
+++ b/packages/microservices/test/server/server-mqtt.spec.ts
@@ -3,15 +3,15 @@ import * as sinon from 'sinon';
 import { NO_MESSAGE_HANDLER } from '../../constants';
 import { BaseRpcContext } from '../../ctx-host/base-rpc.context';
 import { ServerMqtt } from '../../server/server-mqtt';
+import { objectToMap } from './utils/object-to-map';
 
 describe('ServerMqtt', () => {
   let server: ServerMqtt;
-
-  const objectToMap = obj =>
-    new Map(Object.keys(obj).map(key => [key, obj[key]]) as any);
+  let untypedServer: any;
 
   beforeEach(() => {
     server = new ServerMqtt({});
+    untypedServer = server as any;
   });
   describe('listen', () => {
     let onSpy: sinon.SinonSpy;
@@ -26,26 +26,38 @@ describe('ServerMqtt', () => {
       sinon.stub(server, 'createMqttClient').callsFake(() => client);
       callbackSpy = sinon.spy();
     });
-    it('should bind "error" event to handler', () => {
-      server.listen(callbackSpy);
+    it('should bind "error" event to handler', async () => {
+      await server.listen(callbackSpy);
       expect(onSpy.getCall(0).args[0]).to.be.equal('error');
     });
-    it('should bind "message" event to handler', () => {
-      server.listen(callbackSpy);
-      expect(onSpy.getCall(1).args[0]).to.be.equal('message');
+    it('should bind "reconnect" event to handler', async () => {
+      await server.listen(callbackSpy);
+      expect(onSpy.getCall(1).args[0]).to.be.equal('reconnect');
+    });
+    it('should bind "disconnect" event to handler', async () => {
+      await server.listen(callbackSpy);
+      expect(onSpy.getCall(2).args[0]).to.be.equal('disconnect');
+    });
+    it('should bind "close" event to handler', async () => {
+      await server.listen(callbackSpy);
+      expect(onSpy.getCall(3).args[0]).to.be.equal('close');
+    });
+    it('should bind "connect" event to handler', async () => {
+      await server.listen(callbackSpy);
+      expect(onSpy.getCall(4).args[0]).to.be.equal('connect');
     });
-    it('should bind "connect" event to handler', () => {
-      server.listen(callbackSpy);
-      expect(onSpy.getCall(2).args[0]).to.be.equal('connect');
+    it('should bind "message" event to handler', async () => {
+      await server.listen(callbackSpy);
+      expect(onSpy.getCall(5).args[0]).to.be.equal('message');
     });
     describe('when "start" throws an exception', () => {
-      it('should call callback with a thrown error as an argument', () => {
+      it('should call callback with a thrown error as an argument', async () => {
         const error = new Error('random error');
 
         sinon.stub(server, 'start').callsFake(() => {
           throw error;
         });
-        server.listen(callbackSpy);
+        await server.listen(callbackSpy);
         expect(callbackSpy.calledWith(error)).to.be.true;
       });
     });
@@ -53,7 +65,7 @@ describe('ServerMqtt', () => {
   describe('close', () => {
     const mqttClient = { end: sinon.spy() };
     beforeEach(() => {
-      (server as any).mqttClient = mqttClient;
+      untypedServer.mqttClient = mqttClient;
     });
     it('should end mqttClient', () => {
       server.close();
@@ -74,7 +86,7 @@ describe('ServerMqtt', () => {
     it('should subscribe to each pattern', () => {
       const pattern = 'test';
       const handler = sinon.spy();
-      (server as any).messageHandlers = objectToMap({
+      untypedServer.messageHandlers = objectToMap({
         [pattern]: handler,
       });
       server.bindEvents(mqttClient);
@@ -84,15 +96,19 @@ describe('ServerMqtt', () => {
   describe('getMessageHandler', () => {
     it(`should return function`, () => {
       expect(
-        typeof server.getMessageHandler((server as any).mqttClient),
+        typeof server.getMessageHandler(untypedServer.mqttClient),
       ).to.be.eql('function');
     });
     describe('handler', () => {
       it('should call "handleMessage"', async () => {
         const handleMessageStub = sinon
           .stub(server, 'handleMessage')
-          .callsFake(() => null);
-        (await server.getMessageHandler((server as any).mqttClient))(null);
+          .callsFake(() => null!);
+        await server.getMessageHandler(untypedServer.mqttClient)(
+          null!,
+          null!,
+          null!,
+        );
         expect(handleMessageStub.called).to.be.true;
       });
     });
@@ -133,7 +149,7 @@ describe('ServerMqtt', () => {
     });
     it(`should call handler with expected arguments`, async () => {
       const handler = sinon.spy();
-      (server as any).messageHandlers = objectToMap({
+      untypedServer.messageHandlers = objectToMap({
         [channel]: handler,
       });
 
@@ -175,7 +191,7 @@ describe('ServerMqtt', () => {
   });
   describe('getRequestPattern', () => {
     const test = 'test';
-    it(`should leave patern as it is`, () => {
+    it(`should leave pattern as it is`, () => {
       expect(server.getRequestPattern(test)).to.equal(test);
     });
   });
@@ -202,13 +218,13 @@ describe('ServerMqtt', () => {
     const channel = 'test';
     const data = 'test';
 
-    it('should call handler with expected arguments', () => {
+    it('should call handler with expected arguments', async () => {
       const handler = sinon.spy();
-      (server as any).messageHandlers = objectToMap({
+      untypedServer.messageHandlers = objectToMap({
         [channel]: handler,
       });
 
-      server.handleEvent(
+      await server.handleEvent(
         channel,
         { pattern: '', data },
         new BaseRpcContext([]),
diff --git a/packages/microservices/test/server/server-nats.spec.ts b/packages/microservices/test/server/server-nats.spec.ts
index 1b9839903..ef5a62800 100644
--- a/packages/microservices/test/server/server-nats.spec.ts
+++ b/packages/microservices/test/server/server-nats.spec.ts
@@ -4,17 +4,19 @@ import * as sinon from 'sinon';
 import { NO_MESSAGE_HANDLER } from '../../constants';
 import { NatsContext } from '../../ctx-host';
 import { BaseRpcContext } from '../../ctx-host/base-rpc.context';
-import { NatsMsg } from '../../external/nats-client.interface';
 import { ServerNats } from '../../server/server-nats';
+import { objectToMap } from './utils/object-to-map';
+
+// type NatsMsg = import('nats').Msg;
+type NatsMsg = any;
 
 describe('ServerNats', () => {
   let server: ServerNats;
-
-  const objectToMap = obj =>
-    new Map(Object.keys(obj).map(key => [key, obj[key]]) as any);
+  let untypedServer: any;
 
   beforeEach(() => {
     server = new ServerNats({});
+    untypedServer = server as any;
   });
   describe('listen', () => {
     let client: any;
@@ -39,15 +41,66 @@ describe('ServerNats', () => {
   describe('close', () => {
     const natsClient = { close: sinon.spy() };
     beforeEach(() => {
-      (server as any).natsClient = natsClient;
+      untypedServer.natsClient = natsClient;
     });
-    it('should close natsClient', () => {
-      server.close();
+    it('should close natsClient', async () => {
+      await server.close();
       expect(natsClient.close.called).to.be.true;
     });
+
+    describe('when "gracefulShutdown" is true', () => {
+      const waitForGracePeriod = sinon.spy();
+      const subscriptions = [
+        { unsubscribe: sinon.spy() },
+        { unsubscribe: sinon.spy() },
+      ];
+      beforeEach(() => {
+        (server as any).subscriptions = subscriptions;
+        (server as any).waitForGracePeriod = waitForGracePeriod;
+        (server as any).options.gracefulShutdown = true;
+      });
+
+      it('should unsubscribe all subscriptions', async () => {
+        await server.close();
+        for (const subscription of subscriptions) {
+          expect(subscription.unsubscribe.calledOnce).to.be.true;
+        }
+      });
+
+      it('should call "waitForGracePeriod"', async () => {
+        await server.close();
+        expect(waitForGracePeriod.called).to.be.true;
+      });
+    });
+
+    describe('when "gracefulShutdown" is false', () => {
+      const waitForGracePeriod = sinon.spy();
+      const subscriptions = [
+        { unsubscribe: sinon.spy() },
+        { unsubscribe: sinon.spy() },
+      ];
+      beforeEach(() => {
+        (server as any).subscriptions = subscriptions;
+        (server as any).waitForGracePeriod = waitForGracePeriod;
+        (server as any).options.gracefulShutdown = false;
+      });
+      it('should not unsubscribe all subscriptions', async () => {
+        await server.close();
+        for (const subscription of subscriptions) {
+          expect(subscription.unsubscribe.called).to.be.false;
+        }
+      });
+
+      it('should not call "waitForGracePeriod"', async () => {
+        await server.close();
+        expect(waitForGracePeriod.called).to.be.false;
+      });
+    });
   });
   describe('bindEvents', () => {
     let onSpy: sinon.SinonSpy, subscribeSpy: sinon.SinonSpy, natsClient;
+    const pattern = 'test';
+    const messageHandler = sinon.spy();
 
     beforeEach(() => {
       onSpy = sinon.spy();
@@ -56,26 +109,44 @@ describe('ServerNats', () => {
         on: onSpy,
         subscribe: subscribeSpy,
       };
-    });
-    it('should subscribe to each acknowledge patterns', () => {
-      const pattern = 'test';
-      const handler = sinon.spy();
-      (server as any).messageHandlers = objectToMap({
-        [pattern]: handler,
+      untypedServer.messageHandlers = objectToMap({
+        [pattern]: messageHandler,
       });
+    });
+
+    it('should subscribe to every pattern', () => {
       server.bindEvents(natsClient);
       expect(subscribeSpy.calledWith(pattern)).to.be.true;
     });
+
+    it('should use a per pattern queue if provided', () => {
+      const queue = 'test';
+      untypedServer.messageHandlers = objectToMap({
+        [pattern]: Object.assign(messageHandler, {
+          extras: {
+            queue,
+          },
+        }),
+      });
+      server.bindEvents(natsClient);
+      const lastCall = subscribeSpy.lastCall;
+      expect(lastCall.args[1].queue).to.be.eql(queue);
+    });
+
+    it('should fill the subscriptions array properly', () => {
+      server.bindEvents(natsClient);
+      expect(server['subscriptions'].length).to.be.equals(1);
+    });
   });
   describe('getMessageHandler', () => {
     it(`should return function`, () => {
-      expect(typeof server.getMessageHandler(null)).to.be.eql('function');
+      expect(typeof server.getMessageHandler(null!)).to.be.eql('function');
     });
     describe('handler', () => {
       it('should call "handleMessage"', async () => {
         const handleMessageStub = sinon
           .stub(server, 'handleMessage')
-          .callsFake(() => null);
+          .callsFake(() => null!);
         await server.getMessageHandler('')('' as any, '');
         expect(handleMessageStub.called).to.be.true;
       });
@@ -127,7 +198,7 @@ describe('ServerNats', () => {
     });
     it(`should call handler with expected arguments`, async () => {
       const handler = sinon.spy();
-      (server as any).messageHandlers = objectToMap({
+      untypedServer.messageHandlers = objectToMap({
         [channel]: handler,
       });
 
@@ -198,13 +269,13 @@ describe('ServerNats', () => {
     const channel = 'test';
     const data = 'test';
 
-    it('should call handler with expected arguments', () => {
+    it('should call handler with expected arguments', async () => {
       const handler = sinon.spy();
-      (server as any).messageHandlers = objectToMap({
+      untypedServer.messageHandlers = objectToMap({
         [channel]: handler,
       });
 
-      server.handleEvent(
+      await server.handleEvent(
         channel,
         { pattern: '', data },
         new BaseRpcContext([]),
@@ -219,12 +290,12 @@ describe('ServerNats', () => {
           [Symbol.asyncIterator]: [],
         }),
       };
-      server.handleStatusUpdates(serverMock as any);
+      void server.handleStatusUpdates(serverMock as any);
       expect(serverMock.status.called).to.be.true;
     });
 
     it('should log "disconnect" and "error" statuses as "errors"', async () => {
-      const logErrorSpy = sinon.spy((server as any).logger, 'error');
+      const logErrorSpy = sinon.spy(untypedServer.logger, 'error');
       const serverMock = {
         status: sinon.stub().returns({
           async *[Symbol.asyncIterator]() {
@@ -245,7 +316,7 @@ describe('ServerNats', () => {
       );
     });
     it('should log other statuses as "logs"', async () => {
-      const logSpy = sinon.spy((server as any).logger, 'log');
+      const logSpy = sinon.spy(untypedServer.logger, 'log');
       const serverMock = {
         status: sinon.stub().returns({
           async *[Symbol.asyncIterator]() {
diff --git a/packages/microservices/test/server/server-redis.spec.ts b/packages/microservices/test/server/server-redis.spec.ts
index fc9650c87..fa8940002 100644
--- a/packages/microservices/test/server/server-redis.spec.ts
+++ b/packages/microservices/test/server/server-redis.spec.ts
@@ -3,25 +3,29 @@ import * as sinon from 'sinon';
 import { NO_MESSAGE_HANDLER } from '../../constants';
 import { BaseRpcContext } from '../../ctx-host/base-rpc.context';
 import { ServerRedis } from '../../server/server-redis';
+import { objectToMap } from './utils/object-to-map';
 
 describe('ServerRedis', () => {
   let server: ServerRedis;
-
-  const objectToMap = obj =>
-    new Map(Object.keys(obj).map(key => [key, obj[key]]) as any);
+  let untypedServer: any;
 
   beforeEach(() => {
     server = new ServerRedis({});
+    untypedServer = server as any;
   });
   describe('listen', () => {
     let onSpy: sinon.SinonSpy;
+    let connectSpy: sinon.SinonSpy;
     let client: any;
     let callbackSpy: sinon.SinonSpy;
 
     beforeEach(() => {
       onSpy = sinon.spy();
+      connectSpy = sinon.spy();
+
       client = {
         on: onSpy,
+        connect: connectSpy,
       };
       sinon.stub(server, 'createRedisClient').callsFake(() => client);
 
@@ -31,13 +35,9 @@ describe('ServerRedis', () => {
       server.listen(callbackSpy);
       expect(onSpy.getCall(0).args[0]).to.be.equal('error');
     });
-    it('should bind "connect" event to handler', () => {
-      server.listen(callbackSpy);
-      expect(onSpy.getCall(3).args[0]).to.be.equal('connect');
-    });
-    it('should bind "message" event to handler', () => {
+    it('should call "RedisClient#connect()"', () => {
       server.listen(callbackSpy);
-      expect(onSpy.getCall(2).args[0]).to.be.equal('message');
+      expect(connectSpy.called).to.be.true;
     });
     describe('when "start" throws an exception', () => {
       it('should call callback with a thrown error as an argument', () => {
@@ -56,8 +56,8 @@ describe('ServerRedis', () => {
     const pub = { quit: sinon.spy() };
     const sub = { quit: sinon.spy() };
     beforeEach(() => {
-      (server as any).pubClient = pub;
-      (server as any).subClient = sub;
+      untypedServer.pubClient = pub;
+      untypedServer.subClient = sub;
     });
     it('should close pub & sub server', () => {
       server.close();
@@ -67,7 +67,7 @@ describe('ServerRedis', () => {
     });
   });
   describe('handleConnection', () => {
-    let onSpy: sinon.SinonSpy, subscribeSpy: sinon.SinonSpy, sub;
+    let onSpy: sinon.SinonSpy, subscribeSpy: sinon.SinonSpy, sub, psub;
 
     beforeEach(() => {
       onSpy = sinon.spy();
@@ -76,20 +76,45 @@ describe('ServerRedis', () => {
         on: onSpy,
         subscribe: subscribeSpy,
       };
+      psub = {
+        on: onSpy,
+        psubscribe: subscribeSpy,
+      };
     });
-    it('should bind "message" event to handler', () => {
+    it('should bind "message" event to handler if wildcards are disabled', () => {
       server.bindEvents(sub, null);
       expect(onSpy.getCall(0).args[0]).to.be.equal('message');
     });
-    it('should subscribe to each pattern', () => {
+    it('should bind "pmessage" event to handler if wildcards are enabled', () => {
+      untypedServer.options = {};
+      untypedServer.options.wildcards = true;
+
+      server.bindEvents(psub, null);
+      expect(onSpy.getCall(0).args[0]).to.be.equal('pmessage');
+    });
+
+    it('should "subscribe" to each pattern if wildcards are disabled', () => {
       const pattern = 'test';
       const handler = sinon.spy();
-      (server as any).messageHandlers = objectToMap({
+      untypedServer.messageHandlers = objectToMap({
         [pattern]: handler,
       });
       server.bindEvents(sub, null);
       expect(subscribeSpy.calledWith(pattern)).to.be.true;
     });
+
+    it('should "psubscribe" to each pattern if wildcards are enabled', () => {
+      untypedServer.options = {};
+      untypedServer.options.wildcards = true;
+
+      const pattern = 'test';
+      const handler = sinon.spy();
+      untypedServer.messageHandlers = objectToMap({
+        [pattern]: handler,
+      });
+      server.bindEvents(psub, null);
+      expect(subscribeSpy.calledWith(pattern)).to.be.true;
+    });
   });
   describe('getMessageHandler', () => {
     it(`should return function`, () => {
@@ -109,14 +134,19 @@ describe('ServerRedis', () => {
     });
     it('should call "handleEvent" if identifier is not present', async () => {
       const handleEventSpy = sinon.spy(server, 'handleEvent');
-      sinon.stub(server, 'parseMessage').callsFake(() => ({ data } as any));
+      sinon.stub(server, 'parseMessage').callsFake(() => ({ data }) as any);
 
-      await server.handleMessage(channel, JSON.stringify({}), null);
+      await server.handleMessage(channel, JSON.stringify({}), null, channel);
       expect(handleEventSpy.called).to.be.true;
     });
     it(`should publish NO_MESSAGE_HANDLER if pattern not exists in messageHandlers object`, async () => {
-      sinon.stub(server, 'parseMessage').callsFake(() => ({ id, data } as any));
-      await server.handleMessage(channel, JSON.stringify({ id }), null);
+      sinon.stub(server, 'parseMessage').callsFake(() => ({ id, data }) as any);
+      await server.handleMessage(
+        channel,
+        JSON.stringify({ id }),
+        null,
+        channel,
+      );
       expect(
         getPublisherSpy.calledWith({
           id,
@@ -127,12 +157,12 @@ describe('ServerRedis', () => {
     });
     it(`should call handler with expected arguments`, async () => {
       const handler = sinon.spy();
-      (server as any).messageHandlers = objectToMap({
+      untypedServer.messageHandlers = objectToMap({
         [channel]: handler,
       });
-      sinon.stub(server, 'parseMessage').callsFake(() => ({ id, data } as any));
+      sinon.stub(server, 'parseMessage').callsFake(() => ({ id, data }) as any);
 
-      await server.handleMessage(channel, {}, null);
+      await server.handleMessage(channel, '', null, channel);
       expect(handler.calledWith(data)).to.be.true;
     });
   });
@@ -191,60 +221,49 @@ describe('ServerRedis', () => {
     });
   });
   describe('getClientOptions', () => {
-    it('should return options object with "retry_strategy" and call "createRetryStrategy"', () => {
+    it('should return options object with "retryStrategy" and call "createRetryStrategy"', () => {
       const createSpy = sinon.spy(server, 'createRetryStrategy');
-      const { retry_strategy } = server.getClientOptions();
+      const { retryStrategy } = server.getClientOptions()!;
       try {
-        retry_strategy({} as any);
-      } catch {}
+        retryStrategy!(0);
+      } catch {
+        // Ignore
+      }
       expect(createSpy.called).to.be.true;
     });
   });
   describe('createRetryStrategy', () => {
     describe('when is terminated', () => {
       it('should return undefined', () => {
-        (server as any).isExplicitlyTerminated = true;
-        const result = server.createRetryStrategy({} as any);
+        untypedServer.isManuallyClosed = true;
+        const result = server.createRetryStrategy(0);
         expect(result).to.be.undefined;
       });
     });
     describe('when "retryAttempts" does not exist', () => {
-      it('should throw an exception', () => {
-        (server as any).options.options = {};
-        (server as any).options.options.retryAttempts = undefined;
+      it('should return undefined', () => {
+        untypedServer.options.options = {};
+        untypedServer.options.options.retryAttempts = undefined;
 
-        expect(() => server.createRetryStrategy({} as any)).to.throw(Error);
+        expect(server.createRetryStrategy(4)).to.be.undefined;
       });
     });
     describe('when "attempts" count is max', () => {
-      it('should throw an exception', () => {
-        (server as any).options.options = {};
-        (server as any).options.options.retryAttempts = 3;
+      it('should return undefined', () => {
+        untypedServer.options.options = {};
+        untypedServer.options.options.retryAttempts = 3;
 
-        expect(() =>
-          server.createRetryStrategy({ attempt: 4 } as any),
-        ).to.throw(Error);
-      });
-    });
-    describe('when ECONNREFUSED', () => {
-      it('should call logger', () => {
-        const loggerErrorSpy = sinon.spy((server as any).logger, 'error');
-        try {
-          server.createRetryStrategy({
-            error: { code: 'ECONNREFUSED' },
-          } as any);
-        } catch {}
-        expect(loggerErrorSpy.called).to.be.true;
+        expect(server.createRetryStrategy(4)).to.be.undefined;
       });
     });
     describe('otherwise', () => {
       it('should return delay (ms)', () => {
-        (server as any).options = {};
-        (server as any).isExplicitlyTerminated = false;
-        (server as any).options.retryAttempts = 3;
-        (server as any).options.retryDelay = 3;
-        const result = server.createRetryStrategy({ attempt: 2 } as any);
-        expect(result).to.be.eql((server as any).options.retryDelay);
+        untypedServer.options = {};
+        untypedServer.isManuallyClosed = false;
+        untypedServer.options.retryAttempts = 3;
+        untypedServer.options.retryDelay = 3;
+        const result = server.createRetryStrategy(2);
+        expect(result).to.be.eql(untypedServer.options.retryDelay);
       });
     });
   });
@@ -252,13 +271,13 @@ describe('ServerRedis', () => {
     const channel = 'test';
     const data = 'test';
 
-    it('should call handler with expected arguments', () => {
+    it('should call handler with expected arguments', async () => {
       const handler = sinon.spy();
-      (server as any).messageHandlers = objectToMap({
+      untypedServer.messageHandlers = objectToMap({
         [channel]: handler,
       });
 
-      server.handleEvent(
+      await server.handleEvent(
         channel,
         { pattern: '', data },
         new BaseRpcContext([]),
diff --git a/packages/microservices/test/server/server-rmq.spec.ts b/packages/microservices/test/server/server-rmq.spec.ts
index 5a0ded627..bb5ec6299 100644
--- a/packages/microservices/test/server/server-rmq.spec.ts
+++ b/packages/microservices/test/server/server-rmq.spec.ts
@@ -1,18 +1,19 @@
-import { expect } from 'chai';
+import { assert, expect } from 'chai';
 import * as sinon from 'sinon';
 import { NO_MESSAGE_HANDLER } from '../../constants';
-import { BaseRpcContext } from '../../ctx-host/base-rpc.context';
+import { RmqContext } from '../../ctx-host';
 import { ServerRMQ } from '../../server/server-rmq';
+import { objectToMap } from './utils/object-to-map';
 
 describe('ServerRMQ', () => {
   let server: ServerRMQ;
-
-  const objectToMap = obj =>
-    new Map(Object.keys(obj).map(key => [key, obj[key]]) as any);
+  let untypedServer: any;
 
   beforeEach(() => {
     server = new ServerRMQ({});
+    untypedServer = server as any;
   });
+
   describe('listen', () => {
     let createClient: sinon.SinonStub;
     let onStub: sinon.SinonStub;
@@ -28,10 +29,11 @@ describe('ServerRMQ', () => {
       createChannelStub = sinon.stub().callsFake(({ setup }) => setup());
       setupChannelStub = sinon
         .stub(server, 'setupChannel')
-        .callsFake(() => ({} as any));
+        .callsFake(() => ({}) as any);
 
       client = {
         on: onStub,
+        once: onStub,
         createChannel: createChannelStub,
       };
       createClient = sinon.stub(server, 'createClient').callsFake(() => client);
@@ -40,26 +42,30 @@ describe('ServerRMQ', () => {
     afterEach(() => {
       setupChannelStub.restore();
     });
-    it('should call "createClient"', () => {
-      server.listen(callbackSpy);
+    it('should call "createClient"', async () => {
+      await server.listen(callbackSpy);
       expect(createClient.called).to.be.true;
     });
-    it('should bind "connect" event to handler', () => {
-      server.listen(callbackSpy);
+    it('should bind "connect" event to handler', async () => {
+      await server.listen(callbackSpy);
       expect(onStub.getCall(0).args[0]).to.be.equal('connect');
     });
-    it('should bind "disconnect" event to handler', () => {
-      server.listen(callbackSpy);
-      expect(onStub.getCall(1).args[0]).to.be.equal('disconnect');
+    it('should bind "disconnected" event to handler', async () => {
+      await server.listen(callbackSpy);
+      expect(onStub.getCall(2).args[0]).to.be.equal('disconnect');
+    });
+    it('should bind "connectFailed" event to handler', async () => {
+      await server.listen(callbackSpy);
+      expect(onStub.getCall(3).args[0]).to.be.equal('connectFailed');
     });
     describe('when "start" throws an exception', () => {
-      it('should call callback with a thrown error as an argument', () => {
+      it('should call callback with a thrown error as an argument', async () => {
         const error = new Error('random error');
 
         sinon.stub(server, 'start').callsFake(() => {
           throw error;
         });
-        server.listen(callbackSpy);
+        await server.listen(callbackSpy);
         expect(callbackSpy.calledWith(error)).to.be.true;
       });
     });
@@ -69,8 +75,8 @@ describe('ServerRMQ', () => {
     const rmqChannel = { close: sinon.spy() };
 
     beforeEach(() => {
-      (server as any).server = rmqServer;
-      (server as any).channel = rmqChannel;
+      untypedServer.server = rmqServer;
+      untypedServer.channel = rmqChannel;
     });
     it('should close server', () => {
       server.close();
@@ -95,10 +101,18 @@ describe('ServerRMQ', () => {
       data: 'tests',
       id: '3',
     });
+    const channel = {
+      nack: sinon.spy(),
+    };
+
     let sendMessageStub: sinon.SinonStub;
 
     beforeEach(() => {
       sendMessageStub = sinon.stub(server, 'sendMessage').callsFake(() => ({}));
+      untypedServer.channel = channel;
+    });
+    afterEach(() => {
+      channel.nack.resetHistory();
     });
     it('should call "handleEvent" if identifier is not present', async () => {
       const handleEventSpy = sinon.spy(server, 'handleEvent');
@@ -117,12 +131,51 @@ describe('ServerRMQ', () => {
     });
     it('should call handler if exists in handlers object', async () => {
       const handler = sinon.spy();
-      (server as any).messageHandlers = objectToMap({
+      untypedServer.messageHandlers = objectToMap({
         [pattern]: handler as any,
       });
       await server.handleMessage(msg, '');
       expect(handler.calledOnce).to.be.true;
     });
+    it('should not throw if the message is an invalid json', async () => {
+      const invalidMsg = {
+        content: {
+          toString: () => 'd',
+        },
+        properties: { correlationId: 1 },
+      };
+      const handler = sinon.spy();
+      untypedServer.messageHandlers = objectToMap({
+        [pattern]: handler as any,
+      });
+
+      return server.handleMessage(invalidMsg, '').catch(() => {
+        assert.fail('Was not supposed to throw an error');
+      });
+    });
+    it('should negative acknowledge if message does not exists in handlers object and noAck option is false', async () => {
+      untypedServer.noAck = false;
+      await server.handleMessage(msg, '');
+      expect(channel.nack.calledWith(msg, false, false)).to.be.true;
+      expect(
+        sendMessageStub.calledWith({
+          id: '3',
+          status: 'error',
+          err: NO_MESSAGE_HANDLER,
+        }),
+      ).to.be.true;
+    });
+    it('should not negative acknowledge if key does not exists in handlers object and noAck option is true', async () => {
+      await server.handleMessage(msg, '');
+      expect(channel.nack.notCalled).to.be.true;
+      expect(
+        sendMessageStub.calledWith({
+          id: '3',
+          status: 'error',
+          err: NO_MESSAGE_HANDLER,
+        }),
+      ).to.be.true;
+    });
   });
   describe('setupChannel', () => {
     const queue = 'test';
@@ -133,10 +186,12 @@ describe('ServerRMQ', () => {
     let channel: any = {};
 
     beforeEach(() => {
-      (server as any)['queue'] = queue;
-      (server as any)['queueOptions'] = queueOptions;
-      (server as any)['isGlobalPrefetchCount'] = isGlobalPrefetchCount;
-      (server as any)['prefetchCount'] = prefetchCount;
+      untypedServer['queue'] = queue;
+      untypedServer['queueOptions'] = queueOptions;
+      untypedServer['options'] = {
+        isGlobalPrefetchCount,
+        prefetchCount,
+      };
 
       channel = {
         assertQueue: sinon.spy(() => ({})),
@@ -144,10 +199,21 @@ describe('ServerRMQ', () => {
         consume: sinon.spy(),
       };
     });
-    it('should call "assertQueue" with queue and queue options', async () => {
+    it('should call "assertQueue" with queue and queue options when noAssert is false', async () => {
+      server['noAssert' as any] = false;
+
       await server.setupChannel(channel, () => null);
       expect(channel.assertQueue.calledWith(queue, queueOptions)).to.be.true;
     });
+    it('should not call "assertQueue" when noAssert is true', async () => {
+      server['options' as any] = {
+        ...(server as any)['options'],
+        noAssert: true,
+      };
+
+      await server.setupChannel(channel, () => null);
+      expect(channel.assertQueue.called).not.to.be.true;
+    });
     it('should call "prefetch" with prefetchCount and "isGlobalPrefetchCount"', async () => {
       await server.setupChannel(channel, () => null);
       expect(channel.prefetch.calledWith(prefetchCount, isGlobalPrefetchCount))
@@ -194,18 +260,50 @@ describe('ServerRMQ', () => {
     const channel = 'test';
     const data = 'test';
 
-    it('should call handler with expected arguments', () => {
+    it('should call handler with expected arguments', async () => {
       const handler = sinon.spy();
-      (server as any).messageHandlers = objectToMap({
+      untypedServer.messageHandlers = objectToMap({
         [channel]: handler,
       });
 
-      server.handleEvent(
+      await server.handleEvent(
         channel,
         { pattern: '', data },
-        new BaseRpcContext([]),
+        new RmqContext([{}, {}, '']),
       );
       expect(handler.calledWith(data)).to.be.true;
     });
+
+    it('should negative acknowledge without retrying if key does not exists in handlers object and noAck option is false', async () => {
+      const nack = sinon.spy();
+      const message = { pattern: 'no-exists', data };
+      untypedServer.channel = {
+        nack,
+      };
+      untypedServer.noAck = false;
+      await server.handleEvent(
+        channel,
+        message,
+        new RmqContext([message, '', '']),
+      );
+
+      expect(nack.calledWith(message, false, false)).to.be.true;
+    });
+
+    it('should not negative acknowledge if key does not exists in handlers object but noAck option is true', async () => {
+      const nack = sinon.spy();
+      const message = { pattern: 'no-exists', data };
+      untypedServer.channel = {
+        nack,
+      };
+      untypedServer.noAck = true;
+      await server.handleEvent(
+        channel,
+        message,
+        new RmqContext([message, '', '']),
+      );
+
+      expect(nack.calledWith(message, false, false)).not.to.be.true;
+    });
   });
 });
diff --git a/packages/microservices/test/server/server-tcp.spec.ts b/packages/microservices/test/server/server-tcp.spec.ts
index 01d01de9c..072e768ac 100644
--- a/packages/microservices/test/server/server-tcp.spec.ts
+++ b/packages/microservices/test/server/server-tcp.spec.ts
@@ -3,31 +3,32 @@ import * as sinon from 'sinon';
 import { NO_MESSAGE_HANDLER } from '../../constants';
 import { BaseRpcContext } from '../../ctx-host/base-rpc.context';
 import { ServerTCP } from '../../server/server-tcp';
+import { objectToMap } from './utils/object-to-map';
 
 describe('ServerTCP', () => {
   let server: ServerTCP;
-
-  const objectToMap = obj =>
-    new Map(Object.keys(obj).map(key => [key, obj[key]]) as any);
+  let untypedServer: any;
 
   beforeEach(() => {
     server = new ServerTCP({});
+    untypedServer = server as any;
   });
 
   describe('bindHandler', () => {
     const socket = { on: sinon.spy() };
+
     beforeEach(() => {
       sinon.stub(server, 'getSocketInstance' as any).callsFake(() => socket);
     });
     it('should bind message and error events to handler', () => {
-      server.bindHandler(null);
+      server.bindHandler(null!);
       expect(socket.on.calledTwice).to.be.true;
     });
   });
   describe('close', () => {
     const tcpServer = { close: sinon.spy() };
     beforeEach(() => {
-      (server as any).server = tcpServer;
+      untypedServer.server = tcpServer;
     });
     it('should close server', () => {
       server.close();
@@ -37,15 +38,15 @@ describe('ServerTCP', () => {
   describe('listen', () => {
     const serverMock = { listen: sinon.spy(), once: sinon.spy() };
     beforeEach(() => {
-      (server as any).server = serverMock;
+      untypedServer.server = serverMock;
     });
     it('should call native listen method with expected arguments', () => {
       const callback = () => {};
       server.listen(callback);
       expect(
         serverMock.listen.calledWith(
-          (server as any).port,
-          (server as any).host,
+          untypedServer.port,
+          untypedServer.host,
           callback,
         ),
       ).to.be.true;
@@ -75,7 +76,7 @@ describe('ServerTCP', () => {
     });
     it('should call handler if exists in handlers object', async () => {
       const handler = sinon.spy();
-      (server as any).messageHandlers = objectToMap({
+      untypedServer.messageHandlers = objectToMap({
         [msg.pattern]: handler as any,
       });
       await server.handleMessage(socket, msg);
@@ -85,33 +86,33 @@ describe('ServerTCP', () => {
   describe('handleClose', () => {
     describe('when is terminated', () => {
       it('should return undefined', () => {
-        (server as any).isExplicitlyTerminated = true;
+        untypedServer.isExplicitlyTerminated = true;
         const result = server.handleClose();
         expect(result).to.be.undefined;
       });
     });
     describe('when "retryAttempts" does not exist', () => {
       it('should return undefined', () => {
-        (server as any).options.retryAttempts = undefined;
+        untypedServer.options.retryAttempts = undefined;
         const result = server.handleClose();
         expect(result).to.be.undefined;
       });
     });
     describe('when "retryAttemptsCount" count is max', () => {
       it('should return undefined', () => {
-        (server as any).options.retryAttempts = 3;
-        (server as any).retryAttemptsCount = 3;
+        untypedServer.options.retryAttempts = 3;
+        untypedServer.retryAttemptsCount = 3;
         const result = server.handleClose();
         expect(result).to.be.undefined;
       });
     });
     describe('otherwise', () => {
       it('should return delay (ms)', () => {
-        (server as any).options = {};
-        (server as any).isExplicitlyTerminated = false;
-        (server as any).options.retryAttempts = 3;
-        (server as any).retryAttemptsCount = 2;
-        (server as any).options.retryDelay = 3;
+        untypedServer.options = {};
+        untypedServer.isExplicitlyTerminated = false;
+        untypedServer.options.retryAttempts = 3;
+        untypedServer.retryAttemptsCount = 2;
+        untypedServer.options.retryDelay = 3;
         const result = server.handleClose();
         expect(result).to.be.not.undefined;
       });
@@ -122,13 +123,13 @@ describe('ServerTCP', () => {
     const channel = 'test';
     const data = 'test';
 
-    it('should call handler with expected arguments', () => {
+    it('should call handler with expected arguments', async () => {
       const handler = sinon.spy();
-      (server as any).messageHandlers = objectToMap({
+      untypedServer.messageHandlers = objectToMap({
         [channel]: handler,
       });
 
-      server.handleEvent(
+      await server.handleEvent(
         channel,
         { pattern: '', data },
         new BaseRpcContext([]),
diff --git a/packages/microservices/test/server/server.spec.ts b/packages/microservices/test/server/server.spec.ts
index ae62ca108..3c7fe801f 100644
--- a/packages/microservices/test/server/server.spec.ts
+++ b/packages/microservices/test/server/server.spec.ts
@@ -1,15 +1,23 @@
 import { expect } from 'chai';
-import { lastValueFrom, Observable, of, throwError as _throw } from 'rxjs';
+import { throwError as _throw, lastValueFrom, Observable, of } from 'rxjs';
 import * as sinon from 'sinon';
 import { Server } from '../../server/server';
 
 class TestServer extends Server {
+  public on<
+    EventKey extends string = string,
+    EventCallback extends Function = Function,
+  >(event: EventKey, callback: EventCallback) {}
+  public unwrap<T>(): T {
+    return null!;
+  }
   public listen(callback: () => void) {}
   public close() {}
 }
 
 describe('Server', () => {
   const server = new TestServer();
+  const untypedServer = server as any;
   const sandbox = sinon.createSandbox();
   const callback = () => {},
     pattern = { test: 'test pattern' };
@@ -26,7 +34,7 @@ describe('Server', () => {
         .value({ set() {}, has() {} });
 
       const messageHandlersSetSpy = sinon.spy(
-        (server as any).messageHandlers,
+        untypedServer.messageHandlers,
         'set',
       );
       const normalizePatternStub = sinon
@@ -49,7 +57,7 @@ describe('Server', () => {
           const nextHandler: any = () => null;
 
           headHandler.next = nextHandler;
-          (server as any)['messageHandlers'] = new Map([
+          untypedServer['messageHandlers'] = new Map([
             [handlerRoute, headHandler],
           ]);
           const normalizePatternStub = sinon
@@ -80,7 +88,7 @@ describe('Server', () => {
       it(`should call 'transformPatternToRoute' with 'string' argument`, () => {
         const inputServerPattern = 'hello';
         const transformedServerPattern = inputServerPattern;
-        (server as any).getRouteFromPattern(inputServerPattern);
+        untypedServer.getRouteFromPattern(inputServerPattern);
 
         expect(normalizePatternStub.args[0][0]).to.be.equal(
           transformedServerPattern,
@@ -95,7 +103,7 @@ describe('Server', () => {
           controller: 'app',
           use: 'getHello',
         };
-        (server as any).getRouteFromPattern(inputServerPattern);
+        untypedServer.getRouteFromPattern(inputServerPattern);
 
         expect(normalizePatternStub.args[0][0]).to.be.deep.equal(
           transformedServerPattern,
@@ -203,12 +211,9 @@ describe('Server', () => {
         .stub(server as any, 'messageHandlers')
         .value({ get() {}, has() {} });
       messageHandlersGetSpy = sinon
-        .stub((server as any).messageHandlers, 'get')
+        .stub(untypedServer.messageHandlers, 'get')
         .returns(callback);
-      messageHandlersHasSpy = sinon.stub(
-        (server as any).messageHandlers,
-        'has',
-      );
+      messageHandlersHasSpy = sinon.stub(untypedServer.messageHandlers, 'has');
 
       sandbox.stub(server as any, 'getRouteFromPattern').returns(handlerRoute);
     });
diff --git a/packages/microservices/test/server/utils/object-to-map.ts b/packages/microservices/test/server/utils/object-to-map.ts
new file mode 100644
index 000000000..a6a383f60
--- /dev/null
+++ b/packages/microservices/test/server/utils/object-to-map.ts
@@ -0,0 +1,2 @@
+export const objectToMap = (obj: Record<string, any>) =>
+  new Map(Object.keys(obj).map(key => [key, obj[key]]) as any);
diff --git a/packages/microservices/test/tsconfig.json b/packages/microservices/test/tsconfig.json
new file mode 100644
index 000000000..50d59661d
--- /dev/null
+++ b/packages/microservices/test/tsconfig.json
@@ -0,0 +1,3 @@
+{
+  "extends": "../../../tsconfig.spec.json"
+}
diff --git a/packages/microservices/test/utils/transform-pattern.utils.spec.ts b/packages/microservices/test/utils/transform-pattern.utils.spec.ts
index 3825a4c4d..4ea4b8423 100644
--- a/packages/microservices/test/utils/transform-pattern.utils.spec.ts
+++ b/packages/microservices/test/utils/transform-pattern.utils.spec.ts
@@ -44,7 +44,7 @@ describe('transformPatternToRoute', () => {
             controller: 'app',
             id: 150,
           },
-        ];
+        ] as MsPattern[];
 
         const expectedResults = [
           JSON.stringify(testPatterns[0]),
@@ -71,7 +71,7 @@ describe('transformPatternToRoute', () => {
             use: { p1: 'path1', p2: 'path2', id: 160 },
             controller: 'app',
           },
-        ];
+        ] as MsPattern[];
 
         const expectedResults = [
           JSON.stringify(testPatterns[0]),
@@ -98,7 +98,7 @@ describe('transformPatternToRoute', () => {
             use: { p1: 'path1', p2: { pp1: 'ppath1' } },
             controller: { p1: { pp1: 'ppath1', id: 180 } },
           },
-        ];
+        ] as MsPattern[];
 
         const expectedResults = [
           JSON.stringify(testPatterns[0]),
diff --git a/packages/microservices/tsconfig.build.json b/packages/microservices/tsconfig.build.json
new file mode 100644
index 000000000..e8b71a07a
--- /dev/null
+++ b/packages/microservices/tsconfig.build.json
@@ -0,0 +1,27 @@
+{
+  "extends": "../tsconfig.build.json",
+  "compilerOptions": {
+    "outDir": ".",
+    "rootDir": ".",
+    "paths": {
+      "@nestjs/common": ["../common"],
+      "@nestjs/common/*": ["../common/*"],
+      "@nestjs/core": ["../core"],
+      "@nestjs/core/*": ["../core/*"],
+      "@nestjs/websockets": ["../websockets"],
+      "@nestjs/websockets/*": ["../websockets/*"]
+    }
+  },
+  "exclude": ["node_modules", "dist", "test/**/*", "*.spec.ts"],
+  "references": [
+    {
+      "path": "../common/tsconfig.build.json"
+    },
+    {
+      "path": "../core/tsconfig.build.json"
+    },
+    {
+      "path": "../websockets/tsconfig.build.json"
+    }
+  ]
+}
diff --git a/packages/microservices/tsconfig.json b/packages/microservices/tsconfig.json
index b238080a4..2ae9e3c90 100644
--- a/packages/microservices/tsconfig.json
+++ b/packages/microservices/tsconfig.json
@@ -1,7 +1,13 @@
 {
-  "extends": "./../tsconfig.base.json",
+  "extends": "../tsconfig.build.json",
   "compilerOptions": {
-    "baseUrl": "./"
+    "types": ["node"]
   },
-  "include": ["*.ts", "**/*.ts"]
+  "files": [],
+  "include": [],
+  "references": [
+    {
+      "path": "./tsconfig.build.json"
+    }
+  ]
 }
diff --git a/packages/microservices/utils/param.utils.ts b/packages/microservices/utils/param.utils.ts
index 4046936ae..6096709db 100644
--- a/packages/microservices/utils/param.utils.ts
+++ b/packages/microservices/utils/param.utils.ts
@@ -11,12 +11,13 @@ export function createRpcParamDecorator(
   return (...pipes: (Type<PipeTransform> | PipeTransform)[]) =>
     (target, key, index) => {
       const args =
-        Reflect.getMetadata(PARAM_ARGS_METADATA, target.constructor, key) || {};
+        Reflect.getMetadata(PARAM_ARGS_METADATA, target.constructor, key!) ||
+        {};
       Reflect.defineMetadata(
         PARAM_ARGS_METADATA,
         assignMetadata(args, paramtype, index, undefined, ...pipes),
         target.constructor,
-        key,
+        key!,
       );
     };
 }
@@ -29,7 +30,7 @@ export const createPipesRpcParamDecorator =
   ): ParameterDecorator =>
   (target, key, index) => {
     const args =
-      Reflect.getMetadata(PARAM_ARGS_METADATA, target.constructor, key) || {};
+      Reflect.getMetadata(PARAM_ARGS_METADATA, target.constructor, key!) || {};
 
     const hasParamData = isNil(data) || isString(data);
     const paramData = hasParamData ? data : undefined;
@@ -37,8 +38,8 @@ export const createPipesRpcParamDecorator =
 
     Reflect.defineMetadata(
       PARAM_ARGS_METADATA,
-      assignMetadata(args, paramtype, index, paramData, ...paramPipes),
+      assignMetadata(args, paramtype, index, paramData!, ...paramPipes),
       target.constructor,
-      key,
+      key!,
     );
   };
diff --git a/packages/platform-express/CHANGELOG.md b/packages/platform-express/CHANGELOG.md
deleted file mode 100644
index 9fbcf7681..000000000
--- a/packages/platform-express/CHANGELOG.md
+++ /dev/null
@@ -1,12 +0,0 @@
-# Change Log
-
-All notable changes to this project will be documented in this file.
-See [Conventional Commits](https://conventionalcommits.org) for commit guidelines.
-
-<a name="8.2.0"></a>
-# [8.2.0](https://github.com/nestjs/nest/compare/v8.1.2...v8.2.0) (2021-11-08)
-
-
-### Features
-
-* **common:** add the ability to set some extra metadata about returned files ([5100573](https://github.com/nestjs/nest/commit/5100573))
diff --git a/packages/platform-express/Readme.md b/packages/platform-express/Readme.md
index 85a8c2535..4cac0d5ea 100644
--- a/packages/platform-express/Readme.md
+++ b/packages/platform-express/Readme.md
@@ -1,17 +1,16 @@
 <p align="center">
-  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
+  <a href="https://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
 </p>
 
 [circleci-image]: https://img.shields.io/circleci/build/github/nestjs/nest/master?token=abc123def456
 [circleci-url]: https://circleci.com/gh/nestjs/nest
 
-  <p align="center">A progressive <a href="http://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>
+  <p align="center">A progressive <a href="https://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>
     <p align="center">
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/v/@nestjs/core.svg" alt="NPM Version" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
 <a href="https://circleci.com/gh/nestjs/nest" target="_blank"><img src="https://img.shields.io/circleci/build/github/nestjs/nest/master" alt="CircleCI" /></a>
-<a href="https://coveralls.io/github/nestjs/nest?branch=master" target="_blank"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#9" alt="Coverage" /></a>
 <a href="https://discord.gg/G7Qnnhy" target="_blank"><img src="https://img.shields.io/badge/discord-online-brightgreen.svg" alt="Discord"/></a>
 <a href="https://opencollective.com/nest#backer" target="_blank"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
 <a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
@@ -24,21 +23,21 @@
 
 ## Description
 
-Nest is a framework for building efficient, scalable <a href="http://nodejs.org" target="_blank">Node.js</a> server-side applications. It uses modern JavaScript, is built with  <a href="http://www.typescriptlang.org" target="_blank">TypeScript</a> (preserves compatibility with pure JavaScript) and combines elements of OOP (Object Oriented Programming), FP (Functional Programming), and FRP (Functional Reactive Programming).
+Nest is a framework for building efficient, scalable <a href="https://nodejs.org" target="_blank">Node.js</a> server-side applications. It uses modern JavaScript, is built with <a href="https://www.typescriptlang.org" target="_blank">TypeScript</a> (preserves compatibility with pure JavaScript) and combines elements of OOP (Object Oriented Programming), FP (Functional Programming), and FRP (Functional Reactive Programming).
 
-<p>Under the hood, Nest makes use of <a href="https://expressjs.com/" target="_blank">Express</a>, but also, provides compatibility with a wide range of other libraries, like e.g. <a href="https://github.com/fastify/fastify" target="_blank">Fastify</a>, allowing for easy use of the myriad third-party plugins which are available.</p>
+<p>Under the hood, Nest makes use of <a href="https://expressjs.com/" target="_blank">Express</a>, but also provides compatibility with a wide range of other libraries, like <a href="https://github.com/fastify/fastify" target="_blank">Fastify</a>, allowing for easy use of the myriad of third-party plugins which are available.</p>
 
 ## Philosophy
 
-<p>In recent years, thanks to Node.js, JavaScript has become the ‚Äúlingua franca‚Äù of the web for both front and backend applications, giving rise to awesome projects like <a href="https://angular.io/" target="_blank">Angular</a>, <a href="https://github.com/facebook/react" target="_blank">React</a> and <a href="https://github.com/vuejs/vue" target="_blank">Vue</a> which improve developer productivity and enable the construction of fast, testable, extensible frontend applications. However, on the server-side, while there are a lot of superb libraries, helpers and tools for Node, none of them effectively solve the main problem - the architecture.</p>
-<p>Nest aims to provide an application architecture out of the box which allows for effortless creation of highly testable, scalable, loosely coupled and easily maintainable applications. The architecture is heavily inspired by Angular.</p>
+<p>In recent years, thanks to Node.js, JavaScript has become the ‚Äúlingua franca‚Äù of the web for both front and backend applications, giving rise to awesome projects like <a href="https://angular.io/" target="_blank">Angular</a>, <a href="https://github.com/facebook/react" target="_blank">React</a>, and <a href="https://github.com/vuejs/vue" target="_blank">Vue</a>, which improve developer productivity and enable the construction of fast, testable, and extensible frontend applications. However, on the server-side, while there are a lot of superb libraries, helpers, and tools for Node, none of them effectively solve the main problem - the architecture.</p>
+<p>Nest aims to provide an application architecture out of the box which allows for effortless creation of highly testable, scalable, and loosely coupled and easily maintainable applications. The architecture is heavily inspired by Angular.</p>
 
 ## Getting started
 
-* To check out the [guide](https://docs.nestjs.com), visit [docs.nestjs.com](https://docs.nestjs.com). :books:
-* Ë¶ÅÊü•Áúã‰∏≠Êñá [ÊåáÂçó](readme_zh.md), ËØ∑ËÆøÈóÆ [docs.nestjs.cn](https://docs.nestjs.cn). :books:
-* [Í∞ÄÏù¥Îìú](readme_kr.md)Î•º ÌôïÏù∏ÌïòÎ†§Î©¥, [docs.nestjs.com](https://docs.nestjs.com)Î•º Î∞©Î¨∏ÌïòÏÑ∏Ïöî.:books: 
-* „ÉÅ„Çß„ÉÉ„ÇØ„Åô„Çã„Å´„ÅØ [„Ç¨„Ç§„Éâ](readme_jp.md), Ë©≥„Åó„Åè„ÅØ [docs.nestjs.com](https://docs.nestjs.com). :books: 
+- To check out the [guide](https://docs.nestjs.com), visit [docs.nestjs.com](https://docs.nestjs.com). :books:
+- Ë¶ÅÊü•Áúã‰∏≠Êñá [ÊåáÂçó](readme_zh.md), ËØ∑ËÆøÈóÆ [docs.nestjs.cn](https://docs.nestjs.cn). :books:
+- [Í∞ÄÏù¥Îìú](readme_kr.md) Î¨∏ÏÑúÎäî [docs.nestjs.com](https://docs.nestjs.com)ÏóêÏÑú ÌôïÏù∏ÌïòÏã§ Ïàò ÏûàÏäµÎãàÎã§. :books:
+- [„Ç¨„Ç§„Éâ](readme_jp.md)„ÅØ [docs.nestjs.com](https://docs.nestjs.com)„Åß„ÅîÁ¢∫Ë™ç„Åè„Å†„Åï„ÅÑ„ÄÇ :books:
 
 ## Questions
 
@@ -54,71 +53,88 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
-<table style="text-align:center;"><tr>
-  <td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
-  <td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/red-hat-logo.svg" width="200" valign="middle" /></a></td>
-<td>
-<a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
-<td>
-<a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
-</tr></table>
+
+<table style="text-align:center;">
+<tr>
+<td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
+<td><a href="https://microsoft.com/" target="_blank"><img src="https://nestjs.com/img/logos/microsoft-logo.png" width="180" valign="middle" /></a></td>
+<td><a href="https://mojam.co" target="_blank"><img src="https://nestjs.com/img/logos/mojam-logo.png" width="80" valign="middle" /></a></td>
+<td><a href="https://marblism.com?utm_source=nest" target="_blank"><img src="https://nestjs.com/img/logos/marblism-logo.png" width="180" valign="middle" /></a></td>
+<td><a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
+<td><a href="https://amplication.com/" target="_blank"><img src="https://nestjs.com/img/logos/amplication-logo.svg" width="190" valign="middle" /></a></td>
+</tr>
+</table>
 
 #### Gold Sponsors
 
-<table style="text-align:center;"><tr><td>
-  <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
-  <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
-<td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
+<table style="text-align:center;">
+<tr>
+<td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/logos/red-hat-logo.svg" width="200" valign="middle" /></a></td>
+<td><a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
+<td><a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/logos/nx-logo.png" height="45" valign="middle" /></a></td>
+<td><a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/logos/intrinisic-logo.png" width="210" valign="middle" /></a></td>
+<td><a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/logos/jetbrains-logo.svg" width="90" valign="middle" /></a></td>
+</tr>
+<tr>
+<td><a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/logos/snyk-logo-black.png" width="185" valign="middle" /></a></td>
+<td><a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/logos/fuse-logo.svg" width="105" valign="middle" /></a></td>
+<td><a href="https://ridicorp.com/career/" target="_blank"><img src="https://nestjs.com/img/logos/ridi-logo.svg" width="105" valign="middle" /></a></td>
+<td><a href="https://www.movavi.com/imovie-for-windows.html" target="_blank"><img src="https://nestjs.com/img/logos/movavi-logo.svg" width="105" valign="middle" /></a></td>
+<td><a href="https://skunk.team" target="_blank"><img src="https://nestjs.com/img/logos/skunk-logo.png" height="60" valign="middle" /></a></td>
+</tr>
+</table>
 
 #### Silver Sponsors
 
-<table style="text-align:center;"><tr><td>
-<a href="https://neoteric.eu/" target="_blank"><img src="https://nestjs.com/img/neoteric-cut.png" width="120" valign="middle" /></a> </td><td>
-  <a href="http://gojob.com" target="_blank"><img src="http://nestjs.com/img/gojob-logo.png" valign="middle" width="100" /></a> </td><td>
-<a href="https://www.myleodsc.com/" target="_blank"><img src="https://nestjs.com/img/myleo-logo.png" width="180" valign="middle" /></td><td>
-<a href="https://careers.meetdandy.com/?gh_src=063ba61e3us" target="_blank"><img src="https://nestjs.com/img/dandy-roles-logo.svg" width="150" valign="middle" /></td><td>
-<a href="https://www.castlecraft.in" target="_blank"><img src="https://nestjs.com/img/castlecraft-logo.png" width="150" valign="middle" /></td>
-<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td></tr></table>
+<table style="text-align:center;">
+<tr>
+<td><a href="https://www.mercedes-benz.com/" target="_blank"><img src="https://nestjs.com/img/logos/mercedes-logo.png" width="100" valign="middle" /></a></td>
+<td><a href="https://www.dinii.jp/" target="_blank"><img src="https://nestjs.com/img/logos/dinii-logo.png" width="65" valign="middle" /></a></td>
+<td><a href="https://bloodycase.com/?promocode=NEST" target="_blank"><img src="https://nestjs.com/img/logos/bloodycase-logo.png" width="65" valign="middle" /></a></td>
+<td><a href="https://handsontable.com/docs/react-data-grid/?utm_source=NestJS_GH&utm_medium=sponsorship&utm_campaign=library_sponsorship_2024" target="_blank"><img src="https://nestjs.com/img/logos/handsontable-dark-logo.svg#2" width="150" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.itflashcards.com/" target="_blank"><img src="https://nestjs.com/img/logos/it_flashcards-logo.png" width="170" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://arcjet.com/?ref=nestjs" target="_blank"><img src="https://nestjs.com/img/logos/arcjet-logo.svg" width="170" valign="middle" /></a></td>
+</tr>
+</table>
 
 #### Sponsors
 
-<table><tr><td align="center" valign="middle">
-<a href="https://www.swingdev.io" target="_blank"><img src="https://nestjs.com/img/swingdev-logo.svg#1" width="110" valign="middle" /> </a></td><td align="center" valign="middle">
-<a href="https://www.novologic.com/" target="_blank"><img src="https://nestjs.com/img/novologic.png" width="110" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://ever.co/" target="_blank"><img src="https://nestjs.com/img/ever-logo.png" width="72" valign="middle" /></a>  </td><td align="center" valign="middle">
-<a href="https://blokt.com" target="_blank"><img src="https://nestjs.com/img/blokt-logo.png" width="120" valign="middle" /></a>  </td><td align="center" valign="middle"> 
-  <a href="http://architectnow.net/" target="_blank"><img src="https://nestjs.com/img/architectnow.png" width="125" valign="middle" /></a> </td><td align="center" valign="middle">
-  <a href="https://quander.io/" target="_blank"><img src="https://nestjs.com/img/quander.png" width="100" valign="middle" /></a> </td></tr><tr><td align="center" valign="middle">
-  <a href="https://mantro.net/" target="_blank"><img src="https://nestjs.com/img/mantro-logo.svg" width="95" valign="middle" /></a> </td><td align="center" valign="middle">
-  <a href="https://triplebyte.com/" target="_blank"><img src="https://nestjs.com/img/triplebyte.png" width="107" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://reposit.co.uk/" target="_blank"><img src="https://nestjs.com/img/reposit-logo.png" width="71" valign="middle" /></a></td><td align="center" valign="middle">
-<a href="https://nearpod.com/" target="_blank"><img src="https://nestjs.com/img/nearpod-logo.svg" width="100" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://clay.global/" target="_blank"><img src="https://nestjs.com/img/clay-logo.svg" width="75" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://firesticktricks.com" target="_blank"><img src="https://nestjs.com/img/firesticktricks-logo.png" width="120" valign="middle" /></a></td></tr><tr><td align="center" valign="middle">
-<a href="https://www.codeguesser.co.uk" target="_blank"><img src="https://nestjs.com/img/codeguesser-logo.svg" width="120" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://f-a.nz/" target="_blank"><img src="https://nestjs.com/img/franz.svg" width="80" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://sparkfabrik.com/" target="_blank"><img src="https://nestjs.com/img/sparkfabrik-logo.png" width="120" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://www.thebigphonestore.co.uk/" target="_blank"><img src="https://nestjs.com/img/the-big-phone-store-logo.png" width="65" valign="middle" /></a></td>
-  <td align="center" valign="middle">
-  <a href="https://genuinebee.com/" target="_blank"><img src="https://nestjs.com/img/genuinebee.svg" width="97" valign="middle" /></a> </td>
-<td align="center" valign="middle"><a href="https://sanyodigital.com/" target="_blank"><img src="https://nestjs.com/img/sanyo-digital.png" width="130" valign="middle" /></a></td></tr><tr><td align="center" valign="middle"><a href="https://vpn-review.com/vpn-for-torrenting" target="_blank"><img src="https://nestjs.com/img/vpn-review-logo.png" width="85" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://lambda-it.ch/" target="_blank"><img src="https://nestjs.com/img/lambda-it-logo.svg" width="115" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://pickwriters.com/top-10-translation-services" target="_blank"><img src="https://nestjs.com/img/pickwriters-logo.png" width="40" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://thewordpoint.com/services/localization" target="_blank"><img src="https://nestjs.com/img/thewordpoint-logo.png" width="40" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://meercode.io/" target="_blank"><img src="https://nestjs.com/img/meercode-logo.png" width="60" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://www.najlepszeplatformyforex.pl/blog/broker-xtb/" target="_blank"><img src="https://nestjs.com/img/npf-logo.jpg" width="200" valign="middle" /></a></td></tr><tr>
-<td align="center" valign="middle"><a href="https://thestandarddaily.com/" target="_blank"><img src="https://nestjs.com/img/the-standard-daily-logo.png" width="180" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://houseofangular.io/" target="_blank"><img src="https://nestjs.com/img/house-of-angular.png" width="100" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://rocketech.it/cases/?utm_source=google&utm_medium=badge&utm_campaign=nestjs" target="_blank"><img src="https://nestjs.com/img/rocketech-logo.svg" width="110" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://www.bystored.com/" target="_blank"><img src="https://nestjs.com/img/stored-logo.svg" width="110" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://studyclerk.com/pay-for-research-paper" target="_blank"><img src="https://nestjs.com/img/studyclerk-logo.png" width="125" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://xyndata.com" target="_blank"><img src="https://nestjs.com/img/xyndata-logo.png" width="125" valign="middle" /></a></td></tr><tr>
-  <td align="center" valign="middle"><a href="https://www.anonymistic.com/" target="_blank"><img src="https://nestjs.com/img/anonymistic-logo.png" width="125" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/naologic-logo.svg" width="125" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://messaged.com/" target="_blank"><img src="https://nestjs.com/img/messaged-logo.png" width="50" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/triplecore-logo.svg" width="50" valign="middle" /></a></td>
-  </tr></table>
+<table>
+<tr>
+<td align="center" valign="middle"><a href="https://www.swingdev.io" target="_blank"><img src="https://nestjs.com/img/logos/swingdev-logo.svg#1" width="110" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.novologic.com/" target="_blank"><img src="https://nestjs.com/img/logos/novologic.png" width="110" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://mantro.net/" target="_blank"><img src="https://nestjs.com/img/logos/mantro-logo.svg" width="95" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://triplebyte.com/" target="_blank"><img src="https://nestjs.com/img/logos/triplebyte.png" width="107" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://nearpod.com/" target="_blank"><img src="https://nestjs.com/img/logos/nearpod-logo.svg" width="100" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://genuinebee.com/" target="_blank"><img src="https://nestjs.com/img/logos/genuinebee.svg" width="97" valign="middle" /></a></td>
+</tr>
+<tr>
+<td align="center" valign="middle"><a href="https://vpn-review.com/vpn-for-torrenting" target="_blank"><img src="https://nestjs.com/img/logos/vpn-review-logo.png" width="85" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://lambda-it.ch/" target="_blank"><img src="https://nestjs.com/img/logos/lambda-it-logo.svg" width="115" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://rocketech.it/cases/?utm_source=google&utm_medium=badge&utm_campaign=nestjs" target="_blank"><img src="https://nestjs.com/img/logos/rocketech-logo.svg" width="110" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.anonymistic.com/" target="_blank"><img src="https://nestjs.com/img/logos/anonymistic-logo.png" width="125" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/logos/naologic-logo.svg" width="125" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/logos/triplecore-logo.svg" width="50" valign="middle" /></a></td>
+</tr>
+<tr>
+<td align="center" valign="middle"><a href="https://thecasinowizard.com/bonuses/no-deposit-bonuses/" target="_blank"><img src="https://nestjs.com/img/logos/casinowizard-logo.png" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://polygon-software.ch/" target="_blank"><img src="https://nestjs.com/img/logos/polygon-logo.svg" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/logos/boringowl-logo.svg" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://nordbot.app/" target="_blank"><img src="https://nestjs.com/img/logos/nordbot-logo.png" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://doppio.sh/" target="_blank"><img src="https://nestjs.com/img/logos/dopiosh-logo.png" width="50" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.hingehealth.com/" target="_blank"><img src="https://nestjs.com/img/logos/hinge-health-logo.svg" width="100" valign="middle" /></a></td>
+</tr>
+<tr>
+<td align="center" valign="middle"><a href="https://julienferand.dev/" target="_blank"><img src="https://nestjs.com/img/logos/julienferand-logo.jpeg" width="55" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.tripoffice.com/" target="_blank"><img src="https://nestjs.com/img/logos/tripoffice-logo.png" width="140" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://solcellsforetag.se/" target="_blank"><img src="https://nestjs.com/img/logos/solcellsforetag-logo.svg" width="140" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.route4me.com/" target="_blank"><img src="https://nestjs.com/img/logos/route4me-logo.svg" width="100" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.slotsup.com/" target="_blank"><img src="https://nestjs.com/img/logos/slotsup-logo.png" width="60" valign="middle" /></a></td>
+</tr>
+</table>
 
 ## Backers
 
@@ -126,9 +142,9 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 
 ## Stay in touch
 
-* Author - [Kamil My≈õliwiec](https://twitter.com/kammysliwiec)
-* Website - [https://nestjs.com](https://nestjs.com/)
-* Twitter - [@nestframework](https://twitter.com/nestframework)
+- Author - [Kamil My≈õliwiec](https://x.com/kammysliwiec)
+- Website - [https://nestjs.com](https://nestjs.com/)
+- X - [@nestframework](https://x.com/nestframework)
 
 ## License
 
diff --git a/packages/platform-express/adapters/express-adapter.ts b/packages/platform-express/adapters/express-adapter.ts
index afe1b782e..ec27a1954 100644
--- a/packages/platform-express/adapters/express-adapter.ts
+++ b/packages/platform-express/adapters/express-adapter.ts
@@ -1,14 +1,14 @@
 import {
+  HttpStatus,
   InternalServerErrorException,
+  Logger,
   RequestMethod,
   StreamableFile,
+  VERSION_NEUTRAL,
+  VersioningOptions,
   VersioningType,
 } from '@nestjs/common';
-import {
-  VersioningOptions,
-  VersionValue,
-  VERSION_NEUTRAL,
-} from '@nestjs/common/interfaces';
+import { VersionValue } from '@nestjs/common/interfaces';
 import {
   CorsOptions,
   CorsOptionsDelegate,
@@ -19,21 +19,44 @@ import {
   isNil,
   isObject,
   isString,
+  isUndefined,
 } from '@nestjs/common/utils/shared.utils';
 import { AbstractHttpAdapter } from '@nestjs/core/adapters/http-adapter';
 import { RouterMethodFactory } from '@nestjs/core/helpers/router-method-factory';
+import * as bodyparser from 'body-parser';
 import {
   json as bodyParserJson,
   urlencoded as bodyParserUrlencoded,
 } from 'body-parser';
 import * as cors from 'cors';
 import * as express from 'express';
+import type { Server } from 'http';
 import * as http from 'http';
 import * as https from 'https';
+import { Duplex, pipeline } from 'stream';
+import { NestExpressBodyParserOptions } from '../interfaces/nest-express-body-parser-options.interface';
+import { NestExpressBodyParserType } from '../interfaces/nest-express-body-parser.interface';
 import { ServeStaticOptions } from '../interfaces/serve-static-options.interface';
-
-export class ExpressAdapter extends AbstractHttpAdapter {
+import { getBodyParserOptions } from './utils/get-body-parser-options.util';
+
+type VersionedRoute = <
+  TRequest extends Record<string, any> = any,
+  TResponse = any,
+>(
+  req: TRequest,
+  res: TResponse,
+  next: () => void,
+) => any;
+
+/**
+ * @publicApi
+ */
+export class ExpressAdapter extends AbstractHttpAdapter<
+  http.Server | https.Server
+> {
   private readonly routerMethodFactory = new RouterMethodFactory();
+  private readonly logger = new Logger(ExpressAdapter.name);
+  private readonly openConnections = new Set<Duplex>();
 
   constructor(instance?: any) {
     super(instance || express());
@@ -48,13 +71,46 @@ export class ExpressAdapter extends AbstractHttpAdapter {
     }
     if (body instanceof StreamableFile) {
       const streamHeaders = body.getHeaders();
-      if (response.getHeader('Content-Type') === undefined) {
+      if (
+        response.getHeader('Content-Type') === undefined &&
+        streamHeaders.type !== undefined
+      ) {
         response.setHeader('Content-Type', streamHeaders.type);
       }
-      if (response.getHeader('Content-Disposition') === undefined) {
+      if (
+        response.getHeader('Content-Disposition') === undefined &&
+        streamHeaders.disposition !== undefined
+      ) {
         response.setHeader('Content-Disposition', streamHeaders.disposition);
       }
-      return body.getStream().pipe(response);
+      if (
+        response.getHeader('Content-Length') === undefined &&
+        streamHeaders.length !== undefined
+      ) {
+        response.setHeader('Content-Length', streamHeaders.length);
+      }
+      return pipeline(
+        body.getStream().once('error', (err: Error) => {
+          body.errorHandler(err, response);
+        }),
+        response,
+        (err: any) => {
+          if (err) {
+            body.errorLogger(err);
+          }
+        },
+      );
+    }
+    const responseContentType = response.getHeader('Content-Type');
+    if (
+      typeof responseContentType === 'string' &&
+      !responseContentType.startsWith('application/json') &&
+      body?.statusCode >= HttpStatus.BAD_REQUEST
+    ) {
+      this.logger.warn(
+        "Content-Type doesn't match Reply body, you might need a custom ExceptionFilter for non-JSON responses",
+      );
+      response.setHeader('Content-Type', 'application/json');
     }
     return isObject(body) ? response.json(body) : response.send(String(body));
   }
@@ -63,6 +119,10 @@ export class ExpressAdapter extends AbstractHttpAdapter {
     return response.status(statusCode);
   }
 
+  public end(response: any, message?: string) {
+    return response.end(message);
+  }
+
   public render(response: any, view: string, options: any) {
     return response.render(view, options);
   }
@@ -79,17 +139,35 @@ export class ExpressAdapter extends AbstractHttpAdapter {
     return this.use(handler);
   }
 
+  public isHeadersSent(response: any): boolean {
+    return response.headersSent;
+  }
+
+  public getHeader?(response: any, name: string) {
+    return response.get(name);
+  }
+
   public setHeader(response: any, name: string, value: string) {
     return response.set(name, value);
   }
 
-  public listen(port: string | number, callback?: () => void);
-  public listen(port: string | number, hostname: string, callback?: () => void);
-  public listen(port: any, ...args: any[]) {
+  public appendHeader?(response: any, name: string, value: string) {
+    return response.append(name, value);
+  }
+
+  public listen(port: string | number, callback?: () => void): Server;
+  public listen(
+    port: string | number,
+    hostname: string,
+    callback?: () => void,
+  ): Server;
+  public listen(port: any, ...args: any[]): Server {
     return this.httpServer.listen(port, ...args);
   }
 
   public close() {
+    this.closeOpenConnections();
+
     if (!this.httpServer) {
       return undefined;
     }
@@ -140,7 +218,7 @@ export class ExpressAdapter extends AbstractHttpAdapter {
   }
 
   public enableCors(options: CorsOptions | CorsOptionsDelegate<any>) {
-    return this.use(cors(options));
+    return this.use(cors(options as any));
   }
 
   public createMiddlewareFactory(
@@ -155,24 +233,48 @@ export class ExpressAdapter extends AbstractHttpAdapter {
     const isHttpsEnabled = options && options.httpsOptions;
     if (isHttpsEnabled) {
       this.httpServer = https.createServer(
-        options.httpsOptions,
+        options.httpsOptions!,
         this.getInstance(),
       );
-      return;
+    } else {
+      this.httpServer = http.createServer(this.getInstance());
+    }
+
+    if (options?.forceCloseConnections) {
+      this.trackOpenConnections();
     }
-    this.httpServer = http.createServer(this.getInstance());
   }
 
-  public registerParserMiddleware() {
+  public registerParserMiddleware(prefix?: string, rawBody?: boolean) {
+    const bodyParserJsonOptions = getBodyParserOptions(rawBody!);
+    const bodyParserUrlencodedOptions = getBodyParserOptions(rawBody!, {
+      extended: true,
+    });
+
     const parserMiddleware = {
-      jsonParser: bodyParserJson(),
-      urlencodedParser: bodyParserUrlencoded({ extended: true }),
+      jsonParser: bodyParserJson(bodyParserJsonOptions),
+      urlencodedParser: bodyParserUrlencoded(bodyParserUrlencodedOptions),
     };
     Object.keys(parserMiddleware)
       .filter(parser => !this.isMiddlewareApplied(parser))
       .forEach(parserKey => this.use(parserMiddleware[parserKey]));
   }
 
+  public useBodyParser<
+    Options extends NestExpressBodyParserOptions = NestExpressBodyParserOptions,
+  >(
+    type: NestExpressBodyParserType,
+    rawBody: boolean,
+    options?: Omit<Options, 'verify'>,
+  ): this {
+    const parserOptions = getBodyParserOptions<Options>(rawBody, options);
+    const parser = bodyparser[type](parserOptions);
+
+    this.use(parser);
+
+    return this;
+  }
+
   public setLocal(key: string, value: any) {
     this.instance.locals[key] = value;
     return this;
@@ -186,21 +288,76 @@ export class ExpressAdapter extends AbstractHttpAdapter {
     handler: Function,
     version: VersionValue,
     versioningOptions: VersioningOptions,
-  ) {
-    return <TRequest extends Record<string, any> = any, TResponse = any>(
-      req: TRequest,
-      res: TResponse,
-      next: () => void,
-    ) => {
-      if (version === VERSION_NEUTRAL) {
-        return handler(req, res, next);
+  ): VersionedRoute {
+    const callNextHandler: VersionedRoute = (req, res, next) => {
+      if (!next) {
+        throw new InternalServerErrorException(
+          'HTTP adapter does not support filtering on version',
+        );
       }
+      return next();
+    };
+
+    if (
+      version === VERSION_NEUTRAL ||
       // URL Versioning is done via the path, so the filter continues forward
-      if (versioningOptions.type === VersioningType.URI) {
-        return handler(req, res, next);
-      }
-      // Media Type (Accept Header) Versioning Handler
-      if (versioningOptions.type === VersioningType.MEDIA_TYPE) {
+      versioningOptions.type === VersioningType.URI
+    ) {
+      const handlerForNoVersioning: VersionedRoute = (req, res, next) =>
+        handler(req, res, next);
+
+      return handlerForNoVersioning;
+    }
+
+    // Custom Extractor Versioning Handler
+    if (versioningOptions.type === VersioningType.CUSTOM) {
+      const handlerForCustomVersioning: VersionedRoute = (req, res, next) => {
+        const extractedVersion = versioningOptions.extractor(req);
+
+        if (Array.isArray(version)) {
+          if (
+            Array.isArray(extractedVersion) &&
+            version.filter(v => extractedVersion.includes(v as string)).length
+          ) {
+            return handler(req, res, next);
+          }
+
+          if (
+            isString(extractedVersion) &&
+            version.includes(extractedVersion)
+          ) {
+            return handler(req, res, next);
+          }
+        } else if (isString(version)) {
+          // Known bug here - if there are multiple versions supported across separate
+          // handlers/controllers, we can't select the highest matching handler.
+          // Since this code is evaluated per-handler, then we can't see if the highest
+          // specified version exists in a different handler.
+          if (
+            Array.isArray(extractedVersion) &&
+            extractedVersion.includes(version)
+          ) {
+            return handler(req, res, next);
+          }
+
+          if (isString(extractedVersion) && version === extractedVersion) {
+            return handler(req, res, next);
+          }
+        }
+
+        return callNextHandler(req, res, next);
+      };
+
+      return handlerForCustomVersioning;
+    }
+
+    // Media Type (Accept Header) Versioning Handler
+    if (versioningOptions.type === VersioningType.MEDIA_TYPE) {
+      const handlerForMediaTypeVersioning: VersionedRoute = (
+        req,
+        res,
+        next,
+      ) => {
         const MEDIA_TYPE_HEADER = 'Accept';
         const acceptHeaderValue: string | undefined =
           req.headers?.[MEDIA_TYPE_HEADER] ||
@@ -208,9 +365,16 @@ export class ExpressAdapter extends AbstractHttpAdapter {
 
         const acceptHeaderVersionParameter = acceptHeaderValue
           ? acceptHeaderValue.split(';')[1]
-          : '';
+          : undefined;
 
-        if (acceptHeaderVersionParameter) {
+        // No version was supplied
+        if (isUndefined(acceptHeaderVersionParameter)) {
+          if (Array.isArray(version)) {
+            if (version.includes(VERSION_NEUTRAL)) {
+              return handler(req, res, next);
+            }
+          }
+        } else {
           const headerVersion = acceptHeaderVersionParameter.split(
             versioningOptions.key,
           )[1];
@@ -225,14 +389,28 @@ export class ExpressAdapter extends AbstractHttpAdapter {
             }
           }
         }
-      }
-      // Header Versioning Handler
-      else if (versioningOptions.type === VersioningType.HEADER) {
+
+        return callNextHandler(req, res, next);
+      };
+
+      return handlerForMediaTypeVersioning;
+    }
+
+    // Header Versioning Handler
+    if (versioningOptions.type === VersioningType.HEADER) {
+      const handlerForHeaderVersioning: VersionedRoute = (req, res, next) => {
         const customHeaderVersionParameter: string | undefined =
           req.headers?.[versioningOptions.header] ||
           req.headers?.[versioningOptions.header.toLowerCase()];
 
-        if (customHeaderVersionParameter) {
+        // No version was supplied
+        if (isUndefined(customHeaderVersionParameter)) {
+          if (Array.isArray(version)) {
+            if (version.includes(VERSION_NEUTRAL)) {
+              return handler(req, res, next);
+            }
+          }
+        } else {
           if (Array.isArray(version)) {
             if (version.includes(customHeaderVersionParameter)) {
               return handler(req, res, next);
@@ -243,15 +421,29 @@ export class ExpressAdapter extends AbstractHttpAdapter {
             }
           }
         }
-      }
 
-      if (!next) {
-        throw new InternalServerErrorException(
-          'HTTP adapter does not support filtering on version',
-        );
-      }
-      return next();
-    };
+        return callNextHandler(req, res, next);
+      };
+
+      return handlerForHeaderVersioning;
+    }
+
+    throw new Error('Unsupported versioning options');
+  }
+
+  private trackOpenConnections() {
+    this.httpServer.on('connection', (socket: Duplex) => {
+      this.openConnections.add(socket);
+
+      socket.on('close', () => this.openConnections.delete(socket));
+    });
+  }
+
+  private closeOpenConnections() {
+    for (const socket of this.openConnections) {
+      socket.destroy();
+      this.openConnections.delete(socket);
+    }
   }
 
   private isMiddlewareApplied(name: string): boolean {
diff --git a/packages/platform-express/adapters/utils/get-body-parser-options.util.ts b/packages/platform-express/adapters/utils/get-body-parser-options.util.ts
new file mode 100644
index 000000000..f7833ad68
--- /dev/null
+++ b/packages/platform-express/adapters/utils/get-body-parser-options.util.ts
@@ -0,0 +1,30 @@
+import type { RawBodyRequest } from '@nestjs/common';
+import type { IncomingMessage, ServerResponse } from 'http';
+import type { NestExpressBodyParserOptions } from '../../interfaces';
+
+const rawBodyParser = (
+  req: RawBodyRequest<IncomingMessage>,
+  _res: ServerResponse,
+  buffer: Buffer,
+) => {
+  if (Buffer.isBuffer(buffer)) {
+    req.rawBody = buffer;
+  }
+  return true;
+};
+
+export function getBodyParserOptions<Options = NestExpressBodyParserOptions>(
+  rawBody: boolean,
+  options?: Omit<Options, 'verify'>,
+): Options {
+  let parserOptions: Options = (options || {}) as Options;
+
+  if (rawBody === true) {
+    parserOptions = {
+      ...parserOptions,
+      verify: rawBodyParser,
+    };
+  }
+
+  return parserOptions;
+}
diff --git a/packages/platform-express/index.ts b/packages/platform-express/index.ts
index df03ac629..ce3dbc432 100644
--- a/packages/platform-express/index.ts
+++ b/packages/platform-express/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @platform-express
- * Copyright(c) 2017 - 2021 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2023 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
diff --git a/packages/platform-express/interfaces/index.ts b/packages/platform-express/interfaces/index.ts
index 3238b1c16..ac057435a 100644
--- a/packages/platform-express/interfaces/index.ts
+++ b/packages/platform-express/interfaces/index.ts
@@ -1 +1,3 @@
 export * from './nest-express-application.interface';
+export { NestExpressBodyParserOptions } from './nest-express-body-parser-options.interface';
+export * from './nest-express-body-parser.interface';
diff --git a/packages/platform-express/interfaces/nest-express-application.interface.ts b/packages/platform-express/interfaces/nest-express-application.interface.ts
index 0b93c1dbf..3020c42ee 100644
--- a/packages/platform-express/interfaces/nest-express-application.interface.ts
+++ b/packages/platform-express/interfaces/nest-express-application.interface.ts
@@ -1,4 +1,9 @@
-import { INestApplication } from '@nestjs/common';
+import { INestApplication, HttpServer } from '@nestjs/common';
+import type { Server as CoreHttpServer } from 'http';
+import type { Server as CoreHttpsServer } from 'https';
+import type { Express } from 'express';
+import { NestExpressBodyParserOptions } from './nest-express-body-parser-options.interface';
+import { NestExpressBodyParserType } from './nest-express-body-parser.interface';
 import { ServeStaticOptions } from './serve-static-options.interface';
 
 /**
@@ -8,7 +13,31 @@ import { ServeStaticOptions } from './serve-static-options.interface';
  *
  * @publicApi
  */
-export interface NestExpressApplication extends INestApplication {
+export interface NestExpressApplication<
+  TServer extends CoreHttpServer | CoreHttpsServer = CoreHttpServer,
+> extends INestApplication<TServer> {
+  /**
+   * Returns the underlying HTTP adapter bounded to the Express.js app.
+   *
+   * @returns {HttpServer}
+   */
+  getHttpAdapter(): HttpServer<Express.Request, Express.Response, Express>;
+
+  /**
+   * Starts the application.
+   *
+   * @param {number|string} port
+   * @param {string} [hostname]
+   * @param {Function} [callback] Optional callback
+   * @returns {Promise} A Promise that, when resolved, is a reference to the underlying HttpServer.
+   */
+  listen(port: number | string, callback?: () => void): Promise<TServer>;
+  listen(
+    port: number | string,
+    hostname: string,
+    callback?: () => void,
+  ): Promise<TServer>;
+
   /**
    * A wrapper function around native `express.set()` method.
    *
@@ -57,6 +86,24 @@ export interface NestExpressApplication extends INestApplication {
    */
   useStaticAssets(path: string, options?: ServeStaticOptions): this;
 
+  /**
+   * Register Express body parsers on the fly. Will respect
+   * the application's `rawBody` option.
+   *
+   * @example
+   * const app = await NestFactory.create<NestExpressApplication>(
+   *   AppModule,
+   *   { rawBody: true }
+   * );
+   * app.useBodyParser('json', { limit: '50mb' });
+   *
+   * @returns {this}
+   */
+  useBodyParser<Options = NestExpressBodyParserOptions>(
+    parser: NestExpressBodyParserType,
+    options?: Omit<Options, 'verify'>,
+  ): this;
+
   /**
    * Sets one or multiple base directories for templates (views).
    *
diff --git a/packages/platform-express/interfaces/nest-express-body-parser-options.interface.ts b/packages/platform-express/interfaces/nest-express-body-parser-options.interface.ts
new file mode 100644
index 000000000..93df3c5f6
--- /dev/null
+++ b/packages/platform-express/interfaces/nest-express-body-parser-options.interface.ts
@@ -0,0 +1,26 @@
+import type { IncomingMessage } from 'http';
+
+/**
+ * Type alias to keep compatibility with @types/body-parser
+ * @see https://github.com/DefinitelyTyped/DefinitelyTyped/blob/dcd1673c4fa18a15ea8cd8ff8af7d563bb6dc8e6/types/body-parser/index.d.ts#L48-L66#L48-L66
+ * @publicApi
+ */
+export interface NestExpressBodyParserOptions {
+  /** When set to true, then deflated (compressed) bodies will be inflated; when false, deflated bodies are rejected. Defaults to true. */
+  inflate?: boolean | undefined;
+
+  /**
+   * Controls the maximum request body size. If this is a number,
+   * then the value specifies the number of bytes; if it is a string,
+   * the value is passed to the bytes library for parsing. Defaults to '100kb'.
+   */
+  limit?: number | string | undefined;
+
+  /**
+   * The type option is used to determine what media type the middleware will parse
+   */
+  type?: string | string[] | ((req: IncomingMessage) => any) | undefined;
+
+  // Catch-all for body-parser type specific options
+  [key: string]: unknown;
+}
diff --git a/packages/platform-express/interfaces/nest-express-body-parser.interface.ts b/packages/platform-express/interfaces/nest-express-body-parser.interface.ts
new file mode 100644
index 000000000..9cb003054
--- /dev/null
+++ b/packages/platform-express/interfaces/nest-express-body-parser.interface.ts
@@ -0,0 +1,4 @@
+/**
+ * Interface defining possible body parser types, to be used with `NestExpressApplication.useBodyParser()`.
+ */
+export type NestExpressBodyParserType = 'json' | 'urlencoded' | 'text' | 'raw';
diff --git a/packages/platform-express/multer/interceptors/any-files.interceptor.ts b/packages/platform-express/multer/interceptors/any-files.interceptor.ts
index afa8a0003..28a332fdd 100644
--- a/packages/platform-express/multer/interceptors/any-files.interceptor.ts
+++ b/packages/platform-express/multer/interceptors/any-files.interceptor.ts
@@ -16,6 +16,11 @@ import { transformException } from '../multer/multer.utils';
 
 type MulterInstance = any;
 
+/**
+ * @param localOptions
+ *
+ * @publicApi
+ */
 export function AnyFilesInterceptor(
   localOptions?: MulterOptions,
 ): Type<NestInterceptor> {
diff --git a/packages/platform-express/multer/interceptors/file-fields.interceptor.ts b/packages/platform-express/multer/interceptors/file-fields.interceptor.ts
index 154981a9b..27f05afca 100644
--- a/packages/platform-express/multer/interceptors/file-fields.interceptor.ts
+++ b/packages/platform-express/multer/interceptors/file-fields.interceptor.ts
@@ -19,6 +19,11 @@ import { transformException } from '../multer/multer.utils';
 
 type MulterInstance = any;
 
+/**
+ * @param uploadFields
+ * @param localOptions
+ * @publicApi
+ */
 export function FileFieldsInterceptor(
   uploadFields: MulterField[],
   localOptions?: MulterOptions,
diff --git a/packages/platform-express/multer/interceptors/file.interceptor.ts b/packages/platform-express/multer/interceptors/file.interceptor.ts
index a1fd82b6a..bbc8f3947 100644
--- a/packages/platform-express/multer/interceptors/file.interceptor.ts
+++ b/packages/platform-express/multer/interceptors/file.interceptor.ts
@@ -16,6 +16,12 @@ import { transformException } from '../multer/multer.utils';
 
 type MulterInstance = any;
 
+/**
+ * @param fieldName
+ * @param localOptions
+ *
+ * @publicApi
+ */
 export function FileInterceptor(
   fieldName: string,
   localOptions?: MulterOptions,
diff --git a/packages/platform-express/multer/interceptors/files.interceptor.ts b/packages/platform-express/multer/interceptors/files.interceptor.ts
index 83705333d..dbdb1abe0 100644
--- a/packages/platform-express/multer/interceptors/files.interceptor.ts
+++ b/packages/platform-express/multer/interceptors/files.interceptor.ts
@@ -16,6 +16,14 @@ import { transformException } from '../multer/multer.utils';
 
 type MulterInstance = any;
 
+/**
+ *
+ * @param fieldName
+ * @param maxCount
+ * @param localOptions
+ *
+ * @publicApi
+ */
 export function FilesInterceptor(
   fieldName: string,
   maxCount?: number,
diff --git a/packages/platform-express/multer/interceptors/index.ts b/packages/platform-express/multer/interceptors/index.ts
index 5f76d7d47..855620d97 100644
--- a/packages/platform-express/multer/interceptors/index.ts
+++ b/packages/platform-express/multer/interceptors/index.ts
@@ -2,3 +2,4 @@ export * from './any-files.interceptor';
 export * from './file-fields.interceptor';
 export * from './file.interceptor';
 export * from './files.interceptor';
+export * from './no-files.interceptor';
diff --git a/packages/platform-express/multer/interceptors/no-files.interceptor.ts b/packages/platform-express/multer/interceptors/no-files.interceptor.ts
new file mode 100644
index 000000000..696df1ab3
--- /dev/null
+++ b/packages/platform-express/multer/interceptors/no-files.interceptor.ts
@@ -0,0 +1,61 @@
+import {
+  CallHandler,
+  ExecutionContext,
+  Inject,
+  mixin,
+  NestInterceptor,
+  Optional,
+  Type,
+} from '@nestjs/common';
+import * as multer from 'multer';
+import { Observable } from 'rxjs';
+import { MULTER_MODULE_OPTIONS } from '../files.constants';
+import { MulterModuleOptions } from '../interfaces';
+import { MulterOptions } from '../interfaces/multer-options.interface';
+import { transformException } from '../multer/multer.utils';
+
+type MulterInstance = any;
+
+/**
+ *
+ * @param localOptions
+ * @publicApi
+ */
+export function NoFilesInterceptor(
+  localOptions?: MulterOptions,
+): Type<NestInterceptor> {
+  class MixinInterceptor implements NestInterceptor {
+    protected multer: MulterInstance;
+
+    constructor(
+      @Optional()
+      @Inject(MULTER_MODULE_OPTIONS)
+      options: MulterModuleOptions = {},
+    ) {
+      this.multer = (multer as any)({
+        ...options,
+        ...localOptions,
+      });
+    }
+
+    async intercept(
+      context: ExecutionContext,
+      next: CallHandler,
+    ): Promise<Observable<any>> {
+      const ctx = context.switchToHttp();
+
+      await new Promise<void>((resolve, reject) =>
+        this.multer.none()(ctx.getRequest(), ctx.getResponse(), (err: any) => {
+          if (err) {
+            const error = transformException(err);
+            return reject(error);
+          }
+          resolve();
+        }),
+      );
+      return next.handle();
+    }
+  }
+  const Interceptor = mixin(MixinInterceptor);
+  return Interceptor;
+}
diff --git a/packages/platform-express/multer/interfaces/files-upload-module.interface.ts b/packages/platform-express/multer/interfaces/files-upload-module.interface.ts
index d467e476e..a8cd80522 100644
--- a/packages/platform-express/multer/interfaces/files-upload-module.interface.ts
+++ b/packages/platform-express/multer/interfaces/files-upload-module.interface.ts
@@ -1,13 +1,18 @@
-import { Type } from '@nestjs/common';
-import { ModuleMetadata } from '@nestjs/common/interfaces';
+import { ModuleMetadata, Type } from '@nestjs/common/interfaces';
 import { MulterOptions } from './multer-options.interface';
 
 export type MulterModuleOptions = MulterOptions;
 
+/**
+ * @publicApi
+ */
 export interface MulterOptionsFactory {
   createMulterOptions(): Promise<MulterModuleOptions> | MulterModuleOptions;
 }
 
+/**
+ * @publicApi
+ */
 export interface MulterModuleAsyncOptions
   extends Pick<ModuleMetadata, 'imports'> {
   useExisting?: Type<MulterOptionsFactory>;
diff --git a/packages/platform-express/multer/interfaces/multer-options.interface.ts b/packages/platform-express/multer/interfaces/multer-options.interface.ts
index 6bcb81b4e..a5ee5db22 100644
--- a/packages/platform-express/multer/interfaces/multer-options.interface.ts
+++ b/packages/platform-express/multer/interfaces/multer-options.interface.ts
@@ -1,8 +1,10 @@
 /**
  * @see https://github.com/expressjs/multer
+ *
+ * @publicApi
  */
 export interface MulterOptions {
-  dest?: string;
+  dest?: string | Function;
   /** The storage engine to use for uploaded files. */
   storage?: any;
   /**
@@ -55,6 +57,9 @@ export interface MulterOptions {
   ): void;
 }
 
+/**
+ * @publicApi
+ */
 export interface MulterField {
   /** The field name. */
   name: string;
diff --git a/packages/platform-express/multer/multer.module.ts b/packages/platform-express/multer/multer.module.ts
index 99545c168..0ee770b93 100644
--- a/packages/platform-express/multer/multer.module.ts
+++ b/packages/platform-express/multer/multer.module.ts
@@ -8,13 +8,16 @@ import {
 } from './interfaces/files-upload-module.interface';
 import { MULTER_MODULE_ID } from './multer.constants';
 
+/**
+ * @publicApi
+ */
 @Module({})
 export class MulterModule {
   static register(options: MulterModuleOptions = {}): DynamicModule {
     return {
       module: MulterModule,
       providers: [
-        { provide: MULTER_MODULE_OPTIONS, useValue: options },
+        { provide: MULTER_MODULE_OPTIONS, useFactory: () => options },
         {
           provide: MULTER_MODULE_ID,
           useValue: randomStringGenerator(),
@@ -48,8 +51,8 @@ export class MulterModule {
     return [
       this.createAsyncOptionsProvider(options),
       {
-        provide: options.useClass,
-        useClass: options.useClass,
+        provide: options.useClass!,
+        useClass: options.useClass!,
       },
     ];
   }
@@ -68,7 +71,7 @@ export class MulterModule {
       provide: MULTER_MODULE_OPTIONS,
       useFactory: async (optionsFactory: MulterOptionsFactory) =>
         optionsFactory.createMulterOptions(),
-      inject: [options.useExisting || options.useClass],
+      inject: [options.useExisting || options.useClass!],
     };
   }
 }
diff --git a/packages/platform-express/multer/multer/multer.constants.ts b/packages/platform-express/multer/multer/multer.constants.ts
index e3c7b4557..5a6f6aaa4 100644
--- a/packages/platform-express/multer/multer/multer.constants.ts
+++ b/packages/platform-express/multer/multer/multer.constants.ts
@@ -1,4 +1,5 @@
 export const multerExceptions = {
+  // from https://github.com/expressjs/multer/blob/master/lib/multer-error.js
   LIMIT_PART_COUNT: 'Too many parts',
   LIMIT_FILE_SIZE: 'File too large',
   LIMIT_FILE_COUNT: 'Too many files',
@@ -6,4 +7,13 @@ export const multerExceptions = {
   LIMIT_FIELD_VALUE: 'Field value too long',
   LIMIT_FIELD_COUNT: 'Too many fields',
   LIMIT_UNEXPECTED_FILE: 'Unexpected field',
+  MISSING_FIELD_NAME: 'Field name missing',
+};
+
+export const busboyExceptions = {
+  // from https://github.com/mscdex/busboy/blob/master/lib/types/multipart.js
+  MULTIPART_BOUNDARY_NOT_FOUND: 'Multipart: Boundary not found',
+  MULTIPART_MALFORMED_PART_HEADER: 'Malformed part header',
+  MULTIPART_UNEXPECTED_END_OF_FORM: 'Unexpected end of form',
+  MULTIPART_UNEXPECTED_END_OF_FILE: 'Unexpected end of file',
 };
diff --git a/packages/platform-express/multer/multer/multer.utils.ts b/packages/platform-express/multer/multer/multer.utils.ts
index 81e19739c..62c1a7f10 100644
--- a/packages/platform-express/multer/multer/multer.utils.ts
+++ b/packages/platform-express/multer/multer/multer.utils.ts
@@ -3,9 +3,13 @@ import {
   HttpException,
   PayloadTooLargeException,
 } from '@nestjs/common';
-import { multerExceptions } from './multer.constants';
+import { multerExceptions, busboyExceptions } from './multer.constants';
 
-export function transformException(error: Error | undefined) {
+// Multer may add in a 'field' property to the error
+// https://github.com/expressjs/multer/blob/aa42bea6ac7d0cb8fcb279b15a7278cda805dc63/lib/multer-error.js#L19
+export function transformException(
+  error: (Error & { field?: string }) | undefined,
+) {
   if (!error || error instanceof HttpException) {
     return error;
   }
@@ -18,7 +22,17 @@ export function transformException(error: Error | undefined) {
     case multerExceptions.LIMIT_FIELD_COUNT:
     case multerExceptions.LIMIT_UNEXPECTED_FILE:
     case multerExceptions.LIMIT_PART_COUNT:
+    case multerExceptions.MISSING_FIELD_NAME:
+      if (error.field) {
+        return new BadRequestException(`${error.message} - ${error.field}`);
+      }
       return new BadRequestException(error.message);
+    case busboyExceptions.MULTIPART_BOUNDARY_NOT_FOUND:
+      return new BadRequestException(error.message);
+    case busboyExceptions.MULTIPART_MALFORMED_PART_HEADER:
+    case busboyExceptions.MULTIPART_UNEXPECTED_END_OF_FORM:
+    case busboyExceptions.MULTIPART_UNEXPECTED_END_OF_FILE:
+      return new BadRequestException(`Multipart: ${error.message}`);
   }
   return error;
 }
diff --git a/packages/platform-express/package.json b/packages/platform-express/package.json
index ce3390423..46b560513 100644
--- a/packages/platform-express/package.json
+++ b/packages/platform-express/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/platform-express",
-  "version": "8.2.5",
+  "version": "10.4.11",
   "description": "Nest - modern, fast, powerful node.js web framework (@platform-express)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -11,24 +11,25 @@
   },
   "repository": {
     "type": "git",
-    "url": "https://github.com/nestjs/nest"
+    "url": "https://github.com/nestjs/nest.git",
+    "directory": "packages/platform-express"
   },
   "publishConfig": {
     "access": "public"
   },
   "dependencies": {
-    "body-parser": "1.19.1",
+    "body-parser": "1.20.3",
     "cors": "2.8.5",
-    "express": "4.17.1",
-    "multer": "1.4.4",
-    "tslib": "2.3.1"
+    "express": "4.21.1",
+    "multer": "1.4.4-lts.1",
+    "tslib": "2.7.0"
   },
   "devDependencies": {
-    "@nestjs/common": "8.2.5",
-    "@nestjs/core": "8.2.5"
+    "@nestjs/common": "10.4.11",
+    "@nestjs/core": "10.4.11"
   },
   "peerDependencies": {
-    "@nestjs/common": "^8.0.0",
-    "@nestjs/core": "^8.0.0"
+    "@nestjs/common": "^10.0.0",
+    "@nestjs/core": "^10.0.0"
   }
 }
diff --git a/packages/platform-express/test/multer/interceptors/no-files.inteceptor.spec.ts b/packages/platform-express/test/multer/interceptors/no-files.inteceptor.spec.ts
new file mode 100644
index 000000000..5b5289941
--- /dev/null
+++ b/packages/platform-express/test/multer/interceptors/no-files.inteceptor.spec.ts
@@ -0,0 +1,44 @@
+import { CallHandler } from '@nestjs/common';
+import { ExecutionContextHost } from '@nestjs/core/helpers/execution-context-host';
+import { expect } from 'chai';
+import { of } from 'rxjs';
+import * as sinon from 'sinon';
+import { NoFilesInterceptor } from '../../../multer/interceptors/no-files.interceptor';
+
+describe('NoFilesInterceptor', () => {
+  it('should return metatype with expected structure', async () => {
+    const targetClass = NoFilesInterceptor();
+    expect(targetClass.prototype.intercept).to.not.be.undefined;
+  });
+  describe('intercept', () => {
+    let handler: CallHandler;
+    beforeEach(() => {
+      handler = {
+        handle: () => of('test'),
+      };
+    });
+    it('should call none() with expected params', async () => {
+      const target = new (NoFilesInterceptor())();
+
+      const callback = (req, res, next) => next();
+      const noneSpy = sinon
+        .stub((target as any).multer, 'none')
+        .returns(callback);
+
+      await target.intercept(new ExecutionContextHost([]), handler);
+
+      expect(noneSpy.called).to.be.true;
+    });
+    it('should transform exception', async () => {
+      const target = new (NoFilesInterceptor())();
+      const err = {};
+      const callback = (req, res, next) => next(err);
+      (target as any).multer = {
+        none: () => callback,
+      };
+      (target.intercept(new ExecutionContextHost([]), handler) as any).catch(
+        error => expect(error).to.not.be.undefined,
+      );
+    });
+  });
+});
diff --git a/packages/platform-express/test/multer/multer/multer.module.spec.ts b/packages/platform-express/test/multer/multer/multer.module.spec.ts
index e8c92f44a..63aaf2330 100644
--- a/packages/platform-express/test/multer/multer/multer.module.spec.ts
+++ b/packages/platform-express/test/multer/multer/multer.module.spec.ts
@@ -1,3 +1,4 @@
+import { FactoryProvider } from '@nestjs/common';
 import { expect } from 'chai';
 import * as sinon from 'sinon';
 import { MULTER_MODULE_OPTIONS } from '../../../multer/files.constants';
@@ -14,10 +15,12 @@ describe('MulterModule', () => {
       expect(dynamicModule.providers).to.have.length(2);
       expect(dynamicModule.imports).to.be.undefined;
       expect(dynamicModule.exports).to.include(MULTER_MODULE_OPTIONS);
-      expect(dynamicModule.providers).to.deep.include({
-        provide: MULTER_MODULE_OPTIONS,
-        useValue: options,
-      });
+
+      const moduleOptionsProvider = dynamicModule.providers!.find(
+        p => 'useFactory' in p && p.provide === MULTER_MODULE_OPTIONS,
+      ) as FactoryProvider;
+      expect(moduleOptionsProvider).to.not.be.undefined;
+      expect(moduleOptionsProvider.useFactory()).to.be.eq(options);
     });
   });
 
@@ -73,9 +76,7 @@ describe('MulterModule', () => {
         const optionsFactory = {
           createMulterOptions: sinon.spy(),
         };
-        await ((dynamicModule.providers[0] as any).useFactory as any)(
-          optionsFactory,
-        );
+        await (dynamicModule.providers![0] as any).useFactory(optionsFactory);
         expect(optionsFactory.createMulterOptions.called).to.be.true;
       });
     });
diff --git a/packages/platform-express/test/multer/multer/multer.utils.spec.ts b/packages/platform-express/test/multer/multer/multer.utils.spec.ts
index 7ad1eec90..be409795a 100644
--- a/packages/platform-express/test/multer/multer/multer.utils.spec.ts
+++ b/packages/platform-express/test/multer/multer/multer.utils.spec.ts
@@ -4,18 +4,21 @@ import {
   PayloadTooLargeException,
 } from '@nestjs/common';
 import { expect } from 'chai';
-import { multerExceptions } from '../../../multer/multer/multer.constants';
+import {
+  busboyExceptions,
+  multerExceptions,
+} from '../../../multer/multer/multer.constants';
 import { transformException } from '../../../multer/multer/multer.utils';
 
 describe('transformException', () => {
   describe('if error does not exist', () => {
-    it('behave as identity', () => {
+    it('should behave as identity', () => {
       const err = undefined;
       expect(transformException(err)).to.be.eq(err);
     });
   });
   describe('if error is instance of HttpException', () => {
-    it('behave as identity', () => {
+    it('should behave as identity', () => {
       const err = new HttpException('response', 500);
       expect(transformException(err)).to.be.eq(err);
     });
@@ -37,5 +40,33 @@ describe('transformException', () => {
         );
       });
     });
+    describe('and is busboy/multipart exception', () => {
+      it('should return "BadRequestException"', () => {
+        const err = { message: busboyExceptions.MULTIPART_BOUNDARY_NOT_FOUND };
+        expect(transformException(err as any)).to.be.instanceof(
+          BadRequestException,
+        );
+      });
+
+      it('should return "BadRequestException"', () => {
+        const err = {
+          message: busboyExceptions.MULTIPART_UNEXPECTED_END_OF_FORM,
+        };
+        expect(transformException(err as any)).to.be.instanceof(
+          BadRequestException,
+        );
+      });
+    });
+    describe(`and has a 'field' property`, () => {
+      it('should return the field propery appended to the error message', () => {
+        const err = {
+          message: multerExceptions.LIMIT_UNEXPECTED_FILE,
+          field: 'foo',
+        };
+        expect(transformException(err as any)!.message).to.equal(
+          `${multerExceptions.LIMIT_UNEXPECTED_FILE} - foo`,
+        );
+      });
+    });
   });
 });
diff --git a/packages/platform-express/test/tsconfig.json b/packages/platform-express/test/tsconfig.json
new file mode 100644
index 000000000..50d59661d
--- /dev/null
+++ b/packages/platform-express/test/tsconfig.json
@@ -0,0 +1,3 @@
+{
+  "extends": "../../../tsconfig.spec.json"
+}
diff --git a/packages/platform-express/tsconfig.build.json b/packages/platform-express/tsconfig.build.json
new file mode 100644
index 000000000..732ca00cb
--- /dev/null
+++ b/packages/platform-express/tsconfig.build.json
@@ -0,0 +1,22 @@
+{
+  "extends": "../tsconfig.build.json",
+  "compilerOptions": {
+    "outDir": ".",
+    "rootDir": ".",
+    "paths": {
+      "@nestjs/common": ["../common"],
+      "@nestjs/common/*": ["../common/*"],
+      "@nestjs/core": ["../core"],
+      "@nestjs/core/*": ["../core/*"]
+    }
+  },
+  "exclude": ["node_modules", "dist", "test/**/*", "*.spec.ts"],
+  "references": [
+    {
+      "path": "../common/tsconfig.build.json"
+    },
+    {
+      "path": "../core/tsconfig.build.json"
+    }
+  ]
+}
diff --git a/packages/platform-express/tsconfig.json b/packages/platform-express/tsconfig.json
index b238080a4..2ae9e3c90 100644
--- a/packages/platform-express/tsconfig.json
+++ b/packages/platform-express/tsconfig.json
@@ -1,7 +1,13 @@
 {
-  "extends": "./../tsconfig.base.json",
+  "extends": "../tsconfig.build.json",
   "compilerOptions": {
-    "baseUrl": "./"
+    "types": ["node"]
   },
-  "include": ["*.ts", "**/*.ts"]
+  "files": [],
+  "include": [],
+  "references": [
+    {
+      "path": "./tsconfig.build.json"
+    }
+  ]
 }
diff --git a/packages/platform-fastify/CHANGELOG.md b/packages/platform-fastify/CHANGELOG.md
deleted file mode 100644
index 8c9c6cd94..000000000
--- a/packages/platform-fastify/CHANGELOG.md
+++ /dev/null
@@ -1,18 +0,0 @@
-# Change Log
-
-All notable changes to this project will be documented in this file.
-See [Conventional Commits](https://conventionalcommits.org) for commit guidelines.
-
-<a name="8.2.0"></a>
-# [8.2.0](https://github.com/nestjs/nest/compare/v8.1.2...v8.2.0) (2021-11-08)
-
-
-### Bug Fixes
-
-* **deps:** update dependency fastify to v3.23.1 ([63113d8](https://github.com/nestjs/nest/commit/63113d8))
-* **platform-fastify:** fix streamable file processing ([365c40b](https://github.com/nestjs/nest/commit/365c40b))
-
-
-### Features
-
-* **common:** add the ability to set some extra metadata about returned files ([5100573](https://github.com/nestjs/nest/commit/5100573))
diff --git a/packages/platform-fastify/Readme.md b/packages/platform-fastify/Readme.md
index 85a8c2535..4cac0d5ea 100644
--- a/packages/platform-fastify/Readme.md
+++ b/packages/platform-fastify/Readme.md
@@ -1,17 +1,16 @@
 <p align="center">
-  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
+  <a href="https://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
 </p>
 
 [circleci-image]: https://img.shields.io/circleci/build/github/nestjs/nest/master?token=abc123def456
 [circleci-url]: https://circleci.com/gh/nestjs/nest
 
-  <p align="center">A progressive <a href="http://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>
+  <p align="center">A progressive <a href="https://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>
     <p align="center">
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/v/@nestjs/core.svg" alt="NPM Version" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
 <a href="https://circleci.com/gh/nestjs/nest" target="_blank"><img src="https://img.shields.io/circleci/build/github/nestjs/nest/master" alt="CircleCI" /></a>
-<a href="https://coveralls.io/github/nestjs/nest?branch=master" target="_blank"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#9" alt="Coverage" /></a>
 <a href="https://discord.gg/G7Qnnhy" target="_blank"><img src="https://img.shields.io/badge/discord-online-brightgreen.svg" alt="Discord"/></a>
 <a href="https://opencollective.com/nest#backer" target="_blank"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
 <a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
@@ -24,21 +23,21 @@
 
 ## Description
 
-Nest is a framework for building efficient, scalable <a href="http://nodejs.org" target="_blank">Node.js</a> server-side applications. It uses modern JavaScript, is built with  <a href="http://www.typescriptlang.org" target="_blank">TypeScript</a> (preserves compatibility with pure JavaScript) and combines elements of OOP (Object Oriented Programming), FP (Functional Programming), and FRP (Functional Reactive Programming).
+Nest is a framework for building efficient, scalable <a href="https://nodejs.org" target="_blank">Node.js</a> server-side applications. It uses modern JavaScript, is built with <a href="https://www.typescriptlang.org" target="_blank">TypeScript</a> (preserves compatibility with pure JavaScript) and combines elements of OOP (Object Oriented Programming), FP (Functional Programming), and FRP (Functional Reactive Programming).
 
-<p>Under the hood, Nest makes use of <a href="https://expressjs.com/" target="_blank">Express</a>, but also, provides compatibility with a wide range of other libraries, like e.g. <a href="https://github.com/fastify/fastify" target="_blank">Fastify</a>, allowing for easy use of the myriad third-party plugins which are available.</p>
+<p>Under the hood, Nest makes use of <a href="https://expressjs.com/" target="_blank">Express</a>, but also provides compatibility with a wide range of other libraries, like <a href="https://github.com/fastify/fastify" target="_blank">Fastify</a>, allowing for easy use of the myriad of third-party plugins which are available.</p>
 
 ## Philosophy
 
-<p>In recent years, thanks to Node.js, JavaScript has become the ‚Äúlingua franca‚Äù of the web for both front and backend applications, giving rise to awesome projects like <a href="https://angular.io/" target="_blank">Angular</a>, <a href="https://github.com/facebook/react" target="_blank">React</a> and <a href="https://github.com/vuejs/vue" target="_blank">Vue</a> which improve developer productivity and enable the construction of fast, testable, extensible frontend applications. However, on the server-side, while there are a lot of superb libraries, helpers and tools for Node, none of them effectively solve the main problem - the architecture.</p>
-<p>Nest aims to provide an application architecture out of the box which allows for effortless creation of highly testable, scalable, loosely coupled and easily maintainable applications. The architecture is heavily inspired by Angular.</p>
+<p>In recent years, thanks to Node.js, JavaScript has become the ‚Äúlingua franca‚Äù of the web for both front and backend applications, giving rise to awesome projects like <a href="https://angular.io/" target="_blank">Angular</a>, <a href="https://github.com/facebook/react" target="_blank">React</a>, and <a href="https://github.com/vuejs/vue" target="_blank">Vue</a>, which improve developer productivity and enable the construction of fast, testable, and extensible frontend applications. However, on the server-side, while there are a lot of superb libraries, helpers, and tools for Node, none of them effectively solve the main problem - the architecture.</p>
+<p>Nest aims to provide an application architecture out of the box which allows for effortless creation of highly testable, scalable, and loosely coupled and easily maintainable applications. The architecture is heavily inspired by Angular.</p>
 
 ## Getting started
 
-* To check out the [guide](https://docs.nestjs.com), visit [docs.nestjs.com](https://docs.nestjs.com). :books:
-* Ë¶ÅÊü•Áúã‰∏≠Êñá [ÊåáÂçó](readme_zh.md), ËØ∑ËÆøÈóÆ [docs.nestjs.cn](https://docs.nestjs.cn). :books:
-* [Í∞ÄÏù¥Îìú](readme_kr.md)Î•º ÌôïÏù∏ÌïòÎ†§Î©¥, [docs.nestjs.com](https://docs.nestjs.com)Î•º Î∞©Î¨∏ÌïòÏÑ∏Ïöî.:books: 
-* „ÉÅ„Çß„ÉÉ„ÇØ„Åô„Çã„Å´„ÅØ [„Ç¨„Ç§„Éâ](readme_jp.md), Ë©≥„Åó„Åè„ÅØ [docs.nestjs.com](https://docs.nestjs.com). :books: 
+- To check out the [guide](https://docs.nestjs.com), visit [docs.nestjs.com](https://docs.nestjs.com). :books:
+- Ë¶ÅÊü•Áúã‰∏≠Êñá [ÊåáÂçó](readme_zh.md), ËØ∑ËÆøÈóÆ [docs.nestjs.cn](https://docs.nestjs.cn). :books:
+- [Í∞ÄÏù¥Îìú](readme_kr.md) Î¨∏ÏÑúÎäî [docs.nestjs.com](https://docs.nestjs.com)ÏóêÏÑú ÌôïÏù∏ÌïòÏã§ Ïàò ÏûàÏäµÎãàÎã§. :books:
+- [„Ç¨„Ç§„Éâ](readme_jp.md)„ÅØ [docs.nestjs.com](https://docs.nestjs.com)„Åß„ÅîÁ¢∫Ë™ç„Åè„Å†„Åï„ÅÑ„ÄÇ :books:
 
 ## Questions
 
@@ -54,71 +53,88 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
-<table style="text-align:center;"><tr>
-  <td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
-  <td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/red-hat-logo.svg" width="200" valign="middle" /></a></td>
-<td>
-<a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
-<td>
-<a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
-</tr></table>
+
+<table style="text-align:center;">
+<tr>
+<td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
+<td><a href="https://microsoft.com/" target="_blank"><img src="https://nestjs.com/img/logos/microsoft-logo.png" width="180" valign="middle" /></a></td>
+<td><a href="https://mojam.co" target="_blank"><img src="https://nestjs.com/img/logos/mojam-logo.png" width="80" valign="middle" /></a></td>
+<td><a href="https://marblism.com?utm_source=nest" target="_blank"><img src="https://nestjs.com/img/logos/marblism-logo.png" width="180" valign="middle" /></a></td>
+<td><a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
+<td><a href="https://amplication.com/" target="_blank"><img src="https://nestjs.com/img/logos/amplication-logo.svg" width="190" valign="middle" /></a></td>
+</tr>
+</table>
 
 #### Gold Sponsors
 
-<table style="text-align:center;"><tr><td>
-  <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
-  <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
-<td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
+<table style="text-align:center;">
+<tr>
+<td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/logos/red-hat-logo.svg" width="200" valign="middle" /></a></td>
+<td><a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
+<td><a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/logos/nx-logo.png" height="45" valign="middle" /></a></td>
+<td><a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/logos/intrinisic-logo.png" width="210" valign="middle" /></a></td>
+<td><a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/logos/jetbrains-logo.svg" width="90" valign="middle" /></a></td>
+</tr>
+<tr>
+<td><a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/logos/snyk-logo-black.png" width="185" valign="middle" /></a></td>
+<td><a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/logos/fuse-logo.svg" width="105" valign="middle" /></a></td>
+<td><a href="https://ridicorp.com/career/" target="_blank"><img src="https://nestjs.com/img/logos/ridi-logo.svg" width="105" valign="middle" /></a></td>
+<td><a href="https://www.movavi.com/imovie-for-windows.html" target="_blank"><img src="https://nestjs.com/img/logos/movavi-logo.svg" width="105" valign="middle" /></a></td>
+<td><a href="https://skunk.team" target="_blank"><img src="https://nestjs.com/img/logos/skunk-logo.png" height="60" valign="middle" /></a></td>
+</tr>
+</table>
 
 #### Silver Sponsors
 
-<table style="text-align:center;"><tr><td>
-<a href="https://neoteric.eu/" target="_blank"><img src="https://nestjs.com/img/neoteric-cut.png" width="120" valign="middle" /></a> </td><td>
-  <a href="http://gojob.com" target="_blank"><img src="http://nestjs.com/img/gojob-logo.png" valign="middle" width="100" /></a> </td><td>
-<a href="https://www.myleodsc.com/" target="_blank"><img src="https://nestjs.com/img/myleo-logo.png" width="180" valign="middle" /></td><td>
-<a href="https://careers.meetdandy.com/?gh_src=063ba61e3us" target="_blank"><img src="https://nestjs.com/img/dandy-roles-logo.svg" width="150" valign="middle" /></td><td>
-<a href="https://www.castlecraft.in" target="_blank"><img src="https://nestjs.com/img/castlecraft-logo.png" width="150" valign="middle" /></td>
-<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td></tr></table>
+<table style="text-align:center;">
+<tr>
+<td><a href="https://www.mercedes-benz.com/" target="_blank"><img src="https://nestjs.com/img/logos/mercedes-logo.png" width="100" valign="middle" /></a></td>
+<td><a href="https://www.dinii.jp/" target="_blank"><img src="https://nestjs.com/img/logos/dinii-logo.png" width="65" valign="middle" /></a></td>
+<td><a href="https://bloodycase.com/?promocode=NEST" target="_blank"><img src="https://nestjs.com/img/logos/bloodycase-logo.png" width="65" valign="middle" /></a></td>
+<td><a href="https://handsontable.com/docs/react-data-grid/?utm_source=NestJS_GH&utm_medium=sponsorship&utm_campaign=library_sponsorship_2024" target="_blank"><img src="https://nestjs.com/img/logos/handsontable-dark-logo.svg#2" width="150" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.itflashcards.com/" target="_blank"><img src="https://nestjs.com/img/logos/it_flashcards-logo.png" width="170" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://arcjet.com/?ref=nestjs" target="_blank"><img src="https://nestjs.com/img/logos/arcjet-logo.svg" width="170" valign="middle" /></a></td>
+</tr>
+</table>
 
 #### Sponsors
 
-<table><tr><td align="center" valign="middle">
-<a href="https://www.swingdev.io" target="_blank"><img src="https://nestjs.com/img/swingdev-logo.svg#1" width="110" valign="middle" /> </a></td><td align="center" valign="middle">
-<a href="https://www.novologic.com/" target="_blank"><img src="https://nestjs.com/img/novologic.png" width="110" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://ever.co/" target="_blank"><img src="https://nestjs.com/img/ever-logo.png" width="72" valign="middle" /></a>  </td><td align="center" valign="middle">
-<a href="https://blokt.com" target="_blank"><img src="https://nestjs.com/img/blokt-logo.png" width="120" valign="middle" /></a>  </td><td align="center" valign="middle"> 
-  <a href="http://architectnow.net/" target="_blank"><img src="https://nestjs.com/img/architectnow.png" width="125" valign="middle" /></a> </td><td align="center" valign="middle">
-  <a href="https://quander.io/" target="_blank"><img src="https://nestjs.com/img/quander.png" width="100" valign="middle" /></a> </td></tr><tr><td align="center" valign="middle">
-  <a href="https://mantro.net/" target="_blank"><img src="https://nestjs.com/img/mantro-logo.svg" width="95" valign="middle" /></a> </td><td align="center" valign="middle">
-  <a href="https://triplebyte.com/" target="_blank"><img src="https://nestjs.com/img/triplebyte.png" width="107" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://reposit.co.uk/" target="_blank"><img src="https://nestjs.com/img/reposit-logo.png" width="71" valign="middle" /></a></td><td align="center" valign="middle">
-<a href="https://nearpod.com/" target="_blank"><img src="https://nestjs.com/img/nearpod-logo.svg" width="100" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://clay.global/" target="_blank"><img src="https://nestjs.com/img/clay-logo.svg" width="75" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://firesticktricks.com" target="_blank"><img src="https://nestjs.com/img/firesticktricks-logo.png" width="120" valign="middle" /></a></td></tr><tr><td align="center" valign="middle">
-<a href="https://www.codeguesser.co.uk" target="_blank"><img src="https://nestjs.com/img/codeguesser-logo.svg" width="120" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://f-a.nz/" target="_blank"><img src="https://nestjs.com/img/franz.svg" width="80" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://sparkfabrik.com/" target="_blank"><img src="https://nestjs.com/img/sparkfabrik-logo.png" width="120" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://www.thebigphonestore.co.uk/" target="_blank"><img src="https://nestjs.com/img/the-big-phone-store-logo.png" width="65" valign="middle" /></a></td>
-  <td align="center" valign="middle">
-  <a href="https://genuinebee.com/" target="_blank"><img src="https://nestjs.com/img/genuinebee.svg" width="97" valign="middle" /></a> </td>
-<td align="center" valign="middle"><a href="https://sanyodigital.com/" target="_blank"><img src="https://nestjs.com/img/sanyo-digital.png" width="130" valign="middle" /></a></td></tr><tr><td align="center" valign="middle"><a href="https://vpn-review.com/vpn-for-torrenting" target="_blank"><img src="https://nestjs.com/img/vpn-review-logo.png" width="85" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://lambda-it.ch/" target="_blank"><img src="https://nestjs.com/img/lambda-it-logo.svg" width="115" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://pickwriters.com/top-10-translation-services" target="_blank"><img src="https://nestjs.com/img/pickwriters-logo.png" width="40" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://thewordpoint.com/services/localization" target="_blank"><img src="https://nestjs.com/img/thewordpoint-logo.png" width="40" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://meercode.io/" target="_blank"><img src="https://nestjs.com/img/meercode-logo.png" width="60" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://www.najlepszeplatformyforex.pl/blog/broker-xtb/" target="_blank"><img src="https://nestjs.com/img/npf-logo.jpg" width="200" valign="middle" /></a></td></tr><tr>
-<td align="center" valign="middle"><a href="https://thestandarddaily.com/" target="_blank"><img src="https://nestjs.com/img/the-standard-daily-logo.png" width="180" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://houseofangular.io/" target="_blank"><img src="https://nestjs.com/img/house-of-angular.png" width="100" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://rocketech.it/cases/?utm_source=google&utm_medium=badge&utm_campaign=nestjs" target="_blank"><img src="https://nestjs.com/img/rocketech-logo.svg" width="110" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://www.bystored.com/" target="_blank"><img src="https://nestjs.com/img/stored-logo.svg" width="110" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://studyclerk.com/pay-for-research-paper" target="_blank"><img src="https://nestjs.com/img/studyclerk-logo.png" width="125" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://xyndata.com" target="_blank"><img src="https://nestjs.com/img/xyndata-logo.png" width="125" valign="middle" /></a></td></tr><tr>
-  <td align="center" valign="middle"><a href="https://www.anonymistic.com/" target="_blank"><img src="https://nestjs.com/img/anonymistic-logo.png" width="125" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/naologic-logo.svg" width="125" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://messaged.com/" target="_blank"><img src="https://nestjs.com/img/messaged-logo.png" width="50" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/triplecore-logo.svg" width="50" valign="middle" /></a></td>
-  </tr></table>
+<table>
+<tr>
+<td align="center" valign="middle"><a href="https://www.swingdev.io" target="_blank"><img src="https://nestjs.com/img/logos/swingdev-logo.svg#1" width="110" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.novologic.com/" target="_blank"><img src="https://nestjs.com/img/logos/novologic.png" width="110" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://mantro.net/" target="_blank"><img src="https://nestjs.com/img/logos/mantro-logo.svg" width="95" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://triplebyte.com/" target="_blank"><img src="https://nestjs.com/img/logos/triplebyte.png" width="107" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://nearpod.com/" target="_blank"><img src="https://nestjs.com/img/logos/nearpod-logo.svg" width="100" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://genuinebee.com/" target="_blank"><img src="https://nestjs.com/img/logos/genuinebee.svg" width="97" valign="middle" /></a></td>
+</tr>
+<tr>
+<td align="center" valign="middle"><a href="https://vpn-review.com/vpn-for-torrenting" target="_blank"><img src="https://nestjs.com/img/logos/vpn-review-logo.png" width="85" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://lambda-it.ch/" target="_blank"><img src="https://nestjs.com/img/logos/lambda-it-logo.svg" width="115" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://rocketech.it/cases/?utm_source=google&utm_medium=badge&utm_campaign=nestjs" target="_blank"><img src="https://nestjs.com/img/logos/rocketech-logo.svg" width="110" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.anonymistic.com/" target="_blank"><img src="https://nestjs.com/img/logos/anonymistic-logo.png" width="125" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/logos/naologic-logo.svg" width="125" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/logos/triplecore-logo.svg" width="50" valign="middle" /></a></td>
+</tr>
+<tr>
+<td align="center" valign="middle"><a href="https://thecasinowizard.com/bonuses/no-deposit-bonuses/" target="_blank"><img src="https://nestjs.com/img/logos/casinowizard-logo.png" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://polygon-software.ch/" target="_blank"><img src="https://nestjs.com/img/logos/polygon-logo.svg" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/logos/boringowl-logo.svg" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://nordbot.app/" target="_blank"><img src="https://nestjs.com/img/logos/nordbot-logo.png" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://doppio.sh/" target="_blank"><img src="https://nestjs.com/img/logos/dopiosh-logo.png" width="50" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.hingehealth.com/" target="_blank"><img src="https://nestjs.com/img/logos/hinge-health-logo.svg" width="100" valign="middle" /></a></td>
+</tr>
+<tr>
+<td align="center" valign="middle"><a href="https://julienferand.dev/" target="_blank"><img src="https://nestjs.com/img/logos/julienferand-logo.jpeg" width="55" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.tripoffice.com/" target="_blank"><img src="https://nestjs.com/img/logos/tripoffice-logo.png" width="140" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://solcellsforetag.se/" target="_blank"><img src="https://nestjs.com/img/logos/solcellsforetag-logo.svg" width="140" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.route4me.com/" target="_blank"><img src="https://nestjs.com/img/logos/route4me-logo.svg" width="100" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.slotsup.com/" target="_blank"><img src="https://nestjs.com/img/logos/slotsup-logo.png" width="60" valign="middle" /></a></td>
+</tr>
+</table>
 
 ## Backers
 
@@ -126,9 +142,9 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 
 ## Stay in touch
 
-* Author - [Kamil My≈õliwiec](https://twitter.com/kammysliwiec)
-* Website - [https://nestjs.com](https://nestjs.com/)
-* Twitter - [@nestframework](https://twitter.com/nestframework)
+- Author - [Kamil My≈õliwiec](https://x.com/kammysliwiec)
+- Website - [https://nestjs.com](https://nestjs.com/)
+- X - [@nestframework](https://x.com/nestframework)
 
 ## License
 
diff --git a/packages/platform-fastify/adapters/fastify-adapter.ts b/packages/platform-fastify/adapters/fastify-adapter.ts
index 6c15826ea..c83239736 100644
--- a/packages/platform-fastify/adapters/fastify-adapter.ts
+++ b/packages/platform-fastify/adapters/fastify-adapter.ts
@@ -1,72 +1,108 @@
+/* eslint-disable @typescript-eslint/no-floating-promises */
 import {
   HttpStatus,
   Logger,
+  RawBodyRequest,
   RequestMethod,
   StreamableFile,
+  VERSION_NEUTRAL,
   VersioningOptions,
   VersioningType,
 } from '@nestjs/common';
-import { VersionValue, VERSION_NEUTRAL } from '@nestjs/common/interfaces';
+import { VersionValue } from '@nestjs/common/interfaces';
 import {
   CorsOptions,
   CorsOptionsDelegate,
 } from '@nestjs/common/interfaces/external/cors-options.interface';
 import { loadPackage } from '@nestjs/common/utils/load-package.util';
-import { isUndefined, isString } from '@nestjs/common/utils/shared.utils';
+import { isString, isUndefined } from '@nestjs/common/utils/shared.utils';
 import { AbstractHttpAdapter } from '@nestjs/core/adapters/http-adapter';
 import {
-  fastify,
+  FastifyBaseLogger,
+  FastifyBodyParser,
   FastifyInstance,
-  FastifyLoggerInstance,
+  FastifyListenOptions,
   FastifyPluginAsync,
   FastifyPluginCallback,
+  FastifyRegister,
   FastifyReply,
   FastifyRequest,
   FastifyServerOptions,
+  HTTPMethods,
   RawReplyDefaultExpression,
   RawRequestDefaultExpression,
   RawServerBase,
   RawServerDefault,
   RequestGenericInterface,
+  RouteOptions,
+  RouteShorthandOptions,
+  fastify,
 } from 'fastify';
 import * as Reply from 'fastify/lib/reply';
-import { RouteShorthandMethod } from 'fastify/types/route';
+import { kRouteContext } from 'fastify/lib/symbols';
+import * as http from 'http';
 import * as http2 from 'http2';
 import * as https from 'https';
 import {
-  Chain as LightMyRequestChain,
   InjectOptions,
+  Chain as LightMyRequestChain,
   Response as LightMyRequestResponse,
 } from 'light-my-request';
+import * as pathToRegexp from 'path-to-regexp';
+// `querystring` is used internally in fastify for registering urlencoded body parser.
+import { parse as querystringParse } from 'querystring';
+import {
+  FASTIFY_ROUTE_CONFIG_METADATA,
+  FASTIFY_ROUTE_CONSTRAINTS_METADATA,
+} from '../constants';
+import { NestFastifyBodyParserOptions } from '../interfaces';
 import {
   FastifyStaticOptions,
-  PointOfViewOptions,
+  FastifyViewOptions,
 } from '../interfaces/external';
 
+type FastifyAdapterBaseOptions<
+  Server extends RawServerBase = RawServerDefault,
+  Logger extends FastifyBaseLogger = FastifyBaseLogger,
+> = FastifyServerOptions<Server, Logger> & {
+  skipMiddie?: boolean;
+};
+
 type FastifyHttp2SecureOptions<
   Server extends http2.Http2SecureServer,
-  Logger extends FastifyLoggerInstance = FastifyLoggerInstance,
-> = FastifyServerOptions<Server, Logger> & {
+  Logger extends FastifyBaseLogger = FastifyBaseLogger,
+> = FastifyAdapterBaseOptions<Server, Logger> & {
   http2: true;
   https: http2.SecureServerOptions;
 };
 
 type FastifyHttp2Options<
   Server extends http2.Http2Server,
-  Logger extends FastifyLoggerInstance = FastifyLoggerInstance,
-> = FastifyServerOptions<Server, Logger> & {
+  Logger extends FastifyBaseLogger = FastifyBaseLogger,
+> = FastifyAdapterBaseOptions<Server, Logger> & {
   http2: true;
   http2SessionTimeout?: number;
 };
 
 type FastifyHttpsOptions<
   Server extends https.Server,
-  Logger extends FastifyLoggerInstance = FastifyLoggerInstance,
-> = FastifyServerOptions<Server, Logger> & {
+  Logger extends FastifyBaseLogger = FastifyBaseLogger,
+> = FastifyAdapterBaseOptions<Server, Logger> & {
   https: https.ServerOptions;
 };
 
-type VersionedRoute = Function & {
+type FastifyHttpOptions<
+  Server extends http.Server,
+  Logger extends FastifyBaseLogger = FastifyBaseLogger,
+> = FastifyAdapterBaseOptions<Server, Logger> & {
+  http: http.ServerOptions;
+};
+
+type VersionedRoute<TRequest, TResponse> = ((
+  req: TRequest,
+  res: TResponse,
+  next: Function,
+) => Function) & {
   version: VersionValue;
   versioningOptions: VersioningOptions;
 };
@@ -80,10 +116,14 @@ type VersionedRoute = Function & {
 type FastifyRawRequest<TServer extends RawServerBase> =
   RawRequestDefaultExpression<TServer> & { originalUrl?: string };
 
+/**
+ * @publicApi
+ */
 export class FastifyAdapter<
   TServer extends RawServerBase = RawServerDefault,
   TRawRequest extends FastifyRawRequest<TServer> = FastifyRawRequest<TServer>,
-  TRawResponse extends RawReplyDefaultExpression<TServer> = RawReplyDefaultExpression<TServer>,
+  TRawResponse extends
+    RawReplyDefaultExpression<TServer> = RawReplyDefaultExpression<TServer>,
   TRequest extends FastifyRequest<
     RequestGenericInterface,
     TServer,
@@ -101,10 +141,11 @@ export class FastifyAdapter<
   > = FastifyInstance<TServer, TRawRequest, TRawResponse>,
 > extends AbstractHttpAdapter<TServer, TRequest, TReply> {
   protected readonly instance: TInstance;
+  protected _pathPrefix?: string;
 
   private _isParserRegistered: boolean;
   private isMiddieRegistered: boolean;
-  private versioningOptions: VersioningOptions;
+  private versioningOptions?: VersioningOptions;
   private readonly versionConstraint = {
     name: 'version',
     validate(value: unknown) {
@@ -115,23 +156,27 @@ export class FastifyAdapter<
       }
     },
     storage() {
-      const versions = new Map();
+      const versions = new Map<string, unknown>();
       return {
         get(version: string | Array<string>) {
+          if (Array.isArray(version)) {
+            return versions.get(version.find(v => versions.has(v))!) || null;
+          }
           return versions.get(version) || null;
         },
-        set(
-          versionOrVersions: string | Array<string>,
-          store: Map<string, any>,
-        ) {
-          const storeVersionConstraint = version =>
+        set(versionOrVersions: string | Array<string>, store: unknown) {
+          const storeVersionConstraint = (version: string) =>
             versions.set(version, store);
           if (Array.isArray(versionOrVersions))
             versionOrVersions.forEach(storeVersionConstraint);
           else storeVersionConstraint(versionOrVersions);
         },
         del(version: string | Array<string>) {
-          versions.delete(version);
+          if (Array.isArray(version)) {
+            version.forEach(v => versions.delete(v));
+          } else {
+            versions.delete(version);
+          }
         },
         empty() {
           versions.clear();
@@ -140,7 +185,7 @@ export class FastifyAdapter<
     },
     deriveConstraint: (req: FastifyRequest) => {
       // Media Type (Accept Header) Versioning Handler
-      if (this.versioningOptions.type === VersioningType.MEDIA_TYPE) {
+      if (this.versioningOptions?.type === VersioningType.MEDIA_TYPE) {
         const MEDIA_TYPE_HEADER = 'Accept';
         const acceptHeaderValue: string | undefined = (req.headers?.[
           MEDIA_TYPE_HEADER
@@ -150,22 +195,23 @@ export class FastifyAdapter<
           ? acceptHeaderValue.split(';')[1]
           : '';
 
-        if (acceptHeaderVersionParameter) {
-          const headerVersion = acceptHeaderVersionParameter.split(
-            this.versioningOptions.key,
-          )[1];
-          return headerVersion;
-        }
+        return isUndefined(acceptHeaderVersionParameter)
+          ? VERSION_NEUTRAL // No version was supplied
+          : acceptHeaderVersionParameter.split(this.versioningOptions.key)[1];
       }
       // Header Versioning Handler
-      else if (this.versioningOptions.type === VersioningType.HEADER) {
+      else if (this.versioningOptions?.type === VersioningType.HEADER) {
         const customHeaderVersionParameter: string | string[] | undefined =
           req.headers?.[this.versioningOptions.header] ||
           req.headers?.[this.versioningOptions.header.toLowerCase()];
 
-        if (customHeaderVersionParameter) {
-          return customHeaderVersionParameter;
-        }
+        return isUndefined(customHeaderVersionParameter)
+          ? VERSION_NEUTRAL // No version was supplied
+          : customHeaderVersionParameter;
+      }
+      // Custom Versioning Handler
+      else if (this.versioningOptions?.type === VersioningType.CUSTOM) {
+        return this.versioningOptions.extractor(req);
       }
       return undefined;
     },
@@ -182,7 +228,8 @@ export class FastifyAdapter<
       | FastifyHttp2Options<any>
       | FastifyHttp2SecureOptions<any>
       | FastifyHttpsOptions<any>
-      | FastifyServerOptions<TServer>,
+      | FastifyHttpOptions<any>
+      | FastifyAdapterBaseOptions<TServer>,
   ) {
     super();
 
@@ -195,7 +242,12 @@ export class FastifyAdapter<
             },
             ...(instanceOrOptions as FastifyServerOptions),
           });
+
     this.setInstance(instance);
+
+    if ((instanceOrOptions as FastifyAdapterBaseOptions)?.skipMiddie) {
+      this.isMiddieRegistered = true;
+    }
   }
 
   public async init() {
@@ -211,47 +263,102 @@ export class FastifyAdapter<
     hostname: string,
     callback?: () => void,
   ): void;
-  public listen(port: string | number, ...args: any[]): Promise<string> {
-    return this.instance.listen(port, ...args);
+  public listen(
+    listenOptions: string | number | FastifyListenOptions,
+    ...args: any[]
+  ): void {
+    const isFirstArgTypeofFunction = typeof args[0] === 'function';
+    const callback = isFirstArgTypeofFunction ? args[0] : args[1];
+
+    let options: Record<string, any>;
+    if (
+      typeof listenOptions === 'object' &&
+      (listenOptions.host !== undefined ||
+        listenOptions.port !== undefined ||
+        listenOptions.path !== undefined)
+    ) {
+      // First parameter is an object with a path, port and/or host attributes
+      options = listenOptions;
+    } else {
+      options = {
+        port: +listenOptions,
+      };
+    }
+    if (!isFirstArgTypeofFunction) {
+      options.host = args[0];
+    }
+    return this.instance.listen(options, callback);
   }
 
   public get(...args: any[]) {
-    return this.injectConstraintsIfVersioned('get', ...args);
+    return this.injectRouteOptions('GET', ...args);
   }
 
   public post(...args: any[]) {
-    return this.injectConstraintsIfVersioned('post', ...args);
+    return this.injectRouteOptions('POST', ...args);
   }
 
   public head(...args: any[]) {
-    return this.injectConstraintsIfVersioned('head', ...args);
+    return this.injectRouteOptions('HEAD', ...args);
   }
 
   public delete(...args: any[]) {
-    return this.injectConstraintsIfVersioned('delete', ...args);
+    return this.injectRouteOptions('DELETE', ...args);
   }
 
   public put(...args: any[]) {
-    return this.injectConstraintsIfVersioned('put', ...args);
+    return this.injectRouteOptions('PUT', ...args);
   }
 
   public patch(...args: any[]) {
-    return this.injectConstraintsIfVersioned('patch', ...args);
+    return this.injectRouteOptions('PATCH', ...args);
   }
 
   public options(...args: any[]) {
-    return this.injectConstraintsIfVersioned('options', ...args);
+    return this.injectRouteOptions('OPTIONS', ...args);
+  }
+
+  public search(...args: any[]) {
+    return this.injectRouteOptions('SEARCH', ...args);
+  }
+
+  public propfind(...args: any[]) {
+    return this.injectRouteOptions('PROPFIND', ...args);
+  }
+
+  public proppatch(...args: any[]) {
+    return this.injectRouteOptions('PROPPATCH', ...args);
+  }
+
+  public mkcol(...args: any[]) {
+    return this.injectRouteOptions('MKCOL', ...args);
+  }
+
+  public copy(...args: any[]) {
+    return this.injectRouteOptions('COPY', ...args);
+  }
+
+  public move(...args: any[]) {
+    return this.injectRouteOptions('MOVE', ...args);
+  }
+
+  public lock(...args: any[]) {
+    return this.injectRouteOptions('LOCK', ...args);
+  }
+
+  public unlock(...args: any[]) {
+    return this.injectRouteOptions('UNLOCK', ...args);
   }
 
   public applyVersionFilter(
     handler: Function,
     version: VersionValue,
     versioningOptions: VersioningOptions,
-  ) {
+  ): VersionedRoute<TRequest, TReply> {
     if (!this.versioningOptions) {
       this.versioningOptions = versioningOptions;
     }
-    const versionedRoute = handler as VersionedRoute;
+    const versionedRoute = handler as VersionedRoute<TRequest, TReply>;
     versionedRoute.version = version;
     return versionedRoute;
   }
@@ -265,7 +372,7 @@ export class FastifyAdapter<
       ? new Reply(
           response,
           {
-            context: {
+            [kRouteContext]: {
               preSerialization: null,
               preValidation: [],
               preHandler: [],
@@ -282,14 +389,37 @@ export class FastifyAdapter<
     }
     if (body instanceof StreamableFile) {
       const streamHeaders = body.getHeaders();
-      if (fastifyReply.getHeader('Content-Type') === undefined) {
+      if (
+        fastifyReply.getHeader('Content-Type') === undefined &&
+        streamHeaders.type !== undefined
+      ) {
         fastifyReply.header('Content-Type', streamHeaders.type);
       }
-      if (fastifyReply.getHeader('Content-Disposition') === undefined) {
+      if (
+        fastifyReply.getHeader('Content-Disposition') === undefined &&
+        streamHeaders.disposition !== undefined
+      ) {
         fastifyReply.header('Content-Disposition', streamHeaders.disposition);
       }
+      if (
+        fastifyReply.getHeader('Content-Length') === undefined &&
+        streamHeaders.length !== undefined
+      ) {
+        fastifyReply.header('Content-Length', streamHeaders.length);
+      }
       body = body.getStream();
     }
+    if (
+      fastifyReply.getHeader('Content-Type') !== undefined &&
+      fastifyReply.getHeader('Content-Type') !== 'application/json' &&
+      body?.statusCode >= HttpStatus.BAD_REQUEST
+    ) {
+      Logger.warn(
+        "Content-Type doesn't match Reply body, you might need a custom ExceptionFilter for non-JSON responses",
+        FastifyAdapter.name,
+      );
+      fastifyReply.header('Content-Type', 'application/json');
+    }
     return fastifyReply.send(body);
   }
 
@@ -298,7 +428,11 @@ export class FastifyAdapter<
       response.statusCode = statusCode;
       return response;
     }
-    return (response as TReply).code(statusCode);
+    return (response as { code: Function }).code(statusCode);
+  }
+
+  public end(response: TReply, message?: string) {
+    response.raw.end(message!);
   }
 
   public render(
@@ -330,7 +464,7 @@ export class FastifyAdapter<
     return this.instance as unknown as T;
   }
 
-  public register<TRegister extends Parameters<TInstance['register']>>(
+  public register<TRegister extends Parameters<FastifyRegister<TInstance>>>(
     plugin: TRegister['0'],
     opts?: TRegister['1'],
   ) {
@@ -342,7 +476,7 @@ export class FastifyAdapter<
   public inject(
     opts?: InjectOptions | string,
   ): LightMyRequestChain | Promise<LightMyRequestResponse> {
-    return this.instance.inject(opts);
+    return this.instance.inject(opts!);
   }
 
   public async close() {
@@ -363,14 +497,14 @@ export class FastifyAdapter<
 
   public useStaticAssets(options: FastifyStaticOptions) {
     return this.register(
-      loadPackage('fastify-static', 'FastifyAdapter.useStaticAssets()', () =>
-        require('fastify-static'),
+      loadPackage('@fastify/static', 'FastifyAdapter.useStaticAssets()', () =>
+        require('@fastify/static'),
       ),
       options,
     );
   }
 
-  public setViewEngine(options: PointOfViewOptions | string) {
+  public setViewEngine(options: FastifyViewOptions | string) {
     if (isString(options)) {
       new Logger('FastifyAdapter').error(
         "setViewEngine() doesn't support a string argument.",
@@ -378,23 +512,35 @@ export class FastifyAdapter<
       process.exit(1);
     }
     return this.register(
-      loadPackage('point-of-view', 'FastifyAdapter.setViewEngine()', () =>
-        require('point-of-view'),
+      loadPackage('@fastify/view', 'FastifyAdapter.setViewEngine()', () =>
+        require('@fastify/view'),
       ),
       options,
     );
   }
 
+  public isHeadersSent(response: TReply): boolean {
+    return response.sent;
+  }
+
+  public getHeader?(response: any, name: string) {
+    return response.getHeader(name);
+  }
+
   public setHeader(response: TReply, name: string, value: string) {
     return response.header(name, value);
   }
 
+  public appendHeader?(response: any, name: string, value: string) {
+    response.header(name, value);
+  }
+
   public getRequestHostname(request: TRequest): string {
     return request.hostname;
   }
 
   public getRequestMethod(request: TRequest): string {
-    return request.raw ? request.raw.method : request.method;
+    return request.raw ? request.raw.method! : request.method;
   }
 
   public getRequestUrl(request: TRequest): string;
@@ -404,14 +550,62 @@ export class FastifyAdapter<
   }
 
   public enableCors(options: CorsOptions | CorsOptionsDelegate<TRequest>) {
-    this.register(import('fastify-cors'), options);
+    this.register(
+      import('@fastify/cors') as Parameters<TInstance['register']>[0],
+      options,
+    );
   }
 
-  public registerParserMiddleware() {
+  public registerParserMiddleware(prefix?: string, rawBody?: boolean) {
     if (this._isParserRegistered) {
       return;
     }
-    this.register(import('fastify-formbody'));
+
+    this.registerUrlencodedContentParser(rawBody);
+    this.registerJsonContentParser(rawBody);
+
+    this._isParserRegistered = true;
+    this._pathPrefix = prefix
+      ? !prefix.startsWith('/')
+        ? `/${prefix}`
+        : prefix
+      : undefined;
+  }
+
+  public useBodyParser(
+    type: string | string[] | RegExp,
+    rawBody: boolean,
+    options?: NestFastifyBodyParserOptions,
+    parser?: FastifyBodyParser<Buffer, TServer>,
+  ) {
+    const parserOptions = {
+      ...(options || {}),
+      parseAs: 'buffer' as const,
+    };
+
+    this.getInstance().addContentTypeParser<Buffer>(
+      type,
+      parserOptions,
+      (
+        req: RawBodyRequest<FastifyRequest<any, TServer, TRawRequest>>,
+        body: Buffer,
+        done,
+      ) => {
+        if (rawBody === true && Buffer.isBuffer(body)) {
+          req.rawBody = body;
+        }
+
+        if (parser) {
+          parser(req, body, done);
+          return;
+        }
+
+        done(null, body);
+      },
+    );
+
+    // To avoid the Nest application init to override our custom
+    // body parser, we mark the parsers as registered.
     this._isParserRegistered = true;
   }
 
@@ -422,15 +616,41 @@ export class FastifyAdapter<
       await this.registerMiddie();
     }
     return (path: string, callback: Function) => {
-      const normalizedPath = path.endsWith('/*')
+      const hasEndOfStringCharacter = path.endsWith('$');
+      path = hasEndOfStringCharacter ? path.slice(0, -1) : path;
+
+      let normalizedPath = path.endsWith('/*')
         ? `${path.slice(0, -1)}(.*)`
         : path;
 
-      // The following type assertion is valid as we use import('middie') rather than require('middie')
+      // Fallback to "(.*)" to support plugins like GraphQL
+      normalizedPath = normalizedPath === '/(.*)' ? '(.*)' : normalizedPath;
+
+      // Normalize the path to support the prefix if it set in application
+      normalizedPath =
+        this._pathPrefix && !normalizedPath.startsWith(this._pathPrefix)
+          ? `${this._pathPrefix}${normalizedPath}(.*)`
+          : normalizedPath;
+
+      let re = pathToRegexp(normalizedPath);
+      re = hasEndOfStringCharacter ? new RegExp(re.source + '$', re.flags) : re;
+
+      // The following type assertion is valid as we use import('@fastify/middie') rather than require('@fastify/middie')
       // ref https://github.com/fastify/middie/pull/55
       this.instance.use(
         normalizedPath,
-        callback as Parameters<TInstance['use']>['1'],
+        (req: any, res: any, next: Function) => {
+          const queryParamsIndex = req.originalUrl.indexOf('?');
+          const pathname =
+            queryParamsIndex >= 0
+              ? req.originalUrl.slice(0, queryParamsIndex)
+              : req.originalUrl;
+
+          if (!re.exec(pathname + '/') && normalizedPath) {
+            return next();
+          }
+          return callback(req, res, next);
+        },
       );
     };
   }
@@ -456,47 +676,105 @@ export class FastifyAdapter<
     return !('status' in response);
   }
 
+  private registerJsonContentParser(rawBody?: boolean) {
+    const contentType = 'application/json';
+    const withRawBody = !!rawBody;
+    const { bodyLimit } = this.getInstance().initialConfig;
+
+    this.useBodyParser(
+      contentType,
+      withRawBody,
+      { bodyLimit },
+      (req, body, done) => {
+        const { onProtoPoisoning, onConstructorPoisoning } =
+          this.instance.initialConfig;
+        const defaultJsonParser = this.instance.getDefaultJsonParser(
+          onProtoPoisoning || 'error',
+          onConstructorPoisoning || 'error',
+        ) as FastifyBodyParser<string | Buffer, TServer>;
+        defaultJsonParser(req, body, done);
+      },
+    );
+  }
+
+  private registerUrlencodedContentParser(rawBody?: boolean) {
+    const contentType = 'application/x-www-form-urlencoded';
+    const withRawBody = !!rawBody;
+    const { bodyLimit } = this.getInstance().initialConfig;
+
+    this.useBodyParser(
+      contentType,
+      withRawBody,
+      { bodyLimit },
+      (_req, body, done) => {
+        done(null, querystringParse(body.toString()));
+      },
+    );
+  }
+
   private async registerMiddie() {
     this.isMiddieRegistered = true;
-    await this.register(import('middie'));
+    await this.register(
+      import('@fastify/middie') as Parameters<TInstance['register']>[0],
+    );
   }
 
   private getRequestOriginalUrl(rawRequest: TRawRequest) {
-    return rawRequest.originalUrl || rawRequest.url;
-  }
-
-  private injectConstraintsIfVersioned(
-    routerMethodKey:
-      | 'get'
-      | 'post'
-      | 'put'
-      | 'delete'
-      | 'options'
-      | 'patch'
-      | 'head',
+    return rawRequest.originalUrl || rawRequest.url!;
+  }
+
+  private injectRouteOptions(
+    routerMethodKey: Uppercase<HTTPMethods>,
     ...args: any[]
   ) {
     const handlerRef = args[args.length - 1];
     const isVersioned =
       !isUndefined(handlerRef.version) &&
       handlerRef.version !== VERSION_NEUTRAL;
+    const routeConfig = Reflect.getMetadata(
+      FASTIFY_ROUTE_CONFIG_METADATA,
+      handlerRef,
+    );
+
+    const routeConstraints = Reflect.getMetadata(
+      FASTIFY_ROUTE_CONSTRAINTS_METADATA,
+      handlerRef,
+    );
 
-    if (isVersioned) {
+    const hasConfig = !isUndefined(routeConfig);
+    const hasConstraints = !isUndefined(routeConstraints);
+
+    const routeToInject: RouteOptions<TServer, TRawRequest, TRawResponse> &
+      RouteShorthandOptions = {
+      method: routerMethodKey,
+      url: args[0],
+      handler: handlerRef,
+    };
+
+    if (isVersioned || hasConstraints || hasConfig) {
       const isPathAndRouteTuple = args.length === 2;
       if (isPathAndRouteTuple) {
-        const options = {
-          constraints: {
+        const constraints = {
+          ...(hasConstraints && routeConstraints),
+          ...(isVersioned && {
             version: handlerRef.version,
-          },
+          }),
+        };
+
+        const options = {
+          constraints,
+          ...(hasConfig && {
+            config: {
+              ...routeConfig,
+            },
+          }),
         };
-        const path = args[0];
-        return this.instance[routerMethodKey](path, options, handlerRef);
+
+        const routeToInjectWithOptions = { ...routeToInject, ...options };
+
+        return this.instance.route(routeToInjectWithOptions);
       }
     }
-    return this.instance[routerMethodKey](
-      ...(args as Parameters<
-        RouteShorthandMethod<TServer, TRawRequest, TRawResponse>
-      >),
-    );
+    return this.instance.route(routeToInject);
   }
 }
diff --git a/packages/platform-fastify/constants.ts b/packages/platform-fastify/constants.ts
new file mode 100644
index 000000000..2f00d8077
--- /dev/null
+++ b/packages/platform-fastify/constants.ts
@@ -0,0 +1,3 @@
+export const FASTIFY_ROUTE_CONFIG_METADATA = '__fastify_route_config__';
+export const FASTIFY_ROUTE_CONSTRAINTS_METADATA =
+  '__fastify_route_constraints__';
diff --git a/packages/platform-fastify/decorators/index.ts b/packages/platform-fastify/decorators/index.ts
new file mode 100644
index 000000000..67cc9d3d8
--- /dev/null
+++ b/packages/platform-fastify/decorators/index.ts
@@ -0,0 +1,2 @@
+export * from './route-config.decorator';
+export * from './route-constraints.decorator';
diff --git a/packages/platform-fastify/decorators/route-config.decorator.ts b/packages/platform-fastify/decorators/route-config.decorator.ts
new file mode 100644
index 000000000..b0e6c874f
--- /dev/null
+++ b/packages/platform-fastify/decorators/route-config.decorator.ts
@@ -0,0 +1,10 @@
+import { SetMetadata } from '@nestjs/common';
+import { FASTIFY_ROUTE_CONFIG_METADATA } from '../constants';
+
+/**
+ * @publicApi
+ *
+ * @param config See {@link https://fastify.dev/docs/latest/Reference/Routes/#config}
+ */
+export const RouteConfig = (config: any) =>
+  SetMetadata(FASTIFY_ROUTE_CONFIG_METADATA, config);
diff --git a/packages/platform-fastify/decorators/route-constraints.decorator.ts b/packages/platform-fastify/decorators/route-constraints.decorator.ts
new file mode 100644
index 000000000..b45633106
--- /dev/null
+++ b/packages/platform-fastify/decorators/route-constraints.decorator.ts
@@ -0,0 +1,11 @@
+import { SetMetadata } from '@nestjs/common';
+import { FASTIFY_ROUTE_CONSTRAINTS_METADATA } from '../constants';
+import { RouteShorthandOptions } from 'fastify';
+
+/**
+ * @publicApi
+ *
+ * @param config See {@link https://fastify.dev/docs/latest/Reference/Routes/#constraints}
+ */
+export const RouteConstraints = (config: RouteShorthandOptions['config']) =>
+  SetMetadata(FASTIFY_ROUTE_CONSTRAINTS_METADATA, config);
diff --git a/packages/platform-fastify/index.ts b/packages/platform-fastify/index.ts
index 6ee0f8cf9..6c1cdefb3 100644
--- a/packages/platform-fastify/index.ts
+++ b/packages/platform-fastify/index.ts
@@ -1,9 +1,10 @@
 /*
- * Nest @platform-express
- * Copyright(c) 2017 - 2021 Kamil Mysliwiec
+ * Nest @platform-fastify
+ * Copyright(c) 2017 - 2023 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
 
 export * from './adapters';
 export * from './interfaces';
+export * from './decorators';
diff --git a/packages/platform-fastify/interfaces/external/fastify-static-options.interface.ts b/packages/platform-fastify/interfaces/external/fastify-static-options.interface.ts
index 9f591764a..e4a434a35 100644
--- a/packages/platform-fastify/interfaces/external/fastify-static-options.interface.ts
+++ b/packages/platform-fastify/interfaces/external/fastify-static-options.interface.ts
@@ -1,16 +1,38 @@
 /**
  * "fastify-static" interfaces
- * @see https://github.com/fastify/fastify-static/blob/master/index.d.ts
+ * @see https://github.com/fastify/fastify-static/blob/master/types/index.d.ts
+ * @publicApi
  */
+import { RouteOptions, FastifyRequest, FastifyReply } from 'fastify';
+import { Stats } from 'fs';
+
+interface SetHeadersResponse {
+  getHeader: FastifyReply['getHeader'];
+  setHeader: FastifyReply['header'];
+  readonly filename: string;
+  statusCode: number;
+}
+
+interface ExtendedInformation {
+  fileCount: number;
+  totalFileCount: number;
+  folderCount: number;
+  totalFolderCount: number;
+  totalSize: number;
+  lastModified: number;
+}
 
 interface ListDir {
   href: string;
   name: string;
+  stats: Stats;
+  extendedInfo?: ExtendedInformation;
 }
 
 interface ListFile {
   href: string;
   name: string;
+  stats: Stats;
 }
 
 interface ListRender {
@@ -18,8 +40,19 @@ interface ListRender {
 }
 
 interface ListOptions {
-  format: 'json' | 'html';
   names: string[];
+  extendedFolderInfo?: boolean;
+  jsonFormat?: 'names' | 'extended';
+}
+
+export interface ListOptionsJsonFormat extends ListOptions {
+  format: 'json';
+  // Required when the URL parameter `format=html` exists
+  render?: ListRender;
+}
+
+export interface ListOptionsHtmlFormat extends ListOptions {
+  format: 'html';
   render: ListRender;
 }
 
@@ -31,23 +64,33 @@ interface SendOptions {
   etag?: boolean;
   extensions?: string[];
   immutable?: boolean;
-  index?: string[] | false;
+  index?: string[] | string | false;
   lastModified?: boolean;
   maxAge?: string | number;
+  serveDotFiles?: boolean;
 }
 
 export interface FastifyStaticOptions extends SendOptions {
-  root: string | string[];
+  root: string | string[] | URL | URL[];
   prefix?: string;
   prefixAvoidTrailingSlash?: boolean;
   serve?: boolean;
   decorateReply?: boolean;
   schemaHide?: boolean;
-  setHeaders?: (...args: any[]) => void;
+  setHeaders?: (res: SetHeadersResponse, path: string, stat: Stats) => void;
   redirect?: boolean;
   wildcard?: boolean;
-  list?: boolean | ListOptions;
-  allowedPath?: (pathName: string, root?: string) => boolean;
+  list?: boolean | ListOptionsJsonFormat | ListOptionsHtmlFormat;
+  allowedPath?: (
+    pathName: string,
+    root: string,
+    request: FastifyRequest,
+  ) => boolean;
+  /**
+   * @description
+   * Opt-in to looking for pre-compressed files
+   */
+  preCompressed?: boolean;
 
   // Passed on to `send`
   acceptRanges?: boolean;
@@ -56,7 +99,8 @@ export interface FastifyStaticOptions extends SendOptions {
   etag?: boolean;
   extensions?: string[];
   immutable?: boolean;
-  index?: string[] | false;
+  index?: string[] | string | false;
   lastModified?: boolean;
   maxAge?: string | number;
+  constraints?: RouteOptions['constraints'];
 }
diff --git a/packages/platform-fastify/interfaces/external/point-of-view-options.interface.ts b/packages/platform-fastify/interfaces/external/fastify-view-options.interface.ts
similarity index 66%
rename from packages/platform-fastify/interfaces/external/point-of-view-options.interface.ts
rename to packages/platform-fastify/interfaces/external/fastify-view-options.interface.ts
index 4d5f918c6..7c1959aea 100644
--- a/packages/platform-fastify/interfaces/external/point-of-view-options.interface.ts
+++ b/packages/platform-fastify/interfaces/external/fastify-view-options.interface.ts
@@ -1,22 +1,22 @@
 /**
- * @see https://github.com/fastify/point-of-view/blob/master/index.d.ts
+ * "fastify/view" interfaces
+ * @see https://github.com/fastify/point-of-view/blob/master/types/index.d.ts
+ * @publicApi
  */
-
-export interface PointOfViewOptions {
+export interface FastifyViewOptions {
   engine: {
     ejs?: any;
     eta?: any;
     nunjucks?: any;
     pug?: any;
     handlebars?: any;
-    marko?: any;
     mustache?: any;
     'art-template'?: any;
     twig?: any;
     liquid?: any;
     dot?: any;
   };
-  templates?: string;
+  templates?: string | string[];
   includeViewExtension?: boolean;
   options?: object;
   charset?: string;
@@ -27,4 +27,5 @@ export interface PointOfViewOptions {
   root?: string;
   viewExt?: string;
   propertyName?: string;
+  asyncProperyName?: string;
 }
diff --git a/packages/platform-fastify/interfaces/external/index.ts b/packages/platform-fastify/interfaces/external/index.ts
index df4df129f..a80eb8a36 100644
--- a/packages/platform-fastify/interfaces/external/index.ts
+++ b/packages/platform-fastify/interfaces/external/index.ts
@@ -1,2 +1,2 @@
 export * from './fastify-static-options.interface';
-export * from './point-of-view-options.interface';
+export * from './fastify-view-options.interface';
diff --git a/packages/platform-fastify/interfaces/index.ts b/packages/platform-fastify/interfaces/index.ts
index ee1841f2f..ae18b9a3c 100644
--- a/packages/platform-fastify/interfaces/index.ts
+++ b/packages/platform-fastify/interfaces/index.ts
@@ -1 +1,2 @@
 export * from './nest-fastify-application.interface';
+export * from './nest-fastify-body-parser-options.interface';
diff --git a/packages/platform-fastify/interfaces/nest-fastify-application.interface.ts b/packages/platform-fastify/interfaces/nest-fastify-application.interface.ts
index f275385ba..97fd813a2 100644
--- a/packages/platform-fastify/interfaces/nest-fastify-application.interface.ts
+++ b/packages/platform-fastify/interfaces/nest-fastify-application.interface.ts
@@ -1,22 +1,41 @@
-import { INestApplication } from '@nestjs/common';
+import { HttpServer, INestApplication } from '@nestjs/common';
 import {
+  FastifyBodyParser,
   FastifyInstance,
+  FastifyListenOptions,
   FastifyPluginAsync,
   FastifyPluginCallback,
   FastifyPluginOptions,
   FastifyRegisterOptions,
+  FastifyReply,
+  FastifyRequest,
+  RawServerBase,
+  RawServerDefault,
 } from 'fastify';
 import {
-  Chain as LightMyRequestChain,
   InjectOptions,
+  Chain as LightMyRequestChain,
   Response as LightMyRequestResponse,
 } from 'light-my-request';
-import { FastifyStaticOptions, PointOfViewOptions } from './external';
+import { FastifyStaticOptions, FastifyViewOptions } from './external';
+import { NestFastifyBodyParserOptions } from './nest-fastify-body-parser-options.interface';
+
+/**
+ * @publicApi
+ */
+export interface NestFastifyApplication<
+  TServer extends RawServerBase = RawServerDefault,
+> extends INestApplication<TServer> {
+  /**
+   * Returns the underlying HTTP adapter bounded to a Fastify app.
+   *
+   * @returns {HttpServer}
+   */
+  getHttpAdapter(): HttpServer<FastifyRequest, FastifyReply, FastifyInstance>;
 
-export interface NestFastifyApplication extends INestApplication {
   /**
    * A wrapper function around native `fastify.register()` method.
-   * Example `app.register(require('fastify-formbody'))
+   * Example `app.register(require('@fastify/formbody'))
    * @returns {Promise<FastifyInstance>}
    */
   register<Options extends FastifyPluginOptions = any>(
@@ -28,6 +47,27 @@ export interface NestFastifyApplication extends INestApplication {
     opts?: FastifyRegisterOptions<Options>,
   ): Promise<FastifyInstance>;
 
+  /**
+   * Register Fastify body parsers on the fly. Will respect
+   * the application's `rawBody` option.
+   *
+   * @example
+   * const app = await NestFactory.create<NestFastifyApplication>(
+   *   AppModule,
+   *   new FastifyAdapter(),
+   *   { rawBody: true }
+   * );
+   * // enable the json parser with a parser limit of 50mb
+   * app.useBodyParser('application/json', { bodyLimit: 50 * 1000 * 1024 });
+   *
+   * @returns {this}
+   */
+  useBodyParser<TServer extends RawServerBase = RawServerBase>(
+    type: string | string[] | RegExp,
+    options?: NestFastifyBodyParserOptions,
+    parser?: FastifyBodyParser<Buffer, TServer>,
+  ): this;
+
   /**
    * Sets a base directory for public assets.
    * Example `app.useStaticAssets({ root: 'public' })`
@@ -38,10 +78,10 @@ export interface NestFastifyApplication extends INestApplication {
   /**
    * Sets a view engine for templates (views), for example: `pug`, `handlebars`, or `ejs`.
    *
-   * Don't pass in a string. The string type in the argument is for compatibilility reason and will cause an exception.
+   * Don't pass in a string. The string type in the argument is for compatibility reason and will cause an exception.
    * @returns {this}
    */
-  setViewEngine(options: PointOfViewOptions | string): this;
+  setViewEngine(options: FastifyViewOptions | string): this;
 
   /**
    * A wrapper function around native `fastify.inject()` method.
@@ -54,19 +94,27 @@ export interface NestFastifyApplication extends INestApplication {
    * Starts the application.
    * @returns A Promise that, when resolved, is a reference to the underlying HttpServer.
    */
+  listen(
+    opts: FastifyListenOptions,
+    callback?: (err: Error | null, address: string) => void,
+  ): Promise<TServer>;
+  listen(opts?: FastifyListenOptions): Promise<TServer>;
+  listen(
+    callback?: (err: Error | null, address: string) => void,
+  ): Promise<TServer>;
   listen(
     port: number | string,
-    callback?: (err: Error, address: string) => void,
-  ): Promise<any>;
+    callback?: (err: Error | null, address: string) => void,
+  ): Promise<TServer>;
   listen(
     port: number | string,
     address: string,
-    callback?: (err: Error, address: string) => void,
-  ): Promise<any>;
+    callback?: (err: Error | null, address: string) => void,
+  ): Promise<TServer>;
   listen(
     port: number | string,
     address: string,
     backlog: number,
-    callback?: (err: Error, address: string) => void,
-  ): Promise<any>;
+    callback?: (err: Error | null, address: string) => void,
+  ): Promise<TServer>;
 }
diff --git a/packages/platform-fastify/interfaces/nest-fastify-body-parser-options.interface.ts b/packages/platform-fastify/interfaces/nest-fastify-body-parser-options.interface.ts
new file mode 100644
index 000000000..9f7ecc054
--- /dev/null
+++ b/packages/platform-fastify/interfaces/nest-fastify-body-parser-options.interface.ts
@@ -0,0 +1,6 @@
+import type { AddContentTypeParser } from 'fastify';
+
+export type NestFastifyBodyParserOptions = Omit<
+  Parameters<AddContentTypeParser>[1],
+  'parseAs'
+>;
diff --git a/packages/platform-fastify/package.json b/packages/platform-fastify/package.json
index 2fd670592..855de422b 100644
--- a/packages/platform-fastify/package.json
+++ b/packages/platform-fastify/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/platform-fastify",
-  "version": "8.2.5",
+  "version": "10.4.11",
   "description": "Nest - modern, fast, powerful node.js web framework (@platform-fastify)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -11,22 +11,33 @@
   },
   "repository": {
     "type": "git",
-    "url": "https://github.com/nestjs/nest"
+    "url": "https://github.com/nestjs/nest.git",
+    "directory": "packages/platform-fastify"
   },
   "publishConfig": {
     "access": "public"
   },
   "dependencies": {
-    "fastify": "3.24.1",
-    "fastify-cors": "6.0.2",
-    "fastify-formbody": "5.2.0",
-    "light-my-request": "4.7.0",
-    "middie": "5.3.0",
-    "path-to-regexp": "3.2.0",
-    "tslib": "2.3.1"
+    "@fastify/cors": "10.0.1",
+    "@fastify/formbody": "8.0.1",
+    "@fastify/middie": "9.0.2",
+    "fastify": "5.1.0",
+    "light-my-request": "6.3.0",
+    "path-to-regexp": "3.3.0",
+    "tslib": "2.7.0"
   },
   "peerDependencies": {
-    "@nestjs/common": "^8.0.0",
-    "@nestjs/core": "^8.0.0"
+    "@fastify/static": "^6.0.0 || ^7.0.0 || ^8.0.0",
+    "@fastify/view": "^7.0.0 || ^8.0.0 || ^9.0.0 || ^10.0.0",
+    "@nestjs/common": "^10.0.0",
+    "@nestjs/core": "^10.0.0"
+  },
+  "peerDependenciesMeta": {
+    "@fastify/static": {
+      "optional": true
+    },
+    "@fastify/view": {
+      "optional": true
+    }
   }
 }
diff --git a/packages/platform-fastify/test/decorators/router-config.decorator.spec.ts b/packages/platform-fastify/test/decorators/router-config.decorator.spec.ts
new file mode 100644
index 000000000..3837d0463
--- /dev/null
+++ b/packages/platform-fastify/test/decorators/router-config.decorator.spec.ts
@@ -0,0 +1,17 @@
+import { expect } from 'chai';
+import { FASTIFY_ROUTE_CONFIG_METADATA } from '../../constants';
+import { RouteConfig } from '../../decorators/route-config.decorator';
+
+describe('@RouteConfig', () => {
+  const routeConfig = { testKey: 'testValue' };
+  class Test {
+    config;
+    @RouteConfig(routeConfig)
+    public static test() {}
+  }
+
+  it('should enhance method with expected fastify route config', () => {
+    const path = Reflect.getMetadata(FASTIFY_ROUTE_CONFIG_METADATA, Test.test);
+    expect(path).to.be.eql(routeConfig);
+  });
+});
diff --git a/packages/platform-fastify/test/decorators/router-constraints.decorator.spec.ts b/packages/platform-fastify/test/decorators/router-constraints.decorator.spec.ts
new file mode 100644
index 000000000..ecd43f7f6
--- /dev/null
+++ b/packages/platform-fastify/test/decorators/router-constraints.decorator.spec.ts
@@ -0,0 +1,39 @@
+import { expect } from 'chai';
+import { FASTIFY_ROUTE_CONSTRAINTS_METADATA } from '../../constants';
+import { RouteConstraints } from '../../decorators/route-constraints.decorator';
+
+describe('@RouteConstraints', () => {
+  describe('has version constraints', () => {
+    const routeConstraints = { version: '1.2.x' };
+    class TestVersionConstraints {
+      config;
+      @RouteConstraints(routeConstraints)
+      public static test() {}
+    }
+
+    it('should have a version constraint', () => {
+      const path = Reflect.getMetadata(
+        FASTIFY_ROUTE_CONSTRAINTS_METADATA,
+        TestVersionConstraints.test,
+      );
+      expect(path).to.be.eql(routeConstraints);
+    });
+  });
+
+  describe('has custom constraints', () => {
+    const customRouteConstraints = { something: 'foo' };
+    class TestConstraints {
+      config;
+      @RouteConstraints(customRouteConstraints)
+      public static test() {}
+    }
+
+    it('should set a custom constraint', () => {
+      const path = Reflect.getMetadata(
+        FASTIFY_ROUTE_CONSTRAINTS_METADATA,
+        TestConstraints.test,
+      );
+      expect(path).to.be.eql(customRouteConstraints);
+    });
+  });
+});
diff --git a/packages/platform-fastify/test/tsconfig.json b/packages/platform-fastify/test/tsconfig.json
new file mode 100644
index 000000000..50d59661d
--- /dev/null
+++ b/packages/platform-fastify/test/tsconfig.json
@@ -0,0 +1,3 @@
+{
+  "extends": "../../../tsconfig.spec.json"
+}
diff --git a/packages/platform-fastify/tsconfig.build.json b/packages/platform-fastify/tsconfig.build.json
new file mode 100644
index 000000000..732ca00cb
--- /dev/null
+++ b/packages/platform-fastify/tsconfig.build.json
@@ -0,0 +1,22 @@
+{
+  "extends": "../tsconfig.build.json",
+  "compilerOptions": {
+    "outDir": ".",
+    "rootDir": ".",
+    "paths": {
+      "@nestjs/common": ["../common"],
+      "@nestjs/common/*": ["../common/*"],
+      "@nestjs/core": ["../core"],
+      "@nestjs/core/*": ["../core/*"]
+    }
+  },
+  "exclude": ["node_modules", "dist", "test/**/*", "*.spec.ts"],
+  "references": [
+    {
+      "path": "../common/tsconfig.build.json"
+    },
+    {
+      "path": "../core/tsconfig.build.json"
+    }
+  ]
+}
diff --git a/packages/platform-fastify/tsconfig.json b/packages/platform-fastify/tsconfig.json
index b238080a4..2ae9e3c90 100644
--- a/packages/platform-fastify/tsconfig.json
+++ b/packages/platform-fastify/tsconfig.json
@@ -1,7 +1,13 @@
 {
-  "extends": "./../tsconfig.base.json",
+  "extends": "../tsconfig.build.json",
   "compilerOptions": {
-    "baseUrl": "./"
+    "types": ["node"]
   },
-  "include": ["*.ts", "**/*.ts"]
+  "files": [],
+  "include": [],
+  "references": [
+    {
+      "path": "./tsconfig.build.json"
+    }
+  ]
 }
diff --git a/packages/platform-socket.io/CHANGELOG.md b/packages/platform-socket.io/CHANGELOG.md
deleted file mode 100644
index 2074a9b0d..000000000
--- a/packages/platform-socket.io/CHANGELOG.md
+++ /dev/null
@@ -1,12 +0,0 @@
-# Change Log
-
-All notable changes to this project will be documented in this file.
-See [Conventional Commits](https://conventionalcommits.org) for commit guidelines.
-
-<a name="8.2.0"></a>
-# [8.2.0](https://github.com/nestjs/nest/compare/v8.1.2...v8.2.0) (2021-11-08)
-
-
-
-
-**Note:** Version bump only for package @nestjs/platform-socket.io
diff --git a/packages/platform-socket.io/Readme.md b/packages/platform-socket.io/Readme.md
index 85a8c2535..4cac0d5ea 100644
--- a/packages/platform-socket.io/Readme.md
+++ b/packages/platform-socket.io/Readme.md
@@ -1,17 +1,16 @@
 <p align="center">
-  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
+  <a href="https://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
 </p>
 
 [circleci-image]: https://img.shields.io/circleci/build/github/nestjs/nest/master?token=abc123def456
 [circleci-url]: https://circleci.com/gh/nestjs/nest
 
-  <p align="center">A progressive <a href="http://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>
+  <p align="center">A progressive <a href="https://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>
     <p align="center">
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/v/@nestjs/core.svg" alt="NPM Version" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
 <a href="https://circleci.com/gh/nestjs/nest" target="_blank"><img src="https://img.shields.io/circleci/build/github/nestjs/nest/master" alt="CircleCI" /></a>
-<a href="https://coveralls.io/github/nestjs/nest?branch=master" target="_blank"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#9" alt="Coverage" /></a>
 <a href="https://discord.gg/G7Qnnhy" target="_blank"><img src="https://img.shields.io/badge/discord-online-brightgreen.svg" alt="Discord"/></a>
 <a href="https://opencollective.com/nest#backer" target="_blank"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
 <a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
@@ -24,21 +23,21 @@
 
 ## Description
 
-Nest is a framework for building efficient, scalable <a href="http://nodejs.org" target="_blank">Node.js</a> server-side applications. It uses modern JavaScript, is built with  <a href="http://www.typescriptlang.org" target="_blank">TypeScript</a> (preserves compatibility with pure JavaScript) and combines elements of OOP (Object Oriented Programming), FP (Functional Programming), and FRP (Functional Reactive Programming).
+Nest is a framework for building efficient, scalable <a href="https://nodejs.org" target="_blank">Node.js</a> server-side applications. It uses modern JavaScript, is built with <a href="https://www.typescriptlang.org" target="_blank">TypeScript</a> (preserves compatibility with pure JavaScript) and combines elements of OOP (Object Oriented Programming), FP (Functional Programming), and FRP (Functional Reactive Programming).
 
-<p>Under the hood, Nest makes use of <a href="https://expressjs.com/" target="_blank">Express</a>, but also, provides compatibility with a wide range of other libraries, like e.g. <a href="https://github.com/fastify/fastify" target="_blank">Fastify</a>, allowing for easy use of the myriad third-party plugins which are available.</p>
+<p>Under the hood, Nest makes use of <a href="https://expressjs.com/" target="_blank">Express</a>, but also provides compatibility with a wide range of other libraries, like <a href="https://github.com/fastify/fastify" target="_blank">Fastify</a>, allowing for easy use of the myriad of third-party plugins which are available.</p>
 
 ## Philosophy
 
-<p>In recent years, thanks to Node.js, JavaScript has become the ‚Äúlingua franca‚Äù of the web for both front and backend applications, giving rise to awesome projects like <a href="https://angular.io/" target="_blank">Angular</a>, <a href="https://github.com/facebook/react" target="_blank">React</a> and <a href="https://github.com/vuejs/vue" target="_blank">Vue</a> which improve developer productivity and enable the construction of fast, testable, extensible frontend applications. However, on the server-side, while there are a lot of superb libraries, helpers and tools for Node, none of them effectively solve the main problem - the architecture.</p>
-<p>Nest aims to provide an application architecture out of the box which allows for effortless creation of highly testable, scalable, loosely coupled and easily maintainable applications. The architecture is heavily inspired by Angular.</p>
+<p>In recent years, thanks to Node.js, JavaScript has become the ‚Äúlingua franca‚Äù of the web for both front and backend applications, giving rise to awesome projects like <a href="https://angular.io/" target="_blank">Angular</a>, <a href="https://github.com/facebook/react" target="_blank">React</a>, and <a href="https://github.com/vuejs/vue" target="_blank">Vue</a>, which improve developer productivity and enable the construction of fast, testable, and extensible frontend applications. However, on the server-side, while there are a lot of superb libraries, helpers, and tools for Node, none of them effectively solve the main problem - the architecture.</p>
+<p>Nest aims to provide an application architecture out of the box which allows for effortless creation of highly testable, scalable, and loosely coupled and easily maintainable applications. The architecture is heavily inspired by Angular.</p>
 
 ## Getting started
 
-* To check out the [guide](https://docs.nestjs.com), visit [docs.nestjs.com](https://docs.nestjs.com). :books:
-* Ë¶ÅÊü•Áúã‰∏≠Êñá [ÊåáÂçó](readme_zh.md), ËØ∑ËÆøÈóÆ [docs.nestjs.cn](https://docs.nestjs.cn). :books:
-* [Í∞ÄÏù¥Îìú](readme_kr.md)Î•º ÌôïÏù∏ÌïòÎ†§Î©¥, [docs.nestjs.com](https://docs.nestjs.com)Î•º Î∞©Î¨∏ÌïòÏÑ∏Ïöî.:books: 
-* „ÉÅ„Çß„ÉÉ„ÇØ„Åô„Çã„Å´„ÅØ [„Ç¨„Ç§„Éâ](readme_jp.md), Ë©≥„Åó„Åè„ÅØ [docs.nestjs.com](https://docs.nestjs.com). :books: 
+- To check out the [guide](https://docs.nestjs.com), visit [docs.nestjs.com](https://docs.nestjs.com). :books:
+- Ë¶ÅÊü•Áúã‰∏≠Êñá [ÊåáÂçó](readme_zh.md), ËØ∑ËÆøÈóÆ [docs.nestjs.cn](https://docs.nestjs.cn). :books:
+- [Í∞ÄÏù¥Îìú](readme_kr.md) Î¨∏ÏÑúÎäî [docs.nestjs.com](https://docs.nestjs.com)ÏóêÏÑú ÌôïÏù∏ÌïòÏã§ Ïàò ÏûàÏäµÎãàÎã§. :books:
+- [„Ç¨„Ç§„Éâ](readme_jp.md)„ÅØ [docs.nestjs.com](https://docs.nestjs.com)„Åß„ÅîÁ¢∫Ë™ç„Åè„Å†„Åï„ÅÑ„ÄÇ :books:
 
 ## Questions
 
@@ -54,71 +53,88 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
-<table style="text-align:center;"><tr>
-  <td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
-  <td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/red-hat-logo.svg" width="200" valign="middle" /></a></td>
-<td>
-<a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
-<td>
-<a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
-</tr></table>
+
+<table style="text-align:center;">
+<tr>
+<td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
+<td><a href="https://microsoft.com/" target="_blank"><img src="https://nestjs.com/img/logos/microsoft-logo.png" width="180" valign="middle" /></a></td>
+<td><a href="https://mojam.co" target="_blank"><img src="https://nestjs.com/img/logos/mojam-logo.png" width="80" valign="middle" /></a></td>
+<td><a href="https://marblism.com?utm_source=nest" target="_blank"><img src="https://nestjs.com/img/logos/marblism-logo.png" width="180" valign="middle" /></a></td>
+<td><a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
+<td><a href="https://amplication.com/" target="_blank"><img src="https://nestjs.com/img/logos/amplication-logo.svg" width="190" valign="middle" /></a></td>
+</tr>
+</table>
 
 #### Gold Sponsors
 
-<table style="text-align:center;"><tr><td>
-  <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
-  <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
-<td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
+<table style="text-align:center;">
+<tr>
+<td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/logos/red-hat-logo.svg" width="200" valign="middle" /></a></td>
+<td><a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
+<td><a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/logos/nx-logo.png" height="45" valign="middle" /></a></td>
+<td><a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/logos/intrinisic-logo.png" width="210" valign="middle" /></a></td>
+<td><a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/logos/jetbrains-logo.svg" width="90" valign="middle" /></a></td>
+</tr>
+<tr>
+<td><a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/logos/snyk-logo-black.png" width="185" valign="middle" /></a></td>
+<td><a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/logos/fuse-logo.svg" width="105" valign="middle" /></a></td>
+<td><a href="https://ridicorp.com/career/" target="_blank"><img src="https://nestjs.com/img/logos/ridi-logo.svg" width="105" valign="middle" /></a></td>
+<td><a href="https://www.movavi.com/imovie-for-windows.html" target="_blank"><img src="https://nestjs.com/img/logos/movavi-logo.svg" width="105" valign="middle" /></a></td>
+<td><a href="https://skunk.team" target="_blank"><img src="https://nestjs.com/img/logos/skunk-logo.png" height="60" valign="middle" /></a></td>
+</tr>
+</table>
 
 #### Silver Sponsors
 
-<table style="text-align:center;"><tr><td>
-<a href="https://neoteric.eu/" target="_blank"><img src="https://nestjs.com/img/neoteric-cut.png" width="120" valign="middle" /></a> </td><td>
-  <a href="http://gojob.com" target="_blank"><img src="http://nestjs.com/img/gojob-logo.png" valign="middle" width="100" /></a> </td><td>
-<a href="https://www.myleodsc.com/" target="_blank"><img src="https://nestjs.com/img/myleo-logo.png" width="180" valign="middle" /></td><td>
-<a href="https://careers.meetdandy.com/?gh_src=063ba61e3us" target="_blank"><img src="https://nestjs.com/img/dandy-roles-logo.svg" width="150" valign="middle" /></td><td>
-<a href="https://www.castlecraft.in" target="_blank"><img src="https://nestjs.com/img/castlecraft-logo.png" width="150" valign="middle" /></td>
-<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td></tr></table>
+<table style="text-align:center;">
+<tr>
+<td><a href="https://www.mercedes-benz.com/" target="_blank"><img src="https://nestjs.com/img/logos/mercedes-logo.png" width="100" valign="middle" /></a></td>
+<td><a href="https://www.dinii.jp/" target="_blank"><img src="https://nestjs.com/img/logos/dinii-logo.png" width="65" valign="middle" /></a></td>
+<td><a href="https://bloodycase.com/?promocode=NEST" target="_blank"><img src="https://nestjs.com/img/logos/bloodycase-logo.png" width="65" valign="middle" /></a></td>
+<td><a href="https://handsontable.com/docs/react-data-grid/?utm_source=NestJS_GH&utm_medium=sponsorship&utm_campaign=library_sponsorship_2024" target="_blank"><img src="https://nestjs.com/img/logos/handsontable-dark-logo.svg#2" width="150" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.itflashcards.com/" target="_blank"><img src="https://nestjs.com/img/logos/it_flashcards-logo.png" width="170" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://arcjet.com/?ref=nestjs" target="_blank"><img src="https://nestjs.com/img/logos/arcjet-logo.svg" width="170" valign="middle" /></a></td>
+</tr>
+</table>
 
 #### Sponsors
 
-<table><tr><td align="center" valign="middle">
-<a href="https://www.swingdev.io" target="_blank"><img src="https://nestjs.com/img/swingdev-logo.svg#1" width="110" valign="middle" /> </a></td><td align="center" valign="middle">
-<a href="https://www.novologic.com/" target="_blank"><img src="https://nestjs.com/img/novologic.png" width="110" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://ever.co/" target="_blank"><img src="https://nestjs.com/img/ever-logo.png" width="72" valign="middle" /></a>  </td><td align="center" valign="middle">
-<a href="https://blokt.com" target="_blank"><img src="https://nestjs.com/img/blokt-logo.png" width="120" valign="middle" /></a>  </td><td align="center" valign="middle"> 
-  <a href="http://architectnow.net/" target="_blank"><img src="https://nestjs.com/img/architectnow.png" width="125" valign="middle" /></a> </td><td align="center" valign="middle">
-  <a href="https://quander.io/" target="_blank"><img src="https://nestjs.com/img/quander.png" width="100" valign="middle" /></a> </td></tr><tr><td align="center" valign="middle">
-  <a href="https://mantro.net/" target="_blank"><img src="https://nestjs.com/img/mantro-logo.svg" width="95" valign="middle" /></a> </td><td align="center" valign="middle">
-  <a href="https://triplebyte.com/" target="_blank"><img src="https://nestjs.com/img/triplebyte.png" width="107" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://reposit.co.uk/" target="_blank"><img src="https://nestjs.com/img/reposit-logo.png" width="71" valign="middle" /></a></td><td align="center" valign="middle">
-<a href="https://nearpod.com/" target="_blank"><img src="https://nestjs.com/img/nearpod-logo.svg" width="100" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://clay.global/" target="_blank"><img src="https://nestjs.com/img/clay-logo.svg" width="75" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://firesticktricks.com" target="_blank"><img src="https://nestjs.com/img/firesticktricks-logo.png" width="120" valign="middle" /></a></td></tr><tr><td align="center" valign="middle">
-<a href="https://www.codeguesser.co.uk" target="_blank"><img src="https://nestjs.com/img/codeguesser-logo.svg" width="120" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://f-a.nz/" target="_blank"><img src="https://nestjs.com/img/franz.svg" width="80" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://sparkfabrik.com/" target="_blank"><img src="https://nestjs.com/img/sparkfabrik-logo.png" width="120" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://www.thebigphonestore.co.uk/" target="_blank"><img src="https://nestjs.com/img/the-big-phone-store-logo.png" width="65" valign="middle" /></a></td>
-  <td align="center" valign="middle">
-  <a href="https://genuinebee.com/" target="_blank"><img src="https://nestjs.com/img/genuinebee.svg" width="97" valign="middle" /></a> </td>
-<td align="center" valign="middle"><a href="https://sanyodigital.com/" target="_blank"><img src="https://nestjs.com/img/sanyo-digital.png" width="130" valign="middle" /></a></td></tr><tr><td align="center" valign="middle"><a href="https://vpn-review.com/vpn-for-torrenting" target="_blank"><img src="https://nestjs.com/img/vpn-review-logo.png" width="85" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://lambda-it.ch/" target="_blank"><img src="https://nestjs.com/img/lambda-it-logo.svg" width="115" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://pickwriters.com/top-10-translation-services" target="_blank"><img src="https://nestjs.com/img/pickwriters-logo.png" width="40" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://thewordpoint.com/services/localization" target="_blank"><img src="https://nestjs.com/img/thewordpoint-logo.png" width="40" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://meercode.io/" target="_blank"><img src="https://nestjs.com/img/meercode-logo.png" width="60" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://www.najlepszeplatformyforex.pl/blog/broker-xtb/" target="_blank"><img src="https://nestjs.com/img/npf-logo.jpg" width="200" valign="middle" /></a></td></tr><tr>
-<td align="center" valign="middle"><a href="https://thestandarddaily.com/" target="_blank"><img src="https://nestjs.com/img/the-standard-daily-logo.png" width="180" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://houseofangular.io/" target="_blank"><img src="https://nestjs.com/img/house-of-angular.png" width="100" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://rocketech.it/cases/?utm_source=google&utm_medium=badge&utm_campaign=nestjs" target="_blank"><img src="https://nestjs.com/img/rocketech-logo.svg" width="110" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://www.bystored.com/" target="_blank"><img src="https://nestjs.com/img/stored-logo.svg" width="110" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://studyclerk.com/pay-for-research-paper" target="_blank"><img src="https://nestjs.com/img/studyclerk-logo.png" width="125" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://xyndata.com" target="_blank"><img src="https://nestjs.com/img/xyndata-logo.png" width="125" valign="middle" /></a></td></tr><tr>
-  <td align="center" valign="middle"><a href="https://www.anonymistic.com/" target="_blank"><img src="https://nestjs.com/img/anonymistic-logo.png" width="125" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/naologic-logo.svg" width="125" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://messaged.com/" target="_blank"><img src="https://nestjs.com/img/messaged-logo.png" width="50" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/triplecore-logo.svg" width="50" valign="middle" /></a></td>
-  </tr></table>
+<table>
+<tr>
+<td align="center" valign="middle"><a href="https://www.swingdev.io" target="_blank"><img src="https://nestjs.com/img/logos/swingdev-logo.svg#1" width="110" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.novologic.com/" target="_blank"><img src="https://nestjs.com/img/logos/novologic.png" width="110" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://mantro.net/" target="_blank"><img src="https://nestjs.com/img/logos/mantro-logo.svg" width="95" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://triplebyte.com/" target="_blank"><img src="https://nestjs.com/img/logos/triplebyte.png" width="107" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://nearpod.com/" target="_blank"><img src="https://nestjs.com/img/logos/nearpod-logo.svg" width="100" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://genuinebee.com/" target="_blank"><img src="https://nestjs.com/img/logos/genuinebee.svg" width="97" valign="middle" /></a></td>
+</tr>
+<tr>
+<td align="center" valign="middle"><a href="https://vpn-review.com/vpn-for-torrenting" target="_blank"><img src="https://nestjs.com/img/logos/vpn-review-logo.png" width="85" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://lambda-it.ch/" target="_blank"><img src="https://nestjs.com/img/logos/lambda-it-logo.svg" width="115" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://rocketech.it/cases/?utm_source=google&utm_medium=badge&utm_campaign=nestjs" target="_blank"><img src="https://nestjs.com/img/logos/rocketech-logo.svg" width="110" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.anonymistic.com/" target="_blank"><img src="https://nestjs.com/img/logos/anonymistic-logo.png" width="125" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/logos/naologic-logo.svg" width="125" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/logos/triplecore-logo.svg" width="50" valign="middle" /></a></td>
+</tr>
+<tr>
+<td align="center" valign="middle"><a href="https://thecasinowizard.com/bonuses/no-deposit-bonuses/" target="_blank"><img src="https://nestjs.com/img/logos/casinowizard-logo.png" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://polygon-software.ch/" target="_blank"><img src="https://nestjs.com/img/logos/polygon-logo.svg" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/logos/boringowl-logo.svg" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://nordbot.app/" target="_blank"><img src="https://nestjs.com/img/logos/nordbot-logo.png" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://doppio.sh/" target="_blank"><img src="https://nestjs.com/img/logos/dopiosh-logo.png" width="50" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.hingehealth.com/" target="_blank"><img src="https://nestjs.com/img/logos/hinge-health-logo.svg" width="100" valign="middle" /></a></td>
+</tr>
+<tr>
+<td align="center" valign="middle"><a href="https://julienferand.dev/" target="_blank"><img src="https://nestjs.com/img/logos/julienferand-logo.jpeg" width="55" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.tripoffice.com/" target="_blank"><img src="https://nestjs.com/img/logos/tripoffice-logo.png" width="140" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://solcellsforetag.se/" target="_blank"><img src="https://nestjs.com/img/logos/solcellsforetag-logo.svg" width="140" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.route4me.com/" target="_blank"><img src="https://nestjs.com/img/logos/route4me-logo.svg" width="100" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.slotsup.com/" target="_blank"><img src="https://nestjs.com/img/logos/slotsup-logo.png" width="60" valign="middle" /></a></td>
+</tr>
+</table>
 
 ## Backers
 
@@ -126,9 +142,9 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 
 ## Stay in touch
 
-* Author - [Kamil My≈õliwiec](https://twitter.com/kammysliwiec)
-* Website - [https://nestjs.com](https://nestjs.com/)
-* Twitter - [@nestframework](https://twitter.com/nestframework)
+- Author - [Kamil My≈õliwiec](https://x.com/kammysliwiec)
+- Website - [https://nestjs.com](https://nestjs.com/)
+- X - [@nestframework](https://x.com/nestframework)
 
 ## License
 
diff --git a/packages/platform-socket.io/adapters/io-adapter.ts b/packages/platform-socket.io/adapters/io-adapter.ts
index 22eb9155c..ab08fde13 100644
--- a/packages/platform-socket.io/adapters/io-adapter.ts
+++ b/packages/platform-socket.io/adapters/io-adapter.ts
@@ -8,6 +8,9 @@ import { fromEvent, Observable } from 'rxjs';
 import { filter, first, map, mergeMap, share, takeUntil } from 'rxjs/operators';
 import { Server, ServerOptions, Socket } from 'socket.io';
 
+/**
+ * @publicApi
+ */
 export class IoAdapter extends AbstractWsAdapter {
   public create(
     port: number,
@@ -20,8 +23,8 @@ export class IoAdapter extends AbstractWsAdapter {
     return server && isFunction(server.of)
       ? server.of(namespace)
       : namespace
-      ? this.createIOServer(port, opt).of(namespace)
-      : this.createIOServer(port, opt);
+        ? this.createIOServer(port, opt).of(namespace)
+        : this.createIOServer(port, opt);
   }
 
   public createIOServer(port: number, options?: any): any {
@@ -64,7 +67,7 @@ export class IoAdapter extends AbstractWsAdapter {
   public mapPayload(payload: unknown): { data: any; ack?: Function } {
     if (!Array.isArray(payload)) {
       if (isFunction(payload)) {
-        return { data: undefined, ack: payload as Function };
+        return { data: undefined, ack: payload };
       }
       return { data: payload };
     }
@@ -79,4 +82,12 @@ export class IoAdapter extends AbstractWsAdapter {
     }
     return { data: payload };
   }
+
+  public async close(server: Server): Promise<void> {
+    if (this.forceCloseConnections && server.httpServer === this.httpServer) {
+      return;
+    }
+
+    return super.close(server);
+  }
 }
diff --git a/packages/platform-socket.io/index.ts b/packages/platform-socket.io/index.ts
index 175a4e0d6..434d79eb4 100644
--- a/packages/platform-socket.io/index.ts
+++ b/packages/platform-socket.io/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @platform-socket.io
- * Copyright(c) 2017 - 2021 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2023 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
diff --git a/packages/platform-socket.io/package.json b/packages/platform-socket.io/package.json
index 5651cdcc4..faa5ce190 100644
--- a/packages/platform-socket.io/package.json
+++ b/packages/platform-socket.io/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/platform-socket.io",
-  "version": "8.2.5",
+  "version": "10.4.11",
   "description": "Nest - modern, fast, powerful node.js web framework (@platform-socket.io)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -11,18 +11,19 @@
   },
   "repository": {
     "type": "git",
-    "url": "https://github.com/nestjs/nest"
+    "url": "https://github.com/nestjs/nest.git",
+    "directory": "packages/platform-socket.io"
   },
   "publishConfig": {
     "access": "public"
   },
   "dependencies": {
-    "socket.io": "4.4.0",
-    "tslib": "2.3.1"
+    "socket.io": "4.8.0",
+    "tslib": "2.7.0"
   },
   "peerDependencies": {
-    "@nestjs/common": "^8.0.0",
-    "@nestjs/websockets": "^8.0.0",
+    "@nestjs/common": "^10.0.0",
+    "@nestjs/websockets": "^10.0.0",
     "rxjs": "^7.1.0"
   }
 }
diff --git a/packages/platform-socket.io/tsconfig.build.json b/packages/platform-socket.io/tsconfig.build.json
new file mode 100644
index 000000000..b9ccddc22
--- /dev/null
+++ b/packages/platform-socket.io/tsconfig.build.json
@@ -0,0 +1,22 @@
+{
+  "extends": "../tsconfig.build.json",
+  "compilerOptions": {
+    "outDir": ".",
+    "rootDir": ".",
+    "paths": {
+      "@nestjs/common": ["../common"],
+      "@nestjs/common/*": ["../common/*"],
+      "@nestjs/websockets": ["../websockets"],
+      "@nestjs/websockets/*": ["../websockets/*"]
+    }
+  },
+  "exclude": ["node_modules", "dist", "test/**/*", "*.spec.ts"],
+  "references": [
+    {
+      "path": "../common/tsconfig.build.json"
+    },
+    {
+      "path": "../websockets/tsconfig.build.json"
+    }
+  ]
+}
diff --git a/packages/platform-socket.io/tsconfig.json b/packages/platform-socket.io/tsconfig.json
index b238080a4..2ae9e3c90 100644
--- a/packages/platform-socket.io/tsconfig.json
+++ b/packages/platform-socket.io/tsconfig.json
@@ -1,7 +1,13 @@
 {
-  "extends": "./../tsconfig.base.json",
+  "extends": "../tsconfig.build.json",
   "compilerOptions": {
-    "baseUrl": "./"
+    "types": ["node"]
   },
-  "include": ["*.ts", "**/*.ts"]
+  "files": [],
+  "include": [],
+  "references": [
+    {
+      "path": "./tsconfig.build.json"
+    }
+  ]
 }
diff --git a/packages/platform-ws/CHANGELOG.md b/packages/platform-ws/CHANGELOG.md
deleted file mode 100644
index 38ce8ea49..000000000
--- a/packages/platform-ws/CHANGELOG.md
+++ /dev/null
@@ -1,12 +0,0 @@
-# Change Log
-
-All notable changes to this project will be documented in this file.
-See [Conventional Commits](https://conventionalcommits.org) for commit guidelines.
-
-<a name="8.2.0"></a>
-# [8.2.0](https://github.com/nestjs/nest/compare/v8.1.2...v8.2.0) (2021-11-08)
-
-
-
-
-**Note:** Version bump only for package @nestjs/platform-ws
diff --git a/packages/platform-ws/Readme.md b/packages/platform-ws/Readme.md
index 85a8c2535..4cac0d5ea 100644
--- a/packages/platform-ws/Readme.md
+++ b/packages/platform-ws/Readme.md
@@ -1,17 +1,16 @@
 <p align="center">
-  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
+  <a href="https://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
 </p>
 
 [circleci-image]: https://img.shields.io/circleci/build/github/nestjs/nest/master?token=abc123def456
 [circleci-url]: https://circleci.com/gh/nestjs/nest
 
-  <p align="center">A progressive <a href="http://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>
+  <p align="center">A progressive <a href="https://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>
     <p align="center">
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/v/@nestjs/core.svg" alt="NPM Version" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
 <a href="https://circleci.com/gh/nestjs/nest" target="_blank"><img src="https://img.shields.io/circleci/build/github/nestjs/nest/master" alt="CircleCI" /></a>
-<a href="https://coveralls.io/github/nestjs/nest?branch=master" target="_blank"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#9" alt="Coverage" /></a>
 <a href="https://discord.gg/G7Qnnhy" target="_blank"><img src="https://img.shields.io/badge/discord-online-brightgreen.svg" alt="Discord"/></a>
 <a href="https://opencollective.com/nest#backer" target="_blank"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
 <a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
@@ -24,21 +23,21 @@
 
 ## Description
 
-Nest is a framework for building efficient, scalable <a href="http://nodejs.org" target="_blank">Node.js</a> server-side applications. It uses modern JavaScript, is built with  <a href="http://www.typescriptlang.org" target="_blank">TypeScript</a> (preserves compatibility with pure JavaScript) and combines elements of OOP (Object Oriented Programming), FP (Functional Programming), and FRP (Functional Reactive Programming).
+Nest is a framework for building efficient, scalable <a href="https://nodejs.org" target="_blank">Node.js</a> server-side applications. It uses modern JavaScript, is built with <a href="https://www.typescriptlang.org" target="_blank">TypeScript</a> (preserves compatibility with pure JavaScript) and combines elements of OOP (Object Oriented Programming), FP (Functional Programming), and FRP (Functional Reactive Programming).
 
-<p>Under the hood, Nest makes use of <a href="https://expressjs.com/" target="_blank">Express</a>, but also, provides compatibility with a wide range of other libraries, like e.g. <a href="https://github.com/fastify/fastify" target="_blank">Fastify</a>, allowing for easy use of the myriad third-party plugins which are available.</p>
+<p>Under the hood, Nest makes use of <a href="https://expressjs.com/" target="_blank">Express</a>, but also provides compatibility with a wide range of other libraries, like <a href="https://github.com/fastify/fastify" target="_blank">Fastify</a>, allowing for easy use of the myriad of third-party plugins which are available.</p>
 
 ## Philosophy
 
-<p>In recent years, thanks to Node.js, JavaScript has become the ‚Äúlingua franca‚Äù of the web for both front and backend applications, giving rise to awesome projects like <a href="https://angular.io/" target="_blank">Angular</a>, <a href="https://github.com/facebook/react" target="_blank">React</a> and <a href="https://github.com/vuejs/vue" target="_blank">Vue</a> which improve developer productivity and enable the construction of fast, testable, extensible frontend applications. However, on the server-side, while there are a lot of superb libraries, helpers and tools for Node, none of them effectively solve the main problem - the architecture.</p>
-<p>Nest aims to provide an application architecture out of the box which allows for effortless creation of highly testable, scalable, loosely coupled and easily maintainable applications. The architecture is heavily inspired by Angular.</p>
+<p>In recent years, thanks to Node.js, JavaScript has become the ‚Äúlingua franca‚Äù of the web for both front and backend applications, giving rise to awesome projects like <a href="https://angular.io/" target="_blank">Angular</a>, <a href="https://github.com/facebook/react" target="_blank">React</a>, and <a href="https://github.com/vuejs/vue" target="_blank">Vue</a>, which improve developer productivity and enable the construction of fast, testable, and extensible frontend applications. However, on the server-side, while there are a lot of superb libraries, helpers, and tools for Node, none of them effectively solve the main problem - the architecture.</p>
+<p>Nest aims to provide an application architecture out of the box which allows for effortless creation of highly testable, scalable, and loosely coupled and easily maintainable applications. The architecture is heavily inspired by Angular.</p>
 
 ## Getting started
 
-* To check out the [guide](https://docs.nestjs.com), visit [docs.nestjs.com](https://docs.nestjs.com). :books:
-* Ë¶ÅÊü•Áúã‰∏≠Êñá [ÊåáÂçó](readme_zh.md), ËØ∑ËÆøÈóÆ [docs.nestjs.cn](https://docs.nestjs.cn). :books:
-* [Í∞ÄÏù¥Îìú](readme_kr.md)Î•º ÌôïÏù∏ÌïòÎ†§Î©¥, [docs.nestjs.com](https://docs.nestjs.com)Î•º Î∞©Î¨∏ÌïòÏÑ∏Ïöî.:books: 
-* „ÉÅ„Çß„ÉÉ„ÇØ„Åô„Çã„Å´„ÅØ [„Ç¨„Ç§„Éâ](readme_jp.md), Ë©≥„Åó„Åè„ÅØ [docs.nestjs.com](https://docs.nestjs.com). :books: 
+- To check out the [guide](https://docs.nestjs.com), visit [docs.nestjs.com](https://docs.nestjs.com). :books:
+- Ë¶ÅÊü•Áúã‰∏≠Êñá [ÊåáÂçó](readme_zh.md), ËØ∑ËÆøÈóÆ [docs.nestjs.cn](https://docs.nestjs.cn). :books:
+- [Í∞ÄÏù¥Îìú](readme_kr.md) Î¨∏ÏÑúÎäî [docs.nestjs.com](https://docs.nestjs.com)ÏóêÏÑú ÌôïÏù∏ÌïòÏã§ Ïàò ÏûàÏäµÎãàÎã§. :books:
+- [„Ç¨„Ç§„Éâ](readme_jp.md)„ÅØ [docs.nestjs.com](https://docs.nestjs.com)„Åß„ÅîÁ¢∫Ë™ç„Åè„Å†„Åï„ÅÑ„ÄÇ :books:
 
 ## Questions
 
@@ -54,71 +53,88 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
-<table style="text-align:center;"><tr>
-  <td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
-  <td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/red-hat-logo.svg" width="200" valign="middle" /></a></td>
-<td>
-<a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
-<td>
-<a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
-</tr></table>
+
+<table style="text-align:center;">
+<tr>
+<td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
+<td><a href="https://microsoft.com/" target="_blank"><img src="https://nestjs.com/img/logos/microsoft-logo.png" width="180" valign="middle" /></a></td>
+<td><a href="https://mojam.co" target="_blank"><img src="https://nestjs.com/img/logos/mojam-logo.png" width="80" valign="middle" /></a></td>
+<td><a href="https://marblism.com?utm_source=nest" target="_blank"><img src="https://nestjs.com/img/logos/marblism-logo.png" width="180" valign="middle" /></a></td>
+<td><a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
+<td><a href="https://amplication.com/" target="_blank"><img src="https://nestjs.com/img/logos/amplication-logo.svg" width="190" valign="middle" /></a></td>
+</tr>
+</table>
 
 #### Gold Sponsors
 
-<table style="text-align:center;"><tr><td>
-  <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
-  <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
-<td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
+<table style="text-align:center;">
+<tr>
+<td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/logos/red-hat-logo.svg" width="200" valign="middle" /></a></td>
+<td><a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
+<td><a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/logos/nx-logo.png" height="45" valign="middle" /></a></td>
+<td><a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/logos/intrinisic-logo.png" width="210" valign="middle" /></a></td>
+<td><a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/logos/jetbrains-logo.svg" width="90" valign="middle" /></a></td>
+</tr>
+<tr>
+<td><a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/logos/snyk-logo-black.png" width="185" valign="middle" /></a></td>
+<td><a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/logos/fuse-logo.svg" width="105" valign="middle" /></a></td>
+<td><a href="https://ridicorp.com/career/" target="_blank"><img src="https://nestjs.com/img/logos/ridi-logo.svg" width="105" valign="middle" /></a></td>
+<td><a href="https://www.movavi.com/imovie-for-windows.html" target="_blank"><img src="https://nestjs.com/img/logos/movavi-logo.svg" width="105" valign="middle" /></a></td>
+<td><a href="https://skunk.team" target="_blank"><img src="https://nestjs.com/img/logos/skunk-logo.png" height="60" valign="middle" /></a></td>
+</tr>
+</table>
 
 #### Silver Sponsors
 
-<table style="text-align:center;"><tr><td>
-<a href="https://neoteric.eu/" target="_blank"><img src="https://nestjs.com/img/neoteric-cut.png" width="120" valign="middle" /></a> </td><td>
-  <a href="http://gojob.com" target="_blank"><img src="http://nestjs.com/img/gojob-logo.png" valign="middle" width="100" /></a> </td><td>
-<a href="https://www.myleodsc.com/" target="_blank"><img src="https://nestjs.com/img/myleo-logo.png" width="180" valign="middle" /></td><td>
-<a href="https://careers.meetdandy.com/?gh_src=063ba61e3us" target="_blank"><img src="https://nestjs.com/img/dandy-roles-logo.svg" width="150" valign="middle" /></td><td>
-<a href="https://www.castlecraft.in" target="_blank"><img src="https://nestjs.com/img/castlecraft-logo.png" width="150" valign="middle" /></td>
-<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td></tr></table>
+<table style="text-align:center;">
+<tr>
+<td><a href="https://www.mercedes-benz.com/" target="_blank"><img src="https://nestjs.com/img/logos/mercedes-logo.png" width="100" valign="middle" /></a></td>
+<td><a href="https://www.dinii.jp/" target="_blank"><img src="https://nestjs.com/img/logos/dinii-logo.png" width="65" valign="middle" /></a></td>
+<td><a href="https://bloodycase.com/?promocode=NEST" target="_blank"><img src="https://nestjs.com/img/logos/bloodycase-logo.png" width="65" valign="middle" /></a></td>
+<td><a href="https://handsontable.com/docs/react-data-grid/?utm_source=NestJS_GH&utm_medium=sponsorship&utm_campaign=library_sponsorship_2024" target="_blank"><img src="https://nestjs.com/img/logos/handsontable-dark-logo.svg#2" width="150" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.itflashcards.com/" target="_blank"><img src="https://nestjs.com/img/logos/it_flashcards-logo.png" width="170" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://arcjet.com/?ref=nestjs" target="_blank"><img src="https://nestjs.com/img/logos/arcjet-logo.svg" width="170" valign="middle" /></a></td>
+</tr>
+</table>
 
 #### Sponsors
 
-<table><tr><td align="center" valign="middle">
-<a href="https://www.swingdev.io" target="_blank"><img src="https://nestjs.com/img/swingdev-logo.svg#1" width="110" valign="middle" /> </a></td><td align="center" valign="middle">
-<a href="https://www.novologic.com/" target="_blank"><img src="https://nestjs.com/img/novologic.png" width="110" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://ever.co/" target="_blank"><img src="https://nestjs.com/img/ever-logo.png" width="72" valign="middle" /></a>  </td><td align="center" valign="middle">
-<a href="https://blokt.com" target="_blank"><img src="https://nestjs.com/img/blokt-logo.png" width="120" valign="middle" /></a>  </td><td align="center" valign="middle"> 
-  <a href="http://architectnow.net/" target="_blank"><img src="https://nestjs.com/img/architectnow.png" width="125" valign="middle" /></a> </td><td align="center" valign="middle">
-  <a href="https://quander.io/" target="_blank"><img src="https://nestjs.com/img/quander.png" width="100" valign="middle" /></a> </td></tr><tr><td align="center" valign="middle">
-  <a href="https://mantro.net/" target="_blank"><img src="https://nestjs.com/img/mantro-logo.svg" width="95" valign="middle" /></a> </td><td align="center" valign="middle">
-  <a href="https://triplebyte.com/" target="_blank"><img src="https://nestjs.com/img/triplebyte.png" width="107" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://reposit.co.uk/" target="_blank"><img src="https://nestjs.com/img/reposit-logo.png" width="71" valign="middle" /></a></td><td align="center" valign="middle">
-<a href="https://nearpod.com/" target="_blank"><img src="https://nestjs.com/img/nearpod-logo.svg" width="100" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://clay.global/" target="_blank"><img src="https://nestjs.com/img/clay-logo.svg" width="75" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://firesticktricks.com" target="_blank"><img src="https://nestjs.com/img/firesticktricks-logo.png" width="120" valign="middle" /></a></td></tr><tr><td align="center" valign="middle">
-<a href="https://www.codeguesser.co.uk" target="_blank"><img src="https://nestjs.com/img/codeguesser-logo.svg" width="120" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://f-a.nz/" target="_blank"><img src="https://nestjs.com/img/franz.svg" width="80" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://sparkfabrik.com/" target="_blank"><img src="https://nestjs.com/img/sparkfabrik-logo.png" width="120" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://www.thebigphonestore.co.uk/" target="_blank"><img src="https://nestjs.com/img/the-big-phone-store-logo.png" width="65" valign="middle" /></a></td>
-  <td align="center" valign="middle">
-  <a href="https://genuinebee.com/" target="_blank"><img src="https://nestjs.com/img/genuinebee.svg" width="97" valign="middle" /></a> </td>
-<td align="center" valign="middle"><a href="https://sanyodigital.com/" target="_blank"><img src="https://nestjs.com/img/sanyo-digital.png" width="130" valign="middle" /></a></td></tr><tr><td align="center" valign="middle"><a href="https://vpn-review.com/vpn-for-torrenting" target="_blank"><img src="https://nestjs.com/img/vpn-review-logo.png" width="85" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://lambda-it.ch/" target="_blank"><img src="https://nestjs.com/img/lambda-it-logo.svg" width="115" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://pickwriters.com/top-10-translation-services" target="_blank"><img src="https://nestjs.com/img/pickwriters-logo.png" width="40" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://thewordpoint.com/services/localization" target="_blank"><img src="https://nestjs.com/img/thewordpoint-logo.png" width="40" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://meercode.io/" target="_blank"><img src="https://nestjs.com/img/meercode-logo.png" width="60" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://www.najlepszeplatformyforex.pl/blog/broker-xtb/" target="_blank"><img src="https://nestjs.com/img/npf-logo.jpg" width="200" valign="middle" /></a></td></tr><tr>
-<td align="center" valign="middle"><a href="https://thestandarddaily.com/" target="_blank"><img src="https://nestjs.com/img/the-standard-daily-logo.png" width="180" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://houseofangular.io/" target="_blank"><img src="https://nestjs.com/img/house-of-angular.png" width="100" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://rocketech.it/cases/?utm_source=google&utm_medium=badge&utm_campaign=nestjs" target="_blank"><img src="https://nestjs.com/img/rocketech-logo.svg" width="110" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://www.bystored.com/" target="_blank"><img src="https://nestjs.com/img/stored-logo.svg" width="110" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://studyclerk.com/pay-for-research-paper" target="_blank"><img src="https://nestjs.com/img/studyclerk-logo.png" width="125" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://xyndata.com" target="_blank"><img src="https://nestjs.com/img/xyndata-logo.png" width="125" valign="middle" /></a></td></tr><tr>
-  <td align="center" valign="middle"><a href="https://www.anonymistic.com/" target="_blank"><img src="https://nestjs.com/img/anonymistic-logo.png" width="125" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/naologic-logo.svg" width="125" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://messaged.com/" target="_blank"><img src="https://nestjs.com/img/messaged-logo.png" width="50" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/triplecore-logo.svg" width="50" valign="middle" /></a></td>
-  </tr></table>
+<table>
+<tr>
+<td align="center" valign="middle"><a href="https://www.swingdev.io" target="_blank"><img src="https://nestjs.com/img/logos/swingdev-logo.svg#1" width="110" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.novologic.com/" target="_blank"><img src="https://nestjs.com/img/logos/novologic.png" width="110" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://mantro.net/" target="_blank"><img src="https://nestjs.com/img/logos/mantro-logo.svg" width="95" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://triplebyte.com/" target="_blank"><img src="https://nestjs.com/img/logos/triplebyte.png" width="107" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://nearpod.com/" target="_blank"><img src="https://nestjs.com/img/logos/nearpod-logo.svg" width="100" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://genuinebee.com/" target="_blank"><img src="https://nestjs.com/img/logos/genuinebee.svg" width="97" valign="middle" /></a></td>
+</tr>
+<tr>
+<td align="center" valign="middle"><a href="https://vpn-review.com/vpn-for-torrenting" target="_blank"><img src="https://nestjs.com/img/logos/vpn-review-logo.png" width="85" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://lambda-it.ch/" target="_blank"><img src="https://nestjs.com/img/logos/lambda-it-logo.svg" width="115" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://rocketech.it/cases/?utm_source=google&utm_medium=badge&utm_campaign=nestjs" target="_blank"><img src="https://nestjs.com/img/logos/rocketech-logo.svg" width="110" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.anonymistic.com/" target="_blank"><img src="https://nestjs.com/img/logos/anonymistic-logo.png" width="125" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/logos/naologic-logo.svg" width="125" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/logos/triplecore-logo.svg" width="50" valign="middle" /></a></td>
+</tr>
+<tr>
+<td align="center" valign="middle"><a href="https://thecasinowizard.com/bonuses/no-deposit-bonuses/" target="_blank"><img src="https://nestjs.com/img/logos/casinowizard-logo.png" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://polygon-software.ch/" target="_blank"><img src="https://nestjs.com/img/logos/polygon-logo.svg" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/logos/boringowl-logo.svg" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://nordbot.app/" target="_blank"><img src="https://nestjs.com/img/logos/nordbot-logo.png" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://doppio.sh/" target="_blank"><img src="https://nestjs.com/img/logos/dopiosh-logo.png" width="50" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.hingehealth.com/" target="_blank"><img src="https://nestjs.com/img/logos/hinge-health-logo.svg" width="100" valign="middle" /></a></td>
+</tr>
+<tr>
+<td align="center" valign="middle"><a href="https://julienferand.dev/" target="_blank"><img src="https://nestjs.com/img/logos/julienferand-logo.jpeg" width="55" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.tripoffice.com/" target="_blank"><img src="https://nestjs.com/img/logos/tripoffice-logo.png" width="140" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://solcellsforetag.se/" target="_blank"><img src="https://nestjs.com/img/logos/solcellsforetag-logo.svg" width="140" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.route4me.com/" target="_blank"><img src="https://nestjs.com/img/logos/route4me-logo.svg" width="100" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.slotsup.com/" target="_blank"><img src="https://nestjs.com/img/logos/slotsup-logo.png" width="60" valign="middle" /></a></td>
+</tr>
+</table>
 
 ## Backers
 
@@ -126,9 +142,9 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 
 ## Stay in touch
 
-* Author - [Kamil My≈õliwiec](https://twitter.com/kammysliwiec)
-* Website - [https://nestjs.com](https://nestjs.com/)
-* Twitter - [@nestframework](https://twitter.com/nestframework)
+- Author - [Kamil My≈õliwiec](https://x.com/kammysliwiec)
+- Website - [https://nestjs.com](https://nestjs.com/)
+- X - [@nestframework](https://x.com/nestframework)
 
 ## License
 
diff --git a/packages/platform-ws/adapters/ws-adapter.ts b/packages/platform-ws/adapters/ws-adapter.ts
index 973bce7b9..6292468ad 100644
--- a/packages/platform-ws/adapters/ws-adapter.ts
+++ b/packages/platform-ws/adapters/ws-adapter.ts
@@ -1,5 +1,6 @@
 import { INestApplicationContext, Logger } from '@nestjs/common';
 import { loadPackage } from '@nestjs/common/utils/load-package.util';
+import { isNil, normalizePath } from '@nestjs/common/utils/shared.utils';
 import { AbstractWsAdapter } from '@nestjs/websockets';
 import {
   CLOSE_EVENT,
@@ -24,9 +25,17 @@ type HttpServerRegistryKey = number;
 type HttpServerRegistryEntry = any;
 type WsServerRegistryKey = number;
 type WsServerRegistryEntry = any[];
+type WsData = string | Buffer | ArrayBuffer | Buffer[];
+type WsMessageParser = (data: WsData) => { event: string; data: any } | void;
+type WsAdapterOptions = {
+  messageParser?: WsMessageParser;
+};
 
 const UNDERLYING_HTTP_SERVER_PORT = 0;
 
+/**
+ * @publicApi
+ */
 export class WsAdapter extends AbstractWsAdapter {
   protected readonly logger = new Logger(WsAdapter.name);
   protected readonly httpServersRegistry = new Map<
@@ -37,17 +46,35 @@ export class WsAdapter extends AbstractWsAdapter {
     WsServerRegistryKey,
     WsServerRegistryEntry
   >();
+  protected messageParser: WsMessageParser = (data: WsData) => {
+    return JSON.parse(data.toString());
+  };
 
-  constructor(appOrHttpServer?: INestApplicationContext | any) {
+  constructor(
+    appOrHttpServer?: INestApplicationContext | object,
+    options?: WsAdapterOptions,
+  ) {
     super(appOrHttpServer);
     wsPackage = loadPackage('ws', 'WsAdapter', () => require('ws'));
+
+    if (options?.messageParser) {
+      this.messageParser = options.messageParser;
+    }
   }
 
   public create(
     port: number,
-    options?: Record<string, any> & { namespace?: string; server?: any },
+    options?: Record<string, any> & {
+      namespace?: string;
+      server?: any;
+      path?: string;
+    },
   ) {
-    const { server, ...wsOptions } = options;
+    const { server, path, ...wsOptions } = options as {
+      namespace?: string;
+      server?: any;
+      path?: string;
+    };
     if (wsOptions?.namespace) {
       const error = new Error(
         '"WsAdapter" does not support namespaces. If you need namespaces in your project, consider using the "@nestjs/platform-socket.io" package instead.',
@@ -65,14 +92,14 @@ export class WsAdapter extends AbstractWsAdapter {
         }),
       );
 
-      this.addWsServerToRegistry(wsServer, port, options.path || '/');
+      this.addWsServerToRegistry(wsServer, port, path!);
       return wsServer;
     }
 
     if (server) {
       return server;
     }
-    if (options.path && port !== UNDERLYING_HTTP_SERVER_PORT) {
+    if (path && port !== UNDERLYING_HTTP_SERVER_PORT) {
       // Multiple servers with different paths
       // sharing a single HTTP/S server running on different port
       // than a regular HTTP application
@@ -85,12 +112,13 @@ export class WsAdapter extends AbstractWsAdapter {
           ...wsOptions,
         }),
       );
-      this.addWsServerToRegistry(wsServer, port, options.path);
+      this.addWsServerToRegistry(wsServer, port, path);
       return wsServer;
     }
     const wsServer = this.bindErrorHandler(
       new wsPackage.Server({
         port,
+        path,
         ...wsOptions,
       }),
     );
@@ -102,11 +130,14 @@ export class WsAdapter extends AbstractWsAdapter {
     handlers: MessageMappingProperties[],
     transform: (data: any) => Observable<any>,
   ) {
+    const handlersMap = new Map<string, MessageMappingProperties>();
+    handlers.forEach(handler => handlersMap.set(handler.message, handler));
+
     const close$ = fromEvent(client, CLOSE_EVENT).pipe(share(), first());
     const source$ = fromEvent(client, 'message').pipe(
       mergeMap(data =>
-        this.bindMessageHandler(data, handlers, transform).pipe(
-          filter(result => result),
+        this.bindMessageHandler(data, handlersMap, transform).pipe(
+          filter(result => !isNil(result)),
         ),
       ),
       takeUntil(close$),
@@ -122,16 +153,17 @@ export class WsAdapter extends AbstractWsAdapter {
 
   public bindMessageHandler(
     buffer: any,
-    handlers: MessageMappingProperties[],
+    handlersMap: Map<string, MessageMappingProperties>,
     transform: (data: any) => Observable<any>,
   ): Observable<any> {
     try {
-      const message = JSON.parse(buffer.data);
-      const messageHandler = handlers.find(
-        handler => handler.message === message.event,
-      );
+      const message = this.messageParser(buffer.data);
+      if (!message) {
+        return EMPTY;
+      }
+      const messageHandler = handlersMap.get(message.event)!;
       const { callback } = messageHandler;
-      return transform(callback(message.data));
+      return transform(callback(message.data, message.event));
     } catch {
       return EMPTY;
     }
@@ -149,6 +181,16 @@ export class WsAdapter extends AbstractWsAdapter {
     client.on(CLOSE_EVENT, callback);
   }
 
+  public async close(server: any) {
+    const closeEventSignal = new Promise((resolve, reject) =>
+      server.close((err: Error) => (err ? reject(err) : resolve(undefined))),
+    );
+    for (const ws of server.clients) {
+      ws.terminate();
+    }
+    await closeEventSignal;
+  }
+
   public async dispose() {
     const closeEventSignals = Array.from(this.httpServersRegistry)
       .filter(([port]) => port !== UNDERLYING_HTTP_SERVER_PORT)
@@ -159,6 +201,10 @@ export class WsAdapter extends AbstractWsAdapter {
     this.wsServersRegistry.clear();
   }
 
+  public setMessageParser(parser: WsMessageParser) {
+    this.messageParser = parser;
+  }
+
   protected ensureHttpServerExists(
     port: number,
     httpServer = http.createServer(),
@@ -169,22 +215,26 @@ export class WsAdapter extends AbstractWsAdapter {
     this.httpServersRegistry.set(port, httpServer);
 
     httpServer.on('upgrade', (request, socket, head) => {
-      const baseUrl = 'ws://' + request.headers.host + '/';
-      const pathname = new URL(request.url, baseUrl).pathname;
-      const wsServersCollection = this.wsServersRegistry.get(port);
-
-      let isRequestDelegated = false;
-      for (const wsServer of wsServersCollection) {
-        if (pathname === wsServer.path) {
-          wsServer.handleUpgrade(request, socket, head, (ws: unknown) => {
-            wsServer.emit('connection', ws, request);
-          });
-          isRequestDelegated = true;
-          break;
+      try {
+        const baseUrl = 'ws://' + request.headers.host + '/';
+        const pathname = new URL(request.url!, baseUrl).pathname;
+        const wsServersCollection = this.wsServersRegistry.get(port)!;
+
+        let isRequestDelegated = false;
+        for (const wsServer of wsServersCollection) {
+          if (pathname === wsServer.path) {
+            wsServer.handleUpgrade(request, socket, head, (ws: unknown) => {
+              wsServer.emit('connection', ws, request);
+            });
+            isRequestDelegated = true;
+            break;
+          }
         }
-      }
-      if (!isRequestDelegated) {
-        socket.destroy();
+        if (!isRequestDelegated) {
+          socket.destroy();
+        }
+      } catch (err) {
+        socket.end('HTTP/1.1 400\r\n' + err.message);
       }
     });
     return httpServer;
@@ -198,7 +248,7 @@ export class WsAdapter extends AbstractWsAdapter {
     const entries = this.wsServersRegistry.get(port) ?? [];
     entries.push(wsServer);
 
-    wsServer.path = path;
+    wsServer.path = normalizePath(path);
     this.wsServersRegistry.set(port, entries);
   }
 }
diff --git a/packages/platform-ws/index.ts b/packages/platform-ws/index.ts
index e1b9386e4..e83223e11 100644
--- a/packages/platform-ws/index.ts
+++ b/packages/platform-ws/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @platform-ws
- * Copyright(c) 2017 - 2021 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2023 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
diff --git a/packages/platform-ws/package.json b/packages/platform-ws/package.json
index 8f5842fda..0085eec82 100644
--- a/packages/platform-ws/package.json
+++ b/packages/platform-ws/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/platform-ws",
-  "version": "8.2.5",
+  "version": "10.4.11",
   "description": "Nest - modern, fast, powerful node.js web framework (@platform-ws)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -11,18 +11,19 @@
   },
   "repository": {
     "type": "git",
-    "url": "https://github.com/nestjs/nest"
+    "url": "https://github.com/nestjs/nest.git",
+    "directory": "packages/platform-ws"
   },
   "publishConfig": {
     "access": "public"
   },
   "dependencies": {
-    "tslib": "2.3.1",
-    "ws": "7.5.6"
+    "tslib": "2.7.0",
+    "ws": "8.18.0"
   },
   "peerDependencies": {
-    "@nestjs/common": "^8.0.0",
-    "@nestjs/websockets": "^8.0.0",
+    "@nestjs/common": "^10.0.0",
+    "@nestjs/websockets": "^10.0.0",
     "rxjs": "^7.1.0"
   }
 }
diff --git a/packages/platform-ws/tsconfig.build.json b/packages/platform-ws/tsconfig.build.json
new file mode 100644
index 000000000..b9ccddc22
--- /dev/null
+++ b/packages/platform-ws/tsconfig.build.json
@@ -0,0 +1,22 @@
+{
+  "extends": "../tsconfig.build.json",
+  "compilerOptions": {
+    "outDir": ".",
+    "rootDir": ".",
+    "paths": {
+      "@nestjs/common": ["../common"],
+      "@nestjs/common/*": ["../common/*"],
+      "@nestjs/websockets": ["../websockets"],
+      "@nestjs/websockets/*": ["../websockets/*"]
+    }
+  },
+  "exclude": ["node_modules", "dist", "test/**/*", "*.spec.ts"],
+  "references": [
+    {
+      "path": "../common/tsconfig.build.json"
+    },
+    {
+      "path": "../websockets/tsconfig.build.json"
+    }
+  ]
+}
diff --git a/packages/platform-ws/tsconfig.json b/packages/platform-ws/tsconfig.json
index b238080a4..2ae9e3c90 100644
--- a/packages/platform-ws/tsconfig.json
+++ b/packages/platform-ws/tsconfig.json
@@ -1,7 +1,13 @@
 {
-  "extends": "./../tsconfig.base.json",
+  "extends": "../tsconfig.build.json",
   "compilerOptions": {
-    "baseUrl": "./"
+    "types": ["node"]
   },
-  "include": ["*.ts", "**/*.ts"]
+  "files": [],
+  "include": [],
+  "references": [
+    {
+      "path": "./tsconfig.build.json"
+    }
+  ]
 }
diff --git a/packages/testing/CHANGELOG.md b/packages/testing/CHANGELOG.md
deleted file mode 100644
index fca1fb6df..000000000
--- a/packages/testing/CHANGELOG.md
+++ /dev/null
@@ -1,12 +0,0 @@
-# Change Log
-
-All notable changes to this project will be documented in this file.
-See [Conventional Commits](https://conventionalcommits.org) for commit guidelines.
-
-<a name="8.2.0"></a>
-# [8.2.0](https://github.com/nestjs/nest/compare/v8.1.2...v8.2.0) (2021-11-08)
-
-
-
-
-**Note:** Version bump only for package @nestjs/testing
diff --git a/packages/testing/Readme.md b/packages/testing/Readme.md
index 85a8c2535..4cac0d5ea 100644
--- a/packages/testing/Readme.md
+++ b/packages/testing/Readme.md
@@ -1,17 +1,16 @@
 <p align="center">
-  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
+  <a href="https://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
 </p>
 
 [circleci-image]: https://img.shields.io/circleci/build/github/nestjs/nest/master?token=abc123def456
 [circleci-url]: https://circleci.com/gh/nestjs/nest
 
-  <p align="center">A progressive <a href="http://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>
+  <p align="center">A progressive <a href="https://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>
     <p align="center">
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/v/@nestjs/core.svg" alt="NPM Version" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
 <a href="https://circleci.com/gh/nestjs/nest" target="_blank"><img src="https://img.shields.io/circleci/build/github/nestjs/nest/master" alt="CircleCI" /></a>
-<a href="https://coveralls.io/github/nestjs/nest?branch=master" target="_blank"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#9" alt="Coverage" /></a>
 <a href="https://discord.gg/G7Qnnhy" target="_blank"><img src="https://img.shields.io/badge/discord-online-brightgreen.svg" alt="Discord"/></a>
 <a href="https://opencollective.com/nest#backer" target="_blank"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
 <a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
@@ -24,21 +23,21 @@
 
 ## Description
 
-Nest is a framework for building efficient, scalable <a href="http://nodejs.org" target="_blank">Node.js</a> server-side applications. It uses modern JavaScript, is built with  <a href="http://www.typescriptlang.org" target="_blank">TypeScript</a> (preserves compatibility with pure JavaScript) and combines elements of OOP (Object Oriented Programming), FP (Functional Programming), and FRP (Functional Reactive Programming).
+Nest is a framework for building efficient, scalable <a href="https://nodejs.org" target="_blank">Node.js</a> server-side applications. It uses modern JavaScript, is built with <a href="https://www.typescriptlang.org" target="_blank">TypeScript</a> (preserves compatibility with pure JavaScript) and combines elements of OOP (Object Oriented Programming), FP (Functional Programming), and FRP (Functional Reactive Programming).
 
-<p>Under the hood, Nest makes use of <a href="https://expressjs.com/" target="_blank">Express</a>, but also, provides compatibility with a wide range of other libraries, like e.g. <a href="https://github.com/fastify/fastify" target="_blank">Fastify</a>, allowing for easy use of the myriad third-party plugins which are available.</p>
+<p>Under the hood, Nest makes use of <a href="https://expressjs.com/" target="_blank">Express</a>, but also provides compatibility with a wide range of other libraries, like <a href="https://github.com/fastify/fastify" target="_blank">Fastify</a>, allowing for easy use of the myriad of third-party plugins which are available.</p>
 
 ## Philosophy
 
-<p>In recent years, thanks to Node.js, JavaScript has become the ‚Äúlingua franca‚Äù of the web for both front and backend applications, giving rise to awesome projects like <a href="https://angular.io/" target="_blank">Angular</a>, <a href="https://github.com/facebook/react" target="_blank">React</a> and <a href="https://github.com/vuejs/vue" target="_blank">Vue</a> which improve developer productivity and enable the construction of fast, testable, extensible frontend applications. However, on the server-side, while there are a lot of superb libraries, helpers and tools for Node, none of them effectively solve the main problem - the architecture.</p>
-<p>Nest aims to provide an application architecture out of the box which allows for effortless creation of highly testable, scalable, loosely coupled and easily maintainable applications. The architecture is heavily inspired by Angular.</p>
+<p>In recent years, thanks to Node.js, JavaScript has become the ‚Äúlingua franca‚Äù of the web for both front and backend applications, giving rise to awesome projects like <a href="https://angular.io/" target="_blank">Angular</a>, <a href="https://github.com/facebook/react" target="_blank">React</a>, and <a href="https://github.com/vuejs/vue" target="_blank">Vue</a>, which improve developer productivity and enable the construction of fast, testable, and extensible frontend applications. However, on the server-side, while there are a lot of superb libraries, helpers, and tools for Node, none of them effectively solve the main problem - the architecture.</p>
+<p>Nest aims to provide an application architecture out of the box which allows for effortless creation of highly testable, scalable, and loosely coupled and easily maintainable applications. The architecture is heavily inspired by Angular.</p>
 
 ## Getting started
 
-* To check out the [guide](https://docs.nestjs.com), visit [docs.nestjs.com](https://docs.nestjs.com). :books:
-* Ë¶ÅÊü•Áúã‰∏≠Êñá [ÊåáÂçó](readme_zh.md), ËØ∑ËÆøÈóÆ [docs.nestjs.cn](https://docs.nestjs.cn). :books:
-* [Í∞ÄÏù¥Îìú](readme_kr.md)Î•º ÌôïÏù∏ÌïòÎ†§Î©¥, [docs.nestjs.com](https://docs.nestjs.com)Î•º Î∞©Î¨∏ÌïòÏÑ∏Ïöî.:books: 
-* „ÉÅ„Çß„ÉÉ„ÇØ„Åô„Çã„Å´„ÅØ [„Ç¨„Ç§„Éâ](readme_jp.md), Ë©≥„Åó„Åè„ÅØ [docs.nestjs.com](https://docs.nestjs.com). :books: 
+- To check out the [guide](https://docs.nestjs.com), visit [docs.nestjs.com](https://docs.nestjs.com). :books:
+- Ë¶ÅÊü•Áúã‰∏≠Êñá [ÊåáÂçó](readme_zh.md), ËØ∑ËÆøÈóÆ [docs.nestjs.cn](https://docs.nestjs.cn). :books:
+- [Í∞ÄÏù¥Îìú](readme_kr.md) Î¨∏ÏÑúÎäî [docs.nestjs.com](https://docs.nestjs.com)ÏóêÏÑú ÌôïÏù∏ÌïòÏã§ Ïàò ÏûàÏäµÎãàÎã§. :books:
+- [„Ç¨„Ç§„Éâ](readme_jp.md)„ÅØ [docs.nestjs.com](https://docs.nestjs.com)„Åß„ÅîÁ¢∫Ë™ç„Åè„Å†„Åï„ÅÑ„ÄÇ :books:
 
 ## Questions
 
@@ -54,71 +53,88 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
-<table style="text-align:center;"><tr>
-  <td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
-  <td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/red-hat-logo.svg" width="200" valign="middle" /></a></td>
-<td>
-<a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
-<td>
-<a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
-</tr></table>
+
+<table style="text-align:center;">
+<tr>
+<td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
+<td><a href="https://microsoft.com/" target="_blank"><img src="https://nestjs.com/img/logos/microsoft-logo.png" width="180" valign="middle" /></a></td>
+<td><a href="https://mojam.co" target="_blank"><img src="https://nestjs.com/img/logos/mojam-logo.png" width="80" valign="middle" /></a></td>
+<td><a href="https://marblism.com?utm_source=nest" target="_blank"><img src="https://nestjs.com/img/logos/marblism-logo.png" width="180" valign="middle" /></a></td>
+<td><a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
+<td><a href="https://amplication.com/" target="_blank"><img src="https://nestjs.com/img/logos/amplication-logo.svg" width="190" valign="middle" /></a></td>
+</tr>
+</table>
 
 #### Gold Sponsors
 
-<table style="text-align:center;"><tr><td>
-  <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
-  <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
-<td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
+<table style="text-align:center;">
+<tr>
+<td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/logos/red-hat-logo.svg" width="200" valign="middle" /></a></td>
+<td><a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
+<td><a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/logos/nx-logo.png" height="45" valign="middle" /></a></td>
+<td><a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/logos/intrinisic-logo.png" width="210" valign="middle" /></a></td>
+<td><a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/logos/jetbrains-logo.svg" width="90" valign="middle" /></a></td>
+</tr>
+<tr>
+<td><a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/logos/snyk-logo-black.png" width="185" valign="middle" /></a></td>
+<td><a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/logos/fuse-logo.svg" width="105" valign="middle" /></a></td>
+<td><a href="https://ridicorp.com/career/" target="_blank"><img src="https://nestjs.com/img/logos/ridi-logo.svg" width="105" valign="middle" /></a></td>
+<td><a href="https://www.movavi.com/imovie-for-windows.html" target="_blank"><img src="https://nestjs.com/img/logos/movavi-logo.svg" width="105" valign="middle" /></a></td>
+<td><a href="https://skunk.team" target="_blank"><img src="https://nestjs.com/img/logos/skunk-logo.png" height="60" valign="middle" /></a></td>
+</tr>
+</table>
 
 #### Silver Sponsors
 
-<table style="text-align:center;"><tr><td>
-<a href="https://neoteric.eu/" target="_blank"><img src="https://nestjs.com/img/neoteric-cut.png" width="120" valign="middle" /></a> </td><td>
-  <a href="http://gojob.com" target="_blank"><img src="http://nestjs.com/img/gojob-logo.png" valign="middle" width="100" /></a> </td><td>
-<a href="https://www.myleodsc.com/" target="_blank"><img src="https://nestjs.com/img/myleo-logo.png" width="180" valign="middle" /></td><td>
-<a href="https://careers.meetdandy.com/?gh_src=063ba61e3us" target="_blank"><img src="https://nestjs.com/img/dandy-roles-logo.svg" width="150" valign="middle" /></td><td>
-<a href="https://www.castlecraft.in" target="_blank"><img src="https://nestjs.com/img/castlecraft-logo.png" width="150" valign="middle" /></td>
-<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td></tr></table>
+<table style="text-align:center;">
+<tr>
+<td><a href="https://www.mercedes-benz.com/" target="_blank"><img src="https://nestjs.com/img/logos/mercedes-logo.png" width="100" valign="middle" /></a></td>
+<td><a href="https://www.dinii.jp/" target="_blank"><img src="https://nestjs.com/img/logos/dinii-logo.png" width="65" valign="middle" /></a></td>
+<td><a href="https://bloodycase.com/?promocode=NEST" target="_blank"><img src="https://nestjs.com/img/logos/bloodycase-logo.png" width="65" valign="middle" /></a></td>
+<td><a href="https://handsontable.com/docs/react-data-grid/?utm_source=NestJS_GH&utm_medium=sponsorship&utm_campaign=library_sponsorship_2024" target="_blank"><img src="https://nestjs.com/img/logos/handsontable-dark-logo.svg#2" width="150" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.itflashcards.com/" target="_blank"><img src="https://nestjs.com/img/logos/it_flashcards-logo.png" width="170" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://arcjet.com/?ref=nestjs" target="_blank"><img src="https://nestjs.com/img/logos/arcjet-logo.svg" width="170" valign="middle" /></a></td>
+</tr>
+</table>
 
 #### Sponsors
 
-<table><tr><td align="center" valign="middle">
-<a href="https://www.swingdev.io" target="_blank"><img src="https://nestjs.com/img/swingdev-logo.svg#1" width="110" valign="middle" /> </a></td><td align="center" valign="middle">
-<a href="https://www.novologic.com/" target="_blank"><img src="https://nestjs.com/img/novologic.png" width="110" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://ever.co/" target="_blank"><img src="https://nestjs.com/img/ever-logo.png" width="72" valign="middle" /></a>  </td><td align="center" valign="middle">
-<a href="https://blokt.com" target="_blank"><img src="https://nestjs.com/img/blokt-logo.png" width="120" valign="middle" /></a>  </td><td align="center" valign="middle"> 
-  <a href="http://architectnow.net/" target="_blank"><img src="https://nestjs.com/img/architectnow.png" width="125" valign="middle" /></a> </td><td align="center" valign="middle">
-  <a href="https://quander.io/" target="_blank"><img src="https://nestjs.com/img/quander.png" width="100" valign="middle" /></a> </td></tr><tr><td align="center" valign="middle">
-  <a href="https://mantro.net/" target="_blank"><img src="https://nestjs.com/img/mantro-logo.svg" width="95" valign="middle" /></a> </td><td align="center" valign="middle">
-  <a href="https://triplebyte.com/" target="_blank"><img src="https://nestjs.com/img/triplebyte.png" width="107" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://reposit.co.uk/" target="_blank"><img src="https://nestjs.com/img/reposit-logo.png" width="71" valign="middle" /></a></td><td align="center" valign="middle">
-<a href="https://nearpod.com/" target="_blank"><img src="https://nestjs.com/img/nearpod-logo.svg" width="100" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://clay.global/" target="_blank"><img src="https://nestjs.com/img/clay-logo.svg" width="75" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://firesticktricks.com" target="_blank"><img src="https://nestjs.com/img/firesticktricks-logo.png" width="120" valign="middle" /></a></td></tr><tr><td align="center" valign="middle">
-<a href="https://www.codeguesser.co.uk" target="_blank"><img src="https://nestjs.com/img/codeguesser-logo.svg" width="120" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://f-a.nz/" target="_blank"><img src="https://nestjs.com/img/franz.svg" width="80" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://sparkfabrik.com/" target="_blank"><img src="https://nestjs.com/img/sparkfabrik-logo.png" width="120" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://www.thebigphonestore.co.uk/" target="_blank"><img src="https://nestjs.com/img/the-big-phone-store-logo.png" width="65" valign="middle" /></a></td>
-  <td align="center" valign="middle">
-  <a href="https://genuinebee.com/" target="_blank"><img src="https://nestjs.com/img/genuinebee.svg" width="97" valign="middle" /></a> </td>
-<td align="center" valign="middle"><a href="https://sanyodigital.com/" target="_blank"><img src="https://nestjs.com/img/sanyo-digital.png" width="130" valign="middle" /></a></td></tr><tr><td align="center" valign="middle"><a href="https://vpn-review.com/vpn-for-torrenting" target="_blank"><img src="https://nestjs.com/img/vpn-review-logo.png" width="85" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://lambda-it.ch/" target="_blank"><img src="https://nestjs.com/img/lambda-it-logo.svg" width="115" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://pickwriters.com/top-10-translation-services" target="_blank"><img src="https://nestjs.com/img/pickwriters-logo.png" width="40" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://thewordpoint.com/services/localization" target="_blank"><img src="https://nestjs.com/img/thewordpoint-logo.png" width="40" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://meercode.io/" target="_blank"><img src="https://nestjs.com/img/meercode-logo.png" width="60" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://www.najlepszeplatformyforex.pl/blog/broker-xtb/" target="_blank"><img src="https://nestjs.com/img/npf-logo.jpg" width="200" valign="middle" /></a></td></tr><tr>
-<td align="center" valign="middle"><a href="https://thestandarddaily.com/" target="_blank"><img src="https://nestjs.com/img/the-standard-daily-logo.png" width="180" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://houseofangular.io/" target="_blank"><img src="https://nestjs.com/img/house-of-angular.png" width="100" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://rocketech.it/cases/?utm_source=google&utm_medium=badge&utm_campaign=nestjs" target="_blank"><img src="https://nestjs.com/img/rocketech-logo.svg" width="110" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://www.bystored.com/" target="_blank"><img src="https://nestjs.com/img/stored-logo.svg" width="110" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://studyclerk.com/pay-for-research-paper" target="_blank"><img src="https://nestjs.com/img/studyclerk-logo.png" width="125" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://xyndata.com" target="_blank"><img src="https://nestjs.com/img/xyndata-logo.png" width="125" valign="middle" /></a></td></tr><tr>
-  <td align="center" valign="middle"><a href="https://www.anonymistic.com/" target="_blank"><img src="https://nestjs.com/img/anonymistic-logo.png" width="125" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/naologic-logo.svg" width="125" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://messaged.com/" target="_blank"><img src="https://nestjs.com/img/messaged-logo.png" width="50" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/triplecore-logo.svg" width="50" valign="middle" /></a></td>
-  </tr></table>
+<table>
+<tr>
+<td align="center" valign="middle"><a href="https://www.swingdev.io" target="_blank"><img src="https://nestjs.com/img/logos/swingdev-logo.svg#1" width="110" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.novologic.com/" target="_blank"><img src="https://nestjs.com/img/logos/novologic.png" width="110" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://mantro.net/" target="_blank"><img src="https://nestjs.com/img/logos/mantro-logo.svg" width="95" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://triplebyte.com/" target="_blank"><img src="https://nestjs.com/img/logos/triplebyte.png" width="107" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://nearpod.com/" target="_blank"><img src="https://nestjs.com/img/logos/nearpod-logo.svg" width="100" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://genuinebee.com/" target="_blank"><img src="https://nestjs.com/img/logos/genuinebee.svg" width="97" valign="middle" /></a></td>
+</tr>
+<tr>
+<td align="center" valign="middle"><a href="https://vpn-review.com/vpn-for-torrenting" target="_blank"><img src="https://nestjs.com/img/logos/vpn-review-logo.png" width="85" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://lambda-it.ch/" target="_blank"><img src="https://nestjs.com/img/logos/lambda-it-logo.svg" width="115" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://rocketech.it/cases/?utm_source=google&utm_medium=badge&utm_campaign=nestjs" target="_blank"><img src="https://nestjs.com/img/logos/rocketech-logo.svg" width="110" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.anonymistic.com/" target="_blank"><img src="https://nestjs.com/img/logos/anonymistic-logo.png" width="125" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/logos/naologic-logo.svg" width="125" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/logos/triplecore-logo.svg" width="50" valign="middle" /></a></td>
+</tr>
+<tr>
+<td align="center" valign="middle"><a href="https://thecasinowizard.com/bonuses/no-deposit-bonuses/" target="_blank"><img src="https://nestjs.com/img/logos/casinowizard-logo.png" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://polygon-software.ch/" target="_blank"><img src="https://nestjs.com/img/logos/polygon-logo.svg" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/logos/boringowl-logo.svg" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://nordbot.app/" target="_blank"><img src="https://nestjs.com/img/logos/nordbot-logo.png" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://doppio.sh/" target="_blank"><img src="https://nestjs.com/img/logos/dopiosh-logo.png" width="50" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.hingehealth.com/" target="_blank"><img src="https://nestjs.com/img/logos/hinge-health-logo.svg" width="100" valign="middle" /></a></td>
+</tr>
+<tr>
+<td align="center" valign="middle"><a href="https://julienferand.dev/" target="_blank"><img src="https://nestjs.com/img/logos/julienferand-logo.jpeg" width="55" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.tripoffice.com/" target="_blank"><img src="https://nestjs.com/img/logos/tripoffice-logo.png" width="140" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://solcellsforetag.se/" target="_blank"><img src="https://nestjs.com/img/logos/solcellsforetag-logo.svg" width="140" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.route4me.com/" target="_blank"><img src="https://nestjs.com/img/logos/route4me-logo.svg" width="100" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.slotsup.com/" target="_blank"><img src="https://nestjs.com/img/logos/slotsup-logo.png" width="60" valign="middle" /></a></td>
+</tr>
+</table>
 
 ## Backers
 
@@ -126,9 +142,9 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 
 ## Stay in touch
 
-* Author - [Kamil My≈õliwiec](https://twitter.com/kammysliwiec)
-* Website - [https://nestjs.com](https://nestjs.com/)
-* Twitter - [@nestframework](https://twitter.com/nestframework)
+- Author - [Kamil My≈õliwiec](https://x.com/kammysliwiec)
+- Website - [https://nestjs.com](https://nestjs.com/)
+- X - [@nestframework](https://x.com/nestframework)
 
 ## License
 
diff --git a/packages/testing/index.ts b/packages/testing/index.ts
index c68ed76f1..d760d09f7 100644
--- a/packages/testing/index.ts
+++ b/packages/testing/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @testing
- * Copyright(c) 2017 - 2021 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2023 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
diff --git a/packages/testing/interfaces/mock-factory.ts b/packages/testing/interfaces/mock-factory.ts
index 6dc400fb1..0b67435ea 100644
--- a/packages/testing/interfaces/mock-factory.ts
+++ b/packages/testing/interfaces/mock-factory.ts
@@ -1,3 +1,3 @@
-import { InstanceToken } from '@nestjs/core/injector/module';
+import { InjectionToken } from '@nestjs/common';
 
-export type MockFactory = (token?: InstanceToken) => any;
+export type MockFactory = (token?: InjectionToken) => any;
diff --git a/packages/testing/interfaces/override-by-factory-options.interface.ts b/packages/testing/interfaces/override-by-factory-options.interface.ts
index 59a78d657..a2d58ec91 100644
--- a/packages/testing/interfaces/override-by-factory-options.interface.ts
+++ b/packages/testing/interfaces/override-by-factory-options.interface.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export interface OverrideByFactoryOptions {
   factory: (...args: any[]) => any;
   inject?: any[];
diff --git a/packages/testing/interfaces/override-by.interface.ts b/packages/testing/interfaces/override-by.interface.ts
index 25fc60a95..fafc82e46 100644
--- a/packages/testing/interfaces/override-by.interface.ts
+++ b/packages/testing/interfaces/override-by.interface.ts
@@ -1,6 +1,9 @@
 import { TestingModuleBuilder } from '../testing-module.builder';
 import { OverrideByFactoryOptions } from './override-by-factory-options.interface';
 
+/**
+ * @publicApi
+ */
 export interface OverrideBy {
   useValue: (value: any) => TestingModuleBuilder;
   useFactory: (options: OverrideByFactoryOptions) => TestingModuleBuilder;
diff --git a/packages/testing/interfaces/override-module.interface.ts b/packages/testing/interfaces/override-module.interface.ts
new file mode 100644
index 000000000..1bebdd4ac
--- /dev/null
+++ b/packages/testing/interfaces/override-module.interface.ts
@@ -0,0 +1,9 @@
+import { ModuleDefinition } from '@nestjs/core/interfaces/module-definition.interface';
+import { TestingModuleBuilder } from '../testing-module.builder';
+
+/**
+ * @publicApi
+ */
+export interface OverrideModule {
+  useModule: (newModule: ModuleDefinition) => TestingModuleBuilder;
+}
diff --git a/packages/testing/package.json b/packages/testing/package.json
index d59c79716..ee67b048f 100644
--- a/packages/testing/package.json
+++ b/packages/testing/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/testing",
-  "version": "8.2.5",
+  "version": "10.4.11",
   "description": "Nest - modern, fast, powerful node.js web framework (@testing)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -11,20 +11,20 @@
   },
   "repository": {
     "type": "git",
-    "url": "https://github.com/nestjs/nest"
+    "url": "https://github.com/nestjs/nest.git",
+    "directory": "packages/testing"
   },
   "publishConfig": {
     "access": "public"
   },
   "dependencies": {
-    "optional": "0.1.4",
-    "tslib": "2.3.1"
+    "tslib": "2.7.0"
   },
   "peerDependencies": {
-    "@nestjs/common": "^8.0.0",
-    "@nestjs/core": "^8.0.0",
-    "@nestjs/microservices": "^8.0.0",
-    "@nestjs/platform-express": "^8.0.0"
+    "@nestjs/common": "^10.0.0",
+    "@nestjs/core": "^10.0.0",
+    "@nestjs/microservices": "^10.0.0",
+    "@nestjs/platform-express": "^10.0.0"
   },
   "peerDependenciesMeta": {
     "@nestjs/microservices": {
diff --git a/packages/testing/services/testing-logger.service.ts b/packages/testing/services/testing-logger.service.ts
index 1e7b44b2a..a1ca5d107 100644
--- a/packages/testing/services/testing-logger.service.ts
+++ b/packages/testing/services/testing-logger.service.ts
@@ -1,7 +1,8 @@
-/* eslint-disable @typescript-eslint/no-empty-function */
-/* eslint-disable @typescript-eslint/no-unused-vars */
 import { ConsoleLogger } from '@nestjs/common';
 
+/**
+ * @publicApi
+ */
 export class TestingLogger extends ConsoleLogger {
   constructor() {
     super('Testing');
diff --git a/packages/testing/testing-injector.ts b/packages/testing/testing-injector.ts
index 417ef295c..3ece834be 100644
--- a/packages/testing/testing-injector.ts
+++ b/packages/testing/testing-injector.ts
@@ -8,6 +8,9 @@ import { InstanceWrapper } from '@nestjs/core/injector/instance-wrapper';
 import { Module } from '@nestjs/core/injector/module';
 import { MockFactory } from './interfaces';
 
+/**
+ * @publicApi
+ */
 export class TestingInjector extends Injector {
   protected mocker?: MockFactory;
   protected container: NestContainer;
@@ -56,6 +59,12 @@ export class TestingInjector extends Injector {
           metatype: wrapper.metatype,
         });
         const internalCoreModule = this.container.getInternalCoreModuleRef();
+        if (!internalCoreModule) {
+          throw new Error(
+            'Expected to have internal core module reference at this point.',
+          );
+        }
+
         internalCoreModule.addCustomProvider(
           {
             provide: name,
diff --git a/packages/testing/testing-instance-loader.ts b/packages/testing/testing-instance-loader.ts
index e11062210..6c4aead48 100644
--- a/packages/testing/testing-instance-loader.ts
+++ b/packages/testing/testing-instance-loader.ts
@@ -3,9 +3,7 @@ import { Module } from '@nestjs/core/injector/module';
 import { MockFactory } from './interfaces';
 import { TestingInjector } from './testing-injector';
 
-export class TestingInstanceLoader extends InstanceLoader {
-  protected injector = new TestingInjector();
-
+export class TestingInstanceLoader extends InstanceLoader<TestingInjector> {
   public async createInstancesOfDependencies(
     modules: Map<string, Module> = this.container.getModules(),
     mocker?: MockFactory,
diff --git a/packages/testing/testing-module.builder.ts b/packages/testing/testing-module.builder.ts
index e72f67785..6fd4443b4 100644
--- a/packages/testing/testing-module.builder.ts
+++ b/packages/testing/testing-module.builder.ts
@@ -1,7 +1,15 @@
-import { Logger, LoggerService, Module } from '@nestjs/common';
-import { ModuleMetadata } from '@nestjs/common/interfaces';
+import { Logger, LoggerService, Module, ModuleMetadata } from '@nestjs/common';
+import { NestApplicationContextOptions } from '@nestjs/common/interfaces/nest-application-context-options.interface';
 import { ApplicationConfig } from '@nestjs/core/application-config';
 import { NestContainer } from '@nestjs/core/injector/container';
+import { GraphInspector } from '@nestjs/core/inspector/graph-inspector';
+import { NoopGraphInspector } from '@nestjs/core/inspector/noop-graph-inspector';
+import {
+  UuidFactory,
+  UuidFactoryMode,
+} from '@nestjs/core/inspector/uuid-factory';
+import { ModuleDefinition } from '@nestjs/core/interfaces/module-definition.interface';
+import { ModuleOverride } from '@nestjs/core/interfaces/module-override.interface';
 import { MetadataScanner } from '@nestjs/core/metadata-scanner';
 import { DependenciesScanner } from '@nestjs/core/scanner';
 import {
@@ -9,26 +17,31 @@ import {
   OverrideBy,
   OverrideByFactoryOptions,
 } from './interfaces';
+import { OverrideModule } from './interfaces/override-module.interface';
 import { TestingLogger } from './services/testing-logger.service';
+import { TestingInjector } from './testing-injector';
 import { TestingInstanceLoader } from './testing-instance-loader';
 import { TestingModule } from './testing-module';
 
+/**
+ * @publicApi
+ */
 export class TestingModuleBuilder {
   private readonly applicationConfig = new ApplicationConfig();
   private readonly container = new NestContainer(this.applicationConfig);
   private readonly overloadsMap = new Map();
-  private readonly scanner: DependenciesScanner;
-  private readonly instanceLoader = new TestingInstanceLoader(this.container);
+  private readonly moduleOverloadsMap = new Map<
+    ModuleDefinition,
+    ModuleDefinition
+  >();
   private readonly module: any;
   private testingLogger: LoggerService;
   private mocker?: MockFactory;
 
-  constructor(metadataScanner: MetadataScanner, metadata: ModuleMetadata) {
-    this.scanner = new DependenciesScanner(
-      this.container,
-      metadataScanner,
-      this.applicationConfig,
-    );
+  constructor(
+    private readonly metadataScanner: MetadataScanner,
+    metadata: ModuleMetadata,
+  ) {
     this.module = this.createModule(metadata);
   }
 
@@ -62,19 +75,50 @@ export class TestingModuleBuilder {
     return this.override(typeOrToken, true);
   }
 
-  public async compile(): Promise<TestingModule> {
+  public overrideModule(moduleToOverride: ModuleDefinition): OverrideModule {
+    return {
+      useModule: newModule => {
+        this.moduleOverloadsMap.set(moduleToOverride, newModule);
+        return this;
+      },
+    };
+  }
+
+  public async compile(
+    options: Pick<NestApplicationContextOptions, 'snapshot' | 'preview'> = {},
+  ): Promise<TestingModule> {
     this.applyLogger();
-    await this.scanner.scan(this.module);
 
-    this.applyOverloadsMap();
-    await this.instanceLoader.createInstancesOfDependencies(
-      this.container.getModules(),
-      this.mocker,
+    let graphInspector: GraphInspector;
+    if (options?.snapshot) {
+      graphInspector = new GraphInspector(this.container);
+      UuidFactory.mode = UuidFactoryMode.Deterministic;
+    } else {
+      graphInspector = NoopGraphInspector;
+      UuidFactory.mode = UuidFactoryMode.Random;
+    }
+
+    const scanner = new DependenciesScanner(
+      this.container,
+      this.metadataScanner,
+      graphInspector,
+      this.applicationConfig,
     );
-    this.scanner.applyApplicationProviders();
+    await scanner.scan(this.module, {
+      overrides: this.getModuleOverloads(),
+    });
+
+    this.applyOverloadsMap();
+    await this.createInstancesOfDependencies(graphInspector, options);
+    scanner.applyApplicationProviders();
 
     const root = this.getRootModule();
-    return new TestingModule(this.container, [], root, this.applicationConfig);
+    return new TestingModule(
+      this.container,
+      graphInspector,
+      root,
+      this.applicationConfig,
+    );
   }
 
   private override<T = any>(typeOrToken: T, isProvider: boolean): OverrideBy {
@@ -100,14 +144,41 @@ export class TestingModuleBuilder {
   }
 
   private applyOverloadsMap() {
-    [...this.overloadsMap.entries()].forEach(([item, options]) => {
+    const overloads = [...this.overloadsMap.entries()];
+    overloads.forEach(([item, options]) => {
       this.container.replace(item, options);
     });
   }
 
+  private getModuleOverloads(): ModuleOverride[] {
+    const overloads = [...this.moduleOverloadsMap.entries()];
+    return overloads.map(([moduleToReplace, newModule]) => ({
+      moduleToReplace,
+      newModule,
+    }));
+  }
+
   private getRootModule() {
     const modules = this.container.getModules().values();
-    return modules.next().value;
+    return modules.next().value!;
+  }
+
+  private async createInstancesOfDependencies(
+    graphInspector: GraphInspector,
+    options: { preview?: boolean },
+  ) {
+    const injector = new TestingInjector({
+      preview: options?.preview ?? false,
+    });
+    const instanceLoader = new TestingInstanceLoader(
+      this.container,
+      injector,
+      graphInspector,
+    );
+    await instanceLoader.createInstancesOfDependencies(
+      this.container.getModules(),
+      this.mocker,
+    );
   }
 
   private createModule(metadata: ModuleMetadata) {
diff --git a/packages/testing/testing-module.ts b/packages/testing/testing-module.ts
index d1e15acd6..79d2e86c3 100644
--- a/packages/testing/testing-module.ts
+++ b/packages/testing/testing-module.ts
@@ -9,6 +9,7 @@ import {
 import { NestMicroserviceOptions } from '@nestjs/common/interfaces/microservices/nest-microservice-options.interface';
 import { NestApplicationContextOptions } from '@nestjs/common/interfaces/nest-application-context-options.interface';
 import { loadPackage } from '@nestjs/common/utils/load-package.util';
+import { isUndefined } from '@nestjs/common/utils/shared.utils';
 import {
   AbstractHttpAdapter,
   NestApplication,
@@ -17,31 +18,65 @@ import {
 import { ApplicationConfig } from '@nestjs/core/application-config';
 import { NestContainer } from '@nestjs/core/injector/container';
 import { Module } from '@nestjs/core/injector/module';
+import { GraphInspector } from '@nestjs/core/inspector/graph-inspector';
 
+/**
+ * @publicApi
+ */
 export class TestingModule extends NestApplicationContext {
+  protected readonly graphInspector: GraphInspector;
+
   constructor(
     container: NestContainer,
-    scope: Type<any>[],
+    graphInspector: GraphInspector,
     contextModule: Module,
     private readonly applicationConfig: ApplicationConfig,
+    scope: Type<any>[] = [],
   ) {
-    super(container, scope, contextModule);
+    const options = {};
+    super(container, options, contextModule, scope);
+
+    this.graphInspector = graphInspector;
   }
 
+  private isHttpServer(
+    serverOrOptions:
+      | HttpServer
+      | AbstractHttpAdapter
+      | NestApplicationOptions
+      | undefined,
+  ): serverOrOptions is HttpServer | AbstractHttpAdapter {
+    return !!(serverOrOptions && (serverOrOptions as HttpServer).patch);
+  }
+
+  public createNestApplication<T extends INestApplication = INestApplication>(
+    httpAdapter: HttpServer | AbstractHttpAdapter,
+    options?: NestApplicationOptions,
+  ): T;
+  public createNestApplication<T extends INestApplication = INestApplication>(
+    options?: NestApplicationOptions,
+  ): T;
   public createNestApplication<T extends INestApplication = INestApplication>(
-    httpAdapter?: HttpServer | AbstractHttpAdapter,
+    serverOrOptions:
+      | HttpServer
+      | AbstractHttpAdapter
+      | NestApplicationOptions
+      | undefined,
     options?: NestApplicationOptions,
   ): T {
-    httpAdapter = httpAdapter || this.createHttpAdapter();
+    const [httpAdapter, appOptions] = this.isHttpServer(serverOrOptions)
+      ? [serverOrOptions, options]
+      : [this.createHttpAdapter(), serverOrOptions];
 
-    this.applyLogger(options);
+    this.applyLogger(appOptions);
     this.container.setHttpAdapter(httpAdapter);
 
     const instance = new NestApplication(
       this.container,
       httpAdapter,
       this.applicationConfig,
-      options,
+      this.graphInspector,
+      appOptions,
     );
     return this.createAdapterProxy<T>(instance, httpAdapter);
   }
@@ -58,6 +93,7 @@ export class TestingModule extends NestApplicationContext {
     return new NestMicroservice(
       this.container,
       options,
+      this.graphInspector,
       this.applicationConfig,
     );
   }
@@ -72,7 +108,7 @@ export class TestingModule extends NestApplicationContext {
   }
 
   private applyLogger(options: NestApplicationContextOptions | undefined) {
-    if (!options || !options.logger) {
+    if (!options || isUndefined(options.logger)) {
       return;
     }
     Logger.overrideLogger(options.logger);
diff --git a/packages/testing/tsconfig.build.json b/packages/testing/tsconfig.build.json
new file mode 100644
index 000000000..a5a3a6305
--- /dev/null
+++ b/packages/testing/tsconfig.build.json
@@ -0,0 +1,32 @@
+{
+  "extends": "../tsconfig.build.json",
+  "compilerOptions": {
+    "outDir": ".",
+    "rootDir": ".",
+    "paths": {
+      "@nestjs/common": ["../common"],
+      "@nestjs/common/*": ["../common/*"],
+      "@nestjs/core": ["../core"],
+      "@nestjs/core/*": ["../core/*"],
+      "@nestjs/microservices": ["../microservices"],
+      "@nestjs/microservices/*": ["../microservices/*"],
+      "@nestjs/platform-express": ["../platform-express"],
+      "@nestjs/platform-express/*": ["../platform-express/*"]
+    }
+  },
+  "exclude": ["node_modules", "dist", "test/**/*", "*.spec.ts"],
+  "references": [
+    {
+      "path": "../common/tsconfig.build.json"
+    },
+    {
+      "path": "../core/tsconfig.build.json"
+    },
+    {
+      "path": "../microservices/tsconfig.build.json"
+    },
+    {
+      "path": "../platform-express/tsconfig.build.json"
+    }
+  ]
+}
diff --git a/packages/testing/tsconfig.json b/packages/testing/tsconfig.json
index b238080a4..2ae9e3c90 100644
--- a/packages/testing/tsconfig.json
+++ b/packages/testing/tsconfig.json
@@ -1,7 +1,13 @@
 {
-  "extends": "./../tsconfig.base.json",
+  "extends": "../tsconfig.build.json",
   "compilerOptions": {
-    "baseUrl": "./"
+    "types": ["node"]
   },
-  "include": ["*.ts", "**/*.ts"]
+  "files": [],
+  "include": [],
+  "references": [
+    {
+      "path": "./tsconfig.build.json"
+    }
+  ]
 }
diff --git a/packages/tsconfig.base.json b/packages/tsconfig.build.json
similarity index 65%
rename from packages/tsconfig.base.json
rename to packages/tsconfig.build.json
index ff837eb4f..e1bdb8e40 100644
--- a/packages/tsconfig.base.json
+++ b/packages/tsconfig.build.json
@@ -1,22 +1,24 @@
 {
   "compilerOptions": {
+    "composite": true,
     "module": "commonjs",
     "declaration": true,
     "noImplicitAny": false,
     "skipLibCheck": true,
-    "suppressImplicitAnyIndexErrors": true,
     "noUnusedLocals": false,
     "importHelpers": true,
     "removeComments": false,
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es2017",
+    "useUnknownInCatchVariables": false,
+    "target": "ES2021",
     "sourceMap": false,
     "allowJs": false,
     "strict": true,
-    "strictNullChecks": false,
+    "strictNullChecks": true,
+    "forceConsistentCasingInFileNames": true,
+    "strictPropertyInitialization": false,
     "types": ["node"]
-  },
-  "exclude": ["../node_modules", "./**/*.spec.ts"]
+  }
 }
diff --git a/packages/tsconfig.json b/packages/tsconfig.json
new file mode 100644
index 000000000..b980bbe84
--- /dev/null
+++ b/packages/tsconfig.json
@@ -0,0 +1,32 @@
+{
+  "files": [],
+  "references": [
+    {
+      "path": "./common/tsconfig.build.json"
+    },
+    {
+      "path": "./core/tsconfig.build.json"
+    },
+    {
+      "path": "./microservices/tsconfig.build.json"
+    },
+    {
+      "path": "./platform-express/tsconfig.build.json"
+    },
+    {
+      "path": "./platform-fastify/tsconfig.build.json"
+    },
+    {
+      "path": "./platform-socket.io/tsconfig.build.json"
+    },
+    {
+      "path": "./platform-ws/tsconfig.build.json"
+    },
+    {
+      "path": "./testing/tsconfig.build.json"
+    },
+    {
+      "path": "./websockets/tsconfig.build.json"
+    }
+  ]
+}
diff --git a/packages/websockets/CHANGELOG.md b/packages/websockets/CHANGELOG.md
deleted file mode 100644
index 125af3005..000000000
--- a/packages/websockets/CHANGELOG.md
+++ /dev/null
@@ -1,12 +0,0 @@
-# Change Log
-
-All notable changes to this project will be documented in this file.
-See [Conventional Commits](https://conventionalcommits.org) for commit guidelines.
-
-<a name="8.2.0"></a>
-# [8.2.0](https://github.com/nestjs/nest/compare/v8.1.2...v8.2.0) (2021-11-08)
-
-
-
-
-**Note:** Version bump only for package @nestjs/websockets
diff --git a/packages/websockets/Readme.md b/packages/websockets/Readme.md
index 85a8c2535..4cac0d5ea 100644
--- a/packages/websockets/Readme.md
+++ b/packages/websockets/Readme.md
@@ -1,17 +1,16 @@
 <p align="center">
-  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
+  <a href="https://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
 </p>
 
 [circleci-image]: https://img.shields.io/circleci/build/github/nestjs/nest/master?token=abc123def456
 [circleci-url]: https://circleci.com/gh/nestjs/nest
 
-  <p align="center">A progressive <a href="http://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>
+  <p align="center">A progressive <a href="https://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>
     <p align="center">
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/v/@nestjs/core.svg" alt="NPM Version" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
 <a href="https://circleci.com/gh/nestjs/nest" target="_blank"><img src="https://img.shields.io/circleci/build/github/nestjs/nest/master" alt="CircleCI" /></a>
-<a href="https://coveralls.io/github/nestjs/nest?branch=master" target="_blank"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#9" alt="Coverage" /></a>
 <a href="https://discord.gg/G7Qnnhy" target="_blank"><img src="https://img.shields.io/badge/discord-online-brightgreen.svg" alt="Discord"/></a>
 <a href="https://opencollective.com/nest#backer" target="_blank"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
 <a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
@@ -24,21 +23,21 @@
 
 ## Description
 
-Nest is a framework for building efficient, scalable <a href="http://nodejs.org" target="_blank">Node.js</a> server-side applications. It uses modern JavaScript, is built with  <a href="http://www.typescriptlang.org" target="_blank">TypeScript</a> (preserves compatibility with pure JavaScript) and combines elements of OOP (Object Oriented Programming), FP (Functional Programming), and FRP (Functional Reactive Programming).
+Nest is a framework for building efficient, scalable <a href="https://nodejs.org" target="_blank">Node.js</a> server-side applications. It uses modern JavaScript, is built with <a href="https://www.typescriptlang.org" target="_blank">TypeScript</a> (preserves compatibility with pure JavaScript) and combines elements of OOP (Object Oriented Programming), FP (Functional Programming), and FRP (Functional Reactive Programming).
 
-<p>Under the hood, Nest makes use of <a href="https://expressjs.com/" target="_blank">Express</a>, but also, provides compatibility with a wide range of other libraries, like e.g. <a href="https://github.com/fastify/fastify" target="_blank">Fastify</a>, allowing for easy use of the myriad third-party plugins which are available.</p>
+<p>Under the hood, Nest makes use of <a href="https://expressjs.com/" target="_blank">Express</a>, but also provides compatibility with a wide range of other libraries, like <a href="https://github.com/fastify/fastify" target="_blank">Fastify</a>, allowing for easy use of the myriad of third-party plugins which are available.</p>
 
 ## Philosophy
 
-<p>In recent years, thanks to Node.js, JavaScript has become the ‚Äúlingua franca‚Äù of the web for both front and backend applications, giving rise to awesome projects like <a href="https://angular.io/" target="_blank">Angular</a>, <a href="https://github.com/facebook/react" target="_blank">React</a> and <a href="https://github.com/vuejs/vue" target="_blank">Vue</a> which improve developer productivity and enable the construction of fast, testable, extensible frontend applications. However, on the server-side, while there are a lot of superb libraries, helpers and tools for Node, none of them effectively solve the main problem - the architecture.</p>
-<p>Nest aims to provide an application architecture out of the box which allows for effortless creation of highly testable, scalable, loosely coupled and easily maintainable applications. The architecture is heavily inspired by Angular.</p>
+<p>In recent years, thanks to Node.js, JavaScript has become the ‚Äúlingua franca‚Äù of the web for both front and backend applications, giving rise to awesome projects like <a href="https://angular.io/" target="_blank">Angular</a>, <a href="https://github.com/facebook/react" target="_blank">React</a>, and <a href="https://github.com/vuejs/vue" target="_blank">Vue</a>, which improve developer productivity and enable the construction of fast, testable, and extensible frontend applications. However, on the server-side, while there are a lot of superb libraries, helpers, and tools for Node, none of them effectively solve the main problem - the architecture.</p>
+<p>Nest aims to provide an application architecture out of the box which allows for effortless creation of highly testable, scalable, and loosely coupled and easily maintainable applications. The architecture is heavily inspired by Angular.</p>
 
 ## Getting started
 
-* To check out the [guide](https://docs.nestjs.com), visit [docs.nestjs.com](https://docs.nestjs.com). :books:
-* Ë¶ÅÊü•Áúã‰∏≠Êñá [ÊåáÂçó](readme_zh.md), ËØ∑ËÆøÈóÆ [docs.nestjs.cn](https://docs.nestjs.cn). :books:
-* [Í∞ÄÏù¥Îìú](readme_kr.md)Î•º ÌôïÏù∏ÌïòÎ†§Î©¥, [docs.nestjs.com](https://docs.nestjs.com)Î•º Î∞©Î¨∏ÌïòÏÑ∏Ïöî.:books: 
-* „ÉÅ„Çß„ÉÉ„ÇØ„Åô„Çã„Å´„ÅØ [„Ç¨„Ç§„Éâ](readme_jp.md), Ë©≥„Åó„Åè„ÅØ [docs.nestjs.com](https://docs.nestjs.com). :books: 
+- To check out the [guide](https://docs.nestjs.com), visit [docs.nestjs.com](https://docs.nestjs.com). :books:
+- Ë¶ÅÊü•Áúã‰∏≠Êñá [ÊåáÂçó](readme_zh.md), ËØ∑ËÆøÈóÆ [docs.nestjs.cn](https://docs.nestjs.cn). :books:
+- [Í∞ÄÏù¥Îìú](readme_kr.md) Î¨∏ÏÑúÎäî [docs.nestjs.com](https://docs.nestjs.com)ÏóêÏÑú ÌôïÏù∏ÌïòÏã§ Ïàò ÏûàÏäµÎãàÎã§. :books:
+- [„Ç¨„Ç§„Éâ](readme_jp.md)„ÅØ [docs.nestjs.com](https://docs.nestjs.com)„Åß„ÅîÁ¢∫Ë™ç„Åè„Å†„Åï„ÅÑ„ÄÇ :books:
 
 ## Questions
 
@@ -54,71 +53,88 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
-<table style="text-align:center;"><tr>
-  <td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
-  <td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/red-hat-logo.svg" width="200" valign="middle" /></a></td>
-<td>
-<a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
-<td>
-<a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
-</tr></table>
+
+<table style="text-align:center;">
+<tr>
+<td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
+<td><a href="https://microsoft.com/" target="_blank"><img src="https://nestjs.com/img/logos/microsoft-logo.png" width="180" valign="middle" /></a></td>
+<td><a href="https://mojam.co" target="_blank"><img src="https://nestjs.com/img/logos/mojam-logo.png" width="80" valign="middle" /></a></td>
+<td><a href="https://marblism.com?utm_source=nest" target="_blank"><img src="https://nestjs.com/img/logos/marblism-logo.png" width="180" valign="middle" /></a></td>
+<td><a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
+<td><a href="https://amplication.com/" target="_blank"><img src="https://nestjs.com/img/logos/amplication-logo.svg" width="190" valign="middle" /></a></td>
+</tr>
+</table>
 
 #### Gold Sponsors
 
-<table style="text-align:center;"><tr><td>
-  <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
-  <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
-<td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
+<table style="text-align:center;">
+<tr>
+<td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/logos/red-hat-logo.svg" width="200" valign="middle" /></a></td>
+<td><a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
+<td><a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/logos/nx-logo.png" height="45" valign="middle" /></a></td>
+<td><a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/logos/intrinisic-logo.png" width="210" valign="middle" /></a></td>
+<td><a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/logos/jetbrains-logo.svg" width="90" valign="middle" /></a></td>
+</tr>
+<tr>
+<td><a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/logos/snyk-logo-black.png" width="185" valign="middle" /></a></td>
+<td><a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/logos/fuse-logo.svg" width="105" valign="middle" /></a></td>
+<td><a href="https://ridicorp.com/career/" target="_blank"><img src="https://nestjs.com/img/logos/ridi-logo.svg" width="105" valign="middle" /></a></td>
+<td><a href="https://www.movavi.com/imovie-for-windows.html" target="_blank"><img src="https://nestjs.com/img/logos/movavi-logo.svg" width="105" valign="middle" /></a></td>
+<td><a href="https://skunk.team" target="_blank"><img src="https://nestjs.com/img/logos/skunk-logo.png" height="60" valign="middle" /></a></td>
+</tr>
+</table>
 
 #### Silver Sponsors
 
-<table style="text-align:center;"><tr><td>
-<a href="https://neoteric.eu/" target="_blank"><img src="https://nestjs.com/img/neoteric-cut.png" width="120" valign="middle" /></a> </td><td>
-  <a href="http://gojob.com" target="_blank"><img src="http://nestjs.com/img/gojob-logo.png" valign="middle" width="100" /></a> </td><td>
-<a href="https://www.myleodsc.com/" target="_blank"><img src="https://nestjs.com/img/myleo-logo.png" width="180" valign="middle" /></td><td>
-<a href="https://careers.meetdandy.com/?gh_src=063ba61e3us" target="_blank"><img src="https://nestjs.com/img/dandy-roles-logo.svg" width="150" valign="middle" /></td><td>
-<a href="https://www.castlecraft.in" target="_blank"><img src="https://nestjs.com/img/castlecraft-logo.png" width="150" valign="middle" /></td>
-<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td></tr></table>
+<table style="text-align:center;">
+<tr>
+<td><a href="https://www.mercedes-benz.com/" target="_blank"><img src="https://nestjs.com/img/logos/mercedes-logo.png" width="100" valign="middle" /></a></td>
+<td><a href="https://www.dinii.jp/" target="_blank"><img src="https://nestjs.com/img/logos/dinii-logo.png" width="65" valign="middle" /></a></td>
+<td><a href="https://bloodycase.com/?promocode=NEST" target="_blank"><img src="https://nestjs.com/img/logos/bloodycase-logo.png" width="65" valign="middle" /></a></td>
+<td><a href="https://handsontable.com/docs/react-data-grid/?utm_source=NestJS_GH&utm_medium=sponsorship&utm_campaign=library_sponsorship_2024" target="_blank"><img src="https://nestjs.com/img/logos/handsontable-dark-logo.svg#2" width="150" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.itflashcards.com/" target="_blank"><img src="https://nestjs.com/img/logos/it_flashcards-logo.png" width="170" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://arcjet.com/?ref=nestjs" target="_blank"><img src="https://nestjs.com/img/logos/arcjet-logo.svg" width="170" valign="middle" /></a></td>
+</tr>
+</table>
 
 #### Sponsors
 
-<table><tr><td align="center" valign="middle">
-<a href="https://www.swingdev.io" target="_blank"><img src="https://nestjs.com/img/swingdev-logo.svg#1" width="110" valign="middle" /> </a></td><td align="center" valign="middle">
-<a href="https://www.novologic.com/" target="_blank"><img src="https://nestjs.com/img/novologic.png" width="110" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://ever.co/" target="_blank"><img src="https://nestjs.com/img/ever-logo.png" width="72" valign="middle" /></a>  </td><td align="center" valign="middle">
-<a href="https://blokt.com" target="_blank"><img src="https://nestjs.com/img/blokt-logo.png" width="120" valign="middle" /></a>  </td><td align="center" valign="middle"> 
-  <a href="http://architectnow.net/" target="_blank"><img src="https://nestjs.com/img/architectnow.png" width="125" valign="middle" /></a> </td><td align="center" valign="middle">
-  <a href="https://quander.io/" target="_blank"><img src="https://nestjs.com/img/quander.png" width="100" valign="middle" /></a> </td></tr><tr><td align="center" valign="middle">
-  <a href="https://mantro.net/" target="_blank"><img src="https://nestjs.com/img/mantro-logo.svg" width="95" valign="middle" /></a> </td><td align="center" valign="middle">
-  <a href="https://triplebyte.com/" target="_blank"><img src="https://nestjs.com/img/triplebyte.png" width="107" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://reposit.co.uk/" target="_blank"><img src="https://nestjs.com/img/reposit-logo.png" width="71" valign="middle" /></a></td><td align="center" valign="middle">
-<a href="https://nearpod.com/" target="_blank"><img src="https://nestjs.com/img/nearpod-logo.svg" width="100" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://clay.global/" target="_blank"><img src="https://nestjs.com/img/clay-logo.svg" width="75" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://firesticktricks.com" target="_blank"><img src="https://nestjs.com/img/firesticktricks-logo.png" width="120" valign="middle" /></a></td></tr><tr><td align="center" valign="middle">
-<a href="https://www.codeguesser.co.uk" target="_blank"><img src="https://nestjs.com/img/codeguesser-logo.svg" width="120" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://f-a.nz/" target="_blank"><img src="https://nestjs.com/img/franz.svg" width="80" valign="middle" /></a> </td><td align="center" valign="middle">
-<a href="https://sparkfabrik.com/" target="_blank"><img src="https://nestjs.com/img/sparkfabrik-logo.png" width="120" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://www.thebigphonestore.co.uk/" target="_blank"><img src="https://nestjs.com/img/the-big-phone-store-logo.png" width="65" valign="middle" /></a></td>
-  <td align="center" valign="middle">
-  <a href="https://genuinebee.com/" target="_blank"><img src="https://nestjs.com/img/genuinebee.svg" width="97" valign="middle" /></a> </td>
-<td align="center" valign="middle"><a href="https://sanyodigital.com/" target="_blank"><img src="https://nestjs.com/img/sanyo-digital.png" width="130" valign="middle" /></a></td></tr><tr><td align="center" valign="middle"><a href="https://vpn-review.com/vpn-for-torrenting" target="_blank"><img src="https://nestjs.com/img/vpn-review-logo.png" width="85" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://lambda-it.ch/" target="_blank"><img src="https://nestjs.com/img/lambda-it-logo.svg" width="115" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://pickwriters.com/top-10-translation-services" target="_blank"><img src="https://nestjs.com/img/pickwriters-logo.png" width="40" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://thewordpoint.com/services/localization" target="_blank"><img src="https://nestjs.com/img/thewordpoint-logo.png" width="40" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://meercode.io/" target="_blank"><img src="https://nestjs.com/img/meercode-logo.png" width="60" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://www.najlepszeplatformyforex.pl/blog/broker-xtb/" target="_blank"><img src="https://nestjs.com/img/npf-logo.jpg" width="200" valign="middle" /></a></td></tr><tr>
-<td align="center" valign="middle"><a href="https://thestandarddaily.com/" target="_blank"><img src="https://nestjs.com/img/the-standard-daily-logo.png" width="180" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://houseofangular.io/" target="_blank"><img src="https://nestjs.com/img/house-of-angular.png" width="100" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://rocketech.it/cases/?utm_source=google&utm_medium=badge&utm_campaign=nestjs" target="_blank"><img src="https://nestjs.com/img/rocketech-logo.svg" width="110" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://www.bystored.com/" target="_blank"><img src="https://nestjs.com/img/stored-logo.svg" width="110" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://studyclerk.com/pay-for-research-paper" target="_blank"><img src="https://nestjs.com/img/studyclerk-logo.png" width="125" valign="middle" /></a></td><td align="center" valign="middle"><a href="https://xyndata.com" target="_blank"><img src="https://nestjs.com/img/xyndata-logo.png" width="125" valign="middle" /></a></td></tr><tr>
-  <td align="center" valign="middle"><a href="https://www.anonymistic.com/" target="_blank"><img src="https://nestjs.com/img/anonymistic-logo.png" width="125" valign="middle" /></a></td>
-<td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/naologic-logo.svg" width="125" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://messaged.com/" target="_blank"><img src="https://nestjs.com/img/messaged-logo.png" width="50" valign="middle" /></a></td>
-  <td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/triplecore-logo.svg" width="50" valign="middle" /></a></td>
-  </tr></table>
+<table>
+<tr>
+<td align="center" valign="middle"><a href="https://www.swingdev.io" target="_blank"><img src="https://nestjs.com/img/logos/swingdev-logo.svg#1" width="110" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.novologic.com/" target="_blank"><img src="https://nestjs.com/img/logos/novologic.png" width="110" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://mantro.net/" target="_blank"><img src="https://nestjs.com/img/logos/mantro-logo.svg" width="95" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://triplebyte.com/" target="_blank"><img src="https://nestjs.com/img/logos/triplebyte.png" width="107" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://nearpod.com/" target="_blank"><img src="https://nestjs.com/img/logos/nearpod-logo.svg" width="100" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://genuinebee.com/" target="_blank"><img src="https://nestjs.com/img/logos/genuinebee.svg" width="97" valign="middle" /></a></td>
+</tr>
+<tr>
+<td align="center" valign="middle"><a href="https://vpn-review.com/vpn-for-torrenting" target="_blank"><img src="https://nestjs.com/img/logos/vpn-review-logo.png" width="85" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://lambda-it.ch/" target="_blank"><img src="https://nestjs.com/img/logos/lambda-it-logo.svg" width="115" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://rocketech.it/cases/?utm_source=google&utm_medium=badge&utm_campaign=nestjs" target="_blank"><img src="https://nestjs.com/img/logos/rocketech-logo.svg" width="110" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.anonymistic.com/" target="_blank"><img src="https://nestjs.com/img/logos/anonymistic-logo.png" width="125" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/logos/naologic-logo.svg" width="125" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/logos/triplecore-logo.svg" width="50" valign="middle" /></a></td>
+</tr>
+<tr>
+<td align="center" valign="middle"><a href="https://thecasinowizard.com/bonuses/no-deposit-bonuses/" target="_blank"><img src="https://nestjs.com/img/logos/casinowizard-logo.png" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://polygon-software.ch/" target="_blank"><img src="https://nestjs.com/img/logos/polygon-logo.svg" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/logos/boringowl-logo.svg" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://nordbot.app/" target="_blank"><img src="https://nestjs.com/img/logos/nordbot-logo.png" width="120" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://doppio.sh/" target="_blank"><img src="https://nestjs.com/img/logos/dopiosh-logo.png" width="50" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.hingehealth.com/" target="_blank"><img src="https://nestjs.com/img/logos/hinge-health-logo.svg" width="100" valign="middle" /></a></td>
+</tr>
+<tr>
+<td align="center" valign="middle"><a href="https://julienferand.dev/" target="_blank"><img src="https://nestjs.com/img/logos/julienferand-logo.jpeg" width="55" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.tripoffice.com/" target="_blank"><img src="https://nestjs.com/img/logos/tripoffice-logo.png" width="140" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://solcellsforetag.se/" target="_blank"><img src="https://nestjs.com/img/logos/solcellsforetag-logo.svg" width="140" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.route4me.com/" target="_blank"><img src="https://nestjs.com/img/logos/route4me-logo.svg" width="100" valign="middle" /></a></td>
+<td align="center" valign="middle"><a href="https://www.slotsup.com/" target="_blank"><img src="https://nestjs.com/img/logos/slotsup-logo.png" width="60" valign="middle" /></a></td>
+</tr>
+</table>
 
 ## Backers
 
@@ -126,9 +142,9 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 
 ## Stay in touch
 
-* Author - [Kamil My≈õliwiec](https://twitter.com/kammysliwiec)
-* Website - [https://nestjs.com](https://nestjs.com/)
-* Twitter - [@nestframework](https://twitter.com/nestframework)
+- Author - [Kamil My≈õliwiec](https://x.com/kammysliwiec)
+- Website - [https://nestjs.com](https://nestjs.com/)
+- X - [@nestframework](https://x.com/nestframework)
 
 ## License
 
diff --git a/packages/websockets/adapters/ws-adapter.ts b/packages/websockets/adapters/ws-adapter.ts
index b32be38b8..54303e50d 100644
--- a/packages/websockets/adapters/ws-adapter.ts
+++ b/packages/websockets/adapters/ws-adapter.ts
@@ -17,8 +17,17 @@ export abstract class AbstractWsAdapter<
 > implements WebSocketAdapter<TServer, TClient, TOptions>
 {
   protected readonly httpServer: any;
+  private _forceCloseConnections: boolean;
 
-  constructor(appOrHttpServer?: INestApplicationContext | any) {
+  public set forceCloseConnections(value: boolean) {
+    this._forceCloseConnections = value;
+  }
+
+  public get forceCloseConnections(): boolean {
+    return this._forceCloseConnections;
+  }
+
+  constructor(appOrHttpServer?: INestApplicationContext | object) {
     if (appOrHttpServer && appOrHttpServer instanceof NestApplication) {
       this.httpServer = appOrHttpServer.getUnderlyingHttpServer();
     } else {
@@ -39,7 +48,6 @@ export abstract class AbstractWsAdapter<
     isCallable && (await new Promise(resolve => server.close(resolve)));
   }
 
-  // eslint-disable-next-line @typescript-eslint/no-empty-function
   public async dispose() {}
 
   public abstract create(port: number, options?: TOptions): TServer;
diff --git a/packages/websockets/context/exception-filters-context.ts b/packages/websockets/context/exception-filters-context.ts
index 319aedc54..7d630ad1c 100644
--- a/packages/websockets/context/exception-filters-context.ts
+++ b/packages/websockets/context/exception-filters-context.ts
@@ -4,6 +4,9 @@ import { BaseExceptionFilterContext } from '@nestjs/core/exceptions/base-excepti
 import { NestContainer } from '@nestjs/core/injector/container';
 import { WsExceptionsHandler } from '../exceptions/ws-exceptions-handler';
 
+/**
+ * @publicApi
+ */
 export class ExceptionFiltersContext extends BaseExceptionFilterContext {
   constructor(container: NestContainer) {
     super(container);
@@ -30,6 +33,6 @@ export class ExceptionFiltersContext extends BaseExceptionFilterContext {
   }
 
   public getGlobalMetadata<T extends any[]>(): T {
-    return [] as T;
+    return [] as any[] as T;
   }
 }
diff --git a/packages/websockets/context/ws-context-creator.ts b/packages/websockets/context/ws-context-creator.ts
index ed0819bf8..c699612b6 100644
--- a/packages/websockets/context/ws-context-creator.ts
+++ b/packages/websockets/context/ws-context-creator.ts
@@ -1,5 +1,5 @@
 import {
-  CUSTOM_ROUTE_AGRS_METADATA,
+  CUSTOM_ROUTE_ARGS_METADATA,
   PARAMTYPES_METADATA,
 } from '@nestjs/common/constants';
 import {
@@ -18,11 +18,12 @@ import {
 import { ExecutionContextHost } from '@nestjs/core/helpers/execution-context-host';
 import { HandlerMetadataStorage } from '@nestjs/core/helpers/handler-metadata-storage';
 import { ParamsMetadata } from '@nestjs/core/helpers/interfaces';
-import { InterceptorsConsumer } from '@nestjs/core/interceptors/interceptors-consumer';
-import { InterceptorsContextCreator } from '@nestjs/core/interceptors/interceptors-context-creator';
-import { PipesConsumer } from '@nestjs/core/pipes/pipes-consumer';
-import { PipesContextCreator } from '@nestjs/core/pipes/pipes-context-creator';
-import { PARAM_ARGS_METADATA } from '../constants';
+import {
+  InterceptorsConsumer,
+  InterceptorsContextCreator,
+} from '@nestjs/core/interceptors';
+import { PipesConsumer, PipesContextCreator } from '@nestjs/core/pipes';
+import { MESSAGE_METADATA, PARAM_ARGS_METADATA } from '../constants';
 import { WsException } from '../errors/ws-exception';
 import { WsParamsFactory } from '../factories/ws-params-factory';
 import { ExceptionFiltersContext } from './exception-filters-context';
@@ -65,7 +66,6 @@ export class WsContextCreator {
       methodName,
       contextType,
     );
-
     const exceptionHandler = this.exceptionFiltersContext.create(
       instance,
       callback,
@@ -107,20 +107,26 @@ export class WsContextCreator {
       }
       return callback.apply(instance, args);
     };
+    const targetPattern = this.reflectCallbackPattern(callback);
+    return this.wsProxy.create(
+      async (...args: unknown[]) => {
+        args.push(targetPattern);
 
-    return this.wsProxy.create(async (...args: unknown[]) => {
-      const initialArgs = this.contextUtils.createNullArray(argsLength);
-      fnCanActivate && (await fnCanActivate(args));
+        const initialArgs = this.contextUtils.createNullArray(argsLength);
+        fnCanActivate && (await fnCanActivate(args));
 
-      return this.interceptorsConsumer.intercept(
-        interceptors,
-        args,
-        instance,
-        callback,
-        handler(initialArgs, args),
-        contextType,
-      );
-    }, exceptionHandler);
+        return this.interceptorsConsumer.intercept(
+          interceptors,
+          args,
+          instance,
+          callback,
+          handler(initialArgs, args),
+          contextType,
+        );
+      },
+      exceptionHandler,
+      targetPattern,
+    );
   }
 
   public reflectCallbackParamtypes(
@@ -130,6 +136,10 @@ export class WsContextCreator {
     return Reflect.getMetadata(PARAMTYPES_METADATA, instance, callback.name);
   }
 
+  public reflectCallbackPattern(callback: (...args: any[]) => any): string {
+    return Reflect.getMetadata(MESSAGE_METADATA, callback);
+  }
+
   public createGuardsFn<TContext extends string = ContextType>(
     guards: any[],
     instance: Controller,
@@ -210,7 +220,7 @@ export class WsContextCreator {
         this.pipesContextCreator.createConcreteContext(pipesCollection);
       const type = this.contextUtils.mapParamType(key);
 
-      if (key.includes(CUSTOM_ROUTE_AGRS_METADATA)) {
+      if (key.includes(CUSTOM_ROUTE_ARGS_METADATA)) {
         const { factory } = metadata[key];
         const customExtractValue = this.contextUtils.getCustomFactory(
           factory,
diff --git a/packages/websockets/context/ws-proxy.ts b/packages/websockets/context/ws-proxy.ts
index dee999afc..dedbfddfc 100644
--- a/packages/websockets/context/ws-proxy.ts
+++ b/packages/websockets/context/ws-proxy.ts
@@ -7,8 +7,10 @@ export class WsProxy {
   public create(
     targetCallback: (...args: unknown[]) => Promise<any>,
     exceptionsHandler: WsExceptionsHandler,
+    targetPattern?: string,
   ): (...args: unknown[]) => Promise<any> {
     return async (...args: unknown[]) => {
+      args = [...args, targetPattern ?? 'unknown'];
       try {
         const result = await targetCallback(...args);
         return !isObservable(result)
@@ -32,6 +34,6 @@ export class WsProxy {
   ) {
     const host = new ExecutionContextHost(args);
     host.setType('ws');
-    exceptionsHandler.handle(error, host);
+    exceptionsHandler.handle(error as Error, host);
   }
 }
diff --git a/packages/websockets/decorators/connected-socket.decorator.ts b/packages/websockets/decorators/connected-socket.decorator.ts
index 32bd663c7..c21e4f8a1 100644
--- a/packages/websockets/decorators/connected-socket.decorator.ts
+++ b/packages/websockets/decorators/connected-socket.decorator.ts
@@ -1,6 +1,9 @@
 import { WsParamtype } from '../enums/ws-paramtype.enum';
 import { createWsParamDecorator } from '../utils/param.utils';
 
+/**
+ * @publicApi
+ */
 export const ConnectedSocket: () => ParameterDecorator = createWsParamDecorator(
   WsParamtype.SOCKET,
 );
diff --git a/packages/websockets/decorators/gateway-server.decorator.ts b/packages/websockets/decorators/gateway-server.decorator.ts
index a3a21b634..3a0832639 100644
--- a/packages/websockets/decorators/gateway-server.decorator.ts
+++ b/packages/websockets/decorators/gateway-server.decorator.ts
@@ -2,6 +2,8 @@ import { GATEWAY_SERVER_METADATA } from '../constants';
 
 /**
  * Attaches native Web Socket Server to a given property.
+ *
+ * @publicApi
  */
 export const WebSocketServer = (): PropertyDecorator => {
   return (target: object, propertyKey: string | symbol) => {
diff --git a/packages/websockets/decorators/socket-gateway.decorator.ts b/packages/websockets/decorators/socket-gateway.decorator.ts
index 4361b121d..8fc1c9bae 100644
--- a/packages/websockets/decorators/socket-gateway.decorator.ts
+++ b/packages/websockets/decorators/socket-gateway.decorator.ts
@@ -4,6 +4,8 @@ import { GatewayMetadata } from '../interfaces';
 /**
  * Decorator that marks a class as a Nest gateway that enables real-time, bidirectional
  * and event-based communication between the browser and the server.
+ *
+ * @publicApi
  */
 export function WebSocketGateway(port?: number): ClassDecorator;
 export function WebSocketGateway<
diff --git a/packages/websockets/decorators/subscribe-message.decorator.ts b/packages/websockets/decorators/subscribe-message.decorator.ts
index 2b22c9376..4e3329900 100644
--- a/packages/websockets/decorators/subscribe-message.decorator.ts
+++ b/packages/websockets/decorators/subscribe-message.decorator.ts
@@ -2,6 +2,8 @@ import { MESSAGE_MAPPING_METADATA, MESSAGE_METADATA } from '../constants';
 
 /**
  * Subscribes to messages that fulfils chosen pattern.
+ *
+ * @publicApi
  */
 export const SubscribeMessage = <T = string>(message: T): MethodDecorator => {
   return (
diff --git a/packages/websockets/enums/ws-paramtype.enum.ts b/packages/websockets/enums/ws-paramtype.enum.ts
index daa8f4265..51dd98abf 100644
--- a/packages/websockets/enums/ws-paramtype.enum.ts
+++ b/packages/websockets/enums/ws-paramtype.enum.ts
@@ -1,4 +1,6 @@
+import { RouteParamtypes } from '@nestjs/common/enums/route-paramtypes.enum';
+
 export enum WsParamtype {
-  SOCKET = 0,
-  PAYLOAD = 3,
+  SOCKET = RouteParamtypes.REQUEST,
+  PAYLOAD = RouteParamtypes.BODY,
 }
diff --git a/packages/websockets/errors/ws-exception.ts b/packages/websockets/errors/ws-exception.ts
index cf7e639a2..f6eddd845 100644
--- a/packages/websockets/errors/ws-exception.ts
+++ b/packages/websockets/errors/ws-exception.ts
@@ -16,7 +16,7 @@ export class WsException extends Error {
       this.message = (this.error as Record<string, any>).message;
     } else if (this.constructor) {
       this.message = this.constructor.name
-        .match(/[A-Z][a-z]+|[0-9]+/g)
+        .match(/[A-Z][a-z]+|[0-9]+/g)!
         .join(' ');
     }
   }
diff --git a/packages/websockets/exceptions/base-ws-exception-filter.ts b/packages/websockets/exceptions/base-ws-exception-filter.ts
index 5c29d5a03..7b7f09bb5 100644
--- a/packages/websockets/exceptions/base-ws-exception-filter.ts
+++ b/packages/websockets/exceptions/base-ws-exception-filter.ts
@@ -1,55 +1,118 @@
-import { ArgumentsHost, Logger, WsExceptionFilter } from '@nestjs/common';
+import {
+  ArgumentsHost,
+  IntrinsicException,
+  Logger,
+  WsExceptionFilter,
+} from '@nestjs/common';
 import { isObject } from '@nestjs/common/utils/shared.utils';
 import { MESSAGES } from '@nestjs/core/constants';
 import { WsException } from '../errors/ws-exception';
 
+export interface ErrorPayload<Cause = { pattern: string; data: unknown }> {
+  /**
+   * Error message identifier.
+   */
+  status: 'error';
+  /**
+   * Error message.
+   */
+  message: string;
+  /**
+   * Message that caused the exception.
+   */
+  cause?: Cause;
+}
+
+interface BaseWsExceptionFilterOptions {
+  /**
+   * When true, the data that caused the exception will be included in the response.
+   * This is useful when you want to provide additional context to the client, or
+   * when you need to associate the error with a specific request.
+   * @default true
+   */
+  includeCause?: boolean;
+
+  /**
+   * A factory function that can be used to control the shape of the "cause" object.
+   * This is useful when you need a custom structure for the cause object.
+   * @default (pattern, data) => ({ pattern, data })
+   */
+  causeFactory?: (pattern: string, data: unknown) => Record<string, any>;
+}
+
+/**
+ * @publicApi
+ */
 export class BaseWsExceptionFilter<TError = any>
   implements WsExceptionFilter<TError>
 {
-  private static readonly logger = new Logger('WsExceptionsHandler');
+  protected static readonly logger = new Logger('WsExceptionsHandler');
+
+  constructor(protected readonly options: BaseWsExceptionFilterOptions = {}) {
+    this.options.includeCause = this.options.includeCause ?? true;
+    this.options.causeFactory =
+      this.options.causeFactory ?? ((pattern, data) => ({ pattern, data }));
+  }
 
   public catch(exception: TError, host: ArgumentsHost) {
     const client = host.switchToWs().getClient();
-    this.handleError(client, exception);
+    const pattern = host.switchToWs().getPattern();
+    const data = host.switchToWs().getData();
+    this.handleError(client, exception, {
+      pattern,
+      data,
+    });
   }
 
   public handleError<TClient extends { emit: Function }>(
     client: TClient,
     exception: TError,
+    cause: ErrorPayload['cause'],
   ) {
     if (!(exception instanceof WsException)) {
-      return this.handleUnknownError(exception, client);
+      return this.handleUnknownError(exception, client, cause);
     }
 
     const status = 'error';
     const result = exception.getError();
-    const message = isObject(result)
-      ? result
-      : {
-          status,
-          message: result,
-        };
-
-    client.emit('exception', message);
+
+    if (isObject(result)) {
+      return client.emit('exception', result);
+    }
+
+    const payload: ErrorPayload<unknown> = {
+      status,
+      message: result,
+    };
+
+    if (this.options?.includeCause && cause) {
+      payload.cause = this.options.causeFactory!(cause.pattern, cause.data);
+    }
+
+    client.emit('exception', payload);
   }
 
   public handleUnknownError<TClient extends { emit: Function }>(
     exception: TError,
     client: TClient,
+    data: ErrorPayload['cause'],
   ) {
     const status = 'error';
-    client.emit('exception', {
+    const payload: ErrorPayload<unknown> = {
       status,
       message: MESSAGES.UNKNOWN_EXCEPTION_MESSAGE,
-    });
+    };
+
+    if (this.options?.includeCause && data) {
+      payload.cause = this.options.causeFactory!(data.pattern, data.data);
+    }
+
+    client.emit('exception', payload);
 
-    if (this.isExceptionObject(exception)) {
-      return BaseWsExceptionFilter.logger.error(
-        exception.message,
-        exception.stack,
-      );
+    if (!(exception instanceof IntrinsicException)) {
+      const logger = BaseWsExceptionFilter.logger;
+      logger.error(exception);
     }
-    return BaseWsExceptionFilter.logger.error(exception);
   }
 
   public isExceptionObject(err: any): err is Error {
diff --git a/packages/websockets/exceptions/ws-exceptions-handler.ts b/packages/websockets/exceptions/ws-exceptions-handler.ts
index e1b09589d..3efbbbfad 100644
--- a/packages/websockets/exceptions/ws-exceptions-handler.ts
+++ b/packages/websockets/exceptions/ws-exceptions-handler.ts
@@ -1,14 +1,18 @@
 import { ArgumentsHost } from '@nestjs/common';
 import { ExceptionFilterMetadata } from '@nestjs/common/interfaces/exceptions/exception-filter-metadata.interface';
+import { selectExceptionFilterMetadata } from '@nestjs/common/utils/select-exception-filter-metadata.util';
 import { isEmpty } from '@nestjs/common/utils/shared.utils';
 import { InvalidExceptionFilterException } from '@nestjs/core/errors/exceptions/invalid-exception-filter.exception';
 import { WsException } from '../errors/ws-exception';
 import { BaseWsExceptionFilter } from './base-ws-exception-filter';
 
+/**
+ * @publicApi
+ */
 export class WsExceptionsHandler extends BaseWsExceptionFilter {
   private filters: ExceptionFilterMetadata[] = [];
 
-  public handle(exception: Error | WsException | any, host: ArgumentsHost) {
+  public handle(exception: Error | WsException, host: ArgumentsHost) {
     const client = host.switchToWs().getClient();
     if (this.invokeCustomFilters(exception, host) || !client.emit) {
       return;
@@ -29,14 +33,7 @@ export class WsExceptionsHandler extends BaseWsExceptionFilter {
   ): boolean {
     if (isEmpty(this.filters)) return false;
 
-    const filter = this.filters.find(({ exceptionMetatypes }) => {
-      const hasMetatype =
-        !exceptionMetatypes.length ||
-        exceptionMetatypes.some(
-          ExceptionMetatype => exception instanceof ExceptionMetatype,
-        );
-      return hasMetatype;
-    });
+    const filter = selectExceptionFilterMetadata(this.filters, exception);
     filter && filter.func(exception, args);
     return !!filter;
   }
diff --git a/packages/websockets/gateway-metadata-explorer.ts b/packages/websockets/gateway-metadata-explorer.ts
index dc20cfbe3..aadaaf67c 100644
--- a/packages/websockets/gateway-metadata-explorer.ts
+++ b/packages/websockets/gateway-metadata-explorer.ts
@@ -11,7 +11,7 @@ import { NestGateway } from './interfaces/nest-gateway.interface';
 export interface MessageMappingProperties {
   message: any;
   methodName: string;
-  callback: (...args: any[]) => Observable<any> | Promise<any> | any;
+  callback: (...args: any[]) => Observable<any> | Promise<any>;
 }
 
 export class GatewayMetadataExplorer {
@@ -19,18 +19,16 @@ export class GatewayMetadataExplorer {
 
   public explore(instance: NestGateway): MessageMappingProperties[] {
     const instancePrototype = Object.getPrototypeOf(instance);
-    return this.metadataScanner.scanFromPrototype<
-      NestGateway,
-      MessageMappingProperties
-    >(instance, instancePrototype, method =>
-      this.exploreMethodMetadata(instancePrototype, method),
-    );
+    return this.metadataScanner
+      .getAllMethodNames(instancePrototype)
+      .map(method => this.exploreMethodMetadata(instancePrototype, method)!)
+      .filter(metadata => metadata);
   }
 
   public exploreMethodMetadata(
     instancePrototype: object,
     methodName: string,
-  ): MessageMappingProperties {
+  ): MessageMappingProperties | null {
     const callback = instancePrototype[methodName];
     const isMessageMapping = Reflect.getMetadata(
       MESSAGE_MAPPING_METADATA,
diff --git a/packages/websockets/index.ts b/packages/websockets/index.ts
index 76db23065..bccb398b5 100644
--- a/packages/websockets/index.ts
+++ b/packages/websockets/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @websockets
- * Copyright(c) 2017 - 2021 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2023 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
diff --git a/packages/websockets/interfaces/gateway-metadata.interface.ts b/packages/websockets/interfaces/gateway-metadata.interface.ts
index 1666b321f..7164c21a9 100644
--- a/packages/websockets/interfaces/gateway-metadata.interface.ts
+++ b/packages/websockets/interfaces/gateway-metadata.interface.ts
@@ -1,9 +1,10 @@
-/**
- * @external https://github.com/socketio/socket.io/blob/master/lib/index.ts
- */
-
 import { CorsOptions } from '@nestjs/common/interfaces/external/cors-options.interface';
 
+/**
+ * External interface
+ * @see https://github.com/socketio/socket.io/blob/master/lib/index.ts
+ * @publicApi
+ */
 export interface GatewayMetadata {
   /**
    * The name of a namespace
@@ -31,27 +32,27 @@ export interface GatewayMetadata {
   parser?: any;
   /**
    * How many ms before a client without namespace is closed
-   * @default 45000
+   * @default 45_000
    */
   connectTimeout?: number;
   /**
    * How many ms without a pong packet to consider the connection closed
-   * @default 5000
+   * @default 20_000
    */
   pingTimeout?: number;
   /**
    * How many ms before sending a new ping packet
-   * @default 25000
+   * @default 25_000
    */
   pingInterval?: number;
   /**
    * How many ms before an uncompleted transport upgrade is cancelled
-   * @default 10000
+   * @default 10_000
    */
   upgradeTimeout?: number;
   /**
    * How many bytes or characters a message can be, before closing the session (to avoid DoS).
-   * @default 1e5 (100 KB)
+   * @default 1e6 (1 MB)
    */
   maxHttpBufferSize?: number;
   /**
@@ -99,7 +100,7 @@ export interface GatewayMetadata {
    * might be used for sticky-session. Defaults to not sending any cookie.
    * @default false
    */
-  cookie?: any | boolean;
+  cookie?: any;
   /**
    * The options that will be forwarded to the cors module
    */
@@ -116,7 +117,7 @@ export interface GatewayMetadata {
   destroyUpgrade?: boolean;
   /**
    * Milliseconds after which unhandled requests are ended
-   * @default 1000
+   * @default 1_000
    */
   destroyUpgradeTimeout?: number;
 }
diff --git a/packages/websockets/interfaces/hooks/on-gateway-connection.interface.ts b/packages/websockets/interfaces/hooks/on-gateway-connection.interface.ts
index b3ca0f51c..7f39dbdcf 100644
--- a/packages/websockets/interfaces/hooks/on-gateway-connection.interface.ts
+++ b/packages/websockets/interfaces/hooks/on-gateway-connection.interface.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export interface OnGatewayConnection<T = any> {
   handleConnection(client: T, ...args: any[]): any;
 }
diff --git a/packages/websockets/interfaces/hooks/on-gateway-disconnect.interface.ts b/packages/websockets/interfaces/hooks/on-gateway-disconnect.interface.ts
index f038c2162..e86e27d8f 100644
--- a/packages/websockets/interfaces/hooks/on-gateway-disconnect.interface.ts
+++ b/packages/websockets/interfaces/hooks/on-gateway-disconnect.interface.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export interface OnGatewayDisconnect<T = any> {
   handleDisconnect(client: T): any;
 }
diff --git a/packages/websockets/interfaces/hooks/on-gateway-init.interface.ts b/packages/websockets/interfaces/hooks/on-gateway-init.interface.ts
index 81096e55c..c90f5d8c6 100644
--- a/packages/websockets/interfaces/hooks/on-gateway-init.interface.ts
+++ b/packages/websockets/interfaces/hooks/on-gateway-init.interface.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export interface OnGatewayInit<T = any> {
   afterInit(server: T): any;
 }
diff --git a/packages/websockets/interfaces/nest-gateway.interface.ts b/packages/websockets/interfaces/nest-gateway.interface.ts
index 1011bb053..89472d362 100644
--- a/packages/websockets/interfaces/nest-gateway.interface.ts
+++ b/packages/websockets/interfaces/nest-gateway.interface.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export interface NestGateway {
   afterInit?: (server: any) => void;
   handleConnection?: (...args: any[]) => void;
diff --git a/packages/websockets/interfaces/server-and-event-streams-host.interface.ts b/packages/websockets/interfaces/server-and-event-streams-host.interface.ts
index 4b04a81e5..5049dc959 100644
--- a/packages/websockets/interfaces/server-and-event-streams-host.interface.ts
+++ b/packages/websockets/interfaces/server-and-event-streams-host.interface.ts
@@ -1,5 +1,8 @@
 import { ReplaySubject, Subject } from 'rxjs';
 
+/**
+ * @publicApi
+ */
 export interface ServerAndEventStreamsHost<T = any> {
   server: T;
   init: ReplaySubject<T>;
diff --git a/packages/websockets/interfaces/web-socket-server.interface.ts b/packages/websockets/interfaces/web-socket-server.interface.ts
index 0c0387acf..d573038c1 100644
--- a/packages/websockets/interfaces/web-socket-server.interface.ts
+++ b/packages/websockets/interfaces/web-socket-server.interface.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export interface WebSocketServerOptions {
   port: number;
   namespace: string;
diff --git a/packages/websockets/interfaces/websockets-entrypoint-metadata.interface.ts b/packages/websockets/interfaces/websockets-entrypoint-metadata.interface.ts
new file mode 100644
index 000000000..bd80cd5d2
--- /dev/null
+++ b/packages/websockets/interfaces/websockets-entrypoint-metadata.interface.ts
@@ -0,0 +1,4 @@
+export type WebsocketEntrypointMetadata = {
+  port: number;
+  message: unknown;
+};
diff --git a/packages/websockets/interfaces/ws-response.interface.ts b/packages/websockets/interfaces/ws-response.interface.ts
index 04e815cbf..bf04aa48a 100644
--- a/packages/websockets/interfaces/ws-response.interface.ts
+++ b/packages/websockets/interfaces/ws-response.interface.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export interface WsResponse<T = any> {
   event: string;
   data: T;
diff --git a/packages/websockets/package.json b/packages/websockets/package.json
index e8f6233a5..212a281b0 100644
--- a/packages/websockets/package.json
+++ b/packages/websockets/package.json
@@ -1,30 +1,31 @@
 {
   "name": "@nestjs/websockets",
-  "version": "8.2.5",
+  "version": "10.4.11",
   "description": "Nest - modern, fast, powerful node.js web framework (@websockets)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
   "repository": {
     "type": "git",
-    "url": "https://github.com/nestjs/nest"
+    "url": "https://github.com/nestjs/nest.git",
+    "directory": "packages/websockets"
   },
   "publishConfig": {
     "access": "public"
   },
   "dependencies": {
     "iterare": "1.2.1",
-    "object-hash": "2.2.0",
-    "tslib": "2.3.1"
+    "object-hash": "3.0.0",
+    "tslib": "2.7.0"
   },
   "devDependencies": {
-    "@nestjs/common": "8.2.5",
-    "@nestjs/core": "8.2.5"
+    "@nestjs/common": "10.4.11",
+    "@nestjs/core": "10.4.11"
   },
   "peerDependencies": {
-    "@nestjs/common": "^8.0.0",
-    "@nestjs/core": "^8.0.0",
-    "@nestjs/platform-socket.io": "^8.0.0",
-    "reflect-metadata": "^0.1.12",
+    "@nestjs/common": "^10.0.0",
+    "@nestjs/core": "^10.0.0",
+    "@nestjs/platform-socket.io": "^10.0.0",
+    "reflect-metadata": "^0.1.12 || ^0.2.0",
     "rxjs": "^7.1.0"
   },
   "peerDependenciesMeta": {
diff --git a/packages/websockets/socket-module.ts b/packages/websockets/socket-module.ts
index 681cb0a08..e4bd7dece 100644
--- a/packages/websockets/socket-module.ts
+++ b/packages/websockets/socket-module.ts
@@ -1,11 +1,14 @@
+import { NestApplicationOptions } from '@nestjs/common';
+import { InjectionToken } from '@nestjs/common/interfaces';
 import { Injectable } from '@nestjs/common/interfaces/injectable.interface';
+import { NestApplicationContextOptions } from '@nestjs/common/interfaces/nest-application-context-options.interface';
 import { ApplicationConfig } from '@nestjs/core/application-config';
 import { GuardsConsumer } from '@nestjs/core/guards/guards-consumer';
 import { GuardsContextCreator } from '@nestjs/core/guards/guards-context-creator';
 import { loadAdapter } from '@nestjs/core/helpers/load-adapter';
 import { NestContainer } from '@nestjs/core/injector/container';
 import { InstanceWrapper } from '@nestjs/core/injector/instance-wrapper';
-import { InstanceToken } from '@nestjs/core/injector/module';
+import { GraphInspector } from '@nestjs/core/inspector/graph-inspector';
 import { InterceptorsConsumer } from '@nestjs/core/interceptors/interceptors-consumer';
 import { InterceptorsContextCreator } from '@nestjs/core/interceptors/interceptors-context-creator';
 import { PipesConsumer } from '@nestjs/core/pipes/pipes-consumer';
@@ -21,30 +24,40 @@ import { SocketServerProvider } from './socket-server-provider';
 import { SocketsContainer } from './sockets-container';
 import { WebSocketsController } from './web-sockets-controller';
 
-export class SocketModule<HttpServer = any> {
+export class SocketModule<
+  THttpServer = any,
+  TAppOptions extends
+    NestApplicationContextOptions = NestApplicationContextOptions,
+> {
   private readonly socketsContainer = new SocketsContainer();
   private applicationConfig: ApplicationConfig;
   private webSocketsController: WebSocketsController;
   private isAdapterInitialized: boolean;
-  private httpServer: HttpServer | undefined;
+  private httpServer: THttpServer | undefined;
+  private appOptions: TAppOptions;
 
   public register(
     container: NestContainer,
-    config: ApplicationConfig,
-    httpServer?: HttpServer,
+    applicationConfig: ApplicationConfig,
+    graphInspector: GraphInspector,
+    appOptions: TAppOptions,
+    httpServer?: THttpServer,
   ) {
-    this.applicationConfig = config;
+    this.applicationConfig = applicationConfig;
+    this.appOptions = appOptions;
     this.httpServer = httpServer;
 
     const contextCreator = this.getContextCreator(container);
     const serverProvider = new SocketServerProvider(
       this.socketsContainer,
-      config,
+      applicationConfig,
     );
     this.webSocketsController = new WebSocketsController(
       serverProvider,
-      config,
+      applicationConfig,
       contextCreator,
+      graphInspector,
+      this.appOptions,
     );
     const modules = container.getModules();
     modules.forEach(({ providers }, moduleName: string) =>
@@ -53,7 +66,7 @@ export class SocketModule<HttpServer = any> {
   }
 
   public connectAllGateways(
-    providers: Map<InstanceToken, InstanceWrapper<Injectable>>,
+    providers: Map<InjectionToken, InstanceWrapper<Injectable>>,
     moduleName: string,
   ) {
     iterate(providers.values())
@@ -66,7 +79,7 @@ export class SocketModule<HttpServer = any> {
     moduleName: string,
   ) {
     const { instance, metatype } = wrapper;
-    const metadataKeys = Reflect.getMetadataKeys(metatype);
+    const metadataKeys = Reflect.getMetadataKeys(metatype!);
     if (!metadataKeys.includes(GATEWAY_METADATA)) {
       return;
     }
@@ -75,8 +88,9 @@ export class SocketModule<HttpServer = any> {
     }
     this.webSocketsController.connectGatewayToServer(
       instance as NestGateway,
-      metatype,
+      metatype!,
       moduleName,
+      wrapper.id,
     );
   }
 
@@ -100,8 +114,12 @@ export class SocketModule<HttpServer = any> {
   }
 
   private initializeAdapter() {
+    const forceCloseConnections = (this.appOptions as NestApplicationOptions)
+      .forceCloseConnections;
     const adapter = this.applicationConfig.getIoAdapter();
     if (adapter) {
+      (adapter as AbstractWsAdapter).forceCloseConnections =
+        forceCloseConnections!;
       this.isAdapterInitialized = true;
       return;
     }
@@ -111,6 +129,7 @@ export class SocketModule<HttpServer = any> {
       () => require('@nestjs/platform-socket.io'),
     );
     const ioAdapter = new IoAdapter(this.httpServer);
+    ioAdapter.forceCloseConnections = forceCloseConnections;
     this.applicationConfig.setIoAdapter(ioAdapter);
 
     this.isAdapterInitialized = true;
diff --git a/packages/websockets/sockets-container.ts b/packages/websockets/sockets-container.ts
index 1090150e8..f6b0ccfcc 100644
--- a/packages/websockets/sockets-container.ts
+++ b/packages/websockets/sockets-container.ts
@@ -15,7 +15,7 @@ export class SocketsContainer {
     options: T,
   ): ServerAndEventStreamsHost {
     const uniqueToken = this.generateHashByOptions(options);
-    return this.serverAndEventStreamsHosts.get(uniqueToken);
+    return this.serverAndEventStreamsHosts.get(uniqueToken)!;
   }
 
   public addOne<T extends GatewayMetadata = any>(
diff --git a/packages/websockets/test/context/exception-filters.context.spec.ts b/packages/websockets/test/context/exception-filters.context.spec.ts
index ddc6ac8e4..d58730c1e 100644
--- a/packages/websockets/test/context/exception-filters.context.spec.ts
+++ b/packages/websockets/test/context/exception-filters.context.spec.ts
@@ -6,7 +6,6 @@ import { NestContainer } from '../../../core/injector/container';
 import { ExceptionFiltersContext } from '../../context/exception-filters-context';
 
 describe('ExceptionFiltersContext', () => {
-  let moduleName: string;
   let exceptionFilter: ExceptionFiltersContext;
 
   class CustomException {}
@@ -16,7 +15,6 @@ describe('ExceptionFiltersContext', () => {
   }
 
   beforeEach(() => {
-    moduleName = 'Test';
     exceptionFilter = new ExceptionFiltersContext(new NestContainer() as any);
   });
   describe('create', () => {
@@ -28,7 +26,7 @@ describe('ExceptionFiltersContext', () => {
       it('should return plain ExceptionHandler object', () => {
         const filter = exceptionFilter.create(
           new EmptyMetadata(),
-          () => ({} as any),
+          () => ({}) as any,
           '',
         );
         expect((filter as any).filters).to.be.empty;
@@ -41,7 +39,7 @@ describe('ExceptionFiltersContext', () => {
       it('should return ExceptionHandler object with exception filters', () => {
         const filter = exceptionFilter.create(
           new WithMetadata(),
-          () => ({} as any),
+          () => ({}) as any,
           '',
         );
         expect((filter as any).filters).to.not.be.empty;
diff --git a/packages/websockets/test/context/ws-context-creator.spec.ts b/packages/websockets/test/context/ws-context-creator.spec.ts
index b51a48987..37b0b2835 100644
--- a/packages/websockets/test/context/ws-context-creator.spec.ts
+++ b/packages/websockets/test/context/ws-context-creator.spec.ts
@@ -3,7 +3,7 @@ import { expect } from 'chai';
 import { of } from 'rxjs';
 import * as sinon from 'sinon';
 import { Injectable, UseGuards, UsePipes } from '../../../common';
-import { CUSTOM_ROUTE_AGRS_METADATA } from '../../../common/constants';
+import { CUSTOM_ROUTE_ARGS_METADATA } from '../../../common/constants';
 import { GuardsConsumer } from '../../../core/guards/guards-consumer';
 import { GuardsContextCreator } from '../../../core/guards/guards-context-creator';
 import { NestContainer } from '../../../core/injector/container';
@@ -101,7 +101,7 @@ describe('WsContextCreator', () => {
         sinon
           .stub(guardsContextCreator, 'create')
           .callsFake(() => [{ canActivate: () => true }]);
-        const proxy = await contextCreator.create(
+        const proxy = contextCreator.create(
           instance,
           instance.test,
           module,
@@ -113,11 +113,11 @@ describe('WsContextCreator', () => {
         expect(tryActivateSpy.called).to.be.true;
       });
       describe('when can not activate', () => {
-        it('should throws forbidden exception', async () => {
+        it('should throw forbidden exception', () => {
           sinon
             .stub(guardsConsumer, 'tryActivate')
             .callsFake(async () => false);
-          const proxy = await contextCreator.create(
+          const proxy = contextCreator.create(
             instance,
             instance.test,
             module,
@@ -144,7 +144,7 @@ describe('WsContextCreator', () => {
 
   describe('createGuardsFn', () => {
     it('should throw exception when "tryActivate" returns false', () => {
-      const guardsFn = contextCreator.createGuardsFn([null], null, null);
+      const guardsFn = contextCreator.createGuardsFn([null], null!, null!)!;
       sinon.stub(guardsConsumer, 'tryActivate').callsFake(async () => false);
       guardsFn([]).catch(err => expect(err).to.not.be.undefined);
     });
@@ -155,7 +155,7 @@ describe('WsContextCreator', () => {
       const metadata = {
         [WsParamtype.SOCKET]: { index: 0, data: 'test', pipes: [] },
         [WsParamtype.PAYLOAD]: { index: 2, data: 'test', pipes: [] },
-        [`key${CUSTOM_ROUTE_AGRS_METADATA}`]: {
+        [`key${CUSTOM_ROUTE_ARGS_METADATA}`]: {
           index: 3,
           data: 'custom',
           pipes: [],
@@ -172,7 +172,7 @@ describe('WsContextCreator', () => {
       const expectedValues = [
         { index: 0, type: WsParamtype.SOCKET, data: 'test' },
         { index: 2, type: WsParamtype.PAYLOAD, data: 'test' },
-        { index: 3, type: `key${CUSTOM_ROUTE_AGRS_METADATA}`, data: 'custom' },
+        { index: 3, type: `key${CUSTOM_ROUTE_ARGS_METADATA}`, data: 'custom' },
       ];
       expect(values[0]).to.deep.include(expectedValues[0]);
       expect(values[1]).to.deep.include(expectedValues[1]);
@@ -187,8 +187,8 @@ describe('WsContextCreator', () => {
     beforeEach(() => {
       consumerApplySpy = sinon.spy(pipesConsumer, 'apply');
     });
-    it('should call "consumer.apply"', () => {
-      contextCreator.getParamValue(
+    it('should call "consumer.apply"', async () => {
+      await contextCreator.getParamValue(
         value,
         { metatype, type: WsParamtype.PAYLOAD, data: null },
         transforms,
@@ -211,12 +211,12 @@ describe('WsContextCreator', () => {
             {
               index: 1,
               type: 'test',
-              data: null,
+              data: null!,
               pipes: [],
               extractValue: () => null,
             },
           ],
-        );
+        )!;
         await pipesFn([]);
         expect(pipesFn).to.be.a('function');
       });
diff --git a/packages/websockets/test/context/ws-proxy.spec.ts b/packages/websockets/test/context/ws-proxy.spec.ts
index 1d416c7d5..7266ce13b 100644
--- a/packages/websockets/test/context/ws-proxy.spec.ts
+++ b/packages/websockets/test/context/ws-proxy.spec.ts
@@ -17,9 +17,8 @@ describe('WsProxy', () => {
   });
 
   describe('create', () => {
-    it('should method return thunk', async () => {
-      const proxy = await routerProxy.create(async (client, data) => {},
-      handler);
+    it('should method return thunk', () => {
+      const proxy = routerProxy.create(async (client, data) => {}, handler);
       expect(typeof proxy === 'function').to.be.true;
     });
 
diff --git a/packages/websockets/test/exceptions/ws-exceptions-handler.spec.ts b/packages/websockets/test/exceptions/ws-exceptions-handler.spec.ts
index 199b092e3..c1b54ba4a 100644
--- a/packages/websockets/test/exceptions/ws-exceptions-handler.spec.ts
+++ b/packages/websockets/test/exceptions/ws-exceptions-handler.spec.ts
@@ -7,7 +7,12 @@ import { WsExceptionsHandler } from '../../exceptions/ws-exceptions-handler';
 describe('WsExceptionsHandler', () => {
   let handler: WsExceptionsHandler;
   let emitStub: sinon.SinonStub;
-  let client;
+  let client: {
+    emit: sinon.SinonStub;
+  };
+  let pattern: string;
+  let data: unknown;
+  let executionContextHost: ExecutionContextHost;
 
   beforeEach(() => {
     handler = new WsExceptionsHandler();
@@ -15,47 +20,96 @@ describe('WsExceptionsHandler', () => {
     client = {
       emit: emitStub,
     };
+    pattern = 'test';
+    data = { foo: 'bar' };
+    executionContextHost = new ExecutionContextHost([client, data, pattern]);
+
     client.emit.returns(client);
   });
 
   describe('handle', () => {
-    it('should method emit expected status code message when exception is unknown', () => {
-      handler.handle(new Error(), new ExecutionContextHost([client]));
-      expect(
-        emitStub.calledWith('exception', {
-          status: 'error',
-          message: 'Internal server error',
-        }),
-      ).to.be.true;
+    describe('when "includeCause" is set to true (default)', () => {
+      it('should method emit expected status code message when exception is unknown', () => {
+        handler.handle(new Error(), executionContextHost);
+        expect(
+          emitStub.calledWith('exception', {
+            status: 'error',
+            message: 'Internal server error',
+            cause: {
+              pattern,
+              data,
+            },
+          }),
+        ).to.be.true;
+      });
+      describe('when exception is instance of WsException', () => {
+        it('should method emit expected status and json object', () => {
+          const message = {
+            custom: 'Unauthorized',
+          };
+          handler.handle(new WsException(message), executionContextHost);
+          expect(emitStub.calledWith('exception', message)).to.be.true;
+        });
+        it('should method emit expected status and transform message to json', () => {
+          const message = 'Unauthorized';
+
+          handler.handle(new WsException(message), executionContextHost);
+          console.log(emitStub.getCall(0).args);
+          expect(
+            emitStub.calledWith('exception', {
+              message,
+              status: 'error',
+              cause: {
+                pattern,
+                data,
+              },
+            }),
+          ).to.be.true;
+        });
+      });
     });
-    describe('when exception is instance of WsException', () => {
-      it('should method emit expected status and json object', () => {
-        const message = {
-          custom: 'Unauthorized',
-        };
-        handler.handle(
-          new WsException(message),
-          new ExecutionContextHost([client]),
-        );
-        expect(emitStub.calledWith('exception', message)).to.be.true;
+
+    describe('when "includeCause" is set to false', () => {
+      beforeEach(() => {
+        handler = new WsExceptionsHandler({ includeCause: false });
       });
-      it('should method emit expected status and transform message to json', () => {
-        const message = 'Unauthorized';
 
+      it('should method emit expected status code message when exception is unknown', () => {
         handler.handle(
-          new WsException(message),
-          new ExecutionContextHost([client]),
+          new Error(),
+          new ExecutionContextHost([client, pattern, data]),
         );
-        expect(emitStub.calledWith('exception', { message, status: 'error' }))
-          .to.be.true;
+        expect(
+          emitStub.calledWith('exception', {
+            status: 'error',
+            message: 'Internal server error',
+          }),
+        ).to.be.true;
+      });
+      describe('when exception is instance of WsException', () => {
+        it('should method emit expected status and json object', () => {
+          const message = {
+            custom: 'Unauthorized',
+          };
+          handler.handle(new WsException(message), executionContextHost);
+          expect(emitStub.calledWith('exception', message)).to.be.true;
+        });
+        it('should method emit expected status and transform message to json', () => {
+          const message = 'Unauthorized';
+
+          handler.handle(new WsException(message), executionContextHost);
+          expect(emitStub.calledWith('exception', { message, status: 'error' }))
+            .to.be.true;
+        });
       });
     });
+
     describe('when "invokeCustomFilters" returns true', () => {
       beforeEach(() => {
         sinon.stub(handler, 'invokeCustomFilters').returns(true);
       });
       it('should not call `emit`', () => {
-        handler.handle(new WsException(''), new ExecutionContextHost([client]));
+        handler.handle(new WsException(''), executionContextHost);
         expect(emitStub.notCalled).to.be.true;
       });
     });
@@ -66,18 +120,18 @@ describe('WsExceptionsHandler', () => {
       handler.setCustomFilters(filters as any);
       expect((handler as any).filters).to.be.eql(filters);
     });
-    it('should throws exception when passed argument is not an array', () => {
-      expect(() => handler.setCustomFilters(null)).to.throw();
+    it('should throw exception when passed argument is not an array', () => {
+      expect(() => handler.setCustomFilters(null!)).to.throw();
     });
   });
   describe('invokeCustomFilters', () => {
     describe('when filters array is empty', () => {
       it('should return false', () => {
-        expect(handler.invokeCustomFilters(null, null)).to.be.false;
+        expect(handler.invokeCustomFilters(null, null!)).to.be.false;
       });
     });
     describe('when filters array is not empty', () => {
-      let filters, funcSpy;
+      let filters: any[], funcSpy: sinon.SinonSpy;
       class TestException {}
 
       beforeEach(() => {
@@ -89,7 +143,7 @@ describe('WsExceptionsHandler', () => {
           (handler as any).filters = filters;
         });
         it('should call funcSpy', () => {
-          handler.invokeCustomFilters(new TestException(), null);
+          handler.invokeCustomFilters(new TestException(), null!);
           expect(funcSpy.notCalled).to.be.false;
         });
         it('should call funcSpy with exception and response passed as an arguments', () => {
@@ -100,17 +154,17 @@ describe('WsExceptionsHandler', () => {
           expect(funcSpy.calledWith(exception, res)).to.be.true;
         });
         it('should return true', () => {
-          expect(handler.invokeCustomFilters(new TestException(), null)).to.be
+          expect(handler.invokeCustomFilters(new TestException(), null!)).to.be
             .true;
         });
       });
       describe('when filter does not exists in filters array', () => {
         it('should not call funcSpy', () => {
-          handler.invokeCustomFilters(new TestException(), null);
+          handler.invokeCustomFilters(new TestException(), null!);
           expect(funcSpy.notCalled).to.be.true;
         });
         it('should return false', () => {
-          expect(handler.invokeCustomFilters(new TestException(), null)).to.be
+          expect(handler.invokeCustomFilters(new TestException(), null!)).to.be
             .false;
         });
       });
diff --git a/packages/websockets/test/factories/ws-params-factory.spec.ts b/packages/websockets/test/factories/ws-params-factory.spec.ts
index 1a449edfc..a0e95883b 100644
--- a/packages/websockets/test/factories/ws-params-factory.spec.ts
+++ b/packages/websockets/test/factories/ws-params-factory.spec.ts
@@ -16,7 +16,7 @@ describe('WsParamsFactory', () => {
       describe(`WsParamtype.PAYLOAD`, () => {
         it('should return a message payload object', () => {
           expect(
-            factory.exchangeKeyForValue(WsParamtype.PAYLOAD, null, args),
+            factory.exchangeKeyForValue(WsParamtype.PAYLOAD, null!, args),
           ).to.be.eql(data);
         });
         it('should return a message payload object with parameter extraction', () => {
@@ -28,19 +28,21 @@ describe('WsParamsFactory', () => {
       describe(`WsParamtype.SOCKET`, () => {
         it('should return a connected socket object', () => {
           expect(
-            factory.exchangeKeyForValue(WsParamtype.SOCKET, null, args),
+            factory.exchangeKeyForValue(WsParamtype.SOCKET, null!, args),
           ).to.be.eql(client);
         });
       });
     });
     describe('when key is not available', () => {
       it('should return null', () => {
-        expect(factory.exchangeKeyForValue(-1, null, [])).to.be.eql(null);
+        expect(factory.exchangeKeyForValue(-1, null!, [])).to.be.eql(null);
       });
     });
     describe('when args are not available', () => {
       it('should return null', () => {
-        expect(factory.exchangeKeyForValue(null, null, null)).to.be.eql(null);
+        expect(factory.exchangeKeyForValue(null!, null!, null!)).to.be.eql(
+          null,
+        );
       });
     });
   });
diff --git a/packages/websockets/test/gateway-metadata-explorer.spec.ts b/packages/websockets/test/gateway-metadata-explorer.spec.ts
index b495fea5f..d36979575 100644
--- a/packages/websockets/test/gateway-metadata-explorer.spec.ts
+++ b/packages/websockets/test/gateway-metadata-explorer.spec.ts
@@ -38,16 +38,15 @@ describe('GatewayMetadataExplorer', () => {
     instance = new GatewayMetadataExplorer(scanner);
   });
   describe('explore', () => {
-    let scanFromPrototype: sinon.SinonSpy;
+    let getAllMethodNames: sinon.SinonSpy;
     beforeEach(() => {
-      scanFromPrototype = sinon.spy(scanner, 'scanFromPrototype');
+      getAllMethodNames = sinon.spy(scanner, 'getAllMethodNames');
     });
     it(`should call "scanFromPrototype" with expected arguments`, () => {
       const obj = new Test();
       instance.explore(obj as any);
 
-      const [argObj, argProto] = scanFromPrototype.getCall(0).args;
-      expect(argObj).to.be.eql(obj);
+      const [argProto] = getAllMethodNames.getCall(0).args;
       expect(argProto).to.be.eql(Object.getPrototypeOf(obj));
     });
   });
@@ -61,7 +60,7 @@ describe('GatewayMetadataExplorer', () => {
       expect(metadata).to.eq(null);
     });
     it(`should return message mapping properties when "isMessageMapping" metadata is not undefined`, () => {
-      const metadata = instance.exploreMethodMetadata(test, 'test');
+      const metadata = instance.exploreMethodMetadata(test, 'test')!;
       expect(metadata).to.have.keys(['callback', 'message', 'methodName']);
       expect(metadata.message).to.eql(message);
     });
diff --git a/packages/websockets/test/socket-server-provider.spec.ts b/packages/websockets/test/socket-server-provider.spec.ts
index 9b9711299..a9d1649db 100644
--- a/packages/websockets/test/socket-server-provider.spec.ts
+++ b/packages/websockets/test/socket-server-provider.spec.ts
@@ -38,7 +38,7 @@ describe('SocketServerProvider', () => {
       const server = { test: 'test' };
       mockContainer.expects('getOneByConfig').returns(server);
 
-      const result = instance.scanForSocketServer({ namespace: null }, port);
+      const result = instance.scanForSocketServer({ namespace: null! }, port);
 
       expect(createSocketServerSpy.called).to.be.false;
       expect(result).to.eq(server);
diff --git a/packages/websockets/test/tsconfig.json b/packages/websockets/test/tsconfig.json
new file mode 100644
index 000000000..50d59661d
--- /dev/null
+++ b/packages/websockets/test/tsconfig.json
@@ -0,0 +1,3 @@
+{
+  "extends": "../../../tsconfig.spec.json"
+}
diff --git a/packages/websockets/test/web-sockets-controller.spec.ts b/packages/websockets/test/web-sockets-controller.spec.ts
index 68503abb0..576228a9b 100644
--- a/packages/websockets/test/web-sockets-controller.spec.ts
+++ b/packages/websockets/test/web-sockets-controller.spec.ts
@@ -1,14 +1,19 @@
+import { NestContainer } from '@nestjs/core';
 import { ApplicationConfig } from '@nestjs/core/application-config';
 import { expect } from 'chai';
 import { fromEvent, lastValueFrom, Observable, of } from 'rxjs';
 import * as sinon from 'sinon';
+import { GraphInspector } from '../../core/inspector/graph-inspector';
 import { MetadataScanner } from '../../core/metadata-scanner';
 import { AbstractWsAdapter } from '../adapters/ws-adapter';
 import { PORT_METADATA } from '../constants';
 import { WsContextCreator } from '../context/ws-context-creator';
 import { WebSocketGateway } from '../decorators/socket-gateway.decorator';
 import { InvalidSocketPortException } from '../errors/invalid-socket-port.exception';
-import { GatewayMetadataExplorer } from '../gateway-metadata-explorer';
+import {
+  GatewayMetadataExplorer,
+  MessageMappingProperties,
+} from '../gateway-metadata-explorer';
 import { SocketServerProvider } from '../socket-server-provider';
 import { WebSocketsController } from '../web-sockets-controller';
 
@@ -28,9 +33,12 @@ class NoopAdapter extends AbstractWsAdapter {
 
 describe('WebSocketsController', () => {
   let instance: WebSocketsController;
+  let untypedInstance: any;
   let provider: SocketServerProvider,
+    graphInspector: GraphInspector,
     config: ApplicationConfig,
     mockProvider: sinon.SinonMock;
+
   const messageHandlerCallback = () => Promise.resolve();
   const port = 90,
     namespace = '/';
@@ -39,7 +47,8 @@ describe('WebSocketsController', () => {
 
   beforeEach(() => {
     config = new ApplicationConfig(new NoopAdapter());
-    provider = new SocketServerProvider(null, config);
+    provider = new SocketServerProvider(null!, config);
+    graphInspector = new GraphInspector(new NestContainer());
     mockProvider = sinon.mock(provider);
 
     const contextCreator = sinon.createStubInstance(WsContextCreator);
@@ -48,7 +57,9 @@ describe('WebSocketsController', () => {
       provider,
       config,
       contextCreator as any,
+      graphInspector,
     );
+    untypedInstance = instance as any;
   });
   describe('connectGatewayToServer', () => {
     let subscribeToServerEvents: sinon.SinonSpy;
@@ -61,28 +72,45 @@ describe('WebSocketsController', () => {
 
     beforeEach(() => {
       subscribeToServerEvents = sinon.spy();
-      (instance as any).subscribeToServerEvents = subscribeToServerEvents;
+      untypedInstance.subscribeToServerEvents = subscribeToServerEvents;
     });
-    it('should throws "InvalidSocketPortException" when port is not a number', () => {
+    it('should throw "InvalidSocketPortException" when port is not a number', () => {
       Reflect.defineMetadata(PORT_METADATA, 'test', InvalidGateway);
       expect(() =>
         instance.connectGatewayToServer(
           new InvalidGateway(),
           InvalidGateway,
-          '',
+          'moduleKey',
+          'instanceWrapperId',
         ),
       ).throws(InvalidSocketPortException);
     });
     it('should call "subscribeToServerEvents" with default values when metadata is empty', () => {
       const gateway = new DefaultGateway();
-      instance.connectGatewayToServer(gateway, DefaultGateway, '');
-      expect(subscribeToServerEvents.calledWith(gateway, {}, 0, '')).to.be.true;
+      instance.connectGatewayToServer(
+        gateway,
+        DefaultGateway,
+        'moduleKey',
+        'instanceWrapperId',
+      );
+      expect(subscribeToServerEvents.calledWith(gateway, {}, 0, 'moduleKey')).to
+        .be.true;
     });
     it('should call "subscribeToServerEvents" when metadata is valid', () => {
       const gateway = new Test();
-      instance.connectGatewayToServer(gateway, Test, '');
+      instance.connectGatewayToServer(
+        gateway,
+        Test,
+        'moduleKey',
+        'instanceWrapperId',
+      );
       expect(
-        subscribeToServerEvents.calledWith(gateway, { namespace }, port, ''),
+        subscribeToServerEvents.calledWith(
+          gateway,
+          { namespace },
+          port,
+          'moduleKey',
+        ),
       ).to.be.true;
     });
   });
@@ -100,7 +128,7 @@ describe('WebSocketsController', () => {
       gateway = new Test();
       explorer = new GatewayMetadataExplorer(new MetadataScanner());
       mockExplorer = sinon.mock(explorer);
-      (instance as any).metadataExplorer = explorer;
+      untypedInstance.metadataExplorer = explorer;
 
       handlers = [
         {
@@ -116,16 +144,28 @@ describe('WebSocketsController', () => {
 
       assignServerToProperties = sinon.spy();
       subscribeEvents = sinon.spy();
-      (instance as any).assignServerToProperties = assignServerToProperties;
-      (instance as any).subscribeEvents = subscribeEvents;
+      instance['assignServerToProperties'] = assignServerToProperties;
+      instance['subscribeEvents'] = subscribeEvents;
     });
     it('should call "assignServerToProperties" with expected arguments', () => {
-      instance.subscribeToServerEvents(gateway, { namespace }, port, '');
+      instance.subscribeToServerEvents(
+        gateway,
+        { namespace },
+        port,
+        'moduleKey',
+        'instanceWrapperId',
+      );
       expect(assignServerToProperties.calledWith(gateway, server.server)).to.be
         .true;
     });
     it('should call "subscribeEvents" with expected arguments', () => {
-      instance.subscribeToServerEvents(gateway, { namespace }, port, '');
+      instance.subscribeToServerEvents(
+        gateway,
+        { namespace },
+        port,
+        'moduleKey',
+        'instanceWrapperId',
+      );
       expect(subscribeEvents.firstCall.args[0]).to.be.equal(gateway);
       expect(subscribeEvents.firstCall.args[2]).to.be.equal(server);
       expect(subscribeEvents.firstCall.args[1]).to.be.eql([
@@ -137,11 +177,69 @@ describe('WebSocketsController', () => {
       ]);
     });
   });
+  describe('inspectEntrypointDefinitions', () => {
+    it('should inspect & insert corresponding entrypoint definitions', () => {
+      class GatewayHostCls {}
+
+      const port = 80;
+      const instanceWrapperId = '1234';
+      const messageHandlers: MessageMappingProperties[] = [
+        {
+          methodName: 'findOne',
+          message: 'find',
+          callback: null!,
+        },
+        {
+          methodName: 'create',
+          message: 'insert',
+          callback: null!,
+        },
+      ];
+      const insertEntrypointDefinitionSpy = sinon.spy(
+        graphInspector,
+        'insertEntrypointDefinition',
+      );
+      instance.inspectEntrypointDefinitions(
+        new GatewayHostCls(),
+        port,
+        messageHandlers,
+        instanceWrapperId,
+      );
+
+      expect(insertEntrypointDefinitionSpy.calledTwice).to.be.true;
+      expect(
+        insertEntrypointDefinitionSpy.calledWith({
+          type: 'websocket',
+          methodName: messageHandlers[0].methodName,
+          className: GatewayHostCls.name,
+          classNodeId: instanceWrapperId,
+          metadata: {
+            port,
+            key: messageHandlers[0].message,
+            message: messageHandlers[0].message,
+          } as any,
+        }),
+      ).to.be.true;
+      expect(
+        insertEntrypointDefinitionSpy.calledWith({
+          type: 'websocket',
+          methodName: messageHandlers[1].methodName,
+          className: GatewayHostCls.name,
+          classNodeId: instanceWrapperId,
+          metadata: {
+            port,
+            key: messageHandlers[1].message,
+            message: messageHandlers[1].message,
+          } as any,
+        }),
+      ).to.be.true;
+    });
+  });
   describe('subscribeEvents', () => {
     const gateway = new Test();
 
-    let handlers;
-    let server,
+    let handlers: any;
+    let server: any,
       subscribeConnectionEvent: sinon.SinonSpy,
       subscribeDisconnectEvent: sinon.SinonSpy,
       nextSpy: sinon.SinonSpy,
@@ -168,32 +266,32 @@ describe('WebSocketsController', () => {
         disconnect: {},
         connection: {},
       };
-      (instance as any).subscribeInitEvent = subscribeInitEvent;
-      (instance as any).getConnectionHandler = getConnectionHandler;
-      (instance as any).subscribeConnectionEvent = subscribeConnectionEvent;
-      (instance as any).subscribeDisconnectEvent = subscribeDisconnectEvent;
+      untypedInstance.subscribeInitEvent = subscribeInitEvent;
+      untypedInstance.getConnectionHandler = getConnectionHandler;
+      untypedInstance.subscribeConnectionEvent = subscribeConnectionEvent;
+      untypedInstance.subscribeDisconnectEvent = subscribeDisconnectEvent;
     });
 
     it('should call "subscribeConnectionEvent" with expected arguments', () => {
-      instance.subscribeEvents(gateway, handlers, server as any);
+      instance.subscribeEvents(gateway, handlers, server);
       expect(subscribeConnectionEvent.calledWith(gateway, server.connection)).to
         .be.true;
     });
     it('should call "subscribeDisconnectEvent" with expected arguments', () => {
-      instance.subscribeEvents(gateway, handlers, server as any);
+      instance.subscribeEvents(gateway, handlers, server);
       expect(subscribeDisconnectEvent.calledWith(gateway, server.disconnect)).to
         .be.true;
     });
     it('should call "subscribeInitEvent" with expected arguments', () => {
-      instance.subscribeEvents(gateway, handlers, server as any);
+      instance.subscribeEvents(gateway, handlers, server);
       expect(subscribeInitEvent.calledWith(gateway, server.init)).to.be.true;
     });
     it('should bind connection handler to server', () => {
-      instance.subscribeEvents(gateway, handlers, server as any);
+      instance.subscribeEvents(gateway, handlers, server);
       expect(onSpy.calledWith('connection', getConnectionHandler())).to.be.true;
     });
     it('should call "getConnectionHandler" with expected arguments', () => {
-      instance.subscribeEvents(gateway, handlers, server as any);
+      instance.subscribeEvents(gateway, handlers, server);
       expect(
         getConnectionHandler.calledWith(
           instance,
@@ -231,15 +329,15 @@ describe('WebSocketsController', () => {
       client = {
         on: onSpy,
       };
-      (instance as any).subscribeDisconnectEvent = subscribeDisconnectEvent;
-      (instance as any).subscribeConnectionEvent = subscribeConnectionEvent;
-      (instance as any).subscribeMessages = subscribeMessages;
+      untypedInstance.subscribeDisconnectEvent = subscribeDisconnectEvent;
+      untypedInstance.subscribeConnectionEvent = subscribeConnectionEvent;
+      untypedInstance.subscribeMessages = subscribeMessages;
 
       fn = instance.getConnectionHandler(
         instance,
         gateway,
         handlers,
-        null,
+        null!,
         connection,
       );
       fn(client);
@@ -247,7 +345,7 @@ describe('WebSocketsController', () => {
 
     it('should return function', () => {
       expect(
-        instance.getConnectionHandler(null, null, null, null, null),
+        instance.getConnectionHandler(null!, null!, null!, null!, null!),
       ).to.be.a('function');
     });
     it('should call "next" method of connection object with expected argument', () => {
@@ -263,7 +361,7 @@ describe('WebSocketsController', () => {
   });
   describe('subscribeInitEvent', () => {
     const gateway = new Test();
-    let event, subscribe: sinon.SinonSpy;
+    let event: any, subscribe: sinon.SinonSpy;
 
     beforeEach(() => {
       subscribe = sinon.spy();
@@ -345,7 +443,7 @@ describe('WebSocketsController', () => {
                 Promise.resolve(Promise.resolve(value)),
               ),
             ),
-          ).to.be.eq(100);
+          ).to.be.eq(value);
         });
       });
 
@@ -356,18 +454,29 @@ describe('WebSocketsController', () => {
             await lastValueFrom(
               await instance.pickResult(Promise.resolve(of(value))),
             ),
-          ).to.be.eq(100);
+          ).to.be.eq(value);
+        });
+      });
+
+      describe('is an object that has the method `subscribe`', () => {
+        it('should return Promise<Observable>', async () => {
+          const value = { subscribe() {} };
+          expect(
+            await lastValueFrom(
+              await instance.pickResult(Promise.resolve(value)),
+            ),
+          ).to.equal(value);
         });
       });
 
-      describe('is a value', () => {
+      describe('is an ordinary value', () => {
         it('should return Promise<Observable>', async () => {
           const value = 100;
           expect(
             await lastValueFrom(
               await instance.pickResult(Promise.resolve(value)),
             ),
-          ).to.be.eq(100);
+          ).to.be.eq(value);
         });
       });
     });
diff --git a/packages/websockets/tsconfig.build.json b/packages/websockets/tsconfig.build.json
new file mode 100644
index 000000000..732ca00cb
--- /dev/null
+++ b/packages/websockets/tsconfig.build.json
@@ -0,0 +1,22 @@
+{
+  "extends": "../tsconfig.build.json",
+  "compilerOptions": {
+    "outDir": ".",
+    "rootDir": ".",
+    "paths": {
+      "@nestjs/common": ["../common"],
+      "@nestjs/common/*": ["../common/*"],
+      "@nestjs/core": ["../core"],
+      "@nestjs/core/*": ["../core/*"]
+    }
+  },
+  "exclude": ["node_modules", "dist", "test/**/*", "*.spec.ts"],
+  "references": [
+    {
+      "path": "../common/tsconfig.build.json"
+    },
+    {
+      "path": "../core/tsconfig.build.json"
+    }
+  ]
+}
diff --git a/packages/websockets/tsconfig.json b/packages/websockets/tsconfig.json
index b238080a4..2ae9e3c90 100644
--- a/packages/websockets/tsconfig.json
+++ b/packages/websockets/tsconfig.json
@@ -1,7 +1,13 @@
 {
-  "extends": "./../tsconfig.base.json",
+  "extends": "../tsconfig.build.json",
   "compilerOptions": {
-    "baseUrl": "./"
+    "types": ["node"]
   },
-  "include": ["*.ts", "**/*.ts"]
+  "files": [],
+  "include": [],
+  "references": [
+    {
+      "path": "./tsconfig.build.json"
+    }
+  ]
 }
diff --git a/packages/websockets/utils/param.utils.ts b/packages/websockets/utils/param.utils.ts
index 48598d97e..6f539903b 100644
--- a/packages/websockets/utils/param.utils.ts
+++ b/packages/websockets/utils/param.utils.ts
@@ -11,12 +11,13 @@ export function createWsParamDecorator(
   return (...pipes: (Type<PipeTransform> | PipeTransform)[]) =>
     (target, key, index) => {
       const args =
-        Reflect.getMetadata(PARAM_ARGS_METADATA, target.constructor, key) || {};
+        Reflect.getMetadata(PARAM_ARGS_METADATA, target.constructor, key!) ||
+        {};
       Reflect.defineMetadata(
         PARAM_ARGS_METADATA,
         assignMetadata(args, paramtype, index, undefined, ...pipes),
         target.constructor,
-        key,
+        key!,
       );
     };
 }
@@ -29,15 +30,15 @@ export const createPipesWsParamDecorator =
   ): ParameterDecorator =>
   (target, key, index) => {
     const args =
-      Reflect.getMetadata(PARAM_ARGS_METADATA, target.constructor, key) || {};
+      Reflect.getMetadata(PARAM_ARGS_METADATA, target.constructor, key!) || {};
     const hasParamData = isNil(data) || isString(data);
     const paramData = hasParamData ? data : undefined;
     const paramPipes = hasParamData ? pipes : [data, ...pipes];
 
     Reflect.defineMetadata(
       PARAM_ARGS_METADATA,
-      assignMetadata(args, paramtype, index, paramData, ...paramPipes),
+      assignMetadata(args, paramtype, index, paramData!, ...paramPipes),
       target.constructor,
-      key,
+      key!,
     );
   };
diff --git a/packages/websockets/web-sockets-controller.ts b/packages/websockets/web-sockets-controller.ts
index 75e790c82..09677f4d8 100644
--- a/packages/websockets/web-sockets-controller.ts
+++ b/packages/websockets/web-sockets-controller.ts
@@ -1,9 +1,16 @@
+import { NestApplicationContextOptions } from '@nestjs/common/interfaces/nest-application-context-options.interface';
 import { Type } from '@nestjs/common/interfaces/type.interface';
 import { Logger } from '@nestjs/common/services/logger.service';
-import { isFunction } from '@nestjs/common/utils/shared.utils';
 import { ApplicationConfig } from '@nestjs/core/application-config';
+import { GraphInspector } from '@nestjs/core/inspector/graph-inspector';
 import { MetadataScanner } from '@nestjs/core/metadata-scanner';
-import { from as fromPromise, Observable, of, Subject } from 'rxjs';
+import {
+  from as fromPromise,
+  isObservable,
+  Observable,
+  of,
+  Subject,
+} from 'rxjs';
 import { distinctUntilChanged, mergeAll } from 'rxjs/operators';
 import { GATEWAY_OPTIONS, PORT_METADATA } from './constants';
 import { WsContextCreator } from './context/ws-context-creator';
@@ -15,6 +22,7 @@ import {
 import { GatewayMetadata } from './interfaces/gateway-metadata.interface';
 import { NestGateway } from './interfaces/nest-gateway.interface';
 import { ServerAndEventStreamsHost } from './interfaces/server-and-event-streams-host.interface';
+import { WebsocketEntrypointMetadata } from './interfaces/websockets-entrypoint-metadata.interface';
 import { SocketServerProvider } from './socket-server-provider';
 import { compareElementAt } from './utils/compare-element.util';
 
@@ -30,12 +38,15 @@ export class WebSocketsController {
     private readonly socketServerProvider: SocketServerProvider,
     private readonly config: ApplicationConfig,
     private readonly contextCreator: WsContextCreator,
+    private readonly graphInspector: GraphInspector,
+    private readonly appOptions: NestApplicationContextOptions = {},
   ) {}
 
   public connectGatewayToServer(
     instance: NestGateway,
     metatype: Type<unknown> | Function,
     moduleKey: string,
+    instanceWrapperId: string,
   ) {
     const options = Reflect.getMetadata(GATEWAY_OPTIONS, metatype) || {};
     const port = Reflect.getMetadata(PORT_METADATA, metatype) || 0;
@@ -43,7 +54,13 @@ export class WebSocketsController {
     if (!Number.isInteger(port)) {
       throw new InvalidSocketPortException(port, metatype);
     }
-    this.subscribeToServerEvents(instance, options, port, moduleKey);
+    this.subscribeToServerEvents(
+      instance,
+      options,
+      port,
+      moduleKey,
+      instanceWrapperId,
+    );
   }
 
   public subscribeToServerEvents<T extends GatewayMetadata>(
@@ -51,6 +68,7 @@ export class WebSocketsController {
     options: T,
     port: number,
     moduleKey: string,
+    instanceWrapperId: string,
   ) {
     const nativeMessageHandlers = this.metadataExplorer.explore(instance);
     const messageHandlers = nativeMessageHandlers.map(
@@ -65,6 +83,17 @@ export class WebSocketsController {
         ),
       }),
     );
+
+    this.inspectEntrypointDefinitions(
+      instance,
+      port,
+      messageHandlers,
+      instanceWrapperId,
+    );
+
+    if (this.appOptions.preview) {
+      return;
+    }
     const observableServer = this.socketServerProvider.scanForSocketServer<T>(
       options,
       port,
@@ -127,7 +156,7 @@ export class WebSocketsController {
         .pipe(
           distinctUntilChanged((prev, curr) => compareElementAt(prev, curr, 0)),
         )
-        .subscribe((args: unknown[]) => instance.handleConnection(...args));
+        .subscribe((args: unknown[]) => instance.handleConnection!(...args));
     }
   }
 
@@ -147,6 +176,7 @@ export class WebSocketsController {
     const adapter = this.config.getIoAdapter();
     const handlers = subscribersMap.map(({ callback, message }) => ({
       message,
+
       callback: callback.bind(instance, client),
     }));
     adapter.bindMessageHandlers(client, handlers, data =>
@@ -158,7 +188,7 @@ export class WebSocketsController {
     deferredResult: Promise<any>,
   ): Promise<Observable<any>> {
     const result = await deferredResult;
-    if (result && isFunction(result.subscribe)) {
+    if (isObservable(result)) {
       return result;
     }
     if (result instanceof Promise) {
@@ -167,6 +197,30 @@ export class WebSocketsController {
     return of(result);
   }
 
+  public inspectEntrypointDefinitions(
+    instance: NestGateway,
+    port: number,
+    messageHandlers: MessageMappingProperties[],
+    instanceWrapperId: string,
+  ) {
+    messageHandlers.forEach(handler => {
+      this.graphInspector.insertEntrypointDefinition<WebsocketEntrypointMetadata>(
+        {
+          type: 'websocket',
+          methodName: handler.methodName,
+          className: instance.constructor?.name,
+          classNodeId: instanceWrapperId,
+          metadata: {
+            port,
+            key: handler.message,
+            message: handler.message,
+          },
+        },
+        instanceWrapperId,
+      );
+    });
+  }
+
   private assignServerToProperties<T = any>(
     instance: NestGateway,
     server: object,
@@ -182,7 +236,7 @@ export class WebSocketsController {
     instance: NestGateway,
     subscribersMap: MessageMappingProperties[],
   ) {
-    const gatewayClassName = (instance as Object)?.constructor?.name;
+    const gatewayClassName = (instance as object)?.constructor?.name;
     if (!gatewayClassName) {
       return;
     }
diff --git a/readme_jp.md b/readme_jp.md
index 53991a69b..5e793672b 100644
--- a/readme_jp.md
+++ b/readme_jp.md
@@ -1,11 +1,11 @@
 <p align="center">
-  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
+  <a href="https://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
 </p>
 
 [circleci-image]: https://img.shields.io/circleci/build/github/nestjs/nest/master?token=abc123def456
 [circleci-url]: https://circleci.com/gh/nestjs/nest
 
-<p align="center">„Åô„Å∞„ÇÑ„Åè„Çπ„Ç±„Éº„É©„Éñ„É´„Å™„Çµ„Éº„Éê„Éº„Çµ„Ç§„Éâ„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÇíÊßãÁØâ„Åô„Çã„Åü„ÇÅ„ÅÆÈù©Êñ∞ÁöÑ„Å™<a href="http://nodejs.org" target="_blank">Node.js</a>„Éï„É¨„Éº„É†„ÉØ„Éº„ÇØ„Åß„Åô„ÄÇ</p>
+<p align="center">„Åô„Å∞„ÇÑ„Åè„Çπ„Ç±„Éº„É©„Éñ„É´„Å™„Çµ„Éº„Éê„Éº„Çµ„Ç§„Éâ„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÇíÊßãÁØâ„Åô„Çã„Åü„ÇÅ„ÅÆÈù©Êñ∞ÁöÑ„Å™<a href="https://nodejs.org" target="_blank">Node.js</a>„Éï„É¨„Éº„É†„ÉØ„Éº„ÇØ„Åß„Åô„ÄÇ</p>
 <p align="center">
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/v/@nestjs/core.svg" alt="NPM Version" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
@@ -24,7 +24,7 @@
 
 ## Ê¶ÇË¶Å
 
-„Åô„Å∞„ÇÑ„Åè„Çπ„Ç±„Éº„É©„Éñ„É´„Å™„Çµ„Éº„Éê„Éº„Çµ„Ç§„Éâ„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÇíÊßãÁØâ„Åô„Çã„Åü„ÇÅ„ÅÆÈù©Êñ∞ÁöÑ„Å™<a href="http://nodejs.org" target="_blank">Node.js</a>„Éï„É¨„Éº„É†„ÉØ„Éº„ÇØ„Åß„Åô„ÄÇÊúÄÊñ∞„ÅÆJavaScript„Çí‰ΩøÁî®„Åó„ÄÅ<a href="http://www.typescriptlang.org" target="_blank">TypeScript</a>ÔºàJavaScript„ÇíÊã°Âºµ„Åó„Åü„Çπ„Éº„Éë„Éº„Çª„ÉÉ„ÉàÔºâ„ÅßÊßãÁØâ„Åï„Çå „ÄÅOOPÔºà„Ç™„Éñ„Ç∏„Çß„ÇØ„ÉàÊåáÂêë„Éó„É≠„Ç∞„É©„Éü„É≥„Ç∞Ôºâ„ÄÅFPÔºàÈñ¢Êï∞Âûã„Éó„É≠„Ç∞„É©„Éü„É≥„Ç∞Ôºâ„ÄÅ„Åä„Çà„Å≥FRPÔºàÈñ¢Êï∞Âûã„É™„Ç¢„ÇØ„ÉÜ„Ç£„Éñ„Éó„É≠„Ç∞„É©„Éü„É≥„Ç∞Ôºâ„ÅÆË¶ÅÁ¥†„ÇíÂèñ„ÇäÂÖ•„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ
+„Åô„Å∞„ÇÑ„Åè„Çπ„Ç±„Éº„É©„Éñ„É´„Å™„Çµ„Éº„Éê„Éº„Çµ„Ç§„Éâ„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÇíÊßãÁØâ„Åô„Çã„Åü„ÇÅ„ÅÆÈù©Êñ∞ÁöÑ„Å™<a href="https://nodejs.org" target="_blank">Node.js</a>„Éï„É¨„Éº„É†„ÉØ„Éº„ÇØ„Åß„Åô„ÄÇÊúÄÊñ∞„ÅÆJavaScript„Çí‰ΩøÁî®„Åó„ÄÅ<a href="https://www.typescriptlang.org" target="_blank">TypeScript</a>ÔºàJavaScript„ÇíÊã°Âºµ„Åó„Åü„Çπ„Éº„Éë„Éº„Çª„ÉÉ„ÉàÔºâ„ÅßÊßãÁØâ„Åï„Çå „ÄÅOOPÔºà„Ç™„Éñ„Ç∏„Çß„ÇØ„ÉàÊåáÂêë„Éó„É≠„Ç∞„É©„Éü„É≥„Ç∞Ôºâ„ÄÅFPÔºàÈñ¢Êï∞Âûã„Éó„É≠„Ç∞„É©„Éü„É≥„Ç∞Ôºâ„ÄÅ„Åä„Çà„Å≥FRPÔºàÈñ¢Êï∞Âûã„É™„Ç¢„ÇØ„ÉÜ„Ç£„Éñ„Éó„É≠„Ç∞„É©„Éü„É≥„Ç∞Ôºâ„ÅÆË¶ÅÁ¥†„ÇíÂèñ„ÇäÂÖ•„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ
 
 <p>Nest„ÅØ<a href="https://expressjs.com/" target="_blank">Express</a>(„Éá„Éï„Ç©„É´„Éà)„ÇÑ<a href="https://github.com/fastify/fastify" target="_blank">Fastify</a>„Å™„Å©„ÅÆ„Åï„Åæ„Åñ„Åæ„Å™„É©„Ç§„Éñ„É©„É™„Å®„ÅÆ‰∫íÊèõÊÄß„ÇíÊèê‰æõ„Åô„Çã„Åì„Å®„Åß„ÄÅ„Åü„Åè„Åï„Çì„ÅÆ„Çµ„Éº„Éâ„Éë„Éº„ÉÜ„Ç£„Éó„É©„Ç∞„Ç§„É≥„ÇíÁ∞°Âçò„Å´‰ΩøÁî®„Åô„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ
 </p>
@@ -37,20 +37,20 @@
 
 <p>Nest„ÅØ„ÄÅÂÆüÁî®ÁöÑ„Å™„Ç¢„Éº„Ç≠„ÉÜ„ÇØ„ÉÅ„É£„Çí„Åô„Åê„Å´ÊßãÁØâ„Åß„Åç„Çã„Åì„Å®„ÇíÁõÆÁöÑ„Å®„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇÂÖ∑‰ΩìÁöÑ„Å´„ÅØ„ÄÅ„ÉÜ„Çπ„Éà„Éï„É¨„É≥„Éâ„É™„Éº„Åß„ÄÅ„Çπ„Ç±„Éº„É©„Éñ„É´„Åß„ÄÅÁñéÁµêÂêà„Åß„ÄÅÈÅãÁî®„Å´„ÇÑ„Åï„Åó„ÅÑ„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÇíÊßãÁØâ„Åß„Åç„Çã„Çà„ÅÜ„Å´„Å™„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Åæ„Åü„ÄÅ„Ç¢„Éº„Ç≠„ÉÜ„ÇØ„ÉÅ„É£„ÅØAngular„Å´„Ç§„É≥„Çπ„Éë„Ç§„Ç¢„Åï„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ</p>
 
-## ÂÖ•ÈñÄ
+## „ÅØ„Åò„ÇÅ„Å´
 
 * To check out the [guide](https://docs.nestjs.com), visit [docs.nestjs.com](https://docs.nestjs.com). :books:
 * Ë¶ÅÊü•Áúã‰∏≠Êñá [ÊåáÂçó](readme_zh.md), ËØ∑ËÆøÈóÆ [docs.nestjs.cn](https://docs.nestjs.cn). :books:
-* [Í∞ÄÏù¥Îìú](readme_kr.md)Î•º ÌôïÏù∏ÌïòÎ†§Î©¥, [docs.nestjs.com](https://docs.nestjs.com)Î•º Î∞©Î¨∏ÌïòÏÑ∏Ïöî.:books: 
-* „ÉÅ„Çß„ÉÉ„ÇØ„Åô„Çã„Å´„ÅØ [„Ç¨„Ç§„Éâ](readme_jp.md), Ë©≥„Åó„Åè„ÅØ [docs.nestjs.com](https://docs.nestjs.com).:books:
+* [Í∞ÄÏù¥Îìú](readme_kr.md) Î¨∏ÏÑúÎäî [docs.nestjs.com](https://docs.nestjs.com)ÏóêÏÑú ÌôïÏù∏ÌïòÏã§ Ïàò ÏûàÏäµÎãàÎã§. :books:
+* [„Ç¨„Ç§„Éâ](readme_jp.md)„ÅØ [docs.nestjs.com](https://docs.nestjs.com)„Åß„ÅîÁ¢∫Ë™ç„Åè„Å†„Åï„ÅÑ„ÄÇ :books:
 
 ## Ë≥™Âïè
 
 Ë≥™Âïè„ÇÑ„Çµ„Éù„Éº„Éà„Å´„Å§„ÅÑ„Å¶„ÅØ„ÄÅÂÖ¨Âºè„ÅÆ[Discord„ÉÅ„É£„É≥„Éç„É´](https://discord.gg/G7Qnnhy)„Çí‰ΩøÁî®„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ„Åæ„Åü„ÄÅ„Åì„ÅÆ„É™„Éù„Ç∏„Éà„É™„ÅÆissue„É™„Çπ„Éà„ÅØ„ÄÅ„Éê„Ç∞„É¨„Éù„Éº„Éà„Å®Ê©üËÉΩ„É™„ÇØ„Ç®„Çπ„Éà **Â∞ÇÁî®** „Åß„Åô„ÄÇ
 
-## ÂïèÈ°å(Issues)
+## „Ç§„Ç∑„É•„Éº(Issues)
 
-issue„ÇíÈñã„ÅèÂâç„Å´„ÄÅÂøÖ„Åö[Issue Reporting Checklist](https://github.com/nestjs/nest/blob/master/CONTRIBUTING.md#-submitting-an-issue)„Çí„ÅäË™≠„Åø„Åè„Å†„Åï„ÅÑ„ÄÇ„Ç¨„Ç§„Éâ„É©„Ç§„É≥„Å´Ê∫ñÊã†„Åó„Å¶„ÅÑ„Å™„ÅÑissue„ÅØ„ÄÅ„ÇØ„É≠„Éº„Ç∫„Åï„Çå„ÇãÂ†¥Âêà„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ
+issue„Çí‰ΩúÊàê„Åô„ÇãÂâç„Å´„ÄÅÂøÖ„Åö[Issue Reporting Checklist](https://github.com/nestjs/nest/blob/master/CONTRIBUTING.md#-submitting-an-issue)„Çí„ÅäË™≠„Åø„Åè„Å†„Åï„ÅÑ„ÄÇ„Ç¨„Ç§„Éâ„É©„Ç§„É≥„Å´Ê∫ñÊã†„Åó„Å¶„ÅÑ„Å™„ÅÑissue„ÅØ„ÄÅ„ÇØ„É≠„Éº„Ç∫„Åï„Çå„ÇãÂ†¥Âêà„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ
 
 ## „Ç≥„É≥„Çµ„É´„ÉÜ„Ç£„É≥„Ç∞
 
@@ -60,12 +60,12 @@ issue„ÇíÈñã„ÅèÂâç„Å´„ÄÅÂøÖ„Åö[Issue Reporting Checklist](https://github.com/nest
 
 Nest„ÅØ„ÄÅMIT„É©„Ç§„Çª„É≥„Çπ„ÅÆ„Ç™„Éº„Éó„É≥„ÇΩ„Éº„Çπ„Éó„É≠„Ç∏„Çß„ÇØ„Éà„Åß„Åô„ÄÇ„Çπ„Éù„É≥„Çµ„Éº„Å®ÊîØÊè¥ËÄÖ„Å´„Çà„ÇãÁ¥†Êô¥„Çâ„Åó„ÅÑ„Çµ„Éù„Éº„Éà„Å´„Çà„Å£„Å¶„ÄÅ„Åù„ÅÆÁô∫Â±ï„ÇíÊîØ„Åà„Çâ„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇÂèÇÂä†„Åó„Åü„ÅÑÂ†¥Âêà„ÅØ[„Åì„Å°„Çâ](https://docs.nestjs.com/support)„Çí„ÅîË¶ß„Åè„Å†„Åï„ÅÑ„ÄÇ
 
-## ÈÄ£Áµ°„Åô„Çã
+## ÈÄ£Áµ°ÂÖà
 
-* Author - [Kamil My≈õliwiec](https://twitter.com/kammysliwiec)
-* Website - [https://nestjs.com](https://nestjs.com/)
-* Twitter - [@nestframework](https://twitter.com/nestframework)
+* ËëóËÄÖ - [Kamil My≈õliwiec](https://twitter.com/kammysliwiec)
+* „Ç¶„Çß„Éñ„Çµ„Ç§„Éà - [https://nestjs.com](https://nestjs.com/)
+* X - [@nestframework](https://twitter.com/nestframework)
 
 ## „É©„Ç§„Çª„É≥„Çπ
 
-Nest is [MIT licensed](LICENSE).
+Nest „ÅØ [MIT „É©„Ç§„Çª„É≥„Çπ](LICENSE) „Åß„Åô„ÄÇ
diff --git a/readme_kr.md b/readme_kr.md
index f00e9429e..5b5da7c5e 100644
--- a/readme_kr.md
+++ b/readme_kr.md
@@ -1,11 +1,11 @@
 <p align="center">
-  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
+  <a href="https://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
 </p>
 
 [circleci-image]: https://img.shields.io/circleci/build/github/nestjs/nest/master?token=abc123def456
 [circleci-url]: https://circleci.com/gh/nestjs/nest
 
-  <p align="center">Ìö®Ïú®Ï†ÅÏù¥Í≥† ÌôïÏû• Í∞ÄÎä•Ìïú ÏÑúÎ≤Ñ-ÏÇ¨Ïù¥Îìú Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖòÏùÑ ÏúÑÌïú ÌòÅÏã†Ï†ÅÏù∏ <a href="http://nodejs.org" target="_blank">Node.js</a> ÌîÑÎ†àÏûÑÏõåÌÅ¨.</p>
+  <p align="center">Ìö®Ïú®Ï†ÅÏù¥Í≥† ÌôïÏû• Í∞ÄÎä•Ìïú ÏÑúÎ≤Ñ ÏÇ¨Ïù¥Îìú Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖòÏùÑ ÏúÑÌïú ÌòÅÏã†Ï†Å <a href="https://nodejs.org" target="_blank">Node.js</a> ÌîÑÎ†àÏûÑÏõåÌÅ¨.</p>
     <p align="center">
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/v/@nestjs/core.svg" alt="NPM Version" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
@@ -24,43 +24,40 @@
 
 ## Í∞úÏöî
 
-NestÎäî Ìö®Í≥ºÏ†ÅÏù¥Í≥†, ÌôïÏû• Í∞ÄÎä•Ìïú <a href="http://nodejs.org" target="_blank">Node.js</a> ÏÑúÎ≤Ñ ÏÇ¨Ïù¥Îìú Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖòÏùÑ ÎπåÎìúÌïòÍ∏∞ ÏúÑÌïú ÌîÑÎ†àÏûÑÏõåÌÅ¨ÏûÖÎãàÎã§. NestÎäî Î™®Îçò JavascriptÎ•º ÏÇ¨Ïö©ÌïòÍ≥†, <a href="http://www.typescriptlang.org" target="_blank">TypeScript</a>Î°ú ÎπåÎìúÎêòÏóàÏúºÎ©∞(ÏàúÏàò ÏûêÎ∞îÏä§ÌÅ¨Î¶ΩÌä∏ÏôÄ Ìò∏ÌôòÏÑ±ÏùÑ Ïú†ÏßÄÌï©ÎãàÎã§) OOP(Í∞ùÏ≤¥ ÏßÄÌñ• ÌîÑÎ°úÍ∑∏ÎûòÎ∞ç), FP(Ìï®ÏàòÌòï ÌîÑÎ°úÍ∑∏ÎûòÎ∞ç), FRP(Ìï®Ïàò Î∞òÏùëÌòï ÌîÑÎ°úÍ∑∏ÎûòÎ∞ç)Ïùò ÏöîÏÜåÎì§Ïù¥ Í≤∞Ìï©ÎêòÏóàÏäµÎãàÎã§.
+NestÎäî Ìö®Ïú®Ï†ÅÏù¥Í≥† ÌôïÏû• Í∞ÄÎä•Ìïú <a href="https://nodejs.org" target="_blank">Node.js</a> ÏÑúÎ≤Ñ ÏÇ¨Ïù¥Îìú Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖòÏùÑ ÎπåÎìúÌïòÍ∏∞ ÏúÑÌïú ÌîÑÎ†àÏûÑÏõåÌÅ¨ÏûÖÎãàÎã§. NestÎäî Î™®Îçò JavascriptÎ•º ÏÇ¨Ïö©ÌïòÍ≥† <a href="https://www.typescriptlang.org" target="_blank">TypeScript</a>Î°ú ÎπåÎìúÎêòÏóàÏúºÎ©∞(ÏàúÏàò ÏûêÎ∞îÏä§ÌÅ¨Î¶ΩÌä∏ÏôÄ Ìò∏Ìôò), OOP(Í∞ùÏ≤¥ ÏßÄÌñ• ÌîÑÎ°úÍ∑∏ÎûòÎ∞ç), FP(Ìï®ÏàòÌòï ÌîÑÎ°úÍ∑∏ÎûòÎ∞ç), FRP(Ìï®Ïàò Î∞òÏùëÌòï ÌîÑÎ°úÍ∑∏ÎûòÎ∞ç)Ïùò ÏöîÏÜåÎì§Ïù¥ Í≤∞Ìï©ÎêòÏñ¥ ÏûàÏäµÎãàÎã§.
 
-<p>ÎÇ¥Î∂ÄÏ†ÅÏúºÎ°ú NestÎäî <a href="https://expressjs.com/" target="_blank">Express</a>Î•º ÏÇ¨Ïö©ÌïòÏßÄÎßå, ÎßéÏùÄ ÏÑúÎìúÌååÌã∞ ÌîåÎü¨Í∑∏Ïù∏Îì§ÏùÑ ÏâΩÍ≤å ÏÇ¨Ïö©ÌïòÍ≤å ÌïòÎäî Îã§ÏñëÌïú ÎùºÏù¥Î∏åÎü¨Î¶¨Îì§Í≥ºÏùò Ìò∏ÌôòÏÑ±ÏùÑ Ï†úÍ≥µÌï©ÎãàÎã§. ÏòàÏãú-<a href="https://github.com/fastify/fastify" target="_blank">Fastify</a></p>
+<p>NestÎäî ÎÇ¥Î∂ÄÏ†ÅÏúºÎ°ú <a href="https://expressjs.com/" target="_blank">Express</a>Î•º ÏÇ¨Ïö©ÌïòÏßÄÎßå, <a href="https://github.com/fastify/fastify" target="_blank">Fastify</a>ÏôÄ Í∞ôÏùÄ ÌÉÄ ÎùºÏù¥Î∏åÎü¨Î¶¨Îì§Í≥ºÏùò Ìò∏ÌôòÏÑ±ÏùÑ Í¥ëÎ≤îÏúÑÌïòÍ≤å Ï†úÍ≥µÌïòÎ©∞ ÎßéÏùÄ ÏÑúÎìúÌååÌã∞ ÌîåÎü¨Í∑∏Ïù∏Îì§ÏùÑ ÏÜêÏâΩÍ≤å ÏÇ¨Ïö©Ìï† Ïàò ÏûàÍ≤å Ìï¥Ï§çÎãàÎã§.</p>
 
 ## Ï≤†Ìïô
 
-<p>ÏµúÍ∑º Î™á ÎÖÑÍ∞Ñ, Node.js ÎçïÎ∂ÑÏóê JavascriptÎäî ÏõπÏùò ÌîÑÎ°†Ìä∏ÏôÄ Î∞±ÏóîÎìúÏóêÏÑú ÏÇ¨Ïö©ÌïòÎäî "Í≥µÌÜµÏñ¥"Í∞Ä ÎêòÏóàÍ≥†, Ïù¥Í≤ÉÏùÄ Í∞úÎ∞úÏûêÏùò ÏÉùÏÇ∞ÏÑ±ÏùÑ Ìñ•ÏÉÅÌï¥Ï£ºÍ≥†, Îπ†Î•¥Í≥†, ÌÖåÏä§Ìä∏ Í∞ÄÎä•ÌïòÍ≥† ÌôïÏû• Í∞ÄÎä•Ìïú ÌîÑÎ°†Ìä∏ÏóîÎìú Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖòÏùò Í∞úÎ∞úÏùÑ Í∞ÄÎä•ÌïòÍ≤å Ìï¥Ï£ºÎäî <a href="https://angular.io/" target="_blank">Angular</a>ÏôÄ <a href="https://github.com/facebook/react" target="_blank">React</a>, <a href="https://github.com/vuejs/vue" target="_blank">Vue</a> Îì±Ïùò Î©ãÏßÑ ÌîÑÎ°úÏ†ùÌä∏Îì§Ïù¥ Îì±Ïû•ÌñàÏßÄÎßå. Ïù¥ÏôÄ Î∞òÌï¥ ÏÑúÎ≤Ñ ÏÇ¨Ïù¥Îìú Î∂ÑÏïºÏóêÏÑúÎäî ÏÇ¨Ïö©ÏûêÎ•º ÎèÑÏôÄÏ£ºÎäî ÌõåÎ•≠Ìïú ÎùºÏù¥Î∏åÎü¨Î¶¨Í∞Ä Îã§ÏñëÌïòÍ≤å Ï°¥Ïû¨ÌïòÏßÄÎßå, Ïù¥ Ï§ë Ïñ¥Îäê Í≤ÉÎèÑ Í∞ÄÏû• Ï§ëÏöîÌïú Î¨∏Ï†úÎ•º Ìö®Í≥ºÏ†ÅÏúºÎ°ú Ìï¥Í≤∞ÌïòÏßÄ Î™ªÌñàÏäµÎãàÎã§. - Íµ¨Ï°∞(architecture)Ïùò Î¨∏Ï†ú.</p>
-<p>NestÎäî Í∞ÑÌé∏ÌïòÍ≤å Í≥†ÏàòÏ§ÄÏúºÎ°ú ÌÖåÏä§Ìä∏ Í∞ÄÎä•ÌïòÍ≥†, ÌôïÏû• Í∞ÄÎä•ÌïòÎ©¥ÏÑú, ÎÇ¥Î∂Ä ÏùòÏ°¥ÏÑ±Ïù¥ ÎÇÆÏúºÎ©∞(loosely coupled), Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖòÏùÑ ÏâΩÍ≤å Ïú†ÏßÄÌï† Ïàò ÏûàÎäî ÌòÅÏã†Ï†ÅÏù∏ Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖò Íµ¨Ï°∞(architecture)Î•º Ï†úÍ≥µÌïòÎäî Í≤ÉÏùÑ Î™©ÌëúÎ°ú Ìï©ÎãàÎã§. Nest Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖòÏùò Íµ¨Ï°∞(architecture)Îäî AngularÎ°úÎ∂ÄÌÑ∞ ÎßéÏùÄ ÏòÅÍ∞êÏùÑ Î∞õÏïòÏäµÎãàÎã§. </p>
+<p>ÏµúÍ∑º Î™á ÎÖÑÍ∞Ñ JavascriptÎäî Node.jsÏùò Î∞úÏ†ÑÏóê Îî∞Îùº ÏõπÏùò ÌîÑÎ°†Ìä∏ÏóîÎìúÏôÄ Î∞±ÏóîÎìúÏóê ÏûàÏñ¥ÏÑú "Í≥µÏö©Ïñ¥"Í∞Ä ÎêòÏóàÏäµÎãàÎã§. Í∑∏Î¶¨Í≥† ÌîÑÎ°†Ìä∏ÏóîÎìúÏóêÏÑúÎäî <a href="https://angular.io/" target="_blank">Angular</a>ÏôÄ <a href="https://github.com/facebook/react" target="_blank">React</a>, <a href="https://github.com/vuejs/vue" target="_blank">Vue</a>ÏôÄ Í∞ôÏù¥ Î©ãÏßÑ ÌîÑÎ°úÏ†ùÌä∏Îì§Ïù¥ Îì±Ïû•ÌïòÏó¨ Í∞úÎ∞úÏûêÏùò ÏÉùÏÇ∞ÏÑ±ÏùÑ Ìñ•ÏÉÅÏãúÏº∞ÏúºÎ©∞, Îπ†Î•¥Í≥† ÌÖåÏä§Ìä∏ÏôÄ ÌôïÏû•Ïù¥ Í∞ÄÎä•Ìïú ÌîÑÎ°†Ìä∏ÏóîÎìú Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖòÏùÑ ÎßåÎì§ Ïàò ÏûàÍ≤å Ìï¥Ï£ºÏóàÏäµÎãàÎã§. ÌïòÏßÄÎßå ÏÑúÎ≤Ñ ÏÇ¨Ïù¥ÎìúÏóêÏÑúÎäî Node.jsÎ•º ÏúÑÌïú Ïö∞ÏàòÌïú ÎùºÏù¥Î∏åÎü¨Î¶¨ÏôÄ Ìà¥Ïù¥ ÎßéÏùÄ Í∞ÄÏö¥Îç∞, Ï£ºÏöî Î¨∏Ï†úÎ•º Ìö®Í≥ºÏ†ÅÏúºÎ°ú Ìï¥Í≤∞ÌïòÎäî Í≤ÉÏùÄ ÏóÜÏóàÏäµÎãàÎã§. Í∑∏ Ï£ºÏöî Î¨∏Ï†úÎûÄ Î∞îÎ°ú ÏïÑÌÇ§ÌÖçÏ≤ò(architecture)ÏûÖÎãàÎã§.</p>
+<p>NestÎäî ÌÖåÏä§Ìä∏ ÏπúÌôîÏ†ÅÏù¥Î©¥ÏÑú ÌôïÏû•Ïù¥ Í∞ÄÎä•ÌïòÍ≥† Í≤∞Ìï©Ïù¥ ÎäêÏä®ÌïòÎ©∞, Ïú†ÏßÄ Í¥ÄÎ¶¨Í∞Ä Ïö©Ïù¥Ìïú Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖòÏùÑ ÏÜêÏâΩÍ≤å ÎßåÎì§ Ïàò ÏûàÎäî Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖò ÏïÑÌÇ§ÌÖçÏ≤ò Ï†úÍ≥µÏùÑ Î™©ÌëúÎ°ú Ìï©ÎãàÎã§. Ïù¥ ÏïÑÌÇ§ÌÖçÏ≤òÎäî AngularÏóêÏÑú ÎßéÏùÄ ÏòÅÍ∞êÏùÑ Î∞õÏïòÏäµÎãàÎã§.</p>
 
-## ÏãúÏûëÌïòÎ†§Î©¥
+## ÏãúÏûëÌïòÍ∏∞
 
 * To check out the [guide](https://docs.nestjs.com), visit [docs.nestjs.com](https://docs.nestjs.com). :books:
 * Ë¶ÅÊü•Áúã‰∏≠Êñá [ÊåáÂçó](readme_zh.md), ËØ∑ËÆøÈóÆ [docs.nestjs.cn](https://docs.nestjs.cn). :books:
-* [Í∞ÄÏù¥Îìú](readme_kr.md)Î•º ÌôïÏù∏ÌïòÎ†§Î©¥, [docs.nestjs.com](https://docs.nestjs.com)Î•º Î∞©Î¨∏ÌïòÏÑ∏Ïöî.:books: 
-* „ÉÅ„Çß„ÉÉ„ÇØ„Åô„Çã„Å´„ÅØ [„Ç¨„Ç§„Éâ](readme_jp.md), Ë©≥„Åó„Åè„ÅØ [docs.nestjs.com](https://docs.nestjs.com).:books:
+* [Í∞ÄÏù¥Îìú](readme_kr.md) Î¨∏ÏÑúÎäî [docs.nestjs.com](https://docs.nestjs.com)ÏóêÏÑú ÌôïÏù∏ÌïòÏã§ Ïàò ÏûàÏäµÎãàÎã§. :books:
+* [„Ç¨„Ç§„Éâ](readme_jp.md)„ÅØ [docs.nestjs.com](https://docs.nestjs.com)„Åß„ÅîÁ¢∫Ë™ç„Åè„Å†„Åï„ÅÑ„ÄÇ :books:
 
 ## ÏßàÎ¨∏
 
-ÏßàÎ¨∏ ÏÇ¨Ìï≠Ïù¥ ÏûàÍ±∞ÎÇò ÏßÄÏõêÏùÑ Î∞õÏúºÎ†§Î©¥ Í≥µÏãù [ÎîîÏä§ÏΩîÎìú Ï±ÑÎÑê](https://discord.gg/G7Qnnhy)ÏùÑ Ïù¥Ïö©Ìï¥Ï£ºÏÑ∏Ïöî.
-Ïù¥ Ï†ÄÏû•ÏÜå(repo)Ïùò Ïù¥Ïäà Î™©Î°ùÏùÄ **Ïò§ÏßÅ** Î≤ÑÍ∑∏ Î¶¨Ìè¨Ìä∏ÏôÄ Í∏∞Îä• ÏöîÏ≤≠Îßå Í∞ÄÎä•Ìï©ÎãàÎã§. 
+ÏßàÎ¨∏Ïù¥ ÏûàÍ±∞ÎÇò ÏßÄÏõêÏùÑ Î∞õÍ≥† Ïã∂ÏúºÏã§ Í≤ΩÏö∞ Í≥µÏãù [ÎîîÏä§ÏΩîÎìú Ï±ÑÎÑê](https://discord.gg/G7Qnnhy)ÏùÑ Ïù¥Ïö©Ìï¥Ï£ºÏÑ∏Ïöî.
+Ïù¥ Ï†ÄÏû•ÏÜåÏùò Ïù¥Ïäà Î™©Î°ùÏùÄ Î≤ÑÍ∑∏ Î¶¨Ìè¨Ìä∏ÏôÄ Í∏∞Îä• ÏöîÏ≤≠ **Ï†ÑÏö©**ÏúºÎ°ú ÏÇ¨Ïö©ÎêòÍ≥† ÏûàÏäµÎãàÎã§.
 
+## Ïù¥Ïäà
 
-## Ïù¥Ïäà(Issues)
-
-
- IssueÎ•º Ï†úÎ≥¥ÌïòÍ∏∞ Ï†ÑÏóê [Issue Ï†úÎ≥¥ Ï†Ñ Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏](https://github.com/nestjs/nest/blob/master/CONTRIBUTING.md#-submitting-an-issue)Î•º ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî. Í∞ÄÏù¥ÎìúÎùºÏù∏Ïóê ÎßûÏßÄ ÏïäÎäî Ïù¥ÏäàÎì§ÏùÄ Ï¶âÏãú ÏÇ≠Ï†úÎê† Ïàò ÏûàÏäµÎãàÎã§.
-
+Ïù¥ÏäàÎ•º Ïò¨Î¶¨Í∏∞ Ï†ÑÏóê Î∞òÎìúÏãú [Ïù¥Ïäà Î≥¥Í≥† Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏](https://github.com/nestjs/nest/blob/master/CONTRIBUTING.md#-submitting-an-issue)Î•º ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî. Í∞ÄÏù¥ÎìúÎùºÏù∏Ïóê ÎßûÏßÄ ÏïäÎäî Ïù¥ÏäàÎäî Î∞îÎ°ú ÌÅ¥Î°úÏ¶àÎê† Ïàò ÏûàÏäµÎãàÎã§.
 
 ## ÏûêÎ¨∏
 
-Í≥µÏãùÏ†ÅÏù∏ ÏßÄÏõêÏùÑ ÌÜµÌï¥, Nest core ÌåÄÏùò Ï†ÑÎ¨∏Ï†ÅÏù∏ ÎèÑÏõÄÏùÑ Î∞õÏùÑ Ïàò ÏûàÏäµÎãàÎã§. Ïö∞Î¶¨Îäî Ï†ÑÎÖêÏ†Å Í∏∞Ïà† ÏßÄÏõê, Ïù¥Ï£º(migration) Ï†ÑÎûµ, Î™®Î≤îÏÇ¨Î°ÄÏóê ÎåÄÌïú Ï°∞Ïñ∏(Î∞è ÏÑ§Í≥Ñ Í≤∞Ï†ï), PR Î¶¨Î∑∞, ÌåÄ Ï¶ùÎåÄ(team augment)Îì±ÏùÑ Ï†úÍ≥µÌï©ÎãàÎã§. Îçî ÎßéÏùÄ ÎÇ¥Ïö©ÏùÑ Î≥¥ÏãúÎ†§Î©¥ [ÏßÄÏõê](https://enterprise.nestjs.com)ÏùÑ Î∞©Î¨∏Ìï¥Ï£ºÏÑ∏Ïöî.
+Í≥µÏãù ÏßÄÏõêÏùÑ ÌÜµÌï¥ Nest core ÌåÄÏùò Ï†ÑÎ¨∏Ï†ÅÏù∏ ÎèÑÏõÄÏùÑ Î∞õÏùÑ Ïàò ÏûàÏäµÎãàÎã§. Ïö∞Î¶¨Îäî Ï†ÑÎã¥ Í∏∞Ïà† ÏßÄÏõê, ÎßàÏù¥Í∑∏Î†àÏù¥ÏÖò Ï†ÑÎûµ, Î™®Î≤î ÏÇ¨Î°Ä Î∞è ÏÑ§Í≥ÑÏóê ÎåÄÌïú Ï°∞Ïñ∏, PR Î¶¨Î∑∞, ÌåÄ Î≥¥Í∞ïÏóê ÎåÄÌïú ÎèÑÏõÄÏùÑ Ï†úÍ≥µÌï©ÎãàÎã§. Îçî ÏûêÏÑ∏Ìïú ÎÇ¥Ïö©ÏùÄ [Í≥µÏãù ÏßÄÏõê ÌéòÏù¥ÏßÄ](https://enterprise.nestjs.com)ÏóêÏÑú ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.
 
-## ÏßÄÏõê
+## ÏÑúÌè¨Ìä∏
 
-NestÎäî MIT-licensed Ïò§Ìîà ÏÜåÏä§ ÌîÑÎ°úÏ†ùÌä∏ÏûÖÎãàÎã§. NestÎäî ÌõÑÏõêÏûêÏôÄ ÎÜÄÎùºÏö¥ Í∏∞Ïó¨ÏûêÎì§Ïùò ÏßÄÏõêÏúºÎ°ú ÏÑ±Ïû•Ìï† Ïàò ÏûàÏäµÎãàÎã§. Ï∞∏Ïó¨ÌïòÍ≥† Ïã∂ÏúºÏãúÎã§Î©¥ [Ïó¨Í∏∞](https://docs.nestjs.com/support)Î•º Î∞©Î¨∏Ìï¥Ï£ºÏÑ∏Ïöî.
+NestÎäî MIT License Ïò§Ìîà ÏÜåÏä§ ÌîÑÎ°úÏ†ùÌä∏Ïù¥Î©∞, Í∞êÏÇ¨ÌïòÍ≤åÎèÑ ÌõÑÏõêÏûêÎì§Í≥º ÍµâÏû•Ìïú Í∏∞Ïó¨ÏûêÎì§Ïùò ÏÑúÌè¨Ìä∏Î•º ÌÜµÌï¥ÏÑú ÎçîÏö± ÏÑ±Ïû•Ìï† Ïàò ÏûàÏäµÎãàÎã§. Ï∞∏Ïó¨ÌïòÍ≥† Ïã∂ÏúºÏãúÎã§Î©¥ [ÏÑúÌè¨Ìä∏ Î¨∏ÏÑú](https://docs.nestjs.com/support)Î•º ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.
 
-## Stay in touch
+## Ïó∞ÎùΩÏ≤ò
 
 * Author - [Kamil My≈õliwiec](https://twitter.com/kammysliwiec)
 * Website - [https://nestjs.com](https://nestjs.com/)
diff --git a/readme_zh.md b/readme_zh.md
index 96c485a9e..0959d0a1e 100644
--- a/readme_zh.md
+++ b/readme_zh.md
@@ -1,22 +1,22 @@
 <p align="center">
-  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo_text.svg" width="320" alt="Nest Logo" /></a>
-
-[travis-image]: https://api.travis-ci.org/nestjs/nest.svg?branch=master
-[travis-url]: https://travis-ci.org/nestjs/nest
-[linux-image]: https://img.shields.io/travis/nestjs/nest/master.svg?label=linux
-[linux-url]: https://travis-ci.org/nestjs/nest
-  
- <p align="center">Áî®‰∫éÊûÑÂª∫È´òÊïà‰∏îÂèØÊâ©Â±ïÁöÑÊúçÂä°Âô®Á´ØÂ∫îÁî®Á®ãÂ∫èÁöÑÊ∏êËøõÂºè <a href="http://nodejs.cn" target="blank">Node.js</a> Ê°ÜÊû∂ÔºåÊ∑±Âèó <a href="https://angular.cn" target="_blank">Angular</a> ÁöÑÂêØÂèë„ÄÇ</p> 
+  <a href="https://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
+</p>
+
+[circleci-image]: https://img.shields.io/circleci/build/github/nestjs/nest/master?token=abc123def456
+[circleci-url]: https://circleci.com/gh/nestjs/nest
+
+  <p align="center">Áî®‰∫éÊûÑÂª∫È´òÊïà‰∏îÂèØÊâ©Â±ïÁöÑÊúçÂä°Âô®Á´ØÂ∫îÁî®Á®ãÂ∫èÁöÑÊ∏êËøõÂºè <a href="https://nodejs.cn" target="blank">Node.js</a> Ê°ÜÊû∂ÔºåÊ∑±Âèó <a href="https://angular.cn" target="_blank">Angular</a> ÁöÑÂêØÂèë„ÄÇ</p>
     <p align="center">
-<a href="https://www.npmjs.com/~nestjscore"><img src="https://img.shields.io/npm/v/@nestjs/core.svg" alt="NPM Version" /></a>
-<a href="https://www.npmjs.com/~nestjscore"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
-<a href="https://www.npmjs.com/~nestjscore"><img src="https://img.shields.io/npm/dm/@nestjs/core.svg" alt="NPM Downloads" /></a>
-<a href="https://travis-ci.org/nestjs/nest"><img src="https://api.travis-ci.org/nestjs/nest.svg?branch=master" alt="Travis" /></a>
-<a href="https://travis-ci.org/nestjs/nest"><img src="https://img.shields.io/travis/nestjs/nest/master.svg?label=linux" alt="Linux" /></a>
-<a href="https://coveralls.io/github/nestjs/nest?branch=master"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#5" alt="Coverage" /></a>
+<a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/v/@nestjs/core.svg" alt="NPM Version" /></a>
+<a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
+<a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
+<a href="https://circleci.com/gh/nestjs/nest" target="_blank"><img src="https://img.shields.io/circleci/build/github/nestjs/nest/master" alt="CircleCI" /></a>
 <a href="https://discord.gg/G7Qnnhy" target="_blank"><img src="https://img.shields.io/badge/discord-online-brightgreen.svg" alt="Discord"/></a>
-<a href="https://opencollective.com/nest#backer"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
-<a href="https://opencollective.com/nest#sponsor"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
+<a href="https://opencollective.com/nest#backer" target="_blank"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
+<a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
+  <a href="https://paypal.me/kamilmysliwiec" target="_blank"><img src="https://img.shields.io/badge/Donate-PayPal-ff3f59.svg"/></a>
+    <a href="https://opencollective.com/nest#sponsor"  target="_blank"><img src="https://img.shields.io/badge/Support%20us-Open%20Collective-41B883.svg" alt="Support us"></a>
+  <a href="https://twitter.com/nestframework" target="_blank"><img src="https://img.shields.io/twitter/follow/nestframework.svg?style=social&label=Follow"></a>
 </p>
   <!--[![Backers on Open Collective](https://opencollective.com/nest/backers/badge.svg)](https://opencollective.com/nest#backer)
   [![Sponsors on Open Collective](https://opencollective.com/nest/sponsors/badge.svg)](https://opencollective.com/nest#sponsor)-->
@@ -26,8 +26,8 @@
 
 ## ‰ªãÁªç
 
-<p>NestÊòØÊûÑÂª∫È´òÊïàÔºåÂèØÊâ©Â±ïÁöÑ <a href="http://nodejs.cn" target="blank">Node.js</a> Web Â∫îÁî®Á®ãÂ∫èÁöÑÊ°ÜÊû∂„ÄÇ ÂÆÉ‰ΩøÁî®Áé∞‰ª£ÁöÑ JavaScript Êàñ <a href="https://www.tslang.cn" target="_blank">TypeScript</a>Ôºà‰øùÁïô‰∏éÁ∫Ø JavaScript ÁöÑÂÖºÂÆπÊÄßÔºâÔºåÂπ∂ÁªìÂêà OOPÔºàÈù¢ÂêëÂØπË±°ÁºñÁ®ãÔºâÔºåFPÔºàÂáΩÊï∞ÂºèÁºñÁ®ãÔºâÂíåFRPÔºàÂáΩÊï∞ÂìçÂ∫îÂºèÁºñÁ®ãÔºâÁöÑÂÖÉÁ¥†„ÄÇ</p>
-<p>Âú®Â∫ïÂ±ÇÔºåNest ‰ΩøÁî®‰∫Ü <a href="http://www.expressjs.com.cn" target="_blank">Express</a>Ôºå‰ΩÜ‰πüÊèê‰æõ‰∫Ü‰∏éÂÖ∂‰ªñÂêÑÁßçÂ∫ìÁöÑÂÖºÂÆπÔºå‰æãÂ¶Ç<a href="https://github.com/fastify/fastify" target="blank">Fastify</a>ÔºåÂèØ‰ª•Êñπ‰æøÂú∞‰ΩøÁî®ÂêÑÁßçÂèØÁî®ÁöÑÁ¨¨‰∏âÊñπÊèí‰ª∂„ÄÇ</p>
+<p>NestÊòØÊûÑÂª∫È´òÊïàÔºåÂèØÊâ©Â±ïÁöÑ <a href="https://nodejs.cn" target="blank">Node.js</a> Web Â∫îÁî®Á®ãÂ∫èÁöÑÊ°ÜÊû∂„ÄÇ ÂÆÉ‰ΩøÁî®Áé∞‰ª£ÁöÑ JavaScript Êàñ <a href="https://www.tslang.cn" target="_blank">TypeScript</a>Ôºà‰øùÁïô‰∏éÁ∫Ø JavaScript ÁöÑÂÖºÂÆπÊÄßÔºâÔºåÂπ∂ÁªìÂêà OOPÔºàÈù¢ÂêëÂØπË±°ÁºñÁ®ãÔºâÔºåFPÔºàÂáΩÊï∞ÂºèÁºñÁ®ãÔºâÂíåFRPÔºàÂáΩÊï∞ÂìçÂ∫îÂºèÁºñÁ®ãÔºâÁöÑÂÖÉÁ¥†„ÄÇ</p>
+<p>Âú®Â∫ïÂ±ÇÔºåNest ‰ΩøÁî®‰∫Ü <a href="https://www.expressjs.com.cn" target="_blank">Express</a>Ôºå‰ΩÜ‰πüÊèê‰æõ‰∫Ü‰∏éÂÖ∂‰ªñÂêÑÁßçÂ∫ìÁöÑÂÖºÂÆπÔºå‰æãÂ¶Ç<a href="https://github.com/fastify/fastify" target="blank">Fastify</a>ÔºåÂèØ‰ª•Êñπ‰æøÂú∞‰ΩøÁî®ÂêÑÁßçÂèØÁî®ÁöÑÁ¨¨‰∏âÊñπÊèí‰ª∂„ÄÇ</p>
 
 ## ËÆæËÆ°Âì≤Â≠¶
 
@@ -46,7 +46,7 @@ QQÁæ§Ôºö277386223
 QQÁæ§Ôºö336289049
 QQÁæ§Ôºö489719517
 
-> Ê≥®ÊÑèÔºöËøô‰∏™‰∫§ÊµÅÁæ§‰∏çÊòØ NestJS ÂÆòÊñπÊîØÊåÅÂíåÁª¥Êä§ÁöÑÔºåÂè™ÊòØ‰∏∫‰∫ÜÊñπ‰æøÂõΩÂÜÖÂºÄÂèëËÄÖ‰∫§ÊµÅËÄåÂª∫Á´ãÁöÑ„ÄÇ  
+> Ê≥®ÊÑèÔºöËøô‰∏™‰∫§ÊµÅÁæ§‰∏çÊòØ NestJS ÂÆòÊñπÊîØÊåÅÂíåÁª¥Êä§ÁöÑÔºåÂè™ÊòØ‰∏∫‰∫ÜÊñπ‰æøÂõΩÂÜÖÂºÄÂèëËÄÖ‰∫§ÊµÅËÄåÂª∫Á´ãÁöÑ„ÄÇ
 > ÔºàNote: This channel is not officially supported and maintained by the NestJS org members.Ôºâ
 
 ## ËµûÂä©ÂïÜ
diff --git a/renovate.json b/renovate.json
index a75e902ef..26c1d72d6 100644
--- a/renovate.json
+++ b/renovate.json
@@ -1,7 +1,5 @@
 {
-  "extends": [
-    "config:base"
-  ],
+  "extends": ["config:base", ":dependencyDashboard"],
   "labels": ["dependencies"],
   "packageRules": [
     {
diff --git a/sample/01-cats-app/package-lock.json b/sample/01-cats-app/package-lock.json
index f35631637..9f2b84f3c 100644
Binary files a/sample/01-cats-app/package-lock.json and b/sample/01-cats-app/package-lock.json differ
diff --git a/sample/01-cats-app/package.json b/sample/01-cats-app/package.json
index f5b921386..54f02096e 100644
--- a/sample/01-cats-app/package.json
+++ b/sample/01-cats-app/package.json
@@ -19,36 +19,36 @@
     "test:e2e": "jest --config ./e2e/jest-e2e.json"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "class-transformer": "0.4.0",
-    "class-validator": "0.13.2",
-    "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/platform-express": "10.4.10",
+    "class-transformer": "0.5.1",
+    "class-validator": "0.14.1",
+    "reflect-metadata": "0.2.1",
+    "rimraf": "5.0.10",
+    "rxjs": "7.8.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.7",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.19",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@nestjs/testing": "10.4.10",
+    "@types/express": "4.17.21",
+    "@types/jest": "29.5.12",
+    "@types/node": "20.17.8",
+    "@types/supertest": "6.0.2",
+    "jest": "29.7.0",
+    "prettier": "3.2.5",
+    "supertest": "6.3.4",
+    "ts-jest": "29.1.2",
+    "ts-loader": "9.5.1",
+    "ts-node": "10.9.2",
+    "tsconfig-paths": "4.2.0",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.42.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-import": "2.29.1",
+    "typescript": "5.3.3"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/01-cats-app/src/cats/cats.controller.spec.ts b/sample/01-cats-app/src/cats/cats.controller.spec.ts
index cce227165..5eb9ac4f9 100644
--- a/sample/01-cats-app/src/cats/cats.controller.spec.ts
+++ b/sample/01-cats-app/src/cats/cats.controller.spec.ts
@@ -19,16 +19,36 @@ describe('CatsController', () => {
 
   describe('findAll', () => {
     it('should return an array of cats', async () => {
-      const result: Cat[] = [
+      const cats: Cat[] = [
         {
           age: 2,
           breed: 'Bombay',
           name: 'Pixel',
         },
       ];
-      jest.spyOn(catsService, 'findAll').mockImplementation(() => result);
+      // @ts-ignore
+      catsService.cats = cats;
 
-      expect(await catsController.findAll()).toBe(result);
+      expect(await catsController.findAll()).toBe(cats);
+    });
+  });
+
+  describe('create', () => {
+    it('should add a new cat', async () => {
+      const cat: Cat = {
+        age: 2,
+        breed: 'Bombay',
+        name: 'Pixel',
+      };
+      const expectedCatArray = [cat];
+
+      // @ts-ignore
+      expect(catsService.cats).toStrictEqual([]);
+
+      await catsController.create(cat);
+
+      // @ts-ignore
+      expect(catsService.cats).toStrictEqual(expectedCatArray);
     });
   });
 });
diff --git a/sample/01-cats-app/src/cats/cats.controller.ts b/sample/01-cats-app/src/cats/cats.controller.ts
index 2008e3de7..0d02279dc 100644
--- a/sample/01-cats-app/src/cats/cats.controller.ts
+++ b/sample/01-cats-app/src/cats/cats.controller.ts
@@ -12,7 +12,7 @@ export class CatsController {
   constructor(private readonly catsService: CatsService) {}
 
   @Post()
-  @Roles('admin')
+  @Roles(['admin'])
   async create(@Body() createCatDto: CreateCatDto) {
     this.catsService.create(createCatDto);
   }
diff --git a/sample/01-cats-app/src/cats/cats.service.spec.ts b/sample/01-cats-app/src/cats/cats.service.spec.ts
new file mode 100644
index 000000000..f6847ee9f
--- /dev/null
+++ b/sample/01-cats-app/src/cats/cats.service.spec.ts
@@ -0,0 +1,48 @@
+import { Test } from '@nestjs/testing';
+import { CatsService } from './cats.service';
+import { Cat } from './interfaces/cat.interface';
+
+describe('CatsService', () => {
+  let catsService: CatsService;
+
+  beforeEach(async () => {
+    const moduleRef = await Test.createTestingModule({
+      providers: [CatsService],
+    }).compile();
+
+    catsService = moduleRef.get<CatsService>(CatsService);
+  });
+
+  describe('findAll', () => {
+    it('should return an array of cats', async () => {
+      const result = [
+        {
+          name: 'Frajola',
+          age: 2,
+          breed: 'Stray',
+        },
+      ];
+      //@ts-ignore
+      catsService.cats = result;
+
+      await expect(catsService.findAll()).resolves.toBe(result);
+    });
+  });
+
+  describe('create', () => {
+    it('should add a new cat', async () => {
+      const cat: Cat = {
+        name: 'Frajola',
+        age: 2,
+        breed: 'Stray',
+      };
+      const expectedCatArray = [cat];
+      //@ts-ignore
+      expect(catsService.cats).toStrictEqual([]);
+
+      await catsService.create(cat);
+      //@ts-ignore
+      expect(catsService.cats).toStrictEqual(expectedCatArray);
+    });
+  });
+});
diff --git a/sample/01-cats-app/src/cats/cats.service.ts b/sample/01-cats-app/src/cats/cats.service.ts
index 2619cd717..955f56408 100644
--- a/sample/01-cats-app/src/cats/cats.service.ts
+++ b/sample/01-cats-app/src/cats/cats.service.ts
@@ -9,7 +9,7 @@ export class CatsService {
     this.cats.push(cat);
   }
 
-  findAll(): Cat[] {
-    return this.cats;
+  findAll(): Promise<Cat[]> {
+    return Promise.resolve(this.cats);
   }
 }
diff --git a/sample/01-cats-app/src/common/decorators/roles.decorator.ts b/sample/01-cats-app/src/common/decorators/roles.decorator.ts
index b0376727c..b69b3734a 100644
--- a/sample/01-cats-app/src/common/decorators/roles.decorator.ts
+++ b/sample/01-cats-app/src/common/decorators/roles.decorator.ts
@@ -1,3 +1,3 @@
-import { SetMetadata } from '@nestjs/common';
+import { Reflector } from '@nestjs/core';
 
-export const Roles = (...roles: string[]) => SetMetadata('roles', roles);
+export const Roles = Reflector.createDecorator<string[]>();
diff --git a/sample/01-cats-app/src/common/guards/roles.guard.ts b/sample/01-cats-app/src/common/guards/roles.guard.ts
index 0ae26c41d..59636afa8 100644
--- a/sample/01-cats-app/src/common/guards/roles.guard.ts
+++ b/sample/01-cats-app/src/common/guards/roles.guard.ts
@@ -1,12 +1,13 @@
 import { CanActivate, ExecutionContext, Injectable } from '@nestjs/common';
 import { Reflector } from '@nestjs/core';
+import { Roles } from '../decorators/roles.decorator';
 
 @Injectable()
 export class RolesGuard implements CanActivate {
   constructor(private readonly reflector: Reflector) {}
 
   canActivate(context: ExecutionContext): boolean {
-    const roles = this.reflector.get<string[]>('roles', context.getHandler());
+    const roles = this.reflector.get(Roles, context.getHandler());
     if (!roles) {
       return true;
     }
diff --git a/sample/01-cats-app/src/common/pipes/validation.pipe.ts b/sample/01-cats-app/src/common/pipes/validation.pipe.ts
index 9df091a88..1a79ae214 100644
--- a/sample/01-cats-app/src/common/pipes/validation.pipe.ts
+++ b/sample/01-cats-app/src/common/pipes/validation.pipe.ts
@@ -5,7 +5,7 @@ import {
   PipeTransform,
   Type,
 } from '@nestjs/common';
-import { plainToClass } from 'class-transformer';
+import { plainToInstance } from 'class-transformer';
 import { validate } from 'class-validator';
 
 @Injectable()
@@ -15,7 +15,7 @@ export class ValidationPipe implements PipeTransform<any> {
     if (!metatype || !this.toValidate(metatype)) {
       return value;
     }
-    const object = plainToClass(metatype, value);
+    const object = plainToInstance(metatype, value);
     const errors = await validate(object);
     if (errors.length > 0) {
       throw new BadRequestException('Validation failed');
diff --git a/sample/01-cats-app/tsconfig.json b/sample/01-cats-app/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/01-cats-app/tsconfig.json
+++ b/sample/01-cats-app/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/02-gateways/e2e/events-gateway/gateway.e2e-spec.ts b/sample/02-gateways/e2e/events-gateway/gateway.e2e-spec.ts
new file mode 100644
index 000000000..c9dbfd51e
--- /dev/null
+++ b/sample/02-gateways/e2e/events-gateway/gateway.e2e-spec.ts
@@ -0,0 +1,55 @@
+import { INestApplication } from '@nestjs/common';
+import { Test } from '@nestjs/testing';
+import { AppModule } from '../../src/app.module';
+import { io, Socket } from 'socket.io-client';
+
+describe('EventsGateway', () => {
+  let app: INestApplication;
+  let socket: Socket;
+
+  beforeAll(async () => {
+    const moduleRef = await Test.createTestingModule({
+      imports: [AppModule],
+    }).compile();
+
+    app = moduleRef.createNestApplication();
+    await app.listen(3000);
+  });
+
+  beforeEach(done => {
+    socket = io('http://localhost:3000');
+    socket.on('connect', () => {
+      done();
+    });
+  });
+
+  describe('findAll', () => {
+    it('should receive 3 numbers', done => {
+      let eventCount = 1;
+      socket.emit('events', { test: 'test' });
+      socket.on('events', data => {
+        expect(data).toBe(eventCount);
+        if (++eventCount > 3) {
+          done();
+        }
+      });
+    });
+  });
+
+  describe('identity', () => {
+    it('should return the same number has what was sent', done => {
+      socket.emit('identity', 0, response => {
+        expect(response).toBe(0);
+        done();
+      });
+    });
+  });
+
+  afterEach(() => {
+    socket.disconnect();
+  });
+
+  afterAll(async () => {
+    await app.close();
+  });
+});
diff --git a/sample/02-gateways/e2e/jest-e2e.json b/sample/02-gateways/e2e/jest-e2e.json
new file mode 100644
index 000000000..72eb5c3c0
--- /dev/null
+++ b/sample/02-gateways/e2e/jest-e2e.json
@@ -0,0 +1,14 @@
+{
+    "moduleFileExtensions": [
+        "ts",
+        "tsx",
+        "js",
+        "json"
+    ],
+    "transform": {
+        "^.+\\.tsx?$": "ts-jest"
+    },
+    "testRegex": "/e2e/.*\\.(e2e-test|e2e-spec).(ts|tsx|js)$",
+    "collectCoverageFrom" : ["src/**/*.{js,jsx,tsx,ts}", "!**/node_modules/**", "!**/vendor/**"],
+    "coverageReporters": ["json", "lcov"]
+}
\ No newline at end of file
diff --git a/sample/02-gateways/jest.json b/sample/02-gateways/jest.json
new file mode 100644
index 000000000..591de12b6
--- /dev/null
+++ b/sample/02-gateways/jest.json
@@ -0,0 +1,14 @@
+{
+  "moduleFileExtensions": [
+        "ts",
+        "tsx",
+        "js",
+        "json"
+    ],
+    "transform": {
+        "^.+\\.tsx?$": "ts-jest"
+    },
+    "testRegex": "/src/.*\\.(test|spec).(ts|tsx|js)$",
+    "collectCoverageFrom" : ["src/**/*.{js,jsx,tsx,ts}", "!**/node_modules/**", "!**/vendor/**"],
+    "coverageReporters": ["json", "lcov"]
+}
\ No newline at end of file
diff --git a/sample/02-gateways/package-lock.json b/sample/02-gateways/package-lock.json
index d5faa1bd8..0c40594cb 100644
Binary files a/sample/02-gateways/package-lock.json and b/sample/02-gateways/package-lock.json differ
diff --git a/sample/02-gateways/package.json b/sample/02-gateways/package.json
index c5e99535d..13145376a 100644
--- a/sample/02-gateways/package.json
+++ b/sample/02-gateways/package.json
@@ -16,44 +16,61 @@
     "test:watch": "jest --watch",
     "test:cov": "jest --coverage",
     "test:debug": "node --inspect-brk -r tsconfig-paths/register -r ts-node/register node_modules/.bin/jest --runInBand",
-    "test:e2e": "echo 'No e2e tests implemented yet.'"
+    "test:e2e": "jest --config ./e2e/jest-e2e.json"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "@nestjs/platform-socket.io": "8.2.3",
-    "@nestjs/websockets": "8.2.3",
-    "class-transformer": "0.4.0",
-    "class-validator": "0.13.2",
-    "redis": "3.1.2",
-    "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0",
-    "socket.io-redis": "6.1.1"
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/platform-express": "10.4.10",
+    "@nestjs/platform-socket.io": "10.4.10",
+    "@nestjs/websockets": "10.4.10",
+    "@socket.io/redis-adapter": "8.2.1",
+    "class-transformer": "0.5.1",
+    "class-validator": "0.14.1",
+    "reflect-metadata": "0.2.1",
+    "rimraf": "5.0.10",
+    "rxjs": "7.8.1",
+    "socket.io": "4.7.4"
   },
   "devDependencies": {
-    "@types/socket.io": "3.0.1",
-    "@types/socket.io-redis": "1.0.27",
-    "@types/ws": "7.4.7",
-    "@nestjs/cli": "8.1.7",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/node": "16.11.19",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@nestjs/testing": "10.4.10",
+    "@types/express": "4.17.21",
+    "@types/jest": "29.5.12",
+    "@types/node": "20.17.8",
+    "@types/supertest": "6.0.2",
+    "@types/ws": "8.5.5",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.42.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-import": "2.29.1",
+    "jest": "29.7.0",
+    "prettier": "3.2.5",
+    "redis": "4.6.13",
+    "supertest": "6.3.4",
+    "ts-jest": "29.1.2",
+    "ts-loader": "9.5.1",
+    "ts-node": "10.9.2",
+    "tsconfig-paths": "4.2.0",
+    "typescript": "5.3.3"
+  },
+  "jest": {
+    "moduleFileExtensions": [
+      "js",
+      "json",
+      "ts"
+    ],
+    "rootDir": "src",
+    "testRegex": ".*\\.spec\\.ts$",
+    "transform": {
+      "^.+\\.(t|j)s$": "ts-jest"
+    },
+    "collectCoverageFrom": [
+      "**/*.(t|j)s"
+    ],
+    "coverageDirectory": "../coverage",
+    "testEnvironment": "node"
   }
 }
diff --git a/sample/02-gateways/src/adapters/redis-io.adapter.ts b/sample/02-gateways/src/adapters/redis-io.adapter.ts
index a0f83932a..e8c4467d0 100644
--- a/sample/02-gateways/src/adapters/redis-io.adapter.ts
+++ b/sample/02-gateways/src/adapters/redis-io.adapter.ts
@@ -1,16 +1,23 @@
 import { IoAdapter } from '@nestjs/platform-socket.io';
-import { RedisClient } from 'redis';
 import { ServerOptions } from 'socket.io';
-import { createAdapter } from 'socket.io-redis';
-
-const pubClient = new RedisClient({ host: 'localhost', port: 6379 });
-const subClient = pubClient.duplicate();
-const redisAdapter = createAdapter({ pubClient, subClient });
+import { createAdapter } from '@socket.io/redis-adapter';
+import { createClient } from 'redis';
 
 export class RedisIoAdapter extends IoAdapter {
+  private adapterConstructor: ReturnType<typeof createAdapter>;
+
+  async connectToRedis(): Promise<void> {
+    const pubClient = createClient({ url: `redis://localhost:6379` });
+    const subClient = pubClient.duplicate();
+
+    await Promise.all([pubClient.connect(), subClient.connect()]);
+
+    this.adapterConstructor = createAdapter(pubClient, subClient);
+  }
+
   createIOServer(port: number, options?: ServerOptions): any {
     const server = super.createIOServer(port, options);
-    server.adapter(redisAdapter);
+    server.adapter(this.adapterConstructor);
     return server;
   }
 }
diff --git a/sample/02-gateways/src/events/events.gateway.spec.ts b/sample/02-gateways/src/events/events.gateway.spec.ts
new file mode 100644
index 000000000..e40de3deb
--- /dev/null
+++ b/sample/02-gateways/src/events/events.gateway.spec.ts
@@ -0,0 +1,40 @@
+import { Test, TestingModule } from '@nestjs/testing';
+import { reduce } from 'rxjs/operators';
+import { EventsGateway } from './events.gateway';
+
+describe('EventsGateway', () => {
+  let gateway: EventsGateway;
+
+  beforeEach(async () => {
+    const module: TestingModule = await Test.createTestingModule({
+      providers: [EventsGateway],
+    }).compile();
+
+    gateway = module.get<EventsGateway>(EventsGateway);
+  });
+
+  it('should be defined', () => {
+    expect(gateway).toBeDefined();
+  });
+
+  describe('findAll', () => {
+    it('should return 3 numbers', done => {
+      gateway
+        .findAll({})
+        .pipe(reduce((acc, item) => [...acc, item], []))
+        .subscribe(results => {
+          expect(results.length).toBe(3);
+          results.forEach((result, index) =>
+            expect(result.data).toBe(index + 1),
+          );
+          done();
+        });
+    });
+  });
+
+  describe('identity', () => {
+    it('should return the same number has what was sent', async () => {
+      await expect(gateway.identity(1)).resolves.toBe(1);
+    });
+  });
+});
diff --git a/sample/02-gateways/src/main.ts b/sample/02-gateways/src/main.ts
index e1e10d969..02ced27bc 100644
--- a/sample/02-gateways/src/main.ts
+++ b/sample/02-gateways/src/main.ts
@@ -3,6 +3,12 @@ import { AppModule } from './app.module';
 
 async function bootstrap() {
   const app = await NestFactory.create(AppModule);
+
+  // Uncomment these lines to use the Redis adapter:
+  // const redisIoAdapter = new RedisIoAdapter(app);
+  // await redisIoAdapter.connectToRedis();
+  // app.useWebSocketAdapter(redisIoAdapter);
+
   await app.listen(3000);
   console.log(`Application is running on: ${await app.getUrl()}`);
 }
diff --git a/sample/02-gateways/tsconfig.json b/sample/02-gateways/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/02-gateways/tsconfig.json
+++ b/sample/02-gateways/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/03-microservices/package-lock.json b/sample/03-microservices/package-lock.json
index e8630bb4c..45dca2fa2 100644
Binary files a/sample/03-microservices/package-lock.json and b/sample/03-microservices/package-lock.json differ
diff --git a/sample/03-microservices/package.json b/sample/03-microservices/package.json
index 5d94e9443..5274960cb 100644
--- a/sample/03-microservices/package.json
+++ b/sample/03-microservices/package.json
@@ -19,36 +19,36 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/microservices": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "class-transformer": "0.4.0",
-    "class-validator": "0.13.2",
-    "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/microservices": "10.4.10",
+    "@nestjs/platform-express": "10.4.10",
+    "class-transformer": "0.5.1",
+    "class-validator": "0.14.1",
+    "reflect-metadata": "0.2.1",
+    "rimraf": "5.0.10",
+    "rxjs": "7.8.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.7",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/amqplib": "0.8.2",
-    "@types/express": "4.17.13",
-    "@types/node": "16.11.19",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@nestjs/testing": "10.4.10",
+    "@types/amqplib": "0.10.5",
+    "@types/express": "4.17.21",
+    "@types/node": "20.17.8",
+    "@types/supertest": "6.0.2",
+    "jest": "29.7.0",
+    "prettier": "3.2.5",
+    "supertest": "6.3.4",
+    "ts-jest": "29.1.2",
+    "ts-loader": "9.5.1",
+    "ts-node": "10.9.2",
+    "tsconfig-paths": "4.2.0",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.42.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-import": "2.29.1",
+    "typescript": "5.3.3"
   }
 }
diff --git a/sample/03-microservices/tsconfig.json b/sample/03-microservices/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/03-microservices/tsconfig.json
+++ b/sample/03-microservices/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/04-grpc/package-lock.json b/sample/04-grpc/package-lock.json
index 5e33939a6..4d9be5a83 100644
Binary files a/sample/04-grpc/package-lock.json and b/sample/04-grpc/package-lock.json differ
diff --git a/sample/04-grpc/package.json b/sample/04-grpc/package.json
index f0e0d0d2d..b724d454f 100644
--- a/sample/04-grpc/package.json
+++ b/sample/04-grpc/package.json
@@ -19,36 +19,37 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@grpc/grpc-js": "1.4.4",
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/microservices": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "class-transformer": "0.4.0",
-    "class-validator": "0.13.2",
-    "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "@grpc/grpc-js": "1.10.9",
+    "@grpc/reflection": "1.0.4",
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/microservices": "10.4.10",
+    "@nestjs/platform-express": "10.4.10",
+    "class-transformer": "0.5.1",
+    "class-validator": "0.14.1",
+    "reflect-metadata": "0.2.1",
+    "rimraf": "5.0.10",
+    "rxjs": "7.8.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/node": "16.11.19",
-    "@types/supertest": "2.0.11",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "jest": "27.3.1",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@nestjs/testing": "10.4.10",
+    "@types/express": "4.17.21",
+    "@types/node": "20.17.8",
+    "@types/supertest": "6.0.2",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.42.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-import": "2.29.1",
+    "jest": "29.7.0",
+    "prettier": "3.2.5",
+    "supertest": "6.3.4",
+    "ts-jest": "29.1.2",
+    "ts-loader": "9.5.1",
+    "ts-node": "10.9.2",
+    "tsconfig-paths": "4.2.0",
+    "typescript": "5.3.3"
   }
 }
diff --git a/sample/04-grpc/src/grpc-client.options.ts b/sample/04-grpc/src/grpc-client.options.ts
index 0c31bdc09..abdae9a88 100644
--- a/sample/04-grpc/src/grpc-client.options.ts
+++ b/sample/04-grpc/src/grpc-client.options.ts
@@ -1,10 +1,14 @@
-import { ClientOptions, Transport } from '@nestjs/microservices';
+import { ReflectionService } from '@grpc/reflection';
+import { GrpcOptions, Transport } from '@nestjs/microservices';
 import { join } from 'path';
 
-export const grpcClientOptions: ClientOptions = {
+export const grpcClientOptions: GrpcOptions = {
   transport: Transport.GRPC,
   options: {
     package: 'hero', // ['hero', 'hero2']
     protoPath: join(__dirname, './hero/hero.proto'), // ['./hero/hero.proto', './hero/hero2.proto']
+    onLoadPackageDefinition: (pkg, server) => {
+      new ReflectionService(pkg).addToServer(server);
+    },
   },
 };
diff --git a/sample/04-grpc/src/hero/hero.controller.ts b/sample/04-grpc/src/hero/hero.controller.ts
index 82a65234d..796a5e6a6 100644
--- a/sample/04-grpc/src/hero/hero.controller.ts
+++ b/sample/04-grpc/src/hero/hero.controller.ts
@@ -9,7 +9,7 @@ import { toArray } from 'rxjs/operators';
 import { HeroById } from './interfaces/hero-by-id.interface';
 import { Hero } from './interfaces/hero.interface';
 
-interface HeroService {
+interface HeroesService {
   findOne(data: HeroById): Observable<Hero>;
   findMany(upstream: Observable<HeroById>): Observable<Hero>;
 }
@@ -20,12 +20,12 @@ export class HeroController implements OnModuleInit {
     { id: 1, name: 'John' },
     { id: 2, name: 'Doe' },
   ];
-  private heroService: HeroService;
+  private heroesService: HeroesService;
 
   constructor(@Inject('HERO_PACKAGE') private readonly client: ClientGrpc) {}
 
   onModuleInit() {
-    this.heroService = this.client.getService<HeroService>('HeroService');
+    this.heroesService = this.client.getService<HeroesService>('HeroesService');
   }
 
   @Get()
@@ -35,21 +35,21 @@ export class HeroController implements OnModuleInit {
     ids$.next({ id: 2 });
     ids$.complete();
 
-    const stream = this.heroService.findMany(ids$.asObservable());
+    const stream = this.heroesService.findMany(ids$.asObservable());
     return stream.pipe(toArray());
   }
 
   @Get(':id')
   getById(@Param('id') id: string): Observable<Hero> {
-    return this.heroService.findOne({ id: +id });
+    return this.heroesService.findOne({ id: +id });
   }
 
-  @GrpcMethod('HeroService')
+  @GrpcMethod('HeroesService')
   findOne(data: HeroById): Hero {
     return this.items.find(({ id }) => id === data.id);
   }
 
-  @GrpcStreamMethod('HeroService')
+  @GrpcStreamMethod('HeroesService')
   findMany(data$: Observable<HeroById>): Observable<Hero> {
     const hero$ = new Subject<Hero>();
 
diff --git a/sample/04-grpc/src/hero/hero.proto b/sample/04-grpc/src/hero/hero.proto
index d13eec3f7..95235f69e 100644
--- a/sample/04-grpc/src/hero/hero.proto
+++ b/sample/04-grpc/src/hero/hero.proto
@@ -2,7 +2,7 @@ syntax = "proto3";
 
 package hero;
 
-service HeroService {
+service HeroesService {
   rpc FindOne (HeroById) returns (Hero);
   rpc FindMany (stream HeroById) returns (stream Hero);
 }
@@ -14,4 +14,4 @@ message HeroById {
 message Hero {
   int32 id = 1;
   string name = 2;
-}
\ No newline at end of file
+}
diff --git a/sample/04-grpc/tsconfig.json b/sample/04-grpc/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/04-grpc/tsconfig.json
+++ b/sample/04-grpc/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/05-sql-typeorm/.gitignore b/sample/05-sql-typeorm/.gitignore
index b5e5f9755..44c92371f 100644
--- a/sample/05-sql-typeorm/.gitignore
+++ b/sample/05-sql-typeorm/.gitignore
@@ -13,7 +13,6 @@ npm-debug.log
 /quick-start
 
 # tests
-/test
 /coverage
 /.nyc_output
 
diff --git a/sample/05-sql-typeorm/docker-compose.yml b/sample/05-sql-typeorm/docker-compose.yml
index eee25f209..a8b6aadb8 100644
--- a/sample/05-sql-typeorm/docker-compose.yml
+++ b/sample/05-sql-typeorm/docker-compose.yml
@@ -9,3 +9,11 @@ services:
       MYSQL_DATABASE: test
     ports:
       - "3306:3306"
+  db-test:
+    image: mysql:8
+    restart: always
+    environment:
+      MYSQL_ROOT_PASSWORD: root
+      MYSQL_DATABASE: test
+    ports:
+      - "3307:3306"
\ No newline at end of file
diff --git a/sample/05-sql-typeorm/package-lock.json b/sample/05-sql-typeorm/package-lock.json
index 5cb92b054..e782e7d6c 100644
Binary files a/sample/05-sql-typeorm/package-lock.json and b/sample/05-sql-typeorm/package-lock.json differ
diff --git a/sample/05-sql-typeorm/package.json b/sample/05-sql-typeorm/package.json
index d323d324e..b6f5499b6 100644
--- a/sample/05-sql-typeorm/package.json
+++ b/sample/05-sql-typeorm/package.json
@@ -19,37 +19,37 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "@nestjs/typeorm": "8.0.2",
-    "mysql2": "2.3.3",
-    "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0",
-    "typeorm": "0.2.41"
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/platform-express": "10.4.10",
+    "@nestjs/typeorm": "10.0.1",
+    "mysql2": "3.9.8",
+    "reflect-metadata": "0.2.2",
+    "rimraf": "5.0.10",
+    "rxjs": "7.8.1",
+    "typeorm": "0.3.20"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.7",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.19",
-    "@types/supertest": "2.0.11",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "jest": "27.3.1",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@nestjs/testing": "10.4.10",
+    "@types/express": "4.17.21",
+    "@types/jest": "29.5.12",
+    "@types/node": "20.17.8",
+    "@types/supertest": "6.0.2",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.42.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-import": "2.29.1",
+    "jest": "29.7.0",
+    "prettier": "3.2.5",
+    "supertest": "6.3.4",
+    "ts-jest": "29.1.2",
+    "ts-loader": "9.5.1",
+    "ts-node": "10.9.2",
+    "tsconfig-paths": "4.2.0",
+    "typescript": "5.3.3"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/05-sql-typeorm/src/app.module.ts b/sample/05-sql-typeorm/src/app.module.ts
index 742ef5b5d..d6da69ee9 100644
--- a/sample/05-sql-typeorm/src/app.module.ts
+++ b/sample/05-sql-typeorm/src/app.module.ts
@@ -6,7 +6,7 @@ import { UsersModule } from './users/users.module';
   imports: [
     TypeOrmModule.forRoot({
       type: 'mysql',
-      host: 'localhost',
+      host: '127.0.0.1',
       port: 3306,
       username: 'root',
       password: 'root',
diff --git a/sample/05-sql-typeorm/src/users/users.controller.spec.ts b/sample/05-sql-typeorm/src/users/users.controller.spec.ts
index 199cea13b..4d1160037 100644
--- a/sample/05-sql-typeorm/src/users/users.controller.spec.ts
+++ b/sample/05-sql-typeorm/src/users/users.controller.spec.ts
@@ -76,10 +76,10 @@ describe('UsersController', () => {
 
   describe('findOne()', () => {
     it('should find a user', () => {
-      expect(usersController.findOne('1')).resolves.toEqual({
+      expect(usersController.findOne(1)).resolves.toEqual({
         firstName: 'firstName #1',
         lastName: 'lastName #1',
-        id: '1',
+        id: 1,
       });
       expect(usersService.findOne).toHaveBeenCalled();
     });
diff --git a/sample/05-sql-typeorm/src/users/users.controller.ts b/sample/05-sql-typeorm/src/users/users.controller.ts
index f710be650..4f88099cd 100644
--- a/sample/05-sql-typeorm/src/users/users.controller.ts
+++ b/sample/05-sql-typeorm/src/users/users.controller.ts
@@ -1,4 +1,12 @@
-import { Body, Controller, Delete, Get, Param, Post } from '@nestjs/common';
+import {
+  Body,
+  Controller,
+  Delete,
+  Get,
+  Param,
+  Post,
+  ParseIntPipe,
+} from '@nestjs/common';
 import { CreateUserDto } from './dto/create-user.dto';
 import { User } from './user.entity';
 import { UsersService } from './users.service';
@@ -18,7 +26,7 @@ export class UsersController {
   }
 
   @Get(':id')
-  findOne(@Param('id') id: string): Promise<User> {
+  findOne(@Param('id', ParseIntPipe) id: number): Promise<User> {
     return this.usersService.findOne(id);
   }
 
diff --git a/sample/05-sql-typeorm/src/users/users.service.spec.ts b/sample/05-sql-typeorm/src/users/users.service.spec.ts
index 46c8b7eda..575df1573 100644
--- a/sample/05-sql-typeorm/src/users/users.service.spec.ts
+++ b/sample/05-sql-typeorm/src/users/users.service.spec.ts
@@ -32,7 +32,7 @@ describe('UserService', () => {
           provide: getRepositoryToken(User),
           useValue: {
             find: jest.fn().mockResolvedValue(userArray),
-            findOne: jest.fn().mockResolvedValue(oneUser),
+            findOneBy: jest.fn().mockResolvedValue(oneUser),
             save: jest.fn().mockResolvedValue(oneUser),
             remove: jest.fn(),
             delete: jest.fn(),
@@ -74,9 +74,9 @@ describe('UserService', () => {
 
   describe('findOne()', () => {
     it('should get a single user', () => {
-      const repoSpy = jest.spyOn(repository, 'findOne');
-      expect(service.findOne('1')).resolves.toEqual(oneUser);
-      expect(repoSpy).toBeCalledWith('1');
+      const repoSpy = jest.spyOn(repository, 'findOneBy');
+      expect(service.findOne(1)).resolves.toEqual(oneUser);
+      expect(repoSpy).toBeCalledWith({ id: 1 });
     });
   });
 
diff --git a/sample/05-sql-typeorm/src/users/users.service.ts b/sample/05-sql-typeorm/src/users/users.service.ts
index 12ca83286..ac82eb7e1 100644
--- a/sample/05-sql-typeorm/src/users/users.service.ts
+++ b/sample/05-sql-typeorm/src/users/users.service.ts
@@ -23,8 +23,8 @@ export class UsersService {
     return this.usersRepository.find();
   }
 
-  findOne(id: string): Promise<User> {
-    return this.usersRepository.findOne(id);
+  findOne(id: number): Promise<User> {
+    return this.usersRepository.findOneBy({ id: id });
   }
 
   async remove(id: string): Promise<void> {
diff --git a/sample/05-sql-typeorm/test/jest-e2e.json b/sample/05-sql-typeorm/test/jest-e2e.json
new file mode 100644
index 000000000..e9d912f3e
--- /dev/null
+++ b/sample/05-sql-typeorm/test/jest-e2e.json
@@ -0,0 +1,9 @@
+{
+  "moduleFileExtensions": ["js", "json", "ts"],
+  "rootDir": ".",
+  "testEnvironment": "node",
+  "testRegex": ".e2e-spec.ts$",
+  "transform": {
+    "^.+\\.(t|j)s$": "ts-jest"
+  }
+}
diff --git a/sample/05-sql-typeorm/test/users/users.e2e-spec.ts b/sample/05-sql-typeorm/test/users/users.e2e-spec.ts
new file mode 100644
index 000000000..4ba372c4e
--- /dev/null
+++ b/sample/05-sql-typeorm/test/users/users.e2e-spec.ts
@@ -0,0 +1,74 @@
+import { Test, TestingModule } from '@nestjs/testing';
+import { INestApplication } from '@nestjs/common';
+import * as request from 'supertest';
+import { UsersModule } from '../../src/users/users.module';
+import { TypeOrmModule } from '@nestjs/typeorm';
+import { CreateUserDto } from '../../src/users/dto/create-user.dto';
+
+describe('Users - /users (e2e)', () => {
+  const users = {
+    id: 1,
+    firstName: 'FirstName #1',
+    lastName: 'LastName #1',
+    isActive: true,
+  };
+
+  let app: INestApplication;
+
+  beforeAll(async () => {
+    const moduleFixture: TestingModule = await Test.createTestingModule({
+      imports: [
+        TypeOrmModule.forRoot({
+          type: 'mysql',
+          host: '127.0.0.1',
+          port: 3307,
+          username: 'root',
+          password: 'root',
+          database: 'test',
+          autoLoadEntities: true,
+          synchronize: true,
+        }),
+        UsersModule,
+      ],
+    }).compile();
+
+    app = moduleFixture.createNestApplication();
+    await app.init();
+  });
+
+  it('Create [POST /users]', () => {
+    return request(app.getHttpServer())
+      .post('/users')
+      .send(users as CreateUserDto)
+      .expect(201)
+      .then(({ body }) => {
+        expect(body).toEqual(users);
+      });
+  });
+
+  it('Get all users [GET /users]', () => {
+    return request(app.getHttpServer())
+      .get('/users')
+      .expect(200)
+      .then(({ body }) => {
+        expect(body).toBeDefined();
+      });
+  });
+
+  it('Get one user [GET /users/:id]', () => {
+    return request(app.getHttpServer())
+      .get('/users/2')
+      .expect(200)
+      .then(({ body }) => {
+        expect(body).toBeDefined();
+      });
+  });
+
+  it('Delete one user [DELETE /users/:id]', () => {
+    return request(app.getHttpServer()).delete('/users/1').expect(200);
+  });
+
+  afterAll(async () => {
+    await app.close();
+  });
+});
diff --git a/sample/05-sql-typeorm/tsconfig.json b/sample/05-sql-typeorm/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/05-sql-typeorm/tsconfig.json
+++ b/sample/05-sql-typeorm/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/06-mongoose/package-lock.json b/sample/06-mongoose/package-lock.json
index d06acdb67..bdad41067 100644
Binary files a/sample/06-mongoose/package-lock.json and b/sample/06-mongoose/package-lock.json differ
diff --git a/sample/06-mongoose/package.json b/sample/06-mongoose/package.json
index e93852ce1..c33c0638d 100644
--- a/sample/06-mongoose/package.json
+++ b/sample/06-mongoose/package.json
@@ -19,36 +19,36 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/mongoose": "9.0.1",
-    "@nestjs/platform-express": "8.2.3",
-    "mongoose": "6.0.15",
-    "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/mongoose": "10.0.3",
+    "@nestjs/platform-express": "10.4.10",
+    "mongoose": "8.8.3",
+    "reflect-metadata": "0.2.1",
+    "rimraf": "5.0.10",
+    "rxjs": "7.8.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.7",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.19",
-    "@types/supertest": "2.0.11",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "jest": "27.3.1",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@nestjs/testing": "10.4.10",
+    "@types/express": "4.17.21",
+    "@types/jest": "29.5.12",
+    "@types/node": "20.17.8",
+    "@types/supertest": "6.0.2",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.42.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-import": "2.29.1",
+    "jest": "29.7.0",
+    "prettier": "3.2.5",
+    "supertest": "6.3.4",
+    "ts-jest": "29.1.2",
+    "ts-loader": "9.5.1",
+    "ts-node": "10.9.2",
+    "tsconfig-paths": "4.2.0",
+    "typescript": "5.3.3"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/06-mongoose/src/cats/cats.controller.spec.ts b/sample/06-mongoose/src/cats/cats.controller.spec.ts
index 3d166b4a2..298e5cbd3 100644
--- a/sample/06-mongoose/src/cats/cats.controller.spec.ts
+++ b/sample/06-mongoose/src/cats/cats.controller.spec.ts
@@ -1,23 +1,20 @@
 import { Test, TestingModule } from '@nestjs/testing';
+import { Types } from 'mongoose';
 import { CatsController } from './cats.controller';
-import { CreateCatDto } from './dto/create-cat.dto';
 import { CatsService } from './cats.service';
+import { CreateCatDto } from './dto/create-cat.dto';
+
+const catsServiceMock = {
+  create: jest.fn(),
+  findAll: jest.fn(),
+  findOne: jest.fn(),
+  update: jest.fn(),
+  delete: jest.fn(),
+};
 
-describe('Cats Controller', () => {
+describe('CatsController', () => {
   let controller: CatsController;
-  let service: CatsService;
-  const createCatDto: CreateCatDto = {
-    name: 'Cat #1',
-    breed: 'Breed #1',
-    age: 4,
-  };
-
-  const mockCat = {
-    name: 'Cat #1',
-    breed: 'Breed #1',
-    age: 4,
-    _id: 'a id',
-  };
+  let service: jest.Mocked<CatsService>;
 
   beforeEach(async () => {
     const module: TestingModule = await Test.createTestingModule({
@@ -25,65 +22,124 @@ describe('Cats Controller', () => {
       providers: [
         {
           provide: CatsService,
-          useValue: {
-            findAll: jest.fn().mockResolvedValue([
-              {
-                name: 'Cat #1',
-                breed: 'Bread #1',
-                age: 4,
-              },
-              {
-                name: 'Cat #2',
-                breed: 'Breed #2',
-                age: 3,
-              },
-              {
-                name: 'Cat #3',
-                breed: 'Breed #3',
-                age: 2,
-              },
-            ]),
-            create: jest.fn().mockResolvedValue(createCatDto),
-          },
+          useValue: catsServiceMock,
         },
       ],
     }).compile();
 
-    controller = module.get<CatsController>(CatsController);
-    service = module.get<CatsService>(CatsService);
+    controller = module.get(CatsController);
+    service = module.get(CatsService);
   });
 
-  describe('create()', () => {
+  describe('create', () => {
     it('should create a new cat', async () => {
-      const createSpy = jest
-        .spyOn(service, 'create')
-        .mockResolvedValueOnce(mockCat);
+      const mockedCat = {
+        _id: new Types.ObjectId(),
+        name: 'Cat #1',
+        breed: 'Breed #1',
+        age: 4,
+      };
+      service.create.mockResolvedValueOnce(mockedCat);
 
-      await controller.create(createCatDto);
-      expect(createSpy).toHaveBeenCalledWith(createCatDto);
+      const createCatDto: CreateCatDto = {
+        name: 'Cat #1',
+        breed: 'Breed #1',
+        age: 4,
+      };
+      const result = await controller.create(createCatDto);
+
+      expect(result).toEqual(mockedCat);
+      expect(service.create).toHaveBeenCalledWith(createCatDto);
     });
   });
 
-  describe('findAll()', () => {
+  describe('findAll', () => {
     it('should return an array of cats', async () => {
-      expect(controller.findAll()).resolves.toEqual([
+      const mockedCats = [
         {
+          _id: new Types.ObjectId(),
           name: 'Cat #1',
           breed: 'Bread #1',
           age: 4,
         },
         {
+          _id: new Types.ObjectId(),
           name: 'Cat #2',
           breed: 'Breed #2',
           age: 3,
         },
         {
+          _id: new Types.ObjectId(),
           name: 'Cat #3',
           breed: 'Breed #3',
           age: 2,
         },
-      ]);
+      ];
+      service.findAll.mockResolvedValueOnce(mockedCats);
+
+      const result = await controller.findAll();
+
+      expect(result).toEqual(mockedCats);
       expect(service.findAll).toHaveBeenCalled();
     });
   });
+
+  describe('findOne', () => {
+    it('should return a single cat', async () => {
+      const mockedCat = {
+        _id: new Types.ObjectId(),
+        name: 'Cat #1',
+        breed: 'Breed #1',
+        age: 4,
+      };
+      service.findOne.mockResolvedValueOnce(mockedCat);
+
+      const id = new Types.ObjectId().toString();
+      const result = await controller.findOne(id);
+
+      expect(result).toEqual(mockedCat);
+      expect(service.findOne).toHaveBeenCalledWith(id);
+    });
+  });
+
+  describe('update', () => {
+    it('should update a single cat', async () => {
+      const mockedCat = {
+        _id: new Types.ObjectId(),
+        name: 'Cat #1',
+        breed: 'Breed #1',
+        age: 4,
+      };
+      service.update.mockResolvedValueOnce(mockedCat);
+
+      const id = new Types.ObjectId().toString();
+      const updateCatDto: CreateCatDto = {
+        name: 'Cat #1',
+        breed: 'Breed #1',
+        age: 4,
+      };
+      const result = await controller.update(id, updateCatDto);
+
+      expect(result).toEqual(mockedCat);
+      expect(service.update).toHaveBeenCalledWith(id, updateCatDto);
+    });
+  });
+
+  describe('delete', () => {
+    it('should delete a single cat', async () => {
+      const mockedCat = {
+        _id: new Types.ObjectId(),
+        name: 'Cat #1',
+        breed: 'Breed #1',
+        age: 4,
+      };
+      service.delete.mockResolvedValueOnce(mockedCat);
+
+      const id = new Types.ObjectId().toString();
+      const result = await controller.delete(id);
+
+      expect(result).toEqual(mockedCat);
+      expect(service.delete).toHaveBeenCalledWith(id);
+    });
+  });
 });
diff --git a/sample/06-mongoose/src/cats/cats.controller.ts b/sample/06-mongoose/src/cats/cats.controller.ts
index 84306fe38..deac9a335 100644
--- a/sample/06-mongoose/src/cats/cats.controller.ts
+++ b/sample/06-mongoose/src/cats/cats.controller.ts
@@ -1,6 +1,7 @@
-import { Body, Controller, Get, Post } from '@nestjs/common';
+import { Body, Controller, Delete, Get, Param, Post } from '@nestjs/common';
 import { CatsService } from './cats.service';
 import { CreateCatDto } from './dto/create-cat.dto';
+import { UpdateCatDto } from './dto/update-cat.dto';
 import { Cat } from './schemas/cat.schema';
 
 @Controller('cats')
@@ -9,11 +10,26 @@ export class CatsController {
 
   @Post()
   async create(@Body() createCatDto: CreateCatDto) {
-    await this.catsService.create(createCatDto);
+    return this.catsService.create(createCatDto);
   }
 
   @Get()
   async findAll(): Promise<Cat[]> {
     return this.catsService.findAll();
   }
+
+  @Get(':id')
+  async findOne(@Param('id') id: string): Promise<Cat> {
+    return this.catsService.findOne(id);
+  }
+
+  @Post(':id')
+  async update(@Param('id') id: string, @Body() updateCatDto: UpdateCatDto) {
+    return this.catsService.update(id, updateCatDto);
+  }
+
+  @Delete(':id')
+  async delete(@Param('id') id: string) {
+    return this.catsService.delete(id);
+  }
 }
diff --git a/sample/06-mongoose/src/cats/cats.service.spec.ts b/sample/06-mongoose/src/cats/cats.service.spec.ts
index cc55a1951..ac2d9bada 100644
--- a/sample/06-mongoose/src/cats/cats.service.spec.ts
+++ b/sample/06-mongoose/src/cats/cats.service.spec.ts
@@ -1,31 +1,21 @@
+import { getModelToken } from '@nestjs/mongoose';
 import { Test, TestingModule } from '@nestjs/testing';
+import { Model, Types } from 'mongoose';
 import { CatsService } from './cats.service';
-import { getModelToken } from '@nestjs/mongoose';
+import { CreateCatDto } from './dto/create-cat.dto';
 import { Cat } from './schemas/cat.schema';
-import { Model } from 'mongoose';
 
-const mockCat = {
-  name: 'Cat #1',
-  breed: 'Breed #1',
-  age: 4,
+const catModelMock = {
+  create: jest.fn(),
+  find: jest.fn(),
+  findOne: jest.fn(),
+  findByIdAndUpdate: jest.fn(),
+  findByIdAndDelete: jest.fn(),
 };
 
 describe('CatsService', () => {
   let service: CatsService;
-  let model: Model<Cat>;
-
-  const catsArray = [
-    {
-      name: 'Cat #1',
-      breed: 'Breed #1',
-      age: 4,
-    },
-    {
-      name: 'Cat #2',
-      breed: 'Breed #2',
-      age: 2,
-    },
-  ];
+  let model: jest.Mocked<Model<Cat>>;
 
   beforeEach(async () => {
     const module: TestingModule = await Test.createTestingModule({
@@ -33,46 +23,128 @@ describe('CatsService', () => {
         CatsService,
         {
           provide: getModelToken('Cat'),
-          useValue: {
-            new: jest.fn().mockResolvedValue(mockCat),
-            constructor: jest.fn().mockResolvedValue(mockCat),
-            find: jest.fn(),
-            create: jest.fn(),
-            exec: jest.fn(),
-          },
+          useValue: catModelMock,
         },
       ],
     }).compile();
 
-    service = module.get<CatsService>(CatsService);
-    model = module.get<Model<Cat>>(getModelToken('Cat'));
+    service = module.get(CatsService);
+    model = module.get(getModelToken('Cat'));
   });
 
   it('should be defined', () => {
     expect(service).toBeDefined();
   });
 
-  it('should return all cats', async () => {
-    jest.spyOn(model, 'find').mockReturnValue({
-      exec: jest.fn().mockResolvedValueOnce(catsArray),
-    } as any);
-    const cats = await service.findAll();
-    expect(cats).toEqual(catsArray);
+  describe('create', () => {
+    it('should insert a new cat', async () => {
+      const mockedCat: CreateCatDto = {
+        name: 'Cat #1',
+        breed: 'Breed #1',
+        age: 4,
+      };
+      model.create.mockResolvedValueOnce(mockedCat as any);
+
+      const createCatDto = {
+        name: 'Cat #1',
+        breed: 'Breed #1',
+        age: 4,
+      };
+      const result = await service.create(createCatDto);
+
+      expect(result).toEqual(mockedCat);
+      expect(model.create).toHaveBeenCalledWith(createCatDto);
+    });
   });
 
-  it('should insert a new cat', async () => {
-    jest.spyOn(model, 'create').mockImplementationOnce(() =>
-      Promise.resolve({
+  describe('findAll', () => {
+    it('should return all cats', async () => {
+      const mockedCats = [
+        {
+          name: 'Cat #1',
+          breed: 'Breed #1',
+          age: 4,
+        },
+        {
+          name: 'Cat #2',
+          breed: 'Breed #2',
+          age: 2,
+        },
+      ];
+      model.find.mockReturnValueOnce({
+        exec: jest.fn().mockResolvedValueOnce(mockedCats),
+      } as any);
+
+      const result = await service.findAll();
+
+      expect(result).toEqual(mockedCats);
+      expect(model.find).toHaveBeenCalled();
+    });
+  });
+
+  describe('findOne', () => {
+    it('should return one cat', async () => {
+      const mockedCat = {
         name: 'Cat #1',
         breed: 'Breed #1',
         age: 4,
-      }),
-    );
-    const newCat = await service.create({
-      name: 'Cat #1',
-      breed: 'Breed #1',
-      age: 4,
+      };
+      model.findOne.mockReturnValueOnce({
+        exec: jest.fn().mockResolvedValueOnce(mockedCat),
+      } as any);
+
+      const id = new Types.ObjectId().toString();
+      const result = await service.findOne(id);
+
+      expect(result).toEqual(mockedCat);
+      expect(model.findOne).toHaveBeenCalledWith({ _id: id });
+    });
+  });
+
+  describe('update', () => {
+    it('should update a cat', async () => {
+      const mockedCat = {
+        name: 'Cat #1',
+        breed: 'Breed #1',
+        age: 4,
+      };
+      model.findByIdAndUpdate.mockReturnValueOnce({
+        exec: jest.fn().mockResolvedValueOnce(mockedCat),
+      } as any);
+
+      const id = new Types.ObjectId().toString();
+      const updateCatDto = {
+        name: 'Cat #1',
+        breed: 'Breed #1',
+        age: 4,
+      };
+      const result = await service.update(id, updateCatDto);
+
+      expect(result).toEqual(mockedCat);
+      expect(model.findByIdAndUpdate).toHaveBeenCalledWith(
+        { _id: id },
+        updateCatDto,
+        { new: true },
+      );
+    });
+  });
+
+  describe('delete', () => {
+    it('should delete a cat', async () => {
+      const mockedCat = {
+        name: 'Cat #1',
+        breed: 'Breed #1',
+        age: 4,
+      };
+      model.findByIdAndDelete.mockReturnValueOnce({
+        exec: jest.fn().mockResolvedValueOnce(mockedCat),
+      } as any);
+
+      const id = new Types.ObjectId().toString();
+      const result = await service.delete(id);
+
+      expect(result).toEqual(mockedCat);
+      expect(model.findByIdAndDelete).toHaveBeenCalledWith({ _id: id });
     });
-    expect(newCat).toEqual(mockCat);
   });
 });
diff --git a/sample/06-mongoose/src/cats/cats.service.ts b/sample/06-mongoose/src/cats/cats.service.ts
index 73d44320a..b089e84b1 100644
--- a/sample/06-mongoose/src/cats/cats.service.ts
+++ b/sample/06-mongoose/src/cats/cats.service.ts
@@ -2,13 +2,12 @@ import { Injectable } from '@nestjs/common';
 import { InjectModel } from '@nestjs/mongoose';
 import { Model } from 'mongoose';
 import { CreateCatDto } from './dto/create-cat.dto';
-import { Cat, CatDocument } from './schemas/cat.schema';
+import { UpdateCatDto } from './dto/update-cat.dto';
+import { Cat } from './schemas/cat.schema';
 
 @Injectable()
 export class CatsService {
-  constructor(
-    @InjectModel(Cat.name) private readonly catModel: Model<CatDocument>,
-  ) {}
+  constructor(@InjectModel(Cat.name) private readonly catModel: Model<Cat>) {}
 
   async create(createCatDto: CreateCatDto): Promise<Cat> {
     const createdCat = await this.catModel.create(createCatDto);
@@ -18,4 +17,21 @@ export class CatsService {
   async findAll(): Promise<Cat[]> {
     return this.catModel.find().exec();
   }
+
+  async findOne(id: string): Promise<Cat> {
+    return this.catModel.findOne({ _id: id }).exec();
+  }
+
+  async update(id: string, updateCatDto: UpdateCatDto): Promise<Cat> {
+    return this.catModel
+      .findByIdAndUpdate({ _id: id }, updateCatDto, { new: true })
+      .exec();
+  }
+
+  async delete(id: string): Promise<Cat> {
+    const deletedCat = await this.catModel
+      .findByIdAndDelete({ _id: id })
+      .exec();
+    return deletedCat;
+  }
 }
diff --git a/sample/06-mongoose/src/cats/dto/update-cat.dto.ts b/sample/06-mongoose/src/cats/dto/update-cat.dto.ts
new file mode 100644
index 000000000..be75756b8
--- /dev/null
+++ b/sample/06-mongoose/src/cats/dto/update-cat.dto.ts
@@ -0,0 +1,5 @@
+export class UpdateCatDto {
+  readonly name?: string;
+  readonly age?: number;
+  readonly breed?: string;
+}
diff --git a/sample/06-mongoose/src/cats/schemas/cat.schema.ts b/sample/06-mongoose/src/cats/schemas/cat.schema.ts
index 2cd7b90af..ff3500720 100644
--- a/sample/06-mongoose/src/cats/schemas/cat.schema.ts
+++ b/sample/06-mongoose/src/cats/schemas/cat.schema.ts
@@ -1,7 +1,7 @@
 import { Prop, Schema, SchemaFactory } from '@nestjs/mongoose';
-import { Document } from 'mongoose';
+import { HydratedDocument } from 'mongoose';
 
-export type CatDocument = Cat & Document;
+export type CatDocument = HydratedDocument<Cat>;
 
 @Schema()
 export class Cat {
diff --git a/sample/06-mongoose/tsconfig.json b/sample/06-mongoose/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/06-mongoose/tsconfig.json
+++ b/sample/06-mongoose/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/07-sequelize/package-lock.json b/sample/07-sequelize/package-lock.json
index 20ee5ccd8..b0671ee97 100644
Binary files a/sample/07-sequelize/package-lock.json and b/sample/07-sequelize/package-lock.json differ
diff --git a/sample/07-sequelize/package.json b/sample/07-sequelize/package.json
index 96db788a9..070153e9a 100644
--- a/sample/07-sequelize/package.json
+++ b/sample/07-sequelize/package.json
@@ -19,39 +19,39 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "@nestjs/sequelize": "8.0.0",
-    "mysql2": "2.3.3",
-    "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0",
-    "sequelize": "6.9.0",
-    "sequelize-typescript": "2.1.1",
-    "typescript": "4.3.5"
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/platform-express": "10.4.10",
+    "@nestjs/sequelize": "10.0.0",
+    "mysql2": "3.9.8",
+    "reflect-metadata": "0.2.1",
+    "rimraf": "5.0.10",
+    "rxjs": "7.8.1",
+    "sequelize": "6.36.0",
+    "sequelize-typescript": "2.1.6",
+    "typescript": "5.3.3"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.19",
-    "@types/supertest": "2.0.11",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "jest": "27.3.1",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@nestjs/testing": "10.4.10",
+    "@types/express": "4.17.21",
+    "@types/jest": "29.5.12",
+    "@types/node": "20.17.8",
+    "@types/supertest": "6.0.2",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.42.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-import": "2.29.1",
+    "jest": "29.7.0",
+    "prettier": "3.2.5",
+    "supertest": "6.3.4",
+    "ts-jest": "29.1.2",
+    "ts-loader": "9.5.1",
+    "ts-node": "10.9.2",
+    "tsconfig-paths": "4.2.0",
+    "typescript": "5.3.3"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/07-sequelize/src/app.module.ts b/sample/07-sequelize/src/app.module.ts
index fa6c98aec..f7160b783 100644
--- a/sample/07-sequelize/src/app.module.ts
+++ b/sample/07-sequelize/src/app.module.ts
@@ -6,7 +6,7 @@ import { UsersModule } from './users/users.module';
   imports: [
     SequelizeModule.forRoot({
       dialect: 'mysql',
-      host: 'localhost',
+      host: '127.0.0.1',
       port: 3306,
       username: 'root',
       password: 'root',
diff --git a/sample/07-sequelize/src/users/users.service.ts b/sample/07-sequelize/src/users/users.service.ts
index ebdb2282e..615252598 100644
--- a/sample/07-sequelize/src/users/users.service.ts
+++ b/sample/07-sequelize/src/users/users.service.ts
@@ -11,7 +11,10 @@ export class UsersService {
   ) {}
 
   create(createUserDto: CreateUserDto): Promise<User> {
-    return this.userModel.create(createUserDto);
+    return this.userModel.create({
+      firstName: createUserDto.firstName,
+      lastName: createUserDto.lastName,
+    });
   }
 
   async findAll(): Promise<User[]> {
diff --git a/sample/07-sequelize/tsconfig.json b/sample/07-sequelize/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/07-sequelize/tsconfig.json
+++ b/sample/07-sequelize/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/08-webpack/package-lock.json b/sample/08-webpack/package-lock.json
index ecc3bcf44..f207d384e 100644
Binary files a/sample/08-webpack/package-lock.json and b/sample/08-webpack/package-lock.json differ
diff --git a/sample/08-webpack/package.json b/sample/08-webpack/package.json
index 07bca7f85..367241ba1 100644
--- a/sample/08-webpack/package.json
+++ b/sample/08-webpack/package.json
@@ -8,30 +8,31 @@
     "build:dev": "nest build --watch --webpack --webpackPath webpack-hmr.config.js",
     "start": "node dist/main",
     "lint": "eslint '{src,apps,libs,test}/**/*.ts' --fix",
+    "test": "echo 'No tests implemented yet.'",
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "reflect-metadata": "0.1.13",
-    "rxjs": "7.4.0",
-    "typescript": "4.3.5"
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/platform-express": "10.4.10",
+    "reflect-metadata": "0.2.1",
+    "rxjs": "7.8.1",
+    "typescript": "5.3.3"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.7",
-    "@nestjs/schematics": "8.0.5",
-    "@types/node": "16.11.19",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@types/node": "20.17.8",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.42.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-import": "2.29.1",
     "start-server-webpack-plugin": "2.2.5",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "webpack": "5.64.4",
-    "webpack-cli": "4.9.1",
+    "ts-loader": "9.5.1",
+    "ts-node": "10.9.2",
+    "webpack": "5.96.1",
+    "webpack-cli": "5.1.4",
     "webpack-node-externals": "3.0.0"
   }
 }
diff --git a/sample/08-webpack/tsconfig.json b/sample/08-webpack/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/08-webpack/tsconfig.json
+++ b/sample/08-webpack/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/09-babel-example/package-lock.json b/sample/09-babel-example/package-lock.json
index 41e916267..54bee0e85 100644
Binary files a/sample/09-babel-example/package-lock.json and b/sample/09-babel-example/package-lock.json differ
diff --git a/sample/09-babel-example/package.json b/sample/09-babel-example/package.json
index b4caa3514..f24fc3c6f 100644
--- a/sample/09-babel-example/package.json
+++ b/sample/09-babel-example/package.json
@@ -13,28 +13,28 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "@nestjs/microservices": "8.2.3",
-    "@nestjs/websockets": "8.2.3",
-    "reflect-metadata": "0.1.13",
-    "rxjs": "7.4.0"
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/platform-express": "10.4.10",
+    "@nestjs/microservices": "10.4.10",
+    "@nestjs/websockets": "10.4.10",
+    "reflect-metadata": "0.2.1",
+    "rxjs": "7.8.1"
   },
   "devDependencies": {
-    "@babel/cli": "7.16.8",
-    "@babel/core": "7.16.7",
-    "@babel/node": "7.16.8",
-    "@babel/plugin-proposal-decorators": "7.16.7",
-    "@babel/plugin-transform-runtime": "7.16.8",
-    "@babel/preset-env": "7.16.8",
-    "@babel/register": "7.16.9",
-    "@babel/runtime": "7.16.7",
-    "@nestjs/testing": "8.2.3",
-    "jest": "27.3.1",
-    "nodemon": "2.0.15",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6"
+    "@babel/cli": "7.23.9",
+    "@babel/core": "7.23.9",
+    "@babel/node": "7.23.9",
+    "@babel/plugin-proposal-decorators": "7.23.9",
+    "@babel/plugin-transform-runtime": "7.23.9",
+    "@babel/preset-env": "7.23.9",
+    "@babel/register": "7.23.7",
+    "@babel/runtime": "7.23.9",
+    "@nestjs/testing": "10.4.10",
+    "jest": "29.7.0",
+    "nodemon": "3.1.7",
+    "prettier": "3.2.5",
+    "supertest": "6.3.4"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/10-fastify/package-lock.json b/sample/10-fastify/package-lock.json
index 84161d49b..d58d60985 100644
Binary files a/sample/10-fastify/package-lock.json and b/sample/10-fastify/package-lock.json differ
diff --git a/sample/10-fastify/package.json b/sample/10-fastify/package.json
index 37bf3f233..c3be402c2 100644
--- a/sample/10-fastify/package.json
+++ b/sample/10-fastify/package.json
@@ -19,34 +19,34 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-fastify": "8.2.3",
-    "class-transformer": "0.4.0",
-    "class-validator": "0.13.2",
-    "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/platform-fastify": "10.4.10",
+    "class-transformer": "0.5.1",
+    "class-validator": "0.14.1",
+    "reflect-metadata": "0.2.1",
+    "rimraf": "5.0.10",
+    "rxjs": "7.8.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.7",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/node": "16.11.19",
-    "@types/supertest": "2.0.11",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "jest": "27.3.1",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@nestjs/testing": "10.4.10",
+    "@types/express": "4.17.21",
+    "@types/node": "20.17.8",
+    "@types/supertest": "6.0.2",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.42.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-import": "2.29.1",
+    "jest": "29.7.0",
+    "prettier": "3.2.5",
+    "supertest": "6.3.4",
+    "ts-jest": "29.1.2",
+    "ts-loader": "9.5.1",
+    "ts-node": "10.9.2",
+    "tsconfig-paths": "4.2.0",
+    "typescript": "5.3.3"
   }
 }
diff --git a/sample/10-fastify/src/common/pipes/validation.pipe.ts b/sample/10-fastify/src/common/pipes/validation.pipe.ts
index 9df091a88..1a79ae214 100644
--- a/sample/10-fastify/src/common/pipes/validation.pipe.ts
+++ b/sample/10-fastify/src/common/pipes/validation.pipe.ts
@@ -5,7 +5,7 @@ import {
   PipeTransform,
   Type,
 } from '@nestjs/common';
-import { plainToClass } from 'class-transformer';
+import { plainToInstance } from 'class-transformer';
 import { validate } from 'class-validator';
 
 @Injectable()
@@ -15,7 +15,7 @@ export class ValidationPipe implements PipeTransform<any> {
     if (!metatype || !this.toValidate(metatype)) {
       return value;
     }
-    const object = plainToClass(metatype, value);
+    const object = plainToInstance(metatype, value);
     const errors = await validate(object);
     if (errors.length > 0) {
       throw new BadRequestException('Validation failed');
diff --git a/sample/10-fastify/tsconfig.json b/sample/10-fastify/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/10-fastify/tsconfig.json
+++ b/sample/10-fastify/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/11-swagger/package-lock.json b/sample/11-swagger/package-lock.json
index b25a7dc91..bbef5253f 100644
Binary files a/sample/11-swagger/package-lock.json and b/sample/11-swagger/package-lock.json differ
diff --git a/sample/11-swagger/package.json b/sample/11-swagger/package.json
index 08ec1c3e7..79a8e55e8 100644
--- a/sample/11-swagger/package.json
+++ b/sample/11-swagger/package.json
@@ -19,36 +19,35 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "@nestjs/swagger": "5.1.5",
-    "class-transformer": "0.4.0",
-    "class-validator": "0.13.2",
-    "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0",
-    "swagger-ui-express": "4.1.6"
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/platform-express": "10.4.10",
+    "@nestjs/swagger": "7.3.0",
+    "class-transformer": "0.5.1",
+    "class-validator": "0.14.1",
+    "reflect-metadata": "0.2.1",
+    "rimraf": "5.0.10",
+    "rxjs": "7.8.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/node": "16.11.19",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@nestjs/testing": "10.4.10",
+    "@types/express": "4.17.21",
+    "@types/node": "20.17.8",
+    "@types/supertest": "6.0.2",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.42.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-import": "2.29.1",
+    "jest": "29.7.0",
+    "prettier": "3.2.5",
+    "supertest": "6.3.4",
+    "ts-jest": "29.1.2",
+    "ts-loader": "9.5.1",
+    "ts-node": "10.9.2",
+    "tsconfig-paths": "4.2.0",
+    "typescript": "5.3.3"
   }
 }
diff --git a/sample/11-swagger/tsconfig.json b/sample/11-swagger/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/11-swagger/tsconfig.json
+++ b/sample/11-swagger/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/12-graphql-schema-first/e2e/cats/cats.e2e-spec.ts b/sample/12-graphql-schema-first/e2e/cats/cats.e2e-spec.ts
new file mode 100644
index 000000000..a1e446a83
--- /dev/null
+++ b/sample/12-graphql-schema-first/e2e/cats/cats.e2e-spec.ts
@@ -0,0 +1,67 @@
+import { INestApplication } from '@nestjs/common';
+import { Test, TestingModule } from '@nestjs/testing';
+import * as request from 'supertest';
+
+import { Cat } from '../../src/graphql.schema';
+import { AppModule } from '../../src/app.module';
+
+describe('Cats Resolver (e2e)', () => {
+  let app: INestApplication;
+  let cat: Cat;
+
+  beforeEach(async () => {
+    const moduleFixture: TestingModule = await Test.createTestingModule({
+      imports: [AppModule],
+    }).compile();
+
+    app = moduleFixture.createNestApplication();
+    await app.init();
+  });
+
+  afterEach(async () => {
+    await app.close();
+  });
+
+  it('should create a new cat', async () => {
+    const query = `
+      mutation {
+        createCat(createCatInput: { name: "Cat", age: 5 }) {
+          id
+          name
+          age
+        }
+      }
+    `;
+
+    return request(app.getHttpServer())
+      .post('/graphql')
+      .send({ query })
+      .expect(200)
+      .expect(response => {
+        cat = response.body.data.createCat;
+        expect(cat.name).toEqual('Cat');
+        expect(cat.age).toEqual(5);
+      });
+  });
+
+  it('should get all cats', async () => {
+    const query = `
+      query {
+        cats {
+          id
+          name
+          age
+        }
+      }
+    `;
+
+    return request(app.getHttpServer())
+      .post('/graphql')
+      .send({ query })
+      .expect(200)
+      .expect(response => {
+        const cats = response.body.data.cats;
+        expect(cats[0].name).toEqual('Cat');
+      });
+  });
+});
diff --git a/sample/12-graphql-schema-first/e2e/jest-e2e.json b/sample/12-graphql-schema-first/e2e/jest-e2e.json
new file mode 100644
index 000000000..5be9543cc
--- /dev/null
+++ b/sample/12-graphql-schema-first/e2e/jest-e2e.json
@@ -0,0 +1,13 @@
+{
+  "moduleFileExtensions": ["ts", "tsx", "js", "json"],
+  "transform": {
+    "^.+\\.tsx?$": "ts-jest"
+  },
+  "testRegex": "/e2e/.*\\.(e2e-test|e2e-spec).(ts|tsx|js)$",
+  "collectCoverageFrom": [
+    "src/**/*.{js,jsx,tsx,ts}",
+    "!**/node_modules/**",
+    "!**/vendor/**"
+  ],
+  "coverageReporters": ["json", "lcov"]
+}
diff --git a/sample/12-graphql-schema-first/package-lock.json b/sample/12-graphql-schema-first/package-lock.json
index 8b322eb2a..51c302ad4 100644
Binary files a/sample/12-graphql-schema-first/package-lock.json and b/sample/12-graphql-schema-first/package-lock.json differ
diff --git a/sample/12-graphql-schema-first/package.json b/sample/12-graphql-schema-first/package.json
index 3c6f5e02c..db2b39159 100644
--- a/sample/12-graphql-schema-first/package.json
+++ b/sample/12-graphql-schema-first/package.json
@@ -16,43 +16,76 @@
     "test:watch": "jest --watch",
     "test:cov": "jest --coverage",
     "test:debug": "node --inspect-brk -r tsconfig-paths/register -r ts-node/register node_modules/.bin/jest --runInBand",
-    "test:e2e": "echo 'No e2e tests implemented yet.'"
+    "test:e2e": "jest --config ./e2e/jest-e2e.json"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/graphql": "9.1.2",
-    "@nestjs/platform-express": "8.2.3",
-    "apollo-server": "3.6.1",
-    "apollo-server-express": "3.6.1",
-    "class-transformer": "0.4.0",
-    "class-validator": "0.13.2",
-    "graphql": "15.7.2",
+    "@apollo/server": "4.9.3",
+    "@graphql-tools/utils": "10.0.13",
+    "@nestjs/apollo": "12.0.11",
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/graphql": "12.2.0",
+    "@nestjs/platform-express": "10.4.10",
+    "class-transformer": "0.5.1",
+    "class-validator": "0.14.1",
+    "graphql": "16.8.1",
     "graphql-subscriptions": "2.0.0",
-    "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "reflect-metadata": "0.2.1",
+    "rimraf": "5.0.10",
+    "rxjs": "7.8.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/node": "16.11.19",
-    "@types/supertest": "2.0.11",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "jest": "27.3.1",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-morph": "12.2.0",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "typescript": "4.4.2"
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@nestjs/testing": "10.4.10",
+    "@types/express": "4.17.21",
+    "@types/jest": "29.5.10",
+    "@types/node": "20.17.8",
+    "@types/supertest": "6.0.2",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.42.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-import": "2.29.1",
+    "jest": "29.7.0",
+    "prettier": "3.2.5",
+    "supertest": "6.3.4",
+    "ts-jest": "29.1.2",
+    "ts-loader": "9.5.1",
+    "ts-morph": "21.0.1",
+    "ts-node": "10.9.2",
+    "tsconfig-paths": "4.2.0",
+    "typescript": "5.3.3"
+  },
+  "jest": {
+    "moduleFileExtensions": [
+      "js",
+      "json",
+      "ts"
+    ],
+    "rootDir": "src",
+    "testRegex": ".*\\.spec\\.ts$",
+    "transform": {
+      "^.+\\.(t|j)s$": "ts-jest"
+    },
+    "collectCoverageFrom": [
+      "**/*.(t|j)s",
+      "!main.(t|j)s",
+      "!**/*.module.(t|j)s",
+      "!**/*.dto.(t|j)s",
+      "!**/*.entity.(t|j)s",
+      "!**/*.guard.(t|j)s",
+      "!**/*.response.(t|j)s",
+      "!**/*.strategy.(t|j)s",
+      "!**/*.args.(t|j)s",
+      "!**/*.types.(t|j)s",
+      "!**/*.directive.(t|j)s",
+      "!**/*.plugin.(t|j)s",
+      "!**/*.scalar.(t|j)s",
+      "!**/*.schema.(t|j)s",
+      "!**/node_modules/**"
+    ],
+    "coverageDirectory": "../coverage",
+    "testEnvironment": "node"
   }
 }
diff --git a/sample/12-graphql-schema-first/src/app.module.ts b/sample/12-graphql-schema-first/src/app.module.ts
index c3b0f1f25..c6833d0f6 100644
--- a/sample/12-graphql-schema-first/src/app.module.ts
+++ b/sample/12-graphql-schema-first/src/app.module.ts
@@ -1,12 +1,16 @@
+import { ApolloDriver, ApolloDriverConfig } from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
 import { GraphQLModule } from '@nestjs/graphql';
 import { CatsModule } from './cats/cats.module';
+import { upperDirectiveTransformer } from './common/directives/upper-case.directive';
 
 @Module({
   imports: [
     CatsModule,
-    GraphQLModule.forRoot({
+    GraphQLModule.forRoot<ApolloDriverConfig>({
+      driver: ApolloDriver,
       typePaths: ['./**/*.graphql'],
+      transformSchema: schema => upperDirectiveTransformer(schema, 'upper'),
       installSubscriptionHandlers: true,
     }),
   ],
diff --git a/sample/12-graphql-schema-first/src/cats/cat-owner.resolver.spec.ts b/sample/12-graphql-schema-first/src/cats/cat-owner.resolver.spec.ts
new file mode 100644
index 000000000..d5878086e
--- /dev/null
+++ b/sample/12-graphql-schema-first/src/cats/cat-owner.resolver.spec.ts
@@ -0,0 +1,42 @@
+import { Test, TestingModule } from '@nestjs/testing';
+import { Cat, Owner } from '../graphql.schema';
+import { OwnersService } from '../owners/owners.service';
+import { CatOwnerResolver } from './cat-owner.resolver';
+
+describe('CatOwnerResolver', () => {
+  let resolver: CatOwnerResolver;
+  let ownersService: OwnersService;
+
+  beforeEach(async () => {
+    const moduleRef: TestingModule = await Test.createTestingModule({
+      providers: [
+        CatOwnerResolver,
+        {
+          provide: OwnersService,
+          useValue: {
+            findOneById: jest.fn(),
+          },
+        },
+      ],
+    }).compile();
+
+    resolver = moduleRef.get(CatOwnerResolver);
+    ownersService = moduleRef.get(OwnersService);
+  });
+
+  it('should be defined', () => {
+    expect(resolver).toBeDefined();
+  });
+
+  it('should resolve the owner for a cat', async () => {
+    const cat: Cat & { ownerId: number } = { id: 1, ownerId: 101 };
+    const owner: Owner = { id: 101, name: 'Kambale' };
+
+    jest.spyOn(ownersService, 'findOneById').mockImplementation(() => owner);
+
+    const resolvedOwner = await resolver.owner(cat);
+
+    expect(ownersService.findOneById).toHaveBeenCalledWith(cat.ownerId);
+    expect(resolvedOwner).toEqual(owner);
+  });
+});
diff --git a/sample/12-graphql-schema-first/src/cats/cats.resolver.spec.ts b/sample/12-graphql-schema-first/src/cats/cats.resolver.spec.ts
new file mode 100644
index 000000000..717fafd6f
--- /dev/null
+++ b/sample/12-graphql-schema-first/src/cats/cats.resolver.spec.ts
@@ -0,0 +1,63 @@
+import { Test, TestingModule } from '@nestjs/testing';
+
+import { Cat } from '../graphql.schema';
+import { CatsResolver } from './cats.resolver';
+import { CatsService } from './cats.service';
+
+import { MINIMUM_AGE, MINIMUM_AGE_ERROR } from './dto/create-cat.dto';
+
+describe('CatsResolver', () => {
+  let resolver: CatsResolver;
+  const cat: Cat = { name: 'Cat', age: 5 };
+
+  beforeEach(async () => {
+    const moduleRef: TestingModule = await Test.createTestingModule({
+      providers: [
+        CatsResolver,
+        {
+          provide: CatsService,
+          useValue: {
+            create: jest
+              .fn()
+              .mockImplementation((cat: Cat) => ({ id: 1, ...cat })),
+            findAll: jest.fn().mockReturnValue([cat]),
+            findOneById: jest
+              .fn()
+              .mockImplementation((id: number) => ({ ...cat, id })),
+          },
+        },
+      ],
+    }).compile();
+
+    resolver = moduleRef.get<CatsResolver>(CatsResolver);
+  });
+
+  it('should be defined', () => {
+    expect(resolver).toBeDefined();
+  });
+
+  it('should create a new cat', async () => {
+    const newCat = await resolver.create({ name: cat.name, age: cat.age });
+    expect(newCat.name).toEqual(cat.name);
+    expect(newCat).toEqual({ id: 1, ...cat });
+  });
+
+  it(`should fail to save if the age is under ${MINIMUM_AGE}`, async () => {
+    try {
+      await resolver.create({ name: cat.name, age: 0 });
+    } catch (error) {
+      expect(error.message).toBe(MINIMUM_AGE_ERROR);
+    }
+  });
+
+  it('should return all cats', async () => {
+    const cats = await resolver.getCats();
+    expect(cats.length).toEqual(1);
+    expect(cats[0].name).toEqual(cat.name);
+  });
+
+  it('should return a cat by id', async () => {
+    const cat = await resolver.findOneById(1);
+    expect(cat).toEqual({ ...cat, id: 1 });
+  });
+});
diff --git a/sample/12-graphql-schema-first/src/cats/cats.service.spec.ts b/sample/12-graphql-schema-first/src/cats/cats.service.spec.ts
new file mode 100644
index 000000000..90e26f5ba
--- /dev/null
+++ b/sample/12-graphql-schema-first/src/cats/cats.service.spec.ts
@@ -0,0 +1,42 @@
+import { Test, TestingModule } from '@nestjs/testing';
+import { CatsService } from './cats.service';
+import { Cat } from 'src/graphql.schema';
+
+describe('CatsService', () => {
+  let service: CatsService;
+  const cat: Cat = { name: 'Cat', age: 5 };
+
+  beforeEach(async () => {
+    const module: TestingModule = await Test.createTestingModule({
+      providers: [CatsService],
+    }).compile();
+
+    service = module.get<CatsService>(CatsService);
+  });
+
+  it('should be defined', () => {
+    expect(service).toBeDefined();
+  });
+
+  it('should create a new cat', () => {
+    const newCat = service.create(cat);
+    expect(newCat.name).toEqual(cat.name);
+    expect(newCat).toEqual({ id: 1, ...cat });
+  });
+
+  it('should return all cats', () => {
+    const cats = service.findAll();
+    expect(cats.length).toEqual(1);
+    expect(cats[0].name).toEqual(cat.name);
+  });
+
+  it('should return a cat by id', () => {
+    const cat = service.findOneById(1);
+    expect(cat).toEqual({ ...cat, id: 1 });
+  });
+
+  it('should return undefined if cat not found', () => {
+    const cat = service.findOneById(2);
+    expect(cat).toBeUndefined();
+  });
+});
diff --git a/sample/12-graphql-schema-first/src/cats/dto/create-cat.dto.ts b/sample/12-graphql-schema-first/src/cats/dto/create-cat.dto.ts
index e27a98e24..cfca24ae4 100644
--- a/sample/12-graphql-schema-first/src/cats/dto/create-cat.dto.ts
+++ b/sample/12-graphql-schema-first/src/cats/dto/create-cat.dto.ts
@@ -1,7 +1,10 @@
 import { Min } from 'class-validator';
 import { CreateCatInput } from '../../graphql.schema';
 
+export const MINIMUM_AGE = 1;
+export const MINIMUM_AGE_ERROR = `Age must be greater than ${MINIMUM_AGE}`;
+
 export class CreateCatDto extends CreateCatInput {
-  @Min(1)
+  @Min(MINIMUM_AGE, { message: MINIMUM_AGE_ERROR })
   age: number;
 }
diff --git a/sample/12-graphql-schema-first/src/common/directives/upper-case.directive.ts b/sample/12-graphql-schema-first/src/common/directives/upper-case.directive.ts
index 49341fe8e..52cabe0ef 100644
--- a/sample/12-graphql-schema-first/src/common/directives/upper-case.directive.ts
+++ b/sample/12-graphql-schema-first/src/common/directives/upper-case.directive.ts
@@ -1,15 +1,32 @@
-import { SchemaDirectiveVisitor } from '@graphql-tools/utils';
-import { defaultFieldResolver, GraphQLField } from 'graphql';
+import { getDirective, MapperKind, mapSchema } from '@graphql-tools/utils';
+import { defaultFieldResolver, GraphQLSchema } from 'graphql';
 
-export class UpperCaseDirective extends SchemaDirectiveVisitor {
-  visitFieldDefinition(field: GraphQLField<any, any>) {
-    const { resolve = defaultFieldResolver } = field;
-    field.resolve = async function (...args) {
-      const result = await resolve.apply(this, args);
-      if (typeof result === 'string') {
-        return result.toUpperCase();
+export function upperDirectiveTransformer(
+  schema: GraphQLSchema,
+  directiveName: string,
+) {
+  return mapSchema(schema, {
+    [MapperKind.OBJECT_FIELD]: fieldConfig => {
+      const upperDirective = getDirective(
+        schema,
+        fieldConfig,
+        directiveName,
+      )?.[0];
+
+      if (upperDirective) {
+        const { resolve = defaultFieldResolver } = fieldConfig;
+
+        // Replace the original resolver with a function that *first* calls
+        // the original resolver, then converts its result to upper case
+        fieldConfig.resolve = async function (source, args, context, info) {
+          const result = await resolve(source, args, context, info);
+          if (typeof result === 'string') {
+            return result.toUpperCase();
+          }
+          return result;
+        };
+        return fieldConfig;
       }
-      return result;
-    };
-  }
+    },
+  });
 }
diff --git a/sample/12-graphql-schema-first/src/common/plugins/logging.plugin.ts b/sample/12-graphql-schema-first/src/common/plugins/logging.plugin.ts
index 8e48e29cb..77c23a96c 100644
--- a/sample/12-graphql-schema-first/src/common/plugins/logging.plugin.ts
+++ b/sample/12-graphql-schema-first/src/common/plugins/logging.plugin.ts
@@ -1,12 +1,9 @@
-import { Plugin } from '@nestjs/graphql';
-import {
-  ApolloServerPlugin,
-  GraphQLRequestListener,
-} from 'apollo-server-plugin-base';
+import { ApolloServerPlugin, GraphQLRequestListener } from '@apollo/server';
+import { Plugin } from '@nestjs/apollo';
 
 @Plugin()
 export class LoggingPlugin implements ApolloServerPlugin {
-  async requestDidStart(): Promise<GraphQLRequestListener> {
+  async requestDidStart(): Promise<GraphQLRequestListener<any>> {
     console.log('Request started');
     return {
       async willSendResponse() {
diff --git a/sample/12-graphql-schema-first/src/graphql.schema.ts b/sample/12-graphql-schema-first/src/graphql.schema.ts
index d93925312..47a938f40 100644
--- a/sample/12-graphql-schema-first/src/graphql.schema.ts
+++ b/sample/12-graphql-schema-first/src/graphql.schema.ts
@@ -1,4 +1,3 @@
-
 /*
  * -------------------------------------------------------
  * THIS FILE WAS AUTOMATICALLY GENERATED (DO NOT MODIFY)
@@ -8,36 +7,40 @@
 /* tslint:disable */
 /* eslint-disable */
 export class CreateCatInput {
-    name?: Nullable<string>;
-    age?: Nullable<number>;
+  name?: Nullable<string>;
+  age?: Nullable<number>;
 }
 
 export abstract class IQuery {
-    abstract cats(): Nullable<Nullable<Cat>[]> | Promise<Nullable<Nullable<Cat>[]>>;
+  abstract cats():
+    | Nullable<Nullable<Cat>[]>
+    | Promise<Nullable<Nullable<Cat>[]>>;
 
-    abstract cat(id: string): Nullable<Cat> | Promise<Nullable<Cat>>;
+  abstract cat(id: string): Nullable<Cat> | Promise<Nullable<Cat>>;
 }
 
 export abstract class IMutation {
-    abstract createCat(createCatInput?: Nullable<CreateCatInput>): Nullable<Cat> | Promise<Nullable<Cat>>;
+  abstract createCat(
+    createCatInput?: Nullable<CreateCatInput>,
+  ): Nullable<Cat> | Promise<Nullable<Cat>>;
 }
 
 export abstract class ISubscription {
-    abstract catCreated(): Nullable<Cat> | Promise<Nullable<Cat>>;
+  abstract catCreated(): Nullable<Cat> | Promise<Nullable<Cat>>;
 }
 
 export class Owner {
-    id: number;
-    name: string;
-    age?: Nullable<number>;
-    cats?: Nullable<Cat[]>;
+  id: number;
+  name: string;
+  age?: Nullable<number>;
+  cats?: Nullable<Cat[]>;
 }
 
 export class Cat {
-    id?: Nullable<number>;
-    name?: Nullable<string>;
-    age?: Nullable<number>;
-    owner?: Nullable<Owner>;
+  id?: Nullable<number>;
+  name?: Nullable<string>;
+  age?: Nullable<number>;
+  owner?: Nullable<Owner>;
 }
 
 type Nullable<T> = T | null;
diff --git a/sample/12-graphql-schema-first/src/owners/owners.service.spec.ts b/sample/12-graphql-schema-first/src/owners/owners.service.spec.ts
new file mode 100644
index 000000000..087c0aca4
--- /dev/null
+++ b/sample/12-graphql-schema-first/src/owners/owners.service.spec.ts
@@ -0,0 +1,38 @@
+import { Test, TestingModule } from '@nestjs/testing';
+import { Owner } from '../graphql.schema';
+import { OwnersService } from './owners.service';
+
+describe('OwnersService', () => {
+  let service: OwnersService;
+
+  beforeEach(async () => {
+    const module: TestingModule = await Test.createTestingModule({
+      providers: [OwnersService],
+    }).compile();
+
+    service = module.get<OwnersService>(OwnersService);
+  });
+
+  it('should be defined', () => {
+    expect(service).toBeDefined();
+  });
+
+  describe('findOneById', () => {
+    it('should return an owner if exists', () => {
+      const ownerId = 1;
+      const expectedOwner: Owner = { id: 1, name: 'Jon', age: 5 };
+
+      const result = service.findOneById(ownerId);
+
+      expect(result).toEqual(expectedOwner);
+    });
+
+    it('should return undefined if owner does not exist', () => {
+      const ownerId = 9999;
+
+      const result = service.findOneById(ownerId);
+
+      expect(result).toBeUndefined();
+    });
+  });
+});
diff --git a/sample/12-graphql-schema-first/tsconfig.json b/sample/12-graphql-schema-first/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/12-graphql-schema-first/tsconfig.json
+++ b/sample/12-graphql-schema-first/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/13-mongo-typeorm/README.md b/sample/13-mongo-typeorm/README.md
index 382469cf6..f9207ca33 100644
--- a/sample/13-mongo-typeorm/README.md
+++ b/sample/13-mongo-typeorm/README.md
@@ -1,8 +1,7 @@
-### Mongoose sample
+### Mongo TypeORM sample
 
 ### Installation
 
-
 `npm install`
 
 ### Running
@@ -23,4 +22,4 @@ After running the sample, you can stop the Docker container with
 
 Then, run Nest as usual:
 
-`npm run start`
\ No newline at end of file
+`npm run start`
diff --git a/sample/13-mongo-typeorm/docker-compose.yml b/sample/13-mongo-typeorm/docker-compose.yml
index 834d04a17..b237343a4 100644
--- a/sample/13-mongo-typeorm/docker-compose.yml
+++ b/sample/13-mongo-typeorm/docker-compose.yml
@@ -2,7 +2,7 @@ version: "3"
 
 services:
   mongodb:
-    image: mongo:5.0
+    image: mongo:7.0
     environment:
       - MONGODB_DATABASE="test"
     ports:
diff --git a/sample/13-mongo-typeorm/package-lock.json b/sample/13-mongo-typeorm/package-lock.json
index b7c122ecb..0c762b0f6 100644
Binary files a/sample/13-mongo-typeorm/package-lock.json and b/sample/13-mongo-typeorm/package-lock.json differ
diff --git a/sample/13-mongo-typeorm/package.json b/sample/13-mongo-typeorm/package.json
index af65c376f..304a6a338 100644
--- a/sample/13-mongo-typeorm/package.json
+++ b/sample/13-mongo-typeorm/package.json
@@ -19,37 +19,37 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "@nestjs/typeorm": "8.0.2",
-    "mongodb": "3.7.3",
-    "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0",
-    "typeorm": "0.2.41"
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/platform-express": "10.4.10",
+    "@nestjs/typeorm": "10.0.1",
+    "mongodb": "6.3.0",
+    "reflect-metadata": "0.2.1",
+    "rimraf": "5.0.10",
+    "rxjs": "7.8.1",
+    "typeorm": "0.3.20"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.7",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.19",
-    "@types/supertest": "2.0.11",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "jest": "27.3.1",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@nestjs/testing": "10.4.10",
+    "@types/express": "4.17.21",
+    "@types/jest": "29.5.12",
+    "@types/node": "20.17.8",
+    "@types/supertest": "6.0.2",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.42.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-import": "2.29.1",
+    "jest": "29.7.0",
+    "prettier": "3.2.5",
+    "supertest": "6.3.4",
+    "ts-jest": "29.1.2",
+    "ts-loader": "9.5.1",
+    "ts-node": "10.9.2",
+    "tsconfig-paths": "4.2.0",
+    "typescript": "5.3.3"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/13-mongo-typeorm/src/photo/photo.entity.ts b/sample/13-mongo-typeorm/src/photo/photo.entity.ts
index 92dfd47ff..4fe2d4c77 100644
--- a/sample/13-mongo-typeorm/src/photo/photo.entity.ts
+++ b/sample/13-mongo-typeorm/src/photo/photo.entity.ts
@@ -1,9 +1,9 @@
-import { Column, Entity, ObjectID, ObjectIdColumn } from 'typeorm';
+import { Column, Entity, ObjectId, ObjectIdColumn } from 'typeorm';
 
 @Entity()
 export class Photo {
   @ObjectIdColumn()
-  id: ObjectID;
+  id: ObjectId;
 
   @Column()
   name: string;
diff --git a/sample/13-mongo-typeorm/src/photo/photo.service.ts b/sample/13-mongo-typeorm/src/photo/photo.service.ts
index 31c751b35..0bca3ddee 100644
--- a/sample/13-mongo-typeorm/src/photo/photo.service.ts
+++ b/sample/13-mongo-typeorm/src/photo/photo.service.ts
@@ -1,13 +1,13 @@
 import { Injectable } from '@nestjs/common';
 import { InjectRepository } from '@nestjs/typeorm';
-import { Repository } from 'typeorm';
+import { MongoRepository } from 'typeorm';
 import { Photo } from './photo.entity';
 
 @Injectable()
 export class PhotoService {
   constructor(
     @InjectRepository(Photo)
-    private readonly photoRepository: Repository<Photo>,
+    private readonly photoRepository: MongoRepository<Photo>,
   ) {}
 
   async findAll(): Promise<Photo[]> {
diff --git a/sample/13-mongo-typeorm/tsconfig.json b/sample/13-mongo-typeorm/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/13-mongo-typeorm/tsconfig.json
+++ b/sample/13-mongo-typeorm/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/14-mongoose-base/package-lock.json b/sample/14-mongoose-base/package-lock.json
index 6f6ccc72a..1c546cfb7 100644
Binary files a/sample/14-mongoose-base/package-lock.json and b/sample/14-mongoose-base/package-lock.json differ
diff --git a/sample/14-mongoose-base/package.json b/sample/14-mongoose-base/package.json
index e67a4b03d..8361ae938 100644
--- a/sample/14-mongoose-base/package.json
+++ b/sample/14-mongoose-base/package.json
@@ -19,35 +19,35 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "mongoose": "6.0.15",
-    "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/platform-express": "10.4.10",
+    "mongoose": "8.8.3",
+    "reflect-metadata": "0.2.1",
+    "rimraf": "5.0.10",
+    "rxjs": "7.8.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.19",
-    "@types/supertest": "2.0.11",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "jest": "27.3.1",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@nestjs/testing": "10.4.10",
+    "@types/express": "4.17.21",
+    "@types/jest": "29.5.12",
+    "@types/node": "20.17.8",
+    "@types/supertest": "6.0.2",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.42.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-import": "2.29.1",
+    "jest": "29.7.0",
+    "prettier": "3.2.5",
+    "supertest": "6.3.4",
+    "ts-jest": "29.1.2",
+    "ts-loader": "9.5.1",
+    "ts-node": "10.9.2",
+    "tsconfig-paths": "4.2.0",
+    "typescript": "5.3.3"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/14-mongoose-base/src/cats/cats.service.spec.ts b/sample/14-mongoose-base/src/cats/cats.service.spec.ts
index 18d086802..5e8aba135 100644
--- a/sample/14-mongoose-base/src/cats/cats.service.spec.ts
+++ b/sample/14-mongoose-base/src/cats/cats.service.spec.ts
@@ -1,7 +1,7 @@
 import { Test, TestingModule } from '@nestjs/testing';
+import { Model } from 'mongoose';
 import { CatsService } from './cats.service';
 import { Cat } from './interfaces/cat.interface';
-import { Model } from 'mongoose';
 
 const mockCat = {
   name: 'Cat #1',
@@ -66,7 +66,7 @@ describe('CatService', () => {
         name: 'Cat #1',
         breed: 'Breed #1',
         age: 4,
-      }),
+      } as any),
     );
     const newCat = await service.create({
       name: 'Cat #1',
diff --git a/sample/14-mongoose-base/tsconfig.json b/sample/14-mongoose-base/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/14-mongoose-base/tsconfig.json
+++ b/sample/14-mongoose-base/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/15-mvc/package-lock.json b/sample/15-mvc/package-lock.json
index 611c958c6..931b4ef3d 100644
Binary files a/sample/15-mvc/package-lock.json and b/sample/15-mvc/package-lock.json differ
diff --git a/sample/15-mvc/package.json b/sample/15-mvc/package.json
index 5c3db3701..fca6426ef 100644
--- a/sample/15-mvc/package.json
+++ b/sample/15-mvc/package.json
@@ -19,34 +19,33 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/platform-express": "10.4.10",
     "hbs": "4.2.0",
-    "pug": "3.0.2",
-    "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "reflect-metadata": "0.2.1",
+    "rimraf": "5.0.10",
+    "rxjs": "7.8.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/node": "16.11.19",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@nestjs/testing": "10.4.10",
+    "@types/express": "4.17.21",
+    "@types/node": "20.17.8",
+    "@types/supertest": "6.0.2",
+    "jest": "29.7.0",
+    "prettier": "3.2.5",
+    "supertest": "6.3.4",
+    "ts-jest": "29.1.2",
+    "ts-loader": "9.5.1",
+    "ts-node": "10.9.2",
+    "tsconfig-paths": "4.2.0",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.42.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-import": "2.29.1",
+    "typescript": "5.3.3"
   }
 }
diff --git a/sample/15-mvc/tsconfig.json b/sample/15-mvc/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/15-mvc/tsconfig.json
+++ b/sample/15-mvc/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/16-gateways-ws/package-lock.json b/sample/16-gateways-ws/package-lock.json
index 3fc0bd85b..3a60b3bb3 100644
Binary files a/sample/16-gateways-ws/package-lock.json and b/sample/16-gateways-ws/package-lock.json differ
diff --git a/sample/16-gateways-ws/package.json b/sample/16-gateways-ws/package.json
index 64dad4963..d09a656d2 100644
--- a/sample/16-gateways-ws/package.json
+++ b/sample/16-gateways-ws/package.json
@@ -19,38 +19,38 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "@nestjs/platform-ws": "8.2.3",
-    "@nestjs/websockets": "8.2.3",
-    "class-transformer": "0.4.0",
-    "class-validator": "0.13.2",
-    "rimraf": "3.0.2",
-    "reflect-metadata": "0.1.13",
-    "rxjs": "7.4.0",
-    "ws": "7.5.6"
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/platform-express": "10.4.10",
+    "@nestjs/platform-ws": "10.4.10",
+    "@nestjs/websockets": "10.4.10",
+    "class-transformer": "0.5.1",
+    "class-validator": "0.14.1",
+    "rimraf": "5.0.10",
+    "reflect-metadata": "0.2.1",
+    "rxjs": "7.8.1",
+    "ws": "8.17.1"
   },
   "devDependencies": {
-    "@types/ws": "7.4.7",
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/node": "16.11.19",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@types/ws": "8.5.5",
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@nestjs/testing": "10.4.10",
+    "@types/express": "4.17.21",
+    "@types/node": "20.17.8",
+    "@types/supertest": "6.0.2",
+    "jest": "29.7.0",
+    "prettier": "3.2.5",
+    "supertest": "6.3.4",
+    "ts-jest": "29.1.2",
+    "ts-loader": "9.5.1",
+    "ts-node": "10.9.2",
+    "tsconfig-paths": "4.2.0",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.42.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-import": "2.29.1",
+    "typescript": "5.3.3"
   }
 }
diff --git a/sample/16-gateways-ws/tsconfig.json b/sample/16-gateways-ws/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/16-gateways-ws/tsconfig.json
+++ b/sample/16-gateways-ws/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/17-mvc-fastify/package-lock.json b/sample/17-mvc-fastify/package-lock.json
index 3cc5840a5..95a8b455b 100644
Binary files a/sample/17-mvc-fastify/package-lock.json and b/sample/17-mvc-fastify/package-lock.json differ
diff --git a/sample/17-mvc-fastify/package.json b/sample/17-mvc-fastify/package.json
index 84b2cb878..cbf8d842c 100644
--- a/sample/17-mvc-fastify/package.json
+++ b/sample/17-mvc-fastify/package.json
@@ -1,53 +1,53 @@
 {
-  "name": "nest-typescript-starter",
-  "version": "1.0.0",
-  "description": "Nest TypeScript starter repository",
-  "license": "MIT",
-  "scripts": {
-    "prebuild": "rimraf dist",
-    "build": "nest build",
-    "format": "prettier --write \"src/**/*.ts\" \"test/**/*.ts\"",
-    "start": "nest start",
-    "start:dev": "nest start --watch",
-    "start:debug": "nest start --debug --watch",
-    "start:prod": "node dist/main",
-    "lint": "eslint '{src,apps,libs,test}/**/*.ts' --fix",
-    "test": "jest",
-    "test:watch": "jest --watch",
-    "test:cov": "jest --coverage",
-    "test:debug": "node --inspect-brk -r tsconfig-paths/register -r ts-node/register node_modules/.bin/jest --runInBand",
-    "test:e2e": "echo 'No e2e tests implemented yet.'"
-  },
-  "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-fastify": "8.2.3",
-    "fastify-static": "4.5.0",
-    "handlebars": "4.7.7",
-    "point-of-view": "4.15.3",
-    "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
-  },
-  "devDependencies": {
-    "@nestjs/cli": "8.1.7",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/node": "16.11.19",
-    "@types/supertest": "2.0.11",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "jest": "27.3.1",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "typescript": "4.3.5"
-  }
+    "name": "nest-typescript-starter",
+    "version": "1.0.0",
+    "description": "Nest TypeScript starter repository",
+    "license": "MIT",
+    "scripts": {
+        "prebuild": "rimraf dist",
+        "build": "nest build",
+        "format": "prettier --write \"src/**/*.ts\" \"test/**/*.ts\"",
+        "start": "nest start",
+        "start:dev": "nest start --watch",
+        "start:debug": "nest start --debug --watch",
+        "start:prod": "node dist/main",
+        "lint": "eslint '{src,apps,libs,test}/**/*.ts' --fix",
+        "test": "jest",
+        "test:watch": "jest --watch",
+        "test:cov": "jest --coverage",
+        "test:debug": "node --inspect-brk -r tsconfig-paths/register -r ts-node/register node_modules/.bin/jest --runInBand",
+        "test:e2e": "echo 'No e2e tests implemented yet.'"
+    },
+    "dependencies": {
+        "@nestjs/common": "10.4.10",
+        "@nestjs/core": "10.4.10",
+        "@nestjs/platform-fastify": "10.4.10",
+        "@fastify/static": "7.0.1",
+        "handlebars": "4.7.8",
+        "@fastify/view": "8.2.0",
+        "reflect-metadata": "0.2.1",
+        "rimraf": "5.0.10",
+        "rxjs": "7.8.1"
+    },
+    "devDependencies": {
+        "@nestjs/cli": "10.4.8",
+        "@nestjs/schematics": "10.2.3",
+        "@nestjs/testing": "10.4.10",
+        "@types/express": "4.17.21",
+        "@types/node": "20.17.8",
+        "@types/supertest": "6.0.2",
+        "@typescript-eslint/eslint-plugin": "5.62.0",
+        "@typescript-eslint/parser": "5.62.0",
+        "eslint": "8.42.0",
+        "eslint-config-prettier": "9.1.0",
+        "eslint-plugin-import": "2.29.1",
+        "jest": "29.7.0",
+        "prettier": "3.2.5",
+        "supertest": "6.3.4",
+        "ts-jest": "29.1.2",
+        "ts-loader": "9.5.1",
+        "ts-node": "10.9.2",
+        "tsconfig-paths": "4.2.0",
+        "typescript": "5.3.3"
+    }
 }
diff --git a/sample/17-mvc-fastify/tsconfig.json b/sample/17-mvc-fastify/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/17-mvc-fastify/tsconfig.json
+++ b/sample/17-mvc-fastify/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/18-context/package-lock.json b/sample/18-context/package-lock.json
index f5bbb2268..3892961ae 100644
Binary files a/sample/18-context/package-lock.json and b/sample/18-context/package-lock.json differ
diff --git a/sample/18-context/package.json b/sample/18-context/package.json
index d5ac47fad..e8d5b3c21 100644
--- a/sample/18-context/package.json
+++ b/sample/18-context/package.json
@@ -19,29 +19,29 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "reflect-metadata": "0.2.1",
+    "rimraf": "5.0.10",
+    "rxjs": "7.8.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@types/node": "16.11.19",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@types/node": "20.17.8",
+    "@types/supertest": "6.0.2",
+    "jest": "29.7.0",
+    "prettier": "3.2.5",
+    "supertest": "6.3.4",
+    "ts-jest": "29.1.2",
+    "ts-loader": "9.5.1",
+    "ts-node": "10.9.2",
+    "tsconfig-paths": "4.2.0",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.42.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-import": "2.29.1",
+    "typescript": "5.3.3"
   }
 }
diff --git a/sample/18-context/src/app.module.ts b/sample/18-context/src/app.module.ts
index 3298df774..0f9c3fb3a 100644
--- a/sample/18-context/src/app.module.ts
+++ b/sample/18-context/src/app.module.ts
@@ -1,7 +1,11 @@
 import { Module } from '@nestjs/common';
 import { AppService } from './app.service';
+import { MyDynamicModule } from './my-dynamic.module';
+
+export const dynamicModule = MyDynamicModule.register('foobar');
 
 @Module({
+  imports: [dynamicModule],
   providers: [AppService],
 })
 export class AppModule {}
diff --git a/sample/18-context/src/main.ts b/sample/18-context/src/main.ts
index 117e62b27..a6e8f13a8 100644
--- a/sample/18-context/src/main.ts
+++ b/sample/18-context/src/main.ts
@@ -1,10 +1,19 @@
 import { NestFactory } from '@nestjs/core';
-import { AppModule } from './app.module';
+import { AppModule, dynamicModule } from './app.module';
 import { AppService } from './app.service';
 
 async function bootstrap() {
   const app = await NestFactory.createApplicationContext(AppModule);
+
   const appService = app.get(AppService);
-  console.log(appService.getHello());
+  console.log('AppService#getHello:', appService.getHello());
+
+  // Note that below we can't use `app.select(MyDynamicModule)` otherwise we would get an error as the static version of `MyDynamicModule` was not imported anywhere
+  const myDynamicProviderValue = app
+    .select(dynamicModule)
+    .get('MyDynamicProvider');
+  console.log('MyDynamicProvider:', myDynamicProviderValue);
+
+  return app.close();
 }
 bootstrap();
diff --git a/sample/18-context/src/my-dynamic.module.ts b/sample/18-context/src/my-dynamic.module.ts
new file mode 100644
index 000000000..2143dc712
--- /dev/null
+++ b/sample/18-context/src/my-dynamic.module.ts
@@ -0,0 +1,17 @@
+import { Module, DynamicModule } from '@nestjs/common';
+
+@Module({})
+export class MyDynamicModule {
+  static register(dyanmicProviderValue: any): DynamicModule {
+    return {
+      module: MyDynamicModule,
+      providers: [
+        {
+          provide: 'MyDynamicProvider',
+          useValue: dyanmicProviderValue,
+        },
+      ],
+      exports: ['MyDynamicProvider'],
+    };
+  }
+}
diff --git a/sample/18-context/tsconfig.json b/sample/18-context/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/18-context/tsconfig.json
+++ b/sample/18-context/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/19-auth-jwt/e2e/app/app.e2e-spec.ts b/sample/19-auth-jwt/e2e/app/app.e2e-spec.ts
index 7c07c91cc..b92a425e1 100644
--- a/sample/19-auth-jwt/e2e/app/app.e2e-spec.ts
+++ b/sample/19-auth-jwt/e2e/app/app.e2e-spec.ts
@@ -19,14 +19,17 @@ describe('E2E JWT Sample', () => {
     const loginReq = await request(app.getHttpServer())
       .post('/auth/login')
       .send({ username: 'john', password: 'changeme' })
-      .expect(201);
+      .expect(200);
 
     const token = loginReq.body.access_token;
     return request(app.getHttpServer())
-      .get('/profile')
+      .get('/auth/profile')
       .set('Authorization', 'Bearer ' + token)
       .expect(200)
-      .expect({ userId: 1, username: 'john' });
+      .expect(({ body }) => {
+        expect(body.sub).toEqual(1);
+        expect(body.username).toEqual('john');
+      });
   });
 
   afterAll(async () => {
diff --git a/sample/19-auth-jwt/package-lock.json b/sample/19-auth-jwt/package-lock.json
index c63600cd1..5f5fcd63b 100644
Binary files a/sample/19-auth-jwt/package-lock.json and b/sample/19-auth-jwt/package-lock.json differ
diff --git a/sample/19-auth-jwt/package.json b/sample/19-auth-jwt/package.json
index f06a195eb..f47e576d4 100644
--- a/sample/19-auth-jwt/package.json
+++ b/sample/19-auth-jwt/package.json
@@ -20,39 +20,36 @@
     "test:e2e": "jest --config ./e2e/jest-e2e.json"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/jwt": "8.0.0",
-    "@nestjs/passport": "8.0.1",
-    "@nestjs/platform-express": "8.2.3",
-    "passport": "0.5.0",
-    "passport-jwt": "4.0.0",
-    "passport-local": "1.0.0",
-    "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/jwt": "10.2.0",
+    "@nestjs/passport": "10.0.3",
+    "@nestjs/platform-express": "10.4.10",
+    "reflect-metadata": "0.2.1",
+    "rimraf": "5.0.10",
+    "rxjs": "7.8.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.19",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@nestjs/testing": "10.4.10",
+    "@types/express": "4.17.21",
+    "@types/jest": "29.5.12",
+    "@types/node": "20.17.8",
+    "@types/supertest": "6.0.2",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.42.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-import": "2.29.1",
+    "jest": "29.7.0",
+    "prettier": "3.2.5",
+    "supertest": "6.3.4",
+    "ts-jest": "29.1.2",
+    "ts-loader": "9.5.1",
+    "ts-node": "10.9.2",
+    "tsconfig-paths": "4.2.0",
+    "typescript": "5.3.3"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/19-auth-jwt/src/app.controller.ts b/sample/19-auth-jwt/src/app.controller.ts
index 4c6b68ca9..24fa19368 100644
--- a/sample/19-auth-jwt/src/app.controller.ts
+++ b/sample/19-auth-jwt/src/app.controller.ts
@@ -1,21 +1,4 @@
-import { Controller, Get, Post, Request, UseGuards } from '@nestjs/common';
-import { AuthService } from './auth/auth.service';
-import { JwtAuthGuard } from './auth/guards/jwt-auth.guard';
-import { LocalAuthGuard } from './auth/guards/local-auth.guard';
+import { Controller } from '@nestjs/common';
 
 @Controller()
-export class AppController {
-  constructor(private readonly authService: AuthService) {}
-
-  @UseGuards(LocalAuthGuard)
-  @Post('auth/login')
-  async login(@Request() req) {
-    return this.authService.login(req.user);
-  }
-
-  @UseGuards(JwtAuthGuard)
-  @Get('profile')
-  getProfile(@Request() req) {
-    return req.user;
-  }
-}
+export class AppController {}
diff --git a/sample/19-auth-jwt/src/auth/auth.controller.ts b/sample/19-auth-jwt/src/auth/auth.controller.ts
new file mode 100644
index 000000000..8e7b51642
--- /dev/null
+++ b/sample/19-auth-jwt/src/auth/auth.controller.ts
@@ -0,0 +1,28 @@
+import {
+  Body,
+  Controller,
+  Get,
+  HttpCode,
+  HttpStatus,
+  Post,
+  Request,
+} from '@nestjs/common';
+import { AuthService } from './auth.service';
+import { Public } from './decorators/public.decorator';
+
+@Controller('auth')
+export class AuthController {
+  constructor(private authService: AuthService) {}
+
+  @Public()
+  @HttpCode(HttpStatus.OK)
+  @Post('login')
+  signIn(@Body() signInDto: Record<string, any>) {
+    return this.authService.signIn(signInDto.username, signInDto.password);
+  }
+
+  @Get('profile')
+  getProfile(@Request() req) {
+    return req.user;
+  }
+}
diff --git a/sample/19-auth-jwt/src/auth/auth.guard.ts b/sample/19-auth-jwt/src/auth/auth.guard.ts
new file mode 100644
index 000000000..8ae499c1b
--- /dev/null
+++ b/sample/19-auth-jwt/src/auth/auth.guard.ts
@@ -0,0 +1,52 @@
+import {
+  CanActivate,
+  ExecutionContext,
+  Injectable,
+  UnauthorizedException,
+} from '@nestjs/common';
+import { Reflector } from '@nestjs/core';
+import { JwtService } from '@nestjs/jwt';
+import { Request } from 'express';
+import { jwtConstants } from './constants';
+import { IS_PUBLIC_KEY } from './decorators/public.decorator';
+
+@Injectable()
+export class AuthGuard implements CanActivate {
+  constructor(
+    private jwtService: JwtService,
+    private reflector: Reflector,
+  ) {}
+
+  async canActivate(context: ExecutionContext): Promise<boolean> {
+    const isPublic = this.reflector.getAllAndOverride<boolean>(IS_PUBLIC_KEY, [
+      context.getHandler(),
+      context.getClass(),
+    ]);
+    if (isPublic) {
+      // üí° See this condition
+      return true;
+    }
+
+    const request = context.switchToHttp().getRequest();
+    const token = this.extractTokenFromHeader(request);
+    if (!token) {
+      throw new UnauthorizedException();
+    }
+    try {
+      const payload = await this.jwtService.verifyAsync(token, {
+        secret: jwtConstants.secret,
+      });
+      // üí° We're assigning the payload to the request object here
+      // so that we can access it in our route handlers
+      request['user'] = payload;
+    } catch {
+      throw new UnauthorizedException();
+    }
+    return true;
+  }
+
+  private extractTokenFromHeader(request: Request): string | undefined {
+    const [type, token] = request.headers.authorization?.split(' ') ?? [];
+    return type === 'Bearer' ? token : undefined;
+  }
+}
diff --git a/sample/19-auth-jwt/src/auth/auth.module.ts b/sample/19-auth-jwt/src/auth/auth.module.ts
index 7e853d5b7..9361229eb 100644
--- a/sample/19-auth-jwt/src/auth/auth.module.ts
+++ b/sample/19-auth-jwt/src/auth/auth.module.ts
@@ -1,22 +1,29 @@
 import { Module } from '@nestjs/common';
+import { APP_GUARD } from '@nestjs/core';
 import { JwtModule } from '@nestjs/jwt';
-import { PassportModule } from '@nestjs/passport';
 import { UsersModule } from '../users/users.module';
+import { AuthController } from './auth.controller';
+import { AuthGuard } from './auth.guard';
 import { AuthService } from './auth.service';
 import { jwtConstants } from './constants';
-import { JwtStrategy } from './strategies/jwt.strategy';
-import { LocalStrategy } from './strategies/local.strategy';
 
 @Module({
   imports: [
     UsersModule,
-    PassportModule,
     JwtModule.register({
+      global: true,
       secret: jwtConstants.secret,
       signOptions: { expiresIn: '60s' },
     }),
   ],
-  providers: [AuthService, LocalStrategy, JwtStrategy],
+  providers: [
+    AuthService,
+    {
+      provide: APP_GUARD,
+      useClass: AuthGuard,
+    },
+  ],
+  controllers: [AuthController],
   exports: [AuthService],
 })
 export class AuthModule {}
diff --git a/sample/19-auth-jwt/src/auth/auth.service.spec.ts b/sample/19-auth-jwt/src/auth/auth.service.spec.ts
deleted file mode 100644
index 7f1241107..000000000
--- a/sample/19-auth-jwt/src/auth/auth.service.spec.ts
+++ /dev/null
@@ -1,87 +0,0 @@
-import { JwtModule } from '@nestjs/jwt';
-import { PassportModule } from '@nestjs/passport';
-import { Test, TestingModule } from '@nestjs/testing';
-import { UsersModule } from '../users/users.module';
-import { AuthService } from './auth.service';
-import { jwtConstants } from './constants';
-import { JwtStrategy } from './strategies/jwt.strategy';
-import { LocalStrategy } from './strategies/local.strategy';
-
-describe('AuthService', () => {
-  let service: AuthService;
-
-  beforeEach(async () => {
-    const moduleRef: TestingModule = await Test.createTestingModule({
-      imports: [
-        UsersModule,
-        PassportModule,
-        JwtModule.register({
-          secret: jwtConstants.secret,
-          signOptions: { expiresIn: '60s' },
-        }),
-      ],
-      providers: [AuthService, LocalStrategy, JwtStrategy],
-    }).compile();
-
-    service = moduleRef.get<AuthService>(AuthService);
-  });
-
-  it('should be defined', () => {
-    expect(service).toBeDefined();
-  });
-});
-
-describe('validateUser', () => {
-  let service: AuthService;
-
-  beforeEach(async () => {
-    const moduleRef: TestingModule = await Test.createTestingModule({
-      imports: [
-        UsersModule,
-        PassportModule,
-        JwtModule.register({
-          secret: jwtConstants.secret,
-          signOptions: { expiresIn: '60s' },
-        }),
-      ],
-      providers: [AuthService, LocalStrategy, JwtStrategy],
-    }).compile();
-
-    service = moduleRef.get<AuthService>(AuthService);
-  });
-
-  it('should return a user object when credentials are valid', async () => {
-    const res = await service.validateUser('maria', 'guess');
-    expect(res.userId).toEqual(3);
-  });
-
-  it('should return null when credentials are invalid', async () => {
-    const res = await service.validateUser('xxx', 'xxx');
-    expect(res).toBeNull();
-  });
-});
-
-describe('validateLogin', () => {
-  let service: AuthService;
-
-  beforeEach(async () => {
-    const moduleRef: TestingModule = await Test.createTestingModule({
-      imports: [
-        UsersModule,
-        PassportModule,
-        JwtModule.register({
-          secret: jwtConstants.secret,
-          signOptions: { expiresIn: '60s' },
-        }),
-      ],
-      providers: [AuthService, LocalStrategy, JwtStrategy],
-    }).compile();
-
-    service = moduleRef.get<AuthService>(AuthService);
-  });
-
-  it('should return JWT object when credentials are valid', async () => {
-    const res = await service.login({ username: 'maria', userId: 3 });
-    expect(res.access_token).toBeDefined();
-  });
-});
diff --git a/sample/19-auth-jwt/src/auth/auth.service.ts b/sample/19-auth-jwt/src/auth/auth.service.ts
index c477d52b2..f97c917d7 100644
--- a/sample/19-auth-jwt/src/auth/auth.service.ts
+++ b/sample/19-auth-jwt/src/auth/auth.service.ts
@@ -1,27 +1,22 @@
-import { Injectable } from '@nestjs/common';
-import { UsersService } from '../users/users.service';
+import { Injectable, UnauthorizedException } from '@nestjs/common';
 import { JwtService } from '@nestjs/jwt';
+import { UsersService } from '../users/users.service';
 
 @Injectable()
 export class AuthService {
   constructor(
-    private readonly usersService: UsersService,
-    private readonly jwtService: JwtService,
+    private usersService: UsersService,
+    private jwtService: JwtService,
   ) {}
 
-  async validateUser(username: string, pass: string): Promise<any> {
+  async signIn(username: string, pass: string) {
     const user = await this.usersService.findOne(username);
-    if (user && user.password === pass) {
-      const { password, ...result } = user;
-      return result;
+    if (user?.password !== pass) {
+      throw new UnauthorizedException();
     }
-    return null;
-  }
-
-  async login(user: any) {
     const payload = { username: user.username, sub: user.userId };
     return {
-      access_token: this.jwtService.sign(payload),
+      access_token: await this.jwtService.signAsync(payload),
     };
   }
 }
diff --git a/sample/19-auth-jwt/src/auth/constants.ts b/sample/19-auth-jwt/src/auth/constants.ts
index 8b22f8b64..9e8c4061f 100644
--- a/sample/19-auth-jwt/src/auth/constants.ts
+++ b/sample/19-auth-jwt/src/auth/constants.ts
@@ -1,3 +1,4 @@
 export const jwtConstants = {
-  secret: 'secretKey',
+  secret:
+    'DO NOT USE THIS VALUE. INSTEAD, CREATE A COMPLEX SECRET AND KEEP IT SAFE OUTSIDE OF THE SOURCE CODE.',
 };
diff --git a/sample/19-auth-jwt/src/auth/decorators/public.decorator.ts b/sample/19-auth-jwt/src/auth/decorators/public.decorator.ts
new file mode 100644
index 000000000..b3845e122
--- /dev/null
+++ b/sample/19-auth-jwt/src/auth/decorators/public.decorator.ts
@@ -0,0 +1,4 @@
+import { SetMetadata } from '@nestjs/common';
+
+export const IS_PUBLIC_KEY = 'isPublic';
+export const Public = () => SetMetadata(IS_PUBLIC_KEY, true);
diff --git a/sample/19-auth-jwt/src/auth/guards/jwt-auth.guard.ts b/sample/19-auth-jwt/src/auth/guards/jwt-auth.guard.ts
deleted file mode 100644
index 2155290ed..000000000
--- a/sample/19-auth-jwt/src/auth/guards/jwt-auth.guard.ts
+++ /dev/null
@@ -1,5 +0,0 @@
-import { Injectable } from '@nestjs/common';
-import { AuthGuard } from '@nestjs/passport';
-
-@Injectable()
-export class JwtAuthGuard extends AuthGuard('jwt') {}
diff --git a/sample/19-auth-jwt/src/auth/guards/local-auth.guard.ts b/sample/19-auth-jwt/src/auth/guards/local-auth.guard.ts
deleted file mode 100644
index ccf962b67..000000000
--- a/sample/19-auth-jwt/src/auth/guards/local-auth.guard.ts
+++ /dev/null
@@ -1,5 +0,0 @@
-import { Injectable } from '@nestjs/common';
-import { AuthGuard } from '@nestjs/passport';
-
-@Injectable()
-export class LocalAuthGuard extends AuthGuard('local') {}
diff --git a/sample/19-auth-jwt/src/auth/strategies/jwt.strategy.ts b/sample/19-auth-jwt/src/auth/strategies/jwt.strategy.ts
deleted file mode 100644
index 08524da5a..000000000
--- a/sample/19-auth-jwt/src/auth/strategies/jwt.strategy.ts
+++ /dev/null
@@ -1,19 +0,0 @@
-import { Injectable } from '@nestjs/common';
-import { PassportStrategy } from '@nestjs/passport';
-import { ExtractJwt, Strategy } from 'passport-jwt';
-import { jwtConstants } from '../constants';
-
-@Injectable()
-export class JwtStrategy extends PassportStrategy(Strategy) {
-  constructor() {
-    super({
-      jwtFromRequest: ExtractJwt.fromAuthHeaderAsBearerToken(),
-      ignoreExpiration: false,
-      secretOrKey: jwtConstants.secret,
-    });
-  }
-
-  async validate(payload: any) {
-    return { userId: payload.sub, username: payload.username };
-  }
-}
diff --git a/sample/19-auth-jwt/src/auth/strategies/local.strategy.ts b/sample/19-auth-jwt/src/auth/strategies/local.strategy.ts
deleted file mode 100644
index 79f85280f..000000000
--- a/sample/19-auth-jwt/src/auth/strategies/local.strategy.ts
+++ /dev/null
@@ -1,19 +0,0 @@
-import { Injectable, UnauthorizedException } from '@nestjs/common';
-import { PassportStrategy } from '@nestjs/passport';
-import { Strategy } from 'passport-local';
-import { AuthService } from '../auth.service';
-
-@Injectable()
-export class LocalStrategy extends PassportStrategy(Strategy) {
-  constructor(private readonly authService: AuthService) {
-    super();
-  }
-
-  async validate(username: string, password: string): Promise<any> {
-    const user = await this.authService.validateUser(username, password);
-    if (!user) {
-      throw new UnauthorizedException();
-    }
-    return user;
-  }
-}
diff --git a/sample/19-auth-jwt/src/users/users.service.spec.ts b/sample/19-auth-jwt/src/users/users.service.spec.ts
index 71c5e2da4..62815ba64 100644
--- a/sample/19-auth-jwt/src/users/users.service.spec.ts
+++ b/sample/19-auth-jwt/src/users/users.service.spec.ts
@@ -1,27 +1,18 @@
 import { Test, TestingModule } from '@nestjs/testing';
-import { User, UsersService } from './users.service';
+import { UsersService } from './users.service';
 
 describe('UsersService', () => {
   let service: UsersService;
 
   beforeEach(async () => {
-    const moduleRef: TestingModule = await Test.createTestingModule({
+    const module: TestingModule = await Test.createTestingModule({
       providers: [UsersService],
     }).compile();
 
-    service = moduleRef.get<UsersService>(UsersService);
+    service = module.get<UsersService>(UsersService);
   });
 
   it('should be defined', () => {
     expect(service).toBeDefined();
   });
-  it.each`
-    name      | returnVal
-    ${'john'} | ${{ userId: 1, username: 'john', password: 'changeme' }}
-  `(
-    'should call findOne for $name and return $returnVal',
-    async ({ name, returnVal }: { name: string; returnVal: User }) => {
-      expect(await service.findOne(name)).toEqual(returnVal);
-    },
-  );
 });
diff --git a/sample/19-auth-jwt/src/users/users.service.ts b/sample/19-auth-jwt/src/users/users.service.ts
index f24f26b30..47e5cde7b 100644
--- a/sample/19-auth-jwt/src/users/users.service.ts
+++ b/sample/19-auth-jwt/src/users/users.service.ts
@@ -1,30 +1,22 @@
 import { Injectable } from '@nestjs/common';
 
+// This should be a real class/interface representing a user entity
 export type User = any;
 
 @Injectable()
 export class UsersService {
-  private readonly users: User[];
-
-  constructor() {
-    this.users = [
-      {
-        userId: 1,
-        username: 'john',
-        password: 'changeme',
-      },
-      {
-        userId: 2,
-        username: 'chris',
-        password: 'secret',
-      },
-      {
-        userId: 3,
-        username: 'maria',
-        password: 'guess',
-      },
-    ];
-  }
+  private readonly users = [
+    {
+      userId: 1,
+      username: 'john',
+      password: 'changeme',
+    },
+    {
+      userId: 2,
+      username: 'maria',
+      password: 'guess',
+    },
+  ];
 
   async findOne(username: string): Promise<User | undefined> {
     return this.users.find(user => user.username === username);
diff --git a/sample/19-auth-jwt/tsconfig.json b/sample/19-auth-jwt/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/19-auth-jwt/tsconfig.json
+++ b/sample/19-auth-jwt/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/20-cache/package-lock.json b/sample/20-cache/package-lock.json
index 598a22193..4a1d6b3e9 100644
Binary files a/sample/20-cache/package-lock.json and b/sample/20-cache/package-lock.json differ
diff --git a/sample/20-cache/package.json b/sample/20-cache/package.json
index ed73e2b9f..02e0d3ed6 100644
--- a/sample/20-cache/package.json
+++ b/sample/20-cache/package.json
@@ -19,34 +19,36 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "cache-manager-redis-store": "2.0.0",
-    "class-transformer": "0.4.0",
-    "class-validator": "0.13.2",
-    "reflect-metadata": "0.1.13",
-    "rxjs": "7.4.0"
+    "@nestjs/cache-manager": "2.2.0",
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/platform-express": "10.4.10",
+    "cache-manager": "^5.2.3",
+    "class-transformer": "0.5.1",
+    "class-validator": "0.14.1",
+    "reflect-metadata": "0.2.1",
+    "rxjs": "7.8.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/node": "16.11.19",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@nestjs/testing": "10.4.10",
+    "@types/cache-manager": "^4.0.2",
+    "@types/express": "4.17.21",
+    "@types/node": "20.17.8",
+    "@types/supertest": "6.0.2",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.42.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-import": "2.29.1",
+    "jest": "29.7.0",
+    "prettier": "3.2.5",
+    "supertest": "6.3.4",
+    "ts-jest": "29.1.2",
+    "ts-loader": "9.5.1",
+    "ts-node": "10.9.2",
+    "tsconfig-paths": "4.2.0",
+    "typescript": "5.3.3"
   }
 }
diff --git a/sample/20-cache/src/app.controller.ts b/sample/20-cache/src/app.controller.ts
index d2ba94e99..596ebf4bb 100644
--- a/sample/20-cache/src/app.controller.ts
+++ b/sample/20-cache/src/app.controller.ts
@@ -1,15 +1,14 @@
-import {
-  CacheInterceptor,
-  Controller,
-  Get,
-  UseInterceptors,
-} from '@nestjs/common';
+import { CacheInterceptor } from '@nestjs/cache-manager';
+import { Controller, Get, UseInterceptors } from '@nestjs/common';
 
 @Controller()
 @UseInterceptors(CacheInterceptor)
 export class AppController {
   @Get()
-  findAll() {
+  async findAll() {
+    // For demonstration purposes, we will simulate a delay
+    // to show that the cache is working as expected.
+    await new Promise(resolve => setTimeout(resolve, 3000));
     return [{ id: 1, name: 'Nest' }];
   }
 }
diff --git a/sample/20-cache/src/app.module.ts b/sample/20-cache/src/app.module.ts
index a85f2b5fb..310d05226 100644
--- a/sample/20-cache/src/app.module.ts
+++ b/sample/20-cache/src/app.module.ts
@@ -1,4 +1,5 @@
-import { CacheModule, Module } from '@nestjs/common';
+import { CacheModule } from '@nestjs/cache-manager';
+import { Module } from '@nestjs/common';
 import { AppController } from './app.controller';
 
 @Module({
diff --git a/sample/20-cache/src/common/http-cache.interceptor.ts b/sample/20-cache/src/common/http-cache.interceptor.ts
index c0d3638c7..f2bc578ef 100644
--- a/sample/20-cache/src/common/http-cache.interceptor.ts
+++ b/sample/20-cache/src/common/http-cache.interceptor.ts
@@ -1,4 +1,5 @@
-import { CacheInterceptor, ExecutionContext, Injectable } from '@nestjs/common';
+import { CacheInterceptor } from '@nestjs/cache-manager';
+import { ExecutionContext, Injectable } from '@nestjs/common';
 
 @Injectable()
 export class HttpCacheInterceptor extends CacheInterceptor {
diff --git a/sample/20-cache/tsconfig.json b/sample/20-cache/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/20-cache/tsconfig.json
+++ b/sample/20-cache/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/21-serializer/package-lock.json b/sample/21-serializer/package-lock.json
index 228f6b01e..9d5c855df 100644
Binary files a/sample/21-serializer/package-lock.json and b/sample/21-serializer/package-lock.json differ
diff --git a/sample/21-serializer/package.json b/sample/21-serializer/package.json
index 3e6d58e1b..62071e074 100644
--- a/sample/21-serializer/package.json
+++ b/sample/21-serializer/package.json
@@ -19,33 +19,33 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "class-transformer": "0.4.0",
-    "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/platform-express": "10.4.10",
+    "class-transformer": "0.5.1",
+    "reflect-metadata": "0.2.1",
+    "rimraf": "5.0.10",
+    "rxjs": "7.8.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/node": "16.11.19",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@nestjs/testing": "10.4.10",
+    "@types/express": "4.17.21",
+    "@types/node": "20.17.8",
+    "@types/supertest": "6.0.2",
+    "jest": "29.7.0",
+    "prettier": "3.2.5",
+    "supertest": "6.3.4",
+    "ts-jest": "29.1.2",
+    "ts-loader": "9.5.1",
+    "ts-node": "10.9.2",
+    "tsconfig-paths": "4.2.0",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.42.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-import": "2.29.1",
+    "typescript": "5.3.3"
   }
 }
diff --git a/sample/21-serializer/tsconfig.json b/sample/21-serializer/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/21-serializer/tsconfig.json
+++ b/sample/21-serializer/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/22-graphql-prisma/.eslintrc.js b/sample/22-graphql-prisma/.eslintrc.js
old mode 100644
new mode 100755
diff --git a/sample/22-graphql-prisma/.gitignore b/sample/22-graphql-prisma/.gitignore
old mode 100644
new mode 100755
index d5c8a57e7..d64fba583
--- a/sample/22-graphql-prisma/.gitignore
+++ b/sample/22-graphql-prisma/.gitignore
@@ -1,104 +1,27 @@
+# dependencies
+/node_modules
 
-# Created by https://www.gitignore.io/api/node,macos,visualstudiocode
+# IDE
+/.idea
+/.awcache
+/.vscode
 
-### macOS ###
-*.DS_Store
-.AppleDouble
-.LSOverride
+# misc
+npm-debug.log
 
-# Icon must end with two \r
-Icon
+# example
+/quick-start
 
-# Thumbnails
-._*
+# tests
+/test
+/coverage
+/.nyc_output
 
-# Files that might appear in the root of a volume
-.DocumentRevisions-V100
-.fseventsd
-.Spotlight-V100
-.TemporaryItems
-.Trashes
-.VolumeIcon.icns
-.com.apple.timemachine.donotpresent
+# dist
+/dist
 
-# Directories potentially created on remote AFP share
-.AppleDB
-.AppleDesktop
-Network Trash Folder
-Temporary Items
-.apdisk
+# database
+prisma/dev.db
 
-### Node ###
-# Logs
-logs
-*.log
-npm-debug.log*
-yarn-debug.log*
-yarn-error.log*
-
-# Runtime data
-pids
-*.pid
-*.seed
-*.pid.lock
-
-# Directory for instrumented libs generated by jscoverage/JSCover
-lib-cov
-
-# Coverage directory used by tools like istanbul
-coverage
-
-# nyc test coverage
-.nyc_output
-
-# Grunt intermediate storage (http://gruntjs.com/creating-plugins#storing-task-files)
-.grunt
-
-# Bower dependency directory (https://bower.io/)
-bower_components
-
-# node-waf configuration
-.lock-wscript
-
-# Compiled binary addons (http://nodejs.org/api/addons.html)
-build/Release
-
-# Dependency directories
-node_modules/
-jspm_packages/
-
-# Typescript v1 declaration files
-typings/
-
-# Optional npm cache directory
-.npm
-
-# Optional eslint cache
-.eslintcache
-
-# Optional REPL history
-.node_repl_history
-
-# Output of 'npm pack'
-*.tgz
-
-# Yarn Integrity file
-.yarn-integrity
-
-# dotenv environment variables file
-.env
-
-### VisualStudioCode ###
-.vscode/*
-!.vscode/settings.json
-!.vscode/tasks.json
-!.vscode/launch.json
-!.vscode/extensions.json
-.history
-
-
-# Target Folder
-dist/
-*.deb
-
-# End of https://www.gitignore.io/api/node,macos,visualstudiocode
+# secrets
+.env
\ No newline at end of file
diff --git a/sample/22-graphql-prisma/.graphqlconfig.yml b/sample/22-graphql-prisma/.graphqlconfig.yml
deleted file mode 100644
index 0ef04dedd..000000000
--- a/sample/22-graphql-prisma/.graphqlconfig.yml
+++ /dev/null
@@ -1,11 +0,0 @@
-projects:
-  database:
-    schemaPath: src/prisma/prisma-types.graphql
-    extensions:
-      endpoints:
-        default: https://eu1.prisma.sh/public-agatepuma-476/my-app/dev
-      codegen:
-        - generator: prisma-binding
-          language: typescript
-          output:
-            binding: src/prisma/prisma.binding.ts
diff --git a/sample/22-graphql-prisma/README.md b/sample/22-graphql-prisma/README.md
new file mode 100755
index 000000000..75c5b827a
--- /dev/null
+++ b/sample/22-graphql-prisma/README.md
@@ -0,0 +1,14 @@
+### Prisma GraphQL schema first sample
+
+This sample project uses sqlite as the relational database. To use a different database, check the [Prisma docs](https://www.prisma.io/docs/getting-started).
+
+### Installation
+
+1. Install dependencies: `npm install`
+2. Generate TypeScript type definitions for the GraphQL schema: `npm run generate:typings`
+3. Create sqlite database and create tables: `npx prisma db push`
+4. Start server: `npm run start:dev`
+
+### Graphql Playground
+
+When the application is running, you can go to [http://localhost:3000/graphql](http://localhost:3000/graphql) to access the GraphQL Playground.  See [here](https://docs.nestjs.com/graphql/quick-start#playground) for more.
\ No newline at end of file
diff --git a/sample/22-graphql-prisma/database/datamodel.graphql b/sample/22-graphql-prisma/database/datamodel.graphql
deleted file mode 100644
index d94e42feb..000000000
--- a/sample/22-graphql-prisma/database/datamodel.graphql
+++ /dev/null
@@ -1,6 +0,0 @@
-type Post {
-  id: ID! @unique @id
-  isPublished: Boolean! @default(value: false)
-  title: String!
-  text: String!
-}
diff --git a/sample/22-graphql-prisma/database/prisma.yml b/sample/22-graphql-prisma/database/prisma.yml
deleted file mode 100644
index 33bd8b9e7..000000000
--- a/sample/22-graphql-prisma/database/prisma.yml
+++ /dev/null
@@ -1,20 +0,0 @@
-# The endpoint of your Prisma API (deployed to a Prisma Sandbox).
-endpoint: https://eu1.prisma.sh/public-agatepuma-476/my-app/dev
-
-# The file containing the definition of your data model.
-datamodel: datamodel.graphql
-
-# Seed your service with initial data based on `seed.graphql`.
-seed:
-  import: seed.graphql
-
-# Download the GraphQL schema of the Prisma API into
-# `src/generated/prisma.graphql` (as specfied in `.graphqlconfig.yml`).
-hooks:
-  post-deploy:
-    - graphql get-schema --project database
-
-# If specified, the `secret` must be used to generate a JWT which is attached
-# to the `Authorization` header of HTTP requests made against the Prisma API.
-# Info: https://www.prisma.io/docs/reference/prisma-api/concepts-utee3eiquo#authentication
-# secret: mysecret123
diff --git a/sample/22-graphql-prisma/database/seed.graphql b/sample/22-graphql-prisma/database/seed.graphql
deleted file mode 100644
index c5c21972f..000000000
--- a/sample/22-graphql-prisma/database/seed.graphql
+++ /dev/null
@@ -1,31 +0,0 @@
-mutation {
-  first: createPost(
-    data: {
-      title: "Hello World üëã"
-      text: "I like turtles."
-      isPublished: true
-    }
-  ) {
-    id
-  }
-
-  second: createPost(
-    data: {
-      title: "Join us at GraphQL Europe üá™üá∫ "
-      text: "Get a 10%-discount with this promo code on graphql-europe.org: gql-boilerplates"
-      isPublished: true
-    }
-  ) {
-    id
-  }
-
-  third: createPost(
-    data: {
-      title: "Solving world hunger"
-      text: "This is a draft..."
-      isPublished: false
-    }
-  ) {
-    id
-  }
-}
diff --git a/sample/22-graphql-prisma/generate-typings.ts b/sample/22-graphql-prisma/generate-typings.ts
new file mode 100755
index 000000000..91f00bd20
--- /dev/null
+++ b/sample/22-graphql-prisma/generate-typings.ts
@@ -0,0 +1,9 @@
+import { GraphQLDefinitionsFactory } from '@nestjs/graphql';
+import { join } from 'path';
+
+const definitionsFactory = new GraphQLDefinitionsFactory();
+definitionsFactory.generate({
+  typePaths: ['./src/**/*.graphql'],
+  path: join(process.cwd(), 'src/graphql.schema.ts'),
+  outputAs: 'class',
+});
diff --git a/sample/22-graphql-prisma/nest-cli.json b/sample/22-graphql-prisma/nest-cli.json
new file mode 100755
index 000000000..89bc59ae9
--- /dev/null
+++ b/sample/22-graphql-prisma/nest-cli.json
@@ -0,0 +1,5 @@
+{
+  "compilerOptions": {
+    "assets": ["**/*.graphql"]
+  }
+}
diff --git a/sample/22-graphql-prisma/nodemon.json b/sample/22-graphql-prisma/nodemon.json
deleted file mode 100644
index cef103d86..000000000
--- a/sample/22-graphql-prisma/nodemon.json
+++ /dev/null
@@ -1,6 +0,0 @@
-{
-  "watch": ["src"],
-  "ext": "ts",
-  "ignore": ["src/**/*.spec.ts", "src/graphql.schema.d.ts"],
-  "exec": "ts-node -r tsconfig-paths/register src/main.ts"
-}
diff --git a/sample/22-graphql-prisma/package-lock.json b/sample/22-graphql-prisma/package-lock.json
index 169262439..0b4662b47 100644
Binary files a/sample/22-graphql-prisma/package-lock.json and b/sample/22-graphql-prisma/package-lock.json differ
diff --git a/sample/22-graphql-prisma/package.json b/sample/22-graphql-prisma/package.json
index 3a3f67455..c39a301ed 100644
--- a/sample/22-graphql-prisma/package.json
+++ b/sample/22-graphql-prisma/package.json
@@ -6,6 +6,7 @@
   "scripts": {
     "prebuild": "rimraf dist",
     "build": "nest build",
+    "generate:typings": "ts-node generate-typings.ts",
     "format": "prettier --write \"src/**/*.ts\" \"test/**/*.ts\"",
     "start": "nest start",
     "start:dev": "nest start --watch",
@@ -19,37 +20,42 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/graphql": "9.1.2",
-    "@nestjs/platform-express": "8.2.3",
-    "apollo-server-express": "3.6.1",
-    "graphql": "15.7.2",
-    "graphql-tools": "7.0.5",
-    "prisma-binding": "2.3.16",
-    "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "@apollo/server": "4.9.3",
+    "@nestjs/apollo": "12.0.11",
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/graphql": "12.2.0",
+    "@nestjs/platform-express": "10.4.10",
+    "@prisma/client": "4.16.2",
+    "class-transformer": "0.5.1",
+    "class-validator": "0.14.1",
+    "graphql": "16.8.1",
+    "graphql-subscriptions": "2.0.0",
+    "reflect-metadata": "0.2.1",
+    "rimraf": "5.0.10",
+    "rxjs": "7.8.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/node": "16.11.19",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@nestjs/testing": "10.4.10",
+    "@types/express": "4.17.21",
+    "@types/node": "20.17.8",
+    "@types/supertest": "6.0.2",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.42.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-import": "2.29.1",
+    "jest": "29.7.0",
+    "prettier": "3.2.5",
+    "prisma": "^4.15.0",
+    "supertest": "6.3.4",
+    "ts-jest": "29.1.2",
+    "ts-loader": "9.5.1",
+    "ts-morph": "21.0.1",
+    "ts-node": "10.9.2",
+    "tsconfig-paths": "4.2.0",
+    "typescript": "5.3.3"
   }
 }
diff --git a/sample/22-graphql-prisma/prisma/schema.prisma b/sample/22-graphql-prisma/prisma/schema.prisma
new file mode 100755
index 000000000..c085f0aee
--- /dev/null
+++ b/sample/22-graphql-prisma/prisma/schema.prisma
@@ -0,0 +1,18 @@
+// This is your Prisma schema file,
+// learn more about it in the docs: https://pris.ly/d/prisma-schema
+
+datasource db {
+  provider = "sqlite"
+  url      = "file:./dev.db"
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+model Post {
+  id          String  @id @default(uuid())
+  title       String
+  text        String
+  isPublished Boolean @default(false)
+}
diff --git a/sample/22-graphql-prisma/src/app.module.ts b/sample/22-graphql-prisma/src/app.module.ts
old mode 100644
new mode 100755
index 616ec9848..b8ea4ccb2
--- a/sample/22-graphql-prisma/src/app.module.ts
+++ b/sample/22-graphql-prisma/src/app.module.ts
@@ -1,16 +1,16 @@
 import { Module } from '@nestjs/common';
 import { GraphQLModule } from '@nestjs/graphql';
-import { GraphqlOptions } from './graphql.options';
 import { PostsModule } from './posts/posts.module';
-import { PrismaModule } from './prisma/prisma.module';
+import { ApolloDriver, ApolloDriverConfig } from '@nestjs/apollo';
 
 @Module({
   imports: [
-    GraphQLModule.forRootAsync({
-      useClass: GraphqlOptions,
-    }),
-    PrismaModule,
     PostsModule,
+    GraphQLModule.forRoot<ApolloDriverConfig>({
+      driver: ApolloDriver,
+      typePaths: ['./**/*.graphql'],
+      installSubscriptionHandlers: true,
+    }),
   ],
 })
 export class AppModule {}
diff --git a/sample/22-graphql-prisma/src/graphql.options.ts b/sample/22-graphql-prisma/src/graphql.options.ts
deleted file mode 100644
index 5de5f64ae..000000000
--- a/sample/22-graphql-prisma/src/graphql.options.ts
+++ /dev/null
@@ -1,21 +0,0 @@
-import { Injectable } from '@nestjs/common';
-import { GqlModuleOptions, GqlOptionsFactory } from '@nestjs/graphql';
-import { join } from 'path';
-
-@Injectable()
-export class GraphqlOptions implements GqlOptionsFactory {
-  createGqlOptions(): Promise<GqlModuleOptions> | GqlModuleOptions {
-    return {
-      typePaths: ['./src/**/*.graphql'],
-      path: '/',
-      installSubscriptionHandlers: true,
-      resolverValidationOptions: {
-        requireResolversForResolveType: 'ignore',
-      },
-      definitions: {
-        path: join(process.cwd(), 'src/graphql.schema.d.ts'),
-        outputAs: 'class',
-      },
-    };
-  }
-}
diff --git a/sample/22-graphql-prisma/src/graphql.schema.d.ts b/sample/22-graphql-prisma/src/graphql.schema.d.ts
deleted file mode 100644
index d818b240e..000000000
--- a/sample/22-graphql-prisma/src/graphql.schema.d.ts
+++ /dev/null
@@ -1,209 +0,0 @@
-/** ------------------------------------------------------
- * THIS FILE WAS AUTOMATICALLY GENERATED (DO NOT MODIFY)
- * -------------------------------------------------------
- */
-
-/* tslint:disable */
-export enum MutationType {
-  CREATED = 'CREATED',
-  UPDATED = 'UPDATED',
-  DELETED = 'DELETED',
-}
-
-export enum PostOrderByInput {
-  id_ASC = 'id_ASC',
-  id_DESC = 'id_DESC',
-  isPublished_ASC = 'isPublished_ASC',
-  isPublished_DESC = 'isPublished_DESC',
-  title_ASC = 'title_ASC',
-  title_DESC = 'title_DESC',
-  text_ASC = 'text_ASC',
-  text_DESC = 'text_DESC',
-}
-
-export class PostCreateInput {
-  id?: string;
-  isPublished?: boolean;
-  title: string;
-  text: string;
-}
-
-export class PostSubscriptionWhereInput {
-  AND?: PostSubscriptionWhereInput[];
-  OR?: PostSubscriptionWhereInput[];
-  NOT?: PostSubscriptionWhereInput[];
-  mutation_in?: MutationType[];
-  updatedFields_contains?: string;
-  updatedFields_contains_every?: string[];
-  updatedFields_contains_some?: string[];
-  node?: PostWhereInput;
-}
-
-export class PostUpdateInput {
-  isPublished?: boolean;
-  title?: string;
-  text?: string;
-}
-
-export class PostUpdateManyMutationInput {
-  isPublished?: boolean;
-  title?: string;
-  text?: string;
-}
-
-export class PostWhereInput {
-  AND?: PostWhereInput[];
-  OR?: PostWhereInput[];
-  NOT?: PostWhereInput[];
-  id?: string;
-  id_not?: string;
-  id_in?: string[];
-  id_not_in?: string[];
-  id_lt?: string;
-  id_lte?: string;
-  id_gt?: string;
-  id_gte?: string;
-  id_contains?: string;
-  id_not_contains?: string;
-  id_starts_with?: string;
-  id_not_starts_with?: string;
-  id_ends_with?: string;
-  id_not_ends_with?: string;
-  isPublished?: boolean;
-  isPublished_not?: boolean;
-  title?: string;
-  title_not?: string;
-  title_in?: string[];
-  title_not_in?: string[];
-  title_lt?: string;
-  title_lte?: string;
-  title_gt?: string;
-  title_gte?: string;
-  title_contains?: string;
-  title_not_contains?: string;
-  title_starts_with?: string;
-  title_not_starts_with?: string;
-  title_ends_with?: string;
-  title_not_ends_with?: string;
-  text?: string;
-  text_not?: string;
-  text_in?: string[];
-  text_not_in?: string[];
-  text_lt?: string;
-  text_lte?: string;
-  text_gt?: string;
-  text_gte?: string;
-  text_contains?: string;
-  text_not_contains?: string;
-  text_starts_with?: string;
-  text_not_starts_with?: string;
-  text_ends_with?: string;
-  text_not_ends_with?: string;
-}
-
-export class PostWhereUniqueInput {
-  id?: string;
-}
-
-export interface Node {
-  id: string;
-}
-
-export class AggregatePost {
-  count: number;
-}
-
-export class BatchPayload {
-  count: Long;
-}
-
-export abstract class IMutation {
-  abstract createPost(data: PostCreateInput): Post | Promise<Post>;
-  abstract updatePost(
-    data: PostUpdateInput,
-    where: PostWhereUniqueInput,
-  ): Post | Promise<Post>;
-  abstract deletePost(where: PostWhereUniqueInput): Post | Promise<Post>;
-  abstract upsertPost(
-    where: PostWhereUniqueInput,
-    create: PostCreateInput,
-    update: PostUpdateInput,
-  ): Post | Promise<Post>;
-  abstract updateManyPosts(
-    data: PostUpdateManyMutationInput,
-    where?: PostWhereInput,
-  ): BatchPayload | Promise<BatchPayload>;
-  abstract deleteManyPosts(
-    where?: PostWhereInput,
-  ): BatchPayload | Promise<BatchPayload>;
-}
-
-export class PageInfo {
-  hasNextPage: boolean;
-  hasPreviousPage: boolean;
-  startCursor?: string;
-  endCursor?: string;
-}
-
-export class Post implements Node {
-  id: string;
-  isPublished: boolean;
-  title: string;
-  text: string;
-}
-
-export class PostConnection {
-  pageInfo: PageInfo;
-  edges: PostEdge[];
-  aggregate: AggregatePost;
-}
-
-export class PostEdge {
-  node: Post;
-  cursor: string;
-}
-
-export class PostPreviousValues {
-  id: string;
-  isPublished: boolean;
-  title: string;
-  text: string;
-}
-
-export class PostSubscriptionPayload {
-  mutation: MutationType;
-  node?: Post;
-  updatedFields?: string[];
-  previousValues?: PostPreviousValues;
-}
-
-export abstract class IQuery {
-  abstract posts(
-    where?: PostWhereInput,
-    orderBy?: PostOrderByInput,
-    skip?: number,
-    after?: string,
-    before?: string,
-    first?: number,
-    last?: number,
-  ): Post[] | Promise<Post[]>;
-  abstract post(where: PostWhereUniqueInput): Post | Promise<Post>;
-  abstract postsConnection(
-    where?: PostWhereInput,
-    orderBy?: PostOrderByInput,
-    skip?: number,
-    after?: string,
-    before?: string,
-    first?: number,
-    last?: number,
-  ): PostConnection | Promise<PostConnection>;
-  abstract node(id: string): Node | Promise<Node>;
-}
-
-export abstract class ISubscription {
-  abstract post(
-    where?: PostSubscriptionWhereInput,
-  ): PostSubscriptionPayload | Promise<PostSubscriptionPayload>;
-}
-
-export type Long = any;
diff --git a/sample/22-graphql-prisma/src/graphql.schema.ts b/sample/22-graphql-prisma/src/graphql.schema.ts
new file mode 100755
index 000000000..38a134f7f
--- /dev/null
+++ b/sample/22-graphql-prisma/src/graphql.schema.ts
@@ -0,0 +1,48 @@
+/*
+ * -------------------------------------------------------
+ * THIS FILE WAS AUTOMATICALLY GENERATED (DO NOT MODIFY)
+ * -------------------------------------------------------
+ */
+
+/* tslint:disable */
+/* eslint-disable */
+export class NewPost {
+  title: string;
+  text: string;
+}
+
+export class UpdatePost {
+  id: string;
+  title?: Nullable<string>;
+  text?: Nullable<string>;
+  isPublished?: Nullable<boolean>;
+}
+
+export class Post {
+  id: string;
+  title: string;
+  text: string;
+  isPublished: boolean;
+}
+
+export abstract class IQuery {
+  abstract posts(): Post[] | Promise<Post[]>;
+
+  abstract post(id: string): Nullable<Post> | Promise<Nullable<Post>>;
+}
+
+export abstract class IMutation {
+  abstract createPost(input: NewPost): Post | Promise<Post>;
+
+  abstract updatePost(
+    input: UpdatePost,
+  ): Nullable<Post> | Promise<Nullable<Post>>;
+
+  abstract deletePost(id: string): Nullable<Post> | Promise<Nullable<Post>>;
+}
+
+export abstract class ISubscription {
+  abstract postCreated(): Nullable<Post> | Promise<Nullable<Post>>;
+}
+
+type Nullable<T> = T | null;
diff --git a/sample/22-graphql-prisma/src/main.ts b/sample/22-graphql-prisma/src/main.ts
old mode 100644
new mode 100755
index e1e10d969..c442b692c
--- a/sample/22-graphql-prisma/src/main.ts
+++ b/sample/22-graphql-prisma/src/main.ts
@@ -1,9 +1,13 @@
+import { ValidationPipe } from '@nestjs/common';
 import { NestFactory } from '@nestjs/core';
 import { AppModule } from './app.module';
 
 async function bootstrap() {
   const app = await NestFactory.create(AppModule);
+  app.useGlobalPipes(new ValidationPipe());
+
   await app.listen(3000);
   console.log(`Application is running on: ${await app.getUrl()}`);
+  console.log(`GraphQL Playground: ${await app.getUrl()}/graphql`);
 }
 bootstrap();
diff --git a/sample/22-graphql-prisma/src/posts/posts.module.ts b/sample/22-graphql-prisma/src/posts/posts.module.ts
old mode 100644
new mode 100755
index a1f53f854..a70df6058
--- a/sample/22-graphql-prisma/src/posts/posts.module.ts
+++ b/sample/22-graphql-prisma/src/posts/posts.module.ts
@@ -1,9 +1,10 @@
 import { Module } from '@nestjs/common';
-import { PrismaModule } from './../prisma/prisma.module';
-import { PostsResolver } from './posts.resolver';
+import { PostsResolvers } from './posts.resolvers';
+import { PostsService } from './posts.service';
+import { PrismaModule } from '../prisma/prisma.module';
 
 @Module({
-  providers: [PostsResolver],
+  providers: [PostsResolvers, PostsService],
   imports: [PrismaModule],
 })
 export class PostsModule {}
diff --git a/sample/22-graphql-prisma/src/posts/posts.resolver.ts b/sample/22-graphql-prisma/src/posts/posts.resolver.ts
deleted file mode 100644
index 303b65dae..000000000
--- a/sample/22-graphql-prisma/src/posts/posts.resolver.ts
+++ /dev/null
@@ -1,56 +0,0 @@
-import {
-  Args,
-  Info,
-  Mutation,
-  Query,
-  Resolver,
-  Subscription,
-} from '@nestjs/graphql';
-import { Post } from '../graphql.schema';
-import { BatchPayload } from '../prisma/prisma.binding';
-import { PrismaService } from '../prisma/prisma.service';
-
-@Resolver()
-export class PostsResolver {
-  constructor(private readonly prisma: PrismaService) {}
-
-  @Query('posts')
-  async getPosts(@Args() args, @Info() info): Promise<Post[]> {
-    return this.prisma.query.posts(args, info);
-  }
-
-  @Query('post')
-  async getPost(@Args() args, @Info() info): Promise<Post> {
-    return this.prisma.query.post(args, info);
-  }
-
-  @Mutation('createPost')
-  async createPost(@Args() args, @Info() info): Promise<Post> {
-    return this.prisma.mutation.createPost(args, info);
-  }
-
-  @Mutation('updatePost')
-  async updatePost(@Args() args, @Info() info): Promise<Post> {
-    return this.prisma.mutation.updatePost(args, info);
-  }
-
-  @Mutation('updateManyPosts')
-  async updateManyPosts(@Args() args, @Info() info): Promise<BatchPayload> {
-    return this.prisma.mutation.updateManyPosts(args, info);
-  }
-
-  @Mutation('deletePost')
-  async deletePost(@Args() args, @Info() info): Promise<Post> {
-    return this.prisma.mutation.deletePost(args, info);
-  }
-
-  @Mutation('deleteManyPosts')
-  async deleteManyPosts(@Args() args, @Info() info): Promise<BatchPayload> {
-    return this.prisma.mutation.deleteManyPosts(args, info);
-  }
-
-  @Subscription('post')
-  onPostMutation(@Args() args, @Info() info) {
-    return this.prisma.subscription.post(args, info);
-  }
-}
diff --git a/sample/22-graphql-prisma/src/posts/posts.resolvers.ts b/sample/22-graphql-prisma/src/posts/posts.resolvers.ts
new file mode 100755
index 000000000..5ecb8c28f
--- /dev/null
+++ b/sample/22-graphql-prisma/src/posts/posts.resolvers.ts
@@ -0,0 +1,43 @@
+import { Resolver, Query, Mutation, Args, Subscription } from '@nestjs/graphql';
+import { PostsService } from './posts.service';
+import { Post, NewPost, UpdatePost } from 'src/graphql.schema';
+import { PubSub } from 'graphql-subscriptions';
+
+const pubSub = new PubSub();
+
+@Resolver('Post')
+export class PostsResolvers {
+  constructor(private readonly postService: PostsService) {}
+
+  @Query('posts')
+  async posts(): Promise<Post[]> {
+    return this.postService.findAll();
+  }
+
+  @Query('post')
+  async post(@Args('id') args: string): Promise<Post> {
+    return this.postService.findOne(args);
+  }
+
+  @Mutation('createPost')
+  async create(@Args('input') args: NewPost): Promise<Post> {
+    const createdPost = await this.postService.create(args);
+    pubSub.publish('postCreated', { postCreated: createdPost });
+    return createdPost;
+  }
+
+  @Mutation('updatePost')
+  async update(@Args('input') args: UpdatePost): Promise<Post> {
+    return this.postService.update(args);
+  }
+
+  @Mutation('deletePost')
+  async delete(@Args('id') args: string): Promise<Post> {
+    return this.postService.delete(args);
+  }
+
+  @Subscription('postCreated')
+  postCreated() {
+    return pubSub.asyncIterator('postCreated');
+  }
+}
diff --git a/sample/22-graphql-prisma/src/posts/posts.service.ts b/sample/22-graphql-prisma/src/posts/posts.service.ts
new file mode 100755
index 000000000..633065a28
--- /dev/null
+++ b/sample/22-graphql-prisma/src/posts/posts.service.ts
@@ -0,0 +1,48 @@
+import { Injectable } from '@nestjs/common';
+import { Post } from '@prisma/client';
+import { NewPost, UpdatePost } from 'src/graphql.schema';
+import { PrismaService } from '../prisma/prisma.service';
+
+@Injectable()
+export class PostsService {
+  constructor(private prisma: PrismaService) {}
+
+  async findOne(id: string): Promise<Post | null> {
+    return this.prisma.post.findUnique({
+      where: {
+        id,
+      },
+    });
+  }
+
+  async findAll(): Promise<Post[]> {
+    return this.prisma.post.findMany({});
+  }
+
+  async create(input: NewPost): Promise<Post> {
+    return this.prisma.post.create({
+      data: input,
+    });
+  }
+
+  async update(params: UpdatePost): Promise<Post> {
+    const { id, ...params_without_id } = params;
+
+    return this.prisma.post.update({
+      where: {
+        id,
+      },
+      data: {
+        ...params_without_id,
+      },
+    });
+  }
+
+  async delete(id: string): Promise<Post> {
+    return this.prisma.post.delete({
+      where: {
+        id,
+      },
+    });
+  }
+}
diff --git a/sample/22-graphql-prisma/src/posts/schema.graphql b/sample/22-graphql-prisma/src/posts/schema.graphql
new file mode 100755
index 000000000..ac00d18f0
--- /dev/null
+++ b/sample/22-graphql-prisma/src/posts/schema.graphql
@@ -0,0 +1,33 @@
+type Post {
+  id: ID!
+  title: String!
+  text: String!
+  isPublished: Boolean!
+}
+
+input NewPost {
+  title: String!
+  text: String!
+}
+
+input UpdatePost {
+  id: ID!
+  title: String
+  text: String
+  isPublished: Boolean
+}
+
+type Query {
+  posts: [Post!]!
+  post(id: ID!): Post
+}
+
+type Mutation {
+  createPost(input: NewPost!): Post!
+  updatePost(input: UpdatePost!): Post
+  deletePost(id: ID!): Post
+}
+
+type Subscription {
+  postCreated: Post
+}
diff --git a/sample/22-graphql-prisma/src/prisma/prisma-types.graphql b/sample/22-graphql-prisma/src/prisma/prisma-types.graphql
deleted file mode 100644
index 36380cf51..000000000
--- a/sample/22-graphql-prisma/src/prisma/prisma-types.graphql
+++ /dev/null
@@ -1,308 +0,0 @@
-# source: https://eu1.prisma.sh/adam-gajzlerowicz-1dadb3/demo/dev
-# timestamp: Sun Jan 26 2020 09:49:46 GMT+0100 (Central European Standard Time)
-
-type AggregatePost {
-  count: Int!
-}
-
-type BatchPayload {
-  """The number of nodes that have been affected by the Batch operation."""
-  count: Long!
-}
-
-"""
-The `Long` scalar type represents non-fractional signed whole numeric values.
-Long can represent values between -(2^63) and 2^63 - 1.
-"""
-scalar Long
-
-type Mutation {
-  createPost(data: PostCreateInput!): Post!
-  updatePost(data: PostUpdateInput!, where: PostWhereUniqueInput!): Post
-  deletePost(where: PostWhereUniqueInput!): Post
-  upsertPost(where: PostWhereUniqueInput!, create: PostCreateInput!, update: PostUpdateInput!): Post!
-  updateManyPosts(data: PostUpdateManyMutationInput!, where: PostWhereInput): BatchPayload!
-  deleteManyPosts(where: PostWhereInput): BatchPayload!
-}
-
-enum MutationType {
-  CREATED
-  UPDATED
-  DELETED
-}
-
-"""An object with an ID"""
-interface Node {
-  """The id of the object."""
-  id: ID!
-}
-
-"""Information about pagination in a connection."""
-type PageInfo {
-  """When paginating forwards, are there more items?"""
-  hasNextPage: Boolean!
-
-  """When paginating backwards, are there more items?"""
-  hasPreviousPage: Boolean!
-
-  """When paginating backwards, the cursor to continue."""
-  startCursor: String
-
-  """When paginating forwards, the cursor to continue."""
-  endCursor: String
-}
-
-type Post implements Node {
-  id: ID!
-  isPublished: Boolean!
-  title: String!
-  text: String!
-}
-
-"""A connection to a list of items."""
-type PostConnection {
-  """Information to aid in pagination."""
-  pageInfo: PageInfo!
-
-  """A list of edges."""
-  edges: [PostEdge]!
-  aggregate: AggregatePost!
-}
-
-input PostCreateInput {
-  id: ID
-  isPublished: Boolean
-  title: String!
-  text: String!
-}
-
-"""An edge in a connection."""
-type PostEdge {
-  """The item at the end of the edge."""
-  node: Post!
-
-  """A cursor for use in pagination."""
-  cursor: String!
-}
-
-enum PostOrderByInput {
-  id_ASC
-  id_DESC
-  isPublished_ASC
-  isPublished_DESC
-  title_ASC
-  title_DESC
-  text_ASC
-  text_DESC
-}
-
-type PostPreviousValues {
-  id: ID!
-  isPublished: Boolean!
-  title: String!
-  text: String!
-}
-
-type PostSubscriptionPayload {
-  mutation: MutationType!
-  node: Post
-  updatedFields: [String!]
-  previousValues: PostPreviousValues
-}
-
-input PostSubscriptionWhereInput {
-  """Logical AND on all given filters."""
-  AND: [PostSubscriptionWhereInput!]
-
-  """Logical OR on all given filters."""
-  OR: [PostSubscriptionWhereInput!]
-
-  """Logical NOT on all given filters combined by AND."""
-  NOT: [PostSubscriptionWhereInput!]
-
-  """The subscription event gets dispatched when it's listed in mutation_in"""
-  mutation_in: [MutationType!]
-
-  """
-  The subscription event gets only dispatched when one of the updated fields names is included in this list
-  """
-  updatedFields_contains: String
-
-  """
-  The subscription event gets only dispatched when all of the field names included in this list have been updated
-  """
-  updatedFields_contains_every: [String!]
-
-  """
-  The subscription event gets only dispatched when some of the field names included in this list have been updated
-  """
-  updatedFields_contains_some: [String!]
-  node: PostWhereInput
-}
-
-input PostUpdateInput {
-  isPublished: Boolean
-  title: String
-  text: String
-}
-
-input PostUpdateManyMutationInput {
-  isPublished: Boolean
-  title: String
-  text: String
-}
-
-input PostWhereInput {
-  """Logical AND on all given filters."""
-  AND: [PostWhereInput!]
-
-  """Logical OR on all given filters."""
-  OR: [PostWhereInput!]
-
-  """Logical NOT on all given filters combined by AND."""
-  NOT: [PostWhereInput!]
-  id: ID
-
-  """All values that are not equal to given value."""
-  id_not: ID
-
-  """All values that are contained in given list."""
-  id_in: [ID!]
-
-  """All values that are not contained in given list."""
-  id_not_in: [ID!]
-
-  """All values less than the given value."""
-  id_lt: ID
-
-  """All values less than or equal the given value."""
-  id_lte: ID
-
-  """All values greater than the given value."""
-  id_gt: ID
-
-  """All values greater than or equal the given value."""
-  id_gte: ID
-
-  """All values containing the given string."""
-  id_contains: ID
-
-  """All values not containing the given string."""
-  id_not_contains: ID
-
-  """All values starting with the given string."""
-  id_starts_with: ID
-
-  """All values not starting with the given string."""
-  id_not_starts_with: ID
-
-  """All values ending with the given string."""
-  id_ends_with: ID
-
-  """All values not ending with the given string."""
-  id_not_ends_with: ID
-  isPublished: Boolean
-
-  """All values that are not equal to given value."""
-  isPublished_not: Boolean
-  title: String
-
-  """All values that are not equal to given value."""
-  title_not: String
-
-  """All values that are contained in given list."""
-  title_in: [String!]
-
-  """All values that are not contained in given list."""
-  title_not_in: [String!]
-
-  """All values less than the given value."""
-  title_lt: String
-
-  """All values less than or equal the given value."""
-  title_lte: String
-
-  """All values greater than the given value."""
-  title_gt: String
-
-  """All values greater than or equal the given value."""
-  title_gte: String
-
-  """All values containing the given string."""
-  title_contains: String
-
-  """All values not containing the given string."""
-  title_not_contains: String
-
-  """All values starting with the given string."""
-  title_starts_with: String
-
-  """All values not starting with the given string."""
-  title_not_starts_with: String
-
-  """All values ending with the given string."""
-  title_ends_with: String
-
-  """All values not ending with the given string."""
-  title_not_ends_with: String
-  text: String
-
-  """All values that are not equal to given value."""
-  text_not: String
-
-  """All values that are contained in given list."""
-  text_in: [String!]
-
-  """All values that are not contained in given list."""
-  text_not_in: [String!]
-
-  """All values less than the given value."""
-  text_lt: String
-
-  """All values less than or equal the given value."""
-  text_lte: String
-
-  """All values greater than the given value."""
-  text_gt: String
-
-  """All values greater than or equal the given value."""
-  text_gte: String
-
-  """All values containing the given string."""
-  text_contains: String
-
-  """All values not containing the given string."""
-  text_not_contains: String
-
-  """All values starting with the given string."""
-  text_starts_with: String
-
-  """All values not starting with the given string."""
-  text_not_starts_with: String
-
-  """All values ending with the given string."""
-  text_ends_with: String
-
-  """All values not ending with the given string."""
-  text_not_ends_with: String
-}
-
-input PostWhereUniqueInput {
-  id: ID
-}
-
-type Query {
-  posts(where: PostWhereInput, orderBy: PostOrderByInput, skip: Int, after: String, before: String, first: Int, last: Int): [Post]!
-  post(where: PostWhereUniqueInput!): Post
-  postsConnection(where: PostWhereInput, orderBy: PostOrderByInput, skip: Int, after: String, before: String, first: Int, last: Int): PostConnection!
-
-  """Fetches an object given its ID"""
-  node(
-    """The ID of an object"""
-    id: ID!
-  ): Node
-}
-
-type Subscription {
-  post(where: PostSubscriptionWhereInput): PostSubscriptionPayload
-}
diff --git a/sample/22-graphql-prisma/src/prisma/prisma.binding.ts b/sample/22-graphql-prisma/src/prisma/prisma.binding.ts
deleted file mode 100644
index a9dbf053a..000000000
--- a/sample/22-graphql-prisma/src/prisma/prisma.binding.ts
+++ /dev/null
@@ -1,629 +0,0 @@
-import { GraphQLResolveInfo, GraphQLSchema } from 'graphql';
-import { Options } from 'graphql-binding';
-import { IResolvers } from 'graphql-tools';
-import { BasePrismaOptions, makePrismaBindingClass } from 'prisma-binding';
-
-export interface Query {
-  posts: <T = Post[]>(
-    args: {
-      where?: PostWhereInput;
-      orderBy?: PostOrderByInput;
-      skip?: Int;
-      after?: String;
-      before?: String;
-      first?: Int;
-      last?: Int;
-    },
-    info?: GraphQLResolveInfo | string,
-    options?: Options,
-  ) => Promise<T>;
-  post: <T = Post | null>(
-    args: { where: PostWhereUniqueInput },
-    info?: GraphQLResolveInfo | string,
-    options?: Options,
-  ) => Promise<T>;
-  postsConnection: <T = PostConnection>(
-    args: {
-      where?: PostWhereInput;
-      orderBy?: PostOrderByInput;
-      skip?: Int;
-      after?: String;
-      before?: String;
-      first?: Int;
-      last?: Int;
-    },
-    info?: GraphQLResolveInfo | string,
-    options?: Options,
-  ) => Promise<T>;
-  node: <T = Node | null>(
-    args: { id: ID_Output },
-    info?: GraphQLResolveInfo | string,
-    options?: Options,
-  ) => Promise<T>;
-}
-
-export interface Mutation {
-  createPost: <T = Post>(
-    args: { data: PostCreateInput },
-    info?: GraphQLResolveInfo | string,
-    options?: Options,
-  ) => Promise<T>;
-  updatePost: <T = Post | null>(
-    args: { data: PostUpdateInput; where: PostWhereUniqueInput },
-    info?: GraphQLResolveInfo | string,
-    options?: Options,
-  ) => Promise<T>;
-  deletePost: <T = Post | null>(
-    args: { where: PostWhereUniqueInput },
-    info?: GraphQLResolveInfo | string,
-    options?: Options,
-  ) => Promise<T>;
-  upsertPost: <T = Post>(
-    args: {
-      where: PostWhereUniqueInput;
-      create: PostCreateInput;
-      update: PostUpdateInput;
-    },
-    info?: GraphQLResolveInfo | string,
-    options?: Options,
-  ) => Promise<T>;
-  updateManyPosts: <T = BatchPayload>(
-    args: { data: PostUpdateInput; where?: PostWhereInput },
-    info?: GraphQLResolveInfo | string,
-    options?: Options,
-  ) => Promise<T>;
-  deleteManyPosts: <T = BatchPayload>(
-    args: { where?: PostWhereInput },
-    info?: GraphQLResolveInfo | string,
-    options?: Options,
-  ) => Promise<T>;
-}
-
-export interface Subscription {
-  post: <T = PostSubscriptionPayload | null>(
-    args: { where?: PostSubscriptionWhereInput },
-    info?: GraphQLResolveInfo | string,
-    options?: Options,
-  ) => Promise<AsyncIterator<T>>;
-}
-
-export interface Exists {
-  Post: (where?: PostWhereInput) => Promise<boolean>;
-}
-
-export interface Prisma {
-  query: Query;
-  mutation: Mutation;
-  subscription: Subscription;
-  exists: Exists;
-  request: <T = any>(
-    query: string,
-    variables?: { [key: string]: any },
-  ) => Promise<T>;
-  delegate(
-    operation: 'query' | 'mutation',
-    fieldName: string,
-    args: {
-      [key: string]: any;
-    },
-    infoOrQuery?: GraphQLResolveInfo | string,
-    options?: Options,
-  ): Promise<any>;
-  delegateSubscription(
-    fieldName: string,
-    args?: {
-      [key: string]: any;
-    },
-    infoOrQuery?: GraphQLResolveInfo | string,
-    options?: Options,
-  ): Promise<AsyncIterator<any>>;
-  getAbstractResolvers(filterSchema?: GraphQLSchema | string): IResolvers;
-}
-
-export interface BindingConstructor<T> {
-  new (options: BasePrismaOptions): T;
-}
-/**
- * Type Defs
- */
-
-const typeDefs = `type AggregatePost {
-  count: Int!
-}
-
-type BatchPayload {
-  """The number of nodes that have been affected by the Batch operation."""
-  count: Long!
-}
-
-"""
-The \`Long\` scalar type represents non-fractional signed whole numeric values.
-Long can represent values between -(2^63) and 2^63 - 1.
-"""
-scalar Long
-
-type Mutation {
-  createPost(data: PostCreateInput!): Post!
-  updatePost(data: PostUpdateInput!, where: PostWhereUniqueInput!): Post
-  deletePost(where: PostWhereUniqueInput!): Post
-  upsertPost(where: PostWhereUniqueInput!, create: PostCreateInput!, update: PostUpdateInput!): Post!
-  updateManyPosts(data: PostUpdateInput!, where: PostWhereInput): BatchPayload!
-  deleteManyPosts(where: PostWhereInput): BatchPayload!
-}
-
-enum MutationType {
-  CREATED
-  UPDATED
-  DELETED
-}
-
-"""An object with an ID"""
-interface Node {
-  """The id of the object."""
-  id: ID!
-}
-
-"""Information about pagination in a connection."""
-type PageInfo {
-  """When paginating forwards, are there more items?"""
-  hasNextPage: Boolean!
-
-  """When paginating backwards, are there more items?"""
-  hasPreviousPage: Boolean!
-
-  """When paginating backwards, the cursor to continue."""
-  startCursor: String
-
-  """When paginating forwards, the cursor to continue."""
-  endCursor: String
-}
-
-type Post implements Node {
-  id: ID!
-  isPublished: Boolean!
-  title: String!
-  text: String!
-}
-
-"""A connection to a list of items."""
-type PostConnection {
-  """Information to aid in pagination."""
-  pageInfo: PageInfo!
-
-  """A list of edges."""
-  edges: [PostEdge]!
-  aggregate: AggregatePost!
-}
-
-input PostCreateInput {
-  isPublished: Boolean
-  title: String!
-  text: String!
-}
-
-"""An edge in a connection."""
-type PostEdge {
-  """The item at the end of the edge."""
-  node: Post!
-
-  """A cursor for use in pagination."""
-  cursor: String!
-}
-
-enum PostOrderByInput {
-  id_ASC
-  id_DESC
-  isPublished_ASC
-  isPublished_DESC
-  title_ASC
-  title_DESC
-  text_ASC
-  text_DESC
-  updatedAt_ASC
-  updatedAt_DESC
-  createdAt_ASC
-  createdAt_DESC
-}
-
-type PostPreviousValues {
-  id: ID!
-  isPublished: Boolean!
-  title: String!
-  text: String!
-}
-
-type PostSubscriptionPayload {
-  mutation: MutationType!
-  node: Post
-  updatedFields: [String!]
-  previousValues: PostPreviousValues
-}
-
-input PostSubscriptionWhereInput {
-  """Logical AND on all given filters."""
-  AND: [PostSubscriptionWhereInput!]
-
-  """Logical OR on all given filters."""
-  OR: [PostSubscriptionWhereInput!]
-
-  """Logical NOT on all given filters combined by AND."""
-  NOT: [PostSubscriptionWhereInput!]
-
-  """
-  The subscription event gets dispatched when it's listed in mutation_in
-  """
-  mutation_in: [MutationType!]
-
-  """
-  The subscription event gets only dispatched when one of the updated fields names is included in this list
-  """
-  updatedFields_contains: String
-
-  """
-  The subscription event gets only dispatched when all of the field names included in this list have been updated
-  """
-  updatedFields_contains_every: [String!]
-
-  """
-  The subscription event gets only dispatched when some of the field names included in this list have been updated
-  """
-  updatedFields_contains_some: [String!]
-  node: PostWhereInput
-}
-
-input PostUpdateInput {
-  isPublished: Boolean
-  title: String
-  text: String
-}
-
-input PostWhereInput {
-  """Logical AND on all given filters."""
-  AND: [PostWhereInput!]
-
-  """Logical OR on all given filters."""
-  OR: [PostWhereInput!]
-
-  """Logical NOT on all given filters combined by AND."""
-  NOT: [PostWhereInput!]
-  id: ID
-
-  """All values that are not equal to given value."""
-  id_not: ID
-
-  """All values that are contained in given list."""
-  id_in: [ID!]
-
-  """All values that are not contained in given list."""
-  id_not_in: [ID!]
-
-  """All values less than the given value."""
-  id_lt: ID
-
-  """All values less than or equal the given value."""
-  id_lte: ID
-
-  """All values greater than the given value."""
-  id_gt: ID
-
-  """All values greater than or equal the given value."""
-  id_gte: ID
-
-  """All values containing the given string."""
-  id_contains: ID
-
-  """All values not containing the given string."""
-  id_not_contains: ID
-
-  """All values starting with the given string."""
-  id_starts_with: ID
-
-  """All values not starting with the given string."""
-  id_not_starts_with: ID
-
-  """All values ending with the given string."""
-  id_ends_with: ID
-
-  """All values not ending with the given string."""
-  id_not_ends_with: ID
-  isPublished: Boolean
-
-  """All values that are not equal to given value."""
-  isPublished_not: Boolean
-  title: String
-
-  """All values that are not equal to given value."""
-  title_not: String
-
-  """All values that are contained in given list."""
-  title_in: [String!]
-
-  """All values that are not contained in given list."""
-  title_not_in: [String!]
-
-  """All values less than the given value."""
-  title_lt: String
-
-  """All values less than or equal the given value."""
-  title_lte: String
-
-  """All values greater than the given value."""
-  title_gt: String
-
-  """All values greater than or equal the given value."""
-  title_gte: String
-
-  """All values containing the given string."""
-  title_contains: String
-
-  """All values not containing the given string."""
-  title_not_contains: String
-
-  """All values starting with the given string."""
-  title_starts_with: String
-
-  """All values not starting with the given string."""
-  title_not_starts_with: String
-
-  """All values ending with the given string."""
-  title_ends_with: String
-
-  """All values not ending with the given string."""
-  title_not_ends_with: String
-  text: String
-
-  """All values that are not equal to given value."""
-  text_not: String
-
-  """All values that are contained in given list."""
-  text_in: [String!]
-
-  """All values that are not contained in given list."""
-  text_not_in: [String!]
-
-  """All values less than the given value."""
-  text_lt: String
-
-  """All values less than or equal the given value."""
-  text_lte: String
-
-  """All values greater than the given value."""
-  text_gt: String
-
-  """All values greater than or equal the given value."""
-  text_gte: String
-
-  """All values containing the given string."""
-  text_contains: String
-
-  """All values not containing the given string."""
-  text_not_contains: String
-
-  """All values starting with the given string."""
-  text_starts_with: String
-
-  """All values not starting with the given string."""
-  text_not_starts_with: String
-
-  """All values ending with the given string."""
-  text_ends_with: String
-
-  """All values not ending with the given string."""
-  text_not_ends_with: String
-}
-
-input PostWhereUniqueInput {
-  id: ID
-}
-
-type Query {
-  posts(where: PostWhereInput, orderBy: PostOrderByInput, skip: Int, after: String, before: String, first: Int, last: Int): [Post]!
-  post(where: PostWhereUniqueInput!): Post
-  postsConnection(where: PostWhereInput, orderBy: PostOrderByInput, skip: Int, after: String, before: String, first: Int, last: Int): PostConnection!
-
-  """Fetches an object given its ID"""
-  node(
-    """The ID of an object"""
-    id: ID!
-  ): Node
-}
-
-type Subscription {
-  post(where: PostSubscriptionWhereInput): PostSubscriptionPayload
-}
-`;
-
-export const Prisma = makePrismaBindingClass<BindingConstructor<Prisma>>({
-  typeDefs,
-});
-
-/**
- * Types
- */
-
-export type PostOrderByInput =
-  | 'id_ASC'
-  | 'id_DESC'
-  | 'isPublished_ASC'
-  | 'isPublished_DESC'
-  | 'title_ASC'
-  | 'title_DESC'
-  | 'text_ASC'
-  | 'text_DESC'
-  | 'updatedAt_ASC'
-  | 'updatedAt_DESC'
-  | 'createdAt_ASC'
-  | 'createdAt_DESC';
-
-export type MutationType = 'CREATED' | 'UPDATED' | 'DELETED';
-
-export interface PostWhereUniqueInput {
-  id?: ID_Input;
-}
-
-export interface PostCreateInput {
-  isPublished?: Boolean;
-  title: String;
-  text: String;
-}
-
-export interface PostUpdateInput {
-  isPublished?: Boolean;
-  title?: String;
-  text?: String;
-}
-
-export interface PostSubscriptionWhereInput {
-  AND?: PostSubscriptionWhereInput[] | PostSubscriptionWhereInput;
-  OR?: PostSubscriptionWhereInput[] | PostSubscriptionWhereInput;
-  NOT?: PostSubscriptionWhereInput[] | PostSubscriptionWhereInput;
-  mutation_in?: MutationType[] | MutationType;
-  updatedFields_contains?: String;
-  updatedFields_contains_every?: String[] | String;
-  updatedFields_contains_some?: String[] | String;
-  node?: PostWhereInput;
-}
-
-export interface PostWhereInput {
-  AND?: PostWhereInput[] | PostWhereInput;
-  OR?: PostWhereInput[] | PostWhereInput;
-  NOT?: PostWhereInput[] | PostWhereInput;
-  id?: ID_Input;
-  id_not?: ID_Input;
-  id_in?: ID_Input[] | ID_Input;
-  id_not_in?: ID_Input[] | ID_Input;
-  id_lt?: ID_Input;
-  id_lte?: ID_Input;
-  id_gt?: ID_Input;
-  id_gte?: ID_Input;
-  id_contains?: ID_Input;
-  id_not_contains?: ID_Input;
-  id_starts_with?: ID_Input;
-  id_not_starts_with?: ID_Input;
-  id_ends_with?: ID_Input;
-  id_not_ends_with?: ID_Input;
-  isPublished?: Boolean;
-  isPublished_not?: Boolean;
-  title?: String;
-  title_not?: String;
-  title_in?: String[] | String;
-  title_not_in?: String[] | String;
-  title_lt?: String;
-  title_lte?: String;
-  title_gt?: String;
-  title_gte?: String;
-  title_contains?: String;
-  title_not_contains?: String;
-  title_starts_with?: String;
-  title_not_starts_with?: String;
-  title_ends_with?: String;
-  title_not_ends_with?: String;
-  text?: String;
-  text_not?: String;
-  text_in?: String[] | String;
-  text_not_in?: String[] | String;
-  text_lt?: String;
-  text_lte?: String;
-  text_gt?: String;
-  text_gte?: String;
-  text_contains?: String;
-  text_not_contains?: String;
-  text_starts_with?: String;
-  text_not_starts_with?: String;
-  text_ends_with?: String;
-  text_not_ends_with?: String;
-}
-
-/*
- * An object with an ID
-
- */
-export interface Node {
-  id: ID_Output;
-}
-
-/*
- * Information about pagination in a connection.
-
- */
-export interface PageInfo {
-  hasNextPage: Boolean;
-  hasPreviousPage: Boolean;
-  startCursor?: String;
-  endCursor?: String;
-}
-
-export interface BatchPayload {
-  count: Long;
-}
-
-export interface PostPreviousValues {
-  id: ID_Output;
-  isPublished: Boolean;
-  title: String;
-  text: String;
-}
-
-/*
- * A connection to a list of items.
-
- */
-export interface PostConnection {
-  pageInfo: PageInfo;
-  edges: PostEdge[];
-  aggregate: AggregatePost;
-}
-
-export interface PostSubscriptionPayload {
-  mutation: MutationType;
-  node?: Post;
-  updatedFields?: String[];
-  previousValues?: PostPreviousValues;
-}
-
-export interface Post extends Node {
-  id: ID_Output;
-  isPublished: Boolean;
-  title: String;
-  text: String;
-}
-
-export interface AggregatePost {
-  count: Int;
-}
-
-/*
- * An edge in a connection.
-
- */
-export interface PostEdge {
-  node: Post;
-  cursor: String;
-}
-
-/*
-The `Boolean` scalar type represents `true` or `false`.
-*/
-export type Boolean = boolean;
-
-/*
-The `String` scalar type represents textual data, represented as UTF-8 character sequences. The String type is most often used by GraphQL to represent free-form human-readable text.
-*/
-export type String = string;
-
-/*
-The `Long` scalar type represents non-fractional signed whole numeric values.
-Long can represent values between -(2^63) and 2^63 - 1.
-*/
-export type Long = string;
-
-/*
-The `ID` scalar type represents a unique identifier, often used to refetch an object or as key for a cache. The ID type appears in a JSON response as a String; however, it is not intended to be human-readable. When expected as an input type, any string (such as `"4"`) or integer (such as `4`) input value will be accepted as an ID.
-*/
-export type ID_Input = string | number;
-export type ID_Output = string;
-
-/*
-The `Int` scalar type represents non-fractional signed whole numeric values. Int can represent values between -(2^31) and 2^31 - 1. 
-*/
-export type Int = number;
diff --git a/sample/22-graphql-prisma/src/prisma/prisma.module.ts b/sample/22-graphql-prisma/src/prisma/prisma.module.ts
old mode 100644
new mode 100755
diff --git a/sample/22-graphql-prisma/src/prisma/prisma.service.ts b/sample/22-graphql-prisma/src/prisma/prisma.service.ts
old mode 100644
new mode 100755
index dc2e22529..edf653202
--- a/sample/22-graphql-prisma/src/prisma/prisma.service.ts
+++ b/sample/22-graphql-prisma/src/prisma/prisma.service.ts
@@ -1,12 +1,15 @@
-import { Injectable } from '@nestjs/common';
-import { Prisma } from './prisma.binding';
+import { INestApplication, Injectable, OnModuleInit } from '@nestjs/common';
+import { PrismaClient } from '@prisma/client';
 
 @Injectable()
-export class PrismaService extends Prisma {
-  constructor() {
-    super({
-      endpoint: 'https://eu1.prisma.sh/public-agatepuma-476/my-app/dev',
-      debug: false,
+export class PrismaService extends PrismaClient implements OnModuleInit {
+  async onModuleInit() {
+    await this.$connect();
+  }
+
+  async enableShutdownHooks(app: INestApplication) {
+    this.$on('beforeExit', async () => {
+      await app.close();
     });
   }
 }
diff --git a/sample/22-graphql-prisma/tsconfig.build.json b/sample/22-graphql-prisma/tsconfig.build.json
old mode 100644
new mode 100755
diff --git a/sample/22-graphql-prisma/tsconfig.json b/sample/22-graphql-prisma/tsconfig.json
old mode 100644
new mode 100755
index e268e37aa..d9c82ca97
--- a/sample/22-graphql-prisma/tsconfig.json
+++ b/sample/22-graphql-prisma/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/23-graphql-code-first/package-lock.json b/sample/23-graphql-code-first/package-lock.json
index f08d4b379..c5a6d4930 100644
Binary files a/sample/23-graphql-code-first/package-lock.json and b/sample/23-graphql-code-first/package-lock.json differ
diff --git a/sample/23-graphql-code-first/package.json b/sample/23-graphql-code-first/package.json
index f3e80738f..cbc5e8180 100644
--- a/sample/23-graphql-code-first/package.json
+++ b/sample/23-graphql-code-first/package.json
@@ -19,39 +19,39 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/graphql": "9.1.2",
-    "@nestjs/platform-express": "8.2.3",
-    "apollo-server": "3.6.1",
-    "apollo-server-express": "3.6.1",
-    "class-transformer": "0.4.0",
-    "class-validator": "0.13.2",
-    "graphql": "15.7.2",
-    "graphql-query-complexity": "0.11.0",
+    "@apollo/server": "4.9.3",
+    "@nestjs/apollo": "12.0.11",
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/graphql": "12.2.0",
+    "@nestjs/platform-express": "10.4.10",
+    "class-transformer": "0.5.1",
+    "class-validator": "0.14.1",
+    "graphql": "16.8.1",
+    "graphql-query-complexity": "0.12.0",
     "graphql-subscriptions": "2.0.0",
-    "reflect-metadata": "0.1.13",
-    "rxjs": "7.4.0"
+    "reflect-metadata": "0.2.1",
+    "rxjs": "7.8.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/node": "16.11.19",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.4.2"
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@nestjs/testing": "10.4.10",
+    "@types/express": "4.17.21",
+    "@types/node": "20.17.8",
+    "@types/supertest": "6.0.2",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.42.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-import": "2.29.1",
+    "jest": "29.7.0",
+    "prettier": "3.2.5",
+    "supertest": "6.3.4",
+    "ts-jest": "29.1.2",
+    "ts-loader": "9.5.1",
+    "ts-node": "10.9.2",
+    "tsconfig-paths": "4.2.0",
+    "typescript": "5.3.3"
   }
 }
diff --git a/sample/23-graphql-code-first/schema.gql b/sample/23-graphql-code-first/schema.gql
index 9c1d511de..7a46060d1 100644
--- a/sample/23-graphql-code-first/schema.gql
+++ b/sample/23-graphql-code-first/schema.gql
@@ -2,13 +2,15 @@
 # THIS FILE WAS AUTOMATICALLY GENERATED (DO NOT MODIFY)
 # ------------------------------------------------------
 
+directive @upper on FIELD_DEFINITION
+
 """recipe """
 type Recipe {
   id: ID!
-  title: String!
   description: String
   creationDate: Date!
   ingredients: [String!]!
+  title: String!
 }
 
 """Date custom scalar type"""
@@ -16,7 +18,7 @@ scalar Date
 
 type Query {
   recipe(id: String!): Recipe!
-  recipes(skip: Int = 0, take: Int = 25): [Recipe!]!
+  recipes(skip: Int! = 0, take: Int! = 25): [Recipe!]!
 }
 
 type Mutation {
@@ -32,4 +34,4 @@ input NewRecipeInput {
 
 type Subscription {
   recipeAdded: Recipe!
-}
+}
\ No newline at end of file
diff --git a/sample/23-graphql-code-first/src/app.module.ts b/sample/23-graphql-code-first/src/app.module.ts
index c418f9f79..2b32aa272 100644
--- a/sample/23-graphql-code-first/src/app.module.ts
+++ b/sample/23-graphql-code-first/src/app.module.ts
@@ -1,13 +1,26 @@
+import { ApolloDriver, ApolloDriverConfig } from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
 import { GraphQLModule } from '@nestjs/graphql';
+import { DirectiveLocation, GraphQLDirective } from 'graphql';
+import { upperDirectiveTransformer } from './common/directives/upper-case.directive';
 import { RecipesModule } from './recipes/recipes.module';
 
 @Module({
   imports: [
     RecipesModule,
-    GraphQLModule.forRoot({
-      installSubscriptionHandlers: true,
+    GraphQLModule.forRoot<ApolloDriverConfig>({
+      driver: ApolloDriver,
       autoSchemaFile: 'schema.gql',
+      transformSchema: schema => upperDirectiveTransformer(schema, 'upper'),
+      installSubscriptionHandlers: true,
+      buildSchemaOptions: {
+        directives: [
+          new GraphQLDirective({
+            name: 'upper',
+            locations: [DirectiveLocation.FIELD_DEFINITION],
+          }),
+        ],
+      },
     }),
   ],
 })
diff --git a/sample/23-graphql-code-first/src/common/directives/upper-case.directive.ts b/sample/23-graphql-code-first/src/common/directives/upper-case.directive.ts
index 49341fe8e..52cabe0ef 100644
--- a/sample/23-graphql-code-first/src/common/directives/upper-case.directive.ts
+++ b/sample/23-graphql-code-first/src/common/directives/upper-case.directive.ts
@@ -1,15 +1,32 @@
-import { SchemaDirectiveVisitor } from '@graphql-tools/utils';
-import { defaultFieldResolver, GraphQLField } from 'graphql';
+import { getDirective, MapperKind, mapSchema } from '@graphql-tools/utils';
+import { defaultFieldResolver, GraphQLSchema } from 'graphql';
 
-export class UpperCaseDirective extends SchemaDirectiveVisitor {
-  visitFieldDefinition(field: GraphQLField<any, any>) {
-    const { resolve = defaultFieldResolver } = field;
-    field.resolve = async function (...args) {
-      const result = await resolve.apply(this, args);
-      if (typeof result === 'string') {
-        return result.toUpperCase();
+export function upperDirectiveTransformer(
+  schema: GraphQLSchema,
+  directiveName: string,
+) {
+  return mapSchema(schema, {
+    [MapperKind.OBJECT_FIELD]: fieldConfig => {
+      const upperDirective = getDirective(
+        schema,
+        fieldConfig,
+        directiveName,
+      )?.[0];
+
+      if (upperDirective) {
+        const { resolve = defaultFieldResolver } = fieldConfig;
+
+        // Replace the original resolver with a function that *first* calls
+        // the original resolver, then converts its result to upper case
+        fieldConfig.resolve = async function (source, args, context, info) {
+          const result = await resolve(source, args, context, info);
+          if (typeof result === 'string') {
+            return result.toUpperCase();
+          }
+          return result;
+        };
+        return fieldConfig;
       }
-      return result;
-    };
-  }
+    },
+  });
 }
diff --git a/sample/23-graphql-code-first/src/common/plugins/complexity.plugin.ts b/sample/23-graphql-code-first/src/common/plugins/complexity.plugin.ts
index 86883940e..d7e3699e9 100644
--- a/sample/23-graphql-code-first/src/common/plugins/complexity.plugin.ts
+++ b/sample/23-graphql-code-first/src/common/plugins/complexity.plugin.ts
@@ -1,8 +1,6 @@
-import { GraphQLSchemaHost, Plugin } from '@nestjs/graphql';
-import {
-  ApolloServerPlugin,
-  GraphQLRequestListener,
-} from 'apollo-server-plugin-base';
+import { ApolloServerPlugin, GraphQLRequestListener } from '@apollo/server';
+import { Plugin } from '@nestjs/apollo';
+import { GraphQLSchemaHost } from '@nestjs/graphql';
 import { GraphQLError } from 'graphql';
 import {
   fieldExtensionsEstimator,
@@ -14,7 +12,7 @@ import {
 export class ComplexityPlugin implements ApolloServerPlugin {
   constructor(private gqlSchemaHost: GraphQLSchemaHost) {}
 
-  async requestDidStart(): Promise<GraphQLRequestListener> {
+  async requestDidStart(): Promise<GraphQLRequestListener<any>> {
     const { schema } = this.gqlSchemaHost;
 
     return {
diff --git a/sample/23-graphql-code-first/src/common/plugins/logging.plugin.ts b/sample/23-graphql-code-first/src/common/plugins/logging.plugin.ts
index 8e48e29cb..77c23a96c 100644
--- a/sample/23-graphql-code-first/src/common/plugins/logging.plugin.ts
+++ b/sample/23-graphql-code-first/src/common/plugins/logging.plugin.ts
@@ -1,12 +1,9 @@
-import { Plugin } from '@nestjs/graphql';
-import {
-  ApolloServerPlugin,
-  GraphQLRequestListener,
-} from 'apollo-server-plugin-base';
+import { ApolloServerPlugin, GraphQLRequestListener } from '@apollo/server';
+import { Plugin } from '@nestjs/apollo';
 
 @Plugin()
 export class LoggingPlugin implements ApolloServerPlugin {
-  async requestDidStart(): Promise<GraphQLRequestListener> {
+  async requestDidStart(): Promise<GraphQLRequestListener<any>> {
     console.log('Request started');
     return {
       async willSendResponse() {
diff --git a/sample/23-graphql-code-first/src/recipes/models/recipe.model.ts b/sample/23-graphql-code-first/src/recipes/models/recipe.model.ts
index 2193b2310..8fd872f4e 100644
--- a/sample/23-graphql-code-first/src/recipes/models/recipe.model.ts
+++ b/sample/23-graphql-code-first/src/recipes/models/recipe.model.ts
@@ -1,11 +1,11 @@
-import { Field, ID, ObjectType } from '@nestjs/graphql';
+import { Directive, Field, ID, ObjectType } from '@nestjs/graphql';
 
-@ObjectType({ description: 'recipe ' })
+@ObjectType({ description: 'recipe' })
 export class Recipe {
   @Field(type => ID)
   id: string;
 
-  @Field()
+  @Directive('@upper')
   title: string;
 
   @Field({ nullable: true })
diff --git a/sample/23-graphql-code-first/tsconfig.json b/sample/23-graphql-code-first/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/23-graphql-code-first/tsconfig.json
+++ b/sample/23-graphql-code-first/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/24-serve-static/package-lock.json b/sample/24-serve-static/package-lock.json
index af55cec67..41a361dfd 100644
Binary files a/sample/24-serve-static/package-lock.json and b/sample/24-serve-static/package-lock.json differ
diff --git a/sample/24-serve-static/package.json b/sample/24-serve-static/package.json
index b941d7858..c9903ec0e 100644
--- a/sample/24-serve-static/package.json
+++ b/sample/24-serve-static/package.json
@@ -19,35 +19,35 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/serve-static": "2.2.2",
-    "@nestjs/platform-express": "8.2.3",
-    "class-transformer": "0.4.0",
-    "class-validator": "0.13.2",
-    "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/serve-static": "4.0.0",
+    "@nestjs/platform-express": "10.4.10",
+    "class-transformer": "0.5.1",
+    "class-validator": "0.14.1",
+    "reflect-metadata": "0.2.1",
+    "rimraf": "5.0.10",
+    "rxjs": "7.8.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/node": "16.11.19",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@nestjs/testing": "10.4.10",
+    "@types/express": "4.17.21",
+    "@types/node": "20.17.8",
+    "@types/supertest": "6.0.2",
+    "jest": "29.7.0",
+    "prettier": "3.2.5",
+    "supertest": "6.3.4",
+    "ts-jest": "29.1.2",
+    "ts-loader": "9.5.1",
+    "ts-node": "10.9.2",
+    "tsconfig-paths": "4.2.0",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.42.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-import": "2.29.1",
+    "typescript": "5.3.3"
   }
 }
diff --git a/sample/24-serve-static/src/app.module.ts b/sample/24-serve-static/src/app.module.ts
index 3f4864ce5..4fbea3cf2 100644
--- a/sample/24-serve-static/src/app.module.ts
+++ b/sample/24-serve-static/src/app.module.ts
@@ -7,7 +7,7 @@ import { AppController } from './app.controller';
   imports: [
     ServeStaticModule.forRoot({
       rootPath: join(__dirname, '..', 'client'),
-      exclude: ['/api*'],
+      exclude: ['/api/(.*)'],
     }),
   ],
   controllers: [AppController],
diff --git a/sample/24-serve-static/tsconfig.json b/sample/24-serve-static/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/24-serve-static/tsconfig.json
+++ b/sample/24-serve-static/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/25-dynamic-modules/README.md b/sample/25-dynamic-modules/README.md
index a59ef9241..ac4f77526 100644
--- a/sample/25-dynamic-modules/README.md
+++ b/sample/25-dynamic-modules/README.md
@@ -1,13 +1,13 @@
 <p align="center">
-  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo_text.svg" width="320" alt="Nest Logo" /></a>
+  <a href="https://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
 </p>
 
 [travis-image]: https://api.travis-ci.org/nestjs/nest.svg?branch=master
 [travis-url]: https://travis-ci.org/nestjs/nest
 [linux-image]: https://img.shields.io/travis/nestjs/nest/master.svg?label=linux
 [linux-url]: https://travis-ci.org/nestjs/nest
-  
-  <p align="center">A progressive <a href="http://nodejs.org" target="blank">Node.js</a> framework for building efficient and scalable server-side applications, heavily inspired by <a href="https://angular.io" target="blank">Angular</a>.</p>
+
+  <p align="center">A progressive <a href="https://nodejs.org" target="blank">Node.js</a> framework for building efficient and scalable server-side applications, heavily inspired by <a href="https://angular.io" target="blank">Angular</a>.</p>
     <p align="center">
 <a href="https://www.npmjs.com/~nestjscore"><img src="https://img.shields.io/npm/v/@nestjs/core.svg" alt="NPM Version" /></a>
 <a href="https://www.npmjs.com/~nestjscore"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
diff --git a/sample/25-dynamic-modules/package-lock.json b/sample/25-dynamic-modules/package-lock.json
index 3b510598b..c76ef1d9f 100644
Binary files a/sample/25-dynamic-modules/package-lock.json and b/sample/25-dynamic-modules/package-lock.json differ
diff --git a/sample/25-dynamic-modules/package.json b/sample/25-dynamic-modules/package.json
index 656dc8276..365c35093 100644
--- a/sample/25-dynamic-modules/package.json
+++ b/sample/25-dynamic-modules/package.json
@@ -19,36 +19,36 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "dotenv": "10.0.0",
-    "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/platform-express": "10.4.10",
+    "dotenv": "16.4.5",
+    "reflect-metadata": "0.2.1",
+    "rimraf": "5.0.10",
+    "rxjs": "7.8.1"
   },
   "devDependencies": {
-    "@types/dotenv": "8.2.0",
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.19",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@types/dotenv": "8.2.3",
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@nestjs/testing": "10.4.10",
+    "@types/express": "4.17.21",
+    "@types/jest": "29.5.12",
+    "@types/node": "20.17.8",
+    "@types/supertest": "6.0.2",
+    "jest": "29.7.0",
+    "prettier": "3.2.5",
+    "supertest": "6.3.4",
+    "ts-jest": "29.1.2",
+    "ts-loader": "9.5.1",
+    "ts-node": "10.9.2",
+    "tsconfig-paths": "4.2.0",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.42.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-import": "2.29.1",
+    "typescript": "5.3.3"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/25-dynamic-modules/tsconfig.json b/sample/25-dynamic-modules/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/25-dynamic-modules/tsconfig.json
+++ b/sample/25-dynamic-modules/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/26-queues/README.md b/sample/26-queues/README.md
index a59ef9241..ac4f77526 100644
--- a/sample/26-queues/README.md
+++ b/sample/26-queues/README.md
@@ -1,13 +1,13 @@
 <p align="center">
-  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo_text.svg" width="320" alt="Nest Logo" /></a>
+  <a href="https://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
 </p>
 
 [travis-image]: https://api.travis-ci.org/nestjs/nest.svg?branch=master
 [travis-url]: https://travis-ci.org/nestjs/nest
 [linux-image]: https://img.shields.io/travis/nestjs/nest/master.svg?label=linux
 [linux-url]: https://travis-ci.org/nestjs/nest
-  
-  <p align="center">A progressive <a href="http://nodejs.org" target="blank">Node.js</a> framework for building efficient and scalable server-side applications, heavily inspired by <a href="https://angular.io" target="blank">Angular</a>.</p>
+
+  <p align="center">A progressive <a href="https://nodejs.org" target="blank">Node.js</a> framework for building efficient and scalable server-side applications, heavily inspired by <a href="https://angular.io" target="blank">Angular</a>.</p>
     <p align="center">
 <a href="https://www.npmjs.com/~nestjscore"><img src="https://img.shields.io/npm/v/@nestjs/core.svg" alt="NPM Version" /></a>
 <a href="https://www.npmjs.com/~nestjscore"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
diff --git a/sample/26-queues/package-lock.json b/sample/26-queues/package-lock.json
index d0df3c3c8..fd69c5ee0 100644
Binary files a/sample/26-queues/package-lock.json and b/sample/26-queues/package-lock.json differ
diff --git a/sample/26-queues/package.json b/sample/26-queues/package.json
index b1f00981c..83ed62ec7 100644
--- a/sample/26-queues/package.json
+++ b/sample/26-queues/package.json
@@ -19,39 +19,39 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/bull": "0.4.2",
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "bull": "3.29.3",
-    "dotenv": "10.0.0",
-    "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "@nestjs/bull": "10.1.0",
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/platform-express": "10.4.10",
+    "bull": "4.10.4",
+    "dotenv": "16.4.5",
+    "reflect-metadata": "0.2.1",
+    "rimraf": "5.0.10",
+    "rxjs": "7.8.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/bull": "3.15.7",
-    "@types/dotenv": "8.2.0",
-    "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.19",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@nestjs/testing": "10.4.10",
+    "@types/bull": "3.15.9",
+    "@types/dotenv": "8.2.3",
+    "@types/express": "4.17.21",
+    "@types/jest": "29.5.12",
+    "@types/node": "20.17.8",
+    "@types/supertest": "6.0.2",
+    "jest": "29.7.0",
+    "prettier": "3.2.5",
+    "supertest": "6.3.4",
+    "ts-jest": "29.1.2",
+    "ts-loader": "9.5.1",
+    "ts-node": "10.9.2",
+    "tsconfig-paths": "4.2.0",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.42.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-import": "2.29.1",
+    "typescript": "5.3.3"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/26-queues/tsconfig.json b/sample/26-queues/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/26-queues/tsconfig.json
+++ b/sample/26-queues/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/27-scheduling/README.md b/sample/27-scheduling/README.md
index a59ef9241..ac4f77526 100644
--- a/sample/27-scheduling/README.md
+++ b/sample/27-scheduling/README.md
@@ -1,13 +1,13 @@
 <p align="center">
-  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo_text.svg" width="320" alt="Nest Logo" /></a>
+  <a href="https://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
 </p>
 
 [travis-image]: https://api.travis-ci.org/nestjs/nest.svg?branch=master
 [travis-url]: https://travis-ci.org/nestjs/nest
 [linux-image]: https://img.shields.io/travis/nestjs/nest/master.svg?label=linux
 [linux-url]: https://travis-ci.org/nestjs/nest
-  
-  <p align="center">A progressive <a href="http://nodejs.org" target="blank">Node.js</a> framework for building efficient and scalable server-side applications, heavily inspired by <a href="https://angular.io" target="blank">Angular</a>.</p>
+
+  <p align="center">A progressive <a href="https://nodejs.org" target="blank">Node.js</a> framework for building efficient and scalable server-side applications, heavily inspired by <a href="https://angular.io" target="blank">Angular</a>.</p>
     <p align="center">
 <a href="https://www.npmjs.com/~nestjscore"><img src="https://img.shields.io/npm/v/@nestjs/core.svg" alt="NPM Version" /></a>
 <a href="https://www.npmjs.com/~nestjscore"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
diff --git a/sample/27-scheduling/package-lock.json b/sample/27-scheduling/package-lock.json
index 37a08b19a..5da76acbc 100644
Binary files a/sample/27-scheduling/package-lock.json and b/sample/27-scheduling/package-lock.json differ
diff --git a/sample/27-scheduling/package.json b/sample/27-scheduling/package.json
index ccd3ab632..79c564caf 100644
--- a/sample/27-scheduling/package.json
+++ b/sample/27-scheduling/package.json
@@ -19,38 +19,38 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "@nestjs/schedule": "1.0.2",
-    "dotenv": "10.0.0",
-    "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/platform-express": "10.4.10",
+    "@nestjs/schedule": "4.0.0",
+    "dotenv": "16.4.5",
+    "reflect-metadata": "0.2.1",
+    "rimraf": "5.0.10",
+    "rxjs": "7.8.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/bull": "3.15.7",
-    "@types/dotenv": "8.2.0",
-    "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.19",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@nestjs/testing": "10.4.10",
+    "@types/bull": "3.15.9",
+    "@types/dotenv": "8.2.3",
+    "@types/express": "4.17.21",
+    "@types/jest": "29.5.12",
+    "@types/node": "20.17.8",
+    "@types/supertest": "6.0.2",
+    "jest": "29.7.0",
+    "prettier": "3.2.5",
+    "supertest": "6.3.4",
+    "ts-jest": "29.1.2",
+    "ts-loader": "9.5.1",
+    "ts-node": "10.9.2",
+    "tsconfig-paths": "4.2.0",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.42.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-import": "2.29.1",
+    "typescript": "5.3.3"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/27-scheduling/tsconfig.json b/sample/27-scheduling/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/27-scheduling/tsconfig.json
+++ b/sample/27-scheduling/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/28-sse/README.md b/sample/28-sse/README.md
index a59ef9241..ac4f77526 100644
--- a/sample/28-sse/README.md
+++ b/sample/28-sse/README.md
@@ -1,13 +1,13 @@
 <p align="center">
-  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo_text.svg" width="320" alt="Nest Logo" /></a>
+  <a href="https://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
 </p>
 
 [travis-image]: https://api.travis-ci.org/nestjs/nest.svg?branch=master
 [travis-url]: https://travis-ci.org/nestjs/nest
 [linux-image]: https://img.shields.io/travis/nestjs/nest/master.svg?label=linux
 [linux-url]: https://travis-ci.org/nestjs/nest
-  
-  <p align="center">A progressive <a href="http://nodejs.org" target="blank">Node.js</a> framework for building efficient and scalable server-side applications, heavily inspired by <a href="https://angular.io" target="blank">Angular</a>.</p>
+
+  <p align="center">A progressive <a href="https://nodejs.org" target="blank">Node.js</a> framework for building efficient and scalable server-side applications, heavily inspired by <a href="https://angular.io" target="blank">Angular</a>.</p>
     <p align="center">
 <a href="https://www.npmjs.com/~nestjscore"><img src="https://img.shields.io/npm/v/@nestjs/core.svg" alt="NPM Version" /></a>
 <a href="https://www.npmjs.com/~nestjscore"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
diff --git a/sample/28-sse/package-lock.json b/sample/28-sse/package-lock.json
index feed399bc..7aca786bf 100644
Binary files a/sample/28-sse/package-lock.json and b/sample/28-sse/package-lock.json differ
diff --git a/sample/28-sse/package.json b/sample/28-sse/package.json
index d588a5bb9..e8bed8380 100644
--- a/sample/28-sse/package.json
+++ b/sample/28-sse/package.json
@@ -19,35 +19,35 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/platform-express": "10.4.10",
+    "reflect-metadata": "0.2.1",
+    "rimraf": "5.0.10",
+    "rxjs": "7.8.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/dotenv": "8.2.0",
-    "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.19",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@nestjs/testing": "10.4.10",
+    "@types/dotenv": "8.2.3",
+    "@types/express": "4.17.21",
+    "@types/jest": "29.5.12",
+    "@types/node": "20.17.8",
+    "@types/supertest": "6.0.2",
+    "jest": "29.7.0",
+    "prettier": "3.2.5",
+    "supertest": "6.3.4",
+    "ts-jest": "29.1.2",
+    "ts-loader": "9.5.1",
+    "ts-node": "10.9.2",
+    "tsconfig-paths": "4.2.0",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.42.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-import": "2.29.1",
+    "typescript": "5.3.3"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/28-sse/src/app.controller.ts b/sample/28-sse/src/app.controller.ts
index b8d0abb01..6a029a9a9 100644
--- a/sample/28-sse/src/app.controller.ts
+++ b/sample/28-sse/src/app.controller.ts
@@ -17,7 +17,7 @@ export class AppController {
   @Sse('sse')
   sse(): Observable<MessageEvent> {
     return interval(1000).pipe(
-      map((_) => ({ data: { hello: 'world' } } as MessageEvent)),
+      map((_) => ({ data: { hello: 'world' } }) as MessageEvent),
     );
   }
 }
diff --git a/sample/28-sse/src/main.ts b/sample/28-sse/src/main.ts
index e1e10d969..4d8008da5 100644
--- a/sample/28-sse/src/main.ts
+++ b/sample/28-sse/src/main.ts
@@ -2,7 +2,10 @@ import { NestFactory } from '@nestjs/core';
 import { AppModule } from './app.module';
 
 async function bootstrap() {
-  const app = await NestFactory.create(AppModule);
+  const app = await NestFactory.create(AppModule, {
+    forceCloseConnections: true,
+  });
+  app.enableShutdownHooks();
   await app.listen(3000);
   console.log(`Application is running on: ${await app.getUrl()}`);
 }
diff --git a/sample/28-sse/tsconfig.json b/sample/28-sse/tsconfig.json
index 4e6e210f1..1bbdea209 100644
--- a/sample/28-sse/tsconfig.json
+++ b/sample/28-sse/tsconfig.json
@@ -5,7 +5,7 @@
     "removeComments": true,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/29-file-upload/e2e/app/app.e2e-spec.ts b/sample/29-file-upload/e2e/app/app.e2e-spec.ts
index 826b5ba8d..6f8bc9034 100644
--- a/sample/29-file-upload/e2e/app/app.e2e-spec.ts
+++ b/sample/29-file-upload/e2e/app/app.e2e-spec.ts
@@ -1,7 +1,6 @@
 import { INestApplication } from '@nestjs/common';
 import { Test } from '@nestjs/testing';
 import { readFileSync } from 'fs';
-import { join } from 'path';
 import * as request from 'supertest';
 import { AppModule } from '../../src/app.module';
 
@@ -30,6 +29,40 @@ describe('E2E FileTest', () => {
       });
   });
 
+  it('should allow for file uploads that pass validation', async () => {
+    return request(app.getHttpServer())
+      .post('/file/pass-validation')
+      .attach('file', './package.json')
+      .field('name', 'test')
+      .expect(201)
+      .expect({
+        body: {
+          name: 'test',
+        },
+        file: readFileSync('./package.json').toString(),
+      });
+  });
+
+  it('should throw for file uploads that do not pass validation', async () => {
+    return request(app.getHttpServer())
+      .post('/file/fail-validation')
+      .attach('file', './package.json')
+      .field('name', 'test')
+      .expect(400);
+  });
+
+  it('should throw when file is required but no file is uploaded', async () => {
+    return request(app.getHttpServer())
+      .post('/file/fail-validation')
+      .expect(400);
+  });
+
+  it('should allow for optional file uploads with validation enabled (fixes #10017)', () => {
+    return request(app.getHttpServer())
+      .post('/file/pass-validation')
+      .expect(201);
+  });
+
   afterAll(async () => {
     await app.close();
   });
diff --git a/sample/29-file-upload/package-lock.json b/sample/29-file-upload/package-lock.json
index 691e2889f..87c83b22d 100644
Binary files a/sample/29-file-upload/package-lock.json and b/sample/29-file-upload/package-lock.json differ
diff --git a/sample/29-file-upload/package.json b/sample/29-file-upload/package.json
index 04bc067f8..d3b4ef201 100644
--- a/sample/29-file-upload/package.json
+++ b/sample/29-file-upload/package.json
@@ -19,37 +19,37 @@
     "test:e2e": "jest --config ./e2e/jest-e2e.json"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "class-transformer": "0.4.0",
-    "class-validator": "0.13.2",
-    "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/platform-express": "10.4.10",
+    "class-transformer": "0.5.1",
+    "class-validator": "0.14.1",
+    "reflect-metadata": "0.2.1",
+    "rimraf": "5.0.10",
+    "rxjs": "7.8.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/multer": "1.4.7",
-    "@types/node": "16.11.19",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@nestjs/testing": "10.4.10",
+    "@types/express": "4.17.21",
+    "@types/jest": "29.5.12",
+    "@types/multer": "1.4.11",
+    "@types/node": "20.17.8",
+    "@types/supertest": "6.0.2",
+    "jest": "29.7.0",
+    "prettier": "3.2.5",
+    "supertest": "6.3.4",
+    "ts-jest": "29.1.2",
+    "ts-loader": "9.5.1",
+    "ts-node": "10.9.2",
+    "tsconfig-paths": "4.2.0",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.42.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-import": "2.29.1",
+    "typescript": "5.3.3"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/29-file-upload/src/app.controller.ts b/sample/29-file-upload/src/app.controller.ts
index dc59cd260..371a1fd69 100644
--- a/sample/29-file-upload/src/app.controller.ts
+++ b/sample/29-file-upload/src/app.controller.ts
@@ -2,6 +2,7 @@ import {
   Body,
   Controller,
   Get,
+  ParseFilePipeBuilder,
   Post,
   UploadedFile,
   UseInterceptors,
@@ -31,4 +32,44 @@ export class AppController {
       file: file.buffer.toString(),
     };
   }
+
+  @UseInterceptors(FileInterceptor('file'))
+  @Post('file/pass-validation')
+  uploadFileAndPassValidation(
+    @Body() body: SampleDto,
+    @UploadedFile(
+      new ParseFilePipeBuilder()
+        .addFileTypeValidator({
+          fileType: 'json',
+        })
+        .build({
+          fileIsRequired: false,
+        }),
+    )
+    file?: Express.Multer.File,
+  ) {
+    return {
+      body,
+      file: file?.buffer.toString(),
+    };
+  }
+
+  @UseInterceptors(FileInterceptor('file'))
+  @Post('file/fail-validation')
+  uploadFileAndFailValidation(
+    @Body() body: SampleDto,
+    @UploadedFile(
+      new ParseFilePipeBuilder()
+        .addFileTypeValidator({
+          fileType: 'jpg',
+        })
+        .build(),
+    )
+    file: Express.Multer.File,
+  ) {
+    return {
+      body,
+      file: file.buffer.toString(),
+    };
+  }
 }
diff --git a/sample/29-file-upload/tsconfig.json b/sample/29-file-upload/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/29-file-upload/tsconfig.json
+++ b/sample/29-file-upload/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/30-event-emitter/package-lock.json b/sample/30-event-emitter/package-lock.json
index f4afd44bc..2a9c253bb 100644
Binary files a/sample/30-event-emitter/package-lock.json and b/sample/30-event-emitter/package-lock.json differ
diff --git a/sample/30-event-emitter/package.json b/sample/30-event-emitter/package.json
index 85665c562..48f514621 100644
--- a/sample/30-event-emitter/package.json
+++ b/sample/30-event-emitter/package.json
@@ -19,35 +19,35 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/event-emitter": "1.0.0",
-    "@nestjs/platform-express": "8.2.3",
-    "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/event-emitter": "2.0.3",
+    "@nestjs/platform-express": "10.4.10",
+    "reflect-metadata": "0.2.1",
+    "rimraf": "5.0.10",
+    "rxjs": "7.8.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.19",
-    "@types/supertest": "2.0.11",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "jest": "27.3.1",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@nestjs/testing": "10.4.10",
+    "@types/express": "4.17.21",
+    "@types/jest": "29.5.12",
+    "@types/node": "20.17.8",
+    "@types/supertest": "6.0.2",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.42.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-import": "2.29.1",
+    "jest": "29.7.0",
+    "prettier": "3.2.5",
+    "supertest": "6.3.4",
+    "ts-jest": "29.1.2",
+    "ts-loader": "9.5.1",
+    "ts-node": "10.9.2",
+    "tsconfig-paths": "4.2.0",
+    "typescript": "5.3.3"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/30-event-emitter/test/app.e2e-spec.ts b/sample/30-event-emitter/test/app.e2e-spec.ts
index 50cda6233..0136f2d60 100644
--- a/sample/30-event-emitter/test/app.e2e-spec.ts
+++ b/sample/30-event-emitter/test/app.e2e-spec.ts
@@ -21,4 +21,6 @@ describe('AppController (e2e)', () => {
       .expect(200)
       .expect('Hello World!');
   });
+
+  afterEach(() => app.close());
 });
diff --git a/sample/30-event-emitter/tsconfig.json b/sample/30-event-emitter/tsconfig.json
index a0e283732..d670b01d5 100644
--- a/sample/30-event-emitter/tsconfig.json
+++ b/sample/30-event-emitter/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/31-graphql-federation-code-first/README.md b/sample/31-graphql-federation-code-first/README.md
index e7b90c765..2743338c4 100644
--- a/sample/31-graphql-federation-code-first/README.md
+++ b/sample/31-graphql-federation-code-first/README.md
@@ -4,7 +4,7 @@ A simple example of GraphQL Federation using Code First approach.
 
 ## Execution
 
-Make sure to start the two sub-graph applications first, then the gatway. Otherwise the gateway won't be able to fetch schemas from the sub-graphs.
+Make sure to start the two sub-graph applications first, then the gateway. Otherwise the gateway won't be able to fetch schemas from the sub-graphs.
 
 ```sh
 cd users-application && npm run start
@@ -20,7 +20,7 @@ cd gateway && npm run start
 
 ## Access the graph
 
-You can reach the gateway under `http://localhost:3002/graphql`
+You can reach the gateway under `http://localhost:3001/graphql`
 
 ## Query a combined graph
 
diff --git a/sample/31-graphql-federation-code-first/gateway/README.md b/sample/31-graphql-federation-code-first/gateway/README.md
index 9fe8812ff..78eec602a 100644
--- a/sample/31-graphql-federation-code-first/gateway/README.md
+++ b/sample/31-graphql-federation-code-first/gateway/README.md
@@ -1,11 +1,11 @@
 <p align="center">
-  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo_text.svg" width="320" alt="Nest Logo" /></a>
+  <a href="https://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
 </p>
 
 [circleci-image]: https://img.shields.io/circleci/build/github/nestjs/nest/master?token=abc123def456
 [circleci-url]: https://circleci.com/gh/nestjs/nest
 
-  <p align="center">A progressive <a href="http://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>
+  <p align="center">A progressive <a href="https://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>
     <p align="center">
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/v/@nestjs/core.svg" alt="NPM Version" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
diff --git a/sample/31-graphql-federation-code-first/gateway/package-lock.json b/sample/31-graphql-federation-code-first/gateway/package-lock.json
index f476cfe72..c2d9e5785 100644
Binary files a/sample/31-graphql-federation-code-first/gateway/package-lock.json and b/sample/31-graphql-federation-code-first/gateway/package-lock.json differ
diff --git a/sample/31-graphql-federation-code-first/gateway/package.json b/sample/31-graphql-federation-code-first/gateway/package.json
index b8e4cf110..80f714484 100644
--- a/sample/31-graphql-federation-code-first/gateway/package.json
+++ b/sample/31-graphql-federation-code-first/gateway/package.json
@@ -1,10 +1,8 @@
 {
   "name": "gateway",
-  "version": "0.0.1",
-  "description": "",
-  "author": "",
-  "private": true,
-  "license": "UNLICENSED",
+  "version": "1.0.0",
+  "description": "Nest TypeScript starter repository",
+  "license": "MIT",
   "scripts": {
     "prebuild": "rimraf dist",
     "build": "nest build",
@@ -21,40 +19,42 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@apollo/gateway": "0.46.0",
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/graphql": "9.1.2",
-    "@nestjs/platform-express": "8.2.3",
-    "apollo-server-express": "3.6.1",
-    "graphql": "15.7.2",
-    "graphql-tools": "7.0.5",
-    "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0",
-    "ts-morph": "12.2.0"
+    "@apollo/gateway": "2.8.5",
+    "@apollo/server": "4.9.3",
+    "@nestjs/apollo": "12.0.11",
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/graphql": "12.2.0",
+    "@nestjs/platform-express": "10.4.10",
+    "graphql": "16.8.1",
+    "graphql-tools": "9.0.0",
+    "reflect-metadata": "0.2.1",
+    "rimraf": "5.0.10",
+    "rxjs": "7.8.1",
+    "ts-morph": "21.0.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.19",
-    "@types/supertest": "2.0.11",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-prettier": "4.0.0",
-    "jest": "27.3.1",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@nestjs/testing": "10.4.10",
+    "@types/express": "4.17.21",
+    "@types/jest": "29.5.12",
+    "@types/node": "20.17.8",
+    "@types/supertest": "6.0.2",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.43.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-prettier": "5.1.3",
+    "jest": "29.7.0",
+    "prettier": "3.2.5",
+    "supertest": "6.3.4",
+    "ts-jest": "29.1.2",
+    "ts-loader": "9.5.1",
+    "ts-node": "10.9.2",
+    "tsconfig-paths": "4.2.0",
+    "typescript": "5.3.3",
+    "webpack": "5.96.1"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/31-graphql-federation-code-first/gateway/src/app.module.ts b/sample/31-graphql-federation-code-first/gateway/src/app.module.ts
index c07abd63e..4ce964b08 100644
--- a/sample/31-graphql-federation-code-first/gateway/src/app.module.ts
+++ b/sample/31-graphql-federation-code-first/gateway/src/app.module.ts
@@ -1,19 +1,21 @@
+import { IntrospectAndCompose } from '@apollo/gateway';
+import { ApolloGatewayDriver, ApolloGatewayDriverConfig } from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
+import { GraphQLModule } from '@nestjs/graphql';
 import { AppController } from './app.controller';
 import { AppService } from './app.service';
-import { GraphQLGatewayModule } from '@nestjs/graphql';
 
 @Module({
   imports: [
-    GraphQLGatewayModule.forRoot({
-      server: {
-        cors: true,
-      },
+    GraphQLModule.forRoot<ApolloGatewayDriverConfig>({
+      driver: ApolloGatewayDriver,
       gateway: {
-        serviceList: [
-          { name: 'users', url: 'http://localhost:3000/graphql' },
-          { name: 'posts', url: 'http://localhost:3001/graphql' },
-        ],
+        supergraphSdl: new IntrospectAndCompose({
+          subgraphs: [
+            { name: 'users', url: 'http://localhost:3002/graphql' },
+            { name: 'posts', url: 'http://localhost:3003/graphql' },
+          ],
+        }),
       },
     }),
   ],
diff --git a/sample/31-graphql-federation-code-first/gateway/src/main.ts b/sample/31-graphql-federation-code-first/gateway/src/main.ts
index cdebcd75e..7d4c1629f 100644
--- a/sample/31-graphql-federation-code-first/gateway/src/main.ts
+++ b/sample/31-graphql-federation-code-first/gateway/src/main.ts
@@ -3,6 +3,6 @@ import { AppModule } from './app.module';
 
 async function bootstrap() {
   const app = await NestFactory.create(AppModule);
-  await app.listen(3002);
+  await app.listen(3001);
 }
 bootstrap();
diff --git a/sample/31-graphql-federation-code-first/gateway/tsconfig.json b/sample/31-graphql-federation-code-first/gateway/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/31-graphql-federation-code-first/gateway/tsconfig.json
+++ b/sample/31-graphql-federation-code-first/gateway/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/31-graphql-federation-code-first/posts-application/README.md b/sample/31-graphql-federation-code-first/posts-application/README.md
index 9fe8812ff..78eec602a 100644
--- a/sample/31-graphql-federation-code-first/posts-application/README.md
+++ b/sample/31-graphql-federation-code-first/posts-application/README.md
@@ -1,11 +1,11 @@
 <p align="center">
-  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo_text.svg" width="320" alt="Nest Logo" /></a>
+  <a href="https://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
 </p>
 
 [circleci-image]: https://img.shields.io/circleci/build/github/nestjs/nest/master?token=abc123def456
 [circleci-url]: https://circleci.com/gh/nestjs/nest
 
-  <p align="center">A progressive <a href="http://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>
+  <p align="center">A progressive <a href="https://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>
     <p align="center">
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/v/@nestjs/core.svg" alt="NPM Version" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
diff --git a/sample/31-graphql-federation-code-first/posts-application/package-lock.json b/sample/31-graphql-federation-code-first/posts-application/package-lock.json
index e7a108a63..c27cbb347 100644
Binary files a/sample/31-graphql-federation-code-first/posts-application/package-lock.json and b/sample/31-graphql-federation-code-first/posts-application/package-lock.json differ
diff --git a/sample/31-graphql-federation-code-first/posts-application/package.json b/sample/31-graphql-federation-code-first/posts-application/package.json
index 4ec6c7d53..c6331b867 100644
--- a/sample/31-graphql-federation-code-first/posts-application/package.json
+++ b/sample/31-graphql-federation-code-first/posts-application/package.json
@@ -1,9 +1,7 @@
 {
   "name": "posts-application",
   "version": "1.0.0",
-  "description": "",
-  "author": "Flusinerd",
-  "private": true,
+  "description": "Nest TypeScript starter repository",
   "license": "MIT",
   "scripts": {
     "prebuild": "rimraf dist",
@@ -21,42 +19,43 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@apollo/federation": "0.33.9",
-    "@apollo/gateway": "0.46.0",
-    "@apollo/subgraph": "0.1.5",
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/graphql": "9.1.2",
-    "@nestjs/platform-express": "8.2.3",
-    "apollo-server-express": "3.6.1",
-    "graphql": "15.7.2",
-    "graphql-tools": "7.0.5",
-    "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0",
-    "ts-morph": "12.2.0"
+    "@apollo/federation": "0.38.1",
+    "@apollo/gateway": "2.8.5",
+    "@apollo/server": "4.9.3",
+    "@apollo/subgraph": "2.2.3",
+    "@nestjs/apollo": "12.0.11",
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/graphql": "12.2.0",
+    "@nestjs/platform-express": "10.4.10",
+    "graphql": "16.8.1",
+    "graphql-tools": "9.0.0",
+    "reflect-metadata": "0.2.1",
+    "rimraf": "5.0.10",
+    "rxjs": "7.8.1",
+    "ts-morph": "21.0.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.19",
-    "@types/supertest": "2.0.11",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-prettier": "4.0.0",
-    "jest": "27.3.1",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@nestjs/testing": "10.4.10",
+    "@types/express": "4.17.21",
+    "@types/jest": "29.5.12",
+    "@types/node": "20.17.8",
+    "@types/supertest": "6.0.2",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.43.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-prettier": "5.1.3",
+    "jest": "29.7.0",
+    "prettier": "3.2.5",
+    "supertest": "6.3.4",
+    "ts-jest": "29.1.2",
+    "ts-loader": "9.5.1",
+    "ts-node": "10.9.2",
+    "tsconfig-paths": "4.2.0",
+    "typescript": "5.3.3"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/31-graphql-federation-code-first/posts-application/src/main.ts b/sample/31-graphql-federation-code-first/posts-application/src/main.ts
index 7d4c1629f..138096340 100644
--- a/sample/31-graphql-federation-code-first/posts-application/src/main.ts
+++ b/sample/31-graphql-federation-code-first/posts-application/src/main.ts
@@ -3,6 +3,6 @@ import { AppModule } from './app.module';
 
 async function bootstrap() {
   const app = await NestFactory.create(AppModule);
-  await app.listen(3001);
+  await app.listen(3003);
 }
 bootstrap();
diff --git a/sample/31-graphql-federation-code-first/posts-application/src/posts/posts.module.ts b/sample/31-graphql-federation-code-first/posts-application/src/posts/posts.module.ts
index 4ebf3c92f..a3048ea0a 100644
--- a/sample/31-graphql-federation-code-first/posts-application/src/posts/posts.module.ts
+++ b/sample/31-graphql-federation-code-first/posts-application/src/posts/posts.module.ts
@@ -1,14 +1,21 @@
+import {
+  ApolloFederationDriver,
+  ApolloFederationDriverConfig,
+} from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
-import { GraphQLFederationModule } from '@nestjs/graphql';
+import { GraphQLModule } from '@nestjs/graphql';
 import { User } from './models/user.model';
 import { PostsResolver } from './posts.resolver';
 import { PostsService } from './posts.service';
 import { UsersResolver } from './users.resolver';
+import { ApolloServerPluginInlineTrace } from '@apollo/server/plugin/inlineTrace';
 
 @Module({
   imports: [
-    GraphQLFederationModule.forRoot({
+    GraphQLModule.forRoot<ApolloFederationDriverConfig>({
+      driver: ApolloFederationDriver,
       autoSchemaFile: true,
+      plugins: [ApolloServerPluginInlineTrace()],
       buildSchemaOptions: {
         orphanedTypes: [User],
       },
diff --git a/sample/31-graphql-federation-code-first/posts-application/src/posts/posts.resolver.ts b/sample/31-graphql-federation-code-first/posts-application/src/posts/posts.resolver.ts
index 891f1398a..c66f8dc38 100644
--- a/sample/31-graphql-federation-code-first/posts-application/src/posts/posts.resolver.ts
+++ b/sample/31-graphql-federation-code-first/posts-application/src/posts/posts.resolver.ts
@@ -9,13 +9,14 @@ import {
 import { Post } from './models/post.model';
 import { User } from './models/user.model';
 import { PostsService } from './posts.service';
+import { ParseIntPipe } from '@nestjs/common';
 
 @Resolver((of) => Post)
 export class PostsResolver {
   constructor(private readonly postsService: PostsService) {}
 
   @Query((returns) => Post)
-  post(@Args({ name: 'id', type: () => ID }) id: number): Post {
+  post(@Args({ name: 'id', type: () => ID }, ParseIntPipe) id: number): Post {
     return this.postsService.findOne(id);
   }
 
diff --git a/sample/31-graphql-federation-code-first/posts-application/tsconfig.json b/sample/31-graphql-federation-code-first/posts-application/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/31-graphql-federation-code-first/posts-application/tsconfig.json
+++ b/sample/31-graphql-federation-code-first/posts-application/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/31-graphql-federation-code-first/users-application/README.md b/sample/31-graphql-federation-code-first/users-application/README.md
index 9fe8812ff..78eec602a 100644
--- a/sample/31-graphql-federation-code-first/users-application/README.md
+++ b/sample/31-graphql-federation-code-first/users-application/README.md
@@ -1,11 +1,11 @@
 <p align="center">
-  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo_text.svg" width="320" alt="Nest Logo" /></a>
+  <a href="https://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
 </p>
 
 [circleci-image]: https://img.shields.io/circleci/build/github/nestjs/nest/master?token=abc123def456
 [circleci-url]: https://circleci.com/gh/nestjs/nest
 
-  <p align="center">A progressive <a href="http://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>
+  <p align="center">A progressive <a href="https://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>
     <p align="center">
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/v/@nestjs/core.svg" alt="NPM Version" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
diff --git a/sample/31-graphql-federation-code-first/users-application/package-lock.json b/sample/31-graphql-federation-code-first/users-application/package-lock.json
index 21700057e..a16d9303a 100644
Binary files a/sample/31-graphql-federation-code-first/users-application/package-lock.json and b/sample/31-graphql-federation-code-first/users-application/package-lock.json differ
diff --git a/sample/31-graphql-federation-code-first/users-application/package.json b/sample/31-graphql-federation-code-first/users-application/package.json
index 648cc86b7..adec1a8d3 100644
--- a/sample/31-graphql-federation-code-first/users-application/package.json
+++ b/sample/31-graphql-federation-code-first/users-application/package.json
@@ -1,8 +1,7 @@
 {
   "name": "users-application",
   "version": "1.0.0",
-  "description": "",
-  "author": "Flusinerd",
+  "description": "Nest TypeScript starter repository",
   "license": "MIT",
   "scripts": {
     "prebuild": "rimraf dist",
@@ -20,42 +19,43 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@apollo/federation": "0.33.9",
-    "@apollo/gateway": "0.46.0",
-    "@apollo/subgraph": "0.1.5",
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/graphql": "9.1.2",
-    "@nestjs/platform-express": "8.2.3",
-    "apollo-server-express": "3.6.1",
-    "graphql": "15.7.2",
-    "graphql-tools": "7.0.5",
-    "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0",
-    "ts-morph": "12.2.0"
+    "@apollo/gateway": "2.9.0",
+    "@apollo/server": "4.9.3",
+    "@apollo/subgraph": "2.2.3",
+    "@nestjs/apollo": "12.0.11",
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/graphql": "12.0.11",
+    "@nestjs/platform-express": "10.4.10",
+    "graphql": "16.8.1",
+    "graphql-tools": "9.0.0",
+    "reflect-metadata": "0.2.1",
+    "rimraf": "5.0.10",
+    "rxjs": "7.8.1",
+    "ts-morph": "21.0.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.19",
-    "@types/supertest": "2.0.11",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-prettier": "4.0.0",
-    "jest": "27.3.1",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@nestjs/testing": "10.4.10",
+    "@types/express": "4.17.21",
+    "@types/jest": "29.5.12",
+    "@types/node": "20.17.8",
+    "@types/supertest": "6.0.2",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.43.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-prettier": "5.1.3",
+    "jest": "29.7.0",
+    "prettier": "3.2.5",
+    "supertest": "6.3.4",
+    "ts-jest": "29.1.2",
+    "ts-loader": "9.5.1",
+    "ts-node": "10.9.2",
+    "tsconfig-paths": "4.2.0",
+    "typescript": "5.3.3",
+    "webpack": "5.96.1"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/31-graphql-federation-code-first/users-application/src/main.ts b/sample/31-graphql-federation-code-first/users-application/src/main.ts
index 13cad38cf..cdebcd75e 100644
--- a/sample/31-graphql-federation-code-first/users-application/src/main.ts
+++ b/sample/31-graphql-federation-code-first/users-application/src/main.ts
@@ -3,6 +3,6 @@ import { AppModule } from './app.module';
 
 async function bootstrap() {
   const app = await NestFactory.create(AppModule);
-  await app.listen(3000);
+  await app.listen(3002);
 }
 bootstrap();
diff --git a/sample/31-graphql-federation-code-first/users-application/src/users/users.module.ts b/sample/31-graphql-federation-code-first/users-application/src/users/users.module.ts
index f70c88091..10c7a3b33 100644
--- a/sample/31-graphql-federation-code-first/users-application/src/users/users.module.ts
+++ b/sample/31-graphql-federation-code-first/users-application/src/users/users.module.ts
@@ -1,13 +1,20 @@
+import {
+  ApolloFederationDriver,
+  ApolloFederationDriverConfig,
+} from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
-import { GraphQLFederationModule } from '@nestjs/graphql';
+import { GraphQLModule } from '@nestjs/graphql';
 import { UsersResolver } from './users.resolver';
 import { UsersService } from './users.service';
+import { ApolloServerPluginInlineTrace } from '@apollo/server/plugin/inlineTrace';
 
 @Module({
   providers: [UsersResolver, UsersService],
   imports: [
-    GraphQLFederationModule.forRoot({
+    GraphQLModule.forRoot<ApolloFederationDriverConfig>({
+      driver: ApolloFederationDriver,
       autoSchemaFile: true,
+      plugins: [ApolloServerPluginInlineTrace()],
     }),
   ],
 })
diff --git a/sample/31-graphql-federation-code-first/users-application/tsconfig.json b/sample/31-graphql-federation-code-first/users-application/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/31-graphql-federation-code-first/users-application/tsconfig.json
+++ b/sample/31-graphql-federation-code-first/users-application/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/32-graphql-federation-schema-first/README.md b/sample/32-graphql-federation-schema-first/README.md
index 1f3fd3dc1..7a0f47a9d 100644
--- a/sample/32-graphql-federation-schema-first/README.md
+++ b/sample/32-graphql-federation-schema-first/README.md
@@ -4,7 +4,7 @@ A simple example of GraphQL Federation using Schema First approach.
 
 ## Execution
 
-Make sure to start the two sub-graph applications first, then the gatway. Otherwise the gateway won't be able to fetch schemas from the sub-graphs.
+Make sure to start the two sub-graph applications first, then the gateway. Otherwise the gateway won't be able to fetch schemas from the sub-graphs.
 
 ```sh
 cd users-application && npm run start
diff --git a/sample/32-graphql-federation-schema-first/gateway/README.md b/sample/32-graphql-federation-schema-first/gateway/README.md
index 9fe8812ff..78eec602a 100644
--- a/sample/32-graphql-federation-schema-first/gateway/README.md
+++ b/sample/32-graphql-federation-schema-first/gateway/README.md
@@ -1,11 +1,11 @@
 <p align="center">
-  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo_text.svg" width="320" alt="Nest Logo" /></a>
+  <a href="https://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
 </p>
 
 [circleci-image]: https://img.shields.io/circleci/build/github/nestjs/nest/master?token=abc123def456
 [circleci-url]: https://circleci.com/gh/nestjs/nest
 
-  <p align="center">A progressive <a href="http://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>
+  <p align="center">A progressive <a href="https://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>
     <p align="center">
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/v/@nestjs/core.svg" alt="NPM Version" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
diff --git a/sample/32-graphql-federation-schema-first/gateway/package-lock.json b/sample/32-graphql-federation-schema-first/gateway/package-lock.json
index f476cfe72..d55364a69 100644
Binary files a/sample/32-graphql-federation-schema-first/gateway/package-lock.json and b/sample/32-graphql-federation-schema-first/gateway/package-lock.json differ
diff --git a/sample/32-graphql-federation-schema-first/gateway/package.json b/sample/32-graphql-federation-schema-first/gateway/package.json
index b8e4cf110..eedee9a68 100644
--- a/sample/32-graphql-federation-schema-first/gateway/package.json
+++ b/sample/32-graphql-federation-schema-first/gateway/package.json
@@ -21,40 +21,41 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@apollo/gateway": "0.46.0",
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/graphql": "9.1.2",
-    "@nestjs/platform-express": "8.2.3",
-    "apollo-server-express": "3.6.1",
-    "graphql": "15.7.2",
-    "graphql-tools": "7.0.5",
-    "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0",
-    "ts-morph": "12.2.0"
+    "@apollo/gateway": "2.4.8",
+    "@apollo/server": "^4.7.4",
+    "@nestjs/apollo": "12.0.11",
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/graphql": "12.0.11",
+    "@nestjs/platform-express": "10.4.10",
+    "graphql": "16.8.1",
+    "graphql-tools": "9.0.0",
+    "reflect-metadata": "0.2.1",
+    "rimraf": "5.0.10",
+    "rxjs": "7.8.1",
+    "ts-morph": "21.0.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.19",
-    "@types/supertest": "2.0.11",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-prettier": "4.0.0",
-    "jest": "27.3.1",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@nestjs/testing": "10.4.10",
+    "@types/express": "4.17.21",
+    "@types/jest": "29.5.12",
+    "@types/node": "20.17.8",
+    "@types/supertest": "6.0.2",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.42.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-prettier": "5.1.3",
+    "jest": "29.7.0",
+    "prettier": "3.2.5",
+    "supertest": "6.3.4",
+    "ts-jest": "29.1.2",
+    "ts-loader": "9.5.1",
+    "ts-node": "10.9.2",
+    "tsconfig-paths": "4.2.0",
+    "typescript": "5.3.3"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/32-graphql-federation-schema-first/gateway/src/app.module.ts b/sample/32-graphql-federation-schema-first/gateway/src/app.module.ts
index c07abd63e..8c6c39d1e 100644
--- a/sample/32-graphql-federation-schema-first/gateway/src/app.module.ts
+++ b/sample/32-graphql-federation-schema-first/gateway/src/app.module.ts
@@ -1,19 +1,21 @@
+import { IntrospectAndCompose } from '@apollo/gateway';
+import { ApolloGatewayDriver, ApolloGatewayDriverConfig } from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
+import { GraphQLModule } from '@nestjs/graphql';
 import { AppController } from './app.controller';
 import { AppService } from './app.service';
-import { GraphQLGatewayModule } from '@nestjs/graphql';
 
 @Module({
   imports: [
-    GraphQLGatewayModule.forRoot({
-      server: {
-        cors: true,
-      },
+    GraphQLModule.forRoot<ApolloGatewayDriverConfig>({
+      driver: ApolloGatewayDriver,
       gateway: {
-        serviceList: [
-          { name: 'users', url: 'http://localhost:3000/graphql' },
-          { name: 'posts', url: 'http://localhost:3001/graphql' },
-        ],
+        supergraphSdl: new IntrospectAndCompose({
+          subgraphs: [
+            { name: 'users', url: 'http://localhost:3000/graphql' },
+            { name: 'posts', url: 'http://localhost:3001/graphql' },
+          ],
+        }),
       },
     }),
   ],
diff --git a/sample/32-graphql-federation-schema-first/gateway/tsconfig.json b/sample/32-graphql-federation-schema-first/gateway/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/32-graphql-federation-schema-first/gateway/tsconfig.json
+++ b/sample/32-graphql-federation-schema-first/gateway/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/32-graphql-federation-schema-first/posts-application/README.md b/sample/32-graphql-federation-schema-first/posts-application/README.md
index 9fe8812ff..78eec602a 100644
--- a/sample/32-graphql-federation-schema-first/posts-application/README.md
+++ b/sample/32-graphql-federation-schema-first/posts-application/README.md
@@ -1,11 +1,11 @@
 <p align="center">
-  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo_text.svg" width="320" alt="Nest Logo" /></a>
+  <a href="https://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
 </p>
 
 [circleci-image]: https://img.shields.io/circleci/build/github/nestjs/nest/master?token=abc123def456
 [circleci-url]: https://circleci.com/gh/nestjs/nest
 
-  <p align="center">A progressive <a href="http://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>
+  <p align="center">A progressive <a href="https://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>
     <p align="center">
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/v/@nestjs/core.svg" alt="NPM Version" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
diff --git a/sample/32-graphql-federation-schema-first/posts-application/package-lock.json b/sample/32-graphql-federation-schema-first/posts-application/package-lock.json
index e7a108a63..734df068c 100644
Binary files a/sample/32-graphql-federation-schema-first/posts-application/package-lock.json and b/sample/32-graphql-federation-schema-first/posts-application/package-lock.json differ
diff --git a/sample/32-graphql-federation-schema-first/posts-application/package.json b/sample/32-graphql-federation-schema-first/posts-application/package.json
index 4ec6c7d53..cf1e51312 100644
--- a/sample/32-graphql-federation-schema-first/posts-application/package.json
+++ b/sample/32-graphql-federation-schema-first/posts-application/package.json
@@ -21,42 +21,42 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@apollo/federation": "0.33.9",
-    "@apollo/gateway": "0.46.0",
-    "@apollo/subgraph": "0.1.5",
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/graphql": "9.1.2",
-    "@nestjs/platform-express": "8.2.3",
-    "apollo-server-express": "3.6.1",
-    "graphql": "15.7.2",
-    "graphql-tools": "7.0.5",
-    "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0",
-    "ts-morph": "12.2.0"
+    "@apollo/gateway": "2.4.8",
+    "@apollo/server": "^4.7.4",
+    "@apollo/subgraph": "2.4.8",
+    "@nestjs/apollo": "12.0.11",
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/graphql": "12.0.11",
+    "@nestjs/platform-express": "10.4.10",
+    "graphql": "16.8.1",
+    "graphql-tools": "9.0.0",
+    "reflect-metadata": "0.2.1",
+    "rimraf": "5.0.10",
+    "rxjs": "7.8.1",
+    "ts-morph": "21.0.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.19",
-    "@types/supertest": "2.0.11",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-prettier": "4.0.0",
-    "jest": "27.3.1",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@nestjs/testing": "10.4.10",
+    "@types/express": "4.17.21",
+    "@types/jest": "29.5.12",
+    "@types/node": "20.17.8",
+    "@types/supertest": "6.0.2",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.42.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-prettier": "5.1.3",
+    "jest": "29.7.0",
+    "prettier": "3.2.5",
+    "supertest": "6.3.4",
+    "ts-jest": "29.1.2",
+    "ts-loader": "9.5.1",
+    "ts-node": "10.9.2",
+    "tsconfig-paths": "4.2.0",
+    "typescript": "5.3.3"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/32-graphql-federation-schema-first/posts-application/src/posts/posts.module.ts b/sample/32-graphql-federation-schema-first/posts-application/src/posts/posts.module.ts
index 8c34378d7..2254d715d 100644
--- a/sample/32-graphql-federation-schema-first/posts-application/src/posts/posts.module.ts
+++ b/sample/32-graphql-federation-schema-first/posts-application/src/posts/posts.module.ts
@@ -1,12 +1,17 @@
+import {
+  ApolloFederationDriver,
+  ApolloFederationDriverConfig,
+} from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
-import { GraphQLFederationModule } from '@nestjs/graphql';
+import { GraphQLModule } from '@nestjs/graphql';
 import { PostsResolver } from './posts.resolver';
 import { PostsService } from './posts.service';
 import { UsersResolver } from './users.resolver';
 
 @Module({
   imports: [
-    GraphQLFederationModule.forRoot({
+    GraphQLModule.forRoot<ApolloFederationDriverConfig>({
+      driver: ApolloFederationDriver,
       typePaths: ['**/*.graphql'],
     }),
   ],
diff --git a/sample/32-graphql-federation-schema-first/posts-application/tsconfig.json b/sample/32-graphql-federation-schema-first/posts-application/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/32-graphql-federation-schema-first/posts-application/tsconfig.json
+++ b/sample/32-graphql-federation-schema-first/posts-application/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/32-graphql-federation-schema-first/users-application/README.md b/sample/32-graphql-federation-schema-first/users-application/README.md
index 9fe8812ff..78eec602a 100644
--- a/sample/32-graphql-federation-schema-first/users-application/README.md
+++ b/sample/32-graphql-federation-schema-first/users-application/README.md
@@ -1,11 +1,11 @@
 <p align="center">
-  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo_text.svg" width="320" alt="Nest Logo" /></a>
+  <a href="https://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
 </p>
 
 [circleci-image]: https://img.shields.io/circleci/build/github/nestjs/nest/master?token=abc123def456
 [circleci-url]: https://circleci.com/gh/nestjs/nest
 
-  <p align="center">A progressive <a href="http://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>
+  <p align="center">A progressive <a href="https://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>
     <p align="center">
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/v/@nestjs/core.svg" alt="NPM Version" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
diff --git a/sample/32-graphql-federation-schema-first/users-application/package-lock.json b/sample/32-graphql-federation-schema-first/users-application/package-lock.json
index 21700057e..cf59ad565 100644
Binary files a/sample/32-graphql-federation-schema-first/users-application/package-lock.json and b/sample/32-graphql-federation-schema-first/users-application/package-lock.json differ
diff --git a/sample/32-graphql-federation-schema-first/users-application/package.json b/sample/32-graphql-federation-schema-first/users-application/package.json
index 648cc86b7..401e8ad61 100644
--- a/sample/32-graphql-federation-schema-first/users-application/package.json
+++ b/sample/32-graphql-federation-schema-first/users-application/package.json
@@ -20,42 +20,42 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@apollo/federation": "0.33.9",
-    "@apollo/gateway": "0.46.0",
-    "@apollo/subgraph": "0.1.5",
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/graphql": "9.1.2",
-    "@nestjs/platform-express": "8.2.3",
-    "apollo-server-express": "3.6.1",
-    "graphql": "15.7.2",
-    "graphql-tools": "7.0.5",
-    "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0",
-    "ts-morph": "12.2.0"
+    "@apollo/gateway": "2.4.8",
+    "@apollo/server": "^4.7.4",
+    "@apollo/subgraph": "2.4.8",
+    "@nestjs/apollo": "12.0.11",
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/graphql": "12.0.11",
+    "@nestjs/platform-express": "10.4.10",
+    "graphql": "16.8.1",
+    "graphql-tools": "9.0.0",
+    "reflect-metadata": "0.2.1",
+    "rimraf": "5.0.10",
+    "rxjs": "7.8.1",
+    "ts-morph": "21.0.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.19",
-    "@types/supertest": "2.0.11",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-prettier": "4.0.0",
-    "jest": "27.3.1",
-    "prettier": "2.5.1",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@nestjs/testing": "10.4.10",
+    "@types/express": "4.17.21",
+    "@types/jest": "29.5.12",
+    "@types/node": "20.17.8",
+    "@types/supertest": "6.0.2",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.42.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-prettier": "5.1.3",
+    "jest": "29.7.0",
+    "prettier": "3.2.5",
+    "supertest": "6.3.4",
+    "ts-jest": "29.1.2",
+    "ts-loader": "9.5.1",
+    "ts-node": "10.9.2",
+    "tsconfig-paths": "4.2.0",
+    "typescript": "5.3.3"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/32-graphql-federation-schema-first/users-application/src/users/users.module.ts b/sample/32-graphql-federation-schema-first/users-application/src/users/users.module.ts
index e4a70b139..d98abacac 100644
--- a/sample/32-graphql-federation-schema-first/users-application/src/users/users.module.ts
+++ b/sample/32-graphql-federation-schema-first/users-application/src/users/users.module.ts
@@ -1,12 +1,17 @@
+import {
+  ApolloFederationDriver,
+  ApolloFederationDriverConfig,
+} from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
-import { GraphQLFederationModule } from '@nestjs/graphql';
+import { GraphQLModule } from '@nestjs/graphql';
 import { UsersResolver } from './users.resolver';
 import { UsersService } from './users.service';
 
 @Module({
   providers: [UsersResolver, UsersService],
   imports: [
-    GraphQLFederationModule.forRoot({
+    GraphQLModule.forRoot<ApolloFederationDriverConfig>({
+      driver: ApolloFederationDriver,
       typePaths: ['**/*.graphql'],
     }),
   ],
diff --git a/sample/32-graphql-federation-schema-first/users-application/tsconfig.json b/sample/32-graphql-federation-schema-first/users-application/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/32-graphql-federation-schema-first/users-application/tsconfig.json
+++ b/sample/32-graphql-federation-schema-first/users-application/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/.eslintrc.js b/sample/33-graphql-mercurius/.eslintrc.js
similarity index 77%
rename from .eslintrc.js
rename to sample/33-graphql-mercurius/.eslintrc.js
index 280fe9a37..284719548 100644
--- a/.eslintrc.js
+++ b/sample/33-graphql-mercurius/.eslintrc.js
@@ -13,13 +13,11 @@ module.exports = {
   root: true,
   env: {
     node: true,
+    jest: true,
   },
   rules: {
     '@typescript-eslint/interface-name-prefix': 'off',
     '@typescript-eslint/explicit-function-return-type': 'off',
     '@typescript-eslint/no-explicit-any': 'off',
-    '@typescript-eslint/explicit-module-boundary-types': 'off',
-    '@typescript-eslint/no-unused-vars': 'off',
-    '@typescript-eslint/ban-types': 'off',
   },
 };
diff --git a/sample/33-graphql-mercurius/.gitignore b/sample/33-graphql-mercurius/.gitignore
new file mode 100644
index 000000000..b5e5f9755
--- /dev/null
+++ b/sample/33-graphql-mercurius/.gitignore
@@ -0,0 +1,21 @@
+# dependencies
+/node_modules
+
+# IDE
+/.idea
+/.awcache
+/.vscode
+
+# misc
+npm-debug.log
+
+# example
+/quick-start
+
+# tests
+/test
+/coverage
+/.nyc_output
+
+# dist
+/dist
\ No newline at end of file
diff --git a/sample/33-graphql-mercurius/nest-cli.json b/sample/33-graphql-mercurius/nest-cli.json
new file mode 100644
index 000000000..095fdb25b
--- /dev/null
+++ b/sample/33-graphql-mercurius/nest-cli.json
@@ -0,0 +1,12 @@
+{
+  "compilerOptions": {
+    "plugins": [
+      {
+        "name": "@nestjs/graphql",
+        "options": {
+          "introspectComments": true
+        }
+      }
+    ]
+  }
+}
diff --git a/sample/33-graphql-mercurius/package-lock.json b/sample/33-graphql-mercurius/package-lock.json
new file mode 100644
index 000000000..5cb9d7af8
Binary files /dev/null and b/sample/33-graphql-mercurius/package-lock.json differ
diff --git a/sample/33-graphql-mercurius/package.json b/sample/33-graphql-mercurius/package.json
new file mode 100644
index 000000000..dd3bd31a8
--- /dev/null
+++ b/sample/33-graphql-mercurius/package.json
@@ -0,0 +1,55 @@
+{
+  "name": "nest-typescript-starter",
+  "version": "1.0.0",
+  "description": "Nest TypeScript starter repository",
+  "license": "MIT",
+  "scripts": {
+    "prebuild": "rimraf dist",
+    "build": "nest build",
+    "format": "prettier --write \"src/**/*.ts\" \"test/**/*.ts\"",
+    "start": "nest start",
+    "start:dev": "nest start --watch",
+    "start:debug": "nest start --debug --watch",
+    "start:prod": "node dist/main",
+    "lint": "eslint '{src,apps,libs,test}/**/*.ts' --fix",
+    "test": "jest",
+    "test:watch": "jest --watch",
+    "test:cov": "jest --coverage",
+    "test:debug": "node --inspect-brk -r tsconfig-paths/register -r ts-node/register node_modules/.bin/jest --runInBand",
+    "test:e2e": "echo 'No e2e tests implemented yet.'"
+  },
+  "dependencies": {
+    "@nestjs/common": "10.4.10",
+    "@nestjs/core": "10.4.10",
+    "@nestjs/graphql": "12.0.11",
+    "@nestjs/mercurius": "12.0.11",
+    "@nestjs/platform-fastify": "10.4.10",
+    "class-transformer": "0.5.1",
+    "class-validator": "0.14.1",
+    "graphql": "16.8.1",
+    "mercurius": "14.1.0",
+    "reflect-metadata": "0.2.1",
+    "rxjs": "7.8.1"
+  },
+  "devDependencies": {
+    "@nestjs/cli": "10.4.8",
+    "@nestjs/schematics": "10.2.3",
+    "@nestjs/testing": "10.4.10",
+    "@types/express": "4.17.21",
+    "@types/node": "20.17.8",
+    "@types/supertest": "6.0.2",
+    "jest": "29.7.0",
+    "prettier": "3.2.5",
+    "supertest": "6.3.4",
+    "ts-jest": "29.1.2",
+    "ts-loader": "9.5.1",
+    "ts-node": "10.9.2",
+    "tsconfig-paths": "4.2.0",
+    "@typescript-eslint/eslint-plugin": "5.62.0",
+    "@typescript-eslint/parser": "5.62.0",
+    "eslint": "8.42.0",
+    "eslint-config-prettier": "9.1.0",
+    "eslint-plugin-import": "2.29.1",
+    "typescript": "5.3.3"
+  }
+}
diff --git a/sample/33-graphql-mercurius/schema.gql b/sample/33-graphql-mercurius/schema.gql
new file mode 100644
index 000000000..e11c56434
--- /dev/null
+++ b/sample/33-graphql-mercurius/schema.gql
@@ -0,0 +1,35 @@
+# ------------------------------------------------------
+# THIS FILE WAS AUTOMATICALLY GENERATED (DO NOT MODIFY)
+# ------------------------------------------------------
+
+"""recipe """
+type Recipe {
+  id: ID!
+  title: String!
+  description: String
+  creationDate: Date!
+  ingredients: [String!]!
+}
+
+"""Date custom scalar type"""
+scalar Date
+
+type Query {
+  recipe(id: String!): Recipe!
+  recipes(skip: Int = 0, take: Int = 25): [Recipe!]!
+}
+
+type Mutation {
+  addRecipe(newRecipeData: NewRecipeInput!): Recipe!
+  removeRecipe(id: String!): Boolean!
+}
+
+input NewRecipeInput {
+  title: String!
+  description: String
+  ingredients: [String!]!
+}
+
+type Subscription {
+  recipeAdded: Recipe!
+}
\ No newline at end of file
diff --git a/sample/33-graphql-mercurius/src/app.module.ts b/sample/33-graphql-mercurius/src/app.module.ts
new file mode 100644
index 000000000..53cc6458e
--- /dev/null
+++ b/sample/33-graphql-mercurius/src/app.module.ts
@@ -0,0 +1,17 @@
+import { Module } from '@nestjs/common';
+import { GraphQLModule } from '@nestjs/graphql';
+import { MercuriusDriver, MercuriusDriverConfig } from '@nestjs/mercurius';
+import { RecipesModule } from './recipes/recipes.module';
+
+@Module({
+  imports: [
+    RecipesModule,
+    GraphQLModule.forRoot<MercuriusDriverConfig>({
+      driver: MercuriusDriver,
+      autoSchemaFile: 'schema.gql',
+      subscription: true,
+      graphiql: true,
+    }),
+  ],
+})
+export class AppModule {}
diff --git a/sample/33-graphql-mercurius/src/common/scalars/date.scalar.ts b/sample/33-graphql-mercurius/src/common/scalars/date.scalar.ts
new file mode 100644
index 000000000..38290dcc8
--- /dev/null
+++ b/sample/33-graphql-mercurius/src/common/scalars/date.scalar.ts
@@ -0,0 +1,22 @@
+import { CustomScalar, Scalar } from '@nestjs/graphql';
+import { Kind, ValueNode } from 'graphql';
+
+@Scalar('Date', type => Date)
+export class DateScalar implements CustomScalar<number, Date> {
+  description = 'Date custom scalar type';
+
+  parseValue(value: number): Date {
+    return new Date(value); // value from the client
+  }
+
+  serialize(value: Date): number {
+    return value.getTime(); // value sent to the client
+  }
+
+  parseLiteral(ast: ValueNode): Date {
+    if (ast.kind === Kind.INT) {
+      return new Date(ast.value);
+    }
+    return null;
+  }
+}
diff --git a/sample/33-graphql-mercurius/src/main.ts b/sample/33-graphql-mercurius/src/main.ts
new file mode 100644
index 000000000..8e7886667
--- /dev/null
+++ b/sample/33-graphql-mercurius/src/main.ts
@@ -0,0 +1,13 @@
+import { ValidationPipe } from '@nestjs/common';
+import { NestFactory } from '@nestjs/core';
+import { FastifyAdapter } from '@nestjs/platform-fastify';
+import { AppModule } from './app.module';
+
+async function bootstrap() {
+  const app = await NestFactory.create(AppModule, new FastifyAdapter());
+  app.useGlobalPipes(new ValidationPipe());
+
+  await app.listen(3000);
+  console.log(`Application is running on: ${await app.getUrl()}`);
+}
+bootstrap();
diff --git a/sample/33-graphql-mercurius/src/recipes/dto/new-recipe.input.ts b/sample/33-graphql-mercurius/src/recipes/dto/new-recipe.input.ts
new file mode 100644
index 000000000..79645888c
--- /dev/null
+++ b/sample/33-graphql-mercurius/src/recipes/dto/new-recipe.input.ts
@@ -0,0 +1,17 @@
+import { Field, InputType } from '@nestjs/graphql';
+import { IsOptional, Length, MaxLength } from 'class-validator';
+
+@InputType()
+export class NewRecipeInput {
+  @Field()
+  @MaxLength(30)
+  title: string;
+
+  @Field({ nullable: true })
+  @IsOptional()
+  @Length(30, 255)
+  description?: string;
+
+  @Field(type => [String])
+  ingredients: string[];
+}
diff --git a/sample/33-graphql-mercurius/src/recipes/dto/recipes.args.ts b/sample/33-graphql-mercurius/src/recipes/dto/recipes.args.ts
new file mode 100644
index 000000000..9bce0582f
--- /dev/null
+++ b/sample/33-graphql-mercurius/src/recipes/dto/recipes.args.ts
@@ -0,0 +1,14 @@
+import { ArgsType, Field, Int } from '@nestjs/graphql';
+import { Max, Min } from 'class-validator';
+
+@ArgsType()
+export class RecipesArgs {
+  @Field(type => Int)
+  @Min(0)
+  skip = 0;
+
+  @Field(type => Int)
+  @Min(1)
+  @Max(50)
+  take = 25;
+}
diff --git a/sample/33-graphql-mercurius/src/recipes/models/recipe.model.ts b/sample/33-graphql-mercurius/src/recipes/models/recipe.model.ts
new file mode 100644
index 000000000..2193b2310
--- /dev/null
+++ b/sample/33-graphql-mercurius/src/recipes/models/recipe.model.ts
@@ -0,0 +1,19 @@
+import { Field, ID, ObjectType } from '@nestjs/graphql';
+
+@ObjectType({ description: 'recipe ' })
+export class Recipe {
+  @Field(type => ID)
+  id: string;
+
+  @Field()
+  title: string;
+
+  @Field({ nullable: true })
+  description?: string;
+
+  @Field()
+  creationDate: Date;
+
+  @Field(type => [String])
+  ingredients: string[];
+}
diff --git a/sample/33-graphql-mercurius/src/recipes/recipes.module.ts b/sample/33-graphql-mercurius/src/recipes/recipes.module.ts
new file mode 100644
index 000000000..fd2d2cc95
--- /dev/null
+++ b/sample/33-graphql-mercurius/src/recipes/recipes.module.ts
@@ -0,0 +1,9 @@
+import { Module } from '@nestjs/common';
+import { DateScalar } from '../common/scalars/date.scalar';
+import { RecipesResolver } from './recipes.resolver';
+import { RecipesService } from './recipes.service';
+
+@Module({
+  providers: [RecipesResolver, RecipesService, DateScalar],
+})
+export class RecipesModule {}
diff --git a/sample/33-graphql-mercurius/src/recipes/recipes.resolver.ts b/sample/33-graphql-mercurius/src/recipes/recipes.resolver.ts
new file mode 100644
index 000000000..5b42038fc
--- /dev/null
+++ b/sample/33-graphql-mercurius/src/recipes/recipes.resolver.ts
@@ -0,0 +1,53 @@
+import { NotFoundException } from '@nestjs/common';
+import {
+  Args,
+  Context,
+  Mutation,
+  Query,
+  Resolver,
+  Subscription,
+} from '@nestjs/graphql';
+import { PubSub } from 'mercurius';
+import { NewRecipeInput } from './dto/new-recipe.input';
+import { RecipesArgs } from './dto/recipes.args';
+import { Recipe } from './models/recipe.model';
+import { RecipesService } from './recipes.service';
+
+@Resolver(of => Recipe)
+export class RecipesResolver {
+  constructor(private readonly recipesService: RecipesService) {}
+
+  @Query(returns => Recipe)
+  async recipe(@Args('id') id: string): Promise<Recipe> {
+    const recipe = await this.recipesService.findOneById(id);
+    if (!recipe) {
+      throw new NotFoundException(id);
+    }
+    return recipe;
+  }
+
+  @Query(returns => [Recipe])
+  recipes(@Args() recipesArgs: RecipesArgs): Promise<Recipe[]> {
+    return this.recipesService.findAll(recipesArgs);
+  }
+
+  @Mutation(returns => Recipe)
+  async addRecipe(
+    @Args('newRecipeData') newRecipeData: NewRecipeInput,
+    @Context('pubsub') pubSub: PubSub,
+  ): Promise<Recipe> {
+    const recipe = await this.recipesService.create(newRecipeData);
+    pubSub.publish({ topic: 'recipeAdded', payload: { recipeAdded: recipe } });
+    return recipe;
+  }
+
+  @Mutation(returns => Boolean)
+  async removeRecipe(@Args('id') id: string) {
+    return this.recipesService.remove(id);
+  }
+
+  @Subscription(returns => Recipe)
+  recipeAdded(@Context('pubsub') pubSub: PubSub) {
+    return pubSub.subscribe('recipeAdded');
+  }
+}
diff --git a/sample/33-graphql-mercurius/src/recipes/recipes.service.ts b/sample/33-graphql-mercurius/src/recipes/recipes.service.ts
new file mode 100644
index 000000000..a4d6428eb
--- /dev/null
+++ b/sample/33-graphql-mercurius/src/recipes/recipes.service.ts
@@ -0,0 +1,29 @@
+import { Injectable } from '@nestjs/common';
+import { NewRecipeInput } from './dto/new-recipe.input';
+import { RecipesArgs } from './dto/recipes.args';
+import { Recipe } from './models/recipe.model';
+
+@Injectable()
+export class RecipesService {
+  /**
+   * MOCK
+   * Put some real business logic here
+   * Left for demonstration purposes
+   */
+
+  async create(data: NewRecipeInput): Promise<Recipe> {
+    return {} as any;
+  }
+
+  async findOneById(id: string): Promise<Recipe> {
+    return {} as any;
+  }
+
+  async findAll(recipesArgs: RecipesArgs): Promise<Recipe[]> {
+    return [] as Recipe[];
+  }
+
+  async remove(id: string): Promise<boolean> {
+    return true;
+  }
+}
diff --git a/sample/33-graphql-mercurius/tsconfig.build.json b/sample/33-graphql-mercurius/tsconfig.build.json
new file mode 100644
index 000000000..2fe1df273
--- /dev/null
+++ b/sample/33-graphql-mercurius/tsconfig.build.json
@@ -0,0 +1,4 @@
+{
+  "extends": "./tsconfig.json",
+  "exclude": ["node_modules", "dist", "test", "**/*spec.ts"]
+}
diff --git a/sample/33-graphql-mercurius/tsconfig.json b/sample/33-graphql-mercurius/tsconfig.json
new file mode 100644
index 000000000..d9c82ca97
--- /dev/null
+++ b/sample/33-graphql-mercurius/tsconfig.json
@@ -0,0 +1,17 @@
+{
+  "compilerOptions": {
+    "module": "commonjs",
+    "declaration": true,
+    "removeComments": true,
+    "emitDecoratorMetadata": true,
+    "experimentalDecorators": true,
+    "allowSyntheticDefaultImports": true,
+    "target": "ES2021",
+    "sourceMap": true,
+    "outDir": "./dist",
+    "baseUrl": "./",
+    "incremental": true,
+    "skipLibCheck": true
+  },
+  "include": ["src/**/*"]
+}
diff --git a/sample/34-using-esm-packages/.eslintrc.js b/sample/34-using-esm-packages/.eslintrc.js
new file mode 100644
index 000000000..259de13c7
--- /dev/null
+++ b/sample/34-using-esm-packages/.eslintrc.js
@@ -0,0 +1,25 @@
+module.exports = {
+  parser: '@typescript-eslint/parser',
+  parserOptions: {
+    project: 'tsconfig.json',
+    tsconfigRootDir: __dirname,
+    sourceType: 'module',
+  },
+  plugins: ['@typescript-eslint/eslint-plugin'],
+  extends: [
+    'plugin:@typescript-eslint/recommended',
+    'plugin:prettier/recommended',
+  ],
+  root: true,
+  env: {
+    node: true,
+    jest: true,
+  },
+  ignorePatterns: ['.eslintrc.js'],
+  rules: {
+    '@typescript-eslint/interface-name-prefix': 'off',
+    '@typescript-eslint/explicit-function-return-type': 'off',
+    '@typescript-eslint/explicit-module-boundary-types': 'off',
+    '@typescript-eslint/no-explicit-any': 'off',
+  },
+};
diff --git a/sample/34-using-esm-packages/.gitignore b/sample/34-using-esm-packages/.gitignore
new file mode 100644
index 000000000..4b56acfbe
--- /dev/null
+++ b/sample/34-using-esm-packages/.gitignore
@@ -0,0 +1,56 @@
+# compiled output
+/dist
+/node_modules
+/build
+
+# Logs
+logs
+*.log
+npm-debug.log*
+pnpm-debug.log*
+yarn-debug.log*
+yarn-error.log*
+lerna-debug.log*
+
+# OS
+.DS_Store
+
+# Tests
+/coverage
+/.nyc_output
+
+# IDEs and editors
+/.idea
+.project
+.classpath
+.c9/
+*.launch
+.settings/
+*.sublime-workspace
+
+# IDE - VSCode
+.vscode/*
+!.vscode/settings.json
+!.vscode/tasks.json
+!.vscode/launch.json
+!.vscode/extensions.json
+
+# dotenv environment variable files
+.env
+.env.development.local
+.env.test.local
+.env.production.local
+.env.local
+
+# temp directory
+.temp
+.tmp
+
+# Runtime data
+pids
+*.pid
+*.seed
+*.pid.lock
+
+# Diagnostic reports (https://nodejs.org/api/report.html)
+report.[0-9]*.[0-9]*.[0-9]*.[0-9]*.json
diff --git a/sample/34-using-esm-packages/.prettierrc b/sample/34-using-esm-packages/.prettierrc
new file mode 100644
index 000000000..dcb72794f
--- /dev/null
+++ b/sample/34-using-esm-packages/.prettierrc
@@ -0,0 +1,4 @@
+{
+  "singleQuote": true,
+  "trailingComma": "all"
+}
\ No newline at end of file
diff --git a/sample/34-using-esm-packages/README.md b/sample/34-using-esm-packages/README.md
new file mode 100644
index 000000000..f7bab1901
--- /dev/null
+++ b/sample/34-using-esm-packages/README.md
@@ -0,0 +1,6 @@
+## About using ESM with Jest
+
+We are using the `--experimental-vm-modules` NodeJS v18 flag as explained at https://jestjs.io/docs/ecmascript-modules
+
+You can see how to mock an ESM package at [`app.controller.spec.ts`](./src/app.controller.spec.ts)  
+You can see how that the real import of an ESM package is working at [`app.e2e-spec.ts`](./test/app.e2e-spec.ts)
\ No newline at end of file
diff --git a/sample/34-using-esm-packages/nest-cli.json b/sample/34-using-esm-packages/nest-cli.json
new file mode 100644
index 000000000..f9aa683b1
--- /dev/null
+++ b/sample/34-using-esm-packages/nest-cli.json
@@ -0,0 +1,8 @@
+{
+  "$schema": "https://json.schemastore.org/nest-cli",
+  "collection": "@nestjs/schematics",
+  "sourceRoot": "src",
+  "compilerOptions": {
+    "deleteOutDir": true
+  }
+}
diff --git a/sample/34-using-esm-packages/package-lock.json b/sample/34-using-esm-packages/package-lock.json
new file mode 100644
index 000000000..c9d06ac77
Binary files /dev/null and b/sample/34-using-esm-packages/package-lock.json differ
diff --git a/sample/34-using-esm-packages/package.json b/sample/34-using-esm-packages/package.json
new file mode 100644
index 000000000..dc0ff125e
--- /dev/null
+++ b/sample/34-using-esm-packages/package.json
@@ -0,0 +1,75 @@
+{
+  "name": "34-using-esm-packages",
+  "version": "0.0.1",
+  "description": "",
+  "author": "",
+  "private": true,
+  "license": "UNLICENSED",
+  "type": "commonjs",
+  "engines": {
+    "node": ">=18.8"
+  },
+  "scripts": {
+    "build": "nest build",
+    "format": "prettier --write \"src/**/*.ts\" \"test/**/*.ts\"",
+    "start": "nest start",
+    "start:dev": "nest start --watch",
+    "start:debug": "nest start --debug --watch",
+    "start:prod": "node dist/main",
+    "lint": "eslint \"{src,apps,libs,test}/**/*.ts\" --fix",
+    "test": "NODE_OPTIONS=\"$NODE_OPTIONS --experimental-vm-modules\" jest",
+    "test:watch": "NODE_OPTIONS=\"$NODE_OPTIONS --experimental-vm-modules\" jest --watch",
+    "test:cov": "NODE_OPTIONS=\"$NODE_OPTIONS --experimental-vm-modules\" jest --coverage",
+    "test:debug": "NODE_OPTIONS=\"$NODE_OPTIONS --experimental-vm-modules\" node --inspect-brk -r tsconfig-paths/register -r ts-node/register node_modules/.bin/jest --runInBand",
+    "test:e2e": "NODE_OPTIONS=\"$NODE_OPTIONS --experimental-vm-modules\" jest --config ./test/jest-e2e.json"
+  },
+  "dependencies": {
+    "@nestjs/common": "10.x",
+    "@nestjs/core": "10.x",
+    "@nestjs/platform-express": "10.x",
+    "delay": "6.x",
+    "reflect-metadata": "0.2.0",
+    "rxjs": "7.x",
+    "superjson": "2.x"
+  },
+  "devDependencies": {
+    "@nestjs/cli": "10.x",
+    "@nestjs/schematics": "10.x",
+    "@nestjs/testing": "10.x",
+    "@types/express": "4.x",
+    "@types/jest": "29.x",
+    "@types/node": "20.x",
+    "@types/supertest": "6.x",
+    "@typescript-eslint/eslint-plugin": "8.x",
+    "@typescript-eslint/parser": "8.x",
+    "eslint": "8.x",
+    "eslint-config-prettier": "9.x",
+    "eslint-plugin-prettier": "5.x",
+    "jest": "29.5.0",
+    "prettier": "3.x",
+    "source-map-support": "0.5.21",
+    "supertest": "7.x",
+    "ts-jest": "29.x",
+    "ts-loader": "9.x",
+    "ts-node": "10.x",
+    "tsconfig-paths": "4.x",
+    "typescript": "5.5.x"
+  },
+  "jest": {
+    "moduleFileExtensions": [
+      "js",
+      "json",
+      "ts"
+    ],
+    "rootDir": "src",
+    "testRegex": ".*\\.spec\\.ts$",
+    "transform": {
+      "^.+\\.(t|j)s$": "ts-jest"
+    },
+    "collectCoverageFrom": [
+      "**/*.(t|j)s"
+    ],
+    "coverageDirectory": "../coverage",
+    "testEnvironment": "node"
+  }
+}
diff --git a/sample/34-using-esm-packages/src/app.controller.spec.ts b/sample/34-using-esm-packages/src/app.controller.spec.ts
new file mode 100644
index 000000000..a16820f1e
--- /dev/null
+++ b/sample/34-using-esm-packages/src/app.controller.spec.ts
@@ -0,0 +1,34 @@
+// NOTE: This tests nothing, it's just to show how to mock an ESM package
+import { jest } from '@jest/globals';
+
+// We will test the mocking feature from Jest to mock the `superjson` package for testing purposes
+// We must call this before loading the module!
+jest.unstable_mockModule('superjson', () => ({
+  stringify: () => 'noop',
+}));
+
+import { Test, TestingModule } from '@nestjs/testing';
+import { AppController } from './app.controller';
+import { AppService } from './app.service';
+import { superJSONProvider } from './superjson.provider';
+
+describe('AppController', () => {
+  let appController: AppController;
+
+  beforeEach(async () => {
+    const app: TestingModule = await Test.createTestingModule({
+      controllers: [AppController],
+      providers: [superJSONProvider, AppService],
+    }).compile();
+
+    appController = app.get<AppController>(AppController);
+  });
+
+  describe('root', () => {
+    it('should return the stub object', () => {
+      expect(appController.getHello()).toEqual({
+        jsonString: 'noop',
+      });
+    });
+  });
+});
diff --git a/sample/34-using-esm-packages/src/app.controller.ts b/sample/34-using-esm-packages/src/app.controller.ts
new file mode 100644
index 000000000..62a2f2c83
--- /dev/null
+++ b/sample/34-using-esm-packages/src/app.controller.ts
@@ -0,0 +1,12 @@
+import { Controller, Get } from '@nestjs/common';
+import { AppService } from './app.service';
+
+@Controller()
+export class AppController {
+  constructor(private readonly appService: AppService) {}
+
+  @Get()
+  getHello() {
+    return this.appService.getHello();
+  }
+}
diff --git a/sample/34-using-esm-packages/src/app.module.ts b/sample/34-using-esm-packages/src/app.module.ts
new file mode 100644
index 000000000..534a90ae7
--- /dev/null
+++ b/sample/34-using-esm-packages/src/app.module.ts
@@ -0,0 +1,27 @@
+import { Module, OnModuleInit } from '@nestjs/common';
+import { AppController } from './app.controller';
+import { AppService } from './app.service';
+import { superJSONProvider } from './superjson.provider';
+import { importEsmPackage } from './import-esm-package';
+
+@Module({
+  imports: [],
+  controllers: [AppController],
+  providers: [
+    superJSONProvider, // One way to load the ESM package is turning it into a custom provider
+
+    AppService,
+  ],
+})
+export class AppModule implements OnModuleInit {
+  // This is just to test the 'delay' ESM-only package
+  async onModuleInit() {
+    // Another way to load the ESM package is using our 'import' function directly when we need to use it
+    const delay =
+      await importEsmPackage<typeof import('delay').default>('delay');
+
+    console.time('delay');
+    await delay(1_000);
+    console.timeEnd('delay');
+  }
+}
diff --git a/sample/34-using-esm-packages/src/app.service.ts b/sample/34-using-esm-packages/src/app.service.ts
new file mode 100644
index 000000000..25314aec5
--- /dev/null
+++ b/sample/34-using-esm-packages/src/app.service.ts
@@ -0,0 +1,18 @@
+import { Inject, Injectable } from '@nestjs/common';
+import { superJSONProvider, SuperJSON } from './superjson.provider';
+
+@Injectable()
+export class AppService {
+  constructor(
+    @Inject(superJSONProvider.provide)
+    private readonly superjson: SuperJSON,
+  ) {}
+
+  getHello() {
+    const jsonString = this.superjson.stringify({ big: 10n });
+
+    return {
+      jsonString,
+    };
+  }
+}
diff --git a/sample/34-using-esm-packages/src/import-esm-package.ts b/sample/34-using-esm-packages/src/import-esm-package.ts
new file mode 100644
index 000000000..b69aad199
--- /dev/null
+++ b/sample/34-using-esm-packages/src/import-esm-package.ts
@@ -0,0 +1,10 @@
+/**
+ * This is the same as `import()` expression that is supposed to load ESM packages while
+ * preventing TypeScript from transpiling the import statement into `require()`.
+ */
+export const importEsmPackage = async <ReturnType>(
+  packageName: string,
+): Promise<ReturnType> =>
+  new Function(`return import('${packageName}')`)().then(
+    (loadedModule: unknown) => loadedModule['default'] ?? loadedModule,
+  );
diff --git a/sample/34-using-esm-packages/src/main.ts b/sample/34-using-esm-packages/src/main.ts
new file mode 100644
index 000000000..13cad38cf
--- /dev/null
+++ b/sample/34-using-esm-packages/src/main.ts
@@ -0,0 +1,8 @@
+import { NestFactory } from '@nestjs/core';
+import { AppModule } from './app.module';
+
+async function bootstrap() {
+  const app = await NestFactory.create(AppModule);
+  await app.listen(3000);
+}
+bootstrap();
diff --git a/sample/34-using-esm-packages/src/superjson.provider.ts b/sample/34-using-esm-packages/src/superjson.provider.ts
new file mode 100644
index 000000000..46b53eac2
--- /dev/null
+++ b/sample/34-using-esm-packages/src/superjson.provider.ts
@@ -0,0 +1,10 @@
+import { FactoryProvider } from '@nestjs/common';
+import { importEsmPackage } from './import-esm-package';
+
+// We must expose only the type definition!
+export type { SuperJSON } from 'superjson';
+
+export const superJSONProvider: FactoryProvider = {
+  provide: 'SuperJSON',
+  useFactory: () => importEsmPackage('superjson'),
+};
diff --git a/sample/34-using-esm-packages/test/app.e2e-spec.ts b/sample/34-using-esm-packages/test/app.e2e-spec.ts
new file mode 100644
index 000000000..1a1dcf27c
--- /dev/null
+++ b/sample/34-using-esm-packages/test/app.e2e-spec.ts
@@ -0,0 +1,29 @@
+import { Test, TestingModule } from '@nestjs/testing';
+import { INestApplication } from '@nestjs/common';
+import * as request from 'supertest';
+import { AppModule } from './../src/app.module';
+
+describe('AppController (e2e)', () => {
+  let app: INestApplication;
+
+  beforeEach(async () => {
+    const moduleFixture: TestingModule = await Test.createTestingModule({
+      imports: [AppModule],
+    }).compile();
+
+    app = moduleFixture.createNestApplication();
+    await app.init();
+  });
+
+  it('/ (GET)', () => {
+    return request(app.getHttpServer())
+      .get('/')
+      .expect(200)
+      .expect(
+        JSON.stringify({
+          jsonString:
+            '{"json":{"big":"10"},"meta":{"values":{"big":["bigint"]}}}',
+        }),
+      );
+  });
+});
diff --git a/sample/34-using-esm-packages/test/jest-e2e.json b/sample/34-using-esm-packages/test/jest-e2e.json
new file mode 100644
index 000000000..e9d912f3e
--- /dev/null
+++ b/sample/34-using-esm-packages/test/jest-e2e.json
@@ -0,0 +1,9 @@
+{
+  "moduleFileExtensions": ["js", "json", "ts"],
+  "rootDir": ".",
+  "testEnvironment": "node",
+  "testRegex": ".e2e-spec.ts$",
+  "transform": {
+    "^.+\\.(t|j)s$": "ts-jest"
+  }
+}
diff --git a/sample/34-using-esm-packages/tsconfig.build.json b/sample/34-using-esm-packages/tsconfig.build.json
new file mode 100644
index 000000000..64f86c6bd
--- /dev/null
+++ b/sample/34-using-esm-packages/tsconfig.build.json
@@ -0,0 +1,4 @@
+{
+  "extends": "./tsconfig.json",
+  "exclude": ["node_modules", "test", "dist", "**/*spec.ts"]
+}
diff --git a/sample/34-using-esm-packages/tsconfig.json b/sample/34-using-esm-packages/tsconfig.json
new file mode 100644
index 000000000..95f5641cf
--- /dev/null
+++ b/sample/34-using-esm-packages/tsconfig.json
@@ -0,0 +1,21 @@
+{
+  "compilerOptions": {
+    "module": "commonjs",
+    "declaration": true,
+    "removeComments": true,
+    "emitDecoratorMetadata": true,
+    "experimentalDecorators": true,
+    "allowSyntheticDefaultImports": true,
+    "target": "ES2021",
+    "sourceMap": true,
+    "outDir": "./dist",
+    "baseUrl": "./",
+    "incremental": true,
+    "skipLibCheck": true,
+    "strictNullChecks": false,
+    "noImplicitAny": false,
+    "strictBindCallApply": false,
+    "forceConsistentCasingInFileNames": false,
+    "noFallthroughCasesInSwitch": false
+  }
+}
diff --git a/sample/35-use-esm-package-after-node22/.eslintrc.js b/sample/35-use-esm-package-after-node22/.eslintrc.js
new file mode 100644
index 000000000..259de13c7
--- /dev/null
+++ b/sample/35-use-esm-package-after-node22/.eslintrc.js
@@ -0,0 +1,25 @@
+module.exports = {
+  parser: '@typescript-eslint/parser',
+  parserOptions: {
+    project: 'tsconfig.json',
+    tsconfigRootDir: __dirname,
+    sourceType: 'module',
+  },
+  plugins: ['@typescript-eslint/eslint-plugin'],
+  extends: [
+    'plugin:@typescript-eslint/recommended',
+    'plugin:prettier/recommended',
+  ],
+  root: true,
+  env: {
+    node: true,
+    jest: true,
+  },
+  ignorePatterns: ['.eslintrc.js'],
+  rules: {
+    '@typescript-eslint/interface-name-prefix': 'off',
+    '@typescript-eslint/explicit-function-return-type': 'off',
+    '@typescript-eslint/explicit-module-boundary-types': 'off',
+    '@typescript-eslint/no-explicit-any': 'off',
+  },
+};
diff --git a/sample/35-use-esm-package-after-node22/.gitignore b/sample/35-use-esm-package-after-node22/.gitignore
new file mode 100644
index 000000000..4b56acfbe
--- /dev/null
+++ b/sample/35-use-esm-package-after-node22/.gitignore
@@ -0,0 +1,56 @@
+# compiled output
+/dist
+/node_modules
+/build
+
+# Logs
+logs
+*.log
+npm-debug.log*
+pnpm-debug.log*
+yarn-debug.log*
+yarn-error.log*
+lerna-debug.log*
+
+# OS
+.DS_Store
+
+# Tests
+/coverage
+/.nyc_output
+
+# IDEs and editors
+/.idea
+.project
+.classpath
+.c9/
+*.launch
+.settings/
+*.sublime-workspace
+
+# IDE - VSCode
+.vscode/*
+!.vscode/settings.json
+!.vscode/tasks.json
+!.vscode/launch.json
+!.vscode/extensions.json
+
+# dotenv environment variable files
+.env
+.env.development.local
+.env.test.local
+.env.production.local
+.env.local
+
+# temp directory
+.temp
+.tmp
+
+# Runtime data
+pids
+*.pid
+*.seed
+*.pid.lock
+
+# Diagnostic reports (https://nodejs.org/api/report.html)
+report.[0-9]*.[0-9]*.[0-9]*.[0-9]*.json
diff --git a/sample/35-use-esm-package-after-node22/.prettierrc b/sample/35-use-esm-package-after-node22/.prettierrc
new file mode 100644
index 000000000..dcb72794f
--- /dev/null
+++ b/sample/35-use-esm-package-after-node22/.prettierrc
@@ -0,0 +1,4 @@
+{
+  "singleQuote": true,
+  "trailingComma": "all"
+}
\ No newline at end of file
diff --git a/sample/35-use-esm-package-after-node22/README.md b/sample/35-use-esm-package-after-node22/README.md
new file mode 100644
index 000000000..e1f3b0cc0
--- /dev/null
+++ b/sample/35-use-esm-package-after-node22/README.md
@@ -0,0 +1,9 @@
+## How this works
+
+We are relying on the [`--experimental-require-module`](https://nodejs.org/api/modules.html#loading-ecmascript-modules-using-require) NodeJS v22 flag so that we can load ESM packages using `require()`
+
+Check out the `package.json` file.
+
+## About automated tests with Jest
+
+While Jest [does not supports](https://github.com/jestjs/jest/issues/15275) the `--experimental-require-module` flag, we cannot use Jest in this project!
\ No newline at end of file
diff --git a/sample/35-use-esm-package-after-node22/nest-cli.json b/sample/35-use-esm-package-after-node22/nest-cli.json
new file mode 100644
index 000000000..f9aa683b1
--- /dev/null
+++ b/sample/35-use-esm-package-after-node22/nest-cli.json
@@ -0,0 +1,8 @@
+{
+  "$schema": "https://json.schemastore.org/nest-cli",
+  "collection": "@nestjs/schematics",
+  "sourceRoot": "src",
+  "compilerOptions": {
+    "deleteOutDir": true
+  }
+}
diff --git a/sample/35-use-esm-package-after-node22/package-lock.json b/sample/35-use-esm-package-after-node22/package-lock.json
new file mode 100644
index 000000000..68c4588e8
Binary files /dev/null and b/sample/35-use-esm-package-after-node22/package-lock.json differ
diff --git a/sample/35-use-esm-package-after-node22/package.json b/sample/35-use-esm-package-after-node22/package.json
new file mode 100644
index 000000000..5901e3f68
--- /dev/null
+++ b/sample/35-use-esm-package-after-node22/package.json
@@ -0,0 +1,49 @@
+{
+  "name": "35-using-esm-package-after-node22",
+  "version": "0.0.1",
+  "description": "",
+  "author": "",
+  "private": true,
+  "license": "UNLICENSED",
+  "type": "commonjs",
+  "engines": {
+    "node": ">=22"
+  },
+  "scripts": {
+    "build": "nest build",
+    "format": "prettier --write \"src/**/*.ts\" \"test/**/*.ts\"",
+    "start": "nest start --exec \"node --experimental-require-module\"",
+    "start:dev": "nest start --exec \"node --experimental-require-module\" --watch",
+    "start:debug": "nest start --exec \"node --experimental-require-module\" --debug --watch",
+    "start:prod": "node --experimental-require-module dist/main",
+    "lint": "eslint \"{src,apps,libs,test}/**/*.ts\" --fix"
+  },
+  "dependencies": {
+    "@nestjs/common": "10.x",
+    "@nestjs/core": "10.x",
+    "@nestjs/platform-express": "10.x",
+    "reflect-metadata": "0.2.0",
+    "rxjs": "7.x",
+    "superjson": "2.x"
+  },
+  "devDependencies": {
+    "@nestjs/cli": "10.x",
+    "@nestjs/schematics": "10.x",
+    "@nestjs/testing": "10.x",
+    "@types/express": "4.x",
+    "@types/node": "22.x",
+    "@types/supertest": "6.x",
+    "@typescript-eslint/eslint-plugin": "8.x",
+    "@typescript-eslint/parser": "8.x",
+    "eslint": "8.x",
+    "eslint-config-prettier": "9.x",
+    "eslint-plugin-prettier": "5.x",
+    "prettier": "3.x",
+    "source-map-support": "0.5.21",
+    "supertest": "7.x",
+    "ts-loader": "9.x",
+    "ts-node": "10.x",
+    "tsconfig-paths": "4.x",
+    "typescript": "5.5.x"
+  }
+}
diff --git a/sample/35-use-esm-package-after-node22/src/app.controller.ts b/sample/35-use-esm-package-after-node22/src/app.controller.ts
new file mode 100644
index 000000000..87e5a6fca
--- /dev/null
+++ b/sample/35-use-esm-package-after-node22/src/app.controller.ts
@@ -0,0 +1,12 @@
+import { Controller, Get } from '@nestjs/common';
+import { AppService } from './app.service';
+
+@Controller()
+export class AppController {
+  constructor(private readonly appService: AppService) {}
+
+  @Get()
+  getHello() {
+    return this.appService.getJsonStringExample();
+  }
+}
diff --git a/sample/35-use-esm-package-after-node22/src/app.module.ts b/sample/35-use-esm-package-after-node22/src/app.module.ts
new file mode 100644
index 000000000..86628031c
--- /dev/null
+++ b/sample/35-use-esm-package-after-node22/src/app.module.ts
@@ -0,0 +1,10 @@
+import { Module } from '@nestjs/common';
+import { AppController } from './app.controller';
+import { AppService } from './app.service';
+
+@Module({
+  imports: [],
+  controllers: [AppController],
+  providers: [AppService],
+})
+export class AppModule {}
diff --git a/sample/35-use-esm-package-after-node22/src/app.service.ts b/sample/35-use-esm-package-after-node22/src/app.service.ts
new file mode 100644
index 000000000..09b14b203
--- /dev/null
+++ b/sample/35-use-esm-package-after-node22/src/app.service.ts
@@ -0,0 +1,13 @@
+import { Injectable } from '@nestjs/common';
+import superjson from 'superjson';
+
+@Injectable()
+export class AppService {
+  getJsonStringExample() {
+    const jsonString = superjson.stringify({ big: 10n });
+
+    return {
+      jsonString,
+    };
+  }
+}
diff --git a/sample/35-use-esm-package-after-node22/src/main.ts b/sample/35-use-esm-package-after-node22/src/main.ts
new file mode 100644
index 000000000..13cad38cf
--- /dev/null
+++ b/sample/35-use-esm-package-after-node22/src/main.ts
@@ -0,0 +1,8 @@
+import { NestFactory } from '@nestjs/core';
+import { AppModule } from './app.module';
+
+async function bootstrap() {
+  const app = await NestFactory.create(AppModule);
+  await app.listen(3000);
+}
+bootstrap();
diff --git a/sample/35-use-esm-package-after-node22/tsconfig.build.json b/sample/35-use-esm-package-after-node22/tsconfig.build.json
new file mode 100644
index 000000000..64f86c6bd
--- /dev/null
+++ b/sample/35-use-esm-package-after-node22/tsconfig.build.json
@@ -0,0 +1,4 @@
+{
+  "extends": "./tsconfig.json",
+  "exclude": ["node_modules", "test", "dist", "**/*spec.ts"]
+}
diff --git a/sample/35-use-esm-package-after-node22/tsconfig.json b/sample/35-use-esm-package-after-node22/tsconfig.json
new file mode 100644
index 000000000..95f5641cf
--- /dev/null
+++ b/sample/35-use-esm-package-after-node22/tsconfig.json
@@ -0,0 +1,21 @@
+{
+  "compilerOptions": {
+    "module": "commonjs",
+    "declaration": true,
+    "removeComments": true,
+    "emitDecoratorMetadata": true,
+    "experimentalDecorators": true,
+    "allowSyntheticDefaultImports": true,
+    "target": "ES2021",
+    "sourceMap": true,
+    "outDir": "./dist",
+    "baseUrl": "./",
+    "incremental": true,
+    "skipLibCheck": true,
+    "strictNullChecks": false,
+    "noImplicitAny": false,
+    "strictBindCallApply": false,
+    "forceConsistentCasingInFileNames": false,
+    "noFallthroughCasesInSwitch": false
+  }
+}
diff --git a/tools/benchmarks/check-benchmarks.ts b/tools/benchmarks/check-benchmarks.ts
index 750580b1b..58ed73244 100644
--- a/tools/benchmarks/check-benchmarks.ts
+++ b/tools/benchmarks/check-benchmarks.ts
@@ -12,9 +12,8 @@ export default async function checkBenchmarks() {
   if (!codechecks.isPr()) {
     return;
   }
-  const baselineBenchmarks = await codechecks.getValue<Benchmarks>(
-    benchmarksKey,
-  );
+  const baselineBenchmarks =
+    await codechecks.getValue<Benchmarks>(benchmarksKey);
   const report = getCodechecksReport(currentBenchmarks, baselineBenchmarks);
   await codechecks.report(report);
 }
diff --git a/tools/benchmarks/get-benchmarks.ts b/tools/benchmarks/get-benchmarks.ts
index eaf9a320b..a4fc51668 100644
--- a/tools/benchmarks/get-benchmarks.ts
+++ b/tools/benchmarks/get-benchmarks.ts
@@ -23,7 +23,13 @@ async function runBenchmarkOfLib(lib: string): Promise<WrkResults> {
   const libPath = join(BENCHMARK_PATH, `${lib}.js`);
   const process = spawn('node', [libPath], {
     detached: true,
-    stdio: 'ignore',
+  });
+
+  process.stdout!.on('data', data => {
+    console.log(`stdout: ${data}`);
+  });
+  process.stderr!.on('data', data => {
+    console.log(`stderr: ${data}`);
   });
 
   process.unref();
@@ -32,7 +38,7 @@ async function runBenchmarkOfLib(lib: string): Promise<WrkResults> {
 
   const result = await wrk({
     threads: 8,
-    duraton: '10s',
+    duration: '10s',
     connections: 1024,
     url: 'http://localhost:3000',
   });
diff --git a/tools/gulp/gulpfile.ts b/tools/gulp/gulpfile.ts
index de25610c2..1e6200761 100644
--- a/tools/gulp/gulpfile.ts
+++ b/tools/gulp/gulpfile.ts
@@ -1,5 +1,4 @@
-import './tasks/copy-misc';
 import './tasks/clean';
-import './tasks/packages';
+import './tasks/copy-misc';
 import './tasks/move';
 import './tasks/samples';
diff --git a/tools/gulp/tasks/move.ts b/tools/gulp/tasks/move.ts
index d01a29d59..0991e1e6f 100644
--- a/tools/gulp/tasks/move.ts
+++ b/tools/gulp/tasks/move.ts
@@ -3,12 +3,24 @@ import { join } from 'path';
 import { samplePath } from '../config';
 import { containsPackageJson, getDirs } from '../util/task-helpers';
 
+const distFiles = src([
+  'packages/**/*',
+  '!packages/**/*.ts',
+  'packages/**/*.d.ts',
+]);
+
+/**
+ * Moves the compiled nest files into "node_module" folder.
+ */
+function moveToNodeModules() {
+  return distFiles.pipe(dest('node_modules/@nestjs'));
+}
+
 /**
  * Moves the compiled nest files into the `samples/*` dirs.
  */
-function move() {
+function moveToSamples() {
   const samplesDirs = getDirs(samplePath);
-  const distFiles = src(['node_modules/@nestjs/**/*']);
 
   /**
    * Flatten the sampleDirs
@@ -31,4 +43,5 @@ function move() {
   );
 }
 
-task('move', move);
+task('move:node_modules', moveToNodeModules);
+task('move:samples', moveToSamples);
diff --git a/tools/gulp/tasks/packages.ts b/tools/gulp/tasks/packages.ts
deleted file mode 100644
index d71d76e90..000000000
--- a/tools/gulp/tasks/packages.ts
+++ /dev/null
@@ -1,78 +0,0 @@
-import { source, packagePaths } from '../config';
-import { task, watch, series, dest } from 'gulp';
-import { createProject } from 'gulp-typescript';
-import * as sourcemaps from 'gulp-sourcemaps';
-import * as log from 'fancy-log';
-
-// Has to be a hardcoded object due to build order
-const packages = {
-  common: createProject('packages/common/tsconfig.json'),
-  core: createProject('packages/core/tsconfig.json'),
-  microservices: createProject('packages/microservices/tsconfig.json'),
-  websockets: createProject('packages/websockets/tsconfig.json'),
-  testing: createProject('packages/testing/tsconfig.json'),
-  'platform-express': createProject('packages/platform-express/tsconfig.json'),
-  'platform-fastify': createProject('packages/platform-fastify/tsconfig.json'),
-  'platform-socket.io': createProject(
-    'packages/platform-socket.io/tsconfig.json',
-  ),
-  'platform-ws': createProject('packages/platform-ws/tsconfig.json'),
-};
-
-const modules = Object.keys(packages);
-
-const distId = process.argv.indexOf('--dist');
-const dist = distId < 0 ? source : process.argv[distId + 1];
-
-/**
- * Watches the packages/* folder and
- * builds the package on file change
- */
-function defaultTask() {
-  log.info('Watching files..');
-  modules.forEach(packageName => {
-    watch(
-      [`${source}/${packageName}/**/*.ts`, `${source}/${packageName}/*.ts`],
-      series(packageName),
-    );
-  });
-}
-
-/**
- * Builds the given package
- * @param packageName The name of the package
- */
-function buildPackage(packageName: string) {
-  return packages[packageName]
-    .src()
-    .pipe(packages[packageName]())
-    .pipe(dest(`${dist}/${packageName}`));
-}
-
-/**
- * Builds the given package and adds sourcemaps
- * @param packageName The name of the package
- */
-function buildPackageDev(packageName: string) {
-  return packages[packageName]
-    .src()
-    .pipe(sourcemaps.init())
-    .pipe(packages[packageName]())
-    .pipe(
-      sourcemaps.mapSources(
-        (sourcePath: string) => './' + sourcePath.split('/').pop(),
-      ),
-    )
-    .pipe(sourcemaps.write('.', {}))
-    .pipe(dest(`${dist}/${packageName}`));
-}
-
-modules.forEach(packageName => {
-  task(packageName, () => buildPackage(packageName));
-  task(`${packageName}:dev`, () => buildPackageDev(packageName));
-});
-
-task('common:dev', series(modules.map(packageName => `${packageName}:dev`)));
-task('build', series(modules));
-task('build:dev', series('common:dev'));
-task('default', defaultTask);
diff --git a/tools/gulp/tasks/samples.ts b/tools/gulp/tasks/samples.ts
index cd0243946..4656d31d0 100644
--- a/tools/gulp/tasks/samples.ts
+++ b/tools/gulp/tasks/samples.ts
@@ -1,5 +1,5 @@
 import * as childProcess from 'child_process';
-import * as clc from 'cli-color';
+import { blue, magenta } from 'ansis';
 import * as log from 'fancy-log';
 import { task } from 'gulp';
 import { resolve } from 'path';
@@ -13,9 +13,35 @@ async function executeNpmScriptInSamples(
   script: string,
   appendScript?: string,
 ) {
+  const nodejsVersionMajorSlice = Number.parseInt(process.versions.node);
+
   const directories = getDirs(samplePath);
 
+  /**
+   * A dictionary that maps the sample number to the minimum Node.js version
+   * required to execute any scripts.
+   */
+  const minNodejsVersionBySampleNumber = {
+    '34': 18, // we could use `engines.node` from package.json instead of hardcoding
+    '35': 22,
+  };
+
   for await (const dir of directories) {
+    const sampleIdentifier = dir.match(/\d+/)?.[0];
+    const minNodejsVersionForDir =
+      sampleIdentifier && sampleIdentifier in minNodejsVersionBySampleNumber
+        ? minNodejsVersionBySampleNumber[sampleIdentifier]
+        : undefined;
+    const isOnDesiredMinNodejsVersion = minNodejsVersionForDir
+      ? nodejsVersionMajorSlice >= minNodejsVersionForDir
+      : true;
+    if (!isOnDesiredMinNodejsVersion) {
+      console.info(
+        `Skipping sample ${sampleIdentifier} because it requires Node.js version v${minNodejsVersionForDir}`,
+      );
+      continue;
+    }
+
     // Check if the sample is a multi-application sample
     const isSingleApplicationSample = containsPackageJson(dir);
     if (!isSingleApplicationSample) {
@@ -43,12 +69,16 @@ async function executeNPMScriptInDirectory(
   appendScript?: string,
 ) {
   const dirName = dir.replace(resolve(__dirname, '../../../'), '');
-  log.info(`Running ${clc.blue(script)} in ${clc.magenta(dirName)}`);
+  log.info(`Running ${blue(script)} in ${magenta(dirName)}`);
   try {
     const result = await exec(
       `${script} --prefix ${dir} ${appendScript ? '-- ' + appendScript : ''}`,
     );
-    log.info(`Finished running ${clc.blue(script)} in ${clc.magenta(dirName)}`);
+    // const result = await exec(`npx npm-check-updates -u`, {
+    //   cwd: join(process.cwd(), dir),
+    // });
+
+    log.info(`Finished running ${blue(script)} in ${magenta(dirName)}`);
     if (result.stderr) {
       log.error(result.stderr);
     }
@@ -56,7 +86,7 @@ async function executeNPMScriptInDirectory(
       log.error(result.stdout);
     }
   } catch (err) {
-    log.error(`Failed running ${clc.blue(script)} in ${clc.magenta(dirName)}`);
+    log.error(`Failed running ${blue(script)} in ${magenta(dirName)}`);
     if (err.stderr) {
       log.error(err.stderr);
     }
@@ -70,7 +100,7 @@ async function executeNPMScriptInDirectory(
 task('install:samples', async () =>
   executeNpmScriptInSamples(
     // 'npm ci --no-audit --no-shrinkwrap --no-optional',
-    'npm install',
+    'npm install --legacy-peer-deps',
   ),
 );
 task('build:samples', async () => executeNpmScriptInSamples('npm run build'));
diff --git a/tools/gulp/tsconfig.json b/tools/gulp/tsconfig.json
index 6438b3c5a..043217830 100644
--- a/tools/gulp/tsconfig.json
+++ b/tools/gulp/tsconfig.json
@@ -3,7 +3,6 @@
     "experimentalDecorators": true,
     "noUnusedParameters": false,
     "noUnusedLocals": false,
-    "lib": ["es2015", "dom", "es2016.array.include"],
     "module": "commonjs",
     "moduleResolution": "node",
     "outDir": "../../dist/tools/gulp",
@@ -12,7 +11,7 @@
     "noImplicitThis": true,
     "noEmitOnError": true,
     "noImplicitAny": false,
-    "target": "es5",
+    "target": "ES2021",
     "types": [
       "node"
     ],
diff --git a/tools/gulp/util/task-helpers.ts b/tools/gulp/util/task-helpers.ts
index 736a1087c..9e9e65e3c 100644
--- a/tools/gulp/util/task-helpers.ts
+++ b/tools/gulp/util/task-helpers.ts
@@ -15,7 +15,7 @@ export function getDirs(base: string) {
 
 /**
  * Checks if the directory contains a package.json file
- * @param dir Path to the dircetory
+ * @param dir Path to the directory
  * @returns True if the directory contains a package.json
  */
 export function containsPackageJson(dir: string) {
diff --git a/tsconfig.json b/tsconfig.json
index 036b1a814..b9e2adb88 100644
--- a/tsconfig.json
+++ b/tsconfig.json
@@ -1,18 +1,21 @@
 {
   "compilerOptions": {
     "module": "commonjs",
-    "declaration": false,
     "noImplicitAny": false,
     "noUnusedLocals": false,
     "removeComments": true,
+    "strictNullChecks": true,
+    "strictPropertyInitialization": false,
+    "forceConsistentCasingInFileNames": true,
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "useUnknownInCatchVariables": false,
+    "target": "ES2021",
     "sourceMap": true,
-    "allowJs": true,
+    "allowJs": false,
     "outDir": "dist",
-    "lib": ["es7"],
+    "baseUrl": ".",
     "paths": {
       "@nestjs/common": ["./packages/common"],
       "@nestjs/common/*": ["./packages/common/*"],
@@ -30,7 +33,7 @@
       "@nestjs/platform-ws/*": ["./packages/platform-ws/*"],
       "@nestjs/platform-fastify": ["./packages/platform-fastify"],
       "@nestjs/platform-fastify/*": ["./packages/platform-fastify/*"],
-      "@nestjs/platform-socket.io": ["./packages/platform-ws"],
+      "@nestjs/platform-socket.io": ["./packages/platform-socket.io"],
       "@nestjs/platform-socket.io/*": ["./packages/platform-socket.io/*"],
     }
   },
diff --git a/tsconfig.spec.json b/tsconfig.spec.json
index 60e239b85..204fc267b 100644
--- a/tsconfig.spec.json
+++ b/tsconfig.spec.json
@@ -1,5 +1,5 @@
 {
   "extends": "./tsconfig.json",
-  "include": ["integration/**/*", "**/*.spec.ts"],
+  "include": ["integration/**/*", "integration/**/*.spec.ts", "packages/**/*.spec.ts"],
   "exclude": ["node_modules", "dist"]
-}
+}
\ No newline at end of file
