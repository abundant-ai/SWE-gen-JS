diff --git a/.changeset/flat-rockets-battle.md b/.changeset/flat-rockets-battle.md
new file mode 100644
index 0000000000..c5893db20a
--- /dev/null
+++ b/.changeset/flat-rockets-battle.md
@@ -0,0 +1,5 @@
+---
+"@biomejs/biome": patch
+---
+
+Biome now keeps a blank line after the frontmatter section in Astro files.
diff --git a/.changeset/stale-windows-strive.md b/.changeset/stale-windows-strive.md
deleted file mode 100644
index 2de982af0b..0000000000
--- a/.changeset/stale-windows-strive.md
+++ /dev/null
@@ -1,9 +0,0 @@
----
-"@biomejs/biome": patch
----
-
-The CSS parser, with `tailwindDirectives` enabled, will now accept lists of selectors in `@custom-variant` shorthand syntax.
-
-```css
-@custom-variant cell (th:has(&), td:has(&));
-```
diff --git a/.changeset/vast-donuts-rescue.md b/.changeset/vast-donuts-rescue.md
new file mode 100644
index 0000000000..09cd4030e4
--- /dev/null
+++ b/.changeset/vast-donuts-rescue.md
@@ -0,0 +1,5 @@
+---
+"@biomejs/biome": patch
+---
+
+`indentScriptAndStyle` no longer indents the frontmatter in Astro files.
diff --git a/crates/biome_cli/tests/cases/handle_astro_files.rs b/crates/biome_cli/tests/cases/handle_astro_files.rs
index 4010616d59..8c2808a146 100644
--- a/crates/biome_cli/tests/cases/handle_astro_files.rs
+++ b/crates/biome_cli/tests/cases/handle_astro_files.rs
@@ -223,6 +223,9 @@ let schema = z.object().optional();
 schema + sure()
 ---
 
+
+
+
 <html><head><title>Astro</title></head><body></body></html>
 
 <style>
@@ -667,3 +670,51 @@ fn format_astro_with_typescript_script_tag() {
         result,
     ));
 }
+
+#[test]
+fn dont_indent_frontmatter() {
+    let fs = MemoryFileSystem::default();
+    let mut console = BufferConsole::default();
+
+    fs.insert(
+        "biome.json".into(),
+        r#"{ "html": { "formatter": {"enabled": true, "indentScriptAndStyle": true}, "linter": {"enabled": true}, "experimentalFullSupportEnabled": true } }"#.as_bytes(),
+    );
+
+    let astro_file_path = Utf8Path::new("file.astro");
+    fs.insert(
+        astro_file_path.into(),
+        r#"---
+import Foo from "./Foo.astro"
+const bar = 123
+if (bar>1) {console.log(bar+1)}
+---
+<Foo>{bar}</Foo>
+
+<style>
+#id { font-family: comic-sans } .class { background: red}
+</style>
+
+<script>
+function foo(){console.log("Hello")}
+</script>
+"#
+        .as_bytes(),
+    );
+
+    let (fs, result) = run_cli(
+        fs,
+        &mut console,
+        Args::from(["format", "--write", astro_file_path.as_str()].as_slice()),
+    );
+
+    assert!(result.is_ok(), "run_cli returned {result:?}");
+
+    assert_cli_snapshot(SnapshotPayload::new(
+        module_path!(),
+        "dont_indent_frontmatter",
+        fs,
+        console,
+        result,
+    ));
+}
diff --git a/crates/biome_cli/tests/snapshots/main_cases_handle_astro_files/dont_indent_frontmatter.snap b/crates/biome_cli/tests/snapshots/main_cases_handle_astro_files/dont_indent_frontmatter.snap
new file mode 100644
index 0000000000..9ea776f16e
--- /dev/null
+++ b/crates/biome_cli/tests/snapshots/main_cases_handle_astro_files/dont_indent_frontmatter.snap
@@ -0,0 +1,51 @@
+---
+source: crates/biome_cli/tests/snap_test.rs
+expression: redactor(content)
+---
+## `biome.json`
+
+```json
+{
+  "html": {
+    "formatter": { "enabled": true, "indentScriptAndStyle": true },
+    "linter": { "enabled": true },
+    "experimentalFullSupportEnabled": true
+  }
+}
+```
+
+## `file.astro`
+
+```astro
+---
+import Foo from "./Foo.astro";
+const bar = 123;
+if (bar > 1) {
+	console.log(bar + 1);
+}
+---
+
+<Foo>{bar}</Foo>
+
+<style>
+	#id {
+		font-family: comic-sans;
+	}
+	.class {
+		background: red;
+	}
+</style>
+
+<script>
+	function foo() {
+		console.log("Hello");
+	}
+</script>
+
+```
+
+# Emitted Messages
+
+```block
+Formatted 1 file in <TIME>. Fixed 1 file.
+```
diff --git a/crates/biome_cli/tests/snapshots/main_cases_handle_astro_files/format_astro_with_typescript_script_tag.snap b/crates/biome_cli/tests/snapshots/main_cases_handle_astro_files/format_astro_with_typescript_script_tag.snap
index 6a48cf6d07..7372ba8bea 100644
--- a/crates/biome_cli/tests/snapshots/main_cases_handle_astro_files/format_astro_with_typescript_script_tag.snap
+++ b/crates/biome_cli/tests/snapshots/main_cases_handle_astro_files/format_astro_with_typescript_script_tag.snap
@@ -20,6 +20,7 @@ expression: redactor(content)
 ---
 const title = "My Page";
 ---
+
 <html>
 	<body>
 		<script>
diff --git a/crates/biome_cli/tests/snapshots/main_cases_handle_astro_files/full_support.snap b/crates/biome_cli/tests/snapshots/main_cases_handle_astro_files/full_support.snap
index 630710ed97..e58a15f5c9 100644
--- a/crates/biome_cli/tests/snapshots/main_cases_handle_astro_files/full_support.snap
+++ b/crates/biome_cli/tests/snapshots/main_cases_handle_astro_files/full_support.snap
@@ -24,6 +24,7 @@ import z from "zod";
 const schema = z.object().optional();
 schema + sure();
 ---
+
 <html>
 	<head>
 		<title>Astro</title>
@@ -56,15 +57,15 @@ check ━━━━━━━━━━━━━━━━━━━━━━━━
 # Emitted Messages
 
 ```block
-file.astro:13:20 lint/a11y/useGenericFontNames ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
+file.astro:16:20 lint/a11y/useGenericFontNames ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 
   × Generic font family missing.
   
-    12 │ <style>
-  > 13 │ #id { font-family: comic-sans } .class { background: red}
+    15 │ <style>
+  > 16 │ #id { font-family: comic-sans } .class { background: red}
        │                    ^^^^^^^^^^
-    14 │ </style>
-    15 │ 
+    17 │ </style>
+    18 │ 
   
   i Consider adding a generic font family as a fallback.
   
diff --git a/crates/biome_css_factory/src/generated/node_factory.rs b/crates/biome_css_factory/src/generated/node_factory.rs
index 35bfa0f23e..62624ad03b 100644
--- a/crates/biome_css_factory/src/generated/node_factory.rs
+++ b/crates/biome_css_factory/src/generated/node_factory.rs
@@ -2424,7 +2424,7 @@ pub fn tw_custom_variant_at_rule(
 }
 pub fn tw_custom_variant_shorthand(
     l_paren_token: SyntaxToken,
-    selector: CssSelectorList,
+    selector: AnyCssSelector,
     r_paren_token: SyntaxToken,
     semicolon_token: SyntaxToken,
 ) -> TwCustomVariantShorthand {
diff --git a/crates/biome_css_factory/src/generated/syntax_factory.rs b/crates/biome_css_factory/src/generated/syntax_factory.rs
index b281455a6b..57e07f530d 100644
--- a/crates/biome_css_factory/src/generated/syntax_factory.rs
+++ b/crates/biome_css_factory/src/generated/syntax_factory.rs
@@ -4985,7 +4985,7 @@ impl SyntaxFactory for CssSyntaxFactory {
                 }
                 slots.next_slot();
                 if let Some(element) = &current_element
-                    && CssSelectorList::can_cast(element.kind())
+                    && AnyCssSelector::can_cast(element.kind())
                 {
                     slots.mark_present();
                     current_element = elements.next();
diff --git a/crates/biome_css_parser/src/syntax/at_rule/tailwind.rs b/crates/biome_css_parser/src/syntax/at_rule/tailwind.rs
index a7e503097e..55a3c9a4fb 100644
--- a/crates/biome_css_parser/src/syntax/at_rule/tailwind.rs
+++ b/crates/biome_css_parser/src/syntax/at_rule/tailwind.rs
@@ -3,12 +3,14 @@ use crate::parser::CssParser;
 use crate::syntax::block::{
     parse_declaration_block, parse_declaration_or_rule_list_block, parse_rule_block,
 };
-use crate::syntax::parse_error::{expected_identifier, expected_string, expected_tw_source};
-use crate::syntax::selector::SelectorList;
+use crate::syntax::parse_error::{
+    expected_identifier, expected_selector, expected_string, expected_tw_source,
+};
+use crate::syntax::selector::parse_selector;
 use crate::syntax::{is_at_identifier, parse_identifier, parse_regular_identifier, parse_string};
 use biome_css_syntax::CssSyntaxKind::{self, *};
 use biome_css_syntax::T;
-use biome_parser::parse_lists::{ParseNodeList, ParseSeparatedList};
+use biome_parser::parse_lists::ParseNodeList;
 use biome_parser::parse_recovery::ParseRecoveryTokenSet;
 use biome_parser::parsed_syntax::ParsedSyntax;
 use biome_parser::parsed_syntax::ParsedSyntax::{Absent, Present};
@@ -131,10 +133,7 @@ fn parse_custom_variant_shorthand(p: &mut CssParser) -> ParsedSyntax {
     let m = p.start();
 
     p.bump(T!['(']);
-    let mut selector_list = SelectorList::default()
-        .with_end_kind_ts(token_set![T![')']])
-        .with_recovery_ts(token_set![T![')'], T![,], T![;]]);
-    selector_list.parse_list(p);
+    parse_selector(p).or_add_diagnostic(p, expected_selector);
     p.expect(T![')']);
     p.expect(T![;]);
 
diff --git a/crates/biome_css_parser/tests/css_test_suite/ok/tailwind/custom-variants/dark.css.snap b/crates/biome_css_parser/tests/css_test_suite/ok/tailwind/custom-variants/dark.css.snap
index 9f42534937..6533b628a7 100644
--- a/crates/biome_css_parser/tests/css_test_suite/ok/tailwind/custom-variants/dark.css.snap
+++ b/crates/biome_css_parser/tests/css_test_suite/ok/tailwind/custom-variants/dark.css.snap
@@ -25,53 +25,51 @@ CssRoot {
                 },
                 selector: TwCustomVariantShorthand {
                     l_paren_token: L_PAREN@21..22 "(" [] [],
-                    selector: CssSelectorList [
-                        CssCompoundSelector {
-                            nesting_selectors: CssNestedSelectorList [
-                                CssNestedSelector {
-                                    amp_token: AMP@22..23 "&" [] [],
-                                },
-                            ],
-                            simple_selector: missing (optional),
-                            sub_selectors: CssSubSelectorList [
-                                CssPseudoClassSelector {
-                                    colon_token: COLON@23..24 ":" [] [],
-                                    class: CssPseudoClassFunctionSelectorList {
-                                        name: CssIdentifier {
-                                            value_token: IDENT@24..26 "is" [] [],
-                                        },
-                                        l_paren_token: L_PAREN@26..27 "(" [] [],
-                                        selectors: CssSelectorList [
-                                            CssComplexSelector {
-                                                left: CssCompoundSelector {
-                                                    nesting_selectors: CssNestedSelectorList [],
-                                                    simple_selector: missing (optional),
-                                                    sub_selectors: CssSubSelectorList [
-                                                        CssClassSelector {
-                                                            dot_token: DOT@27..28 "." [] [],
-                                                            name: CssCustomIdentifier {
-                                                                value_token: IDENT@28..32 "dark" [] [],
-                                                            },
+                    selector: CssCompoundSelector {
+                        nesting_selectors: CssNestedSelectorList [
+                            CssNestedSelector {
+                                amp_token: AMP@22..23 "&" [] [],
+                            },
+                        ],
+                        simple_selector: missing (optional),
+                        sub_selectors: CssSubSelectorList [
+                            CssPseudoClassSelector {
+                                colon_token: COLON@23..24 ":" [] [],
+                                class: CssPseudoClassFunctionSelectorList {
+                                    name: CssIdentifier {
+                                        value_token: IDENT@24..26 "is" [] [],
+                                    },
+                                    l_paren_token: L_PAREN@26..27 "(" [] [],
+                                    selectors: CssSelectorList [
+                                        CssComplexSelector {
+                                            left: CssCompoundSelector {
+                                                nesting_selectors: CssNestedSelectorList [],
+                                                simple_selector: missing (optional),
+                                                sub_selectors: CssSubSelectorList [
+                                                    CssClassSelector {
+                                                        dot_token: DOT@27..28 "." [] [],
+                                                        name: CssCustomIdentifier {
+                                                            value_token: IDENT@28..32 "dark" [] [],
                                                         },
-                                                    ],
-                                                },
-                                                combinator: CSS_SPACE_LITERAL@32..33 " " [] [],
-                                                right: CssCompoundSelector {
-                                                    nesting_selectors: CssNestedSelectorList [],
-                                                    simple_selector: CssUniversalSelector {
-                                                        namespace: missing (optional),
-                                                        star_token: STAR@33..34 "*" [] [],
                                                     },
-                                                    sub_selectors: CssSubSelectorList [],
+                                                ],
+                                            },
+                                            combinator: CSS_SPACE_LITERAL@32..33 " " [] [],
+                                            right: CssCompoundSelector {
+                                                nesting_selectors: CssNestedSelectorList [],
+                                                simple_selector: CssUniversalSelector {
+                                                    namespace: missing (optional),
+                                                    star_token: STAR@33..34 "*" [] [],
                                                 },
+                                                sub_selectors: CssSubSelectorList [],
                                             },
-                                        ],
-                                        r_paren_token: R_PAREN@34..35 ")" [] [],
-                                    },
+                                        },
+                                    ],
+                                    r_paren_token: R_PAREN@34..35 ")" [] [],
                                 },
-                            ],
-                        },
-                    ],
+                            },
+                        ],
+                    },
                     r_paren_token: R_PAREN@35..36 ")" [] [],
                     semicolon_token: SEMICOLON@36..37 ";" [] [],
                 },
@@ -96,37 +94,36 @@ CssRoot {
           0: IDENT@16..21 "dark" [] [Whitespace(" ")]
         2: TW_CUSTOM_VARIANT_SHORTHAND@21..37
           0: L_PAREN@21..22 "(" [] []
-          1: CSS_SELECTOR_LIST@22..35
-            0: CSS_COMPOUND_SELECTOR@22..35
-              0: CSS_NESTED_SELECTOR_LIST@22..23
-                0: CSS_NESTED_SELECTOR@22..23
-                  0: AMP@22..23 "&" [] []
-              1: (empty)
-              2: CSS_SUB_SELECTOR_LIST@23..35
-                0: CSS_PSEUDO_CLASS_SELECTOR@23..35
-                  0: COLON@23..24 ":" [] []
-                  1: CSS_PSEUDO_CLASS_FUNCTION_SELECTOR_LIST@24..35
-                    0: CSS_IDENTIFIER@24..26
-                      0: IDENT@24..26 "is" [] []
-                    1: L_PAREN@26..27 "(" [] []
-                    2: CSS_SELECTOR_LIST@27..34
-                      0: CSS_COMPLEX_SELECTOR@27..34
-                        0: CSS_COMPOUND_SELECTOR@27..32
-                          0: CSS_NESTED_SELECTOR_LIST@27..27
-                          1: (empty)
-                          2: CSS_SUB_SELECTOR_LIST@27..32
-                            0: CSS_CLASS_SELECTOR@27..32
-                              0: DOT@27..28 "." [] []
-                              1: CSS_CUSTOM_IDENTIFIER@28..32
-                                0: IDENT@28..32 "dark" [] []
-                        1: CSS_SPACE_LITERAL@32..33 " " [] []
-                        2: CSS_COMPOUND_SELECTOR@33..34
-                          0: CSS_NESTED_SELECTOR_LIST@33..33
-                          1: CSS_UNIVERSAL_SELECTOR@33..34
-                            0: (empty)
-                            1: STAR@33..34 "*" [] []
-                          2: CSS_SUB_SELECTOR_LIST@34..34
-                    3: R_PAREN@34..35 ")" [] []
+          1: CSS_COMPOUND_SELECTOR@22..35
+            0: CSS_NESTED_SELECTOR_LIST@22..23
+              0: CSS_NESTED_SELECTOR@22..23
+                0: AMP@22..23 "&" [] []
+            1: (empty)
+            2: CSS_SUB_SELECTOR_LIST@23..35
+              0: CSS_PSEUDO_CLASS_SELECTOR@23..35
+                0: COLON@23..24 ":" [] []
+                1: CSS_PSEUDO_CLASS_FUNCTION_SELECTOR_LIST@24..35
+                  0: CSS_IDENTIFIER@24..26
+                    0: IDENT@24..26 "is" [] []
+                  1: L_PAREN@26..27 "(" [] []
+                  2: CSS_SELECTOR_LIST@27..34
+                    0: CSS_COMPLEX_SELECTOR@27..34
+                      0: CSS_COMPOUND_SELECTOR@27..32
+                        0: CSS_NESTED_SELECTOR_LIST@27..27
+                        1: (empty)
+                        2: CSS_SUB_SELECTOR_LIST@27..32
+                          0: CSS_CLASS_SELECTOR@27..32
+                            0: DOT@27..28 "." [] []
+                            1: CSS_CUSTOM_IDENTIFIER@28..32
+                              0: IDENT@28..32 "dark" [] []
+                      1: CSS_SPACE_LITERAL@32..33 " " [] []
+                      2: CSS_COMPOUND_SELECTOR@33..34
+                        0: CSS_NESTED_SELECTOR_LIST@33..33
+                        1: CSS_UNIVERSAL_SELECTOR@33..34
+                          0: (empty)
+                          1: STAR@33..34 "*" [] []
+                        2: CSS_SUB_SELECTOR_LIST@34..34
+                  3: R_PAREN@34..35 ")" [] []
           2: R_PAREN@35..36 ")" [] []
           3: SEMICOLON@36..37 ";" [] []
   2: EOF@37..38 "" [Newline("\n")] []
diff --git a/crates/biome_css_parser/tests/css_test_suite/ok/tailwind/custom-variants/shorthand-multiple-selectors.css b/crates/biome_css_parser/tests/css_test_suite/ok/tailwind/custom-variants/shorthand-multiple-selectors.css
deleted file mode 100644
index 54253ae481..0000000000
--- a/crates/biome_css_parser/tests/css_test_suite/ok/tailwind/custom-variants/shorthand-multiple-selectors.css
+++ /dev/null
@@ -1,3 +0,0 @@
-@custom-variant foobar (.foo, .bar);
-
-@custom-variant cell (th:has(&), td:has(&));
diff --git a/crates/biome_css_parser/tests/css_test_suite/ok/tailwind/custom-variants/shorthand-multiple-selectors.css.snap b/crates/biome_css_parser/tests/css_test_suite/ok/tailwind/custom-variants/shorthand-multiple-selectors.css.snap
deleted file mode 100644
index b5e7e969f1..0000000000
--- a/crates/biome_css_parser/tests/css_test_suite/ok/tailwind/custom-variants/shorthand-multiple-selectors.css.snap
+++ /dev/null
@@ -1,248 +0,0 @@
----
-source: crates/biome_css_parser/tests/spec_test.rs
-expression: snapshot
----
-## Input
-
-```css
-@custom-variant foobar (.foo, .bar);
-
-@custom-variant cell (th:has(&), td:has(&));
-
-```
-
-
-## AST
-
-```
-CssRoot {
-    bom_token: missing (optional),
-    rules: CssRuleList [
-        CssAtRule {
-            at_token: AT@0..1 "@" [] [],
-            rule: TwCustomVariantAtRule {
-                custom_variant_token: CUSTOM_VARIANT_KW@1..16 "custom-variant" [] [Whitespace(" ")],
-                name: CssIdentifier {
-                    value_token: IDENT@16..23 "foobar" [] [Whitespace(" ")],
-                },
-                selector: TwCustomVariantShorthand {
-                    l_paren_token: L_PAREN@23..24 "(" [] [],
-                    selector: CssSelectorList [
-                        CssCompoundSelector {
-                            nesting_selectors: CssNestedSelectorList [],
-                            simple_selector: missing (optional),
-                            sub_selectors: CssSubSelectorList [
-                                CssClassSelector {
-                                    dot_token: DOT@24..25 "." [] [],
-                                    name: CssCustomIdentifier {
-                                        value_token: IDENT@25..28 "foo" [] [],
-                                    },
-                                },
-                            ],
-                        },
-                        COMMA@28..30 "," [] [Whitespace(" ")],
-                        CssCompoundSelector {
-                            nesting_selectors: CssNestedSelectorList [],
-                            simple_selector: missing (optional),
-                            sub_selectors: CssSubSelectorList [
-                                CssClassSelector {
-                                    dot_token: DOT@30..31 "." [] [],
-                                    name: CssCustomIdentifier {
-                                        value_token: IDENT@31..34 "bar" [] [],
-                                    },
-                                },
-                            ],
-                        },
-                    ],
-                    r_paren_token: R_PAREN@34..35 ")" [] [],
-                    semicolon_token: SEMICOLON@35..36 ";" [] [],
-                },
-            },
-        },
-        CssAtRule {
-            at_token: AT@36..39 "@" [Newline("\n"), Newline("\n")] [],
-            rule: TwCustomVariantAtRule {
-                custom_variant_token: CUSTOM_VARIANT_KW@39..54 "custom-variant" [] [Whitespace(" ")],
-                name: CssIdentifier {
-                    value_token: IDENT@54..59 "cell" [] [Whitespace(" ")],
-                },
-                selector: TwCustomVariantShorthand {
-                    l_paren_token: L_PAREN@59..60 "(" [] [],
-                    selector: CssSelectorList [
-                        CssCompoundSelector {
-                            nesting_selectors: CssNestedSelectorList [],
-                            simple_selector: CssTypeSelector {
-                                namespace: missing (optional),
-                                ident: CssIdentifier {
-                                    value_token: IDENT@60..62 "th" [] [],
-                                },
-                            },
-                            sub_selectors: CssSubSelectorList [
-                                CssPseudoClassSelector {
-                                    colon_token: COLON@62..63 ":" [] [],
-                                    class: CssPseudoClassFunctionRelativeSelectorList {
-                                        name: CssIdentifier {
-                                            value_token: IDENT@63..66 "has" [] [],
-                                        },
-                                        l_paren_token: L_PAREN@66..67 "(" [] [],
-                                        relative_selectors: CssRelativeSelectorList [
-                                            CssRelativeSelector {
-                                                combinator: missing (optional),
-                                                selector: CssCompoundSelector {
-                                                    nesting_selectors: CssNestedSelectorList [
-                                                        CssNestedSelector {
-                                                            amp_token: AMP@67..68 "&" [] [],
-                                                        },
-                                                    ],
-                                                    simple_selector: missing (optional),
-                                                    sub_selectors: CssSubSelectorList [],
-                                                },
-                                            },
-                                        ],
-                                        r_paren_token: R_PAREN@68..69 ")" [] [],
-                                    },
-                                },
-                            ],
-                        },
-                        COMMA@69..71 "," [] [Whitespace(" ")],
-                        CssCompoundSelector {
-                            nesting_selectors: CssNestedSelectorList [],
-                            simple_selector: CssTypeSelector {
-                                namespace: missing (optional),
-                                ident: CssIdentifier {
-                                    value_token: IDENT@71..73 "td" [] [],
-                                },
-                            },
-                            sub_selectors: CssSubSelectorList [
-                                CssPseudoClassSelector {
-                                    colon_token: COLON@73..74 ":" [] [],
-                                    class: CssPseudoClassFunctionRelativeSelectorList {
-                                        name: CssIdentifier {
-                                            value_token: IDENT@74..77 "has" [] [],
-                                        },
-                                        l_paren_token: L_PAREN@77..78 "(" [] [],
-                                        relative_selectors: CssRelativeSelectorList [
-                                            CssRelativeSelector {
-                                                combinator: missing (optional),
-                                                selector: CssCompoundSelector {
-                                                    nesting_selectors: CssNestedSelectorList [
-                                                        CssNestedSelector {
-                                                            amp_token: AMP@78..79 "&" [] [],
-                                                        },
-                                                    ],
-                                                    simple_selector: missing (optional),
-                                                    sub_selectors: CssSubSelectorList [],
-                                                },
-                                            },
-                                        ],
-                                        r_paren_token: R_PAREN@79..80 ")" [] [],
-                                    },
-                                },
-                            ],
-                        },
-                    ],
-                    r_paren_token: R_PAREN@80..81 ")" [] [],
-                    semicolon_token: SEMICOLON@81..82 ";" [] [],
-                },
-            },
-        },
-    ],
-    eof_token: EOF@82..83 "" [Newline("\n")] [],
-}
-```
-
-## CST
-
-```
-0: CSS_ROOT@0..83
-  0: (empty)
-  1: CSS_RULE_LIST@0..82
-    0: CSS_AT_RULE@0..36
-      0: AT@0..1 "@" [] []
-      1: TW_CUSTOM_VARIANT_AT_RULE@1..36
-        0: CUSTOM_VARIANT_KW@1..16 "custom-variant" [] [Whitespace(" ")]
-        1: CSS_IDENTIFIER@16..23
-          0: IDENT@16..23 "foobar" [] [Whitespace(" ")]
-        2: TW_CUSTOM_VARIANT_SHORTHAND@23..36
-          0: L_PAREN@23..24 "(" [] []
-          1: CSS_SELECTOR_LIST@24..34
-            0: CSS_COMPOUND_SELECTOR@24..28
-              0: CSS_NESTED_SELECTOR_LIST@24..24
-              1: (empty)
-              2: CSS_SUB_SELECTOR_LIST@24..28
-                0: CSS_CLASS_SELECTOR@24..28
-                  0: DOT@24..25 "." [] []
-                  1: CSS_CUSTOM_IDENTIFIER@25..28
-                    0: IDENT@25..28 "foo" [] []
-            1: COMMA@28..30 "," [] [Whitespace(" ")]
-            2: CSS_COMPOUND_SELECTOR@30..34
-              0: CSS_NESTED_SELECTOR_LIST@30..30
-              1: (empty)
-              2: CSS_SUB_SELECTOR_LIST@30..34
-                0: CSS_CLASS_SELECTOR@30..34
-                  0: DOT@30..31 "." [] []
-                  1: CSS_CUSTOM_IDENTIFIER@31..34
-                    0: IDENT@31..34 "bar" [] []
-          2: R_PAREN@34..35 ")" [] []
-          3: SEMICOLON@35..36 ";" [] []
-    1: CSS_AT_RULE@36..82
-      0: AT@36..39 "@" [Newline("\n"), Newline("\n")] []
-      1: TW_CUSTOM_VARIANT_AT_RULE@39..82
-        0: CUSTOM_VARIANT_KW@39..54 "custom-variant" [] [Whitespace(" ")]
-        1: CSS_IDENTIFIER@54..59
-          0: IDENT@54..59 "cell" [] [Whitespace(" ")]
-        2: TW_CUSTOM_VARIANT_SHORTHAND@59..82
-          0: L_PAREN@59..60 "(" [] []
-          1: CSS_SELECTOR_LIST@60..80
-            0: CSS_COMPOUND_SELECTOR@60..69
-              0: CSS_NESTED_SELECTOR_LIST@60..60
-              1: CSS_TYPE_SELECTOR@60..62
-                0: (empty)
-                1: CSS_IDENTIFIER@60..62
-                  0: IDENT@60..62 "th" [] []
-              2: CSS_SUB_SELECTOR_LIST@62..69
-                0: CSS_PSEUDO_CLASS_SELECTOR@62..69
-                  0: COLON@62..63 ":" [] []
-                  1: CSS_PSEUDO_CLASS_FUNCTION_RELATIVE_SELECTOR_LIST@63..69
-                    0: CSS_IDENTIFIER@63..66
-                      0: IDENT@63..66 "has" [] []
-                    1: L_PAREN@66..67 "(" [] []
-                    2: CSS_RELATIVE_SELECTOR_LIST@67..68
-                      0: CSS_RELATIVE_SELECTOR@67..68
-                        0: (empty)
-                        1: CSS_COMPOUND_SELECTOR@67..68
-                          0: CSS_NESTED_SELECTOR_LIST@67..68
-                            0: CSS_NESTED_SELECTOR@67..68
-                              0: AMP@67..68 "&" [] []
-                          1: (empty)
-                          2: CSS_SUB_SELECTOR_LIST@68..68
-                    3: R_PAREN@68..69 ")" [] []
-            1: COMMA@69..71 "," [] [Whitespace(" ")]
-            2: CSS_COMPOUND_SELECTOR@71..80
-              0: CSS_NESTED_SELECTOR_LIST@71..71
-              1: CSS_TYPE_SELECTOR@71..73
-                0: (empty)
-                1: CSS_IDENTIFIER@71..73
-                  0: IDENT@71..73 "td" [] []
-              2: CSS_SUB_SELECTOR_LIST@73..80
-                0: CSS_PSEUDO_CLASS_SELECTOR@73..80
-                  0: COLON@73..74 ":" [] []
-                  1: CSS_PSEUDO_CLASS_FUNCTION_RELATIVE_SELECTOR_LIST@74..80
-                    0: CSS_IDENTIFIER@74..77
-                      0: IDENT@74..77 "has" [] []
-                    1: L_PAREN@77..78 "(" [] []
-                    2: CSS_RELATIVE_SELECTOR_LIST@78..79
-                      0: CSS_RELATIVE_SELECTOR@78..79
-                        0: (empty)
-                        1: CSS_COMPOUND_SELECTOR@78..79
-                          0: CSS_NESTED_SELECTOR_LIST@78..79
-                            0: CSS_NESTED_SELECTOR@78..79
-                              0: AMP@78..79 "&" [] []
-                          1: (empty)
-                          2: CSS_SUB_SELECTOR_LIST@79..79
-                    3: R_PAREN@79..80 ")" [] []
-          2: R_PAREN@80..81 ")" [] []
-          3: SEMICOLON@81..82 ";" [] []
-  2: EOF@82..83 "" [Newline("\n")] []
-
-```
diff --git a/crates/biome_css_parser/tests/css_test_suite/ok/tailwind/custom-variants/shorthand.css.snap b/crates/biome_css_parser/tests/css_test_suite/ok/tailwind/custom-variants/shorthand.css.snap
index 2cc4cd17d6..9323a3c042 100644
--- a/crates/biome_css_parser/tests/css_test_suite/ok/tailwind/custom-variants/shorthand.css.snap
+++ b/crates/biome_css_parser/tests/css_test_suite/ok/tailwind/custom-variants/shorthand.css.snap
@@ -25,66 +25,64 @@ CssRoot {
                 },
                 selector: TwCustomVariantShorthand {
                     l_paren_token: L_PAREN@31..32 "(" [] [],
-                    selector: CssSelectorList [
-                        CssCompoundSelector {
-                            nesting_selectors: CssNestedSelectorList [
-                                CssNestedSelector {
-                                    amp_token: AMP@32..33 "&" [] [],
-                                },
-                            ],
-                            simple_selector: missing (optional),
-                            sub_selectors: CssSubSelectorList [
-                                CssPseudoClassSelector {
-                                    colon_token: COLON@33..34 ":" [] [],
-                                    class: CssPseudoClassFunctionSelectorList {
-                                        name: CssIdentifier {
-                                            value_token: IDENT@34..39 "where" [] [],
-                                        },
-                                        l_paren_token: L_PAREN@39..40 "(" [] [],
-                                        selectors: CssSelectorList [
-                                            CssComplexSelector {
-                                                left: CssCompoundSelector {
-                                                    nesting_selectors: CssNestedSelectorList [],
-                                                    simple_selector: missing (optional),
-                                                    sub_selectors: CssSubSelectorList [
-                                                        CssAttributeSelector {
-                                                            l_brack_token: L_BRACK@40..41 "[" [] [],
-                                                            name: CssAttributeName {
-                                                                namespace: missing (optional),
-                                                                name: CssIdentifier {
-                                                                    value_token: IDENT@41..51 "data-theme" [] [],
-                                                                },
+                    selector: CssCompoundSelector {
+                        nesting_selectors: CssNestedSelectorList [
+                            CssNestedSelector {
+                                amp_token: AMP@32..33 "&" [] [],
+                            },
+                        ],
+                        simple_selector: missing (optional),
+                        sub_selectors: CssSubSelectorList [
+                            CssPseudoClassSelector {
+                                colon_token: COLON@33..34 ":" [] [],
+                                class: CssPseudoClassFunctionSelectorList {
+                                    name: CssIdentifier {
+                                        value_token: IDENT@34..39 "where" [] [],
+                                    },
+                                    l_paren_token: L_PAREN@39..40 "(" [] [],
+                                    selectors: CssSelectorList [
+                                        CssComplexSelector {
+                                            left: CssCompoundSelector {
+                                                nesting_selectors: CssNestedSelectorList [],
+                                                simple_selector: missing (optional),
+                                                sub_selectors: CssSubSelectorList [
+                                                    CssAttributeSelector {
+                                                        l_brack_token: L_BRACK@40..41 "[" [] [],
+                                                        name: CssAttributeName {
+                                                            namespace: missing (optional),
+                                                            name: CssIdentifier {
+                                                                value_token: IDENT@41..51 "data-theme" [] [],
                                                             },
-                                                            matcher: CssAttributeMatcher {
-                                                                operator: EQ@51..52 "=" [] [],
-                                                                value: CssAttributeMatcherValue {
-                                                                    name: CssString {
-                                                                        value_token: CSS_STRING_LITERAL@52..62 "\"midnight\"" [] [],
-                                                                    },
+                                                        },
+                                                        matcher: CssAttributeMatcher {
+                                                            operator: EQ@51..52 "=" [] [],
+                                                            value: CssAttributeMatcherValue {
+                                                                name: CssString {
+                                                                    value_token: CSS_STRING_LITERAL@52..62 "\"midnight\"" [] [],
                                                                 },
-                                                                modifier: missing (optional),
                                                             },
-                                                            r_brack_token: R_BRACK@62..63 "]" [] [],
+                                                            modifier: missing (optional),
                                                         },
-                                                    ],
-                                                },
-                                                combinator: CSS_SPACE_LITERAL@63..64 " " [] [],
-                                                right: CssCompoundSelector {
-                                                    nesting_selectors: CssNestedSelectorList [],
-                                                    simple_selector: CssUniversalSelector {
-                                                        namespace: missing (optional),
-                                                        star_token: STAR@64..65 "*" [] [],
+                                                        r_brack_token: R_BRACK@62..63 "]" [] [],
                                                     },
-                                                    sub_selectors: CssSubSelectorList [],
+                                                ],
+                                            },
+                                            combinator: CSS_SPACE_LITERAL@63..64 " " [] [],
+                                            right: CssCompoundSelector {
+                                                nesting_selectors: CssNestedSelectorList [],
+                                                simple_selector: CssUniversalSelector {
+                                                    namespace: missing (optional),
+                                                    star_token: STAR@64..65 "*" [] [],
                                                 },
+                                                sub_selectors: CssSubSelectorList [],
                                             },
-                                        ],
-                                        r_paren_token: R_PAREN@65..66 ")" [] [],
-                                    },
+                                        },
+                                    ],
+                                    r_paren_token: R_PAREN@65..66 ")" [] [],
                                 },
-                            ],
-                        },
-                    ],
+                            },
+                        ],
+                    },
                     r_paren_token: R_PAREN@66..67 ")" [] [],
                     semicolon_token: SEMICOLON@67..68 ";" [] [],
                 },
@@ -109,46 +107,45 @@ CssRoot {
           0: IDENT@16..31 "theme-midnight" [] [Whitespace(" ")]
         2: TW_CUSTOM_VARIANT_SHORTHAND@31..68
           0: L_PAREN@31..32 "(" [] []
-          1: CSS_SELECTOR_LIST@32..66
-            0: CSS_COMPOUND_SELECTOR@32..66
-              0: CSS_NESTED_SELECTOR_LIST@32..33
-                0: CSS_NESTED_SELECTOR@32..33
-                  0: AMP@32..33 "&" [] []
-              1: (empty)
-              2: CSS_SUB_SELECTOR_LIST@33..66
-                0: CSS_PSEUDO_CLASS_SELECTOR@33..66
-                  0: COLON@33..34 ":" [] []
-                  1: CSS_PSEUDO_CLASS_FUNCTION_SELECTOR_LIST@34..66
-                    0: CSS_IDENTIFIER@34..39
-                      0: IDENT@34..39 "where" [] []
-                    1: L_PAREN@39..40 "(" [] []
-                    2: CSS_SELECTOR_LIST@40..65
-                      0: CSS_COMPLEX_SELECTOR@40..65
-                        0: CSS_COMPOUND_SELECTOR@40..63
-                          0: CSS_NESTED_SELECTOR_LIST@40..40
-                          1: (empty)
-                          2: CSS_SUB_SELECTOR_LIST@40..63
-                            0: CSS_ATTRIBUTE_SELECTOR@40..63
-                              0: L_BRACK@40..41 "[" [] []
-                              1: CSS_ATTRIBUTE_NAME@41..51
-                                0: (empty)
-                                1: CSS_IDENTIFIER@41..51
-                                  0: IDENT@41..51 "data-theme" [] []
-                              2: CSS_ATTRIBUTE_MATCHER@51..62
-                                0: EQ@51..52 "=" [] []
-                                1: CSS_ATTRIBUTE_MATCHER_VALUE@52..62
-                                  0: CSS_STRING@52..62
-                                    0: CSS_STRING_LITERAL@52..62 "\"midnight\"" [] []
-                                2: (empty)
-                              3: R_BRACK@62..63 "]" [] []
-                        1: CSS_SPACE_LITERAL@63..64 " " [] []
-                        2: CSS_COMPOUND_SELECTOR@64..65
-                          0: CSS_NESTED_SELECTOR_LIST@64..64
-                          1: CSS_UNIVERSAL_SELECTOR@64..65
-                            0: (empty)
-                            1: STAR@64..65 "*" [] []
-                          2: CSS_SUB_SELECTOR_LIST@65..65
-                    3: R_PAREN@65..66 ")" [] []
+          1: CSS_COMPOUND_SELECTOR@32..66
+            0: CSS_NESTED_SELECTOR_LIST@32..33
+              0: CSS_NESTED_SELECTOR@32..33
+                0: AMP@32..33 "&" [] []
+            1: (empty)
+            2: CSS_SUB_SELECTOR_LIST@33..66
+              0: CSS_PSEUDO_CLASS_SELECTOR@33..66
+                0: COLON@33..34 ":" [] []
+                1: CSS_PSEUDO_CLASS_FUNCTION_SELECTOR_LIST@34..66
+                  0: CSS_IDENTIFIER@34..39
+                    0: IDENT@34..39 "where" [] []
+                  1: L_PAREN@39..40 "(" [] []
+                  2: CSS_SELECTOR_LIST@40..65
+                    0: CSS_COMPLEX_SELECTOR@40..65
+                      0: CSS_COMPOUND_SELECTOR@40..63
+                        0: CSS_NESTED_SELECTOR_LIST@40..40
+                        1: (empty)
+                        2: CSS_SUB_SELECTOR_LIST@40..63
+                          0: CSS_ATTRIBUTE_SELECTOR@40..63
+                            0: L_BRACK@40..41 "[" [] []
+                            1: CSS_ATTRIBUTE_NAME@41..51
+                              0: (empty)
+                              1: CSS_IDENTIFIER@41..51
+                                0: IDENT@41..51 "data-theme" [] []
+                            2: CSS_ATTRIBUTE_MATCHER@51..62
+                              0: EQ@51..52 "=" [] []
+                              1: CSS_ATTRIBUTE_MATCHER_VALUE@52..62
+                                0: CSS_STRING@52..62
+                                  0: CSS_STRING_LITERAL@52..62 "\"midnight\"" [] []
+                              2: (empty)
+                            3: R_BRACK@62..63 "]" [] []
+                      1: CSS_SPACE_LITERAL@63..64 " " [] []
+                      2: CSS_COMPOUND_SELECTOR@64..65
+                        0: CSS_NESTED_SELECTOR_LIST@64..64
+                        1: CSS_UNIVERSAL_SELECTOR@64..65
+                          0: (empty)
+                          1: STAR@64..65 "*" [] []
+                        2: CSS_SUB_SELECTOR_LIST@65..65
+                  3: R_PAREN@65..66 ")" [] []
           2: R_PAREN@66..67 ")" [] []
           3: SEMICOLON@67..68 ";" [] []
   2: EOF@68..69 "" [Newline("\n")] []
diff --git a/crates/biome_css_parser/tests/css_test_suite/ok/tailwind/shadcn-default.css.snap b/crates/biome_css_parser/tests/css_test_suite/ok/tailwind/shadcn-default.css.snap
index 6c71315b44..8454e7c260 100644
--- a/crates/biome_css_parser/tests/css_test_suite/ok/tailwind/shadcn-default.css.snap
+++ b/crates/biome_css_parser/tests/css_test_suite/ok/tailwind/shadcn-default.css.snap
@@ -195,53 +195,51 @@ CssRoot {
                 },
                 selector: TwCustomVariantShorthand {
                     l_paren_token: L_PAREN@77..78 "(" [] [],
-                    selector: CssSelectorList [
-                        CssCompoundSelector {
-                            nesting_selectors: CssNestedSelectorList [
-                                CssNestedSelector {
-                                    amp_token: AMP@78..79 "&" [] [],
-                                },
-                            ],
-                            simple_selector: missing (optional),
-                            sub_selectors: CssSubSelectorList [
-                                CssPseudoClassSelector {
-                                    colon_token: COLON@79..80 ":" [] [],
-                                    class: CssPseudoClassFunctionSelectorList {
-                                        name: CssIdentifier {
-                                            value_token: IDENT@80..82 "is" [] [],
-                                        },
-                                        l_paren_token: L_PAREN@82..83 "(" [] [],
-                                        selectors: CssSelectorList [
-                                            CssComplexSelector {
-                                                left: CssCompoundSelector {
-                                                    nesting_selectors: CssNestedSelectorList [],
-                                                    simple_selector: missing (optional),
-                                                    sub_selectors: CssSubSelectorList [
-                                                        CssClassSelector {
-                                                            dot_token: DOT@83..84 "." [] [],
-                                                            name: CssCustomIdentifier {
-                                                                value_token: IDENT@84..88 "dark" [] [],
-                                                            },
+                    selector: CssCompoundSelector {
+                        nesting_selectors: CssNestedSelectorList [
+                            CssNestedSelector {
+                                amp_token: AMP@78..79 "&" [] [],
+                            },
+                        ],
+                        simple_selector: missing (optional),
+                        sub_selectors: CssSubSelectorList [
+                            CssPseudoClassSelector {
+                                colon_token: COLON@79..80 ":" [] [],
+                                class: CssPseudoClassFunctionSelectorList {
+                                    name: CssIdentifier {
+                                        value_token: IDENT@80..82 "is" [] [],
+                                    },
+                                    l_paren_token: L_PAREN@82..83 "(" [] [],
+                                    selectors: CssSelectorList [
+                                        CssComplexSelector {
+                                            left: CssCompoundSelector {
+                                                nesting_selectors: CssNestedSelectorList [],
+                                                simple_selector: missing (optional),
+                                                sub_selectors: CssSubSelectorList [
+                                                    CssClassSelector {
+                                                        dot_token: DOT@83..84 "." [] [],
+                                                        name: CssCustomIdentifier {
+                                                            value_token: IDENT@84..88 "dark" [] [],
                                                         },
-                                                    ],
-                                                },
-                                                combinator: CSS_SPACE_LITERAL@88..89 " " [] [],
-                                                right: CssCompoundSelector {
-                                                    nesting_selectors: CssNestedSelectorList [],
-                                                    simple_selector: CssUniversalSelector {
-                                                        namespace: missing (optional),
-                                                        star_token: STAR@89..90 "*" [] [],
                                                     },
-                                                    sub_selectors: CssSubSelectorList [],
+                                                ],
+                                            },
+                                            combinator: CSS_SPACE_LITERAL@88..89 " " [] [],
+                                            right: CssCompoundSelector {
+                                                nesting_selectors: CssNestedSelectorList [],
+                                                simple_selector: CssUniversalSelector {
+                                                    namespace: missing (optional),
+                                                    star_token: STAR@89..90 "*" [] [],
                                                 },
+                                                sub_selectors: CssSubSelectorList [],
                                             },
-                                        ],
-                                        r_paren_token: R_PAREN@90..91 ")" [] [],
-                                    },
+                                        },
+                                    ],
+                                    r_paren_token: R_PAREN@90..91 ")" [] [],
                                 },
-                            ],
-                        },
-                    ],
+                            },
+                        ],
+                    },
                     r_paren_token: R_PAREN@91..92 ")" [] [],
                     semicolon_token: SEMICOLON@92..93 ";" [] [],
                 },
@@ -4470,37 +4468,36 @@ CssRoot {
           0: IDENT@72..77 "dark" [] [Whitespace(" ")]
         2: TW_CUSTOM_VARIANT_SHORTHAND@77..93
           0: L_PAREN@77..78 "(" [] []
-          1: CSS_SELECTOR_LIST@78..91
-            0: CSS_COMPOUND_SELECTOR@78..91
-              0: CSS_NESTED_SELECTOR_LIST@78..79
-                0: CSS_NESTED_SELECTOR@78..79
-                  0: AMP@78..79 "&" [] []
-              1: (empty)
-              2: CSS_SUB_SELECTOR_LIST@79..91
-                0: CSS_PSEUDO_CLASS_SELECTOR@79..91
-                  0: COLON@79..80 ":" [] []
-                  1: CSS_PSEUDO_CLASS_FUNCTION_SELECTOR_LIST@80..91
-                    0: CSS_IDENTIFIER@80..82
-                      0: IDENT@80..82 "is" [] []
-                    1: L_PAREN@82..83 "(" [] []
-                    2: CSS_SELECTOR_LIST@83..90
-                      0: CSS_COMPLEX_SELECTOR@83..90
-                        0: CSS_COMPOUND_SELECTOR@83..88
-                          0: CSS_NESTED_SELECTOR_LIST@83..83
-                          1: (empty)
-                          2: CSS_SUB_SELECTOR_LIST@83..88
-                            0: CSS_CLASS_SELECTOR@83..88
-                              0: DOT@83..84 "." [] []
-                              1: CSS_CUSTOM_IDENTIFIER@84..88
-                                0: IDENT@84..88 "dark" [] []
-                        1: CSS_SPACE_LITERAL@88..89 " " [] []
-                        2: CSS_COMPOUND_SELECTOR@89..90
-                          0: CSS_NESTED_SELECTOR_LIST@89..89
-                          1: CSS_UNIVERSAL_SELECTOR@89..90
-                            0: (empty)
-                            1: STAR@89..90 "*" [] []
-                          2: CSS_SUB_SELECTOR_LIST@90..90
-                    3: R_PAREN@90..91 ")" [] []
+          1: CSS_COMPOUND_SELECTOR@78..91
+            0: CSS_NESTED_SELECTOR_LIST@78..79
+              0: CSS_NESTED_SELECTOR@78..79
+                0: AMP@78..79 "&" [] []
+            1: (empty)
+            2: CSS_SUB_SELECTOR_LIST@79..91
+              0: CSS_PSEUDO_CLASS_SELECTOR@79..91
+                0: COLON@79..80 ":" [] []
+                1: CSS_PSEUDO_CLASS_FUNCTION_SELECTOR_LIST@80..91
+                  0: CSS_IDENTIFIER@80..82
+                    0: IDENT@80..82 "is" [] []
+                  1: L_PAREN@82..83 "(" [] []
+                  2: CSS_SELECTOR_LIST@83..90
+                    0: CSS_COMPLEX_SELECTOR@83..90
+                      0: CSS_COMPOUND_SELECTOR@83..88
+                        0: CSS_NESTED_SELECTOR_LIST@83..83
+                        1: (empty)
+                        2: CSS_SUB_SELECTOR_LIST@83..88
+                          0: CSS_CLASS_SELECTOR@83..88
+                            0: DOT@83..84 "." [] []
+                            1: CSS_CUSTOM_IDENTIFIER@84..88
+                              0: IDENT@84..88 "dark" [] []
+                      1: CSS_SPACE_LITERAL@88..89 " " [] []
+                      2: CSS_COMPOUND_SELECTOR@89..90
+                        0: CSS_NESTED_SELECTOR_LIST@89..89
+                        1: CSS_UNIVERSAL_SELECTOR@89..90
+                          0: (empty)
+                          1: STAR@89..90 "*" [] []
+                        2: CSS_SUB_SELECTOR_LIST@90..90
+                  3: R_PAREN@90..91 ")" [] []
           2: R_PAREN@91..92 ")" [] []
           3: SEMICOLON@92..93 ";" [] []
     3: CSS_QUALIFIED_RULE@93..1262
diff --git a/crates/biome_css_syntax/src/generated/nodes.rs b/crates/biome_css_syntax/src/generated/nodes.rs
index 1772b33974..c1434540f3 100644
--- a/crates/biome_css_syntax/src/generated/nodes.rs
+++ b/crates/biome_css_syntax/src/generated/nodes.rs
@@ -7042,8 +7042,8 @@ impl TwCustomVariantShorthand {
     pub fn l_paren_token(&self) -> SyntaxResult<SyntaxToken> {
         support::required_token(&self.syntax, 0usize)
     }
-    pub fn selector(&self) -> CssSelectorList {
-        support::list(&self.syntax, 1usize)
+    pub fn selector(&self) -> SyntaxResult<AnyCssSelector> {
+        support::required_node(&self.syntax, 1usize)
     }
     pub fn r_paren_token(&self) -> SyntaxResult<SyntaxToken> {
         support::required_token(&self.syntax, 2usize)
@@ -7063,7 +7063,7 @@ impl Serialize for TwCustomVariantShorthand {
 #[derive(Serialize)]
 pub struct TwCustomVariantShorthandFields {
     pub l_paren_token: SyntaxResult<SyntaxToken>,
-    pub selector: CssSelectorList,
+    pub selector: SyntaxResult<AnyCssSelector>,
     pub r_paren_token: SyntaxResult<SyntaxToken>,
     pub semicolon_token: SyntaxResult<SyntaxToken>,
 }
@@ -18366,7 +18366,7 @@ impl std::fmt::Debug for TwCustomVariantShorthand {
                     "l_paren_token",
                     &support::DebugSyntaxResult(self.l_paren_token()),
                 )
-                .field("selector", &self.selector())
+                .field("selector", &support::DebugSyntaxResult(self.selector()))
                 .field(
                     "r_paren_token",
                     &support::DebugSyntaxResult(self.r_paren_token()),
diff --git a/crates/biome_css_syntax/src/generated/nodes_mut.rs b/crates/biome_css_syntax/src/generated/nodes_mut.rs
index e8441b2cf7..5104ecbb8c 100644
--- a/crates/biome_css_syntax/src/generated/nodes_mut.rs
+++ b/crates/biome_css_syntax/src/generated/nodes_mut.rs
@@ -2846,7 +2846,7 @@ impl TwCustomVariantShorthand {
                 .splice_slots(0usize..=0usize, once(Some(element.into()))),
         )
     }
-    pub fn with_selector(self, element: CssSelectorList) -> Self {
+    pub fn with_selector(self, element: AnyCssSelector) -> Self {
         Self::unwrap_cast(
             self.syntax
                 .splice_slots(1usize..=1usize, once(Some(element.into_syntax().into()))),
diff --git a/crates/biome_html_formatter/src/html/auxiliary/root.rs b/crates/biome_html_formatter/src/html/auxiliary/root.rs
index b12c8ebf4e..d72a0a6348 100644
--- a/crates/biome_html_formatter/src/html/auxiliary/root.rs
+++ b/crates/biome_html_formatter/src/html/auxiliary/root.rs
@@ -18,7 +18,7 @@ impl FormatNodeRule<HtmlRoot> for FormatHtmlRoot {
         }
 
         if let Some(frontmatter) = frontmatter {
-            write!(f, [frontmatter.format(), hard_line_break()])?;
+            write!(f, [frontmatter.format(), empty_line()])?;
         }
 
         if let Some(directive) = directive {
diff --git a/crates/biome_html_formatter/tests/specs/html/component-frameworks/astro-component-casing.astro.snap b/crates/biome_html_formatter/tests/specs/html/component-frameworks/astro-component-casing.astro.snap
index a230f45174..7b69b59a43 100644
--- a/crates/biome_html_formatter/tests/specs/html/component-frameworks/astro-component-casing.astro.snap
+++ b/crates/biome_html_formatter/tests/specs/html/component-frameworks/astro-component-casing.astro.snap
@@ -41,6 +41,7 @@ Self close void elements: never
 import Button from './Button.astro';
 import TextInput from './TextInput.astro';
 ---
+
 <Button label="test button"/>
 <TextInput placeholder="enter text"/>
 <button>native button</button>
diff --git a/crates/biome_html_formatter/tests/specs/html/frontmatter.html.snap b/crates/biome_html_formatter/tests/specs/html/frontmatter.html.snap
index 2e5d3a9602..808ad5a9c7 100644
--- a/crates/biome_html_formatter/tests/specs/html/frontmatter.html.snap
+++ b/crates/biome_html_formatter/tests/specs/html/frontmatter.html.snap
@@ -36,5 +36,6 @@ Self close void elements: never
 ---
 layout: foo
 ---
+
 Test <a href="https://prettier.io">abc</a>.
 ```
diff --git a/crates/biome_html_formatter/tests/specs/prettier/html/front-matter/custom-parser.html.snap b/crates/biome_html_formatter/tests/specs/prettier/html/front-matter/custom-parser.html.snap
deleted file mode 100644
index eb1b6571d6..0000000000
--- a/crates/biome_html_formatter/tests/specs/prettier/html/front-matter/custom-parser.html.snap
+++ /dev/null
@@ -1,66 +0,0 @@
----
-source: crates/biome_formatter_test/src/snapshot_builder.rs
-info: html/front-matter/custom-parser.html
----
-# Input
-
-```html
----mycustomparser
-  
-title: Hello
-slug: home
-
----
-
-<h1>
-  Hello world!</h1>
-
-```
-
-
-# Prettier differences
-
-```diff
---- Prettier
-+++ Biome
-@@ -4,5 +4,4 @@
- slug: home
- 
- ---
--
- <h1>Hello world!</h1>
-```
-
-# Output
-
-```html
----mycustomparser
-  
-title: Hello
-slug: home
-
----
-<h1>Hello world!</h1>
-```
-
-# Errors
-```
-custom-parser.html:1:1 parse ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
-
-  × Frontmatter is only valid inside Astro files.
-  
-  > 1 │ ---mycustomparser
-      │ ^^^^^^^^^^^^^^^^^
-  > 2 │   
-  > 3 │ title: Hello
-  > 4 │ slug: home
-  > 5 │ 
-  > 6 │ ---
-      │ ^^^
-    7 │ 
-    8 │ <h1>
-  
-  i Remove it or rename the file to have the .astro extension.
-  
-
-```
diff --git a/crates/biome_html_formatter/tests/specs/prettier/html/front-matter/empty.html.snap b/crates/biome_html_formatter/tests/specs/prettier/html/front-matter/empty.html.snap
deleted file mode 100644
index 21b2942d13..0000000000
--- a/crates/biome_html_formatter/tests/specs/prettier/html/front-matter/empty.html.snap
+++ /dev/null
@@ -1,53 +0,0 @@
----
-source: crates/biome_formatter_test/src/snapshot_builder.rs
-info: html/front-matter/empty.html
----
-# Input
-
-```html
----
----
-
-<h1>
-  Hello world!</h1>
-
-```
-
-
-# Prettier differences
-
-```diff
---- Prettier
-+++ Biome
-@@ -1,4 +1,3 @@
- ---
- ---
--
- <h1>Hello world!</h1>
-```
-
-# Output
-
-```html
----
----
-<h1>Hello world!</h1>
-```
-
-# Errors
-```
-empty.html:1:1 parse ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
-
-  × Frontmatter is only valid inside Astro files.
-  
-  > 1 │ ---
-      │ ^^^
-  > 2 │ ---
-      │ ^^^
-    3 │ 
-    4 │ <h1>
-  
-  i Remove it or rename the file to have the .astro extension.
-  
-
-```
diff --git a/crates/biome_html_formatter/tests/specs/prettier/html/front-matter/empty2.html.snap b/crates/biome_html_formatter/tests/specs/prettier/html/front-matter/empty2.html.snap
deleted file mode 100644
index ab29229871..0000000000
--- a/crates/biome_html_formatter/tests/specs/prettier/html/front-matter/empty2.html.snap
+++ /dev/null
@@ -1,70 +0,0 @@
----
-source: crates/biome_formatter_test/src/snapshot_builder.rs
-info: html/front-matter/empty2.html
----
-# Input
-
-```html
----
----
-
-<div>
----
-</div>
-
-```
-
-
-# Prettier differences
-
-```diff
---- Prettier
-+++ Biome
-@@ -1,4 +1,3 @@
- ---
- ---
--
- <div>---</div>
-```
-
-# Output
-
-```html
----
----
-<div>---</div>
-```
-
-# Errors
-```
-empty2.html:1:1 parse ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
-
-  × Frontmatter is only valid inside Astro files.
-  
-  > 1 │ ---
-      │ ^^^
-  > 2 │ ---
-      │ ^^^
-    3 │ 
-    4 │ <div>
-  
-  i Remove it or rename the file to have the .astro extension.
-  
-empty2.html:5:1 parse ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
-
-  × Unexpected value or character.
-  
-    4 │ <div>
-  > 5 │ ---
-      │ ^^^
-    6 │ </div>
-    7 │ 
-  
-  i Expected one of:
-  
-  - element
-  - text
-  - closing block
-  
-
-```
diff --git a/crates/biome_html_formatter/tests/specs/prettier/html/front-matter/issue-9042-no-empty-line.html.snap b/crates/biome_html_formatter/tests/specs/prettier/html/front-matter/issue-9042-no-empty-line.html.snap
deleted file mode 100644
index 6caf972176..0000000000
--- a/crates/biome_html_formatter/tests/specs/prettier/html/front-matter/issue-9042-no-empty-line.html.snap
+++ /dev/null
@@ -1,56 +0,0 @@
----
-source: crates/biome_formatter_test/src/snapshot_builder.rs
-info: html/front-matter/issue-9042-no-empty-line.html
----
-# Input
-
-```html
----
-layout: foo
----
-Test <a
-href="https://prettier.io">abc</a>.
-
-```
-
-
-# Prettier differences
-
-```diff
---- Prettier
-+++ Biome
-@@ -1,5 +1,4 @@
- ---
- layout: foo
- ---
--
- Test <a href="https://prettier.io">abc</a>.
-```
-
-# Output
-
-```html
----
-layout: foo
----
-Test <a href="https://prettier.io">abc</a>.
-```
-
-# Errors
-```
-issue-9042-no-empty-line.html:1:1 parse ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
-
-  × Frontmatter is only valid inside Astro files.
-  
-  > 1 │ ---
-      │ ^^^
-  > 2 │ layout: foo
-  > 3 │ ---
-      │ ^^^
-    4 │ Test <a
-    5 │ href="https://prettier.io">abc</a>.
-  
-  i Remove it or rename the file to have the .astro extension.
-  
-
-```
diff --git a/crates/biome_html_formatter/tests/specs/prettier/html/front-matter/issue-9042.html.snap b/crates/biome_html_formatter/tests/specs/prettier/html/front-matter/issue-9042.html.snap
deleted file mode 100644
index c360307adf..0000000000
--- a/crates/biome_html_formatter/tests/specs/prettier/html/front-matter/issue-9042.html.snap
+++ /dev/null
@@ -1,57 +0,0 @@
----
-source: crates/biome_formatter_test/src/snapshot_builder.rs
-info: html/front-matter/issue-9042.html
----
-# Input
-
-```html
----
-layout: foo
----
-
-Test <a
-href="https://prettier.io">abc</a>.
-
-```
-
-
-# Prettier differences
-
-```diff
---- Prettier
-+++ Biome
-@@ -1,5 +1,4 @@
- ---
- layout: foo
- ---
--
- Test <a href="https://prettier.io">abc</a>.
-```
-
-# Output
-
-```html
----
-layout: foo
----
-Test <a href="https://prettier.io">abc</a>.
-```
-
-# Errors
-```
-issue-9042.html:1:1 parse ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
-
-  × Frontmatter is only valid inside Astro files.
-  
-  > 1 │ ---
-      │ ^^^
-  > 2 │ layout: foo
-  > 3 │ ---
-      │ ^^^
-    4 │ 
-    5 │ Test <a
-  
-  i Remove it or rename the file to have the .astro extension.
-  
-
-```
diff --git a/crates/biome_html_formatter/tests/specs/prettier/html/yaml/invalid.html.snap b/crates/biome_html_formatter/tests/specs/prettier/html/yaml/invalid.html.snap
deleted file mode 100644
index 09dba2d7b7..0000000000
--- a/crates/biome_html_formatter/tests/specs/prettier/html/yaml/invalid.html.snap
+++ /dev/null
@@ -1,65 +0,0 @@
----
-source: crates/biome_formatter_test/src/snapshot_builder.rs
-info: html/yaml/invalid.html
----
-# Input
-
-```html
----
-    invalid:
-invalid:
----
-
-
-
-<html><head></head><body></body></html>
-
-```
-
-
-# Prettier differences
-
-```diff
---- Prettier
-+++ Biome
-@@ -2,7 +2,6 @@
-     invalid:
- invalid:
- ---
--
- <html>
-   <head></head>
-   <body></body>
-```
-
-# Output
-
-```html
----
-    invalid:
-invalid:
----
-<html>
-  <head></head>
-  <body></body>
-</html>
-```
-
-# Errors
-```
-invalid.html:1:1 parse ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
-
-  × Frontmatter is only valid inside Astro files.
-  
-  > 1 │ ---
-      │ ^^^
-  > 2 │     invalid:
-  > 3 │ invalid:
-  > 4 │ ---
-      │ ^^^
-    5 │ 
-  
-  i Remove it or rename the file to have the .astro extension.
-  
-
-```
diff --git a/crates/biome_html_formatter/tests/specs/prettier/html/yaml/yaml.html.snap b/crates/biome_html_formatter/tests/specs/prettier/html/yaml/yaml.html.snap
index b9f40d1133..0e0f60203c 100644
--- a/crates/biome_html_formatter/tests/specs/prettier/html/yaml/yaml.html.snap
+++ b/crates/biome_html_formatter/tests/specs/prettier/html/yaml/yaml.html.snap
@@ -24,15 +24,13 @@ hello:     world
 ```diff
 --- Prettier
 +++ Biome
-@@ -1,7 +1,6 @@
+@@ -1,5 +1,5 @@
  ---
 -hello: world
 +hello:     world
  ---
--
+ 
  <html>
-   <head></head>
-   <body></body>
 ```
 
 # Output
@@ -41,6 +39,7 @@ hello:     world
 ---
 hello:     world
 ---
+
 <html>
   <head></head>
   <body></body>
diff --git a/crates/biome_js_syntax/src/file_source.rs b/crates/biome_js_syntax/src/file_source.rs
index 7bb3ca96d5..693d84700e 100644
--- a/crates/biome_js_syntax/src/file_source.rs
+++ b/crates/biome_js_syntax/src/file_source.rs
@@ -120,7 +120,10 @@ impl Language {
     Debug, Clone, Default, Copy, Eq, PartialEq, Hash, serde::Serialize, serde::Deserialize,
 )]
 pub enum EmbeddingKind {
-    Astro,
+    Astro {
+        /// Whether the script is inside Astro frontmatter
+        frontmatter: bool,
+    },
     Vue,
     Svelte,
     #[default]
@@ -129,7 +132,10 @@ pub enum EmbeddingKind {
 
 impl EmbeddingKind {
     pub const fn is_astro(&self) -> bool {
-        matches!(self, Self::Astro)
+        matches!(self, Self::Astro { frontmatter: false })
+    }
+    pub const fn is_astro_frontmatter(&self) -> bool {
+        matches!(self, Self::Astro { frontmatter: true })
     }
     pub const fn is_vue(&self) -> bool {
         matches!(self, Self::Vue)
@@ -201,7 +207,10 @@ impl JsFileSource {
     }
 
     pub fn astro() -> Self {
-        Self::ts().with_embedding_kind(EmbeddingKind::Astro)
+        Self::ts().with_embedding_kind(EmbeddingKind::Astro { frontmatter: false })
+    }
+    pub fn astro_frontmatter() -> Self {
+        Self::ts().with_embedding_kind(EmbeddingKind::Astro { frontmatter: true })
     }
 
     /// Vue file definition
diff --git a/crates/biome_service/src/file_handlers/html.rs b/crates/biome_service/src/file_handlers/html.rs
index 982f83594b..3338fd6201 100644
--- a/crates/biome_service/src/file_handlers/html.rs
+++ b/crates/biome_service/src/file_handlers/html.rs
@@ -445,7 +445,8 @@ pub(crate) fn parse_astro_embedded_script(
     settings: &Settings,
 ) -> Option<(EmbeddedSnippet<JsLanguage>, DocumentFileSource)> {
     let content = element.content_token()?;
-    let file_source = JsFileSource::ts().with_embedding_kind(EmbeddingKind::Astro);
+    let file_source =
+        JsFileSource::ts().with_embedding_kind(EmbeddingKind::Astro { frontmatter: true });
     let document_file_source = DocumentFileSource::Js(file_source);
     let options = settings.parse_options::<JsLanguage>(path, &document_file_source);
     let parse = parse_js_with_offset_and_cache(
@@ -493,7 +494,7 @@ pub(crate) fn parse_embedded_script(
             }
             file_source
         } else if html_file_source.is_astro() {
-            JsFileSource::ts().with_embedding_kind(EmbeddingKind::Astro)
+            JsFileSource::ts().with_embedding_kind(EmbeddingKind::Astro { frontmatter: false })
         } else {
             let is_module = element.is_javascript_module().unwrap_or_default();
             if is_module {
@@ -672,8 +673,8 @@ fn format_embedded(
         let mut iter = embedded_nodes.iter();
         let node = iter.find(|node| node.range == range)?;
 
-        let wrap_document = |document: Document| {
-            if indent_script_and_style {
+        let wrap_document = |document: Document, should_indent: bool| {
+            if indent_script_and_style && should_indent {
                 let elements = vec![
                     FormatElement::Line(LineMode::Hard),
                     FormatElement::Tag(Tag::StartIndent),
@@ -693,12 +694,16 @@ fn format_embedded(
         };
 
         match node.source {
-            DocumentFileSource::Js(_) => {
+            DocumentFileSource::Js(file_source) => {
                 let js_options = settings.format_options::<JsLanguage>(biome_path, &node.source);
                 let node = node.node.clone().embedded_syntax::<JsLanguage>().clone();
                 let formatted =
                     biome_js_formatter::format_node_with_offset(js_options, &node).ok()?;
-                Some(wrap_document(formatted.into_document()))
+
+                Some(wrap_document(
+                    formatted.into_document(),
+                    !file_source.as_embedding_kind().is_astro_frontmatter(),
+                ))
             }
             DocumentFileSource::Json(_) => {
                 let json_options =
@@ -706,14 +711,14 @@ fn format_embedded(
                 let node = node.node.clone().embedded_syntax::<JsonLanguage>().clone();
                 let formatted =
                     biome_json_formatter::format_node_with_offset(json_options, &node).ok()?;
-                Some(wrap_document(formatted.into_document()))
+                Some(wrap_document(formatted.into_document(), true))
             }
             DocumentFileSource::Css(_) => {
                 let css_options = settings.format_options::<CssLanguage>(biome_path, &node.source);
                 let node = node.node.clone().embedded_syntax::<CssLanguage>();
                 let formatted =
                     biome_css_formatter::format_node_with_offset(css_options, &node).ok()?;
-                Some(wrap_document(formatted.into_document()))
+                Some(wrap_document(formatted.into_document(), true))
             }
             _ => None,
         }
diff --git a/crates/biome_service/src/file_handlers/mod.rs b/crates/biome_service/src/file_handlers/mod.rs
index 2001b46387..e69b344c00 100644
--- a/crates/biome_service/src/file_handlers/mod.rs
+++ b/crates/biome_service/src/file_handlers/mod.rs
@@ -814,7 +814,7 @@ impl Features {
         match language_hint {
             // TODO: remove match once we remove vue/astro/svelte handlers
             DocumentFileSource::Js(source) => match source.as_embedding_kind() {
-                EmbeddingKind::Astro => self.astro.capabilities(),
+                EmbeddingKind::Astro { .. } => self.astro.capabilities(),
                 EmbeddingKind::Vue => self.vue.capabilities(),
                 EmbeddingKind::Svelte => self.svelte.capabilities(),
                 EmbeddingKind::None => self.js.capabilities(),
diff --git a/packages/@biomejs/backend-jsonrpc/src/workspace.ts b/packages/@biomejs/backend-jsonrpc/src/workspace.ts
index bb7ae96540..f326649ea7 100644
--- a/packages/@biomejs/backend-jsonrpc/src/workspace.ts
+++ b/packages/@biomejs/backend-jsonrpc/src/workspace.ts
@@ -9594,7 +9594,18 @@ export interface HtmlFileSource {
 export interface GritFileSource {
 	variant: GritVariant;
 }
-export type EmbeddingKind = "Astro" | "Vue" | "Svelte" | "None";
+export type EmbeddingKind =
+	| "Vue"
+	| "Svelte"
+	| "None"
+	| {
+			Astro: {
+				/**
+				 * Whether the script is inside Astro frontmatter
+				 */
+				frontmatter: boolean;
+			};
+	  };
 export type Language =
 	| "javaScript"
 	| { typeScript: { definition_file: boolean } };
diff --git a/xtask/codegen/css.ungram b/xtask/codegen/css.ungram
index 2402f70851..1e9a9b1ea4 100644
--- a/xtask/codegen/css.ungram
+++ b/xtask/codegen/css.ungram
@@ -1930,7 +1930,7 @@ AnyTwCustomVariantSelector =
 
 TwCustomVariantShorthand =
   '('
-  selector: CssSelectorList
+  selector: AnyCssSelector
   ')'
   ';'
 
diff --git a/xtask/rules_check/src/lib.rs b/xtask/rules_check/src/lib.rs
index e702739fcc..e875321d8c 100644
--- a/xtask/rules_check/src/lib.rs
+++ b/xtask/rules_check/src/lib.rs
@@ -285,7 +285,7 @@ fn assert_lint(
         DocumentFileSource::Js(file_source) => {
             // Temporary support for astro, svelte and vue code blocks
             let (code, file_source) = match file_source.as_embedding_kind() {
-                EmbeddingKind::Astro => (
+                EmbeddingKind::Astro { .. } => (
                     biome_service::file_handlers::AstroFileHandler::input(code),
                     JsFileSource::ts(),
                 ),
