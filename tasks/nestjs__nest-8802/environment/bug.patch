diff --git a/.circleci/config.yml b/.circleci/config.yml
index 8fa94ead5..ed7d72129 100644
--- a/.circleci/config.yml
+++ b/.circleci/config.yml
@@ -65,11 +65,6 @@ jobs:
       - store_artifacts:
           path: coverage
 
-  test_node_10:
-    <<: *unit-tests-template
-    docker:
-      - image: circleci/node:10
-
   test_node_14:
     <<: *unit-tests-template
     docker:
@@ -174,9 +169,6 @@ workflows:
       - test_node_12:
           requires:
             - build
-      - test_node_10:
-          requires:
-            - build
       - lint:
           requires:
             - build
diff --git a/.commitlintrc.json b/.commitlintrc.json
index 5c5e64d4b..d541ae390 100644
--- a/.commitlintrc.json
+++ b/.commitlintrc.json
@@ -23,6 +23,22 @@
         "test",
         "sample"
       ]
+    ],
+    "scope-enum": [
+      1,
+      "always",
+      [
+        "common",
+        "core",
+        "sample",
+        "microservices",
+        "express",
+        "fastify",
+        "socket.io",
+        "ws",
+        "testing",
+        "websockets"
+      ]
     ]
   }
 }
diff --git a/.eslintrc.js b/.eslintrc.js
index 280fe9a37..6c2dc7c33 100644
--- a/.eslintrc.js
+++ b/.eslintrc.js
@@ -1,8 +1,7 @@
 module.exports = {
-  parser: '@typescript-eslint/parser',
-  parserOptions: {
-    project: 'tsconfig.json',
-    sourceType: 'module',
+  root: true,
+  env: {
+    node: true,
   },
   plugins: ['@typescript-eslint/eslint-plugin'],
   extends: [
@@ -10,16 +9,39 @@ module.exports = {
     'plugin:@typescript-eslint/recommended',
     'prettier',
   ],
-  root: true,
-  env: {
-    node: true,
-  },
-  rules: {
-    '@typescript-eslint/interface-name-prefix': 'off',
-    '@typescript-eslint/explicit-function-return-type': 'off',
-    '@typescript-eslint/no-explicit-any': 'off',
-    '@typescript-eslint/explicit-module-boundary-types': 'off',
-    '@typescript-eslint/no-unused-vars': 'off',
-    '@typescript-eslint/ban-types': 'off',
-  },
+  overrides: [
+    {
+      files: ['**/*.ts'],
+      parser: '@typescript-eslint/parser',
+      parserOptions: {
+        project: 'tsconfig.json',
+        sourceType: 'module',
+      },
+      rules: {
+        '@typescript-eslint/interface-name-prefix': 'off',
+        '@typescript-eslint/explicit-function-return-type': 'off',
+        '@typescript-eslint/no-explicit-any': 'off',
+        '@typescript-eslint/explicit-module-boundary-types': 'off',
+        '@typescript-eslint/no-unused-vars': 'off',
+        '@typescript-eslint/ban-types': 'off',
+      },
+    },
+    {
+      files: ['**/*.spec.ts', 'integration/**/*.ts'],
+      parser: '@typescript-eslint/parser',
+      parserOptions: {
+        project: 'tsconfig.spec.json',
+        sourceType: 'module',
+      },
+      rules: {
+        '@typescript-eslint/interface-name-prefix': 'off',
+        '@typescript-eslint/explicit-function-return-type': 'off',
+        '@typescript-eslint/no-explicit-any': 'off',
+        '@typescript-eslint/explicit-module-boundary-types': 'off',
+        '@typescript-eslint/no-unused-vars': 'off',
+        '@typescript-eslint/ban-types': 'off',
+        '@typescript-eslint/no-empty-function': 'off',
+      },
+    }
+  ]
 };
diff --git a/.eslintrc.spec.js b/.eslintrc.spec.js
deleted file mode 100644
index f7b2e8ed7..000000000
--- a/.eslintrc.spec.js
+++ /dev/null
@@ -1,13 +0,0 @@
-const baseConfig = require('./.eslintrc');
-
-module.exports = {
-  ...baseConfig,
-  parserOptions: {
-    project: 'tsconfig.spec.json',
-    sourceType: 'module',
-  },
-  rules: {
-    ...baseConfig.rules,
-    '@typescript-eslint/no-empty-function': 'off',
-  },
-};
diff --git a/.github/ISSUE_TEMPLATE/Bug_report.yml b/.github/ISSUE_TEMPLATE/Bug_report.yml
index 56ff8ecf7..98e32d7ca 100644
--- a/.github/ISSUE_TEMPLATE/Bug_report.yml
+++ b/.github/ISSUE_TEMPLATE/Bug_report.yml
@@ -9,6 +9,7 @@ body:
  
         If you are not sure that your issue is a bug, you could:
 
+        - read the [FAQ's common errors](https://docs.nestjs.com/faq/common-errors) page
         - use our [Discord community](https://discord.gg/NestJS)
         - use [StackOverflow using the tag `nestjs`](https://stackoverflow.com/questions/tagged/nestjs)
         - If it's just a quick question you can ping [our Twitter](https://twitter.com/nestframework)
@@ -20,7 +21,7 @@ body:
   - type: checkboxes
     attributes:
       label: "Is there an existing issue for this?"
-      description: "Please search [here](https://github.com/nestjs/nest/issues?q=is%3Aissue) to see if an issue already exists for the bug you encountered"
+      description: "Please search [here](../issues?q=is%3Aissue) to see if an issue already exists for the bug you encountered"
       options:
       - label: "I have searched the existing issues"
         required: true
@@ -37,7 +38,7 @@ body:
       required: true
     attributes:
       label: "Minimum reproduction code"
-      description: "An URL to some git repository that reproduces this issue. [Wtf is a minimum reproduction?](https://jmcdo29.github.io/wtf-is-a-minimum-reproduction)"
+      description: "An URL to some Git repository/[StackBlitz](https://stackblitz.com/fork/github/nestjs/typescript-starter)/[CodeSandbox](https://codesandbox.io/s/github/nestjs/typescript-starter/tree/master) project that reproduces your issue. [Wtf is a minimum reproduction?](https://jmcdo29.github.io/wtf-is-a-minimum-reproduction)"
       placeholder: "https://github.com/..."
 
   - type: textarea
@@ -47,7 +48,7 @@ body:
         How the issue manifests?
         You could leave this blank if you alread write this in your reproduction code
       placeholder: |
-        1. `npm i`
+        1. `npm ci`
         2. `npm start:dev`
         3. See error...
 
@@ -104,10 +105,13 @@ body:
       required: true
     attributes:
       label: "Packages versions"
-      description: "You could leave your whole `package.json` dependencies list here, or just indicates which version of `@nestjs/*` are you using"
-      placeholder: |
-        - `@nestjs/common`: 8.1.3
-        - `@nestjs/platform-express`: 8.1.3
+      description: |
+        You could leave your whole `package.json` dependencies list here, or just indicate which version of `@nestjs/*` you are using
+        **Tip**: run _npx nest info_
+      value: |
+        ```json
+
+        ```
 
   - type: input
     attributes:
diff --git a/.github/ISSUE_TEMPLATE/Feature_request.yml b/.github/ISSUE_TEMPLATE/Feature_request.yml
index d2d432009..4bd28c420 100644
--- a/.github/ISSUE_TEMPLATE/Feature_request.yml
+++ b/.github/ISSUE_TEMPLATE/Feature_request.yml
@@ -9,6 +9,7 @@ body:
  
         If you are not sure that your issue is a bug, you could:
 
+        - read the [FAQ's common errors](https://docs.nestjs.com/faq/common-errors) page
         - use our [Discord community](https://discord.gg/NestJS)
         - use [StackOverflow using the tag `nestjs`](https://stackoverflow.com/questions/tagged/nestjs)
         - If it's just a quick question you can ping [our Twitter](https://twitter.com/nestframework)
@@ -18,7 +19,7 @@ body:
   - type: checkboxes
     attributes:
       label: "Is there an existing issue that is already proposing this?"
-      description: "Please search [here](https://github.com/nestjs/nest/issues?q=is%3Aissue) to see if an issue already exists for the feature you are requesting"
+      description: "Please search [here](../issues?q=is%3Aissue) to see if an issue already exists for the feature you are requesting"
       options:
       - label: "I have searched the existing issues"
         required: true
diff --git a/.github/ISSUE_TEMPLATE/Regression.yml b/.github/ISSUE_TEMPLATE/Regression.yml
index 85df74216..66ac1610b 100644
--- a/.github/ISSUE_TEMPLATE/Regression.yml
+++ b/.github/ISSUE_TEMPLATE/Regression.yml
@@ -9,6 +9,7 @@ body:
  
         If you are not sure that your issue is a bug, you could:
 
+        - read the [FAQ's common errors](https://docs.nestjs.com/faq/common-errors) page
         - use our [Discord community](https://discord.gg/NestJS)
         - use [StackOverflow using the tag `nestjs`](https://stackoverflow.com/questions/tagged/nestjs)
         - If it's just a quick question you can ping [our Twitter](https://twitter.com/nestframework)
@@ -28,7 +29,7 @@ body:
   - type: checkboxes
     attributes:
       label: "Is there an existing issue that is already proposing this?"
-      description: "Please search [here](https://github.com/nestjs/nest/issues?q=is%3Aissue) to see if an issue already exists for the feature you are requesting"
+      description: "Please search [here](../issues?q=is%3Aissue) to see if an issue already exists for the feature you are requesting"
       options:
       - label: "I have searched the existing issues"
         required: true
diff --git a/.github/ISSUE_TEMPLATE/Suggestion_improve_performance.yml b/.github/ISSUE_TEMPLATE/Suggestion_improve_performance.yml
index 9af904576..90652b6ef 100644
--- a/.github/ISSUE_TEMPLATE/Suggestion_improve_performance.yml
+++ b/.github/ISSUE_TEMPLATE/Suggestion_improve_performance.yml
@@ -6,7 +6,7 @@ body:
   - type: checkboxes
     attributes:
       label: "Is there an existing issue that is already proposing this?"
-      description: "Please search [here](https://github.com/nestjs/nest/issues?q=is%3Aissue) to see if an issue already exists for this"
+      description: "Please search [here](../issues?q=is%3Aissue) to see if an issue already exists for this"
       options:
       - label: "I have searched the existing issues"
         required: true
@@ -34,7 +34,7 @@ body:
 
   - type: textarea
     validations:
-      required: true
+     required: true
     attributes:
       label: "Benchmarks result or another proof (eg: POC)"
       description: |
diff --git a/.github/ISSUE_TEMPLATE/config.yml b/.github/ISSUE_TEMPLATE/config.yml
index b080c8139..0bf87e036 100644
--- a/.github/ISSUE_TEMPLATE/config.yml
+++ b/.github/ISSUE_TEMPLATE/config.yml
@@ -2,6 +2,9 @@
 blank_issues_enabled: false
 
 contact_links:
+  - name: "\u2049 FAQ"
+    url: "https://docs.nestjs.com/faq"
+    about: "Make sure you have read the Frequently Asked Questions page."
   - name: "\u2753 Discord Community of NestJS"
     url: "https://discord.gg/NestJS"
     about: "Please ask support questions or discuss suggestions/enhancements here."
diff --git a/.github/dependabot.yml b/.github/dependabot.yml
index 4872c5afd..b31110af1 100644
--- a/.github/dependabot.yml
+++ b/.github/dependabot.yml
@@ -5,3 +5,8 @@ updates:
   schedule:
     interval: daily
   open-pull-requests-limit: 10
+- package-ecosystem: "github-actions"
+  directory: "/"
+  schedule:
+    interval: daily
+  open-pull-requests-limit: 10
diff --git a/.github/workflows/codeql-analysis.yml b/.github/workflows/codeql-analysis.yml
index d148be272..17661cc77 100644
--- a/.github/workflows/codeql-analysis.yml
+++ b/.github/workflows/codeql-analysis.yml
@@ -29,7 +29,9 @@ jobs:
 
     # Initializes the CodeQL tools for scanning.
     - name: Initialize CodeQL
-      uses: github/codeql-action/init@v1
+      uses: github/codeql-action/init@v2
+      with:
+        queries: +security-extended
       # Override language selection by uncommenting this and choosing your languages
       # with:
       #   languages: go, javascript, csharp, python, cpp, java
@@ -37,7 +39,7 @@ jobs:
     # Autobuild attempts to build any compiled languages  (C/C++, C#, or Java).
     # If this step fails, then you should remove it and run the build manually (see below)
     - name: Autobuild
-      uses: github/codeql-action/autobuild@v1
+      uses: github/codeql-action/autobuild@v2
 
     # â„¹ï¸ Command-line programs to run using the OS shell.
     # ðŸ“š https://git.io/JvXDl
@@ -51,4 +53,4 @@ jobs:
     #   make release
 
     - name: Perform CodeQL Analysis
-      uses: github/codeql-action/analyze@v1
+      uses: github/codeql-action/analyze@v2
diff --git a/.gitignore b/.gitignore
index e4ac8a641..5943850da 100644
--- a/.gitignore
+++ b/.gitignore
@@ -5,6 +5,7 @@ node_modules/
 /.idea
 /.awcache
 /.vscode
+/.devcontainer
 *.code-workspace
 
 # bundle
diff --git a/.mocharc.js b/.mocharc.js
deleted file mode 100644
index b9cef9d6d..000000000
--- a/.mocharc.js
+++ /dev/null
@@ -1,7 +0,0 @@
-module.exports = {
-  mochaHooks: {
-    beforeAll: function() {
-      require('reflect-metadata');
-    }
-  }
-};
diff --git a/.prettierignore b/.prettierignore
index 59fc75a6f..cb4f4fe93 100644
--- a/.prettierignore
+++ b/.prettierignore
@@ -1,2 +1,3 @@
 packages/**/*.d.ts
-packages/**/*.js
\ No newline at end of file
+packages/**/*.js
+.nyc_output
diff --git a/CONTRIBUTING.md b/CONTRIBUTING.md
index a00cda048..585848980 100755
--- a/CONTRIBUTING.md
+++ b/CONTRIBUTING.md
@@ -19,7 +19,7 @@ Help us keep Nest open and inclusive. Please read and follow our [Code of Conduc
 
 ## <a name="question"></a> Got a Question or Problem?
 
-**Do not open issues for general support questions as we want to keep GitHub issues for bug reports and feature requests.** You've got much better chances of getting your question answered on [Stack Overflow](https://stackoverflow.com/questions/tagged/nestjs) where the questions should be tagged with tag `nestjs`.
+**Do not open issues for general support questions as we want to keep GitHub issues for bug reports and feature requests.** You've got much better chances of getting your question answered on [Stack Overflow][stackoverflow] where the questions should be tagged with tag `nestjs`.
 
 Stack Overflow is a much better place to ask questions since:
 
@@ -71,7 +71,7 @@ A minimal reproduce scenario using a repository or Gist allows us to quickly con
 
 Unfortunately, we are not able to investigate / fix bugs without a minimal reproduction, so if we don't hear back from you we are going to close an issue that doesn't have enough info to be reproduced.
 
-You can file new issues by filling out our [new issue form](https://github.com/nestjs/nest/issues/new).
+You can file new issues by filling out our [new issue form][new_issue].
 
 ### <a name="submit-pr"></a> Submitting a Pull Request (PR)
 
@@ -84,9 +84,9 @@ To the first point
 We cannot accept code without this.
 -->
 
-1. Search [GitHub](https://github.com/nestjs/nest/pulls) for an open or closed PR
+1. Search [GitHub Pull Requests][gh_prs] for an open or closed PR
    that relates to your submission. You don't want to duplicate effort.
-1. Fork the nestjs/nest repo.
+1. Fork this repository.
 1. Make your changes in a new git branch:
 
    ```shell
@@ -159,12 +159,12 @@ from the main (upstream) repository:
 
 ## <a name="development"></a> Development Setup
 
-You will need Node.js version 8.9.0+.
+You will need [Node.js](https://nodejs.org) version >= 10.13.0 (except for v13).
 
 1. After cloning the repo, run:
 
 ```bash
-$ npm i # (or yarn install)
+$ npm ci # (or yarn install)
 ```
 
 2. In order to prepare your environment run `prepare.sh` shell script:
@@ -233,7 +233,7 @@ to read on GitHub as well as in various git tools.
 
 Footer should contain a [closing reference to an issue](https://help.github.com/articles/closing-issues-via-commit-messages/) if any.
 
-Samples: (even more [samples](https://github.com/nestjs/nest/commits/master))
+Samples: (even more [samples][commits_samples])
 
 ```
 docs(changelog): update change log to beta.5
@@ -262,16 +262,22 @@ Must be one of the following:
 
 ### Scope
 
-The scope should be the name of the npm package affected (as perceived by person reading changelog generated from commit messages.
+The scope should have the name of the npm package affected (as perceived by person reading changelog generated from commit messages).
 
 The following is the list of supported scopes:
 
-- **common**
-- **core**
-- **sample**
-- **microservices**
-- **testing**
-- **websockets**
+- **common**: for changes made on `packages/common` directory
+- **core**: for changes made on `packages/core` directory
+- **sample**: for changes made on `packages/sample` directory
+- **microservices**: for changes made on `packages/microservices` directory
+- **express**: for changes made on `packages/platform-express` directory
+- **fastify**: for changes made on `packages/platform-fastify` directory
+- **socket.io**: for changes made on `packages/platform-socket.io` directory
+- **ws**: for changes made on `packages/platform-ws` directory
+- **testing**: for changes made on `packages/testing` directory
+- **websockets**: for changes made on `packages/websockets` directory
+
+If your change affect more than one package, separate the scopes with a comma (e.g. `common,core`).
 
 There are currently a few exceptions to the "use package name" rule:
 
@@ -279,7 +285,6 @@ There are currently a few exceptions to the "use package name" rule:
 - **changelog**: used for updating the release notes in CHANGELOG.md
 - **sample/#**: for the example apps directory, replacing # with the example app number
 - none/empty string: useful for `style`, `test` and `refactor` changes that are done across all packages (e.g. `style: add missing semicolons`)
-  <!-- * **aio**: used for docs-app (angular.io) related changes within the /aio directory of the repo -->
 
 ### Subject
 
@@ -317,14 +322,13 @@ changes to be accepted, the CLA must be signed. It's a quick process, we promise
 <!-- [coc]: https://github.com/angular/code-of-conduct/blob/master/CODE_OF_CONDUCT.md -->
 
 [commit-message-format]: https://docs.google.com/document/d/1QrDFcIiPjSLDn3EL15IJygNPiHORgU1_OOAqWjiDU5Y/edit#
-[corporate-cla]: http://code.google.com/legal/corporate-cla-v1.0.html
+<!-- [individual-cla]: http://code.google.com/legal/individual-cla-v1.0.html -->
+<!-- [corporate-cla]: http://code.google.com/legal/corporate-cla-v1.0.html -->
 [dev-doc]: https://github.com/nestjs/nest/blob/master/docs/DEVELOPER.md
 [github]: https://github.com/nestjs/nest
+[stackoverflow]: https://stackoverflow.com/questions/tagged/nestjs
 [discord]: https://discordapp.com/invite/G7Qnnhy
-[individual-cla]: http://code.google.com/legal/individual-cla-v1.0.html
 [js-style-guide]: https://google.github.io/styleguide/jsguide.html
-[jsfiddle]: http://jsfiddle.net
-[plunker]: http://plnkr.co/edit
-[runnable]: http://runnable.com
-
-<!-- [stackoverflow]: http://stackoverflow.com/questions/tagged/angular -->
+[new_issue]: https://github.com/nestjs/nest/issues/new
+[gh_prs]: https://github.com/nestjs/nest/pulls
+[commits_samples]: https://github.com/nestjs/nest/commits/master
diff --git a/LICENSE b/LICENSE
index e0006437c..8268fe7ff 100644
--- a/LICENSE
+++ b/LICENSE
@@ -1,6 +1,6 @@
 (The MIT License)
 
-Copyright (c) 2017-2021 Kamil Mysliwiec <https://kamilmysliwiec.com>
+Copyright (c) 2017-2022 Kamil Mysliwiec <https://kamilmysliwiec.com>
 
 Permission is hereby granted, free of charge, to any person obtaining
 a copy of this software and associated documentation files (the
diff --git a/Readme.md b/Readme.md
index f288809a9..9a3f42045 100644
--- a/Readme.md
+++ b/Readme.md
@@ -54,36 +54,42 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
 <table style="text-align:center;"><tr>
   <td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
+  <td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/red-hat-logo.svg" width="200" valign="middle" /></a></td>
 <td>
 <a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
 <td>
 <a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
+    <td>
+<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td><td>
+<a href="https://amplication.com/" target="_blank"><img src="https://nestjs.com/img/amplication-logo.svg" width="190" valign="middle" /></a></td>
 </tr></table>
 
 #### Gold Sponsors
 
 <table style="text-align:center;"><tr><td>
-  <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
-  <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
+<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="140" valign="middle" /></a></td>
 <td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
+<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td>
+ <td>
+<a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
+<a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td><td>
+<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
 <table style="text-align:center;"><tr><td>
 <a href="https://neoteric.eu/" target="_blank"><img src="https://nestjs.com/img/neoteric-cut.png" width="120" valign="middle" /></a> </td><td>
   <a href="http://gojob.com" target="_blank"><img src="http://nestjs.com/img/gojob-logo.png" valign="middle" width="100" /></a> </td><td>
-<a href="http://www.leogistics.com" target="_blank"><img src="https://nestjs.com/img/leogistics-logo.jpeg" width="150" valign="middle" /></td><td>
+<a href="https://www.myleodsc.com/" target="_blank"><img src="https://nestjs.com/img/myleo-logo.png" width="180" valign="middle" /></td><td>
 <a href="https://careers.meetdandy.com/?gh_src=063ba61e3us" target="_blank"><img src="https://nestjs.com/img/dandy-roles-logo.svg" width="150" valign="middle" /></td><td>
 <a href="https://www.castlecraft.in" target="_blank"><img src="https://nestjs.com/img/castlecraft-logo.png" width="150" valign="middle" /></td>
-<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td></tr></table>
+<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td>
+<td><a href="https://n.inc" target="_blank"><img src="https://nestjs.com/img/n-inc-logo.svg" width="120" valign="middle" /></td></tr></table>
 
 #### Sponsors
 
@@ -117,6 +123,11 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/naologic-logo.svg" width="125" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://messaged.com/" target="_blank"><img src="https://nestjs.com/img/messaged-logo.png" width="50" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/triplecore-logo.svg" width="50" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://klqc.de" target="_blank"><img src="https://nestjs.com/img/klcqcl-logo.png" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://thecasinowizard.com/bonuses/no-deposit-bonuses/" target="_blank"><img src="https://nestjs.com/img/casinowizard-logo.png" width="120" valign="middle" /></a></td></tr><tr>
+     <td align="center" valign="middle"><a href="https://polygon-software.ch/" target="_blank"><img src="https://nestjs.com/img/polygon-logo.svg" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://mobilereality.pl/" target="_blank"><img src="https://nestjs.com/img/mobile-reality-logo.png" width="45" valign="middle" /></a></td>
+     <td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/boringowl-logo.svg" width="120" valign="middle" /></a></td>
   </tr></table>
 
 ## Backers
diff --git a/hooks/mocha-init-hook.ts b/hooks/mocha-init-hook.ts
new file mode 100644
index 000000000..4a774163f
--- /dev/null
+++ b/hooks/mocha-init-hook.ts
@@ -0,0 +1,7 @@
+export const mochaHooks = (): Mocha.RootHookObject => {
+  return {
+    async beforeAll(this: Mocha.Context) {
+      await import('reflect-metadata');
+    }
+  };
+};
diff --git a/integration/docker-compose.yml b/integration/docker-compose.yml
index 7ee1a96ac..6d2bf45fd 100644
--- a/integration/docker-compose.yml
+++ b/integration/docker-compose.yml
@@ -17,13 +17,15 @@ services:
     restart: always
   mqtt:
     container_name: test-mqtt
-    image: toke/mosquitto
+    image: eclipse-mosquitto
+    volumes:
+      - ./mosquitto.conf:/mosquitto/config/mosquitto.conf
     ports:
       - "1883:1883"
       - "9001:9001"
     restart: always
   mysql:
-    image: mysql:8.0.27
+    image: mysql:8.0.28
     environment:
       MYSQL_ROOT_PASSWORD: root
       MYSQL_DATABASE: test
@@ -48,7 +50,7 @@ services:
   zookeeper:
     container_name: test-zookeeper
     hostname: zookeeper
-    image: confluentinc/cp-zookeeper:7.0.0
+    image: confluentinc/cp-zookeeper:7.0.1
     ports:
       - "2181:2181"
     environment:
@@ -57,7 +59,7 @@ services:
   kafka:
     container_name: test-kafka
     hostname: kafka
-    image: confluentinc/cp-kafka:7.0.0
+    image: confluentinc/cp-kafka:7.0.1
     depends_on:
       - zookeeper
     ports:
diff --git a/integration/graphql-code-first/e2e/code-first.spec.ts b/integration/graphql-code-first/e2e/code-first.spec.ts
index 3a2cb97b3..258edd8a9 100644
--- a/integration/graphql-code-first/e2e/code-first.spec.ts
+++ b/integration/graphql-code-first/e2e/code-first.spec.ts
@@ -1,14 +1,14 @@
 import { INestApplication } from '@nestjs/common';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 describe('GraphQL - Code-first', () => {
   let app: INestApplication;
 
   beforeEach(async () => {
     const module = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
 
     app = module.createNestApplication();
diff --git a/integration/graphql-code-first/e2e/guards-filters.spec.ts b/integration/graphql-code-first/e2e/guards-filters.spec.ts
index 6e3307b5b..4953d771c 100644
--- a/integration/graphql-code-first/e2e/guards-filters.spec.ts
+++ b/integration/graphql-code-first/e2e/guards-filters.spec.ts
@@ -1,14 +1,14 @@
 import { INestApplication } from '@nestjs/common';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 describe('GraphQL - Guards', () => {
   let app: INestApplication;
 
   beforeEach(async () => {
     const module = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
 
     app = module.createNestApplication();
diff --git a/integration/graphql-code-first/e2e/pipes.spec.ts b/integration/graphql-code-first/e2e/pipes.spec.ts
index bdd928fd9..61f169c2a 100644
--- a/integration/graphql-code-first/e2e/pipes.spec.ts
+++ b/integration/graphql-code-first/e2e/pipes.spec.ts
@@ -1,14 +1,14 @@
 import { INestApplication, ValidationPipe } from '@nestjs/common';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 describe('GraphQL Pipes', () => {
   let app: INestApplication;
 
   beforeEach(async () => {
     const module = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
 
     app = module.createNestApplication();
diff --git a/integration/graphql-code-first/src/app.module.ts b/integration/graphql-code-first/src/app.module.ts
index 4fd71db94..595288ffc 100644
--- a/integration/graphql-code-first/src/app.module.ts
+++ b/integration/graphql-code-first/src/app.module.ts
@@ -1,3 +1,4 @@
+import { ApolloDriver, ApolloDriverConfig } from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
 import { GraphQLModule } from '@nestjs/graphql';
 import { join } from 'path';
@@ -6,7 +7,8 @@ import { RecipesModule } from './recipes/recipes.module';
 @Module({
   imports: [
     RecipesModule,
-    GraphQLModule.forRoot({
+    GraphQLModule.forRoot<ApolloDriverConfig>({
+      driver: ApolloDriver,
       debug: false,
       installSubscriptionHandlers: true,
       autoSchemaFile: join(
@@ -16,4 +18,4 @@ import { RecipesModule } from './recipes/recipes.module';
     }),
   ],
 })
-export class ApplicationModule {}
+export class AppModule {}
diff --git a/integration/graphql-schema-first/e2e/graphql-request-scoped.spec.ts b/integration/graphql-schema-first/e2e/graphql-request-scoped.spec.ts
index fa470c2c6..5f2309689 100644
--- a/integration/graphql-schema-first/e2e/graphql-request-scoped.spec.ts
+++ b/integration/graphql-schema-first/e2e/graphql-request-scoped.spec.ts
@@ -1,3 +1,4 @@
+import { ApolloDriver } from '@nestjs/apollo';
 import { INestApplication } from '@nestjs/common';
 import { GraphQLModule } from '@nestjs/graphql';
 import { Test } from '@nestjs/testing';
@@ -15,6 +16,7 @@ describe('GraphQL request scoped', () => {
       imports: [
         CatsModule.enableRequestScope(),
         GraphQLModule.forRoot({
+          driver: ApolloDriver,
           typePaths: [join(__dirname, '..', 'src', '**', '*.graphql')],
         }),
       ],
diff --git a/integration/graphql-schema-first/e2e/graphql.spec.ts b/integration/graphql-schema-first/e2e/graphql.spec.ts
index 376244f1a..e8ced186f 100644
--- a/integration/graphql-schema-first/e2e/graphql.spec.ts
+++ b/integration/graphql-schema-first/e2e/graphql.spec.ts
@@ -1,14 +1,14 @@
 import { INestApplication } from '@nestjs/common';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 describe('GraphQL', () => {
   let app: INestApplication;
 
   beforeEach(async () => {
     const module = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
 
     app = module.createNestApplication();
diff --git a/integration/graphql-schema-first/src/app.module.ts b/integration/graphql-schema-first/src/app.module.ts
index a3cfa7a6d..2dbbb236a 100644
--- a/integration/graphql-schema-first/src/app.module.ts
+++ b/integration/graphql-schema-first/src/app.module.ts
@@ -1,3 +1,4 @@
+import { ApolloDriver, ApolloDriverConfig } from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
 import { GraphQLModule } from '@nestjs/graphql';
 import { join } from 'path';
@@ -6,9 +7,10 @@ import { CatsModule } from './cats/cats.module';
 @Module({
   imports: [
     CatsModule,
-    GraphQLModule.forRoot({
+    GraphQLModule.forRoot<ApolloDriverConfig>({
+      driver: ApolloDriver,
       typePaths: [join(__dirname, '**', '*.graphql')],
     }),
   ],
 })
-export class ApplicationModule {}
+export class AppModule {}
diff --git a/integration/graphql-schema-first/src/async-options-class.module.ts b/integration/graphql-schema-first/src/async-options-class.module.ts
index 749492e8c..5e702348d 100644
--- a/integration/graphql-schema-first/src/async-options-class.module.ts
+++ b/integration/graphql-schema-first/src/async-options-class.module.ts
@@ -1,14 +1,11 @@
+import { ApolloDriver, ApolloDriverConfig } from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
-import {
-  GqlModuleOptions,
-  GqlOptionsFactory,
-  GraphQLModule,
-} from '@nestjs/graphql';
+import { GqlOptionsFactory, GraphQLModule } from '@nestjs/graphql';
 import { join } from 'path';
 import { CatsModule } from './cats/cats.module';
 
 class ConfigService implements GqlOptionsFactory {
-  createGqlOptions(): GqlModuleOptions {
+  createGqlOptions(): ApolloDriverConfig {
     return {
       typePaths: [join(__dirname, '**', '*.graphql')],
     };
@@ -18,7 +15,8 @@ class ConfigService implements GqlOptionsFactory {
 @Module({
   imports: [
     CatsModule,
-    GraphQLModule.forRootAsync({
+    GraphQLModule.forRootAsync<ApolloDriverConfig>({
+      driver: ApolloDriver,
       useClass: ConfigService,
     }),
   ],
diff --git a/integration/graphql-schema-first/src/async-options-existing.module.ts b/integration/graphql-schema-first/src/async-options-existing.module.ts
index 9bfe86369..e68b65ada 100644
--- a/integration/graphql-schema-first/src/async-options-existing.module.ts
+++ b/integration/graphql-schema-first/src/async-options-existing.module.ts
@@ -1,3 +1,4 @@
+import { ApolloDriver, ApolloDriverConfig } from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
 import { GraphQLModule } from '@nestjs/graphql';
 import { CatsModule } from './cats/cats.module';
@@ -7,7 +8,8 @@ import { ConfigService } from './config.service';
 @Module({
   imports: [
     CatsModule,
-    GraphQLModule.forRootAsync({
+    GraphQLModule.forRootAsync<ApolloDriverConfig>({
+      driver: ApolloDriver,
       imports: [ConfigModule],
       useExisting: ConfigService,
     }),
diff --git a/integration/graphql-schema-first/src/async-options.module.ts b/integration/graphql-schema-first/src/async-options.module.ts
index 77dfb471d..c123cbc97 100644
--- a/integration/graphql-schema-first/src/async-options.module.ts
+++ b/integration/graphql-schema-first/src/async-options.module.ts
@@ -1,3 +1,4 @@
+import { ApolloDriver, ApolloDriverConfig } from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
 import { GraphQLModule } from '@nestjs/graphql';
 import { join } from 'path';
@@ -6,7 +7,8 @@ import { CatsModule } from './cats/cats.module';
 @Module({
   imports: [
     CatsModule,
-    GraphQLModule.forRootAsync({
+    GraphQLModule.forRootAsync<ApolloDriverConfig>({
+      driver: ApolloDriver,
       useFactory: async () => ({
         typePaths: [join(__dirname, '**', '*.graphql')],
       }),
diff --git a/integration/hello-world/e2e/exclude-middleware-fastify.spec.ts b/integration/hello-world/e2e/exclude-middleware-fastify.spec.ts
index b3bbca679..2622d4cd0 100644
--- a/integration/hello-world/e2e/exclude-middleware-fastify.spec.ts
+++ b/integration/hello-world/e2e/exclude-middleware-fastify.spec.ts
@@ -13,7 +13,7 @@ import {
 } from '@nestjs/platform-fastify';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 const RETURN_VALUE = 'test';
 const MIDDLEWARE_VALUE = 'middleware';
@@ -57,7 +57,7 @@ class TestController {
 }
 
 @Module({
-  imports: [ApplicationModule],
+  imports: [AppModule],
   controllers: [TestController],
 })
 class TestModule {
diff --git a/integration/hello-world/e2e/exclude-middleware.spec.ts b/integration/hello-world/e2e/exclude-middleware.spec.ts
index 0b0fe2d74..1bc6f3df2 100644
--- a/integration/hello-world/e2e/exclude-middleware.spec.ts
+++ b/integration/hello-world/e2e/exclude-middleware.spec.ts
@@ -9,7 +9,7 @@ import {
 } from '@nestjs/common';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 const RETURN_VALUE = 'test';
 const MIDDLEWARE_VALUE = 'middleware';
@@ -48,7 +48,7 @@ class TestController {
 }
 
 @Module({
-  imports: [ApplicationModule],
+  imports: [AppModule],
   controllers: [TestController],
 })
 class TestModule {
diff --git a/integration/hello-world/e2e/express-instance.spec.ts b/integration/hello-world/e2e/express-instance.spec.ts
index 9774487a2..9d5840e65 100644
--- a/integration/hello-world/e2e/express-instance.spec.ts
+++ b/integration/hello-world/e2e/express-instance.spec.ts
@@ -3,7 +3,7 @@ import { ExpressAdapter } from '@nestjs/platform-express';
 import { Test } from '@nestjs/testing';
 import * as express from 'express';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 describe('Hello world (express instance)', () => {
   let server;
@@ -11,7 +11,7 @@ describe('Hello world (express instance)', () => {
 
   beforeEach(async () => {
     const module = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
 
     app = module.createNestApplication(new ExpressAdapter(express()));
diff --git a/integration/hello-world/e2e/express-multiple.spec.ts b/integration/hello-world/e2e/express-multiple.spec.ts
index 431e896b7..1f799d479 100644
--- a/integration/hello-world/e2e/express-multiple.spec.ts
+++ b/integration/hello-world/e2e/express-multiple.spec.ts
@@ -3,7 +3,7 @@ import { ExpressAdapter } from '@nestjs/platform-express';
 import { Test } from '@nestjs/testing';
 import * as express from 'express';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 describe('Hello world (express instance with multiple applications)', () => {
   let server;
@@ -11,10 +11,10 @@ describe('Hello world (express instance with multiple applications)', () => {
 
   beforeEach(async () => {
     const module1 = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
     const module2 = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
 
     const adapter = new ExpressAdapter(express());
diff --git a/integration/hello-world/e2e/fastify-adapter.spec.ts b/integration/hello-world/e2e/fastify-adapter.spec.ts
index 2846b0edd..25d263b20 100644
--- a/integration/hello-world/e2e/fastify-adapter.spec.ts
+++ b/integration/hello-world/e2e/fastify-adapter.spec.ts
@@ -4,14 +4,14 @@ import {
 } from '@nestjs/platform-fastify';
 import { Test } from '@nestjs/testing';
 import { expect } from 'chai';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 describe('Hello world (fastify adapter)', () => {
   let app: NestFastifyApplication;
 
   beforeEach(async () => {
     const module = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
 
     app = module.createNestApplication<NestFastifyApplication>(
diff --git a/integration/hello-world/e2e/guards.spec.ts b/integration/hello-world/e2e/guards.spec.ts
index 08e372e00..970826123 100644
--- a/integration/hello-world/e2e/guards.spec.ts
+++ b/integration/hello-world/e2e/guards.spec.ts
@@ -6,7 +6,7 @@ import {
 import { APP_GUARD } from '@nestjs/core';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 @Injectable()
 export class AuthGuard {
@@ -20,7 +20,7 @@ export class AuthGuard {
 
 function createTestModule(guard) {
   return Test.createTestingModule({
-    imports: [ApplicationModule],
+    imports: [AppModule],
     providers: [
       {
         provide: APP_GUARD,
diff --git a/integration/hello-world/e2e/hello-world.spec.ts b/integration/hello-world/e2e/hello-world.spec.ts
index 531a65160..e2f3a895f 100644
--- a/integration/hello-world/e2e/hello-world.spec.ts
+++ b/integration/hello-world/e2e/hello-world.spec.ts
@@ -1,7 +1,7 @@
 import * as request from 'supertest';
 import { Test } from '@nestjs/testing';
 import { INestApplication } from '@nestjs/common';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 describe('Hello world (default adapter)', () => {
   let server;
@@ -9,7 +9,7 @@ describe('Hello world (default adapter)', () => {
 
   beforeEach(async () => {
     const module = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
 
     app = module.createNestApplication();
diff --git a/integration/hello-world/e2e/interceptors.spec.ts b/integration/hello-world/e2e/interceptors.spec.ts
index 11222c514..c9a0c3179 100644
--- a/integration/hello-world/e2e/interceptors.spec.ts
+++ b/integration/hello-world/e2e/interceptors.spec.ts
@@ -10,7 +10,7 @@ import { Test } from '@nestjs/testing';
 import { of } from 'rxjs';
 import { map } from 'rxjs/operators';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 const RETURN_VALUE = 'test';
 
@@ -58,7 +58,7 @@ export class HeaderInterceptor {
 
 function createTestModule(interceptor) {
   return Test.createTestingModule({
-    imports: [ApplicationModule],
+    imports: [AppModule],
     providers: [
       {
         provide: APP_INTERCEPTOR,
diff --git a/integration/hello-world/e2e/local-pipes.spec.ts b/integration/hello-world/e2e/local-pipes.spec.ts
index 5bc4a66d8..e982bc4ae 100644
--- a/integration/hello-world/e2e/local-pipes.spec.ts
+++ b/integration/hello-world/e2e/local-pipes.spec.ts
@@ -1,7 +1,7 @@
 import { INestApplication } from '@nestjs/common';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 describe('Hello world (default adapter)', () => {
   let server;
@@ -9,7 +9,7 @@ describe('Hello world (default adapter)', () => {
 
   beforeEach(async () => {
     const module = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
 
     app = module.createNestApplication();
diff --git a/integration/hello-world/e2e/middleware-class.spec.ts b/integration/hello-world/e2e/middleware-class.spec.ts
index 134222611..e71a12ec5 100644
--- a/integration/hello-world/e2e/middleware-class.spec.ts
+++ b/integration/hello-world/e2e/middleware-class.spec.ts
@@ -9,7 +9,7 @@ import {
 } from '@nestjs/common';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 import { Response } from 'express';
 
 const INCLUDED_VALUE = 'test_included';
@@ -32,7 +32,7 @@ class TestController {
 }
 
 @Module({
-  imports: [ApplicationModule],
+  imports: [AppModule],
   controllers: [TestController],
 })
 class TestModule {
diff --git a/integration/hello-world/e2e/middleware-fastify.spec.ts b/integration/hello-world/e2e/middleware-fastify.spec.ts
index 4fe34a0b3..de8040759 100644
--- a/integration/hello-world/e2e/middleware-fastify.spec.ts
+++ b/integration/hello-world/e2e/middleware-fastify.spec.ts
@@ -12,7 +12,7 @@ import {
 } from '@nestjs/platform-fastify';
 import { Test } from '@nestjs/testing';
 import { expect } from 'chai';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 const INCLUDED_VALUE = 'test_included';
 const QUERY_VALUE = 'test_query';
@@ -58,7 +58,7 @@ class TestQueryController {
 }
 
 @Module({
-  imports: [ApplicationModule],
+  imports: [AppModule],
   controllers: [TestController, TestQueryController],
 })
 class TestModule {
diff --git a/integration/hello-world/e2e/middleware.spec.ts b/integration/hello-world/e2e/middleware.spec.ts
index d6347464f..ccb20b2ce 100644
--- a/integration/hello-world/e2e/middleware.spec.ts
+++ b/integration/hello-world/e2e/middleware.spec.ts
@@ -7,7 +7,7 @@ import {
 } from '@nestjs/common';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 const RETURN_VALUE = 'test';
 const SCOPED_VALUE = 'test_scoped';
@@ -27,7 +27,7 @@ class TestController {
 }
 
 @Module({
-  imports: [ApplicationModule],
+  imports: [AppModule],
   controllers: [TestController],
 })
 class TestModule {
diff --git a/integration/hello-world/e2e/router-module-middleware.spec.ts b/integration/hello-world/e2e/router-module-middleware.spec.ts
index bc386e404..52fe55ced 100644
--- a/integration/hello-world/e2e/router-module-middleware.spec.ts
+++ b/integration/hello-world/e2e/router-module-middleware.spec.ts
@@ -8,7 +8,7 @@ import {
 import { RouterModule } from '@nestjs/core';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 const RETURN_VALUE = 'test';
 const SCOPED_VALUE = 'test_scoped';
@@ -27,7 +27,7 @@ class TestController {
 }
 
 @Module({
-  imports: [ApplicationModule],
+  imports: [AppModule],
   controllers: [TestController],
 })
 class TestModule {
diff --git a/integration/hello-world/src/app.module.ts b/integration/hello-world/src/app.module.ts
index 982d6c65f..b34bf1cfe 100644
--- a/integration/hello-world/src/app.module.ts
+++ b/integration/hello-world/src/app.module.ts
@@ -6,4 +6,4 @@ import { HostModule } from './host/host.module';
 @Module({
   imports: [HelloModule, HostModule, HostArrayModule],
 })
-export class ApplicationModule {}
+export class AppModule {}
diff --git a/integration/injector/e2e/injector.spec.ts b/integration/injector/e2e/injector.spec.ts
index 95208f618..5fd489676 100644
--- a/integration/injector/e2e/injector.spec.ts
+++ b/integration/injector/e2e/injector.spec.ts
@@ -1,7 +1,10 @@
 import { RuntimeException } from '@nestjs/core/errors/exceptions/runtime.exception';
+import { UnknownDependenciesException } from '@nestjs/core/errors/exceptions/unknown-dependencies.exception';
 import { UnknownExportException } from '@nestjs/core/errors/exceptions/unknown-export.exception';
 import { Test } from '@nestjs/testing';
 import { expect } from 'chai';
+import * as chai from 'chai';
+import * as chaiAsPromised from 'chai-as-promised';
 import {
   DYNAMIC_TOKEN,
   DYNAMIC_VALUE,
@@ -9,6 +12,13 @@ import {
 } from '../src/dynamic/dynamic.module';
 import { ExportsModule } from '../src/exports/exports.module';
 import { InjectModule } from '../src/inject/inject.module';
+import { InjectSameNameModule } from '../src/inject/inject-same-name.module';
+import {
+  SelfInjectionProviderModule,
+  SelfInjectionProviderCustomTokenModule,
+  SelfInjectionForwardProviderModule,
+} from '../src/self-injection/self-injection-provider.module';
+chai.use(chaiAsPromised);
 
 describe('Injector', () => {
   describe('when "providers" and "exports" properties are inconsistent', () => {
@@ -24,6 +34,16 @@ describe('Injector', () => {
     });
   });
 
+  describe("When class injects a provider with the same as class's name", () => {
+    it('should compile with success', async () => {
+      const builder = Test.createTestingModule({
+        imports: [InjectSameNameModule],
+      });
+
+      await expect(builder.compile()).to.eventually.be.fulfilled;
+    });
+  });
+
   describe('when Nest cannot resolve dependencies', () => {
     it(`should fail with "RuntimeException"`, async () => {
       try {
@@ -35,6 +55,42 @@ describe('Injector', () => {
         expect(err).to.be.instanceof(RuntimeException);
       }
     });
+
+    describe('due to self-injection providers', () => {
+      it('should fail with "UnknownDependenciesException" due to self-injection via same class reference', async () => {
+        const builder = Test.createTestingModule({
+          imports: [SelfInjectionProviderModule],
+        });
+
+        await expect(
+          builder.compile(),
+        ).to.eventually.be.rejected.and.be.an.instanceOf(
+          UnknownDependenciesException,
+        );
+      });
+      it('should fail with "UnknownDependenciesException" due to self-injection via forwardRef to the same class reference', async () => {
+        const builder = Test.createTestingModule({
+          imports: [SelfInjectionForwardProviderModule],
+        });
+
+        await expect(
+          builder.compile(),
+        ).to.eventually.be.rejected.and.be.an.instanceOf(
+          UnknownDependenciesException,
+        );
+      });
+      it('should fail with "UnknownDependenciesException" due to self-injection via custom provider', async () => {
+        const builder = Test.createTestingModule({
+          imports: [SelfInjectionProviderCustomTokenModule],
+        });
+
+        await expect(
+          builder.compile(),
+        ).to.eventually.be.rejected.and.be.an.instanceOf(
+          UnknownDependenciesException,
+        );
+      });
+    });
   });
 
   describe('when dynamic module', () => {
diff --git a/integration/injector/e2e/optional-factory-provider-dep.spec.ts b/integration/injector/e2e/optional-factory-provider-dep.spec.ts
new file mode 100644
index 000000000..e5162d03c
--- /dev/null
+++ b/integration/injector/e2e/optional-factory-provider-dep.spec.ts
@@ -0,0 +1,96 @@
+import { UnknownDependenciesException } from '@nestjs/core/errors/exceptions/unknown-dependencies.exception';
+import { Test } from '@nestjs/testing';
+import { expect } from 'chai';
+
+describe('Optional factory provider deps', () => {
+  describe('when dependency is optional', () => {
+    describe('and it is available', () => {
+      it('then it should be injected into the factory function', async () => {
+        const defaultValue = 'DEFAULT_VALUE';
+        const moduleRef = await Test.createTestingModule({
+          providers: [
+            {
+              provide: 'FACTORY',
+              useFactory: dep => dep ?? defaultValue,
+              inject: [{ token: 'MISSING_DEP', optional: true }],
+            },
+            { provide: 'MISSING_DEP', useValue: 'OPTIONAL_DEP_VALUE' },
+          ],
+        }).compile();
+
+        const factoryProvider = moduleRef.get('FACTORY');
+        expect(factoryProvider).to.equal('OPTIONAL_DEP_VALUE');
+      });
+    });
+    describe('otherwise', () => {
+      it('"undefined" should be injected into the factory function', async () => {
+        const defaultValue = 'DEFAULT_VALUE';
+        const moduleRef = await Test.createTestingModule({
+          providers: [
+            {
+              provide: 'FACTORY',
+              useFactory: dep => dep ?? defaultValue,
+              inject: [{ token: 'MISSING_DEP', optional: true }],
+            },
+          ],
+        }).compile();
+
+        const factoryProvider = moduleRef.get('FACTORY');
+        expect(factoryProvider).to.equal(defaultValue);
+      });
+    });
+  });
+  describe('otherwise', () => {
+    describe('and dependency is not registered', () => {
+      it('should error out', async () => {
+        try {
+          const builder = Test.createTestingModule({
+            providers: [
+              {
+                provide: 'FACTORY',
+                useFactory: () => 'RETURNED_VALUE',
+                inject: ['MISSING_DEP'],
+              },
+            ],
+          });
+          await builder.compile();
+        } catch (err) {
+          expect(err).to.be.instanceOf(UnknownDependenciesException);
+        }
+      });
+    });
+  });
+  describe('and dependency is registered but it cannot be instantiated', () => {
+    it('should error out', async () => {
+      try {
+        const builder = Test.createTestingModule({
+          providers: [
+            {
+              provide: 'POSSIBLY_MISSING_DEP',
+              useFactory: () => null,
+              inject: ['MISSING_DEP'],
+            },
+            {
+              provide: 'FACTORY',
+              useFactory: () => 'RETURNED_VALUE',
+              inject: [{ token: 'POSSIBLY_MISSING_DEP', optional: false }],
+            },
+          ],
+        });
+        await builder.compile();
+      } catch (err) {
+        expect(err).to.be.instanceOf(UnknownDependenciesException);
+        expect(err.message).to
+          .equal(`Nest can't resolve dependencies of the POSSIBLY_MISSING_DEP (?). Please make sure that the argument MISSING_DEP at index [0] is available in the RootTestModule context.
+
+Potential solutions:
+- If MISSING_DEP is a provider, is it part of the current RootTestModule?
+- If MISSING_DEP is exported from a separate @Module, is that module imported within RootTestModule?
+  @Module({
+    imports: [ /* the Module containing MISSING_DEP */ ]
+  })
+`);
+      }
+    });
+  });
+});
diff --git a/integration/injector/src/inject/inject-same-name.module.ts b/integration/injector/src/inject/inject-same-name.module.ts
new file mode 100644
index 000000000..f66fd51a7
--- /dev/null
+++ b/integration/injector/src/inject/inject-same-name.module.ts
@@ -0,0 +1,16 @@
+import { Module, Injectable, Inject } from '@nestjs/common';
+
+@Injectable()
+class CoreService {
+  constructor(@Inject(CoreService.name) private readonly coreService: any) {}
+}
+
+@Module({
+  providers: [
+    {
+      provide: CoreService.name,
+      useValue: 'anything',
+    },
+  ],
+})
+export class InjectSameNameModule {}
diff --git a/integration/injector/src/self-injection/self-injection-provider.module.ts b/integration/injector/src/self-injection/self-injection-provider.module.ts
new file mode 100644
index 000000000..6850c75dc
--- /dev/null
+++ b/integration/injector/src/self-injection/self-injection-provider.module.ts
@@ -0,0 +1,40 @@
+import { Module, Injectable, Inject, forwardRef } from '@nestjs/common';
+
+@Injectable()
+class ServiceInjectingItself {
+  constructor(private readonly coreService: ServiceInjectingItself) {}
+}
+
+@Injectable()
+class ServiceInjectingItselfForwared {
+  constructor(
+    @Inject(forwardRef(() => ServiceInjectingItself))
+    private readonly coreService: ServiceInjectingItself,
+  ) {}
+}
+
+@Injectable()
+class ServiceInjectingItselfViaCustomToken {
+  constructor(@Inject('AnotherToken') private readonly coreService: any) {}
+}
+
+@Module({
+  providers: [ServiceInjectingItself],
+})
+export class SelfInjectionProviderModule {}
+
+@Module({
+  providers: [ServiceInjectingItselfForwared],
+})
+export class SelfInjectionForwardProviderModule {}
+
+@Module({
+  providers: [
+    ServiceInjectingItselfViaCustomToken,
+    {
+      provide: 'AnotherToken',
+      useClass: ServiceInjectingItselfViaCustomToken,
+    },
+  ],
+})
+export class SelfInjectionProviderCustomTokenModule {}
diff --git a/integration/microservices/e2e/disconnected-client.spec.ts b/integration/microservices/e2e/disconnected-client.spec.ts
index dcd4c03cc..35b65dfb6 100644
--- a/integration/microservices/e2e/disconnected-client.spec.ts
+++ b/integration/microservices/e2e/disconnected-client.spec.ts
@@ -34,7 +34,7 @@ describe('Disconnected client', () => {
       .send({
         transport: Transport.REDIS,
         options: {
-          url: 'redis://localhost:3333',
+          port: '3333',
         },
       })
       .expect(408);
@@ -65,6 +65,19 @@ describe('Disconnected client', () => {
       .expect(408);
   });
 
+  it(`RMQ`, () => {
+    return request(server)
+      .post('/')
+      .send({
+        transport: Transport.RMQ,
+        options: {
+          urls: [`amqp://0.0.0.0:3333`],
+          queue: 'test',
+        },
+      })
+      .expect(408);
+  });
+
   afterEach(async () => {
     await app.close();
   });
diff --git a/integration/microservices/e2e/orders-grpc.spec.ts b/integration/microservices/e2e/orders-grpc.spec.ts
index 82f1d69e0..d3c293ef6 100644
--- a/integration/microservices/e2e/orders-grpc.spec.ts
+++ b/integration/microservices/e2e/orders-grpc.spec.ts
@@ -134,7 +134,7 @@ describe('Advanced GRPC transport', () => {
     callHandler.on('error', (err: any) => {
       // We want to fail only on real errors while Cancellation error
       // is expected
-      if (String(err).toLowerCase().indexOf('cancelled') === -1) {
+      if (!String(err).toLowerCase().includes('cancelled')) {
         fail('gRPC Stream error happened, error: ' + err);
       }
     });
@@ -166,7 +166,7 @@ describe('Advanced GRPC transport', () => {
     callHandler.on('error', (err: any) => {
       // We want to fail only on real errors while Cancellation error
       // is expected
-      if (String(err).toLowerCase().indexOf('cancelled') === -1) {
+      if (!String(err).toLowerCase().includes('cancelled')) {
         fail('gRPC Stream error happened, error: ' + err);
       }
     });
diff --git a/integration/microservices/e2e/sum-grpc.spec.ts b/integration/microservices/e2e/sum-grpc.spec.ts
index 23cc9a886..cc4dbe45a 100644
--- a/integration/microservices/e2e/sum-grpc.spec.ts
+++ b/integration/microservices/e2e/sum-grpc.spec.ts
@@ -48,11 +48,16 @@ describe('GRPC transport', () => {
     );
   });
 
-  it(`GRPC Sending and Receiving HTTP POST`, () => {
-    return request(server)
+  it(`GRPC Sending and Receiving HTTP POST`, async () => {
+    await request(server)
       .post('/sum')
       .send([1, 2, 3, 4, 5])
       .expect(200, { result: 15 });
+
+    await request(server)
+      .post('/upperMethod/sum')
+      .send([1, 2, 3, 4, 5])
+      .expect(200, { result: 15 });
   });
 
   it(`GRPC Sending and Receiving HTTP POST (multiple proto)`, async () => {
@@ -78,7 +83,7 @@ describe('GRPC transport', () => {
     callHandler.on('error', (err: any) => {
       // We want to fail only on real errors while Cancellation error
       // is expected
-      if (String(err).toLowerCase().indexOf('cancelled') === -1) {
+      if (!String(err).toLowerCase().includes('cancelled')) {
         fail('gRPC Stream error happened, error: ' + err);
       }
     });
@@ -100,7 +105,7 @@ describe('GRPC transport', () => {
     callHandler.on('error', (err: any) => {
       // We want to fail only on real errors while Cancellation error
       // is expected
-      if (String(err).toLowerCase().indexOf('cancelled') === -1) {
+      if (!String(err).toLowerCase().includes('cancelled')) {
         fail('gRPC Stream error happened, error: ' + err);
       }
     });
diff --git a/integration/microservices/e2e/sum-mqtt.spec.ts b/integration/microservices/e2e/sum-mqtt.spec.ts
index 7d81b9f1f..2b2320e67 100644
--- a/integration/microservices/e2e/sum-mqtt.spec.ts
+++ b/integration/microservices/e2e/sum-mqtt.spec.ts
@@ -47,7 +47,7 @@ describe('MQTT transport', () => {
       .post('/?command=streamSum')
       .send([1, 2, 3, 4, 5])
       .expect(200, '15');
-  });
+  }).timeout(5000);
 
   it(`/POST (concurrent)`, function () {
     return request(server)
@@ -72,7 +72,7 @@ describe('MQTT transport', () => {
       .post('/stream')
       .send([1, 2, 3, 4, 5])
       .expect(200, '15');
-  });
+  }).timeout(5000);
 
   it(`/POST (event notification)`, done => {
     request(server)
@@ -124,6 +124,44 @@ describe('MQTT transport', () => {
       .expect(201, '15');
   });
 
+  it(`/POST (shared wildcard EVENT #)`, done => {
+    request(server)
+      .post('/shared-wildcard-event')
+      .send([1, 2, 3, 4, 5])
+      .end(() => {
+        setTimeout(() => {
+          expect(MqttController.IS_SHARED_WILDCARD_EVENT_RECEIVED).to.be.true;
+          done();
+        }, 1000);
+      });
+  });
+
+  it(`/POST (shared wildcard MESSAGE #)`, () => {
+    return request(server)
+      .post('/shared-wildcard-message')
+      .send([1, 2, 3, 4, 5])
+      .expect(201, '15');
+  });
+
+  it(`/POST (shared wildcard EVENT +)`, done => {
+    request(server)
+      .post('/shared-wildcard-event2')
+      .send([1, 2, 3, 4, 5])
+      .end(() => {
+        setTimeout(() => {
+          expect(MqttController.IS_SHARED_WILDCARD2_EVENT_RECEIVED).to.be.true;
+          done();
+        }, 1000);
+      });
+  });
+
+  it(`/POST (shared wildcard MESSAGE +)`, () => {
+    return request(server)
+      .post('/shared-wildcard-message2')
+      .send([1, 2, 3, 4, 5])
+      .expect(201, '15');
+  });
+
   afterEach(async () => {
     await app.close();
   });
diff --git a/integration/microservices/e2e/sum-rmq.spec.ts b/integration/microservices/e2e/sum-rmq.spec.ts
index f5f0e0a36..97ac90749 100644
--- a/integration/microservices/e2e/sum-rmq.spec.ts
+++ b/integration/microservices/e2e/sum-rmq.spec.ts
@@ -77,6 +77,13 @@ describe('RabbitMQ transport', () => {
       .expect(200, '15');
   });
 
+  it(`/POST (multiple-urls)`, () => {
+    return request(server)
+      .post('/multiple-urls')
+      .send([1, 2, 3, 4, 5])
+      .expect(200, '15');
+  }).timeout(10000);
+
   it(`/POST (event notification)`, done => {
     request(server)
       .post('/notify')
diff --git a/integration/microservices/e2e/sum-rpc.spec.ts b/integration/microservices/e2e/sum-rpc.spec.ts
index 85cf67705..54a9bc360 100644
--- a/integration/microservices/e2e/sum-rpc.spec.ts
+++ b/integration/microservices/e2e/sum-rpc.spec.ts
@@ -4,7 +4,7 @@ import { Test } from '@nestjs/testing';
 import { expect } from 'chai';
 import * as request from 'supertest';
 import { AppController } from '../src/app.controller';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 describe('RPC transport', () => {
   let server;
@@ -12,7 +12,7 @@ describe('RPC transport', () => {
 
   beforeEach(async () => {
     const module = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
 
     app = module.createNestApplication();
diff --git a/integration/microservices/src/app.module.ts b/integration/microservices/src/app.module.ts
index c9ac72909..dacf646e4 100644
--- a/integration/microservices/src/app.module.ts
+++ b/integration/microservices/src/app.module.ts
@@ -72,4 +72,4 @@ class ClientOptionService implements ClientsModuleOptionsFactory {
   ],
   controllers: [AppController],
 })
-export class ApplicationModule {}
+export class AppModule {}
diff --git a/integration/microservices/src/disconnected.controller.ts b/integration/microservices/src/disconnected.controller.ts
index 0f529c948..0212ab1ce 100644
--- a/integration/microservices/src/disconnected.controller.ts
+++ b/integration/microservices/src/disconnected.controller.ts
@@ -3,7 +3,7 @@ import {
   Controller,
   InternalServerErrorException,
   Post,
-  RequestTimeoutException,
+  RequestTimeoutException
 } from '@nestjs/common';
 import { ClientProxyFactory } from '@nestjs/microservices';
 import { Observable, throwError } from 'rxjs';
@@ -15,16 +15,17 @@ export class DisconnectedClientController {
   call(@Body() options): Observable<number> {
     const client = ClientProxyFactory.create(options);
     return client.send<number, number[]>({ cmd: 'none' }, [1, 2, 3]).pipe(
-      /*tap(
-          console.log.bind(console, 'data'),
-          console.error.bind(console, 'error'),
-        ),*/
+      // tap(
+      //   console.log.bind(console, 'data'),
+      //   console.error.bind(console, 'error'),
+      // ),
       catchError(error => {
-        const { code } = error || { code: 'CONN_ERR' };
+        const { code } = error?.err ?? error ?? { code: 'CONN_ERR' };
         return throwError(() =>
           code === 'ECONNREFUSED' ||
           code === 'CONN_ERR' ||
-          code === 'CONNECTION_REFUSED'
+          code === 'CONNECTION_REFUSED' ||
+          error.message === 'Connection is closed.'
             ? new RequestTimeoutException('ECONNREFUSED')
             : new InternalServerErrorException(),
         );
diff --git a/integration/microservices/src/grpc-advanced/advanced.grpc.controller.ts b/integration/microservices/src/grpc-advanced/advanced.grpc.controller.ts
index 930644909..e4aa0234b 100644
--- a/integration/microservices/src/grpc-advanced/advanced.grpc.controller.ts
+++ b/integration/microservices/src/grpc-advanced/advanced.grpc.controller.ts
@@ -134,8 +134,8 @@ export class AdvancedGrpcController {
   async streamReq(messages: Observable<any>): Promise<any> {
     const s = new Subject();
     const o = s.asObservable();
-    messages.subscribe(
-      msg => {
+    messages.subscribe({
+      next: () => {
         s.next({
           id: 1,
           itemTypes: [1],
@@ -146,9 +146,8 @@ export class AdvancedGrpcController {
           },
         });
       },
-      null,
-      () => s.complete(),
-    );
+      complete: () => s.complete(),
+    });
     return o;
   }
 
diff --git a/integration/microservices/src/grpc/grpc.controller.ts b/integration/microservices/src/grpc/grpc.controller.ts
index 9414de5f2..94b7c4f75 100644
--- a/integration/microservices/src/grpc/grpc.controller.ts
+++ b/integration/microservices/src/grpc/grpc.controller.ts
@@ -40,6 +40,14 @@ export class GrpcController {
     return svc.sum({ data });
   }
 
+  // Test that getService generate both lower and uppercase method
+  @Post('upperMethod/sum')
+  @HttpCode(200)
+  callWithOptions(@Body() data: number[]): Observable<number> {
+    const svc = this.client.getService<any>('Math');
+    return svc.Sum({ data });
+  }
+
   @GrpcMethod('Math')
   async sum({ data }: { data: number[] }): Promise<any> {
     return of({
@@ -50,16 +58,16 @@ export class GrpcController {
   @GrpcStreamMethod('Math')
   async sumStream(messages: Observable<any>): Promise<any> {
     return new Promise<any>((resolve, reject) => {
-      messages.subscribe(
-        msg => {
+      messages.subscribe({
+        next: msg => {
           resolve({
             result: msg.data.reduce((a, b) => a + b),
           });
         },
-        err => {
+        error: err => {
           reject(err);
         },
-      );
+      });
     });
   }
 
diff --git a/integration/microservices/src/mqtt/mqtt.controller.ts b/integration/microservices/src/mqtt/mqtt.controller.ts
index c8d813efa..72de41d5c 100644
--- a/integration/microservices/src/mqtt/mqtt.controller.ts
+++ b/integration/microservices/src/mqtt/mqtt.controller.ts
@@ -18,6 +18,8 @@ export class MqttController {
   static IS_NOTIFIED = false;
   static IS_WILDCARD_EVENT_RECEIVED = false;
   static IS_WILDCARD2_EVENT_RECEIVED = false;
+  static IS_SHARED_WILDCARD_EVENT_RECEIVED = false;
+  static IS_SHARED_WILDCARD2_EVENT_RECEIVED = false;
 
   @Client({ transport: Transport.MQTT })
   client: ClientProxy;
@@ -93,7 +95,7 @@ export class MqttController {
   @Post('record-builder-duplex')
   @HttpCode(200)
   useRecordBuilderDuplex(@Body() data: Record<string, any>) {
-    const record = new MqttRecordBuilder(data).setQoS(2).build();
+    const record = new MqttRecordBuilder(data).setQoS(1).build();
     return this.client.send('record-builder-duplex', record);
   }
 
@@ -109,6 +111,32 @@ export class MqttController {
     };
   }
 
+  @Post('shared-wildcard-event')
+  async sendSharedWildcardEvent(): Promise<any> {
+    return this.client.emit<number>('shared-wildcard-event/test', true);
+  }
+
+  @Post('shared-wildcard-message')
+  async sendSharedWildcardMessage(
+    @Body() data: number[],
+  ): Promise<Observable<number>> {
+    await this.client.connect();
+    return this.client.send<number>('shared-wildcard-message/test', data);
+  }
+
+  @Post('shared-wildcard-event2')
+  async sendSharedWildcardEvent2(): Promise<any> {
+    return this.client.emit<number>('shared-wildcard-event2/test/test', true);
+  }
+
+  @Post('shared-wildcard-message2')
+  async sendSharedWildcardMessage2(
+    @Body() data: number[],
+  ): Promise<Observable<number>> {
+    await this.client.connect();
+    return this.client.send<number>('shared-wildcard-message2/test/test', data);
+  }
+
   @MessagePattern('wildcard-message/#')
   wildcardMessageHandler(data: number[]): number {
     if ((data as any).response) {
@@ -156,4 +184,27 @@ export class MqttController {
   streaming(data: number[]): Observable<number> {
     return from(data);
   }
+
+  @MessagePattern('$share/test-group/shared-wildcard-message/#')
+  sharedWildcardMessageHandler(data: number[]): number {
+    if ((data as any).response) {
+      return;
+    }
+    return (data || []).reduce((a, b) => a + b);
+  }
+
+  @EventPattern('$share/test-group/shared-wildcard-event/#')
+  sharedWildcardEventHandler(data: boolean) {
+    MqttController.IS_SHARED_WILDCARD_EVENT_RECEIVED = data;
+  }
+
+  @MessagePattern('$share/test-group/shared-wildcard-message2/+/test')
+  sharedWildcardMessageHandler2(data: number[]): number {
+    return (data || []).reduce((a, b) => a + b);
+  }
+
+  @EventPattern('$share/test-group/shared-wildcard-event2/+/test')
+  sharedWildcardEventHandler2(data: boolean) {
+    MqttController.IS_SHARED_WILDCARD2_EVENT_RECEIVED = data;
+  }
 }
diff --git a/integration/microservices/src/rmq/rmq.controller.ts b/integration/microservices/src/rmq/rmq.controller.ts
index 932bb46a9..07f8075e6 100644
--- a/integration/microservices/src/rmq/rmq.controller.ts
+++ b/integration/microservices/src/rmq/rmq.controller.ts
@@ -61,6 +61,21 @@ export class RMQController {
       .reduce(async (a, b) => (await a) && b);
   }
 
+  @Post('multiple-urls')
+  @HttpCode(200)
+  multipleUrls(@Body() data: number[]) {
+    const clientWithMultipleUrls = ClientProxyFactory.create({
+      transport: Transport.RMQ,
+      options: {
+        urls: [`amqp://localhost:5671`, `amqp://localhost:5672`],
+        queue: 'test',
+        queueOptions: { durable: false },
+        socketOptions: { noDelay: true },
+      },
+    });
+    return clientWithMultipleUrls.send<number>({ cmd: 'multiple-urls' }, data);
+  }
+
   @Post('record-builder-duplex')
   @HttpCode(200)
   useRecordBuilderDuplex(@Body() data: Record<string, any>) {
@@ -109,6 +124,11 @@ export class RMQController {
     return from(data);
   }
 
+  @MessagePattern({ cmd: 'multiple-urls' })
+  handleMultipleUrls(data: number[]): number {
+    return (data || []).reduce((a, b) => a + b);
+  }
+
   @Post('notify')
   async sendNotification(): Promise<any> {
     return this.client.emit<number>('notification', true);
diff --git a/integration/module-utils/src/integration.module-definition.ts b/integration/module-utils/src/integration.module-definition.ts
new file mode 100644
index 000000000..89d7a9842
--- /dev/null
+++ b/integration/module-utils/src/integration.module-definition.ts
@@ -0,0 +1,17 @@
+import { ConfigurableModuleBuilder } from '@nestjs/common';
+import { IntegrationModuleOptions } from './interfaces/integration-module-options.interface';
+
+export const { ConfigurableModuleClass, MODULE_OPTIONS_TOKEN } =
+  new ConfigurableModuleBuilder<IntegrationModuleOptions>()
+    .setClassMethodName('forRoot')
+    .setFactoryMethodName('construct')
+    .setExtras(
+      {
+        isGlobal: true,
+      },
+      (definition, extras) => ({
+        ...definition,
+        global: extras.isGlobal,
+      }),
+    )
+    .build();
diff --git a/integration/module-utils/src/integration.module.ts b/integration/module-utils/src/integration.module.ts
new file mode 100644
index 000000000..3b994f4bd
--- /dev/null
+++ b/integration/module-utils/src/integration.module.ts
@@ -0,0 +1,16 @@
+import { Inject, Module } from '@nestjs/common';
+import {
+  ConfigurableModuleClass,
+  MODULE_OPTIONS_TOKEN,
+} from './integration.module-definition';
+import { IntegrationModuleOptions } from './interfaces/integration-module-options.interface';
+
+@Module({})
+export class IntegrationModule extends ConfigurableModuleClass {
+  constructor(
+    @Inject(MODULE_OPTIONS_TOKEN)
+    public readonly options: IntegrationModuleOptions,
+  ) {
+    super();
+  }
+}
diff --git a/integration/module-utils/src/interfaces/integration-module-options.interface.ts b/integration/module-utils/src/interfaces/integration-module-options.interface.ts
new file mode 100644
index 000000000..802e02076
--- /dev/null
+++ b/integration/module-utils/src/interfaces/integration-module-options.interface.ts
@@ -0,0 +1,4 @@
+export interface IntegrationModuleOptions {
+  url: string;
+  secure?: boolean;
+}
diff --git a/integration/module-utils/test/integration-module.spec.ts b/integration/module-utils/test/integration-module.spec.ts
new file mode 100644
index 000000000..ea22a71c5
--- /dev/null
+++ b/integration/module-utils/test/integration-module.spec.ts
@@ -0,0 +1,47 @@
+import { Test } from '@nestjs/testing';
+import { expect } from 'chai';
+import { IntegrationModule } from '../src/integration.module';
+
+describe('Module utils (ConfigurableModuleBuilder)', () => {
+  it('should auto-generate "forRoot" method', async () => {
+    const moduleRef = await Test.createTestingModule({
+      imports: [
+        IntegrationModule.forRoot({
+          isGlobal: true,
+          url: 'test_url',
+          secure: false,
+        }),
+      ],
+    }).compile();
+
+    const integrationModule = moduleRef.get(IntegrationModule);
+
+    expect(integrationModule.options).to.deep.equal({
+      url: 'test_url',
+      secure: false,
+    });
+  });
+
+  it('should auto-generate "forRootAsync" method', async () => {
+    const moduleRef = await Test.createTestingModule({
+      imports: [
+        IntegrationModule.forRootAsync({
+          isGlobal: true,
+          useFactory: () => {
+            return {
+              url: 'test_url',
+              secure: false,
+            };
+          },
+        }),
+      ],
+    }).compile();
+
+    const integrationModule = moduleRef.get(IntegrationModule);
+
+    expect(integrationModule.options).to.deep.equal({
+      url: 'test_url',
+      secure: false,
+    });
+  });
+});
diff --git a/integration/module-utils/tsconfig.json b/integration/module-utils/tsconfig.json
new file mode 100644
index 000000000..c6354c564
--- /dev/null
+++ b/integration/module-utils/tsconfig.json
@@ -0,0 +1,22 @@
+{
+  "compilerOptions": {
+    "module": "commonjs",
+    "declaration": false,
+    "noImplicitAny": false,
+    "removeComments": true,
+    "noLib": false,
+    "emitDecoratorMetadata": true,
+    "experimentalDecorators": true,
+    "target": "es6",
+    "sourceMap": true,
+    "allowJs": true,
+    "outDir": "./dist"
+  },
+  "include": [
+    "src/**/*",
+    "e2e/**/*"
+  ],
+  "exclude": [
+    "node_modules",
+  ]
+}
\ No newline at end of file
diff --git a/integration/mosquitto.conf b/integration/mosquitto.conf
new file mode 100644
index 000000000..440823741
--- /dev/null
+++ b/integration/mosquitto.conf
@@ -0,0 +1,906 @@
+# Config file for mosquitto
+#
+# See mosquitto.conf(5) for more information.
+#
+# Default values are shown, uncomment to change.
+#
+# Use the # character to indicate a comment, but only if it is the
+# very first character on the line.
+
+# =================================================================
+# General configuration
+# =================================================================
+
+# Use per listener security settings.
+#
+# It is recommended this option be set before any other options.
+#
+# If this option is set to true, then all authentication and access control
+# options are controlled on a per listener basis. The following options are
+# affected:
+#
+# acl_file
+# allow_anonymous
+# allow_zero_length_clientid
+# auto_id_prefix
+# password_file
+# plugin
+# plugin_opt_*
+# psk_file
+#
+# Note that if set to true, then a durable client (i.e. with clean session set
+# to false) that has disconnected will use the ACL settings defined for the
+# listener that it was most recently connected to.
+#
+# The default behaviour is for this to be set to false, which maintains the
+# setting behaviour from previous versions of mosquitto.
+#per_listener_settings false
+
+
+# This option controls whether a client is allowed to connect with a zero
+# length client id or not. This option only affects clients using MQTT v3.1.1
+# and later. If set to false, clients connecting with a zero length client id
+# are disconnected. If set to true, clients will be allocated a client id by
+# the broker. This means it is only useful for clients with clean session set
+# to true.
+#allow_zero_length_clientid true
+
+# If allow_zero_length_clientid is true, this option allows you to set a prefix
+# to automatically generated client ids to aid visibility in logs.
+# Defaults to 'auto-'
+#auto_id_prefix auto-
+
+# This option affects the scenario when a client subscribes to a topic that has
+# retained messages. It is possible that the client that published the retained
+# message to the topic had access at the time they published, but that access
+# has been subsequently removed. If check_retain_source is set to true, the
+# default, the source of a retained message will be checked for access rights
+# before it is republished. When set to false, no check will be made and the
+# retained message will always be published. This affects all listeners.
+#check_retain_source true
+
+# QoS 1 and 2 messages will be allowed inflight per client until this limit
+# is exceeded.  Defaults to 0. (No maximum)
+# See also max_inflight_messages
+#max_inflight_bytes 0
+
+# The maximum number of QoS 1 and 2 messages currently inflight per
+# client.
+# This includes messages that are partway through handshakes and
+# those that are being retried. Defaults to 20. Set to 0 for no
+# maximum. Setting to 1 will guarantee in-order delivery of QoS 1
+# and 2 messages.
+#max_inflight_messages 20
+
+# For MQTT v5 clients, it is possible to have the server send a "server
+# keepalive" value that will override the keepalive value set by the client.
+# This is intended to be used as a mechanism to say that the server will
+# disconnect the client earlier than it anticipated, and that the client should
+# use the new keepalive value. The max_keepalive option allows you to specify
+# that clients may only connect with keepalive less than or equal to this
+# value, otherwise they will be sent a server keepalive telling them to use
+# max_keepalive. This only applies to MQTT v5 clients. The default, and maximum
+# value allowable, is 65535.
+#
+# Set to 0 to allow clients to set keepalive = 0, which means no keepalive
+# checks are made and the client will never be disconnected by the broker if no
+# messages are received. You should be very sure this is the behaviour that you
+# want.
+#
+# For MQTT v3.1.1 and v3.1 clients, there is no mechanism to tell the client
+# what keepalive value they should use. If an MQTT v3.1.1 or v3.1 client
+# specifies a keepalive time greater than max_keepalive they will be sent a
+# CONNACK message with the "identifier rejected" reason code, and disconnected.
+#
+#max_keepalive 65535
+
+# For MQTT v5 clients, it is possible to have the server send a "maximum packet
+# size" value that will instruct the client it will not accept MQTT packets
+# with size greater than max_packet_size bytes. This applies to the full MQTT
+# packet, not just the payload. Setting this option to a positive value will
+# set the maximum packet size to that number of bytes. If a client sends a
+# packet which is larger than this value, it will be disconnected. This applies
+# to all clients regardless of the protocol version they are using, but v3.1.1
+# and earlier clients will of course not have received the maximum packet size
+# information. Defaults to no limit. Setting below 20 bytes is forbidden
+# because it is likely to interfere with ordinary client operation, even with
+# very small payloads.
+#max_packet_size 0
+
+# QoS 1 and 2 messages above those currently in-flight will be queued per
+# client until this limit is exceeded.  Defaults to 0. (No maximum)
+# See also max_queued_messages.
+# If both max_queued_messages and max_queued_bytes are specified, packets will
+# be queued until the first limit is reached.
+#max_queued_bytes 0
+
+# Set the maximum QoS supported. Clients publishing at a QoS higher than
+# specified here will be disconnected.
+#max_qos 2
+
+# The maximum number of QoS 1 and 2 messages to hold in a queue per client
+# above those that are currently in-flight.  Defaults to 1000. Set
+# to 0 for no maximum (not recommended).
+# See also queue_qos0_messages.
+# See also max_queued_bytes.
+#max_queued_messages 1000
+#
+# This option sets the maximum number of heap memory bytes that the broker will
+# allocate, and hence sets a hard limit on memory use by the broker.  Memory
+# requests that exceed this value will be denied. The effect will vary
+# depending on what has been denied. If an incoming message is being processed,
+# then the message will be dropped and the publishing client will be
+# disconnected. If an outgoing message is being sent, then the individual
+# message will be dropped and the receiving client will be disconnected.
+# Defaults to no limit.
+#memory_limit 0
+
+# This option sets the maximum publish payload size that the broker will allow.
+# Received messages that exceed this size will not be accepted by the broker.
+# The default value is 0, which means that all valid MQTT messages are
+# accepted. MQTT imposes a maximum payload size of 268435455 bytes.
+#message_size_limit 0
+
+# This option allows persistent clients (those with clean session set to false)
+# to be removed if they do not reconnect within a certain time frame.
+#
+# This is a non-standard option in MQTT V3.1 but allowed in MQTT v3.1.1.
+#
+# Badly designed clients may set clean session to false whilst using a randomly
+# generated client id. This leads to persistent clients that will never
+# reconnect. This option allows these clients to be removed.
+#
+# The expiration period should be an integer followed by one of h d w m y for
+# hour, day, week, month and year respectively. For example
+#
+# persistent_client_expiration 2m
+# persistent_client_expiration 14d
+# persistent_client_expiration 1y
+#
+# The default if not set is to never expire persistent clients.
+#persistent_client_expiration
+
+# Write process id to a file. Default is a blank string which means
+# a pid file shouldn't be written.
+# This should be set to /var/run/mosquitto/mosquitto.pid if mosquitto is
+# being run automatically on boot with an init script and
+# start-stop-daemon or similar.
+#pid_file
+
+# Set to true to queue messages with QoS 0 when a persistent client is
+# disconnected. These messages are included in the limit imposed by
+# max_queued_messages and max_queued_bytes
+# Defaults to false.
+# This is a non-standard option for the MQTT v3.1 spec but is allowed in
+# v3.1.1.
+#queue_qos0_messages false
+
+# Set to false to disable retained message support. If a client publishes a
+# message with the retain bit set, it will be disconnected if this is set to
+# false.
+#retain_available true
+
+# Disable Nagle's algorithm on client sockets. This has the effect of reducing
+# latency of individual messages at the potential cost of increasing the number
+# of packets being sent.
+#set_tcp_nodelay false
+
+# Time in seconds between updates of the $SYS tree.
+# Set to 0 to disable the publishing of the $SYS tree.
+#sys_interval 10
+
+# The MQTT specification requires that the QoS of a message delivered to a
+# subscriber is never upgraded to match the QoS of the subscription. Enabling
+# this option changes this behaviour. If upgrade_outgoing_qos is set true,
+# messages sent to a subscriber will always match the QoS of its subscription.
+# This is a non-standard option explicitly disallowed by the spec.
+#upgrade_outgoing_qos false
+
+# When run as root, drop privileges to this user and its primary
+# group.
+# Set to root to stay as root, but this is not recommended.
+# If set to "mosquitto", or left unset, and the "mosquitto" user does not exist
+# then it will drop privileges to the "nobody" user instead.
+# If run as a non-root user, this setting has no effect.
+# Note that on Windows this has no effect and so mosquitto should be started by
+# the user you wish it to run as.
+#user mosquitto
+
+# =================================================================
+# Listeners
+# =================================================================
+
+# Listen on a port/ip address combination. By using this variable
+# multiple times, mosquitto can listen on more than one port. If
+# this variable is used and neither bind_address nor port given,
+# then the default listener will not be started.
+# The port number to listen on must be given. Optionally, an ip
+# address or host name may be supplied as a second argument. In
+# this case, mosquitto will attempt to bind the listener to that
+# address and so restrict access to the associated network and
+# interface. By default, mosquitto will listen on all interfaces.
+# Note that for a websockets listener it is not possible to bind to a host
+# name.
+#
+# On systems that support Unix Domain Sockets, it is also possible
+# to create a # Unix socket rather than opening a TCP socket. In
+# this case, the port number should be set to 0 and a unix socket
+# path must be provided, e.g.
+# listener 0 /tmp/mosquitto.sock
+#
+# listener port-number [ip address/host name/unix socket path]
+#listener
+
+# By default, a listener will attempt to listen on all supported IP protocol
+# versions. If you do not have an IPv4 or IPv6 interface you may wish to
+# disable support for either of those protocol versions. In particular, note
+# that due to the limitations of the websockets library, it will only ever
+# attempt to open IPv6 sockets if IPv6 support is compiled in, and so will fail
+# if IPv6 is not available.
+#
+# Set to `ipv4` to force the listener to only use IPv4, or set to `ipv6` to
+# force the listener to only use IPv6. If you want support for both IPv4 and
+# IPv6, then do not use the socket_domain option.
+#
+#socket_domain
+
+# Bind the listener to a specific interface. This is similar to
+# the [ip address/host name] part of the listener definition, but is useful
+# when an interface has multiple addresses or the address may change. If used
+# with the [ip address/host name] part of the listener definition, then the
+# bind_interface option will take priority.
+# Not available on Windows.
+#
+# Example: bind_interface eth0
+#bind_interface
+
+# When a listener is using the websockets protocol, it is possible to serve
+# http data as well. Set http_dir to a directory which contains the files you
+# wish to serve. If this option is not specified, then no normal http
+# connections will be possible.
+#http_dir
+
+# The maximum number of client connections to allow. This is
+# a per listener setting.
+# Default is -1, which means unlimited connections.
+# Note that other process limits mean that unlimited connections
+# are not really possible. Typically the default maximum number of
+# connections possible is around 1024.
+#max_connections -1
+
+# The listener can be restricted to operating within a topic hierarchy using
+# the mount_point option. This is achieved be prefixing the mount_point string
+# to all topics for any clients connected to this listener. This prefixing only
+# happens internally to the broker; the client will not see the prefix.
+#mount_point
+
+# Choose the protocol to use when listening.
+# This can be either mqtt or websockets.
+# Certificate based TLS may be used with websockets, except that only the
+# cafile, certfile, keyfile, ciphers, and ciphers_tls13 options are supported.
+#protocol mqtt
+listener 1883
+protocol mqtt
+
+listener 9001
+protocol websockets
+
+# Set use_username_as_clientid to true to replace the clientid that a client
+# connected with with its username. This allows authentication to be tied to
+# the clientid, which means that it is possible to prevent one client
+# disconnecting another by using the same clientid.
+# If a client connects with no username it will be disconnected as not
+# authorised when this option is set to true.
+# Do not use in conjunction with clientid_prefixes.
+# See also use_identity_as_username.
+#use_username_as_clientid
+
+# Change the websockets headers size. This is a global option, it is not
+# possible to set per listener. This option sets the size of the buffer used in
+# the libwebsockets library when reading HTTP headers. If you are passing large
+# header data such as cookies then you may need to increase this value. If left
+# unset, or set to 0, then the default of 1024 bytes will be used.
+#websockets_headers_size
+
+# -----------------------------------------------------------------
+# Certificate based SSL/TLS support
+# -----------------------------------------------------------------
+# The following options can be used to enable certificate based SSL/TLS support
+# for this listener. Note that the recommended port for MQTT over TLS is 8883,
+# but this must be set manually.
+#
+# See also the mosquitto-tls man page and the "Pre-shared-key based SSL/TLS
+# support" section. Only one of certificate or PSK encryption support can be
+# enabled for any listener.
+
+# Both of certfile and keyfile must be defined to enable certificate based
+# TLS encryption.
+
+# Path to the PEM encoded server certificate.
+#certfile
+
+# Path to the PEM encoded keyfile.
+#keyfile
+
+# If you wish to control which encryption ciphers are used, use the ciphers
+# option. The list of available ciphers can be optained using the "openssl
+# ciphers" command and should be provided in the same format as the output of
+# that command. This applies to TLS 1.2 and earlier versions only. Use
+# ciphers_tls1.3 for TLS v1.3.
+#ciphers
+
+# Choose which TLS v1.3 ciphersuites are used for this listener.
+# Defaults to "TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256"
+#ciphers_tls1.3
+
+# If you have require_certificate set to true, you can create a certificate
+# revocation list file to revoke access to particular client certificates. If
+# you have done this, use crlfile to point to the PEM encoded revocation file.
+#crlfile
+
+# To allow the use of ephemeral DH key exchange, which provides forward
+# security, the listener must load DH parameters. This can be specified with
+# the dhparamfile option. The dhparamfile can be generated with the command
+# e.g. "openssl dhparam -out dhparam.pem 2048"
+#dhparamfile
+
+# By default an TLS enabled listener will operate in a similar fashion to a
+# https enabled web server, in that the server has a certificate signed by a CA
+# and the client will verify that it is a trusted certificate. The overall aim
+# is encryption of the network traffic. By setting require_certificate to true,
+# the client must provide a valid certificate in order for the network
+# connection to proceed. This allows access to the broker to be controlled
+# outside of the mechanisms provided by MQTT.
+#require_certificate false
+
+# cafile and capath define methods of accessing the PEM encoded
+# Certificate Authority certificates that will be considered trusted when
+# checking incoming client certificates.
+# cafile defines the path to a file containing the CA certificates.
+# capath defines a directory that will be searched for files
+# containing the CA certificates. For capath to work correctly, the
+# certificate files must have ".crt" as the file ending and you must run
+# "openssl rehash <path to capath>" each time you add/remove a certificate.
+#cafile
+#capath
+
+
+# If require_certificate is true, you may set use_identity_as_username to true
+# to use the CN value from the client certificate as a username. If this is
+# true, the password_file option will not be used for this listener.
+#use_identity_as_username false
+
+# -----------------------------------------------------------------
+# Pre-shared-key based SSL/TLS support
+# -----------------------------------------------------------------
+# The following options can be used to enable PSK based SSL/TLS support for
+# this listener. Note that the recommended port for MQTT over TLS is 8883, but
+# this must be set manually.
+#
+# See also the mosquitto-tls man page and the "Certificate based SSL/TLS
+# support" section. Only one of certificate or PSK encryption support can be
+# enabled for any listener.
+
+# The psk_hint option enables pre-shared-key support for this listener and also
+# acts as an identifier for this listener. The hint is sent to clients and may
+# be used locally to aid authentication. The hint is a free form string that
+# doesn't have much meaning in itself, so feel free to be creative.
+# If this option is provided, see psk_file to define the pre-shared keys to be
+# used or create a security plugin to handle them.
+#psk_hint
+
+# When using PSK, the encryption ciphers used will be chosen from the list of
+# available PSK ciphers. If you want to control which ciphers are available,
+# use the "ciphers" option.  The list of available ciphers can be optained
+# using the "openssl ciphers" command and should be provided in the same format
+# as the output of that command.
+#ciphers
+
+# Set use_identity_as_username to have the psk identity sent by the client used
+# as its username. Authentication will be carried out using the PSK rather than
+# the MQTT username/password and so password_file will not be used for this
+# listener.
+#use_identity_as_username false
+
+
+# =================================================================
+# Persistence
+# =================================================================
+
+# If persistence is enabled, save the in-memory database to disk
+# every autosave_interval seconds. If set to 0, the persistence
+# database will only be written when mosquitto exits. See also
+# autosave_on_changes.
+# Note that writing of the persistence database can be forced by
+# sending mosquitto a SIGUSR1 signal.
+#autosave_interval 1800
+
+# If true, mosquitto will count the number of subscription changes, retained
+# messages received and queued messages and if the total exceeds
+# autosave_interval then the in-memory database will be saved to disk.
+# If false, mosquitto will save the in-memory database to disk by treating
+# autosave_interval as a time in seconds.
+#autosave_on_changes false
+
+# Save persistent message data to disk (true/false).
+# This saves information about all messages, including
+# subscriptions, currently in-flight messages and retained
+# messages.
+# retained_persistence is a synonym for this option.
+#persistence false
+
+# The filename to use for the persistent database, not including
+# the path.
+#persistence_file mosquitto.db
+
+# Location for persistent database.
+# Default is an empty string (current directory).
+# Set to e.g. /var/lib/mosquitto if running as a proper service on Linux or
+# similar.
+#persistence_location
+
+
+# =================================================================
+# Logging
+# =================================================================
+
+# Places to log to. Use multiple log_dest lines for multiple
+# logging destinations.
+# Possible destinations are: stdout stderr syslog topic file dlt
+#
+# stdout and stderr log to the console on the named output.
+#
+# syslog uses the userspace syslog facility which usually ends up
+# in /var/log/messages or similar.
+#
+# topic logs to the broker topic '$SYS/broker/log/<severity>',
+# where severity is one of D, E, W, N, I, M which are debug, error,
+# warning, notice, information and message. Message type severity is used by
+# the subscribe/unsubscribe log_types and publishes log messages to
+# $SYS/broker/log/M/susbcribe or $SYS/broker/log/M/unsubscribe.
+#
+# The file destination requires an additional parameter which is the file to be
+# logged to, e.g. "log_dest file /var/log/mosquitto.log". The file will be
+# closed and reopened when the broker receives a HUP signal. Only a single file
+# destination may be configured.
+#
+# The dlt destination is for the automotive `Diagnostic Log and Trace` tool.
+# This requires that Mosquitto has been compiled with DLT support.
+#
+# Note that if the broker is running as a Windows service it will default to
+# "log_dest none" and neither stdout nor stderr logging is available.
+# Use "log_dest none" if you wish to disable logging.
+#log_dest stderr
+
+# Types of messages to log. Use multiple log_type lines for logging
+# multiple types of messages.
+# Possible types are: debug, error, warning, notice, information,
+# none, subscribe, unsubscribe, websockets, all.
+# Note that debug type messages are for decoding the incoming/outgoing
+# network packets. They are not logged in "topics".
+#log_type error
+#log_type warning
+#log_type notice
+#log_type information
+
+
+# If set to true, client connection and disconnection messages will be included
+# in the log.
+#connection_messages true
+
+# If using syslog logging (not on Windows), messages will be logged to the
+# "daemon" facility by default. Use the log_facility option to choose which of
+# local0 to local7 to log to instead. The option value should be an integer
+# value, e.g. "log_facility 5" to use local5.
+#log_facility
+
+# If set to true, add a timestamp value to each log message.
+#log_timestamp true
+
+# Set the format of the log timestamp. If left unset, this is the number of
+# seconds since the Unix epoch.
+# This is a free text string which will be passed to the strftime function. To
+# get an ISO 8601 datetime, for example:
+# log_timestamp_format %Y-%m-%dT%H:%M:%S
+#log_timestamp_format
+
+# Change the websockets logging level. This is a global option, it is not
+# possible to set per listener. This is an integer that is interpreted by
+# libwebsockets as a bit mask for its lws_log_levels enum. See the
+# libwebsockets documentation for more details. "log_type websockets" must also
+# be enabled.
+#websockets_log_level 0
+
+
+# =================================================================
+# Security
+# =================================================================
+
+# If set, only clients that have a matching prefix on their
+# clientid will be allowed to connect to the broker. By default,
+# all clients may connect.
+# For example, setting "secure-" here would mean a client "secure-
+# client" could connect but another with clientid "mqtt" couldn't.
+#clientid_prefixes
+
+# Boolean value that determines whether clients that connect
+# without providing a username are allowed to connect. If set to
+# false then a password file should be created (see the
+# password_file option) to control authenticated client access.
+#
+# Defaults to false, unless there are no listeners defined in the configuration
+# file, in which case it is set to true, but connections are only allowed from
+# the local machine.
+allow_anonymous true
+
+# -----------------------------------------------------------------
+# Default authentication and topic access control
+# -----------------------------------------------------------------
+
+# Control access to the broker using a password file. This file can be
+# generated using the mosquitto_passwd utility. If TLS support is not compiled
+# into mosquitto (it is recommended that TLS support should be included) then
+# plain text passwords are used, in which case the file should be a text file
+# with lines in the format:
+# username:password
+# The password (and colon) may be omitted if desired, although this
+# offers very little in the way of security.
+#
+# See the TLS client require_certificate and use_identity_as_username options
+# for alternative authentication options. If a plugin is used as well as
+# password_file, the plugin check will be made first.
+#password_file
+
+# Access may also be controlled using a pre-shared-key file. This requires
+# TLS-PSK support and a listener configured to use it. The file should be text
+# lines in the format:
+# identity:key
+# The key should be in hexadecimal format without a leading "0x".
+# If an plugin is used as well, the plugin check will be made first.
+#psk_file
+
+# Control access to topics on the broker using an access control list
+# file. If this parameter is defined then only the topics listed will
+# have access.
+# If the first character of a line of the ACL file is a # it is treated as a
+# comment.
+# Topic access is added with lines of the format:
+#
+# topic [read|write|readwrite|deny] <topic>
+#
+# The access type is controlled using "read", "write", "readwrite" or "deny".
+# This parameter is optional (unless <topic> contains a space character) - if
+# not given then the access is read/write.  <topic> can contain the + or #
+# wildcards as in subscriptions.
+#
+# The "deny" option can used to explicity deny access to a topic that would
+# otherwise be granted by a broader read/write/readwrite statement. Any "deny"
+# topics are handled before topics that grant read/write access.
+#
+# The first set of topics are applied to anonymous clients, assuming
+# allow_anonymous is true. User specific topic ACLs are added after a
+# user line as follows:
+#
+# user <username>
+#
+# The username referred to here is the same as in password_file. It is
+# not the clientid.
+#
+#
+# If is also possible to define ACLs based on pattern substitution within the
+# topic. The patterns available for substition are:
+#
+# %c to match the client id of the client
+# %u to match the username of the client
+#
+# The substitution pattern must be the only text for that level of hierarchy.
+#
+# The form is the same as for the topic keyword, but using pattern as the
+# keyword.
+# Pattern ACLs apply to all users even if the "user" keyword has previously
+# been given.
+#
+# If using bridges with usernames and ACLs, connection messages can be allowed
+# with the following pattern:
+# pattern write $SYS/broker/connection/%c/state
+#
+# pattern [read|write|readwrite] <topic>
+#
+# Example:
+#
+# pattern write sensor/%u/data
+#
+# If an plugin is used as well as acl_file, the plugin check will be
+# made first.
+#acl_file
+
+# -----------------------------------------------------------------
+# External authentication and topic access plugin options
+# -----------------------------------------------------------------
+
+# External authentication and access control can be supported with the
+# plugin option. This is a path to a loadable plugin. See also the
+# plugin_opt_* options described below.
+#
+# The plugin option can be specified multiple times to load multiple
+# plugins. The plugins will be processed in the order that they are specified
+# here. If the plugin option is specified alongside either of
+# password_file or acl_file then the plugin checks will be made first.
+#
+# If the per_listener_settings option is false, the plugin will be apply to all
+# listeners. If per_listener_settings is true, then the plugin will apply to
+# the current listener being defined only.
+#
+# This option is also available as `auth_plugin`, but this use is deprecated
+# and will be removed in the future.
+#
+#plugin
+
+# If the plugin option above is used, define options to pass to the
+# plugin here as described by the plugin instructions. All options named
+# using the format plugin_opt_* will be passed to the plugin, for example:
+#
+# This option is also available as `auth_opt_*`, but this use is deprecated
+# and will be removed in the future.
+#
+# plugin_opt_db_host
+# plugin_opt_db_port
+# plugin_opt_db_username
+# plugin_opt_db_password
+
+
+# =================================================================
+# Bridges
+# =================================================================
+
+# A bridge is a way of connecting multiple MQTT brokers together.
+# Create a new bridge using the "connection" option as described below. Set
+# options for the bridges using the remaining parameters. You must specify the
+# address and at least one topic to subscribe to.
+#
+# Each connection must have a unique name.
+#
+# The address line may have multiple host address and ports specified. See
+# below in the round_robin description for more details on bridge behaviour if
+# multiple addresses are used. Note that if you use an IPv6 address, then you
+# are required to specify a port.
+#
+# The direction that the topic will be shared can be chosen by
+# specifying out, in or both, where the default value is out.
+# The QoS level of the bridged communication can be specified with the next
+# topic option. The default QoS level is 0, to change the QoS the topic
+# direction must also be given.
+#
+# The local and remote prefix options allow a topic to be remapped when it is
+# bridged to/from the remote broker. This provides the ability to place a topic
+# tree in an appropriate location.
+#
+# For more details see the mosquitto.conf man page.
+#
+# Multiple topics can be specified per connection, but be careful
+# not to create any loops.
+#
+# If you are using bridges with cleansession set to false (the default), then
+# you may get unexpected behaviour from incoming topics if you change what
+# topics you are subscribing to. This is because the remote broker keeps the
+# subscription for the old topic. If you have this problem, connect your bridge
+# with cleansession set to true, then reconnect with cleansession set to false
+# as normal.
+#connection <name>
+#address <host>[:<port>] [<host>[:<port>]]
+#topic <topic> [[[out | in | both] qos-level] local-prefix remote-prefix]
+
+# If you need to have the bridge connect over a particular network interface,
+# use bridge_bind_address to tell the bridge which local IP address the socket
+# should bind to, e.g. `bridge_bind_address 192.168.1.10`
+#bridge_bind_address
+
+# If a bridge has topics that have "out" direction, the default behaviour is to
+# send an unsubscribe request to the remote broker on that topic. This means
+# that changing a topic direction from "in" to "out" will not keep receiving
+# incoming messages. Sending these unsubscribe requests is not always
+# desirable, setting bridge_attempt_unsubscribe to false will disable sending
+# the unsubscribe request.
+#bridge_attempt_unsubscribe true
+
+# Set the version of the MQTT protocol to use with for this bridge. Can be one
+# of mqttv50, mqttv311 or mqttv31. Defaults to mqttv311.
+#bridge_protocol_version mqttv311
+
+# Set the clean session variable for this bridge.
+# When set to true, when the bridge disconnects for any reason, all
+# messages and subscriptions will be cleaned up on the remote
+# broker. Note that with cleansession set to true, there may be a
+# significant amount of retained messages sent when the bridge
+# reconnects after losing its connection.
+# When set to false, the subscriptions and messages are kept on the
+# remote broker, and delivered when the bridge reconnects.
+#cleansession false
+
+# Set the amount of time a bridge using the lazy start type must be idle before
+# it will be stopped. Defaults to 60 seconds.
+#idle_timeout 60
+
+# Set the keepalive interval for this bridge connection, in
+# seconds.
+#keepalive_interval 60
+
+# Set the clientid to use on the local broker. If not defined, this defaults to
+# 'local.<clientid>'. If you are bridging a broker to itself, it is important
+# that local_clientid and clientid do not match.
+#local_clientid
+
+# If set to true, publish notification messages to the local and remote brokers
+# giving information about the state of the bridge connection. Retained
+# messages are published to the topic $SYS/broker/connection/<clientid>/state
+# unless the notification_topic option is used.
+# If the message is 1 then the connection is active, or 0 if the connection has
+# failed.
+# This uses the last will and testament feature.
+#notifications true
+
+# Choose the topic on which notification messages for this bridge are
+# published. If not set, messages are published on the topic
+# $SYS/broker/connection/<clientid>/state
+#notification_topic
+
+# Set the client id to use on the remote end of this bridge connection. If not
+# defined, this defaults to 'name.hostname' where name is the connection name
+# and hostname is the hostname of this computer.
+# This replaces the old "clientid" option to avoid confusion. "clientid"
+# remains valid for the time being.
+#remote_clientid
+
+# Set the password to use when connecting to a broker that requires
+# authentication. This option is only used if remote_username is also set.
+# This replaces the old "password" option to avoid confusion. "password"
+# remains valid for the time being.
+#remote_password
+
+# Set the username to use when connecting to a broker that requires
+# authentication.
+# This replaces the old "username" option to avoid confusion. "username"
+# remains valid for the time being.
+#remote_username
+
+# Set the amount of time a bridge using the automatic start type will wait
+# until attempting to reconnect.
+# This option can be configured to use a constant delay time in seconds, or to
+# use a backoff mechanism based on "Decorrelated Jitter", which adds a degree
+# of randomness to when the restart occurs.
+#
+# Set a constant timeout of 20 seconds:
+# restart_timeout 20
+#
+# Set backoff with a base (start value) of 10 seconds and a cap (upper limit) of
+# 60 seconds:
+# restart_timeout 10 30
+#
+# Defaults to jitter with a base of 5 and cap of 30
+#restart_timeout 5 30
+
+# If the bridge has more than one address given in the address/addresses
+# configuration, the round_robin option defines the behaviour of the bridge on
+# a failure of the bridge connection. If round_robin is false, the default
+# value, then the first address is treated as the main bridge connection. If
+# the connection fails, the other secondary addresses will be attempted in
+# turn. Whilst connected to a secondary bridge, the bridge will periodically
+# attempt to reconnect to the main bridge until successful.
+# If round_robin is true, then all addresses are treated as equals. If a
+# connection fails, the next address will be tried and if successful will
+# remain connected until it fails
+#round_robin false
+
+# Set the start type of the bridge. This controls how the bridge starts and
+# can be one of three types: automatic, lazy and once. Note that RSMB provides
+# a fourth start type "manual" which isn't currently supported by mosquitto.
+#
+# "automatic" is the default start type and means that the bridge connection
+# will be started automatically when the broker starts and also restarted
+# after a short delay (30 seconds) if the connection fails.
+#
+# Bridges using the "lazy" start type will be started automatically when the
+# number of queued messages exceeds the number set with the "threshold"
+# parameter. It will be stopped automatically after the time set by the
+# "idle_timeout" parameter. Use this start type if you wish the connection to
+# only be active when it is needed.
+#
+# A bridge using the "once" start type will be started automatically when the
+# broker starts but will not be restarted if the connection fails.
+#start_type automatic
+
+# Set the number of messages that need to be queued for a bridge with lazy
+# start type to be restarted. Defaults to 10 messages.
+# Must be less than max_queued_messages.
+#threshold 10
+
+# If try_private is set to true, the bridge will attempt to indicate to the
+# remote broker that it is a bridge not an ordinary client. If successful, this
+# means that loop detection will be more effective and that retained messages
+# will be propagated correctly. Not all brokers support this feature so it may
+# be necessary to set try_private to false if your bridge does not connect
+# properly.
+#try_private true
+
+# Some MQTT brokers do not allow retained messages. MQTT v5 gives a mechanism
+# for brokers to tell clients that they do not support retained messages, but
+# this is not possible for MQTT v3.1.1 or v3.1. If you need to bridge to a
+# v3.1.1 or v3.1 broker that does not support retained messages, set the
+# bridge_outgoing_retain option to false. This will remove the retain bit on
+# all outgoing messages to that bridge, regardless of any other setting.
+#bridge_outgoing_retain true
+
+# If you wish to restrict the size of messages sent to a remote bridge, use the
+# bridge_max_packet_size option. This sets the maximum number of bytes for
+# the total message, including headers and payload.
+# Note that MQTT v5 brokers may provide their own maximum-packet-size property.
+# In this case, the smaller of the two limits will be used.
+# Set to 0 for "unlimited".
+#bridge_max_packet_size 0
+
+
+# -----------------------------------------------------------------
+# Certificate based SSL/TLS support
+# -----------------------------------------------------------------
+# Either bridge_cafile or bridge_capath must be defined to enable TLS support
+# for this bridge.
+# bridge_cafile defines the path to a file containing the
+# Certificate Authority certificates that have signed the remote broker
+# certificate.
+# bridge_capath defines a directory that will be searched for files containing
+# the CA certificates. For bridge_capath to work correctly, the certificate
+# files must have ".crt" as the file ending and you must run "openssl rehash
+# <path to capath>" each time you add/remove a certificate.
+#bridge_cafile
+#bridge_capath
+
+
+# If the remote broker has more than one protocol available on its port, e.g.
+# MQTT and WebSockets, then use bridge_alpn to configure which protocol is
+# requested. Note that WebSockets support for bridges is not yet available.
+#bridge_alpn
+
+# When using certificate based encryption, bridge_insecure disables
+# verification of the server hostname in the server certificate. This can be
+# useful when testing initial server configurations, but makes it possible for
+# a malicious third party to impersonate your server through DNS spoofing, for
+# example. Use this option in testing only. If you need to resort to using this
+# option in a production environment, your setup is at fault and there is no
+# point using encryption.
+#bridge_insecure false
+
+# Path to the PEM encoded client certificate, if required by the remote broker.
+#bridge_certfile
+
+# Path to the PEM encoded client private key, if required by the remote broker.
+#bridge_keyfile
+
+# -----------------------------------------------------------------
+# PSK based SSL/TLS support
+# -----------------------------------------------------------------
+# Pre-shared-key encryption provides an alternative to certificate based
+# encryption. A bridge can be configured to use PSK with the bridge_identity
+# and bridge_psk options. These are the client PSK identity, and pre-shared-key
+# in hexadecimal format with no "0x". Only one of certificate and PSK based
+# encryption can be used on one
+# bridge at once.
+#bridge_identity
+#bridge_psk
+
+
+# =================================================================
+# External config files
+# =================================================================
+
+# External configuration files may be included by using the
+# include_dir option. This defines a directory that will be searched
+# for config files. All files that end in '.conf' will be loaded as
+# a configuration file. It is best to have this as the last option
+# in the main file. This option will only be processed from the main
+# configuration file. The directory specified must not contain the
+# main configuration file.
+# Files within include_dir will be loaded sorted in case-sensitive
+# alphabetical order, with capital letters ordered first. If this option is
+# given multiple times, all of the files from the first instance will be
+# processed before the next instance. See the man page for examples.
+#include_dir
diff --git a/integration/nest-application/global-prefix/e2e/global-prefix.spec.ts b/integration/nest-application/global-prefix/e2e/global-prefix.spec.ts
index b11becd24..131d2dd03 100644
--- a/integration/nest-application/global-prefix/e2e/global-prefix.spec.ts
+++ b/integration/nest-application/global-prefix/e2e/global-prefix.spec.ts
@@ -108,15 +108,15 @@ describe('Global prefix', () => {
     server = app.getHttpServer();
     await app.init();
 
-    await request(server).get('/hello/foo').expect(200);
+    await request(server)
+      .get('/hello/foo')
+      .expect(200, 'Hello: Data attached in middleware');
 
     await request(server)
       .get('/middleware/foo')
       .expect(200, MIDDLEWARE_PARAM_VALUE);
 
-    await request(server)
-      .get('/api/v1/middleware/foo')
-      .expect(404);
+    await request(server).get('/api/v1/middleware/foo').expect(404);
   });
 
   afterEach(async () => {
diff --git a/integration/nest-application/global-prefix/src/app.controller.ts b/integration/nest-application/global-prefix/src/app.controller.ts
index 8d1472a2f..912c0d76c 100644
--- a/integration/nest-application/global-prefix/src/app.controller.ts
+++ b/integration/nest-application/global-prefix/src/app.controller.ts
@@ -1,10 +1,10 @@
-import { Controller, Get, Post } from '@nestjs/common';
+import { Controller, Get, Post, Req } from '@nestjs/common';
 
 @Controller()
 export class AppController {
   @Get('hello/:name')
-  getHello(): string {
-    return 'hello';
+  getHello(@Req() req): string {
+    return 'Hello: ' + req.extras?.data;
   }
 
   @Get('health')
diff --git a/integration/nest-application/global-prefix/src/app.module.ts b/integration/nest-application/global-prefix/src/app.module.ts
index 2123145a8..85d1e6ac4 100644
--- a/integration/nest-application/global-prefix/src/app.module.ts
+++ b/integration/nest-application/global-prefix/src/app.module.ts
@@ -17,6 +17,11 @@ export class AppModule {
       .apply((req, res, next) => res.end(MIDDLEWARE_PARAM_VALUE))
       .forRoutes({ path: MIDDLEWARE_VALUE + '/*', method: RequestMethod.GET })
       .apply((req, res, next) => res.status(201).end(MIDDLEWARE_PARAM_VALUE))
-      .forRoutes({ path: MIDDLEWARE_VALUE + '/*', method: RequestMethod.POST });
+      .forRoutes({ path: MIDDLEWARE_VALUE + '/*', method: RequestMethod.POST })
+      .apply((req, res, next) => {
+        req.extras = { data: 'Data attached in middleware' };
+        next();
+      })
+      .forRoutes({ path: '*', method: RequestMethod.GET });
   }
 }
diff --git a/integration/nest-application/raw-body/e2e/express.spec.ts b/integration/nest-application/raw-body/e2e/express.spec.ts
new file mode 100644
index 000000000..910a0785c
--- /dev/null
+++ b/integration/nest-application/raw-body/e2e/express.spec.ts
@@ -0,0 +1,49 @@
+import { NestExpressApplication } from '@nestjs/platform-express';
+import { Test } from '@nestjs/testing';
+import { expect } from 'chai';
+import * as request from 'supertest';
+import { ExpressModule } from '../src/express.module';
+
+describe('Raw body (Express Application)', () => {
+  let app: NestExpressApplication;
+  const body = '{ "amount":0.0 }';
+
+  beforeEach(async () => {
+    const moduleFixture = await Test.createTestingModule({
+      imports: [ExpressModule],
+    }).compile();
+
+    app = moduleFixture.createNestApplication<NestExpressApplication>(
+      undefined,
+      { rawBody: true },
+    );
+  });
+
+  it('should return exact post body', async () => {
+    await app.init();
+    const response = await request(app.getHttpServer())
+      .post('/')
+      .set('Content-Type', 'application/json')
+      .send(body)
+      .expect(201);
+
+    expect(response.body).to.eql({
+      parsed: {
+        amount: 0,
+      },
+      raw: '{ "amount":0.0 }',
+    });
+  });
+
+  it('should work if post body is empty', async () => {
+    await app.init();
+    await request(app.getHttpServer())
+      .post('/')
+      .set('Content-Type', 'application/json')
+      .expect(201);
+  });
+
+  afterEach(async () => {
+    await app.close();
+  });
+});
diff --git a/integration/nest-application/raw-body/e2e/fastify.spec.ts b/integration/nest-application/raw-body/e2e/fastify.spec.ts
new file mode 100644
index 000000000..5d6e9052a
--- /dev/null
+++ b/integration/nest-application/raw-body/e2e/fastify.spec.ts
@@ -0,0 +1,63 @@
+import {
+  NestFastifyApplication,
+  FastifyAdapter,
+} from '@nestjs/platform-fastify';
+import { Test } from '@nestjs/testing';
+import { expect } from 'chai';
+import { FastifyModule } from '../src/fastify.module';
+
+describe('Raw body (Fastify Application)', () => {
+  let app: NestFastifyApplication;
+  const body = '{ "amount":0.0 }';
+
+  beforeEach(async () => {
+    const moduleFixture = await Test.createTestingModule({
+      imports: [FastifyModule],
+    }).compile();
+
+    app = moduleFixture.createNestApplication<NestFastifyApplication>(
+      new FastifyAdapter(),
+      {
+        rawBody: true,
+      },
+    );
+  });
+
+  it('should return exact post body', async () => {
+    await app.init();
+    const response = await app.inject({
+      method: 'POST',
+      url: '/',
+      headers: { 'content-type': 'application/json' },
+      payload: body,
+    });
+
+    expect(JSON.parse(response.body)).to.eql({
+      parsed: {
+        amount: 0,
+      },
+      raw: '{ "amount":0.0 }',
+    });
+  });
+
+  it('should fail if post body is empty', async () => {
+    await app.init();
+    const response = await app.inject({
+      method: 'POST',
+      url: '/',
+      headers: {
+        'content-type': 'application/json',
+        accept: 'application/json',
+      },
+    });
+
+    // Unlike Express, when you send a POST request without a body
+    // with Fastify, Fastify will throw an error because it isn't valid
+    // JSON. See fastify/fastify#297.
+    expect(response.statusCode).to.equal(400);
+  });
+
+  afterEach(async () => {
+    await app.close();
+  });
+});
diff --git a/integration/nest-application/raw-body/src/express.controller.ts b/integration/nest-application/raw-body/src/express.controller.ts
new file mode 100644
index 000000000..5f504ede0
--- /dev/null
+++ b/integration/nest-application/raw-body/src/express.controller.ts
@@ -0,0 +1,13 @@
+import { Controller, Post, RawBodyRequest, Req } from '@nestjs/common';
+import { Request } from 'express';
+
+@Controller()
+export class ExpressController {
+  @Post()
+  getRawBody(@Req() req: RawBodyRequest<Request>) {
+    return {
+      parsed: req.body,
+      raw: req.rawBody.toString(),
+    };
+  }
+}
diff --git a/integration/nest-application/raw-body/src/express.module.ts b/integration/nest-application/raw-body/src/express.module.ts
new file mode 100644
index 000000000..5ddb71426
--- /dev/null
+++ b/integration/nest-application/raw-body/src/express.module.ts
@@ -0,0 +1,7 @@
+import { Module } from '@nestjs/common';
+import { ExpressController } from './express.controller';
+
+@Module({
+  controllers: [ExpressController],
+})
+export class ExpressModule {}
diff --git a/integration/nest-application/raw-body/src/fastify.controller.ts b/integration/nest-application/raw-body/src/fastify.controller.ts
new file mode 100644
index 000000000..3cdf8484e
--- /dev/null
+++ b/integration/nest-application/raw-body/src/fastify.controller.ts
@@ -0,0 +1,13 @@
+import { Controller, Post, RawBodyRequest, Req } from '@nestjs/common';
+import type { FastifyRequest } from 'fastify';
+
+@Controller()
+export class FastifyController {
+  @Post()
+  getRawBody(@Req() req: RawBodyRequest<FastifyRequest>) {
+    return {
+      parsed: req.body,
+      raw: req.rawBody.toString(),
+    };
+  }
+}
diff --git a/integration/nest-application/raw-body/src/fastify.module.ts b/integration/nest-application/raw-body/src/fastify.module.ts
new file mode 100644
index 000000000..462f427ba
--- /dev/null
+++ b/integration/nest-application/raw-body/src/fastify.module.ts
@@ -0,0 +1,7 @@
+import { Module } from '@nestjs/common';
+import { FastifyController } from './fastify.controller';
+
+@Module({
+  controllers: [FastifyController],
+})
+export class FastifyModule {}
diff --git a/integration/nest-application/raw-body/tsconfig.json b/integration/nest-application/raw-body/tsconfig.json
new file mode 100644
index 000000000..2a0adf369
--- /dev/null
+++ b/integration/nest-application/raw-body/tsconfig.json
@@ -0,0 +1,22 @@
+{
+  "compilerOptions": {
+    "module": "commonjs",
+    "declaration": false,
+    "noImplicitAny": false,
+    "removeComments": true,
+    "noLib": false,
+    "emitDecoratorMetadata": true,
+    "experimentalDecorators": true,
+    "target": "es6",
+    "sourceMap": true,
+    "allowJs": true,
+    "outDir": "./dist"
+  },
+  "include": [
+    "src/**/*",
+    "e2e/**/*"
+  ],
+  "exclude": [
+    "node_modules"
+  ]
+}
\ No newline at end of file
diff --git a/integration/repl/e2e/repl.spec.ts b/integration/repl/e2e/repl.spec.ts
new file mode 100644
index 000000000..8c20d3a79
--- /dev/null
+++ b/integration/repl/e2e/repl.spec.ts
@@ -0,0 +1,233 @@
+import { clc } from '@nestjs/common/utils/cli-colors.util';
+import { repl } from '@nestjs/core';
+import { ReplContext } from '@nestjs/core/repl/repl-context';
+import {
+  HelpReplFn,
+  GetReplFn,
+  ResolveReplFn,
+  SelectReplFn,
+  DebugReplFn,
+  MethodsReplFn,
+} from '@nestjs/core/repl/native-functions';
+import { expect } from 'chai';
+import * as sinon from 'sinon';
+import { AppModule } from '../src/app.module';
+
+const PROMPT = '\u001b[1G\u001b[0J> \u001b[3G';
+
+describe('REPL', () => {
+  beforeEach(() => {
+    // To avoid coloring the output:
+    sinon.stub(clc, 'bold').callsFake(text => text);
+    sinon.stub(clc, 'green').callsFake(text => text);
+    sinon.stub(clc, 'yellow').callsFake(text => text);
+    sinon.stub(clc, 'red').callsFake(text => text);
+    sinon.stub(clc, 'magentaBright').callsFake(text => text);
+    sinon.stub(clc, 'cyanBright').callsFake(text => text);
+  });
+  afterEach(() => {
+    sinon.restore();
+  });
+
+  it('get()', async () => {
+    const server = await repl(AppModule);
+    server.context
+    let outputText = '';
+    sinon.stub(process.stdout, 'write').callsFake(text => {
+      outputText += text;
+      return true;
+    });
+    server.emit('line', 'get(UsersService)');
+
+    expect(outputText).to.equal(
+      `UsersService { usersRepository: UsersRepository {} }
+${PROMPT}`,
+    );
+
+    outputText = '';
+    server.emit('line', 'get(UsersService).findAll()');
+
+    expect(outputText).to
+      .equal(`\u001b[32m'This action returns all users'\u001b[39m
+${PROMPT}`);
+
+    outputText = '';
+    server.emit('line', 'get(UsersRepository)');
+
+    expect(outputText).to.equal(`UsersRepository {}
+${PROMPT}`);
+  });
+
+  it('debug()', async () => {
+    const server = await repl(AppModule);
+
+    let outputText = '';
+    sinon.stub(process.stdout, 'write').callsFake(text => {
+      outputText += text;
+      return true;
+    });
+    server.emit('line', 'debug(UsersModule)');
+
+    expect(outputText).to.equal(
+      `
+UsersModule:
+ - controllers:
+  â—» UsersController
+ - providers:
+  â—» UsersService
+  â—» UsersRepository
+
+${PROMPT}`,
+    );
+  });
+
+  it('methods()', async () => {
+    const server = await repl(AppModule);
+
+    let outputText = '';
+    sinon.stub(process.stdout, 'write').callsFake(text => {
+      outputText += text;
+      return true;
+    });
+    server.emit('line', 'methods(UsersRepository)');
+
+    expect(outputText).to.equal(
+      `
+Methods:
+ â—» find
+
+${PROMPT}`,
+    );
+
+    outputText = '';
+    server.emit('line', 'methods(UsersService)');
+
+    expect(outputText).to.equal(
+      `
+Methods:
+ â—» create
+ â—» findAll
+ â—» findOne
+ â—» update
+ â—» remove
+
+${PROMPT}`,
+    );
+  });
+
+  describe('<native_function>.help', () => {
+    it(`Typing "help.help" should print function's description and interface`, async () => {
+      const replServer = await repl(AppModule);
+
+      const { description, signature } = new HelpReplFn(
+        sinon.stub() as unknown as ReplContext,
+      ).fnDefinition;
+      let outputText = '';
+      sinon.stub(process.stdout, 'write').callsFake(text => {
+        outputText += text;
+        return true;
+      });
+
+      replServer.emit('line', 'help.help');
+
+      expect(outputText).to.equal(`${description}
+Interface: help${signature}
+${PROMPT}`);
+    });
+
+    it(`Typing "get.help" should print function's description and interface`, async () => {
+      const replServer = await repl(AppModule);
+
+      const { description, signature } = new GetReplFn(
+        sinon.stub() as unknown as ReplContext,
+      ).fnDefinition;
+      let outputText = '';
+      sinon.stub(process.stdout, 'write').callsFake(text => {
+        outputText += text;
+        return true;
+      });
+
+      replServer.emit('line', 'get.help');
+
+      expect(outputText).to.equal(`${description}
+Interface: get${signature}
+${PROMPT}`);
+    });
+
+    it(`Typing "resolve.help" should print function's description and interface`, async () => {
+      const replServer = await repl(AppModule);
+
+      const { description, signature } = new ResolveReplFn(
+        sinon.stub() as unknown as ReplContext,
+      ).fnDefinition;
+      let outputText = '';
+      sinon.stub(process.stdout, 'write').callsFake(text => {
+        outputText += text;
+        return true;
+      });
+
+      replServer.emit('line', 'resolve.help');
+
+      expect(outputText).to.equal(`${description}
+Interface: resolve${signature}
+${PROMPT}`);
+    });
+
+    it(`Typing "select.help" should print function's description and interface`, async () => {
+      const replServer = await repl(AppModule);
+
+      const { description, signature } = new SelectReplFn(
+        sinon.stub() as unknown as ReplContext,
+      ).fnDefinition;
+      let outputText = '';
+      sinon.stub(process.stdout, 'write').callsFake(text => {
+        outputText += text;
+        return true;
+      });
+
+      replServer.emit('line', 'select.help');
+
+      expect(outputText).to.equal(`${description}
+Interface: select${signature}
+${PROMPT}`);
+    });
+
+    it(`Typing "debug.help" should print function's description and interface`, async () => {
+      const replServer = await repl(AppModule);
+
+      const { description, signature } = new DebugReplFn(
+        sinon.stub() as unknown as ReplContext,
+      ).fnDefinition;
+      let outputText = '';
+      sinon.stub(process.stdout, 'write').callsFake(text => {
+        outputText += text;
+        return true;
+      });
+
+      replServer.emit('line', 'debug.help');
+
+      expect(outputText).to.equal(`${description}
+Interface: debug${signature}
+${PROMPT}`);
+    });
+
+    it(`Typing "methods.help" should print function's description and interface`, async () => {
+      const replServer = await repl(AppModule);
+
+      const { description, signature } = new MethodsReplFn(
+        sinon.stub() as unknown as ReplContext,
+      ).fnDefinition;
+      let outputText = '';
+      sinon.stub(process.stdout, 'write').callsFake(text => {
+        outputText += text;
+        return true;
+      });
+
+      replServer.emit('line', 'methods.help');
+
+      expect(outputText).to.equal(`${description}
+Interface: methods${signature}
+${PROMPT}`);
+    });
+  });
+});
diff --git a/integration/repl/src/app.module.ts b/integration/repl/src/app.module.ts
new file mode 100644
index 000000000..867c4b1b3
--- /dev/null
+++ b/integration/repl/src/app.module.ts
@@ -0,0 +1,7 @@
+import { Module } from '@nestjs/common';
+import { UsersModule } from './users/users.module';
+
+@Module({
+  imports: [UsersModule],
+})
+export class AppModule {}
diff --git a/integration/repl/src/users/dto/create-user.dto.ts b/integration/repl/src/users/dto/create-user.dto.ts
new file mode 100644
index 000000000..0311be138
--- /dev/null
+++ b/integration/repl/src/users/dto/create-user.dto.ts
@@ -0,0 +1 @@
+export class CreateUserDto {}
diff --git a/integration/repl/src/users/dto/update-user.dto.ts b/integration/repl/src/users/dto/update-user.dto.ts
new file mode 100644
index 000000000..dfd37fb1e
--- /dev/null
+++ b/integration/repl/src/users/dto/update-user.dto.ts
@@ -0,0 +1,4 @@
+import { PartialType } from '@nestjs/mapped-types';
+import { CreateUserDto } from './create-user.dto';
+
+export class UpdateUserDto extends PartialType(CreateUserDto) {}
diff --git a/integration/repl/src/users/entities/user.entity.ts b/integration/repl/src/users/entities/user.entity.ts
new file mode 100644
index 000000000..4f82c1457
--- /dev/null
+++ b/integration/repl/src/users/entities/user.entity.ts
@@ -0,0 +1 @@
+export class User {}
diff --git a/integration/repl/src/users/users.controller.ts b/integration/repl/src/users/users.controller.ts
new file mode 100644
index 000000000..3eca7ebde
--- /dev/null
+++ b/integration/repl/src/users/users.controller.ts
@@ -0,0 +1,34 @@
+import { Controller, Get, Post, Body, Patch, Param, Delete } from '@nestjs/common';
+import { UsersService } from './users.service';
+import { CreateUserDto } from './dto/create-user.dto';
+import { UpdateUserDto } from './dto/update-user.dto';
+
+@Controller('users')
+export class UsersController {
+  constructor(private readonly usersService: UsersService) {}
+
+  @Post()
+  create(@Body() createUserDto: CreateUserDto) {
+    return this.usersService.create(createUserDto);
+  }
+
+  @Get()
+  findAll() {
+    return this.usersService.findAll();
+  }
+
+  @Get(':id')
+  findOne(@Param('id') id: string) {
+    return this.usersService.findOne(+id);
+  }
+
+  @Patch(':id')
+  update(@Param('id') id: string, @Body() updateUserDto: UpdateUserDto) {
+    return this.usersService.update(+id, updateUserDto);
+  }
+
+  @Delete(':id')
+  remove(@Param('id') id: string) {
+    return this.usersService.remove(+id);
+  }
+}
diff --git a/integration/repl/src/users/users.module.ts b/integration/repl/src/users/users.module.ts
new file mode 100644
index 000000000..86d73a3f0
--- /dev/null
+++ b/integration/repl/src/users/users.module.ts
@@ -0,0 +1,16 @@
+import { Module } from '@nestjs/common';
+import { UsersController } from './users.controller';
+import { UsersRepository } from './users.repository';
+import { UsersService } from './users.service';
+
+@Module({
+  controllers: [UsersController],
+  providers: [
+    UsersService,
+    {
+      provide: UsersRepository.name,
+      useValue: new UsersRepository(),
+    },
+  ],
+})
+export class UsersModule {}
diff --git a/integration/repl/src/users/users.repository.ts b/integration/repl/src/users/users.repository.ts
new file mode 100644
index 000000000..4a6166586
--- /dev/null
+++ b/integration/repl/src/users/users.repository.ts
@@ -0,0 +1,8 @@
+import { Injectable } from '@nestjs/common';
+
+@Injectable()
+export class UsersRepository {
+  async find() {
+    return [{ id: 1, email: 'test@nestjs.com' }];
+  }
+}
diff --git a/integration/repl/src/users/users.service.ts b/integration/repl/src/users/users.service.ts
new file mode 100644
index 000000000..ab3191152
--- /dev/null
+++ b/integration/repl/src/users/users.service.ts
@@ -0,0 +1,32 @@
+import { Inject, Injectable } from '@nestjs/common';
+import { CreateUserDto } from './dto/create-user.dto';
+import { UpdateUserDto } from './dto/update-user.dto';
+import { UsersRepository } from './users.repository';
+
+@Injectable()
+export class UsersService {
+  constructor(
+    @Inject('UsersRepository')
+    private readonly usersRepository: UsersRepository,
+  ) {}
+
+  create(createUserDto: CreateUserDto) {
+    return 'This action adds a new user';
+  }
+
+  findAll() {
+    return `This action returns all users`;
+  }
+
+  findOne(id: number) {
+    return `This action returns a #${id} user`;
+  }
+
+  update(id: number, updateUserDto: UpdateUserDto) {
+    return `This action updates a #${id} user`;
+  }
+
+  remove(id: number) {
+    return `This action removes a #${id} user`;
+  }
+}
diff --git a/integration/repl/tsconfig.json b/integration/repl/tsconfig.json
new file mode 100644
index 000000000..ea15af490
--- /dev/null
+++ b/integration/repl/tsconfig.json
@@ -0,0 +1,22 @@
+{
+  "compilerOptions": {
+    "module": "commonjs",
+    "declaration": false,
+    "noImplicitAny": false,
+    "removeComments": true,
+    "noLib": false,
+    "emitDecoratorMetadata": true,
+    "experimentalDecorators": true,
+    "target": "es6",
+    "sourceMap": true,
+    "allowJs": true,
+    "outDir": "./dist"
+  },
+  "include": [
+    "src/**/*"
+  ],
+  "exclude": [
+    "node_modules",
+    "**/*.spec.ts"
+  ]
+}
\ No newline at end of file
diff --git a/integration/scopes/e2e/durable-providers.spec.ts b/integration/scopes/e2e/durable-providers.spec.ts
new file mode 100644
index 000000000..306d63aec
--- /dev/null
+++ b/integration/scopes/e2e/durable-providers.spec.ts
@@ -0,0 +1,76 @@
+import { INestApplication } from '@nestjs/common';
+import { ContextIdFactory } from '@nestjs/core';
+import { Test } from '@nestjs/testing';
+import { expect } from 'chai';
+import * as request from 'supertest';
+import { DurableContextIdStrategy } from '../src/durable/durable-context-id.strategy';
+import { DurableModule } from '../src/durable/durable.module';
+
+describe('Durable providers', () => {
+  let server: any;
+  let app: INestApplication;
+
+  before(async () => {
+    const moduleRef = await Test.createTestingModule({
+      imports: [DurableModule],
+    }).compile();
+
+    app = moduleRef.createNestApplication();
+    server = app.getHttpServer();
+    await app.init();
+
+    ContextIdFactory.apply(new DurableContextIdStrategy());
+  });
+
+  describe('when service is durable', () => {
+    const performHttpCall = (tenantId: number, end: (err?: any) => void) =>
+      request(server)
+        .get('/durable')
+        .set({ ['x-tenant-id']: tenantId })
+        .end((err, res) => {
+          if (err) return end(err);
+          end(res);
+        });
+
+    it(`should share durable providers per tenant`, async () => {
+      let result: request.Response;
+      result = await new Promise<request.Response>(resolve =>
+        performHttpCall(1, resolve),
+      );
+      expect(result.text).equal('Hello world! Counter: 1');
+
+      result = await new Promise<request.Response>(resolve =>
+        performHttpCall(1, resolve),
+      );
+      expect(result.text).equal('Hello world! Counter: 2');
+
+      result = await new Promise<request.Response>(resolve =>
+        performHttpCall(1, resolve),
+      );
+      expect(result.text).equal('Hello world! Counter: 3');
+    });
+
+    it(`should create per-tenant DI sub-tree`, async () => {
+      let result: request.Response;
+      result = await new Promise<request.Response>(resolve =>
+        performHttpCall(4, resolve),
+      );
+      expect(result.text).equal('Hello world! Counter: 1');
+
+      result = await new Promise<request.Response>(resolve =>
+        performHttpCall(5, resolve),
+      );
+      expect(result.text).equal('Hello world! Counter: 1');
+
+      result = await new Promise<request.Response>(resolve =>
+        performHttpCall(6, resolve),
+      );
+      expect(result.text).equal('Hello world! Counter: 1');
+    });
+  });
+
+  after(async () => {
+    ContextIdFactory['strategy'] = undefined;
+    await app.close();
+  });
+});
diff --git a/integration/scopes/src/durable/durable-context-id.strategy.ts b/integration/scopes/src/durable/durable-context-id.strategy.ts
new file mode 100644
index 000000000..dffa71515
--- /dev/null
+++ b/integration/scopes/src/durable/durable-context-id.strategy.ts
@@ -0,0 +1,21 @@
+import { ChildContextIdInfo, ContextId, ContextIdStrategy } from '@nestjs/core';
+import { Request } from 'express';
+
+const tenants = new Map<string, ContextId>();
+
+export class DurableContextIdStrategy implements ContextIdStrategy {
+  attach(contextId: ContextId, request: Request) {
+    const tenantId = request.headers['x-tenant-id'] as string;
+    let tenantSubTreeId: ContextId;
+
+    if (tenants.has(tenantId)) {
+      tenantSubTreeId = tenants.get(tenantId);
+    } else {
+      tenantSubTreeId = { id: +tenantId } as ContextId;
+      tenants.set(tenantId, tenantSubTreeId);
+    }
+
+    return (info: ChildContextIdInfo) =>
+      info.isTreeDurable ? tenantSubTreeId : contextId;
+  }
+}
diff --git a/integration/scopes/src/durable/durable.controller.ts b/integration/scopes/src/durable/durable.controller.ts
new file mode 100644
index 000000000..0800381c0
--- /dev/null
+++ b/integration/scopes/src/durable/durable.controller.ts
@@ -0,0 +1,12 @@
+import { Controller, Get } from '@nestjs/common';
+import { DurableService } from './durable.service';
+
+@Controller('durable')
+export class DurableController {
+  constructor(private readonly durableService: DurableService) {}
+
+  @Get()
+  greeting(): string {
+    return this.durableService.greeting();
+  }
+}
diff --git a/integration/scopes/src/durable/durable.module.ts b/integration/scopes/src/durable/durable.module.ts
new file mode 100644
index 000000000..ed312900f
--- /dev/null
+++ b/integration/scopes/src/durable/durable.module.ts
@@ -0,0 +1,9 @@
+import { Module } from '@nestjs/common';
+import { DurableController } from './durable.controller';
+import { DurableService } from './durable.service';
+
+@Module({
+  controllers: [DurableController],
+  providers: [DurableService],
+})
+export class DurableModule {}
diff --git a/integration/scopes/src/durable/durable.service.ts b/integration/scopes/src/durable/durable.service.ts
new file mode 100644
index 000000000..84639a215
--- /dev/null
+++ b/integration/scopes/src/durable/durable.service.ts
@@ -0,0 +1,11 @@
+import { Injectable, Scope } from '@nestjs/common';
+
+@Injectable({ scope: Scope.REQUEST, durable: true })
+export class DurableService {
+  public instanceCounter = 0;
+
+  greeting() {
+    ++this.instanceCounter;
+    return `Hello world! Counter: ${this.instanceCounter}`;
+  }
+}
diff --git a/integration/send-files/e2e/express.spec.ts b/integration/send-files/e2e/express.spec.ts
index 425ce6695..1657d137c 100644
--- a/integration/send-files/e2e/express.spec.ts
+++ b/integration/send-files/e2e/express.spec.ts
@@ -9,7 +9,8 @@ import { join } from 'path';
 import * as request from 'supertest';
 import { AppModule } from '../src/app.module';
 
-const readmeString = readFileSync(join(process.cwd(), 'Readme.md')).toString();
+const readme = readFileSync(join(process.cwd(), 'Readme.md'));
+const readmeString = readme.toString();
 
 describe('Express FileSend', () => {
   let app: NestExpressApplication;
@@ -53,12 +54,13 @@ describe('Express FileSend', () => {
         expect(res.body.toString()).to.be.eq(readmeString);
       });
   });
-  it('should return a file with correct content type and disposition', async () => {
+  it('should return a file with correct headers', async () => {
     return request(app.getHttpServer())
       .get('/file/with/headers')
       .expect(200)
       .expect('Content-Type', 'text/markdown')
       .expect('Content-Disposition', 'attachment; filename="Readme.md"')
+      .expect('Content-Length', readme.byteLength.toString())
       .expect(res => {
         expect(res.text).to.be.eq(readmeString);
       });
diff --git a/integration/send-files/e2e/fastify.spec.ts b/integration/send-files/e2e/fastify.spec.ts
index 9e7ee5b5e..8b821ba7c 100644
--- a/integration/send-files/e2e/fastify.spec.ts
+++ b/integration/send-files/e2e/fastify.spec.ts
@@ -8,7 +8,8 @@ import { readFileSync } from 'fs';
 import { join } from 'path';
 import { AppModule } from '../src/app.module';
 
-const readmeString = readFileSync(join(process.cwd(), 'Readme.md')).toString();
+const readme = readFileSync(join(process.cwd(), 'Readme.md'));
+const readmeString = readme.toString();
 
 describe('Fastify FileSend', () => {
   let app: NestFastifyApplication;
@@ -67,4 +68,17 @@ describe('Fastify FileSend', () => {
         expect(payload.toString()).to.be.eq(readmeString);
       });
   });
+  it('should return a file with correct headers', async () => {
+    return app
+      .inject({ url: '/file/with/headers', method: 'get' })
+      .then(({ statusCode, headers, payload }) => {
+        expect(statusCode).to.equal(200);
+        expect(headers['content-type']).to.equal('text/markdown');
+        expect(headers['content-disposition']).to.equal(
+          'attachment; filename="Readme.md"',
+        );
+        expect(headers['content-length']).to.equal(readme.byteLength);
+        expect(payload).to.equal(readmeString);
+      });
+  });
 });
diff --git a/integration/send-files/src/app.service.ts b/integration/send-files/src/app.service.ts
index a83e6a4f6..ba5849a75 100644
--- a/integration/send-files/src/app.service.ts
+++ b/integration/send-files/src/app.service.ts
@@ -25,11 +25,13 @@ export class AppService {
   }
 
   getFileWithHeaders(): StreamableFile {
+    const file = readFileSync(join(process.cwd(), 'Readme.md'));
     return new StreamableFile(
       createReadStream(join(process.cwd(), 'Readme.md')),
       {
         type: 'text/markdown',
         disposition: 'attachment; filename="Readme.md"',
+        length: file.byteLength,
       },
     );
   }
diff --git a/integration/typeorm/e2e/typeorm.spec.ts b/integration/typeorm/e2e/typeorm.spec.ts
index 60ab18303..958713903 100644
--- a/integration/typeorm/e2e/typeorm.spec.ts
+++ b/integration/typeorm/e2e/typeorm.spec.ts
@@ -1,7 +1,7 @@
 import { INestApplication } from '@nestjs/common';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 describe('TypeOrm', () => {
   let server;
@@ -9,7 +9,7 @@ describe('TypeOrm', () => {
 
   beforeEach(async () => {
     const module = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
 
     app = module.createNestApplication();
diff --git a/integration/typeorm/src/app.module.ts b/integration/typeorm/src/app.module.ts
index 32fbf84fd..96bdb7bb1 100644
--- a/integration/typeorm/src/app.module.ts
+++ b/integration/typeorm/src/app.module.ts
@@ -21,4 +21,4 @@ import { PhotoModule } from './photo/photo.module';
     PhotoModule,
   ],
 })
-export class ApplicationModule {}
+export class AppModule {}
diff --git a/integration/versioning/e2e/custom-versioning-fastify.spec.ts b/integration/versioning/e2e/custom-versioning-fastify.spec.ts
new file mode 100644
index 000000000..0deaf4e59
--- /dev/null
+++ b/integration/versioning/e2e/custom-versioning-fastify.spec.ts
@@ -0,0 +1,967 @@
+import { INestApplication, VersioningType } from '@nestjs/common';
+import {
+  FastifyAdapter,
+  NestFastifyApplication,
+} from '@nestjs/platform-fastify';
+import { Test } from '@nestjs/testing';
+import { FastifyRequest } from 'fastify';
+import * as request from 'supertest';
+import { AppModule } from '../src/app.module';
+
+describe('Custom Versioning (fastify)', () => {
+  const extractor = (request: FastifyRequest): string | string[] => {
+    const versions = [request.headers['accept'] ?? '']
+      .flatMap(v => v.split(','))
+      .map(header => header.match(/v(\d+\.?\d*)\+json$/))
+      .filter(match => match && match.length)
+      .map(matchArray => matchArray[1])
+      .sort()
+      .reverse();
+
+    return versions;
+  };
+  let app: INestApplication;
+
+  // ======================================================================== //
+  describe('without global default version', () => {
+    before(async () => {
+      const moduleRef = await Test.createTestingModule({
+        imports: [AppModule],
+      }).compile();
+
+      app = moduleRef.createNestApplication<NestFastifyApplication>(
+        new FastifyAdapter(),
+      );
+      app.enableVersioning({
+        type: VersioningType.CUSTOM,
+        extractor,
+      });
+      await app.init();
+      await app.getHttpAdapter().getInstance().ready();
+    });
+
+    describe('GET /', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Hello World V1!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Hello World V2!');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Hello World V2!');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Hello World V2!');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/').expect(404);
+      });
+    });
+
+    describe('GET /:param', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Parameter V1!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Parameter V2!');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Parameter V2!');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Parameter V2!');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: '',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/').expect(404);
+      });
+    });
+
+    describe('GET /multiple', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/multiple').expect(404);
+      });
+    });
+
+    describe('GET /neutral', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .expect(200)
+          .expect('Neutral');
+      });
+    });
+
+    describe('GET /override', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Override Version 1');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Version 2');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Version 2');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Override Version 2');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/override').expect(404);
+      });
+    });
+
+    describe('GET /override-partial', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 1');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 2');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 2');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 2');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .expect(404);
+      });
+    });
+
+    describe('GET /foo/bar', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+    });
+
+    after(async () => {
+      await app.close();
+    });
+  });
+
+  // ======================================================================== //
+  describe('with the global default version: "1"', () => {
+    before(async () => {
+      const moduleRef = await Test.createTestingModule({
+        imports: [AppModule],
+      }).compile();
+
+      app = moduleRef.createNestApplication<NestFastifyApplication>(
+        new FastifyAdapter(),
+      );
+      app.enableVersioning({
+        type: VersioningType.CUSTOM,
+        extractor,
+        defaultVersion: '1',
+      });
+      await app.init();
+      await app.getHttpAdapter().getInstance().ready();
+    });
+
+    describe('GET /', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Hello World V1!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Hello World V2!');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Hello World V2!');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Hello World V2!');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/').expect(404);
+      });
+    });
+
+    describe('GET /:param', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Parameter V1!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Parameter V2!');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Parameter V2!');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Parameter V2!');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: '',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/').expect(404);
+      });
+    });
+
+    describe('GET /multiple', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/multiple').expect(404);
+      });
+    });
+
+    describe('GET /neutral', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .expect(200)
+          .expect('Neutral');
+      });
+    });
+
+    describe('GET /override', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Override Version 1');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Version 2');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Version 2');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Override Version 2');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/override').expect(404);
+      });
+    });
+
+    describe('GET /override-partial', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 1');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 2');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 2');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 2');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .expect(404);
+      });
+    });
+
+    describe('GET /foo/bar', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(404);
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect('Hello FooBar!');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/foo/bar').expect(404);
+      });
+    });
+
+    after(async () => {
+      await app.close();
+    });
+  });
+});
diff --git a/integration/versioning/e2e/custom-versioning.spec.ts b/integration/versioning/e2e/custom-versioning.spec.ts
new file mode 100644
index 000000000..9cff09d2f
--- /dev/null
+++ b/integration/versioning/e2e/custom-versioning.spec.ts
@@ -0,0 +1,712 @@
+import { INestApplication, VersioningType } from '@nestjs/common';
+import { Test } from '@nestjs/testing';
+import { Request } from 'express';
+import * as request from 'supertest';
+import { AppModule } from '../src/app.module';
+
+describe('Custom Versioning', () => {
+  const extractor = (request: Request): string | string[] => {
+    const versions = request
+      .header('Accept')
+      ?.split(',')
+      .map(header => header.match(/v(\d+\.?\d*)\+json$/))
+      .filter(match => match && match.length)
+      .map(matchArray => matchArray[1])
+      .sort()
+      .reverse();
+
+    return versions;
+  };
+  let app: INestApplication;
+
+  // ======================================================================== //
+  describe('without global default version', () => {
+    before(async () => {
+      const moduleRef = await Test.createTestingModule({
+        imports: [AppModule],
+      }).compile();
+
+      app = moduleRef.createNestApplication();
+      app.enableVersioning({
+        type: VersioningType.CUSTOM,
+        extractor,
+      });
+      await app.init();
+    });
+
+    describe('GET /', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Hello World V1!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Hello World V2!');
+      });
+
+      // There's a known limitation of the express-adapter, where
+      // it cannot handle selection of the highest matched version properly.
+      //
+      // it('V2, if two versions are requested, select the highest version', () => {
+      //   return request(app.getHttpServer())
+      //     .get('/')
+      //     .set({
+      //       Accept: 'application/foo.v1+json, application/foo.v2+json',
+      //     })
+      //     .expect(200)
+      //     .expect('Hello World V2!');
+      // });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/').expect(404);
+      });
+    });
+
+    describe('GET /:param', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Parameter V1!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Parameter V2!');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: '',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/').expect(404);
+      });
+    });
+
+    describe('GET /multiple', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V2, if an unsupported version is specified, select the lower supported version', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/multiple').expect(404);
+      });
+    });
+
+    describe('GET /neutral', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .expect(200)
+          .expect('Neutral');
+      });
+    });
+
+    describe('GET /override', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Override Version 1');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Version 2');
+      });
+
+      // There's a known limitation of the express-adapter, where
+      // it cannot handle selection of the highest matched version properly.
+      //
+      // it('V2, if two versions are requested, select the highest version', () => {
+      //   return request(app.getHttpServer())
+      //     .get('/override')
+      //     .set({
+      //       Accept: 'application/foo.v1+json, application/foo.v2+json',
+      //     })
+      //     .expect(200)
+      //     .expect('Override Version 2');
+      // });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/override').expect(404);
+      });
+    });
+
+    describe('GET /override-partial', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 1');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 2');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .expect(404);
+      });
+    });
+
+    describe('GET /foo/bar', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+    });
+
+    after(async () => {
+      await app.close();
+    });
+  });
+
+  // ======================================================================== //
+  describe('with the global default version: "1"', () => {
+    before(async () => {
+      const moduleRef = await Test.createTestingModule({
+        imports: [AppModule],
+      }).compile();
+
+      app = moduleRef.createNestApplication();
+      app.enableVersioning({
+        type: VersioningType.CUSTOM,
+        extractor,
+        defaultVersion: '1',
+      });
+      await app.init();
+    });
+
+    describe('GET /', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Hello World V1!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Hello World V2!');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/').expect(404);
+      });
+    });
+
+    describe('GET /:param', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Parameter V1!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Parameter V2!');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: '',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/').expect(404);
+      });
+    });
+
+    describe('GET /multiple', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/multiple').expect(404);
+      });
+    });
+
+    describe('GET /neutral', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .expect(200)
+          .expect('Neutral');
+      });
+    });
+
+    describe('GET /override', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Override Version 1');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Version 2');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/override').expect(404);
+      });
+    });
+
+    describe('GET /override-partial', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 1');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 2');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .expect(404);
+      });
+    });
+
+    describe('GET /foo/bar', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(404);
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/foo/bar').expect(404);
+      });
+    });
+
+    after(async () => {
+      await app.close();
+    });
+  });
+});
diff --git a/integration/websockets/e2e/ws-gateway.spec.ts b/integration/websockets/e2e/ws-gateway.spec.ts
index c68883ba3..973e7c839 100644
--- a/integration/websockets/e2e/ws-gateway.spec.ts
+++ b/integration/websockets/e2e/ws-gateway.spec.ts
@@ -14,7 +14,7 @@ async function createNestApp(...gateways): Promise<INestApplication> {
   const testingModule = await Test.createTestingModule({
     providers: gateways,
   }).compile();
-  const app = await testingModule.createNestApplication();
+  const app = testingModule.createNestApplication();
   app.useWebSocketAdapter(new WsAdapter(app) as any);
   return app;
 }
@@ -40,6 +40,7 @@ describe('WebSocketGateway (WsAdapter)', () => {
     await new Promise<void>(resolve =>
       ws.on('message', data => {
         expect(JSON.parse(data).data.test).to.be.eql('test');
+        ws.close();
         resolve();
       }),
     );
@@ -63,6 +64,7 @@ describe('WebSocketGateway (WsAdapter)', () => {
     await new Promise<void>(resolve =>
       ws.on('message', data => {
         expect(JSON.parse(data).data.test).to.be.eql('test');
+        ws.close();
         resolve();
       }),
     );
@@ -70,7 +72,7 @@ describe('WebSocketGateway (WsAdapter)', () => {
 
   it(`should handle message on a different path`, async () => {
     app = await createNestApp(WsPathGateway);
-    await app.listenAsync(3000);
+    await app.listen(3000);
     try {
       ws = new WebSocket('ws://localhost:3000/ws-path');
       await new Promise((resolve, reject) => {
@@ -89,6 +91,7 @@ describe('WebSocketGateway (WsAdapter)', () => {
       await new Promise<void>(resolve =>
         ws.on('message', data => {
           expect(JSON.parse(data).data.test).to.be.eql('test');
+          ws.close();
           resolve();
         }),
       );
@@ -101,7 +104,7 @@ describe('WebSocketGateway (WsAdapter)', () => {
     this.retries(10);
 
     app = await createNestApp(ExamplePathGateway, WsPathGateway2);
-    await app.listenAsync(3000);
+    await app.listen(3000);
 
     // open websockets delay
     await new Promise(resolve => setTimeout(resolve, 1000));
@@ -113,6 +116,7 @@ describe('WebSocketGateway (WsAdapter)', () => {
       ws.on('open', () => {
         ws.on('message', data => {
           expect(JSON.parse(data).data.test).to.be.eql('test');
+          ws.close();
           resolve();
         });
         ws.send(
@@ -129,6 +133,7 @@ describe('WebSocketGateway (WsAdapter)', () => {
     await new Promise<void>(resolve => {
       ws2.on('message', data => {
         expect(JSON.parse(data).data.test).to.be.eql('test');
+        ws2.close();
         resolve();
       });
       ws2.send(
@@ -158,6 +163,7 @@ describe('WebSocketGateway (WsAdapter)', () => {
       ws.on('open', () => {
         ws.on('message', data => {
           expect(JSON.parse(data).data.test).to.be.eql('test');
+          ws.close();
           resolve();
         });
         ws.send(
@@ -174,6 +180,7 @@ describe('WebSocketGateway (WsAdapter)', () => {
     await new Promise<void>(resolve => {
       ws2.on('message', data => {
         expect(JSON.parse(data).data.test).to.be.eql('test');
+        ws2.close();
         resolve();
       });
       ws2.send(
@@ -187,5 +194,7 @@ describe('WebSocketGateway (WsAdapter)', () => {
     });
   });
 
-  afterEach(() => app.close());
+  afterEach(async function () {
+    await app.close();
+  });
 });
diff --git a/lerna.json b/lerna.json
index 042e9d281..efd62bfbb 100644
--- a/lerna.json
+++ b/lerna.json
@@ -3,5 +3,5 @@
   "packages": [
     "packages/*"
   ],
-  "version": "8.2.3"
+  "version": "8.4.7"
 }
diff --git a/package-lock.json b/package-lock.json
index 92187fe8c..1701f5ffd 100644
Binary files a/package-lock.json and b/package-lock.json differ
diff --git a/package.json b/package.json
index d8ee91800..603816aed 100644
--- a/package.json
+++ b/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/core",
-  "version": "8.2.3",
+  "version": "9.0.0-next.1",
   "description": "Modern, fast, powerful node.js web framework",
   "homepage": "https://nestjs.com",
   "repository": {
@@ -23,19 +23,20 @@
     "clean": "gulp clean:bundle",
     "codechecks:benchmarks": "codechecks ./tools/benchmarks/check-benchmarks.ts",
     "coverage": "nyc report --reporter=text-lcov | coveralls",
-    "format": "prettier \"**/*.ts\" --ignore-path ./.prettierignore --write && git status",
+    "format": "prettier \"**/*.ts\" \"packages/**/*.json\" --ignore-path ./.prettierignore --write && git status",
     "postinstall": "opencollective",
-    "test": "nyc --require ts-node/register mocha packages/**/*.spec.ts --reporter spec --require 'node_modules/reflect-metadata/Reflect.js' --exit",
-    "test:integration": "mocha \"integration/*/{,!(node_modules)/**/}/*.spec.ts\" --reporter spec --require ts-node/register --require 'node_modules/reflect-metadata/Reflect.js' --exit",
+    "test": "nyc mocha packages/**/*.spec.ts --reporter spec",
+    "test:integration": "mocha \"integration/*/{,!(node_modules)/**/}/*.spec.ts\" --reporter spec",
     "test:docker:up": "docker-compose -f integration/docker-compose.yml up -d",
     "test:docker:down": "docker-compose -f integration/docker-compose.yml down",
     "lint": "concurrently 'npm run lint:packages' 'npm run lint:integration' 'npm run lint:spec'",
     "lint:fix": "concurrently 'npm run lint:packages -- --fix' 'npm run lint:integration -- --fix' 'npm run lint:spec -- --fix'",
-    "lint:integration": "eslint 'integration/*/{,!(node_modules)/**/}/*.ts' -c '.eslintrc.spec.js'",
+    "lint:integration": "eslint 'integration/*/{,!(node_modules)/**/}/*.ts'",
     "lint:packages": "eslint 'packages/**/**.ts' --ignore-pattern 'packages/**/*.spec.ts'",
-    "lint:spec": "eslint 'packages/**/**.spec.ts' -c '.eslintrc.spec.js'",
-    "prerelease": "gulp copy-misc && gulp build --dist node_modules/@nestjs && npm run changelog | pbcopy",
+    "lint:spec": "eslint 'packages/**/**.spec.ts'",
+    "prerelease": "gulp copy-misc && gulp build --dist node_modules/@nestjs",
     "publish": "npm run prerelease && npm run build:prod && ./node_modules/.bin/lerna publish --force-publish --access public --exact -m \"chore(@nestjs) publish %s release\"",
+    "prepublishOnly": "npm run changelog | pbcopy",
     "publish:beta": "npm run prerelease && npm run build:prod && ./node_modules/.bin/lerna publish --npm-tag=beta --access public -m \"chore(@nestjs) publish %s release\"",
     "publish:next": "npm run prerelease && npm run build:prod && ./node_modules/.bin/lerna publish --npm-tag=next --access public --skip-git -m \"chore(@nestjs) publish %s release\"",
     "publish:rc": "npm run prerelease && npm run build:prod && ./node_modules/.bin/lerna publish --npm-tag=rc --access public -m \"chore(@nestjs) publish %s release\"",
@@ -43,132 +44,135 @@
     "prepare": "husky install"
   },
   "lint-staged": {
-    "packages/**/*.{ts,json}": [
+    "**/*.ts": [
+      "prettier --ignore-path ./.prettierignore --write"
+    ],
+    "packages/**/*.json": [
       "prettier --ignore-path ./.prettierignore --write"
     ]
   },
   "dependencies": {
     "@nuxtjs/opencollective": "0.3.2",
-    "axios": "0.24.0",
-    "class-transformer": "0.4.0",
+    "class-transformer": "0.5.1",
     "class-validator": "0.13.2",
-    "cli-color": "2.0.1",
+    "cli-color": "2.0.2",
     "cors": "2.8.5",
-    "express": "4.17.1",
-    "fast-json-stringify": "2.7.12",
+    "express": "4.18.1",
+    "fast-json-stringify": "4.2.0",
     "fast-safe-stringify": "2.1.1",
     "graphql-subscriptions": "2.0.0",
     "iterare": "1.2.1",
-    "object-hash": "2.2.0",
+    "object-hash": "3.0.0",
     "path-to-regexp": "3.2.0",
     "reflect-metadata": "0.1.13",
-    "rxjs": "7.4.0",
-    "socket.io": "4.4.0",
-    "tslib": "2.3.1",
+    "rxjs": "7.5.5",
+    "socket.io": "4.5.1",
+    "tslib": "2.4.0",
     "uuid": "8.3.2"
   },
   "devDependencies": {
     "@codechecks/client": "0.1.12",
-    "@commitlint/cli": "15.0.0",
-    "@commitlint/config-angular": "15.0.0",
-    "@grpc/grpc-js": "1.4.4",
-    "@grpc/proto-loader": "0.6.7",
-    "@nestjs/graphql": "9.1.2",
-    "@nestjs/mongoose": "9.0.1",
-    "@nestjs/typeorm": "8.0.2",
+    "@commitlint/cli": "17.0.2",
+    "@commitlint/config-angular": "17.0.0",
+    "@fastify/cors": "7.0.0",
+    "@fastify/formbody": "7.0.1",
+    "@fastify/middie": "8.0.0",
+    "@fastify/multipart": "6.0.0",
+    "@fastify/static": "5.0.0",
+    "@grpc/grpc-js": "1.6.7",
+    "@grpc/proto-loader": "0.6.13",
+    "@nestjs/apollo": "10.0.14",
+    "@nestjs/graphql": "10.0.15",
+    "@nestjs/mongoose": "9.1.1",
+    "@nestjs/typeorm": "8.0.4",
     "@types/amqplib": "0.8.2",
     "@types/bytes": "3.1.1",
-    "@types/cache-manager": "3.4.2",
-    "@types/chai": "4.2.22",
-    "@types/chai-as-promised": "7.1.4",
+    "@types/cache-manager": "4.0.0",
+    "@types/chai": "4.3.1",
+    "@types/chai-as-promised": "7.1.5",
     "@types/cors": "2.8.12",
     "@types/express": "4.17.13",
     "@types/gulp": "4.0.9",
-    "@types/http-errors": "1.8.1",
-    "@types/mocha": "9.0.0",
-    "@types/node": "16.11.11",
-    "@types/redis": "2.8.32",
+    "@types/http-errors": "1.8.2",
+    "@types/mocha": "9.1.1",
+    "@types/node": "17.0.43",
     "@types/reflect-metadata": "0.1.0",
-    "@types/sinon": "10.0.6",
-    "@types/socket.io": "3.0.2",
-    "@types/ws": "8.2.0",
+    "@types/sinon": "10.0.11",
+    "@types/supertest": "2.0.12",
+    "@types/ws": "8.5.3",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
-    "amqp-connection-manager": "3.7.0",
-    "amqplib": "0.8.0",
-    "apollo-server-core": "3.5.0",
-    "apollo-server-express": "3.5.0",
+    "amqp-connection-manager": "4.1.3",
+    "amqplib": "0.10.0",
+    "apollo-server-core": "3.8.2",
+    "apollo-server-express": "3.8.2",
     "artillery": "1.7.9",
-    "body-parser": "1.19.0",
-    "bytes": "3.1.1",
-    "cache-manager": "3.6.0",
+    "body-parser": "1.20.0",
+    "bytes": "3.1.2",
+    "cache-manager": "4.0.1",
     "cache-manager-redis-store": "2.0.0",
-    "chai": "4.3.4",
+    "chai": "4.3.6",
     "chai-as-promised": "7.1.1",
-    "clang-format": "1.6.0",
+    "clang-format": "1.8.0",
     "commitlint-circle": "1.0.0",
-    "concurrently": "6.4.0",
-    "conventional-changelog": "3.1.24",
-    "core-js": "3.19.3",
+    "concurrently": "7.2.2",
+    "conventional-changelog": "3.1.25",
+    "core-js": "3.23.1",
     "coveralls": "3.1.1",
     "delete-empty": "3.0.0",
-    "engine.io-client": "6.1.1",
+    "engine.io-client": "6.2.2",
     "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "eventsource": "1.1.0",
-    "fancy-log": "1.3.3",
-    "fastify": "3.24.1",
-    "fastify-cors": "6.0.2",
-    "fastify-formbody": "5.2.0",
-    "fastify-multipart": "5.2.0",
-    "fastify-static": "4.5.0",
-    "graphql": "15.7.2",
-    "graphql-tools": "7.0.5",
+    "eslint-config-prettier": "8.5.0",
+    "eslint-plugin-import": "2.26.0",
+    "eventsource": "2.0.2",
+    "fancy-log": "2.0.0",
+    "fastify": "4.0.2",
+    "graphql": "15.8.0",
+    "graphql-tools": "8.2.12",
     "gulp": "4.0.2",
     "gulp-clang-format": "1.0.27",
     "gulp-clean": "0.4.0",
     "gulp-sourcemaps": "3.0.0",
     "gulp-typescript": "5.0.1",
     "gulp-watch": "5.0.1",
-    "http-errors": "1.8.1",
-    "husky": "7.0.4",
-    "imports-loader": "3.1.1",
+    "http-errors": "2.0.0",
+    "husky": "8.0.1",
+    "imports-loader": "4.0.0",
+    "ioredis": "5.0.4",
     "json-loader": "0.5.7",
-    "kafkajs": "1.15.0",
+    "kafkajs": "2.0.2",
     "lerna": "2.11.0",
     "lerna-changelog": "2.2.0",
-    "light-my-request": "4.7.0",
-    "lint-staged": "12.1.2",
+    "light-my-request": "5.0.0",
+    "lint-staged": "13.0.1",
     "markdown-table": "2.0.0",
     "merge-graphql-schemas": "1.7.8",
-    "middie": "5.3.0",
-    "mocha": "9.1.3",
-    "mongoose": "6.0.14",
-    "mqtt": "4.2.8",
-    "multer": "1.4.3",
+    "mocha": "10.0.0",
+    "mongoose": "6.3.8",
+    "mqtt": "4.3.7",
+    "multer": "1.4.4",
     "mysql2": "2.3.3",
-    "nats": "2.4.0",
-    "nodemon": "2.0.15",
+    "nats": "2.7.1",
+    "nodemon": "2.0.16",
     "nyc": "15.1.0",
-    "point-of-view": "4.15.3",
-    "prettier": "2.5.1",
+    "point-of-view": "6.3.0",
+    "prettier": "2.7.0",
     "redis": "3.1.2",
     "rxjs-compat": "6.6.7",
-    "sinon": "12.0.1",
+    "sinon": "14.0.0",
     "sinon-chai": "3.7.0",
-    "socket.io-client": "4.4.0",
+    "socket.io-client": "4.5.1",
     "subscriptions-transport-ws": "0.11.0",
-    "supertest": "6.1.6",
-    "ts-morph": "13.0.2",
-    "ts-node": "10.4.0",
-    "typeorm": "0.2.41",
-    "typescript": "4.3.5",
+    "supertest": "6.2.3",
+    "ts-morph": "15.1.0",
+    "ts-node": "10.8.1",
+    "typeorm": "0.2.45",
+    "typescript": "4.7.3",
     "wrk": "1.2.1",
-    "ws": "7.5.6"
+    "ws": "8.8.0"
   },
   "engines": {
-    "node": ">= 10.13.0"
+    "node": ">= 12.9.0"
   },
   "collective": {
     "type": "opencollective",
@@ -183,6 +187,7 @@
       "type: bug :sob:": "Bug fixes",
       "type: enhancement :wolf:": "Enhancements",
       "type: docs :page_facing_up:": "Docs",
+      "type: code style": "Code style tweaks",
       "dependencies": "Dependencies"
     }
   },
@@ -221,5 +226,13 @@
     ],
     "sourceMap": true,
     "instrument": true
+  },
+  "mocha": {
+    "require": [
+      "ts-node/register",
+      "node_modules/reflect-metadata/Reflect.js",
+      "hooks/mocha-init-hook.ts"
+    ],
+    "exit": true
   }
 }
diff --git a/packages/common/CHANGELOG.md b/packages/common/CHANGELOG.md
deleted file mode 100644
index 5d699e1d6..000000000
--- a/packages/common/CHANGELOG.md
+++ /dev/null
@@ -1,18 +0,0 @@
-# Change Log
-
-All notable changes to this project will be documented in this file.
-See [Conventional Commits](https://conventionalcommits.org) for commit guidelines.
-
-<a name="8.2.0"></a>
-# [8.2.0](https://github.com/nestjs/nest/compare/v8.1.2...v8.2.0) (2021-11-08)
-
-
-### Bug Fixes
-
-* **deps:** update dependency axios to v0.24.0 ([fc77e4f](https://github.com/nestjs/nest/commit/fc77e4f))
-
-
-### Features
-
-* **common:** add the ability to set some extra metadata about returned files ([5100573](https://github.com/nestjs/nest/commit/5100573))
-* **common:** allow to swap out class-validator and class-transformer ([2a1cc62](https://github.com/nestjs/nest/commit/2a1cc62))
diff --git a/packages/common/Readme.md b/packages/common/Readme.md
index f288809a9..9a3f42045 100644
--- a/packages/common/Readme.md
+++ b/packages/common/Readme.md
@@ -54,36 +54,42 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
 <table style="text-align:center;"><tr>
   <td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
+  <td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/red-hat-logo.svg" width="200" valign="middle" /></a></td>
 <td>
 <a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
 <td>
 <a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
+    <td>
+<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td><td>
+<a href="https://amplication.com/" target="_blank"><img src="https://nestjs.com/img/amplication-logo.svg" width="190" valign="middle" /></a></td>
 </tr></table>
 
 #### Gold Sponsors
 
 <table style="text-align:center;"><tr><td>
-  <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
-  <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
+<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="140" valign="middle" /></a></td>
 <td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
+<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td>
+ <td>
+<a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
+<a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td><td>
+<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
 <table style="text-align:center;"><tr><td>
 <a href="https://neoteric.eu/" target="_blank"><img src="https://nestjs.com/img/neoteric-cut.png" width="120" valign="middle" /></a> </td><td>
   <a href="http://gojob.com" target="_blank"><img src="http://nestjs.com/img/gojob-logo.png" valign="middle" width="100" /></a> </td><td>
-<a href="http://www.leogistics.com" target="_blank"><img src="https://nestjs.com/img/leogistics-logo.jpeg" width="150" valign="middle" /></td><td>
+<a href="https://www.myleodsc.com/" target="_blank"><img src="https://nestjs.com/img/myleo-logo.png" width="180" valign="middle" /></td><td>
 <a href="https://careers.meetdandy.com/?gh_src=063ba61e3us" target="_blank"><img src="https://nestjs.com/img/dandy-roles-logo.svg" width="150" valign="middle" /></td><td>
 <a href="https://www.castlecraft.in" target="_blank"><img src="https://nestjs.com/img/castlecraft-logo.png" width="150" valign="middle" /></td>
-<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td></tr></table>
+<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td>
+<td><a href="https://n.inc" target="_blank"><img src="https://nestjs.com/img/n-inc-logo.svg" width="120" valign="middle" /></td></tr></table>
 
 #### Sponsors
 
@@ -117,6 +123,11 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/naologic-logo.svg" width="125" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://messaged.com/" target="_blank"><img src="https://nestjs.com/img/messaged-logo.png" width="50" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/triplecore-logo.svg" width="50" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://klqc.de" target="_blank"><img src="https://nestjs.com/img/klcqcl-logo.png" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://thecasinowizard.com/bonuses/no-deposit-bonuses/" target="_blank"><img src="https://nestjs.com/img/casinowizard-logo.png" width="120" valign="middle" /></a></td></tr><tr>
+     <td align="center" valign="middle"><a href="https://polygon-software.ch/" target="_blank"><img src="https://nestjs.com/img/polygon-logo.svg" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://mobilereality.pl/" target="_blank"><img src="https://nestjs.com/img/mobile-reality-logo.png" width="45" valign="middle" /></a></td>
+     <td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/boringowl-logo.svg" width="120" valign="middle" /></a></td>
   </tr></table>
 
 ## Backers
diff --git a/packages/common/cache/cache.constants.ts b/packages/common/cache/cache.constants.ts
index 0ecf5c94e..799547a7b 100644
--- a/packages/common/cache/cache.constants.ts
+++ b/packages/common/cache/cache.constants.ts
@@ -1,4 +1,3 @@
 export const CACHE_MANAGER = 'CACHE_MANAGER';
-export const CACHE_MODULE_OPTIONS = 'CACHE_MODULE_OPTIONS';
 export const CACHE_KEY_METADATA = 'cache_module:cache_key';
 export const CACHE_TTL_METADATA = 'cache_module:cache_ttl';
diff --git a/packages/common/cache/cache.module-definition.ts b/packages/common/cache/cache.module-definition.ts
new file mode 100644
index 000000000..25d74e986
--- /dev/null
+++ b/packages/common/cache/cache.module-definition.ts
@@ -0,0 +1,12 @@
+import { ConfigurableModuleBuilder } from '../module-utils';
+import {
+  CacheModuleOptions,
+  CacheOptionsFactory,
+} from './interfaces/cache-module.interface';
+
+export const { ConfigurableModuleClass, MODULE_OPTIONS_TOKEN } =
+  new ConfigurableModuleBuilder<CacheModuleOptions>({
+    moduleName: 'Cache',
+  })
+    .setFactoryMethodName('createCacheOptions' as keyof CacheOptionsFactory)
+    .build();
diff --git a/packages/common/cache/cache.module.ts b/packages/common/cache/cache.module.ts
index 4e2c63d48..992f98f03 100644
--- a/packages/common/cache/cache.module.ts
+++ b/packages/common/cache/cache.module.ts
@@ -1,11 +1,11 @@
 import { Module } from '../decorators';
-import { DynamicModule, Provider } from '../interfaces';
-import { CACHE_MANAGER, CACHE_MODULE_OPTIONS } from './cache.constants';
+import { DynamicModule } from '../interfaces';
+import { CACHE_MANAGER } from './cache.constants';
+import { ConfigurableModuleClass } from './cache.module-definition';
 import { createCacheManager } from './cache.providers';
 import {
   CacheModuleAsyncOptions,
   CacheModuleOptions,
-  CacheOptionsFactory,
 } from './interfaces/cache-module.interface';
 
 /**
@@ -19,7 +19,7 @@ import {
   providers: [createCacheManager()],
   exports: [CACHE_MANAGER],
 })
-export class CacheModule {
+export class CacheModule extends ConfigurableModuleClass {
   /**
    * Configure the cache manager statically.
    *
@@ -31,9 +31,8 @@ export class CacheModule {
     options: CacheModuleOptions<StoreConfig> = {} as any,
   ): DynamicModule {
     return {
-      module: CacheModule,
       global: options.isGlobal,
-      providers: [{ provide: CACHE_MODULE_OPTIONS, useValue: options }],
+      ...super.register(options),
     };
   }
 
@@ -48,47 +47,11 @@ export class CacheModule {
   static registerAsync<
     StoreConfig extends Record<any, any> = Record<string, any>,
   >(options: CacheModuleAsyncOptions<StoreConfig>): DynamicModule {
+    const moduleDefinition = super.registerAsync(options);
     return {
-      module: CacheModule,
       global: options.isGlobal,
-      imports: options.imports,
-      providers: [
-        ...this.createAsyncProviders<StoreConfig>(options),
-        ...(options.extraProviders || []),
-      ],
-    };
-  }
-
-  private static createAsyncProviders<StoreConfig extends Record<any, any>>(
-    options: CacheModuleAsyncOptions<StoreConfig>,
-  ): Provider[] {
-    if (options.useExisting || options.useFactory) {
-      return [this.createAsyncOptionsProvider(options)];
-    }
-    return [
-      this.createAsyncOptionsProvider(options),
-      {
-        provide: options.useClass,
-        useClass: options.useClass,
-      },
-    ];
-  }
-
-  private static createAsyncOptionsProvider<
-    StoreConfig extends Record<any, any>,
-  >(options: CacheModuleAsyncOptions<StoreConfig>): Provider {
-    if (options.useFactory) {
-      return {
-        provide: CACHE_MODULE_OPTIONS,
-        useFactory: options.useFactory,
-        inject: options.inject || [],
-      };
-    }
-    return {
-      provide: CACHE_MODULE_OPTIONS,
-      useFactory: async (optionsFactory: CacheOptionsFactory<StoreConfig>) =>
-        optionsFactory.createCacheOptions(),
-      inject: [options.useExisting || options.useClass],
+      ...moduleDefinition,
+      providers: moduleDefinition.providers.concat(options.extraProviders),
     };
   }
 }
diff --git a/packages/common/cache/cache.providers.ts b/packages/common/cache/cache.providers.ts
index 2e6df398d..4aaacf0f5 100644
--- a/packages/common/cache/cache.providers.ts
+++ b/packages/common/cache/cache.providers.ts
@@ -1,6 +1,7 @@
 import { Provider } from '../interfaces';
 import { loadPackage } from '../utils/load-package.util';
-import { CACHE_MANAGER, CACHE_MODULE_OPTIONS } from './cache.constants';
+import { CACHE_MANAGER } from './cache.constants';
+import { MODULE_OPTIONS_TOKEN } from './cache.module-definition';
 import { defaultCacheOptions } from './default-options';
 import { CacheManagerOptions } from './interfaces/cache-manager.interface';
 
@@ -31,6 +32,6 @@ export function createCacheManager(): Provider {
             ...(options || {}),
           });
     },
-    inject: [CACHE_MODULE_OPTIONS],
+    inject: [MODULE_OPTIONS_TOKEN],
   };
 }
diff --git a/packages/common/cache/interfaces/cache-module.interface.ts b/packages/common/cache/interfaces/cache-module.interface.ts
index 5beb769c8..a5fd220cc 100644
--- a/packages/common/cache/interfaces/cache-module.interface.ts
+++ b/packages/common/cache/interfaces/cache-module.interface.ts
@@ -1,4 +1,5 @@
-import { ModuleMetadata, Provider, Type } from '../../interfaces';
+import { Provider, Type } from '../../interfaces';
+import { ConfigurableModuleAsyncOptions } from '../../module-utils';
 import { CacheManagerOptions } from './cache-manager.interface';
 
 export type CacheModuleOptions<
@@ -39,7 +40,10 @@ export interface CacheOptionsFactory<
  */
 export interface CacheModuleAsyncOptions<
   StoreConfig extends Record<any, any> = Record<string, any>,
-> extends Pick<ModuleMetadata, 'imports'> {
+> extends ConfigurableModuleAsyncOptions<
+    CacheModuleOptions<StoreConfig>,
+    keyof CacheOptionsFactory
+  > {
   /**
    * Injection token resolving to an existing provider. The provider must implement
    * the `CacheOptionsFactory` interface.
@@ -63,6 +67,9 @@ export interface CacheModuleAsyncOptions<
    * Dependencies that a Factory may inject.
    */
   inject?: any[];
+  /**
+   * Extra providers to be registered within a scope of this module.
+   */
   extraProviders?: Provider[];
   /**
    * If "true', register `CacheModule` as a global module.
diff --git a/packages/common/constants.ts b/packages/common/constants.ts
index d6ded9f97..bd18972d5 100644
--- a/packages/common/constants.ts
+++ b/packages/common/constants.ts
@@ -29,3 +29,6 @@ export const REDIRECT_METADATA = '__redirect__';
 export const RESPONSE_PASSTHROUGH_METADATA = '__responsePassthrough__';
 export const SSE_METADATA = '__sse__';
 export const VERSION_METADATA = '__version__';
+export const INJECTABLE_WATERMARK = '__injectable__';
+export const CONTROLLER_WATERMARK = '__controller__';
+export const CATCH_WATERMARK = '__catch__';
diff --git a/packages/common/decorators/core/catch.decorator.ts b/packages/common/decorators/core/catch.decorator.ts
index d211a6d82..cd3cdb161 100644
--- a/packages/common/decorators/core/catch.decorator.ts
+++ b/packages/common/decorators/core/catch.decorator.ts
@@ -1,5 +1,5 @@
-import { FILTER_CATCH_EXCEPTIONS } from '../../constants';
-import { Type } from '../../interfaces';
+import { CATCH_WATERMARK, FILTER_CATCH_EXCEPTIONS } from '../../constants';
+import { Type, Abstract } from '../../interfaces';
 
 /**
  * Decorator that marks a class as a Nest exception filter. An exception filter
@@ -18,8 +18,11 @@ import { Type } from '../../interfaces';
  *
  * @publicApi
  */
-export function Catch(...exceptions: Type<any>[]): ClassDecorator {
+export function Catch(
+  ...exceptions: Array<Type<any> | Abstract<any>>
+): ClassDecorator {
   return (target: object) => {
+    Reflect.defineMetadata(CATCH_WATERMARK, true, target);
     Reflect.defineMetadata(FILTER_CATCH_EXCEPTIONS, exceptions, target);
   };
 }
diff --git a/packages/common/decorators/core/controller.decorator.ts b/packages/common/decorators/core/controller.decorator.ts
index 9f17a9fb5..ec13f5f7c 100644
--- a/packages/common/decorators/core/controller.decorator.ts
+++ b/packages/common/decorators/core/controller.decorator.ts
@@ -1,4 +1,5 @@
 import {
+  CONTROLLER_WATERMARK,
   HOST_METADATA,
   PATH_METADATA,
   SCOPE_OPTIONS_METADATA,
@@ -162,11 +163,14 @@ export function Controller(
     : [
         prefixOrOptions.path || defaultPath,
         prefixOrOptions.host,
-        { scope: prefixOrOptions.scope },
-        prefixOrOptions.version,
+        { scope: prefixOrOptions.scope, durable: prefixOrOptions.durable },
+        Array.isArray(prefixOrOptions.version)
+          ? Array.from(new Set(prefixOrOptions.version))
+          : prefixOrOptions.version,
       ];
 
   return (target: object) => {
+    Reflect.defineMetadata(CONTROLLER_WATERMARK, true, target);
     Reflect.defineMetadata(PATH_METADATA, path, target);
     Reflect.defineMetadata(HOST_METADATA, host, target);
     Reflect.defineMetadata(SCOPE_OPTIONS_METADATA, scopeOptions, target);
diff --git a/packages/common/decorators/core/injectable.decorator.ts b/packages/common/decorators/core/injectable.decorator.ts
index 91910dfc5..453e7666f 100644
--- a/packages/common/decorators/core/injectable.decorator.ts
+++ b/packages/common/decorators/core/injectable.decorator.ts
@@ -1,5 +1,5 @@
 import { v4 as uuid } from 'uuid';
-import { SCOPE_OPTIONS_METADATA } from '../../constants';
+import { INJECTABLE_WATERMARK, SCOPE_OPTIONS_METADATA } from '../../constants';
 import { ScopeOptions } from '../../interfaces/scope-options.interface';
 import { Type } from '../../interfaces/type.interface';
 
@@ -42,6 +42,7 @@ export type InjectableOptions = ScopeOptions;
  */
 export function Injectable(options?: InjectableOptions): ClassDecorator {
   return (target: object) => {
+    Reflect.defineMetadata(INJECTABLE_WATERMARK, true, target);
     Reflect.defineMetadata(SCOPE_OPTIONS_METADATA, options, target);
   };
 }
diff --git a/packages/common/decorators/core/version.decorator.ts b/packages/common/decorators/core/version.decorator.ts
index d82d079e2..9ab8fc887 100644
--- a/packages/common/decorators/core/version.decorator.ts
+++ b/packages/common/decorators/core/version.decorator.ts
@@ -7,6 +7,11 @@ import { VersionValue } from '../../interfaces/version-options.interface';
  * @publicApi
  */
 export function Version(version: VersionValue): MethodDecorator {
+  if (Array.isArray(version)) {
+    // Drop duplicated versions
+    version = Array.from(new Set(version));
+  }
+
   return (
     target: any,
     key: string | symbol,
diff --git a/packages/common/decorators/http/render.decorator.ts b/packages/common/decorators/http/render.decorator.ts
index 6e9f22a1c..92d2f8d20 100644
--- a/packages/common/decorators/http/render.decorator.ts
+++ b/packages/common/decorators/http/render.decorator.ts
@@ -7,7 +7,7 @@ import { RENDER_METADATA } from '../../constants';
  *
  * @param template name of the render engine template file
  *
- * @see [Model-View-Controller](https://docs.nestjs.com/techniques.mvc)
+ * @see [Model-View-Controller](https://docs.nestjs.com/techniques/mvc)
  *
  * @publicApi
  */
diff --git a/packages/common/decorators/modules/module.decorator.ts b/packages/common/decorators/modules/module.decorator.ts
index c5df824d9..b0547b6d3 100644
--- a/packages/common/decorators/modules/module.decorator.ts
+++ b/packages/common/decorators/modules/module.decorator.ts
@@ -5,7 +5,7 @@ import { validateModuleKeys } from '../../utils/validate-module-keys.util';
  * Decorator that marks a class as a [module](https://docs.nestjs.com/modules).
  *
  * Modules are used by Nest to organize the application structure into scopes. Controllers
- * and Providers are scoped by the module they are declared in.  Modules and their
+ * and Providers are scoped by the module they are declared in. Modules and their
  * classes (Controllers and Providers) form a graph that determines how Nest
  * performs [Dependency Injection (DI)](https://docs.nestjs.com/providers#dependency-injection).
  *
diff --git a/packages/common/enums/version-type.enum.ts b/packages/common/enums/version-type.enum.ts
index 981986e87..abe4c6416 100644
--- a/packages/common/enums/version-type.enum.ts
+++ b/packages/common/enums/version-type.enum.ts
@@ -5,4 +5,5 @@ export enum VersioningType {
   URI,
   HEADER,
   MEDIA_TYPE,
+  CUSTOM,
 }
diff --git a/packages/common/exceptions/bad-gateway.exception.ts b/packages/common/exceptions/bad-gateway.exception.ts
index 78667996c..83ae75507 100644
--- a/packages/common/exceptions/bad-gateway.exception.ts
+++ b/packages/common/exceptions/bad-gateway.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Bad Gateway* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/bad-request.exception.ts b/packages/common/exceptions/bad-request.exception.ts
index b5385d09c..3d93e229b 100644
--- a/packages/common/exceptions/bad-request.exception.ts
+++ b/packages/common/exceptions/bad-request.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Bad Request* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/conflict.exception.ts b/packages/common/exceptions/conflict.exception.ts
index d67cc30f4..93322515e 100644
--- a/packages/common/exceptions/conflict.exception.ts
+++ b/packages/common/exceptions/conflict.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Conflict* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/forbidden.exception.ts b/packages/common/exceptions/forbidden.exception.ts
index 7c3ae92fb..2c10e7a2a 100644
--- a/packages/common/exceptions/forbidden.exception.ts
+++ b/packages/common/exceptions/forbidden.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Forbidden* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/gateway-timeout.exception.ts b/packages/common/exceptions/gateway-timeout.exception.ts
index 2648ddfec..e2d068518 100644
--- a/packages/common/exceptions/gateway-timeout.exception.ts
+++ b/packages/common/exceptions/gateway-timeout.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Gateway Timeout* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/gone.exception.ts b/packages/common/exceptions/gone.exception.ts
index 48b141dfe..f319fe558 100644
--- a/packages/common/exceptions/gone.exception.ts
+++ b/packages/common/exceptions/gone.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Gone* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/http-version-not-supported.exception.ts b/packages/common/exceptions/http-version-not-supported.exception.ts
index 41b340291..ded68714b 100644
--- a/packages/common/exceptions/http-version-not-supported.exception.ts
+++ b/packages/common/exceptions/http-version-not-supported.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Http Version Not Supported* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/http.exception.ts b/packages/common/exceptions/http.exception.ts
index e907834c8..540844298 100644
--- a/packages/common/exceptions/http.exception.ts
+++ b/packages/common/exceptions/http.exception.ts
@@ -4,7 +4,7 @@ import { isObject, isString } from '../utils/shared.utils';
  * Defines the base Nest HTTP exception, which is handled by the default
  * Exceptions Handler.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -41,6 +41,22 @@ export class HttpException extends Error {
     super();
     this.initMessage();
     this.initName();
+    this.initCause();
+  }
+
+  public cause: Error | undefined;
+
+  /**
+   * Configures error chaining support
+   *
+   * See:
+   * - https://nodejs.org/en/blog/release/v16.9.0/#error-cause
+   * - https://github.com/microsoft/TypeScript/issues/45167
+   */
+  public initCause() {
+    if (this.response instanceof Error) {
+      this.cause = this.response;
+    }
   }
 
   public initMessage() {
diff --git a/packages/common/exceptions/im-a-teapot.exception.ts b/packages/common/exceptions/im-a-teapot.exception.ts
index db640cd90..4b345681e 100644
--- a/packages/common/exceptions/im-a-teapot.exception.ts
+++ b/packages/common/exceptions/im-a-teapot.exception.ts
@@ -7,7 +7,7 @@ import { HttpException } from './http.exception';
  * Any attempt to brew coffee with a teapot should result in the error code
  * "418 I'm a teapot". The resulting entity body MAY be short and stout.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/internal-server-error.exception.ts b/packages/common/exceptions/internal-server-error.exception.ts
index 06a04d7d8..673a2e7a2 100644
--- a/packages/common/exceptions/internal-server-error.exception.ts
+++ b/packages/common/exceptions/internal-server-error.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Internal Server Error* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/method-not-allowed.exception.ts b/packages/common/exceptions/method-not-allowed.exception.ts
index df7666b00..f44ad305b 100644
--- a/packages/common/exceptions/method-not-allowed.exception.ts
+++ b/packages/common/exceptions/method-not-allowed.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Method Not Allowed* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/misdirected.exception.ts b/packages/common/exceptions/misdirected.exception.ts
index 11ae29bae..5fa2f082c 100644
--- a/packages/common/exceptions/misdirected.exception.ts
+++ b/packages/common/exceptions/misdirected.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Misdirected* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/not-acceptable.exception.ts b/packages/common/exceptions/not-acceptable.exception.ts
index e836d3447..18e71156c 100644
--- a/packages/common/exceptions/not-acceptable.exception.ts
+++ b/packages/common/exceptions/not-acceptable.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Not Acceptable* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/not-found.exception.ts b/packages/common/exceptions/not-found.exception.ts
index d8c38ca7f..a8ab1491a 100644
--- a/packages/common/exceptions/not-found.exception.ts
+++ b/packages/common/exceptions/not-found.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Not Found* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/not-implemented.exception.ts b/packages/common/exceptions/not-implemented.exception.ts
index 4702fe384..0576406fc 100644
--- a/packages/common/exceptions/not-implemented.exception.ts
+++ b/packages/common/exceptions/not-implemented.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Not Implemented* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/payload-too-large.exception.ts b/packages/common/exceptions/payload-too-large.exception.ts
index 968b94d3f..3f967f834 100644
--- a/packages/common/exceptions/payload-too-large.exception.ts
+++ b/packages/common/exceptions/payload-too-large.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Payload Too Large* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/precondition-failed.exception.ts b/packages/common/exceptions/precondition-failed.exception.ts
index ca9c3a70d..6e8456396 100644
--- a/packages/common/exceptions/precondition-failed.exception.ts
+++ b/packages/common/exceptions/precondition-failed.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Precondition Failed* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/request-timeout.exception.ts b/packages/common/exceptions/request-timeout.exception.ts
index 3bcd193ce..8521e290f 100644
--- a/packages/common/exceptions/request-timeout.exception.ts
+++ b/packages/common/exceptions/request-timeout.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Request Timeout* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/service-unavailable.exception.ts b/packages/common/exceptions/service-unavailable.exception.ts
index f0270b7e6..b7721322f 100644
--- a/packages/common/exceptions/service-unavailable.exception.ts
+++ b/packages/common/exceptions/service-unavailable.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Service Unavailable* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/unauthorized.exception.ts b/packages/common/exceptions/unauthorized.exception.ts
index 7d9379816..1791316c6 100644
--- a/packages/common/exceptions/unauthorized.exception.ts
+++ b/packages/common/exceptions/unauthorized.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Unauthorized* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/unprocessable-entity.exception.ts b/packages/common/exceptions/unprocessable-entity.exception.ts
index f76c8d24e..b1cf34b77 100644
--- a/packages/common/exceptions/unprocessable-entity.exception.ts
+++ b/packages/common/exceptions/unprocessable-entity.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Unprocessable Entity* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/unsupported-media-type.exception.ts b/packages/common/exceptions/unsupported-media-type.exception.ts
index 49e4ab14f..eaeab69a9 100644
--- a/packages/common/exceptions/unsupported-media-type.exception.ts
+++ b/packages/common/exceptions/unsupported-media-type.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Unsupported Media Type* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/file-stream/streamable-file.ts b/packages/common/file-stream/streamable-file.ts
index 305ee624b..7fe05c1d9 100644
--- a/packages/common/file-stream/streamable-file.ts
+++ b/packages/common/file-stream/streamable-file.ts
@@ -1,23 +1,23 @@
 import { Readable } from 'stream';
+import { types } from 'util';
+import { isFunction } from '../utils/shared.utils';
 import { StreamableFileOptions } from './streamable-options.interface';
 
 export class StreamableFile {
   private readonly stream: Readable;
 
-  constructor(buffer: Buffer, options?: StreamableFileOptions);
+  constructor(buffer: Uint8Array, options?: StreamableFileOptions);
   constructor(readable: Readable, options?: StreamableFileOptions);
   constructor(
-    bufferOrReadStream: Buffer | Readable,
+    bufferOrReadStream: Uint8Array | Readable,
     readonly options: StreamableFileOptions = {},
   ) {
-    if (Buffer.isBuffer(bufferOrReadStream)) {
+    if (types.isUint8Array(bufferOrReadStream)) {
       this.stream = new Readable();
       this.stream.push(bufferOrReadStream);
       this.stream.push(null);
-    } else if (
-      bufferOrReadStream.pipe &&
-      typeof bufferOrReadStream.pipe === 'function'
-    ) {
+      this.options.length ??= bufferOrReadStream.length;
+    } else if (bufferOrReadStream.pipe && isFunction(bufferOrReadStream.pipe)) {
       this.stream = bufferOrReadStream;
     }
   }
@@ -27,8 +27,15 @@ export class StreamableFile {
   }
 
   getHeaders() {
-    const { type = 'application/octet-stream', disposition = null } =
-      this.options;
-    return { type, disposition };
+    const {
+      type = 'application/octet-stream',
+      disposition = undefined,
+      length = undefined,
+    } = this.options;
+    return {
+      type,
+      disposition,
+      length,
+    };
   }
 }
diff --git a/packages/common/file-stream/streamable-options.interface.ts b/packages/common/file-stream/streamable-options.interface.ts
index 4b7bbee4e..5d167b6b0 100644
--- a/packages/common/file-stream/streamable-options.interface.ts
+++ b/packages/common/file-stream/streamable-options.interface.ts
@@ -1,4 +1,5 @@
 export interface StreamableFileOptions {
   type?: string;
   disposition?: string;
-}
\ No newline at end of file
+  length?: number;
+}
diff --git a/packages/common/http/http.constants.ts b/packages/common/http/http.constants.ts
deleted file mode 100644
index 21f6d8499..000000000
--- a/packages/common/http/http.constants.ts
+++ /dev/null
@@ -1,3 +0,0 @@
-export const AXIOS_INSTANCE_TOKEN = 'AXIOS_INSTANCE_TOKEN';
-export const HTTP_MODULE_ID = 'HTTP_MODULE_ID';
-export const HTTP_MODULE_OPTIONS = 'HTTP_MODULE_OPTIONS';
diff --git a/packages/common/http/http.module.ts b/packages/common/http/http.module.ts
deleted file mode 100644
index cc0367673..000000000
--- a/packages/common/http/http.module.ts
+++ /dev/null
@@ -1,99 +0,0 @@
-import Axios from 'axios';
-import { Module } from '../decorators/modules/module.decorator';
-import { DynamicModule, Provider } from '../interfaces';
-import { randomStringGenerator } from '../utils/random-string-generator.util';
-import {
-  AXIOS_INSTANCE_TOKEN,
-  HTTP_MODULE_ID,
-  HTTP_MODULE_OPTIONS,
-} from './http.constants';
-import { HttpService } from './http.service';
-import {
-  HttpModuleAsyncOptions,
-  HttpModuleOptions,
-  HttpModuleOptionsFactory,
-} from './interfaces';
-
-/**
- * @deprecated "HttpModule" (from the "@nestjs/common" package) is deprecated and will be removed in the next major release. Please, use the "@nestjs/axios" package instead.
- */
-@Module({
-  providers: [
-    HttpService,
-    {
-      provide: AXIOS_INSTANCE_TOKEN,
-      useValue: Axios,
-    },
-  ],
-  exports: [HttpService],
-})
-export class HttpModule {
-  static register(config: HttpModuleOptions): DynamicModule {
-    return {
-      module: HttpModule,
-      providers: [
-        {
-          provide: AXIOS_INSTANCE_TOKEN,
-          useValue: Axios.create(config),
-        },
-        {
-          provide: HTTP_MODULE_ID,
-          useValue: randomStringGenerator(),
-        },
-      ],
-    };
-  }
-
-  static registerAsync(options: HttpModuleAsyncOptions): DynamicModule {
-    return {
-      module: HttpModule,
-      imports: options.imports,
-      providers: [
-        ...this.createAsyncProviders(options),
-        {
-          provide: AXIOS_INSTANCE_TOKEN,
-          useFactory: (config: HttpModuleOptions) => Axios.create(config),
-          inject: [HTTP_MODULE_OPTIONS],
-        },
-        {
-          provide: HTTP_MODULE_ID,
-          useValue: randomStringGenerator(),
-        },
-        ...(options.extraProviders || []),
-      ],
-    };
-  }
-
-  private static createAsyncProviders(
-    options: HttpModuleAsyncOptions,
-  ): Provider[] {
-    if (options.useExisting || options.useFactory) {
-      return [this.createAsyncOptionsProvider(options)];
-    }
-    return [
-      this.createAsyncOptionsProvider(options),
-      {
-        provide: options.useClass,
-        useClass: options.useClass,
-      },
-    ];
-  }
-
-  private static createAsyncOptionsProvider(
-    options: HttpModuleAsyncOptions,
-  ): Provider {
-    if (options.useFactory) {
-      return {
-        provide: HTTP_MODULE_OPTIONS,
-        useFactory: options.useFactory,
-        inject: options.inject || [],
-      };
-    }
-    return {
-      provide: HTTP_MODULE_OPTIONS,
-      useFactory: async (optionsFactory: HttpModuleOptionsFactory) =>
-        optionsFactory.createHttpOptions(),
-      inject: [options.useExisting || options.useClass],
-    };
-  }
-}
diff --git a/packages/common/http/http.service.ts b/packages/common/http/http.service.ts
deleted file mode 100644
index 7c6e2ded2..000000000
--- a/packages/common/http/http.service.ts
+++ /dev/null
@@ -1,113 +0,0 @@
-import Axios, {
-  AxiosInstance,
-  AxiosPromise,
-  AxiosRequestConfig,
-  AxiosResponse,
-  CancelTokenSource,
-} from 'axios';
-import { Observable } from 'rxjs';
-import { Inject } from '../decorators';
-import { Logger } from '../services';
-import { AXIOS_INSTANCE_TOKEN } from './http.constants';
-
-/**
- * @deprecated "HttpModule" (from the "@nestjs/common" package) is deprecated and will be removed in the next major release. Please, use the "@nestjs/axios" package instead.
- */
-export class HttpService {
-  private readonly logger = new Logger(HttpService.name);
-
-  constructor(
-    @Inject(AXIOS_INSTANCE_TOKEN)
-    private readonly instance: AxiosInstance = Axios,
-  ) {
-    this.logger.warn(
-      'DEPRECATED! "HttpModule" (from the "@nestjs/common" package) is deprecated and will be removed in the next major release. Please, use the "@nestjs/axios" package instead.',
-    );
-  }
-
-  request<T = any>(config: AxiosRequestConfig): Observable<AxiosResponse<T>> {
-    return this.makeObservable<T>(this.instance.request, config);
-  }
-
-  get<T = any>(
-    url: string,
-    config?: AxiosRequestConfig,
-  ): Observable<AxiosResponse<T>> {
-    return this.makeObservable<T>(this.instance.get, url, config);
-  }
-
-  delete<T = any>(
-    url: string,
-    config?: AxiosRequestConfig,
-  ): Observable<AxiosResponse<T>> {
-    return this.makeObservable<T>(this.instance.delete, url, config);
-  }
-
-  head<T = any>(
-    url: string,
-    config?: AxiosRequestConfig,
-  ): Observable<AxiosResponse<T>> {
-    return this.makeObservable<T>(this.instance.head, url, config);
-  }
-
-  post<T = any>(
-    url: string,
-    data?: any,
-    config?: AxiosRequestConfig,
-  ): Observable<AxiosResponse<T>> {
-    return this.makeObservable<T>(this.instance.post, url, data, config);
-  }
-
-  put<T = any>(
-    url: string,
-    data?: any,
-    config?: AxiosRequestConfig,
-  ): Observable<AxiosResponse<T>> {
-    return this.makeObservable<T>(this.instance.put, url, data, config);
-  }
-
-  patch<T = any>(
-    url: string,
-    data?: any,
-    config?: AxiosRequestConfig,
-  ): Observable<AxiosResponse<T>> {
-    return this.makeObservable<T>(this.instance.patch, url, data, config);
-  }
-
-  get axiosRef(): AxiosInstance {
-    return this.instance;
-  }
-
-  private makeObservable<T>(
-    axios: (...args: any[]) => AxiosPromise<T>,
-    ...args: any[]
-  ) {
-    return new Observable<AxiosResponse<T>>(subscriber => {
-      const config: AxiosRequestConfig = { ...(args[args.length - 1] || {}) };
-
-      let cancelSource: CancelTokenSource;
-      if (!config.cancelToken) {
-        cancelSource = Axios.CancelToken.source();
-        config.cancelToken = cancelSource.token;
-      }
-
-      axios(...args)
-        .then(res => {
-          subscriber.next(res);
-          subscriber.complete();
-        })
-        .catch(err => {
-          subscriber.error(err);
-        });
-      return () => {
-        if (config.responseType === 'stream') {
-          return;
-        }
-
-        if (cancelSource) {
-          cancelSource.cancel();
-        }
-      };
-    });
-  }
-}
diff --git a/packages/common/http/index.ts b/packages/common/http/index.ts
deleted file mode 100644
index 2e7a1fead..000000000
--- a/packages/common/http/index.ts
+++ /dev/null
@@ -1,3 +0,0 @@
-export * from './http.module';
-export * from './http.service';
-export * from './interfaces';
diff --git a/packages/common/http/interfaces/http-module.interface.ts b/packages/common/http/interfaces/http-module.interface.ts
deleted file mode 100644
index 794f9385c..000000000
--- a/packages/common/http/interfaces/http-module.interface.ts
+++ /dev/null
@@ -1,19 +0,0 @@
-import { AxiosRequestConfig } from 'axios';
-import { ModuleMetadata, Provider, Type } from '../../interfaces';
-
-export type HttpModuleOptions = AxiosRequestConfig;
-
-export interface HttpModuleOptionsFactory {
-  createHttpOptions(): Promise<HttpModuleOptions> | HttpModuleOptions;
-}
-
-export interface HttpModuleAsyncOptions
-  extends Pick<ModuleMetadata, 'imports'> {
-  useExisting?: Type<HttpModuleOptionsFactory>;
-  useClass?: Type<HttpModuleOptionsFactory>;
-  useFactory?: (
-    ...args: any[]
-  ) => Promise<HttpModuleOptions> | HttpModuleOptions;
-  inject?: any[];
-  extraProviders?: Provider[];
-}
diff --git a/packages/common/http/interfaces/index.ts b/packages/common/http/interfaces/index.ts
deleted file mode 100644
index 692e7247e..000000000
--- a/packages/common/http/interfaces/index.ts
+++ /dev/null
@@ -1 +0,0 @@
-export * from './http-module.interface';
diff --git a/packages/common/index.ts b/packages/common/index.ts
index 6a6107762..c8d815187 100644
--- a/packages/common/index.ts
+++ b/packages/common/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @common
- * Copyright(c) 2017 - 2021 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2022 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
@@ -11,7 +11,6 @@ export * from './decorators';
 export * from './enums';
 export * from './exceptions';
 export * from './file-stream';
-export * from './http';
 export {
   Abstract,
   ArgumentMetadata,
@@ -31,6 +30,7 @@ export {
   INestApplication,
   INestApplicationContext,
   INestMicroservice,
+  InjectionToken,
   IntrospectionResult,
   MessageEvent,
   MiddlewareConsumer,
@@ -44,9 +44,11 @@ export {
   OnApplicationShutdown,
   OnModuleDestroy,
   OnModuleInit,
+  OptionalFactoryDependency,
   Paramtype,
   PipeTransform,
   Provider,
+  RawBodyRequest,
   RpcExceptionFilter,
   Scope,
   ScopeOptions,
@@ -59,6 +61,7 @@ export {
   WsExceptionFilter,
   WsMessageHandler,
 } from './interfaces';
+export * from './module-utils';
 export * from './pipes';
 export * from './serializer';
 export * from './services';
diff --git a/packages/common/interfaces/http/http-server.interface.ts b/packages/common/interfaces/http/http-server.interface.ts
index 9d91a97ff..d2e27de83 100644
--- a/packages/common/interfaces/http/http-server.interface.ts
+++ b/packages/common/interfaces/http/http-server.interface.ts
@@ -50,10 +50,8 @@ export interface HttpServer<TRequest = any, TResponse = any> {
   listen(port: number | string, hostname: string, callback?: () => void): any;
   reply(response: any, body: any, statusCode?: number): any;
   status(response: any, statusCode: number): any;
-  end(response: any, message?: string): any;
   render(response: any, view: string, options: any): any;
   redirect(response: any, statusCode: number, url: string): any;
-  isHeadersSent(response: any): boolean;
   setHeader(response: any, name: string, value: string): any;
   setErrorHandler?(handler: Function, prefix?: string): any;
   setNotFoundHandler?(handler: Function, prefix?: string): any;
@@ -69,20 +67,16 @@ export interface HttpServer<TRequest = any, TResponse = any> {
   getRequestMethod?(request: TRequest): string;
   getRequestUrl?(request: TRequest): string;
   getInstance(): any;
-  registerParserMiddleware(): any;
+  registerParserMiddleware(...args: any[]): any;
   enableCors(options: CorsOptions | CorsOptionsDelegate<TRequest>): any;
   getHttpServer(): any;
   initHttpServer(options: NestApplicationOptions): void;
   close(): any;
   getType(): string;
   init?(): Promise<void>;
-  applyVersionFilter?(
+  applyVersionFilter(
     handler: Function,
     version: VersionValue,
     versioningOptions: VersioningOptions,
-  ): <TRequest extends Record<string, any> = any, TResponse = any>(
-    req: TRequest,
-    res: TResponse,
-    next: () => void,
-  ) => any;
+  ): (req: TRequest, res: TResponse, next: () => void) => Function;
 }
diff --git a/packages/common/interfaces/http/index.ts b/packages/common/interfaces/http/index.ts
index f57d218dd..8c9eed173 100644
--- a/packages/common/interfaces/http/index.ts
+++ b/packages/common/interfaces/http/index.ts
@@ -1,2 +1,3 @@
 export * from './http-server.interface';
 export * from './message-event.interface';
+export * from './raw-body-request.interface';
diff --git a/packages/common/interfaces/http/raw-body-request.interface.ts b/packages/common/interfaces/http/raw-body-request.interface.ts
new file mode 100644
index 000000000..77b6248f9
--- /dev/null
+++ b/packages/common/interfaces/http/raw-body-request.interface.ts
@@ -0,0 +1 @@
+export type RawBodyRequest<T> = T & { rawBody?: Buffer };
diff --git a/packages/common/interfaces/middleware/nest-middleware.interface.ts b/packages/common/interfaces/middleware/nest-middleware.interface.ts
index d392d052d..bf3106995 100644
--- a/packages/common/interfaces/middleware/nest-middleware.interface.ts
+++ b/packages/common/interfaces/middleware/nest-middleware.interface.ts
@@ -1,3 +1,3 @@
 export interface NestMiddleware<TRequest = any, TResponse = any> {
-  use(req: TRequest, res: TResponse, next: () => void): any;
+  use(req: TRequest, res: TResponse, next: (error?: Error | any) => void): any;
 }
diff --git a/packages/common/interfaces/modules/index.ts b/packages/common/interfaces/modules/index.ts
index 612adb82b..458f952a3 100644
--- a/packages/common/interfaces/modules/index.ts
+++ b/packages/common/interfaces/modules/index.ts
@@ -1,6 +1,8 @@
 export * from './dynamic-module.interface';
 export * from './forward-reference.interface';
+export * from './injection-token.interface';
 export * from './introspection-result.interface';
 export * from './module-metadata.interface';
 export * from './nest-module.interface';
+export * from './optional-factory-dependency.interface';
 export * from './provider.interface';
diff --git a/packages/common/interfaces/modules/injection-token.interface.ts b/packages/common/interfaces/modules/injection-token.interface.ts
new file mode 100644
index 000000000..01aa7b1a9
--- /dev/null
+++ b/packages/common/interfaces/modules/injection-token.interface.ts
@@ -0,0 +1,9 @@
+import { Abstract } from '../abstract.interface';
+import { Type } from '../type.interface';
+
+export type InjectionToken =
+  | string
+  | symbol
+  | Type<any>
+  | Abstract<any>
+  | Function;
diff --git a/packages/common/interfaces/modules/optional-factory-dependency.interface.ts b/packages/common/interfaces/modules/optional-factory-dependency.interface.ts
new file mode 100644
index 000000000..be2ebb298
--- /dev/null
+++ b/packages/common/interfaces/modules/optional-factory-dependency.interface.ts
@@ -0,0 +1,6 @@
+import { InjectionToken } from './injection-token.interface';
+
+export type OptionalFactoryDependency = {
+  token: InjectionToken;
+  optional: boolean;
+};
diff --git a/packages/common/interfaces/modules/provider.interface.ts b/packages/common/interfaces/modules/provider.interface.ts
index c868b3c97..2fd7f85b6 100644
--- a/packages/common/interfaces/modules/provider.interface.ts
+++ b/packages/common/interfaces/modules/provider.interface.ts
@@ -1,6 +1,7 @@
-import { Abstract } from '../abstract.interface';
 import { Scope } from '../scope-options.interface';
 import { Type } from '../type.interface';
+import { InjectionToken } from './injection-token.interface';
+import { OptionalFactoryDependency } from './optional-factory-dependency.interface';
 
 /**
  *
@@ -27,7 +28,7 @@ export type Provider<T = any> =
  * };
  * ```
  *
- * @see [Use class](https://docs.nestjs.com/fundamentals/custom-providers#use-class)
+ * @see [Class providers](https://docs.nestjs.com/fundamentals/custom-providers#class-providers-useclass)
  * @see [Injection scopes](https://docs.nestjs.com/fundamentals/injection-scopes)
  *
  * @publicApi
@@ -36,7 +37,7 @@ export interface ClassProvider<T = any> {
   /**
    * Injection token
    */
-  provide: string | symbol | Type<any> | Abstract<any> | Function;
+  provide: InjectionToken;
   /**
    * Type (class name) of provider (instance to be injected).
    */
@@ -45,6 +46,19 @@ export interface ClassProvider<T = any> {
    * Optional enum defining lifetime of the provider that is injected.
    */
   scope?: Scope;
+  /**
+   * This option is only available on factory providers!
+   *
+   * @see [Use factory](https://docs.nestjs.com/fundamentals/custom-providers#factory-providers-usefactory)
+   */
+  inject?: never;
+  /**
+   * Flags provider as durable. This flag can be used in combination with custom context id
+   * factory strategy to construct lazy DI subtrees.
+   *
+   * This flag can be used only in conjunction with scope = Scope.REQUEST.
+   */
+  durable?: boolean;
 }
 
 /**
@@ -58,7 +72,7 @@ export interface ClassProvider<T = any> {
  * };
  * ```
  *
- * @see [Use value](https://docs.nestjs.com/fundamentals/custom-providers#use-value)
+ * @see [Value providers](https://docs.nestjs.com/fundamentals/custom-providers#value-providers-usevalue)
  *
  * @publicApi
  */
@@ -66,11 +80,17 @@ export interface ValueProvider<T = any> {
   /**
    * Injection token
    */
-  provide: string | symbol | Type<any> | Abstract<any> | Function;
+  provide: InjectionToken;
   /**
    * Instance of a provider to be injected.
    */
   useValue: T;
+  /**
+   * This option is only available on factory providers!
+   *
+   * @see [Use factory](https://docs.nestjs.com/fundamentals/custom-providers#factory-providers-usefactory)
+   */
+  inject?: never;
 }
 
 /**
@@ -88,7 +108,7 @@ export interface ValueProvider<T = any> {
  * };
  * ```
  *
- * @see [Use factory](https://docs.nestjs.com/fundamentals/custom-providers#use-factory)
+ * @see [Factory providers](https://docs.nestjs.com/fundamentals/custom-providers#factory-providers-usefactory)
  * @see [Injection scopes](https://docs.nestjs.com/fundamentals/injection-scopes)
  *
  * @publicApi
@@ -97,19 +117,26 @@ export interface FactoryProvider<T = any> {
   /**
    * Injection token
    */
-  provide: string | symbol | Type<any> | Abstract<any> | Function;
+  provide: InjectionToken;
   /**
    * Factory function that returns an instance of the provider to be injected.
    */
-  useFactory: (...args: any[]) => T;
+  useFactory: (...args: any[]) => T | Promise<T>;
   /**
    * Optional list of providers to be injected into the context of the Factory function.
    */
-  inject?: Array<Type<any> | string | symbol | Abstract<any> | Function>;
+  inject?: Array<InjectionToken | OptionalFactoryDependency>;
   /**
    * Optional enum defining lifetime of the provider that is returned by the Factory function.
    */
   scope?: Scope;
+  /**
+   * Flags provider as durable. This flag can be used in combination with custom context id
+   * factory strategy to construct lazy DI subtrees.
+   *
+   * This flag can be used only in conjunction with scope = Scope.REQUEST.
+   */
+  durable?: boolean;
 }
 
 /**
@@ -123,7 +150,7 @@ export interface FactoryProvider<T = any> {
  * };
  * ```
  *
- * @see [Use existing](https://docs.nestjs.com/fundamentals/custom-providers#use-existing)
+ * @see [Alias providers](https://docs.nestjs.com/fundamentals/custom-providers#alias-providers-useexisting)
  *
  * @publicApi
  */
@@ -131,7 +158,7 @@ export interface ExistingProvider<T = any> {
   /**
    * Injection token
    */
-  provide: string | symbol | Type<any> | Abstract<any> | Function;
+  provide: InjectionToken;
   /**
    * Provider to be aliased by the Injection token.
    */
diff --git a/packages/common/interfaces/nest-application-context.interface.ts b/packages/common/interfaces/nest-application-context.interface.ts
index 47ec30cad..11888397a 100644
--- a/packages/common/interfaces/nest-application-context.interface.ts
+++ b/packages/common/interfaces/nest-application-context.interface.ts
@@ -50,7 +50,8 @@ export interface INestApplicationContext {
   close(): Promise<void>;
 
   /**
-   * Sets custom logger service
+   * Sets custom logger service.
+   * Flushes buffered logs if auto flush is on.
    * @returns {void}
    */
   useLogger(logger: LoggerService | LogLevel[] | false): void;
diff --git a/packages/common/interfaces/nest-application-options.interface.ts b/packages/common/interfaces/nest-application-options.interface.ts
index a21bfed98..5c67cd9d2 100644
--- a/packages/common/interfaces/nest-application-options.interface.ts
+++ b/packages/common/interfaces/nest-application-options.interface.ts
@@ -21,4 +21,8 @@ export interface NestApplicationOptions extends NestApplicationContextOptions {
    * Set of configurable HTTPS options
    */
   httpsOptions?: HttpsOptions;
+  /**
+   * Whether to register the raw request body on the request. Use `req.rawBody`.
+   */
+  rawBody?: boolean;
 }
diff --git a/packages/common/interfaces/nest-application.interface.ts b/packages/common/interfaces/nest-application.interface.ts
index ec04c5180..82e302dc8 100644
--- a/packages/common/interfaces/nest-application.interface.ts
+++ b/packages/common/interfaces/nest-application.interface.ts
@@ -61,16 +61,6 @@ export interface INestApplication extends INestApplicationContext {
     callback?: () => void,
   ): Promise<any>;
 
-  /**
-   * Starts the application (can be awaited).
-   * @deprecated use "listen" instead.
-   *
-   * @param {number|string} port
-   * @param {string} [hostname]
-   * @returns {Promise}
-   */
-  listenAsync(port: number | string, hostname?: string): Promise<any>;
-
   /**
    * Returns the url the application is listening at, based on OS and IP version. Returns as an IP value either in IPv6 or IPv4
    *
@@ -138,14 +128,6 @@ export interface INestApplication extends INestApplicationContext {
    */
   startAllMicroservices(): Promise<this>;
 
-  /**
-   * Starts all connected microservices and can be awaited.
-   * @deprecated use "startAllMicroservices" instead.
-   *
-   * @returns {Promise}
-   */
-  startAllMicroservicesAsync(): Promise<this>;
-
   /**
    * Registers exception filters as global filters (will be used within
    * every HTTP route handler)
diff --git a/packages/common/interfaces/nest-microservice.interface.ts b/packages/common/interfaces/nest-microservice.interface.ts
index 857f1d66c..025c331bc 100644
--- a/packages/common/interfaces/nest-microservice.interface.ts
+++ b/packages/common/interfaces/nest-microservice.interface.ts
@@ -18,14 +18,6 @@ export interface INestMicroservice extends INestApplicationContext {
    */
   listen(): Promise<any>;
 
-  /**
-   * Starts the microservice (can be awaited).
-   * @deprecated use "listen" instead.
-   *
-   * @returns {Promise}
-   */
-  listenAsync(): Promise<any>;
-
   /**
    * Register Ws Adapter which will be used inside Gateways.
    * Use when you want to override default `socket.io` library.
diff --git a/packages/common/interfaces/scope-options.interface.ts b/packages/common/interfaces/scope-options.interface.ts
index f958c393b..4cca74275 100644
--- a/packages/common/interfaces/scope-options.interface.ts
+++ b/packages/common/interfaces/scope-options.interface.ts
@@ -28,4 +28,11 @@ export interface ScopeOptions {
    * Specifies the lifetime of an injected Provider or Controller.
    */
   scope?: Scope;
+  /**
+   * Flags provider as durable. This flag can be used in combination with custom context id
+   * factory strategy to construct lazy DI subtrees.
+   *
+   * This flag can be used only in conjunction with scope = Scope.REQUEST.
+   */
+  durable?: boolean;
 }
diff --git a/packages/common/interfaces/version-options.interface.ts b/packages/common/interfaces/version-options.interface.ts
index 3c214e64a..fcdd786b6 100644
--- a/packages/common/interfaces/version-options.interface.ts
+++ b/packages/common/interfaces/version-options.interface.ts
@@ -7,7 +7,10 @@ import { VersioningType } from '../enums/version-type.enum';
  */
 export const VERSION_NEUTRAL = Symbol('VERSION_NEUTRAL');
 
-export type VersionValue = string | string[] | typeof VERSION_NEUTRAL;
+export type VersionValue =
+  | string
+  | typeof VERSION_NEUTRAL
+  | Array<string | typeof VERSION_NEUTRAL>;
 
 /**
  * @publicApi
@@ -55,6 +58,20 @@ export interface MediaTypeVersioningOptions {
   key: string;
 }
 
+export interface CustomVersioningOptions {
+  type: VersioningType.CUSTOM;
+
+  /**
+   * A function that accepts a request object (specific to the underlying platform, ie Express or Fastify)
+   * and returns a single version value or an ordered array of versions, in order from HIGHEST to LOWEST.
+   *
+   * Ex. Returned version array = ['3.1', '3.0', '2.5', '2', '1.9']
+   *
+   * Use type assertion or narrowing to identify the specific request type.
+   */
+  extractor: (request: unknown) => string | string[];
+}
+
 interface VersioningCommonOptions {
   /**
    * The default version to be used as a fallback when you did not provide some
@@ -67,4 +84,9 @@ interface VersioningCommonOptions {
  * @publicApi
  */
 export type VersioningOptions = VersioningCommonOptions &
-  (HeaderVersioningOptions | UriVersioningOptions | MediaTypeVersioningOptions);
+  (
+    | HeaderVersioningOptions
+    | UriVersioningOptions
+    | MediaTypeVersioningOptions
+    | CustomVersioningOptions
+  );
diff --git a/packages/common/module-utils/configurable-module.builder.ts b/packages/common/module-utils/configurable-module.builder.ts
new file mode 100644
index 000000000..0e3f1318f
--- /dev/null
+++ b/packages/common/module-utils/configurable-module.builder.ts
@@ -0,0 +1,330 @@
+import { DynamicModule, Provider } from '../interfaces';
+import { Logger } from '../services/logger.service';
+import { randomStringGenerator } from '../utils/random-string-generator.util';
+import {
+  ASYNC_METHOD_SUFFIX,
+  CONFIGURABLE_MODULE_ID,
+  DEFAULT_FACTORY_CLASS_METHOD_KEY,
+  DEFAULT_METHOD_KEY,
+} from './constants';
+import {
+  ConfigurableModuleAsyncOptions,
+  ConfigurableModuleCls,
+  ConfigurableModuleOptionsFactory,
+} from './interfaces';
+import { ConfigurableModuleHost } from './interfaces/configurable-module-host.interface';
+import { generateOptionsInjectionToken } from './utils/generate-options-injection-token.util';
+
+/**
+ * @publicApi
+ */
+export interface ConfigurableModuleBuilderOptions {
+  /**
+   * Specified what injection token should be used for the module options provider.
+   * By default, an auto-generated UUID will be used.
+   */
+  optionsInjectionToken?: string | symbol;
+  /**
+   * By default, an UUID will be used as a module options provider token.
+   * Explicitly specifying the "moduleName" will instruct the "ConfigurableModuleBuilder"
+   * to use a more descriptive provider token.
+   *
+   * For example, if `moduleName: "Cache"` then auto-generated provider token will be "CACHE_MODULE_OPTIONS".
+   */
+  moduleName?: string;
+  /**
+   * Indicates whether module should always be "transient", meaning,
+   * every time you call the static method to construct a dynamic module,
+   * regardless of what arguments you pass in, a new "unique" module will be created.
+   *
+   * @default false
+   */
+  alwaysTransient?: boolean;
+}
+
+/**
+ * Factory that lets you create configurable modules and
+ * provides a way to reduce the majority of dynamic module boilerplate.
+ *
+ * @publicApi
+ */
+export class ConfigurableModuleBuilder<
+  ModuleOptions,
+  StaticMethodKey extends string = typeof DEFAULT_METHOD_KEY,
+  FactoryClassMethodKey extends string = typeof DEFAULT_FACTORY_CLASS_METHOD_KEY,
+  ExtraModuleDefinitionOptions = {},
+> {
+  protected staticMethodKey: StaticMethodKey;
+  protected factoryClassMethodKey: FactoryClassMethodKey;
+  protected extras: ExtraModuleDefinitionOptions;
+  protected transformModuleDefinition: (
+    definition: DynamicModule,
+    extraOptions: ExtraModuleDefinitionOptions,
+  ) => DynamicModule;
+
+  protected readonly logger = new Logger(ConfigurableModuleBuilder.name);
+
+  constructor(
+    protected readonly options: ConfigurableModuleBuilderOptions = {},
+    parentBuilder?: ConfigurableModuleBuilder<ModuleOptions>,
+  ) {
+    if (parentBuilder) {
+      this.staticMethodKey = parentBuilder.staticMethodKey as StaticMethodKey;
+      this.factoryClassMethodKey =
+        parentBuilder.factoryClassMethodKey as FactoryClassMethodKey;
+      this.transformModuleDefinition = parentBuilder.transformModuleDefinition;
+      this.extras = parentBuilder.extras as ExtraModuleDefinitionOptions;
+    }
+  }
+
+  /**
+   * Registers the "extras" object (a set of extra options that can be used to modify the dynamic module definition).
+   * Values you specify within the "extras" object will be used as default values (that can be overriden by module consumers).
+   *
+   * This method also applies the so-called "module definition transform function" that takes the auto-generated
+   * dynamic module object ("DynamicModule") and the actual consumer "extras" object as input parameters.
+   * The "extras" object consists of values explicitly specified by module consumers and default values.
+   *
+   * @example
+   * ```typescript
+   * .setExtras<{ isGlobal?: boolean }>({ isGlobal: false }, (definition, extras) =>
+   *    ({ ...definition, global: extras.isGlobal })
+   * )
+   * ```
+   */
+  setExtras<ExtraModuleDefinitionOptions>(
+    extras: ExtraModuleDefinitionOptions,
+    transformDefinition: (
+      definition: DynamicModule,
+      extras: ExtraModuleDefinitionOptions,
+    ) => DynamicModule,
+  ) {
+    const builder = new ConfigurableModuleBuilder<
+      ModuleOptions,
+      StaticMethodKey,
+      FactoryClassMethodKey,
+      ExtraModuleDefinitionOptions
+    >(this.options, this as any);
+    builder.extras = extras;
+    builder.transformModuleDefinition = transformDefinition;
+    return builder;
+  }
+
+  /**
+   * Dynamic modules must expose public static methods that let you pass in
+   * configuration parameters (control the module's behavior from the outside).
+   * Some frequently used names that you may have seen in other modules are:
+   * "forRoot", "forFeature", "register", "configure".
+   *
+   * This method "setClassMethodName" lets you specify the name of the
+   * method that will be auto-generated.
+   *
+   * @param key name of the method
+   */
+  setClassMethodName<StaticMethodKey extends string>(key: StaticMethodKey) {
+    const builder = new ConfigurableModuleBuilder<
+      ModuleOptions,
+      StaticMethodKey,
+      FactoryClassMethodKey,
+      ExtraModuleDefinitionOptions
+    >(this.options, this as any);
+    builder.staticMethodKey = key;
+    return builder;
+  }
+
+  /**
+   * Asynchronously configured modules (that rely on other modules, i.e. "ConfigModule")
+   * let you pass the configuration factory class that will be registered and instantiated as a provider.
+   * This provider then will be used to retrieve the module's configuration. To provide the configuration,
+   * the corresponding factory method must be implemented.
+   *
+   * This method ("setFactoryMethodName") lets you control what method name will have to be
+   * implemented by the config factory (default is "create").
+   *
+   * @param key name of the method
+   */
+  setFactoryMethodName<FactoryClassMethodKey extends string>(
+    key: FactoryClassMethodKey,
+  ) {
+    const builder = new ConfigurableModuleBuilder<
+      ModuleOptions,
+      StaticMethodKey,
+      FactoryClassMethodKey,
+      ExtraModuleDefinitionOptions
+    >(this.options, this as any);
+    builder.factoryClassMethodKey = key;
+    return builder;
+  }
+
+  /**
+   * Returns an object consisting of multiple properties that lets you
+   * easily construct dynamic configurable modules. See "ConfigurableModuleHost" interface for more details.
+   */
+  build(): ConfigurableModuleHost<
+    ModuleOptions,
+    StaticMethodKey,
+    FactoryClassMethodKey,
+    ExtraModuleDefinitionOptions
+  > {
+    this.staticMethodKey ??= DEFAULT_METHOD_KEY as StaticMethodKey;
+    this.factoryClassMethodKey ??=
+      DEFAULT_FACTORY_CLASS_METHOD_KEY as FactoryClassMethodKey;
+    this.options.optionsInjectionToken ??= this.options.moduleName
+      ? this.constructInjectionTokenString()
+      : generateOptionsInjectionToken();
+    this.transformModuleDefinition ??= definition => definition;
+
+    return {
+      ConfigurableModuleClass:
+        this.createConfigurableModuleCls<ModuleOptions>(),
+      MODULE_OPTIONS_TOKEN: this.options.optionsInjectionToken,
+      ASYNC_OPTIONS_TYPE: this.createTypeProxy('ASYNC_OPTIONS_TYPE'),
+      OPTIONS_TYPE: this.createTypeProxy('OPTIONS_TYPE'),
+    };
+  }
+
+  private constructInjectionTokenString(): string {
+    const moduleNameInSnakeCase = this.options.moduleName
+      .trim()
+      .split(/(?=[A-Z])/)
+      .join('_')
+      .toUpperCase();
+    return `${moduleNameInSnakeCase}_MODULE_OPTIONS`;
+  }
+
+  private createConfigurableModuleCls<ModuleOptions>(): ConfigurableModuleCls<
+    ModuleOptions,
+    StaticMethodKey,
+    FactoryClassMethodKey
+  > {
+    // eslint-disable-next-line @typescript-eslint/no-this-alias
+    const self = this;
+    const asyncMethodKey = this.staticMethodKey + ASYNC_METHOD_SUFFIX;
+
+    class InternalModuleClass {
+      static [self.staticMethodKey](
+        options: ModuleOptions & ExtraModuleDefinitionOptions,
+      ): DynamicModule {
+        const providers = [
+          {
+            provide: self.options.optionsInjectionToken,
+            useValue: this.omitExtras(options, self.extras),
+          },
+        ];
+        if (self.options.alwaysTransient) {
+          providers.push({
+            provide: CONFIGURABLE_MODULE_ID,
+            useValue: randomStringGenerator(),
+          });
+        }
+        return self.transformModuleDefinition(
+          {
+            module: this,
+            providers,
+          },
+          options,
+        );
+      }
+
+      static [asyncMethodKey](
+        options: ConfigurableModuleAsyncOptions<ModuleOptions> &
+          ExtraModuleDefinitionOptions,
+      ): DynamicModule {
+        const providers = this.createAsyncProviders(options);
+        if (self.options.alwaysTransient) {
+          providers.push({
+            provide: CONFIGURABLE_MODULE_ID,
+            useValue: randomStringGenerator(),
+          });
+        }
+        return self.transformModuleDefinition(
+          {
+            module: this,
+            imports: options.imports || [],
+            providers,
+          },
+          options,
+        );
+      }
+
+      private static omitExtras(
+        input: ModuleOptions & ExtraModuleDefinitionOptions,
+        extras: ExtraModuleDefinitionOptions | undefined,
+      ): ModuleOptions {
+        if (!extras) {
+          return input;
+        }
+        const moduleOptions = {};
+        const extrasKeys = Object.keys(extras);
+
+        Object.keys(input)
+          .filter(key => !extrasKeys.includes(key))
+          .forEach(key => {
+            moduleOptions[key] = input[key];
+          });
+        return moduleOptions as ModuleOptions;
+      }
+
+      private static createAsyncProviders(
+        options: ConfigurableModuleAsyncOptions<ModuleOptions>,
+      ): Provider[] {
+        if (options.useExisting || options.useFactory) {
+          return [this.createAsyncOptionsProvider(options)];
+        }
+        return [
+          this.createAsyncOptionsProvider(options),
+          {
+            provide: options.useClass,
+            useClass: options.useClass,
+          },
+        ];
+      }
+
+      private static createAsyncOptionsProvider(
+        options: ConfigurableModuleAsyncOptions<ModuleOptions>,
+      ): Provider {
+        if (options.useFactory) {
+          return {
+            provide: self.options.optionsInjectionToken,
+            useFactory: options.useFactory,
+            inject: options.inject || [],
+          };
+        }
+        return {
+          provide: self.options.optionsInjectionToken,
+          useFactory: async (
+            optionsFactory: ConfigurableModuleOptionsFactory<
+              ModuleOptions,
+              FactoryClassMethodKey
+            >,
+          ) =>
+            await optionsFactory[
+              self.factoryClassMethodKey as keyof typeof optionsFactory
+            ](),
+          inject: [options.useExisting || options.useClass],
+        };
+      }
+    }
+    return InternalModuleClass as unknown as ConfigurableModuleCls<
+      ModuleOptions,
+      StaticMethodKey,
+      FactoryClassMethodKey
+    >;
+  }
+
+  private createTypeProxy(
+    typeName: 'OPTIONS_TYPE' | 'ASYNC_OPTIONS_TYPE' | 'OptionsFactoryInterface',
+  ) {
+    const proxy = new Proxy(
+      {},
+      {
+        get: () => {
+          throw new Error(
+            `"${typeName}" is not supposed to be used as a value.`,
+          );
+        },
+      },
+    );
+    return proxy as any;
+  }
+}
diff --git a/packages/common/module-utils/constants.ts b/packages/common/module-utils/constants.ts
new file mode 100644
index 000000000..2d97c0c8c
--- /dev/null
+++ b/packages/common/module-utils/constants.ts
@@ -0,0 +1,5 @@
+export const DEFAULT_METHOD_KEY = 'register';
+export const DEFAULT_FACTORY_CLASS_METHOD_KEY = 'create';
+
+export const ASYNC_METHOD_SUFFIX = 'Async';
+export const CONFIGURABLE_MODULE_ID = 'CONFIGURABLE_MODULE_ID';
diff --git a/packages/common/module-utils/index.ts b/packages/common/module-utils/index.ts
new file mode 100644
index 000000000..4393992bd
--- /dev/null
+++ b/packages/common/module-utils/index.ts
@@ -0,0 +1,2 @@
+export * from './configurable-module.builder';
+export * from './interfaces';
diff --git a/packages/common/module-utils/interfaces/configurable-module-async-options.interface.ts b/packages/common/module-utils/interfaces/configurable-module-async-options.interface.ts
new file mode 100644
index 000000000..56f7040e4
--- /dev/null
+++ b/packages/common/module-utils/interfaces/configurable-module-async-options.interface.ts
@@ -0,0 +1,51 @@
+import { FactoryProvider, ModuleMetadata, Type } from '../../interfaces';
+import { DEFAULT_FACTORY_CLASS_METHOD_KEY } from '../constants';
+
+/**
+ * Interface that must be implemented by the module options factory class.
+ * Method key varies depending on the "FactoryClassMethodKey" type argument.
+ *
+ * @publicApi
+ */
+export type ConfigurableModuleOptionsFactory<
+  ModuleOptions,
+  FactoryClassMethodKey extends string,
+> = Record<
+  `${FactoryClassMethodKey}`,
+  () => Promise<ModuleOptions> | ModuleOptions
+>;
+
+/**
+ * Interface that represents the module async options object
+ * Factory method name varies depending on the "FactoryClassMethodKey" type argument.
+ *
+ * @publicApi
+ */
+export interface ConfigurableModuleAsyncOptions<
+  ModuleOptions,
+  FactoryClassMethodKey extends string = typeof DEFAULT_FACTORY_CLASS_METHOD_KEY,
+> extends Pick<ModuleMetadata, 'imports'> {
+  /**
+   * Injection token resolving to an existing provider. The provider must implement
+   * the corresponding interface.
+   */
+  useExisting?: Type<
+    ConfigurableModuleOptionsFactory<ModuleOptions, FactoryClassMethodKey>
+  >;
+  /**
+   * Injection token resolving to a class that will be instantiated as a provider.
+   * The class must implement the corresponding interface.
+   */
+  useClass?: Type<
+    ConfigurableModuleOptionsFactory<ModuleOptions, FactoryClassMethodKey>
+  >;
+  /**
+   * Function returning options (or a Promise resolving to options) to configure the
+   * cache module.
+   */
+  useFactory?: (...args: unknown[]) => Promise<ModuleOptions> | ModuleOptions;
+  /**
+   * Dependencies that a Factory may inject.
+   */
+  inject?: FactoryProvider['inject'];
+}
diff --git a/packages/common/module-utils/interfaces/configurable-module-cls.interface.ts b/packages/common/module-utils/interfaces/configurable-module-cls.interface.ts
new file mode 100644
index 000000000..e01c706be
--- /dev/null
+++ b/packages/common/module-utils/interfaces/configurable-module-cls.interface.ts
@@ -0,0 +1,35 @@
+import { DynamicModule } from '../../interfaces';
+import {
+  DEFAULT_FACTORY_CLASS_METHOD_KEY,
+  DEFAULT_METHOD_KEY,
+} from '../constants';
+import { ConfigurableModuleAsyncOptions } from './configurable-module-async-options.interface';
+
+/**
+ * Class that represents a blueprint/prototype for a configurable Nest module.
+ * This class provides static methods for constructing dynamic modules. Their names
+ * can be controlled through the "MethodKey" type argument.
+ *
+ * @publicApi
+ */
+export type ConfigurableModuleCls<
+  ModuleOptions,
+  MethodKey extends string = typeof DEFAULT_METHOD_KEY,
+  FactoryClassMethodKey extends string = typeof DEFAULT_FACTORY_CLASS_METHOD_KEY,
+  ExtraModuleDefinitionOptions = {},
+> = {
+  new (): any;
+} & Record<
+  `${MethodKey}`,
+  (options: ModuleOptions & ExtraModuleDefinitionOptions) => DynamicModule
+> &
+  Record<
+    `${MethodKey}Async`,
+    (
+      options: ConfigurableModuleAsyncOptions<
+        ModuleOptions,
+        FactoryClassMethodKey
+      > &
+        ExtraModuleDefinitionOptions,
+    ) => DynamicModule
+  >;
diff --git a/packages/common/module-utils/interfaces/configurable-module-host.interface.ts b/packages/common/module-utils/interfaces/configurable-module-host.interface.ts
new file mode 100644
index 000000000..6a652ecce
--- /dev/null
+++ b/packages/common/module-utils/interfaces/configurable-module-host.interface.ts
@@ -0,0 +1,77 @@
+import { ConfigurableModuleAsyncOptions } from './configurable-module-async-options.interface';
+import { ConfigurableModuleCls } from './configurable-module-cls.interface';
+
+/**
+ * Configurable module host. See properties for more details
+ *
+ * @publicApi
+ */
+export interface ConfigurableModuleHost<
+  ModuleOptions = Record<string, unknown>,
+  MethodKey extends string = string,
+  FactoryClassMethodKey extends string = string,
+  ExtraModuleDefinitionOptions = {},
+> {
+  /**
+   * Class that represents a blueprint/prototype for a configurable Nest module.
+   * This class provides static methods for constructing dynamic modules. Their names
+   * can be controlled through the "MethodKey" type argument.
+   *
+   * Your module class should inherit from this class to make the static methods available.
+   *
+   * @example
+   * ```typescript
+   * @Module({})
+   * class IntegrationModule extends ConfigurableModuleCls {
+   *  // ...
+   * }
+   * ```
+   */
+  ConfigurableModuleClass: ConfigurableModuleCls<
+    ModuleOptions,
+    MethodKey,
+    FactoryClassMethodKey,
+    ExtraModuleDefinitionOptions
+  >;
+  /**
+   * Module options provider token. Can be used to inject the "options object" to
+   * providers registered within the host module.
+   */
+  MODULE_OPTIONS_TOKEN: string | symbol;
+  /**
+   * Can be used to auto-infer the compound "async module options" type.
+   * Note: this property is not supposed to be used as a value.
+   *
+   * @example
+   * ```typescript
+   * @Module({})
+   * class IntegrationModule extends ConfigurableModuleCls {
+   *  static module = initializer(IntegrationModule);
+   *
+   * static registerAsync(options: typeof ASYNC_OPTIONS_TYPE): DynamicModule {
+   *  return super.registerAsync(options);
+   * }
+   * ```
+   */
+  ASYNC_OPTIONS_TYPE: ConfigurableModuleAsyncOptions<
+    ModuleOptions,
+    FactoryClassMethodKey
+  > &
+    ExtraModuleDefinitionOptions;
+  /**
+   * Can be used to auto-infer the compound "module options" type (options interface + extra module definition options).
+   * Note: this property is not supposed to be used as a value.
+   *
+   * @example
+   * ```typescript
+   * @Module({})
+   * class IntegrationModule extends ConfigurableModuleCls {
+   *  static module = initializer(IntegrationModule);
+   *
+   * static register(options: typeof OPTIONS_TYPE): DynamicModule {
+   *  return super.register(options);
+   * }
+   * ```
+   */
+  OPTIONS_TYPE: ModuleOptions & ExtraModuleDefinitionOptions;
+}
diff --git a/packages/common/module-utils/interfaces/index.ts b/packages/common/module-utils/interfaces/index.ts
new file mode 100644
index 000000000..35c523076
--- /dev/null
+++ b/packages/common/module-utils/interfaces/index.ts
@@ -0,0 +1,3 @@
+export * from './configurable-module-async-options.interface';
+export * from './configurable-module-cls.interface';
+export * from './configurable-module-host.interface';
diff --git a/packages/common/module-utils/utils/generate-options-injection-token.util.ts b/packages/common/module-utils/utils/generate-options-injection-token.util.ts
new file mode 100644
index 000000000..259a6afa3
--- /dev/null
+++ b/packages/common/module-utils/utils/generate-options-injection-token.util.ts
@@ -0,0 +1,6 @@
+import { randomStringGenerator } from '../../utils/random-string-generator.util';
+
+export function generateOptionsInjectionToken() {
+  const hash = randomStringGenerator();
+  return `CONFIGURABLE_MODULE_OPTIONS[${hash}]`;
+}
diff --git a/packages/common/package.json b/packages/common/package.json
index 3d75eef42..101a52e9a 100644
--- a/packages/common/package.json
+++ b/packages/common/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/common",
-  "version": "8.2.3",
+  "version": "8.4.7",
   "description": "Nest - modern, fast, powerful node.js web framework (@common)",
   "author": "Kamil Mysliwiec",
   "homepage": "https://nestjs.com",
@@ -17,9 +17,8 @@
   },
   "license": "MIT",
   "dependencies": {
-    "axios": "0.24.0",
     "iterare": "1.2.1",
-    "tslib": "2.3.1",
+    "tslib": "2.4.0",
     "uuid": "8.3.2"
   },
   "peerDependencies": {
diff --git a/packages/common/pipes/default-value.pipe.ts b/packages/common/pipes/default-value.pipe.ts
index ee99ecc2f..65716f497 100644
--- a/packages/common/pipes/default-value.pipe.ts
+++ b/packages/common/pipes/default-value.pipe.ts
@@ -3,7 +3,7 @@ import {
   ArgumentMetadata,
   PipeTransform,
 } from '../interfaces/features/pipe-transform.interface';
-import { isNil } from '../utils/shared.utils';
+import { isNil, isNumber } from '../utils/shared.utils';
 
 /**
  * Defines the built-in DefaultValue Pipe
@@ -16,12 +16,12 @@ import { isNil } from '../utils/shared.utils';
 export class DefaultValuePipe<T = any, R = any>
   implements PipeTransform<T, T | R>
 {
-  constructor(private readonly defaultValue: R) {}
+  constructor(protected readonly defaultValue: R) {}
 
   transform(value?: T, _metadata?: ArgumentMetadata): T | R {
     if (
       isNil(value) ||
-      (typeof value === 'number' && isNaN(value as unknown as number))
+      (isNumber(value) && isNaN(value as unknown as number))
     ) {
       return this.defaultValue;
     }
diff --git a/packages/common/pipes/file/file-type.validator.ts b/packages/common/pipes/file/file-type.validator.ts
new file mode 100644
index 000000000..334049149
--- /dev/null
+++ b/packages/common/pipes/file/file-type.validator.ts
@@ -0,0 +1,30 @@
+import { FileValidator } from './file-validator.interface';
+
+export type FileTypeValidatorOptions = {
+  fileType: string;
+};
+
+/**
+ * Defines the built-in FileType File Validator
+ *
+ * @see [File Validators](https://docs.nestjs.com/techniques/file-upload#validators)
+ *
+ * @publicApi
+ */
+export class FileTypeValidator extends FileValidator<FileTypeValidatorOptions> {
+  buildErrorMessage(): string {
+    return `Validation failed (expected type is ${this.validationOptions.fileType})`;
+  }
+
+  isValid(file: any): boolean {
+    if (!this.validationOptions) {
+      return true;
+    }
+
+    if (!file.mimetype) {
+      return false;
+    }
+
+    return (file.mimetype as string).endsWith(this.validationOptions.fileType);
+  }
+}
diff --git a/packages/common/pipes/file/file-validator.interface.ts b/packages/common/pipes/file/file-validator.interface.ts
new file mode 100644
index 000000000..ad453cdae
--- /dev/null
+++ b/packages/common/pipes/file/file-validator.interface.ts
@@ -0,0 +1,18 @@
+/**
+ * Interface describing FileValidators, which can be added to a {@link ParseFilePipe}.
+ */
+export abstract class FileValidator<TValidationOptions = Record<string, any>> {
+  constructor(protected readonly validationOptions: TValidationOptions) {}
+
+  /**
+   * Indicates if this file should be considered valid, according to the options passed in the constructor.
+   * @param file the file from the request object
+   */
+  abstract isValid(file?: any): boolean | Promise<boolean>;
+
+  /**
+   * Builds an error message in case the validation fails.
+   * @param file the file from the request object
+   */
+  abstract buildErrorMessage(file: any): string;
+}
diff --git a/packages/common/pipes/file/index.ts b/packages/common/pipes/file/index.ts
new file mode 100644
index 000000000..11d19e318
--- /dev/null
+++ b/packages/common/pipes/file/index.ts
@@ -0,0 +1,6 @@
+export * from './file-type.validator';
+export * from './file-validator.interface';
+export * from './max-file-size.validator';
+export * from './parse-file-options.interface';
+export * from './parse-file.pipe';
+export * from './parse-file-pipe.builder';
diff --git a/packages/common/pipes/file/max-file-size.validator.ts b/packages/common/pipes/file/max-file-size.validator.ts
new file mode 100644
index 000000000..847ee19f0
--- /dev/null
+++ b/packages/common/pipes/file/max-file-size.validator.ts
@@ -0,0 +1,26 @@
+import { FileValidator } from './file-validator.interface';
+
+export type MaxFileSizeValidatorOptions = {
+  maxSize: number;
+};
+
+/**
+ * Defines the built-in MaxSize File Validator
+ *
+ * @see [File Validators](https://docs.nestjs.com/techniques/file-upload#validators)
+ *
+ * @publicApi
+ */
+export class MaxFileSizeValidator extends FileValidator<MaxFileSizeValidatorOptions> {
+  buildErrorMessage(): string {
+    return `Validation failed (expected size is less than ${this.validationOptions.maxSize})`;
+  }
+
+  public isValid(file: any): boolean {
+    if (!this.validationOptions) {
+      return true;
+    }
+
+    return file.size < this.validationOptions.maxSize;
+  }
+}
diff --git a/packages/common/pipes/file/parse-file-options.interface.ts b/packages/common/pipes/file/parse-file-options.interface.ts
new file mode 100644
index 000000000..e74630999
--- /dev/null
+++ b/packages/common/pipes/file/parse-file-options.interface.ts
@@ -0,0 +1,8 @@
+import { ErrorHttpStatusCode } from '../../utils/http-error-by-code.util';
+import { FileValidator } from './file-validator.interface';
+
+export interface ParseFileOptions {
+  validators?: FileValidator[];
+  errorHttpStatusCode?: ErrorHttpStatusCode;
+  exceptionFactory?: (error: string) => any;
+}
diff --git a/packages/common/pipes/file/parse-file-pipe.builder.ts b/packages/common/pipes/file/parse-file-pipe.builder.ts
new file mode 100644
index 000000000..7835322d9
--- /dev/null
+++ b/packages/common/pipes/file/parse-file-pipe.builder.ts
@@ -0,0 +1,37 @@
+import {
+  FileTypeValidator,
+  FileTypeValidatorOptions,
+} from './file-type.validator';
+import { FileValidator } from './file-validator.interface';
+import {
+  MaxFileSizeValidator,
+  MaxFileSizeValidatorOptions,
+} from './max-file-size.validator';
+import { ParseFileOptions } from './parse-file-options.interface';
+import { ParseFilePipe } from './parse-file.pipe';
+
+export class ParseFilePipeBuilder {
+  private validators: FileValidator[] = [];
+
+  addMaxSizeValidator(options: MaxFileSizeValidatorOptions) {
+    this.validators.push(new MaxFileSizeValidator(options));
+    return this;
+  }
+
+  addFileTypeValidator(options: FileTypeValidatorOptions) {
+    this.validators.push(new FileTypeValidator(options));
+    return this;
+  }
+
+  build(
+    additionalOptions?: Omit<ParseFileOptions, 'validators'>,
+  ): ParseFilePipe {
+    const parseFilePipe = new ParseFilePipe({
+      ...additionalOptions,
+      validators: this.validators,
+    });
+
+    this.validators = [];
+    return parseFilePipe;
+  }
+}
diff --git a/packages/common/pipes/file/parse-file.pipe.ts b/packages/common/pipes/file/parse-file.pipe.ts
new file mode 100644
index 000000000..e952c38f5
--- /dev/null
+++ b/packages/common/pipes/file/parse-file.pipe.ts
@@ -0,0 +1,68 @@
+import { Injectable, Optional } from '../../decorators/core';
+import { HttpStatus } from '../../enums';
+import { HttpErrorByCode } from '../../utils/http-error-by-code.util';
+import { PipeTransform } from '../../interfaces/features/pipe-transform.interface';
+import { ParseFileOptions } from './parse-file-options.interface';
+import { FileValidator } from './file-validator.interface';
+import { throws } from 'assert';
+
+/**
+ * Defines the built-in ParseFile Pipe. This pipe can be used to validate incoming files
+ * with `@UploadedFile()` decorator. You can use either other specific built-in validators
+ * or provide one of your own, simply implementing it through {@link FileValidator}
+ * interface and adding it to ParseFilePipe's constructor.
+ *
+ * @see [Built-in Pipes](https://docs.nestjs.com/pipes#built-in-pipes)
+ *
+ * @publicApi
+ */
+@Injectable()
+export class ParseFilePipe implements PipeTransform<any> {
+  protected exceptionFactory: (error: string) => any;
+  private readonly validators: FileValidator[];
+
+  constructor(@Optional() options: ParseFileOptions = {}) {
+    const {
+      exceptionFactory,
+      errorHttpStatusCode = HttpStatus.BAD_REQUEST,
+      validators = [],
+    } = options;
+
+    this.exceptionFactory =
+      exceptionFactory ||
+      (error => new HttpErrorByCode[errorHttpStatusCode](error));
+
+    this.validators = validators;
+  }
+
+  async transform(value: any): Promise<any> {
+    if (this.validators.length) {
+      await this.validate(value);
+    }
+    return value;
+  }
+
+  protected async validate(file: any): Promise<any> {
+    for (const validator of this.validators) {
+      await this.validateOrThrow(file, validator);
+    }
+
+    return file;
+  }
+
+  private async validateOrThrow(file: any, validator: FileValidator) {
+    const isValid = await validator.isValid(file);
+
+    if (!isValid) {
+      const errorMessage = validator.buildErrorMessage(file);
+      throw this.exceptionFactory(errorMessage);
+    }
+  }
+
+  /**
+   * @returns list of validators used in this pipe.
+   */
+  getValidators() {
+    return this.validators;
+  }
+}
diff --git a/packages/common/pipes/index.ts b/packages/common/pipes/index.ts
index a69365493..ebbc55f27 100644
--- a/packages/common/pipes/index.ts
+++ b/packages/common/pipes/index.ts
@@ -6,3 +6,4 @@ export * from './parse-float.pipe';
 export * from './parse-enum.pipe';
 export * from './parse-uuid.pipe';
 export * from './validation.pipe';
+export * from './file';
diff --git a/packages/common/pipes/parse-array.pipe.ts b/packages/common/pipes/parse-array.pipe.ts
index 125676458..c9ed1c67d 100644
--- a/packages/common/pipes/parse-array.pipe.ts
+++ b/packages/common/pipes/parse-array.pipe.ts
@@ -7,7 +7,7 @@ import {
   PipeTransform,
 } from '../interfaces/features/pipe-transform.interface';
 import { HttpErrorByCode } from '../utils/http-error-by-code.util';
-import { isNil, isString } from '../utils/shared.utils';
+import { isNil, isUndefined, isString } from '../utils/shared.utils';
 import { ValidationPipe, ValidationPipeOptions } from './validation.pipe';
 
 const VALIDATION_ERROR_MESSAGE = 'Validation failed (parsable array expected)';
@@ -36,7 +36,7 @@ export class ParseArrayPipe implements PipeTransform {
   protected readonly validationPipe: ValidationPipe;
   protected exceptionFactory: (error: string) => any;
 
-  constructor(@Optional() private readonly options: ParseArrayOptions = {}) {
+  constructor(@Optional() protected readonly options: ParseArrayOptions = {}) {
     this.validationPipe = new ValidationPipe({
       transform: true,
       validateCustomDecorators: true,
@@ -141,21 +141,19 @@ export class ParseArrayPipe implements PipeTransform {
         originalValue !== null && originalValue !== '' ? +originalValue : NaN;
       if (isNaN(value)) {
         throw this.exceptionFactory(
-          `${
-            typeof index !== 'undefined' ? `[${index}] ` : ''
-          }item must be a number`,
+          `${isUndefined(index) ? '' : `[${index}] `}item must be a number`,
         );
       }
       return value;
     } else if (this.options.items === String) {
-      if (typeof originalValue !== 'string') {
+      if (!isString(originalValue)) {
         return `${originalValue}`;
       }
     } else if (this.options.items === Boolean) {
       if (typeof originalValue !== 'boolean') {
         throw this.exceptionFactory(
           `${
-            typeof index !== 'undefined' ? `[${index}] ` : ''
+            isUndefined(index) ? '' : `[${index}] `
           }item must be a boolean value`,
         );
       }
diff --git a/packages/common/pipes/parse-bool.pipe.ts b/packages/common/pipes/parse-bool.pipe.ts
index 5876144d9..a5b6bcb6d 100644
--- a/packages/common/pipes/parse-bool.pipe.ts
+++ b/packages/common/pipes/parse-bool.pipe.ts
@@ -48,14 +48,32 @@ export class ParseBoolPipe
     value: string | boolean,
     metadata: ArgumentMetadata,
   ): Promise<boolean> {
-    if (value === true || value === 'true') {
+    if (this.isTrue(value)) {
       return true;
     }
-    if (value === false || value === 'false') {
+    if (this.isFalse(value)) {
       return false;
     }
     throw this.exceptionFactory(
       'Validation failed (boolean string is expected)',
     );
   }
+
+  /**
+   * @param value currently processed route argument
+   * @returns `true` if `value` is said 'true', ie., if it is equal to the boolean
+   * `true` or the string `"true"`
+   */
+  protected isTrue(value: string | boolean): boolean {
+    return value === true || value === 'true';
+  }
+
+  /**
+   * @param value currently processed route argument
+   * @returns `true` if `value` is said 'false', ie., if it is equal to the boolean
+   * `false` or the string `"false"`
+   */
+  protected isFalse(value: string | boolean): boolean {
+    return value === false || value === 'false';
+  }
 }
diff --git a/packages/common/pipes/parse-enum.pipe.ts b/packages/common/pipes/parse-enum.pipe.ts
index 4f0fc8537..406f61727 100644
--- a/packages/common/pipes/parse-enum.pipe.ts
+++ b/packages/common/pipes/parse-enum.pipe.ts
@@ -59,6 +59,6 @@ export class ParseEnumPipe<T = any> implements PipeTransform<T> {
     const enumValues = Object.keys(this.enumType).map(
       item => this.enumType[item],
     );
-    return enumValues.indexOf(value) >= 0;
+    return enumValues.includes(value);
   }
 }
diff --git a/packages/common/pipes/parse-float.pipe.ts b/packages/common/pipes/parse-float.pipe.ts
index 086152a9b..1f0fdb021 100644
--- a/packages/common/pipes/parse-float.pipe.ts
+++ b/packages/common/pipes/parse-float.pipe.ts
@@ -39,15 +39,23 @@ export class ParseFloatPipe implements PipeTransform<string> {
    * @param metadata contains metadata about the currently processed route argument
    */
   async transform(value: string, metadata: ArgumentMetadata): Promise<number> {
-    const isNumeric =
-      ['string', 'number'].includes(typeof value) &&
-      !isNaN(parseFloat(value)) &&
-      isFinite(value as any);
-    if (!isNumeric) {
+    if (!this.isNumeric(value)) {
       throw this.exceptionFactory(
         'Validation failed (numeric string is expected)',
       );
     }
     return parseFloat(value);
   }
+
+  /**
+   * @param value currently processed route argument
+   * @returns `true` if `value` is a valid float number
+   */
+  protected isNumeric(value: string): boolean {
+    return (
+      ['string', 'number'].includes(typeof value) &&
+      !isNaN(parseFloat(value)) &&
+      isFinite(value as any)
+    );
+  }
 }
diff --git a/packages/common/pipes/parse-int.pipe.ts b/packages/common/pipes/parse-int.pipe.ts
index 2ba713f85..9d79a2b4c 100644
--- a/packages/common/pipes/parse-int.pipe.ts
+++ b/packages/common/pipes/parse-int.pipe.ts
@@ -44,15 +44,23 @@ export class ParseIntPipe implements PipeTransform<string> {
    * @param metadata contains metadata about the currently processed route argument
    */
   async transform(value: string, metadata: ArgumentMetadata): Promise<number> {
-    const isNumeric =
-      ['string', 'number'].includes(typeof value) &&
-      /^-?\d+$/.test(value) &&
-      isFinite(value as any);
-    if (!isNumeric) {
+    if (!this.isNumeric(value)) {
       throw this.exceptionFactory(
         'Validation failed (numeric string is expected)',
       );
     }
     return parseInt(value, 10);
   }
+
+  /**
+   * @param value currently processed route argument
+   * @returns `true` if `value` is a valid integer number
+   */
+  protected isNumeric(value: string): boolean {
+    return (
+      ['string', 'number'].includes(typeof value) &&
+      /^-?\d+$/.test(value) &&
+      isFinite(value as any)
+    );
+  }
 }
diff --git a/packages/common/pipes/parse-uuid.pipe.ts b/packages/common/pipes/parse-uuid.pipe.ts
index 2679e8f93..81fe2b4c1 100644
--- a/packages/common/pipes/parse-uuid.pipe.ts
+++ b/packages/common/pipes/parse-uuid.pipe.ts
@@ -9,7 +9,7 @@ import {
   ErrorHttpStatusCode,
   HttpErrorByCode,
 } from '../utils/http-error-by-code.util';
-import { isUUID } from '../utils/is-uuid';
+import { isString } from '../utils/shared.utils';
 
 export interface ParseUUIDPipeOptions {
   version?: '3' | '4' | '5';
@@ -19,6 +19,12 @@ export interface ParseUUIDPipeOptions {
 
 @Injectable()
 export class ParseUUIDPipe implements PipeTransform<string> {
+  protected static uuidRegExps = {
+    3: /^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,
+    4: /^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,
+    5: /^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,
+    all: /^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i,
+  };
   private readonly version: '3' | '4' | '5';
   protected exceptionFactory: (errors: string) => any;
 
@@ -35,14 +41,23 @@ export class ParseUUIDPipe implements PipeTransform<string> {
       exceptionFactory ||
       (error => new HttpErrorByCode[errorHttpStatusCode](error));
   }
+
   async transform(value: string, metadata: ArgumentMetadata): Promise<string> {
-    if (!isUUID(value, this.version)) {
+    if (!this.isUUID(value, this.version)) {
       throw this.exceptionFactory(
-        `Validation failed (uuid ${
-          this.version ? 'v' + this.version : ''
+        `Validation failed (uuid${
+          this.version ? ` v ${this.version}` : ''
         } is expected)`,
       );
     }
     return value;
   }
+
+  protected isUUID(str: unknown, version = 'all') {
+    if (!isString(str)) {
+      throw this.exceptionFactory('The value passed as UUID is not a string');
+    }
+    const pattern = ParseUUIDPipe.uuidRegExps[version];
+    return pattern?.test(str);
+  }
 }
diff --git a/packages/common/pipes/validation.pipe.ts b/packages/common/pipes/validation.pipe.ts
index 483498796..27ea9701d 100644
--- a/packages/common/pipes/validation.pipe.ts
+++ b/packages/common/pipes/validation.pipe.ts
@@ -1,4 +1,5 @@
 import { iterate } from 'iterare';
+import { types } from 'util';
 import { Optional } from '../decorators';
 import { Injectable } from '../decorators/core';
 import { HttpStatus } from '../enums/http-status.enum';
@@ -17,7 +18,7 @@ import {
   HttpErrorByCode,
 } from '../utils/http-error-by-code.util';
 import { loadPackage } from '../utils/load-package.util';
-import { isNil } from '../utils/shared.utils';
+import { isNil, isObject } from '../utils/shared.utils';
 
 export interface ValidationPipeOptions extends ValidatorOptions {
   transform?: boolean;
@@ -190,12 +191,24 @@ export class ValidationPipe implements PipeTransform<any> {
     return isNil(value) ? {} : value;
   }
 
-  protected stripProtoKeys(value: Record<string, any>) {
+  protected stripProtoKeys(value: any) {
+    if (
+      value == null ||
+      typeof value !== 'object' ||
+      types.isTypedArray(value)
+    ) {
+      return;
+    }
+    if (Array.isArray(value)) {
+      for (const v of value) {
+        this.stripProtoKeys(v);
+      }
+      return;
+    }
     delete value.__proto__;
-    const keys = Object.keys(value);
-    iterate(keys)
-      .filter(key => typeof value[key] === 'object' && value[key])
-      .forEach(key => this.stripProtoKeys(value[key]));
+    for (const key in value) {
+      this.stripProtoKeys(value[key]);
+    }
   }
 
   protected isPrimitive(value: unknown): boolean {
diff --git a/packages/common/services/console-logger.service.ts b/packages/common/services/console-logger.service.ts
index d5a4612ae..a1a9ffb6c 100644
--- a/packages/common/services/console-logger.service.ts
+++ b/packages/common/services/console-logger.service.ts
@@ -1,7 +1,7 @@
 import { Injectable } from '../decorators/core/injectable.decorator';
 import { Optional } from '../decorators/core/optional.decorator';
 import { clc, yellow } from '../utils/cli-colors.util';
-import { isPlainObject } from '../utils/shared.utils';
+import { isPlainObject, isString } from '../utils/shared.utils';
 import { LoggerService, LogLevel } from './logger.service';
 import { isLogLevelEnabled } from './utils';
 
@@ -183,27 +183,58 @@ export class ConsoleLogger implements LoggerService {
     logLevel: LogLevel = 'log',
     writeStreamType?: 'stdout' | 'stderr',
   ) {
-    const color = this.getColorByLogLevel(logLevel);
     messages.forEach(message => {
-      const output = isPlainObject(message)
-        ? `${color('Object:')}\n${JSON.stringify(
-            message,
-            (key, value) =>
-              typeof value === 'bigint' ? value.toString() : value,
-            2,
-          )}\n`
-        : color(message as string);
-
-      const pidMessage = color(`[Nest] ${process.pid}  - `);
+      const pidMessage = this.formatPid(process.pid);
       const contextMessage = context ? yellow(`[${context}] `) : '';
       const timestampDiff = this.updateAndGetTimestampDiff();
-      const formattedLogLevel = color(logLevel.toUpperCase().padStart(7, ' '));
-      const computedMessage = `${pidMessage}${this.getTimestamp()} ${formattedLogLevel} ${contextMessage}${output}${timestampDiff}\n`;
+      const formattedLogLevel = logLevel.toUpperCase().padStart(7, ' ');
+      const formatedMessage = this.formatMessage(
+        logLevel,
+        message,
+        pidMessage,
+        formattedLogLevel,
+        contextMessage,
+        timestampDiff,
+      );
 
-      process[writeStreamType ?? 'stdout'].write(computedMessage);
+      process[writeStreamType ?? 'stdout'].write(formatedMessage);
     });
   }
 
+  protected formatPid(pid: number) {
+    return `[Nest] ${pid}  - `;
+  }
+
+  protected formatMessage(
+    logLevel: LogLevel,
+    message: unknown,
+    pidMessage: string,
+    formattedLogLevel: string,
+    contextMessage: string,
+    timestampDiff: string,
+  ) {
+    const output = this.stringifyMessage(message, logLevel);
+    pidMessage = this.colorize(pidMessage, logLevel);
+    formattedLogLevel = this.colorize(formattedLogLevel, logLevel);
+    return `${pidMessage}${this.getTimestamp()} ${formattedLogLevel} ${contextMessage}${output}${timestampDiff}\n`;
+  }
+
+  protected stringifyMessage(message: unknown, logLevel: LogLevel) {
+    return isPlainObject(message)
+      ? `${this.colorize('Object:', logLevel)}\n${JSON.stringify(
+          message,
+          (key, value) =>
+            typeof value === 'bigint' ? value.toString() : value,
+          2,
+        )}\n`
+      : this.colorize(message as string, logLevel);
+  }
+
+  protected colorize(message: string, logLevel: LogLevel) {
+    const color = this.getColorByLogLevel(logLevel);
+    return color(message);
+  }
+
   protected printStackTrace(stack: string) {
     if (!stack) {
       return;
@@ -226,7 +257,7 @@ export class ConsoleLogger implements LoggerService {
       return { messages: args, context: this.context };
     }
     const lastElement = args[args.length - 1];
-    const isContext = typeof lastElement === 'string';
+    const isContext = isString(lastElement);
     if (!isContext) {
       return { messages: args, context: this.context };
     }
@@ -242,7 +273,7 @@ export class ConsoleLogger implements LoggerService {
       return { messages, context };
     }
     const lastElement = messages[messages.length - 1];
-    const isStack = typeof lastElement === 'string';
+    const isStack = isString(lastElement);
     if (!isStack) {
       return { messages, context };
     }
diff --git a/packages/common/test/decorators/catch.decorator.spec.ts b/packages/common/test/decorators/catch.decorator.spec.ts
index bdd9e5f69..5fff8ebf1 100644
--- a/packages/common/test/decorators/catch.decorator.spec.ts
+++ b/packages/common/test/decorators/catch.decorator.spec.ts
@@ -1,5 +1,5 @@
 import { expect } from 'chai';
-import { FILTER_CATCH_EXCEPTIONS } from '../../constants';
+import { CATCH_WATERMARK, FILTER_CATCH_EXCEPTIONS } from '../../constants';
 import { Catch } from '../../decorators/core/catch.decorator';
 
 describe('@Catch', () => {
@@ -8,6 +8,12 @@ describe('@Catch', () => {
   @Catch(...exceptions)
   class Test {}
 
+  it(`should enhance component with "${CATCH_WATERMARK}" metadata`, () => {
+    const catchWatermark = Reflect.getMetadata(CATCH_WATERMARK, Test);
+
+    expect(catchWatermark).to.be.true;
+  });
+
   it('should enhance class with expected exceptions array', () => {
     const metadata = Reflect.getMetadata(FILTER_CATCH_EXCEPTIONS, Test);
     expect(metadata).to.be.eql(exceptions);
diff --git a/packages/common/test/decorators/controller.decorator.spec.ts b/packages/common/test/decorators/controller.decorator.spec.ts
index a375f5028..100a4ecbb 100644
--- a/packages/common/test/decorators/controller.decorator.spec.ts
+++ b/packages/common/test/decorators/controller.decorator.spec.ts
@@ -1,5 +1,5 @@
 import { expect } from 'chai';
-import { VERSION_METADATA } from '../../constants';
+import { VERSION_METADATA, CONTROLLER_WATERMARK } from '../../constants';
 import { Controller } from '../../decorators/core/controller.decorator';
 
 describe('@Controller', () => {
@@ -7,13 +7,15 @@ describe('@Controller', () => {
   const reflectedHost = 'api.example.com';
   const reflectedHostArray = ['api1.example.com', 'api2.example.com'];
   const reflectedVersion = '1';
-
-  @Controller(reflectedPath)
-  class Test {}
+  const reflectedVersionWithDuplicates = ['1', '2', '2', '1', '2', '1'];
+  const reflectedVersionWithoutDuplicates = ['1', '2'];
 
   @Controller()
   class EmptyDecorator {}
 
+  @Controller(reflectedPath)
+  class Test {}
+
   @Controller({ path: reflectedPath, host: reflectedHost })
   class PathAndHostDecorator {}
 
@@ -33,6 +35,18 @@ describe('@Controller', () => {
   @Controller({ version: reflectedVersion })
   class VersionOnlyDecorator {}
 
+  @Controller({ version: reflectedVersionWithDuplicates })
+  class VersionOnlyArrayDecorator {}
+
+  it(`should enhance component with "${CONTROLLER_WATERMARK}" metadata`, () => {
+    const controllerWatermark = Reflect.getMetadata(
+      CONTROLLER_WATERMARK,
+      EmptyDecorator,
+    );
+
+    expect(controllerWatermark).to.be.true;
+  });
+
   it('should enhance controller with expected path metadata', () => {
     const path = Reflect.getMetadata('path', Test);
     expect(path).to.be.eql(reflectedPath);
@@ -64,6 +78,11 @@ describe('@Controller', () => {
       VersionOnlyDecorator,
     );
     expect(version2).to.be.eql(reflectedVersion);
+    const version3 = Reflect.getMetadata(
+      VERSION_METADATA,
+      VersionOnlyArrayDecorator,
+    );
+    expect(version3).to.be.eql(reflectedVersionWithoutDuplicates);
   });
 
   it('should set default path when no object passed as param', () => {
diff --git a/packages/common/test/decorators/injectable.decorator.spec.ts b/packages/common/test/decorators/injectable.decorator.spec.ts
index 61b4df86d..aba23e043 100644
--- a/packages/common/test/decorators/injectable.decorator.spec.ts
+++ b/packages/common/test/decorators/injectable.decorator.spec.ts
@@ -1,12 +1,24 @@
 import { expect } from 'chai';
+import { SCOPE_OPTIONS_METADATA, INJECTABLE_WATERMARK } from '../../constants';
 import { Injectable, mixin } from '../../index';
 
 describe('@Injectable', () => {
-  @Injectable()
+  const options = {};
+
+  @Injectable(options)
   class TestMiddleware {
-    constructor(param: number, test: string) {}
+    constructor(_param: number, _test: string) {}
   }
 
+  it(`should enhance component with "${INJECTABLE_WATERMARK}" metadata`, () => {
+    const injectableWatermark = Reflect.getMetadata(
+      INJECTABLE_WATERMARK,
+      TestMiddleware,
+    );
+
+    expect(injectableWatermark).to.be.eql(true);
+  });
+
   it('should enhance component with "design:paramtypes" metadata', () => {
     const constructorParams = Reflect.getMetadata(
       'design:paramtypes',
@@ -16,22 +28,33 @@ describe('@Injectable', () => {
     expect(constructorParams[0]).to.be.eql(Number);
     expect(constructorParams[1]).to.be.eql(String);
   });
+
+  it(`should enhance component with "${SCOPE_OPTIONS_METADATA}" metadata`, () => {
+    const constructorParams = Reflect.getMetadata(
+      SCOPE_OPTIONS_METADATA,
+      TestMiddleware,
+    );
+
+    expect(constructorParams).to.be.eql(options);
+  });
 });
 
 describe('mixin', () => {
   @Injectable()
   class Test {
-    constructor(param: number, test: string) {}
+    constructor(_param: number, _test: string) {}
   }
 
   it('should set name of metatype', () => {
     const type = mixin(Test);
+
     expect(type.name).to.not.eql('Test');
   });
 
   it('should not lost the design:parmatypes metadata', () => {
     const type = mixin(Test);
     const constructorParams = Reflect.getMetadata('design:paramtypes', type);
+
     expect(constructorParams[0]).to.be.eql(Number);
     expect(constructorParams[1]).to.be.eql(String);
   });
diff --git a/packages/common/test/decorators/version.decorator.spec.ts b/packages/common/test/decorators/version.decorator.spec.ts
index 950e3f971..d33ea668d 100644
--- a/packages/common/test/decorators/version.decorator.spec.ts
+++ b/packages/common/test/decorators/version.decorator.spec.ts
@@ -4,14 +4,27 @@ import { Version } from '../../decorators/core/version.decorator';
 
 describe('@Version', () => {
   const version = '1';
+  const versions = ['1', '2', '2', '1', '2', '1'];
+  const versionsWithoutDuplicates = ['1', '2'];
 
   class Test {
     @Version(version)
-    public static test() {}
+    public static oneVersion() {}
+
+    @Version(versions)
+    public static multipleVersions() {}
   }
 
   it('should enhance method with expected version string', () => {
-    const metadata = Reflect.getMetadata(VERSION_METADATA, Test.test);
+    const metadata = Reflect.getMetadata(VERSION_METADATA, Test.oneVersion);
     expect(metadata).to.be.eql(version);
   });
+
+  it('should enhance method with expected version array', () => {
+    const metadata = Reflect.getMetadata(
+      VERSION_METADATA,
+      Test.multipleVersions,
+    );
+    expect(metadata).to.be.eql(versionsWithoutDuplicates);
+  });
 });
diff --git a/packages/common/test/exceptions/http.exception.spec.ts b/packages/common/test/exceptions/http.exception.spec.ts
index c9fbab731..a880c1bfc 100644
--- a/packages/common/test/exceptions/http.exception.spec.ts
+++ b/packages/common/test/exceptions/http.exception.spec.ts
@@ -129,4 +129,15 @@ describe('HttpException', () => {
       });
     });
   });
+
+  describe('initCause', () => {
+    it('configures a cause when message is an instance of error', () => {
+      const message = new Error('Some Error');
+      const error = new HttpException(message, 400);
+      expect(`${error}`).to.be.eql(`HttpException: ${message.message}`);
+      const { cause } = error;
+
+      expect(cause).to.be.eql(message);
+    });
+  });
 });
diff --git a/packages/common/test/file-stream/streamable-file.spec.ts b/packages/common/test/file-stream/streamable-file.spec.ts
index 905e1d179..7bfd43301 100644
--- a/packages/common/test/file-stream/streamable-file.spec.ts
+++ b/packages/common/test/file-stream/streamable-file.spec.ts
@@ -17,12 +17,48 @@ describe('StreamableFile', () => {
       expect(streamableFile.getStream()).to.equal(stream);
     });
   });
+  describe('when options is empty', () => {
+    it('should return application/octet-stream for type and undefined for others', () => {
+      const stream = new Readable();
+      const streamableFile = new StreamableFile(stream);
+      expect(streamableFile.getHeaders()).to.deep.equal({
+        type: 'application/octet-stream',
+        disposition: undefined,
+        length: undefined,
+      });
+    });
+  });
+  describe('when options is defined', () => {
+    it('should pass provided headers', () => {
+      const stream = new Readable();
+      const streamableFile = new StreamableFile(stream, {
+        type: 'application/pdf',
+        disposition: 'inline',
+        length: 100,
+      });
+      expect(streamableFile.getHeaders()).to.deep.equal({
+        type: 'application/pdf',
+        disposition: 'inline',
+        length: 100,
+      });
+    });
+  });
   describe('otherwise', () => {
-    it('should create a readable straem and push the input buffer', () => {
-      const buffer = Buffer.from('test');
-      const streamableFile = new StreamableFile(buffer);
-      const stream = streamableFile.getStream();
-      expect(stream.read()).to.equal(buffer);
+    describe('when input is a Buffer instance', () => {
+      it('should create a readable stream and push the input buffer', () => {
+        const buffer = Buffer.from('test');
+        const streamableFile = new StreamableFile(buffer);
+        const stream = streamableFile.getStream();
+        expect(stream.read()).to.equal(buffer);
+      });
+    });
+    describe('when input is a Uint8Array', () => {
+      it('should create a readable stream and push the input buffer', () => {
+        const buffer = Uint8Array.from([0xab, 0xcd, 0xef, 0x00]);
+        const streamableFile = new StreamableFile(buffer);
+        const stream = streamableFile.getStream();
+        expect(stream.read()).to.deep.equal(Buffer.from(buffer));
+      });
     });
   });
 });
diff --git a/packages/common/test/http/http.service.spec.ts b/packages/common/test/http/http.service.spec.ts
deleted file mode 100644
index f8a6d9540..000000000
--- a/packages/common/test/http/http.service.spec.ts
+++ /dev/null
@@ -1,16 +0,0 @@
-import { AxiosRequestConfig } from 'axios';
-import { expect } from 'chai';
-import { lastValueFrom } from 'rxjs';
-import { HttpService } from '../../http/http.service';
-
-describe('HttpService', () => {
-  it('should not mutate user-given axios options object', done => {
-    const http = new HttpService({ get: () => Promise.resolve() } as any);
-    const options: AxiosRequestConfig = {};
-
-    lastValueFrom(http.get('/', options)).then(() => {
-      expect(options.cancelToken).to.be.undefined;
-      done();
-    });
-  });
-});
diff --git a/packages/common/test/module-utils/configurable-module.builder.spec.ts b/packages/common/test/module-utils/configurable-module.builder.spec.ts
new file mode 100644
index 000000000..3d3623271
--- /dev/null
+++ b/packages/common/test/module-utils/configurable-module.builder.spec.ts
@@ -0,0 +1,112 @@
+import { expect } from 'chai';
+import { Provider } from '../../interfaces';
+import { ConfigurableModuleBuilder } from '../../module-utils';
+
+describe('ConfigurableModuleBuilder', () => {
+  describe('setExtras', () => {
+    it('should apply module definition transformer function and return typed builder', () => {
+      const { ConfigurableModuleClass } = new ConfigurableModuleBuilder()
+        .setExtras(
+          { isGlobal: false },
+          (definition, extras: { isGlobal: boolean }) => ({
+            ...definition,
+            global: extras.isGlobal,
+          }),
+        )
+        .build();
+
+      expect(
+        ConfigurableModuleClass.register({
+          // No type error
+          isGlobal: true,
+        }),
+      ).to.deep.include({
+        global: true,
+      });
+    });
+  });
+  describe('setClassMethodName', () => {
+    it('should set static class method name and return typed builder', () => {
+      const { ConfigurableModuleClass } = new ConfigurableModuleBuilder()
+        .setClassMethodName('forRoot')
+        .build();
+
+      expect(ConfigurableModuleClass.forRoot).to.not.be.undefined;
+      expect(ConfigurableModuleClass.forRootAsync).to.not.be.undefined;
+      expect((ConfigurableModuleClass as any).register).to.be.undefined;
+    });
+  });
+  describe('setFactoryMethodName', () => {
+    it('should set configuration factory class method name and return typed builder', () => {
+      const { ConfigurableModuleClass } = new ConfigurableModuleBuilder()
+        .setFactoryMethodName('createOptions')
+        .build();
+
+      expect(
+        ConfigurableModuleClass.registerAsync({
+          useClass: class {
+            // No type error
+            createOptions() {}
+          },
+        }),
+      ).to.not.be.undefined;
+    });
+  });
+  describe('build', () => {
+    it('should return a fully typed "ConfigurableModuleClass"', () => {
+      type ExtraConfig = { isGlobal?: boolean; extraProviders: Provider[] };
+
+      const {
+        ConfigurableModuleClass,
+        OPTIONS_TYPE,
+        ASYNC_OPTIONS_TYPE,
+        MODULE_OPTIONS_TOKEN,
+      } = new ConfigurableModuleBuilder({
+        moduleName: 'RandomTest',
+        alwaysTransient: true,
+      })
+        .setFactoryMethodName('createOptions')
+        .setClassMethodName('forFeature')
+        .setExtras<ExtraConfig>(
+          { isGlobal: false, extraProviders: [] },
+          (definition, extras) => ({
+            ...definition,
+            global: extras.isGlobal,
+            providers: definition.providers?.concat(extras.extraProviders),
+          }),
+        )
+        .build();
+
+      const definition = ConfigurableModuleClass.forFeatureAsync({
+        useFactory: () => {},
+        isGlobal: true,
+        extraProviders: ['test' as any],
+      });
+
+      expect(definition.global).to.equal(true);
+      expect(definition.providers).to.have.length(3);
+      expect(definition.providers).to.deep.contain('test');
+      expect(MODULE_OPTIONS_TOKEN).to.equal('RANDOM_TEST_MODULE_OPTIONS');
+      expect((definition.providers[0] as any).provide).to.equal(
+        'RANDOM_TEST_MODULE_OPTIONS',
+      );
+
+      try {
+        expect(ASYNC_OPTIONS_TYPE.imports).to.equal(undefined);
+      } catch (err) {
+        expect(err).to.be.instanceOf(Error);
+        expect(err.message).to.equal(
+          '"ASYNC_OPTIONS_TYPE" is not supposed to be used as a value.',
+        );
+      }
+      try {
+        expect(OPTIONS_TYPE.isGlobal).to.equal(undefined);
+      } catch (err) {
+        expect(err).to.be.instanceOf(Error);
+        expect(err.message).to.equal(
+          '"OPTIONS_TYPE" is not supposed to be used as a value.',
+        );
+      }
+    });
+  });
+});
diff --git a/packages/common/test/pipes/file/file-type.validator.spec.ts b/packages/common/test/pipes/file/file-type.validator.spec.ts
new file mode 100644
index 000000000..c4248f66a
--- /dev/null
+++ b/packages/common/test/pipes/file/file-type.validator.spec.ts
@@ -0,0 +1,65 @@
+import { FileTypeValidator } from '../../../pipes';
+import { expect } from 'chai';
+
+describe('FileTypeValidator', () => {
+  describe('isValid', () => {
+    it('should return true when the file mimetype is the same as the specified', () => {
+      const fileTypeValidator = new FileTypeValidator({
+        fileType: 'image/jpeg',
+      });
+
+      const requestFile = {
+        mimetype: 'image/jpeg',
+      };
+
+      expect(fileTypeValidator.isValid(requestFile)).to.equal(true);
+    });
+
+    it('should return true when the file mimetype ends with the specified option type', () => {
+      const fileTypeValidator = new FileTypeValidator({
+        fileType: 'jpeg',
+      });
+
+      const requestFile = {
+        mimetype: 'image/jpeg',
+      };
+
+      expect(fileTypeValidator.isValid(requestFile)).to.equal(true);
+    });
+
+    it('should return false when the file mimetype is different from the specified', () => {
+      const fileTypeValidator = new FileTypeValidator({
+        fileType: 'image/jpeg',
+      });
+
+      const requestFile = {
+        mimetype: 'image/png',
+      };
+
+      expect(fileTypeValidator.isValid(requestFile)).to.equal(false);
+    });
+
+    it('should return false when the file mimetype was not provided', () => {
+      const fileTypeValidator = new FileTypeValidator({
+        fileType: 'image/jpeg',
+      });
+
+      const requestFile = {};
+
+      expect(fileTypeValidator.isValid(requestFile)).to.equal(false);
+    });
+  });
+
+  describe('buildErrorMessage', () => {
+    it('should return a string with the format "Validation failed (expected type is #fileType)"', () => {
+      const fileType = 'image/jpeg';
+      const fileTypeValidator = new FileTypeValidator({
+        fileType,
+      });
+
+      expect(fileTypeValidator.buildErrorMessage()).to.equal(
+        `Validation failed (expected type is ${fileType})`,
+      );
+    });
+  });
+});
diff --git a/packages/common/test/pipes/file/max-file-size.validator.spec.ts b/packages/common/test/pipes/file/max-file-size.validator.spec.ts
new file mode 100644
index 000000000..9ba8e4283
--- /dev/null
+++ b/packages/common/test/pipes/file/max-file-size.validator.spec.ts
@@ -0,0 +1,56 @@
+import { expect } from 'chai';
+import { MaxFileSizeValidator } from '../../../pipes';
+
+describe('MaxFileSizeValidator', () => {
+  const oneKb = 1024;
+
+  describe('isValid', () => {
+    it('should return true when the file size is less than the maximum size', () => {
+      const maxFileSizeValidator = new MaxFileSizeValidator({
+        maxSize: oneKb,
+      });
+
+      const requestFile = {
+        size: 100,
+      };
+
+      expect(maxFileSizeValidator.isValid(requestFile)).to.equal(true);
+    });
+
+    it('should return false when the file size is greater than the maximum size', () => {
+      const maxFileSizeValidator = new MaxFileSizeValidator({
+        maxSize: oneKb,
+      });
+
+      const requestFile = {
+        size: oneKb + 1,
+      };
+
+      expect(maxFileSizeValidator.isValid(requestFile)).to.equal(false);
+    });
+
+    it('should return false when the file size is equal to the maximum size', () => {
+      const maxFileSizeValidator = new MaxFileSizeValidator({
+        maxSize: oneKb,
+      });
+
+      const requestFile = {
+        size: oneKb,
+      };
+
+      expect(maxFileSizeValidator.isValid(requestFile)).to.equal(false);
+    });
+  });
+
+  describe('buildErrorMessage', () => {
+    it('should return a string with the format "Validation failed (expected size is less than #maxSize")', () => {
+      const maxFileSizeValidator = new MaxFileSizeValidator({
+        maxSize: oneKb,
+      });
+
+      expect(maxFileSizeValidator.buildErrorMessage()).to.equal(
+        `Validation failed (expected size is less than ${oneKb})`,
+      );
+    });
+  });
+});
diff --git a/packages/common/test/pipes/file/parse-file-pipe.builder.spec.ts b/packages/common/test/pipes/file/parse-file-pipe.builder.spec.ts
new file mode 100644
index 000000000..8c31904aa
--- /dev/null
+++ b/packages/common/test/pipes/file/parse-file-pipe.builder.spec.ts
@@ -0,0 +1,77 @@
+import { expect } from 'chai';
+import {
+  FileTypeValidator,
+  MaxFileSizeValidator,
+  ParseFilePipeBuilder,
+} from '../../../pipes';
+
+describe('ParseFilePipeBuilder', () => {
+  let parseFilePipeBuilder: ParseFilePipeBuilder;
+
+  beforeEach(() => {
+    parseFilePipeBuilder = new ParseFilePipeBuilder();
+  });
+
+  describe('build', () => {
+    describe('when no validator was passed', () => {
+      it('should return a ParseFilePipe with no validators', () => {
+        const parseFilePipe = parseFilePipeBuilder.build();
+        expect(parseFilePipe.getValidators()).to.be.empty;
+      });
+    });
+
+    describe('when addMaxSizeValidator was chained', () => {
+      it('should return a ParseFilePipe with MaxSizeValidator and given options', () => {
+        const options = {
+          maxSize: 1000,
+        };
+        const parseFilePipe = parseFilePipeBuilder
+          .addMaxSizeValidator(options)
+          .build();
+
+        expect(parseFilePipe.getValidators()).to.deep.include(
+          new MaxFileSizeValidator(options),
+        );
+      });
+    });
+
+    describe('when addFileTypeValidator was chained', () => {
+      it('should return a ParseFilePipe with FileTypeValidator and given options', () => {
+        const options = {
+          fileType: 'image/jpeg',
+        };
+        const parseFilePipe = parseFilePipeBuilder
+          .addFileTypeValidator(options)
+          .build();
+
+        expect(parseFilePipe.getValidators()).to.deep.include(
+          new FileTypeValidator(options),
+        );
+      });
+    });
+
+    describe('when it is called twice with different validators', () => {
+      it('should not reuse validators', () => {
+        const maxSizeValidatorOptions = {
+          maxSize: 1000,
+        };
+
+        const pipeWithMaxSizeValidator = parseFilePipeBuilder
+          .addMaxSizeValidator(maxSizeValidatorOptions)
+          .build();
+
+        const fileTypeValidatorOptions = {
+          fileType: 'image/jpeg',
+        };
+
+        const pipeWithFileTypeValidator = parseFilePipeBuilder
+          .addFileTypeValidator(fileTypeValidatorOptions)
+          .build();
+
+        expect(pipeWithFileTypeValidator.getValidators()).not.to.deep.equal(
+          pipeWithMaxSizeValidator.getValidators(),
+        );
+      });
+    });
+  });
+});
diff --git a/packages/common/test/pipes/file/parse-file.pipe.spec.ts b/packages/common/test/pipes/file/parse-file.pipe.spec.ts
new file mode 100644
index 000000000..ee06ef44b
--- /dev/null
+++ b/packages/common/test/pipes/file/parse-file.pipe.spec.ts
@@ -0,0 +1,120 @@
+import { HttpStatus } from '../../../enums';
+import { BadRequestException, ConflictException } from '../../../exceptions';
+import { FileValidator, ParseFilePipe } from '../../../pipes';
+import { expect } from 'chai';
+
+class AlwaysValidValidator extends FileValidator {
+  isValid(): boolean {
+    return true;
+  }
+  buildErrorMessage(): string {
+    return '';
+  }
+}
+
+const customErrorMessage = 'Error!';
+
+class AlwaysInvalidValidator extends FileValidator {
+  isValid(): boolean {
+    return false;
+  }
+  buildErrorMessage(): string {
+    return customErrorMessage;
+  }
+}
+
+describe('ParseFilePipe', () => {
+  let parseFilePipe: ParseFilePipe;
+  describe('transform', () => {
+    describe('when there are no validators (explicit)', () => {
+      beforeEach(() => {
+        parseFilePipe = new ParseFilePipe({
+          validators: [],
+        });
+      });
+
+      it('should return the file object', async () => {
+        const requestFile = {
+          path: 'some-path',
+        };
+
+        await expect(parseFilePipe.transform(requestFile)).to.eventually.eql(
+          requestFile,
+        );
+      });
+    });
+
+    describe('when there are no validators (by default constructor)', () => {
+      beforeEach(() => {
+        parseFilePipe = new ParseFilePipe();
+      });
+
+      it('should return the file object', async () => {
+        const requestFile = {
+          path: 'some-path',
+        };
+
+        await expect(parseFilePipe.transform(requestFile)).to.eventually.eql(
+          requestFile,
+        );
+      });
+    });
+
+    describe('when all the validators validate the file', () => {
+      beforeEach(() => {
+        parseFilePipe = new ParseFilePipe({
+          validators: [new AlwaysValidValidator({})],
+        });
+      });
+
+      it('should return the file object', async () => {
+        const requestFile = {
+          path: 'some-path',
+        };
+
+        await expect(parseFilePipe.transform(requestFile)).to.eventually.eql(
+          requestFile,
+        );
+      });
+    });
+
+    describe('when some validator invalidates the file', () => {
+      describe('and the pipe has the default error', () => {
+        beforeEach(() => {
+          parseFilePipe = new ParseFilePipe({
+            validators: [new AlwaysInvalidValidator({})],
+          });
+        });
+
+        it('should throw a BadRequestException', async () => {
+          const requestFile = {
+            path: 'some-path',
+          };
+
+          await expect(parseFilePipe.transform(requestFile)).to.be.rejectedWith(
+            BadRequestException,
+          );
+        });
+      });
+
+      describe('and the pipe has a custom error code', () => {
+        beforeEach(() => {
+          parseFilePipe = new ParseFilePipe({
+            validators: [new AlwaysInvalidValidator({})],
+            errorHttpStatusCode: HttpStatus.CONFLICT,
+          });
+        });
+
+        it('should throw this custom Error', async () => {
+          const requestFile = {
+            path: 'some-path',
+          };
+
+          await expect(parseFilePipe.transform(requestFile)).to.be.rejectedWith(
+            ConflictException,
+          );
+        });
+      });
+    });
+  });
+});
diff --git a/packages/common/test/pipes/parse-int.pipe.spec.ts b/packages/common/test/pipes/parse-int.pipe.spec.ts
index 3bb7ab185..d9d78de27 100644
--- a/packages/common/test/pipes/parse-int.pipe.spec.ts
+++ b/packages/common/test/pipes/parse-int.pipe.spec.ts
@@ -1,4 +1,3 @@
-import * as sinon from 'sinon';
 import { expect } from 'chai';
 import { ArgumentMetadata } from '../../interfaces';
 import { ParseIntPipe } from '../../pipes/parse-int.pipe';
diff --git a/packages/common/test/pipes/parse-uuid.pipe.spec.ts b/packages/common/test/pipes/parse-uuid.pipe.spec.ts
index 3f6cb79fb..bcb3a76b3 100644
--- a/packages/common/test/pipes/parse-uuid.pipe.spec.ts
+++ b/packages/common/test/pipes/parse-uuid.pipe.spec.ts
@@ -1,9 +1,18 @@
 import { expect } from 'chai';
+import { HttpStatus } from '../../enums';
+import { HttpException } from '../../exceptions';
 import { ArgumentMetadata } from '../../interfaces';
 import { ParseUUIDPipe } from '../../pipes/parse-uuid.pipe';
 
+class TestException extends HttpException {
+  constructor() {
+    super('This is a TestException', HttpStatus.I_AM_A_TEAPOT);
+  }
+}
+
 describe('ParseUUIDPipe', () => {
   let target: ParseUUIDPipe;
+  const exceptionFactory = (error: any) => new TestException();
 
   describe('transform', () => {
     const v3 = 'e8b5a51d-11c8-3310-a6ab-367563f20686';
@@ -12,53 +21,80 @@ describe('ParseUUIDPipe', () => {
 
     describe('when validation passes', () => {
       it('should return string if value is uuid v3, v4 or v5', async () => {
-        target = new ParseUUIDPipe();
+        target = new ParseUUIDPipe({ exceptionFactory });
         expect(await target.transform(v3, {} as ArgumentMetadata)).to.equal(v3);
         expect(await target.transform(v4, {} as ArgumentMetadata)).to.equal(v4);
         expect(await target.transform(v5, {} as ArgumentMetadata)).to.equal(v5);
       });
 
       it('should return string if value is uuid v3', async () => {
-        target = new ParseUUIDPipe({ version: '3' });
+        target = new ParseUUIDPipe({ version: '3', exceptionFactory });
         expect(await target.transform(v3, {} as ArgumentMetadata)).to.equal(v3);
       });
 
       it('should return string if value is uuid v4', async () => {
-        target = new ParseUUIDPipe({ version: '4' });
+        target = new ParseUUIDPipe({ version: '4', exceptionFactory });
         expect(await target.transform(v4, {} as ArgumentMetadata)).to.equal(v4);
       });
 
       it('should return string if value is uuid v5', async () => {
-        target = new ParseUUIDPipe({ version: '5' });
+        target = new ParseUUIDPipe({ version: '5', exceptionFactory });
         expect(await target.transform(v5, {} as ArgumentMetadata)).to.equal(v5);
       });
     });
 
     describe('when validation fails', () => {
       it('should throw an error', async () => {
-        target = new ParseUUIDPipe();
-        expect(target.transform('123a', {} as ArgumentMetadata)).to.be.rejected;
+        target = new ParseUUIDPipe({ exceptionFactory });
+        await expect(
+          target.transform('123a', {} as ArgumentMetadata),
+        ).to.be.rejectedWith(TestException);
+      });
+
+      it('should throw an error - not a string', async () => {
+        target = new ParseUUIDPipe({ exceptionFactory });
+        await expect(
+          target.transform(undefined, {} as ArgumentMetadata),
+        ).to.be.rejectedWith(TestException);
       });
 
       it('should throw an error - v3', async () => {
-        target = new ParseUUIDPipe({ version: '3' });
-        expect(target.transform('123a', {} as ArgumentMetadata)).to.be.rejected;
-        expect(target.transform(v4, {} as ArgumentMetadata)).to.be.rejected;
-        expect(target.transform(v5, {} as ArgumentMetadata)).to.be.rejected;
+        target = new ParseUUIDPipe({ version: '3', exceptionFactory });
+        await expect(
+          target.transform('123a', {} as ArgumentMetadata),
+        ).to.be.rejectedWith(TestException);
+        await expect(
+          target.transform(v4, {} as ArgumentMetadata),
+        ).to.be.rejectedWith(TestException);
+        await expect(
+          target.transform(v5, {} as ArgumentMetadata),
+        ).to.be.rejectedWith(TestException);
       });
 
       it('should throw an error - v4', async () => {
-        target = new ParseUUIDPipe({ version: '4' });
-        expect(target.transform('123a', {} as ArgumentMetadata)).to.be.rejected;
-        expect(target.transform(v3, {} as ArgumentMetadata)).to.be.rejected;
-        expect(target.transform(v5, {} as ArgumentMetadata)).to.be.rejected;
+        target = new ParseUUIDPipe({ version: '4', exceptionFactory });
+        await expect(
+          target.transform('123a', {} as ArgumentMetadata),
+        ).to.be.rejectedWith(TestException);
+        await expect(
+          target.transform(v3, {} as ArgumentMetadata),
+        ).to.be.rejectedWith(TestException);
+        await expect(
+          target.transform(v5, {} as ArgumentMetadata),
+        ).to.be.rejectedWith(TestException);
       });
 
       it('should throw an error - v5 ', async () => {
-        target = new ParseUUIDPipe({ version: '5' });
-        expect(target.transform('123a', {} as ArgumentMetadata)).to.be.rejected;
-        expect(target.transform(v3, {} as ArgumentMetadata)).to.be.rejected;
-        expect(target.transform(v4, {} as ArgumentMetadata)).to.be.rejected;
+        target = new ParseUUIDPipe({ version: '5', exceptionFactory });
+        await expect(
+          target.transform('123a', {} as ArgumentMetadata),
+        ).to.be.rejectedWith(TestException);
+        await expect(
+          target.transform(v3, {} as ArgumentMetadata),
+        ).to.be.rejectedWith(TestException);
+        await expect(
+          target.transform(v4, {} as ArgumentMetadata),
+        ).to.be.rejectedWith(TestException);
       });
     });
   });
diff --git a/packages/common/test/services/logger.service.spec.ts b/packages/common/test/services/logger.service.spec.ts
index 5caa83a65..1a954c1be 100644
--- a/packages/common/test/services/logger.service.spec.ts
+++ b/packages/common/test/services/logger.service.spec.ts
@@ -1,7 +1,7 @@
 import { expect } from 'chai';
 import 'reflect-metadata';
 import * as sinon from 'sinon';
-import { ConsoleLogger, Logger, LoggerService } from '../../services';
+import { ConsoleLogger, Logger, LoggerService, LogLevel } from '../../services';
 
 describe('Logger', () => {
   describe('[static methods]', () => {
@@ -520,4 +520,61 @@ describe('Logger', () => {
       });
     });
   });
+  describe('ConsoleLogger', () => {
+    let processStdoutWriteSpy: sinon.SinonSpy;
+
+    beforeEach(() => {
+      processStdoutWriteSpy = sinon.spy(process.stdout, 'write');
+    });
+    afterEach(() => {
+      processStdoutWriteSpy.restore();
+    });
+
+    it('should support custom formatter', () => {
+      class CustomConsoleLogger extends ConsoleLogger {
+        protected formatMessage(
+          logLevel: LogLevel,
+          message: unknown,
+          pidMessage: string,
+          formattedLogLevel: string,
+          contextMessage: string,
+          timestampDiff: string,
+        ) {
+          return `Prefix: ${message}`;
+        }
+      }
+
+      const consoleLogger = new CustomConsoleLogger();
+      consoleLogger.debug('test');
+
+      expect(processStdoutWriteSpy.firstCall.firstArg).to.equal(`Prefix: test`);
+    });
+
+    it('should support custom formatter and colorizer', () => {
+      class CustomConsoleLogger extends ConsoleLogger {
+        protected formatMessage(
+          logLevel: LogLevel,
+          message: unknown,
+          pidMessage: string,
+          formattedLogLevel: string,
+          contextMessage: string,
+          timestampDiff: string,
+        ) {
+          const strMessage = this.stringifyMessage(message, logLevel);
+          return `Prefix: ${strMessage}`;
+        }
+
+        protected colorize(message: string, logLevel: LogLevel): string {
+          return `~~~${message}~~~`;
+        }
+      }
+
+      const consoleLogger = new CustomConsoleLogger();
+      consoleLogger.debug('test');
+
+      expect(processStdoutWriteSpy.firstCall.firstArg).to.equal(
+        `Prefix: ~~~test~~~`,
+      );
+    });
+  });
 });
diff --git a/packages/common/test/tsconfig.json b/packages/common/test/tsconfig.json
new file mode 100644
index 000000000..50d59661d
--- /dev/null
+++ b/packages/common/test/tsconfig.json
@@ -0,0 +1,3 @@
+{
+  "extends": "../../../tsconfig.spec.json"
+}
diff --git a/packages/common/test/utils/shared.utils.spec.ts b/packages/common/test/utils/shared.utils.spec.ts
index a4ce885c0..d37ac4a0f 100644
--- a/packages/common/test/utils/shared.utils.spec.ts
+++ b/packages/common/test/utils/shared.utils.spec.ts
@@ -5,9 +5,11 @@ import {
   isEmpty,
   isFunction,
   isNil,
+  isNumber,
   isObject,
   isPlainObject,
   isString,
+  isSymbol,
   isUndefined,
   normalizePath,
   stripEndSlash,
@@ -66,15 +68,44 @@ describe('Shared utils', () => {
     });
   });
   describe('isString', () => {
-    it('should return true when obj is a string', () => {
+    it('should return true when val is a string', () => {
       expect(isString('true')).to.be.true;
     });
-    it('should return false when object is not a string', () => {
+    it('should return false when val is not a string', () => {
+      expect(isString(new String('fine'))).to.be.false;
       expect(isString(false)).to.be.false;
       expect(isString(null)).to.be.false;
       expect(isString(undefined)).to.be.false;
     });
   });
+  describe('isSymbol', () => {
+    it('should return true when val is a Symbol', () => {
+      expect(isSymbol(Symbol())).to.be.true;
+    });
+    it('should return false when val is not a symbol', () => {
+      expect(isSymbol('Symbol()')).to.be.false;
+      expect(isSymbol(false)).to.be.false;
+      expect(isSymbol(null)).to.be.false;
+      expect(isSymbol(undefined)).to.be.false;
+    });
+  });
+  describe('isNumber', () => {
+    it('should return true when val is a number or NaN', () => {
+      expect(isNumber(1)).to.be.true;
+      expect(isNumber(1.23)).to.be.true; // with decimals
+      expect(isNumber(123e-5)).to.be.true; // scientific (exponent) notation
+      expect(isNumber(0o1)).to.be.true; // octal notation
+      expect(isNumber(0b1)).to.be.true; // binary notation
+      expect(isNumber(0x1)).to.be.true; // hexadecimal notation
+      expect(isNumber(NaN)).to.be.true;
+    });
+    it('should return false when val is not a number', () => {
+      // expect(isNumber(1n)).to.be.false; // big int (available on ES2020)
+      expect(isNumber('1')).to.be.false; // string
+      expect(isNumber(undefined)).to.be.false; // nullish
+      expect(isNumber(null)).to.be.false; // nullish
+    });
+  });
   describe('isConstructor', () => {
     it('should return true when string is equal to constructor', () => {
       expect(isConstructor('constructor')).to.be.true;
diff --git a/packages/common/utils/cli-colors.util.ts b/packages/common/utils/cli-colors.util.ts
index 8efd61670..738fbc6d3 100644
--- a/packages/common/utils/cli-colors.util.ts
+++ b/packages/common/utils/cli-colors.util.ts
@@ -5,6 +5,7 @@ const colorIfAllowed = (colorFn: ColorTextFn) => (text: string) =>
   isColorAllowed() ? colorFn(text) : text;
 
 export const clc = {
+  bold: colorIfAllowed((text: string) => `\x1B[1m${text}\x1B[0m`),
   green: colorIfAllowed((text: string) => `\x1B[32m${text}\x1B[39m`),
   yellow: colorIfAllowed((text: string) => `\x1B[33m${text}\x1B[39m`),
   red: colorIfAllowed((text: string) => `\x1B[31m${text}\x1B[39m`),
diff --git a/packages/common/utils/is-uuid.ts b/packages/common/utils/is-uuid.ts
deleted file mode 100644
index 4c5474ade..000000000
--- a/packages/common/utils/is-uuid.ts
+++ /dev/null
@@ -1,16 +0,0 @@
-import { BadRequestException } from '../exceptions';
-
-const uuid = {
-  3: /^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,
-  4: /^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,
-  5: /^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,
-  all: /^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i,
-};
-
-export function isUUID(str: any, version = 'all') {
-  if (typeof str !== 'string') {
-    throw new BadRequestException('The value passed as UUID is not a string');
-  }
-  const pattern = uuid[version];
-  return pattern && pattern.test(str);
-}
diff --git a/packages/common/utils/shared.utils.ts b/packages/common/utils/shared.utils.ts
index d988f0139..4f9ff6eea 100644
--- a/packages/common/utils/shared.utils.ts
+++ b/packages/common/utils/shared.utils.ts
@@ -31,12 +31,6 @@ export const addLeadingSlash = (path?: string): string =>
       : path
     : '';
 
-/**
- * Deprecated. Use the "addLeadingSlash" function instead.
- * @deprecated
- */
-export const validatePath = addLeadingSlash;
-
 export const normalizePath = (path?: string): string =>
   path
     ? path.startsWith('/')
@@ -47,10 +41,11 @@ export const normalizePath = (path?: string): string =>
 export const stripEndSlash = (path: string) =>
   path[path.length - 1] === '/' ? path.slice(0, path.length - 1) : path;
 
-export const isFunction = (fn: any): boolean => typeof fn === 'function';
-export const isString = (fn: any): fn is string => typeof fn === 'string';
-export const isConstructor = (fn: any): boolean => fn === 'constructor';
-export const isNil = (obj: any): obj is null | undefined =>
-  isUndefined(obj) || obj === null;
+export const isFunction = (val: any): boolean => typeof val === 'function';
+export const isString = (val: any): val is string => typeof val === 'string';
+export const isNumber = (val: any): val is number => typeof val === 'number';
+export const isConstructor = (val: any): boolean => val === 'constructor';
+export const isNil = (val: any): val is null | undefined =>
+  isUndefined(val) || val === null;
 export const isEmpty = (array: any): boolean => !(array && array.length > 0);
-export const isSymbol = (fn: any): fn is symbol => typeof fn === 'symbol';
+export const isSymbol = (val: any): val is symbol => typeof val === 'symbol';
diff --git a/packages/core/CHANGELOG.md b/packages/core/CHANGELOG.md
deleted file mode 100644
index f16fa8cd1..000000000
--- a/packages/core/CHANGELOG.md
+++ /dev/null
@@ -1,12 +0,0 @@
-# Change Log
-
-All notable changes to this project will be documented in this file.
-See [Conventional Commits](https://conventionalcommits.org) for commit guidelines.
-
-<a name="8.2.0"></a>
-# [8.2.0](https://github.com/nestjs/nest/compare/v8.1.2...v8.2.0) (2021-11-08)
-
-
-
-
-**Note:** Version bump only for package @nestjs/core
diff --git a/packages/core/Readme.md b/packages/core/Readme.md
index f288809a9..9a3f42045 100644
--- a/packages/core/Readme.md
+++ b/packages/core/Readme.md
@@ -54,36 +54,42 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
 <table style="text-align:center;"><tr>
   <td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
+  <td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/red-hat-logo.svg" width="200" valign="middle" /></a></td>
 <td>
 <a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
 <td>
 <a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
+    <td>
+<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td><td>
+<a href="https://amplication.com/" target="_blank"><img src="https://nestjs.com/img/amplication-logo.svg" width="190" valign="middle" /></a></td>
 </tr></table>
 
 #### Gold Sponsors
 
 <table style="text-align:center;"><tr><td>
-  <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
-  <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
+<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="140" valign="middle" /></a></td>
 <td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
+<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td>
+ <td>
+<a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
+<a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td><td>
+<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
 <table style="text-align:center;"><tr><td>
 <a href="https://neoteric.eu/" target="_blank"><img src="https://nestjs.com/img/neoteric-cut.png" width="120" valign="middle" /></a> </td><td>
   <a href="http://gojob.com" target="_blank"><img src="http://nestjs.com/img/gojob-logo.png" valign="middle" width="100" /></a> </td><td>
-<a href="http://www.leogistics.com" target="_blank"><img src="https://nestjs.com/img/leogistics-logo.jpeg" width="150" valign="middle" /></td><td>
+<a href="https://www.myleodsc.com/" target="_blank"><img src="https://nestjs.com/img/myleo-logo.png" width="180" valign="middle" /></td><td>
 <a href="https://careers.meetdandy.com/?gh_src=063ba61e3us" target="_blank"><img src="https://nestjs.com/img/dandy-roles-logo.svg" width="150" valign="middle" /></td><td>
 <a href="https://www.castlecraft.in" target="_blank"><img src="https://nestjs.com/img/castlecraft-logo.png" width="150" valign="middle" /></td>
-<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td></tr></table>
+<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td>
+<td><a href="https://n.inc" target="_blank"><img src="https://nestjs.com/img/n-inc-logo.svg" width="120" valign="middle" /></td></tr></table>
 
 #### Sponsors
 
@@ -117,6 +123,11 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/naologic-logo.svg" width="125" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://messaged.com/" target="_blank"><img src="https://nestjs.com/img/messaged-logo.png" width="50" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/triplecore-logo.svg" width="50" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://klqc.de" target="_blank"><img src="https://nestjs.com/img/klcqcl-logo.png" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://thecasinowizard.com/bonuses/no-deposit-bonuses/" target="_blank"><img src="https://nestjs.com/img/casinowizard-logo.png" width="120" valign="middle" /></a></td></tr><tr>
+     <td align="center" valign="middle"><a href="https://polygon-software.ch/" target="_blank"><img src="https://nestjs.com/img/polygon-logo.svg" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://mobilereality.pl/" target="_blank"><img src="https://nestjs.com/img/mobile-reality-logo.png" width="45" valign="middle" /></a></td>
+     <td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/boringowl-logo.svg" width="120" valign="middle" /></a></td>
   </tr></table>
 
 ## Backers
diff --git a/packages/core/adapters/http-adapter.ts b/packages/core/adapters/http-adapter.ts
index c5d778c13..449c9e68c 100644
--- a/packages/core/adapters/http-adapter.ts
+++ b/packages/core/adapters/http-adapter.ts
@@ -1,5 +1,5 @@
-import { HttpServer, RequestMethod } from '@nestjs/common';
-import { RequestHandler } from '@nestjs/common/interfaces';
+import { HttpServer, RequestMethod, VersioningOptions } from '@nestjs/common';
+import { RequestHandler, VersionValue } from '@nestjs/common/interfaces';
 import {
   CorsOptions,
   CorsOptionsDelegate,
@@ -105,14 +105,12 @@ export abstract class AbstractHttpAdapter<
   abstract getRequestUrl(request);
   abstract status(response, statusCode: number);
   abstract reply(response, body: any, statusCode?: number);
-  abstract end(response, message?: string);
   abstract render(response, view: string, options: any);
   abstract redirect(response, statusCode: number, url: string);
   abstract setErrorHandler(handler: Function, prefix?: string);
   abstract setNotFoundHandler(handler: Function, prefix?: string);
-  abstract isHeadersSent(response);
   abstract setHeader(response, name: string, value: string);
-  abstract registerParserMiddleware(prefix?: string);
+  abstract registerParserMiddleware(prefix?: string, rawBody?: boolean);
   abstract enableCors(
     options: CorsOptions | CorsOptionsDelegate<TRequest>,
     prefix?: string,
@@ -123,4 +121,9 @@ export abstract class AbstractHttpAdapter<
     | ((path: string, callback: Function) => any)
     | Promise<(path: string, callback: Function) => any>;
   abstract getType(): string;
+  abstract applyVersionFilter(
+    handler: Function,
+    version: VersionValue,
+    versioningOptions: VersioningOptions,
+  ): (req: TRequest, res: TResponse, next: () => void) => Function;
 }
diff --git a/packages/core/application-config.ts b/packages/core/application-config.ts
index 4df293753..1b6adfa4e 100644
--- a/packages/core/application-config.ts
+++ b/packages/core/application-config.ts
@@ -136,6 +136,11 @@ export class ApplicationConfig {
   }
 
   public enableVersioning(options: VersioningOptions): void {
+    if (Array.isArray(options.defaultVersion)) {
+      // Drop duplicated versions
+      options.defaultVersion = Array.from(new Set(options.defaultVersion));
+    }
+
     this.versioningOptions = options;
   }
 
diff --git a/packages/core/errors/exceptions/invalid-class-module.exception.ts b/packages/core/errors/exceptions/invalid-class-module.exception.ts
new file mode 100644
index 000000000..0761ea5ce
--- /dev/null
+++ b/packages/core/errors/exceptions/invalid-class-module.exception.ts
@@ -0,0 +1,10 @@
+import { USING_INVALID_CLASS_AS_A_MODULE_MESSAGE } from '../messages';
+import { RuntimeException } from './runtime.exception';
+
+export class InvalidClassModuleException extends RuntimeException {
+  constructor(metatypeUsedAsAModule: any, scope: any[]) {
+    super(
+      USING_INVALID_CLASS_AS_A_MODULE_MESSAGE(metatypeUsedAsAModule, scope),
+    );
+  }
+}
diff --git a/packages/core/errors/messages.ts b/packages/core/errors/messages.ts
index 2aaec08e6..b0a26e8d1 100644
--- a/packages/core/errors/messages.ts
+++ b/packages/core/errors/messages.ts
@@ -1,4 +1,4 @@
-import { ForwardReference, Type } from '@nestjs/common';
+import type { ForwardReference, Type, DynamicModule } from '@nestjs/common';
 import { isNil, isSymbol } from '@nestjs/common/utils/shared.utils';
 import {
   InjectorDependency,
@@ -7,14 +7,19 @@ import {
 import { Module } from '../injector/module';
 
 /**
- * Returns the name of an instance
+ * Returns the name of an instance or `undefined`
  * @param instance The instance which should get the name from
  */
 const getInstanceName = (instance: unknown): string => {
   if ((instance as ForwardReference)?.forwardRef) {
     return (instance as ForwardReference).forwardRef()?.name;
   }
-  return (instance as Type<any>)?.name;
+
+  if ((instance as DynamicModule)?.module) {
+    return (instance as DynamicModule).module?.name;
+  }
+
+  return (instance as Type)?.name;
 };
 
 /**
@@ -97,7 +102,7 @@ export const UNDEFINED_FORWARDREF_MESSAGE = (
 
 (Read more: https://docs.nestjs.com/fundamentals/circular-dependency)
 Scope [${stringifyScope(scope)}]
-  `;
+`;
 
 export const INVALID_MODULE_MESSAGE = (
   parentModule: any,
@@ -107,11 +112,25 @@ export const INVALID_MODULE_MESSAGE = (
   const parentModuleName = parentModule?.name || 'module';
 
   return `Nest cannot create the ${parentModuleName} instance.
-Received an unexpected value at index [${index}] of the ${parentModuleName} "imports" array. 
+Received an unexpected value at index [${index}] of the ${parentModuleName} "imports" array.
 
 Scope [${stringifyScope(scope)}]`;
 };
 
+export const USING_INVALID_CLASS_AS_A_MODULE_MESSAGE = (
+  metatypeUsedAsAModule: Type | ForwardReference,
+  scope: any[],
+) => {
+  const metatypeNameQuote =
+    `"${getInstanceName(metatypeUsedAsAModule)}"` || 'that class';
+
+  return `Classes annotated with @Injectable(), @Catch(), and @Controller() decorators must not appear in the "imports" array of a module.
+Please remove ${metatypeNameQuote} (including forwarded occurrences, if any) from all of the "imports" arrays.
+
+Scope [${stringifyScope(scope)}]
+`;
+};
+
 export const UNDEFINED_MODULE_MESSAGE = (
   parentModule: any,
   index: number,
diff --git a/packages/core/exceptions/base-exception-filter.ts b/packages/core/exceptions/base-exception-filter.ts
index bc3784501..ea360e84a 100644
--- a/packages/core/exceptions/base-exception-filter.ts
+++ b/packages/core/exceptions/base-exception-filter.ts
@@ -38,12 +38,7 @@ export class BaseExceptionFilter<T = any> implements ExceptionFilter<T> {
           message: res,
         };
 
-    const response = host.getArgByIndex(1);
-    if (!applicationRef.isHeadersSent(response)) {
-      applicationRef.reply(response, message, exception.getStatus());
-    } else {
-      applicationRef.end(response);
-    }
+    applicationRef.reply(host.getArgByIndex(1), message, exception.getStatus());
   }
 
   public handleUnknownError(
@@ -60,14 +55,7 @@ export class BaseExceptionFilter<T = any> implements ExceptionFilter<T> {
           statusCode: HttpStatus.INTERNAL_SERVER_ERROR,
           message: MESSAGES.UNKNOWN_EXCEPTION_MESSAGE,
         };
-
-    const response = host.getArgByIndex(1);
-    if (!applicationRef.isHeadersSent(response)) {
-      applicationRef.reply(response, body, body.statusCode);
-    } else {
-      applicationRef.end(response);
-    }
-
+    applicationRef.reply(host.getArgByIndex(1), body, body.statusCode);
     if (this.isExceptionObject(exception)) {
       return BaseExceptionFilter.logger.error(
         exception.message,
diff --git a/packages/core/helpers/context-id-factory.ts b/packages/core/helpers/context-id-factory.ts
index 0cb80d311..3b26e6eb1 100644
--- a/packages/core/helpers/context-id-factory.ts
+++ b/packages/core/helpers/context-id-factory.ts
@@ -1,4 +1,4 @@
-import { ContextId } from '../injector/instance-wrapper';
+import { ChildContextIdInfo, ContextId } from '../injector/instance-wrapper';
 import { REQUEST_CONTEXT_ID } from '../router/request/request-constants';
 
 export function createContextId(): ContextId {
@@ -13,7 +13,22 @@ export function createContextId(): ContextId {
   return { id: Math.random() };
 }
 
+export interface ContextIdStrategy<T = any> {
+  /**
+   * Allows to attach a parent context id to the existing child context id.
+   * This lets you construct durable DI sub-trees that can be shared between contexts.
+   * @param contextId auto-generated child context id
+   * @param request request object
+   */
+  attach(
+    contextId: ContextId,
+    request: T,
+  ): ((info: ChildContextIdInfo) => ContextId) | undefined;
+}
+
 export class ContextIdFactory {
+  private static strategy?: ContextIdStrategy;
+
   /**
    * Generates a context identifier based on the request object.
    */
@@ -27,16 +42,33 @@ export class ContextIdFactory {
    */
   public static getByRequest<T extends Record<any, any> = any>(
     request: T,
+    propsToInspect: string[] = ['raw'],
   ): ContextId {
     if (!request) {
-      return createContextId();
+      return ContextIdFactory.create();
     }
     if (request[REQUEST_CONTEXT_ID as any]) {
       return request[REQUEST_CONTEXT_ID as any];
     }
-    if (request.raw && request.raw[REQUEST_CONTEXT_ID]) {
-      return request.raw[REQUEST_CONTEXT_ID];
+    for (const key of propsToInspect) {
+      if (request[key]?.[REQUEST_CONTEXT_ID]) {
+        return request[key][REQUEST_CONTEXT_ID];
+      }
     }
-    return createContextId();
+    if (!this.strategy) {
+      return ContextIdFactory.create();
+    }
+    const contextId = createContextId();
+    contextId.getParent = this.strategy.attach(contextId, request);
+    return contextId;
+  }
+
+  /**
+   * Registers a custom context id strategy that lets you attach
+   * a parent context id to the existing context id object.
+   * @param strategy strategy instance
+   */
+  public static apply(strategy: ContextIdStrategy) {
+    this.strategy = strategy;
   }
 }
diff --git a/packages/core/helpers/context-utils.ts b/packages/core/helpers/context-utils.ts
index dc64660f1..10c67b5a8 100644
--- a/packages/core/helpers/context-utils.ts
+++ b/packages/core/helpers/context-utils.ts
@@ -50,12 +50,15 @@ export class ContextUtils {
   }
 
   public getArgumentsLength<T>(keys: string[], metadata: T): number {
-    return Math.max(...keys.map(key => metadata[key].index)) + 1;
+    return keys.length
+      ? Math.max(...keys.map(key => metadata[key].index)) + 1
+      : 0;
   }
 
   public createNullArray(length: number): any[] {
-    // eslint-disable-next-line prefer-spread
-    return Array.apply(null, { length } as any).fill(undefined);
+    const a = new Array(length);
+    for (let i = 0; i < length; ++i) a[i] = undefined;
+    return a;
   }
 
   public mergeParamsMetatypes(
diff --git a/packages/core/helpers/external-context-creator.ts b/packages/core/helpers/external-context-creator.ts
index 847da432d..ee9484017 100644
--- a/packages/core/helpers/external-context-creator.ts
+++ b/packages/core/helpers/external-context-creator.ts
@@ -6,7 +6,7 @@ import {
   PipeTransform,
 } from '@nestjs/common/interfaces';
 import { isEmpty, isFunction } from '@nestjs/common/utils/shared.utils';
-import { lastValueFrom } from 'rxjs';
+import { lastValueFrom, isObservable } from 'rxjs';
 import { ExternalExceptionFilterContext } from '../exceptions/external-exception-filter-context';
 import { FORBIDDEN_MESSAGE } from '../guards/constants';
 import { GuardsConsumer } from '../guards/guards-consumer';
@@ -329,7 +329,7 @@ export class ExternalContextCreator {
   }
 
   public async transformToResult(resultOrDeferred: any) {
-    if (resultOrDeferred && isFunction(resultOrDeferred.subscribe)) {
+    if (isObservable(resultOrDeferred)) {
       return lastValueFrom(resultOrDeferred);
     }
     return resultOrDeferred;
diff --git a/packages/core/helpers/is-durable.ts b/packages/core/helpers/is-durable.ts
new file mode 100644
index 000000000..377c84f18
--- /dev/null
+++ b/packages/core/helpers/is-durable.ts
@@ -0,0 +1,7 @@
+import { SCOPE_OPTIONS_METADATA } from '@nestjs/common/constants';
+import { Type } from '@nestjs/common/interfaces/type.interface';
+
+export function isDurable(provider: Type<unknown>): boolean | undefined {
+  const metadata = Reflect.getMetadata(SCOPE_OPTIONS_METADATA, provider);
+  return metadata && metadata.durable;
+}
diff --git a/packages/core/helpers/messages.ts b/packages/core/helpers/messages.ts
index b7d37cc44..3c2fffd7c 100644
--- a/packages/core/helpers/messages.ts
+++ b/packages/core/helpers/messages.ts
@@ -17,10 +17,12 @@ export const VERSIONED_ROUTE_MAPPED_MESSAGE = (
   method: string | number,
   version: VersionValue,
 ) => {
-  if (version === VERSION_NEUTRAL) {
-    version = 'Neutral';
-  }
-  return `Mapped {${path}, ${RequestMethod[method]}} (version: ${version}) route`;
+  const controllerVersions = Array.isArray(version) ? version : [version];
+  const versions = controllerVersions
+    .map(version => (version === VERSION_NEUTRAL ? 'Neutral' : version))
+    .join(',');
+
+  return `Mapped {${path}, ${RequestMethod[method]}} (version: ${versions}) route`;
 };
 
 export const CONTROLLER_MAPPING_MESSAGE = (name: string, path: string) =>
@@ -31,10 +33,12 @@ export const VERSIONED_CONTROLLER_MAPPING_MESSAGE = (
   path: string,
   version: VersionValue,
 ) => {
-  if (version === VERSION_NEUTRAL) {
-    version = 'Neutral';
-  }
-  return `${name} {${path}} (version: ${version}):`;
+  const controllerVersions = Array.isArray(version) ? version : [version];
+  const versions = controllerVersions
+    .map(version => (version === VERSION_NEUTRAL ? 'Neutral' : version))
+    .join(',');
+
+  return `${name} {${path}} (version: ${versions}):`;
 };
 
 export const INVALID_EXECUTION_CONTEXT = (
diff --git a/packages/core/index.ts b/packages/core/index.ts
index 2915304ab..1babf6c15 100644
--- a/packages/core/index.ts
+++ b/packages/core/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @core
- * Copyright(c) 2017 - 2021 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2022 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
@@ -18,5 +18,6 @@ export * from './middleware';
 export * from './nest-application';
 export * from './nest-application-context';
 export { NestFactory } from './nest-factory';
+export * from './repl';
 export * from './router';
 export * from './services';
diff --git a/packages/core/injector/container.ts b/packages/core/injector/container.ts
index b50957d38..138524a5c 100644
--- a/packages/core/injector/container.ts
+++ b/packages/core/injector/container.ts
@@ -154,13 +154,13 @@ export class NestContainer {
     provider: Provider,
     token: string,
   ): string | symbol | Function {
+    const moduleRef = this.modules.get(token);
     if (!provider) {
-      throw new CircularDependencyException();
+      throw new CircularDependencyException(moduleRef?.metatype.name);
     }
-    if (!this.modules.has(token)) {
+    if (!moduleRef) {
       throw new UnknownModuleException();
     }
-    const moduleRef = this.modules.get(token);
     return moduleRef.addProvider(provider);
   }
 
diff --git a/packages/core/injector/index.ts b/packages/core/injector/index.ts
index 6eb81c89c..6d411776d 100644
--- a/packages/core/injector/index.ts
+++ b/packages/core/injector/index.ts
@@ -1,6 +1,6 @@
 export * from './container';
 export * from './inquirer';
-export { ContextId } from './instance-wrapper';
+export { ChildContextIdInfo, ContextId } from './instance-wrapper';
 export * from './lazy-module-loader';
 export * from './module-ref';
 export * from './modules-container';
diff --git a/packages/core/injector/injector.ts b/packages/core/injector/injector.ts
index 67996afb3..4f11322e1 100644
--- a/packages/core/injector/injector.ts
+++ b/packages/core/injector/injector.ts
@@ -1,4 +1,9 @@
-import { Logger, LoggerService } from '@nestjs/common';
+import {
+  InjectionToken,
+  Logger,
+  LoggerService,
+  OptionalFactoryDependency,
+} from '@nestjs/common';
 import {
   OPTIONAL_DEPS_METADATA,
   OPTIONAL_PROPERTY_DEPS_METADATA,
@@ -15,6 +20,7 @@ import {
   isNil,
   isObject,
   isString,
+  isSymbol,
   isUndefined,
 } from '@nestjs/common/utils/shared.utils';
 import { iterate } from 'iterare';
@@ -34,13 +40,13 @@ import { InstanceToken, Module } from './module';
 /**
  * The type of an injectable dependency
  */
-export type InjectorDependency = Type<any> | Function | string | symbol;
+export type InjectorDependency = InjectionToken;
 
 /**
  * The property-based dependency
  */
 export interface PropertyDependency {
-  key: string;
+  key: symbol | string;
   name: InjectorDependency;
   isOptional?: boolean;
   instance?: any;
@@ -100,7 +106,10 @@ export class Injector {
     inquirer?: InstanceWrapper,
   ) {
     const inquirerId = this.getInquirerId(inquirer);
-    const instanceHost = wrapper.getInstanceByContextId(contextId, inquirerId);
+    const instanceHost = wrapper.getInstanceByContextId(
+      this.getContextId(contextId, wrapper),
+      inquirerId,
+    );
     if (instanceHost.isPending) {
       return instanceHost.donePromise;
     }
@@ -119,7 +128,7 @@ export class Injector {
       const properties = await this.resolveProperties(
         wrapper,
         moduleRef,
-        inject,
+        inject as InjectionToken[],
         contextId,
         wrapper,
         inquirer,
@@ -137,7 +146,7 @@ export class Injector {
     await this.resolveConstructorParams<T>(
       wrapper,
       moduleRef,
-      inject,
+      inject as InjectionToken[],
       callback,
       contextId,
       wrapper,
@@ -246,12 +255,11 @@ export class Injector {
       );
       return callback(deps);
     }
-    const dependencies = isNil(inject)
-      ? this.reflectConstructorParams(wrapper.metatype as Type<any>)
-      : inject;
-    const optionalDependenciesIds = isNil(inject)
-      ? this.reflectOptionalParams(wrapper.metatype as Type<any>)
-      : [];
+
+    const isFactoryProvider = !isNil(inject);
+    const [dependencies, optionalDependenciesIds] = isFactoryProvider
+      ? this.getFactoryProviderDependencies(wrapper)
+      : this.getClassDependencies(wrapper);
 
     let isResolved = true;
     const resolveParam = async (param: unknown, index: number) => {
@@ -273,7 +281,7 @@ export class Injector {
           index,
         );
         const instanceHost = paramWrapper.getInstanceByContextId(
-          contextId,
+          this.getContextId(contextId, paramWrapper),
           inquirerId,
         );
         if (!instanceHost.isResolved && !paramWrapper.forwardRef) {
@@ -292,6 +300,47 @@ export class Injector {
     isResolved && (await callback(instances));
   }
 
+  public getClassDependencies<T>(
+    wrapper: InstanceWrapper<T>,
+  ): [InjectorDependency[], number[]] {
+    const ctorRef = wrapper.metatype as Type<any>;
+    return [
+      this.reflectConstructorParams(ctorRef),
+      this.reflectOptionalParams(ctorRef),
+    ];
+  }
+
+  public getFactoryProviderDependencies<T>(
+    wrapper: InstanceWrapper<T>,
+  ): [InjectorDependency[], number[]] {
+    const optionalDependenciesIds = [];
+    const isOptionalFactoryDep = (
+      item: InjectionToken | OptionalFactoryDependency,
+    ): item is OptionalFactoryDependency =>
+      !isUndefined((item as OptionalFactoryDependency).token) &&
+      !isUndefined((item as OptionalFactoryDependency).optional);
+
+    const mapFactoryProviderInjectArray = (
+      item: InjectionToken | OptionalFactoryDependency,
+      index: number,
+    ): InjectionToken => {
+      if (typeof item !== 'object') {
+        return item;
+      }
+      if (isOptionalFactoryDep(item)) {
+        if (item.optional) {
+          optionalDependenciesIds.push(index);
+        }
+        return item?.token;
+      }
+      return item;
+    };
+    return [
+      wrapper.inject?.map?.(mapFactoryProviderInjectArray),
+      optionalDependenciesIds,
+    ];
+  }
+
   public reflectConstructorParams<T>(type: Type<T>): any[] {
     const paramtypes = Reflect.getMetadata(PARAMTYPES_METADATA, type) || [];
     const selfParams = this.reflectSelfParams<T>(type);
@@ -315,7 +364,7 @@ export class Injector {
     moduleRef: Module,
     contextId = STATIC_CONTEXT,
     inquirer?: InstanceWrapper,
-    keyOrIndex?: string | number,
+    keyOrIndex?: symbol | string | number,
   ) {
     if (isUndefined(param)) {
       this.logger.log(
@@ -357,7 +406,7 @@ export class Injector {
     wrapper: InstanceWrapper<T>,
     contextId = STATIC_CONTEXT,
     inquirer?: InstanceWrapper,
-    keyOrIndex?: string | number,
+    keyOrIndex?: symbol | string | number,
   ): Promise<InstanceWrapper> {
     this.printResolvingDependenciesLog(token, inquirer);
     this.printLookingForProviderLog(token, moduleRef);
@@ -388,11 +437,16 @@ export class Injector {
   ): Promise<InstanceWrapper> {
     const inquirerId = this.getInquirerId(inquirer);
     const instanceHost = instanceWrapper.getInstanceByContextId(
-      contextId,
+      this.getContextId(contextId, instanceWrapper),
       inquirerId,
     );
     if (!instanceHost.isResolved && !instanceWrapper.forwardRef) {
-      await this.loadProvider(instanceWrapper, moduleRef, contextId, inquirer);
+      await this.loadProvider(
+        instanceWrapper,
+        instanceWrapper.host ?? moduleRef,
+        contextId,
+        inquirer,
+      );
     } else if (
       !instanceHost.isResolved &&
       instanceWrapper.forwardRef &&
@@ -412,7 +466,7 @@ export class Injector {
     }
     if (instanceWrapper.async) {
       const host = instanceWrapper.getInstanceByContextId(
-        contextId,
+        this.getContextId(contextId, instanceWrapper),
         inquirerId,
       );
       host.instance = await host.instance;
@@ -428,10 +482,11 @@ export class Injector {
     wrapper: InstanceWrapper<T>,
     contextId = STATIC_CONTEXT,
     inquirer?: InstanceWrapper,
-    keyOrIndex?: string | number,
+    keyOrIndex?: symbol | string | number,
   ): Promise<InstanceWrapper<T>> {
+    const token = wrapper.token || wrapper.name;
     const { name } = dependencyContext;
-    if (wrapper && wrapper.name === name) {
+    if (wrapper && token === name) {
       throw new UnknownDependenciesException(
         wrapper.name,
         dependencyContext,
@@ -460,7 +515,7 @@ export class Injector {
     wrapper: InstanceWrapper<T>,
     contextId = STATIC_CONTEXT,
     inquirer?: InstanceWrapper,
-    keyOrIndex?: string | number,
+    keyOrIndex?: symbol | string | number,
   ) {
     const instanceWrapper = await this.lookupComponentInImports(
       moduleRef,
@@ -488,7 +543,7 @@ export class Injector {
     moduleRegistry: any[] = [],
     contextId = STATIC_CONTEXT,
     inquirer?: InstanceWrapper,
-    keyOrIndex?: string | number,
+    keyOrIndex?: symbol | string | number,
     isTraversing?: boolean,
   ): Promise<any> {
     let instanceWrapperRef: InstanceWrapper = null;
@@ -532,7 +587,7 @@ export class Injector {
 
       const inquirerId = this.getInquirerId(inquirer);
       const instanceHost = instanceWrapperRef.getInstanceByContextId(
-        contextId,
+        this.getContextId(contextId, instanceWrapperRef),
         inquirerId,
       );
       if (!instanceHost.isResolved && !instanceWrapperRef.forwardRef) {
@@ -588,7 +643,7 @@ export class Injector {
           }
           const inquirerId = this.getInquirerId(inquirer);
           const instanceHost = paramWrapper.getInstanceByContextId(
-            contextId,
+            this.getContextId(contextId, paramWrapper),
             inquirerId,
           );
           return instanceHost.instance;
@@ -640,7 +695,7 @@ export class Injector {
     const { metatype, inject } = wrapper;
     const inquirerId = this.getInquirerId(inquirer);
     const instanceHost = targetMetatype.getInstanceByContextId(
-      contextId,
+      this.getContextId(contextId, targetMetatype),
       inquirerId,
     );
     const isInContext =
@@ -680,7 +735,10 @@ export class Injector {
     await this.loadInstance(wrapper, collection, moduleRef, ctx, wrapper);
     await this.loadEnhancersPerContext(wrapper, ctx, wrapper);
 
-    const host = wrapper.getInstanceByContextId(ctx, wrapper.id);
+    const host = wrapper.getInstanceByContextId(
+      this.getContextId(ctx, wrapper),
+      wrapper.id,
+    );
     return host && (host.instance as T);
   }
 
@@ -721,7 +779,11 @@ export class Injector {
     );
     const inquirerId = this.getInquirerId(inquirer);
     return hosts.map(
-      item => item.getInstanceByContextId(contextId, inquirerId).instance,
+      item =>
+        item.getInstanceByContextId(
+          this.getContextId(contextId, item),
+          inquirerId,
+        ).instance,
     );
   }
 
@@ -745,7 +807,10 @@ export class Injector {
     return dependenciesHosts.map(({ key, host }) => ({
       key,
       name: key,
-      instance: host.getInstanceByContextId(contextId, inquirerId).instance,
+      instance: host.getInstanceByContextId(
+        this.getContextId(contextId, host),
+        inquirerId,
+      ).instance,
     }));
   }
 
@@ -779,13 +844,15 @@ export class Injector {
   }
 
   protected addDependencyMetadata(
-    keyOrIndex: number | string,
+    keyOrIndex: symbol | string | number,
     hostWrapper: InstanceWrapper,
     instanceWrapper: InstanceWrapper,
   ) {
-    isString(keyOrIndex)
-      ? hostWrapper.addPropertiesMetadata(keyOrIndex, instanceWrapper)
-      : hostWrapper.addCtorMetadata(keyOrIndex, instanceWrapper);
+    if (isSymbol(keyOrIndex) || isString(keyOrIndex)) {
+      hostWrapper.addPropertiesMetadata(keyOrIndex, instanceWrapper);
+    } else {
+      hostWrapper.addCtorMetadata(keyOrIndex, instanceWrapper);
+    }
   }
 
   private getTokenName(token: InstanceToken): string {
@@ -845,4 +912,16 @@ export class Injector {
   private isDebugMode(): boolean {
     return !!process.env.NEST_DEBUG;
   }
+
+  private getContextId(
+    contextId: ContextId,
+    instanceWrapper: InstanceWrapper,
+  ): ContextId {
+    return contextId.getParent
+      ? contextId.getParent({
+          token: instanceWrapper.token,
+          isTreeDurable: instanceWrapper.isDependencyTreeDurable(),
+        })
+      : contextId;
+  }
 }
diff --git a/packages/core/injector/instance-wrapper.ts b/packages/core/injector/instance-wrapper.ts
index 9d9d29579..17a74142a 100644
--- a/packages/core/injector/instance-wrapper.ts
+++ b/packages/core/injector/instance-wrapper.ts
@@ -1,11 +1,16 @@
-import { Provider, Scope, Type } from '@nestjs/common';
+import { Logger, LoggerService, Provider, Scope, Type } from '@nestjs/common';
 import {
   ClassProvider,
   FactoryProvider,
   ValueProvider,
 } from '@nestjs/common/interfaces';
+import { clc } from '@nestjs/common/utils/cli-colors.util';
 import { randomStringGenerator } from '@nestjs/common/utils/random-string-generator.util';
-import { isNil, isUndefined } from '@nestjs/common/utils/shared.utils';
+import {
+  isNil,
+  isString,
+  isUndefined,
+} from '@nestjs/common/utils/shared.utils';
 import { iterate } from 'iterare';
 import { STATIC_CONTEXT } from './constants';
 import { InstanceToken, Module } from './module';
@@ -13,8 +18,20 @@ import { InstanceToken, Module } from './module';
 export const INSTANCE_METADATA_SYMBOL = Symbol.for('instance_metadata:cache');
 export const INSTANCE_ID_SYMBOL = Symbol.for('instance_metadata:id');
 
+export interface ChildContextIdInfo {
+  /**
+   * Injection token (or class reference)
+   */
+  token: InstanceToken;
+  /**
+   * Flag that indicates whether DI subtree is durable
+   */
+  isTreeDurable: boolean;
+}
+
 export interface ContextId {
   readonly id: number;
+  getParent?(info: ChildContextIdInfo): ContextId;
 }
 
 export interface InstancePerContext<T> {
@@ -24,7 +41,7 @@ export interface InstancePerContext<T> {
   donePromise?: Promise<void>;
 }
 export interface PropertyMetadata {
-  key: string;
+  key: symbol | string;
   wrapper: InstanceWrapper;
 }
 
@@ -43,8 +60,11 @@ export class InstanceWrapper<T = any> {
 
   public scope?: Scope = Scope.DEFAULT;
   public metatype: Type<T> | Function;
-  public inject?: (string | symbol | Function | Type<any>)[];
+  public inject?: FactoryProvider['inject'];
   public forwardRef?: boolean;
+  public durable?: boolean;
+
+  private static logger: LoggerService = new Logger(InstanceWrapper.name);
 
   private readonly values = new WeakMap<ContextId, InstancePerContext<T>>();
   private readonly [INSTANCE_METADATA_SYMBOL]: InstanceMetadataStore = {};
@@ -53,6 +73,7 @@ export class InstanceWrapper<T = any> {
     | Map<string, WeakMap<ContextId, InstancePerContext<T>>>
     | undefined;
   private isTreeStatic: boolean | undefined;
+  private isTreeDurable: boolean | undefined;
 
   constructor(
     metadata: Partial<InstanceWrapper<T>> & Partial<InstancePerContext<T>> = {},
@@ -146,7 +167,7 @@ export class InstanceWrapper<T = any> {
     return this[INSTANCE_METADATA_SYMBOL].dependencies;
   }
 
-  public addPropertiesMetadata(key: string, wrapper: InstanceWrapper) {
+  public addPropertiesMetadata(key: symbol | string, wrapper: InstanceWrapper) {
     if (!this[INSTANCE_METADATA_SYMBOL].properties) {
       this[INSTANCE_METADATA_SYMBOL].properties = [];
     }
@@ -171,14 +192,40 @@ export class InstanceWrapper<T = any> {
     return this[INSTANCE_METADATA_SYMBOL].enhancers;
   }
 
-  public isDependencyTreeStatic(lookupRegistry: string[] = []): boolean {
-    if (!isUndefined(this.isTreeStatic)) {
-      return this.isTreeStatic;
+  public isDependencyTreeDurable(lookupRegistry: string[] = []): boolean {
+    if (!isUndefined(this.isTreeDurable)) {
+      return this.isTreeDurable;
     }
-    if (this.scope === Scope.REQUEST) {
-      this.isTreeStatic = false;
-      return this.isTreeStatic;
+    if (this.durable === true) {
+      this.isTreeDurable = true;
+      this.printIntrospectedAsDurable();
+      return this.isTreeDurable;
+    }
+    const isStatic = this.isDependencyTreeStatic();
+    if (isStatic) {
+      return false;
     }
+    const isTreeNonDurable = this.introspectDepsAttribute(
+      (collection, registry) =>
+        collection.every(
+          (item: InstanceWrapper) => !item.isDependencyTreeDurable(registry),
+        ),
+      lookupRegistry,
+    );
+    this.isTreeDurable = !isTreeNonDurable && this.durable !== false;
+    if (this.isTreeDurable) {
+      this.printIntrospectedAsDurable();
+    }
+    return this.isTreeDurable;
+  }
+
+  public introspectDepsAttribute(
+    callback: (
+      collection: InstanceWrapper[],
+      lookupRegistry: string[],
+    ) => boolean,
+    lookupRegistry: string[] = [],
+  ): boolean {
     if (lookupRegistry.includes(this[INSTANCE_ID_SYMBOL])) {
       return true;
     }
@@ -186,23 +233,41 @@ export class InstanceWrapper<T = any> {
 
     const { dependencies, properties, enhancers } =
       this[INSTANCE_METADATA_SYMBOL];
-    let isStatic =
-      (dependencies &&
-        this.isWrapperListStatic(dependencies, lookupRegistry)) ||
-      !dependencies;
 
-    if (!isStatic || !(properties || enhancers)) {
-      this.isTreeStatic = isStatic;
-      return this.isTreeStatic;
+    let introspectionResult =
+      (dependencies && callback(dependencies, lookupRegistry)) || !dependencies;
+
+    if (!introspectionResult || !(properties || enhancers)) {
+      return introspectionResult;
     }
     const propertiesHosts = (properties || []).map(item => item.wrapper);
-    isStatic =
-      isStatic && this.isWrapperListStatic(propertiesHosts, lookupRegistry);
-    if (!isStatic || !enhancers) {
-      this.isTreeStatic = isStatic;
+    introspectionResult =
+      introspectionResult && callback(propertiesHosts, lookupRegistry);
+    if (!introspectionResult || !enhancers) {
+      return introspectionResult;
+    }
+    return callback(enhancers, lookupRegistry);
+  }
+
+  public isDependencyTreeStatic(lookupRegistry: string[] = []): boolean {
+    if (!isUndefined(this.isTreeStatic)) {
       return this.isTreeStatic;
     }
-    this.isTreeStatic = this.isWrapperListStatic(enhancers, lookupRegistry);
+    if (this.scope === Scope.REQUEST) {
+      this.isTreeStatic = false;
+      this.printIntrospectedAsRequestScoped();
+      return this.isTreeStatic;
+    }
+    this.isTreeStatic = this.introspectDepsAttribute(
+      (collection, registry) =>
+        collection.every((item: InstanceWrapper) =>
+          item.isDependencyTreeStatic(registry),
+        ),
+      lookupRegistry,
+    );
+    if (!this.isTreeStatic) {
+      this.printIntrospectedAsRequestScoped();
+    }
     return this.isTreeStatic;
   }
 
@@ -341,15 +406,6 @@ export class InstanceWrapper<T = any> {
     return isNil(this.inject) && this.metatype && this.metatype.prototype;
   }
 
-  private isWrapperListStatic(
-    tree: InstanceWrapper[],
-    lookupRegistry: string[],
-  ): boolean {
-    return tree.every((item: InstanceWrapper) =>
-      item.isDependencyTreeStatic(lookupRegistry),
-    );
-  }
-
   private initialize(
     metadata: Partial<InstanceWrapper<T>> & Partial<InstancePerContext<T>>,
   ) {
@@ -362,4 +418,34 @@ export class InstanceWrapper<T = any> {
     });
     this.scope === Scope.TRANSIENT && (this.transientMap = new Map());
   }
+
+  private printIntrospectedAsRequestScoped() {
+    if (!this.isDebugMode() || this.name === 'REQUEST') {
+      return;
+    }
+    if (isString(this.name)) {
+      InstanceWrapper.logger.log(
+        `${clc.cyanBright(this.name)}${clc.green(
+          ' introspected as ',
+        )}${clc.magentaBright('request-scoped')}`,
+      );
+    }
+  }
+
+  private printIntrospectedAsDurable() {
+    if (!this.isDebugMode()) {
+      return;
+    }
+    if (isString(this.name)) {
+      InstanceWrapper.logger.log(
+        `${clc.cyanBright(this.name)}${clc.green(
+          ' introspected as ',
+        )}${clc.magentaBright('durable')}`,
+      );
+    }
+  }
+
+  private isDebugMode(): boolean {
+    return !!process.env.NEST_DEBUG;
+  }
 }
diff --git a/packages/core/injector/module-ref.ts b/packages/core/injector/module-ref.ts
index 22fe0f383..7051a7b34 100644
--- a/packages/core/injector/module-ref.ts
+++ b/packages/core/injector/module-ref.ts
@@ -2,6 +2,7 @@ import { IntrospectionResult, Scope, Type } from '@nestjs/common';
 import { InvalidClassScopeException } from '../errors/exceptions/invalid-class-scope.exception';
 import { UnknownElementException } from '../errors/exceptions/unknown-element.exception';
 import { getClassScope } from '../helpers/get-class-scope';
+import { isDurable } from '../helpers/is-durable';
 import { NestContainer } from './container';
 import { Injector } from './injector';
 import { InstanceLinksHost } from './instance-links-host';
@@ -107,6 +108,7 @@ export abstract class ModuleRef {
       metatype: type,
       isResolved: false,
       scope: getClassScope(type),
+      durable: isDurable(type),
       host: moduleRef,
     });
     return new Promise<T>(async (resolve, reject) => {
diff --git a/packages/core/injector/module-token-factory.ts b/packages/core/injector/module-token-factory.ts
index 8a81ddd47..65409ad09 100644
--- a/packages/core/injector/module-token-factory.ts
+++ b/packages/core/injector/module-token-factory.ts
@@ -1,6 +1,7 @@
 import { DynamicModule } from '@nestjs/common';
 import { Type } from '@nestjs/common/interfaces/type.interface';
 import { randomStringGenerator } from '@nestjs/common/utils/random-string-generator.util';
+import { isFunction, isSymbol } from '@nestjs/common/utils/shared.utils';
 import stringify from 'fast-safe-stringify';
 import * as hash from 'object-hash';
 
@@ -46,7 +47,7 @@ export class ModuleTokenFactory {
   }
 
   private replacer(key: string, value: any) {
-    if (typeof value === 'function') {
+    if (isFunction(value)) {
       const funcAsString = value.toString();
       const isClass = /^class\s/.test(funcAsString);
       if (isClass) {
@@ -54,7 +55,7 @@ export class ModuleTokenFactory {
       }
       return hash(funcAsString, { ignoreUnknown: true });
     }
-    if (typeof value === 'symbol') {
+    if (isSymbol(value)) {
       return value.toString();
     }
     return value;
diff --git a/packages/core/injector/module.ts b/packages/core/injector/module.ts
index ed3102a01..15b025d4a 100644
--- a/packages/core/injector/module.ts
+++ b/packages/core/injector/module.ts
@@ -1,11 +1,11 @@
 import {
-  Abstract,
   ClassProvider,
   Controller,
   DynamicModule,
   ExistingProvider,
   FactoryProvider,
   Injectable,
+  InjectionToken,
   NestModule,
   Provider,
   ValueProvider,
@@ -26,17 +26,17 @@ import { RuntimeException } from '../errors/exceptions/runtime.exception';
 import { UnknownExportException } from '../errors/exceptions/unknown-export.exception';
 import { createContextId } from '../helpers/context-id-factory';
 import { getClassScope } from '../helpers/get-class-scope';
+import { isDurable } from '../helpers/is-durable';
 import { CONTROLLER_ID_KEY } from './constants';
 import { NestContainer } from './container';
 import { InstanceWrapper } from './instance-wrapper';
 import { ModuleRef } from './module-ref';
 
-export type InstanceToken =
-  | string
-  | symbol
-  | Type<any>
-  | Abstract<any>
-  | Function;
+/**
+ * @note
+ * Left for backward compatibility
+ */
+export type InstanceToken = InjectionToken;
 
 export class Module {
   private readonly _id: string;
@@ -210,6 +210,7 @@ export class Module {
         instance: null,
         isResolved: false,
         scope: getClassScope(injectable),
+        durable: isDurable(injectable),
         host: this,
       });
       this._injectables.set(injectable, instanceWrapper);
@@ -234,6 +235,7 @@ export class Module {
         instance: null,
         isResolved: false,
         scope: getClassScope(provider),
+        durable: isDurable(provider),
         host: this,
       }),
     );
@@ -302,12 +304,15 @@ export class Module {
     provider: ClassProvider,
     collection: Map<InstanceToken, InstanceWrapper>,
   ) {
-    let { scope } = provider;
+    let { scope, durable } = provider;
 
     const { useClass } = provider;
     if (isUndefined(scope)) {
       scope = getClassScope(useClass);
     }
+    if (isUndefined(durable)) {
+      durable = isDurable(useClass);
+    }
     collection.set(
       provider.provide,
       new InstanceWrapper({
@@ -317,6 +322,7 @@ export class Module {
         instance: null,
         isResolved: false,
         scope,
+        durable,
         host: this,
       }),
     );
@@ -349,6 +355,7 @@ export class Module {
       useFactory: factory,
       inject,
       scope,
+      durable,
       provide: providerToken,
     } = provider;
 
@@ -362,6 +369,7 @@ export class Module {
         isResolved: false,
         inject: inject || [],
         scope,
+        durable,
         host: this,
       }),
     );
@@ -446,6 +454,7 @@ export class Module {
         instance: null,
         isResolved: false,
         scope: getClassScope(controller),
+        durable: isDurable(controller),
         host: this,
       }),
     );
diff --git a/packages/core/middleware/container.ts b/packages/core/middleware/container.ts
index 326fc9089..de8dc214b 100644
--- a/packages/core/middleware/container.ts
+++ b/packages/core/middleware/container.ts
@@ -1,6 +1,7 @@
-import { Scope, Type } from '@nestjs/common';
-import { SCOPE_OPTIONS_METADATA } from '@nestjs/common/constants';
+import { Type } from '@nestjs/common';
 import { MiddlewareConfiguration } from '@nestjs/common/interfaces/middleware/middleware-configuration.interface';
+import { getClassScope } from '../helpers/get-class-scope';
+import { isDurable } from '../helpers/is-durable';
 import { NestContainer } from '../injector/container';
 import { InstanceWrapper } from '../injector/instance-wrapper';
 import { InstanceToken } from '../injector/module';
@@ -44,7 +45,8 @@ export class MiddlewareContainer {
       middleware.set(
         token,
         new InstanceWrapper({
-          scope: this.getClassScope(metatype),
+          scope: getClassScope(metatype),
+          durable: isDurable(metatype),
           name: token,
           metatype,
           token,
@@ -66,9 +68,4 @@ export class MiddlewareContainer {
     }
     return this.configurationSets.get(moduleName);
   }
-
-  private getClassScope<T = unknown>(type: Type<T>): Scope {
-    const metadata = Reflect.getMetadata(SCOPE_OPTIONS_METADATA, type);
-    return metadata && metadata.scope;
-  }
 }
diff --git a/packages/core/middleware/middleware-module.ts b/packages/core/middleware/middleware-module.ts
index 748887811..ecb98e1b5 100644
--- a/packages/core/middleware/middleware-module.ts
+++ b/packages/core/middleware/middleware-module.ts
@@ -9,7 +9,6 @@ import {
   addLeadingSlash,
   isUndefined,
 } from '@nestjs/common/utils/shared.utils';
-import { isRouteExcluded, isRequestMethodAll } from '../router/utils';
 import { ApplicationConfig } from '../application-config';
 import { InvalidMiddlewareException } from '../errors/exceptions/invalid-middleware.exception';
 import { RuntimeException } from '../errors/exceptions/runtime.exception';
@@ -23,6 +22,7 @@ import { InstanceToken, Module } from '../injector/module';
 import { REQUEST_CONTEXT_ID } from '../router/request/request-constants';
 import { RouterExceptionFilters } from '../router/router-exception-filters';
 import { RouterProxy } from '../router/router-proxy';
+import { isRequestMethodAll, isRouteExcluded } from '../router/utils';
 import { MiddlewareBuilder } from './builder';
 import { MiddlewareContainer } from './container';
 import { MiddlewareResolver } from './resolver';
@@ -274,8 +274,9 @@ export class MiddlewareModule {
     const prefix = this.config.getGlobalPrefix();
     const excludedRoutes = this.config.getGlobalPrefixOptions().exclude;
     if (
-      Array.isArray(excludedRoutes) &&
-      isRouteExcluded(excludedRoutes, path, method)
+      (Array.isArray(excludedRoutes) &&
+        isRouteExcluded(excludedRoutes, path, method)) ||
+      ['*', '/*', '(.*)', '/(.*)'].includes(path)
     ) {
       path = addLeadingSlash(path);
     } else {
diff --git a/packages/core/middleware/utils.ts b/packages/core/middleware/utils.ts
index f0cdddf99..19418afc8 100644
--- a/packages/core/middleware/utils.ts
+++ b/packages/core/middleware/utils.ts
@@ -81,7 +81,7 @@ export function isMiddlewareClass(middleware: any): middleware is Type<any> {
   return (
     middlewareArr[0] === 'function' &&
     /[A-Z]/.test(middlewareArr[1]?.[0]) &&
-    typeof middleware.prototype?.use === 'function'
+    isFunction(middleware.prototype?.use)
   );
 }
 
diff --git a/packages/core/nest-application-context.ts b/packages/core/nest-application-context.ts
index cfd4e19b6..657bc68ee 100644
--- a/packages/core/nest-application-context.ts
+++ b/packages/core/nest-application-context.ts
@@ -35,6 +35,7 @@ export class NestApplicationContext implements INestApplicationContext {
   protected isInitialized = false;
   protected readonly injector = new Injector();
 
+  private shouldFlushLogsOnOverride = false;
   private readonly activeShutdownSignals = new Array<string>();
   private readonly moduleCompiler = new ModuleCompiler();
   private shutdownCleanupRef?: (...args: unknown[]) => unknown;
@@ -105,7 +106,7 @@ export class NestApplicationContext implements INestApplicationContext {
   }
 
   /**
-   * Initalizes the Nest application.
+   * Initializes the Nest application.
    * Calls the Nest lifecycle events.
    *
    * @returns {Promise<this>} The NestApplicationContext instance as Promise
@@ -131,12 +132,23 @@ export class NestApplicationContext implements INestApplicationContext {
 
   public useLogger(logger: LoggerService | LogLevel[] | false) {
     Logger.overrideLogger(logger);
+
+    if (this.shouldFlushLogsOnOverride) {
+      this.flushLogs();
+    }
   }
 
   public flushLogs() {
     Logger.flush();
   }
 
+  /**
+   * Define that it must flush logs right after defining a custom logger.
+   */
+  public flushLogsOnOverride() {
+    this.shouldFlushLogsOnOverride = true;
+  }
+
   /**
    * Enables the usage of shutdown hooks. Will call the
    * `onApplicationShutdown` function of a provider if the
@@ -312,6 +324,7 @@ export class NestApplicationContext implements INestApplicationContext {
       wrapperRef.host,
       collection,
       contextId,
+      wrapperRef,
     );
     if (!instance) {
       throw new UnknownElementException();
diff --git a/packages/core/nest-application.ts b/packages/core/nest-application.ts
index 2fac71560..ed7484c4d 100644
--- a/packages/core/nest-application.ts
+++ b/packages/core/nest-application.ts
@@ -121,8 +121,7 @@ export class NestApplication
       return undefined;
     }
     const passCustomOptions =
-      isObject(this.appOptions.cors) ||
-      typeof this.appOptions.cors === 'function';
+      isObject(this.appOptions.cors) || isFunction(this.appOptions.cors);
     if (!passCustomOptions) {
       return this.enableCors();
     }
@@ -179,7 +178,9 @@ export class NestApplication
   }
 
   public registerParserMiddleware() {
-    this.httpAdapter.registerParserMiddleware();
+    const prefix = this.config.getGlobalPrefix();
+    const rawBody = !!this.appOptions?.rawBody;
+    this.httpAdapter.registerParserMiddleware(prefix, rawBody);
   }
 
   public async registerRouter() {
@@ -235,13 +236,6 @@ export class NestApplication
     return this;
   }
 
-  public startAllMicroservicesAsync(): Promise<this> {
-    this.logger.warn(
-      'DEPRECATED! "startAllMicroservicesAsync" method is deprecated and will be removed in the next major release. Please, use "startAllMicroservices" instead.',
-    );
-    return this.startAllMicroservices();
-  }
-
   public use(...args: [any, any?]): this {
     this.httpAdapter.use(...args);
     return this;
@@ -300,13 +294,6 @@ export class NestApplication
     });
   }
 
-  public listenAsync(port: number | string, ...args: any[]): Promise<any> {
-    this.logger.warn(
-      'DEPRECATED! "listenAsync" method is deprecated and will be removed in the next major release. Please, use "listen" instead.',
-    );
-    return this.listen(port, ...(args as [any]));
-  }
-
   public async getUrl(): Promise<string> {
     return new Promise((resolve, reject) => {
       if (!this.isListening) {
@@ -319,13 +306,14 @@ export class NestApplication
   }
 
   private formatAddress(address: any): string {
-    if (typeof address === 'string') {
+    if (isString(address)) {
       if (platform() === 'win32') {
         return address;
       }
       const basePath = encodeURIComponent(address);
       return `${this.getProtocol()}+unix://${basePath}`;
     }
+
     let host = this.host();
     if (address && address.family === 'IPv6') {
       if (host === '::') {
@@ -410,7 +398,7 @@ export class NestApplication
   }
   private host(): string | undefined {
     const address = this.httpServer.address();
-    if (typeof address === 'string') {
+    if (isString(address)) {
       return undefined;
     }
     return address && address.address;
diff --git a/packages/core/nest-factory.ts b/packages/core/nest-factory.ts
index 702ee9146..617b11a97 100644
--- a/packages/core/nest-factory.ts
+++ b/packages/core/nest-factory.ts
@@ -142,6 +142,9 @@ export class NestFactoryStatic {
     const context = this.createNestInstance<NestApplicationContext>(
       new NestApplicationContext(container, [], root),
     );
+    if (this.autoFlushLogs) {
+      context.flushLogsOnOverride();
+    }
     return context.init();
   }
 
diff --git a/packages/core/package.json b/packages/core/package.json
index 0a82418a8..34aa43602 100644
--- a/packages/core/package.json
+++ b/packages/core/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/core",
-  "version": "8.2.3",
+  "version": "8.4.7",
   "description": "Nest - modern, fast, powerful node.js web framework (@core)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -30,13 +30,13 @@
     "@nuxtjs/opencollective": "0.3.2",
     "fast-safe-stringify": "2.1.1",
     "iterare": "1.2.1",
-    "object-hash": "2.2.0",
+    "object-hash": "3.0.0",
     "path-to-regexp": "3.2.0",
-    "tslib": "2.3.1",
+    "tslib": "2.4.0",
     "uuid": "8.3.2"
   },
   "devDependencies": {
-    "@nestjs/common": "8.2.3"
+    "@nestjs/common": "8.4.7"
   },
   "peerDependencies": {
     "@nestjs/common": "^8.0.0",
diff --git a/packages/core/repl/assign-to-object.util.ts b/packages/core/repl/assign-to-object.util.ts
new file mode 100644
index 000000000..16f937999
--- /dev/null
+++ b/packages/core/repl/assign-to-object.util.ts
@@ -0,0 +1,14 @@
+/**
+ * Similar to `Object.assign` but copying properties descriptors from `source`
+ * as well.
+ */
+export function assignToObject<T, U>(target: T, source: U): T & U {
+  Object.defineProperties(
+    target,
+    Object.keys(source).reduce((descriptors, key) => {
+      descriptors[key] = Object.getOwnPropertyDescriptor(source, key);
+      return descriptors;
+    }, Object.create(null)),
+  );
+  return target as T & U;
+}
diff --git a/packages/core/repl/constants.ts b/packages/core/repl/constants.ts
new file mode 100644
index 000000000..870e2ec51
--- /dev/null
+++ b/packages/core/repl/constants.ts
@@ -0,0 +1 @@
+export const REPL_INITIALIZED_MESSAGE = 'REPL initialized';
diff --git a/packages/core/repl/index.ts b/packages/core/repl/index.ts
new file mode 100644
index 000000000..8a399bd09
--- /dev/null
+++ b/packages/core/repl/index.ts
@@ -0,0 +1 @@
+export * from './repl';
diff --git a/packages/core/repl/native-functions/debug-repl-fn.ts b/packages/core/repl/native-functions/debug-repl-fn.ts
new file mode 100644
index 000000000..910941584
--- /dev/null
+++ b/packages/core/repl/native-functions/debug-repl-fn.ts
@@ -0,0 +1,62 @@
+import type { Type, InjectionToken } from '@nestjs/common';
+import { clc } from '@nestjs/common/utils/cli-colors.util';
+import { ReplFunction } from '../repl-function';
+import type { ModuleDebugEntry } from '../repl-context';
+import type { ReplFnDefinition } from '../repl.interfaces';
+
+export class DebugReplFn extends ReplFunction {
+  public fnDefinition: ReplFnDefinition = {
+    name: 'debug',
+    description:
+      'Print all registered modules as a list together with their controllers and providers. If the argument is passed in, for example, "debug(MyModule)" then it will only print components of this specific module.',
+    signature: '(moduleCls?: ClassRef | string) => void',
+  };
+
+  action(moduleCls?: Type<unknown> | string): void {
+    this.ctx.writeToStdout('\n');
+
+    if (moduleCls) {
+      const token =
+        typeof moduleCls === 'function' ? moduleCls.name : moduleCls;
+      const moduleEntry = this.ctx.debugRegistry[token];
+      if (!moduleEntry) {
+        return this.logger.error(
+          `"${token}" has not been found in the modules registry`,
+        );
+      }
+      this.printCtrlsAndProviders(token, moduleEntry);
+    } else {
+      Object.keys(this.ctx.debugRegistry).forEach(moduleKey => {
+        this.printCtrlsAndProviders(
+          moduleKey,
+          this.ctx.debugRegistry[moduleKey],
+        );
+      });
+    }
+    this.ctx.writeToStdout('\n');
+  }
+
+  private printCtrlsAndProviders(
+    moduleName: string,
+    moduleDebugEntry: ModuleDebugEntry,
+  ) {
+    this.ctx.writeToStdout(`${clc.green(moduleName)}:\n`);
+    this.printCollection('controllers', moduleDebugEntry['controllers']);
+    this.printCollection('providers', moduleDebugEntry['providers']);
+  }
+
+  private printCollection(
+    title: string,
+    collectionValue: Record<string, InjectionToken>,
+  ) {
+    const collectionEntries = Object.keys(collectionValue);
+    if (collectionEntries.length <= 0) {
+      return;
+    }
+
+    this.ctx.writeToStdout(` ${clc.yellow(`- ${title}`)}:\n`);
+    collectionEntries.forEach(provider =>
+      this.ctx.writeToStdout(`  ${clc.green('â—»')} ${provider}\n`),
+    );
+  }
+}
diff --git a/packages/core/repl/native-functions/get-relp-fn.ts b/packages/core/repl/native-functions/get-relp-fn.ts
new file mode 100644
index 000000000..6de276918
--- /dev/null
+++ b/packages/core/repl/native-functions/get-relp-fn.ts
@@ -0,0 +1,17 @@
+import type { Type } from '@nestjs/common';
+import { ReplFunction } from '../repl-function';
+import type { ReplFnDefinition } from '../repl.interfaces';
+
+export class GetReplFn extends ReplFunction {
+  public fnDefinition: ReplFnDefinition = {
+    name: 'get',
+    signature: '(token: InjectionToken) => any',
+    description:
+      'Retrieves an instance of either injectable or controller, otherwise, throws exception.',
+    aliases: ['$'],
+  };
+
+  action(token: string | symbol | Function | Type<any>): any {
+    return this.ctx.app.get(token);
+  }
+}
diff --git a/packages/core/repl/native-functions/help-repl-fn.ts b/packages/core/repl/native-functions/help-repl-fn.ts
new file mode 100644
index 000000000..913ced7ee
--- /dev/null
+++ b/packages/core/repl/native-functions/help-repl-fn.ts
@@ -0,0 +1,32 @@
+import { iterate } from 'iterare';
+import { clc } from '@nestjs/common/utils/cli-colors.util';
+import { ReplFunction } from '../repl-function';
+import type { ReplFnDefinition } from '../repl.interfaces';
+
+export class HelpReplFn extends ReplFunction {
+  public fnDefinition: ReplFnDefinition = {
+    name: 'help',
+    signature: '() => void',
+    description: 'Display all available REPL native functions.',
+  };
+
+  static buildHelpMessage = ({ name, description }: ReplFnDefinition) =>
+    clc.cyanBright(name) +
+    (description ? ` ${clc.bold('-')} ${description}` : '');
+
+  action(): void {
+    const sortedNativeFunctions = iterate(this.ctx.nativeFunctions)
+      .map(([, nativeFunction]) => nativeFunction.fnDefinition)
+      .toArray()
+      .sort((a, b) => (a.name < b.name ? -1 : 1));
+
+    this.ctx.writeToStdout(
+      `You can call ${clc.bold(
+        '.help',
+      )} on any function listed below (e.g.: ${clc.bold('help.help')}):\n\n` +
+        sortedNativeFunctions.map(HelpReplFn.buildHelpMessage).join('\n') +
+        // Without the following LF the last item won't be displayed
+        '\n',
+    );
+  }
+}
diff --git a/packages/core/repl/native-functions/index.ts b/packages/core/repl/native-functions/index.ts
new file mode 100644
index 000000000..8799e685d
--- /dev/null
+++ b/packages/core/repl/native-functions/index.ts
@@ -0,0 +1,6 @@
+export * from './help-repl-fn';
+export * from './get-relp-fn';
+export * from './resolve-repl-fn';
+export * from './select-relp-fn';
+export * from './debug-repl-fn';
+export * from './methods-repl-fn';
diff --git a/packages/core/repl/native-functions/methods-repl-fn.ts b/packages/core/repl/native-functions/methods-repl-fn.ts
new file mode 100644
index 000000000..b8deb83fc
--- /dev/null
+++ b/packages/core/repl/native-functions/methods-repl-fn.ts
@@ -0,0 +1,33 @@
+import type { Type } from '@nestjs/common';
+import { clc } from '@nestjs/common/utils/cli-colors.util';
+import { MetadataScanner } from '../../metadata-scanner';
+import { ReplFunction } from '../repl-function';
+import type { ReplFnDefinition } from '../repl.interfaces';
+
+export class MethodsReplFn extends ReplFunction {
+  public fnDefinition: ReplFnDefinition = {
+    name: 'methods',
+    description: 'Display all public methods available on a given provider or controller.',
+    signature: '(token: ClassRef | string) => void',
+  };
+
+  private readonly metadataScanner = new MetadataScanner();
+
+  action(token: Type<unknown> | string): void {
+    const proto =
+      typeof token !== 'function'
+        ? Object.getPrototypeOf(this.ctx.app.get(token))
+        : token?.prototype;
+
+    const methods = new Set(
+      this.metadataScanner.getAllFilteredMethodNames(proto),
+    );
+
+    this.ctx.writeToStdout('\n');
+    this.ctx.writeToStdout(`${clc.green('Methods')}:\n`);
+    methods.forEach(methodName =>
+      this.ctx.writeToStdout(` ${clc.yellow('â—»')} ${methodName}\n`),
+    );
+    this.ctx.writeToStdout('\n');
+  }
+}
diff --git a/packages/core/repl/native-functions/resolve-repl-fn.ts b/packages/core/repl/native-functions/resolve-repl-fn.ts
new file mode 100644
index 000000000..fe587682d
--- /dev/null
+++ b/packages/core/repl/native-functions/resolve-repl-fn.ts
@@ -0,0 +1,19 @@
+import type { Type } from '@nestjs/common';
+import { ReplFunction } from '../repl-function';
+import type { ReplFnDefinition } from '../repl.interfaces';
+
+export class ResolveReplFn extends ReplFunction {
+  public fnDefinition: ReplFnDefinition = {
+    name: 'resolve',
+    description:
+      'Resolves transient or request-scoped instance of either injectable or controller, otherwise, throws exception.',
+    signature: '(token: InjectionToken, contextId: any) => Promise<any>',
+  };
+
+  action(
+    token: string | symbol | Function | Type<any>,
+    contextId: any,
+  ): Promise<any> {
+    return this.ctx.app.resolve(token, contextId);
+  }
+}
diff --git a/packages/core/repl/native-functions/select-relp-fn.ts b/packages/core/repl/native-functions/select-relp-fn.ts
new file mode 100644
index 000000000..f35346cd1
--- /dev/null
+++ b/packages/core/repl/native-functions/select-relp-fn.ts
@@ -0,0 +1,20 @@
+import type {
+  DynamicModule,
+  INestApplicationContext,
+  Type,
+} from '@nestjs/common';
+import { ReplFunction } from '../repl-function';
+import type { ReplFnDefinition } from '../repl.interfaces';
+
+export class SelectReplFn extends ReplFunction {
+  public fnDefinition: ReplFnDefinition = {
+    name: 'select',
+    description:
+      'Allows navigating through the modules tree, for example, to pull out a specific instance from the selected module.',
+    signature: '(token: DynamicModule | ClassRef) => INestApplicationContext',
+  };
+
+  action(token: DynamicModule | Type<unknown>): INestApplicationContext {
+    return this.ctx.app.select(token);
+  }
+}
diff --git a/packages/core/repl/repl-context.ts b/packages/core/repl/repl-context.ts
new file mode 100644
index 000000000..7a8696cae
--- /dev/null
+++ b/packages/core/repl/repl-context.ts
@@ -0,0 +1,175 @@
+import { INestApplication, InjectionToken, Logger } from '@nestjs/common';
+import { ApplicationConfig } from '../application-config';
+import { ModuleRef, NestContainer } from '../injector';
+import { InternalCoreModule } from '../injector/internal-core-module';
+import { Module } from '../injector/module';
+import {
+  DebugReplFn,
+  GetReplFn,
+  HelpReplFn,
+  MethodsReplFn,
+  ResolveReplFn,
+  SelectReplFn,
+} from './native-functions';
+import { ReplFunction } from './repl-function';
+import type { ReplFunctionClass } from './repl.interfaces';
+
+type ModuleKey = string;
+export type ModuleDebugEntry = {
+  controllers: Record<string, InjectionToken>;
+  providers: Record<string, InjectionToken>;
+};
+
+type ReplScope = Record<string, any>;
+
+export class ReplContext {
+  public readonly logger = new Logger(ReplContext.name);
+  public debugRegistry: Record<ModuleKey, ModuleDebugEntry> = {};
+  public readonly globalScope: ReplScope = Object.create(null);
+  public readonly nativeFunctions = new Map<
+    string,
+    InstanceType<ReplFunctionClass>
+  >();
+  private readonly container: NestContainer;
+
+  constructor(
+    public readonly app: INestApplication,
+    nativeFunctionsClassRefs?: ReplFunctionClass[],
+  ) {
+    this.container = (app as any).container; // Using `any` because `app.container` is not public.
+
+    this.initializeContext();
+    this.initializeNativeFunctions(nativeFunctionsClassRefs || []);
+  }
+
+  public writeToStdout(text: string) {
+    process.stdout.write(text);
+  }
+
+  private initializeContext() {
+    const modules = this.container.getModules();
+
+    modules.forEach(moduleRef => {
+      let moduleName = moduleRef.metatype.name;
+      if (moduleName === InternalCoreModule.name) {
+        return;
+      }
+      if (this.globalScope[moduleName]) {
+        moduleName += ` (${moduleRef.token})`;
+      }
+
+      this.introspectCollection(moduleRef, moduleName, 'providers');
+      this.introspectCollection(moduleRef, moduleName, 'controllers');
+
+      // For in REPL auto-complete functionality
+      Object.defineProperty(this.globalScope, moduleName, {
+        value: moduleRef.metatype,
+        configurable: false,
+        enumerable: true,
+      });
+    });
+  }
+
+  private introspectCollection(
+    moduleRef: Module,
+    moduleKey: ModuleKey,
+    collection: keyof ModuleDebugEntry,
+  ) {
+    const moduleDebugEntry = {};
+    moduleRef[collection].forEach(({ token }) => {
+      const stringifiedToken = this.stringifyToken(token);
+      if (
+        stringifiedToken === ApplicationConfig.name ||
+        stringifiedToken === moduleRef.metatype.name ||
+        this.globalScope[stringifiedToken]
+      ) {
+        return;
+      }
+      // For in REPL auto-complete functionality
+      Object.defineProperty(this.globalScope, stringifiedToken, {
+        value: token,
+        configurable: false,
+        enumerable: true,
+      });
+
+      if (stringifiedToken === ModuleRef.name) {
+        return;
+      }
+      moduleDebugEntry[stringifiedToken] = token;
+    });
+
+    this.debugRegistry[moduleKey] = {
+      ...this.debugRegistry?.[moduleKey],
+      [collection]: moduleDebugEntry,
+    };
+  }
+
+  private stringifyToken(token: unknown): string {
+    return typeof token !== 'string'
+      ? typeof token === 'function'
+        ? token.name
+        : token?.toString()
+      : token;
+  }
+
+  private addNativeFunction(
+    NativeFunctionRef: ReplFunctionClass,
+  ): InstanceType<ReplFunctionClass> {
+    const nativeFunction = new NativeFunctionRef(this);
+
+    this.nativeFunctions.set(nativeFunction.fnDefinition.name, nativeFunction);
+
+    nativeFunction.fnDefinition.aliases?.forEach(aliaseName => {
+      const aliasNativeFunction: InstanceType<ReplFunctionClass> =
+        Object.create(nativeFunction);
+      aliasNativeFunction.fnDefinition = {
+        name: aliaseName,
+        description: aliasNativeFunction.fnDefinition.description,
+        signature: aliasNativeFunction.fnDefinition.signature,
+      };
+      this.nativeFunctions.set(aliaseName, aliasNativeFunction);
+    });
+
+    return nativeFunction;
+  }
+
+  private registerFunctionIntoGlobalScope(
+    nativeFunction: InstanceType<ReplFunctionClass>,
+  ) {
+    // Bind the method to REPL's context:
+    this.globalScope[nativeFunction.fnDefinition.name] =
+      nativeFunction.action.bind(nativeFunction);
+
+    // Load the help trigger as a `help` getter on each native function:
+    const functionBoundRef: ReplFunction['action'] =
+      this.globalScope[nativeFunction.fnDefinition.name];
+    Object.defineProperty(functionBoundRef, 'help', {
+      enumerable: false,
+      configurable: false,
+      get: () =>
+        // Dynamically builds the help message as will unlikely to be called
+        // several times.
+        this.writeToStdout(nativeFunction.makeHelpMessage()),
+    });
+  }
+
+  private initializeNativeFunctions(
+    nativeFunctionsClassRefs: ReplFunctionClass[],
+  ): void {
+    const builtInFunctionsClassRefs: ReplFunctionClass[] = [
+      HelpReplFn,
+      GetReplFn,
+      ResolveReplFn,
+      SelectReplFn,
+      DebugReplFn,
+      MethodsReplFn,
+    ];
+
+    builtInFunctionsClassRefs
+      .concat(nativeFunctionsClassRefs)
+      .forEach(NativeFunction => {
+        const nativeFunction = this.addNativeFunction(NativeFunction);
+        this.registerFunctionIntoGlobalScope(nativeFunction);
+      });
+  }
+}
diff --git a/packages/core/repl/repl-function.ts b/packages/core/repl/repl-function.ts
new file mode 100644
index 000000000..aa90972c8
--- /dev/null
+++ b/packages/core/repl/repl-function.ts
@@ -0,0 +1,36 @@
+import { Logger } from '@nestjs/common';
+import { clc } from '@nestjs/common/utils/cli-colors.util';
+import { ReplContext } from './repl-context';
+import type { ReplFnDefinition } from './repl.interfaces';
+
+export abstract class ReplFunction<
+  ActionParams extends Array<unknown> = Array<unknown>,
+  ActionReturn = any,
+> {
+  /** Metadata that describes the built-in function itself. */
+  public abstract fnDefinition: ReplFnDefinition;
+
+  protected readonly logger: Logger;
+
+  constructor(protected readonly ctx: ReplContext) {
+    this.logger = ctx.logger;
+  }
+
+  /**
+   * Method called when the function is invoked from the REPL by the user.
+   */
+  abstract action(...args: ActionParams): ActionReturn;
+
+  /**
+   * @returns A message displayed by calling `<fnName>.help`
+   */
+  public makeHelpMessage(): string {
+    const { description, name, signature } = this.fnDefinition;
+
+    const fnSignatureWithName = `${name}${signature}`;
+
+    return `${clc.yellow(description)}\n${clc.magentaBright(
+      'Interface:',
+    )} ${clc.bold(fnSignatureWithName)}\n`;
+  }
+}
diff --git a/packages/core/repl/repl-logger.ts b/packages/core/repl/repl-logger.ts
new file mode 100644
index 000000000..e6195269f
--- /dev/null
+++ b/packages/core/repl/repl-logger.ts
@@ -0,0 +1,19 @@
+import { ConsoleLogger } from '@nestjs/common';
+import { NestApplication } from '../nest-application';
+import { RouterExplorer } from '../router/router-explorer';
+import { RoutesResolver } from '../router/routes-resolver';
+
+export class ReplLogger extends ConsoleLogger {
+  private static readonly ignoredContexts = [
+    RoutesResolver.name,
+    RouterExplorer.name,
+    NestApplication.name,
+  ];
+  log(_message: any, context?: string) {
+    if (ReplLogger.ignoredContexts.includes(context)) {
+      return;
+    }
+    // eslint-disable-next-line
+    return super.log.apply(this, Array.from(arguments) as [any, string?]);
+  }
+}
diff --git a/packages/core/repl/repl.interfaces.ts b/packages/core/repl/repl.interfaces.ts
new file mode 100644
index 000000000..ad4b8fd64
--- /dev/null
+++ b/packages/core/repl/repl.interfaces.ts
@@ -0,0 +1,21 @@
+import type { ReplContext } from './repl-context';
+import type { ReplFunction } from './repl-function';
+
+export type ReplFnDefinition = {
+  /** Function's name. Note that this should be a valid JavaScript function name. */
+  name: string;
+
+  /** Alternative names to the function. */
+  aliases?: ReplFnDefinition['name'][];
+
+  /** Function's description to display when `<function>.help` is entered. */
+  description: string;
+
+  /**
+   * Function's signature following TypeScript _function type expression_ syntax.
+   * @example '(token: InjectionToken) => any'
+   */
+  signature: string;
+};
+
+export type ReplFunctionClass = new (replContext: ReplContext) => ReplFunction;
diff --git a/packages/core/repl/repl.ts b/packages/core/repl/repl.ts
new file mode 100644
index 000000000..079f16f1f
--- /dev/null
+++ b/packages/core/repl/repl.ts
@@ -0,0 +1,27 @@
+import { Logger, Type } from '@nestjs/common';
+import * as _repl from 'repl';
+import { clc } from '@nestjs/common/utils/cli-colors.util';
+import { NestFactory } from '../nest-factory';
+import { REPL_INITIALIZED_MESSAGE } from './constants';
+import { ReplContext } from './repl-context';
+import { ReplLogger } from './repl-logger';
+import { assignToObject } from './assign-to-object.util';
+
+export async function repl(module: Type) {
+  const app = await NestFactory.create(module, {
+    abortOnError: false,
+    logger: new ReplLogger(),
+  });
+  await app.init();
+
+  const replContext = new ReplContext(app);
+  Logger.log(REPL_INITIALIZED_MESSAGE);
+
+  const replServer = _repl.start({
+    prompt: clc.green('> '),
+    ignoreUndefined: true,
+  });
+  assignToObject(replServer.context, replContext.globalScope);
+
+  return replServer;
+}
diff --git a/packages/core/router/route-path-factory.ts b/packages/core/router/route-path-factory.ts
index e53a35b95..78b674161 100644
--- a/packages/core/router/route-path-factory.ts
+++ b/packages/core/router/route-path-factory.ts
@@ -23,18 +23,30 @@ export class RoutePathFactory {
   ): string[] {
     let paths = [''];
 
-    const version = this.getVersion(metadata);
-    if (version && metadata.versioningOptions?.type === VersioningType.URI) {
+    const versionOrVersions = this.getVersion(metadata);
+    if (
+      versionOrVersions &&
+      metadata.versioningOptions?.type === VersioningType.URI
+    ) {
       const versionPrefix = this.getVersionPrefix(metadata.versioningOptions);
 
-      // Version Neutral - Do not include version in URL
-      if (version !== VERSION_NEUTRAL) {
-        if (Array.isArray(version)) {
-          paths = flatten(
-            paths.map(path => version.map(v => path + `/${versionPrefix}${v}`)),
+      if (Array.isArray(versionOrVersions)) {
+        paths = flatten(
+          paths.map(path =>
+            versionOrVersions.map(version =>
+              // Version Neutral - Do not include version in URL
+              version === VERSION_NEUTRAL
+                ? path
+                : `${path}/${versionPrefix}${version}`,
+            ),
+          ),
+        );
+      } else {
+        // Version Neutral - Do not include version in URL
+        if (versionOrVersions !== VERSION_NEUTRAL) {
+          paths = paths.map(
+            path => `${path}/${versionPrefix}${versionOrVersions}`,
           );
-        } else {
-          paths = paths.map(path => path + `/${versionPrefix}${version}`);
         }
       }
     }
diff --git a/packages/core/router/router-execution-context.ts b/packages/core/router/router-execution-context.ts
index d2806f61c..97e514067 100644
--- a/packages/core/router/router-execution-context.ts
+++ b/packages/core/router/router-execution-context.ts
@@ -424,14 +424,14 @@ export class RouterExecutionContext {
         );
       };
     }
-    if (redirectResponse && typeof redirectResponse.url === 'string') {
+    if (redirectResponse && isString(redirectResponse.url)) {
       return async <TResult, TResponse>(result: TResult, res: TResponse) => {
         await this.responseController.redirect(result, res, redirectResponse);
       };
     }
     const isSseHandler = !!this.reflectSse(callback);
     if (isSseHandler) {
-      return async <
+      return <
         TResult extends Observable<unknown> = any,
         TResponse extends HeaderStream = any,
         TRequest extends IncomingMessage = any,
@@ -440,7 +440,7 @@ export class RouterExecutionContext {
         res: TResponse,
         req: TRequest,
       ) => {
-        await this.responseController.sse(
+        this.responseController.sse(
           result,
           (res as any).raw || res,
           (req as any).raw || req,
diff --git a/packages/core/router/router-explorer.ts b/packages/core/router/router-explorer.ts
index 153bf29b4..6dbbad0ae 100644
--- a/packages/core/router/router-explorer.ts
+++ b/packages/core/router/router-explorer.ts
@@ -332,80 +332,12 @@ export class RouterExplorer {
     routePathMetadata: RoutePathMetadata,
     handler: Function,
   ) {
-    const { versioningOptions } = routePathMetadata;
     const version = this.routePathFactory.getVersion(routePathMetadata);
-    if (router?.applyVersionFilter) {
-      return router.applyVersionFilter(handler, version, versioningOptions);
-    }
-    /**
-     * This can be removed in the next major release.
-     * Left for backward-compatibility.
-     */
-    return <TRequest extends Record<string, any> = any, TResponse = any>(
-      req: TRequest,
-      res: TResponse,
-      next: () => void,
-    ) => {
-      if (version === VERSION_NEUTRAL) {
-        return handler(req, res, next);
-      }
-      // URL Versioning is done via the path, so the filter continues forward
-      if (versioningOptions.type === VersioningType.URI) {
-        return handler(req, res, next);
-      }
-      // Media Type (Accept Header) Versioning Handler
-      if (versioningOptions.type === VersioningType.MEDIA_TYPE) {
-        const MEDIA_TYPE_HEADER = 'Accept';
-        const acceptHeaderValue: string | undefined =
-          req.headers?.[MEDIA_TYPE_HEADER] ||
-          req.headers?.[MEDIA_TYPE_HEADER.toLowerCase()];
-
-        const acceptHeaderVersionParameter = acceptHeaderValue
-          ? acceptHeaderValue.split(';')[1]
-          : '';
-
-        if (acceptHeaderVersionParameter) {
-          const headerVersion = acceptHeaderVersionParameter.split(
-            versioningOptions.key,
-          )[1];
-
-          if (Array.isArray(version)) {
-            if (version.includes(headerVersion)) {
-              return handler(req, res, next);
-            }
-          } else if (isString(version)) {
-            if (version === headerVersion) {
-              return handler(req, res, next);
-            }
-          }
-        }
-      }
-      // Header Versioning Handler
-      else if (versioningOptions.type === VersioningType.HEADER) {
-        const customHeaderVersionParameter: string | undefined =
-          req.headers?.[versioningOptions.header] ||
-          req.headers?.[versioningOptions.header.toLowerCase()];
-
-        if (customHeaderVersionParameter) {
-          if (Array.isArray(version)) {
-            if (version.includes(customHeaderVersionParameter)) {
-              return handler(req, res, next);
-            }
-          } else if (isString(version)) {
-            if (version === customHeaderVersionParameter) {
-              return handler(req, res, next);
-            }
-          }
-        }
-      }
-
-      if (!next) {
-        throw new InternalServerErrorException(
-          'HTTP adapter does not support filtering on version',
-        );
-      }
-      return next();
-    };
+    return router.applyVersionFilter(
+      handler,
+      version,
+      routePathMetadata.versioningOptions,
+    );
   }
 
   private createCallbackProxy(
diff --git a/packages/core/router/router-response-controller.ts b/packages/core/router/router-response-controller.ts
index 68f2ef052..4128e7fca 100644
--- a/packages/core/router/router-response-controller.ts
+++ b/packages/core/router/router-response-controller.ts
@@ -1,8 +1,14 @@
-import { HttpServer, HttpStatus, RequestMethod } from '@nestjs/common';
-import { isFunction, isObject } from '@nestjs/common/utils/shared.utils';
+import {
+  HttpServer,
+  HttpStatus,
+  Logger,
+  RequestMethod,
+  MessageEvent,
+} from '@nestjs/common';
+import { isObject } from '@nestjs/common/utils/shared.utils';
 import { IncomingMessage } from 'http';
-import { lastValueFrom, Observable } from 'rxjs';
-import { debounce } from 'rxjs/operators';
+import { EMPTY, lastValueFrom, Observable, isObservable } from 'rxjs';
+import { catchError, debounce, map } from 'rxjs/operators';
 import {
   AdditionalHeaders,
   WritableHeaderStream,
@@ -20,6 +26,8 @@ export interface RedirectResponse {
 }
 
 export class RouterResponseController {
+  private readonly logger = new Logger(RouterResponseController.name);
+
   constructor(private readonly applicationRef: HttpServer) {}
 
   public async apply<TInput = any, TResponse = any>(
@@ -56,7 +64,7 @@ export class RouterResponseController {
   }
 
   public async transformToResult(resultOrDeferred: any) {
-    if (resultOrDeferred && isFunction(resultOrDeferred.subscribe)) {
+    if (isObservable(resultOrDeferred)) {
       return lastValueFrom(resultOrDeferred);
     }
     return resultOrDeferred;
@@ -87,7 +95,7 @@ export class RouterResponseController {
     this.applicationRef.status(response, statusCode);
   }
 
-  public async sse<
+  public sse<
     TInput extends Observable<unknown> = any,
     TResponse extends WritableHeaderStream = any,
     TRequest extends IncomingMessage = any,
@@ -109,15 +117,29 @@ export class RouterResponseController {
 
     const subscription = result
       .pipe(
+        map((message): MessageEvent => {
+          if (isObject(message)) {
+            return message as MessageEvent;
+          }
+
+          return { data: message as object | string };
+        }),
         debounce(
-          (message: any) =>
-            new Promise(resolve => {
-              if (!isObject(message)) {
-                message = { data: message };
-              }
-              stream.writeMessage(message, resolve);
-            }),
+          message =>
+            new Promise<void>(resolve =>
+              stream.writeMessage(message, () => resolve()),
+            ),
         ),
+        catchError(err => {
+          const data = err instanceof Error ? err.message : err;
+          stream.writeMessage({ type: 'error', data }, writeError => {
+            if (writeError) {
+              this.logger.error(writeError);
+            }
+          });
+
+          return EMPTY;
+        }),
       )
       .subscribe({
         complete: () => {
@@ -130,8 +152,8 @@ export class RouterResponseController {
     });
   }
 
-  private assertObservable(result: any) {
-    if (!isFunction(result.subscribe)) {
+  private assertObservable(value: any) {
+    if (!isObservable(value)) {
       throw new ReferenceError(
         'You must return an Observable stream to use Server-Sent Events (SSE).',
       );
diff --git a/packages/core/router/routes-resolver.ts b/packages/core/router/routes-resolver.ts
index f342df916..034959ac3 100644
--- a/packages/core/router/routes-resolver.ts
+++ b/packages/core/router/routes-resolver.ts
@@ -174,7 +174,10 @@ export class RoutesResolver implements Resolver {
 
   public mapExternalException(err: any) {
     switch (true) {
-      case err instanceof SyntaxError:
+      // SyntaxError is thrown by Express body-parser when given invalid JSON (#422, #430)
+      // URIError is thrown by Express when given a path parameter with an invalid percentage
+      // encoding, e.g. '%FF' (#8915)
+      case err instanceof SyntaxError || err instanceof URIError:
         return new BadRequestException(err.message);
       default:
         return err;
diff --git a/packages/core/router/sse-stream.ts b/packages/core/router/sse-stream.ts
index 22327e6c8..3bf666c03 100644
--- a/packages/core/router/sse-stream.ts
+++ b/packages/core/router/sse-stream.ts
@@ -1,9 +1,10 @@
 import { MessageEvent } from '@nestjs/common/interfaces';
+import { isObject } from '@nestjs/common/utils/shared.utils';
 import { IncomingMessage, OutgoingHttpHeaders } from 'http';
 import { Transform } from 'stream';
 
 function toDataString(data: string | object): string {
-  if (typeof data === 'object') {
+  if (isObject(data)) {
     return toDataString(JSON.stringify(data));
   }
 
@@ -85,7 +86,7 @@ export class SseStream extends Transform {
       destination.flushHeaders();
     }
 
-    destination.write(':\n');
+    destination.write('\n');
     return super.pipe(destination, options);
   }
 
diff --git a/packages/core/router/utils/flatten-route-paths.util.ts b/packages/core/router/utils/flatten-route-paths.util.ts
index 40b843408..cbb411f25 100644
--- a/packages/core/router/utils/flatten-route-paths.util.ts
+++ b/packages/core/router/utils/flatten-route-paths.util.ts
@@ -1,4 +1,4 @@
-import { normalizePath } from '@nestjs/common/utils/shared.utils';
+import { normalizePath, isString } from '@nestjs/common/utils/shared.utils';
 import { Routes } from '../interfaces/routes.interface';
 
 export function flattenRoutePaths(routes: Routes) {
@@ -10,7 +10,7 @@ export function flattenRoutePaths(routes: Routes) {
     if (item.children) {
       const childrenRef = item.children as Routes;
       childrenRef.forEach(child => {
-        if (typeof child !== 'string' && child.path) {
+        if (!isString(child) && child.path) {
           child.path = normalizePath(
             normalizePath(item.path) + normalizePath(child.path),
           );
diff --git a/packages/core/scanner.ts b/packages/core/scanner.ts
index ef4ebecc8..1d9301860 100644
--- a/packages/core/scanner.ts
+++ b/packages/core/scanner.ts
@@ -1,13 +1,15 @@
 import {
-  Abstract,
   DynamicModule,
   flatten,
   ForwardReference,
   Provider,
 } from '@nestjs/common';
 import {
+  CATCH_WATERMARK,
+  CONTROLLER_WATERMARK,
   EXCEPTION_FILTERS_METADATA,
   GUARDS_METADATA,
+  INJECTABLE_WATERMARK,
   INTERCEPTORS_METADATA,
   MODULE_METADATA,
   PIPES_METADATA,
@@ -19,6 +21,7 @@ import {
   ExceptionFilter,
   ExistingProvider,
   FactoryProvider,
+  InjectionToken,
   NestInterceptor,
   PipeTransform,
   Scope,
@@ -37,6 +40,7 @@ import { iterate } from 'iterare';
 import { ApplicationConfig } from './application-config';
 import { APP_FILTER, APP_GUARD, APP_INTERCEPTOR, APP_PIPE } from './constants';
 import { CircularDependencyException } from './errors/exceptions/circular-dependency.exception';
+import { InvalidClassModuleException } from './errors/exceptions/invalid-class-module.exception';
 import { InvalidModuleException } from './errors/exceptions/invalid-module.exception';
 import { UndefinedModuleException } from './errors/exceptions/undefined-module.exception';
 import { getClassScope } from './helpers/get-class-scope';
@@ -49,7 +53,7 @@ import { MetadataScanner } from './metadata-scanner';
 interface ApplicationProviderWrapper {
   moduleKey: string;
   providerKey: string;
-  type: string | symbol | Type<any> | Abstract<any> | Function;
+  type: InjectionToken;
   scope?: Scope;
 }
 
@@ -96,13 +100,13 @@ export class DependenciesScanner {
       moduleDefinition as Type<any> | DynamicModule,
     )
       ? this.reflectMetadata(
-          moduleDefinition as Type<any>,
           MODULE_METADATA.IMPORTS,
+          moduleDefinition as Type<any>,
         )
       : [
           ...this.reflectMetadata(
-            (moduleDefinition as DynamicModule).module,
             MODULE_METADATA.IMPORTS,
+            (moduleDefinition as DynamicModule).module,
           ),
           ...((moduleDefinition as DynamicModule).imports || []),
         ];
@@ -133,13 +137,22 @@ export class DependenciesScanner {
   }
 
   public async insertModule(
-    module: any,
+    moduleDefinition: any,
     scope: Type<unknown>[],
   ): Promise<Module | undefined> {
-    if (module && module.forwardRef) {
-      return this.container.addModule(module.forwardRef(), scope);
+    const moduleToAdd = this.isForwardReference(moduleDefinition)
+      ? moduleDefinition.forwardRef()
+      : moduleDefinition;
+
+    if (
+      this.isInjectable(moduleToAdd) ||
+      this.isController(moduleToAdd) ||
+      this.isExceptionFilter(moduleToAdd)
+    ) {
+      throw new InvalidClassModuleException(moduleDefinition, scope);
     }
-    return this.container.addModule(module, scope);
+
+    return this.container.addModule(moduleToAdd, scope);
   }
 
   public async scanModulesForDependencies(
@@ -159,7 +172,7 @@ export class DependenciesScanner {
     context: string,
   ) {
     const modules = [
-      ...this.reflectMetadata(module, MODULE_METADATA.IMPORTS),
+      ...this.reflectMetadata(MODULE_METADATA.IMPORTS, module),
       ...this.container.getDynamicMetadataByToken(
         token,
         MODULE_METADATA.IMPORTS as 'imports',
@@ -172,7 +185,7 @@ export class DependenciesScanner {
 
   public reflectProviders(module: Type<any>, token: string) {
     const providers = [
-      ...this.reflectMetadata(module, MODULE_METADATA.PROVIDERS),
+      ...this.reflectMetadata(MODULE_METADATA.PROVIDERS, module),
       ...this.container.getDynamicMetadataByToken(
         token,
         MODULE_METADATA.PROVIDERS as 'providers',
@@ -186,7 +199,7 @@ export class DependenciesScanner {
 
   public reflectControllers(module: Type<any>, token: string) {
     const controllers = [
-      ...this.reflectMetadata(module, MODULE_METADATA.CONTROLLERS),
+      ...this.reflectMetadata(MODULE_METADATA.CONTROLLERS, module),
       ...this.container.getDynamicMetadataByToken(
         token,
         MODULE_METADATA.CONTROLLERS as 'controllers',
@@ -211,7 +224,7 @@ export class DependenciesScanner {
 
   public reflectExports(module: Type<unknown>, token: string) {
     const exports = [
-      ...this.reflectMetadata(module, MODULE_METADATA.EXPORTS),
+      ...this.reflectMetadata(MODULE_METADATA.EXPORTS, module),
       ...this.container.getDynamicMetadataByToken(
         token,
         MODULE_METADATA.EXPORTS as 'exports',
@@ -227,7 +240,7 @@ export class DependenciesScanner {
     token: string,
     metadataKey: string,
   ) {
-    const controllerInjectables = this.reflectMetadata(component, metadataKey);
+    const controllerInjectables = this.reflectMetadata(metadataKey, component);
     const methodsInjectables = this.metadataScanner.scanFromPrototype(
       null,
       component.prototype,
@@ -315,7 +328,7 @@ export class DependenciesScanner {
     if (isUndefined(related)) {
       throw new CircularDependencyException(context);
     }
-    if (related && related.forwardRef) {
+    if (this.isForwardReference(related)) {
       return this.container.addImport(related.forwardRef(), token);
     }
     await this.container.addImport(related, token);
@@ -398,7 +411,7 @@ export class DependenciesScanner {
     this.container.addController(controller, token);
   }
 
-  public reflectMetadata(metatype: Type<any>, metadataKey: string) {
+  public reflectMetadata(metadataKey: string, metatype: Type<any>) {
     return Reflect.getMetadata(metadataKey, metatype) || [];
   }
 
@@ -502,7 +515,31 @@ export class DependenciesScanner {
     return module && !!(module as DynamicModule).module;
   }
 
-  public isForwardReference(
+  /**
+   * @param metatype
+   * @returns `true` if `metatype` is annotated with the `@Injectable()` decorator.
+   */
+  private isInjectable(metatype: Type<any>): boolean {
+    return !!Reflect.getMetadata(INJECTABLE_WATERMARK, metatype);
+  }
+
+  /**
+   * @param metatype
+   * @returns `true` if `metatype` is annotated with the `@Controller()` decorator.
+   */
+  private isController(metatype: Type<any>): boolean {
+    return !!Reflect.getMetadata(CONTROLLER_WATERMARK, metatype);
+  }
+
+  /**
+   * @param metatype
+   * @returns `true` if `metatype` is annotated with the `@Catch()` decorator.
+   */
+  private isExceptionFilter(metatype: Type<any>): boolean {
+    return !!Reflect.getMetadata(CATCH_WATERMARK, metatype);
+  }
+
+  private isForwardReference(
     module: Type<any> | DynamicModule | ForwardReference,
   ): module is ForwardReference {
     return module && !!(module as ForwardReference).forwardRef;
diff --git a/packages/core/test/application-config.spec.ts b/packages/core/test/application-config.spec.ts
index b01828908..9418b13db 100644
--- a/packages/core/test/application-config.spec.ts
+++ b/packages/core/test/application-config.spec.ts
@@ -1,5 +1,8 @@
 import { RequestMethod } from '@nestjs/common';
-import { GlobalPrefixOptions } from '@nestjs/common/interfaces';
+import {
+  GlobalPrefixOptions,
+  VersioningOptions,
+} from '@nestjs/common/interfaces';
 import { expect } from 'chai';
 import { ApplicationConfig } from '../application-config';
 import { ExcludeRouteMetadata } from '../router/interfaces/exclude-route-metadata.interface';
@@ -130,6 +133,13 @@ describe('ApplicationConfig', () => {
       expect(appConfig.getVersioning()).to.be.eql(options);
     });
 
+    it('should ignore duplicated versions on defaultVersion array', () => {
+      const options = { type: 'test', defaultVersion: ['1', '2', '2', '1'] };
+      appConfig.enableVersioning(options as any);
+
+      expect(appConfig.getVersioning().defaultVersion).to.be.eql(['1', '2']);
+    });
+
     it('should have undefined as the versioning by default', () => {
       expect(appConfig.getVersioning()).to.be.eql(undefined);
     });
diff --git a/packages/core/test/exceptions/exceptions-handler.spec.ts b/packages/core/test/exceptions/exceptions-handler.spec.ts
index 3956c6edd..d74ef9a74 100644
--- a/packages/core/test/exceptions/exceptions-handler.spec.ts
+++ b/packages/core/test/exceptions/exceptions-handler.spec.ts
@@ -102,7 +102,12 @@ describe('ExceptionsHandler', () => {
       beforeEach(() => {
         sinon.stub(handler, 'invokeCustomFilters').returns(true);
       });
-      it('should not call status and json stubs', () => {
+      it('should do nothing', () => {
+        handler.next(
+          new Error(),
+          sinon.createStubInstance(ExecutionContextHost),
+        );
+
         expect(statusStub.notCalled).to.be.true;
         expect(jsonStub.notCalled).to.be.true;
       });
diff --git a/packages/core/test/injector/injector.spec.ts b/packages/core/test/injector/injector.spec.ts
index 8c7d54c2e..3a1068afc 100644
--- a/packages/core/test/injector/injector.spec.ts
+++ b/packages/core/test/injector/injector.spec.ts
@@ -1,3 +1,4 @@
+import { Optional } from '@nestjs/common';
 import * as chai from 'chai';
 import { expect } from 'chai';
 import * as chaiAsPromised from 'chai-as-promised';
@@ -803,4 +804,105 @@ describe('Injector', () => {
       expect(loadPropertiesMetadataSpy.called).to.be.true;
     });
   });
+
+  describe('getClassDependencies', () => {
+    it('should return an array that consists of deps and optional dep ids', async () => {
+      class FixtureDep1 {}
+      class FixtureDep2 {}
+
+      @Injectable()
+      class FixtureClass {
+        constructor(
+          private dep1: FixtureDep1,
+          @Optional() private dep2: FixtureDep2,
+        ) {}
+      }
+
+      const wrapper = new InstanceWrapper({ metatype: FixtureClass });
+      const [dependencies, optionalDependenciesIds] =
+        injector.getClassDependencies(wrapper);
+
+      expect(dependencies).to.deep.eq([FixtureDep1, FixtureDep2]);
+      expect(optionalDependenciesIds).to.deep.eq([1]);
+    });
+  });
+
+  describe('getFactoryProviderDependencies', () => {
+    it('should return an array that consists of deps and optional dep ids', async () => {
+      class FixtureDep1 {}
+      class FixtureDep2 {}
+
+      const wrapper = new InstanceWrapper({
+        inject: [
+          FixtureDep1,
+          { token: FixtureDep2, optional: true },
+          { token: FixtureDep2, optional: false },
+          {} as any,
+        ],
+      });
+      const [dependencies, optionalDependenciesIds] =
+        injector.getFactoryProviderDependencies(wrapper);
+
+      expect(dependencies).to.deep.eq([
+        FixtureDep1,
+        FixtureDep2,
+        FixtureDep2,
+        {},
+      ]);
+      expect(optionalDependenciesIds).to.deep.eq([1]);
+    });
+  });
+
+  describe('addDependencyMetadata', () => {
+    interface IInjector extends Omit<Injector, 'addDependencyMetadata'> {
+      addDependencyMetadata: (
+        keyOrIndex: symbol | string | number,
+        hostWrapper: InstanceWrapper,
+        instanceWrapper: InstanceWrapper,
+      ) => void;
+    }
+
+    let exposedInjector: IInjector;
+    let hostWrapper: InstanceWrapper;
+    let instanceWrapper: InstanceWrapper;
+
+    beforeEach(() => {
+      exposedInjector = injector as unknown as IInjector;
+      hostWrapper = new InstanceWrapper();
+      instanceWrapper = new InstanceWrapper();
+    });
+
+    it('should add dependency metadata to PropertiesMetadata when key is symbol', async () => {
+      const addPropertiesMetadataSpy = sinon.spy(
+        hostWrapper,
+        'addPropertiesMetadata',
+      );
+
+      const key = Symbol.for('symbol');
+      exposedInjector.addDependencyMetadata(key, hostWrapper, instanceWrapper);
+
+      expect(addPropertiesMetadataSpy.called).to.be.true;
+    });
+
+    it('should add dependency metadata to PropertiesMetadata when key is string', async () => {
+      const addPropertiesMetadataSpy = sinon.spy(
+        hostWrapper,
+        'addPropertiesMetadata',
+      );
+
+      const key = 'string';
+      exposedInjector.addDependencyMetadata(key, hostWrapper, instanceWrapper);
+
+      expect(addPropertiesMetadataSpy.called).to.be.true;
+    });
+
+    it('should add dependency metadata to CtorMetadata when key is number', async () => {
+      const addCtorMetadataSpy = sinon.spy(hostWrapper, 'addCtorMetadata');
+
+      const key = 0;
+      exposedInjector.addDependencyMetadata(key, hostWrapper, instanceWrapper);
+
+      expect(addCtorMetadataSpy.called).to.be.true;
+    });
+  });
 });
diff --git a/packages/core/test/injector/instance-wrapper.spec.ts b/packages/core/test/injector/instance-wrapper.spec.ts
index b94cf4e1d..6b0e1734c 100644
--- a/packages/core/test/injector/instance-wrapper.spec.ts
+++ b/packages/core/test/injector/instance-wrapper.spec.ts
@@ -106,6 +106,118 @@ describe('InstanceWrapper', () => {
     });
   });
 
+  describe('isDependencyTreeDurable', () => {
+    describe('when request scoped and durable', () => {
+      it('should return true', () => {
+        const wrapper = new InstanceWrapper({
+          scope: Scope.REQUEST,
+          durable: true,
+        });
+        expect(wrapper.isDependencyTreeDurable()).to.be.true;
+      });
+    });
+    describe('when statically scoped', () => {
+      describe('dependencies', () => {
+        describe('when each is static', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addCtorMetadata(0, new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when one is not static and non-durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addCtorMetadata(0, new InstanceWrapper());
+            wrapper.addCtorMetadata(
+              1,
+              new InstanceWrapper({
+                scope: Scope.REQUEST,
+              }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when one is not static and durable', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addCtorMetadata(0, new InstanceWrapper());
+            wrapper.addCtorMetadata(
+              1,
+              new InstanceWrapper({
+                scope: Scope.REQUEST,
+                durable: true,
+              }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
+      });
+      describe('properties', () => {
+        describe('when each is static', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addPropertiesMetadata('key1', new InstanceWrapper());
+            wrapper.addPropertiesMetadata('key2', new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when one is not static and non-durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addPropertiesMetadata(
+              'key1',
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            wrapper.addPropertiesMetadata('key2', new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when one is not static and durable', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addPropertiesMetadata(
+              'key1',
+              new InstanceWrapper({ scope: Scope.REQUEST, durable: true }),
+            );
+            wrapper.addPropertiesMetadata('key2', new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
+      });
+      describe('enhancers', () => {
+        describe('when each is static', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when one is not static and non-durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addEnhancerMetadata(
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when one is not static and durable', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addEnhancerMetadata(
+              new InstanceWrapper({ scope: Scope.REQUEST, durable: true }),
+            );
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
+      });
+    });
+  });
+
   describe('isNotMetatype', () => {
     describe('when metatype is nil', () => {
       it('should return true', () => {
diff --git a/packages/core/test/injector/module-token-factory.spec.ts b/packages/core/test/injector/module-token-factory.spec.ts
index ed78b734e..9f753773c 100644
--- a/packages/core/test/injector/module-token-factory.spec.ts
+++ b/packages/core/test/injector/module-token-factory.spec.ts
@@ -63,6 +63,18 @@ describe('ModuleTokenFactory', () => {
           '{"providers":["Provider"],"exports":["Provider"]}',
         );
       });
+      it('should return hash with value provider with non-class function', () => {
+        const provider = {
+          provide: 'ProvideValue',
+          useValue: function Provider() {},
+        };
+        const metadata = { providers: [provider] };
+        expect(factory.getDynamicMetadataToken(metadata)).to.be.eql(
+          `{"providers":[{"provide":"ProvideValue","useValue":"${hash(
+            provider.useValue.toString(),
+          )}"}]}`,
+        );
+      });
       it('should serialize symbols in a dynamic metadata object', () => {
         const metadata = {
           providers: [
diff --git a/packages/core/test/injector/module.spec.ts b/packages/core/test/injector/module.spec.ts
index 04581b726..9bddc5aa1 100644
--- a/packages/core/test/injector/module.spec.ts
+++ b/packages/core/test/injector/module.spec.ts
@@ -30,7 +30,7 @@ describe('Module', () => {
     const setSpy = sinon.spy(collection, 'set');
     (module as any)._controllers = collection;
 
-    @Controller({ scope: Scope.REQUEST })
+    @Controller({ scope: Scope.REQUEST, durable: true })
     class Test {}
 
     module.addController(Test);
@@ -43,6 +43,7 @@ describe('Module', () => {
           name: 'Test',
           scope: Scope.REQUEST,
           metatype: Test,
+          durable: true,
           instance: null,
           isResolved: false,
         }),
@@ -66,6 +67,7 @@ describe('Module', () => {
           scope: undefined,
           metatype: TestProvider,
           instance: null,
+          durable: undefined,
           isResolved: false,
         }),
       ),
@@ -96,6 +98,7 @@ describe('Module', () => {
           token: TestProvider,
           scope: undefined,
           metatype: TestProvider,
+          durable: undefined,
           instance: null,
           isResolved: false,
         }),
@@ -155,7 +158,7 @@ describe('Module', () => {
 
   describe('addCustomClass', () => {
     const type = { name: 'TypeTest' };
-    const provider = { provide: type, useClass: type };
+    const provider = { provide: type, useClass: type, durable: true };
     let setSpy;
 
     beforeEach(() => {
@@ -174,6 +177,7 @@ describe('Module', () => {
             name: provider.provide.name,
             scope: undefined,
             metatype: type as any,
+            durable: true,
             instance: null,
             isResolved: false,
           }),
@@ -216,7 +220,7 @@ describe('Module', () => {
   describe('addCustomFactory', () => {
     const type = { name: 'TypeTest' };
     const inject = [1, 2, 3];
-    const provider = { provide: type, useFactory: type, inject };
+    const provider = { provide: type, useFactory: type, inject, durable: true };
 
     let setSpy;
     beforeEach(() => {
@@ -236,6 +240,7 @@ describe('Module', () => {
             name: provider.provide.name,
             scope: undefined,
             metatype: type as any,
+            durable: true,
             instance: null,
             isResolved: false,
             inject: inject as any,
diff --git a/packages/core/test/nest-application-context.spec.ts b/packages/core/test/nest-application-context.spec.ts
new file mode 100644
index 000000000..10f9659c8
--- /dev/null
+++ b/packages/core/test/nest-application-context.spec.ts
@@ -0,0 +1,263 @@
+import { expect } from 'chai';
+import { InjectionToken, Logger, Scope } from '@nestjs/common';
+import { ContextIdFactory } from '../helpers/context-id-factory';
+import { InstanceLoader } from '../injector/instance-loader';
+import { NestContainer } from '../injector/container';
+import { NestApplicationContext } from '../nest-application-context';
+
+describe('NestApplicationContext', () => {
+  class A {}
+
+  async function testHelper(
+    injectionKey: InjectionToken,
+    scope: Scope,
+  ): Promise<NestApplicationContext> {
+    const nestContainer = new NestContainer();
+    const instanceLoader = new InstanceLoader(nestContainer);
+    const module = await nestContainer.addModule(class T {}, []);
+
+    nestContainer.addProvider(
+      {
+        provide: injectionKey,
+        useClass: A,
+        scope,
+      },
+      module.token,
+    );
+
+    nestContainer.addInjectable(
+      {
+        provide: injectionKey,
+        useClass: A,
+        scope,
+      },
+      module.token,
+    );
+
+    const modules = nestContainer.getModules();
+    await instanceLoader.createInstancesOfDependencies(modules);
+
+    const applicationContext = new NestApplicationContext(nestContainer, []);
+    return applicationContext;
+  }
+
+  describe('get', () => {
+    describe('when scope = DEFAULT', () => {
+      it('should get value with function injection key', async () => {
+        const key = A;
+        const applicationContext = await testHelper(key, Scope.DEFAULT);
+
+        const a1: A = await applicationContext.get(key);
+        const a2: A = await applicationContext.get(key);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).equal(a2);
+      });
+
+      it('should get value with string injection key', async () => {
+        const key = 'KEY_A';
+        const applicationContext = await testHelper(key, Scope.DEFAULT);
+
+        const a1: A = await applicationContext.get(key);
+        const a2: A = await applicationContext.get(key);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).equal(a2);
+      });
+
+      it('should get value with symbol injection key', async () => {
+        const key = Symbol('KEY_A');
+        const applicationContext = await testHelper(key, Scope.DEFAULT);
+
+        const a1: A = await applicationContext.get(key);
+        const a2: A = await applicationContext.get(key);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).equal(a2);
+      });
+    });
+
+    describe('when scope = REQUEST', () => {
+      it('should throw error when use function injection key', async () => {
+        const key = A;
+        const applicationContext = await testHelper(key, Scope.REQUEST);
+
+        expect(() => applicationContext.get(key)).to.be.throw;
+      });
+
+      it('should throw error when use string injection key', async () => {
+        const key = 'KEY_A';
+        const applicationContext = await testHelper(key, Scope.REQUEST);
+
+        expect(() => applicationContext.get(key)).to.be.throw;
+      });
+
+      it('should throw error when use symbol injection key', async () => {
+        const key = Symbol('KEY_A');
+        const applicationContext = await testHelper(key, Scope.REQUEST);
+
+        expect(() => applicationContext.get(key)).to.be.throw;
+      });
+    });
+
+    describe('when scope = TRANSIENT', () => {
+      it('should throw error when use function injection key', async () => {
+        const key = A;
+        const applicationContext = await testHelper(key, Scope.TRANSIENT);
+
+        expect(() => applicationContext.get(key)).to.be.throw;
+      });
+
+      it('should throw error when use string injection key', async () => {
+        const key = 'KEY_A';
+        const applicationContext = await testHelper(key, Scope.TRANSIENT);
+
+        expect(() => applicationContext.get(key)).to.be.throw;
+      });
+
+      it('should throw error when use symbol injection key', async () => {
+        const key = Symbol('KEY_A');
+        const applicationContext = await testHelper(key, Scope.TRANSIENT);
+
+        expect(() => applicationContext.get(key)).to.be.throw;
+      });
+    });
+  });
+
+  describe('resolve', () => {
+    describe('when scope = DEFAULT', () => {
+      it('should resolve value with function injection key', async () => {
+        const key = A;
+        const applicationContext = await testHelper(key, Scope.DEFAULT);
+
+        const a1: A = await applicationContext.resolve(key);
+        const a2: A = await applicationContext.resolve(key);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).equal(a2);
+      });
+
+      it('should resolve value with string injection key', async () => {
+        const key = 'KEY_A';
+        const applicationContext = await testHelper(key, Scope.DEFAULT);
+
+        const a1: A = await applicationContext.resolve(key);
+        const a2: A = await applicationContext.resolve(key);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).equal(a2);
+      });
+
+      it('should resolve value with symbol injection key', async () => {
+        const key = Symbol('KEY_A');
+        const applicationContext = await testHelper(key, Scope.DEFAULT);
+
+        const a1: A = await applicationContext.resolve(key);
+        const a2: A = await applicationContext.resolve(key);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).equal(a2);
+      });
+    });
+
+    describe('when scope = REQUEST', () => {
+      it('should resolve value with function injection key', async () => {
+        const key = A;
+        const applicationContext = await testHelper(key, Scope.REQUEST);
+
+        const contextId = ContextIdFactory.create();
+        const a1: A = await applicationContext.resolve(key);
+        const a2: A = await applicationContext.resolve(key, contextId);
+        const a3: A = await applicationContext.resolve(key, contextId);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).not.equal(a2);
+        expect(a2).equal(a3);
+      });
+
+      it('should resolve value with string injection key', async () => {
+        const key = 'KEY_A';
+        const applicationContext = await testHelper(key, Scope.REQUEST);
+
+        const contextId = ContextIdFactory.create();
+        const a1: A = await applicationContext.resolve(key);
+        const a2: A = await applicationContext.resolve(key, contextId);
+        const a3: A = await applicationContext.resolve(key, contextId);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).not.equal(a2);
+        expect(a2).equal(a3);
+      });
+
+      it('should resolve value with symbol injection key', async () => {
+        const key = Symbol('KEY_A');
+        const applicationContext = await testHelper(key, Scope.REQUEST);
+
+        const contextId = ContextIdFactory.create();
+        const a1: A = await applicationContext.resolve(key);
+        const a2: A = await applicationContext.resolve(key, contextId);
+        const a3: A = await applicationContext.resolve(key, contextId);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).not.equal(a2);
+        expect(a2).equal(a3);
+      });
+    });
+
+    describe('when scope = TRANSIENT', () => {
+      it('should resolve value with function injection key', async () => {
+        const key = A;
+        const applicationContext = await testHelper(key, Scope.TRANSIENT);
+
+        const contextId = ContextIdFactory.create();
+        const a1: A = await applicationContext.resolve(key);
+        const a2: A = await applicationContext.resolve(key, contextId);
+        const a3: A = await applicationContext.resolve(key, contextId);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).not.equal(a2);
+        expect(a2).equal(a3);
+      });
+
+      it('should resolve value with string injection key', async () => {
+        const key = 'KEY_A';
+        const applicationContext = await testHelper(key, Scope.TRANSIENT);
+
+        const contextId = ContextIdFactory.create();
+        const a1: A = await applicationContext.resolve(key);
+        const a2: A = await applicationContext.resolve(key, contextId);
+        const a3: A = await applicationContext.resolve(key, contextId);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).not.equal(a2);
+        expect(a2).equal(a3);
+      });
+
+      it('should resolve value with symbol injection key', async () => {
+        const key = Symbol('KEY_A');
+        const applicationContext = await testHelper(key, Scope.TRANSIENT);
+
+        const contextId = ContextIdFactory.create();
+        const a1: A = await applicationContext.resolve(key);
+        const a2: A = await applicationContext.resolve(key, contextId);
+        const a3: A = await applicationContext.resolve(key, contextId);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).not.equal(a2);
+        expect(a2).equal(a3);
+      });
+    });
+  });
+});
diff --git a/packages/core/test/repl/assign-to-object.util.spec.ts b/packages/core/test/repl/assign-to-object.util.spec.ts
new file mode 100644
index 000000000..812343aef
--- /dev/null
+++ b/packages/core/test/repl/assign-to-object.util.spec.ts
@@ -0,0 +1,36 @@
+import { expect } from 'chai';
+import { assignToObject } from '@nestjs/core/repl/assign-to-object.util';
+
+describe('assignToObject', () => {
+  it('should copy all enumerable properties and their descriptors', () => {
+    const sourceObj = {};
+    Object.defineProperty(sourceObj, 'foo', {
+      value: 123,
+      configurable: true,
+      enumerable: true,
+      writable: true,
+    });
+    Object.defineProperty(sourceObj, 'bar', {
+      value: 456,
+      configurable: true,
+      enumerable: true,
+      writable: false,
+    });
+    const targetObj = {};
+
+    assignToObject(targetObj, sourceObj);
+
+    expect(Object.getOwnPropertyDescriptor(targetObj, 'foo')).to.be.eql({
+      value: 123,
+      configurable: true,
+      enumerable: true,
+      writable: true,
+    });
+    expect(Object.getOwnPropertyDescriptor(targetObj, 'bar')).to.be.eql({
+      value: 456,
+      configurable: true,
+      enumerable: true,
+      writable: false,
+    });
+  });
+});
diff --git a/packages/core/test/repl/native-functions/debug-repl-fn.spec.ts b/packages/core/test/repl/native-functions/debug-repl-fn.spec.ts
new file mode 100644
index 000000000..e7ddc4a04
--- /dev/null
+++ b/packages/core/test/repl/native-functions/debug-repl-fn.spec.ts
@@ -0,0 +1,122 @@
+import { expect } from 'chai';
+import * as sinon from 'sinon';
+import { clc } from '@nestjs/common/utils/cli-colors.util';
+import { DebugReplFn } from '../../../repl/native-functions';
+import { ReplContext } from '../../../repl/repl-context';
+import { NestContainer } from '../../../injector/container';
+
+describe('DebugReplFn', () => {
+  let debugReplFn: DebugReplFn;
+
+  let replContext: ReplContext;
+  let mockApp: {
+    container: NestContainer;
+    get: sinon.SinonStub;
+    resolve: sinon.SinonSpy;
+    select: sinon.SinonSpy;
+  };
+
+  before(async () => {
+    const container = new NestContainer();
+    const aModuleRef = await container.addModule(class ModuleA {}, []);
+    const bModuleRef = await container.addModule(class ModuleB {}, []);
+
+    container.addController(class ControllerA {}, aModuleRef.token);
+    container.addProvider(class ProviderA1 {}, aModuleRef.token);
+    container.addProvider(class ProviderA2 {}, aModuleRef.token);
+
+    container.addProvider(class ProviderB1 {}, bModuleRef.token);
+    container.addProvider(class ProviderB2 {}, bModuleRef.token);
+
+    mockApp = {
+      container,
+      get: sinon.stub(),
+      resolve: sinon.spy(),
+      select: sinon.spy(),
+    };
+    replContext = new ReplContext(mockApp as any);
+  });
+
+  beforeEach(() => {
+    debugReplFn = replContext.nativeFunctions.get('debug') as DebugReplFn;
+
+    // To avoid coloring the output:
+    sinon.stub(clc, 'yellow').callsFake(text => text);
+    sinon.stub(clc, 'green').callsFake(text => text);
+  });
+  afterEach(() => sinon.restore());
+
+  it('the function name should be "debug"', () => {
+    expect(debugReplFn).to.not.be.undefined;
+    expect(debugReplFn.fnDefinition.name).to.eql('debug');
+  });
+
+  describe('action', () => {
+    it('should print all modules along with their controllers and providers', () => {
+      let outputText = '';
+
+      sinon
+        .stub(replContext, 'writeToStdout')
+        .callsFake(text => (outputText += text));
+
+      debugReplFn.action();
+
+      expect(outputText).to.equal(`
+ModuleA:
+ - controllers:
+  â—» ControllerA
+ - providers:
+  â—» ProviderA1
+  â—» ProviderA2
+ModuleB:
+ - providers:
+  â—» ProviderB1
+  â—» ProviderB2
+
+`);
+    });
+
+    describe('when module passed as a class reference', () => {
+      it("should print a specified module's controllers and providers", () => {
+        let outputText = '';
+
+        sinon
+          .stub(replContext, 'writeToStdout')
+          .callsFake(text => (outputText += text));
+
+        debugReplFn.action(class ModuleA {});
+
+        expect(outputText).to.equal(`
+ModuleA:
+ - controllers:
+  â—» ControllerA
+ - providers:
+  â—» ProviderA1
+  â—» ProviderA2
+
+`);
+      });
+    });
+    describe("when module passed as a string (module's key)", () => {
+      it("should print a specified module's controllers and providers", () => {
+        let outputText = '';
+
+        sinon
+          .stub(replContext, 'writeToStdout')
+          .callsFake(text => (outputText += text));
+
+        debugReplFn.action('ModuleA');
+
+        expect(outputText).to.equal(`
+ModuleA:
+ - controllers:
+  â—» ControllerA
+ - providers:
+  â—» ProviderA1
+  â—» ProviderA2
+
+`);
+      });
+    });
+  });
+});
diff --git a/packages/core/test/repl/native-functions/get-repl-fn.spec.ts b/packages/core/test/repl/native-functions/get-repl-fn.spec.ts
new file mode 100644
index 000000000..aec8f335f
--- /dev/null
+++ b/packages/core/test/repl/native-functions/get-repl-fn.spec.ts
@@ -0,0 +1,47 @@
+import { expect } from 'chai';
+import * as sinon from 'sinon';
+import { GetReplFn } from '../../../repl/native-functions';
+import { ReplContext } from '../../../repl/repl-context';
+import { NestContainer } from '../../../injector/container';
+
+describe('GetReplFn', () => {
+  let getReplFn: GetReplFn;
+
+  let replContext: ReplContext;
+  let mockApp: {
+    container: NestContainer;
+    get: sinon.SinonStub;
+    resolve: sinon.SinonSpy;
+    select: sinon.SinonSpy;
+  };
+
+  before(async () => {
+    const container = new NestContainer();
+
+    mockApp = {
+      container,
+      get: sinon.stub(),
+      resolve: sinon.spy(),
+      select: sinon.spy(),
+    };
+    replContext = new ReplContext(mockApp as any);
+  });
+
+  beforeEach(() => {
+    getReplFn = replContext.nativeFunctions.get('get') as GetReplFn;
+  });
+  afterEach(() => sinon.restore());
+
+  it('the function name should be "get"', () => {
+    expect(getReplFn).to.not.be.undefined;
+    expect(getReplFn.fnDefinition.name).to.eql('get');
+  });
+
+  describe('action', () => {
+    it('should pass arguments down to the application context', () => {
+      const token = 'test';
+      getReplFn.action(token);
+      expect(mockApp.get.calledWith(token)).to.be.true;
+    });
+  });
+});
diff --git a/packages/core/test/repl/native-functions/help-repl-fn.spec.ts b/packages/core/test/repl/native-functions/help-repl-fn.spec.ts
new file mode 100644
index 000000000..441d14c43
--- /dev/null
+++ b/packages/core/test/repl/native-functions/help-repl-fn.spec.ts
@@ -0,0 +1,67 @@
+import { expect } from 'chai';
+import * as sinon from 'sinon';
+import { clc } from '@nestjs/common/utils/cli-colors.util';
+import { HelpReplFn } from '../../../repl/native-functions';
+import { ReplContext } from '../../../repl/repl-context';
+import { NestContainer } from '../../../injector/container';
+
+describe('HelpReplFn', () => {
+  let helpReplFn: HelpReplFn;
+
+  let replContext: ReplContext;
+  let mockApp: {
+    container: NestContainer;
+    get: sinon.SinonStub;
+    resolve: sinon.SinonSpy;
+    select: sinon.SinonSpy;
+  };
+
+  before(async () => {
+    const container = new NestContainer();
+
+    mockApp = {
+      container,
+      get: sinon.stub(),
+      resolve: sinon.spy(),
+      select: sinon.spy(),
+    };
+    replContext = new ReplContext(mockApp as any);
+  });
+
+  beforeEach(() => {
+    helpReplFn = replContext.nativeFunctions.get('help') as HelpReplFn;
+
+    // To avoid coloring the output:
+    sinon.stub(clc, 'bold').callsFake(text => text);
+    sinon.stub(clc, 'cyanBright').callsFake(text => text);
+  });
+  afterEach(() => sinon.restore());
+
+  it('the function name should be "help"', () => {
+    expect(helpReplFn).to.not.be.undefined;
+    expect(helpReplFn.fnDefinition.name).to.eql('help');
+  });
+
+  describe('action', () => {
+    it('should print all available native functions and their description', () => {
+      let outputText = '';
+      sinon
+        .stub(replContext, 'writeToStdout')
+        .callsFake(text => (outputText += text));
+
+      helpReplFn.action();
+
+      expect(outputText).to
+        .equal(`You can call .help on any function listed below (e.g.: help.help):
+
+$ - Retrieves an instance of either injectable or controller, otherwise, throws exception.
+debug - Print all registered modules as a list together with their controllers and providers. If the argument is passed in, for example, "debug(MyModule)" then it will only print components of this specific module.
+get - Retrieves an instance of either injectable or controller, otherwise, throws exception.
+help - Display all available REPL native functions.
+methods - Display all public methods available on a given provider or controller.
+resolve - Resolves transient or request-scoped instance of either injectable or controller, otherwise, throws exception.
+select - Allows navigating through the modules tree, for example, to pull out a specific instance from the selected module.
+`);
+    });
+  });
+});
diff --git a/packages/core/test/repl/native-functions/methods-repl-fn.spec.ts b/packages/core/test/repl/native-functions/methods-repl-fn.spec.ts
new file mode 100644
index 000000000..a45f5c255
--- /dev/null
+++ b/packages/core/test/repl/native-functions/methods-repl-fn.spec.ts
@@ -0,0 +1,108 @@
+import { expect } from 'chai';
+import * as sinon from 'sinon';
+import { clc } from '@nestjs/common/utils/cli-colors.util';
+import { MethodsReplFn } from '../../../repl/native-functions';
+import { ReplContext } from '../../../repl/repl-context';
+import { NestContainer } from '../../../injector/container';
+
+describe('MethodsReplFn', () => {
+  let methodsReplFn: MethodsReplFn;
+
+  let replContext: ReplContext;
+  let mockApp: {
+    container: NestContainer;
+    get: sinon.SinonStub;
+    resolve: sinon.SinonSpy;
+    select: sinon.SinonSpy;
+  };
+
+  before(async () => {
+    const container = new NestContainer();
+    const aModuleRef = await container.addModule(class ModuleA {}, []);
+    const bModuleRef = await container.addModule(class ModuleB {}, []);
+
+    container.addController(class ControllerA {}, aModuleRef.token);
+    container.addProvider(class ProviderA1 {}, aModuleRef.token);
+    container.addProvider(class ProviderA2 {}, aModuleRef.token);
+
+    container.addProvider(class ProviderB1 {}, bModuleRef.token);
+    container.addProvider(class ProviderB2 {}, bModuleRef.token);
+
+    mockApp = {
+      container,
+      get: sinon.stub(),
+      resolve: sinon.spy(),
+      select: sinon.spy(),
+    };
+    replContext = new ReplContext(mockApp as any);
+  });
+
+  beforeEach(() => {
+    methodsReplFn = replContext.nativeFunctions.get('methods') as MethodsReplFn;
+
+    // To avoid coloring the output:
+    sinon.stub(clc, 'yellow').callsFake(text => text);
+    sinon.stub(clc, 'green').callsFake(text => text);
+  });
+  afterEach(() => sinon.restore());
+
+  it('the function name should be "methods"', () => {
+    expect(methodsReplFn).to.not.be.undefined;
+    expect(methodsReplFn.fnDefinition.name).to.eql('methods');
+  });
+
+  describe('action', () => {
+    describe('when token is a class reference', () => {
+      it('should print all class methods', () => {
+        class BaseService {
+          create() {}
+        }
+        class TestService extends BaseService {
+          findAll() {}
+          findOne() {}
+        }
+
+        let outputText = '';
+
+        sinon
+          .stub(replContext, 'writeToStdout')
+          .callsFake(text => (outputText += text));
+
+        methodsReplFn.action(TestService);
+
+        expect(outputText).to.equal(`
+Methods:
+ â—» findAll
+ â—» findOne
+ â—» create
+
+`);
+      });
+    });
+
+    describe('when token is a string', () => {
+      it('should grab provider from the container and print its all methods', () => {
+        class ProviderA1 {
+          findAll() {}
+          findOne() {}
+        }
+        let outputText = '';
+
+        sinon
+          .stub(replContext, 'writeToStdout')
+          .callsFake(text => (outputText += text));
+
+        mockApp.get.callsFake(() => new ProviderA1());
+
+        methodsReplFn.action('ProviderA1');
+
+        expect(outputText).to.equal(`
+Methods:
+ â—» findAll
+ â—» findOne
+
+`);
+      });
+    });
+  });
+});
diff --git a/packages/core/test/repl/native-functions/resolve-repl-fn.spec.ts b/packages/core/test/repl/native-functions/resolve-repl-fn.spec.ts
new file mode 100644
index 000000000..cf78bbd40
--- /dev/null
+++ b/packages/core/test/repl/native-functions/resolve-repl-fn.spec.ts
@@ -0,0 +1,49 @@
+import { expect } from 'chai';
+import * as sinon from 'sinon';
+import { ResolveReplFn } from '../../../repl/native-functions';
+import { ReplContext } from '../../../repl/repl-context';
+import { NestContainer } from '../../../injector/container';
+
+describe('ResolveReplFn', () => {
+  let resolveReplFn: ResolveReplFn;
+
+  let replContext: ReplContext;
+  let mockApp: {
+    container: NestContainer;
+    get: sinon.SinonStub;
+    resolve: sinon.SinonSpy;
+    select: sinon.SinonSpy;
+  };
+
+  before(async () => {
+    const container = new NestContainer();
+
+    mockApp = {
+      container,
+      get: sinon.stub(),
+      resolve: sinon.spy(),
+      select: sinon.spy(),
+    };
+    replContext = new ReplContext(mockApp as any);
+  });
+
+  beforeEach(() => {
+    resolveReplFn = replContext.nativeFunctions.get('resolve') as ResolveReplFn;
+  });
+  afterEach(() => sinon.restore());
+
+  it('the function name should be "resolve"', () => {
+    expect(resolveReplFn).to.not.be.undefined;
+    expect(resolveReplFn.fnDefinition.name).to.eql('resolve');
+  });
+
+  describe('action', () => {
+    it('should pass arguments down to the application context', async () => {
+      const token = 'test';
+      const contextId = {};
+
+      await resolveReplFn.action(token, contextId);
+      expect(mockApp.resolve.calledWith(token, contextId)).to.be.true;
+    });
+  });
+});
diff --git a/packages/core/test/repl/native-functions/select-repl-fn.spec.ts b/packages/core/test/repl/native-functions/select-repl-fn.spec.ts
new file mode 100644
index 000000000..22a033e54
--- /dev/null
+++ b/packages/core/test/repl/native-functions/select-repl-fn.spec.ts
@@ -0,0 +1,47 @@
+import { expect } from 'chai';
+import * as sinon from 'sinon';
+import { SelectReplFn } from '../../../repl/native-functions';
+import { ReplContext } from '../../../repl/repl-context';
+import { NestContainer } from '../../../injector/container';
+
+describe('SelectReplFn', () => {
+  let selectReplFn: SelectReplFn;
+
+  let replContext: ReplContext;
+  let mockApp: {
+    container: NestContainer;
+    get: sinon.SinonStub;
+    resolve: sinon.SinonSpy;
+    select: sinon.SinonSpy;
+  };
+
+  before(async () => {
+    const container = new NestContainer();
+
+    mockApp = {
+      container,
+      get: sinon.stub(),
+      resolve: sinon.spy(),
+      select: sinon.spy(),
+    };
+    replContext = new ReplContext(mockApp as any);
+  });
+
+  beforeEach(() => {
+    selectReplFn = replContext.nativeFunctions.get('select') as SelectReplFn;
+  });
+  afterEach(() => sinon.restore());
+
+  it('the function name should be "select"', () => {
+    expect(selectReplFn).to.not.be.undefined;
+    expect(selectReplFn.fnDefinition.name).to.eql('select');
+  });
+
+  describe('action', () => {
+    it('should pass arguments down to the application context', () => {
+      const moduleCls = class TestModule {};
+      selectReplFn.action(moduleCls);
+      expect(mockApp.select.calledWith(moduleCls)).to.be.true;
+    });
+  });
+});
diff --git a/packages/core/test/repl/repl-context.spec.ts b/packages/core/test/repl/repl-context.spec.ts
new file mode 100644
index 000000000..9654dfce5
--- /dev/null
+++ b/packages/core/test/repl/repl-context.spec.ts
@@ -0,0 +1,38 @@
+import { expect } from 'chai';
+import * as sinon from 'sinon';
+import { NestContainer } from '../../injector/container';
+import { ReplContext } from '../../repl/repl-context';
+
+describe('ReplContext', () => {
+  let replContext: ReplContext;
+  let mockApp: {
+    container: NestContainer;
+    get: sinon.SinonStub;
+    resolve: sinon.SinonSpy;
+    select: sinon.SinonSpy;
+  };
+
+  before(async () => {
+    const container = new NestContainer();
+
+    mockApp = {
+      container,
+      get: sinon.stub(),
+      resolve: sinon.spy(),
+      select: sinon.spy(),
+    };
+    replContext = new ReplContext(mockApp as any);
+  });
+
+  afterEach(() => sinon.restore());
+
+  it('writeToStdout', () => {
+    const stdOutWrite = sinon.stub(process.stdout, 'write');
+    const text = sinon.stub() as unknown as string;
+
+    replContext.writeToStdout(text);
+
+    expect(stdOutWrite.calledOnce).to.be.true;
+    expect(stdOutWrite.calledWith(text)).to.be.true;
+  });
+});
diff --git a/packages/core/test/router/route-path-factory.spec.ts b/packages/core/test/router/route-path-factory.spec.ts
index c956eb367..84b9275a7 100644
--- a/packages/core/test/router/route-path-factory.spec.ts
+++ b/packages/core/test/router/route-path-factory.spec.ts
@@ -1,4 +1,4 @@
-import { RequestMethod, VersioningType } from '@nestjs/common';
+import { RequestMethod, VersioningType, VERSION_NEUTRAL } from '@nestjs/common';
 import { expect } from 'chai';
 import * as pathToRegexp from 'path-to-regexp';
 import * as sinon from 'sinon';
@@ -180,6 +180,32 @@ describe('RoutePathFactory', () => {
         }),
       ).to.deep.equal(['/api/v1.1.1', '/api/v1.2.3']);
 
+      expect(
+        routePathFactory.create({
+          ctrlPath: '',
+          methodPath: '',
+          globalPrefix: '',
+          controllerVersion: VERSION_NEUTRAL,
+          versioningOptions: {
+            type: VersioningType.URI,
+            defaultVersion: VERSION_NEUTRAL,
+          },
+        }),
+      ).to.deep.equal(['/']);
+
+      expect(
+        routePathFactory.create({
+          ctrlPath: '',
+          methodPath: '',
+          globalPrefix: '',
+          controllerVersion: ['1', VERSION_NEUTRAL],
+          versioningOptions: {
+            type: VersioningType.URI,
+            defaultVersion: ['1', VERSION_NEUTRAL],
+          },
+        }),
+      ).to.deep.equal(['/v1', '/']);
+
       expect(
         routePathFactory.create({
           ctrlPath: '',
@@ -187,6 +213,17 @@ describe('RoutePathFactory', () => {
           globalPrefix: '',
         }),
       ).to.deep.equal(['/']);
+
+      sinon.stub(routePathFactory, 'isExcludedFromGlobalPrefix').returns(true);
+      expect(
+        routePathFactory.create({
+          ctrlPath: '/ctrlPath/',
+          methodPath: '/',
+          modulePath: '/',
+          globalPrefix: '/api',
+        }),
+      ).to.deep.equal(['/ctrlPath']);
+      sinon.restore();
     });
   });
 
diff --git a/packages/core/test/router/router-explorer.spec.ts b/packages/core/test/router/router-explorer.spec.ts
index f8da6c375..daeff71f9 100644
--- a/packages/core/test/router/router-explorer.spec.ts
+++ b/packages/core/test/router/router-explorer.spec.ts
@@ -1,5 +1,3 @@
-import { VERSION_NEUTRAL } from '@nestjs/common';
-import { VersionValue } from '@nestjs/common/interfaces';
 import { expect } from 'chai';
 import * as sinon from 'sinon';
 import { Controller } from '../../../common/decorators/core/controller.decorator';
@@ -10,7 +8,6 @@ import {
 } from '../../../common/decorators/http/request-mapping.decorator';
 import { RequestMethod } from '../../../common/enums/request-method.enum';
 import { VersioningType } from '../../../common/enums/version-type.enum';
-import { VersioningOptions } from '../../../common/interfaces/version-options.interface';
 import { Injector } from '../../../core/injector/injector';
 import { ApplicationConfig } from '../../application-config';
 import { ExecutionContextHost } from '../../helpers/execution-context-host';
@@ -21,6 +18,7 @@ import { RoutePathMetadata } from '../../router/interfaces/route-path-metadata.i
 import { RoutePathFactory } from '../../router/route-path-factory';
 import { RouterExceptionFilters } from '../../router/router-exception-filters';
 import { RouterExplorer } from '../../router/router-explorer';
+import { NoopHttpAdapter } from '../utils/noop-adapter.spec';
 
 describe('RouterExplorer', () => {
   @Controller('global')
@@ -365,449 +363,34 @@ describe('RouterExplorer', () => {
   });
 
   describe('applyVersionFilter', () => {
-    describe('when the version is VERSION_NEUTRAL', () => {
-      it('should return the handler', () => {
-        const version = VERSION_NEUTRAL as VersionValue;
-        const versioningOptions: VersioningOptions = {
-          type: VersioningType.URI,
-        };
-        const handler = sinon.stub();
-
-        const routePathMetadata: RoutePathMetadata = {
-          methodVersion: version,
-          versioningOptions,
-        };
-        const versionFilter = (routerBuilder as any).applyVersionFilter(
-          null,
-          routePathMetadata,
-          handler,
-        );
-
-        const req = {};
-        const res = {};
-        const next = sinon.stub();
-
-        versionFilter(req, res, next);
-
-        expect(handler.calledWith(req, res, next)).to.be.true;
-      });
-    });
-
-    describe('when the versioning type is URI', () => {
-      it('should return the handler', () => {
-        const version = '1';
-        const versioningOptions: VersioningOptions = {
-          type: VersioningType.URI,
-        };
-        const handler = sinon.stub();
-
-        const routePathMetadata: RoutePathMetadata = {
-          methodVersion: version,
-          versioningOptions,
-        };
-        const versionFilter = (routerBuilder as any).applyVersionFilter(
-          null,
-          routePathMetadata,
-          handler,
-        );
-
-        const req = {};
-        const res = {};
-        const next = sinon.stub();
-
-        versionFilter(req, res, next);
-        expect(handler.calledWith(req, res, next)).to.be.true;
-      });
-    });
-
-    describe('when the versioning type is MEDIA_TYPE', () => {
-      it('should return next if there is no Media Type header', () => {
-        const version = '1';
-        const versioningOptions: VersioningOptions = {
-          type: VersioningType.MEDIA_TYPE,
-          key: 'v=',
-        };
-        const handler = sinon.stub();
-
-        const routePathMetadata: RoutePathMetadata = {
-          methodVersion: version,
-          versioningOptions,
-        };
-        const versionFilter = (routerBuilder as any).applyVersionFilter(
-          null,
-          routePathMetadata,
-          handler,
-        );
-
-        const req = { headers: {} };
-        const res = {};
-        const next = sinon.stub();
-
-        versionFilter(req, res, next);
-
-        expect(next.called).to.be.true;
-      });
-
-      it('should return next if there is no version in the Media Type header', () => {
-        const version = '1';
-        const versioningOptions: VersioningOptions = {
-          type: VersioningType.MEDIA_TYPE,
-          key: 'v=',
-        };
-        const handler = sinon.stub();
-
-        const routePathMetadata: RoutePathMetadata = {
-          methodVersion: version,
-          versioningOptions,
-        };
-        const versionFilter = (routerBuilder as any).applyVersionFilter(
-          null,
-          routePathMetadata,
-          handler,
-        );
-
-        const req = { headers: { accept: 'application/json;' } };
-        const res = {};
-        const next = sinon.stub();
-
-        versionFilter(req, res, next);
-
-        expect(next.called).to.be.true;
-      });
-
-      describe('when the handler version is an array', () => {
-        it('should return next if the version in the Media Type header does not match the handler version', () => {
-          const version = ['1', '2'];
-          const versioningOptions: VersioningOptions = {
-            type: VersioningType.MEDIA_TYPE,
-            key: 'v=',
-          };
-          const handler = sinon.stub();
-
-          const routePathMetadata: RoutePathMetadata = {
-            methodVersion: version,
-            versioningOptions,
-          };
-          const versionFilter = (routerBuilder as any).applyVersionFilter(
-            null,
-            routePathMetadata,
-            handler,
-          );
-
-          const req = { headers: { accept: 'application/json;v=3' } };
-          const res = {};
-          const next = sinon.stub();
-
-          versionFilter(req, res, next);
-
-          expect(next.called).to.be.true;
-        });
-
-        it('should return the handler if the version in the Media Type header matches the handler version', () => {
-          const version = ['1', '2'];
-          const versioningOptions: VersioningOptions = {
-            type: VersioningType.MEDIA_TYPE,
-            key: 'v=',
-          };
-          const handler = sinon.stub();
-
-          const routePathMetadata: RoutePathMetadata = {
-            methodVersion: version,
-            versioningOptions,
-          };
-          const versionFilter = (routerBuilder as any).applyVersionFilter(
-            null,
-            routePathMetadata,
-            handler,
-          );
-
-          const req = { headers: { accept: 'application/json;v=1' } };
-          const res = {};
-          const next = sinon.stub();
-
-          versionFilter(req, res, next);
-
-          expect(handler.calledWith(req, res, next)).to.be.true;
-        });
-      });
-
-      describe('when the handler version is a string', () => {
-        it('should return next if the version in the Media Type header does not match the handler version', () => {
-          const version = '1';
-          const versioningOptions: VersioningOptions = {
-            type: VersioningType.MEDIA_TYPE,
-            key: 'v=',
-          };
-          const handler = sinon.stub();
-
-          const routePathMetadata: RoutePathMetadata = {
-            methodVersion: version,
-            versioningOptions,
-          };
-          const versionFilter = (routerBuilder as any).applyVersionFilter(
-            null,
-            routePathMetadata,
-            handler,
-          );
-
-          const req = { headers: { accept: 'application/json;v=3' } };
-          const res = {};
-          const next = sinon.stub();
-
-          versionFilter(req, res, next);
-
-          expect(next.called).to.be.true;
-        });
-
-        it('should return the handler if the version in the Media Type header matches the handler version', () => {
-          const version = '1';
-          const versioningOptions: VersioningOptions = {
-            type: VersioningType.MEDIA_TYPE,
-            key: 'v=',
-          };
-          const handler = sinon.stub();
-
-          const routePathMetadata: RoutePathMetadata = {
-            methodVersion: version,
-            versioningOptions,
-          };
-          const versionFilter = (routerBuilder as any).applyVersionFilter(
-            null,
-            routePathMetadata,
-            handler,
-          );
-
-          const req = { headers: { accept: 'application/json;v=1' } };
-          const res = {};
-          const next = sinon.stub();
-
-          versionFilter(req, res, next);
-
-          expect(handler.calledWith(req, res, next)).to.be.true;
-        });
-      });
-    });
-
-    describe('when the versioning type is HEADER', () => {
-      it('should return next if there is no Custom Header', () => {
-        const version = '1';
-        const versioningOptions: VersioningOptions = {
-          type: VersioningType.HEADER,
-          header: 'X-API-Version',
-        };
-        const handler = sinon.stub();
-
-        const routePathMetadata: RoutePathMetadata = {
-          methodVersion: version,
-          versioningOptions,
-        };
-        const versionFilter = (routerBuilder as any).applyVersionFilter(
-          null,
-          routePathMetadata,
-          handler,
-        );
-
-        const req = { headers: {} };
-        const res = {};
-        const next = sinon.stub();
-
-        versionFilter(req, res, next);
-
-        expect(next.called).to.be.true;
-      });
-
-      it('should return next if there is no version in the Custom Header', () => {
-        const version = '1';
-        const versioningOptions: VersioningOptions = {
-          type: VersioningType.HEADER,
-          header: 'X-API-Version',
-        };
-        const handler = sinon.stub();
-
-        const routePathMetadata: RoutePathMetadata = {
-          methodVersion: version,
-          versioningOptions,
-        };
-        const versionFilter = (routerBuilder as any).applyVersionFilter(
-          null,
-          routePathMetadata,
-          handler,
-        );
-
-        const req = { headers: { 'X-API-Version': '' } };
-        const res = {};
-        const next = sinon.stub();
-
-        versionFilter(req, res, next);
-
-        expect(next.called).to.be.true;
-      });
-
-      describe('when the handler version is an array', () => {
-        it('should return next if the version in the Custom Header does not match the handler version', () => {
-          const version = ['1', '2'];
-          const versioningOptions: VersioningOptions = {
-            type: VersioningType.HEADER,
-            header: 'X-API-Version',
-          };
-          const handler = sinon.stub();
-
-          const routePathMetadata: RoutePathMetadata = {
-            methodVersion: version,
-            versioningOptions,
-          };
-          const versionFilter = (routerBuilder as any).applyVersionFilter(
-            null,
-            routePathMetadata,
-            handler,
-          );
-
-          const req = { headers: { 'X-API-Version': '3' } };
-          const res = {};
-          const next = sinon.stub();
-
-          versionFilter(req, res, next);
-
-          expect(next.called).to.be.true;
-        });
-
-        it('should return the handler if the version in the Custom Header matches the handler version', () => {
-          const version = ['1', '2'];
-          const versioningOptions: VersioningOptions = {
-            type: VersioningType.HEADER,
-            header: 'X-API-Version',
-          };
-          const handler = sinon.stub();
-
-          const routePathMetadata: RoutePathMetadata = {
-            methodVersion: version,
-            versioningOptions,
-          };
-          const versionFilter = (routerBuilder as any).applyVersionFilter(
-            null,
-            routePathMetadata,
-            handler,
-          );
-
-          const req = { headers: { 'X-API-Version': '1' } };
-          const res = {};
-          const next = sinon.stub();
-
-          versionFilter(req, res, next);
-
-          expect(handler.calledWith(req, res, next)).to.be.true;
-        });
-      });
-
-      describe('when the handler version is a string', () => {
-        it('should return next if the version in the Custom Header does not match the handler version', () => {
-          const version = '1';
-          const versioningOptions: VersioningOptions = {
-            type: VersioningType.HEADER,
-            header: 'X-API-Version',
-          };
-          const handler = sinon.stub();
-
-          const routePathMetadata: RoutePathMetadata = {
-            methodVersion: version,
-            versioningOptions,
-          };
-          const versionFilter = (routerBuilder as any).applyVersionFilter(
-            null,
-            routePathMetadata,
-            handler,
-          );
-
-          const req = { headers: { 'X-API-Version': '3' } };
-          const res = {};
-          const next = sinon.stub();
-
-          versionFilter(req, res, next);
-
-          expect(next.called).to.be.true;
-        });
-
-        it('should return the handler if the version in the Custom Header matches the handler version', () => {
-          const version = '1';
-          const versioningOptions: VersioningOptions = {
-            type: VersioningType.HEADER,
-            header: 'X-API-Version',
-          };
-          const handler = sinon.stub();
-
-          const routePathMetadata: RoutePathMetadata = {
-            methodVersion: version,
-            versioningOptions,
-          };
-          const versionFilter = (routerBuilder as any).applyVersionFilter(
-            null,
-            routePathMetadata,
-            handler,
-          );
-
-          const req = { headers: { 'X-API-Version': '1' } };
-          const res = {};
-          const next = sinon.stub();
-
-          versionFilter(req, res, next);
-
-          expect(handler.calledWith(req, res, next)).to.be.true;
-        });
-      });
-    });
-
-    describe('when versioning type is unrecognized', () => {
-      it('should throw an error if there is no next function', () => {
-        const version = '1';
-        const versioningOptions: any = {
-          type: 'UNKNOWN',
-        };
-        const handler = sinon.stub();
-
-        const routePathMetadata: RoutePathMetadata = {
-          methodVersion: version,
-          versioningOptions,
-        };
-        const versionFilter = (routerBuilder as any).applyVersionFilter(
-          null,
-          routePathMetadata,
-          handler,
-        );
-
-        const req = {};
-        const res = {};
-        const next = null;
+    it('should call and return the `applyVersionFilter` from the underlying http server', () => {
+      const router = sinon.spy(new NoopHttpAdapter({}));
+      const routePathMetadata: RoutePathMetadata = {
+        methodVersion:
+          sinon.fake() as unknown as RoutePathMetadata['methodVersion'],
+        versioningOptions:
+          sinon.fake() as unknown as RoutePathMetadata['versioningOptions'],
+      };
+      const handler = sinon.stub();
 
-        expect(() => versionFilter(req, res, next)).to.throw(
-          'HTTP adapter does not support filtering on version',
-        );
-      });
+      // We're using type assertion here because `applyVersionFilter` is private
+      const versionFilter = (routerBuilder as any).applyVersionFilter(
+        router,
+        routePathMetadata,
+        handler,
+      );
 
-      it('should return next', () => {
-        const version = '1';
-        const versioningOptions: any = {
-          type: 'UNKNOWN',
-        };
-        const handler = sinon.stub();
-
-        const routePathMetadata: RoutePathMetadata = {
-          methodVersion: version,
-          versioningOptions,
-        };
-        const versionFilter = (routerBuilder as any).applyVersionFilter(
-          null,
-          routePathMetadata,
+      expect(
+        router.applyVersionFilter.calledOnceWithExactly(
           handler,
-        );
-
-        const req = {};
-        const res = {};
-        const next = sinon.stub();
-
-        versionFilter(req, res, next);
+          routePathMetadata.methodVersion,
+          routePathMetadata.versioningOptions,
+        ),
+      ).to.be.true;
 
-        expect(next.called).to.be.true;
-      });
+      expect(router.applyVersionFilter.returnValues[0]).to.be.equal(
+        versionFilter,
+      );
     });
   });
 });
diff --git a/packages/core/test/router/router-response-controller.spec.ts b/packages/core/test/router/router-response-controller.spec.ts
index 3f24aa7b5..fbc3d3490 100644
--- a/packages/core/test/router/router-response-controller.spec.ts
+++ b/packages/core/test/router/router-response-controller.spec.ts
@@ -1,7 +1,7 @@
 import { isNil, isObject } from '@nestjs/common/utils/shared.utils';
 import { expect } from 'chai';
 import { IncomingMessage, ServerResponse } from 'http';
-import { Observable, of } from 'rxjs';
+import { Observable, of, Subject } from 'rxjs';
 import * as sinon from 'sinon';
 import { PassThrough, Writable } from 'stream';
 import { HttpStatus, RequestMethod } from '../../../common';
@@ -71,13 +71,13 @@ describe('RouterResponseController', () => {
   describe('transformToResult', () => {
     describe('when resultOrDeferred', () => {
       describe('is Promise', () => {
-        it('should return Promise', async () => {
+        it('should return Promise that resolves to the value resolved by the input Promise', async () => {
           const value = 100;
           expect(
             await routerResponseController.transformToResult(
               Promise.resolve(value),
             ),
-          ).to.be.eq(100);
+          ).to.be.eq(value);
         });
       });
 
@@ -88,16 +88,25 @@ describe('RouterResponseController', () => {
             await routerResponseController.transformToResult(
               of(1, 2, 3, lastValue),
             ),
-          ).to.be.eq(100);
+          ).to.be.eq(lastValue);
         });
       });
 
-      describe('is value', () => {
-        it('should return Promise', async () => {
+      describe('is an object that has the method `subscribe`', () => {
+        it('should return a Promise that resolves to the input value', async () => {
+          const value = { subscribe() {} };
+          expect(
+            await routerResponseController.transformToResult(value),
+          ).to.equal(value);
+        });
+      });
+
+      describe('is an ordinary value', () => {
+        it('should return a Promise that resolves to the input value', async () => {
           const value = 100;
           expect(
             await routerResponseController.transformToResult(value),
-          ).to.be.eq(100);
+          ).to.be.eq(value);
         });
       });
     });
@@ -299,7 +308,7 @@ describe('RouterResponseController', () => {
       request.destroy();
       await written(response);
       expect(response.content).to.eql(
-        `:
+        `
 id: 1
 data: test
 
@@ -310,7 +319,7 @@ data: test
     it('should close on request close', done => {
       const result = of('test');
       const response = new Writable();
-      response.end = () => done();
+      response.end = () => done() as any;
       response._write = () => {};
 
       const request = new Writable();
@@ -327,7 +336,7 @@ data: test
     it('should close the request when observable completes', done => {
       const result = of('test');
       const response = new Writable();
-      response.end = done;
+      response.end = done as any;
       response._write = () => {};
 
       const request = new Writable();
@@ -349,14 +358,86 @@ data: test
       const request = new Writable();
       request._write = () => {};
 
-      routerResponseController.sse(
-        result as unknown as Observable<string>,
-        response as unknown as ServerResponse,
-        request as unknown as IncomingMessage,
-      );
+      try {
+        routerResponseController.sse(
+          result as unknown as Observable<string>,
+          response as unknown as ServerResponse,
+          request as unknown as IncomingMessage,
+        );
+      } catch {
+        // Wether an error is thrown or not
+        // is not relevant, so long as
+        // result is not called
+      }
 
       sinon.assert.notCalled(result);
       done();
     });
+
+    describe('when there is an error', () => {
+      it('should close the request', done => {
+        const result = new Subject();
+        const response = new Writable();
+        response.end = done as any;
+        response._write = () => {};
+
+        const request = new Writable();
+        request._write = () => {};
+
+        routerResponseController.sse(
+          result,
+          response as unknown as ServerResponse,
+          request as unknown as IncomingMessage,
+        );
+
+        result.error(new Error('Some error'));
+      });
+
+      it('should write the error message to the stream', async () => {
+        class Sink extends Writable {
+          private readonly chunks: string[] = [];
+
+          _write(
+            chunk: any,
+            encoding: string,
+            callback: (error?: Error | null) => void,
+          ): void {
+            this.chunks.push(chunk);
+            callback();
+          }
+
+          get content() {
+            return this.chunks.join('');
+          }
+        }
+
+        const written = (stream: Writable) =>
+          new Promise((resolve, reject) =>
+            stream.on('error', reject).on('finish', resolve),
+          );
+
+        const result = new Subject();
+        const response = new Sink();
+        const request = new PassThrough();
+        routerResponseController.sse(
+          result,
+          response as unknown as ServerResponse,
+          request as unknown as IncomingMessage,
+        );
+
+        result.error(new Error('Some error'));
+        request.destroy();
+
+        await written(response);
+        expect(response.content).to.eql(
+          `
+event: error
+id: 1
+data: Some error
+
+`,
+        );
+      });
+    });
   });
 });
diff --git a/packages/core/test/router/routes-resolver.spec.ts b/packages/core/test/router/routes-resolver.spec.ts
index 1b88cee5f..36b67f1c6 100644
--- a/packages/core/test/router/routes-resolver.spec.ts
+++ b/packages/core/test/router/routes-resolver.spec.ts
@@ -319,6 +319,13 @@ describe('RoutesResolver', () => {
           expect(outputErr).to.be.instanceof(BadRequestException);
         });
       });
+      describe('URIError', () => {
+        it('should map to BadRequestException', () => {
+          const err = new URIError();
+          const outputErr = routesResolver.mapExternalException(err);
+          expect(outputErr).to.be.instanceof(BadRequestException);
+        });
+      });
       describe('other', () => {
         it('should behave as an identity', () => {
           const err = new Error();
diff --git a/packages/core/test/router/sse-stream.spec.ts b/packages/core/test/router/sse-stream.spec.ts
index b4ccdf191..173a522fe 100644
--- a/packages/core/test/router/sse-stream.spec.ts
+++ b/packages/core/test/router/sse-stream.spec.ts
@@ -43,6 +43,7 @@ describe('SseStream', () => {
     const sse = new SseStream();
     const sink = new Sink();
     sse.pipe(sink);
+
     sse.writeMessage(
       {
         data: 'hello\nworld',
@@ -57,8 +58,9 @@ describe('SseStream', () => {
     );
     sse.end();
     await written(sink);
+
     expect(sink.content).to.equal(
-      `:
+      `
 id: 1
 data: hello
 data: world
@@ -75,6 +77,7 @@ data: monde
     const sse = new SseStream();
     const sink = new Sink();
     sse.pipe(sink);
+
     sse.writeMessage(
       {
         data: { hello: 'world' },
@@ -83,8 +86,9 @@ data: monde
     );
     sse.end();
     await written(sink);
+
     expect(sink.content).to.equal(
-      `:
+      `
 id: 1
 data: {"hello":"world"}
 
@@ -96,6 +100,7 @@ data: {"hello":"world"}
     const sse = new SseStream();
     const sink = new Sink();
     sse.pipe(sink);
+
     sse.writeMessage(
       {
         type: 'tea-time',
@@ -107,8 +112,9 @@ data: {"hello":"world"}
     );
     sse.end();
     await written(sink);
+
     expect(sink.content).to.equal(
-      `:
+      `
 event: tea-time
 id: the-id
 retry: 222
@@ -148,6 +154,7 @@ data: hello
         return sink;
       },
     );
+
     sse.pipe(sink, {
       additionalHeaders: { 'access-control-headers': 'some-cors-value' },
     });
@@ -159,6 +166,7 @@ data: hello
       sse = new SseStream(req);
       sse.pipe(res);
     });
+
     server.listen(() => {
       const es = new EventSource(
         `http://localhost:${(server.address() as AddressInfo).port}`,
diff --git a/packages/core/test/scanner.spec.ts b/packages/core/test/scanner.spec.ts
index 8b9364ab8..f2ef6b2ac 100644
--- a/packages/core/test/scanner.spec.ts
+++ b/packages/core/test/scanner.spec.ts
@@ -1,4 +1,4 @@
-import { Injectable } from '@nestjs/common';
+import { Catch, Injectable, Logger } from '@nestjs/common';
 import { expect } from 'chai';
 import * as sinon from 'sinon';
 import { GUARDS_METADATA } from '../../common/constants';
@@ -9,6 +9,7 @@ import { Scope } from '../../common/interfaces';
 import { ApplicationConfig } from '../application-config';
 import { APP_FILTER, APP_GUARD, APP_INTERCEPTOR, APP_PIPE } from '../constants';
 import { InvalidModuleException } from '../errors/exceptions/invalid-module.exception';
+import { InvalidClassModuleException } from '../errors/exceptions/invalid-class-module.exception';
 import { UndefinedModuleException } from '../errors/exceptions/undefined-module.exception';
 import { NestContainer } from '../injector/container';
 import { InstanceWrapper } from '../injector/instance-wrapper';
@@ -21,6 +22,9 @@ describe('DependenciesScanner', () => {
   @Injectable()
   class TestComponent {}
 
+  @Catch()
+  class TestExceptionFilterWithoutInjectable {}
+
   @Controller('')
   class TestController {}
 
@@ -163,12 +167,34 @@ describe('DependenciesScanner', () => {
 
   describe('insertModule', () => {
     it('should call forwardRef() when forwardRef property exists', () => {
+      sinon.stub(container, 'addModule').returns({} as any);
+
       const module = { forwardRef: sinon.spy() };
+      scanner.insertModule(module, []);
 
-      sinon.stub(container, 'addModule').returns({} as any);
-      scanner.insertModule(module as any, [] as any);
       expect(module.forwardRef.called).to.be.true;
     });
+    it('should throw "InvalidClassModuleException" exception when suppling a class annotated with `@Injectable()` decorator', () => {
+      sinon.stub(container, 'addModule').returns({} as any);
+
+      expect(scanner.insertModule(TestComponent, [])).to.be.rejectedWith(
+        InvalidClassModuleException,
+      );
+    });
+    it('should throw "InvalidClassModuleException" exception when suppling a class annotated with `@Controller()` decorator', () => {
+      sinon.stub(container, 'addModule').returns({} as any);
+
+      expect(scanner.insertModule(TestController, [])).to.be.rejectedWith(
+        InvalidClassModuleException,
+      );
+    });
+    it('should throw "InvalidClassModuleException" exception when suppling a class annotated with (only) `@Catch()` decorator', () => {
+      sinon.stub(container, 'addModule').returns({} as any);
+
+      expect(
+        scanner.insertModule(TestExceptionFilterWithoutInjectable, []),
+      ).to.be.rejectedWith(InvalidClassModuleException);
+    });
   });
 
   describe('insertImport', () => {
diff --git a/packages/core/test/services/reflector.service.spec.ts b/packages/core/test/services/reflector.service.spec.ts
index 27c8b04bd..20e7b5102 100644
--- a/packages/core/test/services/reflector.service.spec.ts
+++ b/packages/core/test/services/reflector.service.spec.ts
@@ -26,6 +26,10 @@ describe('Reflector', () => {
   });
 
   describe('getAllAndMerge', () => {
+    it('should return an empty array when there are no targets', () => {
+      const key = 'key';
+      expect(reflector.getAllAndMerge(key, [])).to.be.empty;
+    });
     it('should reflect metadata of all targets and concat arrays', () => {
       const key = 'key';
       const value = 'value';
diff --git a/packages/core/test/tsconfig.json b/packages/core/test/tsconfig.json
new file mode 100644
index 000000000..50d59661d
--- /dev/null
+++ b/packages/core/test/tsconfig.json
@@ -0,0 +1,3 @@
+{
+  "extends": "../../../tsconfig.spec.json"
+}
diff --git a/packages/core/test/utils/noop-adapter.spec.ts b/packages/core/test/utils/noop-adapter.spec.ts
index 67eafa54e..4935a53ee 100644
--- a/packages/core/test/utils/noop-adapter.spec.ts
+++ b/packages/core/test/utils/noop-adapter.spec.ts
@@ -1,4 +1,5 @@
-import { RequestMethod } from '@nestjs/common';
+import { RequestMethod, VersioningOptions } from '@nestjs/common';
+import { VersionValue } from '@nestjs/common/interfaces';
 import { AbstractHttpAdapter } from '../../adapters';
 
 export class NoopHttpAdapter extends AbstractHttpAdapter {
@@ -13,13 +14,11 @@ export class NoopHttpAdapter extends AbstractHttpAdapter {
   getRequestMethod(request: any): any {}
   getRequestUrl(request: any): any {}
   reply(response: any, body: any): any {}
-  end(response: any, message?: any): any {}
   status(response: any, statusCode: number): any {}
   render(response: any, view: string, options: any): any {}
   redirect(response: any, statusCode: number, url: string) {}
   setErrorHandler(handler: Function, prefix = '/'): any {}
   setNotFoundHandler(handler: Function, prefix = '/'): any {}
-  isHeadersSent(response: any): any {}
   setHeader(response: any, name: string, value: string): any {}
   registerParserMiddleware(): any {}
   enableCors(options: any): any {}
@@ -27,4 +26,13 @@ export class NoopHttpAdapter extends AbstractHttpAdapter {
   getType() {
     return '';
   }
+  applyVersionFilter(
+    handler: Function,
+    version: VersionValue,
+    versioningOptions: VersioningOptions,
+  ) {
+    return (req, res, next) => {
+      return () => {};
+    };
+  }
 }
diff --git a/packages/microservices/CHANGELOG.md b/packages/microservices/CHANGELOG.md
deleted file mode 100644
index f455b343b..000000000
--- a/packages/microservices/CHANGELOG.md
+++ /dev/null
@@ -1,18 +0,0 @@
-# Change Log
-
-All notable changes to this project will be documented in this file.
-See [Conventional Commits](https://conventionalcommits.org) for commit guidelines.
-
-<a name="8.2.0"></a>
-# [8.2.0](https://github.com/nestjs/nest/compare/v8.1.2...v8.2.0) (2021-11-08)
-
-
-### Bug Fixes
-
-* **microservices:** npm run format ([fdf11a5](https://github.com/nestjs/nest/commit/fdf11a5))
-
-
-### Features
-
-* **microservices:** adds packageDefinition option to ClientGrpc ([76f2918](https://github.com/nestjs/nest/commit/76f2918)), closes [#8457](https://github.com/nestjs/nest/issues/8457)
-* **microservices:** removes [@grpc](https://github.com/grpc)/grpc-js import ([3b74293](https://github.com/nestjs/nest/commit/3b74293))
diff --git a/packages/microservices/Readme.md b/packages/microservices/Readme.md
index f288809a9..9a3f42045 100644
--- a/packages/microservices/Readme.md
+++ b/packages/microservices/Readme.md
@@ -54,36 +54,42 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
 <table style="text-align:center;"><tr>
   <td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
+  <td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/red-hat-logo.svg" width="200" valign="middle" /></a></td>
 <td>
 <a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
 <td>
 <a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
+    <td>
+<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td><td>
+<a href="https://amplication.com/" target="_blank"><img src="https://nestjs.com/img/amplication-logo.svg" width="190" valign="middle" /></a></td>
 </tr></table>
 
 #### Gold Sponsors
 
 <table style="text-align:center;"><tr><td>
-  <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
-  <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
+<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="140" valign="middle" /></a></td>
 <td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
+<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td>
+ <td>
+<a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
+<a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td><td>
+<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
 <table style="text-align:center;"><tr><td>
 <a href="https://neoteric.eu/" target="_blank"><img src="https://nestjs.com/img/neoteric-cut.png" width="120" valign="middle" /></a> </td><td>
   <a href="http://gojob.com" target="_blank"><img src="http://nestjs.com/img/gojob-logo.png" valign="middle" width="100" /></a> </td><td>
-<a href="http://www.leogistics.com" target="_blank"><img src="https://nestjs.com/img/leogistics-logo.jpeg" width="150" valign="middle" /></td><td>
+<a href="https://www.myleodsc.com/" target="_blank"><img src="https://nestjs.com/img/myleo-logo.png" width="180" valign="middle" /></td><td>
 <a href="https://careers.meetdandy.com/?gh_src=063ba61e3us" target="_blank"><img src="https://nestjs.com/img/dandy-roles-logo.svg" width="150" valign="middle" /></td><td>
 <a href="https://www.castlecraft.in" target="_blank"><img src="https://nestjs.com/img/castlecraft-logo.png" width="150" valign="middle" /></td>
-<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td></tr></table>
+<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td>
+<td><a href="https://n.inc" target="_blank"><img src="https://nestjs.com/img/n-inc-logo.svg" width="120" valign="middle" /></td></tr></table>
 
 #### Sponsors
 
@@ -117,6 +123,11 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/naologic-logo.svg" width="125" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://messaged.com/" target="_blank"><img src="https://nestjs.com/img/messaged-logo.png" width="50" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/triplecore-logo.svg" width="50" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://klqc.de" target="_blank"><img src="https://nestjs.com/img/klcqcl-logo.png" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://thecasinowizard.com/bonuses/no-deposit-bonuses/" target="_blank"><img src="https://nestjs.com/img/casinowizard-logo.png" width="120" valign="middle" /></a></td></tr><tr>
+     <td align="center" valign="middle"><a href="https://polygon-software.ch/" target="_blank"><img src="https://nestjs.com/img/polygon-logo.svg" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://mobilereality.pl/" target="_blank"><img src="https://nestjs.com/img/mobile-reality-logo.png" width="45" valign="middle" /></a></td>
+     <td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/boringowl-logo.svg" width="120" valign="middle" /></a></td>
   </tr></table>
 
 ## Backers
diff --git a/packages/microservices/client/client-grpc.ts b/packages/microservices/client/client-grpc.ts
index 298a9e152..008bee4fa 100644
--- a/packages/microservices/client/client-grpc.ts
+++ b/packages/microservices/client/client-grpc.ts
@@ -53,8 +53,7 @@ export class ClientGrpcProxy extends ClientProxy implements ClientGrpc {
     const grpcService = {} as T;
 
     protoMethods.forEach(m => {
-      const key = m[0].toLowerCase() + m.slice(1, m.length);
-      grpcService[key] = this.createServiceMethod(grpcClient, m);
+      grpcService[m] = this.createServiceMethod(grpcClient, m);
     });
     return grpcService;
   }
diff --git a/packages/microservices/client/client-kafka.ts b/packages/microservices/client/client-kafka.ts
index 1900336e4..ba9ad099a 100644
--- a/packages/microservices/client/client-kafka.ts
+++ b/packages/microservices/client/client-kafka.ts
@@ -19,6 +19,7 @@ import {
   KafkaConfig,
   KafkaMessage,
   Producer,
+  TopicPartitionOffsetAndMetadata,
 } from '../external/kafka.interface';
 import {
   KafkaLogger,
@@ -51,6 +52,7 @@ export class ClientKafka extends ClientProxy {
   protected brokers: string[] | BrokersFunction;
   protected clientId: string;
   protected groupId: string;
+  protected producerOnlyMode: boolean;
 
   constructor(protected readonly options: KafkaOptions['options']) {
     super();
@@ -60,7 +62,9 @@ export class ClientKafka extends ClientProxy {
     const consumerOptions =
       this.getOptionsProp(this.options, 'consumer') || ({} as ConsumerConfig);
     const postfixId =
-      this.getOptionsProp(this.options, 'postfixId') || '-client';
+      this.getOptionsProp(this.options, 'postfixId') ?? '-client';
+    this.producerOnlyMode =
+      this.getOptionsProp(this.options, 'producerOnlyMode') || false;
 
     this.brokers = clientOptions.brokers || [KAFKA_DEFAULT_BROKER];
 
@@ -99,36 +103,44 @@ export class ClientKafka extends ClientProxy {
     }
     this.client = this.createClient();
 
-    const partitionAssigners = [
-      (config: ConstructorParameters<typeof KafkaReplyPartitionAssigner>[1]) =>
-        new KafkaReplyPartitionAssigner(this, config),
-    ] as any[];
+    if (!this.producerOnlyMode) {
+      const partitionAssigners = [
+        (
+          config: ConstructorParameters<typeof KafkaReplyPartitionAssigner>[1],
+        ) => new KafkaReplyPartitionAssigner(this, config),
+      ] as any[];
 
-    const consumerOptions = Object.assign(
-      {
-        partitionAssigners,
-      },
-      this.options.consumer || {},
-      {
-        groupId: this.groupId,
-      },
-    );
-    this.producer = this.client.producer(this.options.producer || {});
-    this.consumer = this.client.consumer(consumerOptions);
+      const consumerOptions = Object.assign(
+        {
+          partitionAssigners,
+        },
+        this.options.consumer || {},
+        {
+          groupId: this.groupId,
+        },
+      );
 
-    // set member assignments on join and rebalance
-    this.consumer.on(
-      this.consumer.events.GROUP_JOIN,
-      this.setConsumerAssignments.bind(this),
-    );
+      this.consumer = this.client.consumer(consumerOptions);
+      // set member assignments on join and rebalance
+      this.consumer.on(
+        this.consumer.events.GROUP_JOIN,
+        this.setConsumerAssignments.bind(this),
+      );
+      await this.consumer.connect();
+      await this.bindTopics();
+    }
 
+    this.producer = this.client.producer(this.options.producer || {});
     await this.producer.connect();
-    await this.consumer.connect();
-    await this.bindTopics();
+
     return this.producer;
   }
 
   public async bindTopics(): Promise<void> {
+    if (!this.consumer) {
+      throw Error('No consumer initialized');
+    }
+
     const consumerSubscribeOptions = this.options.subscribe || {};
     const subscribeTo = async (responsePattern: string) =>
       this.consumer.subscribe({
@@ -189,9 +201,11 @@ export class ClientKafka extends ClientProxy {
     return this.consumerAssignments;
   }
 
-  protected dispatchEvent(packet: OutgoingEvent): Promise<any> {
+  protected async dispatchEvent(packet: OutgoingEvent): Promise<any> {
     const pattern = this.normalizePattern(packet.pattern);
-    const outgoingEvent = this.serializer.serialize(packet.data);
+    const outgoingEvent = await this.serializer.serialize(packet.data, {
+      pattern,
+    });
     const message = Object.assign(
       {
         topic: pattern,
@@ -199,6 +213,7 @@ export class ClientKafka extends ClientProxy {
       },
       this.options.send || {},
     );
+
     return this.producer.send(message);
   }
 
@@ -216,33 +231,42 @@ export class ClientKafka extends ClientProxy {
     partialPacket: ReadPacket,
     callback: (packet: WritePacket) => any,
   ): () => void {
+    const packet = this.assignPacketId(partialPacket);
+    this.routingMap.set(packet.id, callback);
+
+    const cleanup = () => this.routingMap.delete(packet.id);
+    const errorCallback = (err: unknown) => {
+      cleanup();
+      callback({ err });
+    };
+
     try {
-      const packet = this.assignPacketId(partialPacket);
       const pattern = this.normalizePattern(partialPacket.pattern);
       const replyTopic = this.getResponsePatternName(pattern);
       const replyPartition = this.getReplyTopicPartition(replyTopic);
 
-      const serializedPacket: KafkaRequest = this.serializer.serialize(
-        packet.data,
-      );
-      serializedPacket.headers[KafkaHeaders.CORRELATION_ID] = packet.id;
-      serializedPacket.headers[KafkaHeaders.REPLY_TOPIC] = replyTopic;
-      serializedPacket.headers[KafkaHeaders.REPLY_PARTITION] = replyPartition;
-
-      this.routingMap.set(packet.id, callback);
-
-      const message = Object.assign(
-        {
-          topic: pattern,
-          messages: [serializedPacket],
-        },
-        this.options.send || {},
-      );
-      this.producer.send(message).catch(err => callback({ err }));
-
-      return () => this.routingMap.delete(packet.id);
+      Promise.resolve(this.serializer.serialize(packet.data, { pattern }))
+        .then((serializedPacket: KafkaRequest) => {
+          serializedPacket.headers[KafkaHeaders.CORRELATION_ID] = packet.id;
+          serializedPacket.headers[KafkaHeaders.REPLY_TOPIC] = replyTopic;
+          serializedPacket.headers[KafkaHeaders.REPLY_PARTITION] =
+            replyPartition;
+
+          const message = Object.assign(
+            {
+              topic: pattern,
+              messages: [serializedPacket],
+            },
+            this.options.send || {},
+          );
+
+          return this.producer.send(message);
+        })
+        .catch(err => errorCallback(err));
+
+      return cleanup;
     } catch (err) {
-      callback({ err });
+      errorCallback(err);
     }
   }
 
@@ -274,4 +298,14 @@ export class ClientKafka extends ClientProxy {
     this.deserializer =
       (options && options.deserializer) || new KafkaResponseDeserializer();
   }
+
+  public commitOffsets(
+    topicPartitions: TopicPartitionOffsetAndMetadata[],
+  ): Promise<void> {
+    if (this.consumer) {
+      return this.consumer.commitOffsets(topicPartitions);
+    } else {
+      throw new Error('No consumer initialized');
+    }
+  }
 }
diff --git a/packages/microservices/client/client-mqtt.ts b/packages/microservices/client/client-mqtt.ts
index 8797b56f8..44cf246b1 100644
--- a/packages/microservices/client/client-mqtt.ts
+++ b/packages/microservices/client/client-mqtt.ts
@@ -174,11 +174,14 @@ export class ClientMqtt extends ClientProxy {
     const serializedPacket: ReadPacket & Partial<MqttRecord> =
       this.serializer.serialize(packet);
 
+    const options = serializedPacket.options;
+    delete serializedPacket.options;
+
     return new Promise<void>((resolve, reject) =>
       this.mqttClient.publish(
         pattern,
         JSON.stringify(serializedPacket),
-        this.mergePacketOptions(serializedPacket.options),
+        this.mergePacketOptions(options),
         (err: any) => (err ? reject(err) : resolve()),
       ),
     );
diff --git a/packages/microservices/client/client-nats.ts b/packages/microservices/client/client-nats.ts
index c124b6c18..f85bf2e83 100644
--- a/packages/microservices/client/client-nats.ts
+++ b/packages/microservices/client/client-nats.ts
@@ -1,5 +1,6 @@
 import { Logger } from '@nestjs/common/services/logger.service';
 import { loadPackage } from '@nestjs/common/utils/load-package.util';
+import { isObject } from '@nestjs/common/utils/shared.utils';
 import { NATS_DEFAULT_URL } from '../constants';
 import { NatsResponseJSONDeserializer } from '../deserializers/nats-response-json.deserializer';
 import { EmptyResponseException } from '../errors/empty-response.exception';
@@ -48,7 +49,7 @@ export class ClientNats extends ClientProxy {
   public async handleStatusUpdates(client: Client) {
     for await (const status of client.status()) {
       const data =
-        status.data && typeof status.data === 'object'
+        status.data && isObject(status.data)
           ? JSON.stringify(status.data)
           : status.data;
       if (status.type === 'disconnect' || status.type === 'error') {
diff --git a/packages/microservices/client/client-redis.ts b/packages/microservices/client/client-redis.ts
index 8b42ce6a0..517ea271c 100644
--- a/packages/microservices/client/client-redis.ts
+++ b/packages/microservices/client/client-redis.ts
@@ -1,48 +1,31 @@
 import { Logger } from '@nestjs/common/services/logger.service';
 import { loadPackage } from '@nestjs/common/utils/load-package.util';
 import {
-  EmptyError,
-  fromEvent,
-  lastValueFrom,
-  merge,
-  Subject,
-  zip,
-} from 'rxjs';
-import { share, take, tap } from 'rxjs/operators';
-import {
-  CONNECT_EVENT,
-  ECONNREFUSED,
   ERROR_EVENT,
   MESSAGE_EVENT,
-  REDIS_DEFAULT_URL,
+  REDIS_DEFAULT_HOST,
+  REDIS_DEFAULT_PORT,
 } from '../constants';
-import {
-  ClientOpts,
-  RedisClient,
-  RetryStrategyOptions,
-} from '../external/redis.interface';
 import { ReadPacket, RedisOptions, WritePacket } from '../interfaces';
 import { ClientProxy } from './client-proxy';
 
-let redisPackage: any = {};
+type Redis = any;
+
+let redisPackage = {} as any;
 
 export class ClientRedis extends ClientProxy {
   protected readonly logger = new Logger(ClientProxy.name);
   protected readonly subscriptionsCount = new Map<string, number>();
-  protected readonly url: string;
-  protected pubClient: RedisClient;
-  protected subClient: RedisClient;
+  protected pubClient: Redis;
+  protected subClient: Redis;
   protected connection: Promise<any>;
   protected isExplicitlyTerminated = false;
 
   constructor(protected readonly options: RedisOptions['options']) {
     super();
-    this.url =
-      this.getOptionsProp(options, 'url') ||
-      (!this.getOptionsProp(options, 'host') && REDIS_DEFAULT_URL);
 
-    redisPackage = loadPackage('redis', ClientRedis.name, () =>
-      require('redis'),
+    redisPackage = loadPackage('ioredis', ClientRedis.name, () =>
+      require('ioredis'),
     );
 
     this.initializeSerializer(options);
@@ -64,73 +47,57 @@ export class ClientRedis extends ClientProxy {
     this.isExplicitlyTerminated = true;
   }
 
-  public connect(): Promise<any> {
+  public async connect(): Promise<any> {
     if (this.pubClient && this.subClient) {
       return this.connection;
     }
-    const error$ = new Subject<Error>();
-
-    this.pubClient = this.createClient(error$);
-    this.subClient = this.createClient(error$);
+    this.pubClient = this.createClient();
+    this.subClient = this.createClient();
     this.handleError(this.pubClient);
     this.handleError(this.subClient);
 
-    const pubConnect$ = fromEvent(this.pubClient, CONNECT_EVENT);
-    const subClient$ = fromEvent(this.subClient, CONNECT_EVENT);
+    this.connection = Promise.all([
+      this.subClient.connect(),
+      this.pubClient.connect(),
+    ]);
+    await this.connection;
 
-    this.connection = lastValueFrom(
-      merge(error$, zip(pubConnect$, subClient$)).pipe(
-        take(1),
-        tap(() =>
-          this.subClient.on(MESSAGE_EVENT, this.createResponseCallback()),
-        ),
-        share(),
-      ),
-    ).catch(err => {
-      if (err instanceof EmptyError) {
-        return;
-      }
-      throw err;
-    });
+    this.subClient.on(MESSAGE_EVENT, this.createResponseCallback());
     return this.connection;
   }
 
-  public createClient(error$: Subject<Error>): RedisClient {
-    return redisPackage.createClient({
-      ...this.getClientOptions(error$),
-      url: this.url,
+  public createClient(): Redis {
+    return new redisPackage({
+      host: REDIS_DEFAULT_HOST,
+      port: REDIS_DEFAULT_PORT,
+      ...this.getClientOptions(),
+      lazyConnect: true,
     });
   }
 
-  public handleError(client: RedisClient) {
+  public handleError(client: Redis) {
     client.addListener(ERROR_EVENT, (err: any) => this.logger.error(err));
   }
 
-  public getClientOptions(error$: Subject<Error>): Partial<ClientOpts> {
-    const retry_strategy = (options: RetryStrategyOptions) =>
-      this.createRetryStrategy(options, error$);
+  public getClientOptions(): Partial<RedisOptions['options']> {
+    const retryStrategy = (times: number) => this.createRetryStrategy(times);
 
     return {
       ...(this.options || {}),
-      retry_strategy,
+      retryStrategy,
     };
   }
 
-  public createRetryStrategy(
-    options: RetryStrategyOptions,
-    error$: Subject<Error>,
-  ): undefined | number | Error {
-    if (options.error && (options.error as any).code === ECONNREFUSED) {
-      error$.error(options.error);
-    }
+  public createRetryStrategy(times: number): undefined | number {
     if (this.isExplicitlyTerminated) {
       return undefined;
     }
     if (
       !this.getOptionsProp(this.options, 'retryAttempts') ||
-      options.attempt > this.getOptionsProp(this.options, 'retryAttempts')
+      times > this.getOptionsProp(this.options, 'retryAttempts')
     ) {
-      return new Error('Retry time exhausted');
+      this.logger.error('Retry time exhausted');
+      return;
     }
     return this.getOptionsProp(this.options, 'retryDelay') || 0;
   }
diff --git a/packages/microservices/client/client-rmq.ts b/packages/microservices/client/client-rmq.ts
index 04498e18f..a8b1e64fd 100644
--- a/packages/microservices/client/client-rmq.ts
+++ b/packages/microservices/client/client-rmq.ts
@@ -3,8 +3,9 @@ import { loadPackage } from '@nestjs/common/utils/load-package.util';
 import { randomStringGenerator } from '@nestjs/common/utils/random-string-generator.util';
 import { EventEmitter } from 'events';
 import { EmptyError, fromEvent, lastValueFrom, merge, Observable } from 'rxjs';
-import { first, map, share, switchMap } from 'rxjs/operators';
+import { first, map, retryWhen, scan, share, switchMap } from 'rxjs/operators';
 import {
+  CONNECT_FAILED_EVENT,
   DISCONNECTED_RMQ_MESSAGE,
   DISCONNECT_EVENT,
   ERROR_EVENT,
@@ -110,12 +111,28 @@ export class ClientRMQ extends ClientProxy {
     instance: any,
     source$: Observable<T>,
   ): Observable<T> {
-    const close$ = fromEvent(instance, DISCONNECT_EVENT).pipe(
-      map((err: any) => {
-        throw err;
-      }),
+    const eventToError = (eventType: string) =>
+      fromEvent(instance, eventType).pipe(
+        map((err: any) => {
+          throw err;
+        }),
+      );
+    const disconnect$ = eventToError(DISCONNECT_EVENT);
+
+    const urls = this.getOptionsProp(this.options, 'urls', []);
+    const connectFailed$ = eventToError(CONNECT_FAILED_EVENT).pipe(
+      retryWhen(e =>
+        e.pipe(
+          scan((errorCount, error: any) => {
+            if (urls.indexOf(error.url) >= urls.length - 1) {
+              throw error;
+            }
+            return errorCount + 1;
+          }, 0),
+        ),
+      ),
     );
-    return merge(source$, close$).pipe(first());
+    return merge(source$, disconnect$, connectFailed$).pipe(first());
   }
 
   public async setupChannel(channel: any, resolve: Function) {
@@ -218,14 +235,17 @@ export class ClientRMQ extends ClientProxy {
     const serializedPacket: ReadPacket & Partial<RmqRecord> =
       this.serializer.serialize(packet);
 
+    const options = serializedPacket.options;
+    delete serializedPacket.options;
+
     return new Promise<void>((resolve, reject) =>
       this.channel.sendToQueue(
         this.queue,
         Buffer.from(JSON.stringify(serializedPacket)),
         {
           persistent: this.persistent,
-          ...serializedPacket.options,
-          headers: this.mergeHeaders(serializedPacket.options?.headers),
+          ...options,
+          headers: this.mergeHeaders(options?.headers),
         },
         (err: unknown) => (err ? reject(err) : resolve()),
       ),
diff --git a/packages/microservices/client/client-tcp.ts b/packages/microservices/client/client-tcp.ts
index f16c6407c..840452c8f 100644
--- a/packages/microservices/client/client-tcp.ts
+++ b/packages/microservices/client/client-tcp.ts
@@ -1,4 +1,4 @@
-import { Logger } from '@nestjs/common';
+import { Logger, Type } from '@nestjs/common';
 import * as net from 'net';
 import { EmptyError, lastValueFrom } from 'rxjs';
 import { share, tap } from 'rxjs/operators';
@@ -10,7 +10,7 @@ import {
   TCP_DEFAULT_HOST,
   TCP_DEFAULT_PORT,
 } from '../constants';
-import { JsonSocket } from '../helpers/json-socket';
+import { JsonSocket, TcpSocket } from '../helpers';
 import { PacketId, ReadPacket, WritePacket } from '../interfaces';
 import { TcpClientOptions } from '../interfaces/client-metadata.interface';
 import { ClientProxy } from './client-proxy';
@@ -20,20 +20,23 @@ export class ClientTCP extends ClientProxy {
   private readonly logger = new Logger(ClientTCP.name);
   private readonly port: number;
   private readonly host: string;
+  private readonly socketClass: Type<TcpSocket>;
   private isConnected = false;
-  private socket: JsonSocket;
+  private socket: TcpSocket;
 
   constructor(options: TcpClientOptions['options']) {
     super();
     this.port = this.getOptionsProp(options, 'port') || TCP_DEFAULT_PORT;
     this.host = this.getOptionsProp(options, 'host') || TCP_DEFAULT_HOST;
+    this.socketClass =
+      this.getOptionsProp(options, 'socketClass') || JsonSocket;
 
     this.initializeSerializer(options);
     this.initializeDeserializer(options);
   }
 
   public connect(): Promise<any> {
-    if (this.isConnected && this.connection) {
+    if (this.connection) {
       return this.connection;
     }
     this.socket = this.createSocket();
@@ -80,8 +83,8 @@ export class ClientTCP extends ClientProxy {
     });
   }
 
-  public createSocket(): JsonSocket {
-    return new JsonSocket(new net.Socket());
+  public createSocket(): TcpSocket {
+    return new this.socketClass(new net.Socket());
   }
 
   public close() {
@@ -89,7 +92,7 @@ export class ClientTCP extends ClientProxy {
     this.handleClose();
   }
 
-  public bindEvents(socket: JsonSocket) {
+  public bindEvents(socket: TcpSocket) {
     socket.on(
       ERROR_EVENT,
       (err: any) => err.code !== ECONNREFUSED && this.handleError(err),
@@ -104,6 +107,7 @@ export class ClientTCP extends ClientProxy {
   public handleClose() {
     this.isConnected = false;
     this.socket = null;
+    this.connection = undefined;
   }
 
   protected publish(
diff --git a/packages/microservices/constants.ts b/packages/microservices/constants.ts
index 7999319b4..2ae256805 100644
--- a/packages/microservices/constants.ts
+++ b/packages/microservices/constants.ts
@@ -2,7 +2,10 @@ import { ROUTE_ARGS_METADATA } from '@nestjs/common/constants';
 
 export const TCP_DEFAULT_PORT = 3000;
 export const TCP_DEFAULT_HOST = 'localhost';
-export const REDIS_DEFAULT_URL = 'redis://localhost:6379';
+
+export const REDIS_DEFAULT_PORT = 6379;
+export const REDIS_DEFAULT_HOST = 'localhost';
+
 export const NATS_DEFAULT_URL = 'nats://localhost:4222';
 export const MQTT_DEFAULT_URL = 'mqtt://localhost:1883';
 export const GRPC_DEFAULT_URL = 'localhost:5000';
@@ -11,6 +14,7 @@ export const KAFKA_DEFAULT_BROKER = 'localhost:9092';
 
 export const CONNECT_EVENT = 'connect';
 export const DISCONNECT_EVENT = 'disconnect';
+export const CONNECT_FAILED_EVENT = 'connectFailed';
 export const MESSAGE_EVENT = 'message';
 export const DATA_EVENT = 'data';
 export const ERROR_EVENT = 'error';
@@ -19,6 +23,7 @@ export const SUBSCRIBE = 'subscribe';
 export const CANCEL_EVENT = 'cancelled';
 
 export const PATTERN_METADATA = 'microservices:pattern';
+export const PATTERN_EXTRAS_METADATA = 'microservices:pattern_extras';
 export const TRANSPORT_METADATA = 'microservices:transport';
 export const CLIENT_CONFIGURATION_METADATA = 'microservices:client';
 export const PATTERN_HANDLER_METADATA = 'microservices:handler_type';
@@ -36,8 +41,10 @@ export const RQM_DEFAULT_NOACK = true;
 export const RQM_DEFAULT_PERSISTENT = false;
 export const GRPC_DEFAULT_PROTO_LOADER = '@grpc/proto-loader';
 
+export const NO_EVENT_HANDLER = (text: TemplateStringsArray, pattern: string) =>
+  `There is no matching event handler defined in the remote service. Event pattern: ${pattern}`;
 export const NO_MESSAGE_HANDLER = `There is no matching message handler defined in the remote service.`;
-export const NO_EVENT_HANDLER = `There is no matching event handler defined in the remote service.`;
+
 export const DISCONNECTED_RMQ_MESSAGE = `Disconnected from RMQ. Trying to reconnect.`;
 
 export const KAFKA_DEFAULT_CLIENT = 'nestjs-consumer';
@@ -50,3 +57,6 @@ export const MQTT_WILDCARD_ALL = '#';
 export const ECONNREFUSED = 'ECONNREFUSED';
 export const CONN_ERR = 'CONN_ERR';
 export const EADDRINUSE = 'EADDRINUSE';
+
+export const CONNECTION_FAILED_MESSAGE =
+  'Connection to transport failed. Trying to reconnect...';
diff --git a/packages/microservices/context/rpc-proxy.ts b/packages/microservices/context/rpc-proxy.ts
index 6d30b4591..521d5b7cd 100644
--- a/packages/microservices/context/rpc-proxy.ts
+++ b/packages/microservices/context/rpc-proxy.ts
@@ -1,6 +1,5 @@
-import { isFunction } from '@nestjs/common/utils/shared.utils';
 import { ExecutionContextHost } from '@nestjs/core/helpers/execution-context-host';
-import { Observable } from 'rxjs';
+import { isObservable, Observable } from 'rxjs';
 import { catchError } from 'rxjs/operators';
 import { RpcExceptionsHandler } from '../exceptions/rpc-exceptions-handler';
 
@@ -12,7 +11,7 @@ export class RpcProxy {
     return async (...args: unknown[]) => {
       try {
         const result = await targetCallback(...args);
-        return !this.isObservable(result)
+        return !isObservable(result)
           ? result
           : result.pipe(
               catchError(error =>
@@ -34,8 +33,4 @@ export class RpcProxy {
     host.setType('rpc');
     return exceptionsHandler.handle(error, host);
   }
-
-  isObservable(result: any): boolean {
-    return result && isFunction(result.subscribe);
-  }
 }
diff --git a/packages/microservices/ctx-host/index.ts b/packages/microservices/ctx-host/index.ts
index 923346e48..9d871dee2 100644
--- a/packages/microservices/ctx-host/index.ts
+++ b/packages/microservices/ctx-host/index.ts
@@ -4,3 +4,4 @@ export * from './nats.context';
 export * from './redis.context';
 export * from './rmq.context';
 export * from './tcp.context';
+export * from './base-rpc.context';
diff --git a/packages/microservices/ctx-host/kafka.context.ts b/packages/microservices/ctx-host/kafka.context.ts
index 922ccb9c5..54c80475a 100644
--- a/packages/microservices/ctx-host/kafka.context.ts
+++ b/packages/microservices/ctx-host/kafka.context.ts
@@ -1,7 +1,12 @@
-import { KafkaMessage } from '../external/kafka.interface';
+import { Consumer, KafkaMessage } from '../external/kafka.interface';
 import { BaseRpcContext } from './base-rpc.context';
 
-type KafkaContextArgs = [KafkaMessage, number, string];
+type KafkaContextArgs = [
+  message: KafkaMessage,
+  partition: number,
+  topic: string,
+  consumer: Consumer,
+];
 
 export class KafkaContext extends BaseRpcContext<KafkaContextArgs> {
   constructor(args: KafkaContextArgs) {
@@ -28,4 +33,11 @@ export class KafkaContext extends BaseRpcContext<KafkaContextArgs> {
   getTopic() {
     return this.args[2];
   }
+
+  /**
+   * Returns the Kafka consumer reference.
+   */
+  getConsumer() {
+    return this.args[3];
+  }
 }
diff --git a/packages/microservices/ctx-host/tcp.context.ts b/packages/microservices/ctx-host/tcp.context.ts
index a858ea442..1f1c6a28d 100644
--- a/packages/microservices/ctx-host/tcp.context.ts
+++ b/packages/microservices/ctx-host/tcp.context.ts
@@ -1,7 +1,7 @@
-import { JsonSocket } from '../helpers/json-socket';
+import { TcpSocket } from '../helpers';
 import { BaseRpcContext } from './base-rpc.context';
 
-type TcpContextArgs = [JsonSocket, string];
+type TcpContextArgs = [TcpSocket, string];
 
 export class TcpContext extends BaseRpcContext<TcpContextArgs> {
   constructor(args: TcpContextArgs) {
diff --git a/packages/microservices/decorators/event-pattern.decorator.ts b/packages/microservices/decorators/event-pattern.decorator.ts
index 5fe9561df..b44825d63 100644
--- a/packages/microservices/decorators/event-pattern.decorator.ts
+++ b/packages/microservices/decorators/event-pattern.decorator.ts
@@ -1,7 +1,14 @@
+import {
+  isObject,
+  isNumber,
+  isNil,
+  isSymbol,
+} from '@nestjs/common/utils/shared.utils';
 import {
   PATTERN_HANDLER_METADATA,
   PATTERN_METADATA,
   TRANSPORT_METADATA,
+  PATTERN_EXTRAS_METADATA,
 } from '../constants';
 import { PatternHandler } from '../enums/pattern-handler.enum';
 import { Transport } from '../enums';
@@ -9,22 +16,50 @@ import { Transport } from '../enums';
 /**
  * Subscribes to incoming events which fulfils chosen pattern.
  */
-export const EventPattern = <T = string>(
+export const EventPattern: {
+  <T = string>(metadata?: T): MethodDecorator;
+  <T = string>(metadata?: T, transport?: Transport | symbol): MethodDecorator;
+  <T = string>(metadata?: T, extras?: Record<string, any>): MethodDecorator;
+  <T = string>(
+    metadata?: T,
+    transport?: Transport | symbol,
+    extras?: Record<string, any>,
+  ): MethodDecorator;
+} = <T = string>(
   metadata?: T,
-  transport?: Transport,
+  transportOrExtras?: Transport | symbol | Record<string, any>,
+  maybeExtras?: Record<string, any>,
 ): MethodDecorator => {
+  let transport: Transport | symbol;
+  let extras: Record<string, any>;
+  if (
+    (isNumber(transportOrExtras) || isSymbol(transportOrExtras)) &&
+    isNil(maybeExtras)
+  ) {
+    transport = transportOrExtras;
+  } else if (isObject(transportOrExtras) && isNil(maybeExtras)) {
+    extras = transportOrExtras;
+  } else {
+    transport = transportOrExtras as Transport | symbol;
+    extras = maybeExtras;
+  }
   return (
     target: object,
     key: string | symbol,
     descriptor: PropertyDescriptor,
   ) => {
-    Reflect.defineMetadata(PATTERN_METADATA, metadata, descriptor.value);
+    Reflect.defineMetadata(
+      PATTERN_METADATA,
+      [].concat(metadata),
+      descriptor.value,
+    );
     Reflect.defineMetadata(
       PATTERN_HANDLER_METADATA,
       PatternHandler.EVENT,
       descriptor.value,
     );
     Reflect.defineMetadata(TRANSPORT_METADATA, transport, descriptor.value);
+    Reflect.defineMetadata(PATTERN_EXTRAS_METADATA, extras, descriptor.value);
     return descriptor;
   };
 };
diff --git a/packages/microservices/decorators/message-pattern.decorator.ts b/packages/microservices/decorators/message-pattern.decorator.ts
index 936d76703..6cb4ed1d8 100644
--- a/packages/microservices/decorators/message-pattern.decorator.ts
+++ b/packages/microservices/decorators/message-pattern.decorator.ts
@@ -1,8 +1,15 @@
+import {
+  isObject,
+  isNumber,
+  isNil,
+  isSymbol,
+} from '@nestjs/common/utils/shared.utils';
 /* eslint-disable @typescript-eslint/no-use-before-define */
 import {
   PATTERN_HANDLER_METADATA,
   PATTERN_METADATA,
   TRANSPORT_METADATA,
+  PATTERN_EXTRAS_METADATA,
 } from '../constants';
 import { PatternHandler } from '../enums/pattern-handler.enum';
 import { PatternMetadata } from '../interfaces/pattern-metadata.interface';
@@ -17,22 +24,56 @@ export enum GrpcMethodStreamingType {
 /**
  * Subscribes to incoming messages which fulfils chosen pattern.
  */
-export const MessagePattern = <T = PatternMetadata | string>(
+export const MessagePattern: {
+  <T = PatternMetadata | string>(metadata?: T): MethodDecorator;
+  <T = PatternMetadata | string>(
+    metadata?: T,
+    transport?: Transport | symbol,
+  ): MethodDecorator;
+  <T = PatternMetadata | string>(
+    metadata?: T,
+    extras?: Record<string, any>,
+  ): MethodDecorator;
+  <T = PatternMetadata | string>(
+    metadata?: T,
+    transport?: Transport | symbol,
+    extras?: Record<string, any>,
+  ): MethodDecorator;
+} = <T = PatternMetadata | string>(
   metadata?: T,
-  transport?: Transport,
+  transportOrExtras?: Transport | symbol | Record<string, any>,
+  maybeExtras?: Record<string, any>,
 ): MethodDecorator => {
+  let transport: Transport | symbol;
+  let extras: Record<string, any>;
+  if (
+    (isNumber(transportOrExtras) || isSymbol(transportOrExtras)) &&
+    isNil(maybeExtras)
+  ) {
+    transport = transportOrExtras;
+  } else if (isObject(transportOrExtras) && isNil(maybeExtras)) {
+    extras = transportOrExtras;
+  } else {
+    transport = transportOrExtras as Transport | symbol;
+    extras = maybeExtras;
+  }
   return (
     target: object,
     key: string | symbol,
     descriptor: PropertyDescriptor,
   ) => {
-    Reflect.defineMetadata(PATTERN_METADATA, metadata, descriptor.value);
+    Reflect.defineMetadata(
+      PATTERN_METADATA,
+      [].concat(metadata),
+      descriptor.value,
+    );
     Reflect.defineMetadata(
       PATTERN_HANDLER_METADATA,
       PatternHandler.MESSAGE,
       descriptor.value,
     );
     Reflect.defineMetadata(TRANSPORT_METADATA, transport, descriptor.value);
+    Reflect.defineMetadata(PATTERN_EXTRAS_METADATA, extras, descriptor.value);
     return descriptor;
   };
 };
diff --git a/packages/microservices/deserializers/kafka-request.deserializer.ts b/packages/microservices/deserializers/kafka-request.deserializer.ts
new file mode 100644
index 000000000..99dae3119
--- /dev/null
+++ b/packages/microservices/deserializers/kafka-request.deserializer.ts
@@ -0,0 +1,21 @@
+import { IncomingEvent, IncomingRequest } from '../interfaces';
+import { KafkaRequest } from '../serializers/kafka-request.serializer';
+import { IncomingRequestDeserializer } from './incoming-request.deserializer';
+
+export class KafkaRequestDeserializer extends IncomingRequestDeserializer {
+  mapToSchema(
+    data: KafkaRequest,
+    options?: Record<string, any>,
+  ): IncomingRequest | IncomingEvent {
+    if (!options) {
+      return {
+        pattern: undefined,
+        data: undefined,
+      };
+    }
+    return {
+      pattern: options.channel,
+      data: data?.value ?? data,
+    };
+  }
+}
diff --git a/packages/microservices/exceptions/base-rpc-exception-filter.ts b/packages/microservices/exceptions/base-rpc-exception-filter.ts
index d7783d40b..1c42d24b6 100644
--- a/packages/microservices/exceptions/base-rpc-exception-filter.ts
+++ b/packages/microservices/exceptions/base-rpc-exception-filter.ts
@@ -17,7 +17,7 @@ export class BaseRpcExceptionFilter<T = any, R = any>
     }
     const res = exception.getError();
     const message = isObject(res) ? res : { status, message: res };
-    return _throw(message);
+    return _throw(() => message);
   }
 
   public handleUnknownError(exception: T, status: string) {
@@ -29,7 +29,7 @@ export class BaseRpcExceptionFilter<T = any, R = any>
     const logger = BaseRpcExceptionFilter.logger;
     logger.error.apply(logger, loggerArgs as any);
 
-    return _throw({ status, message: errorMessage });
+    return _throw(() => ({ status, message: errorMessage }));
   }
 
   public isError(exception: any): exception is Error {
diff --git a/packages/microservices/exceptions/index.ts b/packages/microservices/exceptions/index.ts
index dd6e4d298..73e4c3176 100644
--- a/packages/microservices/exceptions/index.ts
+++ b/packages/microservices/exceptions/index.ts
@@ -1,2 +1,3 @@
 export * from './base-rpc-exception-filter';
+export * from './kafka-retriable-exception';
 export * from './rpc-exception';
diff --git a/packages/microservices/exceptions/kafka-retriable-exception.ts b/packages/microservices/exceptions/kafka-retriable-exception.ts
new file mode 100644
index 000000000..c62194a2e
--- /dev/null
+++ b/packages/microservices/exceptions/kafka-retriable-exception.ts
@@ -0,0 +1,17 @@
+import { RpcException } from './rpc-exception';
+
+/**
+ * Exception that instructs Kafka driver to instead of introspecting
+ * error processing flow and sending serialized error message to the consumer,
+ * force bubble it up to the "eachMessage" callback of the underlying "kafkajs" package
+ * (even if interceptors are applied, or an observable stream is returned from the message handler).
+ *
+ * A transient exception that if retried may succeed.
+ *
+ * @publicApi
+ */
+export class KafkaRetriableException extends RpcException {
+  public getError(): string | object {
+    return this;
+  }
+}
diff --git a/packages/microservices/external/grpc-options.interface.ts b/packages/microservices/external/grpc-options.interface.ts
index f00fb4cb7..3c5bd22c2 100644
--- a/packages/microservices/external/grpc-options.interface.ts
+++ b/packages/microservices/external/grpc-options.interface.ts
@@ -16,5 +16,5 @@ export interface ChannelOptions {
   'grpc.max_reconnect_backoff_ms'?: number;
   'grpc.use_local_subchannel_pool'?: number;
   'grpc-node.max_session_memory'?: number;
-  [key: string]: string | number | undefined;
+  [key: string]: any;
 }
diff --git a/packages/microservices/external/redis.interface.ts b/packages/microservices/external/redis.interface.ts
index 00ae1bba7..6de36c439 100644
--- a/packages/microservices/external/redis.interface.ts
+++ b/packages/microservices/external/redis.interface.ts
@@ -1,383 +1,213 @@
-/* eslint-disable @typescript-eslint/adjacent-overload-signatures */
+import { ConnectionOptions } from 'tls';
 
-export interface RetryStrategyOptions {
-  error: Error;
-  total_retry_time: number;
-  times_connected: number;
-  attempt: number;
-}
+/**
+ * @see https://github.dev/luin/ioredis/blob/df04dd8d87a44d3b64b385c86581915248554508/lib/redis/RedisOptions.ts#L184
+ */
+export interface IORedisOptions {
+  Connector?: any;
+  retryStrategy?: (times: number) => number | void | null;
+
+  /**
+   * If a command does not return a reply within a set number of milliseconds,
+   * a "Command timed out" error will be thrown.
+   */
+  commandTimeout?: number;
+  /**
+   * Enable/disable keep-alive functionality.
+   * @link https://nodejs.org/api/net.html#socketsetkeepaliveenable-initialdelay
+   * @default 0
+   */
+  keepAlive?: number;
+
+  /**
+   * Enable/disable the use of Nagle's algorithm.
+   * @link https://nodejs.org/api/net.html#socketsetnodelaynodelay
+   * @default true
+   */
+  noDelay?: boolean;
+
+  /**
+   * Set the name of the connection to make it easier to identity the connection
+   * in client list.
+   * @link https://redis.io/commands/client-setname
+   */
+  connectionName?: string;
+
+  /**
+   * If set, client will send AUTH command with the value of this option as the first argument when connected.
+   * This is supported since Redis 6.
+   */
+  username?: string;
 
-export interface ClientOpts {
-  auth_pass?: string;
-  command_queue_high_water?: number;
-  command_queue_low_water?: number;
-  connect_timeout?: number;
-  db?: string;
-  detect_buffers?: boolean;
-  disable_resubscribing?: boolean;
-  enable_offline_queue?: boolean;
-  family?: string;
-  host?: string;
-  max_attempts?: number;
-  no_ready_check?: boolean;
-  parser?: string;
+  /**
+   * If set, client will send AUTH command with the value of this option when connected.
+   */
   password?: string;
-  path?: string;
-  port?: number;
-  prefix?: string;
-  rename_commands?: any;
-  retry_max_delay?: number;
-  retry_strategy?: any;
-  retry_unfulfilled_commands?: boolean;
-  return_buffers?: boolean;
-  socket_keepalive?: boolean;
-  socket_nodelay?: boolean;
-  string_numbers?: boolean;
-  tls?: any;
-  url?: string;
-}
 
-export interface RedisClient {
-  // event: connect
-  // event: error
-  // event: message
-  // event: pmessage
-  // event: subscribe
-  // event: psubscribe
-  // event: unsubscribe
-  // event: punsubscribe
+  /**
+   * Database index to use.
+   *
+   * @default 0
+   */
+  db?: number;
 
-  connected: boolean;
-  retry_delay: number;
-  retry_backoff: number;
-  command_queue: any[];
-  offline_queue: any[];
-  server_info: any;
+  /**
+   * When the client reconnects, channels subscribed in the previous connection will be
+   * resubscribed automatically if `autoResubscribe` is `true`.
+   * @default true
+   */
+  autoResubscribe?: boolean;
 
   /**
-   * Forcibly close the connection to the Redis server. Note that this does not wait until all replies have been parsed. If you want to exit cleanly, call client.quit()
+   * Whether or not to resend unfulfilled commands on reconnect.
+   * Unfulfilled commands are most likely to be blocking commands such as `brpop` or `blpop`.
+   * @default true
+   */
+  autoResendUnfulfilledCommands?: boolean;
+  /**
+   * Whether or not to reconnect on certain Redis errors.
+   * This options by default is `null`, which means it should never reconnect on Redis errors.
+   * You can pass a function that accepts an Redis error, and returns:
+   * - `true` or `1` to trigger a reconnection.
+   * - `false` or `0` to not reconnect.
+   * - `2` to reconnect and resend the failed command (who triggered the error) after reconnection.
+   * @example
+   * ```js
+   * const redis = new Redis({
+   *   reconnectOnError(err) {
+   *     const targetError = "READONLY";
+   *     if (err.message.includes(targetError)) {
+   *       // Only reconnect when the error contains "READONLY"
+   *       return true; // or `return 1;`
+   *     }
+   *   },
+   * });
+   * ```
+   * @default null
+   */
+  reconnectOnError?: ((err: Error) => boolean | 1 | 2) | null;
+
+  /**
+   * @default false
+   */
+  readOnly?: boolean;
+  /**
+   * When enabled, numbers returned by Redis will be converted to JavaScript strings instead of numbers.
+   * This is necessary if you want to handle big numbers (above `Number.MAX_SAFE_INTEGER` === 2^53).
+   * @default false
+   */
+  stringNumbers?: boolean;
+
+  /**
+   * How long the client will wait before killing a socket due to inactivity during initial connection.
+   * @default 10000
+   */
+  connectTimeout?: number;
+
+  /**
+   * This option is used internally when you call `redis.monitor()` to tell Redis
+   * to enter the monitor mode when the connection is established.
    *
-   * @param {boolean} flush You should set flush to true, if you are not absolutely sure you do not care about any other commands. If you set flush to false all still running commands will silently fail.
+   * @default false
    */
-  end(flush: boolean): void;
-  unref(): void;
+  monitor?: boolean;
 
   /**
-   * Stop sending commands and queue the commands.
+   * The commands that don't get a reply due to the connection to the server is lost are
+   * put into a queue and will be resent on reconnect (if allowed by the `retryStrategy` option).
+   * This option is used to configure how many reconnection attempts should be allowed before
+   * the queue is flushed with a `MaxRetriesPerRequestError` error.
+   * Set this options to `null` instead of a number to let commands wait forever
+   * until the connection is alive again.
+   *
+   * @default 20
    */
-  cork(): void;
+  maxRetriesPerRequest?: number | null;
 
   /**
-   * Resume and send the queued commands at once.
+   * @default 10000
    */
-  uncork(): void;
+  maxLoadingRetryTime?: number;
+  /**
+   * @default false
+   */
+  enableAutoPipelining?: boolean;
+  /**
+   * @default []
+   */
+  autoPipeliningIgnoredCommands?: string[];
+  offlineQueue?: boolean;
+  commandQueue?: boolean;
 
-  // Low level command execution
-  send_command(command: string, ...args: any[]): boolean;
+  /**
+   *
+   * By default, if the connection to Redis server has not been established, commands are added to a queue
+   * and are executed once the connection is "ready" (when `enableReadyCheck` is true, "ready" means
+   * the Redis server has loaded the database from disk, otherwise means the connection to the Redis
+   * server has been established). If this option is false, when execute the command when the connection
+   * isn't ready, an error will be returned.
+   *
+   * @default true
+   */
+  enableOfflineQueue?: boolean;
 
-  // Connection (http://redis.io/commands#connection)
-  auth(password: string, callback?: any): boolean;
-  ping(callback?: any): boolean;
+  /**
+   * The client will sent an INFO command to check whether the server is still loading data from the disk (
+   * which happens when the server is just launched) when the connection is established, and only wait until
+   * the loading process is finished before emitting the `ready` event.
+   *
+   * @default true
+   */
+  enableReadyCheck?: boolean;
 
-  // Strings (http://redis.io/commands#strings)
-  append(key: string, value: string, callback?: any): boolean;
-  bitcount(key: string, callback?: any): boolean;
-  bitcount(key: string, start: number, end: number, callback?: any): boolean;
-  set(key: string, value: string, callback?: any): boolean;
-  get(key: string, callback?: any): boolean;
-  exists(key: string, value: string, callback?: any): boolean;
+  /**
+   * When a Redis instance is initialized, a connection to the server is immediately established. Set this to
+   * true will delay the connection to the server until the first command is sent or `redis.connect()` is called
+   * explicitly.
+   *
+   * @default false
+   */
 
-  publish(channel: string, value: any): boolean;
-  subscribe(channel: string): boolean;
-  on(event: string, callback: Function): any;
-  off(event: string, callback: Function): any;
-  addListener(event: string, callback: Function): any;
+  lazyConnect?: boolean;
 
-  /*
-   commands = set_union([
-   "get", "set", "setnx", "setex", "append", "strlen", "del", "exists", "setbit", "getbit", "setrange", "getrange", "substr",
-   "incr", "decr", "mget", "rpush", "lpush", "rpushx", "lpushx", "linsert", "rpop", "lpop", "brpop", "brpoplpush", "blpop", "llen", "lindex",
-   "lset", "lrange", "ltrim", "lrem", "rpoplpush", "sadd", "srem", "smove", "sismember", "scard", "spop", "srandmember", "sinter", "sinterstore",
-   "sunion", "sunionstore", "sdiff", "sdiffstore", "smembers", "zadd", "zincrby", "zrem", "zremrangebyscore", "zremrangebyrank", "zunionstore",
-   "zinterstore", "zrange", "zrangebyscore", "zrevrangebyscore", "zcount", "zrevrange", "zcard", "zscore", "zrank", "zrevrank", "hset", "hsetnx",
-   "hget", "hmset", "hmget", "hincrby", "hincrbyfloat", "hdel", "hlen", "hkeys", "hvals", "hgetall", "hexists", "incrby", "decrby", "getset", "mset", "msetnx",
-   "randomkey", "select", "move", "rename", "renamenx", "expire", "expireat", "keys", "dbsize", "auth", "ping", "echo", "save", "bgsave",
-   "bgrewriteaof", "shutdown", "lastsave", "type", "any", "exec", "discard", "sync", "flushdb", "flushall", "sort", "info", "monitor", "ttl",
-   "persist", "slaveof", "debug", "config", "subscribe", "unsubscribe", "psubscribe", "punsubscribe", "publish", "watch", "unwatch", "cluster",
-   "restore", "migrate", "dump", "object", "client", "eval", "evalsha"], require("./lib/commands"));
+  /**
+   * @default undefined
    */
+  scripts?: Record<
+    string,
+    { lua: string; numberOfKeys?: number; readOnly?: boolean }
+  >;
 
-  get(args: any[], callback?: any): boolean;
-  get(...args: any[]): boolean;
-  set(args: any[], callback?: any): boolean;
-  set(...args: any[]): boolean;
-  setnx(args: any[], callback?: any): boolean;
-  setnx(...args: any[]): boolean;
-  setex(args: any[], callback?: any): boolean;
-  setex(...args: any[]): boolean;
-  append(args: any[], callback?: any): boolean;
-  append(...args: any[]): boolean;
-  strlen(args: any[], callback?: any): boolean;
-  strlen(...args: any[]): boolean;
-  del(args: any[], callback?: any): boolean;
-  del(...args: any[]): boolean;
-  exists(args: any[], callback?: any): boolean;
-  exists(...args: any[]): boolean;
-  setbit(args: any[], callback?: any): boolean;
-  setbit(...args: any[]): boolean;
-  getbit(args: any[], callback?: any): boolean;
-  getbit(...args: any[]): boolean;
-  setrange(args: any[], callback?: any): boolean;
-  setrange(...args: any[]): boolean;
-  getrange(args: any[], callback?: any): boolean;
-  getrange(...args: any[]): boolean;
-  substr(args: any[], callback?: any): boolean;
-  substr(...args: any[]): boolean;
-  incr(args: any[], callback?: any): boolean;
-  incr(...args: any[]): boolean;
-  decr(args: any[], callback?: any): boolean;
-  decr(...args: any[]): boolean;
-  mget(args: any[], callback?: any): boolean;
-  mget(...args: any[]): boolean;
-  rpush(...args: any[]): boolean;
-  lpush(args: any[], callback?: any): boolean;
-  lpush(...args: any[]): boolean;
-  rpushx(args: any[], callback?: any): boolean;
-  rpushx(...args: any[]): boolean;
-  lpushx(args: any[], callback?: any): boolean;
-  lpushx(...args: any[]): boolean;
-  linsert(args: any[], callback?: any): boolean;
-  linsert(...args: any[]): boolean;
-  rpop(args: any[], callback?: any): boolean;
-  rpop(...args: any[]): boolean;
-  lpop(args: any[], callback?: any): boolean;
-  lpop(...args: any[]): boolean;
-  brpop(args: any[], callback?: any): boolean;
-  brpop(...args: any[]): boolean;
-  brpoplpush(args: any[], callback?: any): boolean;
-  brpoplpush(...args: any[]): boolean;
-  blpop(args: any[], callback?: any): boolean;
-  blpop(...args: any[]): boolean;
-  llen(args: any[], callback?: any): boolean;
-  llen(...args: any[]): boolean;
-  lindex(args: any[], callback?: any): boolean;
-  lindex(...args: any[]): boolean;
-  lset(args: any[], callback?: any): boolean;
-  lset(...args: any[]): boolean;
-  lrange(args: any[], callback?: any): boolean;
-  lrange(...args: any[]): boolean;
-  ltrim(args: any[], callback?: any): boolean;
-  ltrim(...args: any[]): boolean;
-  lrem(args: any[], callback?: any): boolean;
-  lrem(...args: any[]): boolean;
-  rpoplpush(args: any[], callback?: any): boolean;
-  rpoplpush(...args: any[]): boolean;
-  sadd(args: any[], callback?: any): boolean;
-  sadd(...args: any[]): boolean;
-  srem(args: any[], callback?: any): boolean;
-  srem(...args: any[]): boolean;
-  smove(args: any[], callback?: any): boolean;
-  smove(...args: any[]): boolean;
-  sismember(args: any[], callback?: any): boolean;
-  sismember(...args: any[]): boolean;
-  scard(args: any[], callback?: any): boolean;
-  scard(...args: any[]): boolean;
-  spop(args: any[], callback?: any): boolean;
-  spop(...args: any[]): boolean;
-  srandmember(args: any[], callback?: any): boolean;
-  srandmember(...args: any[]): boolean;
-  sinter(args: any[], callback?: any): boolean;
-  sinter(...args: any[]): boolean;
-  sinterstore(args: any[], callback?: any): boolean;
-  sinterstore(...args: any[]): boolean;
-  sunion(args: any[], callback?: any): boolean;
-  sunion(...args: any[]): boolean;
-  sunionstore(args: any[], callback?: any): boolean;
-  sunionstore(...args: any[]): boolean;
-  sdiff(args: any[], callback?: any): boolean;
-  sdiff(...args: any[]): boolean;
-  sdiffstore(args: any[], callback?: any): boolean;
-  sdiffstore(...args: any[]): boolean;
-  smembers(args: any[], callback?: any): boolean;
-  smembers(...args: any[]): boolean;
-  zadd(args: any[], callback?: any): boolean;
-  zadd(...args: any[]): boolean;
-  zincrby(args: any[], callback?: any): boolean;
-  zincrby(...args: any[]): boolean;
-  zrem(args: any[], callback?: any): boolean;
-  zrem(...args: any[]): boolean;
-  zremrangebyscore(args: any[], callback?: any): boolean;
-  zremrangebyscore(...args: any[]): boolean;
-  zremrangebyrank(args: any[], callback?: any): boolean;
-  zremrangebyrank(...args: any[]): boolean;
-  zunionstore(args: any[], callback?: any): boolean;
-  zunionstore(...args: any[]): boolean;
-  zinterstore(args: any[], callback?: any): boolean;
-  zinterstore(...args: any[]): boolean;
-  zrange(args: any[], callback?: any): boolean;
-  zrange(...args: any[]): boolean;
-  zrangebyscore(args: any[], callback?: any): boolean;
-  zrangebyscore(...args: any[]): boolean;
-  zrevrangebyscore(args: any[], callback?: any): boolean;
-  zrevrangebyscore(...args: any[]): boolean;
-  zcount(args: any[], callback?: any): boolean;
-  zcount(...args: any[]): boolean;
-  zrevrange(args: any[], callback?: any): boolean;
-  zrevrange(...args: any[]): boolean;
-  zcard(args: any[], callback?: any): boolean;
-  zcard(...args: any[]): boolean;
-  zscore(args: any[], callback?: any): boolean;
-  zscore(...args: any[]): boolean;
-  zrank(args: any[], callback?: any): boolean;
-  zrank(...args: any[]): boolean;
-  zrevrank(args: any[], callback?: any): boolean;
-  zrevrank(...args: any[]): boolean;
-  hset(args: any[], callback?: any): boolean;
-  hset(...args: any[]): boolean;
-  hsetnx(args: any[], callback?: any): boolean;
-  hsetnx(...args: any[]): boolean;
-  hget(args: any[], callback?: any): boolean;
-  hget(...args: any[]): boolean;
-  hmset(args: any[], callback?: any): boolean;
-  hmset(key: string, hash: any, callback?: any): boolean;
-  hmset(...args: any[]): boolean;
-  hmget(args: any[], callback?: any): boolean;
-  hmget(...args: any[]): boolean;
-  hincrby(args: any[], callback?: any): boolean;
-  hincrby(...args: any[]): boolean;
-  hincrbyfloat(args: any[], callback?: any): boolean;
-  hincrbyfloat(...args: any[]): boolean;
-  hdel(args: any[], callback?: any): boolean;
-  hdel(...args: any[]): boolean;
-  hlen(args: any[], callback?: any): boolean;
-  hlen(...args: any[]): boolean;
-  hkeys(args: any[], callback?: any): boolean;
-  hkeys(...args: any[]): boolean;
-  hvals(args: any[], callback?: any): boolean;
-  hvals(...args: any[]): boolean;
-  hgetall(args: any[], callback?: any): boolean;
-  hgetall(...args: any[]): boolean;
-  hgetall(key: string, callback?: any): boolean;
-  hexists(args: any[], callback?: any): boolean;
-  hexists(...args: any[]): boolean;
-  incrby(args: any[], callback?: any): boolean;
-  incrby(...args: any[]): boolean;
-  decrby(args: any[], callback?: any): boolean;
-  decrby(...args: any[]): boolean;
-  getset(args: any[], callback?: any): boolean;
-  getset(...args: any[]): boolean;
-  mset(args: any[], callback?: any): boolean;
-  mset(...args: any[]): boolean;
-  msetnx(args: any[], callback?: any): boolean;
-  msetnx(...args: any[]): boolean;
-  randomkey(args: any[], callback?: any): boolean;
-  randomkey(...args: any[]): boolean;
-  select(args: any[], callback?: any): void;
-  select(...args: any[]): void;
-  move(args: any[], callback?: any): boolean;
-  move(...args: any[]): boolean;
-  rename(args: any[], callback?: any): boolean;
-  rename(...args: any[]): boolean;
-  renamenx(args: any[], callback?: any): boolean;
-  renamenx(...args: any[]): boolean;
-  expire(args: any[], callback?: any): boolean;
-  expire(...args: any[]): boolean;
-  expireat(args: any[], callback?: any): boolean;
-  expireat(...args: any[]): boolean;
-  keys(args: any[], callback?: any): boolean;
-  keys(...args: any[]): boolean;
-  dbsize(args: any[], callback?: any): boolean;
-  dbsize(...args: any[]): boolean;
-  auth(args: any[], callback?: any): void;
-  auth(...args: any[]): void;
-  ping(args: any[], callback?: any): boolean;
-  ping(...args: any[]): boolean;
-  echo(args: any[], callback?: any): boolean;
-  echo(...args: any[]): boolean;
-  save(args: any[], callback?: any): boolean;
-  save(...args: any[]): boolean;
-  bgsave(args: any[], callback?: any): boolean;
-  bgsave(...args: any[]): boolean;
-  bgrewriteaof(args: any[], callback?: any): boolean;
-  bgrewriteaof(...args: any[]): boolean;
-  shutdown(args: any[], callback?: any): boolean;
-  shutdown(...args: any[]): boolean;
-  lastsave(args: any[], callback?: any): boolean;
-  lastsave(...args: any[]): boolean;
-  type(args: any[], callback?: any): boolean;
-  type(...args: any[]): boolean;
-  any(args: any[], callback?: any): any;
-  any(...args: any[]): any;
-  exec(args: any[], callback?: any): boolean;
-  exec(...args: any[]): boolean;
-  discard(args: any[], callback?: any): boolean;
-  discard(...args: any[]): boolean;
-  sync(args: any[], callback?: any): boolean;
-  sync(...args: any[]): boolean;
-  flushdb(args: any[], callback?: any): boolean;
-  flushdb(...args: any[]): boolean;
-  flushall(args: any[], callback?: any): boolean;
-  flushall(...args: any[]): boolean;
-  sort(args: any[], callback?: any): boolean;
-  sort(...args: any[]): boolean;
-  info(args: any[], callback?: any): boolean;
-  info(...args: any[]): boolean;
-  monitor(args: any[], callback?: any): boolean;
-  monitor(...args: any[]): boolean;
-  ttl(args: any[], callback?: any): boolean;
-  ttl(...args: any[]): boolean;
-  persist(args: any[], callback?: any): boolean;
-  persist(...args: any[]): boolean;
-  slaveof(args: any[], callback?: any): boolean;
-  slaveof(...args: any[]): boolean;
-  debug(args: any[], callback?: any): boolean;
-  debug(...args: any[]): boolean;
-  config(args: any[], callback?: any): boolean;
-  config(...args: any[]): boolean;
-  subscribe(args: any[], callback?: any): boolean;
-  subscribe(...args: any[]): boolean;
-  unsubscribe(args: any[], callback?: any): boolean;
-  unsubscribe(...args: any[]): boolean;
-  psubscribe(args: any[], callback?: any): boolean;
-  psubscribe(...args: any[]): boolean;
-  punsubscribe(args: any[], callback?: any): boolean;
-  punsubscribe(...args: any[]): boolean;
-  publish(args: any[], callback?: any): boolean;
-  publish(...args: any[]): boolean;
-  watch(args: any[], callback?: any): boolean;
-  watch(...args: any[]): boolean;
-  unwatch(args: any[], callback?: any): boolean;
-  unwatch(...args: any[]): boolean;
-  cluster(args: any[], callback?: any): boolean;
-  cluster(...args: any[]): boolean;
-  restore(args: any[], callback?: any): boolean;
-  restore(...args: any[]): boolean;
-  migrate(args: any[], callback?: any): boolean;
-  migrate(...args: any[]): boolean;
-  dump(args: any[], callback?: any): boolean;
-  dump(...args: any[]): boolean;
-  object(args: any[], callback?: any): boolean;
-  object(...args: any[]): boolean;
-  client(args: any[], callback?: any): boolean;
-  client(...args: any[]): boolean;
-  eval(args: any[], callback?: any): boolean;
-  eval(...args: any[]): boolean;
-  evalsha(args: any[], callback?: any): boolean;
-  evalsha(...args: any[]): boolean;
-  script(args: any[], callback?: any): boolean;
-  script(...args: any[]): boolean;
-  script(key: string, callback?: any): boolean;
-  quit(args: any[], callback?: any): boolean;
-  quit(...args: any[]): boolean;
-  sscan(...args: any[]): boolean;
-  sscan(args: any[], callback?: any): boolean;
-  scan(...args: any[]): boolean;
-  scan(args: any[], callback?: any): boolean;
-  hscan(...args: any[]): boolean;
-  hscan(args: any[], callback?: any): boolean;
-  zscan(...args: any[]): boolean;
-  zscan(args: any[], callback?: any): boolean;
+  keyPrefix?: string;
+  showFriendlyErrorStack?: boolean;
 
-  // Extras
-  duplicate(options?: any[], callback?: any): RedisClient;
+  // StandaloneConnectionOptions
+  disconnectTimeout?: number;
+  tls?: ConnectionOptions;
+
+  // SentinelConnectionOptions
+  /**
+   * Master group name of the Sentinel
+   */
+  name?: string;
+  /**
+   * @default "master"
+   */
+  role?: 'master' | 'slave';
+  sentinelUsername?: string;
+  sentinelPassword?: string;
+  sentinels?: Array<Partial<any>>;
+  sentinelRetryStrategy?: (retryAttempts: number) => number | void | null;
+  sentinelReconnectStrategy?: (retryAttempts: number) => number | void | null;
+  preferredSlaves?: any;
+  sentinelCommandTimeout?: number;
+  enableTLSForSentinelMode?: boolean;
+  sentinelTLS?: ConnectionOptions;
+  natMap?: any;
+  updateSentinels?: boolean;
+  /**
+   * @default 10
+   */
+  sentinelMaxConnections?: number;
+  failoverDetector?: boolean;
 }
diff --git a/packages/microservices/helpers/index.ts b/packages/microservices/helpers/index.ts
index a02fe778e..ff6118b51 100644
--- a/packages/microservices/helpers/index.ts
+++ b/packages/microservices/helpers/index.ts
@@ -2,3 +2,4 @@ export * from './json-socket';
 export * from './kafka-logger';
 export * from './kafka-parser';
 export * from './kafka-reply-partition-assigner';
+export * from './tcp-socket';
diff --git a/packages/microservices/helpers/json-socket.ts b/packages/microservices/helpers/json-socket.ts
index 0320e0dbc..5d017f9b5 100644
--- a/packages/microservices/helpers/json-socket.ts
+++ b/packages/microservices/helpers/json-socket.ts
@@ -1,83 +1,29 @@
-import { Socket } from 'net';
+import { Buffer } from 'buffer';
 import { StringDecoder } from 'string_decoder';
-import {
-  CLOSE_EVENT,
-  CONNECT_EVENT,
-  DATA_EVENT,
-  ERROR_EVENT,
-  MESSAGE_EVENT,
-} from '../constants';
 import { CorruptedPacketLengthException } from '../errors/corrupted-packet-length.exception';
-import { InvalidJSONFormatException } from '../errors/invalid-json-format.exception';
-import { NetSocketClosedException } from '../errors/net-socket-closed.exception';
+import { TcpSocket } from './tcp-socket';
 
-export class JsonSocket {
+export class JsonSocket extends TcpSocket {
   private contentLength: number | null = null;
-  private isClosed = false;
   private buffer = '';
 
   private readonly stringDecoder = new StringDecoder();
-  private readonly delimeter = '#';
+  private readonly delimiter = '#';
 
-  public get netSocket() {
-    return this.socket;
-  }
-
-  constructor(public readonly socket: Socket) {
-    this.socket.on(DATA_EVENT, this.onData.bind(this));
-    this.socket.on(CONNECT_EVENT, () => (this.isClosed = false));
-    this.socket.on(CLOSE_EVENT, () => (this.isClosed = true));
-    this.socket.on(ERROR_EVENT, () => (this.isClosed = true));
-  }
-
-  public connect(port: number, host: string) {
-    this.socket.connect(port, host);
-    return this;
-  }
-
-  public on(event: string, callback: (err?: any) => void) {
-    this.socket.on(event, callback);
-    return this;
-  }
-
-  public once(event: string, callback: (err?: any) => void) {
-    this.socket.once(event, callback);
-    return this;
-  }
-
-  public end() {
-    this.socket.end();
-    return this;
-  }
-
-  public sendMessage(message: any, callback?: (err?: any) => void) {
-    if (this.isClosed) {
-      callback && callback(new NetSocketClosedException());
-      return;
-    }
+  protected handleSend(message: any, callback?: (err?: any) => void) {
     this.socket.write(this.formatMessageData(message), 'utf-8', callback);
   }
 
-  private onData(dataRaw: Buffer | string) {
+  protected handleData(dataRaw: Buffer | string) {
     const data = Buffer.isBuffer(dataRaw)
       ? this.stringDecoder.write(dataRaw)
       : dataRaw;
-
-    try {
-      this.handleData(data);
-    } catch (e) {
-      this.socket.emit(ERROR_EVENT, e.message);
-      this.socket.end();
-    }
-  }
-
-  private handleData(data: string) {
     this.buffer += data;
 
     if (this.contentLength == null) {
-      const i = this.buffer.indexOf(this.delimeter);
+      const i = this.buffer.indexOf(this.delimiter);
       /**
-       * Check if the buffer has the delimeter (#),
+       * Check if the buffer has the delimiter (#),
        * if not, the end of the buffer string might be in the middle of a content length string
        */
       if (i !== -1) {
@@ -95,36 +41,27 @@ export class JsonSocket {
 
     if (this.contentLength !== null) {
       const length = this.buffer.length;
-
       if (length === this.contentLength) {
         this.handleMessage(this.buffer);
       } else if (length > this.contentLength) {
         const message = this.buffer.substring(0, this.contentLength);
         const rest = this.buffer.substring(this.contentLength);
         this.handleMessage(message);
-        this.onData(rest);
+        this.handleData(rest);
       }
     }
   }
 
-  private handleMessage(data: string) {
+  private handleMessage(message: any) {
     this.contentLength = null;
     this.buffer = '';
-
-    let message: Record<string, unknown>;
-    try {
-      message = JSON.parse(data);
-    } catch (e) {
-      throw new InvalidJSONFormatException(e, data);
-    }
-    message = message || {};
-    this.socket.emit(MESSAGE_EVENT, message);
+    this.emitMessage(message);
   }
 
   private formatMessageData(message: any) {
     const messageData = JSON.stringify(message);
     const length = messageData.length;
-    const data = length + this.delimeter + messageData;
+    const data = length + this.delimiter + messageData;
     return data;
   }
 }
diff --git a/packages/microservices/helpers/tcp-socket.ts b/packages/microservices/helpers/tcp-socket.ts
new file mode 100644
index 000000000..cca8fe94d
--- /dev/null
+++ b/packages/microservices/helpers/tcp-socket.ts
@@ -0,0 +1,78 @@
+import { Buffer } from 'buffer';
+import { Socket } from 'net';
+import {
+  CLOSE_EVENT,
+  CONNECT_EVENT,
+  DATA_EVENT,
+  ERROR_EVENT,
+  MESSAGE_EVENT,
+} from '../constants';
+import { NetSocketClosedException } from '../errors/net-socket-closed.exception';
+import { InvalidJSONFormatException } from '../errors/invalid-json-format.exception';
+
+export abstract class TcpSocket {
+  private isClosed = false;
+
+  public get netSocket() {
+    return this.socket;
+  }
+
+  constructor(public readonly socket: Socket) {
+    this.socket.on(DATA_EVENT, this.onData.bind(this));
+    this.socket.on(CONNECT_EVENT, () => (this.isClosed = false));
+    this.socket.on(CLOSE_EVENT, () => (this.isClosed = true));
+    this.socket.on(ERROR_EVENT, () => (this.isClosed = true));
+  }
+
+  public connect(port: number, host: string) {
+    this.socket.connect(port, host);
+    return this;
+  }
+
+  public on(event: string, callback: (err?: any) => void) {
+    this.socket.on(event, callback);
+    return this;
+  }
+
+  public once(event: string, callback: (err?: any) => void) {
+    this.socket.once(event, callback);
+    return this;
+  }
+
+  public end() {
+    this.socket.end();
+    return this;
+  }
+
+  public sendMessage(message: any, callback?: (err?: any) => void) {
+    if (this.isClosed) {
+      callback && callback(new NetSocketClosedException());
+      return;
+    }
+    this.handleSend(message, callback);
+  }
+
+  protected abstract handleSend(message: any, callback?: (err?: any) => void);
+
+  private onData(data: Buffer) {
+    try {
+      this.handleData(data);
+    } catch (e) {
+      this.socket.emit(ERROR_EVENT, e.message);
+      this.socket.end();
+    }
+  }
+
+  protected abstract handleData(data: Buffer | string);
+
+  protected emitMessage(data: string) {
+    let message: Record<string, unknown>;
+    try {
+      message = JSON.parse(data);
+    } catch (e) {
+      throw new InvalidJSONFormatException(e, data);
+    }
+    message = message || {};
+    this.socket.emit(MESSAGE_EVENT, message);
+  }
+}
diff --git a/packages/microservices/index.ts b/packages/microservices/index.ts
index 81f4992ef..886c0be72 100644
--- a/packages/microservices/index.ts
+++ b/packages/microservices/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @microservices
- * Copyright(c) 2017 - 2021 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2022 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
diff --git a/packages/microservices/interfaces/client-metadata.interface.ts b/packages/microservices/interfaces/client-metadata.interface.ts
index 4962eecc1..ace44c265 100644
--- a/packages/microservices/interfaces/client-metadata.interface.ts
+++ b/packages/microservices/interfaces/client-metadata.interface.ts
@@ -1,5 +1,6 @@
 import { Type } from '@nestjs/common';
 import { ClientProxy } from '../client';
+import { TcpSocket } from '../helpers';
 import { Transport } from '../enums/transport.enum';
 import { Deserializer } from './deserializer.interface';
 import {
@@ -33,5 +34,6 @@ export interface TcpClientOptions {
     port?: number;
     serializer?: Serializer;
     deserializer?: Deserializer;
+    socketClass?: Type<TcpSocket>;
   };
 }
diff --git a/packages/microservices/interfaces/custom-transport-strategy.interface.ts b/packages/microservices/interfaces/custom-transport-strategy.interface.ts
index b5d5b2760..358d77b97 100644
--- a/packages/microservices/interfaces/custom-transport-strategy.interface.ts
+++ b/packages/microservices/interfaces/custom-transport-strategy.interface.ts
@@ -1,7 +1,7 @@
 import { Transport } from '../enums';
 
 export interface CustomTransportStrategy {
-  readonly transportId?: Transport;
+  readonly transportId?: Transport | symbol;
   listen(callback: (...optionalParams: unknown[]) => any): any;
   close(): any;
 }
diff --git a/packages/microservices/interfaces/message-handler.interface.ts b/packages/microservices/interfaces/message-handler.interface.ts
index f93896d78..00aecaa6e 100644
--- a/packages/microservices/interfaces/message-handler.interface.ts
+++ b/packages/microservices/interfaces/message-handler.interface.ts
@@ -1,7 +1,13 @@
 import { Observable } from 'rxjs';
 
 export interface MessageHandler<TInput = any, TContext = any, TResult = any> {
-  (data: TInput, ctx?: TContext): Promise<Observable<TResult>>;
-  next?: (data: TInput, ctx?: TContext) => Promise<Observable<TResult>>;
+  (data: TInput, ctx?: TContext):
+    | Promise<Observable<TResult>>
+    | Promise<TResult>;
+  next?: (
+    data: TInput,
+    ctx?: TContext,
+  ) => Promise<Observable<TResult>> | Promise<TResult>;
   isEventHandler?: boolean;
+  extras?: Record<string, any>;
 }
diff --git a/packages/microservices/interfaces/microservice-configuration.interface.ts b/packages/microservices/interfaces/microservice-configuration.interface.ts
index 9942b8b55..f167a414c 100644
--- a/packages/microservices/interfaces/microservice-configuration.interface.ts
+++ b/packages/microservices/interfaces/microservice-configuration.interface.ts
@@ -1,3 +1,4 @@
+import { Type } from '@nestjs/common';
 import { Transport } from '../enums/transport.enum';
 import { ChannelOptions } from '../external/grpc-options.interface';
 import {
@@ -9,8 +10,9 @@ import {
   ProducerRecord,
 } from '../external/kafka.interface';
 import { MqttClientOptions, QoS } from '../external/mqtt-options.interface';
-import { ClientOpts } from '../external/redis.interface';
+import { IORedisOptions } from '../external/redis.interface';
 import { RmqUrl } from '../external/rmq-url.interface';
+import { TcpSocket } from '../helpers';
 import { CustomTransportStrategy } from './custom-transport-strategy.interface';
 import { Deserializer } from './deserializer.interface';
 import { Serializer } from './serializer.interface';
@@ -33,9 +35,6 @@ export interface CustomStrategy {
 export interface GrpcOptions {
   transport?: Transport.GRPC;
   options: {
-    interceptors?: Array<
-      (options: any, nextCall: (options: any) => any) => any
-    >;
     url?: string;
     maxSendMessageLength?: number;
     maxReceiveMessageLength?: number;
@@ -80,6 +79,7 @@ export interface TcpOptions {
     retryDelay?: number;
     serializer?: Serializer;
     deserializer?: Deserializer;
+    socketClass?: Type<TcpSocket>;
   };
 }
 
@@ -91,7 +91,7 @@ export interface RedisOptions {
     retryDelay?: number;
     serializer?: Serializer;
     deserializer?: Deserializer;
-  } & ClientOpts;
+  } & IORedisOptions;
 }
 
 export interface MqttOptions {
@@ -191,6 +191,9 @@ export interface KafkaParserConfig {
 export interface KafkaOptions {
   transport?: Transport.KAFKA;
   options?: {
+    /**
+     * Defaults to `"-server"` on server side and `"-client"` on client side.
+     */
     postfixId?: string;
     client?: KafkaConfig;
     consumer?: ConsumerConfig;
@@ -201,5 +204,6 @@ export interface KafkaOptions {
     serializer?: Serializer;
     deserializer?: Deserializer;
     parser?: KafkaParserConfig;
+    producerOnlyMode?: boolean;
   };
 }
diff --git a/packages/microservices/interfaces/serializer.interface.ts b/packages/microservices/interfaces/serializer.interface.ts
index 6674cd6b1..f8d0c8c25 100644
--- a/packages/microservices/interfaces/serializer.interface.ts
+++ b/packages/microservices/interfaces/serializer.interface.ts
@@ -5,7 +5,7 @@ import {
 } from './packet.interface';
 
 export interface Serializer<TInput = any, TOutput = any> {
-  serialize(value: TInput): TOutput;
+  serialize(value: TInput, options?: Record<string, any>): TOutput;
 }
 
 export type ProducerSerializer = Serializer<
diff --git a/packages/microservices/listener-metadata-explorer.ts b/packages/microservices/listener-metadata-explorer.ts
index 322780ad5..66ddffaf0 100644
--- a/packages/microservices/listener-metadata-explorer.ts
+++ b/packages/microservices/listener-metadata-explorer.ts
@@ -7,6 +7,7 @@ import {
   PATTERN_HANDLER_METADATA,
   PATTERN_METADATA,
   TRANSPORT_METADATA,
+  PATTERN_EXTRAS_METADATA,
 } from './constants';
 import { Transport } from './enums';
 import { PatternHandler } from './enums/pattern-handler.enum';
@@ -19,11 +20,12 @@ export interface ClientProperties {
 }
 
 export interface EventOrMessageListenerDefinition {
-  pattern: PatternMetadata;
+  patterns: PatternMetadata[];
   methodKey: string;
   isEventHandler: boolean;
   targetCallback: (...args: any[]) => any;
   transport?: Transport;
+  extras?: Record<string, any>;
 }
 
 export interface MessageRequestProperties {
@@ -56,13 +58,15 @@ export class ListenerMetadataExplorer {
     if (isUndefined(handlerType)) {
       return;
     }
-    const pattern = Reflect.getMetadata(PATTERN_METADATA, targetCallback);
+    const patterns = Reflect.getMetadata(PATTERN_METADATA, targetCallback);
     const transport = Reflect.getMetadata(TRANSPORT_METADATA, targetCallback);
+    const extras = Reflect.getMetadata(PATTERN_EXTRAS_METADATA, targetCallback);
     return {
       methodKey,
       targetCallback,
-      pattern,
+      patterns,
       transport,
+      extras,
       isEventHandler: handlerType === PatternHandler.EVENT,
     };
   }
diff --git a/packages/microservices/listeners-controller.ts b/packages/microservices/listeners-controller.ts
index 1f3c307a8..df275cb11 100644
--- a/packages/microservices/listeners-controller.ts
+++ b/packages/microservices/listeners-controller.ts
@@ -71,48 +71,68 @@ export class ListenersController {
           isUndefined(server.transportId) ||
           transport === server.transportId,
       )
-      .forEach(({ pattern, targetCallback, methodKey, isEventHandler }) => {
-        if (isStatic) {
-          const proxy = this.contextCreator.create(
-            instance as object,
-            targetCallback,
+      .reduce((acc, handler) => {
+        // Optional chaining for backward-compatibility
+        handler.patterns?.forEach(pattern =>
+          acc.push({ ...handler, patterns: [pattern] }),
+        );
+        return acc;
+      }, [])
+      .forEach(
+        ({
+          patterns: [pattern],
+          targetCallback,
+          methodKey,
+          extras,
+          isEventHandler,
+        }) => {
+          if (isStatic) {
+            const proxy = this.contextCreator.create(
+              instance as object,
+              targetCallback,
+              moduleKey,
+              methodKey,
+              STATIC_CONTEXT,
+              undefined,
+              defaultCallMetadata,
+            );
+            if (isEventHandler) {
+              const eventHandler: MessageHandler = (...args: unknown[]) => {
+                const originalArgs = args;
+                const [dataOrContextHost] = originalArgs;
+                if (dataOrContextHost instanceof RequestContextHost) {
+                  args = args.slice(1, args.length);
+                }
+                const originalReturnValue = proxy(...args);
+                const returnedValueWrapper = eventHandler.next?.(
+                  ...(originalArgs as Parameters<MessageHandler>),
+                );
+                returnedValueWrapper?.then(returnedValue =>
+                  this.connectIfStream(returnedValue as Observable<unknown>),
+                );
+                return originalReturnValue;
+              };
+              return server.addHandler(
+                pattern,
+                eventHandler,
+                isEventHandler,
+                extras,
+              );
+            } else {
+              return server.addHandler(pattern, proxy, isEventHandler, extras);
+            }
+          }
+          const asyncHandler = this.createRequestScopedHandler(
+            instanceWrapper,
+            pattern,
+            moduleRef,
             moduleKey,
             methodKey,
-            STATIC_CONTEXT,
-            undefined,
             defaultCallMetadata,
           );
-          if (isEventHandler) {
-            const eventHandler: MessageHandler = (...args: unknown[]) => {
-              const originalArgs = args;
-              const [dataOrContextHost] = originalArgs;
-              if (dataOrContextHost instanceof RequestContextHost) {
-                args = args.slice(1, args.length);
-              }
-              const originalReturnValue = proxy(...args);
-              const returnedValueWrapper = eventHandler.next?.(
-                ...(originalArgs as Parameters<MessageHandler>),
-              );
-              returnedValueWrapper?.then(returnedValue =>
-                this.connectIfStream(returnedValue as Observable<unknown>),
-              );
-              return originalReturnValue;
-            };
-            return server.addHandler(pattern, eventHandler, isEventHandler);
-          } else {
-            return server.addHandler(pattern, proxy, isEventHandler);
-          }
-        }
-        const asyncHandler = this.createRequestScopedHandler(
-          instanceWrapper,
-          pattern,
-          moduleRef,
-          moduleKey,
-          methodKey,
-          defaultCallMetadata,
-        );
-        server.addHandler(pattern, asyncHandler, isEventHandler);
-      });
+          server.addHandler(pattern, asyncHandler, isEventHandler, extras);
+        },
+      );
   }
 
   public assignClientsToProperties(instance: Controller | Injectable) {
diff --git a/packages/microservices/microservices-module.ts b/packages/microservices/microservices-module.ts
index 735fda9fe..54632e412 100644
--- a/packages/microservices/microservices-module.ts
+++ b/packages/microservices/microservices-module.ts
@@ -24,13 +24,12 @@ export class MicroservicesModule {
   private listenersController: ListenersController;
 
   public register(container: NestContainer, config: ApplicationConfig) {
-    const rpcProxy = new RpcProxy();
     const exceptionFiltersContext = new ExceptionFiltersContext(
       container,
       config,
     );
     const contextCreator = new RpcContextCreator(
-      rpcProxy,
+      new RpcProxy(),
       exceptionFiltersContext,
       new PipesContextCreator(container, config),
       new PipesConsumer(),
diff --git a/packages/microservices/nest-microservice.ts b/packages/microservices/nest-microservice.ts
index be5a79c5f..dbaf19800 100644
--- a/packages/microservices/nest-microservice.ts
+++ b/packages/microservices/nest-microservice.ts
@@ -136,13 +136,6 @@ export class NestMicroservice
     });
   }
 
-  public async listenAsync(): Promise<any> {
-    this.logger.warn(
-      'DEPRECATED! "listenAsync" method is deprecated and will be removed in the next major release. Please, use "listen" instead.',
-    );
-    return this.listen();
-  }
-
   public async close(): Promise<any> {
     await this.server.close();
     if (this.isTerminated) {
diff --git a/packages/microservices/package-lock.json b/packages/microservices/package-lock.json
new file mode 100644
index 000000000..486c9213a
Binary files /dev/null and b/packages/microservices/package-lock.json differ
diff --git a/packages/microservices/package.json b/packages/microservices/package.json
index 3f3a31c82..de74338ac 100644
--- a/packages/microservices/package.json
+++ b/packages/microservices/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/microservices",
-  "version": "8.2.3",
+  "version": "8.4.7",
   "description": "Nest - modern, fast, powerful node.js web framework (@microservices)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -18,12 +18,11 @@
   },
   "dependencies": {
     "iterare": "1.2.1",
-    "json-socket": "0.3.0",
-    "tslib": "2.3.1"
+    "tslib": "2.4.0"
   },
   "devDependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3"
+    "@nestjs/common": "8.4.7",
+    "@nestjs/core": "8.4.7"
   },
   "peerDependencies": {
     "@grpc/grpc-js": "*",
diff --git a/packages/microservices/serializers/kafka-request.serializer.ts b/packages/microservices/serializers/kafka-request.serializer.ts
index cfe73b2ab..732275497 100644
--- a/packages/microservices/serializers/kafka-request.serializer.ts
+++ b/packages/microservices/serializers/kafka-request.serializer.ts
@@ -13,8 +13,10 @@ export interface KafkaRequest<T = any> {
   headers: Record<string, any>;
 }
 
-export class KafkaRequestSerializer implements Serializer<any, KafkaRequest> {
-  serialize(value: any): KafkaRequest {
+export class KafkaRequestSerializer
+  implements Serializer<any, KafkaRequest | Promise<KafkaRequest>>
+{
+  serialize(value: any) {
     const isNotKafkaMessage =
       isNil(value) ||
       !isObject(value) ||
diff --git a/packages/microservices/serializers/mqtt-record.serializer.ts b/packages/microservices/serializers/mqtt-record.serializer.ts
index 18c0bb161..2120c99b8 100644
--- a/packages/microservices/serializers/mqtt-record.serializer.ts
+++ b/packages/microservices/serializers/mqtt-record.serializer.ts
@@ -1,3 +1,4 @@
+import { isObject } from '@nestjs/common/utils/shared.utils';
 import { ReadPacket } from '../interfaces';
 import { Serializer } from '../interfaces/serializer.interface';
 import { MqttRecord } from '../record-builders';
@@ -8,7 +9,7 @@ export class MqttRecordSerializer
   serialize(packet: ReadPacket | any): ReadPacket & Partial<MqttRecord> {
     if (
       packet?.data &&
-      typeof packet.data === 'object' &&
+      isObject(packet.data) &&
       packet.data instanceof MqttRecord
     ) {
       const record = packet.data as MqttRecord;
diff --git a/packages/microservices/serializers/nats-record.serializer.ts b/packages/microservices/serializers/nats-record.serializer.ts
index f1dc9a8df..77f9a4bab 100644
--- a/packages/microservices/serializers/nats-record.serializer.ts
+++ b/packages/microservices/serializers/nats-record.serializer.ts
@@ -1,4 +1,5 @@
 import { loadPackage } from '@nestjs/common/utils/load-package.util';
+import { isObject } from '@nestjs/common/utils/shared.utils';
 import { NatsCodec } from '../external/nats-client.interface';
 import { ReadPacket } from '../interfaces';
 import { Serializer } from '../interfaces/serializer.interface';
@@ -20,9 +21,7 @@ export class NatsRecordSerializer
 
   serialize(packet: ReadPacket | any): NatsRecord {
     const natsMessage =
-      packet?.data &&
-      typeof packet.data === 'object' &&
-      packet.data instanceof NatsRecord
+      packet?.data && isObject(packet.data) && packet.data instanceof NatsRecord
         ? (packet.data as NatsRecord)
         : new NatsRecordBuilder(packet?.data).build();
 
diff --git a/packages/microservices/serializers/rmq-record.serializer.ts b/packages/microservices/serializers/rmq-record.serializer.ts
index 0d85426bb..8039c2f1c 100644
--- a/packages/microservices/serializers/rmq-record.serializer.ts
+++ b/packages/microservices/serializers/rmq-record.serializer.ts
@@ -1,3 +1,4 @@
+import { isObject } from '@nestjs/common/utils/shared.utils';
 import { ReadPacket } from '../interfaces';
 import { Serializer } from '../interfaces/serializer.interface';
 import { RmqRecord } from '../record-builders';
@@ -8,7 +9,7 @@ export class RmqRecordSerializer
   serialize(packet: ReadPacket | any): ReadPacket & Partial<RmqRecord> {
     if (
       packet?.data &&
-      typeof packet.data === 'object' &&
+      isObject(packet.data) &&
       packet.data instanceof RmqRecord
     ) {
       const record = packet.data as RmqRecord;
diff --git a/packages/microservices/server/server-grpc.ts b/packages/microservices/server/server-grpc.ts
index 9606765ad..f88154cf1 100644
--- a/packages/microservices/server/server-grpc.ts
+++ b/packages/microservices/server/server-grpc.ts
@@ -220,10 +220,10 @@ export class ServerGrpc extends Server implements CustomTransportStrategy {
   public createUnaryServiceMethod(methodHandler: Function): Function {
     return async (call: GrpcCall, callback: Function) => {
       const handler = methodHandler(call.request, call.metadata, call);
-      this.transformToObservable(await handler).subscribe(
-        data => callback(null, data),
-        (err: any) => callback(err),
-      );
+      this.transformToObservable(await handler).subscribe({
+        next: data => callback(null, data),
+        error: (err: any) => callback(err),
+      });
     };
   }
 
@@ -292,7 +292,7 @@ export class ServerGrpc extends Server implements CustomTransportStrategy {
           ),
         );
 
-        if (typeof response !== 'undefined') {
+        if (!isUndefined(response)) {
           callback(null, response);
         }
       }
diff --git a/packages/microservices/server/server-kafka.ts b/packages/microservices/server/server-kafka.ts
index 4715ed57a..2a426eaf6 100644
--- a/packages/microservices/server/server-kafka.ts
+++ b/packages/microservices/server/server-kafka.ts
@@ -1,14 +1,17 @@
 import { Logger } from '@nestjs/common/services/logger.service';
 import { isNil } from '@nestjs/common/utils/shared.utils';
-import { Observable } from 'rxjs';
+import { isObservable, lastValueFrom, Observable, ReplaySubject } from 'rxjs';
 import {
   KAFKA_DEFAULT_BROKER,
   KAFKA_DEFAULT_CLIENT,
   KAFKA_DEFAULT_GROUP,
+  NO_EVENT_HANDLER,
   NO_MESSAGE_HANDLER,
 } from '../constants';
 import { KafkaContext } from '../ctx-host';
+import { KafkaRequestDeserializer } from '../deserializers/kafka-request.deserializer';
 import { KafkaHeaders, Transport } from '../enums';
+import { KafkaRetriableException } from '../exceptions';
 import {
   BrokersFunction,
   Consumer,
@@ -26,6 +29,7 @@ import {
   CustomTransportStrategy,
   KafkaOptions,
   OutgoingResponse,
+  ReadPacket,
 } from '../interfaces';
 import { KafkaRequestSerializer } from '../serializers/kafka-request.serializer';
 import { Server } from './server';
@@ -53,7 +57,7 @@ export class ServerKafka extends Server implements CustomTransportStrategy {
     const consumerOptions =
       this.getOptionsProp(this.options, 'consumer') || ({} as ConsumerConfig);
     const postfixId =
-      this.getOptionsProp(this.options, 'postfixId') || '-server';
+      this.getOptionsProp(this.options, 'postfixId') ?? '-server';
 
     this.brokers = clientOptions.brokers || [KAFKA_DEFAULT_BROKER];
 
@@ -162,10 +166,12 @@ export class ServerKafka extends Server implements CustomTransportStrategy {
       rawMessage,
       payload.partition,
       payload.topic,
+      this.consumer,
     ]);
+    const handler = this.getHandlerByPattern(packet.pattern);
     // if the correlation id or reply topic is not set
     // then this is an event (events could still have correlation id)
-    if (!correlationId || !replyTopic) {
+    if (handler?.isEventHandler || !correlationId || !replyTopic) {
       return this.handleEvent(packet.pattern, packet, kafkaContext);
     }
 
@@ -174,7 +180,7 @@ export class ServerKafka extends Server implements CustomTransportStrategy {
       replyPartition,
       correlationId,
     );
-    const handler = this.getHandlerByPattern(packet.pattern);
+
     if (!handler) {
       return publish({
         id: correlationId,
@@ -184,17 +190,47 @@ export class ServerKafka extends Server implements CustomTransportStrategy {
 
     const response$ = this.transformToObservable(
       await handler(packet.data, kafkaContext),
-    ) as Observable<any>;
-    response$ && this.send(response$, publish);
+    );
+
+    const replayStream$ = new ReplaySubject();
+    await this.combineStreamsAndThrowIfRetriable(response$, replayStream$);
+
+    this.send(replayStream$, publish);
   }
 
-  public sendMessage(
+  private combineStreamsAndThrowIfRetriable(
+    response$: Observable<any>,
+    replayStream$: ReplaySubject<unknown>,
+  ) {
+    return new Promise<void>((resolve, reject) => {
+      let isPromiseResolved = false;
+      response$.subscribe({
+        next: val => {
+          replayStream$.next(val);
+          if (!isPromiseResolved) {
+            isPromiseResolved = true;
+            resolve();
+          }
+        },
+        error: err => {
+          if (err instanceof KafkaRetriableException && !isPromiseResolved) {
+            isPromiseResolved = true;
+            reject(err);
+          }
+          replayStream$.error(err);
+        },
+        complete: () => replayStream$.complete(),
+      });
+    });
+  }
+
+  public async sendMessage(
     message: OutgoingResponse,
     replyTopic: string,
     replyPartition: string,
     correlationId: string,
   ): Promise<RecordMetadata[]> {
-    const outgoingMessage = this.serializer.serialize(message.response);
+    const outgoingMessage = await this.serializer.serialize(message.response);
     this.assignReplyPartition(replyPartition, outgoingMessage);
     this.assignCorrelationIdHeader(correlationId, outgoingMessage);
     this.assignErrorHeader(message, outgoingMessage);
@@ -227,9 +263,12 @@ export class ServerKafka extends Server implements CustomTransportStrategy {
     if (!outgoingResponse.err) {
       return;
     }
-    outgoingMessage.headers[KafkaHeaders.NEST_ERR] = Buffer.from(
-      outgoingResponse.err,
-    );
+    const stringifiedError =
+      typeof outgoingResponse.err === 'object'
+        ? JSON.stringify(outgoingResponse.err)
+        : outgoingResponse.err;
+    outgoingMessage.headers[KafkaHeaders.NEST_ERR] =
+      Buffer.from(stringifiedError);
   }
 
   public assignCorrelationIdHeader(
@@ -250,8 +289,27 @@ export class ServerKafka extends Server implements CustomTransportStrategy {
     outgoingMessage.partition = parseFloat(replyPartition);
   }
 
+  public async handleEvent(
+    pattern: string,
+    packet: ReadPacket,
+    context: KafkaContext,
+  ): Promise<any> {
+    const handler = this.getHandlerByPattern(pattern);
+    if (!handler) {
+      return this.logger.error(NO_EVENT_HANDLER`${pattern}`);
+    }
+    const resultOrStream = await handler(packet.data, context);
+    if (isObservable(resultOrStream)) {
+      await lastValueFrom(resultOrStream);
+    }
+  }
+
   protected initializeSerializer(options: KafkaOptions['options']) {
     this.serializer =
       (options && options.serializer) || new KafkaRequestSerializer();
   }
+
+  protected initializeDeserializer(options: KafkaOptions['options']) {
+    this.deserializer = options?.deserializer ?? new KafkaRequestDeserializer();
+  }
 }
diff --git a/packages/microservices/server/server-mqtt.ts b/packages/microservices/server/server-mqtt.ts
index b57c6c519..46a647a7a 100644
--- a/packages/microservices/server/server-mqtt.ts
+++ b/packages/microservices/server/server-mqtt.ts
@@ -1,5 +1,4 @@
 import { isUndefined } from '@nestjs/common/utils/shared.utils';
-import { Observable } from 'rxjs';
 import {
   CONNECT_EVENT,
   ERROR_EVENT,
@@ -123,7 +122,7 @@ export class ServerMqtt extends Server implements CustomTransportStrategy {
     }
     const response$ = this.transformToObservable(
       await handler(packet.data, mqttContext),
-    ) as Observable<any>;
+    );
     response$ && this.send(response$, publish);
   }
 
@@ -191,18 +190,25 @@ export class ServerMqtt extends Server implements CustomTransportStrategy {
 
     for (const [key, value] of this.messageHandlers) {
       if (
-        key.indexOf(MQTT_WILDCARD_SINGLE) === -1 &&
-        key.indexOf(MQTT_WILDCARD_ALL) === -1
+        !key.includes(MQTT_WILDCARD_SINGLE) &&
+        !key.includes(MQTT_WILDCARD_ALL)
       ) {
         continue;
       }
-      if (this.matchMqttPattern(key, route)) {
+      const keyWithoutSharedPrefix = this.removeHandlerKeySharedPrefix(key);
+      if (this.matchMqttPattern(keyWithoutSharedPrefix, route)) {
         return value;
       }
     }
     return null;
   }
 
+  public removeHandlerKeySharedPrefix(handlerKey: string) {
+    return handlerKey && handlerKey.startsWith('$share')
+      ? handlerKey.split('/').slice(2).join('/')
+      : handlerKey;
+  }
+
   public getRequestPattern(pattern: string): string {
     return pattern;
   }
diff --git a/packages/microservices/server/server-nats.ts b/packages/microservices/server/server-nats.ts
index 266b96a14..768fe3664 100644
--- a/packages/microservices/server/server-nats.ts
+++ b/packages/microservices/server/server-nats.ts
@@ -1,4 +1,4 @@
-import { isUndefined } from '@nestjs/common/utils/shared.utils';
+import { isUndefined, isObject } from '@nestjs/common/utils/shared.utils';
 import { Observable } from 'rxjs';
 import { NATS_DEFAULT_URL, NO_MESSAGE_HANDLER } from '../constants';
 import { NatsContext } from '../ctx-host/nats.context';
@@ -109,7 +109,7 @@ export class ServerNats extends Server implements CustomTransportStrategy {
     }
     const response$ = this.transformToObservable(
       await handler(message.data, natsCtx),
-    ) as Observable<any>;
+    );
     response$ && this.send(response$, publish);
   }
 
@@ -134,7 +134,7 @@ export class ServerNats extends Server implements CustomTransportStrategy {
   public async handleStatusUpdates(client: Client) {
     for await (const status of client.status()) {
       const data =
-        status.data && typeof status.data === 'object'
+        status.data && isObject(status.data)
           ? JSON.stringify(status.data)
           : status.data;
       if (status.type === 'disconnect' || status.type === 'error') {
diff --git a/packages/microservices/server/server-redis.ts b/packages/microservices/server/server-redis.ts
index 085849d09..6e5530165 100644
--- a/packages/microservices/server/server-redis.ts
+++ b/packages/microservices/server/server-redis.ts
@@ -1,41 +1,37 @@
 import { isUndefined } from '@nestjs/common/utils/shared.utils';
 import { Observable } from 'rxjs';
 import {
-  CONNECT_EVENT,
   ERROR_EVENT,
   MESSAGE_EVENT,
   NO_MESSAGE_HANDLER,
-  REDIS_DEFAULT_URL,
+  REDIS_DEFAULT_HOST,
+  REDIS_DEFAULT_PORT,
 } from '../constants';
 import { RedisContext } from '../ctx-host';
 import { Transport } from '../enums';
 import {
-  ClientOpts,
-  RedisClient,
-  RetryStrategyOptions,
-} from '../external/redis.interface';
-import { CustomTransportStrategy, IncomingRequest } from '../interfaces';
-import { RedisOptions } from '../interfaces/microservice-configuration.interface';
+  CustomTransportStrategy,
+  IncomingRequest,
+  RedisOptions,
+} from '../interfaces';
 import { Server } from './server';
 
-let redisPackage: any = {};
+type Redis = any;
+
+let redisPackage = {} as any;
 
 export class ServerRedis extends Server implements CustomTransportStrategy {
   public readonly transportId = Transport.REDIS;
 
-  private readonly url: string;
-  private subClient: RedisClient;
-  private pubClient: RedisClient;
+  private subClient: Redis;
+  private pubClient: Redis;
   private isExplicitlyTerminated = false;
 
   constructor(private readonly options: RedisOptions['options']) {
     super();
-    this.url =
-      this.getOptionsProp(options, 'url') ||
-      (!this.getOptionsProp(options, 'host') && REDIS_DEFAULT_URL);
 
-    redisPackage = this.loadPackage('redis', ServerRedis.name, () =>
-      require('redis'),
+    redisPackage = this.loadPackage('ioredis', ServerRedis.name, () =>
+      require('ioredis'),
     );
 
     this.initializeSerializer(options);
@@ -51,6 +47,7 @@ export class ServerRedis extends Server implements CustomTransportStrategy {
 
       this.handleError(this.pubClient);
       this.handleError(this.subClient);
+
       this.start(callback);
     } catch (err) {
       callback(err);
@@ -58,11 +55,15 @@ export class ServerRedis extends Server implements CustomTransportStrategy {
   }
 
   public start(callback?: () => void) {
-    this.bindEvents(this.subClient, this.pubClient);
-    this.subClient.on(CONNECT_EVENT, callback);
+    Promise.all([this.subClient.connect(), this.pubClient.connect()])
+      .then(() => {
+        this.bindEvents(this.subClient, this.pubClient);
+        callback();
+      })
+      .catch(callback);
   }
 
-  public bindEvents(subClient: RedisClient, pubClient: RedisClient) {
+  public bindEvents(subClient: Redis, pubClient: Redis) {
     subClient.on(MESSAGE_EVENT, this.getMessageHandler(pubClient).bind(this));
     const subscribePatterns = [...this.messageHandlers.keys()];
     subscribePatterns.forEach(pattern => {
@@ -79,14 +80,16 @@ export class ServerRedis extends Server implements CustomTransportStrategy {
     this.subClient && this.subClient.quit();
   }
 
-  public createRedisClient(): RedisClient {
-    return redisPackage.createClient({
+  public createRedisClient(): Redis {
+    return new redisPackage({
+      port: REDIS_DEFAULT_PORT,
+      host: REDIS_DEFAULT_HOST,
       ...this.getClientOptions(),
-      url: this.url,
+      lazyConnect: true,
     });
   }
 
-  public getMessageHandler(pub: RedisClient) {
+  public getMessageHandler(pub: Redis) {
     return async (channel: string, buffer: string | any) =>
       this.handleMessage(channel, buffer, pub);
   }
@@ -94,7 +97,7 @@ export class ServerRedis extends Server implements CustomTransportStrategy {
   public async handleMessage(
     channel: string,
     buffer: string | any,
-    pub: RedisClient,
+    pub: Redis,
   ) {
     const rawMessage = this.parseMessage(buffer);
     const packet = await this.deserializer.deserialize(rawMessage, { channel });
@@ -121,11 +124,11 @@ export class ServerRedis extends Server implements CustomTransportStrategy {
     }
     const response$ = this.transformToObservable(
       await handler(packet.data, redisCtx),
-    ) as Observable<any>;
+    );
     response$ && this.send(response$, publish);
   }
 
-  public getPublisher(pub: RedisClient, pattern: any, id: string) {
+  public getPublisher(pub: Redis, pattern: any, id: string) {
     return (response: any) => {
       Object.assign(response, { id });
       const outgoingResponse = this.serializer.serialize(response);
@@ -157,31 +160,25 @@ export class ServerRedis extends Server implements CustomTransportStrategy {
     stream.on(ERROR_EVENT, (err: any) => this.logger.error(err));
   }
 
-  public getClientOptions(): Partial<ClientOpts> {
-    const retry_strategy = (options: RetryStrategyOptions) =>
-      this.createRetryStrategy(options);
+  public getClientOptions(): Partial<RedisOptions['options']> {
+    const retryStrategy = (times: number) => this.createRetryStrategy(times);
 
     return {
       ...(this.options || {}),
-      retry_strategy,
+      retryStrategy,
     };
   }
 
-  public createRetryStrategy(
-    options: RetryStrategyOptions,
-  ): undefined | number | void {
-    if (options.error && (options.error as any).code === 'ECONNREFUSED') {
-      this.logger.error(`Error ECONNREFUSED: ${this.url}`);
-    }
+  public createRetryStrategy(times: number): undefined | number | void {
     if (this.isExplicitlyTerminated) {
       return undefined;
     }
     if (
       !this.getOptionsProp(this.options, 'retryAttempts') ||
-      options.attempt > this.getOptionsProp(this.options, 'retryAttempts')
+      times > this.getOptionsProp(this.options, 'retryAttempts')
     ) {
-      this.logger.error(`Retry time exhausted: ${this.url}`);
-      throw new Error('Retry time exhausted');
+      this.logger.error(`Retry time exhausted`);
+      return;
     }
     return this.getOptionsProp(this.options, 'retryDelay') || 0;
   }
diff --git a/packages/microservices/server/server-rmq.ts b/packages/microservices/server/server-rmq.ts
index d6645ba73..18ca16eb9 100644
--- a/packages/microservices/server/server-rmq.ts
+++ b/packages/microservices/server/server-rmq.ts
@@ -3,11 +3,12 @@ import {
   isString,
   isUndefined,
 } from '@nestjs/common/utils/shared.utils';
-import { Observable } from 'rxjs';
 import {
   CONNECT_EVENT,
-  DISCONNECTED_RMQ_MESSAGE,
+  CONNECT_FAILED_EVENT,
+  CONNECTION_FAILED_MESSAGE,
   DISCONNECT_EVENT,
+  DISCONNECTED_RMQ_MESSAGE,
   NO_MESSAGE_HANDLER,
   RQM_DEFAULT_IS_GLOBAL_PREFETCH_COUNT,
   RQM_DEFAULT_NOACK,
@@ -96,6 +97,10 @@ export class ServerRMQ extends Server implements CustomTransportStrategy {
       this.logger.error(DISCONNECTED_RMQ_MESSAGE);
       this.logger.error(err);
     });
+    this.server.on(CONNECT_FAILED_EVENT, (err: any) => {
+      this.logger.error(CONNECTION_FAILED_MESSAGE);
+      this.logger.error(err);
+    });
   }
 
   public createClient<T = any>(): T {
@@ -157,7 +162,7 @@ export class ServerRMQ extends Server implements CustomTransportStrategy {
     }
     const response$ = this.transformToObservable(
       await handler(packet.data, rmqContext),
-    ) as Observable<any>;
+    );
 
     const publish = <T>(data: T) =>
       this.sendMessage(data, properties.replyTo, properties.correlationId);
diff --git a/packages/microservices/server/server-tcp.ts b/packages/microservices/server/server-tcp.ts
index 0e57c73d5..7a14e60ba 100644
--- a/packages/microservices/server/server-tcp.ts
+++ b/packages/microservices/server/server-tcp.ts
@@ -1,7 +1,7 @@
+import { Type } from '@nestjs/common';
 import { isString, isUndefined } from '@nestjs/common/utils/shared.utils';
 import * as net from 'net';
 import { Server as NetSocket, Socket } from 'net';
-import { Observable } from 'rxjs';
 import {
   CLOSE_EVENT,
   EADDRINUSE,
@@ -14,7 +14,7 @@ import {
 } from '../constants';
 import { TcpContext } from '../ctx-host/tcp.context';
 import { Transport } from '../enums';
-import { JsonSocket } from '../helpers/json-socket';
+import { JsonSocket, TcpSocket } from '../helpers';
 import {
   CustomTransportStrategy,
   IncomingRequest,
@@ -30,6 +30,7 @@ export class ServerTCP extends Server implements CustomTransportStrategy {
 
   private readonly port: number;
   private readonly host: string;
+  private readonly socketClass: Type<TcpSocket>;
   private server: NetSocket;
   private isExplicitlyTerminated = false;
   private retryAttemptsCount = 0;
@@ -38,6 +39,8 @@ export class ServerTCP extends Server implements CustomTransportStrategy {
     super();
     this.port = this.getOptionsProp(options, 'port') || TCP_DEFAULT_PORT;
     this.host = this.getOptionsProp(options, 'host') || TCP_DEFAULT_HOST;
+    this.socketClass =
+      this.getOptionsProp(options, 'socketClass') || JsonSocket;
 
     this.init();
     this.initializeSerializer(options);
@@ -57,6 +60,7 @@ export class ServerTCP extends Server implements CustomTransportStrategy {
 
   public close() {
     this.isExplicitlyTerminated = true;
+
     this.server.close();
   }
 
@@ -68,7 +72,7 @@ export class ServerTCP extends Server implements CustomTransportStrategy {
     readSocket.on(ERROR_EVENT, this.handleError.bind(this));
   }
 
-  public async handleMessage(socket: JsonSocket, rawMessage: unknown) {
+  public async handleMessage(socket: TcpSocket, rawMessage: unknown) {
     const packet = await this.deserializer.deserialize(rawMessage);
     const pattern = !isString(packet.pattern)
       ? JSON.stringify(packet.pattern)
@@ -90,7 +94,7 @@ export class ServerTCP extends Server implements CustomTransportStrategy {
     }
     const response$ = this.transformToObservable(
       await handler(packet.data, tcpContext),
-    ) as Observable<any>;
+    );
 
     response$ &&
       this.send(response$, data => {
@@ -113,7 +117,7 @@ export class ServerTCP extends Server implements CustomTransportStrategy {
     }
     ++this.retryAttemptsCount;
     return setTimeout(
-      () => this.server.listen(this.port),
+      () => this.server.listen(this.port, this.host),
       this.getOptionsProp(this.options, 'retryDelay') || 0,
     );
   }
@@ -124,7 +128,7 @@ export class ServerTCP extends Server implements CustomTransportStrategy {
     this.server.on(CLOSE_EVENT, this.handleClose.bind(this));
   }
 
-  private getSocketInstance(socket: Socket): JsonSocket {
-    return new JsonSocket(socket);
+  private getSocketInstance(socket: Socket): TcpSocket {
+    return new this.socketClass(socket);
   }
 }
diff --git a/packages/microservices/server/server.ts b/packages/microservices/server/server.ts
index 99025a9dd..4e8ee9bf6 100644
--- a/packages/microservices/server/server.ts
+++ b/packages/microservices/server/server.ts
@@ -1,11 +1,12 @@
 import { Logger, LoggerService } from '@nestjs/common/services/logger.service';
 import { loadPackage } from '@nestjs/common/utils/load-package.util';
-import { isFunction } from '@nestjs/common/utils/shared.utils';
 import {
   connectable,
-  EMPTY as empty,
+  EMPTY,
   from as fromPromise,
+  isObservable,
   Observable,
+  ObservedValueOf,
   of,
   Subject,
   Subscription,
@@ -43,9 +44,11 @@ export abstract class Server {
     pattern: any,
     callback: MessageHandler,
     isEventHandler = false,
+    extras: Record<string, any> = {},
   ) {
     const normalizedPattern = this.normalizePattern(pattern);
     callback.isEventHandler = isEventHandler;
+    callback.extras = extras;
 
     if (this.messageHandlers.has(normalizedPattern) && isEventHandler) {
       const headRef = this.messageHandlers.get(normalizedPattern);
@@ -94,7 +97,7 @@ export abstract class Server {
       .pipe(
         catchError((err: any) => {
           scheduleOnNextTick({ err });
-          return empty;
+          return EMPTY;
         }),
         finalize(() => scheduleOnNextTick({ isDisposed: true })),
       )
@@ -108,12 +111,10 @@ export abstract class Server {
   ): Promise<any> {
     const handler = this.getHandlerByPattern(pattern);
     if (!handler) {
-      return this.logger.error(
-        `${NO_EVENT_HANDLER} Event pattern: ${JSON.stringify(pattern)}.`,
-      );
+      return this.logger.error(NO_EVENT_HANDLER`${pattern}`);
     }
     const resultOrStream = await handler(packet.data, context);
-    if (this.isObservable(resultOrStream)) {
+    if (isObservable(resultOrStream)) {
       const connectableSource = connectable(resultOrStream, {
         connector: () => new Subject(),
         resetOnDisconnect: false,
@@ -122,13 +123,24 @@ export abstract class Server {
     }
   }
 
-  public transformToObservable<T = any>(resultOrDeferred: any): Observable<T> {
+  public transformToObservable<T>(
+    resultOrDeferred: Observable<T> | Promise<T>,
+  ): Observable<T>;
+  public transformToObservable<T>(
+    resultOrDeferred: T,
+  ): never extends Observable<ObservedValueOf<T>>
+    ? Observable<T>
+    : Observable<ObservedValueOf<T>>;
+  public transformToObservable(resultOrDeferred: any) {
     if (resultOrDeferred instanceof Promise) {
       return fromPromise(resultOrDeferred);
-    } else if (!this.isObservable(resultOrDeferred)) {
-      return of(resultOrDeferred);
     }
-    return resultOrDeferred;
+
+    if (isObservable(resultOrDeferred)) {
+      return resultOrDeferred;
+    }
+
+    return of(resultOrDeferred);
   }
 
   public getOptionsProp<
@@ -180,10 +192,6 @@ export abstract class Server {
       new IncomingRequestDeserializer();
   }
 
-  private isObservable(input: unknown): input is Observable<any> {
-    return input && isFunction((input as Observable<any>).subscribe);
-  }
-
   /**
    * Transforms the server Pattern to valid type and returns a route for him.
    *
diff --git a/packages/microservices/test/client/client-grpc.spec.ts b/packages/microservices/test/client/client-grpc.spec.ts
index a87b3f5ef..ae041fa99 100644
--- a/packages/microservices/test/client/client-grpc.spec.ts
+++ b/packages/microservices/test/client/client-grpc.spec.ts
@@ -129,10 +129,10 @@ describe('ClientGrpcProxy', () => {
 
       it('should call native method', () => {
         const spy = sinon.spy(obj, methodName);
-        stream$.subscribe(
-          () => ({}),
-          () => ({}),
-        );
+        stream$.subscribe({
+          next: () => ({}),
+          error: () => ({}),
+        });
 
         expect(spy.called).to.be.true;
       });
@@ -156,10 +156,10 @@ describe('ClientGrpcProxy', () => {
 
       it('should subscribe to request upstream', () => {
         const upstreamSubscribe = sinon.spy(upstream, 'subscribe');
-        stream$.subscribe(
-          () => ({}),
-          () => ({}),
-        );
+        stream$.subscribe({
+          next: () => ({}),
+          error: () => ({}),
+        });
         upstream.next({ test: true });
 
         expect(writeSpy.called).to.be.true;
@@ -201,7 +201,12 @@ describe('ClientGrpcProxy', () => {
 
       it('propagates server errors', () => {
         const err = new Error('something happened');
-        stream$.subscribe(dataSpy, errorSpy, completeSpy);
+        stream$.subscribe({
+          next: dataSpy,
+          error: errorSpy,
+          complete: completeSpy,
+        });
+
         eventCallbacks.data('a');
         eventCallbacks.data('b');
         callMock.finished = true;
@@ -219,7 +224,11 @@ describe('ClientGrpcProxy', () => {
         const grpcServerCancelErrMock = {
           details: 'Cancelled',
         };
-        const subscription = stream$.subscribe(dataSpy, errorSpy);
+        const subscription = stream$.subscribe({
+          next: dataSpy,
+          error: errorSpy,
+        });
+
         eventCallbacks.data('a');
         eventCallbacks.data('b');
         subscription.unsubscribe();
@@ -258,10 +267,10 @@ describe('ClientGrpcProxy', () => {
 
       it('should call native method', () => {
         const spy = sinon.spy(obj, methodName);
-        stream$.subscribe(
-          () => ({}),
-          () => ({}),
-        );
+        stream$.subscribe({
+          next: () => ({}),
+          error: () => ({}),
+        });
 
         expect(spy.called).to.be.true;
       });
@@ -298,10 +307,10 @@ describe('ClientGrpcProxy', () => {
 
       it('should subscribe to request upstream', () => {
         const upstreamSubscribe = sinon.spy(upstream, 'subscribe');
-        stream$.subscribe(
-          () => ({}),
-          () => ({}),
-        );
+        stream$.subscribe({
+          next: () => ({}),
+          error: () => ({}),
+        });
         upstream.next({ test: true });
 
         expect(writeSpy.called).to.be.true;
diff --git a/packages/microservices/test/client/client-kafka.spec.ts b/packages/microservices/test/client/client-kafka.spec.ts
index d5af20a8c..d68b8c28a 100644
--- a/packages/microservices/test/client/client-kafka.spec.ts
+++ b/packages/microservices/test/client/client-kafka.spec.ts
@@ -277,47 +277,95 @@ describe('ClientKafka', () => {
     let bindTopicsStub: sinon.SinonStub;
     // let handleErrorsSpy: sinon.SinonSpy;
 
-    beforeEach(() => {
-      consumerAssignmentsStub = sinon.stub(
-        client as any,
-        'consumerAssignments',
-      );
-      bindTopicsStub = sinon
-        .stub(client, 'bindTopics')
-        .callsFake(async () => {});
-    });
+    describe('consumer and producer', () => {
+      beforeEach(() => {
+        consumerAssignmentsStub = sinon.stub(
+          client as any,
+          'consumerAssignments',
+        );
+        bindTopicsStub = sinon
+          .stub(client, 'bindTopics')
+          .callsFake(async () => {});
+      });
+
+      it('should expect the connection to be created', async () => {
+        const connection = await client.connect();
 
-    it('should expect the connection to be created', async () => {
-      const connection = await client.connect();
+        expect(createClientStub.calledOnce).to.be.true;
+        expect(producerStub.calledOnce).to.be.true;
 
-      expect(createClientStub.calledOnce).to.be.true;
-      expect(producerStub.calledOnce).to.be.true;
+        expect(consumerStub.calledOnce).to.be.true;
 
-      expect(consumerStub.calledOnce).to.be.true;
+        expect(on.calledOnce).to.be.true;
+        expect(client['consumerAssignments']).to.be.empty;
 
-      expect(on.calledOnce).to.be.true;
-      expect(client['consumerAssignments']).to.be.empty;
+        expect(connect.calledTwice).to.be.true;
 
-      expect(connect.calledTwice).to.be.true;
+        expect(bindTopicsStub.calledOnce).to.be.true;
+        expect(connection).to.deep.equal(producerStub());
+      });
+
+      it('should expect the connection to be reused', async () => {
+        (client as any).client = kafkaClient;
+        await client.connect();
+
+        expect(createClientStub.calledOnce).to.be.false;
+        expect(producerStub.calledOnce).to.be.false;
+        expect(consumerStub.calledOnce).to.be.false;
+
+        expect(on.calledOnce).to.be.false;
+        expect(client['consumerAssignments']).to.be.empty;
 
-      expect(bindTopicsStub.calledOnce).to.be.true;
-      expect(connection).to.deep.equal(producerStub());
+        expect(connect.calledTwice).to.be.false;
+
+        expect(bindTopicsStub.calledOnce).to.be.false;
+      });
     });
 
-    it('should expect the connection to be reused', async () => {
-      (client as any).client = kafkaClient;
-      await client.connect();
+    describe('producer only mode', () => {
+      beforeEach(() => {
+        consumerAssignmentsStub = sinon.stub(
+          client as any,
+          'consumerAssignments',
+        );
+        bindTopicsStub = sinon
+          .stub(client, 'bindTopics')
+          .callsFake(async () => {});
+        client['producerOnlyMode'] = true;
+      });
+
+      it('should expect the connection to be created', async () => {
+        const connection = await client.connect();
+
+        expect(createClientStub.calledOnce).to.be.true;
+        expect(producerStub.calledOnce).to.be.true;
+
+        expect(consumerStub.calledOnce).to.be.false;
+
+        expect(on.calledOnce).to.be.false;
+        expect(client['consumerAssignments']).to.be.empty;
+
+        expect(connect.calledOnce).to.be.true;
+
+        expect(bindTopicsStub.calledOnce).to.be.false;
+        expect(connection).to.deep.equal(producerStub());
+      });
+
+      it('should expect the connection to be reused', async () => {
+        (client as any).client = kafkaClient;
+        await client.connect();
 
-      expect(createClientStub.calledOnce).to.be.false;
-      expect(producerStub.calledOnce).to.be.false;
-      expect(consumerStub.calledOnce).to.be.false;
+        expect(createClientStub.calledOnce).to.be.false;
+        expect(producerStub.calledOnce).to.be.false;
+        expect(consumerStub.calledOnce).to.be.false;
 
-      expect(on.calledOnce).to.be.false;
-      expect(client['consumerAssignments']).to.be.empty;
+        expect(on.calledOnce).to.be.false;
+        expect(client['consumerAssignments']).to.be.empty;
 
-      expect(connect.calledTwice).to.be.false;
+        expect(connect.calledTwice).to.be.false;
 
-      expect(bindTopicsStub.calledOnce).to.be.false;
+        expect(bindTopicsStub.calledOnce).to.be.false;
+      });
     });
   });
 
@@ -659,6 +707,12 @@ describe('ClientKafka', () => {
       );
     });
 
+    it('should remove callback from routing map when unsubscribe', async () => {
+      client['publish'](readPacket, callback)();
+      expect(client['routingMap'].has(correlationId)).to.be.false;
+      expect(client['routingMap'].size).to.eq(0);
+    });
+
     describe('on error', () => {
       let clientProducerStub: sinon.SinonStub;
       let sendStub: sinon.SinonStub;
@@ -678,10 +732,11 @@ describe('ClientKafka', () => {
       });
 
       it('should call callback', async () => {
-        await client['publish'](readPacket, callback);
-
-        expect(callback.called).to.be.true;
-        expect(callback.getCall(0).args[0].err).to.be.instanceof(Error);
+        return new Promise(async resolve => {
+          return client['publish'](readPacket, ({ err }) => resolve(err));
+        }).then(err => {
+          expect(err).to.be.instanceof(Error);
+        });
       });
     });
 
diff --git a/packages/microservices/test/client/client-mqtt.spec.ts b/packages/microservices/test/client/client-mqtt.spec.ts
index fb8250c71..a5dc9032f 100644
--- a/packages/microservices/test/client/client-mqtt.spec.ts
+++ b/packages/microservices/test/client/client-mqtt.spec.ts
@@ -1,5 +1,5 @@
 import { expect } from 'chai';
-import { empty } from 'rxjs';
+import { EMPTY } from 'rxjs';
 import * as sinon from 'sinon';
 import { ClientMqtt } from '../../client/client-mqtt';
 import { ERROR_EVENT } from '../../constants';
@@ -311,9 +311,9 @@ describe('ClientMqtt', () => {
         on: (ev, callback) => callback(error),
         off: () => ({}),
       };
-      client
-        .mergeCloseEvent(instance as any, empty())
-        .subscribe(null, (err: any) => expect(err).to.be.eql(error));
+      client.mergeCloseEvent(instance as any, EMPTY).subscribe({
+        error: (err: any) => expect(err).to.be.eql(error),
+      });
     });
   });
   describe('handleError', () => {
diff --git a/packages/microservices/test/client/client-proxy.spec.ts b/packages/microservices/test/client/client-proxy.spec.ts
index 12080d011..ea1a912dc 100644
--- a/packages/microservices/test/client/client-proxy.spec.ts
+++ b/packages/microservices/test/client/client-proxy.spec.ts
@@ -96,12 +96,12 @@ describe('ClientProxy', function () {
           throw new Error();
         });
         const stream$ = client.send({ test: 3 }, 'test');
-        stream$.subscribe(
-          () => {},
-          err => {
+        stream$.subscribe({
+          next: () => {},
+          error: err => {
             expect(err).to.be.instanceof(Error);
           },
-        );
+        });
       });
     });
     describe('when is connected', () => {
@@ -142,12 +142,12 @@ describe('ClientProxy', function () {
           throw new Error();
         });
         const stream$ = client.emit({ test: 3 }, 'test');
-        stream$.subscribe(
-          () => {},
-          err => {
+        stream$.subscribe({
+          next: () => {},
+          error: err => {
             expect(err).to.be.instanceof(Error);
           },
-        );
+        });
       });
     });
     describe('when is connected', () => {
diff --git a/packages/microservices/test/client/client-redis.spec.ts b/packages/microservices/test/client/client-redis.spec.ts
index 8045f90a5..b7fb3ec5e 100644
--- a/packages/microservices/test/client/client-redis.spec.ts
+++ b/packages/microservices/test/client/client-redis.spec.ts
@@ -1,9 +1,7 @@
 import { expect } from 'chai';
-import { Subject } from 'rxjs';
 import * as sinon from 'sinon';
 import { ClientRedis } from '../../client/client-redis';
 import { ERROR_EVENT } from '../../constants';
-import { Client } from '../../external/nats-client.interface';
 
 describe('ClientRedis', () => {
   const test = 'test';
@@ -252,53 +250,39 @@ describe('ClientRedis', () => {
     });
   });
   describe('getClientOptions', () => {
-    it('should return options object with "retry_strategy" and call "createRetryStrategy"', () => {
+    it('should return options object with "retryStrategy" and call "createRetryStrategy"', () => {
       const createSpy = sinon.spy(client, 'createRetryStrategy');
-      const { retry_strategy } = client.getClientOptions(new Subject());
+      const { retryStrategy } = client.getClientOptions();
       try {
-        retry_strategy({} as any);
+        retryStrategy({} as any);
       } catch {}
       expect(createSpy.called).to.be.true;
     });
   });
   describe('createRetryStrategy', () => {
-    const subject = new Subject<Error>();
     describe('when is terminated', () => {
       it('should return undefined', () => {
         (client as any).isExplicitlyTerminated = true;
-        const result = client.createRetryStrategy({} as any, subject);
+        const result = client.createRetryStrategy(0);
         expect(result).to.be.undefined;
       });
     });
     describe('when "retryAttempts" does not exist', () => {
-      it('should return an error', () => {
+      it('should return undefined', () => {
         (client as any).isExplicitlyTerminated = false;
         (client as any).options.options = {};
         (client as any).options.options.retryAttempts = undefined;
-        const result = client.createRetryStrategy({} as any, subject);
-        expect(result).to.be.instanceOf(Error);
+        const result = client.createRetryStrategy(1);
+        expect(result).to.be.undefined;
       });
     });
     describe('when "attempts" count is max', () => {
-      it('should return an error', () => {
+      it('should return undefined', () => {
         (client as any).isExplicitlyTerminated = false;
         (client as any).options.options = {};
         (client as any).options.options.retryAttempts = 3;
-        const result = client.createRetryStrategy(
-          { attempt: 4 } as any,
-          subject,
-        );
-        expect(result).to.be.instanceOf(Error);
-      });
-    });
-    describe('when ECONNREFUSED', () => {
-      it('should return error', () => {
-        (client as any).options.options = {};
-        (client as any).options.options.retryAttempts = 10;
-
-        const error = { code: 'ECONNREFUSED' };
-        const result = client.createRetryStrategy({ error } as any, subject);
-        expect(result).to.be.instanceOf(Error);
+        const result = client.createRetryStrategy(4);
+        expect(result).to.be.undefined;
       });
     });
     describe('otherwise', () => {
@@ -307,10 +291,7 @@ describe('ClientRedis', () => {
         (client as any).isExplicitlyTerminated = false;
         (client as any).options.retryAttempts = 3;
         (client as any).options.retryDelay = 3;
-        const result = client.createRetryStrategy(
-          { attempt: 2 } as any,
-          subject,
-        );
+        const result = client.createRetryStrategy(2);
         expect(result).to.be.eql((client as any).options.retryDelay);
       });
     });
diff --git a/packages/microservices/test/client/client-rmq.spec.ts b/packages/microservices/test/client/client-rmq.spec.ts
index 060865ade..2c764b57f 100644
--- a/packages/microservices/test/client/client-rmq.spec.ts
+++ b/packages/microservices/test/client/client-rmq.spec.ts
@@ -1,6 +1,6 @@
 import { expect } from 'chai';
 import { EventEmitter } from 'events';
-import { empty } from 'rxjs';
+import { EMPTY } from 'rxjs';
 import * as sinon from 'sinon';
 import { ClientRMQ } from '../../client/client-rmq';
 import { ReadPacket } from '../../interfaces';
@@ -164,8 +164,8 @@ describe('ClientRMQ', function () {
         off: () => ({}),
       };
       client
-        .mergeDisconnectEvent(instance as any, empty())
-        .subscribe(null, (err: any) => expect(err).to.be.eql(error));
+        .mergeDisconnectEvent(instance as any, EMPTY)
+        .subscribe({ error: (err: any) => expect(err).to.be.eql(error) });
     });
   });
 
diff --git a/packages/microservices/test/context/rpc-proxy.spec.ts b/packages/microservices/test/context/rpc-proxy.spec.ts
index ffa2222bc..dbfe7f0b1 100644
--- a/packages/microservices/test/context/rpc-proxy.spec.ts
+++ b/packages/microservices/test/context/rpc-proxy.spec.ts
@@ -36,19 +36,8 @@ describe('RpcProxy', () => {
       const proxy = routerProxy.create(async (client, data) => {
         return throwError(() => new RpcException('test'));
       }, handler);
-      (await proxy(null, null)).subscribe(null, () => expectation.verify());
-    });
-  });
-
-  describe('isObservable', () => {
-    describe('when observable', () => {
-      it('should return true', () => {
-        expect(routerProxy.isObservable(of('test'))).to.be.true;
-      });
-    });
-    describe('when not observable', () => {
-      it('should return false', () => {
-        expect(routerProxy.isObservable({})).to.be.false;
+      (await proxy(null, null)).subscribe({
+        error: () => expectation.verify(),
       });
     });
   });
diff --git a/packages/microservices/test/ctx-host/kafka.context.spec.ts b/packages/microservices/test/ctx-host/kafka.context.spec.ts
index 9c0c1b312..5f350a635 100644
--- a/packages/microservices/test/ctx-host/kafka.context.spec.ts
+++ b/packages/microservices/test/ctx-host/kafka.context.spec.ts
@@ -1,13 +1,15 @@
 import { expect } from 'chai';
 import { KafkaContext } from '../../ctx-host';
-import { KafkaMessage } from '../../external/kafka.interface';
+import { Consumer, KafkaMessage } from '../../external/kafka.interface';
 
 describe('KafkaContext', () => {
-  const args = ['test', { test: true }];
+  const args = ['test', { test: true }, undefined, { test: 'consumer' }];
   let context: KafkaContext;
 
   beforeEach(() => {
-    context = new KafkaContext(args as [KafkaMessage, number, string]);
+    context = new KafkaContext(
+      args as [KafkaMessage, number, string, Consumer],
+    );
   });
   describe('getTopic', () => {
     it('should return topic', () => {
@@ -24,4 +26,9 @@ describe('KafkaContext', () => {
       expect(context.getMessage()).to.be.eql(args[0]);
     });
   });
+  describe('getConsumer', () => {
+    it('should return consumer instance', () => {
+      expect(context.getConsumer()).to.deep.eq({ test: 'consumer' });
+    });
+  });
 });
diff --git a/packages/microservices/test/decorators/event-pattern.decorator.spec.ts b/packages/microservices/test/decorators/event-pattern.decorator.spec.ts
index d1cb0df25..dbfb07696 100644
--- a/packages/microservices/test/decorators/event-pattern.decorator.spec.ts
+++ b/packages/microservices/test/decorators/event-pattern.decorator.spec.ts
@@ -1,15 +1,147 @@
 import { expect } from 'chai';
-import { PATTERN_METADATA } from '../../constants';
+import {
+  PATTERN_EXTRAS_METADATA,
+  PATTERN_METADATA,
+  TRANSPORT_METADATA,
+} from '../../constants';
+import { Transport } from '../../enums/transport.enum';
 import { EventPattern } from '../../decorators/event-pattern.decorator';
 
 describe('@EventPattern', () => {
   const pattern = { role: 'test' };
+  const patternSecond = { role: 'test2' };
+  const patternThird = { role: 'test3' };
+  const extras = { param: 'value' };
   class TestComponent {
-    @EventPattern(pattern)
+    @EventPattern(pattern, undefined, extras)
     public static test() {}
+
+    @EventPattern(patternSecond, undefined, extras)
+    @EventPattern(patternThird, undefined, extras)
+    public static testOnlyThird() {}
+
+    @EventPattern([patternSecond, patternThird], undefined, extras)
+    public static testBoth() {}
   }
   it(`should enhance method with ${PATTERN_METADATA} metadata`, () => {
     const metadata = Reflect.getMetadata(PATTERN_METADATA, TestComponent.test);
-    expect(metadata).to.be.eql(pattern);
+    expect(metadata.length).to.equal(1);
+    expect(metadata[0]).to.be.eql(pattern);
+  });
+  it(`should enhance method with ${PATTERN_EXTRAS_METADATA} metadata`, () => {
+    const metadata = Reflect.getMetadata(
+      PATTERN_EXTRAS_METADATA,
+      TestComponent.test,
+    );
+    expect(metadata).to.be.deep.equal(extras);
+  });
+  it(`should enhance method with last ${PATTERN_METADATA} metadata`, () => {
+    const metadata = Reflect.getMetadata(
+      PATTERN_METADATA,
+      TestComponent.testOnlyThird,
+    );
+    expect(metadata.length).to.equal(1);
+    expect(metadata[0]).to.be.eql(patternSecond);
+  });
+  it(`should enhance method with both ${PATTERN_METADATA} metadata`, () => {
+    const metadata = Reflect.getMetadata(
+      PATTERN_METADATA,
+      TestComponent.testBoth,
+    );
+    expect(metadata.length).to.equal(2);
+    expect(metadata[0]).to.be.eql(patternSecond);
+    expect(metadata[1]).to.be.eql(patternThird);
+  });
+
+  describe('decorator overloads', () => {
+    class TestComponent1 {
+      @EventPattern(pattern)
+      public static test() {}
+    }
+    class TestComponent2 {
+      @EventPattern(pattern, Transport.TCP)
+      public static test() {}
+    }
+    class TestComponent3 {
+      @EventPattern(pattern, extras)
+      public static test() {}
+    }
+    class TestComponent4 {
+      @EventPattern(pattern, Transport.TCP, extras)
+      public static test() {}
+    }
+
+    it(`should enhance method with ${PATTERN_METADATA} metadata`, () => {
+      const [metadataArg] = Reflect.getMetadata(
+        PATTERN_METADATA,
+        TestComponent1.test,
+      );
+      const transportArg = Reflect.getMetadata(
+        TRANSPORT_METADATA,
+        TestComponent1.test,
+      );
+      const extrasArg = Reflect.getMetadata(
+        PATTERN_EXTRAS_METADATA,
+        TestComponent1.test,
+      );
+      expect(metadataArg).to.be.eql(pattern);
+      expect(transportArg).to.be.undefined;
+      expect(extrasArg).to.be.undefined;
+    });
+
+    it(`should enhance method with ${PATTERN_METADATA}, ${TRANSPORT_METADATA} metadata`, () => {
+      const [metadataArg] = Reflect.getMetadata(
+        PATTERN_METADATA,
+        TestComponent2.test,
+      );
+      const transportArg = Reflect.getMetadata(
+        TRANSPORT_METADATA,
+        TestComponent2.test,
+      );
+      const extrasArg = Reflect.getMetadata(
+        PATTERN_EXTRAS_METADATA,
+        TestComponent2.test,
+      );
+      expect(metadataArg).to.be.eql(pattern);
+      expect(transportArg).to.be.eql(Transport.TCP);
+      expect(extrasArg).to.be.undefined;
+    });
+
+    it(`should enhance method with ${PATTERN_METADATA}, ${PATTERN_EXTRAS_METADATA} metadata`, () => {
+      const [metadataArg] = Reflect.getMetadata(
+        PATTERN_METADATA,
+        TestComponent3.test,
+      );
+      const transportArg = Reflect.getMetadata(
+        TRANSPORT_METADATA,
+        TestComponent3.test,
+      );
+      const extrasArg = Reflect.getMetadata(
+        PATTERN_EXTRAS_METADATA,
+        TestComponent3.test,
+      );
+      expect(metadataArg).to.be.eql(pattern);
+      expect(transportArg).to.be.undefined;
+      expect(extrasArg).to.be.eql(extras);
+    });
+
+    it(`should enhance method with ${PATTERN_METADATA}, ${TRANSPORT_METADATA} and \
+${PATTERN_EXTRAS_METADATA} metadata`, () => {
+      const [metadataArg] = Reflect.getMetadata(
+        PATTERN_METADATA,
+        TestComponent4.test,
+      );
+      const transportArg = Reflect.getMetadata(
+        TRANSPORT_METADATA,
+        TestComponent4.test,
+      );
+      const extrasArg = Reflect.getMetadata(
+        PATTERN_EXTRAS_METADATA,
+        TestComponent4.test,
+      );
+      expect(metadataArg).to.be.eql(pattern);
+      expect(transportArg).to.be.eql(Transport.TCP);
+      expect(extrasArg).to.be.eql(extras);
+    });
   });
 });
diff --git a/packages/microservices/test/decorators/message-pattern.decorator.spec.ts b/packages/microservices/test/decorators/message-pattern.decorator.spec.ts
index b3500e106..d8b62d2f5 100644
--- a/packages/microservices/test/decorators/message-pattern.decorator.spec.ts
+++ b/packages/microservices/test/decorators/message-pattern.decorator.spec.ts
@@ -1,5 +1,10 @@
 import { expect } from 'chai';
-import { PATTERN_METADATA } from '../../constants';
+import {
+  PATTERN_METADATA,
+  PATTERN_EXTRAS_METADATA,
+  TRANSPORT_METADATA,
+} from '../../constants';
+import { Transport } from '../../enums/transport.enum';
 import {
   GrpcMethod,
   GrpcMethodStreamingType,
@@ -10,14 +15,117 @@ import {
 
 describe('@MessagePattern', () => {
   const pattern = { role: 'test' };
+  const extras = { param: 'value' };
   class TestComponent {
-    @MessagePattern(pattern)
+    @MessagePattern(pattern, undefined, extras)
     public static test() {}
   }
   it(`should enhance method with ${PATTERN_METADATA} metadata`, () => {
-    const metadata = Reflect.getMetadata(PATTERN_METADATA, TestComponent.test);
+    const [metadata] = Reflect.getMetadata(
+      PATTERN_METADATA,
+      TestComponent.test,
+    );
     expect(metadata).to.be.eql(pattern);
   });
+  it(`should enhance method with ${PATTERN_EXTRAS_METADATA} metadata`, () => {
+    const metadata = Reflect.getMetadata(
+      PATTERN_EXTRAS_METADATA,
+      TestComponent.test,
+    );
+    expect(metadata).to.be.deep.equal(extras);
+  });
+
+  describe('decorator overloads', () => {
+    class TestComponent1 {
+      @MessagePattern(pattern)
+      public static test() {}
+    }
+    class TestComponent2 {
+      @MessagePattern(pattern, Transport.TCP)
+      public static test() {}
+    }
+    class TestComponent3 {
+      @MessagePattern(pattern, extras)
+      public static test() {}
+    }
+    class TestComponent4 {
+      @MessagePattern(pattern, Transport.TCP, extras)
+      public static test() {}
+    }
+
+    it(`should enhance method with ${PATTERN_METADATA} metadata`, () => {
+      const [metadataArg] = Reflect.getMetadata(
+        PATTERN_METADATA,
+        TestComponent1.test,
+      );
+      const transportArg = Reflect.getMetadata(
+        TRANSPORT_METADATA,
+        TestComponent1.test,
+      );
+      const extrasArg = Reflect.getMetadata(
+        PATTERN_EXTRAS_METADATA,
+        TestComponent1.test,
+      );
+      expect(metadataArg).to.be.eql(pattern);
+      expect(transportArg).to.be.undefined;
+      expect(extrasArg).to.be.undefined;
+    });
+
+    it(`should enhance method with ${PATTERN_METADATA}, ${TRANSPORT_METADATA} metadata`, () => {
+      const [metadataArg] = Reflect.getMetadata(
+        PATTERN_METADATA,
+        TestComponent2.test,
+      );
+      const transportArg = Reflect.getMetadata(
+        TRANSPORT_METADATA,
+        TestComponent2.test,
+      );
+      const extrasArg = Reflect.getMetadata(
+        PATTERN_EXTRAS_METADATA,
+        TestComponent2.test,
+      );
+      expect(metadataArg).to.be.eql(pattern);
+      expect(transportArg).to.be.eql(Transport.TCP);
+      expect(extrasArg).to.be.undefined;
+    });
+
+    it(`should enhance method with ${PATTERN_METADATA}, ${PATTERN_EXTRAS_METADATA} metadata`, () => {
+      const [metadataArg] = Reflect.getMetadata(
+        PATTERN_METADATA,
+        TestComponent3.test,
+      );
+      const transportArg = Reflect.getMetadata(
+        TRANSPORT_METADATA,
+        TestComponent3.test,
+      );
+      const extrasArg = Reflect.getMetadata(
+        PATTERN_EXTRAS_METADATA,
+        TestComponent3.test,
+      );
+      expect(metadataArg).to.be.eql(pattern);
+      expect(transportArg).to.be.undefined;
+      expect(extrasArg).to.be.eql(extras);
+    });
+
+    it(`should enhance method with ${PATTERN_METADATA}, ${TRANSPORT_METADATA} and \
+${PATTERN_EXTRAS_METADATA} metadata`, () => {
+      const [metadataArg] = Reflect.getMetadata(
+        PATTERN_METADATA,
+        TestComponent4.test,
+      );
+      const transportArg = Reflect.getMetadata(
+        TRANSPORT_METADATA,
+        TestComponent4.test,
+      );
+      const extrasArg = Reflect.getMetadata(
+        PATTERN_EXTRAS_METADATA,
+        TestComponent4.test,
+      );
+      expect(metadataArg).to.be.eql(pattern);
+      expect(transportArg).to.be.eql(Transport.TCP);
+      expect(extrasArg).to.be.eql(extras);
+    });
+  });
 });
 
 describe('@GrpcMethod', () => {
@@ -34,7 +142,7 @@ describe('@GrpcMethod', () => {
 
   it('should derive method and service name', () => {
     const svc = new TestService();
-    const metadata = Reflect.getMetadata(PATTERN_METADATA, svc.test);
+    const [metadata] = Reflect.getMetadata(PATTERN_METADATA, svc.test);
     expect(metadata).to.be.eql({
       service: TestService.name,
       rpc: 'Test',
@@ -44,7 +152,7 @@ describe('@GrpcMethod', () => {
 
   it('should derive method', () => {
     const svc = new TestService();
-    const metadata = Reflect.getMetadata(PATTERN_METADATA, svc.test2);
+    const [metadata] = Reflect.getMetadata(PATTERN_METADATA, svc.test2);
     expect(metadata).to.be.eql({
       service: 'TestService2',
       rpc: 'Test2',
@@ -54,7 +162,7 @@ describe('@GrpcMethod', () => {
 
   it('should override both method and service', () => {
     const svc = new TestService();
-    const metadata = Reflect.getMetadata(PATTERN_METADATA, svc.test3);
+    const [metadata] = Reflect.getMetadata(PATTERN_METADATA, svc.test3);
     expect(metadata).to.be.eql({
       service: 'TestService2',
       rpc: 'Test2',
@@ -77,7 +185,7 @@ describe('@GrpcStreamMethod', () => {
 
   it('should derive method and service name', () => {
     const svc = new TestService();
-    const metadata = Reflect.getMetadata(PATTERN_METADATA, svc.test);
+    const [metadata] = Reflect.getMetadata(PATTERN_METADATA, svc.test);
     expect(metadata).to.be.eql({
       service: TestService.name,
       rpc: 'Test',
@@ -87,7 +195,7 @@ describe('@GrpcStreamMethod', () => {
 
   it('should derive method', () => {
     const svc = new TestService();
-    const metadata = Reflect.getMetadata(PATTERN_METADATA, svc.test2);
+    const [metadata] = Reflect.getMetadata(PATTERN_METADATA, svc.test2);
     expect(metadata).to.be.eql({
       service: 'TestService2',
       rpc: 'Test2',
@@ -97,7 +205,7 @@ describe('@GrpcStreamMethod', () => {
 
   it('should override both method and service', () => {
     const svc = new TestService();
-    const metadata = Reflect.getMetadata(PATTERN_METADATA, svc.test3);
+    const [metadata] = Reflect.getMetadata(PATTERN_METADATA, svc.test3);
     expect(metadata).to.be.eql({
       service: 'TestService2',
       rpc: 'Test2',
@@ -120,7 +228,7 @@ describe('@GrpcStreamCall', () => {
 
   it('should derive method and service name', () => {
     const svc = new TestService();
-    const metadata = Reflect.getMetadata(PATTERN_METADATA, svc.test);
+    const [metadata] = Reflect.getMetadata(PATTERN_METADATA, svc.test);
     expect(metadata).to.be.eql({
       service: TestService.name,
       rpc: 'Test',
@@ -130,7 +238,7 @@ describe('@GrpcStreamCall', () => {
 
   it('should derive method', () => {
     const svc = new TestService();
-    const metadata = Reflect.getMetadata(PATTERN_METADATA, svc.test2);
+    const [metadata] = Reflect.getMetadata(PATTERN_METADATA, svc.test2);
     expect(metadata).to.be.eql({
       service: 'TestService2',
       rpc: 'Test2',
@@ -140,7 +248,7 @@ describe('@GrpcStreamCall', () => {
 
   it('should override both method and service', () => {
     const svc = new TestService();
-    const metadata = Reflect.getMetadata(PATTERN_METADATA, svc.test3);
+    const [metadata] = Reflect.getMetadata(PATTERN_METADATA, svc.test3);
     expect(metadata).to.be.eql({
       service: 'TestService2',
       rpc: 'Test2',
diff --git a/packages/microservices/test/exceptions/rpc-exceptions-handler.spec.ts b/packages/microservices/test/exceptions/rpc-exceptions-handler.spec.ts
index 9c40ca858..a3ffb69b7 100644
--- a/packages/microservices/test/exceptions/rpc-exceptions-handler.spec.ts
+++ b/packages/microservices/test/exceptions/rpc-exceptions-handler.spec.ts
@@ -1,5 +1,5 @@
 import { expect } from 'chai';
-import { EMPTY as empty, of } from 'rxjs';
+import { EMPTY, of } from 'rxjs';
 import { catchError } from 'rxjs/operators';
 import * as sinon from 'sinon';
 import { RpcException } from '../../exceptions/rpc-exception';
@@ -23,7 +23,7 @@ describe('RpcExceptionsHandler', () => {
               message: 'Internal server error',
             });
             done();
-            return empty;
+            return EMPTY;
           }),
         )
         .subscribe(() => ({}));
@@ -39,7 +39,7 @@ describe('RpcExceptionsHandler', () => {
             catchError((err: any) => {
               expect(err).to.be.eql(message);
               done();
-              return empty;
+              return EMPTY;
             }),
           )
           .subscribe(() => ({}));
@@ -53,7 +53,7 @@ describe('RpcExceptionsHandler', () => {
             catchError((err: any) => {
               expect(err).to.be.eql({ message, status: 'error' });
               done();
-              return empty;
+              return EMPTY;
             }),
           )
           .subscribe(() => ({}));
diff --git a/packages/microservices/test/listeners-controller.spec.ts b/packages/microservices/test/listeners-controller.spec.ts
index 9b9f67f94..8ad10437a 100644
--- a/packages/microservices/test/listeners-controller.spec.ts
+++ b/packages/microservices/test/listeners-controller.spec.ts
@@ -21,8 +21,11 @@ describe('ListenersController', () => {
     metadataExplorer: ListenerMetadataExplorer,
     server: any,
     serverTCP: any,
+    serverCustom: any,
+    customTransport: Symbol,
     addSpy: sinon.SinonSpy,
     addSpyTCP: sinon.SinonSpy,
+    addSpyCustom: sinon.SinonSpy,
     proxySpy: sinon.SinonSpy,
     container: NestContainer,
     injector: Injector,
@@ -61,12 +64,18 @@ describe('ListenersController', () => {
       addHandler: addSpyTCP,
       transportId: Transport.TCP,
     };
+    addSpyCustom = sinon.spy();
+    customTransport = Symbol();
+    serverCustom = {
+      addHandler: addSpyCustom,
+      transportId: customTransport,
+    };
   });
 
   describe('registerPatternHandlers', () => {
     const handlers = [
-      { pattern: 'test', targetCallback: 'tt' },
-      { pattern: 'test2', targetCallback: '2', isEventHandler: true },
+      { patterns: ['test'], targetCallback: 'tt' },
+      { patterns: ['test2'], targetCallback: '2', isEventHandler: true },
     ];
 
     beforeEach(() => {
@@ -80,7 +89,7 @@ describe('ListenersController', () => {
     it(`should call "addHandler" method of server for each pattern handler with same transport`, () => {
       const serverHandlers = [
         {
-          pattern: { cmd: 'test' },
+          patterns: [{ cmd: 'test' }],
           targetCallback: 'tt',
           transport: Transport.TCP,
         },
@@ -92,8 +101,12 @@ describe('ListenersController', () => {
     });
     it(`should call "addHandler" method of server without transportID for each pattern handler with any transport value`, () => {
       const serverHandlers = [
-        { pattern: { cmd: 'test' }, targetCallback: 'tt' },
-        { pattern: 'test2', targetCallback: '2', transport: Transport.KAFKA },
+        { patterns: [{ cmd: 'test' }], targetCallback: 'tt' },
+        {
+          patterns: ['test2'],
+          targetCallback: '2',
+          transport: Transport.KAFKA,
+        },
       ];
       explorer.expects('explore').returns(serverHandlers);
       instance.registerPatternHandlers(new InstanceWrapper(), server, '');
@@ -101,10 +114,14 @@ describe('ListenersController', () => {
     });
     it(`should call "addHandler" method of server with transportID for each pattern handler with self transport and without transport`, () => {
       const serverHandlers = [
-        { pattern: 'test', targetCallback: 'tt' },
-        { pattern: 'test2', targetCallback: '2', transport: Transport.KAFKA },
+        { patterns: ['test'], targetCallback: 'tt' },
+        {
+          patterns: ['test2'],
+          targetCallback: '2',
+          transport: Transport.KAFKA,
+        },
         {
-          pattern: { cmd: 'test3' },
+          patterns: [{ cmd: 'test3' }],
           targetCallback: '3',
           transport: Transport.TCP,
         },
@@ -118,6 +135,44 @@ describe('ListenersController', () => {
       instance.registerPatternHandlers(new InstanceWrapper(), serverTCP, '');
       expect(addSpyTCP.calledTwice).to.be.true;
     });
+    it(`should call "addHandler" method of server with custom transportID for pattern handler with the same custom token`, () => {
+      const serverHandlers = [
+        {
+          patterns: [{ cmd: 'test' }],
+          targetCallback: 'tt',
+          transport: customTransport,
+        },
+        {
+          patterns: ['test2'],
+          targetCallback: '2',
+          transport: Transport.KAFKA,
+        },
+      ];
+
+      explorer.expects('explore').returns(serverHandlers);
+      instance.registerPatternHandlers(new InstanceWrapper(), serverCustom, '');
+      expect(addSpyCustom.calledOnce).to.be.true;
+    });
+    it(`should call "addHandler" method of server with extras data`, () => {
+      const serverHandlers = [
+        {
+          patterns: ['test'],
+          targetCallback: 'tt',
+          extras: { param: 'value' },
+        },
+      ];
+      explorer.expects('explore').returns(serverHandlers);
+      instance.registerPatternHandlers(new InstanceWrapper(), serverTCP, '');
+      expect(addSpyTCP.calledOnce).to.be.true;
+      expect(
+        addSpyTCP.calledWith(
+          sinon.match.any,
+          sinon.match.any,
+          sinon.match.any,
+          sinon.match({ param: 'value' }),
+        ),
+      ).to.be.true;
+    });
     describe('when request scoped', () => {
       it(`should call "addHandler" with deferred proxy`, () => {
         explorer.expects('explore').returns(handlers);
@@ -154,7 +209,7 @@ describe('ListenersController', () => {
       const module = {
         controllers: new Map(),
       } as any;
-      const pattern = {};
+      const patterns = [{}];
       const wrapper = new InstanceWrapper({ instance: { [methodKey]: {} } });
 
       it('should pass all arguments to the proxy chain', async () => {
@@ -163,7 +218,7 @@ describe('ListenersController', () => {
           .callsFake(() => Promise.resolve({}));
         const handler = instance.createRequestScopedHandler(
           wrapper,
-          pattern,
+          patterns,
           module,
           moduleKey,
           methodKey,
@@ -182,7 +237,7 @@ describe('ListenersController', () => {
       const module = {
         controllers: new Map(),
       } as any;
-      const pattern = {};
+      const patterns = [{}];
       const wrapper = new InstanceWrapper({ instance: { [methodKey]: {} } });
 
       it('should delegete error to exception filters', async () => {
@@ -191,7 +246,7 @@ describe('ListenersController', () => {
         });
         const handler = instance.createRequestScopedHandler(
           wrapper,
-          pattern,
+          patterns,
           module,
           moduleKey,
           methodKey,
diff --git a/packages/microservices/test/listeners-metadata-explorer.spec.ts b/packages/microservices/test/listeners-metadata-explorer.spec.ts
index 01b63413a..2bb04a763 100644
--- a/packages/microservices/test/listeners-metadata-explorer.spec.ts
+++ b/packages/microservices/test/listeners-metadata-explorer.spec.ts
@@ -2,15 +2,20 @@ import { expect } from 'chai';
 import * as sinon from 'sinon';
 import { MetadataScanner } from '../../core/metadata-scanner';
 import { Client } from '../decorators/client.decorator';
+import { EventPattern } from '../decorators/event-pattern.decorator';
 import { MessagePattern } from '../decorators/message-pattern.decorator';
 import { Transport } from '../enums/transport.enum';
 import { ListenerMetadataExplorer } from '../listener-metadata-explorer';
 
 describe('ListenerMetadataExplorer', () => {
-  const pattern = { pattern: 'test' };
-  const secPattern = { role: '2', cmd: 'm' };
+  const msgPattern = { pattern: 'testMsg' };
+  const firstMultipleMsgPattern = { pattern: 'testMultipleMsg1' };
+  const secondMultipleMsgPattern = { pattern: 'testMultipleMsg2' };
   const clientMetadata = {};
   const clientSecMetadata = { transport: Transport.REDIS };
+  const evtPattern = { role: 'testEvt' };
+  const firstMultipleEvtPattern = { role: 'testMultipleEvt1' };
+  const secondMultipleEvtPattern = { role: 'testMultipleEvt2' };
 
   class Test {
     @Client(clientMetadata as any)
@@ -25,11 +30,17 @@ describe('ListenerMetadataExplorer', () => {
 
     constructor() {}
 
-    @MessagePattern(pattern)
-    public test() {}
+    @MessagePattern(msgPattern)
+    public testMessage() {}
 
-    @MessagePattern(secPattern)
-    public testSec() {}
+    @MessagePattern([firstMultipleMsgPattern, secondMultipleMsgPattern])
+    public testMultipleMessage() {}
+
+    @EventPattern(evtPattern)
+    public testEvent() {}
+
+    @EventPattern([firstMultipleEvtPattern, secondMultipleEvtPattern])
+    public testMultipleEvent() {}
 
     public noPattern() {}
   }
@@ -66,19 +77,77 @@ describe('ListenerMetadataExplorer', () => {
       );
       expect(metadata).to.eq(undefined);
     });
-    it(`should return pattern properties when "handlerType" metadata is not undefined`, () => {
-      const metadata = instance.exploreMethodMetadata(
-        Object.getPrototypeOf(test),
-        'test',
-      );
-      expect(metadata).to.have.keys([
-        'isEventHandler',
-        'methodKey',
-        'targetCallback',
-        'pattern',
-        'transport',
-      ]);
-      expect(metadata.pattern).to.eql(pattern);
+
+    describe('@MessagePattern', () => {
+      it(`should return pattern properties when "handlerType" metadata is not undefined`, () => {
+        const metadata = instance.exploreMethodMetadata(
+          Object.getPrototypeOf(test),
+          'testMessage',
+        );
+        expect(metadata).to.have.keys([
+          'isEventHandler',
+          'methodKey',
+          'targetCallback',
+          'patterns',
+          'transport',
+          'extras',
+        ]);
+        expect(metadata.patterns.length).to.eql(1);
+        expect(metadata.patterns[0]).to.eql(msgPattern);
+      });
+      it(`should return multiple patterns when more than one is declared`, () => {
+        const metadata = instance.exploreMethodMetadata(
+          Object.getPrototypeOf(test),
+          'testMultipleMessage',
+        );
+        expect(metadata).to.have.keys([
+          'isEventHandler',
+          'methodKey',
+          'targetCallback',
+          'patterns',
+          'transport',
+          'extras',
+        ]);
+        expect(metadata.patterns.length).to.eql(2);
+        expect(metadata.patterns[0]).to.eql(firstMultipleMsgPattern);
+        expect(metadata.patterns[1]).to.eql(secondMultipleMsgPattern);
+      });
+    });
+
+    describe('@EventPattern', () => {
+      it(`should return pattern properties when "handlerType" metadata is not undefined`, () => {
+        const metadata = instance.exploreMethodMetadata(
+          Object.getPrototypeOf(test),
+          'testEvent',
+        );
+        expect(metadata).to.have.keys([
+          'isEventHandler',
+          'methodKey',
+          'targetCallback',
+          'patterns',
+          'transport',
+          'extras',
+        ]);
+        expect(metadata.patterns.length).to.eql(1);
+        expect(metadata.patterns[0]).to.eql(evtPattern);
+      });
+      it(`should return multiple patterns when more than one is declared`, () => {
+        const metadata = instance.exploreMethodMetadata(
+          Object.getPrototypeOf(test),
+          'testMultipleEvent',
+        );
+        expect(metadata).to.have.keys([
+          'isEventHandler',
+          'methodKey',
+          'targetCallback',
+          'patterns',
+          'transport',
+          'extras',
+        ]);
+        expect(metadata.patterns.length).to.eql(2);
+        expect(metadata.patterns[0]).to.eql(firstMultipleEvtPattern);
+        expect(metadata.patterns[1]).to.eql(secondMultipleEvtPattern);
+      });
     });
   });
   describe('scanForClientHooks', () => {
diff --git a/packages/microservices/test/serializers/kafka-request.serializer.spec.ts b/packages/microservices/test/serializers/kafka-request.serializer.spec.ts
index 5cde5292e..566e86d95 100644
--- a/packages/microservices/test/serializers/kafka-request.serializer.spec.ts
+++ b/packages/microservices/test/serializers/kafka-request.serializer.spec.ts
@@ -8,51 +8,51 @@ describe('KafkaRequestSerializer', () => {
     instance = new KafkaRequestSerializer();
   });
   describe('serialize', () => {
-    it('undefined', () => {
-      expect(instance.serialize(undefined)).to.deep.eq({
+    it('undefined', async () => {
+      expect(await instance.serialize(undefined)).to.deep.eq({
         headers: {},
         value: null,
       });
     });
 
-    it('null', () => {
-      expect(instance.serialize(null)).to.deep.eq({
+    it('null', async () => {
+      expect(await instance.serialize(null)).to.deep.eq({
         headers: {},
         value: null,
       });
     });
 
-    it('string', () => {
-      expect(instance.serialize('string')).to.deep.eq({
+    it('string', async () => {
+      expect(await instance.serialize('string')).to.deep.eq({
         headers: {},
         value: 'string',
       });
     });
 
-    it('number', () => {
-      expect(instance.serialize(12345)).to.deep.eq({
+    it('number', async () => {
+      expect(await instance.serialize(12345)).to.deep.eq({
         headers: {},
         value: '12345',
       });
     });
 
-    it('buffer', () => {
-      expect(instance.serialize(Buffer.from('buffer'))).to.deep.eq({
+    it('buffer', async () => {
+      expect(await instance.serialize(Buffer.from('buffer'))).to.deep.eq({
         headers: {},
         value: Buffer.from('buffer'),
       });
     });
 
-    it('array', () => {
-      expect(instance.serialize([1, 2, 3, 4, 5])).to.deep.eq({
+    it('array', async () => {
+      expect(await instance.serialize([1, 2, 3, 4, 5])).to.deep.eq({
         headers: {},
         value: '[1,2,3,4,5]',
       });
     });
 
-    it('object', () => {
+    it('object', async () => {
       expect(
-        instance.serialize({
+        await instance.serialize({
           prop: 'value',
         }),
       ).to.deep.eq({
@@ -61,7 +61,7 @@ describe('KafkaRequestSerializer', () => {
       });
     });
 
-    it('complex object with .toString()', () => {
+    it('complex object with .toString()', async () => {
       class Complex {
         private readonly name = 'complex';
         public toString(): string {
@@ -69,28 +69,30 @@ describe('KafkaRequestSerializer', () => {
         }
       }
 
-      expect(instance.serialize(new Complex())).to.deep.eq({
+      expect(await instance.serialize(new Complex())).to.deep.eq({
         headers: {},
         value: 'complex',
       });
     });
 
-    it('complex object without .toString()', () => {
+    it('complex object without .toString()', async () => {
       class ComplexWithOutToString {
         private readonly name = 'complex';
       }
 
-      expect(instance.serialize(new ComplexWithOutToString())).to.deep.eq({
-        headers: {},
-        value: '[object Object]',
-      });
+      expect(await instance.serialize(new ComplexWithOutToString())).to.deep.eq(
+        {
+          headers: {},
+          value: '[object Object]',
+        },
+      );
     });
   });
 
   describe('serialize kafka message', () => {
-    it('kafka message without key', () => {
+    it('kafka message without key', async () => {
       expect(
-        instance.serialize({
+        await instance.serialize({
           value: 'string',
         }),
       ).to.deep.eq({
@@ -99,9 +101,9 @@ describe('KafkaRequestSerializer', () => {
       });
     });
 
-    it('kafka message with key', () => {
+    it('kafka message with key', async () => {
       expect(
-        instance.serialize({
+        await instance.serialize({
           key: '1',
           value: 'string',
         }),
@@ -112,9 +114,9 @@ describe('KafkaRequestSerializer', () => {
       });
     });
 
-    it('kafka message with headers', () => {
+    it('kafka message with headers', async () => {
       expect(
-        instance.serialize({
+        await instance.serialize({
           key: '1',
           value: 'string',
           headers: {
diff --git a/packages/microservices/test/server/server-kafka.spec.ts b/packages/microservices/test/server/server-kafka.spec.ts
index 4d086581b..da129d56d 100644
--- a/packages/microservices/test/server/server-kafka.spec.ts
+++ b/packages/microservices/test/server/server-kafka.spec.ts
@@ -1,5 +1,5 @@
 import { Logger } from '@nestjs/common';
-import { expect } from 'chai';
+import { AssertionError, expect } from 'chai';
 import * as sinon from 'sinon';
 import { NO_MESSAGE_HANDLER } from '../../constants';
 import { KafkaHeaders } from '../../enums';
@@ -277,18 +277,77 @@ describe('ServerKafka', () => {
 
       sinon.stub(server, 'getPublisher').callsFake(() => getPublisherSpy);
     });
+
     it('should call "handleEvent" if correlation identifier is not present', async () => {
       const handleEventSpy = sinon.spy(server, 'handleEvent');
       await server.handleMessage(eventPayload);
       expect(handleEventSpy.called).to.be.true;
     });
 
-    it('should call "handleEvent" if correlation identifier is present by the reply topic is not present', async () => {
+    it('should call "handleEvent" if correlation identifier is present but the reply topic is not present', async () => {
       const handleEventSpy = sinon.spy(server, 'handleEvent');
       await server.handleMessage(eventWithCorrelationIdPayload);
       expect(handleEventSpy.called).to.be.true;
     });
 
+    it('should call event handler when "handleEvent" is called', async () => {
+      const messageHandler = sinon.mock();
+      const context = { test: true } as any;
+      const messageData = 'some data';
+      sinon.stub(server, 'getHandlerByPattern').callsFake(() => messageHandler);
+
+      await server.handleEvent(
+        topic,
+        { data: messageData, pattern: topic },
+        context,
+      );
+      expect(messageHandler.calledWith(messageData, context)).to.be.true;
+    });
+
+    it('should not catch error thrown by event handler as part of "handleEvent"', async () => {
+      const error = new Error('handler error');
+      const messageHandler = sinon.mock().throwsException(error);
+      sinon.stub(server, 'getHandlerByPattern').callsFake(() => messageHandler);
+
+      try {
+        await server.handleEvent(
+          topic,
+          { data: 'some data', pattern: topic },
+          {} as any,
+        );
+
+        // code should not be executed
+        expect(true).to.be.false;
+      } catch (e) {
+        if (e instanceof AssertionError) {
+          throw e;
+        }
+        expect(e).to.be.eq(error);
+      }
+    });
+
+    it('should call "handleEvent" if correlation identifier and reply topic are present but the handler is of type eventHandler', async () => {
+      const handler = sinon.spy();
+      (handler as any).isEventHandler = true;
+      (server as any).messageHandlers = objectToMap({
+        [topic]: handler,
+      });
+      const handleEventSpy = sinon.spy(server, 'handleEvent');
+      await server.handleMessage(payload);
+      expect(handleEventSpy.called).to.be.true;
+    });
+
+    it('should NOT call "handleEvent" if correlation identifier and reply topic are present but the handler is not of type eventHandler', async () => {
+      const handler = sinon.spy();
+      (handler as any).isEventHandler = false;
+      (server as any).messageHandlers = objectToMap({
+        [topic]: handler,
+      });
+      const handleEventSpy = sinon.spy(server, 'handleEvent');
+      await server.handleMessage(payload);
+      expect(handleEventSpy.called).to.be.false;
+    });
+
     it(`should publish NO_MESSAGE_HANDLER if pattern not exists in messageHandlers object`, async () => {
       await server.handleMessage(payload);
       expect(
@@ -298,6 +357,7 @@ describe('ServerKafka', () => {
         }),
       ).to.be.true;
     });
+
     it(`should call handler with expected arguments`, async () => {
       const handler = sinon.spy();
       (server as any).messageHandlers = objectToMap({
@@ -319,8 +379,8 @@ describe('ServerKafka', () => {
       });
     });
 
-    it('should send message', () => {
-      server.sendMessage(
+    it('should send message', async () => {
+      await server.sendMessage(
         {
           id: correlationId,
           response: messageValue,
@@ -345,8 +405,8 @@ describe('ServerKafka', () => {
         }),
       ).to.be.true;
     });
-    it('should send message without reply partition', () => {
-      server.sendMessage(
+    it('should send message without reply partition', async () => {
+      await server.sendMessage(
         {
           id: correlationId,
           response: messageValue,
@@ -370,8 +430,8 @@ describe('ServerKafka', () => {
         }),
       ).to.be.true;
     });
-    it('should send error message', () => {
-      server.sendMessage(
+    it('should send error message', async () => {
+      await server.sendMessage(
         {
           id: correlationId,
           err: NO_MESSAGE_HANDLER,
@@ -397,8 +457,8 @@ describe('ServerKafka', () => {
         }),
       ).to.be.true;
     });
-    it('should send `isDisposed` message', () => {
-      server.sendMessage(
+    it('should send `isDisposed` message', async () => {
+      await server.sendMessage(
         {
           id: correlationId,
           isDisposed: true,
diff --git a/packages/microservices/test/server/server-mqtt.spec.ts b/packages/microservices/test/server/server-mqtt.spec.ts
index 43f54eb4a..c5a0e30f2 100644
--- a/packages/microservices/test/server/server-mqtt.spec.ts
+++ b/packages/microservices/test/server/server-mqtt.spec.ts
@@ -112,7 +112,7 @@ describe('ServerMqtt', () => {
       const handleEventSpy = sinon.spy(server, 'handleEvent');
       await server.handleMessage(
         channel,
-        new Buffer(JSON.stringify({ pattern: '', data })),
+        Buffer.from(JSON.stringify({ pattern: '', data })),
         null,
       );
       expect(handleEventSpy.called).to.be.true;
@@ -120,7 +120,7 @@ describe('ServerMqtt', () => {
     it(`should publish NO_MESSAGE_HANDLER if pattern not exists in messageHandlers object`, async () => {
       await server.handleMessage(
         channel,
-        new Buffer(JSON.stringify({ id, pattern: '', data })),
+        Buffer.from(JSON.stringify({ id, pattern: '', data })),
         null,
       );
       expect(
@@ -139,7 +139,7 @@ describe('ServerMqtt', () => {
 
       await server.handleMessage(
         channel,
-        new Buffer(JSON.stringify({ pattern: '', data, id: '2' })),
+        Buffer.from(JSON.stringify({ pattern: '', data, id: '2' })),
         null,
       );
       expect(handler.calledWith(data)).to.be.true;
diff --git a/packages/microservices/test/server/server-redis.spec.ts b/packages/microservices/test/server/server-redis.spec.ts
index fc9650c87..2f0602f90 100644
--- a/packages/microservices/test/server/server-redis.spec.ts
+++ b/packages/microservices/test/server/server-redis.spec.ts
@@ -15,13 +15,17 @@ describe('ServerRedis', () => {
   });
   describe('listen', () => {
     let onSpy: sinon.SinonSpy;
+    let connectSpy: sinon.SinonSpy;
     let client: any;
     let callbackSpy: sinon.SinonSpy;
 
     beforeEach(() => {
       onSpy = sinon.spy();
+      connectSpy = sinon.spy();
+
       client = {
         on: onSpy,
+        connect: connectSpy,
       };
       sinon.stub(server, 'createRedisClient').callsFake(() => client);
 
@@ -31,13 +35,9 @@ describe('ServerRedis', () => {
       server.listen(callbackSpy);
       expect(onSpy.getCall(0).args[0]).to.be.equal('error');
     });
-    it('should bind "connect" event to handler', () => {
-      server.listen(callbackSpy);
-      expect(onSpy.getCall(3).args[0]).to.be.equal('connect');
-    });
-    it('should bind "message" event to handler', () => {
+    it('should call "RedisClient#connect()"', () => {
       server.listen(callbackSpy);
-      expect(onSpy.getCall(2).args[0]).to.be.equal('message');
+      expect(connectSpy.called).to.be.true;
     });
     describe('when "start" throws an exception', () => {
       it('should call callback with a thrown error as an argument', () => {
@@ -191,11 +191,11 @@ describe('ServerRedis', () => {
     });
   });
   describe('getClientOptions', () => {
-    it('should return options object with "retry_strategy" and call "createRetryStrategy"', () => {
+    it('should return options object with "retryStrategy" and call "createRetryStrategy"', () => {
       const createSpy = sinon.spy(server, 'createRetryStrategy');
-      const { retry_strategy } = server.getClientOptions();
+      const { retryStrategy } = server.getClientOptions();
       try {
-        retry_strategy({} as any);
+        retryStrategy(0);
       } catch {}
       expect(createSpy.called).to.be.true;
     });
@@ -204,37 +204,24 @@ describe('ServerRedis', () => {
     describe('when is terminated', () => {
       it('should return undefined', () => {
         (server as any).isExplicitlyTerminated = true;
-        const result = server.createRetryStrategy({} as any);
+        const result = server.createRetryStrategy(0);
         expect(result).to.be.undefined;
       });
     });
     describe('when "retryAttempts" does not exist', () => {
-      it('should throw an exception', () => {
+      it('should return undefined', () => {
         (server as any).options.options = {};
         (server as any).options.options.retryAttempts = undefined;
 
-        expect(() => server.createRetryStrategy({} as any)).to.throw(Error);
+        expect(server.createRetryStrategy(4)).to.be.undefined;
       });
     });
     describe('when "attempts" count is max', () => {
-      it('should throw an exception', () => {
+      it('should return undefined', () => {
         (server as any).options.options = {};
         (server as any).options.options.retryAttempts = 3;
 
-        expect(() =>
-          server.createRetryStrategy({ attempt: 4 } as any),
-        ).to.throw(Error);
-      });
-    });
-    describe('when ECONNREFUSED', () => {
-      it('should call logger', () => {
-        const loggerErrorSpy = sinon.spy((server as any).logger, 'error');
-        try {
-          server.createRetryStrategy({
-            error: { code: 'ECONNREFUSED' },
-          } as any);
-        } catch {}
-        expect(loggerErrorSpy.called).to.be.true;
+        expect(server.createRetryStrategy(4)).to.be.undefined;
       });
     });
     describe('otherwise', () => {
@@ -243,7 +230,7 @@ describe('ServerRedis', () => {
         (server as any).isExplicitlyTerminated = false;
         (server as any).options.retryAttempts = 3;
         (server as any).options.retryDelay = 3;
-        const result = server.createRetryStrategy({ attempt: 2 } as any);
+        const result = server.createRetryStrategy(2);
         expect(result).to.be.eql((server as any).options.retryDelay);
       });
     });
diff --git a/packages/microservices/test/server/server-rmq.spec.ts b/packages/microservices/test/server/server-rmq.spec.ts
index 5a0ded627..085e4d795 100644
--- a/packages/microservices/test/server/server-rmq.spec.ts
+++ b/packages/microservices/test/server/server-rmq.spec.ts
@@ -52,6 +52,10 @@ describe('ServerRMQ', () => {
       server.listen(callbackSpy);
       expect(onStub.getCall(1).args[0]).to.be.equal('disconnect');
     });
+    it('should bind "connectFailed" event to handler', () => {
+      server.listen(callbackSpy);
+      expect(onStub.getCall(2).args[0]).to.be.equal('connectFailed');
+    });
     describe('when "start" throws an exception', () => {
       it('should call callback with a thrown error as an argument', () => {
         const error = new Error('random error');
diff --git a/packages/microservices/test/server/server.spec.ts b/packages/microservices/test/server/server.spec.ts
index 111b48d2f..ae62ca108 100644
--- a/packages/microservices/test/server/server.spec.ts
+++ b/packages/microservices/test/server/server.spec.ts
@@ -116,7 +116,7 @@ describe('Server', () => {
       });
       describe('throws exception', () => {
         beforeEach(() => {
-          server.send(_throw('test') as any, sendSpy);
+          server.send(_throw(() => 'test') as any, sendSpy);
         });
         it('should send error and complete', () => {
           process.nextTick(() => {
@@ -149,7 +149,7 @@ describe('Server', () => {
   describe('transformToObservable', () => {
     describe('when resultOrDeferred', () => {
       describe('is Promise', () => {
-        it('should return Observable', async () => {
+        it('should return Observable that emits the resolved value of the supplied promise', async () => {
           const value = 100;
           expect(
             await lastValueFrom(
@@ -159,21 +159,29 @@ describe('Server', () => {
         });
       });
       describe('is Observable', () => {
-        it('should return Observable', async () => {
+        it('should return the observable itself', async () => {
           const value = 100;
           expect(
             await lastValueFrom(server.transformToObservable(of(value))),
           ).to.be.eq(100);
         });
       });
-      describe('is value', () => {
-        it('should return Observable', async () => {
+      describe('is any number', () => {
+        it('should return Observable that emits the supplied number', async () => {
           const value = 100;
           expect(
             await lastValueFrom(server.transformToObservable(value)),
           ).to.be.eq(100);
         });
       });
+      describe('is an array', () => {
+        it('should return Observable that emits the supplied array', async () => {
+          const value = [1, 2, 3];
+          expect(
+            await lastValueFrom(server.transformToObservable(value)),
+          ).to.be.eq(value);
+        });
+      });
     });
   });
 
diff --git a/packages/microservices/test/tsconfig.json b/packages/microservices/test/tsconfig.json
new file mode 100644
index 000000000..50d59661d
--- /dev/null
+++ b/packages/microservices/test/tsconfig.json
@@ -0,0 +1,3 @@
+{
+  "extends": "../../../tsconfig.spec.json"
+}
diff --git a/packages/microservices/utils/transform-pattern.utils.ts b/packages/microservices/utils/transform-pattern.utils.ts
index 0074ef409..4bcb299ed 100644
--- a/packages/microservices/utils/transform-pattern.utils.ts
+++ b/packages/microservices/utils/transform-pattern.utils.ts
@@ -1,4 +1,8 @@
-import { isObject, isString } from '@nestjs/common/utils/shared.utils';
+import {
+  isObject,
+  isString,
+  isNumber,
+} from '@nestjs/common/utils/shared.utils';
 import { MsPattern } from '../interfaces';
 
 /**
@@ -14,7 +18,7 @@ import { MsPattern } from '../interfaces';
  * @returns string
  */
 export function transformPatternToRoute(pattern: MsPattern): string {
-  if (isString(pattern) || typeof pattern === 'number') {
+  if (isString(pattern) || isNumber(pattern)) {
     return `${pattern}`;
   }
   if (!isObject(pattern)) {
diff --git a/packages/platform-express/CHANGELOG.md b/packages/platform-express/CHANGELOG.md
deleted file mode 100644
index 9fbcf7681..000000000
--- a/packages/platform-express/CHANGELOG.md
+++ /dev/null
@@ -1,12 +0,0 @@
-# Change Log
-
-All notable changes to this project will be documented in this file.
-See [Conventional Commits](https://conventionalcommits.org) for commit guidelines.
-
-<a name="8.2.0"></a>
-# [8.2.0](https://github.com/nestjs/nest/compare/v8.1.2...v8.2.0) (2021-11-08)
-
-
-### Features
-
-* **common:** add the ability to set some extra metadata about returned files ([5100573](https://github.com/nestjs/nest/commit/5100573))
diff --git a/packages/platform-express/Readme.md b/packages/platform-express/Readme.md
index f288809a9..9a3f42045 100644
--- a/packages/platform-express/Readme.md
+++ b/packages/platform-express/Readme.md
@@ -54,36 +54,42 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
 <table style="text-align:center;"><tr>
   <td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
+  <td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/red-hat-logo.svg" width="200" valign="middle" /></a></td>
 <td>
 <a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
 <td>
 <a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
+    <td>
+<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td><td>
+<a href="https://amplication.com/" target="_blank"><img src="https://nestjs.com/img/amplication-logo.svg" width="190" valign="middle" /></a></td>
 </tr></table>
 
 #### Gold Sponsors
 
 <table style="text-align:center;"><tr><td>
-  <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
-  <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
+<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="140" valign="middle" /></a></td>
 <td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
+<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td>
+ <td>
+<a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
+<a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td><td>
+<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
 <table style="text-align:center;"><tr><td>
 <a href="https://neoteric.eu/" target="_blank"><img src="https://nestjs.com/img/neoteric-cut.png" width="120" valign="middle" /></a> </td><td>
   <a href="http://gojob.com" target="_blank"><img src="http://nestjs.com/img/gojob-logo.png" valign="middle" width="100" /></a> </td><td>
-<a href="http://www.leogistics.com" target="_blank"><img src="https://nestjs.com/img/leogistics-logo.jpeg" width="150" valign="middle" /></td><td>
+<a href="https://www.myleodsc.com/" target="_blank"><img src="https://nestjs.com/img/myleo-logo.png" width="180" valign="middle" /></td><td>
 <a href="https://careers.meetdandy.com/?gh_src=063ba61e3us" target="_blank"><img src="https://nestjs.com/img/dandy-roles-logo.svg" width="150" valign="middle" /></td><td>
 <a href="https://www.castlecraft.in" target="_blank"><img src="https://nestjs.com/img/castlecraft-logo.png" width="150" valign="middle" /></td>
-<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td></tr></table>
+<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td>
+<td><a href="https://n.inc" target="_blank"><img src="https://nestjs.com/img/n-inc-logo.svg" width="120" valign="middle" /></td></tr></table>
 
 #### Sponsors
 
@@ -117,6 +123,11 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/naologic-logo.svg" width="125" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://messaged.com/" target="_blank"><img src="https://nestjs.com/img/messaged-logo.png" width="50" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/triplecore-logo.svg" width="50" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://klqc.de" target="_blank"><img src="https://nestjs.com/img/klcqcl-logo.png" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://thecasinowizard.com/bonuses/no-deposit-bonuses/" target="_blank"><img src="https://nestjs.com/img/casinowizard-logo.png" width="120" valign="middle" /></a></td></tr><tr>
+     <td align="center" valign="middle"><a href="https://polygon-software.ch/" target="_blank"><img src="https://nestjs.com/img/polygon-logo.svg" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://mobilereality.pl/" target="_blank"><img src="https://nestjs.com/img/mobile-reality-logo.png" width="45" valign="middle" /></a></td>
+     <td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/boringowl-logo.svg" width="120" valign="middle" /></a></td>
   </tr></table>
 
 ## Backers
diff --git a/packages/platform-express/adapters/express-adapter.ts b/packages/platform-express/adapters/express-adapter.ts
index 4717a3e8f..2bd9b226c 100644
--- a/packages/platform-express/adapters/express-adapter.ts
+++ b/packages/platform-express/adapters/express-adapter.ts
@@ -1,14 +1,13 @@
 import {
   InternalServerErrorException,
+  RawBodyRequest,
   RequestMethod,
   StreamableFile,
   VersioningType,
-} from '@nestjs/common';
-import {
   VersioningOptions,
-  VersionValue,
   VERSION_NEUTRAL,
-} from '@nestjs/common/interfaces';
+} from '@nestjs/common';
+import { VersionValue } from '@nestjs/common/interfaces';
 import {
   CorsOptions,
   CorsOptionsDelegate,
@@ -19,16 +18,30 @@ import {
   isNil,
   isObject,
   isString,
+  isUndefined,
 } from '@nestjs/common/utils/shared.utils';
 import { AbstractHttpAdapter } from '@nestjs/core/adapters/http-adapter';
 import { RouterMethodFactory } from '@nestjs/core/helpers/router-method-factory';
-import * as bodyParser from 'body-parser';
+import {
+  json as bodyParserJson,
+  OptionsJson,
+  urlencoded as bodyParserUrlencoded,
+} from 'body-parser';
 import * as cors from 'cors';
 import * as express from 'express';
 import * as http from 'http';
 import * as https from 'https';
 import { ServeStaticOptions } from '../interfaces/serve-static-options.interface';
 
+type VersionedRoute = <
+  TRequest extends Record<string, any> = any,
+  TResponse = any,
+>(
+  req: TRequest,
+  res: TResponse,
+  next: () => void,
+) => any;
+
 export class ExpressAdapter extends AbstractHttpAdapter {
   private readonly routerMethodFactory = new RouterMethodFactory();
 
@@ -45,12 +58,24 @@ export class ExpressAdapter extends AbstractHttpAdapter {
     }
     if (body instanceof StreamableFile) {
       const streamHeaders = body.getHeaders();
-      if (response.getHeader('Content-Type') === undefined) {
+      if (
+        response.getHeader('Content-Type') === undefined &&
+        streamHeaders.type !== undefined
+      ) {
         response.setHeader('Content-Type', streamHeaders.type);
       }
-      if (response.getHeader('Content-Disposition') === undefined) {
+      if (
+        response.getHeader('Content-Disposition') === undefined &&
+        streamHeaders.disposition !== undefined
+      ) {
         response.setHeader('Content-Disposition', streamHeaders.disposition);
       }
+      if (
+        response.getHeader('Content-Length') === undefined &&
+        streamHeaders.length !== undefined
+      ) {
+        response.setHeader('Content-Length', streamHeaders.length);
+      }
       return body.getStream().pipe(response);
     }
     return isObject(body) ? response.json(body) : response.send(String(body));
@@ -60,10 +85,6 @@ export class ExpressAdapter extends AbstractHttpAdapter {
     return response.status(statusCode);
   }
 
-  public end(response: any, message?: string) {
-    return response.end(message);
-  }
-
   public render(response: any, view: string, options: any) {
     return response.render(view, options);
   }
@@ -80,10 +101,6 @@ export class ExpressAdapter extends AbstractHttpAdapter {
     return this.use(handler);
   }
 
-  public isHeadersSent(response: any): boolean {
-    return response.headersSent;
-  }
-
   public setHeader(response: any, name: string, value: string) {
     return response.set(name, value);
   }
@@ -168,10 +185,22 @@ export class ExpressAdapter extends AbstractHttpAdapter {
     this.httpServer = http.createServer(this.getInstance());
   }
 
-  public registerParserMiddleware() {
+  public registerParserMiddleware(prefix?: string, rawBody?: boolean) {
+    let bodyParserJsonOptions: OptionsJson | undefined;
+    if (rawBody === true) {
+      bodyParserJsonOptions = {
+        verify: (req: RawBodyRequest<http.IncomingMessage>, _res, buffer) => {
+          if (Buffer.isBuffer(buffer)) {
+            req.rawBody = buffer;
+          }
+          return true;
+        },
+      };
+    }
+
     const parserMiddleware = {
-      jsonParser: bodyParser.json(),
-      urlencodedParser: bodyParser.urlencoded({ extended: true }),
+      jsonParser: bodyParserJson(bodyParserJsonOptions),
+      urlencodedParser: bodyParserUrlencoded({ extended: true }),
     };
     Object.keys(parserMiddleware)
       .filter(parser => !this.isMiddlewareApplied(parser))
@@ -191,21 +220,76 @@ export class ExpressAdapter extends AbstractHttpAdapter {
     handler: Function,
     version: VersionValue,
     versioningOptions: VersioningOptions,
-  ) {
-    return <TRequest extends Record<string, any> = any, TResponse = any>(
-      req: TRequest,
-      res: TResponse,
-      next: () => void,
-    ) => {
-      if (version === VERSION_NEUTRAL) {
-        return handler(req, res, next);
+  ): VersionedRoute {
+    const callNextHandler: VersionedRoute = (req, res, next) => {
+      if (!next) {
+        throw new InternalServerErrorException(
+          'HTTP adapter does not support filtering on version',
+        );
       }
+      return next();
+    };
+
+    if (
+      version === VERSION_NEUTRAL ||
       // URL Versioning is done via the path, so the filter continues forward
-      if (versioningOptions.type === VersioningType.URI) {
-        return handler(req, res, next);
-      }
-      // Media Type (Accept Header) Versioning Handler
-      if (versioningOptions.type === VersioningType.MEDIA_TYPE) {
+      versioningOptions.type === VersioningType.URI
+    ) {
+      const handlerForNoVersioning: VersionedRoute = (req, res, next) =>
+        handler(req, res, next);
+
+      return handlerForNoVersioning;
+    }
+
+    // Custom Extractor Versioning Handler
+    if (versioningOptions.type === VersioningType.CUSTOM) {
+      const handlerForCustomVersioning: VersionedRoute = (req, res, next) => {
+        const extractedVersion = versioningOptions.extractor(req);
+
+        if (Array.isArray(version)) {
+          if (
+            Array.isArray(extractedVersion) &&
+            version.filter(v => extractedVersion.includes(v as string)).length
+          ) {
+            return handler(req, res, next);
+          }
+
+          if (
+            isString(extractedVersion) &&
+            version.includes(extractedVersion)
+          ) {
+            return handler(req, res, next);
+          }
+        } else if (isString(version)) {
+          // Known bug here - if there are multiple versions supported across separate
+          // handlers/controllers, we can't select the highest matching handler.
+          // Since this code is evaluated per-handler, then we can't see if the highest
+          // specified version exists in a different handler.
+          if (
+            Array.isArray(extractedVersion) &&
+            extractedVersion.includes(version)
+          ) {
+            return handler(req, res, next);
+          }
+
+          if (isString(extractedVersion) && version === extractedVersion) {
+            return handler(req, res, next);
+          }
+        }
+
+        return callNextHandler(req, res, next);
+      };
+
+      return handlerForCustomVersioning;
+    }
+
+    // Media Type (Accept Header) Versioning Handler
+    if (versioningOptions.type === VersioningType.MEDIA_TYPE) {
+      const handlerForMediaTypeVersioning: VersionedRoute = (
+        req,
+        res,
+        next,
+      ) => {
         const MEDIA_TYPE_HEADER = 'Accept';
         const acceptHeaderValue: string | undefined =
           req.headers?.[MEDIA_TYPE_HEADER] ||
@@ -213,9 +297,16 @@ export class ExpressAdapter extends AbstractHttpAdapter {
 
         const acceptHeaderVersionParameter = acceptHeaderValue
           ? acceptHeaderValue.split(';')[1]
-          : '';
+          : undefined;
 
-        if (acceptHeaderVersionParameter) {
+        // No version was supplied
+        if (isUndefined(acceptHeaderVersionParameter)) {
+          if (Array.isArray(version)) {
+            if (version.includes(VERSION_NEUTRAL)) {
+              return handler(req, res, next);
+            }
+          }
+        } else {
           const headerVersion = acceptHeaderVersionParameter.split(
             versioningOptions.key,
           )[1];
@@ -230,14 +321,28 @@ export class ExpressAdapter extends AbstractHttpAdapter {
             }
           }
         }
-      }
-      // Header Versioning Handler
-      else if (versioningOptions.type === VersioningType.HEADER) {
+
+        return callNextHandler(req, res, next);
+      };
+
+      return handlerForMediaTypeVersioning;
+    }
+
+    // Header Versioning Handler
+    if (versioningOptions.type === VersioningType.HEADER) {
+      const handlerForHeaderVersioning: VersionedRoute = (req, res, next) => {
         const customHeaderVersionParameter: string | undefined =
           req.headers?.[versioningOptions.header] ||
           req.headers?.[versioningOptions.header.toLowerCase()];
 
-        if (customHeaderVersionParameter) {
+        // No version was supplied
+        if (isUndefined(customHeaderVersionParameter)) {
+          if (Array.isArray(version)) {
+            if (version.includes(VERSION_NEUTRAL)) {
+              return handler(req, res, next);
+            }
+          }
+        } else {
           if (Array.isArray(version)) {
             if (version.includes(customHeaderVersionParameter)) {
               return handler(req, res, next);
@@ -248,15 +353,12 @@ export class ExpressAdapter extends AbstractHttpAdapter {
             }
           }
         }
-      }
 
-      if (!next) {
-        throw new InternalServerErrorException(
-          'HTTP adapter does not support filtering on version',
-        );
-      }
-      return next();
-    };
+        return callNextHandler(req, res, next);
+      };
+
+      return handlerForHeaderVersioning;
+    }
   }
 
   private isMiddlewareApplied(name: string): boolean {
diff --git a/packages/platform-express/index.ts b/packages/platform-express/index.ts
index df03ac629..0ed4c2d76 100644
--- a/packages/platform-express/index.ts
+++ b/packages/platform-express/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @platform-express
- * Copyright(c) 2017 - 2021 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2022 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
diff --git a/packages/platform-express/package.json b/packages/platform-express/package.json
index d2843a9cf..9ac643d3a 100644
--- a/packages/platform-express/package.json
+++ b/packages/platform-express/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/platform-express",
-  "version": "8.2.3",
+  "version": "8.4.7",
   "description": "Nest - modern, fast, powerful node.js web framework (@platform-express)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -17,15 +17,15 @@
     "access": "public"
   },
   "dependencies": {
-    "body-parser": "1.19.0",
+    "body-parser": "1.20.0",
     "cors": "2.8.5",
-    "express": "4.17.1",
-    "multer": "1.4.3",
-    "tslib": "2.3.1"
+    "express": "4.18.1",
+    "multer": "1.4.4-lts.1",
+    "tslib": "2.4.0"
   },
   "devDependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3"
+    "@nestjs/common": "8.4.7",
+    "@nestjs/core": "8.4.7"
   },
   "peerDependencies": {
     "@nestjs/common": "^8.0.0",
diff --git a/packages/platform-express/test/tsconfig.json b/packages/platform-express/test/tsconfig.json
new file mode 100644
index 000000000..50d59661d
--- /dev/null
+++ b/packages/platform-express/test/tsconfig.json
@@ -0,0 +1,3 @@
+{
+  "extends": "../../../tsconfig.spec.json"
+}
diff --git a/packages/platform-fastify/CHANGELOG.md b/packages/platform-fastify/CHANGELOG.md
deleted file mode 100644
index 8c9c6cd94..000000000
--- a/packages/platform-fastify/CHANGELOG.md
+++ /dev/null
@@ -1,18 +0,0 @@
-# Change Log
-
-All notable changes to this project will be documented in this file.
-See [Conventional Commits](https://conventionalcommits.org) for commit guidelines.
-
-<a name="8.2.0"></a>
-# [8.2.0](https://github.com/nestjs/nest/compare/v8.1.2...v8.2.0) (2021-11-08)
-
-
-### Bug Fixes
-
-* **deps:** update dependency fastify to v3.23.1 ([63113d8](https://github.com/nestjs/nest/commit/63113d8))
-* **platform-fastify:** fix streamable file processing ([365c40b](https://github.com/nestjs/nest/commit/365c40b))
-
-
-### Features
-
-* **common:** add the ability to set some extra metadata about returned files ([5100573](https://github.com/nestjs/nest/commit/5100573))
diff --git a/packages/platform-fastify/Readme.md b/packages/platform-fastify/Readme.md
index f288809a9..9a3f42045 100644
--- a/packages/platform-fastify/Readme.md
+++ b/packages/platform-fastify/Readme.md
@@ -54,36 +54,42 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
 <table style="text-align:center;"><tr>
   <td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
+  <td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/red-hat-logo.svg" width="200" valign="middle" /></a></td>
 <td>
 <a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
 <td>
 <a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
+    <td>
+<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td><td>
+<a href="https://amplication.com/" target="_blank"><img src="https://nestjs.com/img/amplication-logo.svg" width="190" valign="middle" /></a></td>
 </tr></table>
 
 #### Gold Sponsors
 
 <table style="text-align:center;"><tr><td>
-  <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
-  <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
+<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="140" valign="middle" /></a></td>
 <td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
+<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td>
+ <td>
+<a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
+<a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td><td>
+<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
 <table style="text-align:center;"><tr><td>
 <a href="https://neoteric.eu/" target="_blank"><img src="https://nestjs.com/img/neoteric-cut.png" width="120" valign="middle" /></a> </td><td>
   <a href="http://gojob.com" target="_blank"><img src="http://nestjs.com/img/gojob-logo.png" valign="middle" width="100" /></a> </td><td>
-<a href="http://www.leogistics.com" target="_blank"><img src="https://nestjs.com/img/leogistics-logo.jpeg" width="150" valign="middle" /></td><td>
+<a href="https://www.myleodsc.com/" target="_blank"><img src="https://nestjs.com/img/myleo-logo.png" width="180" valign="middle" /></td><td>
 <a href="https://careers.meetdandy.com/?gh_src=063ba61e3us" target="_blank"><img src="https://nestjs.com/img/dandy-roles-logo.svg" width="150" valign="middle" /></td><td>
 <a href="https://www.castlecraft.in" target="_blank"><img src="https://nestjs.com/img/castlecraft-logo.png" width="150" valign="middle" /></td>
-<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td></tr></table>
+<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td>
+<td><a href="https://n.inc" target="_blank"><img src="https://nestjs.com/img/n-inc-logo.svg" width="120" valign="middle" /></td></tr></table>
 
 #### Sponsors
 
@@ -117,6 +123,11 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/naologic-logo.svg" width="125" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://messaged.com/" target="_blank"><img src="https://nestjs.com/img/messaged-logo.png" width="50" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/triplecore-logo.svg" width="50" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://klqc.de" target="_blank"><img src="https://nestjs.com/img/klcqcl-logo.png" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://thecasinowizard.com/bonuses/no-deposit-bonuses/" target="_blank"><img src="https://nestjs.com/img/casinowizard-logo.png" width="120" valign="middle" /></a></td></tr><tr>
+     <td align="center" valign="middle"><a href="https://polygon-software.ch/" target="_blank"><img src="https://nestjs.com/img/polygon-logo.svg" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://mobilereality.pl/" target="_blank"><img src="https://nestjs.com/img/mobile-reality-logo.png" width="45" valign="middle" /></a></td>
+     <td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/boringowl-logo.svg" width="120" valign="middle" /></a></td>
   </tr></table>
 
 ## Backers
diff --git a/packages/platform-fastify/adapters/fastify-adapter.ts b/packages/platform-fastify/adapters/fastify-adapter.ts
index 4ac3f72ee..96497c654 100644
--- a/packages/platform-fastify/adapters/fastify-adapter.ts
+++ b/packages/platform-fastify/adapters/fastify-adapter.ts
@@ -1,20 +1,24 @@
 import {
   HttpStatus,
   Logger,
+  RawBodyRequest,
   RequestMethod,
   StreamableFile,
   VersioningOptions,
   VersioningType,
+  VERSION_NEUTRAL,
 } from '@nestjs/common';
-import { VersionValue, VERSION_NEUTRAL } from '@nestjs/common/interfaces';
+import { VersionValue } from '@nestjs/common/interfaces';
 import {
   CorsOptions,
   CorsOptionsDelegate,
 } from '@nestjs/common/interfaces/external/cors-options.interface';
 import { loadPackage } from '@nestjs/common/utils/load-package.util';
+import { isString, isUndefined } from '@nestjs/common/utils/shared.utils';
 import { AbstractHttpAdapter } from '@nestjs/core/adapters/http-adapter';
 import {
   fastify,
+  FastifyBodyParser,
   FastifyInstance,
   FastifyLoggerInstance,
   FastifyPluginAsync,
@@ -65,7 +69,11 @@ type FastifyHttpsOptions<
   https: https.ServerOptions;
 };
 
-type VersionedRoute = Function & {
+type VersionedRoute<TRequest, TResponse> = ((
+  req: TRequest,
+  res: TResponse,
+  next: Function,
+) => Function) & {
   version: VersionValue;
   versioningOptions: VersioningOptions;
 };
@@ -107,30 +115,34 @@ export class FastifyAdapter<
   private readonly versionConstraint = {
     name: 'version',
     validate(value: unknown) {
-      if (typeof value !== 'string' && !Array.isArray(value)) {
+      if (!isString(value) && !Array.isArray(value)) {
         throw new Error(
           'Version constraint should be a string or an array of strings.',
         );
       }
     },
     storage() {
-      const versions = new Map();
+      const versions = new Map<string, unknown>();
       return {
         get(version: string | Array<string>) {
+          if (Array.isArray(version)) {
+            return versions.get(version.find(v => versions.has(v))) || null;
+          }
           return versions.get(version) || null;
         },
-        set(
-          versionOrVersions: string | Array<string>,
-          store: Map<string, any>,
-        ) {
-          const storeVersionConstraint = version =>
+        set(versionOrVersions: string | Array<string>, store: unknown) {
+          const storeVersionConstraint = (version: string) =>
             versions.set(version, store);
           if (Array.isArray(versionOrVersions))
             versionOrVersions.forEach(storeVersionConstraint);
           else storeVersionConstraint(versionOrVersions);
         },
         del(version: string | Array<string>) {
-          versions.delete(version);
+          if (Array.isArray(version)) {
+            version.forEach(v => versions.delete(v));
+          } else {
+            versions.delete(version);
+          }
         },
         empty() {
           versions.clear();
@@ -149,12 +161,9 @@ export class FastifyAdapter<
           ? acceptHeaderValue.split(';')[1]
           : '';
 
-        if (acceptHeaderVersionParameter) {
-          const headerVersion = acceptHeaderVersionParameter.split(
-            this.versioningOptions.key,
-          )[1];
-          return headerVersion;
-        }
+        return isUndefined(acceptHeaderVersionParameter)
+          ? VERSION_NEUTRAL // No version was supplied
+          : acceptHeaderVersionParameter.split(this.versioningOptions.key)[1];
       }
       // Header Versioning Handler
       else if (this.versioningOptions.type === VersioningType.HEADER) {
@@ -162,9 +171,13 @@ export class FastifyAdapter<
           req.headers?.[this.versioningOptions.header] ||
           req.headers?.[this.versioningOptions.header.toLowerCase()];
 
-        if (customHeaderVersionParameter) {
-          return customHeaderVersionParameter;
-        }
+        return isUndefined(customHeaderVersionParameter)
+          ? VERSION_NEUTRAL // No version was supplied
+          : customHeaderVersionParameter;
+      }
+      // Custom Versioning Handler
+      else if (this.versioningOptions.type === VersioningType.CUSTOM) {
+        return this.versioningOptions.extractor(req);
       }
       return undefined;
     },
@@ -246,11 +259,11 @@ export class FastifyAdapter<
     handler: Function,
     version: VersionValue,
     versioningOptions: VersioningOptions,
-  ) {
+  ): VersionedRoute<TRequest, TReply> {
     if (!this.versioningOptions) {
       this.versioningOptions = versioningOptions;
     }
-    const versionedRoute = handler as VersionedRoute;
+    const versionedRoute = handler as VersionedRoute<TRequest, TReply>;
     versionedRoute.version = version;
     return versionedRoute;
   }
@@ -281,12 +294,24 @@ export class FastifyAdapter<
     }
     if (body instanceof StreamableFile) {
       const streamHeaders = body.getHeaders();
-      if (fastifyReply.getHeader('Content-Type') === undefined) {
+      if (
+        fastifyReply.getHeader('Content-Type') === undefined &&
+        streamHeaders.type !== undefined
+      ) {
         fastifyReply.header('Content-Type', streamHeaders.type);
       }
-      if (fastifyReply.getHeader('Content-Disposition') === undefined) {
+      if (
+        fastifyReply.getHeader('Content-Disposition') === undefined &&
+        streamHeaders.disposition !== undefined
+      ) {
         fastifyReply.header('Content-Disposition', streamHeaders.disposition);
       }
+      if (
+        fastifyReply.getHeader('Content-Length') === undefined &&
+        streamHeaders.length !== undefined
+      ) {
+        fastifyReply.header('Content-Length', streamHeaders.length);
+      }
       body = body.getStream();
     }
     return fastifyReply.send(body);
@@ -300,10 +325,6 @@ export class FastifyAdapter<
     return (response as TReply).code(statusCode);
   }
 
-  public end(response: TReply, message?: string) {
-    response.raw.end(message);
-  }
-
   public render(
     response: TReply & { view: Function },
     view: string,
@@ -366,15 +387,15 @@ export class FastifyAdapter<
 
   public useStaticAssets(options: FastifyStaticOptions) {
     return this.register(
-      loadPackage('fastify-static', 'FastifyAdapter.useStaticAssets()', () =>
-        require('fastify-static'),
+      loadPackage('@fastify/static', 'FastifyAdapter.useStaticAssets()', () =>
+        require('@fastify/static'),
       ),
       options,
     );
   }
 
   public setViewEngine(options: PointOfViewOptions | string) {
-    if (typeof options === 'string') {
+    if (isString(options)) {
       new Logger('FastifyAdapter').error(
         "setViewEngine() doesn't support a string argument.",
       );
@@ -388,10 +409,6 @@ export class FastifyAdapter<
     );
   }
 
-  public isHeadersSent(response: TReply): boolean {
-    return response.sent;
-  }
-
   public setHeader(response: TReply, name: string, value: string) {
     return response.header(name, value);
   }
@@ -411,14 +428,19 @@ export class FastifyAdapter<
   }
 
   public enableCors(options: CorsOptions | CorsOptionsDelegate<TRequest>) {
-    this.register(import('fastify-cors'), options);
+    this.register(import('@fastify/cors'), options);
   }
 
-  public registerParserMiddleware() {
+  public registerParserMiddleware(prefix?: string, rawBody?: boolean) {
     if (this._isParserRegistered) {
       return;
     }
-    this.register(import('fastify-formbody'));
+    this.register(import('@fastify/formbody'));
+
+    if (rawBody) {
+      this.registerContentParserWithRawBody();
+    }
+
     this._isParserRegistered = true;
   }
 
@@ -429,11 +451,14 @@ export class FastifyAdapter<
       await this.registerMiddie();
     }
     return (path: string, callback: Function) => {
-      const normalizedPath = path.endsWith('/*')
+      let normalizedPath = path.endsWith('/*')
         ? `${path.slice(0, -1)}(.*)`
         : path;
 
-      // The following type assertion is valid as we use import('middie') rather than require('middie')
+      // Fallback to "(.*)" to support plugins like GraphQL
+      normalizedPath = normalizedPath === '/(.*)' ? '(.*)' : normalizedPath;
+
+      // The following type assertion is valid as we use import('@fastify/middie') rather than require('@fastify/middie')
       // ref https://github.com/fastify/middie/pull/55
       this.instance.use(
         normalizedPath,
@@ -463,9 +488,33 @@ export class FastifyAdapter<
     return !('status' in response);
   }
 
+  private registerContentParserWithRawBody() {
+    this.getInstance().addContentTypeParser<Buffer>(
+      'application/json',
+      { parseAs: 'buffer' },
+      (
+        req: RawBodyRequest<FastifyRequest<unknown, TServer, TRawRequest>>,
+        body: Buffer,
+        done,
+      ) => {
+        if (Buffer.isBuffer(body)) {
+          req.rawBody = body;
+        }
+
+        const { onProtoPoisoning, onConstructorPoisoning } =
+          this.instance.initialConfig;
+        const defaultJsonParser = this.instance.getDefaultJsonParser(
+          onProtoPoisoning || 'error',
+          onConstructorPoisoning || 'error',
+        ) as FastifyBodyParser<string | Buffer, TServer>;
+        defaultJsonParser(req, body, done);
+      },
+    );
+  }
+
   private async registerMiddie() {
     this.isMiddieRegistered = true;
-    await this.register(import('middie'));
+    await this.register(import('@fastify/middie'));
   }
 
   private getRequestOriginalUrl(rawRequest: TRawRequest) {
@@ -485,7 +534,7 @@ export class FastifyAdapter<
   ) {
     const handlerRef = args[args.length - 1];
     const isVersioned =
-      typeof handlerRef.version !== 'undefined' &&
+      !isUndefined(handlerRef.version) &&
       handlerRef.version !== VERSION_NEUTRAL;
 
     if (isVersioned) {
diff --git a/packages/platform-fastify/index.ts b/packages/platform-fastify/index.ts
index 6ee0f8cf9..2918a05af 100644
--- a/packages/platform-fastify/index.ts
+++ b/packages/platform-fastify/index.ts
@@ -1,6 +1,6 @@
 /*
- * Nest @platform-express
- * Copyright(c) 2017 - 2021 Kamil Mysliwiec
+ * Nest @platform-fastify
+ * Copyright(c) 2017 - 2022 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
diff --git a/packages/platform-fastify/interfaces/external/fastify-static-options.interface.ts b/packages/platform-fastify/interfaces/external/fastify-static-options.interface.ts
index 9f591764a..a0ccb1f22 100644
--- a/packages/platform-fastify/interfaces/external/fastify-static-options.interface.ts
+++ b/packages/platform-fastify/interfaces/external/fastify-static-options.interface.ts
@@ -2,15 +2,28 @@
  * "fastify-static" interfaces
  * @see https://github.com/fastify/fastify-static/blob/master/index.d.ts
  */
+import { Stats } from 'fs';
+
+interface ExtendedInformation {
+  fileCount: number;
+  totalFileCount: number;
+  folderCount: number;
+  totalFolderCount: number;
+  totalSize: number;
+  lastModified: number;
+}
 
 interface ListDir {
   href: string;
   name: string;
+  stats: Stats;
+  extendedInfo?: ExtendedInformation;
 }
 
 interface ListFile {
   href: string;
   name: string;
+  stats: Stats;
 }
 
 interface ListRender {
@@ -21,6 +34,8 @@ interface ListOptions {
   format: 'json' | 'html';
   names: string[];
   render: ListRender;
+  extendedFolderInfo?: boolean;
+  jsonFormat?: 'names' | 'extended';
 }
 
 // Passed on to `send`
@@ -48,6 +63,11 @@ export interface FastifyStaticOptions extends SendOptions {
   wildcard?: boolean;
   list?: boolean | ListOptions;
   allowedPath?: (pathName: string, root?: string) => boolean;
+  /**
+   * @description
+   * Opt-in to looking for pre-compressed files
+   */
+  preCompressed?: boolean;
 
   // Passed on to `send`
   acceptRanges?: boolean;
diff --git a/packages/platform-fastify/interfaces/external/point-of-view-options.interface.ts b/packages/platform-fastify/interfaces/external/point-of-view-options.interface.ts
index 4d5f918c6..f7ce1adeb 100644
--- a/packages/platform-fastify/interfaces/external/point-of-view-options.interface.ts
+++ b/packages/platform-fastify/interfaces/external/point-of-view-options.interface.ts
@@ -9,7 +9,6 @@ export interface PointOfViewOptions {
     nunjucks?: any;
     pug?: any;
     handlebars?: any;
-    marko?: any;
     mustache?: any;
     'art-template'?: any;
     twig?: any;
diff --git a/packages/platform-fastify/interfaces/nest-fastify-application.interface.ts b/packages/platform-fastify/interfaces/nest-fastify-application.interface.ts
index f275385ba..71908f43a 100644
--- a/packages/platform-fastify/interfaces/nest-fastify-application.interface.ts
+++ b/packages/platform-fastify/interfaces/nest-fastify-application.interface.ts
@@ -16,7 +16,7 @@ import { FastifyStaticOptions, PointOfViewOptions } from './external';
 export interface NestFastifyApplication extends INestApplication {
   /**
    * A wrapper function around native `fastify.register()` method.
-   * Example `app.register(require('fastify-formbody'))
+   * Example `app.register(require('@fastify/formbody'))
    * @returns {Promise<FastifyInstance>}
    */
   register<Options extends FastifyPluginOptions = any>(
diff --git a/packages/platform-fastify/package.json b/packages/platform-fastify/package.json
index edb5e03b9..75c02d58a 100644
--- a/packages/platform-fastify/package.json
+++ b/packages/platform-fastify/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/platform-fastify",
-  "version": "8.2.3",
+  "version": "8.4.7",
   "description": "Nest - modern, fast, powerful node.js web framework (@platform-fastify)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -17,16 +17,26 @@
     "access": "public"
   },
   "dependencies": {
-    "fastify": "3.24.1",
-    "fastify-cors": "6.0.2",
-    "fastify-formbody": "5.2.0",
-    "light-my-request": "4.7.0",
-    "middie": "5.3.0",
+    "@fastify/cors": "7.0.0",
+    "@fastify/formbody": "7.0.1",
+    "@fastify/middie": "8.0.0",
+    "fastify": "4.0.2",
+    "light-my-request": "5.0.0",
     "path-to-regexp": "3.2.0",
-    "tslib": "2.3.1"
+    "tslib": "2.4.0"
   },
   "peerDependencies": {
     "@nestjs/common": "^8.0.0",
-    "@nestjs/core": "^8.0.0"
+    "@nestjs/core": "^8.0.0",
+    "@fastify/static": "^5.0.0",
+    "point-of-view": "^5.0.0"
+  },
+  "peerDependenciesMeta": {
+    "@fastify/static": {
+      "optional": true
+    },
+    "point-of-view": {
+      "optional": true
+    }
   }
 }
diff --git a/packages/platform-socket.io/CHANGELOG.md b/packages/platform-socket.io/CHANGELOG.md
deleted file mode 100644
index 2074a9b0d..000000000
--- a/packages/platform-socket.io/CHANGELOG.md
+++ /dev/null
@@ -1,12 +0,0 @@
-# Change Log
-
-All notable changes to this project will be documented in this file.
-See [Conventional Commits](https://conventionalcommits.org) for commit guidelines.
-
-<a name="8.2.0"></a>
-# [8.2.0](https://github.com/nestjs/nest/compare/v8.1.2...v8.2.0) (2021-11-08)
-
-
-
-
-**Note:** Version bump only for package @nestjs/platform-socket.io
diff --git a/packages/platform-socket.io/Readme.md b/packages/platform-socket.io/Readme.md
index f288809a9..9a3f42045 100644
--- a/packages/platform-socket.io/Readme.md
+++ b/packages/platform-socket.io/Readme.md
@@ -54,36 +54,42 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
 <table style="text-align:center;"><tr>
   <td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
+  <td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/red-hat-logo.svg" width="200" valign="middle" /></a></td>
 <td>
 <a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
 <td>
 <a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
+    <td>
+<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td><td>
+<a href="https://amplication.com/" target="_blank"><img src="https://nestjs.com/img/amplication-logo.svg" width="190" valign="middle" /></a></td>
 </tr></table>
 
 #### Gold Sponsors
 
 <table style="text-align:center;"><tr><td>
-  <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
-  <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
+<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="140" valign="middle" /></a></td>
 <td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
+<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td>
+ <td>
+<a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
+<a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td><td>
+<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
 <table style="text-align:center;"><tr><td>
 <a href="https://neoteric.eu/" target="_blank"><img src="https://nestjs.com/img/neoteric-cut.png" width="120" valign="middle" /></a> </td><td>
   <a href="http://gojob.com" target="_blank"><img src="http://nestjs.com/img/gojob-logo.png" valign="middle" width="100" /></a> </td><td>
-<a href="http://www.leogistics.com" target="_blank"><img src="https://nestjs.com/img/leogistics-logo.jpeg" width="150" valign="middle" /></td><td>
+<a href="https://www.myleodsc.com/" target="_blank"><img src="https://nestjs.com/img/myleo-logo.png" width="180" valign="middle" /></td><td>
 <a href="https://careers.meetdandy.com/?gh_src=063ba61e3us" target="_blank"><img src="https://nestjs.com/img/dandy-roles-logo.svg" width="150" valign="middle" /></td><td>
 <a href="https://www.castlecraft.in" target="_blank"><img src="https://nestjs.com/img/castlecraft-logo.png" width="150" valign="middle" /></td>
-<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td></tr></table>
+<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td>
+<td><a href="https://n.inc" target="_blank"><img src="https://nestjs.com/img/n-inc-logo.svg" width="120" valign="middle" /></td></tr></table>
 
 #### Sponsors
 
@@ -117,6 +123,11 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/naologic-logo.svg" width="125" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://messaged.com/" target="_blank"><img src="https://nestjs.com/img/messaged-logo.png" width="50" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/triplecore-logo.svg" width="50" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://klqc.de" target="_blank"><img src="https://nestjs.com/img/klcqcl-logo.png" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://thecasinowizard.com/bonuses/no-deposit-bonuses/" target="_blank"><img src="https://nestjs.com/img/casinowizard-logo.png" width="120" valign="middle" /></a></td></tr><tr>
+     <td align="center" valign="middle"><a href="https://polygon-software.ch/" target="_blank"><img src="https://nestjs.com/img/polygon-logo.svg" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://mobilereality.pl/" target="_blank"><img src="https://nestjs.com/img/mobile-reality-logo.png" width="45" valign="middle" /></a></td>
+     <td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/boringowl-logo.svg" width="120" valign="middle" /></a></td>
   </tr></table>
 
 ## Backers
diff --git a/packages/platform-socket.io/index.ts b/packages/platform-socket.io/index.ts
index 175a4e0d6..2805fc831 100644
--- a/packages/platform-socket.io/index.ts
+++ b/packages/platform-socket.io/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @platform-socket.io
- * Copyright(c) 2017 - 2021 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2022 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
diff --git a/packages/platform-socket.io/package.json b/packages/platform-socket.io/package.json
index 38fde3ee1..21e06cf47 100644
--- a/packages/platform-socket.io/package.json
+++ b/packages/platform-socket.io/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/platform-socket.io",
-  "version": "8.2.3",
+  "version": "8.4.7",
   "description": "Nest - modern, fast, powerful node.js web framework (@platform-socket.io)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -17,8 +17,8 @@
     "access": "public"
   },
   "dependencies": {
-    "socket.io": "4.4.0",
-    "tslib": "2.3.1"
+    "socket.io": "4.5.1",
+    "tslib": "2.4.0"
   },
   "peerDependencies": {
     "@nestjs/common": "^8.0.0",
diff --git a/packages/platform-ws/CHANGELOG.md b/packages/platform-ws/CHANGELOG.md
deleted file mode 100644
index 38ce8ea49..000000000
--- a/packages/platform-ws/CHANGELOG.md
+++ /dev/null
@@ -1,12 +0,0 @@
-# Change Log
-
-All notable changes to this project will be documented in this file.
-See [Conventional Commits](https://conventionalcommits.org) for commit guidelines.
-
-<a name="8.2.0"></a>
-# [8.2.0](https://github.com/nestjs/nest/compare/v8.1.2...v8.2.0) (2021-11-08)
-
-
-
-
-**Note:** Version bump only for package @nestjs/platform-ws
diff --git a/packages/platform-ws/Readme.md b/packages/platform-ws/Readme.md
index f288809a9..9a3f42045 100644
--- a/packages/platform-ws/Readme.md
+++ b/packages/platform-ws/Readme.md
@@ -54,36 +54,42 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
 <table style="text-align:center;"><tr>
   <td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
+  <td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/red-hat-logo.svg" width="200" valign="middle" /></a></td>
 <td>
 <a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
 <td>
 <a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
+    <td>
+<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td><td>
+<a href="https://amplication.com/" target="_blank"><img src="https://nestjs.com/img/amplication-logo.svg" width="190" valign="middle" /></a></td>
 </tr></table>
 
 #### Gold Sponsors
 
 <table style="text-align:center;"><tr><td>
-  <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
-  <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
+<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="140" valign="middle" /></a></td>
 <td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
+<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td>
+ <td>
+<a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
+<a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td><td>
+<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
 <table style="text-align:center;"><tr><td>
 <a href="https://neoteric.eu/" target="_blank"><img src="https://nestjs.com/img/neoteric-cut.png" width="120" valign="middle" /></a> </td><td>
   <a href="http://gojob.com" target="_blank"><img src="http://nestjs.com/img/gojob-logo.png" valign="middle" width="100" /></a> </td><td>
-<a href="http://www.leogistics.com" target="_blank"><img src="https://nestjs.com/img/leogistics-logo.jpeg" width="150" valign="middle" /></td><td>
+<a href="https://www.myleodsc.com/" target="_blank"><img src="https://nestjs.com/img/myleo-logo.png" width="180" valign="middle" /></td><td>
 <a href="https://careers.meetdandy.com/?gh_src=063ba61e3us" target="_blank"><img src="https://nestjs.com/img/dandy-roles-logo.svg" width="150" valign="middle" /></td><td>
 <a href="https://www.castlecraft.in" target="_blank"><img src="https://nestjs.com/img/castlecraft-logo.png" width="150" valign="middle" /></td>
-<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td></tr></table>
+<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td>
+<td><a href="https://n.inc" target="_blank"><img src="https://nestjs.com/img/n-inc-logo.svg" width="120" valign="middle" /></td></tr></table>
 
 #### Sponsors
 
@@ -117,6 +123,11 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/naologic-logo.svg" width="125" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://messaged.com/" target="_blank"><img src="https://nestjs.com/img/messaged-logo.png" width="50" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/triplecore-logo.svg" width="50" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://klqc.de" target="_blank"><img src="https://nestjs.com/img/klcqcl-logo.png" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://thecasinowizard.com/bonuses/no-deposit-bonuses/" target="_blank"><img src="https://nestjs.com/img/casinowizard-logo.png" width="120" valign="middle" /></a></td></tr><tr>
+     <td align="center" valign="middle"><a href="https://polygon-software.ch/" target="_blank"><img src="https://nestjs.com/img/polygon-logo.svg" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://mobilereality.pl/" target="_blank"><img src="https://nestjs.com/img/mobile-reality-logo.png" width="45" valign="middle" /></a></td>
+     <td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/boringowl-logo.svg" width="120" valign="middle" /></a></td>
   </tr></table>
 
 ## Backers
diff --git a/packages/platform-ws/adapters/ws-adapter.ts b/packages/platform-ws/adapters/ws-adapter.ts
index cca1f81a6..973bce7b9 100644
--- a/packages/platform-ws/adapters/ws-adapter.ts
+++ b/packages/platform-ws/adapters/ws-adapter.ts
@@ -8,7 +8,7 @@ import {
 } from '@nestjs/websockets/constants';
 import { MessageMappingProperties } from '@nestjs/websockets/gateway-metadata-explorer';
 import * as http from 'http';
-import { EMPTY as empty, fromEvent, Observable } from 'rxjs';
+import { EMPTY, fromEvent, Observable } from 'rxjs';
 import { filter, first, mergeMap, share, takeUntil } from 'rxjs/operators';
 
 let wsPackage: any = {};
@@ -133,7 +133,7 @@ export class WsAdapter extends AbstractWsAdapter {
       const { callback } = messageHandler;
       return transform(callback(message.data));
     } catch {
-      return empty;
+      return EMPTY;
     }
   }
 
diff --git a/packages/platform-ws/index.ts b/packages/platform-ws/index.ts
index e1b9386e4..0fb20dd10 100644
--- a/packages/platform-ws/index.ts
+++ b/packages/platform-ws/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @platform-ws
- * Copyright(c) 2017 - 2021 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2022 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
diff --git a/packages/platform-ws/package.json b/packages/platform-ws/package.json
index ac6c0e077..da2154a36 100644
--- a/packages/platform-ws/package.json
+++ b/packages/platform-ws/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/platform-ws",
-  "version": "8.2.3",
+  "version": "8.4.7",
   "description": "Nest - modern, fast, powerful node.js web framework (@platform-ws)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -17,8 +17,8 @@
     "access": "public"
   },
   "dependencies": {
-    "tslib": "2.3.1",
-    "ws": "7.5.6"
+    "tslib": "2.4.0",
+    "ws": "8.8.0"
   },
   "peerDependencies": {
     "@nestjs/common": "^8.0.0",
diff --git a/packages/testing/CHANGELOG.md b/packages/testing/CHANGELOG.md
deleted file mode 100644
index fca1fb6df..000000000
--- a/packages/testing/CHANGELOG.md
+++ /dev/null
@@ -1,12 +0,0 @@
-# Change Log
-
-All notable changes to this project will be documented in this file.
-See [Conventional Commits](https://conventionalcommits.org) for commit guidelines.
-
-<a name="8.2.0"></a>
-# [8.2.0](https://github.com/nestjs/nest/compare/v8.1.2...v8.2.0) (2021-11-08)
-
-
-
-
-**Note:** Version bump only for package @nestjs/testing
diff --git a/packages/testing/Readme.md b/packages/testing/Readme.md
index f288809a9..9a3f42045 100644
--- a/packages/testing/Readme.md
+++ b/packages/testing/Readme.md
@@ -54,36 +54,42 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
 <table style="text-align:center;"><tr>
   <td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
+  <td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/red-hat-logo.svg" width="200" valign="middle" /></a></td>
 <td>
 <a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
 <td>
 <a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
+    <td>
+<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td><td>
+<a href="https://amplication.com/" target="_blank"><img src="https://nestjs.com/img/amplication-logo.svg" width="190" valign="middle" /></a></td>
 </tr></table>
 
 #### Gold Sponsors
 
 <table style="text-align:center;"><tr><td>
-  <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
-  <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
+<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="140" valign="middle" /></a></td>
 <td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
+<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td>
+ <td>
+<a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
+<a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td><td>
+<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
 <table style="text-align:center;"><tr><td>
 <a href="https://neoteric.eu/" target="_blank"><img src="https://nestjs.com/img/neoteric-cut.png" width="120" valign="middle" /></a> </td><td>
   <a href="http://gojob.com" target="_blank"><img src="http://nestjs.com/img/gojob-logo.png" valign="middle" width="100" /></a> </td><td>
-<a href="http://www.leogistics.com" target="_blank"><img src="https://nestjs.com/img/leogistics-logo.jpeg" width="150" valign="middle" /></td><td>
+<a href="https://www.myleodsc.com/" target="_blank"><img src="https://nestjs.com/img/myleo-logo.png" width="180" valign="middle" /></td><td>
 <a href="https://careers.meetdandy.com/?gh_src=063ba61e3us" target="_blank"><img src="https://nestjs.com/img/dandy-roles-logo.svg" width="150" valign="middle" /></td><td>
 <a href="https://www.castlecraft.in" target="_blank"><img src="https://nestjs.com/img/castlecraft-logo.png" width="150" valign="middle" /></td>
-<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td></tr></table>
+<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td>
+<td><a href="https://n.inc" target="_blank"><img src="https://nestjs.com/img/n-inc-logo.svg" width="120" valign="middle" /></td></tr></table>
 
 #### Sponsors
 
@@ -117,6 +123,11 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/naologic-logo.svg" width="125" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://messaged.com/" target="_blank"><img src="https://nestjs.com/img/messaged-logo.png" width="50" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/triplecore-logo.svg" width="50" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://klqc.de" target="_blank"><img src="https://nestjs.com/img/klcqcl-logo.png" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://thecasinowizard.com/bonuses/no-deposit-bonuses/" target="_blank"><img src="https://nestjs.com/img/casinowizard-logo.png" width="120" valign="middle" /></a></td></tr><tr>
+     <td align="center" valign="middle"><a href="https://polygon-software.ch/" target="_blank"><img src="https://nestjs.com/img/polygon-logo.svg" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://mobilereality.pl/" target="_blank"><img src="https://nestjs.com/img/mobile-reality-logo.png" width="45" valign="middle" /></a></td>
+     <td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/boringowl-logo.svg" width="120" valign="middle" /></a></td>
   </tr></table>
 
 ## Backers
diff --git a/packages/testing/index.ts b/packages/testing/index.ts
index c68ed76f1..0a4a47f73 100644
--- a/packages/testing/index.ts
+++ b/packages/testing/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @testing
- * Copyright(c) 2017 - 2021 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2022 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
diff --git a/packages/testing/package-lock.json b/packages/testing/package-lock.json
new file mode 100644
index 000000000..bf611a2b7
Binary files /dev/null and b/packages/testing/package-lock.json differ
diff --git a/packages/testing/package.json b/packages/testing/package.json
index bf07363c2..8dabd8912 100644
--- a/packages/testing/package.json
+++ b/packages/testing/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/testing",
-  "version": "8.2.3",
+  "version": "8.4.7",
   "description": "Nest - modern, fast, powerful node.js web framework (@testing)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -17,8 +17,7 @@
     "access": "public"
   },
   "dependencies": {
-    "optional": "0.1.4",
-    "tslib": "2.3.1"
+    "tslib": "2.4.0"
   },
   "peerDependencies": {
     "@nestjs/common": "^8.0.0",
diff --git a/packages/testing/testing-module.ts b/packages/testing/testing-module.ts
index d1e15acd6..e107acc52 100644
--- a/packages/testing/testing-module.ts
+++ b/packages/testing/testing-module.ts
@@ -9,6 +9,7 @@ import {
 import { NestMicroserviceOptions } from '@nestjs/common/interfaces/microservices/nest-microservice-options.interface';
 import { NestApplicationContextOptions } from '@nestjs/common/interfaces/nest-application-context-options.interface';
 import { loadPackage } from '@nestjs/common/utils/load-package.util';
+import { isUndefined } from '@nestjs/common/utils/shared.utils';
 import {
   AbstractHttpAdapter,
   NestApplication,
@@ -72,7 +73,7 @@ export class TestingModule extends NestApplicationContext {
   }
 
   private applyLogger(options: NestApplicationContextOptions | undefined) {
-    if (!options || !options.logger) {
+    if (!options || isUndefined(options.logger)) {
       return;
     }
     Logger.overrideLogger(options.logger);
diff --git a/packages/tsconfig.base.json b/packages/tsconfig.base.json
index ff837eb4f..d8d4c2be0 100644
--- a/packages/tsconfig.base.json
+++ b/packages/tsconfig.base.json
@@ -11,6 +11,7 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
+    "useUnknownInCatchVariables": false,
     "target": "es2017",
     "sourceMap": false,
     "allowJs": false,
diff --git a/packages/websockets/CHANGELOG.md b/packages/websockets/CHANGELOG.md
deleted file mode 100644
index 125af3005..000000000
--- a/packages/websockets/CHANGELOG.md
+++ /dev/null
@@ -1,12 +0,0 @@
-# Change Log
-
-All notable changes to this project will be documented in this file.
-See [Conventional Commits](https://conventionalcommits.org) for commit guidelines.
-
-<a name="8.2.0"></a>
-# [8.2.0](https://github.com/nestjs/nest/compare/v8.1.2...v8.2.0) (2021-11-08)
-
-
-
-
-**Note:** Version bump only for package @nestjs/websockets
diff --git a/packages/websockets/Readme.md b/packages/websockets/Readme.md
index f288809a9..9a3f42045 100644
--- a/packages/websockets/Readme.md
+++ b/packages/websockets/Readme.md
@@ -54,36 +54,42 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
 <table style="text-align:center;"><tr>
   <td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
+  <td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/red-hat-logo.svg" width="200" valign="middle" /></a></td>
 <td>
 <a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
 <td>
 <a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
+    <td>
+<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td><td>
+<a href="https://amplication.com/" target="_blank"><img src="https://nestjs.com/img/amplication-logo.svg" width="190" valign="middle" /></a></td>
 </tr></table>
 
 #### Gold Sponsors
 
 <table style="text-align:center;"><tr><td>
-  <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
-  <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
+<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="140" valign="middle" /></a></td>
 <td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
+<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td>
+ <td>
+<a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
+<a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td><td>
+<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
 <table style="text-align:center;"><tr><td>
 <a href="https://neoteric.eu/" target="_blank"><img src="https://nestjs.com/img/neoteric-cut.png" width="120" valign="middle" /></a> </td><td>
   <a href="http://gojob.com" target="_blank"><img src="http://nestjs.com/img/gojob-logo.png" valign="middle" width="100" /></a> </td><td>
-<a href="http://www.leogistics.com" target="_blank"><img src="https://nestjs.com/img/leogistics-logo.jpeg" width="150" valign="middle" /></td><td>
+<a href="https://www.myleodsc.com/" target="_blank"><img src="https://nestjs.com/img/myleo-logo.png" width="180" valign="middle" /></td><td>
 <a href="https://careers.meetdandy.com/?gh_src=063ba61e3us" target="_blank"><img src="https://nestjs.com/img/dandy-roles-logo.svg" width="150" valign="middle" /></td><td>
 <a href="https://www.castlecraft.in" target="_blank"><img src="https://nestjs.com/img/castlecraft-logo.png" width="150" valign="middle" /></td>
-<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td></tr></table>
+<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td>
+<td><a href="https://n.inc" target="_blank"><img src="https://nestjs.com/img/n-inc-logo.svg" width="120" valign="middle" /></td></tr></table>
 
 #### Sponsors
 
@@ -117,6 +123,11 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/naologic-logo.svg" width="125" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://messaged.com/" target="_blank"><img src="https://nestjs.com/img/messaged-logo.png" width="50" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/triplecore-logo.svg" width="50" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://klqc.de" target="_blank"><img src="https://nestjs.com/img/klcqcl-logo.png" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://thecasinowizard.com/bonuses/no-deposit-bonuses/" target="_blank"><img src="https://nestjs.com/img/casinowizard-logo.png" width="120" valign="middle" /></a></td></tr><tr>
+     <td align="center" valign="middle"><a href="https://polygon-software.ch/" target="_blank"><img src="https://nestjs.com/img/polygon-logo.svg" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://mobilereality.pl/" target="_blank"><img src="https://nestjs.com/img/mobile-reality-logo.png" width="45" valign="middle" /></a></td>
+     <td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/boringowl-logo.svg" width="120" valign="middle" /></a></td>
   </tr></table>
 
 ## Backers
diff --git a/packages/websockets/context/ws-proxy.ts b/packages/websockets/context/ws-proxy.ts
index ca1ce3b95..dee999afc 100644
--- a/packages/websockets/context/ws-proxy.ts
+++ b/packages/websockets/context/ws-proxy.ts
@@ -1,6 +1,5 @@
-import { isFunction } from '@nestjs/common/utils/shared.utils';
 import { ExecutionContextHost } from '@nestjs/core/helpers/execution-context-host';
-import { empty } from 'rxjs';
+import { EMPTY, isObservable } from 'rxjs';
 import { catchError } from 'rxjs/operators';
 import { WsExceptionsHandler } from '../exceptions/ws-exceptions-handler';
 
@@ -12,12 +11,12 @@ export class WsProxy {
     return async (...args: unknown[]) => {
       try {
         const result = await targetCallback(...args);
-        return !this.isObservable(result)
+        return !isObservable(result)
           ? result
           : result.pipe(
               catchError(error => {
                 this.handleError(exceptionsHandler, args, error);
-                return empty();
+                return EMPTY;
               }),
             );
       } catch (error) {
@@ -35,8 +34,4 @@ export class WsProxy {
     host.setType('ws');
     exceptionsHandler.handle(error, host);
   }
-
-  isObservable(result: any): boolean {
-    return result && isFunction(result.subscribe);
-  }
 }
diff --git a/packages/websockets/index.ts b/packages/websockets/index.ts
index 76db23065..e8baa6f07 100644
--- a/packages/websockets/index.ts
+++ b/packages/websockets/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @websockets
- * Copyright(c) 2017 - 2021 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2022 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
diff --git a/packages/websockets/interfaces/gateway-metadata.interface.ts b/packages/websockets/interfaces/gateway-metadata.interface.ts
index 1666b321f..e5ac2e7bc 100644
--- a/packages/websockets/interfaces/gateway-metadata.interface.ts
+++ b/packages/websockets/interfaces/gateway-metadata.interface.ts
@@ -31,22 +31,22 @@ export interface GatewayMetadata {
   parser?: any;
   /**
    * How many ms before a client without namespace is closed
-   * @default 45000
+   * @default 45_000
    */
   connectTimeout?: number;
   /**
    * How many ms without a pong packet to consider the connection closed
-   * @default 5000
+   * @default 20_000
    */
   pingTimeout?: number;
   /**
    * How many ms before sending a new ping packet
-   * @default 25000
+   * @default 25_000
    */
   pingInterval?: number;
   /**
    * How many ms before an uncompleted transport upgrade is cancelled
-   * @default 10000
+   * @default 10_000
    */
   upgradeTimeout?: number;
   /**
@@ -116,7 +116,7 @@ export interface GatewayMetadata {
   destroyUpgrade?: boolean;
   /**
    * Milliseconds after which unhandled requests are ended
-   * @default 1000
+   * @default 1_000
    */
   destroyUpgradeTimeout?: number;
 }
diff --git a/packages/websockets/package.json b/packages/websockets/package.json
index c1bbcacae..af1d682be 100644
--- a/packages/websockets/package.json
+++ b/packages/websockets/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/websockets",
-  "version": "8.2.3",
+  "version": "8.4.7",
   "description": "Nest - modern, fast, powerful node.js web framework (@websockets)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -13,12 +13,12 @@
   },
   "dependencies": {
     "iterare": "1.2.1",
-    "object-hash": "2.2.0",
-    "tslib": "2.3.1"
+    "object-hash": "3.0.0",
+    "tslib": "2.4.0"
   },
   "devDependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3"
+    "@nestjs/common": "8.4.7",
+    "@nestjs/core": "8.4.7"
   },
   "peerDependencies": {
     "@nestjs/common": "^8.0.0",
diff --git a/packages/websockets/test/context/ws-proxy.spec.ts b/packages/websockets/test/context/ws-proxy.spec.ts
index d4f2b065a..1d416c7d5 100644
--- a/packages/websockets/test/context/ws-proxy.spec.ts
+++ b/packages/websockets/test/context/ws-proxy.spec.ts
@@ -1,5 +1,5 @@
 import { expect } from 'chai';
-import { of, throwError } from 'rxjs';
+import { throwError } from 'rxjs';
 import * as sinon from 'sinon';
 import { WsProxy } from '../../context/ws-proxy';
 import { WsException } from '../../errors/ws-exception';
@@ -40,17 +40,4 @@ describe('WsProxy', () => {
       (await proxy(null, null)).subscribe(null, () => expectation.verify());
     });
   });
-
-  describe('isObservable', () => {
-    describe('when observable', () => {
-      it('should return true', () => {
-        expect(routerProxy.isObservable(of('test'))).to.be.true;
-      });
-    });
-    describe('when not observable', () => {
-      it('should return false', () => {
-        expect(routerProxy.isObservable({})).to.be.false;
-      });
-    });
-  });
 });
diff --git a/packages/websockets/test/tsconfig.json b/packages/websockets/test/tsconfig.json
new file mode 100644
index 000000000..50d59661d
--- /dev/null
+++ b/packages/websockets/test/tsconfig.json
@@ -0,0 +1,3 @@
+{
+  "extends": "../../../tsconfig.spec.json"
+}
diff --git a/packages/websockets/test/web-sockets-controller.spec.ts b/packages/websockets/test/web-sockets-controller.spec.ts
index 68503abb0..659afff09 100644
--- a/packages/websockets/test/web-sockets-controller.spec.ts
+++ b/packages/websockets/test/web-sockets-controller.spec.ts
@@ -345,7 +345,7 @@ describe('WebSocketsController', () => {
                 Promise.resolve(Promise.resolve(value)),
               ),
             ),
-          ).to.be.eq(100);
+          ).to.be.eq(value);
         });
       });
 
@@ -356,18 +356,29 @@ describe('WebSocketsController', () => {
             await lastValueFrom(
               await instance.pickResult(Promise.resolve(of(value))),
             ),
-          ).to.be.eq(100);
+          ).to.be.eq(value);
         });
       });
 
-      describe('is a value', () => {
+      describe('is an object that has the method `subscribe`', () => {
+        it('should return Promise<Observable>', async () => {
+          const value = { subscribe() {} };
+          expect(
+            await lastValueFrom(
+              await instance.pickResult(Promise.resolve(value)),
+            ),
+          ).to.equal(value);
+        });
+      });
+
+      describe('is an ordinary value', () => {
         it('should return Promise<Observable>', async () => {
           const value = 100;
           expect(
             await lastValueFrom(
               await instance.pickResult(Promise.resolve(value)),
             ),
-          ).to.be.eq(100);
+          ).to.be.eq(value);
         });
       });
     });
diff --git a/packages/websockets/web-sockets-controller.ts b/packages/websockets/web-sockets-controller.ts
index 75e790c82..d01811e17 100644
--- a/packages/websockets/web-sockets-controller.ts
+++ b/packages/websockets/web-sockets-controller.ts
@@ -1,9 +1,14 @@
 import { Type } from '@nestjs/common/interfaces/type.interface';
 import { Logger } from '@nestjs/common/services/logger.service';
-import { isFunction } from '@nestjs/common/utils/shared.utils';
 import { ApplicationConfig } from '@nestjs/core/application-config';
 import { MetadataScanner } from '@nestjs/core/metadata-scanner';
-import { from as fromPromise, Observable, of, Subject } from 'rxjs';
+import {
+  from as fromPromise,
+  Observable,
+  isObservable,
+  of,
+  Subject,
+} from 'rxjs';
 import { distinctUntilChanged, mergeAll } from 'rxjs/operators';
 import { GATEWAY_OPTIONS, PORT_METADATA } from './constants';
 import { WsContextCreator } from './context/ws-context-creator';
@@ -158,7 +163,7 @@ export class WebSocketsController {
     deferredResult: Promise<any>,
   ): Promise<Observable<any>> {
     const result = await deferredResult;
-    if (result && isFunction(result.subscribe)) {
+    if (isObservable(result)) {
       return result;
     }
     if (result instanceof Promise) {
diff --git a/sample/01-cats-app/package-lock.json b/sample/01-cats-app/package-lock.json
index aeab2a707..1f3bf12b1 100644
Binary files a/sample/01-cats-app/package-lock.json and b/sample/01-cats-app/package-lock.json differ
diff --git a/sample/01-cats-app/package.json b/sample/01-cats-app/package.json
index db1ac30e9..0f3562953 100644
--- a/sample/01-cats-app/package.json
+++ b/sample/01-cats-app/package.json
@@ -29,25 +29,25 @@
     "rxjs": "7.4.0"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
+    "@nestjs/cli": "8.1.7",
+    "@nestjs/schematics": "8.0.8",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.11",
+    "@types/jest": "27.4.1",
+    "@types/node": "16.11.26",
     "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
+    "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
     "eslint": "7.32.0",
     "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
+    "eslint-plugin-import": "2.25.4",
     "typescript": "4.3.5"
   },
   "jest": {
diff --git a/sample/02-gateways/package-lock.json b/sample/02-gateways/package-lock.json
index cbafcb706..450745806 100644
Binary files a/sample/02-gateways/package-lock.json and b/sample/02-gateways/package-lock.json differ
diff --git a/sample/02-gateways/package.json b/sample/02-gateways/package.json
index 471221b31..910a63c62 100644
--- a/sample/02-gateways/package.json
+++ b/sample/02-gateways/package.json
@@ -22,38 +22,37 @@
     "@nestjs/common": "8.2.3",
     "@nestjs/core": "8.2.3",
     "@nestjs/platform-express": "8.2.3",
-    "@nestjs/platform-socket.io": "8.2.3",
+    "@nestjs/platform-socket.io": "8.2.4",
     "@nestjs/websockets": "8.2.3",
+    "@socket.io/redis-adapter": "7.1.0",
     "class-transformer": "0.4.0",
     "class-validator": "0.13.2",
-    "redis": "3.1.2",
     "reflect-metadata": "0.1.13",
     "rimraf": "3.0.2",
     "rxjs": "7.4.0",
-    "socket.io-redis": "6.1.1"
+    "socket.io": "4.4.1"
   },
   "devDependencies": {
-    "@types/socket.io": "3.0.1",
-    "@types/socket.io-redis": "1.0.27",
-    "@types/ws": "7.4.7",
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
+    "@nestjs/cli": "8.1.7",
+    "@nestjs/schematics": "8.0.8",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.11",
+    "@types/node": "16.11.26",
     "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
+    "@types/ws": "8.2.2",
+    "@typescript-eslint/eslint-plugin": "4.33.0",
+    "@typescript-eslint/parser": "4.33.0",
+    "eslint": "7.32.0",
+    "eslint-config-prettier": "8.3.0",
+    "eslint-plugin-import": "2.25.4",
+    "jest": "27.5.1",
     "prettier": "2.5.1",
+    "redis": "4.0.3",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
     "typescript": "4.3.5"
   }
 }
diff --git a/sample/02-gateways/src/adapters/redis-io.adapter.ts b/sample/02-gateways/src/adapters/redis-io.adapter.ts
index a0f83932a..e8c4467d0 100644
--- a/sample/02-gateways/src/adapters/redis-io.adapter.ts
+++ b/sample/02-gateways/src/adapters/redis-io.adapter.ts
@@ -1,16 +1,23 @@
 import { IoAdapter } from '@nestjs/platform-socket.io';
-import { RedisClient } from 'redis';
 import { ServerOptions } from 'socket.io';
-import { createAdapter } from 'socket.io-redis';
-
-const pubClient = new RedisClient({ host: 'localhost', port: 6379 });
-const subClient = pubClient.duplicate();
-const redisAdapter = createAdapter({ pubClient, subClient });
+import { createAdapter } from '@socket.io/redis-adapter';
+import { createClient } from 'redis';
 
 export class RedisIoAdapter extends IoAdapter {
+  private adapterConstructor: ReturnType<typeof createAdapter>;
+
+  async connectToRedis(): Promise<void> {
+    const pubClient = createClient({ url: `redis://localhost:6379` });
+    const subClient = pubClient.duplicate();
+
+    await Promise.all([pubClient.connect(), subClient.connect()]);
+
+    this.adapterConstructor = createAdapter(pubClient, subClient);
+  }
+
   createIOServer(port: number, options?: ServerOptions): any {
     const server = super.createIOServer(port, options);
-    server.adapter(redisAdapter);
+    server.adapter(this.adapterConstructor);
     return server;
   }
 }
diff --git a/sample/02-gateways/src/main.ts b/sample/02-gateways/src/main.ts
index e1e10d969..02ced27bc 100644
--- a/sample/02-gateways/src/main.ts
+++ b/sample/02-gateways/src/main.ts
@@ -3,6 +3,12 @@ import { AppModule } from './app.module';
 
 async function bootstrap() {
   const app = await NestFactory.create(AppModule);
+
+  // Uncomment these lines to use the Redis adapter:
+  // const redisIoAdapter = new RedisIoAdapter(app);
+  // await redisIoAdapter.connectToRedis();
+  // app.useWebSocketAdapter(redisIoAdapter);
+
   await app.listen(3000);
   console.log(`Application is running on: ${await app.getUrl()}`);
 }
diff --git a/sample/03-microservices/package-lock.json b/sample/03-microservices/package-lock.json
index 71fb15f07..2081cae2d 100644
Binary files a/sample/03-microservices/package-lock.json and b/sample/03-microservices/package-lock.json differ
diff --git a/sample/03-microservices/package.json b/sample/03-microservices/package.json
index f0de1bb3c..9b2e8701c 100644
--- a/sample/03-microservices/package.json
+++ b/sample/03-microservices/package.json
@@ -30,25 +30,25 @@
     "rxjs": "7.4.0"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
+    "@nestjs/cli": "8.1.7",
+    "@nestjs/schematics": "8.0.8",
     "@nestjs/testing": "8.2.3",
     "@types/amqplib": "0.8.2",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.11",
+    "@types/node": "16.11.26",
     "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
+    "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
     "eslint": "7.32.0",
     "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
+    "eslint-plugin-import": "2.25.4",
     "typescript": "4.3.5"
   }
 }
diff --git a/sample/04-grpc/package-lock.json b/sample/04-grpc/package-lock.json
index 0784c5ca0..c5d034295 100644
Binary files a/sample/04-grpc/package-lock.json and b/sample/04-grpc/package-lock.json differ
diff --git a/sample/04-grpc/package.json b/sample/04-grpc/package.json
index b6dd775aa..698f661d3 100644
--- a/sample/04-grpc/package.json
+++ b/sample/04-grpc/package.json
@@ -32,24 +32,23 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
+    "@nestjs/schematics": "8.0.8",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.11",
+    "@types/node": "16.11.26",
     "@types/supertest": "2.0.11",
-    "@types/ws": "7.4.7",
-    "jest": "27.3.1",
+    "@typescript-eslint/eslint-plugin": "4.33.0",
+    "@typescript-eslint/parser": "4.33.0",
+    "eslint": "7.32.0",
+    "eslint-config-prettier": "8.3.0",
+    "eslint-plugin-import": "2.25.4",
+    "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
     "typescript": "4.3.5"
   }
 }
diff --git a/sample/05-sql-typeorm/.gitignore b/sample/05-sql-typeorm/.gitignore
index b5e5f9755..44c92371f 100644
--- a/sample/05-sql-typeorm/.gitignore
+++ b/sample/05-sql-typeorm/.gitignore
@@ -13,7 +13,6 @@ npm-debug.log
 /quick-start
 
 # tests
-/test
 /coverage
 /.nyc_output
 
diff --git a/sample/05-sql-typeorm/docker-compose.yml b/sample/05-sql-typeorm/docker-compose.yml
index eee25f209..a8b6aadb8 100644
--- a/sample/05-sql-typeorm/docker-compose.yml
+++ b/sample/05-sql-typeorm/docker-compose.yml
@@ -9,3 +9,11 @@ services:
       MYSQL_DATABASE: test
     ports:
       - "3306:3306"
+  db-test:
+    image: mysql:8
+    restart: always
+    environment:
+      MYSQL_ROOT_PASSWORD: root
+      MYSQL_DATABASE: test
+    ports:
+      - "3307:3306"
\ No newline at end of file
diff --git a/sample/05-sql-typeorm/package-lock.json b/sample/05-sql-typeorm/package-lock.json
index bd2c44e40..ac4a293b1 100644
Binary files a/sample/05-sql-typeorm/package-lock.json and b/sample/05-sql-typeorm/package-lock.json differ
diff --git a/sample/05-sql-typeorm/package.json b/sample/05-sql-typeorm/package.json
index 08b05f96e..5cd6af955 100644
--- a/sample/05-sql-typeorm/package.json
+++ b/sample/05-sql-typeorm/package.json
@@ -19,37 +19,36 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "@nestjs/typeorm": "8.0.2",
-    "mysql": "2.18.1",
+    "@nestjs/common": "8.4.5",
+    "@nestjs/core": "8.4.5",
+    "@nestjs/platform-express": "8.4.5",
+    "@nestjs/typeorm": "8.1.0",
+    "mysql2": "2.3.3",
     "reflect-metadata": "0.1.13",
     "rimraf": "3.0.2",
     "rxjs": "7.4.0",
-    "typeorm": "0.2.41"
+    "typeorm": "0.3.0"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
+    "@nestjs/cli": "8.1.7",
+    "@nestjs/schematics": "8.0.8",
+    "@nestjs/testing": "8.4.5",
     "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.11",
+    "@types/jest": "27.4.1",
+    "@types/node": "16.11.26",
     "@types/supertest": "2.0.11",
-    "@types/ws": "7.4.7",
-    "jest": "27.3.1",
+    "@typescript-eslint/eslint-plugin": "4.33.0",
+    "@typescript-eslint/parser": "4.33.0",
+    "eslint": "7.32.0",
+    "eslint-config-prettier": "8.3.0",
+    "eslint-plugin-import": "2.25.4",
+    "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
     "typescript": "4.3.5"
   },
   "jest": {
diff --git a/sample/05-sql-typeorm/src/users/users.controller.spec.ts b/sample/05-sql-typeorm/src/users/users.controller.spec.ts
index 199cea13b..4d1160037 100644
--- a/sample/05-sql-typeorm/src/users/users.controller.spec.ts
+++ b/sample/05-sql-typeorm/src/users/users.controller.spec.ts
@@ -76,10 +76,10 @@ describe('UsersController', () => {
 
   describe('findOne()', () => {
     it('should find a user', () => {
-      expect(usersController.findOne('1')).resolves.toEqual({
+      expect(usersController.findOne(1)).resolves.toEqual({
         firstName: 'firstName #1',
         lastName: 'lastName #1',
-        id: '1',
+        id: 1,
       });
       expect(usersService.findOne).toHaveBeenCalled();
     });
diff --git a/sample/05-sql-typeorm/src/users/users.controller.ts b/sample/05-sql-typeorm/src/users/users.controller.ts
index f710be650..4f88099cd 100644
--- a/sample/05-sql-typeorm/src/users/users.controller.ts
+++ b/sample/05-sql-typeorm/src/users/users.controller.ts
@@ -1,4 +1,12 @@
-import { Body, Controller, Delete, Get, Param, Post } from '@nestjs/common';
+import {
+  Body,
+  Controller,
+  Delete,
+  Get,
+  Param,
+  Post,
+  ParseIntPipe,
+} from '@nestjs/common';
 import { CreateUserDto } from './dto/create-user.dto';
 import { User } from './user.entity';
 import { UsersService } from './users.service';
@@ -18,7 +26,7 @@ export class UsersController {
   }
 
   @Get(':id')
-  findOne(@Param('id') id: string): Promise<User> {
+  findOne(@Param('id', ParseIntPipe) id: number): Promise<User> {
     return this.usersService.findOne(id);
   }
 
diff --git a/sample/05-sql-typeorm/src/users/users.service.spec.ts b/sample/05-sql-typeorm/src/users/users.service.spec.ts
index 46c8b7eda..575df1573 100644
--- a/sample/05-sql-typeorm/src/users/users.service.spec.ts
+++ b/sample/05-sql-typeorm/src/users/users.service.spec.ts
@@ -32,7 +32,7 @@ describe('UserService', () => {
           provide: getRepositoryToken(User),
           useValue: {
             find: jest.fn().mockResolvedValue(userArray),
-            findOne: jest.fn().mockResolvedValue(oneUser),
+            findOneBy: jest.fn().mockResolvedValue(oneUser),
             save: jest.fn().mockResolvedValue(oneUser),
             remove: jest.fn(),
             delete: jest.fn(),
@@ -74,9 +74,9 @@ describe('UserService', () => {
 
   describe('findOne()', () => {
     it('should get a single user', () => {
-      const repoSpy = jest.spyOn(repository, 'findOne');
-      expect(service.findOne('1')).resolves.toEqual(oneUser);
-      expect(repoSpy).toBeCalledWith('1');
+      const repoSpy = jest.spyOn(repository, 'findOneBy');
+      expect(service.findOne(1)).resolves.toEqual(oneUser);
+      expect(repoSpy).toBeCalledWith({ id: 1 });
     });
   });
 
diff --git a/sample/05-sql-typeorm/src/users/users.service.ts b/sample/05-sql-typeorm/src/users/users.service.ts
index 12ca83286..ac82eb7e1 100644
--- a/sample/05-sql-typeorm/src/users/users.service.ts
+++ b/sample/05-sql-typeorm/src/users/users.service.ts
@@ -23,8 +23,8 @@ export class UsersService {
     return this.usersRepository.find();
   }
 
-  findOne(id: string): Promise<User> {
-    return this.usersRepository.findOne(id);
+  findOne(id: number): Promise<User> {
+    return this.usersRepository.findOneBy({ id: id });
   }
 
   async remove(id: string): Promise<void> {
diff --git a/sample/05-sql-typeorm/test/jest-e2e.json b/sample/05-sql-typeorm/test/jest-e2e.json
new file mode 100644
index 000000000..e9d912f3e
--- /dev/null
+++ b/sample/05-sql-typeorm/test/jest-e2e.json
@@ -0,0 +1,9 @@
+{
+  "moduleFileExtensions": ["js", "json", "ts"],
+  "rootDir": ".",
+  "testEnvironment": "node",
+  "testRegex": ".e2e-spec.ts$",
+  "transform": {
+    "^.+\\.(t|j)s$": "ts-jest"
+  }
+}
diff --git a/sample/05-sql-typeorm/test/users/users.e2e-spec.ts b/sample/05-sql-typeorm/test/users/users.e2e-spec.ts
new file mode 100644
index 000000000..1f1db731f
--- /dev/null
+++ b/sample/05-sql-typeorm/test/users/users.e2e-spec.ts
@@ -0,0 +1,74 @@
+import { Test, TestingModule } from '@nestjs/testing';
+import { INestApplication } from '@nestjs/common';
+import * as request from 'supertest';
+import { UsersModule } from '../../src/users/users.module';
+import { TypeOrmModule } from '@nestjs/typeorm';
+import { CreateUserDto } from '../../src/users/dto/create-user.dto';
+
+describe('Users - /users (e2e)', () => {
+  const users = {
+    id: 1,
+    firstName: 'FirstName #1',
+    lastName: 'LastName #1',
+    isActive: true,
+  };
+
+  let app: INestApplication;
+
+  beforeAll(async () => {
+    const moduleFixture: TestingModule = await Test.createTestingModule({
+      imports: [
+        TypeOrmModule.forRoot({
+          type: 'mysql',
+          host: 'localhost',
+          port: 3307,
+          username: 'root',
+          password: 'root',
+          database: 'test',
+          autoLoadEntities: true,
+          synchronize: true,
+        }),
+        UsersModule,
+      ],
+    }).compile();
+
+    app = moduleFixture.createNestApplication();
+    await app.init();
+  });
+
+  it('Create [POST /users]', () => {
+    return request(app.getHttpServer())
+      .post('/users')
+      .send(users as CreateUserDto)
+      .expect(201)
+      .then(({ body }) => {
+        expect(body).toEqual(users);
+      });
+  });
+
+  it('Get all users [GET /users]', () => {
+    return request(app.getHttpServer())
+      .get('/users')
+      .expect(200)
+      .then(({ body }) => {
+        expect(body).toBeDefined();
+      });
+  });
+
+  it('Get one user [GET /users/:id]', () => {
+    return request(app.getHttpServer())
+      .get('/users/2')
+      .expect(200)
+      .then(({ body }) => {
+        expect(body).toBeDefined();
+      });
+  });
+
+  it('Delete one user [DELETE /users/:id]', () => {
+    return request(app.getHttpServer()).delete('/users/1').expect(200);
+  });
+
+  afterAll(async () => {
+    await app.close();
+  });
+});
diff --git a/sample/06-mongoose/package-lock.json b/sample/06-mongoose/package-lock.json
index b0d195555..3b88c4d08 100644
Binary files a/sample/06-mongoose/package-lock.json and b/sample/06-mongoose/package-lock.json differ
diff --git a/sample/06-mongoose/package.json b/sample/06-mongoose/package.json
index d57971c99..3996e3a4d 100644
--- a/sample/06-mongoose/package.json
+++ b/sample/06-mongoose/package.json
@@ -23,34 +23,31 @@
     "@nestjs/core": "8.2.3",
     "@nestjs/mongoose": "9.0.1",
     "@nestjs/platform-express": "8.2.3",
-    "mongoose": "6.0.14",
+    "mongoose": "6.0.15",
     "reflect-metadata": "0.1.13",
     "rimraf": "3.0.2",
     "rxjs": "7.4.0"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@types/mongoose": "5.11.96",
-    "@nestjs/schematics": "8.0.5",
+    "@nestjs/cli": "8.1.7",
+    "@nestjs/schematics": "8.0.8",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/mongoose": "5.11.96",
-    "@types/node": "16.11.11",
+    "@types/jest": "27.4.1",
+    "@types/node": "16.11.26",
     "@types/supertest": "2.0.11",
-    "@types/ws": "7.4.7",
-    "jest": "27.3.1",
+    "@typescript-eslint/eslint-plugin": "4.33.0",
+    "@typescript-eslint/parser": "4.33.0",
+    "eslint": "7.32.0",
+    "eslint-config-prettier": "8.3.0",
+    "eslint-plugin-import": "2.25.4",
+    "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
     "typescript": "4.3.5"
   },
   "jest": {
diff --git a/sample/06-mongoose/src/cats/cats.controller.ts b/sample/06-mongoose/src/cats/cats.controller.ts
index 84306fe38..c9aa1f645 100644
--- a/sample/06-mongoose/src/cats/cats.controller.ts
+++ b/sample/06-mongoose/src/cats/cats.controller.ts
@@ -1,4 +1,4 @@
-import { Body, Controller, Get, Post } from '@nestjs/common';
+import { Body, Controller, Delete, Get, Param, Post } from '@nestjs/common';
 import { CatsService } from './cats.service';
 import { CreateCatDto } from './dto/create-cat.dto';
 import { Cat } from './schemas/cat.schema';
@@ -16,4 +16,14 @@ export class CatsController {
   async findAll(): Promise<Cat[]> {
     return this.catsService.findAll();
   }
+
+  @Get(':id')
+  async findOne(@Param('id') id: string): Promise<Cat> {
+    return this.catsService.findOne(id);
+  }
+
+  @Delete(':id')
+  async delete(@Param('id') id: string) {
+    return this.catsService.delete(id);
+  }
 }
diff --git a/sample/06-mongoose/src/cats/cats.service.ts b/sample/06-mongoose/src/cats/cats.service.ts
index 73d44320a..46069489a 100644
--- a/sample/06-mongoose/src/cats/cats.service.ts
+++ b/sample/06-mongoose/src/cats/cats.service.ts
@@ -18,4 +18,15 @@ export class CatsService {
   async findAll(): Promise<Cat[]> {
     return this.catModel.find().exec();
   }
+
+  async findOne(id: string): Promise<Cat> {
+    return this.catModel.findOne({ _id: id }).exec();
+  }
+
+  async delete(id: string) {
+    const deletedCat = await this.catModel
+      .findByIdAndRemove({ _id: id })
+      .exec();
+    return deletedCat;
+  }
 }
diff --git a/sample/07-sequelize/package-lock.json b/sample/07-sequelize/package-lock.json
index a785233ec..5309547a7 100644
Binary files a/sample/07-sequelize/package-lock.json and b/sample/07-sequelize/package-lock.json differ
diff --git a/sample/07-sequelize/package.json b/sample/07-sequelize/package.json
index 57b810bb5..afd851bfc 100644
--- a/sample/07-sequelize/package.json
+++ b/sample/07-sequelize/package.json
@@ -33,26 +33,24 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@types/sequelize": "4.28.10",
-    "@nestjs/schematics": "8.0.5",
+    "@nestjs/schematics": "8.0.8",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.11",
+    "@types/jest": "27.4.1",
+    "@types/node": "16.11.26",
     "@types/supertest": "2.0.11",
-    "@types/ws": "7.4.7",
-    "jest": "27.3.1",
+    "@typescript-eslint/eslint-plugin": "4.33.0",
+    "@typescript-eslint/parser": "4.33.0",
+    "eslint": "7.32.0",
+    "eslint-config-prettier": "8.3.0",
+    "eslint-plugin-import": "2.25.4",
+    "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
     "typescript": "4.3.5"
   },
   "jest": {
diff --git a/sample/08-webpack/package-lock.json b/sample/08-webpack/package-lock.json
index b9cbdcf38..22b640f3b 100644
Binary files a/sample/08-webpack/package-lock.json and b/sample/08-webpack/package-lock.json differ
diff --git a/sample/08-webpack/package.json b/sample/08-webpack/package.json
index 1e376eaa5..bd3082723 100644
--- a/sample/08-webpack/package.json
+++ b/sample/08-webpack/package.json
@@ -19,19 +19,19 @@
     "typescript": "4.3.5"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@types/node": "16.11.11",
+    "@nestjs/cli": "8.1.7",
+    "@nestjs/schematics": "8.0.8",
+    "@types/node": "16.11.26",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
     "eslint": "7.32.0",
     "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
+    "eslint-plugin-import": "2.25.4",
     "start-server-webpack-plugin": "2.2.5",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-node": "10.4.0",
     "webpack": "5.64.4",
-    "webpack-cli": "4.9.1",
+    "webpack-cli": "4.9.2",
     "webpack-node-externals": "3.0.0"
   }
 }
diff --git a/sample/09-babel-example/package-lock.json b/sample/09-babel-example/package-lock.json
index b4b7db8e4..73d9627a8 100644
Binary files a/sample/09-babel-example/package-lock.json and b/sample/09-babel-example/package-lock.json differ
diff --git a/sample/09-babel-example/package.json b/sample/09-babel-example/package.json
index 20827e6ab..27e52a508 100644
--- a/sample/09-babel-example/package.json
+++ b/sample/09-babel-example/package.json
@@ -22,16 +22,16 @@
     "rxjs": "7.4.0"
   },
   "devDependencies": {
-    "@babel/cli": "7.16.0",
-    "@babel/core": "7.16.0",
-    "@babel/node": "7.16.0",
-    "@babel/plugin-proposal-decorators": "7.16.4",
-    "@babel/plugin-transform-runtime": "7.16.4",
-    "@babel/preset-env": "7.16.4",
-    "@babel/register": "7.16.0",
-    "@babel/runtime": "7.16.3",
+    "@babel/cli": "7.17.6",
+    "@babel/core": "7.17.8",
+    "@babel/node": "7.16.8",
+    "@babel/plugin-proposal-decorators": "7.17.8",
+    "@babel/plugin-transform-runtime": "7.17.0",
+    "@babel/preset-env": "7.16.11",
+    "@babel/register": "7.17.7",
+    "@babel/runtime": "7.17.8",
     "@nestjs/testing": "8.2.3",
-    "jest": "27.3.1",
+    "jest": "27.5.1",
     "nodemon": "2.0.15",
     "prettier": "2.5.1",
     "supertest": "6.1.6"
diff --git a/sample/10-fastify/package-lock.json b/sample/10-fastify/package-lock.json
index 939b9241a..62d3daa22 100644
Binary files a/sample/10-fastify/package-lock.json and b/sample/10-fastify/package-lock.json differ
diff --git a/sample/10-fastify/package.json b/sample/10-fastify/package.json
index 13ebb8be2..ae7816b8a 100644
--- a/sample/10-fastify/package.json
+++ b/sample/10-fastify/package.json
@@ -29,25 +29,24 @@
     "rxjs": "7.4.0"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
+    "@nestjs/cli": "8.1.7",
+    "@nestjs/schematics": "8.0.8",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.11",
+    "@types/node": "16.11.26",
     "@types/supertest": "2.0.11",
-    "@types/ws": "7.4.7",
-    "jest": "27.3.1",
+    "@typescript-eslint/eslint-plugin": "4.33.0",
+    "@typescript-eslint/parser": "4.33.0",
+    "eslint": "7.32.0",
+    "eslint-config-prettier": "8.3.0",
+    "eslint-plugin-import": "2.25.4",
+    "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
     "typescript": "4.3.5"
   }
 }
diff --git a/sample/11-swagger/package-lock.json b/sample/11-swagger/package-lock.json
index d8dd79670..5548b5217 100644
Binary files a/sample/11-swagger/package-lock.json and b/sample/11-swagger/package-lock.json differ
diff --git a/sample/11-swagger/package.json b/sample/11-swagger/package.json
index 7c9b57efd..0889b7ad0 100644
--- a/sample/11-swagger/package.json
+++ b/sample/11-swagger/package.json
@@ -28,27 +28,27 @@
     "reflect-metadata": "0.1.13",
     "rimraf": "3.0.2",
     "rxjs": "7.4.0",
-    "swagger-ui-express": "4.1.6"
+    "swagger-ui-express": "4.2.0"
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
+    "@nestjs/schematics": "8.0.8",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.11",
+    "@types/node": "16.11.26",
     "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
+    "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
     "eslint": "7.32.0",
     "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
+    "eslint-plugin-import": "2.25.4",
     "typescript": "4.3.5"
   }
 }
diff --git a/sample/12-graphql-schema-first/package-lock.json b/sample/12-graphql-schema-first/package-lock.json
index f612c8f61..e5467188a 100644
Binary files a/sample/12-graphql-schema-first/package-lock.json and b/sample/12-graphql-schema-first/package-lock.json differ
diff --git a/sample/12-graphql-schema-first/package.json b/sample/12-graphql-schema-first/package.json
index 35234cb9b..44e83e3d6 100644
--- a/sample/12-graphql-schema-first/package.json
+++ b/sample/12-graphql-schema-first/package.json
@@ -19,12 +19,14 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
+    "@graphql-tools/utils": "8.6.3",
+    "@nestjs/apollo": "10.0.0",
     "@nestjs/common": "8.2.3",
     "@nestjs/core": "8.2.3",
-    "@nestjs/graphql": "9.1.2",
+    "@nestjs/graphql": "10.0.0",
     "@nestjs/platform-express": "8.2.3",
-    "apollo-server": "3.5.0",
-    "apollo-server-express": "3.5.0",
+    "apollo-server": "3.6.2",
+    "apollo-server-express": "3.6.2",
     "class-transformer": "0.4.0",
     "class-validator": "0.13.2",
     "graphql": "15.7.2",
@@ -35,21 +37,21 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
+    "@nestjs/schematics": "8.0.8",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.11",
+    "@types/node": "16.11.26",
     "@types/supertest": "2.0.11",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
     "eslint": "7.32.0",
     "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "jest": "27.3.1",
+    "eslint-plugin-import": "2.25.4",
+    "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-morph": "12.2.0",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
diff --git a/sample/12-graphql-schema-first/src/app.module.ts b/sample/12-graphql-schema-first/src/app.module.ts
index c3b0f1f25..c6833d0f6 100644
--- a/sample/12-graphql-schema-first/src/app.module.ts
+++ b/sample/12-graphql-schema-first/src/app.module.ts
@@ -1,12 +1,16 @@
+import { ApolloDriver, ApolloDriverConfig } from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
 import { GraphQLModule } from '@nestjs/graphql';
 import { CatsModule } from './cats/cats.module';
+import { upperDirectiveTransformer } from './common/directives/upper-case.directive';
 
 @Module({
   imports: [
     CatsModule,
-    GraphQLModule.forRoot({
+    GraphQLModule.forRoot<ApolloDriverConfig>({
+      driver: ApolloDriver,
       typePaths: ['./**/*.graphql'],
+      transformSchema: schema => upperDirectiveTransformer(schema, 'upper'),
       installSubscriptionHandlers: true,
     }),
   ],
diff --git a/sample/12-graphql-schema-first/src/common/directives/upper-case.directive.ts b/sample/12-graphql-schema-first/src/common/directives/upper-case.directive.ts
index 49341fe8e..52cabe0ef 100644
--- a/sample/12-graphql-schema-first/src/common/directives/upper-case.directive.ts
+++ b/sample/12-graphql-schema-first/src/common/directives/upper-case.directive.ts
@@ -1,15 +1,32 @@
-import { SchemaDirectiveVisitor } from '@graphql-tools/utils';
-import { defaultFieldResolver, GraphQLField } from 'graphql';
+import { getDirective, MapperKind, mapSchema } from '@graphql-tools/utils';
+import { defaultFieldResolver, GraphQLSchema } from 'graphql';
 
-export class UpperCaseDirective extends SchemaDirectiveVisitor {
-  visitFieldDefinition(field: GraphQLField<any, any>) {
-    const { resolve = defaultFieldResolver } = field;
-    field.resolve = async function (...args) {
-      const result = await resolve.apply(this, args);
-      if (typeof result === 'string') {
-        return result.toUpperCase();
+export function upperDirectiveTransformer(
+  schema: GraphQLSchema,
+  directiveName: string,
+) {
+  return mapSchema(schema, {
+    [MapperKind.OBJECT_FIELD]: fieldConfig => {
+      const upperDirective = getDirective(
+        schema,
+        fieldConfig,
+        directiveName,
+      )?.[0];
+
+      if (upperDirective) {
+        const { resolve = defaultFieldResolver } = fieldConfig;
+
+        // Replace the original resolver with a function that *first* calls
+        // the original resolver, then converts its result to upper case
+        fieldConfig.resolve = async function (source, args, context, info) {
+          const result = await resolve(source, args, context, info);
+          if (typeof result === 'string') {
+            return result.toUpperCase();
+          }
+          return result;
+        };
+        return fieldConfig;
       }
-      return result;
-    };
-  }
+    },
+  });
 }
diff --git a/sample/12-graphql-schema-first/src/common/plugins/logging.plugin.ts b/sample/12-graphql-schema-first/src/common/plugins/logging.plugin.ts
index 8e48e29cb..449d257f4 100644
--- a/sample/12-graphql-schema-first/src/common/plugins/logging.plugin.ts
+++ b/sample/12-graphql-schema-first/src/common/plugins/logging.plugin.ts
@@ -1,4 +1,4 @@
-import { Plugin } from '@nestjs/graphql';
+import { Plugin } from '@nestjs/apollo';
 import {
   ApolloServerPlugin,
   GraphQLRequestListener,
diff --git a/sample/13-mongo-typeorm/package-lock.json b/sample/13-mongo-typeorm/package-lock.json
index 487c235c0..50260a27e 100644
Binary files a/sample/13-mongo-typeorm/package-lock.json and b/sample/13-mongo-typeorm/package-lock.json differ
diff --git a/sample/13-mongo-typeorm/package.json b/sample/13-mongo-typeorm/package.json
index 4e27cb4fc..37c15a7ac 100644
--- a/sample/13-mongo-typeorm/package.json
+++ b/sample/13-mongo-typeorm/package.json
@@ -30,23 +30,23 @@
     "typeorm": "0.2.41"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
+    "@nestjs/cli": "8.1.7",
+    "@nestjs/schematics": "8.0.8",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.11",
+    "@types/jest": "27.4.1",
+    "@types/node": "16.11.26",
     "@types/supertest": "2.0.11",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
     "eslint": "7.32.0",
     "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "jest": "27.3.1",
+    "eslint-plugin-import": "2.25.4",
+    "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "typescript": "4.3.5"
diff --git a/sample/13-mongo-typeorm/src/photo/photo.service.ts b/sample/13-mongo-typeorm/src/photo/photo.service.ts
index 31c751b35..0bca3ddee 100644
--- a/sample/13-mongo-typeorm/src/photo/photo.service.ts
+++ b/sample/13-mongo-typeorm/src/photo/photo.service.ts
@@ -1,13 +1,13 @@
 import { Injectable } from '@nestjs/common';
 import { InjectRepository } from '@nestjs/typeorm';
-import { Repository } from 'typeorm';
+import { MongoRepository } from 'typeorm';
 import { Photo } from './photo.entity';
 
 @Injectable()
 export class PhotoService {
   constructor(
     @InjectRepository(Photo)
-    private readonly photoRepository: Repository<Photo>,
+    private readonly photoRepository: MongoRepository<Photo>,
   ) {}
 
   async findAll(): Promise<Photo[]> {
diff --git a/sample/14-mongoose-base/package-lock.json b/sample/14-mongoose-base/package-lock.json
index 81a2fc5dd..10c9948a9 100644
Binary files a/sample/14-mongoose-base/package-lock.json and b/sample/14-mongoose-base/package-lock.json differ
diff --git a/sample/14-mongoose-base/package.json b/sample/14-mongoose-base/package.json
index 858c01ce6..aa2d93b68 100644
--- a/sample/14-mongoose-base/package.json
+++ b/sample/14-mongoose-base/package.json
@@ -22,29 +22,29 @@
     "@nestjs/common": "8.2.3",
     "@nestjs/core": "8.2.3",
     "@nestjs/platform-express": "8.2.3",
-    "mongoose": "6.0.14",
+    "mongoose": "6.0.15",
     "reflect-metadata": "0.1.13",
     "rimraf": "3.0.2",
     "rxjs": "7.4.0"
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
+    "@nestjs/schematics": "8.0.8",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.11",
+    "@types/jest": "27.4.1",
+    "@types/node": "16.11.26",
     "@types/supertest": "2.0.11",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
     "eslint": "7.32.0",
     "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "jest": "27.3.1",
+    "eslint-plugin-import": "2.25.4",
+    "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "typescript": "4.3.5"
diff --git a/sample/15-mvc/package-lock.json b/sample/15-mvc/package-lock.json
index cfe901c30..217509e85 100644
Binary files a/sample/15-mvc/package-lock.json and b/sample/15-mvc/package-lock.json differ
diff --git a/sample/15-mvc/package.json b/sample/15-mvc/package.json
index f03c43a5a..826740233 100644
--- a/sample/15-mvc/package.json
+++ b/sample/15-mvc/package.json
@@ -30,23 +30,23 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
+    "@nestjs/schematics": "8.0.8",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.11",
+    "@types/node": "16.11.26",
     "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
+    "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
     "eslint": "7.32.0",
     "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
+    "eslint-plugin-import": "2.25.4",
     "typescript": "4.3.5"
   }
 }
diff --git a/sample/16-gateways-ws/package-lock.json b/sample/16-gateways-ws/package-lock.json
index ef3488ffe..644c9c453 100644
Binary files a/sample/16-gateways-ws/package-lock.json and b/sample/16-gateways-ws/package-lock.json differ
diff --git a/sample/16-gateways-ws/package.json b/sample/16-gateways-ws/package.json
index 731497bc2..a5d024427 100644
--- a/sample/16-gateways-ws/package.json
+++ b/sample/16-gateways-ws/package.json
@@ -34,23 +34,23 @@
   "devDependencies": {
     "@types/ws": "7.4.7",
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
+    "@nestjs/schematics": "8.0.8",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.11",
+    "@types/node": "16.11.26",
     "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
+    "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
     "eslint": "7.32.0",
     "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
+    "eslint-plugin-import": "2.25.4",
     "typescript": "4.3.5"
   }
 }
diff --git a/sample/17-mvc-fastify/package-lock.json b/sample/17-mvc-fastify/package-lock.json
index 1b7af76c8..158c7b436 100644
Binary files a/sample/17-mvc-fastify/package-lock.json and b/sample/17-mvc-fastify/package-lock.json differ
diff --git a/sample/17-mvc-fastify/package.json b/sample/17-mvc-fastify/package.json
index 95bc8e367..03551e68b 100644
--- a/sample/17-mvc-fastify/package.json
+++ b/sample/17-mvc-fastify/package.json
@@ -22,7 +22,7 @@
     "@nestjs/common": "8.2.3",
     "@nestjs/core": "8.2.3",
     "@nestjs/platform-fastify": "8.2.3",
-    "fastify-static": "4.5.0",
+    "@fastify/static": "5.0.0",
     "handlebars": "4.7.7",
     "point-of-view": "4.15.3",
     "reflect-metadata": "0.1.13",
@@ -30,27 +30,24 @@
     "rxjs": "7.4.0"
   },
   "devDependencies": {
-    "@types/socket.io": "3.0.1",
-    "@types/socket.io-redis": "1.0.27",
-    "@types/ws": "7.4.7",
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
+    "@nestjs/cli": "8.1.7",
+    "@nestjs/schematics": "8.0.8",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.11",
+    "@types/node": "16.11.26",
     "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
+    "@typescript-eslint/eslint-plugin": "4.33.0",
+    "@typescript-eslint/parser": "4.33.0",
+    "eslint": "7.32.0",
+    "eslint-config-prettier": "8.3.0",
+    "eslint-plugin-import": "2.25.4",
+    "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
     "typescript": "4.3.5"
   }
 }
diff --git a/sample/18-context/package-lock.json b/sample/18-context/package-lock.json
index 796b72dd6..907d5026c 100644
Binary files a/sample/18-context/package-lock.json and b/sample/18-context/package-lock.json differ
diff --git a/sample/18-context/package.json b/sample/18-context/package.json
index 025d11141..af397b8f3 100644
--- a/sample/18-context/package.json
+++ b/sample/18-context/package.json
@@ -27,21 +27,21 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@types/node": "16.11.11",
+    "@nestjs/schematics": "8.0.8",
+    "@types/node": "16.11.26",
     "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
+    "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
     "eslint": "7.32.0",
     "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
+    "eslint-plugin-import": "2.25.4",
     "typescript": "4.3.5"
   }
 }
diff --git a/sample/19-auth-jwt/package-lock.json b/sample/19-auth-jwt/package-lock.json
index f3e5da6cf..bbde2473e 100644
Binary files a/sample/19-auth-jwt/package-lock.json and b/sample/19-auth-jwt/package-lock.json differ
diff --git a/sample/19-auth-jwt/package.json b/sample/19-auth-jwt/package.json
index fb19401ef..b1fd1c297 100644
--- a/sample/19-auth-jwt/package.json
+++ b/sample/19-auth-jwt/package.json
@@ -34,24 +34,24 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
+    "@nestjs/schematics": "8.0.8",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.11",
+    "@types/jest": "27.4.1",
+    "@types/node": "16.11.26",
     "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
+    "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
     "eslint": "7.32.0",
     "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
+    "eslint-plugin-import": "2.25.4",
     "typescript": "4.3.5"
   },
   "jest": {
diff --git a/sample/20-cache/package-lock.json b/sample/20-cache/package-lock.json
index 1f138a05e..c4f66a4a0 100644
Binary files a/sample/20-cache/package-lock.json and b/sample/20-cache/package-lock.json differ
diff --git a/sample/20-cache/package.json b/sample/20-cache/package.json
index c0528fcf0..0429ef329 100644
--- a/sample/20-cache/package.json
+++ b/sample/20-cache/package.json
@@ -30,23 +30,23 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
+    "@nestjs/schematics": "8.0.8",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.11",
+    "@types/node": "16.11.26",
     "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
+    "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
     "eslint": "7.32.0",
     "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
+    "eslint-plugin-import": "2.25.4",
     "typescript": "4.3.5"
   }
 }
diff --git a/sample/21-serializer/package-lock.json b/sample/21-serializer/package-lock.json
index fc18b0fc8..e38ad4229 100644
Binary files a/sample/21-serializer/package-lock.json and b/sample/21-serializer/package-lock.json differ
diff --git a/sample/21-serializer/package.json b/sample/21-serializer/package.json
index d9731cf38..25bbfbfd5 100644
--- a/sample/21-serializer/package.json
+++ b/sample/21-serializer/package.json
@@ -29,23 +29,23 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
+    "@nestjs/schematics": "8.0.8",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.11",
+    "@types/node": "16.11.26",
     "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
+    "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
     "eslint": "7.32.0",
     "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
+    "eslint-plugin-import": "2.25.4",
     "typescript": "4.3.5"
   }
 }
diff --git a/sample/22-graphql-prisma/package-lock.json b/sample/22-graphql-prisma/package-lock.json
index 95b8cd080..c613518e9 100644
Binary files a/sample/22-graphql-prisma/package-lock.json and b/sample/22-graphql-prisma/package-lock.json differ
diff --git a/sample/22-graphql-prisma/package.json b/sample/22-graphql-prisma/package.json
index 3a1b01402..4f1f230d5 100644
--- a/sample/22-graphql-prisma/package.json
+++ b/sample/22-graphql-prisma/package.json
@@ -19,11 +19,12 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
+    "@nestjs/apollo": "10.0.0",
     "@nestjs/common": "8.2.3",
     "@nestjs/core": "8.2.3",
-    "@nestjs/graphql": "9.1.2",
+    "@nestjs/graphql": "10.0.0",
     "@nestjs/platform-express": "8.2.3",
-    "apollo-server-express": "3.5.0",
+    "apollo-server-express": "3.6.2",
     "graphql": "15.7.2",
     "graphql-tools": "7.0.5",
     "prisma-binding": "2.3.16",
@@ -33,23 +34,23 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
+    "@nestjs/schematics": "8.0.8",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.11",
+    "@types/node": "16.11.26",
     "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
+    "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
     "eslint": "7.32.0",
     "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
+    "eslint-plugin-import": "2.25.4",
     "typescript": "4.3.5"
   }
 }
diff --git a/sample/22-graphql-prisma/src/app.module.ts b/sample/22-graphql-prisma/src/app.module.ts
index 616ec9848..f986403ce 100644
--- a/sample/22-graphql-prisma/src/app.module.ts
+++ b/sample/22-graphql-prisma/src/app.module.ts
@@ -1,13 +1,15 @@
+import { ApolloDriver, ApolloDriverConfig } from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
 import { GraphQLModule } from '@nestjs/graphql';
-import { GraphqlOptions } from './graphql.options';
+import { GraphQLOptionsHost } from './graphql.options';
 import { PostsModule } from './posts/posts.module';
 import { PrismaModule } from './prisma/prisma.module';
 
 @Module({
   imports: [
-    GraphQLModule.forRootAsync({
-      useClass: GraphqlOptions,
+    GraphQLModule.forRootAsync<ApolloDriverConfig>({
+      driver: ApolloDriver,
+      useClass: GraphQLOptionsHost,
     }),
     PrismaModule,
     PostsModule,
diff --git a/sample/22-graphql-prisma/src/graphql.options.ts b/sample/22-graphql-prisma/src/graphql.options.ts
index 5de5f64ae..4fe640808 100644
--- a/sample/22-graphql-prisma/src/graphql.options.ts
+++ b/sample/22-graphql-prisma/src/graphql.options.ts
@@ -1,10 +1,11 @@
+import { ApolloDriverConfig } from '@nestjs/apollo';
 import { Injectable } from '@nestjs/common';
-import { GqlModuleOptions, GqlOptionsFactory } from '@nestjs/graphql';
+import { GqlOptionsFactory } from '@nestjs/graphql';
 import { join } from 'path';
 
 @Injectable()
-export class GraphqlOptions implements GqlOptionsFactory {
-  createGqlOptions(): Promise<GqlModuleOptions> | GqlModuleOptions {
+export class GraphQLOptionsHost implements GqlOptionsFactory {
+  createGqlOptions(): Promise<ApolloDriverConfig> | ApolloDriverConfig {
     return {
       typePaths: ['./src/**/*.graphql'],
       path: '/',
diff --git a/sample/22-graphql-prisma/src/graphql.schema.d.ts b/sample/22-graphql-prisma/src/graphql.schema.d.ts
index d818b240e..c216c2d42 100644
--- a/sample/22-graphql-prisma/src/graphql.schema.d.ts
+++ b/sample/22-graphql-prisma/src/graphql.schema.d.ts
@@ -1,209 +1,183 @@
-/** ------------------------------------------------------
+
+/*
+ * -------------------------------------------------------
  * THIS FILE WAS AUTOMATICALLY GENERATED (DO NOT MODIFY)
  * -------------------------------------------------------
  */
 
 /* tslint:disable */
+/* eslint-disable */
 export enum MutationType {
-  CREATED = 'CREATED',
-  UPDATED = 'UPDATED',
-  DELETED = 'DELETED',
+    CREATED = "CREATED",
+    UPDATED = "UPDATED",
+    DELETED = "DELETED"
 }
 
 export enum PostOrderByInput {
-  id_ASC = 'id_ASC',
-  id_DESC = 'id_DESC',
-  isPublished_ASC = 'isPublished_ASC',
-  isPublished_DESC = 'isPublished_DESC',
-  title_ASC = 'title_ASC',
-  title_DESC = 'title_DESC',
-  text_ASC = 'text_ASC',
-  text_DESC = 'text_DESC',
+    id_ASC = "id_ASC",
+    id_DESC = "id_DESC",
+    isPublished_ASC = "isPublished_ASC",
+    isPublished_DESC = "isPublished_DESC",
+    title_ASC = "title_ASC",
+    title_DESC = "title_DESC",
+    text_ASC = "text_ASC",
+    text_DESC = "text_DESC"
 }
 
 export class PostCreateInput {
-  id?: string;
-  isPublished?: boolean;
-  title: string;
-  text: string;
+    id?: Nullable<string>;
+    isPublished?: Nullable<boolean>;
+    title: string;
+    text: string;
 }
 
 export class PostSubscriptionWhereInput {
-  AND?: PostSubscriptionWhereInput[];
-  OR?: PostSubscriptionWhereInput[];
-  NOT?: PostSubscriptionWhereInput[];
-  mutation_in?: MutationType[];
-  updatedFields_contains?: string;
-  updatedFields_contains_every?: string[];
-  updatedFields_contains_some?: string[];
-  node?: PostWhereInput;
+    AND?: Nullable<PostSubscriptionWhereInput[]>;
+    OR?: Nullable<PostSubscriptionWhereInput[]>;
+    NOT?: Nullable<PostSubscriptionWhereInput[]>;
+    mutation_in?: Nullable<MutationType[]>;
+    updatedFields_contains?: Nullable<string>;
+    updatedFields_contains_every?: Nullable<string[]>;
+    updatedFields_contains_some?: Nullable<string[]>;
+    node?: Nullable<PostWhereInput>;
 }
 
 export class PostUpdateInput {
-  isPublished?: boolean;
-  title?: string;
-  text?: string;
+    isPublished?: Nullable<boolean>;
+    title?: Nullable<string>;
+    text?: Nullable<string>;
 }
 
 export class PostUpdateManyMutationInput {
-  isPublished?: boolean;
-  title?: string;
-  text?: string;
+    isPublished?: Nullable<boolean>;
+    title?: Nullable<string>;
+    text?: Nullable<string>;
 }
 
 export class PostWhereInput {
-  AND?: PostWhereInput[];
-  OR?: PostWhereInput[];
-  NOT?: PostWhereInput[];
-  id?: string;
-  id_not?: string;
-  id_in?: string[];
-  id_not_in?: string[];
-  id_lt?: string;
-  id_lte?: string;
-  id_gt?: string;
-  id_gte?: string;
-  id_contains?: string;
-  id_not_contains?: string;
-  id_starts_with?: string;
-  id_not_starts_with?: string;
-  id_ends_with?: string;
-  id_not_ends_with?: string;
-  isPublished?: boolean;
-  isPublished_not?: boolean;
-  title?: string;
-  title_not?: string;
-  title_in?: string[];
-  title_not_in?: string[];
-  title_lt?: string;
-  title_lte?: string;
-  title_gt?: string;
-  title_gte?: string;
-  title_contains?: string;
-  title_not_contains?: string;
-  title_starts_with?: string;
-  title_not_starts_with?: string;
-  title_ends_with?: string;
-  title_not_ends_with?: string;
-  text?: string;
-  text_not?: string;
-  text_in?: string[];
-  text_not_in?: string[];
-  text_lt?: string;
-  text_lte?: string;
-  text_gt?: string;
-  text_gte?: string;
-  text_contains?: string;
-  text_not_contains?: string;
-  text_starts_with?: string;
-  text_not_starts_with?: string;
-  text_ends_with?: string;
-  text_not_ends_with?: string;
+    AND?: Nullable<PostWhereInput[]>;
+    OR?: Nullable<PostWhereInput[]>;
+    NOT?: Nullable<PostWhereInput[]>;
+    id?: Nullable<string>;
+    id_not?: Nullable<string>;
+    id_in?: Nullable<string[]>;
+    id_not_in?: Nullable<string[]>;
+    id_lt?: Nullable<string>;
+    id_lte?: Nullable<string>;
+    id_gt?: Nullable<string>;
+    id_gte?: Nullable<string>;
+    id_contains?: Nullable<string>;
+    id_not_contains?: Nullable<string>;
+    id_starts_with?: Nullable<string>;
+    id_not_starts_with?: Nullable<string>;
+    id_ends_with?: Nullable<string>;
+    id_not_ends_with?: Nullable<string>;
+    isPublished?: Nullable<boolean>;
+    isPublished_not?: Nullable<boolean>;
+    title?: Nullable<string>;
+    title_not?: Nullable<string>;
+    title_in?: Nullable<string[]>;
+    title_not_in?: Nullable<string[]>;
+    title_lt?: Nullable<string>;
+    title_lte?: Nullable<string>;
+    title_gt?: Nullable<string>;
+    title_gte?: Nullable<string>;
+    title_contains?: Nullable<string>;
+    title_not_contains?: Nullable<string>;
+    title_starts_with?: Nullable<string>;
+    title_not_starts_with?: Nullable<string>;
+    title_ends_with?: Nullable<string>;
+    title_not_ends_with?: Nullable<string>;
+    text?: Nullable<string>;
+    text_not?: Nullable<string>;
+    text_in?: Nullable<string[]>;
+    text_not_in?: Nullable<string[]>;
+    text_lt?: Nullable<string>;
+    text_lte?: Nullable<string>;
+    text_gt?: Nullable<string>;
+    text_gte?: Nullable<string>;
+    text_contains?: Nullable<string>;
+    text_not_contains?: Nullable<string>;
+    text_starts_with?: Nullable<string>;
+    text_not_starts_with?: Nullable<string>;
+    text_ends_with?: Nullable<string>;
+    text_not_ends_with?: Nullable<string>;
 }
 
 export class PostWhereUniqueInput {
-  id?: string;
+    id?: Nullable<string>;
 }
 
 export interface Node {
-  id: string;
+    id: string;
 }
 
 export class AggregatePost {
-  count: number;
+    count: number;
 }
 
 export class BatchPayload {
-  count: Long;
+    count: Long;
 }
 
 export abstract class IMutation {
-  abstract createPost(data: PostCreateInput): Post | Promise<Post>;
-  abstract updatePost(
-    data: PostUpdateInput,
-    where: PostWhereUniqueInput,
-  ): Post | Promise<Post>;
-  abstract deletePost(where: PostWhereUniqueInput): Post | Promise<Post>;
-  abstract upsertPost(
-    where: PostWhereUniqueInput,
-    create: PostCreateInput,
-    update: PostUpdateInput,
-  ): Post | Promise<Post>;
-  abstract updateManyPosts(
-    data: PostUpdateManyMutationInput,
-    where?: PostWhereInput,
-  ): BatchPayload | Promise<BatchPayload>;
-  abstract deleteManyPosts(
-    where?: PostWhereInput,
-  ): BatchPayload | Promise<BatchPayload>;
+    abstract createPost(data: PostCreateInput): Post | Promise<Post>;
+    abstract updatePost(data: PostUpdateInput, where: PostWhereUniqueInput): Nullable<Post> | Promise<Nullable<Post>>;
+    abstract deletePost(where: PostWhereUniqueInput): Nullable<Post> | Promise<Nullable<Post>>;
+    abstract upsertPost(where: PostWhereUniqueInput, create: PostCreateInput, update: PostUpdateInput): Post | Promise<Post>;
+    abstract updateManyPosts(data: PostUpdateManyMutationInput, where?: Nullable<PostWhereInput>): BatchPayload | Promise<BatchPayload>;
+    abstract deleteManyPosts(where?: Nullable<PostWhereInput>): BatchPayload | Promise<BatchPayload>;
 }
 
 export class PageInfo {
-  hasNextPage: boolean;
-  hasPreviousPage: boolean;
-  startCursor?: string;
-  endCursor?: string;
+    hasNextPage: boolean;
+    hasPreviousPage: boolean;
+    startCursor?: Nullable<string>;
+    endCursor?: Nullable<string>;
 }
 
 export class Post implements Node {
-  id: string;
-  isPublished: boolean;
-  title: string;
-  text: string;
+    id: string;
+    isPublished: boolean;
+    title: string;
+    text: string;
 }
 
 export class PostConnection {
-  pageInfo: PageInfo;
-  edges: PostEdge[];
-  aggregate: AggregatePost;
+    pageInfo: PageInfo;
+    edges: Nullable<PostEdge>[];
+    aggregate: AggregatePost;
 }
 
 export class PostEdge {
-  node: Post;
-  cursor: string;
+    node: Post;
+    cursor: string;
 }
 
 export class PostPreviousValues {
-  id: string;
-  isPublished: boolean;
-  title: string;
-  text: string;
+    id: string;
+    isPublished: boolean;
+    title: string;
+    text: string;
 }
 
 export class PostSubscriptionPayload {
-  mutation: MutationType;
-  node?: Post;
-  updatedFields?: string[];
-  previousValues?: PostPreviousValues;
+    mutation: MutationType;
+    node?: Nullable<Post>;
+    updatedFields?: Nullable<string[]>;
+    previousValues?: Nullable<PostPreviousValues>;
 }
 
 export abstract class IQuery {
-  abstract posts(
-    where?: PostWhereInput,
-    orderBy?: PostOrderByInput,
-    skip?: number,
-    after?: string,
-    before?: string,
-    first?: number,
-    last?: number,
-  ): Post[] | Promise<Post[]>;
-  abstract post(where: PostWhereUniqueInput): Post | Promise<Post>;
-  abstract postsConnection(
-    where?: PostWhereInput,
-    orderBy?: PostOrderByInput,
-    skip?: number,
-    after?: string,
-    before?: string,
-    first?: number,
-    last?: number,
-  ): PostConnection | Promise<PostConnection>;
-  abstract node(id: string): Node | Promise<Node>;
+    abstract posts(where?: Nullable<PostWhereInput>, orderBy?: Nullable<PostOrderByInput>, skip?: Nullable<number>, after?: Nullable<string>, before?: Nullable<string>, first?: Nullable<number>, last?: Nullable<number>): Nullable<Post>[] | Promise<Nullable<Post>[]>;
+    abstract post(where: PostWhereUniqueInput): Nullable<Post> | Promise<Nullable<Post>>;
+    abstract postsConnection(where?: Nullable<PostWhereInput>, orderBy?: Nullable<PostOrderByInput>, skip?: Nullable<number>, after?: Nullable<string>, before?: Nullable<string>, first?: Nullable<number>, last?: Nullable<number>): PostConnection | Promise<PostConnection>;
+    abstract node(id: string): Nullable<Node> | Promise<Nullable<Node>>;
 }
 
 export abstract class ISubscription {
-  abstract post(
-    where?: PostSubscriptionWhereInput,
-  ): PostSubscriptionPayload | Promise<PostSubscriptionPayload>;
+    abstract post(where?: Nullable<PostSubscriptionWhereInput>): Nullable<PostSubscriptionPayload> | Promise<Nullable<PostSubscriptionPayload>>;
 }
 
 export type Long = any;
+type Nullable<T> = T | null;
diff --git a/sample/23-graphql-code-first/package-lock.json b/sample/23-graphql-code-first/package-lock.json
index b7f3db061..a988bfdd9 100644
Binary files a/sample/23-graphql-code-first/package-lock.json and b/sample/23-graphql-code-first/package-lock.json differ
diff --git a/sample/23-graphql-code-first/package.json b/sample/23-graphql-code-first/package.json
index 67ad044d8..9656a8d21 100644
--- a/sample/23-graphql-code-first/package.json
+++ b/sample/23-graphql-code-first/package.json
@@ -19,15 +19,16 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
+    "@nestjs/apollo": "10.0.2",
     "@nestjs/common": "8.2.3",
     "@nestjs/core": "8.2.3",
-    "@nestjs/graphql": "9.1.2",
+    "@nestjs/graphql": "10.0.2",
     "@nestjs/platform-express": "8.2.3",
-    "apollo-server": "3.5.0",
-    "apollo-server-express": "3.5.0",
+    "apollo-server": "3.6.2",
+    "apollo-server-express": "3.6.2",
     "class-transformer": "0.4.0",
     "class-validator": "0.13.2",
-    "graphql": "15.7.2",
+    "graphql": "16.3.0",
     "graphql-query-complexity": "0.11.0",
     "graphql-subscriptions": "2.0.0",
     "reflect-metadata": "0.1.13",
@@ -35,23 +36,23 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
+    "@nestjs/schematics": "8.0.8",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.11",
+    "@types/node": "16.11.26",
     "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
+    "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
     "eslint": "7.32.0",
     "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
+    "eslint-plugin-import": "2.25.4",
     "typescript": "4.4.2"
   }
 }
diff --git a/sample/23-graphql-code-first/schema.gql b/sample/23-graphql-code-first/schema.gql
index 9c1d511de..4df716415 100644
--- a/sample/23-graphql-code-first/schema.gql
+++ b/sample/23-graphql-code-first/schema.gql
@@ -2,13 +2,15 @@
 # THIS FILE WAS AUTOMATICALLY GENERATED (DO NOT MODIFY)
 # ------------------------------------------------------
 
+directive @upper on FIELD_DEFINITION
+
 """recipe """
 type Recipe {
   id: ID!
-  title: String!
   description: String
   creationDate: Date!
   ingredients: [String!]!
+  title: String!
 }
 
 """Date custom scalar type"""
@@ -32,4 +34,4 @@ input NewRecipeInput {
 
 type Subscription {
   recipeAdded: Recipe!
-}
+}
\ No newline at end of file
diff --git a/sample/23-graphql-code-first/src/app.module.ts b/sample/23-graphql-code-first/src/app.module.ts
index c418f9f79..2b32aa272 100644
--- a/sample/23-graphql-code-first/src/app.module.ts
+++ b/sample/23-graphql-code-first/src/app.module.ts
@@ -1,13 +1,26 @@
+import { ApolloDriver, ApolloDriverConfig } from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
 import { GraphQLModule } from '@nestjs/graphql';
+import { DirectiveLocation, GraphQLDirective } from 'graphql';
+import { upperDirectiveTransformer } from './common/directives/upper-case.directive';
 import { RecipesModule } from './recipes/recipes.module';
 
 @Module({
   imports: [
     RecipesModule,
-    GraphQLModule.forRoot({
-      installSubscriptionHandlers: true,
+    GraphQLModule.forRoot<ApolloDriverConfig>({
+      driver: ApolloDriver,
       autoSchemaFile: 'schema.gql',
+      transformSchema: schema => upperDirectiveTransformer(schema, 'upper'),
+      installSubscriptionHandlers: true,
+      buildSchemaOptions: {
+        directives: [
+          new GraphQLDirective({
+            name: 'upper',
+            locations: [DirectiveLocation.FIELD_DEFINITION],
+          }),
+        ],
+      },
     }),
   ],
 })
diff --git a/sample/23-graphql-code-first/src/common/directives/upper-case.directive.ts b/sample/23-graphql-code-first/src/common/directives/upper-case.directive.ts
index 49341fe8e..52cabe0ef 100644
--- a/sample/23-graphql-code-first/src/common/directives/upper-case.directive.ts
+++ b/sample/23-graphql-code-first/src/common/directives/upper-case.directive.ts
@@ -1,15 +1,32 @@
-import { SchemaDirectiveVisitor } from '@graphql-tools/utils';
-import { defaultFieldResolver, GraphQLField } from 'graphql';
+import { getDirective, MapperKind, mapSchema } from '@graphql-tools/utils';
+import { defaultFieldResolver, GraphQLSchema } from 'graphql';
 
-export class UpperCaseDirective extends SchemaDirectiveVisitor {
-  visitFieldDefinition(field: GraphQLField<any, any>) {
-    const { resolve = defaultFieldResolver } = field;
-    field.resolve = async function (...args) {
-      const result = await resolve.apply(this, args);
-      if (typeof result === 'string') {
-        return result.toUpperCase();
+export function upperDirectiveTransformer(
+  schema: GraphQLSchema,
+  directiveName: string,
+) {
+  return mapSchema(schema, {
+    [MapperKind.OBJECT_FIELD]: fieldConfig => {
+      const upperDirective = getDirective(
+        schema,
+        fieldConfig,
+        directiveName,
+      )?.[0];
+
+      if (upperDirective) {
+        const { resolve = defaultFieldResolver } = fieldConfig;
+
+        // Replace the original resolver with a function that *first* calls
+        // the original resolver, then converts its result to upper case
+        fieldConfig.resolve = async function (source, args, context, info) {
+          const result = await resolve(source, args, context, info);
+          if (typeof result === 'string') {
+            return result.toUpperCase();
+          }
+          return result;
+        };
+        return fieldConfig;
       }
-      return result;
-    };
-  }
+    },
+  });
 }
diff --git a/sample/23-graphql-code-first/src/common/plugins/complexity.plugin.ts b/sample/23-graphql-code-first/src/common/plugins/complexity.plugin.ts
index 86883940e..b58cafeb2 100644
--- a/sample/23-graphql-code-first/src/common/plugins/complexity.plugin.ts
+++ b/sample/23-graphql-code-first/src/common/plugins/complexity.plugin.ts
@@ -1,4 +1,5 @@
-import { GraphQLSchemaHost, Plugin } from '@nestjs/graphql';
+import { Plugin } from '@nestjs/apollo';
+import { GraphQLSchemaHost } from '@nestjs/graphql';
 import {
   ApolloServerPlugin,
   GraphQLRequestListener,
diff --git a/sample/23-graphql-code-first/src/common/plugins/logging.plugin.ts b/sample/23-graphql-code-first/src/common/plugins/logging.plugin.ts
index 8e48e29cb..449d257f4 100644
--- a/sample/23-graphql-code-first/src/common/plugins/logging.plugin.ts
+++ b/sample/23-graphql-code-first/src/common/plugins/logging.plugin.ts
@@ -1,4 +1,4 @@
-import { Plugin } from '@nestjs/graphql';
+import { Plugin } from '@nestjs/apollo';
 import {
   ApolloServerPlugin,
   GraphQLRequestListener,
diff --git a/sample/23-graphql-code-first/src/recipes/models/recipe.model.ts b/sample/23-graphql-code-first/src/recipes/models/recipe.model.ts
index 2193b2310..ef0a772bc 100644
--- a/sample/23-graphql-code-first/src/recipes/models/recipe.model.ts
+++ b/sample/23-graphql-code-first/src/recipes/models/recipe.model.ts
@@ -1,11 +1,11 @@
-import { Field, ID, ObjectType } from '@nestjs/graphql';
+import { Directive, Field, ID, ObjectType } from '@nestjs/graphql';
 
 @ObjectType({ description: 'recipe ' })
 export class Recipe {
   @Field(type => ID)
   id: string;
 
-  @Field()
+  @Directive('@upper')
   title: string;
 
   @Field({ nullable: true })
diff --git a/sample/24-serve-static/package-lock.json b/sample/24-serve-static/package-lock.json
index 9ef89ff97..79bbbed4e 100644
Binary files a/sample/24-serve-static/package-lock.json and b/sample/24-serve-static/package-lock.json differ
diff --git a/sample/24-serve-static/package.json b/sample/24-serve-static/package.json
index d378c5e6a..b91fa8539 100644
--- a/sample/24-serve-static/package.json
+++ b/sample/24-serve-static/package.json
@@ -31,23 +31,23 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
+    "@nestjs/schematics": "8.0.8",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.11",
+    "@types/node": "16.11.26",
     "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
+    "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
     "eslint": "7.32.0",
     "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
+    "eslint-plugin-import": "2.25.4",
     "typescript": "4.3.5"
   }
 }
diff --git a/sample/25-dynamic-modules/package-lock.json b/sample/25-dynamic-modules/package-lock.json
index 75c2d08b0..3eaeea0b9 100644
Binary files a/sample/25-dynamic-modules/package-lock.json and b/sample/25-dynamic-modules/package-lock.json differ
diff --git a/sample/25-dynamic-modules/package.json b/sample/25-dynamic-modules/package.json
index 44da6a99a..0ac6b93e7 100644
--- a/sample/25-dynamic-modules/package.json
+++ b/sample/25-dynamic-modules/package.json
@@ -30,24 +30,24 @@
   "devDependencies": {
     "@types/dotenv": "8.2.0",
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
+    "@nestjs/schematics": "8.0.8",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.11",
+    "@types/jest": "27.4.1",
+    "@types/node": "16.11.26",
     "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
+    "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
     "eslint": "7.32.0",
     "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
+    "eslint-plugin-import": "2.25.4",
     "typescript": "4.3.5"
   },
   "jest": {
diff --git a/sample/26-queues/package-lock.json b/sample/26-queues/package-lock.json
index 8d2b2b331..74ffc81f2 100644
Binary files a/sample/26-queues/package-lock.json and b/sample/26-queues/package-lock.json differ
diff --git a/sample/26-queues/package.json b/sample/26-queues/package.json
index 79140a4cb..ba61b32f1 100644
--- a/sample/26-queues/package.json
+++ b/sample/26-queues/package.json
@@ -31,26 +31,26 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
+    "@nestjs/schematics": "8.0.8",
     "@nestjs/testing": "8.2.3",
-    "@types/bull": "3.15.6",
+    "@types/bull": "3.15.8",
     "@types/dotenv": "8.2.0",
     "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.11",
+    "@types/jest": "27.4.1",
+    "@types/node": "16.11.26",
     "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
+    "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
     "eslint": "7.32.0",
     "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
+    "eslint-plugin-import": "2.25.4",
     "typescript": "4.3.5"
   },
   "jest": {
diff --git a/sample/27-scheduling/package-lock.json b/sample/27-scheduling/package-lock.json
index 56a2f2f76..86d3f8746 100644
Binary files a/sample/27-scheduling/package-lock.json and b/sample/27-scheduling/package-lock.json differ
diff --git a/sample/27-scheduling/package.json b/sample/27-scheduling/package.json
index 1a5e53a31..4bc054eab 100644
--- a/sample/27-scheduling/package.json
+++ b/sample/27-scheduling/package.json
@@ -30,26 +30,26 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
+    "@nestjs/schematics": "8.0.8",
     "@nestjs/testing": "8.2.3",
-    "@types/bull": "3.15.6",
+    "@types/bull": "3.15.8",
     "@types/dotenv": "8.2.0",
     "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.11",
+    "@types/jest": "27.4.1",
+    "@types/node": "16.11.26",
     "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
+    "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
     "eslint": "7.32.0",
     "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
+    "eslint-plugin-import": "2.25.4",
     "typescript": "4.3.5"
   },
   "jest": {
diff --git a/sample/28-sse/package-lock.json b/sample/28-sse/package-lock.json
index 9a5f76081..dfe3c6c91 100644
Binary files a/sample/28-sse/package-lock.json and b/sample/28-sse/package-lock.json differ
diff --git a/sample/28-sse/package.json b/sample/28-sse/package.json
index 83da3973c..3ab54338c 100644
--- a/sample/28-sse/package.json
+++ b/sample/28-sse/package.json
@@ -28,25 +28,25 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
+    "@nestjs/schematics": "8.0.8",
     "@nestjs/testing": "8.2.3",
     "@types/dotenv": "8.2.0",
     "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.11",
+    "@types/jest": "27.4.1",
+    "@types/node": "16.11.26",
     "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
+    "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
     "eslint": "7.32.0",
     "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
+    "eslint-plugin-import": "2.25.4",
     "typescript": "4.3.5"
   },
   "jest": {
diff --git a/sample/29-file-upload/e2e/app/app.e2e-spec.ts b/sample/29-file-upload/e2e/app/app.e2e-spec.ts
index 826b5ba8d..4107251ff 100644
--- a/sample/29-file-upload/e2e/app/app.e2e-spec.ts
+++ b/sample/29-file-upload/e2e/app/app.e2e-spec.ts
@@ -1,7 +1,6 @@
 import { INestApplication } from '@nestjs/common';
 import { Test } from '@nestjs/testing';
 import { readFileSync } from 'fs';
-import { join } from 'path';
 import * as request from 'supertest';
 import { AppModule } from '../../src/app.module';
 
@@ -30,6 +29,28 @@ describe('E2E FileTest', () => {
       });
   });
 
+  it('should allow for file uploads that pass validation', async () => {
+    return request(app.getHttpServer())
+      .post('/file/pass-validation')
+      .attach('file', './package.json')
+      .field('name', 'test')
+      .expect(201)
+      .expect({
+        body: {
+          name: 'test',
+        },
+        file: readFileSync('./package.json').toString(),
+      });
+  });
+
+  it('should throw for file uploads that do not pass validation', async () => {
+    return request(app.getHttpServer())
+      .post('/file/fail-validation')
+      .attach('file', './package.json')
+      .field('name', 'test')
+      .expect(400);
+  });
+
   afterAll(async () => {
     await app.close();
   });
diff --git a/sample/29-file-upload/package-lock.json b/sample/29-file-upload/package-lock.json
index 916675b82..2f075e23a 100644
Binary files a/sample/29-file-upload/package-lock.json and b/sample/29-file-upload/package-lock.json differ
diff --git a/sample/29-file-upload/package.json b/sample/29-file-upload/package.json
index 89655dfa4..df8e1d605 100644
--- a/sample/29-file-upload/package.json
+++ b/sample/29-file-upload/package.json
@@ -30,25 +30,25 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
+    "@nestjs/schematics": "8.0.8",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
+    "@types/jest": "27.4.1",
     "@types/multer": "1.4.7",
-    "@types/node": "16.11.11",
+    "@types/node": "16.11.26",
     "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
+    "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
     "eslint": "7.32.0",
     "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
+    "eslint-plugin-import": "2.25.4",
     "typescript": "4.3.5"
   },
   "jest": {
diff --git a/sample/29-file-upload/src/app.controller.ts b/sample/29-file-upload/src/app.controller.ts
index dc59cd260..39d3af1fb 100644
--- a/sample/29-file-upload/src/app.controller.ts
+++ b/sample/29-file-upload/src/app.controller.ts
@@ -2,6 +2,7 @@ import {
   Body,
   Controller,
   Get,
+  ParseFilePipeBuilder,
   Post,
   UploadedFile,
   UseInterceptors,
@@ -31,4 +32,42 @@ export class AppController {
       file: file.buffer.toString(),
     };
   }
+
+  @UseInterceptors(FileInterceptor('file'))
+  @Post('file/pass-validation')
+  uploadFileAndPassValidation(
+    @Body() body: SampleDto,
+    @UploadedFile(
+      new ParseFilePipeBuilder()
+        .addFileTypeValidator({
+          fileType: 'json',
+        })
+        .build(),
+    )
+    file: Express.Multer.File,
+  ) {
+    return {
+      body,
+      file: file.buffer.toString(),
+    };
+  }
+
+  @UseInterceptors(FileInterceptor('file'))
+  @Post('file/fail-validation')
+  uploadFileAndFailValidation(
+    @Body() body: SampleDto,
+    @UploadedFile(
+      new ParseFilePipeBuilder()
+        .addFileTypeValidator({
+          fileType: 'jpg',
+        })
+        .build(),
+    )
+    file: Express.Multer.File,
+  ) {
+    return {
+      body,
+      file: file.buffer.toString(),
+    };
+  }
 }
diff --git a/sample/30-event-emitter/package-lock.json b/sample/30-event-emitter/package-lock.json
index 0321d6fa9..e93ae381c 100644
Binary files a/sample/30-event-emitter/package-lock.json and b/sample/30-event-emitter/package-lock.json differ
diff --git a/sample/30-event-emitter/package.json b/sample/30-event-emitter/package.json
index 16410a118..548e648b9 100644
--- a/sample/30-event-emitter/package.json
+++ b/sample/30-event-emitter/package.json
@@ -29,22 +29,22 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
+    "@nestjs/schematics": "8.0.8",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.11",
+    "@types/jest": "27.4.1",
+    "@types/node": "16.11.26",
     "@types/supertest": "2.0.11",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
     "eslint": "7.32.0",
     "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "jest": "27.3.1",
+    "eslint-plugin-import": "2.25.4",
+    "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "typescript": "4.3.5"
diff --git a/sample/30-event-emitter/test/app.e2e-spec.ts b/sample/30-event-emitter/test/app.e2e-spec.ts
index 50cda6233..1fac95f6b 100644
--- a/sample/30-event-emitter/test/app.e2e-spec.ts
+++ b/sample/30-event-emitter/test/app.e2e-spec.ts
@@ -21,4 +21,6 @@ describe('AppController (e2e)', () => {
       .expect(200)
       .expect('Hello World!');
   });
+  
+  afterEach(() => app.close());
 });
diff --git a/sample/31-graphql-federation-code-first/gateway/package-lock.json b/sample/31-graphql-federation-code-first/gateway/package-lock.json
index e8c9eaee0..04cb1eb31 100644
Binary files a/sample/31-graphql-federation-code-first/gateway/package-lock.json and b/sample/31-graphql-federation-code-first/gateway/package-lock.json differ
diff --git a/sample/31-graphql-federation-code-first/gateway/package.json b/sample/31-graphql-federation-code-first/gateway/package.json
index 631b13bf5..da6d62a0e 100644
--- a/sample/31-graphql-federation-code-first/gateway/package.json
+++ b/sample/31-graphql-federation-code-first/gateway/package.json
@@ -21,14 +21,15 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@apollo/gateway": "0.44.1",
+    "@apollo/gateway": "0.46.0",
+    "@nestjs/apollo": "9.2.4",
     "@nestjs/common": "8.2.3",
     "@nestjs/core": "8.2.3",
-    "@nestjs/graphql": "9.1.2",
+    "@nestjs/graphql": "10.0.0",
     "@nestjs/platform-express": "8.2.3",
-    "apollo-server-express": "3.5.0",
+    "apollo-server-express": "3.6.2",
     "graphql": "15.7.2",
-    "graphql-tools": "7.0.5",
+    "graphql-tools": "8.0.0",
     "reflect-metadata": "0.1.13",
     "rimraf": "3.0.2",
     "rxjs": "7.4.0",
@@ -36,22 +37,22 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
+    "@nestjs/schematics": "8.0.8",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.11",
+    "@types/jest": "27.4.1",
+    "@types/node": "16.11.26",
     "@types/supertest": "2.0.11",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
     "eslint": "7.32.0",
     "eslint-config-prettier": "8.3.0",
     "eslint-plugin-prettier": "4.0.0",
-    "jest": "27.3.1",
+    "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "typescript": "4.3.5"
diff --git a/sample/31-graphql-federation-code-first/gateway/src/app.module.ts b/sample/31-graphql-federation-code-first/gateway/src/app.module.ts
index c07abd63e..8c6c39d1e 100644
--- a/sample/31-graphql-federation-code-first/gateway/src/app.module.ts
+++ b/sample/31-graphql-federation-code-first/gateway/src/app.module.ts
@@ -1,19 +1,21 @@
+import { IntrospectAndCompose } from '@apollo/gateway';
+import { ApolloGatewayDriver, ApolloGatewayDriverConfig } from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
+import { GraphQLModule } from '@nestjs/graphql';
 import { AppController } from './app.controller';
 import { AppService } from './app.service';
-import { GraphQLGatewayModule } from '@nestjs/graphql';
 
 @Module({
   imports: [
-    GraphQLGatewayModule.forRoot({
-      server: {
-        cors: true,
-      },
+    GraphQLModule.forRoot<ApolloGatewayDriverConfig>({
+      driver: ApolloGatewayDriver,
       gateway: {
-        serviceList: [
-          { name: 'users', url: 'http://localhost:3000/graphql' },
-          { name: 'posts', url: 'http://localhost:3001/graphql' },
-        ],
+        supergraphSdl: new IntrospectAndCompose({
+          subgraphs: [
+            { name: 'users', url: 'http://localhost:3000/graphql' },
+            { name: 'posts', url: 'http://localhost:3001/graphql' },
+          ],
+        }),
       },
     }),
   ],
diff --git a/sample/31-graphql-federation-code-first/posts-application/package-lock.json b/sample/31-graphql-federation-code-first/posts-application/package-lock.json
index ba5229e32..025537d4d 100644
Binary files a/sample/31-graphql-federation-code-first/posts-application/package-lock.json and b/sample/31-graphql-federation-code-first/posts-application/package-lock.json differ
diff --git a/sample/31-graphql-federation-code-first/posts-application/package.json b/sample/31-graphql-federation-code-first/posts-application/package.json
index ae3fb1417..5ef3c4f38 100644
--- a/sample/31-graphql-federation-code-first/posts-application/package.json
+++ b/sample/31-graphql-federation-code-first/posts-application/package.json
@@ -21,16 +21,17 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@apollo/federation": "0.33.8",
-    "@apollo/gateway": "0.44.1",
+    "@apollo/federation": "0.33.9",
+    "@apollo/gateway": "0.46.0",
     "@apollo/subgraph": "0.1.5",
+    "@nestjs/apollo": "9.2.5",
     "@nestjs/common": "8.2.3",
     "@nestjs/core": "8.2.3",
-    "@nestjs/graphql": "9.1.2",
+    "@nestjs/graphql": "10.0.0",
     "@nestjs/platform-express": "8.2.3",
-    "apollo-server-express": "3.5.0",
+    "apollo-server-express": "3.6.2",
     "graphql": "15.7.2",
-    "graphql-tools": "7.0.5",
+    "graphql-tools": "8.0.0",
     "reflect-metadata": "0.1.13",
     "rimraf": "3.0.2",
     "rxjs": "7.4.0",
@@ -38,22 +39,22 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
+    "@nestjs/schematics": "8.0.8",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.11",
+    "@types/jest": "27.4.1",
+    "@types/node": "16.11.26",
     "@types/supertest": "2.0.11",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
     "eslint": "7.32.0",
     "eslint-config-prettier": "8.3.0",
     "eslint-plugin-prettier": "4.0.0",
-    "jest": "27.3.1",
+    "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "typescript": "4.3.5"
diff --git a/sample/31-graphql-federation-code-first/posts-application/src/posts/posts.module.ts b/sample/31-graphql-federation-code-first/posts-application/src/posts/posts.module.ts
index 4ebf3c92f..e2cf306d9 100644
--- a/sample/31-graphql-federation-code-first/posts-application/src/posts/posts.module.ts
+++ b/sample/31-graphql-federation-code-first/posts-application/src/posts/posts.module.ts
@@ -1,5 +1,9 @@
+import {
+  ApolloFederationDriver,
+  ApolloFederationDriverConfig,
+} from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
-import { GraphQLFederationModule } from '@nestjs/graphql';
+import { GraphQLModule } from '@nestjs/graphql';
 import { User } from './models/user.model';
 import { PostsResolver } from './posts.resolver';
 import { PostsService } from './posts.service';
@@ -7,7 +11,8 @@ import { UsersResolver } from './users.resolver';
 
 @Module({
   imports: [
-    GraphQLFederationModule.forRoot({
+    GraphQLModule.forRoot<ApolloFederationDriverConfig>({
+      driver: ApolloFederationDriver,
       autoSchemaFile: true,
       buildSchemaOptions: {
         orphanedTypes: [User],
diff --git a/sample/31-graphql-federation-code-first/posts-application/src/posts/posts.resolver.ts b/sample/31-graphql-federation-code-first/posts-application/src/posts/posts.resolver.ts
index 891f1398a..c66f8dc38 100644
--- a/sample/31-graphql-federation-code-first/posts-application/src/posts/posts.resolver.ts
+++ b/sample/31-graphql-federation-code-first/posts-application/src/posts/posts.resolver.ts
@@ -9,13 +9,14 @@ import {
 import { Post } from './models/post.model';
 import { User } from './models/user.model';
 import { PostsService } from './posts.service';
+import { ParseIntPipe } from '@nestjs/common';
 
 @Resolver((of) => Post)
 export class PostsResolver {
   constructor(private readonly postsService: PostsService) {}
 
   @Query((returns) => Post)
-  post(@Args({ name: 'id', type: () => ID }) id: number): Post {
+  post(@Args({ name: 'id', type: () => ID }, ParseIntPipe) id: number): Post {
     return this.postsService.findOne(id);
   }
 
diff --git a/sample/31-graphql-federation-code-first/users-application/package-lock.json b/sample/31-graphql-federation-code-first/users-application/package-lock.json
index b74dc5e65..41c680a0e 100644
Binary files a/sample/31-graphql-federation-code-first/users-application/package-lock.json and b/sample/31-graphql-federation-code-first/users-application/package-lock.json differ
diff --git a/sample/31-graphql-federation-code-first/users-application/package.json b/sample/31-graphql-federation-code-first/users-application/package.json
index 7a04802de..ede2439a5 100644
--- a/sample/31-graphql-federation-code-first/users-application/package.json
+++ b/sample/31-graphql-federation-code-first/users-application/package.json
@@ -20,16 +20,17 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@apollo/federation": "0.33.8",
-    "@apollo/gateway": "0.44.1",
+    "@apollo/federation": "0.33.9",
+    "@apollo/gateway": "0.46.0",
     "@apollo/subgraph": "0.1.5",
+    "@nestjs/apollo": "9.2.5",
     "@nestjs/common": "8.2.3",
     "@nestjs/core": "8.2.3",
-    "@nestjs/graphql": "9.1.2",
+    "@nestjs/graphql": "10.0.0",
     "@nestjs/platform-express": "8.2.3",
-    "apollo-server-express": "3.5.0",
+    "apollo-server-express": "3.6.2",
     "graphql": "15.7.2",
-    "graphql-tools": "7.0.5",
+    "graphql-tools": "8.0.0",
     "reflect-metadata": "0.1.13",
     "rimraf": "3.0.2",
     "rxjs": "7.4.0",
@@ -37,22 +38,22 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
+    "@nestjs/schematics": "8.0.8",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.11",
+    "@types/jest": "27.4.1",
+    "@types/node": "16.11.26",
     "@types/supertest": "2.0.11",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
     "eslint": "7.32.0",
     "eslint-config-prettier": "8.3.0",
     "eslint-plugin-prettier": "4.0.0",
-    "jest": "27.3.1",
+    "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "typescript": "4.3.5"
diff --git a/sample/31-graphql-federation-code-first/users-application/src/users/users.module.ts b/sample/31-graphql-federation-code-first/users-application/src/users/users.module.ts
index f70c88091..fea78661e 100644
--- a/sample/31-graphql-federation-code-first/users-application/src/users/users.module.ts
+++ b/sample/31-graphql-federation-code-first/users-application/src/users/users.module.ts
@@ -1,12 +1,17 @@
+import {
+  ApolloFederationDriver,
+  ApolloFederationDriverConfig,
+} from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
-import { GraphQLFederationModule } from '@nestjs/graphql';
+import { GraphQLModule } from '@nestjs/graphql';
 import { UsersResolver } from './users.resolver';
 import { UsersService } from './users.service';
 
 @Module({
   providers: [UsersResolver, UsersService],
   imports: [
-    GraphQLFederationModule.forRoot({
+    GraphQLModule.forRoot<ApolloFederationDriverConfig>({
+      driver: ApolloFederationDriver,
       autoSchemaFile: true,
     }),
   ],
diff --git a/sample/32-graphql-federation-schema-first/gateway/package-lock.json b/sample/32-graphql-federation-schema-first/gateway/package-lock.json
index e8c9eaee0..cb349e3d8 100644
Binary files a/sample/32-graphql-federation-schema-first/gateway/package-lock.json and b/sample/32-graphql-federation-schema-first/gateway/package-lock.json differ
diff --git a/sample/32-graphql-federation-schema-first/gateway/package.json b/sample/32-graphql-federation-schema-first/gateway/package.json
index 631b13bf5..c24fea6c6 100644
--- a/sample/32-graphql-federation-schema-first/gateway/package.json
+++ b/sample/32-graphql-federation-schema-first/gateway/package.json
@@ -21,14 +21,15 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@apollo/gateway": "0.44.1",
+    "@apollo/gateway": "0.46.0",
+    "@nestjs/apollo": "9.2.6",
     "@nestjs/common": "8.2.3",
     "@nestjs/core": "8.2.3",
-    "@nestjs/graphql": "9.1.2",
+    "@nestjs/graphql": "10.0.0",
     "@nestjs/platform-express": "8.2.3",
-    "apollo-server-express": "3.5.0",
+    "apollo-server-express": "3.6.2",
     "graphql": "15.7.2",
-    "graphql-tools": "7.0.5",
+    "graphql-tools": "8.0.0",
     "reflect-metadata": "0.1.13",
     "rimraf": "3.0.2",
     "rxjs": "7.4.0",
@@ -36,22 +37,22 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
+    "@nestjs/schematics": "8.0.8",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.11",
+    "@types/jest": "27.4.1",
+    "@types/node": "16.11.26",
     "@types/supertest": "2.0.11",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
     "eslint": "7.32.0",
     "eslint-config-prettier": "8.3.0",
     "eslint-plugin-prettier": "4.0.0",
-    "jest": "27.3.1",
+    "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "typescript": "4.3.5"
diff --git a/sample/32-graphql-federation-schema-first/gateway/src/app.module.ts b/sample/32-graphql-federation-schema-first/gateway/src/app.module.ts
index c07abd63e..8c6c39d1e 100644
--- a/sample/32-graphql-federation-schema-first/gateway/src/app.module.ts
+++ b/sample/32-graphql-federation-schema-first/gateway/src/app.module.ts
@@ -1,19 +1,21 @@
+import { IntrospectAndCompose } from '@apollo/gateway';
+import { ApolloGatewayDriver, ApolloGatewayDriverConfig } from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
+import { GraphQLModule } from '@nestjs/graphql';
 import { AppController } from './app.controller';
 import { AppService } from './app.service';
-import { GraphQLGatewayModule } from '@nestjs/graphql';
 
 @Module({
   imports: [
-    GraphQLGatewayModule.forRoot({
-      server: {
-        cors: true,
-      },
+    GraphQLModule.forRoot<ApolloGatewayDriverConfig>({
+      driver: ApolloGatewayDriver,
       gateway: {
-        serviceList: [
-          { name: 'users', url: 'http://localhost:3000/graphql' },
-          { name: 'posts', url: 'http://localhost:3001/graphql' },
-        ],
+        supergraphSdl: new IntrospectAndCompose({
+          subgraphs: [
+            { name: 'users', url: 'http://localhost:3000/graphql' },
+            { name: 'posts', url: 'http://localhost:3001/graphql' },
+          ],
+        }),
       },
     }),
   ],
diff --git a/sample/32-graphql-federation-schema-first/posts-application/package-lock.json b/sample/32-graphql-federation-schema-first/posts-application/package-lock.json
index ba5229e32..b07ac6e28 100644
Binary files a/sample/32-graphql-federation-schema-first/posts-application/package-lock.json and b/sample/32-graphql-federation-schema-first/posts-application/package-lock.json differ
diff --git a/sample/32-graphql-federation-schema-first/posts-application/package.json b/sample/32-graphql-federation-schema-first/posts-application/package.json
index ae3fb1417..445e1d1ec 100644
--- a/sample/32-graphql-federation-schema-first/posts-application/package.json
+++ b/sample/32-graphql-federation-schema-first/posts-application/package.json
@@ -21,16 +21,17 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@apollo/federation": "0.33.8",
-    "@apollo/gateway": "0.44.1",
+    "@apollo/federation": "0.33.9",
+    "@apollo/gateway": "0.46.0",
     "@apollo/subgraph": "0.1.5",
+    "@nestjs/apollo": "9.2.6",
     "@nestjs/common": "8.2.3",
     "@nestjs/core": "8.2.3",
-    "@nestjs/graphql": "9.1.2",
+    "@nestjs/graphql": "10.0.0",
     "@nestjs/platform-express": "8.2.3",
-    "apollo-server-express": "3.5.0",
+    "apollo-server-express": "3.6.2",
     "graphql": "15.7.2",
-    "graphql-tools": "7.0.5",
+    "graphql-tools": "8.0.0",
     "reflect-metadata": "0.1.13",
     "rimraf": "3.0.2",
     "rxjs": "7.4.0",
@@ -38,22 +39,22 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
+    "@nestjs/schematics": "8.0.8",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.11",
+    "@types/jest": "27.4.1",
+    "@types/node": "16.11.26",
     "@types/supertest": "2.0.11",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
     "eslint": "7.32.0",
     "eslint-config-prettier": "8.3.0",
     "eslint-plugin-prettier": "4.0.0",
-    "jest": "27.3.1",
+    "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "typescript": "4.3.5"
diff --git a/sample/32-graphql-federation-schema-first/posts-application/src/posts/posts.module.ts b/sample/32-graphql-federation-schema-first/posts-application/src/posts/posts.module.ts
index 8c34378d7..2254d715d 100644
--- a/sample/32-graphql-federation-schema-first/posts-application/src/posts/posts.module.ts
+++ b/sample/32-graphql-federation-schema-first/posts-application/src/posts/posts.module.ts
@@ -1,12 +1,17 @@
+import {
+  ApolloFederationDriver,
+  ApolloFederationDriverConfig,
+} from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
-import { GraphQLFederationModule } from '@nestjs/graphql';
+import { GraphQLModule } from '@nestjs/graphql';
 import { PostsResolver } from './posts.resolver';
 import { PostsService } from './posts.service';
 import { UsersResolver } from './users.resolver';
 
 @Module({
   imports: [
-    GraphQLFederationModule.forRoot({
+    GraphQLModule.forRoot<ApolloFederationDriverConfig>({
+      driver: ApolloFederationDriver,
       typePaths: ['**/*.graphql'],
     }),
   ],
diff --git a/sample/32-graphql-federation-schema-first/users-application/package-lock.json b/sample/32-graphql-federation-schema-first/users-application/package-lock.json
index b74dc5e65..ac482ea88 100644
Binary files a/sample/32-graphql-federation-schema-first/users-application/package-lock.json and b/sample/32-graphql-federation-schema-first/users-application/package-lock.json differ
diff --git a/sample/32-graphql-federation-schema-first/users-application/package.json b/sample/32-graphql-federation-schema-first/users-application/package.json
index 7a04802de..c5358a6a3 100644
--- a/sample/32-graphql-federation-schema-first/users-application/package.json
+++ b/sample/32-graphql-federation-schema-first/users-application/package.json
@@ -20,16 +20,17 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@apollo/federation": "0.33.8",
-    "@apollo/gateway": "0.44.1",
+    "@apollo/federation": "0.33.9",
+    "@apollo/gateway": "0.46.0",
     "@apollo/subgraph": "0.1.5",
+    "@nestjs/apollo": "9.2.6",
     "@nestjs/common": "8.2.3",
     "@nestjs/core": "8.2.3",
-    "@nestjs/graphql": "9.1.2",
+    "@nestjs/graphql": "10.0.0",
     "@nestjs/platform-express": "8.2.3",
-    "apollo-server-express": "3.5.0",
+    "apollo-server-express": "3.6.2",
     "graphql": "15.7.2",
-    "graphql-tools": "7.0.5",
+    "graphql-tools": "8.0.0",
     "reflect-metadata": "0.1.13",
     "rimraf": "3.0.2",
     "rxjs": "7.4.0",
@@ -37,22 +38,22 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
+    "@nestjs/schematics": "8.0.8",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.11",
+    "@types/jest": "27.4.1",
+    "@types/node": "16.11.26",
     "@types/supertest": "2.0.11",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
     "eslint": "7.32.0",
     "eslint-config-prettier": "8.3.0",
     "eslint-plugin-prettier": "4.0.0",
-    "jest": "27.3.1",
+    "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
+    "ts-loader": "9.2.8",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "typescript": "4.3.5"
diff --git a/sample/32-graphql-federation-schema-first/users-application/src/users/users.module.ts b/sample/32-graphql-federation-schema-first/users-application/src/users/users.module.ts
index e4a70b139..d98abacac 100644
--- a/sample/32-graphql-federation-schema-first/users-application/src/users/users.module.ts
+++ b/sample/32-graphql-federation-schema-first/users-application/src/users/users.module.ts
@@ -1,12 +1,17 @@
+import {
+  ApolloFederationDriver,
+  ApolloFederationDriverConfig,
+} from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
-import { GraphQLFederationModule } from '@nestjs/graphql';
+import { GraphQLModule } from '@nestjs/graphql';
 import { UsersResolver } from './users.resolver';
 import { UsersService } from './users.service';
 
 @Module({
   providers: [UsersResolver, UsersService],
   imports: [
-    GraphQLFederationModule.forRoot({
+    GraphQLModule.forRoot<ApolloFederationDriverConfig>({
+      driver: ApolloFederationDriver,
       typePaths: ['**/*.graphql'],
     }),
   ],
diff --git a/sample/33-graphql-mercurius/.eslintrc.js b/sample/33-graphql-mercurius/.eslintrc.js
new file mode 100644
index 000000000..284719548
--- /dev/null
+++ b/sample/33-graphql-mercurius/.eslintrc.js
@@ -0,0 +1,23 @@
+module.exports = {
+  parser: '@typescript-eslint/parser',
+  parserOptions: {
+    project: 'tsconfig.json',
+    sourceType: 'module',
+  },
+  plugins: ['@typescript-eslint/eslint-plugin'],
+  extends: [
+    'plugin:@typescript-eslint/eslint-recommended',
+    'plugin:@typescript-eslint/recommended',
+    'prettier',
+  ],
+  root: true,
+  env: {
+    node: true,
+    jest: true,
+  },
+  rules: {
+    '@typescript-eslint/interface-name-prefix': 'off',
+    '@typescript-eslint/explicit-function-return-type': 'off',
+    '@typescript-eslint/no-explicit-any': 'off',
+  },
+};
diff --git a/sample/33-graphql-mercurius/.gitignore b/sample/33-graphql-mercurius/.gitignore
new file mode 100644
index 000000000..b5e5f9755
--- /dev/null
+++ b/sample/33-graphql-mercurius/.gitignore
@@ -0,0 +1,21 @@
+# dependencies
+/node_modules
+
+# IDE
+/.idea
+/.awcache
+/.vscode
+
+# misc
+npm-debug.log
+
+# example
+/quick-start
+
+# tests
+/test
+/coverage
+/.nyc_output
+
+# dist
+/dist
\ No newline at end of file
diff --git a/sample/33-graphql-mercurius/nest-cli.json b/sample/33-graphql-mercurius/nest-cli.json
new file mode 100644
index 000000000..095fdb25b
--- /dev/null
+++ b/sample/33-graphql-mercurius/nest-cli.json
@@ -0,0 +1,12 @@
+{
+  "compilerOptions": {
+    "plugins": [
+      {
+        "name": "@nestjs/graphql",
+        "options": {
+          "introspectComments": true
+        }
+      }
+    ]
+  }
+}
diff --git a/sample/33-graphql-mercurius/package-lock.json b/sample/33-graphql-mercurius/package-lock.json
new file mode 100644
index 000000000..7a9866999
Binary files /dev/null and b/sample/33-graphql-mercurius/package-lock.json differ
diff --git a/sample/33-graphql-mercurius/package.json b/sample/33-graphql-mercurius/package.json
new file mode 100644
index 000000000..5ce073daf
--- /dev/null
+++ b/sample/33-graphql-mercurius/package.json
@@ -0,0 +1,55 @@
+{
+  "name": "nest-typescript-starter",
+  "version": "1.0.0",
+  "description": "Nest TypeScript starter repository",
+  "license": "MIT",
+  "scripts": {
+    "prebuild": "rimraf dist",
+    "build": "nest build",
+    "format": "prettier --write \"src/**/*.ts\" \"test/**/*.ts\"",
+    "start": "nest start",
+    "start:dev": "nest start --watch",
+    "start:debug": "nest start --debug --watch",
+    "start:prod": "node dist/main",
+    "lint": "eslint '{src,apps,libs,test}/**/*.ts' --fix",
+    "test": "jest",
+    "test:watch": "jest --watch",
+    "test:cov": "jest --coverage",
+    "test:debug": "node --inspect-brk -r tsconfig-paths/register -r ts-node/register node_modules/.bin/jest --runInBand",
+    "test:e2e": "echo 'No e2e tests implemented yet.'"
+  },
+  "dependencies": {
+    "@nestjs/common": "8.2.3",
+    "@nestjs/core": "8.2.3",
+    "@nestjs/graphql": "10.0.2",
+    "@nestjs/mercurius": "10.0.0",
+    "@nestjs/platform-fastify": "8.2.6",
+    "class-transformer": "0.4.0",
+    "class-validator": "0.13.2",
+    "graphql": "16.3.0",
+    "mercurius": "9.2.0",
+    "reflect-metadata": "0.1.13",
+    "rxjs": "7.4.0"
+  },
+  "devDependencies": {
+    "@nestjs/cli": "8.1.5",
+    "@nestjs/schematics": "8.0.8",
+    "@nestjs/testing": "8.2.3",
+    "@types/express": "4.17.13",
+    "@types/node": "16.11.26",
+    "@types/supertest": "2.0.11",
+    "jest": "27.5.1",
+    "prettier": "2.5.1",
+    "supertest": "6.1.6",
+    "ts-jest": "27.0.7",
+    "ts-loader": "9.2.8",
+    "ts-node": "10.4.0",
+    "tsconfig-paths": "3.11.0",
+    "@typescript-eslint/eslint-plugin": "4.33.0",
+    "@typescript-eslint/parser": "4.33.0",
+    "eslint": "7.32.0",
+    "eslint-config-prettier": "8.3.0",
+    "eslint-plugin-import": "2.25.4",
+    "typescript": "4.4.2"
+  }
+}
diff --git a/sample/33-graphql-mercurius/schema.gql b/sample/33-graphql-mercurius/schema.gql
new file mode 100644
index 000000000..e11c56434
--- /dev/null
+++ b/sample/33-graphql-mercurius/schema.gql
@@ -0,0 +1,35 @@
+# ------------------------------------------------------
+# THIS FILE WAS AUTOMATICALLY GENERATED (DO NOT MODIFY)
+# ------------------------------------------------------
+
+"""recipe """
+type Recipe {
+  id: ID!
+  title: String!
+  description: String
+  creationDate: Date!
+  ingredients: [String!]!
+}
+
+"""Date custom scalar type"""
+scalar Date
+
+type Query {
+  recipe(id: String!): Recipe!
+  recipes(skip: Int = 0, take: Int = 25): [Recipe!]!
+}
+
+type Mutation {
+  addRecipe(newRecipeData: NewRecipeInput!): Recipe!
+  removeRecipe(id: String!): Boolean!
+}
+
+input NewRecipeInput {
+  title: String!
+  description: String
+  ingredients: [String!]!
+}
+
+type Subscription {
+  recipeAdded: Recipe!
+}
\ No newline at end of file
diff --git a/sample/33-graphql-mercurius/src/app.module.ts b/sample/33-graphql-mercurius/src/app.module.ts
new file mode 100644
index 000000000..53cc6458e
--- /dev/null
+++ b/sample/33-graphql-mercurius/src/app.module.ts
@@ -0,0 +1,17 @@
+import { Module } from '@nestjs/common';
+import { GraphQLModule } from '@nestjs/graphql';
+import { MercuriusDriver, MercuriusDriverConfig } from '@nestjs/mercurius';
+import { RecipesModule } from './recipes/recipes.module';
+
+@Module({
+  imports: [
+    RecipesModule,
+    GraphQLModule.forRoot<MercuriusDriverConfig>({
+      driver: MercuriusDriver,
+      autoSchemaFile: 'schema.gql',
+      subscription: true,
+      graphiql: true,
+    }),
+  ],
+})
+export class AppModule {}
diff --git a/sample/33-graphql-mercurius/src/common/scalars/date.scalar.ts b/sample/33-graphql-mercurius/src/common/scalars/date.scalar.ts
new file mode 100644
index 000000000..38290dcc8
--- /dev/null
+++ b/sample/33-graphql-mercurius/src/common/scalars/date.scalar.ts
@@ -0,0 +1,22 @@
+import { CustomScalar, Scalar } from '@nestjs/graphql';
+import { Kind, ValueNode } from 'graphql';
+
+@Scalar('Date', type => Date)
+export class DateScalar implements CustomScalar<number, Date> {
+  description = 'Date custom scalar type';
+
+  parseValue(value: number): Date {
+    return new Date(value); // value from the client
+  }
+
+  serialize(value: Date): number {
+    return value.getTime(); // value sent to the client
+  }
+
+  parseLiteral(ast: ValueNode): Date {
+    if (ast.kind === Kind.INT) {
+      return new Date(ast.value);
+    }
+    return null;
+  }
+}
diff --git a/sample/33-graphql-mercurius/src/main.ts b/sample/33-graphql-mercurius/src/main.ts
new file mode 100644
index 000000000..8e7886667
--- /dev/null
+++ b/sample/33-graphql-mercurius/src/main.ts
@@ -0,0 +1,13 @@
+import { ValidationPipe } from '@nestjs/common';
+import { NestFactory } from '@nestjs/core';
+import { FastifyAdapter } from '@nestjs/platform-fastify';
+import { AppModule } from './app.module';
+
+async function bootstrap() {
+  const app = await NestFactory.create(AppModule, new FastifyAdapter());
+  app.useGlobalPipes(new ValidationPipe());
+
+  await app.listen(3000);
+  console.log(`Application is running on: ${await app.getUrl()}`);
+}
+bootstrap();
diff --git a/sample/33-graphql-mercurius/src/recipes/dto/new-recipe.input.ts b/sample/33-graphql-mercurius/src/recipes/dto/new-recipe.input.ts
new file mode 100644
index 000000000..79645888c
--- /dev/null
+++ b/sample/33-graphql-mercurius/src/recipes/dto/new-recipe.input.ts
@@ -0,0 +1,17 @@
+import { Field, InputType } from '@nestjs/graphql';
+import { IsOptional, Length, MaxLength } from 'class-validator';
+
+@InputType()
+export class NewRecipeInput {
+  @Field()
+  @MaxLength(30)
+  title: string;
+
+  @Field({ nullable: true })
+  @IsOptional()
+  @Length(30, 255)
+  description?: string;
+
+  @Field(type => [String])
+  ingredients: string[];
+}
diff --git a/sample/33-graphql-mercurius/src/recipes/dto/recipes.args.ts b/sample/33-graphql-mercurius/src/recipes/dto/recipes.args.ts
new file mode 100644
index 000000000..9bce0582f
--- /dev/null
+++ b/sample/33-graphql-mercurius/src/recipes/dto/recipes.args.ts
@@ -0,0 +1,14 @@
+import { ArgsType, Field, Int } from '@nestjs/graphql';
+import { Max, Min } from 'class-validator';
+
+@ArgsType()
+export class RecipesArgs {
+  @Field(type => Int)
+  @Min(0)
+  skip = 0;
+
+  @Field(type => Int)
+  @Min(1)
+  @Max(50)
+  take = 25;
+}
diff --git a/sample/33-graphql-mercurius/src/recipes/models/recipe.model.ts b/sample/33-graphql-mercurius/src/recipes/models/recipe.model.ts
new file mode 100644
index 000000000..2193b2310
--- /dev/null
+++ b/sample/33-graphql-mercurius/src/recipes/models/recipe.model.ts
@@ -0,0 +1,19 @@
+import { Field, ID, ObjectType } from '@nestjs/graphql';
+
+@ObjectType({ description: 'recipe ' })
+export class Recipe {
+  @Field(type => ID)
+  id: string;
+
+  @Field()
+  title: string;
+
+  @Field({ nullable: true })
+  description?: string;
+
+  @Field()
+  creationDate: Date;
+
+  @Field(type => [String])
+  ingredients: string[];
+}
diff --git a/sample/33-graphql-mercurius/src/recipes/recipes.module.ts b/sample/33-graphql-mercurius/src/recipes/recipes.module.ts
new file mode 100644
index 000000000..fd2d2cc95
--- /dev/null
+++ b/sample/33-graphql-mercurius/src/recipes/recipes.module.ts
@@ -0,0 +1,9 @@
+import { Module } from '@nestjs/common';
+import { DateScalar } from '../common/scalars/date.scalar';
+import { RecipesResolver } from './recipes.resolver';
+import { RecipesService } from './recipes.service';
+
+@Module({
+  providers: [RecipesResolver, RecipesService, DateScalar],
+})
+export class RecipesModule {}
diff --git a/sample/33-graphql-mercurius/src/recipes/recipes.resolver.ts b/sample/33-graphql-mercurius/src/recipes/recipes.resolver.ts
new file mode 100644
index 000000000..5b42038fc
--- /dev/null
+++ b/sample/33-graphql-mercurius/src/recipes/recipes.resolver.ts
@@ -0,0 +1,53 @@
+import { NotFoundException } from '@nestjs/common';
+import {
+  Args,
+  Context,
+  Mutation,
+  Query,
+  Resolver,
+  Subscription,
+} from '@nestjs/graphql';
+import { PubSub } from 'mercurius';
+import { NewRecipeInput } from './dto/new-recipe.input';
+import { RecipesArgs } from './dto/recipes.args';
+import { Recipe } from './models/recipe.model';
+import { RecipesService } from './recipes.service';
+
+@Resolver(of => Recipe)
+export class RecipesResolver {
+  constructor(private readonly recipesService: RecipesService) {}
+
+  @Query(returns => Recipe)
+  async recipe(@Args('id') id: string): Promise<Recipe> {
+    const recipe = await this.recipesService.findOneById(id);
+    if (!recipe) {
+      throw new NotFoundException(id);
+    }
+    return recipe;
+  }
+
+  @Query(returns => [Recipe])
+  recipes(@Args() recipesArgs: RecipesArgs): Promise<Recipe[]> {
+    return this.recipesService.findAll(recipesArgs);
+  }
+
+  @Mutation(returns => Recipe)
+  async addRecipe(
+    @Args('newRecipeData') newRecipeData: NewRecipeInput,
+    @Context('pubsub') pubSub: PubSub,
+  ): Promise<Recipe> {
+    const recipe = await this.recipesService.create(newRecipeData);
+    pubSub.publish({ topic: 'recipeAdded', payload: { recipeAdded: recipe } });
+    return recipe;
+  }
+
+  @Mutation(returns => Boolean)
+  async removeRecipe(@Args('id') id: string) {
+    return this.recipesService.remove(id);
+  }
+
+  @Subscription(returns => Recipe)
+  recipeAdded(@Context('pubsub') pubSub: PubSub) {
+    return pubSub.subscribe('recipeAdded');
+  }
+}
diff --git a/sample/33-graphql-mercurius/src/recipes/recipes.service.ts b/sample/33-graphql-mercurius/src/recipes/recipes.service.ts
new file mode 100644
index 000000000..a4d6428eb
--- /dev/null
+++ b/sample/33-graphql-mercurius/src/recipes/recipes.service.ts
@@ -0,0 +1,29 @@
+import { Injectable } from '@nestjs/common';
+import { NewRecipeInput } from './dto/new-recipe.input';
+import { RecipesArgs } from './dto/recipes.args';
+import { Recipe } from './models/recipe.model';
+
+@Injectable()
+export class RecipesService {
+  /**
+   * MOCK
+   * Put some real business logic here
+   * Left for demonstration purposes
+   */
+
+  async create(data: NewRecipeInput): Promise<Recipe> {
+    return {} as any;
+  }
+
+  async findOneById(id: string): Promise<Recipe> {
+    return {} as any;
+  }
+
+  async findAll(recipesArgs: RecipesArgs): Promise<Recipe[]> {
+    return [] as Recipe[];
+  }
+
+  async remove(id: string): Promise<boolean> {
+    return true;
+  }
+}
diff --git a/sample/33-graphql-mercurius/tsconfig.build.json b/sample/33-graphql-mercurius/tsconfig.build.json
new file mode 100644
index 000000000..2fe1df273
--- /dev/null
+++ b/sample/33-graphql-mercurius/tsconfig.build.json
@@ -0,0 +1,4 @@
+{
+  "extends": "./tsconfig.json",
+  "exclude": ["node_modules", "dist", "test", "**/*spec.ts"]
+}
diff --git a/sample/33-graphql-mercurius/tsconfig.json b/sample/33-graphql-mercurius/tsconfig.json
new file mode 100644
index 000000000..e268e37aa
--- /dev/null
+++ b/sample/33-graphql-mercurius/tsconfig.json
@@ -0,0 +1,17 @@
+{
+  "compilerOptions": {
+    "module": "commonjs",
+    "declaration": true,
+    "removeComments": true,
+    "emitDecoratorMetadata": true,
+    "experimentalDecorators": true,
+    "allowSyntheticDefaultImports": true,
+    "target": "es2017",
+    "sourceMap": true,
+    "outDir": "./dist",
+    "baseUrl": "./",
+    "incremental": true,
+    "skipLibCheck": true
+  },
+  "include": ["src/**/*"]
+}
diff --git a/tsconfig.json b/tsconfig.json
index 036b1a814..5712f3c0c 100644
--- a/tsconfig.json
+++ b/tsconfig.json
@@ -8,6 +8,7 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
+    "useUnknownInCatchVariables": false,
     "target": "es6",
     "sourceMap": true,
     "allowJs": true,
