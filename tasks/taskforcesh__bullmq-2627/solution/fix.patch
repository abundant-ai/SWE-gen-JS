diff --git a/python/bullmq/scripts.py b/python/bullmq/scripts.py
index 1c6406e82f..26218b109b 100644
--- a/python/bullmq/scripts.py
+++ b/python/bullmq/scripts.py
@@ -258,7 +258,7 @@ class Scripts:
         push_cmd = "RPUSH" if lifo else "LPUSH"
 
         args = [self.keys[''], round(time.time() * 1000), push_cmd,
-            job_id, token, "1" if opts.get("skipAttempt") else "0"]
+                job_id, token, "1" if opts.get("skipAttempt") else "0"]
 
         return (keys, args)
 
@@ -275,7 +275,7 @@ class Scripts:
         keys.append(self.keys['stalled'])
 
         args = [self.keys[''], round(time.time() * 1000), str(max_timestamp),
-            job_id, token, delay, "1" if opts.get("skipAttempt") else "0"]
+                job_id, token, delay, "1" if opts.get("skipAttempt") else "0"]
 
         return (keys, args)
 
@@ -325,9 +325,9 @@ class Scripts:
 
     def getCountsPerPriorityArgs(self, priorities):
         keys = [self.keys['wait'],
-            self.keys['paused'],
-            self.keys['meta'],
-            self.keys['prioritized']]
+                self.keys['paused'],
+                self.keys['meta'],
+                self.keys['prioritized']]
 
         args = priorities
 
diff --git a/python/bullmq/types/job_options.py b/python/bullmq/types/job_options.py
index 9cb617d477..f0d3fb930d 100644
--- a/python/bullmq/types/job_options.py
+++ b/python/bullmq/types/job_options.py
@@ -7,7 +7,7 @@ class JobOptions(TypedDict, total=False):
     """
     Backoff setting for automatic retries if the job fails.
     """
-    
+
     jobId: str
     """
     Override the job ID - by default, the job ID is a unique
diff --git a/python/bullmq/types/queue_options.py b/python/bullmq/types/queue_options.py
index 70ed1c92d4..19f21f9186 100644
--- a/python/bullmq/types/queue_options.py
+++ b/python/bullmq/types/queue_options.py
@@ -13,4 +13,3 @@ class QueueBaseOptions(TypedDict, total=False):
     """
     Prefix for all queue keys.
     """
-
diff --git a/python/bullmq/utils.py b/python/bullmq/utils.py
index 70b00a288b..7d642c29d7 100644
--- a/python/bullmq/utils.py
+++ b/python/bullmq/utils.py
@@ -1,6 +1,7 @@
 import semver
 import traceback
 
+
 def isRedisVersionLowerThan(current_version, minimum_version):
     return semver.VersionInfo.parse(current_version).compare(minimum_version) == -1
 
diff --git a/python/bullmq/worker.py b/python/bullmq/worker.py
index a0e33404cc..3b1f578c0f 100644
--- a/python/bullmq/worker.py
+++ b/python/bullmq/worker.py
@@ -16,9 +16,11 @@ import math
 
 maximum_block_timeout = 10
 # 1 millisecond is chosen because the granularity of our timestamps are milliseconds.
-# Obviously we can still process much faster than 1 job per millisecond but delays and rate limits will never work with more accuracy than 1ms.
+# Obviously we can still process much faster than 1 job per millisecond but delays and
+# rate limits will never work with more accuracy than 1ms.
 minimum_block_timeout = 0.001
 
+
 class Worker(EventEmitter):
     def __init__(self, name: str, processor: Callable[[Job, str], asyncio.Future], opts: WorkerOptions = {}):
         super().__init__()
diff --git a/src/commands/includes/handleDuplicatedJob.lua b/src/commands/includes/handleDuplicatedJob.lua
index 67cbb558d7..8c2f6bcbf3 100644
--- a/src/commands/includes/handleDuplicatedJob.lua
+++ b/src/commands/includes/handleDuplicatedJob.lua
@@ -9,7 +9,7 @@ local function handleDuplicatedJob(jobKey, jobId, currentParentKey, currentParen
   parentData, parentDependenciesKey, completedKey, eventsKey, maxEvents, timestamp)
   local existedParentKey = rcall("HGET", jobKey, "parentKey")
 
-  if not existedParentKey then
+  if not existedParentKey or existedParentKey == currentParentKey then
     updateExistingJobsParent(currentParentKey, currentParent, parentData,
       parentDependenciesKey, completedKey, jobKey,
       jobId, timestamp)
