diff --git a/bench/parser.benchmark.js b/bench/parser.benchmark.js
index ce295ccd..dd97701a 100644
--- a/bench/parser.benchmark.js
+++ b/bench/parser.benchmark.js
@@ -29,14 +29,14 @@ const pingFrame1 = Buffer.concat(
 );
 
 const textFrame = Buffer.from('819461616161' + '61'.repeat(20), 'hex');
-const pingFrame2 = Buffer.from('8900', 'hex');
+const pingFrame2 = Buffer.from('8980146e915a', 'hex');
 const binaryFrame1 = createBinaryFrame(125);
 const binaryFrame2 = createBinaryFrame(65535);
 const binaryFrame3 = createBinaryFrame(200 * 1024);
 const binaryFrame4 = createBinaryFrame(1024 * 1024);
 
 const suite = new benchmark.Suite();
-const receiver = new Receiver();
+const receiver = new Receiver('nodebuffer', {}, true);
 
 suite.add('ping frame (5 bytes payload)', {
   defer: true,
diff --git a/lib/receiver.js b/lib/receiver.js
index 3a8b92a6..57daa725 100644
--- a/lib/receiver.js
+++ b/lib/receiver.js
@@ -30,14 +30,17 @@ class Receiver extends Writable {
    *
    * @param {String} binaryType The type for binary data
    * @param {Object} extensions An object containing the negotiated extensions
+   * @param {Boolean} isServer Specifies whether to operate in client or server
+   *     mode
    * @param {Number} maxPayload The maximum allowed message length
    */
-  constructor(binaryType, extensions, maxPayload) {
+  constructor(binaryType, extensions, isServer, maxPayload) {
     super();
 
     this._binaryType = binaryType || BINARY_TYPES[0];
     this[kWebSocket] = undefined;
     this._extensions = extensions || {};
+    this._isServer = !!isServer;
     this._maxPayload = maxPayload | 0;
 
     this._bufferedBytes = 0;
@@ -225,6 +228,16 @@ class Receiver extends Writable {
     if (!this._fin && !this._fragmented) this._fragmented = this._opcode;
     this._masked = (buf[1] & 0x80) === 0x80;
 
+    if (this._isServer) {
+      if (!this._masked) {
+        this._loop = false;
+        return error(RangeError, 'MASK must be set', true, 1002);
+      }
+    } else if (this._masked) {
+      this._loop = false;
+      return error(RangeError, 'MASK must be clear', true, 1002);
+    }
+
     if (this._payloadLength === 126) this._state = GET_PAYLOAD_LENGTH_16;
     else if (this._payloadLength === 127) this._state = GET_PAYLOAD_LENGTH_64;
     else return this.haveLength();
diff --git a/lib/websocket.js b/lib/websocket.js
index cd8929bd..c157cfd2 100644
--- a/lib/websocket.js
+++ b/lib/websocket.js
@@ -141,6 +141,7 @@ class WebSocket extends EventEmitter {
     const receiver = new Receiver(
       this._binaryType,
       this._extensions,
+      this._isServer,
       maxPayload
     );
 
