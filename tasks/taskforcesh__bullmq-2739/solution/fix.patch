diff --git a/.husky/pre-commit b/.husky/pre-commit
index 336cbd628b..48087ddca7 100755
--- a/.husky/pre-commit
+++ b/.husky/pre-commit
@@ -1,4 +1,4 @@
 #!/usr/bin/env sh
 . "$(dirname -- "$0")/_/husky.sh"
 
-yarn npm-run-all pretty:quick lint:staged
+npx npm-run-all pretty:quick lint:staged
diff --git a/package.json b/package.json
index aa71199f30..9387aafee6 100644
--- a/package.json
+++ b/package.json
@@ -28,7 +28,7 @@
     "copy:lua": "copyfiles -f ./src/commands/*.lua ./dist/cjs/commands && copyfiles -f ./src/commands/*.lua ./dist/esm/commands",
     "copy:lua:python": "copyfiles -f ./rawScripts/*.lua ./python/bullmq/commands",
     "copy:main:type": "copyfiles -f ./dist/esm/classes/main.d.ts ./dist/esm/classes/main-worker.d.ts ./dist/cjs/classes",
-    "coverage": "nyc --reporter=text --reporter=lcovonly yarn test",
+    "coverage": "nyc --reporter=text --reporter=lcovonly npm run test",
     "cm": "git cz",
     "docs": "typedoc --excludeExternals --excludeProtected --excludePrivate --readme none src/index.ts",
     "docs:json": "typedoc --excludeExternals --excludeProtected --excludePrivate --readme none src/index.ts --json ./apiVersions/v5.json --name v5",
@@ -39,7 +39,7 @@
     "generate:raw:scripts": "ts-node --project tsconfig-cjs.json generateRawScripts.ts",
     "lint": "./node_modules/.bin/eslint . --ignore-path ./.eslintignore",
     "lint:staged": "lint-staged",
-    "prepublishOnly": "yarn build",
+    "prepublishOnly": "npm run build",
     "prepare": "husky install",
     "pretest": "npm-run-all clean:scripts generate:raw:scripts transform:commands",
     "prettier": "prettier --config package.json src/**/*.ts",
@@ -162,7 +162,7 @@
     ]
   },
   "lint-staged": {
-    "*.{js,ts}": "yarn eslint:fix"
+    "*.{js,ts}": "npm run eslint:fix"
   },
   "repository": {
     "type": "git",
diff --git a/src/classes/child-processor.ts b/src/classes/child-processor.ts
index 98ea85b0e5..5ae835bc6d 100644
--- a/src/classes/child-processor.ts
+++ b/src/classes/child-processor.ts
@@ -114,7 +114,7 @@ export class ChildProcessor {
     job: JobJsonSandbox,
     send: (msg: any) => Promise<void>,
   ): SandboxedJob {
-    return {
+    const wrappedJob = {
       ...job,
       data: JSON.parse(job.data || '{}'),
       opts: job.opts,
@@ -136,7 +136,7 @@ export class ChildProcessor {
        * Emulate the real job `log` function.
        */
       log: async (row: any) => {
-        send({
+        await send({
           cmd: ParentCommand.Log,
           value: row,
         });
@@ -145,7 +145,7 @@ export class ChildProcessor {
        * Emulate the real job `moveToDelayed` function.
        */
       moveToDelayed: async (timestamp: number, token?: string) => {
-        send({
+        await send({
           cmd: ParentCommand.MoveToDelayed,
           value: { timestamp, token },
         });
@@ -154,11 +154,14 @@ export class ChildProcessor {
        * Emulate the real job `updateData` function.
        */
       updateData: async (data: any) => {
-        send({
+        await send({
           cmd: ParentCommand.Update,
           value: data,
         });
+        wrappedJob.data = data;
       },
     };
+
+    return wrappedJob;
   }
 }
