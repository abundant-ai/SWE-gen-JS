diff --git a/.gitignore b/.gitignore
index 5943850da..e4ac8a641 100644
--- a/.gitignore
+++ b/.gitignore
@@ -5,7 +5,6 @@ node_modules/
 /.idea
 /.awcache
 /.vscode
-/.devcontainer
 *.code-workspace
 
 # bundle
diff --git a/.mocharc.js b/.mocharc.js
new file mode 100644
index 000000000..b9cef9d6d
--- /dev/null
+++ b/.mocharc.js
@@ -0,0 +1,7 @@
+module.exports = {
+  mochaHooks: {
+    beforeAll: function() {
+      require('reflect-metadata');
+    }
+  }
+};
diff --git a/Readme.md b/Readme.md
index a5e43201d..a037af980 100644
--- a/Readme.md
+++ b/Readme.md
@@ -64,20 +64,17 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
 <td>
 <a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
-    <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
 </tr></table>
 
 #### Gold Sponsors
 
 <table style="text-align:center;"><tr><td>
   <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="140" valign="middle" /></a></td>
+<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
+  <td>
+<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
 <td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td>
- <td>
-<a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
-<a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td></</tr></table>
+<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
diff --git a/hooks/mocha-init-hook.ts b/hooks/mocha-init-hook.ts
deleted file mode 100644
index 4a774163f..000000000
--- a/hooks/mocha-init-hook.ts
+++ /dev/null
@@ -1,7 +0,0 @@
-export const mochaHooks = (): Mocha.RootHookObject => {
-  return {
-    async beforeAll(this: Mocha.Context) {
-      await import('reflect-metadata');
-    }
-  };
-};
diff --git a/integration/docker-compose.yml b/integration/docker-compose.yml
index 6d2bf45fd..148c32151 100644
--- a/integration/docker-compose.yml
+++ b/integration/docker-compose.yml
@@ -17,15 +17,13 @@ services:
     restart: always
   mqtt:
     container_name: test-mqtt
-    image: eclipse-mosquitto
-    volumes:
-      - ./mosquitto.conf:/mosquitto/config/mosquitto.conf
+    image: toke/mosquitto
     ports:
       - "1883:1883"
       - "9001:9001"
     restart: always
   mysql:
-    image: mysql:8.0.28
+    image: mysql:8.0.27
     environment:
       MYSQL_ROOT_PASSWORD: root
       MYSQL_DATABASE: test
diff --git a/integration/injector/src/inject/inject-same-name.module.ts b/integration/injector/src/inject/inject-same-name.module.ts
deleted file mode 100644
index f66fd51a7..000000000
--- a/integration/injector/src/inject/inject-same-name.module.ts
+++ /dev/null
@@ -1,16 +0,0 @@
-import { Module, Injectable, Inject } from '@nestjs/common';
-
-@Injectable()
-class CoreService {
-  constructor(@Inject(CoreService.name) private readonly coreService: any) {}
-}
-
-@Module({
-  providers: [
-    {
-      provide: CoreService.name,
-      useValue: 'anything',
-    },
-  ],
-})
-export class InjectSameNameModule {}
diff --git a/integration/injector/src/self-injection/self-injection-provider.module.ts b/integration/injector/src/self-injection/self-injection-provider.module.ts
deleted file mode 100644
index 6850c75dc..000000000
--- a/integration/injector/src/self-injection/self-injection-provider.module.ts
+++ /dev/null
@@ -1,40 +0,0 @@
-import { Module, Injectable, Inject, forwardRef } from '@nestjs/common';
-
-@Injectable()
-class ServiceInjectingItself {
-  constructor(private readonly coreService: ServiceInjectingItself) {}
-}
-
-@Injectable()
-class ServiceInjectingItselfForwared {
-  constructor(
-    @Inject(forwardRef(() => ServiceInjectingItself))
-    private readonly coreService: ServiceInjectingItself,
-  ) {}
-}
-
-@Injectable()
-class ServiceInjectingItselfViaCustomToken {
-  constructor(@Inject('AnotherToken') private readonly coreService: any) {}
-}
-
-@Module({
-  providers: [ServiceInjectingItself],
-})
-export class SelfInjectionProviderModule {}
-
-@Module({
-  providers: [ServiceInjectingItselfForwared],
-})
-export class SelfInjectionForwardProviderModule {}
-
-@Module({
-  providers: [
-    ServiceInjectingItselfViaCustomToken,
-    {
-      provide: 'AnotherToken',
-      useClass: ServiceInjectingItselfViaCustomToken,
-    },
-  ],
-})
-export class SelfInjectionProviderCustomTokenModule {}
diff --git a/integration/microservices/src/mqtt/mqtt.controller.ts b/integration/microservices/src/mqtt/mqtt.controller.ts
index 72de41d5c..a73a5e0eb 100644
--- a/integration/microservices/src/mqtt/mqtt.controller.ts
+++ b/integration/microservices/src/mqtt/mqtt.controller.ts
@@ -18,8 +18,6 @@ export class MqttController {
   static IS_NOTIFIED = false;
   static IS_WILDCARD_EVENT_RECEIVED = false;
   static IS_WILDCARD2_EVENT_RECEIVED = false;
-  static IS_SHARED_WILDCARD_EVENT_RECEIVED = false;
-  static IS_SHARED_WILDCARD2_EVENT_RECEIVED = false;
 
   @Client({ transport: Transport.MQTT })
   client: ClientProxy;
@@ -111,32 +109,6 @@ export class MqttController {
     };
   }
 
-  @Post('shared-wildcard-event')
-  async sendSharedWildcardEvent(): Promise<any> {
-    return this.client.emit<number>('shared-wildcard-event/test', true);
-  }
-
-  @Post('shared-wildcard-message')
-  async sendSharedWildcardMessage(
-    @Body() data: number[],
-  ): Promise<Observable<number>> {
-    await this.client.connect();
-    return this.client.send<number>('shared-wildcard-message/test', data);
-  }
-
-  @Post('shared-wildcard-event2')
-  async sendSharedWildcardEvent2(): Promise<any> {
-    return this.client.emit<number>('shared-wildcard-event2/test/test', true);
-  }
-
-  @Post('shared-wildcard-message2')
-  async sendSharedWildcardMessage2(
-    @Body() data: number[],
-  ): Promise<Observable<number>> {
-    await this.client.connect();
-    return this.client.send<number>('shared-wildcard-message2/test/test', data);
-  }
-
   @MessagePattern('wildcard-message/#')
   wildcardMessageHandler(data: number[]): number {
     if ((data as any).response) {
@@ -184,27 +156,4 @@ export class MqttController {
   streaming(data: number[]): Observable<number> {
     return from(data);
   }
-
-  @MessagePattern('$share/test-group/shared-wildcard-message/#')
-  sharedWildcardMessageHandler(data: number[]): number {
-    if ((data as any).response) {
-      return;
-    }
-    return (data || []).reduce((a, b) => a + b);
-  }
-
-  @EventPattern('$share/test-group/shared-wildcard-event/#')
-  sharedWildcardEventHandler(data: boolean) {
-    MqttController.IS_SHARED_WILDCARD_EVENT_RECEIVED = data;
-  }
-
-  @MessagePattern('$share/test-group/shared-wildcard-message2/+/test')
-  sharedWildcardMessageHandler2(data: number[]): number {
-    return (data || []).reduce((a, b) => a + b);
-  }
-
-  @EventPattern('$share/test-group/shared-wildcard-event2/+/test')
-  sharedWildcardEventHandler2(data: boolean) {
-    MqttController.IS_SHARED_WILDCARD2_EVENT_RECEIVED = data;
-  }
 }
diff --git a/integration/microservices/src/rmq/rmq.controller.ts b/integration/microservices/src/rmq/rmq.controller.ts
index 07f8075e6..932bb46a9 100644
--- a/integration/microservices/src/rmq/rmq.controller.ts
+++ b/integration/microservices/src/rmq/rmq.controller.ts
@@ -61,21 +61,6 @@ export class RMQController {
       .reduce(async (a, b) => (await a) && b);
   }
 
-  @Post('multiple-urls')
-  @HttpCode(200)
-  multipleUrls(@Body() data: number[]) {
-    const clientWithMultipleUrls = ClientProxyFactory.create({
-      transport: Transport.RMQ,
-      options: {
-        urls: [`amqp://localhost:5671`, `amqp://localhost:5672`],
-        queue: 'test',
-        queueOptions: { durable: false },
-        socketOptions: { noDelay: true },
-      },
-    });
-    return clientWithMultipleUrls.send<number>({ cmd: 'multiple-urls' }, data);
-  }
-
   @Post('record-builder-duplex')
   @HttpCode(200)
   useRecordBuilderDuplex(@Body() data: Record<string, any>) {
@@ -124,11 +109,6 @@ export class RMQController {
     return from(data);
   }
 
-  @MessagePattern({ cmd: 'multiple-urls' })
-  handleMultipleUrls(data: number[]): number {
-    return (data || []).reduce((a, b) => a + b);
-  }
-
   @Post('notify')
   async sendNotification(): Promise<any> {
     return this.client.emit<number>('notification', true);
diff --git a/integration/module-utils/src/integration.module-definition.ts b/integration/module-utils/src/integration.module-definition.ts
deleted file mode 100644
index 89d7a9842..000000000
--- a/integration/module-utils/src/integration.module-definition.ts
+++ /dev/null
@@ -1,17 +0,0 @@
-import { ConfigurableModuleBuilder } from '@nestjs/common';
-import { IntegrationModuleOptions } from './interfaces/integration-module-options.interface';
-
-export const { ConfigurableModuleClass, MODULE_OPTIONS_TOKEN } =
-  new ConfigurableModuleBuilder<IntegrationModuleOptions>()
-    .setClassMethodName('forRoot')
-    .setFactoryMethodName('construct')
-    .setExtras(
-      {
-        isGlobal: true,
-      },
-      (definition, extras) => ({
-        ...definition,
-        global: extras.isGlobal,
-      }),
-    )
-    .build();
diff --git a/integration/module-utils/src/integration.module.ts b/integration/module-utils/src/integration.module.ts
deleted file mode 100644
index 3b994f4bd..000000000
--- a/integration/module-utils/src/integration.module.ts
+++ /dev/null
@@ -1,16 +0,0 @@
-import { Inject, Module } from '@nestjs/common';
-import {
-  ConfigurableModuleClass,
-  MODULE_OPTIONS_TOKEN,
-} from './integration.module-definition';
-import { IntegrationModuleOptions } from './interfaces/integration-module-options.interface';
-
-@Module({})
-export class IntegrationModule extends ConfigurableModuleClass {
-  constructor(
-    @Inject(MODULE_OPTIONS_TOKEN)
-    public readonly options: IntegrationModuleOptions,
-  ) {
-    super();
-  }
-}
diff --git a/integration/module-utils/src/interfaces/integration-module-options.interface.ts b/integration/module-utils/src/interfaces/integration-module-options.interface.ts
deleted file mode 100644
index 802e02076..000000000
--- a/integration/module-utils/src/interfaces/integration-module-options.interface.ts
+++ /dev/null
@@ -1,4 +0,0 @@
-export interface IntegrationModuleOptions {
-  url: string;
-  secure?: boolean;
-}
diff --git a/integration/module-utils/tsconfig.json b/integration/module-utils/tsconfig.json
deleted file mode 100644
index c6354c564..000000000
--- a/integration/module-utils/tsconfig.json
+++ /dev/null
@@ -1,22 +0,0 @@
-{
-  "compilerOptions": {
-    "module": "commonjs",
-    "declaration": false,
-    "noImplicitAny": false,
-    "removeComments": true,
-    "noLib": false,
-    "emitDecoratorMetadata": true,
-    "experimentalDecorators": true,
-    "target": "es6",
-    "sourceMap": true,
-    "allowJs": true,
-    "outDir": "./dist"
-  },
-  "include": [
-    "src/**/*",
-    "e2e/**/*"
-  ],
-  "exclude": [
-    "node_modules",
-  ]
-}
\ No newline at end of file
diff --git a/integration/mosquitto.conf b/integration/mosquitto.conf
deleted file mode 100644
index 440823741..000000000
--- a/integration/mosquitto.conf
+++ /dev/null
@@ -1,906 +0,0 @@
-# Config file for mosquitto
-#
-# See mosquitto.conf(5) for more information.
-#
-# Default values are shown, uncomment to change.
-#
-# Use the # character to indicate a comment, but only if it is the
-# very first character on the line.
-
-# =================================================================
-# General configuration
-# =================================================================
-
-# Use per listener security settings.
-#
-# It is recommended this option be set before any other options.
-#
-# If this option is set to true, then all authentication and access control
-# options are controlled on a per listener basis. The following options are
-# affected:
-#
-# acl_file
-# allow_anonymous
-# allow_zero_length_clientid
-# auto_id_prefix
-# password_file
-# plugin
-# plugin_opt_*
-# psk_file
-#
-# Note that if set to true, then a durable client (i.e. with clean session set
-# to false) that has disconnected will use the ACL settings defined for the
-# listener that it was most recently connected to.
-#
-# The default behaviour is for this to be set to false, which maintains the
-# setting behaviour from previous versions of mosquitto.
-#per_listener_settings false
-
-
-# This option controls whether a client is allowed to connect with a zero
-# length client id or not. This option only affects clients using MQTT v3.1.1
-# and later. If set to false, clients connecting with a zero length client id
-# are disconnected. If set to true, clients will be allocated a client id by
-# the broker. This means it is only useful for clients with clean session set
-# to true.
-#allow_zero_length_clientid true
-
-# If allow_zero_length_clientid is true, this option allows you to set a prefix
-# to automatically generated client ids to aid visibility in logs.
-# Defaults to 'auto-'
-#auto_id_prefix auto-
-
-# This option affects the scenario when a client subscribes to a topic that has
-# retained messages. It is possible that the client that published the retained
-# message to the topic had access at the time they published, but that access
-# has been subsequently removed. If check_retain_source is set to true, the
-# default, the source of a retained message will be checked for access rights
-# before it is republished. When set to false, no check will be made and the
-# retained message will always be published. This affects all listeners.
-#check_retain_source true
-
-# QoS 1 and 2 messages will be allowed inflight per client until this limit
-# is exceeded.  Defaults to 0. (No maximum)
-# See also max_inflight_messages
-#max_inflight_bytes 0
-
-# The maximum number of QoS 1 and 2 messages currently inflight per
-# client.
-# This includes messages that are partway through handshakes and
-# those that are being retried. Defaults to 20. Set to 0 for no
-# maximum. Setting to 1 will guarantee in-order delivery of QoS 1
-# and 2 messages.
-#max_inflight_messages 20
-
-# For MQTT v5 clients, it is possible to have the server send a "server
-# keepalive" value that will override the keepalive value set by the client.
-# This is intended to be used as a mechanism to say that the server will
-# disconnect the client earlier than it anticipated, and that the client should
-# use the new keepalive value. The max_keepalive option allows you to specify
-# that clients may only connect with keepalive less than or equal to this
-# value, otherwise they will be sent a server keepalive telling them to use
-# max_keepalive. This only applies to MQTT v5 clients. The default, and maximum
-# value allowable, is 65535.
-#
-# Set to 0 to allow clients to set keepalive = 0, which means no keepalive
-# checks are made and the client will never be disconnected by the broker if no
-# messages are received. You should be very sure this is the behaviour that you
-# want.
-#
-# For MQTT v3.1.1 and v3.1 clients, there is no mechanism to tell the client
-# what keepalive value they should use. If an MQTT v3.1.1 or v3.1 client
-# specifies a keepalive time greater than max_keepalive they will be sent a
-# CONNACK message with the "identifier rejected" reason code, and disconnected.
-#
-#max_keepalive 65535
-
-# For MQTT v5 clients, it is possible to have the server send a "maximum packet
-# size" value that will instruct the client it will not accept MQTT packets
-# with size greater than max_packet_size bytes. This applies to the full MQTT
-# packet, not just the payload. Setting this option to a positive value will
-# set the maximum packet size to that number of bytes. If a client sends a
-# packet which is larger than this value, it will be disconnected. This applies
-# to all clients regardless of the protocol version they are using, but v3.1.1
-# and earlier clients will of course not have received the maximum packet size
-# information. Defaults to no limit. Setting below 20 bytes is forbidden
-# because it is likely to interfere with ordinary client operation, even with
-# very small payloads.
-#max_packet_size 0
-
-# QoS 1 and 2 messages above those currently in-flight will be queued per
-# client until this limit is exceeded.  Defaults to 0. (No maximum)
-# See also max_queued_messages.
-# If both max_queued_messages and max_queued_bytes are specified, packets will
-# be queued until the first limit is reached.
-#max_queued_bytes 0
-
-# Set the maximum QoS supported. Clients publishing at a QoS higher than
-# specified here will be disconnected.
-#max_qos 2
-
-# The maximum number of QoS 1 and 2 messages to hold in a queue per client
-# above those that are currently in-flight.  Defaults to 1000. Set
-# to 0 for no maximum (not recommended).
-# See also queue_qos0_messages.
-# See also max_queued_bytes.
-#max_queued_messages 1000
-#
-# This option sets the maximum number of heap memory bytes that the broker will
-# allocate, and hence sets a hard limit on memory use by the broker.  Memory
-# requests that exceed this value will be denied. The effect will vary
-# depending on what has been denied. If an incoming message is being processed,
-# then the message will be dropped and the publishing client will be
-# disconnected. If an outgoing message is being sent, then the individual
-# message will be dropped and the receiving client will be disconnected.
-# Defaults to no limit.
-#memory_limit 0
-
-# This option sets the maximum publish payload size that the broker will allow.
-# Received messages that exceed this size will not be accepted by the broker.
-# The default value is 0, which means that all valid MQTT messages are
-# accepted. MQTT imposes a maximum payload size of 268435455 bytes.
-#message_size_limit 0
-
-# This option allows persistent clients (those with clean session set to false)
-# to be removed if they do not reconnect within a certain time frame.
-#
-# This is a non-standard option in MQTT V3.1 but allowed in MQTT v3.1.1.
-#
-# Badly designed clients may set clean session to false whilst using a randomly
-# generated client id. This leads to persistent clients that will never
-# reconnect. This option allows these clients to be removed.
-#
-# The expiration period should be an integer followed by one of h d w m y for
-# hour, day, week, month and year respectively. For example
-#
-# persistent_client_expiration 2m
-# persistent_client_expiration 14d
-# persistent_client_expiration 1y
-#
-# The default if not set is to never expire persistent clients.
-#persistent_client_expiration
-
-# Write process id to a file. Default is a blank string which means
-# a pid file shouldn't be written.
-# This should be set to /var/run/mosquitto/mosquitto.pid if mosquitto is
-# being run automatically on boot with an init script and
-# start-stop-daemon or similar.
-#pid_file
-
-# Set to true to queue messages with QoS 0 when a persistent client is
-# disconnected. These messages are included in the limit imposed by
-# max_queued_messages and max_queued_bytes
-# Defaults to false.
-# This is a non-standard option for the MQTT v3.1 spec but is allowed in
-# v3.1.1.
-#queue_qos0_messages false
-
-# Set to false to disable retained message support. If a client publishes a
-# message with the retain bit set, it will be disconnected if this is set to
-# false.
-#retain_available true
-
-# Disable Nagle's algorithm on client sockets. This has the effect of reducing
-# latency of individual messages at the potential cost of increasing the number
-# of packets being sent.
-#set_tcp_nodelay false
-
-# Time in seconds between updates of the $SYS tree.
-# Set to 0 to disable the publishing of the $SYS tree.
-#sys_interval 10
-
-# The MQTT specification requires that the QoS of a message delivered to a
-# subscriber is never upgraded to match the QoS of the subscription. Enabling
-# this option changes this behaviour. If upgrade_outgoing_qos is set true,
-# messages sent to a subscriber will always match the QoS of its subscription.
-# This is a non-standard option explicitly disallowed by the spec.
-#upgrade_outgoing_qos false
-
-# When run as root, drop privileges to this user and its primary
-# group.
-# Set to root to stay as root, but this is not recommended.
-# If set to "mosquitto", or left unset, and the "mosquitto" user does not exist
-# then it will drop privileges to the "nobody" user instead.
-# If run as a non-root user, this setting has no effect.
-# Note that on Windows this has no effect and so mosquitto should be started by
-# the user you wish it to run as.
-#user mosquitto
-
-# =================================================================
-# Listeners
-# =================================================================
-
-# Listen on a port/ip address combination. By using this variable
-# multiple times, mosquitto can listen on more than one port. If
-# this variable is used and neither bind_address nor port given,
-# then the default listener will not be started.
-# The port number to listen on must be given. Optionally, an ip
-# address or host name may be supplied as a second argument. In
-# this case, mosquitto will attempt to bind the listener to that
-# address and so restrict access to the associated network and
-# interface. By default, mosquitto will listen on all interfaces.
-# Note that for a websockets listener it is not possible to bind to a host
-# name.
-#
-# On systems that support Unix Domain Sockets, it is also possible
-# to create a # Unix socket rather than opening a TCP socket. In
-# this case, the port number should be set to 0 and a unix socket
-# path must be provided, e.g.
-# listener 0 /tmp/mosquitto.sock
-#
-# listener port-number [ip address/host name/unix socket path]
-#listener
-
-# By default, a listener will attempt to listen on all supported IP protocol
-# versions. If you do not have an IPv4 or IPv6 interface you may wish to
-# disable support for either of those protocol versions. In particular, note
-# that due to the limitations of the websockets library, it will only ever
-# attempt to open IPv6 sockets if IPv6 support is compiled in, and so will fail
-# if IPv6 is not available.
-#
-# Set to `ipv4` to force the listener to only use IPv4, or set to `ipv6` to
-# force the listener to only use IPv6. If you want support for both IPv4 and
-# IPv6, then do not use the socket_domain option.
-#
-#socket_domain
-
-# Bind the listener to a specific interface. This is similar to
-# the [ip address/host name] part of the listener definition, but is useful
-# when an interface has multiple addresses or the address may change. If used
-# with the [ip address/host name] part of the listener definition, then the
-# bind_interface option will take priority.
-# Not available on Windows.
-#
-# Example: bind_interface eth0
-#bind_interface
-
-# When a listener is using the websockets protocol, it is possible to serve
-# http data as well. Set http_dir to a directory which contains the files you
-# wish to serve. If this option is not specified, then no normal http
-# connections will be possible.
-#http_dir
-
-# The maximum number of client connections to allow. This is
-# a per listener setting.
-# Default is -1, which means unlimited connections.
-# Note that other process limits mean that unlimited connections
-# are not really possible. Typically the default maximum number of
-# connections possible is around 1024.
-#max_connections -1
-
-# The listener can be restricted to operating within a topic hierarchy using
-# the mount_point option. This is achieved be prefixing the mount_point string
-# to all topics for any clients connected to this listener. This prefixing only
-# happens internally to the broker; the client will not see the prefix.
-#mount_point
-
-# Choose the protocol to use when listening.
-# This can be either mqtt or websockets.
-# Certificate based TLS may be used with websockets, except that only the
-# cafile, certfile, keyfile, ciphers, and ciphers_tls13 options are supported.
-#protocol mqtt
-listener 1883
-protocol mqtt
-
-listener 9001
-protocol websockets
-
-# Set use_username_as_clientid to true to replace the clientid that a client
-# connected with with its username. This allows authentication to be tied to
-# the clientid, which means that it is possible to prevent one client
-# disconnecting another by using the same clientid.
-# If a client connects with no username it will be disconnected as not
-# authorised when this option is set to true.
-# Do not use in conjunction with clientid_prefixes.
-# See also use_identity_as_username.
-#use_username_as_clientid
-
-# Change the websockets headers size. This is a global option, it is not
-# possible to set per listener. This option sets the size of the buffer used in
-# the libwebsockets library when reading HTTP headers. If you are passing large
-# header data such as cookies then you may need to increase this value. If left
-# unset, or set to 0, then the default of 1024 bytes will be used.
-#websockets_headers_size
-
-# -----------------------------------------------------------------
-# Certificate based SSL/TLS support
-# -----------------------------------------------------------------
-# The following options can be used to enable certificate based SSL/TLS support
-# for this listener. Note that the recommended port for MQTT over TLS is 8883,
-# but this must be set manually.
-#
-# See also the mosquitto-tls man page and the "Pre-shared-key based SSL/TLS
-# support" section. Only one of certificate or PSK encryption support can be
-# enabled for any listener.
-
-# Both of certfile and keyfile must be defined to enable certificate based
-# TLS encryption.
-
-# Path to the PEM encoded server certificate.
-#certfile
-
-# Path to the PEM encoded keyfile.
-#keyfile
-
-# If you wish to control which encryption ciphers are used, use the ciphers
-# option. The list of available ciphers can be optained using the "openssl
-# ciphers" command and should be provided in the same format as the output of
-# that command. This applies to TLS 1.2 and earlier versions only. Use
-# ciphers_tls1.3 for TLS v1.3.
-#ciphers
-
-# Choose which TLS v1.3 ciphersuites are used for this listener.
-# Defaults to "TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256"
-#ciphers_tls1.3
-
-# If you have require_certificate set to true, you can create a certificate
-# revocation list file to revoke access to particular client certificates. If
-# you have done this, use crlfile to point to the PEM encoded revocation file.
-#crlfile
-
-# To allow the use of ephemeral DH key exchange, which provides forward
-# security, the listener must load DH parameters. This can be specified with
-# the dhparamfile option. The dhparamfile can be generated with the command
-# e.g. "openssl dhparam -out dhparam.pem 2048"
-#dhparamfile
-
-# By default an TLS enabled listener will operate in a similar fashion to a
-# https enabled web server, in that the server has a certificate signed by a CA
-# and the client will verify that it is a trusted certificate. The overall aim
-# is encryption of the network traffic. By setting require_certificate to true,
-# the client must provide a valid certificate in order for the network
-# connection to proceed. This allows access to the broker to be controlled
-# outside of the mechanisms provided by MQTT.
-#require_certificate false
-
-# cafile and capath define methods of accessing the PEM encoded
-# Certificate Authority certificates that will be considered trusted when
-# checking incoming client certificates.
-# cafile defines the path to a file containing the CA certificates.
-# capath defines a directory that will be searched for files
-# containing the CA certificates. For capath to work correctly, the
-# certificate files must have ".crt" as the file ending and you must run
-# "openssl rehash <path to capath>" each time you add/remove a certificate.
-#cafile
-#capath
-
-
-# If require_certificate is true, you may set use_identity_as_username to true
-# to use the CN value from the client certificate as a username. If this is
-# true, the password_file option will not be used for this listener.
-#use_identity_as_username false
-
-# -----------------------------------------------------------------
-# Pre-shared-key based SSL/TLS support
-# -----------------------------------------------------------------
-# The following options can be used to enable PSK based SSL/TLS support for
-# this listener. Note that the recommended port for MQTT over TLS is 8883, but
-# this must be set manually.
-#
-# See also the mosquitto-tls man page and the "Certificate based SSL/TLS
-# support" section. Only one of certificate or PSK encryption support can be
-# enabled for any listener.
-
-# The psk_hint option enables pre-shared-key support for this listener and also
-# acts as an identifier for this listener. The hint is sent to clients and may
-# be used locally to aid authentication. The hint is a free form string that
-# doesn't have much meaning in itself, so feel free to be creative.
-# If this option is provided, see psk_file to define the pre-shared keys to be
-# used or create a security plugin to handle them.
-#psk_hint
-
-# When using PSK, the encryption ciphers used will be chosen from the list of
-# available PSK ciphers. If you want to control which ciphers are available,
-# use the "ciphers" option.  The list of available ciphers can be optained
-# using the "openssl ciphers" command and should be provided in the same format
-# as the output of that command.
-#ciphers
-
-# Set use_identity_as_username to have the psk identity sent by the client used
-# as its username. Authentication will be carried out using the PSK rather than
-# the MQTT username/password and so password_file will not be used for this
-# listener.
-#use_identity_as_username false
-
-
-# =================================================================
-# Persistence
-# =================================================================
-
-# If persistence is enabled, save the in-memory database to disk
-# every autosave_interval seconds. If set to 0, the persistence
-# database will only be written when mosquitto exits. See also
-# autosave_on_changes.
-# Note that writing of the persistence database can be forced by
-# sending mosquitto a SIGUSR1 signal.
-#autosave_interval 1800
-
-# If true, mosquitto will count the number of subscription changes, retained
-# messages received and queued messages and if the total exceeds
-# autosave_interval then the in-memory database will be saved to disk.
-# If false, mosquitto will save the in-memory database to disk by treating
-# autosave_interval as a time in seconds.
-#autosave_on_changes false
-
-# Save persistent message data to disk (true/false).
-# This saves information about all messages, including
-# subscriptions, currently in-flight messages and retained
-# messages.
-# retained_persistence is a synonym for this option.
-#persistence false
-
-# The filename to use for the persistent database, not including
-# the path.
-#persistence_file mosquitto.db
-
-# Location for persistent database.
-# Default is an empty string (current directory).
-# Set to e.g. /var/lib/mosquitto if running as a proper service on Linux or
-# similar.
-#persistence_location
-
-
-# =================================================================
-# Logging
-# =================================================================
-
-# Places to log to. Use multiple log_dest lines for multiple
-# logging destinations.
-# Possible destinations are: stdout stderr syslog topic file dlt
-#
-# stdout and stderr log to the console on the named output.
-#
-# syslog uses the userspace syslog facility which usually ends up
-# in /var/log/messages or similar.
-#
-# topic logs to the broker topic '$SYS/broker/log/<severity>',
-# where severity is one of D, E, W, N, I, M which are debug, error,
-# warning, notice, information and message. Message type severity is used by
-# the subscribe/unsubscribe log_types and publishes log messages to
-# $SYS/broker/log/M/susbcribe or $SYS/broker/log/M/unsubscribe.
-#
-# The file destination requires an additional parameter which is the file to be
-# logged to, e.g. "log_dest file /var/log/mosquitto.log". The file will be
-# closed and reopened when the broker receives a HUP signal. Only a single file
-# destination may be configured.
-#
-# The dlt destination is for the automotive `Diagnostic Log and Trace` tool.
-# This requires that Mosquitto has been compiled with DLT support.
-#
-# Note that if the broker is running as a Windows service it will default to
-# "log_dest none" and neither stdout nor stderr logging is available.
-# Use "log_dest none" if you wish to disable logging.
-#log_dest stderr
-
-# Types of messages to log. Use multiple log_type lines for logging
-# multiple types of messages.
-# Possible types are: debug, error, warning, notice, information,
-# none, subscribe, unsubscribe, websockets, all.
-# Note that debug type messages are for decoding the incoming/outgoing
-# network packets. They are not logged in "topics".
-#log_type error
-#log_type warning
-#log_type notice
-#log_type information
-
-
-# If set to true, client connection and disconnection messages will be included
-# in the log.
-#connection_messages true
-
-# If using syslog logging (not on Windows), messages will be logged to the
-# "daemon" facility by default. Use the log_facility option to choose which of
-# local0 to local7 to log to instead. The option value should be an integer
-# value, e.g. "log_facility 5" to use local5.
-#log_facility
-
-# If set to true, add a timestamp value to each log message.
-#log_timestamp true
-
-# Set the format of the log timestamp. If left unset, this is the number of
-# seconds since the Unix epoch.
-# This is a free text string which will be passed to the strftime function. To
-# get an ISO 8601 datetime, for example:
-# log_timestamp_format %Y-%m-%dT%H:%M:%S
-#log_timestamp_format
-
-# Change the websockets logging level. This is a global option, it is not
-# possible to set per listener. This is an integer that is interpreted by
-# libwebsockets as a bit mask for its lws_log_levels enum. See the
-# libwebsockets documentation for more details. "log_type websockets" must also
-# be enabled.
-#websockets_log_level 0
-
-
-# =================================================================
-# Security
-# =================================================================
-
-# If set, only clients that have a matching prefix on their
-# clientid will be allowed to connect to the broker. By default,
-# all clients may connect.
-# For example, setting "secure-" here would mean a client "secure-
-# client" could connect but another with clientid "mqtt" couldn't.
-#clientid_prefixes
-
-# Boolean value that determines whether clients that connect
-# without providing a username are allowed to connect. If set to
-# false then a password file should be created (see the
-# password_file option) to control authenticated client access.
-#
-# Defaults to false, unless there are no listeners defined in the configuration
-# file, in which case it is set to true, but connections are only allowed from
-# the local machine.
-allow_anonymous true
-
-# -----------------------------------------------------------------
-# Default authentication and topic access control
-# -----------------------------------------------------------------
-
-# Control access to the broker using a password file. This file can be
-# generated using the mosquitto_passwd utility. If TLS support is not compiled
-# into mosquitto (it is recommended that TLS support should be included) then
-# plain text passwords are used, in which case the file should be a text file
-# with lines in the format:
-# username:password
-# The password (and colon) may be omitted if desired, although this
-# offers very little in the way of security.
-#
-# See the TLS client require_certificate and use_identity_as_username options
-# for alternative authentication options. If a plugin is used as well as
-# password_file, the plugin check will be made first.
-#password_file
-
-# Access may also be controlled using a pre-shared-key file. This requires
-# TLS-PSK support and a listener configured to use it. The file should be text
-# lines in the format:
-# identity:key
-# The key should be in hexadecimal format without a leading "0x".
-# If an plugin is used as well, the plugin check will be made first.
-#psk_file
-
-# Control access to topics on the broker using an access control list
-# file. If this parameter is defined then only the topics listed will
-# have access.
-# If the first character of a line of the ACL file is a # it is treated as a
-# comment.
-# Topic access is added with lines of the format:
-#
-# topic [read|write|readwrite|deny] <topic>
-#
-# The access type is controlled using "read", "write", "readwrite" or "deny".
-# This parameter is optional (unless <topic> contains a space character) - if
-# not given then the access is read/write.  <topic> can contain the + or #
-# wildcards as in subscriptions.
-#
-# The "deny" option can used to explicity deny access to a topic that would
-# otherwise be granted by a broader read/write/readwrite statement. Any "deny"
-# topics are handled before topics that grant read/write access.
-#
-# The first set of topics are applied to anonymous clients, assuming
-# allow_anonymous is true. User specific topic ACLs are added after a
-# user line as follows:
-#
-# user <username>
-#
-# The username referred to here is the same as in password_file. It is
-# not the clientid.
-#
-#
-# If is also possible to define ACLs based on pattern substitution within the
-# topic. The patterns available for substition are:
-#
-# %c to match the client id of the client
-# %u to match the username of the client
-#
-# The substitution pattern must be the only text for that level of hierarchy.
-#
-# The form is the same as for the topic keyword, but using pattern as the
-# keyword.
-# Pattern ACLs apply to all users even if the "user" keyword has previously
-# been given.
-#
-# If using bridges with usernames and ACLs, connection messages can be allowed
-# with the following pattern:
-# pattern write $SYS/broker/connection/%c/state
-#
-# pattern [read|write|readwrite] <topic>
-#
-# Example:
-#
-# pattern write sensor/%u/data
-#
-# If an plugin is used as well as acl_file, the plugin check will be
-# made first.
-#acl_file
-
-# -----------------------------------------------------------------
-# External authentication and topic access plugin options
-# -----------------------------------------------------------------
-
-# External authentication and access control can be supported with the
-# plugin option. This is a path to a loadable plugin. See also the
-# plugin_opt_* options described below.
-#
-# The plugin option can be specified multiple times to load multiple
-# plugins. The plugins will be processed in the order that they are specified
-# here. If the plugin option is specified alongside either of
-# password_file or acl_file then the plugin checks will be made first.
-#
-# If the per_listener_settings option is false, the plugin will be apply to all
-# listeners. If per_listener_settings is true, then the plugin will apply to
-# the current listener being defined only.
-#
-# This option is also available as `auth_plugin`, but this use is deprecated
-# and will be removed in the future.
-#
-#plugin
-
-# If the plugin option above is used, define options to pass to the
-# plugin here as described by the plugin instructions. All options named
-# using the format plugin_opt_* will be passed to the plugin, for example:
-#
-# This option is also available as `auth_opt_*`, but this use is deprecated
-# and will be removed in the future.
-#
-# plugin_opt_db_host
-# plugin_opt_db_port
-# plugin_opt_db_username
-# plugin_opt_db_password
-
-
-# =================================================================
-# Bridges
-# =================================================================
-
-# A bridge is a way of connecting multiple MQTT brokers together.
-# Create a new bridge using the "connection" option as described below. Set
-# options for the bridges using the remaining parameters. You must specify the
-# address and at least one topic to subscribe to.
-#
-# Each connection must have a unique name.
-#
-# The address line may have multiple host address and ports specified. See
-# below in the round_robin description for more details on bridge behaviour if
-# multiple addresses are used. Note that if you use an IPv6 address, then you
-# are required to specify a port.
-#
-# The direction that the topic will be shared can be chosen by
-# specifying out, in or both, where the default value is out.
-# The QoS level of the bridged communication can be specified with the next
-# topic option. The default QoS level is 0, to change the QoS the topic
-# direction must also be given.
-#
-# The local and remote prefix options allow a topic to be remapped when it is
-# bridged to/from the remote broker. This provides the ability to place a topic
-# tree in an appropriate location.
-#
-# For more details see the mosquitto.conf man page.
-#
-# Multiple topics can be specified per connection, but be careful
-# not to create any loops.
-#
-# If you are using bridges with cleansession set to false (the default), then
-# you may get unexpected behaviour from incoming topics if you change what
-# topics you are subscribing to. This is because the remote broker keeps the
-# subscription for the old topic. If you have this problem, connect your bridge
-# with cleansession set to true, then reconnect with cleansession set to false
-# as normal.
-#connection <name>
-#address <host>[:<port>] [<host>[:<port>]]
-#topic <topic> [[[out | in | both] qos-level] local-prefix remote-prefix]
-
-# If you need to have the bridge connect over a particular network interface,
-# use bridge_bind_address to tell the bridge which local IP address the socket
-# should bind to, e.g. `bridge_bind_address 192.168.1.10`
-#bridge_bind_address
-
-# If a bridge has topics that have "out" direction, the default behaviour is to
-# send an unsubscribe request to the remote broker on that topic. This means
-# that changing a topic direction from "in" to "out" will not keep receiving
-# incoming messages. Sending these unsubscribe requests is not always
-# desirable, setting bridge_attempt_unsubscribe to false will disable sending
-# the unsubscribe request.
-#bridge_attempt_unsubscribe true
-
-# Set the version of the MQTT protocol to use with for this bridge. Can be one
-# of mqttv50, mqttv311 or mqttv31. Defaults to mqttv311.
-#bridge_protocol_version mqttv311
-
-# Set the clean session variable for this bridge.
-# When set to true, when the bridge disconnects for any reason, all
-# messages and subscriptions will be cleaned up on the remote
-# broker. Note that with cleansession set to true, there may be a
-# significant amount of retained messages sent when the bridge
-# reconnects after losing its connection.
-# When set to false, the subscriptions and messages are kept on the
-# remote broker, and delivered when the bridge reconnects.
-#cleansession false
-
-# Set the amount of time a bridge using the lazy start type must be idle before
-# it will be stopped. Defaults to 60 seconds.
-#idle_timeout 60
-
-# Set the keepalive interval for this bridge connection, in
-# seconds.
-#keepalive_interval 60
-
-# Set the clientid to use on the local broker. If not defined, this defaults to
-# 'local.<clientid>'. If you are bridging a broker to itself, it is important
-# that local_clientid and clientid do not match.
-#local_clientid
-
-# If set to true, publish notification messages to the local and remote brokers
-# giving information about the state of the bridge connection. Retained
-# messages are published to the topic $SYS/broker/connection/<clientid>/state
-# unless the notification_topic option is used.
-# If the message is 1 then the connection is active, or 0 if the connection has
-# failed.
-# This uses the last will and testament feature.
-#notifications true
-
-# Choose the topic on which notification messages for this bridge are
-# published. If not set, messages are published on the topic
-# $SYS/broker/connection/<clientid>/state
-#notification_topic
-
-# Set the client id to use on the remote end of this bridge connection. If not
-# defined, this defaults to 'name.hostname' where name is the connection name
-# and hostname is the hostname of this computer.
-# This replaces the old "clientid" option to avoid confusion. "clientid"
-# remains valid for the time being.
-#remote_clientid
-
-# Set the password to use when connecting to a broker that requires
-# authentication. This option is only used if remote_username is also set.
-# This replaces the old "password" option to avoid confusion. "password"
-# remains valid for the time being.
-#remote_password
-
-# Set the username to use when connecting to a broker that requires
-# authentication.
-# This replaces the old "username" option to avoid confusion. "username"
-# remains valid for the time being.
-#remote_username
-
-# Set the amount of time a bridge using the automatic start type will wait
-# until attempting to reconnect.
-# This option can be configured to use a constant delay time in seconds, or to
-# use a backoff mechanism based on "Decorrelated Jitter", which adds a degree
-# of randomness to when the restart occurs.
-#
-# Set a constant timeout of 20 seconds:
-# restart_timeout 20
-#
-# Set backoff with a base (start value) of 10 seconds and a cap (upper limit) of
-# 60 seconds:
-# restart_timeout 10 30
-#
-# Defaults to jitter with a base of 5 and cap of 30
-#restart_timeout 5 30
-
-# If the bridge has more than one address given in the address/addresses
-# configuration, the round_robin option defines the behaviour of the bridge on
-# a failure of the bridge connection. If round_robin is false, the default
-# value, then the first address is treated as the main bridge connection. If
-# the connection fails, the other secondary addresses will be attempted in
-# turn. Whilst connected to a secondary bridge, the bridge will periodically
-# attempt to reconnect to the main bridge until successful.
-# If round_robin is true, then all addresses are treated as equals. If a
-# connection fails, the next address will be tried and if successful will
-# remain connected until it fails
-#round_robin false
-
-# Set the start type of the bridge. This controls how the bridge starts and
-# can be one of three types: automatic, lazy and once. Note that RSMB provides
-# a fourth start type "manual" which isn't currently supported by mosquitto.
-#
-# "automatic" is the default start type and means that the bridge connection
-# will be started automatically when the broker starts and also restarted
-# after a short delay (30 seconds) if the connection fails.
-#
-# Bridges using the "lazy" start type will be started automatically when the
-# number of queued messages exceeds the number set with the "threshold"
-# parameter. It will be stopped automatically after the time set by the
-# "idle_timeout" parameter. Use this start type if you wish the connection to
-# only be active when it is needed.
-#
-# A bridge using the "once" start type will be started automatically when the
-# broker starts but will not be restarted if the connection fails.
-#start_type automatic
-
-# Set the number of messages that need to be queued for a bridge with lazy
-# start type to be restarted. Defaults to 10 messages.
-# Must be less than max_queued_messages.
-#threshold 10
-
-# If try_private is set to true, the bridge will attempt to indicate to the
-# remote broker that it is a bridge not an ordinary client. If successful, this
-# means that loop detection will be more effective and that retained messages
-# will be propagated correctly. Not all brokers support this feature so it may
-# be necessary to set try_private to false if your bridge does not connect
-# properly.
-#try_private true
-
-# Some MQTT brokers do not allow retained messages. MQTT v5 gives a mechanism
-# for brokers to tell clients that they do not support retained messages, but
-# this is not possible for MQTT v3.1.1 or v3.1. If you need to bridge to a
-# v3.1.1 or v3.1 broker that does not support retained messages, set the
-# bridge_outgoing_retain option to false. This will remove the retain bit on
-# all outgoing messages to that bridge, regardless of any other setting.
-#bridge_outgoing_retain true
-
-# If you wish to restrict the size of messages sent to a remote bridge, use the
-# bridge_max_packet_size option. This sets the maximum number of bytes for
-# the total message, including headers and payload.
-# Note that MQTT v5 brokers may provide their own maximum-packet-size property.
-# In this case, the smaller of the two limits will be used.
-# Set to 0 for "unlimited".
-#bridge_max_packet_size 0
-
-
-# -----------------------------------------------------------------
-# Certificate based SSL/TLS support
-# -----------------------------------------------------------------
-# Either bridge_cafile or bridge_capath must be defined to enable TLS support
-# for this bridge.
-# bridge_cafile defines the path to a file containing the
-# Certificate Authority certificates that have signed the remote broker
-# certificate.
-# bridge_capath defines a directory that will be searched for files containing
-# the CA certificates. For bridge_capath to work correctly, the certificate
-# files must have ".crt" as the file ending and you must run "openssl rehash
-# <path to capath>" each time you add/remove a certificate.
-#bridge_cafile
-#bridge_capath
-
-
-# If the remote broker has more than one protocol available on its port, e.g.
-# MQTT and WebSockets, then use bridge_alpn to configure which protocol is
-# requested. Note that WebSockets support for bridges is not yet available.
-#bridge_alpn
-
-# When using certificate based encryption, bridge_insecure disables
-# verification of the server hostname in the server certificate. This can be
-# useful when testing initial server configurations, but makes it possible for
-# a malicious third party to impersonate your server through DNS spoofing, for
-# example. Use this option in testing only. If you need to resort to using this
-# option in a production environment, your setup is at fault and there is no
-# point using encryption.
-#bridge_insecure false
-
-# Path to the PEM encoded client certificate, if required by the remote broker.
-#bridge_certfile
-
-# Path to the PEM encoded client private key, if required by the remote broker.
-#bridge_keyfile
-
-# -----------------------------------------------------------------
-# PSK based SSL/TLS support
-# -----------------------------------------------------------------
-# Pre-shared-key encryption provides an alternative to certificate based
-# encryption. A bridge can be configured to use PSK with the bridge_identity
-# and bridge_psk options. These are the client PSK identity, and pre-shared-key
-# in hexadecimal format with no "0x". Only one of certificate and PSK based
-# encryption can be used on one
-# bridge at once.
-#bridge_identity
-#bridge_psk
-
-
-# =================================================================
-# External config files
-# =================================================================
-
-# External configuration files may be included by using the
-# include_dir option. This defines a directory that will be searched
-# for config files. All files that end in '.conf' will be loaded as
-# a configuration file. It is best to have this as the last option
-# in the main file. This option will only be processed from the main
-# configuration file. The directory specified must not contain the
-# main configuration file.
-# Files within include_dir will be loaded sorted in case-sensitive
-# alphabetical order, with capital letters ordered first. If this option is
-# given multiple times, all of the files from the first instance will be
-# processed before the next instance. See the man page for examples.
-#include_dir
diff --git a/integration/nest-application/global-prefix/src/app.controller.ts b/integration/nest-application/global-prefix/src/app.controller.ts
index 912c0d76c..8d1472a2f 100644
--- a/integration/nest-application/global-prefix/src/app.controller.ts
+++ b/integration/nest-application/global-prefix/src/app.controller.ts
@@ -1,10 +1,10 @@
-import { Controller, Get, Post, Req } from '@nestjs/common';
+import { Controller, Get, Post } from '@nestjs/common';
 
 @Controller()
 export class AppController {
   @Get('hello/:name')
-  getHello(@Req() req): string {
-    return 'Hello: ' + req.extras?.data;
+  getHello(): string {
+    return 'hello';
   }
 
   @Get('health')
diff --git a/integration/nest-application/global-prefix/src/app.module.ts b/integration/nest-application/global-prefix/src/app.module.ts
index 85d1e6ac4..2123145a8 100644
--- a/integration/nest-application/global-prefix/src/app.module.ts
+++ b/integration/nest-application/global-prefix/src/app.module.ts
@@ -17,11 +17,6 @@ export class AppModule {
       .apply((req, res, next) => res.end(MIDDLEWARE_PARAM_VALUE))
       .forRoutes({ path: MIDDLEWARE_VALUE + '/*', method: RequestMethod.GET })
       .apply((req, res, next) => res.status(201).end(MIDDLEWARE_PARAM_VALUE))
-      .forRoutes({ path: MIDDLEWARE_VALUE + '/*', method: RequestMethod.POST })
-      .apply((req, res, next) => {
-        req.extras = { data: 'Data attached in middleware' };
-        next();
-      })
-      .forRoutes({ path: '*', method: RequestMethod.GET });
+      .forRoutes({ path: MIDDLEWARE_VALUE + '/*', method: RequestMethod.POST });
   }
 }
diff --git a/integration/send-files/src/app.service.ts b/integration/send-files/src/app.service.ts
index ba5849a75..a83e6a4f6 100644
--- a/integration/send-files/src/app.service.ts
+++ b/integration/send-files/src/app.service.ts
@@ -25,13 +25,11 @@ export class AppService {
   }
 
   getFileWithHeaders(): StreamableFile {
-    const file = readFileSync(join(process.cwd(), 'Readme.md'));
     return new StreamableFile(
       createReadStream(join(process.cwd(), 'Readme.md')),
       {
         type: 'text/markdown',
         disposition: 'attachment; filename="Readme.md"',
-        length: file.byteLength,
       },
     );
   }
diff --git a/lerna.json b/lerna.json
index 8285b0f66..e12b9c5dc 100644
--- a/lerna.json
+++ b/lerna.json
@@ -3,5 +3,5 @@
   "packages": [
     "packages/*"
   ],
-  "version": "8.4.5"
+  "version": "8.3.1"
 }
diff --git a/package-lock.json b/package-lock.json
index 4f7c42bb1..ddc34f406 100644
Binary files a/package-lock.json and b/package-lock.json differ
diff --git a/package.json b/package.json
index 859433b2a..20fb80e7c 100644
--- a/package.json
+++ b/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/core",
-  "version": "8.4.4",
+  "version": "8.3.1",
   "description": "Modern, fast, powerful node.js web framework",
   "homepage": "https://nestjs.com",
   "repository": {
@@ -25,8 +25,8 @@
     "coverage": "nyc report --reporter=text-lcov | coveralls",
     "format": "prettier \"**/*.ts\" --ignore-path ./.prettierignore --write && git status",
     "postinstall": "opencollective",
-    "test": "nyc mocha packages/**/*.spec.ts --reporter spec",
-    "test:integration": "mocha \"integration/*/{,!(node_modules)/**/}/*.spec.ts\" --reporter spec",
+    "test": "nyc --require ts-node/register mocha packages/**/*.spec.ts --reporter spec --require 'node_modules/reflect-metadata/Reflect.js' --exit",
+    "test:integration": "mocha \"integration/*/{,!(node_modules)/**/}/*.spec.ts\" --reporter spec --require ts-node/register --require 'node_modules/reflect-metadata/Reflect.js' --exit",
     "test:docker:up": "docker-compose -f integration/docker-compose.yml up -d",
     "test:docker:down": "docker-compose -f integration/docker-compose.yml down",
     "lint": "concurrently 'npm run lint:packages' 'npm run lint:integration' 'npm run lint:spec'",
@@ -34,9 +34,8 @@
     "lint:integration": "eslint 'integration/*/{,!(node_modules)/**/}/*.ts' -c '.eslintrc.spec.js'",
     "lint:packages": "eslint 'packages/**/**.ts' --ignore-pattern 'packages/**/*.spec.ts'",
     "lint:spec": "eslint 'packages/**/**.spec.ts' -c '.eslintrc.spec.js'",
-    "prerelease": "gulp copy-misc && gulp build --dist node_modules/@nestjs",
+    "prerelease": "gulp copy-misc && gulp build --dist node_modules/@nestjs && npm run changelog | pbcopy",
     "publish": "npm run prerelease && npm run build:prod && ./node_modules/.bin/lerna publish --force-publish --access public --exact -m \"chore(@nestjs) publish %s release\"",
-    "prepublishOnly": "npm run changelog | pbcopy",
     "publish:beta": "npm run prerelease && npm run build:prod && ./node_modules/.bin/lerna publish --npm-tag=beta --access public -m \"chore(@nestjs) publish %s release\"",
     "publish:next": "npm run prerelease && npm run build:prod && ./node_modules/.bin/lerna publish --npm-tag=next --access public --skip-git -m \"chore(@nestjs) publish %s release\"",
     "publish:rc": "npm run prerelease && npm run build:prod && ./node_modules/.bin/lerna publish --npm-tag=rc --access public -m \"chore(@nestjs) publish %s release\"",
@@ -50,84 +49,83 @@
   },
   "dependencies": {
     "@nuxtjs/opencollective": "0.3.2",
-    "axios": "0.27.2",
+    "axios": "0.26.0",
     "class-transformer": "0.5.1",
     "class-validator": "0.13.2",
-    "cli-color": "2.0.2",
+    "cli-color": "2.0.1",
     "cors": "2.8.5",
-    "express": "4.18.1",
-    "fast-json-stringify": "3.2.0",
+    "express": "4.17.3",
+    "fast-json-stringify": "3.0.3",
     "fast-safe-stringify": "2.1.1",
     "graphql-subscriptions": "2.0.0",
     "iterare": "1.2.1",
-    "object-hash": "3.0.0",
+    "object-hash": "2.2.0",
     "path-to-regexp": "3.2.0",
     "reflect-metadata": "0.1.13",
-    "rxjs": "7.5.5",
-    "socket.io": "4.5.0",
-    "tslib": "2.4.0",
+    "rxjs": "7.5.4",
+    "socket.io": "4.4.1",
+    "tslib": "2.3.1",
     "uuid": "8.3.2"
   },
   "devDependencies": {
     "@codechecks/client": "0.1.12",
-    "@commitlint/cli": "17.0.0",
-    "@commitlint/config-angular": "17.0.0",
-    "@grpc/grpc-js": "1.6.7",
-    "@grpc/proto-loader": "0.6.12",
-    "@nestjs/apollo": "10.0.11",
-    "@nestjs/graphql": "10.0.8",
-    "@nestjs/mongoose": "9.0.3",
+    "@commitlint/cli": "16.2.1",
+    "@commitlint/config-angular": "16.2.1",
+    "@grpc/grpc-js": "1.5.5",
+    "@grpc/proto-loader": "0.6.9",
+    "@nestjs/apollo": "10.0.3",
+    "@nestjs/graphql": "10.0.3",
+    "@nestjs/mongoose": "9.0.2",
     "@nestjs/typeorm": "8.0.3",
     "@types/amqplib": "0.8.2",
     "@types/bytes": "3.1.1",
-    "@types/cache-manager": "3.4.3",
-    "@types/chai": "4.3.1",
+    "@types/cache-manager": "3.4.2",
+    "@types/chai": "4.3.0",
     "@types/chai-as-promised": "7.1.5",
     "@types/cors": "2.8.12",
     "@types/express": "4.17.13",
     "@types/gulp": "4.0.9",
     "@types/http-errors": "1.8.2",
-    "@types/mocha": "9.1.1",
-    "@types/node": "17.0.34",
+    "@types/mocha": "9.1.0",
+    "@types/node": "17.0.18",
     "@types/redis": "4.0.11",
     "@types/reflect-metadata": "0.1.0",
     "@types/sinon": "10.0.11",
     "@types/socket.io": "3.0.2",
-    "@types/supertest": "2.0.12",
-    "@types/ws": "8.5.3",
+    "@types/ws": "8.2.2",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
-    "amqp-connection-manager": "4.1.3",
-    "amqplib": "0.9.0",
-    "apollo-server-core": "3.7.0",
-    "apollo-server-express": "3.7.0",
+    "amqp-connection-manager": "4.1.1",
+    "amqplib": "0.8.0",
+    "apollo-server-core": "3.6.3",
+    "apollo-server-express": "3.6.3",
     "artillery": "1.7.9",
-    "body-parser": "1.20.0",
+    "body-parser": "1.19.2",
     "bytes": "3.1.2",
-    "cache-manager": "3.6.1",
+    "cache-manager": "3.6.0",
     "cache-manager-redis-store": "2.0.0",
     "chai": "4.3.6",
     "chai-as-promised": "7.1.1",
-    "clang-format": "1.8.0",
+    "clang-format": "1.6.0",
     "commitlint-circle": "1.0.0",
-    "concurrently": "7.2.0",
+    "concurrently": "7.0.0",
     "conventional-changelog": "3.1.25",
-    "core-js": "3.22.5",
+    "core-js": "3.21.1",
     "coveralls": "3.1.1",
     "delete-empty": "3.0.0",
-    "engine.io-client": "6.2.2",
+    "engine.io-client": "6.1.1",
     "eslint": "7.32.0",
-    "eslint-config-prettier": "8.5.0",
-    "eslint-plugin-import": "2.26.0",
-    "eventsource": "2.0.2",
+    "eslint-config-prettier": "8.3.0",
+    "eslint-plugin-import": "2.25.4",
+    "eventsource": "1.1.0",
     "fancy-log": "2.0.0",
-    "fastify": "3.29.0",
-    "fastify-cors": "6.1.0",
-    "fastify-formbody": "5.3.0",
-    "fastify-multipart": "5.4.0",
-    "fastify-static": "4.7.0",
-    "graphql": "15.8.0",
-    "graphql-tools": "8.2.9",
+    "fastify": "3.27.1",
+    "fastify-cors": "6.0.2",
+    "fastify-formbody": "5.2.0",
+    "fastify-multipart": "5.3.1",
+    "fastify-static": "4.5.0",
+    "graphql": "15.7.2",
+    "graphql-tools": "7.0.5",
     "gulp": "4.0.2",
     "gulp-clang-format": "1.0.27",
     "gulp-clean": "0.4.0",
@@ -135,40 +133,40 @@
     "gulp-typescript": "5.0.1",
     "gulp-watch": "5.0.1",
     "http-errors": "2.0.0",
-    "husky": "8.0.1",
+    "husky": "7.0.4",
     "imports-loader": "3.1.1",
     "json-loader": "0.5.7",
-    "kafkajs": "2.0.0",
-    "lerna": "3.0.0",
+    "kafkajs": "1.16.0",
+    "lerna": "2.11.0",
     "lerna-changelog": "2.2.0",
-    "light-my-request": "4.10.1",
-    "lint-staged": "12.4.1",
+    "light-my-request": "4.8.0",
+    "lint-staged": "12.3.4",
     "markdown-table": "2.0.0",
     "merge-graphql-schemas": "1.7.8",
-    "middie": "6.1.0",
-    "mocha": "9.2.2",
-    "mongoose": "6.3.3",
-    "mqtt": "4.3.7",
+    "middie": "6.0.0",
+    "mocha": "9.2.0",
+    "mongoose": "6.2.2",
+    "mqtt": "4.3.6",
     "multer": "1.4.4",
     "mysql2": "2.3.3",
     "nats": "2.6.1",
-    "nodemon": "2.0.16",
+    "nodemon": "2.0.15",
     "nyc": "15.1.0",
-    "point-of-view": "5.3.0",
-    "prettier": "2.6.2",
+    "point-of-view": "5.1.0",
+    "prettier": "2.5.1",
     "redis": "3.1.2",
     "rxjs-compat": "6.6.7",
-    "sinon": "14.0.0",
+    "sinon": "13.0.1",
     "sinon-chai": "3.7.0",
-    "socket.io-client": "4.5.0",
+    "socket.io-client": "4.4.1",
     "subscriptions-transport-ws": "0.11.0",
-    "supertest": "6.2.3",
-    "ts-morph": "14.0.0",
-    "ts-node": "10.7.0",
-    "typeorm": "0.2.45",
-    "typescript": "4.6.4",
+    "supertest": "6.2.2",
+    "ts-morph": "13.0.3",
+    "ts-node": "10.5.0",
+    "typeorm": "0.2.43",
+    "typescript": "4.3.5",
     "wrk": "1.2.1",
-    "ws": "8.6.0"
+    "ws": "7.5.6"
   },
   "engines": {
     "node": ">= 10.13.0"
@@ -225,13 +223,5 @@
     ],
     "sourceMap": true,
     "instrument": true
-  },
-  "mocha": {
-    "require": [
-      "ts-node/register",
-      "node_modules/reflect-metadata/Reflect.js",
-      "hooks/mocha-init-hook.ts"
-    ],
-    "exit": true
   }
 }
diff --git a/packages/common/Readme.md b/packages/common/Readme.md
index a5e43201d..772d0077a 100644
--- a/packages/common/Readme.md
+++ b/packages/common/Readme.md
@@ -54,7 +54,7 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
 <table style="text-align:center;"><tr>
@@ -64,20 +64,17 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
 <td>
 <a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
-    <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
 </tr></table>
 
 #### Gold Sponsors
 
 <table style="text-align:center;"><tr><td>
   <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="140" valign="middle" /></a></td>
+<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
+  <td>
+<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
 <td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td>
- <td>
-<a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
-<a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td></</tr></table>
+<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
diff --git a/packages/common/cache/cache.constants.ts b/packages/common/cache/cache.constants.ts
index 799547a7b..0ecf5c94e 100644
--- a/packages/common/cache/cache.constants.ts
+++ b/packages/common/cache/cache.constants.ts
@@ -1,3 +1,4 @@
 export const CACHE_MANAGER = 'CACHE_MANAGER';
+export const CACHE_MODULE_OPTIONS = 'CACHE_MODULE_OPTIONS';
 export const CACHE_KEY_METADATA = 'cache_module:cache_key';
 export const CACHE_TTL_METADATA = 'cache_module:cache_ttl';
diff --git a/packages/common/cache/cache.module-definition.ts b/packages/common/cache/cache.module-definition.ts
deleted file mode 100644
index 25d74e986..000000000
--- a/packages/common/cache/cache.module-definition.ts
+++ /dev/null
@@ -1,12 +0,0 @@
-import { ConfigurableModuleBuilder } from '../module-utils';
-import {
-  CacheModuleOptions,
-  CacheOptionsFactory,
-} from './interfaces/cache-module.interface';
-
-export const { ConfigurableModuleClass, MODULE_OPTIONS_TOKEN } =
-  new ConfigurableModuleBuilder<CacheModuleOptions>({
-    moduleName: 'Cache',
-  })
-    .setFactoryMethodName('createCacheOptions' as keyof CacheOptionsFactory)
-    .build();
diff --git a/packages/common/cache/cache.module.ts b/packages/common/cache/cache.module.ts
index 992f98f03..4e2c63d48 100644
--- a/packages/common/cache/cache.module.ts
+++ b/packages/common/cache/cache.module.ts
@@ -1,11 +1,11 @@
 import { Module } from '../decorators';
-import { DynamicModule } from '../interfaces';
-import { CACHE_MANAGER } from './cache.constants';
-import { ConfigurableModuleClass } from './cache.module-definition';
+import { DynamicModule, Provider } from '../interfaces';
+import { CACHE_MANAGER, CACHE_MODULE_OPTIONS } from './cache.constants';
 import { createCacheManager } from './cache.providers';
 import {
   CacheModuleAsyncOptions,
   CacheModuleOptions,
+  CacheOptionsFactory,
 } from './interfaces/cache-module.interface';
 
 /**
@@ -19,7 +19,7 @@ import {
   providers: [createCacheManager()],
   exports: [CACHE_MANAGER],
 })
-export class CacheModule extends ConfigurableModuleClass {
+export class CacheModule {
   /**
    * Configure the cache manager statically.
    *
@@ -31,8 +31,9 @@ export class CacheModule extends ConfigurableModuleClass {
     options: CacheModuleOptions<StoreConfig> = {} as any,
   ): DynamicModule {
     return {
+      module: CacheModule,
       global: options.isGlobal,
-      ...super.register(options),
+      providers: [{ provide: CACHE_MODULE_OPTIONS, useValue: options }],
     };
   }
 
@@ -47,11 +48,47 @@ export class CacheModule extends ConfigurableModuleClass {
   static registerAsync<
     StoreConfig extends Record<any, any> = Record<string, any>,
   >(options: CacheModuleAsyncOptions<StoreConfig>): DynamicModule {
-    const moduleDefinition = super.registerAsync(options);
     return {
+      module: CacheModule,
       global: options.isGlobal,
-      ...moduleDefinition,
-      providers: moduleDefinition.providers.concat(options.extraProviders),
+      imports: options.imports,
+      providers: [
+        ...this.createAsyncProviders<StoreConfig>(options),
+        ...(options.extraProviders || []),
+      ],
+    };
+  }
+
+  private static createAsyncProviders<StoreConfig extends Record<any, any>>(
+    options: CacheModuleAsyncOptions<StoreConfig>,
+  ): Provider[] {
+    if (options.useExisting || options.useFactory) {
+      return [this.createAsyncOptionsProvider(options)];
+    }
+    return [
+      this.createAsyncOptionsProvider(options),
+      {
+        provide: options.useClass,
+        useClass: options.useClass,
+      },
+    ];
+  }
+
+  private static createAsyncOptionsProvider<
+    StoreConfig extends Record<any, any>,
+  >(options: CacheModuleAsyncOptions<StoreConfig>): Provider {
+    if (options.useFactory) {
+      return {
+        provide: CACHE_MODULE_OPTIONS,
+        useFactory: options.useFactory,
+        inject: options.inject || [],
+      };
+    }
+    return {
+      provide: CACHE_MODULE_OPTIONS,
+      useFactory: async (optionsFactory: CacheOptionsFactory<StoreConfig>) =>
+        optionsFactory.createCacheOptions(),
+      inject: [options.useExisting || options.useClass],
     };
   }
 }
diff --git a/packages/common/cache/cache.providers.ts b/packages/common/cache/cache.providers.ts
index 4aaacf0f5..2e6df398d 100644
--- a/packages/common/cache/cache.providers.ts
+++ b/packages/common/cache/cache.providers.ts
@@ -1,7 +1,6 @@
 import { Provider } from '../interfaces';
 import { loadPackage } from '../utils/load-package.util';
-import { CACHE_MANAGER } from './cache.constants';
-import { MODULE_OPTIONS_TOKEN } from './cache.module-definition';
+import { CACHE_MANAGER, CACHE_MODULE_OPTIONS } from './cache.constants';
 import { defaultCacheOptions } from './default-options';
 import { CacheManagerOptions } from './interfaces/cache-manager.interface';
 
@@ -32,6 +31,6 @@ export function createCacheManager(): Provider {
             ...(options || {}),
           });
     },
-    inject: [MODULE_OPTIONS_TOKEN],
+    inject: [CACHE_MODULE_OPTIONS],
   };
 }
diff --git a/packages/common/cache/interfaces/cache-module.interface.ts b/packages/common/cache/interfaces/cache-module.interface.ts
index a5fd220cc..5beb769c8 100644
--- a/packages/common/cache/interfaces/cache-module.interface.ts
+++ b/packages/common/cache/interfaces/cache-module.interface.ts
@@ -1,5 +1,4 @@
-import { Provider, Type } from '../../interfaces';
-import { ConfigurableModuleAsyncOptions } from '../../module-utils';
+import { ModuleMetadata, Provider, Type } from '../../interfaces';
 import { CacheManagerOptions } from './cache-manager.interface';
 
 export type CacheModuleOptions<
@@ -40,10 +39,7 @@ export interface CacheOptionsFactory<
  */
 export interface CacheModuleAsyncOptions<
   StoreConfig extends Record<any, any> = Record<string, any>,
-> extends ConfigurableModuleAsyncOptions<
-    CacheModuleOptions<StoreConfig>,
-    keyof CacheOptionsFactory
-  > {
+> extends Pick<ModuleMetadata, 'imports'> {
   /**
    * Injection token resolving to an existing provider. The provider must implement
    * the `CacheOptionsFactory` interface.
@@ -67,9 +63,6 @@ export interface CacheModuleAsyncOptions<
    * Dependencies that a Factory may inject.
    */
   inject?: any[];
-  /**
-   * Extra providers to be registered within a scope of this module.
-   */
   extraProviders?: Provider[];
   /**
    * If "true', register `CacheModule` as a global module.
diff --git a/packages/common/decorators/core/catch.decorator.ts b/packages/common/decorators/core/catch.decorator.ts
index cd3cdb161..fbf7fb698 100644
--- a/packages/common/decorators/core/catch.decorator.ts
+++ b/packages/common/decorators/core/catch.decorator.ts
@@ -1,5 +1,5 @@
 import { CATCH_WATERMARK, FILTER_CATCH_EXCEPTIONS } from '../../constants';
-import { Type, Abstract } from '../../interfaces';
+import { Type } from '../../interfaces';
 
 /**
  * Decorator that marks a class as a Nest exception filter. An exception filter
@@ -18,9 +18,7 @@ import { Type, Abstract } from '../../interfaces';
  *
  * @publicApi
  */
-export function Catch(
-  ...exceptions: Array<Type<any> | Abstract<any>>
-): ClassDecorator {
+export function Catch(...exceptions: Type<any>[]): ClassDecorator {
   return (target: object) => {
     Reflect.defineMetadata(CATCH_WATERMARK, true, target);
     Reflect.defineMetadata(FILTER_CATCH_EXCEPTIONS, exceptions, target);
diff --git a/packages/common/decorators/http/render.decorator.ts b/packages/common/decorators/http/render.decorator.ts
index 92d2f8d20..6e9f22a1c 100644
--- a/packages/common/decorators/http/render.decorator.ts
+++ b/packages/common/decorators/http/render.decorator.ts
@@ -7,7 +7,7 @@ import { RENDER_METADATA } from '../../constants';
  *
  * @param template name of the render engine template file
  *
- * @see [Model-View-Controller](https://docs.nestjs.com/techniques/mvc)
+ * @see [Model-View-Controller](https://docs.nestjs.com/techniques.mvc)
  *
  * @publicApi
  */
diff --git a/packages/common/enums/version-type.enum.ts b/packages/common/enums/version-type.enum.ts
index abe4c6416..981986e87 100644
--- a/packages/common/enums/version-type.enum.ts
+++ b/packages/common/enums/version-type.enum.ts
@@ -5,5 +5,4 @@ export enum VersioningType {
   URI,
   HEADER,
   MEDIA_TYPE,
-  CUSTOM,
 }
diff --git a/packages/common/exceptions/bad-gateway.exception.ts b/packages/common/exceptions/bad-gateway.exception.ts
index 83ae75507..78667996c 100644
--- a/packages/common/exceptions/bad-gateway.exception.ts
+++ b/packages/common/exceptions/bad-gateway.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Bad Gateway* type errors.
  *
- * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
+ * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/bad-request.exception.ts b/packages/common/exceptions/bad-request.exception.ts
index 3d93e229b..b5385d09c 100644
--- a/packages/common/exceptions/bad-request.exception.ts
+++ b/packages/common/exceptions/bad-request.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Bad Request* type errors.
  *
- * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
+ * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/conflict.exception.ts b/packages/common/exceptions/conflict.exception.ts
index 93322515e..d67cc30f4 100644
--- a/packages/common/exceptions/conflict.exception.ts
+++ b/packages/common/exceptions/conflict.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Conflict* type errors.
  *
- * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
+ * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/forbidden.exception.ts b/packages/common/exceptions/forbidden.exception.ts
index 2c10e7a2a..7c3ae92fb 100644
--- a/packages/common/exceptions/forbidden.exception.ts
+++ b/packages/common/exceptions/forbidden.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Forbidden* type errors.
  *
- * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
+ * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/gateway-timeout.exception.ts b/packages/common/exceptions/gateway-timeout.exception.ts
index e2d068518..2648ddfec 100644
--- a/packages/common/exceptions/gateway-timeout.exception.ts
+++ b/packages/common/exceptions/gateway-timeout.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Gateway Timeout* type errors.
  *
- * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
+ * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/gone.exception.ts b/packages/common/exceptions/gone.exception.ts
index f319fe558..48b141dfe 100644
--- a/packages/common/exceptions/gone.exception.ts
+++ b/packages/common/exceptions/gone.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Gone* type errors.
  *
- * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
+ * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/http-version-not-supported.exception.ts b/packages/common/exceptions/http-version-not-supported.exception.ts
index ded68714b..41b340291 100644
--- a/packages/common/exceptions/http-version-not-supported.exception.ts
+++ b/packages/common/exceptions/http-version-not-supported.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Http Version Not Supported* type errors.
  *
- * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
+ * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/http.exception.ts b/packages/common/exceptions/http.exception.ts
index 84ec9361b..e907834c8 100644
--- a/packages/common/exceptions/http.exception.ts
+++ b/packages/common/exceptions/http.exception.ts
@@ -4,7 +4,7 @@ import { isObject, isString } from '../utils/shared.utils';
  * Defines the base Nest HTTP exception, which is handled by the default
  * Exceptions Handler.
  *
- * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
+ * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/im-a-teapot.exception.ts b/packages/common/exceptions/im-a-teapot.exception.ts
index 4b345681e..db640cd90 100644
--- a/packages/common/exceptions/im-a-teapot.exception.ts
+++ b/packages/common/exceptions/im-a-teapot.exception.ts
@@ -7,7 +7,7 @@ import { HttpException } from './http.exception';
  * Any attempt to brew coffee with a teapot should result in the error code
  * "418 I'm a teapot". The resulting entity body MAY be short and stout.
  *
- * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
+ * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/internal-server-error.exception.ts b/packages/common/exceptions/internal-server-error.exception.ts
index 673a2e7a2..06a04d7d8 100644
--- a/packages/common/exceptions/internal-server-error.exception.ts
+++ b/packages/common/exceptions/internal-server-error.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Internal Server Error* type errors.
  *
- * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
+ * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/method-not-allowed.exception.ts b/packages/common/exceptions/method-not-allowed.exception.ts
index f44ad305b..df7666b00 100644
--- a/packages/common/exceptions/method-not-allowed.exception.ts
+++ b/packages/common/exceptions/method-not-allowed.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Method Not Allowed* type errors.
  *
- * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
+ * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/misdirected.exception.ts b/packages/common/exceptions/misdirected.exception.ts
index 5fa2f082c..11ae29bae 100644
--- a/packages/common/exceptions/misdirected.exception.ts
+++ b/packages/common/exceptions/misdirected.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Misdirected* type errors.
  *
- * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
+ * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/not-acceptable.exception.ts b/packages/common/exceptions/not-acceptable.exception.ts
index 18e71156c..e836d3447 100644
--- a/packages/common/exceptions/not-acceptable.exception.ts
+++ b/packages/common/exceptions/not-acceptable.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Not Acceptable* type errors.
  *
- * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
+ * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/not-found.exception.ts b/packages/common/exceptions/not-found.exception.ts
index a8ab1491a..d8c38ca7f 100644
--- a/packages/common/exceptions/not-found.exception.ts
+++ b/packages/common/exceptions/not-found.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Not Found* type errors.
  *
- * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
+ * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/not-implemented.exception.ts b/packages/common/exceptions/not-implemented.exception.ts
index 0576406fc..4702fe384 100644
--- a/packages/common/exceptions/not-implemented.exception.ts
+++ b/packages/common/exceptions/not-implemented.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Not Implemented* type errors.
  *
- * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
+ * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/payload-too-large.exception.ts b/packages/common/exceptions/payload-too-large.exception.ts
index 3f967f834..968b94d3f 100644
--- a/packages/common/exceptions/payload-too-large.exception.ts
+++ b/packages/common/exceptions/payload-too-large.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Payload Too Large* type errors.
  *
- * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
+ * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/precondition-failed.exception.ts b/packages/common/exceptions/precondition-failed.exception.ts
index 6e8456396..ca9c3a70d 100644
--- a/packages/common/exceptions/precondition-failed.exception.ts
+++ b/packages/common/exceptions/precondition-failed.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Precondition Failed* type errors.
  *
- * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
+ * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/request-timeout.exception.ts b/packages/common/exceptions/request-timeout.exception.ts
index 8521e290f..3bcd193ce 100644
--- a/packages/common/exceptions/request-timeout.exception.ts
+++ b/packages/common/exceptions/request-timeout.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Request Timeout* type errors.
  *
- * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
+ * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/service-unavailable.exception.ts b/packages/common/exceptions/service-unavailable.exception.ts
index b7721322f..f0270b7e6 100644
--- a/packages/common/exceptions/service-unavailable.exception.ts
+++ b/packages/common/exceptions/service-unavailable.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Service Unavailable* type errors.
  *
- * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
+ * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/unauthorized.exception.ts b/packages/common/exceptions/unauthorized.exception.ts
index 1791316c6..7d9379816 100644
--- a/packages/common/exceptions/unauthorized.exception.ts
+++ b/packages/common/exceptions/unauthorized.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Unauthorized* type errors.
  *
- * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
+ * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/unprocessable-entity.exception.ts b/packages/common/exceptions/unprocessable-entity.exception.ts
index b1cf34b77..f76c8d24e 100644
--- a/packages/common/exceptions/unprocessable-entity.exception.ts
+++ b/packages/common/exceptions/unprocessable-entity.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Unprocessable Entity* type errors.
  *
- * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
+ * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/exceptions/unsupported-media-type.exception.ts b/packages/common/exceptions/unsupported-media-type.exception.ts
index eaeab69a9..49e4ab14f 100644
--- a/packages/common/exceptions/unsupported-media-type.exception.ts
+++ b/packages/common/exceptions/unsupported-media-type.exception.ts
@@ -4,7 +4,7 @@ import { HttpException } from './http.exception';
 /**
  * Defines an HTTP exception for *Unsupported Media Type* type errors.
  *
- * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
+ * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
  *
  * @publicApi
  */
diff --git a/packages/common/file-stream/streamable-file.ts b/packages/common/file-stream/streamable-file.ts
index 7fe05c1d9..b0b0ddab0 100644
--- a/packages/common/file-stream/streamable-file.ts
+++ b/packages/common/file-stream/streamable-file.ts
@@ -16,7 +16,6 @@ export class StreamableFile {
       this.stream = new Readable();
       this.stream.push(bufferOrReadStream);
       this.stream.push(null);
-      this.options.length ??= bufferOrReadStream.length;
     } else if (bufferOrReadStream.pipe && isFunction(bufferOrReadStream.pipe)) {
       this.stream = bufferOrReadStream;
     }
@@ -27,15 +26,8 @@ export class StreamableFile {
   }
 
   getHeaders() {
-    const {
-      type = 'application/octet-stream',
-      disposition = undefined,
-      length = undefined,
-    } = this.options;
-    return {
-      type,
-      disposition,
-      length,
-    };
+    const { type = 'application/octet-stream', disposition = null } =
+      this.options;
+    return { type, disposition };
   }
 }
diff --git a/packages/common/file-stream/streamable-options.interface.ts b/packages/common/file-stream/streamable-options.interface.ts
index 5d167b6b0..8b9bd24a7 100644
--- a/packages/common/file-stream/streamable-options.interface.ts
+++ b/packages/common/file-stream/streamable-options.interface.ts
@@ -1,5 +1,4 @@
 export interface StreamableFileOptions {
   type?: string;
   disposition?: string;
-  length?: number;
 }
diff --git a/packages/common/http/http.constants.ts b/packages/common/http/http.constants.ts
index d69880b18..21f6d8499 100644
--- a/packages/common/http/http.constants.ts
+++ b/packages/common/http/http.constants.ts
@@ -1 +1,3 @@
 export const AXIOS_INSTANCE_TOKEN = 'AXIOS_INSTANCE_TOKEN';
+export const HTTP_MODULE_ID = 'HTTP_MODULE_ID';
+export const HTTP_MODULE_OPTIONS = 'HTTP_MODULE_OPTIONS';
diff --git a/packages/common/http/http.module-definition.ts b/packages/common/http/http.module-definition.ts
deleted file mode 100644
index 708d8f701..000000000
--- a/packages/common/http/http.module-definition.ts
+++ /dev/null
@@ -1,23 +0,0 @@
-import { Provider } from '../interfaces';
-import { ConfigurableModuleBuilder } from '../module-utils';
-import { HttpModuleOptions } from './interfaces';
-
-export const {
-  ConfigurableModuleClass,
-  MODULE_OPTIONS_TOKEN,
-  ASYNC_OPTIONS_TYPE,
-} = new ConfigurableModuleBuilder<HttpModuleOptions>({
-  moduleName: 'Http',
-  alwaysTransient: true,
-})
-  .setFactoryMethodName('createHttpOptions')
-  .setExtras<{ extraProviders?: Provider[] }>(
-    {
-      extraProviders: [],
-    },
-    (definition, extras) => ({
-      ...definition,
-      providers: definition.providers.concat(extras?.extraProviders),
-    }),
-  )
-  .build();
diff --git a/packages/common/http/http.module.ts b/packages/common/http/http.module.ts
index a2e46b464..cc0367673 100644
--- a/packages/common/http/http.module.ts
+++ b/packages/common/http/http.module.ts
@@ -1,14 +1,18 @@
 import Axios from 'axios';
 import { Module } from '../decorators/modules/module.decorator';
-import { DynamicModule } from '../interfaces';
-import { AXIOS_INSTANCE_TOKEN } from './http.constants';
+import { DynamicModule, Provider } from '../interfaces';
+import { randomStringGenerator } from '../utils/random-string-generator.util';
 import {
-  ASYNC_OPTIONS_TYPE,
-  ConfigurableModuleClass,
-  MODULE_OPTIONS_TOKEN,
-} from './http.module-definition';
+  AXIOS_INSTANCE_TOKEN,
+  HTTP_MODULE_ID,
+  HTTP_MODULE_OPTIONS,
+} from './http.constants';
 import { HttpService } from './http.service';
-import { HttpModuleOptions } from './interfaces';
+import {
+  HttpModuleAsyncOptions,
+  HttpModuleOptions,
+  HttpModuleOptionsFactory,
+} from './interfaces';
 
 /**
  * @deprecated "HttpModule" (from the "@nestjs/common" package) is deprecated and will be removed in the next major release. Please, use the "@nestjs/axios" package instead.
@@ -23,17 +27,73 @@ import { HttpModuleOptions } from './interfaces';
   ],
   exports: [HttpService],
 })
-export class HttpModule extends ConfigurableModuleClass {
-  static registerAsync(options: typeof ASYNC_OPTIONS_TYPE): DynamicModule {
+export class HttpModule {
+  static register(config: HttpModuleOptions): DynamicModule {
+    return {
+      module: HttpModule,
+      providers: [
+        {
+          provide: AXIOS_INSTANCE_TOKEN,
+          useValue: Axios.create(config),
+        },
+        {
+          provide: HTTP_MODULE_ID,
+          useValue: randomStringGenerator(),
+        },
+      ],
+    };
+  }
+
+  static registerAsync(options: HttpModuleAsyncOptions): DynamicModule {
     return {
-      ...super.registerAsync(options),
+      module: HttpModule,
+      imports: options.imports,
       providers: [
+        ...this.createAsyncProviders(options),
         {
           provide: AXIOS_INSTANCE_TOKEN,
           useFactory: (config: HttpModuleOptions) => Axios.create(config),
-          inject: [MODULE_OPTIONS_TOKEN],
+          inject: [HTTP_MODULE_OPTIONS],
         },
+        {
+          provide: HTTP_MODULE_ID,
+          useValue: randomStringGenerator(),
+        },
+        ...(options.extraProviders || []),
       ],
     };
   }
+
+  private static createAsyncProviders(
+    options: HttpModuleAsyncOptions,
+  ): Provider[] {
+    if (options.useExisting || options.useFactory) {
+      return [this.createAsyncOptionsProvider(options)];
+    }
+    return [
+      this.createAsyncOptionsProvider(options),
+      {
+        provide: options.useClass,
+        useClass: options.useClass,
+      },
+    ];
+  }
+
+  private static createAsyncOptionsProvider(
+    options: HttpModuleAsyncOptions,
+  ): Provider {
+    if (options.useFactory) {
+      return {
+        provide: HTTP_MODULE_OPTIONS,
+        useFactory: options.useFactory,
+        inject: options.inject || [],
+      };
+    }
+    return {
+      provide: HTTP_MODULE_OPTIONS,
+      useFactory: async (optionsFactory: HttpModuleOptionsFactory) =>
+        optionsFactory.createHttpOptions(),
+      inject: [options.useExisting || options.useClass],
+    };
+  }
 }
diff --git a/packages/common/http/interfaces/http-module.interface.ts b/packages/common/http/interfaces/http-module.interface.ts
index 02b147d86..794f9385c 100644
--- a/packages/common/http/interfaces/http-module.interface.ts
+++ b/packages/common/http/interfaces/http-module.interface.ts
@@ -1,3 +1,19 @@
 import { AxiosRequestConfig } from 'axios';
+import { ModuleMetadata, Provider, Type } from '../../interfaces';
 
 export type HttpModuleOptions = AxiosRequestConfig;
+
+export interface HttpModuleOptionsFactory {
+  createHttpOptions(): Promise<HttpModuleOptions> | HttpModuleOptions;
+}
+
+export interface HttpModuleAsyncOptions
+  extends Pick<ModuleMetadata, 'imports'> {
+  useExisting?: Type<HttpModuleOptionsFactory>;
+  useClass?: Type<HttpModuleOptionsFactory>;
+  useFactory?: (
+    ...args: any[]
+  ) => Promise<HttpModuleOptions> | HttpModuleOptions;
+  inject?: any[];
+  extraProviders?: Provider[];
+}
diff --git a/packages/common/index.ts b/packages/common/index.ts
index 350464899..6a6107762 100644
--- a/packages/common/index.ts
+++ b/packages/common/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @common
- * Copyright(c) 2017 - 2022 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2021 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
@@ -31,7 +31,6 @@ export {
   INestApplication,
   INestApplicationContext,
   INestMicroservice,
-  InjectionToken,
   IntrospectionResult,
   MessageEvent,
   MiddlewareConsumer,
@@ -45,7 +44,6 @@ export {
   OnApplicationShutdown,
   OnModuleDestroy,
   OnModuleInit,
-  OptionalFactoryDependency,
   Paramtype,
   PipeTransform,
   Provider,
@@ -61,7 +59,6 @@ export {
   WsExceptionFilter,
   WsMessageHandler,
 } from './interfaces';
-export * from './module-utils';
 export * from './pipes';
 export * from './serializer';
 export * from './services';
diff --git a/packages/common/interfaces/middleware/nest-middleware.interface.ts b/packages/common/interfaces/middleware/nest-middleware.interface.ts
index bf3106995..d392d052d 100644
--- a/packages/common/interfaces/middleware/nest-middleware.interface.ts
+++ b/packages/common/interfaces/middleware/nest-middleware.interface.ts
@@ -1,3 +1,3 @@
 export interface NestMiddleware<TRequest = any, TResponse = any> {
-  use(req: TRequest, res: TResponse, next: (error?: Error | any) => void): any;
+  use(req: TRequest, res: TResponse, next: () => void): any;
 }
diff --git a/packages/common/interfaces/modules/index.ts b/packages/common/interfaces/modules/index.ts
index 458f952a3..612adb82b 100644
--- a/packages/common/interfaces/modules/index.ts
+++ b/packages/common/interfaces/modules/index.ts
@@ -1,8 +1,6 @@
 export * from './dynamic-module.interface';
 export * from './forward-reference.interface';
-export * from './injection-token.interface';
 export * from './introspection-result.interface';
 export * from './module-metadata.interface';
 export * from './nest-module.interface';
-export * from './optional-factory-dependency.interface';
 export * from './provider.interface';
diff --git a/packages/common/interfaces/modules/injection-token.interface.ts b/packages/common/interfaces/modules/injection-token.interface.ts
deleted file mode 100644
index 01aa7b1a9..000000000
--- a/packages/common/interfaces/modules/injection-token.interface.ts
+++ /dev/null
@@ -1,9 +0,0 @@
-import { Abstract } from '../abstract.interface';
-import { Type } from '../type.interface';
-
-export type InjectionToken =
-  | string
-  | symbol
-  | Type<any>
-  | Abstract<any>
-  | Function;
diff --git a/packages/common/interfaces/modules/optional-factory-dependency.interface.ts b/packages/common/interfaces/modules/optional-factory-dependency.interface.ts
deleted file mode 100644
index be2ebb298..000000000
--- a/packages/common/interfaces/modules/optional-factory-dependency.interface.ts
+++ /dev/null
@@ -1,6 +0,0 @@
-import { InjectionToken } from './injection-token.interface';
-
-export type OptionalFactoryDependency = {
-  token: InjectionToken;
-  optional: boolean;
-};
diff --git a/packages/common/interfaces/modules/provider.interface.ts b/packages/common/interfaces/modules/provider.interface.ts
index ba6d86da2..c868b3c97 100644
--- a/packages/common/interfaces/modules/provider.interface.ts
+++ b/packages/common/interfaces/modules/provider.interface.ts
@@ -1,7 +1,6 @@
+import { Abstract } from '../abstract.interface';
 import { Scope } from '../scope-options.interface';
 import { Type } from '../type.interface';
-import { InjectionToken } from './injection-token.interface';
-import { OptionalFactoryDependency } from './optional-factory-dependency.interface';
 
 /**
  *
@@ -28,7 +27,7 @@ export type Provider<T = any> =
  * };
  * ```
  *
- * @see [Class providers](https://docs.nestjs.com/fundamentals/custom-providers#class-providers-useclass)
+ * @see [Use class](https://docs.nestjs.com/fundamentals/custom-providers#use-class)
  * @see [Injection scopes](https://docs.nestjs.com/fundamentals/injection-scopes)
  *
  * @publicApi
@@ -37,7 +36,7 @@ export interface ClassProvider<T = any> {
   /**
    * Injection token
    */
-  provide: InjectionToken;
+  provide: string | symbol | Type<any> | Abstract<any> | Function;
   /**
    * Type (class name) of provider (instance to be injected).
    */
@@ -46,12 +45,6 @@ export interface ClassProvider<T = any> {
    * Optional enum defining lifetime of the provider that is injected.
    */
   scope?: Scope;
-  /**
-   * This option is only available on factory providers!
-   *
-   * @see [Use factory](https://docs.nestjs.com/fundamentals/custom-providers#factory-providers-usefactory)
-   */
-  inject?: never;
 }
 
 /**
@@ -65,7 +58,7 @@ export interface ClassProvider<T = any> {
  * };
  * ```
  *
- * @see [Value providers](https://docs.nestjs.com/fundamentals/custom-providers#value-providers-usevalue)
+ * @see [Use value](https://docs.nestjs.com/fundamentals/custom-providers#use-value)
  *
  * @publicApi
  */
@@ -73,17 +66,11 @@ export interface ValueProvider<T = any> {
   /**
    * Injection token
    */
-  provide: InjectionToken;
+  provide: string | symbol | Type<any> | Abstract<any> | Function;
   /**
    * Instance of a provider to be injected.
    */
   useValue: T;
-  /**
-   * This option is only available on factory providers!
-   *
-   * @see [Use factory](https://docs.nestjs.com/fundamentals/custom-providers#factory-providers-usefactory)
-   */
-  inject?: never;
 }
 
 /**
@@ -101,7 +88,7 @@ export interface ValueProvider<T = any> {
  * };
  * ```
  *
- * @see [Factory providers](https://docs.nestjs.com/fundamentals/custom-providers#factory-providers-usefactory)
+ * @see [Use factory](https://docs.nestjs.com/fundamentals/custom-providers#use-factory)
  * @see [Injection scopes](https://docs.nestjs.com/fundamentals/injection-scopes)
  *
  * @publicApi
@@ -110,15 +97,15 @@ export interface FactoryProvider<T = any> {
   /**
    * Injection token
    */
-  provide: InjectionToken;
+  provide: string | symbol | Type<any> | Abstract<any> | Function;
   /**
    * Factory function that returns an instance of the provider to be injected.
    */
-  useFactory: (...args: any[]) => T | Promise<T>;
+  useFactory: (...args: any[]) => T;
   /**
    * Optional list of providers to be injected into the context of the Factory function.
    */
-  inject?: Array<InjectionToken | OptionalFactoryDependency>;
+  inject?: Array<Type<any> | string | symbol | Abstract<any> | Function>;
   /**
    * Optional enum defining lifetime of the provider that is returned by the Factory function.
    */
@@ -136,7 +123,7 @@ export interface FactoryProvider<T = any> {
  * };
  * ```
  *
- * @see [Alias providers](https://docs.nestjs.com/fundamentals/custom-providers#alias-providers-useexisting)
+ * @see [Use existing](https://docs.nestjs.com/fundamentals/custom-providers#use-existing)
  *
  * @publicApi
  */
@@ -144,7 +131,7 @@ export interface ExistingProvider<T = any> {
   /**
    * Injection token
    */
-  provide: InjectionToken;
+  provide: string | symbol | Type<any> | Abstract<any> | Function;
   /**
    * Provider to be aliased by the Injection token.
    */
diff --git a/packages/common/interfaces/version-options.interface.ts b/packages/common/interfaces/version-options.interface.ts
index fcdd786b6..be03d349d 100644
--- a/packages/common/interfaces/version-options.interface.ts
+++ b/packages/common/interfaces/version-options.interface.ts
@@ -58,20 +58,6 @@ export interface MediaTypeVersioningOptions {
   key: string;
 }
 
-export interface CustomVersioningOptions {
-  type: VersioningType.CUSTOM;
-
-  /**
-   * A function that accepts a request object (specific to the underlying platform, ie Express or Fastify)
-   * and returns a single version value or an ordered array of versions, in order from HIGHEST to LOWEST.
-   *
-   * Ex. Returned version array = ['3.1', '3.0', '2.5', '2', '1.9']
-   *
-   * Use type assertion or narrowing to identify the specific request type.
-   */
-  extractor: (request: unknown) => string | string[];
-}
-
 interface VersioningCommonOptions {
   /**
    * The default version to be used as a fallback when you did not provide some
@@ -84,9 +70,4 @@ interface VersioningCommonOptions {
  * @publicApi
  */
 export type VersioningOptions = VersioningCommonOptions &
-  (
-    | HeaderVersioningOptions
-    | UriVersioningOptions
-    | MediaTypeVersioningOptions
-    | CustomVersioningOptions
-  );
+  (HeaderVersioningOptions | UriVersioningOptions | MediaTypeVersioningOptions);
diff --git a/packages/common/module-utils/configurable-module.builder.ts b/packages/common/module-utils/configurable-module.builder.ts
deleted file mode 100644
index 0e3f1318f..000000000
--- a/packages/common/module-utils/configurable-module.builder.ts
+++ /dev/null
@@ -1,330 +0,0 @@
-import { DynamicModule, Provider } from '../interfaces';
-import { Logger } from '../services/logger.service';
-import { randomStringGenerator } from '../utils/random-string-generator.util';
-import {
-  ASYNC_METHOD_SUFFIX,
-  CONFIGURABLE_MODULE_ID,
-  DEFAULT_FACTORY_CLASS_METHOD_KEY,
-  DEFAULT_METHOD_KEY,
-} from './constants';
-import {
-  ConfigurableModuleAsyncOptions,
-  ConfigurableModuleCls,
-  ConfigurableModuleOptionsFactory,
-} from './interfaces';
-import { ConfigurableModuleHost } from './interfaces/configurable-module-host.interface';
-import { generateOptionsInjectionToken } from './utils/generate-options-injection-token.util';
-
-/**
- * @publicApi
- */
-export interface ConfigurableModuleBuilderOptions {
-  /**
-   * Specified what injection token should be used for the module options provider.
-   * By default, an auto-generated UUID will be used.
-   */
-  optionsInjectionToken?: string | symbol;
-  /**
-   * By default, an UUID will be used as a module options provider token.
-   * Explicitly specifying the "moduleName" will instruct the "ConfigurableModuleBuilder"
-   * to use a more descriptive provider token.
-   *
-   * For example, if `moduleName: "Cache"` then auto-generated provider token will be "CACHE_MODULE_OPTIONS".
-   */
-  moduleName?: string;
-  /**
-   * Indicates whether module should always be "transient", meaning,
-   * every time you call the static method to construct a dynamic module,
-   * regardless of what arguments you pass in, a new "unique" module will be created.
-   *
-   * @default false
-   */
-  alwaysTransient?: boolean;
-}
-
-/**
- * Factory that lets you create configurable modules and
- * provides a way to reduce the majority of dynamic module boilerplate.
- *
- * @publicApi
- */
-export class ConfigurableModuleBuilder<
-  ModuleOptions,
-  StaticMethodKey extends string = typeof DEFAULT_METHOD_KEY,
-  FactoryClassMethodKey extends string = typeof DEFAULT_FACTORY_CLASS_METHOD_KEY,
-  ExtraModuleDefinitionOptions = {},
-> {
-  protected staticMethodKey: StaticMethodKey;
-  protected factoryClassMethodKey: FactoryClassMethodKey;
-  protected extras: ExtraModuleDefinitionOptions;
-  protected transformModuleDefinition: (
-    definition: DynamicModule,
-    extraOptions: ExtraModuleDefinitionOptions,
-  ) => DynamicModule;
-
-  protected readonly logger = new Logger(ConfigurableModuleBuilder.name);
-
-  constructor(
-    protected readonly options: ConfigurableModuleBuilderOptions = {},
-    parentBuilder?: ConfigurableModuleBuilder<ModuleOptions>,
-  ) {
-    if (parentBuilder) {
-      this.staticMethodKey = parentBuilder.staticMethodKey as StaticMethodKey;
-      this.factoryClassMethodKey =
-        parentBuilder.factoryClassMethodKey as FactoryClassMethodKey;
-      this.transformModuleDefinition = parentBuilder.transformModuleDefinition;
-      this.extras = parentBuilder.extras as ExtraModuleDefinitionOptions;
-    }
-  }
-
-  /**
-   * Registers the "extras" object (a set of extra options that can be used to modify the dynamic module definition).
-   * Values you specify within the "extras" object will be used as default values (that can be overriden by module consumers).
-   *
-   * This method also applies the so-called "module definition transform function" that takes the auto-generated
-   * dynamic module object ("DynamicModule") and the actual consumer "extras" object as input parameters.
-   * The "extras" object consists of values explicitly specified by module consumers and default values.
-   *
-   * @example
-   * ```typescript
-   * .setExtras<{ isGlobal?: boolean }>({ isGlobal: false }, (definition, extras) =>
-   *    ({ ...definition, global: extras.isGlobal })
-   * )
-   * ```
-   */
-  setExtras<ExtraModuleDefinitionOptions>(
-    extras: ExtraModuleDefinitionOptions,
-    transformDefinition: (
-      definition: DynamicModule,
-      extras: ExtraModuleDefinitionOptions,
-    ) => DynamicModule,
-  ) {
-    const builder = new ConfigurableModuleBuilder<
-      ModuleOptions,
-      StaticMethodKey,
-      FactoryClassMethodKey,
-      ExtraModuleDefinitionOptions
-    >(this.options, this as any);
-    builder.extras = extras;
-    builder.transformModuleDefinition = transformDefinition;
-    return builder;
-  }
-
-  /**
-   * Dynamic modules must expose public static methods that let you pass in
-   * configuration parameters (control the module's behavior from the outside).
-   * Some frequently used names that you may have seen in other modules are:
-   * "forRoot", "forFeature", "register", "configure".
-   *
-   * This method "setClassMethodName" lets you specify the name of the
-   * method that will be auto-generated.
-   *
-   * @param key name of the method
-   */
-  setClassMethodName<StaticMethodKey extends string>(key: StaticMethodKey) {
-    const builder = new ConfigurableModuleBuilder<
-      ModuleOptions,
-      StaticMethodKey,
-      FactoryClassMethodKey,
-      ExtraModuleDefinitionOptions
-    >(this.options, this as any);
-    builder.staticMethodKey = key;
-    return builder;
-  }
-
-  /**
-   * Asynchronously configured modules (that rely on other modules, i.e. "ConfigModule")
-   * let you pass the configuration factory class that will be registered and instantiated as a provider.
-   * This provider then will be used to retrieve the module's configuration. To provide the configuration,
-   * the corresponding factory method must be implemented.
-   *
-   * This method ("setFactoryMethodName") lets you control what method name will have to be
-   * implemented by the config factory (default is "create").
-   *
-   * @param key name of the method
-   */
-  setFactoryMethodName<FactoryClassMethodKey extends string>(
-    key: FactoryClassMethodKey,
-  ) {
-    const builder = new ConfigurableModuleBuilder<
-      ModuleOptions,
-      StaticMethodKey,
-      FactoryClassMethodKey,
-      ExtraModuleDefinitionOptions
-    >(this.options, this as any);
-    builder.factoryClassMethodKey = key;
-    return builder;
-  }
-
-  /**
-   * Returns an object consisting of multiple properties that lets you
-   * easily construct dynamic configurable modules. See "ConfigurableModuleHost" interface for more details.
-   */
-  build(): ConfigurableModuleHost<
-    ModuleOptions,
-    StaticMethodKey,
-    FactoryClassMethodKey,
-    ExtraModuleDefinitionOptions
-  > {
-    this.staticMethodKey ??= DEFAULT_METHOD_KEY as StaticMethodKey;
-    this.factoryClassMethodKey ??=
-      DEFAULT_FACTORY_CLASS_METHOD_KEY as FactoryClassMethodKey;
-    this.options.optionsInjectionToken ??= this.options.moduleName
-      ? this.constructInjectionTokenString()
-      : generateOptionsInjectionToken();
-    this.transformModuleDefinition ??= definition => definition;
-
-    return {
-      ConfigurableModuleClass:
-        this.createConfigurableModuleCls<ModuleOptions>(),
-      MODULE_OPTIONS_TOKEN: this.options.optionsInjectionToken,
-      ASYNC_OPTIONS_TYPE: this.createTypeProxy('ASYNC_OPTIONS_TYPE'),
-      OPTIONS_TYPE: this.createTypeProxy('OPTIONS_TYPE'),
-    };
-  }
-
-  private constructInjectionTokenString(): string {
-    const moduleNameInSnakeCase = this.options.moduleName
-      .trim()
-      .split(/(?=[A-Z])/)
-      .join('_')
-      .toUpperCase();
-    return `${moduleNameInSnakeCase}_MODULE_OPTIONS`;
-  }
-
-  private createConfigurableModuleCls<ModuleOptions>(): ConfigurableModuleCls<
-    ModuleOptions,
-    StaticMethodKey,
-    FactoryClassMethodKey
-  > {
-    // eslint-disable-next-line @typescript-eslint/no-this-alias
-    const self = this;
-    const asyncMethodKey = this.staticMethodKey + ASYNC_METHOD_SUFFIX;
-
-    class InternalModuleClass {
-      static [self.staticMethodKey](
-        options: ModuleOptions & ExtraModuleDefinitionOptions,
-      ): DynamicModule {
-        const providers = [
-          {
-            provide: self.options.optionsInjectionToken,
-            useValue: this.omitExtras(options, self.extras),
-          },
-        ];
-        if (self.options.alwaysTransient) {
-          providers.push({
-            provide: CONFIGURABLE_MODULE_ID,
-            useValue: randomStringGenerator(),
-          });
-        }
-        return self.transformModuleDefinition(
-          {
-            module: this,
-            providers,
-          },
-          options,
-        );
-      }
-
-      static [asyncMethodKey](
-        options: ConfigurableModuleAsyncOptions<ModuleOptions> &
-          ExtraModuleDefinitionOptions,
-      ): DynamicModule {
-        const providers = this.createAsyncProviders(options);
-        if (self.options.alwaysTransient) {
-          providers.push({
-            provide: CONFIGURABLE_MODULE_ID,
-            useValue: randomStringGenerator(),
-          });
-        }
-        return self.transformModuleDefinition(
-          {
-            module: this,
-            imports: options.imports || [],
-            providers,
-          },
-          options,
-        );
-      }
-
-      private static omitExtras(
-        input: ModuleOptions & ExtraModuleDefinitionOptions,
-        extras: ExtraModuleDefinitionOptions | undefined,
-      ): ModuleOptions {
-        if (!extras) {
-          return input;
-        }
-        const moduleOptions = {};
-        const extrasKeys = Object.keys(extras);
-
-        Object.keys(input)
-          .filter(key => !extrasKeys.includes(key))
-          .forEach(key => {
-            moduleOptions[key] = input[key];
-          });
-        return moduleOptions as ModuleOptions;
-      }
-
-      private static createAsyncProviders(
-        options: ConfigurableModuleAsyncOptions<ModuleOptions>,
-      ): Provider[] {
-        if (options.useExisting || options.useFactory) {
-          return [this.createAsyncOptionsProvider(options)];
-        }
-        return [
-          this.createAsyncOptionsProvider(options),
-          {
-            provide: options.useClass,
-            useClass: options.useClass,
-          },
-        ];
-      }
-
-      private static createAsyncOptionsProvider(
-        options: ConfigurableModuleAsyncOptions<ModuleOptions>,
-      ): Provider {
-        if (options.useFactory) {
-          return {
-            provide: self.options.optionsInjectionToken,
-            useFactory: options.useFactory,
-            inject: options.inject || [],
-          };
-        }
-        return {
-          provide: self.options.optionsInjectionToken,
-          useFactory: async (
-            optionsFactory: ConfigurableModuleOptionsFactory<
-              ModuleOptions,
-              FactoryClassMethodKey
-            >,
-          ) =>
-            await optionsFactory[
-              self.factoryClassMethodKey as keyof typeof optionsFactory
-            ](),
-          inject: [options.useExisting || options.useClass],
-        };
-      }
-    }
-    return InternalModuleClass as unknown as ConfigurableModuleCls<
-      ModuleOptions,
-      StaticMethodKey,
-      FactoryClassMethodKey
-    >;
-  }
-
-  private createTypeProxy(
-    typeName: 'OPTIONS_TYPE' | 'ASYNC_OPTIONS_TYPE' | 'OptionsFactoryInterface',
-  ) {
-    const proxy = new Proxy(
-      {},
-      {
-        get: () => {
-          throw new Error(
-            `"${typeName}" is not supposed to be used as a value.`,
-          );
-        },
-      },
-    );
-    return proxy as any;
-  }
-}
diff --git a/packages/common/module-utils/constants.ts b/packages/common/module-utils/constants.ts
deleted file mode 100644
index 2d97c0c8c..000000000
--- a/packages/common/module-utils/constants.ts
+++ /dev/null
@@ -1,5 +0,0 @@
-export const DEFAULT_METHOD_KEY = 'register';
-export const DEFAULT_FACTORY_CLASS_METHOD_KEY = 'create';
-
-export const ASYNC_METHOD_SUFFIX = 'Async';
-export const CONFIGURABLE_MODULE_ID = 'CONFIGURABLE_MODULE_ID';
diff --git a/packages/common/module-utils/index.ts b/packages/common/module-utils/index.ts
deleted file mode 100644
index 4393992bd..000000000
--- a/packages/common/module-utils/index.ts
+++ /dev/null
@@ -1,2 +0,0 @@
-export * from './configurable-module.builder';
-export * from './interfaces';
diff --git a/packages/common/module-utils/interfaces/configurable-module-async-options.interface.ts b/packages/common/module-utils/interfaces/configurable-module-async-options.interface.ts
deleted file mode 100644
index 56f7040e4..000000000
--- a/packages/common/module-utils/interfaces/configurable-module-async-options.interface.ts
+++ /dev/null
@@ -1,51 +0,0 @@
-import { FactoryProvider, ModuleMetadata, Type } from '../../interfaces';
-import { DEFAULT_FACTORY_CLASS_METHOD_KEY } from '../constants';
-
-/**
- * Interface that must be implemented by the module options factory class.
- * Method key varies depending on the "FactoryClassMethodKey" type argument.
- *
- * @publicApi
- */
-export type ConfigurableModuleOptionsFactory<
-  ModuleOptions,
-  FactoryClassMethodKey extends string,
-> = Record<
-  `${FactoryClassMethodKey}`,
-  () => Promise<ModuleOptions> | ModuleOptions
->;
-
-/**
- * Interface that represents the module async options object
- * Factory method name varies depending on the "FactoryClassMethodKey" type argument.
- *
- * @publicApi
- */
-export interface ConfigurableModuleAsyncOptions<
-  ModuleOptions,
-  FactoryClassMethodKey extends string = typeof DEFAULT_FACTORY_CLASS_METHOD_KEY,
-> extends Pick<ModuleMetadata, 'imports'> {
-  /**
-   * Injection token resolving to an existing provider. The provider must implement
-   * the corresponding interface.
-   */
-  useExisting?: Type<
-    ConfigurableModuleOptionsFactory<ModuleOptions, FactoryClassMethodKey>
-  >;
-  /**
-   * Injection token resolving to a class that will be instantiated as a provider.
-   * The class must implement the corresponding interface.
-   */
-  useClass?: Type<
-    ConfigurableModuleOptionsFactory<ModuleOptions, FactoryClassMethodKey>
-  >;
-  /**
-   * Function returning options (or a Promise resolving to options) to configure the
-   * cache module.
-   */
-  useFactory?: (...args: unknown[]) => Promise<ModuleOptions> | ModuleOptions;
-  /**
-   * Dependencies that a Factory may inject.
-   */
-  inject?: FactoryProvider['inject'];
-}
diff --git a/packages/common/module-utils/interfaces/configurable-module-cls.interface.ts b/packages/common/module-utils/interfaces/configurable-module-cls.interface.ts
deleted file mode 100644
index e01c706be..000000000
--- a/packages/common/module-utils/interfaces/configurable-module-cls.interface.ts
+++ /dev/null
@@ -1,35 +0,0 @@
-import { DynamicModule } from '../../interfaces';
-import {
-  DEFAULT_FACTORY_CLASS_METHOD_KEY,
-  DEFAULT_METHOD_KEY,
-} from '../constants';
-import { ConfigurableModuleAsyncOptions } from './configurable-module-async-options.interface';
-
-/**
- * Class that represents a blueprint/prototype for a configurable Nest module.
- * This class provides static methods for constructing dynamic modules. Their names
- * can be controlled through the "MethodKey" type argument.
- *
- * @publicApi
- */
-export type ConfigurableModuleCls<
-  ModuleOptions,
-  MethodKey extends string = typeof DEFAULT_METHOD_KEY,
-  FactoryClassMethodKey extends string = typeof DEFAULT_FACTORY_CLASS_METHOD_KEY,
-  ExtraModuleDefinitionOptions = {},
-> = {
-  new (): any;
-} & Record<
-  `${MethodKey}`,
-  (options: ModuleOptions & ExtraModuleDefinitionOptions) => DynamicModule
-> &
-  Record<
-    `${MethodKey}Async`,
-    (
-      options: ConfigurableModuleAsyncOptions<
-        ModuleOptions,
-        FactoryClassMethodKey
-      > &
-        ExtraModuleDefinitionOptions,
-    ) => DynamicModule
-  >;
diff --git a/packages/common/module-utils/interfaces/configurable-module-host.interface.ts b/packages/common/module-utils/interfaces/configurable-module-host.interface.ts
deleted file mode 100644
index 6a652ecce..000000000
--- a/packages/common/module-utils/interfaces/configurable-module-host.interface.ts
+++ /dev/null
@@ -1,77 +0,0 @@
-import { ConfigurableModuleAsyncOptions } from './configurable-module-async-options.interface';
-import { ConfigurableModuleCls } from './configurable-module-cls.interface';
-
-/**
- * Configurable module host. See properties for more details
- *
- * @publicApi
- */
-export interface ConfigurableModuleHost<
-  ModuleOptions = Record<string, unknown>,
-  MethodKey extends string = string,
-  FactoryClassMethodKey extends string = string,
-  ExtraModuleDefinitionOptions = {},
-> {
-  /**
-   * Class that represents a blueprint/prototype for a configurable Nest module.
-   * This class provides static methods for constructing dynamic modules. Their names
-   * can be controlled through the "MethodKey" type argument.
-   *
-   * Your module class should inherit from this class to make the static methods available.
-   *
-   * @example
-   * ```typescript
-   * @Module({})
-   * class IntegrationModule extends ConfigurableModuleCls {
-   *  // ...
-   * }
-   * ```
-   */
-  ConfigurableModuleClass: ConfigurableModuleCls<
-    ModuleOptions,
-    MethodKey,
-    FactoryClassMethodKey,
-    ExtraModuleDefinitionOptions
-  >;
-  /**
-   * Module options provider token. Can be used to inject the "options object" to
-   * providers registered within the host module.
-   */
-  MODULE_OPTIONS_TOKEN: string | symbol;
-  /**
-   * Can be used to auto-infer the compound "async module options" type.
-   * Note: this property is not supposed to be used as a value.
-   *
-   * @example
-   * ```typescript
-   * @Module({})
-   * class IntegrationModule extends ConfigurableModuleCls {
-   *  static module = initializer(IntegrationModule);
-   *
-   * static registerAsync(options: typeof ASYNC_OPTIONS_TYPE): DynamicModule {
-   *  return super.registerAsync(options);
-   * }
-   * ```
-   */
-  ASYNC_OPTIONS_TYPE: ConfigurableModuleAsyncOptions<
-    ModuleOptions,
-    FactoryClassMethodKey
-  > &
-    ExtraModuleDefinitionOptions;
-  /**
-   * Can be used to auto-infer the compound "module options" type (options interface + extra module definition options).
-   * Note: this property is not supposed to be used as a value.
-   *
-   * @example
-   * ```typescript
-   * @Module({})
-   * class IntegrationModule extends ConfigurableModuleCls {
-   *  static module = initializer(IntegrationModule);
-   *
-   * static register(options: typeof OPTIONS_TYPE): DynamicModule {
-   *  return super.register(options);
-   * }
-   * ```
-   */
-  OPTIONS_TYPE: ModuleOptions & ExtraModuleDefinitionOptions;
-}
diff --git a/packages/common/module-utils/interfaces/index.ts b/packages/common/module-utils/interfaces/index.ts
deleted file mode 100644
index 35c523076..000000000
--- a/packages/common/module-utils/interfaces/index.ts
+++ /dev/null
@@ -1,3 +0,0 @@
-export * from './configurable-module-async-options.interface';
-export * from './configurable-module-cls.interface';
-export * from './configurable-module-host.interface';
diff --git a/packages/common/module-utils/utils/generate-options-injection-token.util.ts b/packages/common/module-utils/utils/generate-options-injection-token.util.ts
deleted file mode 100644
index 259a6afa3..000000000
--- a/packages/common/module-utils/utils/generate-options-injection-token.util.ts
+++ /dev/null
@@ -1,6 +0,0 @@
-import { randomStringGenerator } from '../../utils/random-string-generator.util';
-
-export function generateOptionsInjectionToken() {
-  const hash = randomStringGenerator();
-  return `CONFIGURABLE_MODULE_OPTIONS[${hash}]`;
-}
diff --git a/packages/common/package.json b/packages/common/package.json
index 82bfc8c5b..58bd7fec9 100644
--- a/packages/common/package.json
+++ b/packages/common/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/common",
-  "version": "8.4.5",
+  "version": "8.3.1",
   "description": "Nest - modern, fast, powerful node.js web framework (@common)",
   "author": "Kamil Mysliwiec",
   "homepage": "https://nestjs.com",
@@ -17,9 +17,9 @@
   },
   "license": "MIT",
   "dependencies": {
-    "axios": "0.27.2",
+    "axios": "0.26.0",
     "iterare": "1.2.1",
-    "tslib": "2.4.0",
+    "tslib": "2.3.1",
     "uuid": "8.3.2"
   },
   "peerDependencies": {
diff --git a/packages/common/pipes/default-value.pipe.ts b/packages/common/pipes/default-value.pipe.ts
index 65716f497..4ce7d9701 100644
--- a/packages/common/pipes/default-value.pipe.ts
+++ b/packages/common/pipes/default-value.pipe.ts
@@ -16,7 +16,7 @@ import { isNil, isNumber } from '../utils/shared.utils';
 export class DefaultValuePipe<T = any, R = any>
   implements PipeTransform<T, T | R>
 {
-  constructor(protected readonly defaultValue: R) {}
+  constructor(private readonly defaultValue: R) {}
 
   transform(value?: T, _metadata?: ArgumentMetadata): T | R {
     if (
diff --git a/packages/common/pipes/parse-array.pipe.ts b/packages/common/pipes/parse-array.pipe.ts
index c9ed1c67d..6ede5cf0b 100644
--- a/packages/common/pipes/parse-array.pipe.ts
+++ b/packages/common/pipes/parse-array.pipe.ts
@@ -36,7 +36,7 @@ export class ParseArrayPipe implements PipeTransform {
   protected readonly validationPipe: ValidationPipe;
   protected exceptionFactory: (error: string) => any;
 
-  constructor(@Optional() protected readonly options: ParseArrayOptions = {}) {
+  constructor(@Optional() private readonly options: ParseArrayOptions = {}) {
     this.validationPipe = new ValidationPipe({
       transform: true,
       validateCustomDecorators: true,
diff --git a/packages/common/pipes/parse-bool.pipe.ts b/packages/common/pipes/parse-bool.pipe.ts
index a5b6bcb6d..5876144d9 100644
--- a/packages/common/pipes/parse-bool.pipe.ts
+++ b/packages/common/pipes/parse-bool.pipe.ts
@@ -48,32 +48,14 @@ export class ParseBoolPipe
     value: string | boolean,
     metadata: ArgumentMetadata,
   ): Promise<boolean> {
-    if (this.isTrue(value)) {
+    if (value === true || value === 'true') {
       return true;
     }
-    if (this.isFalse(value)) {
+    if (value === false || value === 'false') {
       return false;
     }
     throw this.exceptionFactory(
       'Validation failed (boolean string is expected)',
     );
   }
-
-  /**
-   * @param value currently processed route argument
-   * @returns `true` if `value` is said 'true', ie., if it is equal to the boolean
-   * `true` or the string `"true"`
-   */
-  protected isTrue(value: string | boolean): boolean {
-    return value === true || value === 'true';
-  }
-
-  /**
-   * @param value currently processed route argument
-   * @returns `true` if `value` is said 'false', ie., if it is equal to the boolean
-   * `false` or the string `"false"`
-   */
-  protected isFalse(value: string | boolean): boolean {
-    return value === false || value === 'false';
-  }
 }
diff --git a/packages/common/pipes/parse-float.pipe.ts b/packages/common/pipes/parse-float.pipe.ts
index 1f0fdb021..086152a9b 100644
--- a/packages/common/pipes/parse-float.pipe.ts
+++ b/packages/common/pipes/parse-float.pipe.ts
@@ -39,23 +39,15 @@ export class ParseFloatPipe implements PipeTransform<string> {
    * @param metadata contains metadata about the currently processed route argument
    */
   async transform(value: string, metadata: ArgumentMetadata): Promise<number> {
-    if (!this.isNumeric(value)) {
+    const isNumeric =
+      ['string', 'number'].includes(typeof value) &&
+      !isNaN(parseFloat(value)) &&
+      isFinite(value as any);
+    if (!isNumeric) {
       throw this.exceptionFactory(
         'Validation failed (numeric string is expected)',
       );
     }
     return parseFloat(value);
   }
-
-  /**
-   * @param value currently processed route argument
-   * @returns `true` if `value` is a valid float number
-   */
-  protected isNumeric(value: string): boolean {
-    return (
-      ['string', 'number'].includes(typeof value) &&
-      !isNaN(parseFloat(value)) &&
-      isFinite(value as any)
-    );
-  }
 }
diff --git a/packages/common/pipes/parse-int.pipe.ts b/packages/common/pipes/parse-int.pipe.ts
index 9d79a2b4c..2ba713f85 100644
--- a/packages/common/pipes/parse-int.pipe.ts
+++ b/packages/common/pipes/parse-int.pipe.ts
@@ -44,23 +44,15 @@ export class ParseIntPipe implements PipeTransform<string> {
    * @param metadata contains metadata about the currently processed route argument
    */
   async transform(value: string, metadata: ArgumentMetadata): Promise<number> {
-    if (!this.isNumeric(value)) {
+    const isNumeric =
+      ['string', 'number'].includes(typeof value) &&
+      /^-?\d+$/.test(value) &&
+      isFinite(value as any);
+    if (!isNumeric) {
       throw this.exceptionFactory(
         'Validation failed (numeric string is expected)',
       );
     }
     return parseInt(value, 10);
   }
-
-  /**
-   * @param value currently processed route argument
-   * @returns `true` if `value` is a valid integer number
-   */
-  protected isNumeric(value: string): boolean {
-    return (
-      ['string', 'number'].includes(typeof value) &&
-      /^-?\d+$/.test(value) &&
-      isFinite(value as any)
-    );
-  }
 }
diff --git a/packages/common/pipes/parse-uuid.pipe.ts b/packages/common/pipes/parse-uuid.pipe.ts
index 81fe2b4c1..2679e8f93 100644
--- a/packages/common/pipes/parse-uuid.pipe.ts
+++ b/packages/common/pipes/parse-uuid.pipe.ts
@@ -9,7 +9,7 @@ import {
   ErrorHttpStatusCode,
   HttpErrorByCode,
 } from '../utils/http-error-by-code.util';
-import { isString } from '../utils/shared.utils';
+import { isUUID } from '../utils/is-uuid';
 
 export interface ParseUUIDPipeOptions {
   version?: '3' | '4' | '5';
@@ -19,12 +19,6 @@ export interface ParseUUIDPipeOptions {
 
 @Injectable()
 export class ParseUUIDPipe implements PipeTransform<string> {
-  protected static uuidRegExps = {
-    3: /^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,
-    4: /^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,
-    5: /^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,
-    all: /^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i,
-  };
   private readonly version: '3' | '4' | '5';
   protected exceptionFactory: (errors: string) => any;
 
@@ -41,23 +35,14 @@ export class ParseUUIDPipe implements PipeTransform<string> {
       exceptionFactory ||
       (error => new HttpErrorByCode[errorHttpStatusCode](error));
   }
-
   async transform(value: string, metadata: ArgumentMetadata): Promise<string> {
-    if (!this.isUUID(value, this.version)) {
+    if (!isUUID(value, this.version)) {
       throw this.exceptionFactory(
-        `Validation failed (uuid${
-          this.version ? ` v ${this.version}` : ''
+        `Validation failed (uuid ${
+          this.version ? 'v' + this.version : ''
         } is expected)`,
       );
     }
     return value;
   }
-
-  protected isUUID(str: unknown, version = 'all') {
-    if (!isString(str)) {
-      throw this.exceptionFactory('The value passed as UUID is not a string');
-    }
-    const pattern = ParseUUIDPipe.uuidRegExps[version];
-    return pattern?.test(str);
-  }
 }
diff --git a/packages/common/services/console-logger.service.ts b/packages/common/services/console-logger.service.ts
index a1a9ffb6c..5ae5c570c 100644
--- a/packages/common/services/console-logger.service.ts
+++ b/packages/common/services/console-logger.service.ts
@@ -183,58 +183,27 @@ export class ConsoleLogger implements LoggerService {
     logLevel: LogLevel = 'log',
     writeStreamType?: 'stdout' | 'stderr',
   ) {
+    const color = this.getColorByLogLevel(logLevel);
     messages.forEach(message => {
-      const pidMessage = this.formatPid(process.pid);
+      const output = isPlainObject(message)
+        ? `${color('Object:')}\n${JSON.stringify(
+            message,
+            (key, value) =>
+              typeof value === 'bigint' ? value.toString() : value,
+            2,
+          )}\n`
+        : color(message as string);
+
+      const pidMessage = color(`[Nest] ${process.pid}  - `);
       const contextMessage = context ? yellow(`[${context}] `) : '';
       const timestampDiff = this.updateAndGetTimestampDiff();
-      const formattedLogLevel = logLevel.toUpperCase().padStart(7, ' ');
-      const formatedMessage = this.formatMessage(
-        logLevel,
-        message,
-        pidMessage,
-        formattedLogLevel,
-        contextMessage,
-        timestampDiff,
-      );
+      const formattedLogLevel = color(logLevel.toUpperCase().padStart(7, ' '));
+      const computedMessage = `${pidMessage}${this.getTimestamp()} ${formattedLogLevel} ${contextMessage}${output}${timestampDiff}\n`;
 
-      process[writeStreamType ?? 'stdout'].write(formatedMessage);
+      process[writeStreamType ?? 'stdout'].write(computedMessage);
     });
   }
 
-  protected formatPid(pid: number) {
-    return `[Nest] ${pid}  - `;
-  }
-
-  protected formatMessage(
-    logLevel: LogLevel,
-    message: unknown,
-    pidMessage: string,
-    formattedLogLevel: string,
-    contextMessage: string,
-    timestampDiff: string,
-  ) {
-    const output = this.stringifyMessage(message, logLevel);
-    pidMessage = this.colorize(pidMessage, logLevel);
-    formattedLogLevel = this.colorize(formattedLogLevel, logLevel);
-    return `${pidMessage}${this.getTimestamp()} ${formattedLogLevel} ${contextMessage}${output}${timestampDiff}\n`;
-  }
-
-  protected stringifyMessage(message: unknown, logLevel: LogLevel) {
-    return isPlainObject(message)
-      ? `${this.colorize('Object:', logLevel)}\n${JSON.stringify(
-          message,
-          (key, value) =>
-            typeof value === 'bigint' ? value.toString() : value,
-          2,
-        )}\n`
-      : this.colorize(message as string, logLevel);
-  }
-
-  protected colorize(message: string, logLevel: LogLevel) {
-    const color = this.getColorByLogLevel(logLevel);
-    return color(message);
-  }
-
   protected printStackTrace(stack: string) {
     if (!stack) {
       return;
diff --git a/packages/common/utils/is-uuid.ts b/packages/common/utils/is-uuid.ts
new file mode 100644
index 000000000..0e9572f4d
--- /dev/null
+++ b/packages/common/utils/is-uuid.ts
@@ -0,0 +1,17 @@
+import { BadRequestException } from '../exceptions';
+import { isString } from './shared.utils';
+
+const uuid = {
+  3: /^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,
+  4: /^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,
+  5: /^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,
+  all: /^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i,
+};
+
+export function isUUID(str: any, version = 'all') {
+  if (!isString(str)) {
+    throw new BadRequestException('The value passed as UUID is not a string');
+  }
+  const pattern = uuid[version];
+  return pattern && pattern.test(str);
+}
diff --git a/packages/core/Readme.md b/packages/core/Readme.md
index a5e43201d..772d0077a 100644
--- a/packages/core/Readme.md
+++ b/packages/core/Readme.md
@@ -54,7 +54,7 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
 <table style="text-align:center;"><tr>
@@ -64,20 +64,17 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
 <td>
 <a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
-    <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
 </tr></table>
 
 #### Gold Sponsors
 
 <table style="text-align:center;"><tr><td>
   <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="140" valign="middle" /></a></td>
+<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
+  <td>
+<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
 <td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td>
- <td>
-<a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
-<a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td></</tr></table>
+<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
diff --git a/packages/core/index.ts b/packages/core/index.ts
index ebc30ca4c..2915304ab 100644
--- a/packages/core/index.ts
+++ b/packages/core/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @core
- * Copyright(c) 2017 - 2022 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2021 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
diff --git a/packages/core/injector/container.ts b/packages/core/injector/container.ts
index 138524a5c..b50957d38 100644
--- a/packages/core/injector/container.ts
+++ b/packages/core/injector/container.ts
@@ -154,13 +154,13 @@ export class NestContainer {
     provider: Provider,
     token: string,
   ): string | symbol | Function {
-    const moduleRef = this.modules.get(token);
     if (!provider) {
-      throw new CircularDependencyException(moduleRef?.metatype.name);
+      throw new CircularDependencyException();
     }
-    if (!moduleRef) {
+    if (!this.modules.has(token)) {
       throw new UnknownModuleException();
     }
+    const moduleRef = this.modules.get(token);
     return moduleRef.addProvider(provider);
   }
 
diff --git a/packages/core/injector/injector.ts b/packages/core/injector/injector.ts
index d4e8c232d..67996afb3 100644
--- a/packages/core/injector/injector.ts
+++ b/packages/core/injector/injector.ts
@@ -1,9 +1,4 @@
-import {
-  InjectionToken,
-  Logger,
-  LoggerService,
-  OptionalFactoryDependency,
-} from '@nestjs/common';
+import { Logger, LoggerService } from '@nestjs/common';
 import {
   OPTIONAL_DEPS_METADATA,
   OPTIONAL_PROPERTY_DEPS_METADATA,
@@ -20,7 +15,6 @@ import {
   isNil,
   isObject,
   isString,
-  isSymbol,
   isUndefined,
 } from '@nestjs/common/utils/shared.utils';
 import { iterate } from 'iterare';
@@ -40,13 +34,13 @@ import { InstanceToken, Module } from './module';
 /**
  * The type of an injectable dependency
  */
-export type InjectorDependency = InjectionToken;
+export type InjectorDependency = Type<any> | Function | string | symbol;
 
 /**
  * The property-based dependency
  */
 export interface PropertyDependency {
-  key: symbol | string;
+  key: string;
   name: InjectorDependency;
   isOptional?: boolean;
   instance?: any;
@@ -125,7 +119,7 @@ export class Injector {
       const properties = await this.resolveProperties(
         wrapper,
         moduleRef,
-        inject as InjectionToken[],
+        inject,
         contextId,
         wrapper,
         inquirer,
@@ -143,7 +137,7 @@ export class Injector {
     await this.resolveConstructorParams<T>(
       wrapper,
       moduleRef,
-      inject as InjectionToken[],
+      inject,
       callback,
       contextId,
       wrapper,
@@ -252,11 +246,12 @@ export class Injector {
       );
       return callback(deps);
     }
-
-    const isFactoryProvider = !isNil(inject);
-    const [dependencies, optionalDependenciesIds] = isFactoryProvider
-      ? this.getFactoryProviderDependencies(wrapper)
-      : this.getClassDependencies(wrapper);
+    const dependencies = isNil(inject)
+      ? this.reflectConstructorParams(wrapper.metatype as Type<any>)
+      : inject;
+    const optionalDependenciesIds = isNil(inject)
+      ? this.reflectOptionalParams(wrapper.metatype as Type<any>)
+      : [];
 
     let isResolved = true;
     const resolveParam = async (param: unknown, index: number) => {
@@ -297,47 +292,6 @@ export class Injector {
     isResolved && (await callback(instances));
   }
 
-  public getClassDependencies<T>(
-    wrapper: InstanceWrapper<T>,
-  ): [InjectorDependency[], number[]] {
-    const ctorRef = wrapper.metatype as Type<any>;
-    return [
-      this.reflectConstructorParams(ctorRef),
-      this.reflectOptionalParams(ctorRef),
-    ];
-  }
-
-  public getFactoryProviderDependencies<T>(
-    wrapper: InstanceWrapper<T>,
-  ): [InjectorDependency[], number[]] {
-    const optionalDependenciesIds = [];
-    const isOptionalFactoryDep = (
-      item: InjectionToken | OptionalFactoryDependency,
-    ): item is OptionalFactoryDependency =>
-      !isUndefined((item as OptionalFactoryDependency).token) &&
-      !isUndefined((item as OptionalFactoryDependency).optional);
-
-    const mapFactoryProviderInjectArray = (
-      item: InjectionToken | OptionalFactoryDependency,
-      index: number,
-    ): InjectionToken => {
-      if (typeof item !== 'object') {
-        return item;
-      }
-      if (isOptionalFactoryDep(item)) {
-        if (item.optional) {
-          optionalDependenciesIds.push(index);
-        }
-        return item?.token;
-      }
-      return item;
-    };
-    return [
-      wrapper.inject?.map?.(mapFactoryProviderInjectArray),
-      optionalDependenciesIds,
-    ];
-  }
-
   public reflectConstructorParams<T>(type: Type<T>): any[] {
     const paramtypes = Reflect.getMetadata(PARAMTYPES_METADATA, type) || [];
     const selfParams = this.reflectSelfParams<T>(type);
@@ -361,7 +315,7 @@ export class Injector {
     moduleRef: Module,
     contextId = STATIC_CONTEXT,
     inquirer?: InstanceWrapper,
-    keyOrIndex?: symbol | string | number,
+    keyOrIndex?: string | number,
   ) {
     if (isUndefined(param)) {
       this.logger.log(
@@ -403,7 +357,7 @@ export class Injector {
     wrapper: InstanceWrapper<T>,
     contextId = STATIC_CONTEXT,
     inquirer?: InstanceWrapper,
-    keyOrIndex?: symbol | string | number,
+    keyOrIndex?: string | number,
   ): Promise<InstanceWrapper> {
     this.printResolvingDependenciesLog(token, inquirer);
     this.printLookingForProviderLog(token, moduleRef);
@@ -438,12 +392,7 @@ export class Injector {
       inquirerId,
     );
     if (!instanceHost.isResolved && !instanceWrapper.forwardRef) {
-      await this.loadProvider(
-        instanceWrapper,
-        instanceWrapper.host ?? moduleRef,
-        contextId,
-        inquirer,
-      );
+      await this.loadProvider(instanceWrapper, moduleRef, contextId, inquirer);
     } else if (
       !instanceHost.isResolved &&
       instanceWrapper.forwardRef &&
@@ -479,11 +428,10 @@ export class Injector {
     wrapper: InstanceWrapper<T>,
     contextId = STATIC_CONTEXT,
     inquirer?: InstanceWrapper,
-    keyOrIndex?: symbol | string | number,
+    keyOrIndex?: string | number,
   ): Promise<InstanceWrapper<T>> {
-    const token = wrapper.token || wrapper.name;
     const { name } = dependencyContext;
-    if (wrapper && token === name) {
+    if (wrapper && wrapper.name === name) {
       throw new UnknownDependenciesException(
         wrapper.name,
         dependencyContext,
@@ -512,7 +460,7 @@ export class Injector {
     wrapper: InstanceWrapper<T>,
     contextId = STATIC_CONTEXT,
     inquirer?: InstanceWrapper,
-    keyOrIndex?: symbol | string | number,
+    keyOrIndex?: string | number,
   ) {
     const instanceWrapper = await this.lookupComponentInImports(
       moduleRef,
@@ -540,7 +488,7 @@ export class Injector {
     moduleRegistry: any[] = [],
     contextId = STATIC_CONTEXT,
     inquirer?: InstanceWrapper,
-    keyOrIndex?: symbol | string | number,
+    keyOrIndex?: string | number,
     isTraversing?: boolean,
   ): Promise<any> {
     let instanceWrapperRef: InstanceWrapper = null;
@@ -831,15 +779,13 @@ export class Injector {
   }
 
   protected addDependencyMetadata(
-    keyOrIndex: symbol | string | number,
+    keyOrIndex: number | string,
     hostWrapper: InstanceWrapper,
     instanceWrapper: InstanceWrapper,
   ) {
-    if (isSymbol(keyOrIndex) || isString(keyOrIndex)) {
-      hostWrapper.addPropertiesMetadata(keyOrIndex, instanceWrapper);
-    } else {
-      hostWrapper.addCtorMetadata(keyOrIndex, instanceWrapper);
-    }
+    isString(keyOrIndex)
+      ? hostWrapper.addPropertiesMetadata(keyOrIndex, instanceWrapper)
+      : hostWrapper.addCtorMetadata(keyOrIndex, instanceWrapper);
   }
 
   private getTokenName(token: InstanceToken): string {
diff --git a/packages/core/injector/instance-wrapper.ts b/packages/core/injector/instance-wrapper.ts
index 239e89dea..9d9d29579 100644
--- a/packages/core/injector/instance-wrapper.ts
+++ b/packages/core/injector/instance-wrapper.ts
@@ -24,7 +24,7 @@ export interface InstancePerContext<T> {
   donePromise?: Promise<void>;
 }
 export interface PropertyMetadata {
-  key: symbol | string;
+  key: string;
   wrapper: InstanceWrapper;
 }
 
@@ -43,7 +43,7 @@ export class InstanceWrapper<T = any> {
 
   public scope?: Scope = Scope.DEFAULT;
   public metatype: Type<T> | Function;
-  public inject?: FactoryProvider['inject'];
+  public inject?: (string | symbol | Function | Type<any>)[];
   public forwardRef?: boolean;
 
   private readonly values = new WeakMap<ContextId, InstancePerContext<T>>();
@@ -146,7 +146,7 @@ export class InstanceWrapper<T = any> {
     return this[INSTANCE_METADATA_SYMBOL].dependencies;
   }
 
-  public addPropertiesMetadata(key: symbol | string, wrapper: InstanceWrapper) {
+  public addPropertiesMetadata(key: string, wrapper: InstanceWrapper) {
     if (!this[INSTANCE_METADATA_SYMBOL].properties) {
       this[INSTANCE_METADATA_SYMBOL].properties = [];
     }
diff --git a/packages/core/injector/module.ts b/packages/core/injector/module.ts
index 461fd0899..ed3102a01 100644
--- a/packages/core/injector/module.ts
+++ b/packages/core/injector/module.ts
@@ -1,11 +1,11 @@
 import {
+  Abstract,
   ClassProvider,
   Controller,
   DynamicModule,
   ExistingProvider,
   FactoryProvider,
   Injectable,
-  InjectionToken,
   NestModule,
   Provider,
   ValueProvider,
@@ -31,11 +31,12 @@ import { NestContainer } from './container';
 import { InstanceWrapper } from './instance-wrapper';
 import { ModuleRef } from './module-ref';
 
-/**
- * @note
- * Left for backward compatibility
- */
-export type InstanceToken = InjectionToken;
+export type InstanceToken =
+  | string
+  | symbol
+  | Type<any>
+  | Abstract<any>
+  | Function;
 
 export class Module {
   private readonly _id: string;
diff --git a/packages/core/middleware/middleware-module.ts b/packages/core/middleware/middleware-module.ts
index ecb98e1b5..748887811 100644
--- a/packages/core/middleware/middleware-module.ts
+++ b/packages/core/middleware/middleware-module.ts
@@ -9,6 +9,7 @@ import {
   addLeadingSlash,
   isUndefined,
 } from '@nestjs/common/utils/shared.utils';
+import { isRouteExcluded, isRequestMethodAll } from '../router/utils';
 import { ApplicationConfig } from '../application-config';
 import { InvalidMiddlewareException } from '../errors/exceptions/invalid-middleware.exception';
 import { RuntimeException } from '../errors/exceptions/runtime.exception';
@@ -22,7 +23,6 @@ import { InstanceToken, Module } from '../injector/module';
 import { REQUEST_CONTEXT_ID } from '../router/request/request-constants';
 import { RouterExceptionFilters } from '../router/router-exception-filters';
 import { RouterProxy } from '../router/router-proxy';
-import { isRequestMethodAll, isRouteExcluded } from '../router/utils';
 import { MiddlewareBuilder } from './builder';
 import { MiddlewareContainer } from './container';
 import { MiddlewareResolver } from './resolver';
@@ -274,9 +274,8 @@ export class MiddlewareModule {
     const prefix = this.config.getGlobalPrefix();
     const excludedRoutes = this.config.getGlobalPrefixOptions().exclude;
     if (
-      (Array.isArray(excludedRoutes) &&
-        isRouteExcluded(excludedRoutes, path, method)) ||
-      ['*', '/*', '(.*)', '/(.*)'].includes(path)
+      Array.isArray(excludedRoutes) &&
+      isRouteExcluded(excludedRoutes, path, method)
     ) {
       path = addLeadingSlash(path);
     } else {
diff --git a/packages/core/nest-application-context.ts b/packages/core/nest-application-context.ts
index c6e3799a1..a61b9b8b0 100644
--- a/packages/core/nest-application-context.ts
+++ b/packages/core/nest-application-context.ts
@@ -324,7 +324,6 @@ export class NestApplicationContext implements INestApplicationContext {
       wrapperRef.host,
       collection,
       contextId,
-      wrapperRef,
     );
     if (!instance) {
       throw new UnknownElementException();
diff --git a/packages/core/package.json b/packages/core/package.json
index 498884211..0daf73db9 100644
--- a/packages/core/package.json
+++ b/packages/core/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/core",
-  "version": "8.4.5",
+  "version": "8.3.1",
   "description": "Nest - modern, fast, powerful node.js web framework (@core)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -30,13 +30,13 @@
     "@nuxtjs/opencollective": "0.3.2",
     "fast-safe-stringify": "2.1.1",
     "iterare": "1.2.1",
-    "object-hash": "3.0.0",
+    "object-hash": "2.2.0",
     "path-to-regexp": "3.2.0",
-    "tslib": "2.4.0",
+    "tslib": "2.3.1",
     "uuid": "8.3.2"
   },
   "devDependencies": {
-    "@nestjs/common": "8.4.5"
+    "@nestjs/common": "8.3.1"
   },
   "peerDependencies": {
     "@nestjs/common": "^8.0.0",
diff --git a/packages/core/router/router-explorer.ts b/packages/core/router/router-explorer.ts
index ab0517dc5..153bf29b4 100644
--- a/packages/core/router/router-explorer.ts
+++ b/packages/core/router/router-explorer.ts
@@ -338,7 +338,8 @@ export class RouterExplorer {
       return router.applyVersionFilter(handler, version, versioningOptions);
     }
     /**
-     * TODO(v9): This was left for backward-compatibility and can be removed.
+     * This can be removed in the next major release.
+     * Left for backward-compatibility.
      */
     return <TRequest extends Record<string, any> = any, TResponse = any>(
       req: TRequest,
@@ -352,47 +353,6 @@ export class RouterExplorer {
       if (versioningOptions.type === VersioningType.URI) {
         return handler(req, res, next);
       }
-
-      // Custom Extractor Versioning Handler
-      if (versioningOptions.type === VersioningType.CUSTOM) {
-        const extractedVersion = versioningOptions.extractor(req) as
-          | string
-          | string[]
-          | Array<string | symbol>;
-
-        if (Array.isArray(version)) {
-          if (
-            Array.isArray(extractedVersion) &&
-            version.filter(
-              extractedVersion.includes as (
-                value: string | symbol,
-                index: number,
-                array: Array<string | symbol>,
-              ) => boolean,
-            ).length
-          ) {
-            return handler(req, res, next);
-          } else if (
-            isString(extractedVersion) &&
-            version.includes(extractedVersion)
-          ) {
-            return handler(req, res, next);
-          }
-        } else {
-          if (
-            Array.isArray(extractedVersion) &&
-            extractedVersion.includes(version)
-          ) {
-            return handler(req, res, next);
-          } else if (
-            isString(extractedVersion) &&
-            version === extractedVersion
-          ) {
-            return handler(req, res, next);
-          }
-        }
-      }
-
       // Media Type (Accept Header) Versioning Handler
       if (versioningOptions.type === VersioningType.MEDIA_TYPE) {
         const MEDIA_TYPE_HEADER = 'Accept';
@@ -402,16 +362,9 @@ export class RouterExplorer {
 
         const acceptHeaderVersionParameter = acceptHeaderValue
           ? acceptHeaderValue.split(';')[1]
-          : undefined;
+          : '';
 
-        // No version was supplied
-        if (isUndefined(acceptHeaderVersionParameter)) {
-          if (Array.isArray(version)) {
-            if (version.includes(VERSION_NEUTRAL)) {
-              return handler(req, res, next);
-            }
-          }
-        } else {
+        if (acceptHeaderVersionParameter) {
           const headerVersion = acceptHeaderVersionParameter.split(
             versioningOptions.key,
           )[1];
@@ -433,14 +386,7 @@ export class RouterExplorer {
           req.headers?.[versioningOptions.header] ||
           req.headers?.[versioningOptions.header.toLowerCase()];
 
-        // No version was supplied
-        if (isUndefined(customHeaderVersionParameter)) {
-          if (Array.isArray(version)) {
-            if (version.includes(VERSION_NEUTRAL)) {
-              return handler(req, res, next);
-            }
-          }
-        } else {
+        if (customHeaderVersionParameter) {
           if (Array.isArray(version)) {
             if (version.includes(customHeaderVersionParameter)) {
               return handler(req, res, next);
diff --git a/packages/core/router/router-response-controller.ts b/packages/core/router/router-response-controller.ts
index 4128e7fca..008eea5a8 100644
--- a/packages/core/router/router-response-controller.ts
+++ b/packages/core/router/router-response-controller.ts
@@ -5,9 +5,9 @@ import {
   RequestMethod,
   MessageEvent,
 } from '@nestjs/common';
-import { isObject } from '@nestjs/common/utils/shared.utils';
+import { isFunction, isObject } from '@nestjs/common/utils/shared.utils';
 import { IncomingMessage } from 'http';
-import { EMPTY, lastValueFrom, Observable, isObservable } from 'rxjs';
+import { EMPTY, lastValueFrom, Observable } from 'rxjs';
 import { catchError, debounce, map } from 'rxjs/operators';
 import {
   AdditionalHeaders,
@@ -64,7 +64,7 @@ export class RouterResponseController {
   }
 
   public async transformToResult(resultOrDeferred: any) {
-    if (isObservable(resultOrDeferred)) {
+    if (resultOrDeferred && isFunction(resultOrDeferred.subscribe)) {
       return lastValueFrom(resultOrDeferred);
     }
     return resultOrDeferred;
@@ -152,8 +152,8 @@ export class RouterResponseController {
     });
   }
 
-  private assertObservable(value: any) {
-    if (!isObservable(value)) {
+  private assertObservable(result: any) {
+    if (!isFunction(result.subscribe)) {
       throw new ReferenceError(
         'You must return an Observable stream to use Server-Sent Events (SSE).',
       );
diff --git a/packages/core/scanner.ts b/packages/core/scanner.ts
index 63d02a6c2..c318dba07 100644
--- a/packages/core/scanner.ts
+++ b/packages/core/scanner.ts
@@ -1,17 +1,18 @@
 import {
+  Abstract,
   DynamicModule,
   flatten,
   ForwardReference,
-  Logger,
   Provider,
+  Logger,
 } from '@nestjs/common';
 import {
-  CATCH_WATERMARK,
-  CONTROLLER_WATERMARK,
   EXCEPTION_FILTERS_METADATA,
   GUARDS_METADATA,
-  INJECTABLE_WATERMARK,
   INTERCEPTORS_METADATA,
+  INJECTABLE_WATERMARK,
+  CONTROLLER_WATERMARK,
+  CATCH_WATERMARK,
   MODULE_METADATA,
   PIPES_METADATA,
   ROUTE_ARGS_METADATA,
@@ -22,7 +23,6 @@ import {
   ExceptionFilter,
   ExistingProvider,
   FactoryProvider,
-  InjectionToken,
   NestInterceptor,
   PipeTransform,
   Scope,
@@ -41,8 +41,8 @@ import { iterate } from 'iterare';
 import { ApplicationConfig } from './application-config';
 import { APP_FILTER, APP_GUARD, APP_INTERCEPTOR, APP_PIPE } from './constants';
 import { CircularDependencyException } from './errors/exceptions/circular-dependency.exception';
-import { InvalidClassModuleException } from './errors/exceptions/invalid-class-module.exception';
 import { InvalidModuleException } from './errors/exceptions/invalid-module.exception';
+import { InvalidClassModuleException } from './errors/exceptions/invalid-class-module.exception';
 import { UndefinedModuleException } from './errors/exceptions/undefined-module.exception';
 import { getClassScope } from './helpers/get-class-scope';
 import { NestContainer } from './injector/container';
@@ -54,7 +54,7 @@ import { MetadataScanner } from './metadata-scanner';
 interface ApplicationProviderWrapper {
   moduleKey: string;
   providerKey: string;
-  type: InjectionToken;
+  type: string | symbol | Type<any> | Abstract<any> | Function;
   scope?: Scope;
 }
 
diff --git a/packages/microservices/Readme.md b/packages/microservices/Readme.md
index a5e43201d..772d0077a 100644
--- a/packages/microservices/Readme.md
+++ b/packages/microservices/Readme.md
@@ -54,7 +54,7 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
 <table style="text-align:center;"><tr>
@@ -64,20 +64,17 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
 <td>
 <a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
-    <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
 </tr></table>
 
 #### Gold Sponsors
 
 <table style="text-align:center;"><tr><td>
   <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="140" valign="middle" /></a></td>
+<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
+  <td>
+<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
 <td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td>
- <td>
-<a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
-<a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td></</tr></table>
+<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
diff --git a/packages/microservices/client/client-kafka.ts b/packages/microservices/client/client-kafka.ts
index 2715d5ed7..99c85e53f 100644
--- a/packages/microservices/client/client-kafka.ts
+++ b/packages/microservices/client/client-kafka.ts
@@ -19,7 +19,6 @@ import {
   KafkaConfig,
   KafkaMessage,
   Producer,
-  TopicPartitionOffsetAndMetadata,
 } from '../external/kafka.interface';
 import {
   KafkaLogger,
@@ -192,9 +191,7 @@ export class ClientKafka extends ClientProxy {
 
   protected async dispatchEvent(packet: OutgoingEvent): Promise<any> {
     const pattern = this.normalizePattern(packet.pattern);
-    const outgoingEvent = await this.serializer.serialize(packet.data, {
-      pattern,
-    });
+    const outgoingEvent = await this.serializer.serialize(packet.data);
     const message = Object.assign(
       {
         topic: pattern,
@@ -234,7 +231,7 @@ export class ClientKafka extends ClientProxy {
       const replyTopic = this.getResponsePatternName(pattern);
       const replyPartition = this.getReplyTopicPartition(replyTopic);
 
-      Promise.resolve(this.serializer.serialize(packet.data, { pattern }))
+      Promise.resolve(this.serializer.serialize(packet.data))
         .then((serializedPacket: KafkaRequest) => {
           serializedPacket.headers[KafkaHeaders.CORRELATION_ID] = packet.id;
           serializedPacket.headers[KafkaHeaders.REPLY_TOPIC] = replyTopic;
@@ -287,14 +284,4 @@ export class ClientKafka extends ClientProxy {
     this.deserializer =
       (options && options.deserializer) || new KafkaResponseDeserializer();
   }
-
-  public commitOffsets(
-    topicPartitions: TopicPartitionOffsetAndMetadata[],
-  ): Promise<void> {
-    if (this.consumer) {
-      return this.consumer.commitOffsets(topicPartitions);
-    } else {
-      throw new Error('No consumer initialized');
-    }
-  }
 }
diff --git a/packages/microservices/client/client-mqtt.ts b/packages/microservices/client/client-mqtt.ts
index 44cf246b1..8797b56f8 100644
--- a/packages/microservices/client/client-mqtt.ts
+++ b/packages/microservices/client/client-mqtt.ts
@@ -174,14 +174,11 @@ export class ClientMqtt extends ClientProxy {
     const serializedPacket: ReadPacket & Partial<MqttRecord> =
       this.serializer.serialize(packet);
 
-    const options = serializedPacket.options;
-    delete serializedPacket.options;
-
     return new Promise<void>((resolve, reject) =>
       this.mqttClient.publish(
         pattern,
         JSON.stringify(serializedPacket),
-        this.mergePacketOptions(options),
+        this.mergePacketOptions(serializedPacket.options),
         (err: any) => (err ? reject(err) : resolve()),
       ),
     );
diff --git a/packages/microservices/client/client-rmq.ts b/packages/microservices/client/client-rmq.ts
index a8b1e64fd..945b7d6d1 100644
--- a/packages/microservices/client/client-rmq.ts
+++ b/packages/microservices/client/client-rmq.ts
@@ -3,7 +3,7 @@ import { loadPackage } from '@nestjs/common/utils/load-package.util';
 import { randomStringGenerator } from '@nestjs/common/utils/random-string-generator.util';
 import { EventEmitter } from 'events';
 import { EmptyError, fromEvent, lastValueFrom, merge, Observable } from 'rxjs';
-import { first, map, retryWhen, scan, share, switchMap } from 'rxjs/operators';
+import { first, map, share, switchMap } from 'rxjs/operators';
 import {
   CONNECT_FAILED_EVENT,
   DISCONNECTED_RMQ_MESSAGE,
@@ -118,20 +118,7 @@ export class ClientRMQ extends ClientProxy {
         }),
       );
     const disconnect$ = eventToError(DISCONNECT_EVENT);
-
-    const urls = this.getOptionsProp(this.options, 'urls', []);
-    const connectFailed$ = eventToError(CONNECT_FAILED_EVENT).pipe(
-      retryWhen(e =>
-        e.pipe(
-          scan((errorCount, error: any) => {
-            if (urls.indexOf(error.url) >= urls.length - 1) {
-              throw error;
-            }
-            return errorCount + 1;
-          }, 0),
-        ),
-      ),
-    );
+    const connectFailed$ = eventToError(CONNECT_FAILED_EVENT);
     return merge(source$, disconnect$, connectFailed$).pipe(first());
   }
 
@@ -235,17 +222,14 @@ export class ClientRMQ extends ClientProxy {
     const serializedPacket: ReadPacket & Partial<RmqRecord> =
       this.serializer.serialize(packet);
 
-    const options = serializedPacket.options;
-    delete serializedPacket.options;
-
     return new Promise<void>((resolve, reject) =>
       this.channel.sendToQueue(
         this.queue,
         Buffer.from(JSON.stringify(serializedPacket)),
         {
           persistent: this.persistent,
-          ...options,
-          headers: this.mergeHeaders(options?.headers),
+          ...serializedPacket.options,
+          headers: this.mergeHeaders(serializedPacket.options?.headers),
         },
         (err: unknown) => (err ? reject(err) : resolve()),
       ),
diff --git a/packages/microservices/client/client-tcp.ts b/packages/microservices/client/client-tcp.ts
index 840452c8f..f16c6407c 100644
--- a/packages/microservices/client/client-tcp.ts
+++ b/packages/microservices/client/client-tcp.ts
@@ -1,4 +1,4 @@
-import { Logger, Type } from '@nestjs/common';
+import { Logger } from '@nestjs/common';
 import * as net from 'net';
 import { EmptyError, lastValueFrom } from 'rxjs';
 import { share, tap } from 'rxjs/operators';
@@ -10,7 +10,7 @@ import {
   TCP_DEFAULT_HOST,
   TCP_DEFAULT_PORT,
 } from '../constants';
-import { JsonSocket, TcpSocket } from '../helpers';
+import { JsonSocket } from '../helpers/json-socket';
 import { PacketId, ReadPacket, WritePacket } from '../interfaces';
 import { TcpClientOptions } from '../interfaces/client-metadata.interface';
 import { ClientProxy } from './client-proxy';
@@ -20,23 +20,20 @@ export class ClientTCP extends ClientProxy {
   private readonly logger = new Logger(ClientTCP.name);
   private readonly port: number;
   private readonly host: string;
-  private readonly socketClass: Type<TcpSocket>;
   private isConnected = false;
-  private socket: TcpSocket;
+  private socket: JsonSocket;
 
   constructor(options: TcpClientOptions['options']) {
     super();
     this.port = this.getOptionsProp(options, 'port') || TCP_DEFAULT_PORT;
     this.host = this.getOptionsProp(options, 'host') || TCP_DEFAULT_HOST;
-    this.socketClass =
-      this.getOptionsProp(options, 'socketClass') || JsonSocket;
 
     this.initializeSerializer(options);
     this.initializeDeserializer(options);
   }
 
   public connect(): Promise<any> {
-    if (this.connection) {
+    if (this.isConnected && this.connection) {
       return this.connection;
     }
     this.socket = this.createSocket();
@@ -83,8 +80,8 @@ export class ClientTCP extends ClientProxy {
     });
   }
 
-  public createSocket(): TcpSocket {
-    return new this.socketClass(new net.Socket());
+  public createSocket(): JsonSocket {
+    return new JsonSocket(new net.Socket());
   }
 
   public close() {
@@ -92,7 +89,7 @@ export class ClientTCP extends ClientProxy {
     this.handleClose();
   }
 
-  public bindEvents(socket: TcpSocket) {
+  public bindEvents(socket: JsonSocket) {
     socket.on(
       ERROR_EVENT,
       (err: any) => err.code !== ECONNREFUSED && this.handleError(err),
@@ -107,7 +104,6 @@ export class ClientTCP extends ClientProxy {
   public handleClose() {
     this.isConnected = false;
     this.socket = null;
-    this.connection = undefined;
   }
 
   protected publish(
diff --git a/packages/microservices/ctx-host/tcp.context.ts b/packages/microservices/ctx-host/tcp.context.ts
index 1f1c6a28d..a858ea442 100644
--- a/packages/microservices/ctx-host/tcp.context.ts
+++ b/packages/microservices/ctx-host/tcp.context.ts
@@ -1,7 +1,7 @@
-import { TcpSocket } from '../helpers';
+import { JsonSocket } from '../helpers/json-socket';
 import { BaseRpcContext } from './base-rpc.context';
 
-type TcpContextArgs = [TcpSocket, string];
+type TcpContextArgs = [JsonSocket, string];
 
 export class TcpContext extends BaseRpcContext<TcpContextArgs> {
   constructor(args: TcpContextArgs) {
diff --git a/packages/microservices/decorators/event-pattern.decorator.ts b/packages/microservices/decorators/event-pattern.decorator.ts
index 34708b007..57bf07a41 100644
--- a/packages/microservices/decorators/event-pattern.decorator.ts
+++ b/packages/microservices/decorators/event-pattern.decorator.ts
@@ -1,9 +1,4 @@
-import {
-  isObject,
-  isNumber,
-  isNil,
-  isSymbol,
-} from '@nestjs/common/utils/shared.utils';
+import { isObject, isNumber, isNil } from '@nestjs/common/utils/shared.utils';
 import {
   PATTERN_HANDLER_METADATA,
   PATTERN_METADATA,
@@ -18,29 +13,26 @@ import { Transport } from '../enums';
  */
 export const EventPattern: {
   <T = string>(metadata?: T): MethodDecorator;
-  <T = string>(metadata?: T, transport?: Transport | symbol): MethodDecorator;
+  <T = string>(metadata?: T, transport?: Transport): MethodDecorator;
   <T = string>(metadata?: T, extras?: Record<string, any>): MethodDecorator;
   <T = string>(
     metadata?: T,
-    transport?: Transport | symbol,
+    transport?: Transport,
     extras?: Record<string, any>,
   ): MethodDecorator;
 } = <T = string>(
   metadata?: T,
-  transportOrExtras?: Transport | symbol | Record<string, any>,
+  transportOrExtras?: Transport | Record<string, any>,
   maybeExtras?: Record<string, any>,
 ): MethodDecorator => {
-  let transport: Transport | symbol;
+  let transport: Transport;
   let extras: Record<string, any>;
-  if (
-    (isNumber(transportOrExtras) || isSymbol(transportOrExtras)) &&
-    isNil(maybeExtras)
-  ) {
+  if (isNumber(transportOrExtras) && isNil(maybeExtras)) {
     transport = transportOrExtras;
   } else if (isObject(transportOrExtras) && isNil(maybeExtras)) {
     extras = transportOrExtras;
   } else {
-    transport = transportOrExtras as Transport | symbol;
+    transport = transportOrExtras as Transport;
     extras = maybeExtras;
   }
   return (
@@ -48,7 +40,11 @@ export const EventPattern: {
     key: string | symbol,
     descriptor: PropertyDescriptor,
   ) => {
-    Reflect.defineMetadata(PATTERN_METADATA, metadata, descriptor.value);
+    Reflect.defineMetadata(
+      PATTERN_METADATA,
+      [].concat(metadata),
+      descriptor.value,
+    );
     Reflect.defineMetadata(
       PATTERN_HANDLER_METADATA,
       PatternHandler.EVENT,
diff --git a/packages/microservices/decorators/message-pattern.decorator.ts b/packages/microservices/decorators/message-pattern.decorator.ts
index 3e17d8569..553fe3363 100644
--- a/packages/microservices/decorators/message-pattern.decorator.ts
+++ b/packages/microservices/decorators/message-pattern.decorator.ts
@@ -1,9 +1,4 @@
-import {
-  isObject,
-  isNumber,
-  isNil,
-  isSymbol,
-} from '@nestjs/common/utils/shared.utils';
+import { isObject, isNumber, isNil } from '@nestjs/common/utils/shared.utils';
 /* eslint-disable @typescript-eslint/no-use-before-define */
 import {
   PATTERN_HANDLER_METADATA,
@@ -28,7 +23,7 @@ export const MessagePattern: {
   <T = PatternMetadata | string>(metadata?: T): MethodDecorator;
   <T = PatternMetadata | string>(
     metadata?: T,
-    transport?: Transport | symbol,
+    transport?: Transport,
   ): MethodDecorator;
   <T = PatternMetadata | string>(
     metadata?: T,
@@ -36,25 +31,22 @@ export const MessagePattern: {
   ): MethodDecorator;
   <T = PatternMetadata | string>(
     metadata?: T,
-    transport?: Transport | symbol,
+    transport?: Transport,
     extras?: Record<string, any>,
   ): MethodDecorator;
 } = <T = PatternMetadata | string>(
   metadata?: T,
-  transportOrExtras?: Transport | symbol | Record<string, any>,
+  transportOrExtras?: Transport | Record<string, any>,
   maybeExtras?: Record<string, any>,
 ): MethodDecorator => {
-  let transport: Transport | symbol;
+  let transport: Transport;
   let extras: Record<string, any>;
-  if (
-    (isNumber(transportOrExtras) || isSymbol(transportOrExtras)) &&
-    isNil(maybeExtras)
-  ) {
+  if (isNumber(transportOrExtras) && isNil(maybeExtras)) {
     transport = transportOrExtras;
   } else if (isObject(transportOrExtras) && isNil(maybeExtras)) {
     extras = transportOrExtras;
   } else {
-    transport = transportOrExtras as Transport | symbol;
+    transport = transportOrExtras as Transport;
     extras = maybeExtras;
   }
   return (
@@ -62,7 +54,11 @@ export const MessagePattern: {
     key: string | symbol,
     descriptor: PropertyDescriptor,
   ) => {
-    Reflect.defineMetadata(PATTERN_METADATA, metadata, descriptor.value);
+    Reflect.defineMetadata(
+      PATTERN_METADATA,
+      [].concat(metadata),
+      descriptor.value,
+    );
     Reflect.defineMetadata(
       PATTERN_HANDLER_METADATA,
       PatternHandler.MESSAGE,
diff --git a/packages/microservices/helpers/index.ts b/packages/microservices/helpers/index.ts
index ff6118b51..a02fe778e 100644
--- a/packages/microservices/helpers/index.ts
+++ b/packages/microservices/helpers/index.ts
@@ -2,4 +2,3 @@ export * from './json-socket';
 export * from './kafka-logger';
 export * from './kafka-parser';
 export * from './kafka-reply-partition-assigner';
-export * from './tcp-socket';
diff --git a/packages/microservices/helpers/json-socket.ts b/packages/microservices/helpers/json-socket.ts
index 5d017f9b5..0320e0dbc 100644
--- a/packages/microservices/helpers/json-socket.ts
+++ b/packages/microservices/helpers/json-socket.ts
@@ -1,29 +1,83 @@
-import { Buffer } from 'buffer';
+import { Socket } from 'net';
 import { StringDecoder } from 'string_decoder';
+import {
+  CLOSE_EVENT,
+  CONNECT_EVENT,
+  DATA_EVENT,
+  ERROR_EVENT,
+  MESSAGE_EVENT,
+} from '../constants';
 import { CorruptedPacketLengthException } from '../errors/corrupted-packet-length.exception';
-import { TcpSocket } from './tcp-socket';
+import { InvalidJSONFormatException } from '../errors/invalid-json-format.exception';
+import { NetSocketClosedException } from '../errors/net-socket-closed.exception';
 
-export class JsonSocket extends TcpSocket {
+export class JsonSocket {
   private contentLength: number | null = null;
+  private isClosed = false;
   private buffer = '';
 
   private readonly stringDecoder = new StringDecoder();
-  private readonly delimiter = '#';
+  private readonly delimeter = '#';
 
-  protected handleSend(message: any, callback?: (err?: any) => void) {
+  public get netSocket() {
+    return this.socket;
+  }
+
+  constructor(public readonly socket: Socket) {
+    this.socket.on(DATA_EVENT, this.onData.bind(this));
+    this.socket.on(CONNECT_EVENT, () => (this.isClosed = false));
+    this.socket.on(CLOSE_EVENT, () => (this.isClosed = true));
+    this.socket.on(ERROR_EVENT, () => (this.isClosed = true));
+  }
+
+  public connect(port: number, host: string) {
+    this.socket.connect(port, host);
+    return this;
+  }
+
+  public on(event: string, callback: (err?: any) => void) {
+    this.socket.on(event, callback);
+    return this;
+  }
+
+  public once(event: string, callback: (err?: any) => void) {
+    this.socket.once(event, callback);
+    return this;
+  }
+
+  public end() {
+    this.socket.end();
+    return this;
+  }
+
+  public sendMessage(message: any, callback?: (err?: any) => void) {
+    if (this.isClosed) {
+      callback && callback(new NetSocketClosedException());
+      return;
+    }
     this.socket.write(this.formatMessageData(message), 'utf-8', callback);
   }
 
-  protected handleData(dataRaw: Buffer | string) {
+  private onData(dataRaw: Buffer | string) {
     const data = Buffer.isBuffer(dataRaw)
       ? this.stringDecoder.write(dataRaw)
       : dataRaw;
+
+    try {
+      this.handleData(data);
+    } catch (e) {
+      this.socket.emit(ERROR_EVENT, e.message);
+      this.socket.end();
+    }
+  }
+
+  private handleData(data: string) {
     this.buffer += data;
 
     if (this.contentLength == null) {
-      const i = this.buffer.indexOf(this.delimiter);
+      const i = this.buffer.indexOf(this.delimeter);
       /**
-       * Check if the buffer has the delimiter (#),
+       * Check if the buffer has the delimeter (#),
        * if not, the end of the buffer string might be in the middle of a content length string
        */
       if (i !== -1) {
@@ -41,27 +95,36 @@ export class JsonSocket extends TcpSocket {
 
     if (this.contentLength !== null) {
       const length = this.buffer.length;
+
       if (length === this.contentLength) {
         this.handleMessage(this.buffer);
       } else if (length > this.contentLength) {
         const message = this.buffer.substring(0, this.contentLength);
         const rest = this.buffer.substring(this.contentLength);
         this.handleMessage(message);
-        this.handleData(rest);
+        this.onData(rest);
       }
     }
   }
 
-  private handleMessage(message: any) {
+  private handleMessage(data: string) {
     this.contentLength = null;
     this.buffer = '';
-    this.emitMessage(message);
+
+    let message: Record<string, unknown>;
+    try {
+      message = JSON.parse(data);
+    } catch (e) {
+      throw new InvalidJSONFormatException(e, data);
+    }
+    message = message || {};
+    this.socket.emit(MESSAGE_EVENT, message);
   }
 
   private formatMessageData(message: any) {
     const messageData = JSON.stringify(message);
     const length = messageData.length;
-    const data = length + this.delimiter + messageData;
+    const data = length + this.delimeter + messageData;
     return data;
   }
 }
diff --git a/packages/microservices/helpers/tcp-socket.ts b/packages/microservices/helpers/tcp-socket.ts
deleted file mode 100644
index cca8fe94d..000000000
--- a/packages/microservices/helpers/tcp-socket.ts
+++ /dev/null
@@ -1,78 +0,0 @@
-import { Buffer } from 'buffer';
-import { Socket } from 'net';
-import {
-  CLOSE_EVENT,
-  CONNECT_EVENT,
-  DATA_EVENT,
-  ERROR_EVENT,
-  MESSAGE_EVENT,
-} from '../constants';
-import { NetSocketClosedException } from '../errors/net-socket-closed.exception';
-import { InvalidJSONFormatException } from '../errors/invalid-json-format.exception';
-
-export abstract class TcpSocket {
-  private isClosed = false;
-
-  public get netSocket() {
-    return this.socket;
-  }
-
-  constructor(public readonly socket: Socket) {
-    this.socket.on(DATA_EVENT, this.onData.bind(this));
-    this.socket.on(CONNECT_EVENT, () => (this.isClosed = false));
-    this.socket.on(CLOSE_EVENT, () => (this.isClosed = true));
-    this.socket.on(ERROR_EVENT, () => (this.isClosed = true));
-  }
-
-  public connect(port: number, host: string) {
-    this.socket.connect(port, host);
-    return this;
-  }
-
-  public on(event: string, callback: (err?: any) => void) {
-    this.socket.on(event, callback);
-    return this;
-  }
-
-  public once(event: string, callback: (err?: any) => void) {
-    this.socket.once(event, callback);
-    return this;
-  }
-
-  public end() {
-    this.socket.end();
-    return this;
-  }
-
-  public sendMessage(message: any, callback?: (err?: any) => void) {
-    if (this.isClosed) {
-      callback && callback(new NetSocketClosedException());
-      return;
-    }
-    this.handleSend(message, callback);
-  }
-
-  protected abstract handleSend(message: any, callback?: (err?: any) => void);
-
-  private onData(data: Buffer) {
-    try {
-      this.handleData(data);
-    } catch (e) {
-      this.socket.emit(ERROR_EVENT, e.message);
-      this.socket.end();
-    }
-  }
-
-  protected abstract handleData(data: Buffer | string);
-
-  protected emitMessage(data: string) {
-    let message: Record<string, unknown>;
-    try {
-      message = JSON.parse(data);
-    } catch (e) {
-      throw new InvalidJSONFormatException(e, data);
-    }
-    message = message || {};
-    this.socket.emit(MESSAGE_EVENT, message);
-  }
-}
diff --git a/packages/microservices/index.ts b/packages/microservices/index.ts
index 886c0be72..81f4992ef 100644
--- a/packages/microservices/index.ts
+++ b/packages/microservices/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @microservices
- * Copyright(c) 2017 - 2022 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2021 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
diff --git a/packages/microservices/interfaces/client-metadata.interface.ts b/packages/microservices/interfaces/client-metadata.interface.ts
index ace44c265..4962eecc1 100644
--- a/packages/microservices/interfaces/client-metadata.interface.ts
+++ b/packages/microservices/interfaces/client-metadata.interface.ts
@@ -1,6 +1,5 @@
 import { Type } from '@nestjs/common';
 import { ClientProxy } from '../client';
-import { TcpSocket } from '../helpers';
 import { Transport } from '../enums/transport.enum';
 import { Deserializer } from './deserializer.interface';
 import {
@@ -34,6 +33,5 @@ export interface TcpClientOptions {
     port?: number;
     serializer?: Serializer;
     deserializer?: Deserializer;
-    socketClass?: Type<TcpSocket>;
   };
 }
diff --git a/packages/microservices/interfaces/custom-transport-strategy.interface.ts b/packages/microservices/interfaces/custom-transport-strategy.interface.ts
index 358d77b97..b5d5b2760 100644
--- a/packages/microservices/interfaces/custom-transport-strategy.interface.ts
+++ b/packages/microservices/interfaces/custom-transport-strategy.interface.ts
@@ -1,7 +1,7 @@
 import { Transport } from '../enums';
 
 export interface CustomTransportStrategy {
-  readonly transportId?: Transport | symbol;
+  readonly transportId?: Transport;
   listen(callback: (...optionalParams: unknown[]) => any): any;
   close(): any;
 }
diff --git a/packages/microservices/interfaces/microservice-configuration.interface.ts b/packages/microservices/interfaces/microservice-configuration.interface.ts
index 9fd257e69..9942b8b55 100644
--- a/packages/microservices/interfaces/microservice-configuration.interface.ts
+++ b/packages/microservices/interfaces/microservice-configuration.interface.ts
@@ -1,5 +1,3 @@
-import { Type } from '@nestjs/common';
-import { TcpSocket } from '../helpers';
 import { Transport } from '../enums/transport.enum';
 import { ChannelOptions } from '../external/grpc-options.interface';
 import {
@@ -82,7 +80,6 @@ export interface TcpOptions {
     retryDelay?: number;
     serializer?: Serializer;
     deserializer?: Deserializer;
-    socketClass?: Type<TcpSocket>;
   };
 }
 
diff --git a/packages/microservices/interfaces/serializer.interface.ts b/packages/microservices/interfaces/serializer.interface.ts
index f8d0c8c25..6674cd6b1 100644
--- a/packages/microservices/interfaces/serializer.interface.ts
+++ b/packages/microservices/interfaces/serializer.interface.ts
@@ -5,7 +5,7 @@ import {
 } from './packet.interface';
 
 export interface Serializer<TInput = any, TOutput = any> {
-  serialize(value: TInput, options?: Record<string, any>): TOutput;
+  serialize(value: TInput): TOutput;
 }
 
 export type ProducerSerializer = Serializer<
diff --git a/packages/microservices/listener-metadata-explorer.ts b/packages/microservices/listener-metadata-explorer.ts
index 83e8f04c2..66ddffaf0 100644
--- a/packages/microservices/listener-metadata-explorer.ts
+++ b/packages/microservices/listener-metadata-explorer.ts
@@ -20,7 +20,7 @@ export interface ClientProperties {
 }
 
 export interface EventOrMessageListenerDefinition {
-  pattern: PatternMetadata;
+  patterns: PatternMetadata[];
   methodKey: string;
   isEventHandler: boolean;
   targetCallback: (...args: any[]) => any;
@@ -58,13 +58,13 @@ export class ListenerMetadataExplorer {
     if (isUndefined(handlerType)) {
       return;
     }
-    const pattern = Reflect.getMetadata(PATTERN_METADATA, targetCallback);
+    const patterns = Reflect.getMetadata(PATTERN_METADATA, targetCallback);
     const transport = Reflect.getMetadata(TRANSPORT_METADATA, targetCallback);
     const extras = Reflect.getMetadata(PATTERN_EXTRAS_METADATA, targetCallback);
     return {
       methodKey,
       targetCallback,
-      pattern,
+      patterns,
       transport,
       extras,
       isEventHandler: handlerType === PatternHandler.EVENT,
diff --git a/packages/microservices/listeners-controller.ts b/packages/microservices/listeners-controller.ts
index 7687ccf46..abc77d597 100644
--- a/packages/microservices/listeners-controller.ts
+++ b/packages/microservices/listeners-controller.ts
@@ -71,8 +71,20 @@ export class ListenersController {
           isUndefined(server.transportId) ||
           transport === server.transportId,
       )
+      .reduce((acc, handler) => {
+        handler.patterns.forEach(pattern =>
+          acc.push({ ...handler, patterns: [pattern] }),
+        );
+        return acc;
+      }, [])
       .forEach(
-        ({ pattern, targetCallback, methodKey, extras, isEventHandler }) => {
+        ({
+          patterns: [pattern],
+          targetCallback,
+          methodKey,
+          extras,
+          isEventHandler,
+        }) => {
           if (isStatic) {
             const proxy = this.contextCreator.create(
               instance as object,
diff --git a/packages/microservices/package.json b/packages/microservices/package.json
index b6c8cf0fb..4ade69ee8 100644
--- a/packages/microservices/package.json
+++ b/packages/microservices/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/microservices",
-  "version": "8.4.5",
+  "version": "8.3.1",
   "description": "Nest - modern, fast, powerful node.js web framework (@microservices)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -19,11 +19,11 @@
   "dependencies": {
     "iterare": "1.2.1",
     "json-socket": "0.3.0",
-    "tslib": "2.4.0"
+    "tslib": "2.3.1"
   },
   "devDependencies": {
-    "@nestjs/common": "8.4.5",
-    "@nestjs/core": "8.4.5"
+    "@nestjs/common": "8.3.1",
+    "@nestjs/core": "8.3.1"
   },
   "peerDependencies": {
     "@grpc/grpc-js": "*",
diff --git a/packages/microservices/server/server-kafka.ts b/packages/microservices/server/server-kafka.ts
index 829d30d91..e7fcd8786 100644
--- a/packages/microservices/server/server-kafka.ts
+++ b/packages/microservices/server/server-kafka.ts
@@ -163,10 +163,9 @@ export class ServerKafka extends Server implements CustomTransportStrategy {
       payload.partition,
       payload.topic,
     ]);
-    const handler = this.getHandlerByPattern(packet.pattern);
     // if the correlation id or reply topic is not set
     // then this is an event (events could still have correlation id)
-    if (handler?.isEventHandler || !correlationId || !replyTopic) {
+    if (!correlationId || !replyTopic) {
       return this.handleEvent(packet.pattern, packet, kafkaContext);
     }
 
@@ -175,7 +174,7 @@ export class ServerKafka extends Server implements CustomTransportStrategy {
       replyPartition,
       correlationId,
     );
-
+    const handler = this.getHandlerByPattern(packet.pattern);
     if (!handler) {
       return publish({
         id: correlationId,
diff --git a/packages/microservices/server/server-mqtt.ts b/packages/microservices/server/server-mqtt.ts
index 46a647a7a..6ba956b68 100644
--- a/packages/microservices/server/server-mqtt.ts
+++ b/packages/microservices/server/server-mqtt.ts
@@ -1,4 +1,5 @@
 import { isUndefined } from '@nestjs/common/utils/shared.utils';
+import { Observable } from 'rxjs';
 import {
   CONNECT_EVENT,
   ERROR_EVENT,
@@ -195,20 +196,13 @@ export class ServerMqtt extends Server implements CustomTransportStrategy {
       ) {
         continue;
       }
-      const keyWithoutSharedPrefix = this.removeHandlerKeySharedPrefix(key);
-      if (this.matchMqttPattern(keyWithoutSharedPrefix, route)) {
+      if (this.matchMqttPattern(key, route)) {
         return value;
       }
     }
     return null;
   }
 
-  public removeHandlerKeySharedPrefix(handlerKey: string) {
-    return handlerKey && handlerKey.startsWith('$share')
-      ? handlerKey.split('/').slice(2).join('/')
-      : handlerKey;
-  }
-
   public getRequestPattern(pattern: string): string {
     return pattern;
   }
diff --git a/packages/microservices/server/server-tcp.ts b/packages/microservices/server/server-tcp.ts
index 7a14e60ba..6ef786aba 100644
--- a/packages/microservices/server/server-tcp.ts
+++ b/packages/microservices/server/server-tcp.ts
@@ -1,4 +1,3 @@
-import { Type } from '@nestjs/common';
 import { isString, isUndefined } from '@nestjs/common/utils/shared.utils';
 import * as net from 'net';
 import { Server as NetSocket, Socket } from 'net';
@@ -14,7 +13,7 @@ import {
 } from '../constants';
 import { TcpContext } from '../ctx-host/tcp.context';
 import { Transport } from '../enums';
-import { JsonSocket, TcpSocket } from '../helpers';
+import { JsonSocket } from '../helpers/json-socket';
 import {
   CustomTransportStrategy,
   IncomingRequest,
@@ -30,7 +29,6 @@ export class ServerTCP extends Server implements CustomTransportStrategy {
 
   private readonly port: number;
   private readonly host: string;
-  private readonly socketClass: Type<TcpSocket>;
   private server: NetSocket;
   private isExplicitlyTerminated = false;
   private retryAttemptsCount = 0;
@@ -39,8 +37,6 @@ export class ServerTCP extends Server implements CustomTransportStrategy {
     super();
     this.port = this.getOptionsProp(options, 'port') || TCP_DEFAULT_PORT;
     this.host = this.getOptionsProp(options, 'host') || TCP_DEFAULT_HOST;
-    this.socketClass =
-      this.getOptionsProp(options, 'socketClass') || JsonSocket;
 
     this.init();
     this.initializeSerializer(options);
@@ -72,7 +68,7 @@ export class ServerTCP extends Server implements CustomTransportStrategy {
     readSocket.on(ERROR_EVENT, this.handleError.bind(this));
   }
 
-  public async handleMessage(socket: TcpSocket, rawMessage: unknown) {
+  public async handleMessage(socket: JsonSocket, rawMessage: unknown) {
     const packet = await this.deserializer.deserialize(rawMessage);
     const pattern = !isString(packet.pattern)
       ? JSON.stringify(packet.pattern)
@@ -128,7 +124,7 @@ export class ServerTCP extends Server implements CustomTransportStrategy {
     this.server.on(CLOSE_EVENT, this.handleClose.bind(this));
   }
 
-  private getSocketInstance(socket: Socket): TcpSocket {
-    return new this.socketClass(socket);
+  private getSocketInstance(socket: Socket): JsonSocket {
+    return new JsonSocket(socket);
   }
 }
diff --git a/packages/platform-express/Readme.md b/packages/platform-express/Readme.md
index a5e43201d..772d0077a 100644
--- a/packages/platform-express/Readme.md
+++ b/packages/platform-express/Readme.md
@@ -54,7 +54,7 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
 <table style="text-align:center;"><tr>
@@ -64,20 +64,17 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
 <td>
 <a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
-    <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
 </tr></table>
 
 #### Gold Sponsors
 
 <table style="text-align:center;"><tr><td>
   <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="140" valign="middle" /></a></td>
+<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
+  <td>
+<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
 <td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td>
- <td>
-<a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
-<a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td></</tr></table>
+<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
diff --git a/packages/platform-express/adapters/express-adapter.ts b/packages/platform-express/adapters/express-adapter.ts
index b8dcf9340..afe1b782e 100644
--- a/packages/platform-express/adapters/express-adapter.ts
+++ b/packages/platform-express/adapters/express-adapter.ts
@@ -19,7 +19,6 @@ import {
   isNil,
   isObject,
   isString,
-  isUndefined,
 } from '@nestjs/common/utils/shared.utils';
 import { AbstractHttpAdapter } from '@nestjs/core/adapters/http-adapter';
 import { RouterMethodFactory } from '@nestjs/core/helpers/router-method-factory';
@@ -49,24 +48,12 @@ export class ExpressAdapter extends AbstractHttpAdapter {
     }
     if (body instanceof StreamableFile) {
       const streamHeaders = body.getHeaders();
-      if (
-        response.getHeader('Content-Type') === undefined &&
-        streamHeaders.type !== undefined
-      ) {
+      if (response.getHeader('Content-Type') === undefined) {
         response.setHeader('Content-Type', streamHeaders.type);
       }
-      if (
-        response.getHeader('Content-Disposition') === undefined &&
-        streamHeaders.disposition !== undefined
-      ) {
+      if (response.getHeader('Content-Disposition') === undefined) {
         response.setHeader('Content-Disposition', streamHeaders.disposition);
       }
-      if (
-        response.getHeader('Content-Length') === undefined &&
-        streamHeaders.length !== undefined
-      ) {
-        response.setHeader('Content-Length', streamHeaders.length);
-      }
       return body.getStream().pipe(response);
     }
     return isObject(body) ? response.json(body) : response.send(String(body));
@@ -212,42 +199,6 @@ export class ExpressAdapter extends AbstractHttpAdapter {
       if (versioningOptions.type === VersioningType.URI) {
         return handler(req, res, next);
       }
-
-      // Custom Extractor Versioning Handler
-      if (versioningOptions.type === VersioningType.CUSTOM) {
-        const extractedVersion = versioningOptions.extractor(req);
-
-        if (Array.isArray(version)) {
-          if (
-            Array.isArray(extractedVersion) &&
-            version.filter(v => extractedVersion.includes(v as string)).length
-          ) {
-            return handler(req, res, next);
-          } else if (
-            isString(extractedVersion) &&
-            version.includes(extractedVersion)
-          ) {
-            return handler(req, res, next);
-          }
-        } else if (isString(version)) {
-          // Known bug here - if there are multiple versions supported across separate
-          // handlers/controllers, we can't select the highest matching handler.
-          // Since this code is evaluated per-handler, then we can't see if the highest
-          // specified version exists in a different handler.
-          if (
-            Array.isArray(extractedVersion) &&
-            extractedVersion.includes(version)
-          ) {
-            return handler(req, res, next);
-          } else if (
-            isString(extractedVersion) &&
-            version === extractedVersion
-          ) {
-            return handler(req, res, next);
-          }
-        }
-      }
-
       // Media Type (Accept Header) Versioning Handler
       if (versioningOptions.type === VersioningType.MEDIA_TYPE) {
         const MEDIA_TYPE_HEADER = 'Accept';
@@ -257,16 +208,9 @@ export class ExpressAdapter extends AbstractHttpAdapter {
 
         const acceptHeaderVersionParameter = acceptHeaderValue
           ? acceptHeaderValue.split(';')[1]
-          : undefined;
+          : '';
 
-        // No version was supplied
-        if (isUndefined(acceptHeaderVersionParameter)) {
-          if (Array.isArray(version)) {
-            if (version.includes(VERSION_NEUTRAL)) {
-              return handler(req, res, next);
-            }
-          }
-        } else {
+        if (acceptHeaderVersionParameter) {
           const headerVersion = acceptHeaderVersionParameter.split(
             versioningOptions.key,
           )[1];
@@ -288,14 +232,7 @@ export class ExpressAdapter extends AbstractHttpAdapter {
           req.headers?.[versioningOptions.header] ||
           req.headers?.[versioningOptions.header.toLowerCase()];
 
-        // No version was supplied
-        if (isUndefined(customHeaderVersionParameter)) {
-          if (Array.isArray(version)) {
-            if (version.includes(VERSION_NEUTRAL)) {
-              return handler(req, res, next);
-            }
-          }
-        } else {
+        if (customHeaderVersionParameter) {
           if (Array.isArray(version)) {
             if (version.includes(customHeaderVersionParameter)) {
               return handler(req, res, next);
diff --git a/packages/platform-express/index.ts b/packages/platform-express/index.ts
index 0ed4c2d76..df03ac629 100644
--- a/packages/platform-express/index.ts
+++ b/packages/platform-express/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @platform-express
- * Copyright(c) 2017 - 2022 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2021 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
diff --git a/packages/platform-express/package.json b/packages/platform-express/package.json
index e97c6d882..baa5a1b81 100644
--- a/packages/platform-express/package.json
+++ b/packages/platform-express/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/platform-express",
-  "version": "8.4.5",
+  "version": "8.3.1",
   "description": "Nest - modern, fast, powerful node.js web framework (@platform-express)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -17,15 +17,15 @@
     "access": "public"
   },
   "dependencies": {
-    "body-parser": "1.20.0",
+    "body-parser": "1.19.2",
     "cors": "2.8.5",
-    "express": "4.18.1",
+    "express": "4.17.3",
     "multer": "1.4.4",
-    "tslib": "2.4.0"
+    "tslib": "2.3.1"
   },
   "devDependencies": {
-    "@nestjs/common": "8.4.5",
-    "@nestjs/core": "8.4.5"
+    "@nestjs/common": "8.3.1",
+    "@nestjs/core": "8.3.1"
   },
   "peerDependencies": {
     "@nestjs/common": "^8.0.0",
diff --git a/packages/platform-fastify/Readme.md b/packages/platform-fastify/Readme.md
index a5e43201d..772d0077a 100644
--- a/packages/platform-fastify/Readme.md
+++ b/packages/platform-fastify/Readme.md
@@ -54,7 +54,7 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
 <table style="text-align:center;"><tr>
@@ -64,20 +64,17 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
 <td>
 <a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
-    <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
 </tr></table>
 
 #### Gold Sponsors
 
 <table style="text-align:center;"><tr><td>
   <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="140" valign="middle" /></a></td>
+<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
+  <td>
+<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
 <td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td>
- <td>
-<a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
-<a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td></</tr></table>
+<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
diff --git a/packages/platform-fastify/adapters/fastify-adapter.ts b/packages/platform-fastify/adapters/fastify-adapter.ts
index ebf64274e..b2867926d 100644
--- a/packages/platform-fastify/adapters/fastify-adapter.ts
+++ b/packages/platform-fastify/adapters/fastify-adapter.ts
@@ -115,27 +115,23 @@ export class FastifyAdapter<
       }
     },
     storage() {
-      const versions = new Map<string, unknown>();
+      const versions = new Map();
       return {
         get(version: string | Array<string>) {
-          if (Array.isArray(version)) {
-            return versions.get(version.find(v => versions.has(v))) || null;
-          }
           return versions.get(version) || null;
         },
-        set(versionOrVersions: string | Array<string>, store: unknown) {
-          const storeVersionConstraint = (version: string) =>
+        set(
+          versionOrVersions: string | Array<string>,
+          store: Map<string, any>,
+        ) {
+          const storeVersionConstraint = version =>
             versions.set(version, store);
           if (Array.isArray(versionOrVersions))
             versionOrVersions.forEach(storeVersionConstraint);
           else storeVersionConstraint(versionOrVersions);
         },
         del(version: string | Array<string>) {
-          if (Array.isArray(version)) {
-            version.forEach(v => versions.delete(v));
-          } else {
-            versions.delete(version);
-          }
+          versions.delete(version);
         },
         empty() {
           versions.clear();
@@ -154,9 +150,12 @@ export class FastifyAdapter<
           ? acceptHeaderValue.split(';')[1]
           : '';
 
-        return isUndefined(acceptHeaderVersionParameter)
-          ? VERSION_NEUTRAL // No version was supplied
-          : acceptHeaderVersionParameter.split(this.versioningOptions.key)[1];
+        if (acceptHeaderVersionParameter) {
+          const headerVersion = acceptHeaderVersionParameter.split(
+            this.versioningOptions.key,
+          )[1];
+          return headerVersion;
+        }
       }
       // Header Versioning Handler
       else if (this.versioningOptions.type === VersioningType.HEADER) {
@@ -164,13 +163,9 @@ export class FastifyAdapter<
           req.headers?.[this.versioningOptions.header] ||
           req.headers?.[this.versioningOptions.header.toLowerCase()];
 
-        return isUndefined(customHeaderVersionParameter)
-          ? VERSION_NEUTRAL // No version was supplied
-          : customHeaderVersionParameter;
-      }
-      // Custom Versioning Handler
-      else if (this.versioningOptions.type === VersioningType.CUSTOM) {
-        return this.versioningOptions.extractor(req);
+        if (customHeaderVersionParameter) {
+          return customHeaderVersionParameter;
+        }
       }
       return undefined;
     },
@@ -287,24 +282,12 @@ export class FastifyAdapter<
     }
     if (body instanceof StreamableFile) {
       const streamHeaders = body.getHeaders();
-      if (
-        fastifyReply.getHeader('Content-Type') === undefined &&
-        streamHeaders.type !== undefined
-      ) {
+      if (fastifyReply.getHeader('Content-Type') === undefined) {
         fastifyReply.header('Content-Type', streamHeaders.type);
       }
-      if (
-        fastifyReply.getHeader('Content-Disposition') === undefined &&
-        streamHeaders.disposition !== undefined
-      ) {
+      if (fastifyReply.getHeader('Content-Disposition') === undefined) {
         fastifyReply.header('Content-Disposition', streamHeaders.disposition);
       }
-      if (
-        fastifyReply.getHeader('Content-Length') === undefined &&
-        streamHeaders.length !== undefined
-      ) {
-        fastifyReply.header('Content-Length', streamHeaders.length);
-      }
       body = body.getStream();
     }
     return fastifyReply.send(body);
diff --git a/packages/platform-fastify/index.ts b/packages/platform-fastify/index.ts
index 2918a05af..6ee0f8cf9 100644
--- a/packages/platform-fastify/index.ts
+++ b/packages/platform-fastify/index.ts
@@ -1,6 +1,6 @@
 /*
- * Nest @platform-fastify
- * Copyright(c) 2017 - 2022 Kamil Mysliwiec
+ * Nest @platform-express
+ * Copyright(c) 2017 - 2021 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
diff --git a/packages/platform-fastify/package.json b/packages/platform-fastify/package.json
index d284ad585..4cf5d529e 100644
--- a/packages/platform-fastify/package.json
+++ b/packages/platform-fastify/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/platform-fastify",
-  "version": "8.4.5",
+  "version": "8.3.1",
   "description": "Nest - modern, fast, powerful node.js web framework (@platform-fastify)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -17,13 +17,13 @@
     "access": "public"
   },
   "dependencies": {
-    "fastify": "3.29.0",
-    "fastify-cors": "6.1.0",
-    "fastify-formbody": "5.3.0",
-    "light-my-request": "4.10.1",
-    "middie": "6.1.0",
+    "fastify": "3.27.1",
+    "fastify-cors": "6.0.2",
+    "fastify-formbody": "5.2.0",
+    "light-my-request": "4.8.0",
+    "middie": "6.0.0",
     "path-to-regexp": "3.2.0",
-    "tslib": "2.4.0"
+    "tslib": "2.3.1"
   },
   "peerDependencies": {
     "@nestjs/common": "^8.0.0",
diff --git a/packages/platform-socket.io/Readme.md b/packages/platform-socket.io/Readme.md
index a5e43201d..772d0077a 100644
--- a/packages/platform-socket.io/Readme.md
+++ b/packages/platform-socket.io/Readme.md
@@ -54,7 +54,7 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
 <table style="text-align:center;"><tr>
@@ -64,20 +64,17 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
 <td>
 <a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
-    <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
 </tr></table>
 
 #### Gold Sponsors
 
 <table style="text-align:center;"><tr><td>
   <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="140" valign="middle" /></a></td>
+<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
+  <td>
+<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
 <td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td>
- <td>
-<a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
-<a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td></</tr></table>
+<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
diff --git a/packages/platform-socket.io/index.ts b/packages/platform-socket.io/index.ts
index 2805fc831..175a4e0d6 100644
--- a/packages/platform-socket.io/index.ts
+++ b/packages/platform-socket.io/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @platform-socket.io
- * Copyright(c) 2017 - 2022 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2021 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
diff --git a/packages/platform-socket.io/package.json b/packages/platform-socket.io/package.json
index 2d9ac8a0a..2973386e5 100644
--- a/packages/platform-socket.io/package.json
+++ b/packages/platform-socket.io/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/platform-socket.io",
-  "version": "8.4.5",
+  "version": "8.3.1",
   "description": "Nest - modern, fast, powerful node.js web framework (@platform-socket.io)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -17,8 +17,8 @@
     "access": "public"
   },
   "dependencies": {
-    "socket.io": "4.5.0",
-    "tslib": "2.4.0"
+    "socket.io": "4.4.1",
+    "tslib": "2.3.1"
   },
   "peerDependencies": {
     "@nestjs/common": "^8.0.0",
diff --git a/packages/platform-ws/Readme.md b/packages/platform-ws/Readme.md
index a5e43201d..772d0077a 100644
--- a/packages/platform-ws/Readme.md
+++ b/packages/platform-ws/Readme.md
@@ -54,7 +54,7 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
 <table style="text-align:center;"><tr>
@@ -64,20 +64,17 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
 <td>
 <a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
-    <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
 </tr></table>
 
 #### Gold Sponsors
 
 <table style="text-align:center;"><tr><td>
   <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="140" valign="middle" /></a></td>
+<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
+  <td>
+<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
 <td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td>
- <td>
-<a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
-<a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td></</tr></table>
+<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
diff --git a/packages/platform-ws/index.ts b/packages/platform-ws/index.ts
index 0fb20dd10..e1b9386e4 100644
--- a/packages/platform-ws/index.ts
+++ b/packages/platform-ws/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @platform-ws
- * Copyright(c) 2017 - 2022 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2021 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
diff --git a/packages/platform-ws/package.json b/packages/platform-ws/package.json
index 16b8e0932..46df4f973 100644
--- a/packages/platform-ws/package.json
+++ b/packages/platform-ws/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/platform-ws",
-  "version": "8.4.5",
+  "version": "8.3.1",
   "description": "Nest - modern, fast, powerful node.js web framework (@platform-ws)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -17,8 +17,8 @@
     "access": "public"
   },
   "dependencies": {
-    "tslib": "2.4.0",
-    "ws": "8.6.0"
+    "tslib": "2.3.1",
+    "ws": "7.5.6"
   },
   "peerDependencies": {
     "@nestjs/common": "^8.0.0",
diff --git a/packages/testing/Readme.md b/packages/testing/Readme.md
index a5e43201d..772d0077a 100644
--- a/packages/testing/Readme.md
+++ b/packages/testing/Readme.md
@@ -54,7 +54,7 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
 <table style="text-align:center;"><tr>
@@ -64,20 +64,17 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
 <td>
 <a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
-    <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
 </tr></table>
 
 #### Gold Sponsors
 
 <table style="text-align:center;"><tr><td>
   <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="140" valign="middle" /></a></td>
+<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
+  <td>
+<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
 <td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td>
- <td>
-<a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
-<a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td></</tr></table>
+<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
diff --git a/packages/testing/index.ts b/packages/testing/index.ts
index 0a4a47f73..c68ed76f1 100644
--- a/packages/testing/index.ts
+++ b/packages/testing/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @testing
- * Copyright(c) 2017 - 2022 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2021 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
diff --git a/packages/testing/package.json b/packages/testing/package.json
index 8f6bbdd0a..93341567d 100644
--- a/packages/testing/package.json
+++ b/packages/testing/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/testing",
-  "version": "8.4.5",
+  "version": "8.3.1",
   "description": "Nest - modern, fast, powerful node.js web framework (@testing)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -18,7 +18,7 @@
   },
   "dependencies": {
     "optional": "0.1.4",
-    "tslib": "2.4.0"
+    "tslib": "2.3.1"
   },
   "peerDependencies": {
     "@nestjs/common": "^8.0.0",
diff --git a/packages/tsconfig.base.json b/packages/tsconfig.base.json
index d8d4c2be0..ff837eb4f 100644
--- a/packages/tsconfig.base.json
+++ b/packages/tsconfig.base.json
@@ -11,7 +11,6 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "useUnknownInCatchVariables": false,
     "target": "es2017",
     "sourceMap": false,
     "allowJs": false,
diff --git a/packages/websockets/Readme.md b/packages/websockets/Readme.md
index a5e43201d..772d0077a 100644
--- a/packages/websockets/Readme.md
+++ b/packages/websockets/Readme.md
@@ -54,7 +54,7 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
 <table style="text-align:center;"><tr>
@@ -64,20 +64,17 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
 <td>
 <a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
-    <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
 </tr></table>
 
 #### Gold Sponsors
 
 <table style="text-align:center;"><tr><td>
   <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="140" valign="middle" /></a></td>
+<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
+  <td>
+<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
 <td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td>
- <td>
-<a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
-<a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td></</tr></table>
+<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
diff --git a/packages/websockets/index.ts b/packages/websockets/index.ts
index e8baa6f07..76db23065 100644
--- a/packages/websockets/index.ts
+++ b/packages/websockets/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @websockets
- * Copyright(c) 2017 - 2022 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2021 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
diff --git a/packages/websockets/interfaces/gateway-metadata.interface.ts b/packages/websockets/interfaces/gateway-metadata.interface.ts
index e5ac2e7bc..1666b321f 100644
--- a/packages/websockets/interfaces/gateway-metadata.interface.ts
+++ b/packages/websockets/interfaces/gateway-metadata.interface.ts
@@ -31,22 +31,22 @@ export interface GatewayMetadata {
   parser?: any;
   /**
    * How many ms before a client without namespace is closed
-   * @default 45_000
+   * @default 45000
    */
   connectTimeout?: number;
   /**
    * How many ms without a pong packet to consider the connection closed
-   * @default 20_000
+   * @default 5000
    */
   pingTimeout?: number;
   /**
    * How many ms before sending a new ping packet
-   * @default 25_000
+   * @default 25000
    */
   pingInterval?: number;
   /**
    * How many ms before an uncompleted transport upgrade is cancelled
-   * @default 10_000
+   * @default 10000
    */
   upgradeTimeout?: number;
   /**
@@ -116,7 +116,7 @@ export interface GatewayMetadata {
   destroyUpgrade?: boolean;
   /**
    * Milliseconds after which unhandled requests are ended
-   * @default 1_000
+   * @default 1000
    */
   destroyUpgradeTimeout?: number;
 }
diff --git a/packages/websockets/package.json b/packages/websockets/package.json
index 2766f8408..e632daf56 100644
--- a/packages/websockets/package.json
+++ b/packages/websockets/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/websockets",
-  "version": "8.4.5",
+  "version": "8.3.1",
   "description": "Nest - modern, fast, powerful node.js web framework (@websockets)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -13,12 +13,12 @@
   },
   "dependencies": {
     "iterare": "1.2.1",
-    "object-hash": "3.0.0",
-    "tslib": "2.4.0"
+    "object-hash": "2.2.0",
+    "tslib": "2.3.1"
   },
   "devDependencies": {
-    "@nestjs/common": "8.4.5",
-    "@nestjs/core": "8.4.5"
+    "@nestjs/common": "8.3.1",
+    "@nestjs/core": "8.3.1"
   },
   "peerDependencies": {
     "@nestjs/common": "^8.0.0",
diff --git a/packages/websockets/web-sockets-controller.ts b/packages/websockets/web-sockets-controller.ts
index d01811e17..75e790c82 100644
--- a/packages/websockets/web-sockets-controller.ts
+++ b/packages/websockets/web-sockets-controller.ts
@@ -1,14 +1,9 @@
 import { Type } from '@nestjs/common/interfaces/type.interface';
 import { Logger } from '@nestjs/common/services/logger.service';
+import { isFunction } from '@nestjs/common/utils/shared.utils';
 import { ApplicationConfig } from '@nestjs/core/application-config';
 import { MetadataScanner } from '@nestjs/core/metadata-scanner';
-import {
-  from as fromPromise,
-  Observable,
-  isObservable,
-  of,
-  Subject,
-} from 'rxjs';
+import { from as fromPromise, Observable, of, Subject } from 'rxjs';
 import { distinctUntilChanged, mergeAll } from 'rxjs/operators';
 import { GATEWAY_OPTIONS, PORT_METADATA } from './constants';
 import { WsContextCreator } from './context/ws-context-creator';
@@ -163,7 +158,7 @@ export class WebSocketsController {
     deferredResult: Promise<any>,
   ): Promise<Observable<any>> {
     const result = await deferredResult;
-    if (isObservable(result)) {
+    if (result && isFunction(result.subscribe)) {
       return result;
     }
     if (result instanceof Promise) {
diff --git a/sample/01-cats-app/package-lock.json b/sample/01-cats-app/package-lock.json
index 1f3bf12b1..8705e94da 100644
Binary files a/sample/01-cats-app/package-lock.json and b/sample/01-cats-app/package-lock.json differ
diff --git a/sample/01-cats-app/package.json b/sample/01-cats-app/package.json
index 0f3562953..f2770ffcf 100644
--- a/sample/01-cats-app/package.json
+++ b/sample/01-cats-app/package.json
@@ -30,17 +30,17 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.7",
-    "@nestjs/schematics": "8.0.8",
+    "@nestjs/schematics": "8.0.6",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/jest": "27.4.1",
-    "@types/node": "16.11.26",
+    "@types/jest": "27.4.0",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
     "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
diff --git a/sample/02-gateways/package-lock.json b/sample/02-gateways/package-lock.json
index 450745806..4f47da2a5 100644
Binary files a/sample/02-gateways/package-lock.json and b/sample/02-gateways/package-lock.json differ
diff --git a/sample/02-gateways/package.json b/sample/02-gateways/package.json
index 910a63c62..c2d05bff2 100644
--- a/sample/02-gateways/package.json
+++ b/sample/02-gateways/package.json
@@ -29,15 +29,14 @@
     "class-validator": "0.13.2",
     "reflect-metadata": "0.1.13",
     "rimraf": "3.0.2",
-    "rxjs": "7.4.0",
-    "socket.io": "4.4.1"
+    "rxjs": "7.4.0"
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.7",
-    "@nestjs/schematics": "8.0.8",
+    "@nestjs/schematics": "8.0.6",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.26",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
     "@types/ws": "8.2.2",
     "@typescript-eslint/eslint-plugin": "4.33.0",
@@ -50,7 +49,7 @@
     "redis": "4.0.3",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "typescript": "4.3.5"
diff --git a/sample/03-microservices/package-lock.json b/sample/03-microservices/package-lock.json
index 2081cae2d..3035a96bd 100644
Binary files a/sample/03-microservices/package-lock.json and b/sample/03-microservices/package-lock.json differ
diff --git a/sample/03-microservices/package.json b/sample/03-microservices/package.json
index 9b2e8701c..07f152775 100644
--- a/sample/03-microservices/package.json
+++ b/sample/03-microservices/package.json
@@ -31,17 +31,17 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.7",
-    "@nestjs/schematics": "8.0.8",
+    "@nestjs/schematics": "8.0.6",
     "@nestjs/testing": "8.2.3",
     "@types/amqplib": "0.8.2",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.26",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
     "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
diff --git a/sample/04-grpc/package-lock.json b/sample/04-grpc/package-lock.json
index 3ba2e178e..e63c29876 100644
Binary files a/sample/04-grpc/package-lock.json and b/sample/04-grpc/package-lock.json differ
diff --git a/sample/04-grpc/package.json b/sample/04-grpc/package.json
index 698f661d3..af500e08a 100644
--- a/sample/04-grpc/package.json
+++ b/sample/04-grpc/package.json
@@ -32,10 +32,10 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.8",
+    "@nestjs/schematics": "8.0.6",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.26",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
@@ -46,7 +46,7 @@
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "typescript": "4.3.5"
diff --git a/sample/05-sql-typeorm/.gitignore b/sample/05-sql-typeorm/.gitignore
index 44c92371f..b5e5f9755 100644
--- a/sample/05-sql-typeorm/.gitignore
+++ b/sample/05-sql-typeorm/.gitignore
@@ -13,6 +13,7 @@ npm-debug.log
 /quick-start
 
 # tests
+/test
 /coverage
 /.nyc_output
 
diff --git a/sample/05-sql-typeorm/docker-compose.yml b/sample/05-sql-typeorm/docker-compose.yml
index a8b6aadb8..eee25f209 100644
--- a/sample/05-sql-typeorm/docker-compose.yml
+++ b/sample/05-sql-typeorm/docker-compose.yml
@@ -9,11 +9,3 @@ services:
       MYSQL_DATABASE: test
     ports:
       - "3306:3306"
-  db-test:
-    image: mysql:8
-    restart: always
-    environment:
-      MYSQL_ROOT_PASSWORD: root
-      MYSQL_DATABASE: test
-    ports:
-      - "3307:3306"
\ No newline at end of file
diff --git a/sample/05-sql-typeorm/package-lock.json b/sample/05-sql-typeorm/package-lock.json
index 43f3787dc..ccf4d93fc 100644
Binary files a/sample/05-sql-typeorm/package-lock.json and b/sample/05-sql-typeorm/package-lock.json differ
diff --git a/sample/05-sql-typeorm/package.json b/sample/05-sql-typeorm/package.json
index 422b5c423..32957494c 100644
--- a/sample/05-sql-typeorm/package.json
+++ b/sample/05-sql-typeorm/package.json
@@ -31,11 +31,11 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.7",
-    "@nestjs/schematics": "8.0.8",
+    "@nestjs/schematics": "8.0.6",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/jest": "27.4.1",
-    "@types/node": "16.11.26",
+    "@types/jest": "27.4.0",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
@@ -46,7 +46,7 @@
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "typescript": "4.3.5"
diff --git a/sample/06-mongoose/package-lock.json b/sample/06-mongoose/package-lock.json
index ab94878b6..c0e51bd01 100644
Binary files a/sample/06-mongoose/package-lock.json and b/sample/06-mongoose/package-lock.json differ
diff --git a/sample/06-mongoose/package.json b/sample/06-mongoose/package.json
index 3996e3a4d..c41564ef4 100644
--- a/sample/06-mongoose/package.json
+++ b/sample/06-mongoose/package.json
@@ -30,11 +30,11 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.7",
-    "@nestjs/schematics": "8.0.8",
+    "@nestjs/schematics": "8.0.6",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/jest": "27.4.1",
-    "@types/node": "16.11.26",
+    "@types/jest": "27.4.0",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
@@ -45,7 +45,7 @@
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "typescript": "4.3.5"
diff --git a/sample/07-sequelize/package-lock.json b/sample/07-sequelize/package-lock.json
index 8d7637d7f..0c535509a 100644
Binary files a/sample/07-sequelize/package-lock.json and b/sample/07-sequelize/package-lock.json differ
diff --git a/sample/07-sequelize/package.json b/sample/07-sequelize/package.json
index afd851bfc..53c334868 100644
--- a/sample/07-sequelize/package.json
+++ b/sample/07-sequelize/package.json
@@ -33,11 +33,11 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.8",
+    "@nestjs/schematics": "8.0.6",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/jest": "27.4.1",
-    "@types/node": "16.11.26",
+    "@types/jest": "27.4.0",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
@@ -48,7 +48,7 @@
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "typescript": "4.3.5"
diff --git a/sample/08-webpack/package-lock.json b/sample/08-webpack/package-lock.json
index 79e816fd7..1fa83e251 100644
Binary files a/sample/08-webpack/package-lock.json and b/sample/08-webpack/package-lock.json differ
diff --git a/sample/08-webpack/package.json b/sample/08-webpack/package.json
index bd3082723..0b3cadcf9 100644
--- a/sample/08-webpack/package.json
+++ b/sample/08-webpack/package.json
@@ -20,18 +20,18 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.7",
-    "@nestjs/schematics": "8.0.8",
-    "@types/node": "16.11.26",
+    "@nestjs/schematics": "8.0.6",
+    "@types/node": "16.11.25",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
     "eslint": "7.32.0",
     "eslint-config-prettier": "8.3.0",
     "eslint-plugin-import": "2.25.4",
     "start-server-webpack-plugin": "2.2.5",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "webpack": "5.64.4",
-    "webpack-cli": "4.9.2",
+    "webpack-cli": "4.9.1",
     "webpack-node-externals": "3.0.0"
   }
 }
diff --git a/sample/09-babel-example/package-lock.json b/sample/09-babel-example/package-lock.json
index a1e6c9a1f..6ce71f9af 100644
Binary files a/sample/09-babel-example/package-lock.json and b/sample/09-babel-example/package-lock.json differ
diff --git a/sample/09-babel-example/package.json b/sample/09-babel-example/package.json
index 27e52a508..f5d270b7e 100644
--- a/sample/09-babel-example/package.json
+++ b/sample/09-babel-example/package.json
@@ -22,14 +22,14 @@
     "rxjs": "7.4.0"
   },
   "devDependencies": {
-    "@babel/cli": "7.17.6",
-    "@babel/core": "7.17.8",
+    "@babel/cli": "7.17.3",
+    "@babel/core": "7.17.5",
     "@babel/node": "7.16.8",
-    "@babel/plugin-proposal-decorators": "7.17.8",
+    "@babel/plugin-proposal-decorators": "7.17.2",
     "@babel/plugin-transform-runtime": "7.17.0",
     "@babel/preset-env": "7.16.11",
-    "@babel/register": "7.17.7",
-    "@babel/runtime": "7.17.8",
+    "@babel/register": "7.17.0",
+    "@babel/runtime": "7.17.2",
     "@nestjs/testing": "8.2.3",
     "jest": "27.5.1",
     "nodemon": "2.0.15",
diff --git a/sample/10-fastify/package-lock.json b/sample/10-fastify/package-lock.json
index bdc20017f..a4977c843 100644
Binary files a/sample/10-fastify/package-lock.json and b/sample/10-fastify/package-lock.json differ
diff --git a/sample/10-fastify/package.json b/sample/10-fastify/package.json
index ae7816b8a..74f2965e8 100644
--- a/sample/10-fastify/package.json
+++ b/sample/10-fastify/package.json
@@ -30,10 +30,10 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.7",
-    "@nestjs/schematics": "8.0.8",
+    "@nestjs/schematics": "8.0.6",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.26",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
@@ -44,7 +44,7 @@
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "typescript": "4.3.5"
diff --git a/sample/11-swagger/package-lock.json b/sample/11-swagger/package-lock.json
index 556540eaa..285149409 100644
Binary files a/sample/11-swagger/package-lock.json and b/sample/11-swagger/package-lock.json differ
diff --git a/sample/11-swagger/package.json b/sample/11-swagger/package.json
index 0889b7ad0..7a461eec2 100644
--- a/sample/11-swagger/package.json
+++ b/sample/11-swagger/package.json
@@ -28,20 +28,20 @@
     "reflect-metadata": "0.1.13",
     "rimraf": "3.0.2",
     "rxjs": "7.4.0",
-    "swagger-ui-express": "4.2.0"
+    "swagger-ui-express": "4.1.6"
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.8",
+    "@nestjs/schematics": "8.0.6",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.26",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
     "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
diff --git a/sample/12-graphql-schema-first/package-lock.json b/sample/12-graphql-schema-first/package-lock.json
index 790dda25c..1fc38624c 100644
Binary files a/sample/12-graphql-schema-first/package-lock.json and b/sample/12-graphql-schema-first/package-lock.json differ
diff --git a/sample/12-graphql-schema-first/package.json b/sample/12-graphql-schema-first/package.json
index 44e83e3d6..3f60d710b 100644
--- a/sample/12-graphql-schema-first/package.json
+++ b/sample/12-graphql-schema-first/package.json
@@ -19,7 +19,7 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@graphql-tools/utils": "8.6.3",
+    "@graphql-tools/utils": "8.6.1",
     "@nestjs/apollo": "10.0.0",
     "@nestjs/common": "8.2.3",
     "@nestjs/core": "8.2.3",
@@ -37,10 +37,10 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.8",
+    "@nestjs/schematics": "8.0.6",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.26",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
@@ -51,7 +51,7 @@
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-morph": "12.2.0",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
diff --git a/sample/13-mongo-typeorm/package-lock.json b/sample/13-mongo-typeorm/package-lock.json
index 50260a27e..c80437ec5 100644
Binary files a/sample/13-mongo-typeorm/package-lock.json and b/sample/13-mongo-typeorm/package-lock.json differ
diff --git a/sample/13-mongo-typeorm/package.json b/sample/13-mongo-typeorm/package.json
index 37c15a7ac..b8364ff13 100644
--- a/sample/13-mongo-typeorm/package.json
+++ b/sample/13-mongo-typeorm/package.json
@@ -31,11 +31,11 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.7",
-    "@nestjs/schematics": "8.0.8",
+    "@nestjs/schematics": "8.0.6",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/jest": "27.4.1",
-    "@types/node": "16.11.26",
+    "@types/jest": "27.4.0",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
@@ -46,7 +46,7 @@
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "typescript": "4.3.5"
diff --git a/sample/13-mongo-typeorm/src/photo/photo.service.ts b/sample/13-mongo-typeorm/src/photo/photo.service.ts
index 0bca3ddee..31c751b35 100644
--- a/sample/13-mongo-typeorm/src/photo/photo.service.ts
+++ b/sample/13-mongo-typeorm/src/photo/photo.service.ts
@@ -1,13 +1,13 @@
 import { Injectable } from '@nestjs/common';
 import { InjectRepository } from '@nestjs/typeorm';
-import { MongoRepository } from 'typeorm';
+import { Repository } from 'typeorm';
 import { Photo } from './photo.entity';
 
 @Injectable()
 export class PhotoService {
   constructor(
     @InjectRepository(Photo)
-    private readonly photoRepository: MongoRepository<Photo>,
+    private readonly photoRepository: Repository<Photo>,
   ) {}
 
   async findAll(): Promise<Photo[]> {
diff --git a/sample/14-mongoose-base/package-lock.json b/sample/14-mongoose-base/package-lock.json
index 722193cb0..8b2dd8c24 100644
Binary files a/sample/14-mongoose-base/package-lock.json and b/sample/14-mongoose-base/package-lock.json differ
diff --git a/sample/14-mongoose-base/package.json b/sample/14-mongoose-base/package.json
index aa2d93b68..ecb7ef231 100644
--- a/sample/14-mongoose-base/package.json
+++ b/sample/14-mongoose-base/package.json
@@ -29,11 +29,11 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.8",
+    "@nestjs/schematics": "8.0.6",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/jest": "27.4.1",
-    "@types/node": "16.11.26",
+    "@types/jest": "27.4.0",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
@@ -44,7 +44,7 @@
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "typescript": "4.3.5"
diff --git a/sample/15-mvc/package-lock.json b/sample/15-mvc/package-lock.json
index 702eed649..a1ab804bf 100644
Binary files a/sample/15-mvc/package-lock.json and b/sample/15-mvc/package-lock.json differ
diff --git a/sample/15-mvc/package.json b/sample/15-mvc/package.json
index 826740233..01e32cd94 100644
--- a/sample/15-mvc/package.json
+++ b/sample/15-mvc/package.json
@@ -30,16 +30,16 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.8",
+    "@nestjs/schematics": "8.0.6",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.26",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
     "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
diff --git a/sample/16-gateways-ws/package-lock.json b/sample/16-gateways-ws/package-lock.json
index 644c9c453..ec58f2770 100644
Binary files a/sample/16-gateways-ws/package-lock.json and b/sample/16-gateways-ws/package-lock.json differ
diff --git a/sample/16-gateways-ws/package.json b/sample/16-gateways-ws/package.json
index a5d024427..ed7dedc0c 100644
--- a/sample/16-gateways-ws/package.json
+++ b/sample/16-gateways-ws/package.json
@@ -34,16 +34,16 @@
   "devDependencies": {
     "@types/ws": "7.4.7",
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.8",
+    "@nestjs/schematics": "8.0.6",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.26",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
     "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
diff --git a/sample/17-mvc-fastify/package-lock.json b/sample/17-mvc-fastify/package-lock.json
index 7193960fe..38cfece2b 100644
Binary files a/sample/17-mvc-fastify/package-lock.json and b/sample/17-mvc-fastify/package-lock.json differ
diff --git a/sample/17-mvc-fastify/package.json b/sample/17-mvc-fastify/package.json
index e2c4eb63f..740d998a3 100644
--- a/sample/17-mvc-fastify/package.json
+++ b/sample/17-mvc-fastify/package.json
@@ -31,10 +31,10 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.7",
-    "@nestjs/schematics": "8.0.8",
+    "@nestjs/schematics": "8.0.6",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.26",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
@@ -45,7 +45,7 @@
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "typescript": "4.3.5"
diff --git a/sample/18-context/package-lock.json b/sample/18-context/package-lock.json
index 907d5026c..39d8df37a 100644
Binary files a/sample/18-context/package-lock.json and b/sample/18-context/package-lock.json differ
diff --git a/sample/18-context/package.json b/sample/18-context/package.json
index af397b8f3..b90c4ddfa 100644
--- a/sample/18-context/package.json
+++ b/sample/18-context/package.json
@@ -27,14 +27,14 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.8",
-    "@types/node": "16.11.26",
+    "@nestjs/schematics": "8.0.6",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
     "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
diff --git a/sample/19-auth-jwt/package-lock.json b/sample/19-auth-jwt/package-lock.json
index bbde2473e..8668754ac 100644
Binary files a/sample/19-auth-jwt/package-lock.json and b/sample/19-auth-jwt/package-lock.json differ
diff --git a/sample/19-auth-jwt/package.json b/sample/19-auth-jwt/package.json
index b1fd1c297..6a48e2f61 100644
--- a/sample/19-auth-jwt/package.json
+++ b/sample/19-auth-jwt/package.json
@@ -34,17 +34,17 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.8",
+    "@nestjs/schematics": "8.0.6",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/jest": "27.4.1",
-    "@types/node": "16.11.26",
+    "@types/jest": "27.4.0",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
     "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
diff --git a/sample/20-cache/package-lock.json b/sample/20-cache/package-lock.json
index c4f66a4a0..2a9943c86 100644
Binary files a/sample/20-cache/package-lock.json and b/sample/20-cache/package-lock.json differ
diff --git a/sample/20-cache/package.json b/sample/20-cache/package.json
index 0429ef329..f0e3a974e 100644
--- a/sample/20-cache/package.json
+++ b/sample/20-cache/package.json
@@ -30,16 +30,16 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.8",
+    "@nestjs/schematics": "8.0.6",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.26",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
     "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
diff --git a/sample/21-serializer/package-lock.json b/sample/21-serializer/package-lock.json
index e38ad4229..b3d2ef0be 100644
Binary files a/sample/21-serializer/package-lock.json and b/sample/21-serializer/package-lock.json differ
diff --git a/sample/21-serializer/package.json b/sample/21-serializer/package.json
index 25bbfbfd5..1d4445b39 100644
--- a/sample/21-serializer/package.json
+++ b/sample/21-serializer/package.json
@@ -29,16 +29,16 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.8",
+    "@nestjs/schematics": "8.0.6",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.26",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
     "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
diff --git a/sample/22-graphql-prisma/package-lock.json b/sample/22-graphql-prisma/package-lock.json
index c613518e9..e68a4ce04 100644
Binary files a/sample/22-graphql-prisma/package-lock.json and b/sample/22-graphql-prisma/package-lock.json differ
diff --git a/sample/22-graphql-prisma/package.json b/sample/22-graphql-prisma/package.json
index 4f1f230d5..851c1b828 100644
--- a/sample/22-graphql-prisma/package.json
+++ b/sample/22-graphql-prisma/package.json
@@ -34,16 +34,16 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.8",
+    "@nestjs/schematics": "8.0.6",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.26",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
     "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
diff --git a/sample/23-graphql-code-first/package-lock.json b/sample/23-graphql-code-first/package-lock.json
index a988bfdd9..2e89e7c4d 100644
Binary files a/sample/23-graphql-code-first/package-lock.json and b/sample/23-graphql-code-first/package-lock.json differ
diff --git a/sample/23-graphql-code-first/package.json b/sample/23-graphql-code-first/package.json
index 9656a8d21..7a81d07fe 100644
--- a/sample/23-graphql-code-first/package.json
+++ b/sample/23-graphql-code-first/package.json
@@ -36,16 +36,16 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.8",
+    "@nestjs/schematics": "8.0.6",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.26",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
     "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
diff --git a/sample/23-graphql-code-first/schema.gql b/sample/23-graphql-code-first/schema.gql
index 4df716415..e11c56434 100644
--- a/sample/23-graphql-code-first/schema.gql
+++ b/sample/23-graphql-code-first/schema.gql
@@ -2,15 +2,13 @@
 # THIS FILE WAS AUTOMATICALLY GENERATED (DO NOT MODIFY)
 # ------------------------------------------------------
 
-directive @upper on FIELD_DEFINITION
-
 """recipe """
 type Recipe {
   id: ID!
+  title: String!
   description: String
   creationDate: Date!
   ingredients: [String!]!
-  title: String!
 }
 
 """Date custom scalar type"""
diff --git a/sample/23-graphql-code-first/src/app.module.ts b/sample/23-graphql-code-first/src/app.module.ts
index 2b32aa272..481e79ced 100644
--- a/sample/23-graphql-code-first/src/app.module.ts
+++ b/sample/23-graphql-code-first/src/app.module.ts
@@ -1,7 +1,6 @@
 import { ApolloDriver, ApolloDriverConfig } from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
 import { GraphQLModule } from '@nestjs/graphql';
-import { DirectiveLocation, GraphQLDirective } from 'graphql';
 import { upperDirectiveTransformer } from './common/directives/upper-case.directive';
 import { RecipesModule } from './recipes/recipes.module';
 
@@ -13,14 +12,6 @@ import { RecipesModule } from './recipes/recipes.module';
       autoSchemaFile: 'schema.gql',
       transformSchema: schema => upperDirectiveTransformer(schema, 'upper'),
       installSubscriptionHandlers: true,
-      buildSchemaOptions: {
-        directives: [
-          new GraphQLDirective({
-            name: 'upper',
-            locations: [DirectiveLocation.FIELD_DEFINITION],
-          }),
-        ],
-      },
     }),
   ],
 })
diff --git a/sample/23-graphql-code-first/src/recipes/models/recipe.model.ts b/sample/23-graphql-code-first/src/recipes/models/recipe.model.ts
index ef0a772bc..2193b2310 100644
--- a/sample/23-graphql-code-first/src/recipes/models/recipe.model.ts
+++ b/sample/23-graphql-code-first/src/recipes/models/recipe.model.ts
@@ -1,11 +1,11 @@
-import { Directive, Field, ID, ObjectType } from '@nestjs/graphql';
+import { Field, ID, ObjectType } from '@nestjs/graphql';
 
 @ObjectType({ description: 'recipe ' })
 export class Recipe {
   @Field(type => ID)
   id: string;
 
-  @Directive('@upper')
+  @Field()
   title: string;
 
   @Field({ nullable: true })
diff --git a/sample/24-serve-static/package-lock.json b/sample/24-serve-static/package-lock.json
index 79bbbed4e..1851c5c10 100644
Binary files a/sample/24-serve-static/package-lock.json and b/sample/24-serve-static/package-lock.json differ
diff --git a/sample/24-serve-static/package.json b/sample/24-serve-static/package.json
index b91fa8539..58e8a3717 100644
--- a/sample/24-serve-static/package.json
+++ b/sample/24-serve-static/package.json
@@ -31,16 +31,16 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.8",
+    "@nestjs/schematics": "8.0.6",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.26",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
     "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
diff --git a/sample/25-dynamic-modules/package-lock.json b/sample/25-dynamic-modules/package-lock.json
index 3eaeea0b9..8f3d69d38 100644
Binary files a/sample/25-dynamic-modules/package-lock.json and b/sample/25-dynamic-modules/package-lock.json differ
diff --git a/sample/25-dynamic-modules/package.json b/sample/25-dynamic-modules/package.json
index 0ac6b93e7..7c63a61fe 100644
--- a/sample/25-dynamic-modules/package.json
+++ b/sample/25-dynamic-modules/package.json
@@ -30,17 +30,17 @@
   "devDependencies": {
     "@types/dotenv": "8.2.0",
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.8",
+    "@nestjs/schematics": "8.0.6",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/jest": "27.4.1",
-    "@types/node": "16.11.26",
+    "@types/jest": "27.4.0",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
     "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
diff --git a/sample/26-queues/package-lock.json b/sample/26-queues/package-lock.json
index 74ffc81f2..b05c25d3a 100644
Binary files a/sample/26-queues/package-lock.json and b/sample/26-queues/package-lock.json differ
diff --git a/sample/26-queues/package.json b/sample/26-queues/package.json
index ba61b32f1..7c53f9d3a 100644
--- a/sample/26-queues/package.json
+++ b/sample/26-queues/package.json
@@ -31,19 +31,19 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.8",
+    "@nestjs/schematics": "8.0.6",
     "@nestjs/testing": "8.2.3",
     "@types/bull": "3.15.8",
     "@types/dotenv": "8.2.0",
     "@types/express": "4.17.13",
-    "@types/jest": "27.4.1",
-    "@types/node": "16.11.26",
+    "@types/jest": "27.4.0",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
     "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
diff --git a/sample/27-scheduling/package-lock.json b/sample/27-scheduling/package-lock.json
index 86d3f8746..4bb349413 100644
Binary files a/sample/27-scheduling/package-lock.json and b/sample/27-scheduling/package-lock.json differ
diff --git a/sample/27-scheduling/package.json b/sample/27-scheduling/package.json
index 4bc054eab..fefa24d69 100644
--- a/sample/27-scheduling/package.json
+++ b/sample/27-scheduling/package.json
@@ -30,19 +30,19 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.8",
+    "@nestjs/schematics": "8.0.6",
     "@nestjs/testing": "8.2.3",
     "@types/bull": "3.15.8",
     "@types/dotenv": "8.2.0",
     "@types/express": "4.17.13",
-    "@types/jest": "27.4.1",
-    "@types/node": "16.11.26",
+    "@types/jest": "27.4.0",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
     "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
diff --git a/sample/28-sse/package-lock.json b/sample/28-sse/package-lock.json
index dfe3c6c91..bc25d693a 100644
Binary files a/sample/28-sse/package-lock.json and b/sample/28-sse/package-lock.json differ
diff --git a/sample/28-sse/package.json b/sample/28-sse/package.json
index 3ab54338c..18c7a5ed0 100644
--- a/sample/28-sse/package.json
+++ b/sample/28-sse/package.json
@@ -28,18 +28,18 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.8",
+    "@nestjs/schematics": "8.0.6",
     "@nestjs/testing": "8.2.3",
     "@types/dotenv": "8.2.0",
     "@types/express": "4.17.13",
-    "@types/jest": "27.4.1",
-    "@types/node": "16.11.26",
+    "@types/jest": "27.4.0",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
     "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
diff --git a/sample/29-file-upload/package-lock.json b/sample/29-file-upload/package-lock.json
index 2f075e23a..a0202e3c3 100644
Binary files a/sample/29-file-upload/package-lock.json and b/sample/29-file-upload/package-lock.json differ
diff --git a/sample/29-file-upload/package.json b/sample/29-file-upload/package.json
index df8e1d605..c1b9c96b9 100644
--- a/sample/29-file-upload/package.json
+++ b/sample/29-file-upload/package.json
@@ -30,18 +30,18 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.8",
+    "@nestjs/schematics": "8.0.6",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/jest": "27.4.1",
+    "@types/jest": "27.4.0",
     "@types/multer": "1.4.7",
-    "@types/node": "16.11.26",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
     "jest": "27.5.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
diff --git a/sample/30-event-emitter/package-lock.json b/sample/30-event-emitter/package-lock.json
index e93ae381c..a58baae71 100644
Binary files a/sample/30-event-emitter/package-lock.json and b/sample/30-event-emitter/package-lock.json differ
diff --git a/sample/30-event-emitter/package.json b/sample/30-event-emitter/package.json
index 548e648b9..1b70ef84e 100644
--- a/sample/30-event-emitter/package.json
+++ b/sample/30-event-emitter/package.json
@@ -29,11 +29,11 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.8",
+    "@nestjs/schematics": "8.0.6",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/jest": "27.4.1",
-    "@types/node": "16.11.26",
+    "@types/jest": "27.4.0",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
@@ -44,7 +44,7 @@
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "typescript": "4.3.5"
diff --git a/sample/31-graphql-federation-code-first/gateway/package-lock.json b/sample/31-graphql-federation-code-first/gateway/package-lock.json
index 04cb1eb31..ceefa2725 100644
Binary files a/sample/31-graphql-federation-code-first/gateway/package-lock.json and b/sample/31-graphql-federation-code-first/gateway/package-lock.json differ
diff --git a/sample/31-graphql-federation-code-first/gateway/package.json b/sample/31-graphql-federation-code-first/gateway/package.json
index da6d62a0e..b86c4ff0b 100644
--- a/sample/31-graphql-federation-code-first/gateway/package.json
+++ b/sample/31-graphql-federation-code-first/gateway/package.json
@@ -29,7 +29,7 @@
     "@nestjs/platform-express": "8.2.3",
     "apollo-server-express": "3.6.2",
     "graphql": "15.7.2",
-    "graphql-tools": "8.0.0",
+    "graphql-tools": "7.0.5",
     "reflect-metadata": "0.1.13",
     "rimraf": "3.0.2",
     "rxjs": "7.4.0",
@@ -37,11 +37,11 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.8",
+    "@nestjs/schematics": "8.0.6",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/jest": "27.4.1",
-    "@types/node": "16.11.26",
+    "@types/jest": "27.4.0",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
@@ -52,7 +52,7 @@
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "typescript": "4.3.5"
diff --git a/sample/31-graphql-federation-code-first/posts-application/package-lock.json b/sample/31-graphql-federation-code-first/posts-application/package-lock.json
index 025537d4d..fb1b4a90d 100644
Binary files a/sample/31-graphql-federation-code-first/posts-application/package-lock.json and b/sample/31-graphql-federation-code-first/posts-application/package-lock.json differ
diff --git a/sample/31-graphql-federation-code-first/posts-application/package.json b/sample/31-graphql-federation-code-first/posts-application/package.json
index 5ef3c4f38..c58fcc112 100644
--- a/sample/31-graphql-federation-code-first/posts-application/package.json
+++ b/sample/31-graphql-federation-code-first/posts-application/package.json
@@ -31,7 +31,7 @@
     "@nestjs/platform-express": "8.2.3",
     "apollo-server-express": "3.6.2",
     "graphql": "15.7.2",
-    "graphql-tools": "8.0.0",
+    "graphql-tools": "7.0.5",
     "reflect-metadata": "0.1.13",
     "rimraf": "3.0.2",
     "rxjs": "7.4.0",
@@ -39,11 +39,11 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.8",
+    "@nestjs/schematics": "8.0.6",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/jest": "27.4.1",
-    "@types/node": "16.11.26",
+    "@types/jest": "27.4.0",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
@@ -54,7 +54,7 @@
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "typescript": "4.3.5"
diff --git a/sample/31-graphql-federation-code-first/users-application/package-lock.json b/sample/31-graphql-federation-code-first/users-application/package-lock.json
index 41c680a0e..1b6a4b869 100644
Binary files a/sample/31-graphql-federation-code-first/users-application/package-lock.json and b/sample/31-graphql-federation-code-first/users-application/package-lock.json differ
diff --git a/sample/31-graphql-federation-code-first/users-application/package.json b/sample/31-graphql-federation-code-first/users-application/package.json
index ede2439a5..ffbde5458 100644
--- a/sample/31-graphql-federation-code-first/users-application/package.json
+++ b/sample/31-graphql-federation-code-first/users-application/package.json
@@ -30,7 +30,7 @@
     "@nestjs/platform-express": "8.2.3",
     "apollo-server-express": "3.6.2",
     "graphql": "15.7.2",
-    "graphql-tools": "8.0.0",
+    "graphql-tools": "7.0.5",
     "reflect-metadata": "0.1.13",
     "rimraf": "3.0.2",
     "rxjs": "7.4.0",
@@ -38,11 +38,11 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.8",
+    "@nestjs/schematics": "8.0.6",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/jest": "27.4.1",
-    "@types/node": "16.11.26",
+    "@types/jest": "27.4.0",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
@@ -53,7 +53,7 @@
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "typescript": "4.3.5"
diff --git a/sample/32-graphql-federation-schema-first/gateway/package-lock.json b/sample/32-graphql-federation-schema-first/gateway/package-lock.json
index cb349e3d8..fa9edb335 100644
Binary files a/sample/32-graphql-federation-schema-first/gateway/package-lock.json and b/sample/32-graphql-federation-schema-first/gateway/package-lock.json differ
diff --git a/sample/32-graphql-federation-schema-first/gateway/package.json b/sample/32-graphql-federation-schema-first/gateway/package.json
index c24fea6c6..e7308f2b1 100644
--- a/sample/32-graphql-federation-schema-first/gateway/package.json
+++ b/sample/32-graphql-federation-schema-first/gateway/package.json
@@ -29,7 +29,7 @@
     "@nestjs/platform-express": "8.2.3",
     "apollo-server-express": "3.6.2",
     "graphql": "15.7.2",
-    "graphql-tools": "8.0.0",
+    "graphql-tools": "7.0.5",
     "reflect-metadata": "0.1.13",
     "rimraf": "3.0.2",
     "rxjs": "7.4.0",
@@ -37,11 +37,11 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.8",
+    "@nestjs/schematics": "8.0.6",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/jest": "27.4.1",
-    "@types/node": "16.11.26",
+    "@types/jest": "27.4.0",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
@@ -52,7 +52,7 @@
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "typescript": "4.3.5"
diff --git a/sample/32-graphql-federation-schema-first/posts-application/package-lock.json b/sample/32-graphql-federation-schema-first/posts-application/package-lock.json
index b07ac6e28..94b735f7b 100644
Binary files a/sample/32-graphql-federation-schema-first/posts-application/package-lock.json and b/sample/32-graphql-federation-schema-first/posts-application/package-lock.json differ
diff --git a/sample/32-graphql-federation-schema-first/posts-application/package.json b/sample/32-graphql-federation-schema-first/posts-application/package.json
index 445e1d1ec..c8778d69a 100644
--- a/sample/32-graphql-federation-schema-first/posts-application/package.json
+++ b/sample/32-graphql-federation-schema-first/posts-application/package.json
@@ -31,7 +31,7 @@
     "@nestjs/platform-express": "8.2.3",
     "apollo-server-express": "3.6.2",
     "graphql": "15.7.2",
-    "graphql-tools": "8.0.0",
+    "graphql-tools": "7.0.5",
     "reflect-metadata": "0.1.13",
     "rimraf": "3.0.2",
     "rxjs": "7.4.0",
@@ -39,11 +39,11 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.8",
+    "@nestjs/schematics": "8.0.6",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/jest": "27.4.1",
-    "@types/node": "16.11.26",
+    "@types/jest": "27.4.0",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
@@ -54,7 +54,7 @@
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "typescript": "4.3.5"
diff --git a/sample/32-graphql-federation-schema-first/users-application/package-lock.json b/sample/32-graphql-federation-schema-first/users-application/package-lock.json
index ac482ea88..d06551674 100644
Binary files a/sample/32-graphql-federation-schema-first/users-application/package-lock.json and b/sample/32-graphql-federation-schema-first/users-application/package-lock.json differ
diff --git a/sample/32-graphql-federation-schema-first/users-application/package.json b/sample/32-graphql-federation-schema-first/users-application/package.json
index c5358a6a3..7a4bb7bb4 100644
--- a/sample/32-graphql-federation-schema-first/users-application/package.json
+++ b/sample/32-graphql-federation-schema-first/users-application/package.json
@@ -30,7 +30,7 @@
     "@nestjs/platform-express": "8.2.3",
     "apollo-server-express": "3.6.2",
     "graphql": "15.7.2",
-    "graphql-tools": "8.0.0",
+    "graphql-tools": "7.0.5",
     "reflect-metadata": "0.1.13",
     "rimraf": "3.0.2",
     "rxjs": "7.4.0",
@@ -38,11 +38,11 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.8",
+    "@nestjs/schematics": "8.0.6",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/jest": "27.4.1",
-    "@types/node": "16.11.26",
+    "@types/jest": "27.4.0",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
@@ -53,7 +53,7 @@
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "typescript": "4.3.5"
diff --git a/sample/33-graphql-mercurius/package-lock.json b/sample/33-graphql-mercurius/package-lock.json
index 7a9866999..482a902a6 100644
Binary files a/sample/33-graphql-mercurius/package-lock.json and b/sample/33-graphql-mercurius/package-lock.json differ
diff --git a/sample/33-graphql-mercurius/package.json b/sample/33-graphql-mercurius/package.json
index 5ce073daf..cf235c078 100644
--- a/sample/33-graphql-mercurius/package.json
+++ b/sample/33-graphql-mercurius/package.json
@@ -33,16 +33,16 @@
   },
   "devDependencies": {
     "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.8",
+    "@nestjs/schematics": "8.0.6",
     "@nestjs/testing": "8.2.3",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.26",
+    "@types/node": "16.11.25",
     "@types/supertest": "2.0.11",
-    "jest": "27.5.1",
+    "jest": "27.3.1",
     "prettier": "2.5.1",
     "supertest": "6.1.6",
     "ts-jest": "27.0.7",
-    "ts-loader": "9.2.8",
+    "ts-loader": "9.2.6",
     "ts-node": "10.4.0",
     "tsconfig-paths": "3.11.0",
     "@typescript-eslint/eslint-plugin": "4.33.0",
diff --git a/tsconfig.json b/tsconfig.json
index 5712f3c0c..036b1a814 100644
--- a/tsconfig.json
+++ b/tsconfig.json
@@ -8,7 +8,6 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "useUnknownInCatchVariables": false,
     "target": "es6",
     "sourceMap": true,
     "allowJs": true,
