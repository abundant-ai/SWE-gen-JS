diff --git a/python/bullmq/scripts.py b/python/bullmq/scripts.py
index ce9b1e7faa..1af46ce606 100644
--- a/python/bullmq/scripts.py
+++ b/python/bullmq/scripts.py
@@ -36,7 +36,7 @@ class Scripts:
             "moveStalledJobsToWait": redisClient.register_script(self.getScript("moveStalledJobsToWait-8.lua")),
             "pause": redisClient.register_script(self.getScript("pause-4.lua")),
             "obliterate": redisClient.register_script(self.getScript("obliterate-2.lua")),
-            "reprocessJob": redisClient.register_script(self.getScript("reprocessJob-4.lua")),
+            "reprocessJob": redisClient.register_script(self.getScript("reprocessJob-6.lua")),
             "retryJob": redisClient.register_script(self.getScript("retryJob-8.lua")),
             "retryJobs": redisClient.register_script(self.getScript("retryJobs-6.lua")),
             "saveStacktrace": redisClient.register_script(self.getScript("saveStacktrace-1.lua")),
@@ -165,6 +165,8 @@ class Scripts:
         keys.append(self.keys['events'])
         keys.append(self.keys[state])
         keys.append(self.keys['wait'])
+        keys.append(self.keys['meta'])
+        keys.append(self.keys['paused'])
         
         args = [
             job.id,
diff --git a/src/classes/scripts.ts b/src/classes/scripts.ts
index 5ee4cafc02..c7a3cb5e0a 100644
--- a/src/classes/scripts.ts
+++ b/src/classes/scripts.ts
@@ -762,7 +762,9 @@ export class Scripts {
       this.queue.toKey(job.id),
       this.queue.keys.events,
       this.queue.toKey(state),
-      this.queue.toKey('wait'),
+      this.queue.keys.wait,
+      this.queue.keys.meta,
+      this.queue.keys.paused,
     ];
 
     const args = [
@@ -914,37 +916,6 @@ export class Scripts {
     }
     return result;
   }
-
-  /*
-//   *
-//    * Attempts to reprocess a job
-//    *
-//    * @param {Job} job
-//    * @param {Object} options
-//    * @param {String} options.state The expected job state. If the job is not found
-//    * on the provided state, then it's not reprocessed. Supported states: 'failed', 'completed'
-//    *
-//    * @return {Promise<Number>} Returns a promise that evaluates to a return code:
-//    * 1 means the operation was a success
-//    * 0 means the job does not exist
-//    * -1 means the job is currently locked and can't be retried.
-//    * -2 means the job was not found in the expected set
-
-  static reprocessJob(job: Jov, state: string) {
-    var queue = job.queue;
-
-    var keys = [
-      queue.toKey(job.id),
-      queue.toKey(job.id) + ':lock',
-      queue.toKey(state),
-      queue.toKey('wait'),
-    ];
-
-    var args = [job.id, (job.opts.lifo ? 'R' : 'L') + 'PUSH', queue.token];
-
-    return queue.client.reprocessJob(keys.concat(args));
-  }
-  */
 }
 
 export function raw2NextJobData(raw: any[]) {
diff --git a/src/commands/reprocessJob-6.lua b/src/commands/reprocessJob-6.lua
new file mode 100644
index 0000000000..22991cc970
--- /dev/null
+++ b/src/commands/reprocessJob-6.lua
@@ -0,0 +1,43 @@
+--[[
+  Attempts to reprocess a job
+
+  Input:
+    KEYS[1] job key
+    KEYS[2] events stream
+    KEYS[3] job state
+    KEYS[4] wait key
+    KEYS[5] meta
+    KEYS[6] paused key
+
+    ARGV[1] job.id
+    ARGV[2] (job.opts.lifo ? 'R' : 'L') + 'PUSH'
+    ARGV[3] propVal - failedReason/returnvalue
+    ARGV[4] prev state - failed/completed
+
+  Output:
+    1  means the operation was a success
+    -1 means the job does not exist
+    -3 means the job was not found in the expected set.
+]]
+local rcall = redis.call;
+
+-- Includes
+--- @include "includes/getTargetQueueList"
+
+if (rcall("EXISTS", KEYS[1]) == 1) then
+  local jobId = ARGV[1]
+  if (rcall("ZREM", KEYS[3], jobId) == 1) then
+    rcall("HDEL", KEYS[1], "finishedOn", "processedOn", ARGV[3])
+
+    local target = getTargetQueueList(KEYS[5], KEYS[4], KEYS[6])
+    rcall(ARGV[2], target, jobId)
+
+    -- Emit waiting event
+    rcall("XADD", KEYS[2], "*", "event", "waiting", "jobId", jobId, "prev", ARGV[4]);
+    return 1
+  else
+    return -3
+  end
+else
+  return -1
+end
diff --git a/src/types/job-options.ts b/src/types/job-options.ts
index fb88534fe6..3d615fdb98 100644
--- a/src/types/job-options.ts
+++ b/src/types/job-options.ts
@@ -15,4 +15,9 @@ export type RedisJobOptions = BaseJobOptions & {
    * If true, moves parent to failed.
    */
   fpof?: boolean;
+
+  /**
+   * Maximum amount of log entries that will be preserved
+   */
+  kl?: number;
 };
