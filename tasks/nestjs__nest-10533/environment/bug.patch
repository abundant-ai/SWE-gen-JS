diff --git a/.circleci/config.yml b/.circleci/config.yml
index 08487ed7a..e4abf77ba 100644
--- a/.circleci/config.yml
+++ b/.circleci/config.yml
@@ -3,19 +3,19 @@ version: 2
 aliases:
   - &restore-cache
     restore_cache:
-        key: dependency-cache-{{ checksum "package.json" }}
+      key: dependency-cache-{{ checksum "package.json" }}
   - &install-deps
     run:
-        name: Install dependencies
-        command: npm ci
+      name: Install dependencies
+      command: npm ci
   - &build-packages
     run:
-        name: Build
-        command: npm run build
+      name: Build
+      command: npm run build
   - &run-unit-tests
     run:
-        name: Test
-        command: npm run test
+      name: Test
+      command: npm run test
 
 unit-tests-template: &unit-tests-template
   working_directory: ~/nest
@@ -30,7 +30,7 @@ jobs:
   build:
     working_directory: ~/nest
     docker:
-      - image: circleci/node:12
+      - image: cimg/node:16.19
     steps:
       - checkout
       - run:
@@ -48,33 +48,35 @@ jobs:
       - run:
           name: Build
           command: npm run build
-        
-  test_node_12:
-    <<: *unit-tests-template
-    docker:
-      - image: circleci/node:12
 
-  test_node_14:
-    <<: *unit-tests-template
-    docker:
-      - image: circleci/node:14
-    
   test_node_16:
     working_directory: ~/nest
     docker:
-      - image: circleci/node:16
+      - image: cimg/node:16.19
     steps:
       - checkout
       - *restore-cache
       - *install-deps
       - *build-packages
-      - *run-unit-tests
+      - run:
+          name: Test (coverage)
+          command: npm run test:cov
       - run:
           name: Collect coverage
           command: npm run coverage
       - store_artifacts:
           path: coverage
 
+  test_node_18:
+    <<: *unit-tests-template
+    docker:
+      - image: cimg/node:18.14
+
+  test_node_19:
+    <<: *unit-tests-template
+    docker:
+      - image: cimg/node:19.8
+
   lint:
     working_directory: ~/nest
     docker:
@@ -95,17 +97,17 @@ jobs:
     machine: true
     steps:
       - checkout
-      - run: 
+      - run:
           name: Prepare nvm
           command: |
             echo 'export NVM_DIR="/opt/circleci/.nvm"' >> $BASH_ENV
             echo ' [ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"' >> $BASH_ENV
-      - run: 
+      - run:
           name: Upgrade Node.js
           command: |
-            nvm install v12
+            nvm install v16
             node -v
-            nvm alias default v12
+            nvm alias default v16
       - run:
           name: Install Docker Compose
           command: |
@@ -124,11 +126,11 @@ jobs:
       - run:
           name: Integration tests
           command: npm run test:integration
-          
+
   codechecks_benchmarks:
     working_directory: ~/nest
     docker:
-      - image: circleci/node:16
+      - image: cimg/node:16.19
     steps:
       - checkout
       - *restore-cache
@@ -144,7 +146,7 @@ jobs:
   samples:
     working_directory: ~/nest
     docker:
-      - image: circleci/node:16
+      - image: cimg/node:16.19
     environment:
       - DISABLE_OPENCOLLECTIVE: true
     steps:
@@ -163,10 +165,10 @@ workflows:
       - test_node_16:
           requires:
             - build
-      - test_node_14:
+      - test_node_18:
           requires:
             - build
-      - test_node_12:
+      - test_node_19:
           requires:
             - build
       - lint:
diff --git a/.eslintignore b/.eslintignore
index 4197b94e5..07c71c90c 100644
--- a/.eslintignore
+++ b/.eslintignore
@@ -1 +1,3 @@
-**/node_modules/**
\ No newline at end of file
+**/node_modules/**
+*.d.ts
+*.js
\ No newline at end of file
diff --git a/.github/ISSUE_TEMPLATE/Bug_report.yml b/.github/ISSUE_TEMPLATE/Bug_report.yml
index 98e32d7ca..6ed7830d8 100644
--- a/.github/ISSUE_TEMPLATE/Bug_report.yml
+++ b/.github/ISSUE_TEMPLATE/Bug_report.yml
@@ -57,7 +57,7 @@ body:
       required: true
     attributes:
       label: "Expected behavior"
-      description: "A clear and concise description of what you expected to happend (or code)"
+      description: "A clear and concise description of what you expected to happened (or code)"
 
   - type: markdown
     attributes:
diff --git a/.github/ISSUE_TEMPLATE/Regression.yml b/.github/ISSUE_TEMPLATE/Regression.yml
index 66ac1610b..3da97a602 100644
--- a/.github/ISSUE_TEMPLATE/Regression.yml
+++ b/.github/ISSUE_TEMPLATE/Regression.yml
@@ -74,7 +74,7 @@ body:
       required: true
     attributes:
       label: "Expected behavior"
-      description: "A clear and concise description of what you expected to happend (or code)"
+      description: "A clear and concise description of what you expected to happened (or code)"
 
   - type: textarea
     attributes:
diff --git a/.gitignore b/.gitignore
index b256a3db1..68db39d62 100644
--- a/.gitignore
+++ b/.gitignore
@@ -27,6 +27,7 @@ yarn-error.log
 /**/npm-debug.log
 /packages/**/.npmignore
 /packages/**/LICENSE
+*.tsbuildinfo
 
 # example
 /quick-start
@@ -41,3 +42,6 @@ yarn-error.log
 /packages/graphql
 /benchmarks/memory
 build/config\.gypi
+
+.npmrc
+pnpm-lock.yaml
\ No newline at end of file
diff --git a/.npmignore b/.npmignore
index adb8e0dd6..d70d45ce9 100644
--- a/.npmignore
+++ b/.npmignore
@@ -10,4 +10,6 @@
 package-lock.json
 tslint.json
 tsconfig.json
-.prettierrc
\ No newline at end of file
+.prettierrc
+
+*.tsbuildinfo
\ No newline at end of file
diff --git a/LICENSE b/LICENSE
index 8268fe7ff..63c013f03 100644
--- a/LICENSE
+++ b/LICENSE
@@ -1,6 +1,6 @@
 (The MIT License)
 
-Copyright (c) 2017-2022 Kamil Mysliwiec <https://kamilmysliwiec.com>
+Copyright (c) 2017-2023 Kamil Mysliwiec <https://kamilmysliwiec.com>
 
 Permission is hereby granted, free of charge, to any person obtaining
 a copy of this software and associated documentation files (the
diff --git a/Readme.md b/Readme.md
index 5203ac4c2..16f48336d 100644
--- a/Readme.md
+++ b/Readme.md
@@ -11,7 +11,6 @@
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
 <a href="https://circleci.com/gh/nestjs/nest" target="_blank"><img src="https://img.shields.io/circleci/build/github/nestjs/nest/master" alt="CircleCI" /></a>
-<a href="https://coveralls.io/github/nestjs/nest?branch=master" target="_blank"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#9" alt="Coverage" /></a>
 <a href="https://discord.gg/G7Qnnhy" target="_blank"><img src="https://img.shields.io/badge/discord-online-brightgreen.svg" alt="Discord"/></a>
 <a href="https://opencollective.com/nest#backer" target="_blank"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
 <a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
@@ -78,7 +77,10 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
  <td>
 <a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
 <a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td><td>
-<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
+<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td>
+<td>
+<a href="https://ridicorp.com/career/" target="_blank"><img src="https://nestjs.com/img/ridi-logo.svg" width="105" valign="middle" /></a></td><td>
+<a href="https://www.movavi.com/imovie-for-windows.html" target="_blank"><img src="https://nestjs.com/img/movavi-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
@@ -91,7 +93,8 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td>
 <td><a href="https://n.inc" target="_blank"><img src="https://nestjs.com/img/n-inc-logo.svg" width="120" valign="middle" /></td></tr><tr>
 <td><a href="https://bilberrry.com/" target="_blank"><img src="https://nestjs.com/img/bilberrry-logo.svg" width="180" valign="middle" /></td>
-<td><a href="https://ipinfo.ai/" target="_blank"><img src="https://nestjs.com/img/ipinfo-logo.png" width="130" valign="middle" /></td></tr>
+<td><a href="https://ipinfo.ai/" target="_blank"><img src="https://nestjs.com/img/ipinfo-logo.png" width="130" valign="middle" /></td>
+<td><a href="https://chax.at" target="_blank"><img src="https://nestjs.com/img/chaxat-logo.png" width="100" valign="middle" /></td></tr>
 </table>
 
 #### Sponsors
@@ -132,7 +135,8 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
    <td align="center" valign="middle"><a href="https://mobilereality.pl/" target="_blank"><img src="https://nestjs.com/img/mobile-reality-logo.png" width="45" valign="middle" /></a></td>
      <td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/boringowl-logo.svg" width="120" valign="middle" /></a></td>
  <td align="center" valign="middle"><a href="https://www.mobilefactory.jp/" target="_blank"><img src="https://nestjs.com/img/mobilefactory-logo.png" width="100" valign="middle" /></a></td>
- <td align="center" valign="middle"><a href="https://db.nordbot.app/" target="_blank"><img src="https://nestjs.com/img/nord-logo.png" width="50" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://nordbot.app/" target="_blank"><img src="https://nestjs.com/img/nordbot-logo.png" width="120" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://doppio.sh/" target="_blank"><img src="https://nestjs.com/img/dopiosh-logo.png" width="50" valign="middle" /></a></td>
   </tr></table>
 
 ## Backers
diff --git a/integration/auto-mock/tsconfig.json b/integration/auto-mock/tsconfig.json
index c6354c564..cef623d14 100644
--- a/integration/auto-mock/tsconfig.json
+++ b/integration/auto-mock/tsconfig.json
@@ -7,10 +7,28 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
diff --git a/integration/cache/e2e/async-register-extra-providers.ts b/integration/cache/e2e/async-register-extra-providers.ts
deleted file mode 100644
index d2c47857d..000000000
--- a/integration/cache/e2e/async-register-extra-providers.ts
+++ /dev/null
@@ -1,39 +0,0 @@
-import { CACHE_MANAGER, INestApplication } from '@nestjs/common';
-import { Test } from '@nestjs/testing';
-import * as request from 'supertest';
-import { AsyncRegisterExtraModule } from '../src/async-register-extra-providers/async-register-extra.module';
-import { Cache } from 'cache-manager';
-import { assert } from 'chai';
-
-describe('Async Register Extra Providers', () => {
-  let server;
-  let app: INestApplication;
-  let cacheManager: Cache;
-
-  before(async () => {
-    const module = await Test.createTestingModule({
-      imports: [AsyncRegisterExtraModule],
-    }).compile();
-
-    cacheManager = module.get<Cache>(CACHE_MANAGER);
-    app = module.createNestApplication();
-    server = app.getHttpServer();
-    await app.init();
-  });
-
-  it('should be defined', async () => {
-    assert.isDefined(cacheManager);
-  });
-
-  it(`should return empty`, async () => {
-    return request(server).get('/').expect(200, 'Not found');
-  });
-
-  it(`should return data`, async () => {
-    return request(server).get('/').expect(200, 'value');
-  });
-
-  after(async () => {
-    await app.close();
-  });
-});
diff --git a/integration/cache/e2e/async-register.spec.ts b/integration/cache/e2e/async-register.spec.ts
deleted file mode 100644
index 411ccfc6d..000000000
--- a/integration/cache/e2e/async-register.spec.ts
+++ /dev/null
@@ -1,39 +0,0 @@
-import { CACHE_MANAGER, INestApplication } from '@nestjs/common';
-import { Test } from '@nestjs/testing';
-import * as request from 'supertest';
-import { AsyncRegisterModule } from '../src/async-register/async-register.module';
-import { Cache } from 'cache-manager';
-import { assert } from 'chai';
-
-describe('Async Register', () => {
-  let server;
-  let app: INestApplication;
-  let cacheManager: Cache;
-
-  before(async () => {
-    const module = await Test.createTestingModule({
-      imports: [AsyncRegisterModule],
-    }).compile();
-
-    cacheManager = module.get<Cache>(CACHE_MANAGER);
-    app = module.createNestApplication();
-    server = app.getHttpServer();
-    await app.init();
-  });
-
-  it('should be defined', async () => {
-    assert.isDefined(cacheManager);
-  });
-
-  it(`should return empty`, async () => {
-    return request(server).get('/').expect(200, 'Not found');
-  });
-
-  it(`should return data`, async () => {
-    return request(server).get('/').expect(200, 'value');
-  });
-
-  after(async () => {
-    await app.close();
-  });
-});
diff --git a/integration/cache/e2e/multi-store.spec.ts b/integration/cache/e2e/multi-store.spec.ts
deleted file mode 100644
index bae2dea08..000000000
--- a/integration/cache/e2e/multi-store.spec.ts
+++ /dev/null
@@ -1,31 +0,0 @@
-import { INestApplication } from '@nestjs/common';
-import { Test } from '@nestjs/testing';
-import * as request from 'supertest';
-import { MultiStoreModule } from '../src/multi-store/multi-store.module';
-
-describe('Caching Multi Store', () => {
-  let server;
-  let app: INestApplication;
-
-  before(async () => {
-    const module = await Test.createTestingModule({
-      imports: [MultiStoreModule],
-    }).compile();
-
-    app = module.createNestApplication();
-    server = app.getHttpServer();
-    await app.init();
-  });
-
-  it(`should return empty`, async () => {
-    return request(server).get('/').expect(200, '');
-  });
-
-  it(`should return data`, async () => {
-    return request(server).get('/').expect(200, 'multi-store-value');
-  });
-
-  after(async () => {
-    await app.close();
-  });
-});
diff --git a/integration/cache/src/async-register-extra-providers/async-register-extra.controller.ts b/integration/cache/src/async-register-extra-providers/async-register-extra.controller.ts
deleted file mode 100644
index c4df4dff7..000000000
--- a/integration/cache/src/async-register-extra-providers/async-register-extra.controller.ts
+++ /dev/null
@@ -1,16 +0,0 @@
-import { Controller, Get, Inject, CACHE_MANAGER } from '@nestjs/common';
-import { Cache } from 'cache-manager';
-
-@Controller()
-export class AsyncRegisterExtraController {
-  constructor(@Inject(CACHE_MANAGER) private cacheManager: Cache) {}
-
-  @Get()
-  async getFromStore(): Promise<string> {
-    const value: string | undefined = await this.cacheManager.get('key');
-    if (!value) {
-      await this.cacheManager.set('key', 'value');
-    }
-    return value ?? 'Not found';
-  }
-}
diff --git a/integration/cache/src/async-register-extra-providers/async-register-extra.module.ts b/integration/cache/src/async-register-extra-providers/async-register-extra.module.ts
deleted file mode 100644
index 4d3fdcecc..000000000
--- a/integration/cache/src/async-register-extra-providers/async-register-extra.module.ts
+++ /dev/null
@@ -1,16 +0,0 @@
-import { CacheModule, Module } from '@nestjs/common';
-import { AsyncRegisterExtraController } from './async-register-extra.controller';
-import { CacheConfig } from './config/cache.config';
-import { ConfigModule } from './config/config.module';
-
-@Module({
-  imports: [
-    CacheModule.registerAsync({
-      extraProviders: [ConfigModule],
-      isGlobal: true,
-      useClass: CacheConfig,
-    }),
-  ],
-  controllers: [AsyncRegisterExtraController],
-})
-export class AsyncRegisterExtraModule {}
diff --git a/integration/cache/src/async-register-extra-providers/config/cache.config.ts b/integration/cache/src/async-register-extra-providers/config/cache.config.ts
deleted file mode 100644
index 905ee6461..000000000
--- a/integration/cache/src/async-register-extra-providers/config/cache.config.ts
+++ /dev/null
@@ -1,17 +0,0 @@
-import {
-  CacheModuleOptions,
-  CacheOptionsFactory,
-  Injectable,
-} from '@nestjs/common';
-import { ConfigService } from './config.service';
-
-@Injectable()
-export class CacheConfig implements CacheOptionsFactory {
-  constructor(private readonly configService: ConfigService) {}
-
-  createCacheOptions(): CacheModuleOptions {
-    const ttl = this.configService.getTtl();
-
-    return { ttl };
-  }
-}
diff --git a/integration/cache/src/async-register-extra-providers/config/config.module.ts b/integration/cache/src/async-register-extra-providers/config/config.module.ts
deleted file mode 100644
index eaa505c84..000000000
--- a/integration/cache/src/async-register-extra-providers/config/config.module.ts
+++ /dev/null
@@ -1,8 +0,0 @@
-import { Module } from '@nestjs/common';
-import { ConfigService } from './config.service';
-
-@Module({
-  providers: [ConfigService],
-  exports: [ConfigService],
-})
-export class ConfigModule {}
diff --git a/integration/cache/src/async-register-extra-providers/config/config.service.ts b/integration/cache/src/async-register-extra-providers/config/config.service.ts
deleted file mode 100644
index 0a7a886a4..000000000
--- a/integration/cache/src/async-register-extra-providers/config/config.service.ts
+++ /dev/null
@@ -1,8 +0,0 @@
-import { Injectable } from '@nestjs/common';
-
-@Injectable()
-export class ConfigService {
-  public getTtl(): number {
-    return 10;
-  }
-}
diff --git a/integration/cache/src/async-register-extra-providers/tsconfig.json b/integration/cache/src/async-register-extra-providers/tsconfig.json
deleted file mode 100644
index 567a5c9e6..000000000
--- a/integration/cache/src/async-register-extra-providers/tsconfig.json
+++ /dev/null
@@ -1,22 +0,0 @@
-{
-  "compilerOptions": {
-    "module": "commonjs",
-    "declaration": false,
-    "noImplicitAny": false,
-    "removeComments": true,
-    "noLib": false,
-    "emitDecoratorMetadata": true,
-    "experimentalDecorators": true,
-    "target": "es6",
-    "sourceMap": true,
-    "allowJs": true,
-    "outDir": "./dist"
-  },
-  "include": [
-    "src/**/*",
-    "e2e/**/*"
-  ],
-  "exclude": [
-    "node_modules",
-  ]
-}
diff --git a/integration/cache/src/async-register/async-register.controller.ts b/integration/cache/src/async-register/async-register.controller.ts
deleted file mode 100644
index 4f2c12f08..000000000
--- a/integration/cache/src/async-register/async-register.controller.ts
+++ /dev/null
@@ -1,16 +0,0 @@
-import { Controller, Get, Inject, CACHE_MANAGER } from '@nestjs/common';
-import { Cache } from 'cache-manager';
-
-@Controller()
-export class AsyncRegisterController {
-  constructor(@Inject(CACHE_MANAGER) private cacheManager: Cache) {}
-
-  @Get()
-  async getFromStore(): Promise<string> {
-    const value: string | undefined = await this.cacheManager.get('key');
-    if (!value) {
-      await this.cacheManager.set('key', 'value');
-    }
-    return value ?? 'Not found';
-  }
-}
diff --git a/integration/cache/src/async-register/async-register.module.ts b/integration/cache/src/async-register/async-register.module.ts
deleted file mode 100644
index d2a907f3b..000000000
--- a/integration/cache/src/async-register/async-register.module.ts
+++ /dev/null
@@ -1,14 +0,0 @@
-import { CacheModule, Module } from '@nestjs/common';
-import { AsyncRegisterController } from './async-register.controller';
-import { CacheConfig } from './config/cache.config';
-
-@Module({
-  imports: [
-    CacheModule.registerAsync({
-      isGlobal: true,
-      useClass: CacheConfig,
-    }),
-  ],
-  controllers: [AsyncRegisterController],
-})
-export class AsyncRegisterModule {}
diff --git a/integration/cache/src/async-register/config/cache.config.ts b/integration/cache/src/async-register/config/cache.config.ts
deleted file mode 100644
index 36609b360..000000000
--- a/integration/cache/src/async-register/config/cache.config.ts
+++ /dev/null
@@ -1,14 +0,0 @@
-import {
-  CacheModuleOptions,
-  CacheOptionsFactory,
-  Injectable,
-} from '@nestjs/common';
-
-@Injectable()
-export class CacheConfig implements CacheOptionsFactory {
-  createCacheOptions(): CacheModuleOptions {
-    const ttl = 100;
-
-    return { ttl };
-  }
-}
diff --git a/integration/cache/src/async-register/tsconfig.json b/integration/cache/src/async-register/tsconfig.json
deleted file mode 100644
index 567a5c9e6..000000000
--- a/integration/cache/src/async-register/tsconfig.json
+++ /dev/null
@@ -1,22 +0,0 @@
-{
-  "compilerOptions": {
-    "module": "commonjs",
-    "declaration": false,
-    "noImplicitAny": false,
-    "removeComments": true,
-    "noLib": false,
-    "emitDecoratorMetadata": true,
-    "experimentalDecorators": true,
-    "target": "es6",
-    "sourceMap": true,
-    "allowJs": true,
-    "outDir": "./dist"
-  },
-  "include": [
-    "src/**/*",
-    "e2e/**/*"
-  ],
-  "exclude": [
-    "node_modules",
-  ]
-}
diff --git a/integration/cache/src/multi-store/multi-store.controller.ts b/integration/cache/src/multi-store/multi-store.controller.ts
deleted file mode 100644
index ce4a446a8..000000000
--- a/integration/cache/src/multi-store/multi-store.controller.ts
+++ /dev/null
@@ -1,16 +0,0 @@
-import { Controller, Get, Inject, CACHE_MANAGER } from '@nestjs/common';
-import { Cache } from 'cache-manager';
-
-@Controller()
-export class MultiStoreController {
-  constructor(@Inject(CACHE_MANAGER) private cacheManager: Cache) {}
-
-  @Get()
-  async getFromMultiStore(): Promise<unknown> {
-    const value = await this.cacheManager.get('multi-store-key');
-    if (!value) {
-      await this.cacheManager.set('multi-store-key', 'multi-store-value');
-    }
-    return value;
-  }
-}
diff --git a/integration/cache/src/multi-store/multi-store.module.ts b/integration/cache/src/multi-store/multi-store.module.ts
deleted file mode 100644
index 8ebc34e5b..000000000
--- a/integration/cache/src/multi-store/multi-store.module.ts
+++ /dev/null
@@ -1,24 +0,0 @@
-import { CacheModule, Module } from '@nestjs/common';
-import * as redisStore from 'cache-manager-redis-store';
-import { MultiStoreController } from './multi-store.controller';
-
-@Module({
-  imports: [
-    CacheModule.register([
-      {
-        store: 'memory',
-        max: 100,
-        ttl: 10,
-      },
-      {
-        store: redisStore,
-        host: 'localhost',
-        port: 6379,
-        db: 0,
-        ttl: 600,
-      },
-    ]),
-  ],
-  controllers: [MultiStoreController],
-})
-export class MultiStoreModule {}
diff --git a/integration/cors/tsconfig.json b/integration/cors/tsconfig.json
index c6354c564..cef623d14 100644
--- a/integration/cors/tsconfig.json
+++ b/integration/cors/tsconfig.json
@@ -7,10 +7,28 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
diff --git a/integration/docker-compose.yml b/integration/docker-compose.yml
index 1a1dfa986..bbf95d3a9 100644
--- a/integration/docker-compose.yml
+++ b/integration/docker-compose.yml
@@ -25,7 +25,7 @@ services:
       - "9001:9001"
     restart: always
   mysql:
-    image: mysql:8.0.30
+    image: mysql:8.0.32
     environment:
       MYSQL_ROOT_PASSWORD: root
       MYSQL_DATABASE: test
@@ -50,7 +50,7 @@ services:
   zookeeper:
     container_name: test-zookeeper
     hostname: zookeeper
-    image: confluentinc/cp-zookeeper:7.0.1
+    image: confluentinc/cp-zookeeper:7.3.2
     ports:
       - "2181:2181"
     environment:
@@ -59,7 +59,7 @@ services:
   kafka:
     container_name: test-kafka
     hostname: kafka
-    image: confluentinc/cp-kafka:7.0.1
+    image: confluentinc/cp-kafka:7.3.2
     depends_on:
       - zookeeper
     ports:
diff --git a/integration/graphql-code-first/e2e/pipes.spec.ts b/integration/graphql-code-first/e2e/pipes.spec.ts
index 61f169c2a..e14e31df1 100644
--- a/integration/graphql-code-first/e2e/pipes.spec.ts
+++ b/integration/graphql-code-first/e2e/pipes.spec.ts
@@ -30,8 +30,8 @@ describe('GraphQL Pipes', () => {
         errors: [
           {
             extensions: {
-              code: 'BAD_USER_INPUT',
-              response: {
+              code: 'BAD_REQUEST',
+              originalError: {
                 error: 'Bad Request',
                 message: [
                   'description must be longer than or equal to 30 characters',
@@ -39,7 +39,14 @@ describe('GraphQL Pipes', () => {
                 statusCode: 400,
               },
             },
+            locations: [
+              {
+                column: 3,
+                line: 2,
+              },
+            ],
             message: 'Bad Request Exception',
+            path: ['addRecipe'],
           },
         ],
       });
diff --git a/integration/graphql-code-first/schema.gql b/integration/graphql-code-first/schema.gql
index 59f110694..c196e332d 100644
--- a/integration/graphql-code-first/schema.gql
+++ b/integration/graphql-code-first/schema.gql
@@ -15,7 +15,7 @@ scalar Date
 
 type Query {
   recipe(id: String!): Recipe!
-  recipes(skip: Int = 0, take: Int = 25): [Recipe!]!
+  recipes(skip: Int! = 0, take: Int! = 25): [Recipe!]!
 }
 
 type Mutation {
@@ -31,4 +31,4 @@ input NewRecipeInput {
 
 type Subscription {
   recipeAdded: Recipe!
-}
+}
\ No newline at end of file
diff --git a/integration/graphql-code-first/src/app.module.ts b/integration/graphql-code-first/src/app.module.ts
index 595288ffc..5da27fa35 100644
--- a/integration/graphql-code-first/src/app.module.ts
+++ b/integration/graphql-code-first/src/app.module.ts
@@ -9,7 +9,7 @@ import { RecipesModule } from './recipes/recipes.module';
     RecipesModule,
     GraphQLModule.forRoot<ApolloDriverConfig>({
       driver: ApolloDriver,
-      debug: false,
+      includeStacktraceInErrorResponses: false,
       installSubscriptionHandlers: true,
       autoSchemaFile: join(
         process.cwd(),
diff --git a/integration/graphql-code-first/src/main.ts b/integration/graphql-code-first/src/main.ts
index c04a543a1..5a5fd57ce 100644
--- a/integration/graphql-code-first/src/main.ts
+++ b/integration/graphql-code-first/src/main.ts
@@ -1,9 +1,9 @@
 import { ValidationPipe } from '@nestjs/common';
 import { NestFactory } from '@nestjs/core';
-import { ApplicationModule } from './app.module';
+import { AppModule } from './app.module';
 
 async function bootstrap() {
-  const app = await NestFactory.create(ApplicationModule);
+  const app = await NestFactory.create(AppModule);
   app.useGlobalPipes(new ValidationPipe());
   await app.listen(3000);
 }
diff --git a/integration/graphql-code-first/tsconfig.json b/integration/graphql-code-first/tsconfig.json
index ea15af490..cef623d14 100644
--- a/integration/graphql-code-first/tsconfig.json
+++ b/integration/graphql-code-first/tsconfig.json
@@ -7,16 +7,34 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
-    "src/**/*"
+    "src/**/*",
+    "e2e/**/*"
   ],
   "exclude": [
     "node_modules",
-    "**/*.spec.ts"
   ]
 }
\ No newline at end of file
diff --git a/integration/graphql-schema-first/src/app.module.ts b/integration/graphql-schema-first/src/app.module.ts
index 2dbbb236a..2879cfc9f 100644
--- a/integration/graphql-schema-first/src/app.module.ts
+++ b/integration/graphql-schema-first/src/app.module.ts
@@ -9,6 +9,7 @@ import { CatsModule } from './cats/cats.module';
     CatsModule,
     GraphQLModule.forRoot<ApolloDriverConfig>({
       driver: ApolloDriver,
+      includeStacktraceInErrorResponses: true,
       typePaths: [join(__dirname, '**', '*.graphql')],
     }),
   ],
diff --git a/integration/graphql-schema-first/src/main.ts b/integration/graphql-schema-first/src/main.ts
index afb93ba07..13cad38cf 100644
--- a/integration/graphql-schema-first/src/main.ts
+++ b/integration/graphql-schema-first/src/main.ts
@@ -1,8 +1,8 @@
 import { NestFactory } from '@nestjs/core';
-import { ApplicationModule } from './app.module';
+import { AppModule } from './app.module';
 
 async function bootstrap() {
-  const app = await NestFactory.create(ApplicationModule);
+  const app = await NestFactory.create(AppModule);
   await app.listen(3000);
 }
 bootstrap();
diff --git a/integration/graphql-schema-first/tsconfig.json b/integration/graphql-schema-first/tsconfig.json
index 3229c5596..cef623d14 100644
--- a/integration/graphql-schema-first/tsconfig.json
+++ b/integration/graphql-schema-first/tsconfig.json
@@ -7,17 +7,34 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
     "outDir": "./dist",
-    "skipLibCheck": true
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
-    "src/**/*"
+    "src/**/*",
+    "e2e/**/*"
   ],
   "exclude": [
     "node_modules",
-    "**/*.spec.ts"
   ]
 }
\ No newline at end of file
diff --git a/integration/hello-world/e2e/exceptions.spec.ts b/integration/hello-world/e2e/exceptions.spec.ts
index 7cf8223ab..581964807 100644
--- a/integration/hello-world/e2e/exceptions.spec.ts
+++ b/integration/hello-world/e2e/exceptions.spec.ts
@@ -1,39 +1,135 @@
 import { HttpStatus, INestApplication } from '@nestjs/common';
+import {
+  FastifyAdapter,
+  NestFastifyApplication,
+} from '@nestjs/platform-fastify';
 import { Test } from '@nestjs/testing';
+import { expect } from 'chai';
+import { RawServerDefault } from 'fastify';
 import * as request from 'supertest';
 import { ErrorsController } from '../src/errors/errors.controller';
 
 describe('Error messages', () => {
-  let server;
-  let app: INestApplication;
+  let server: RawServerDefault;
 
-  beforeEach(async () => {
-    const module = await Test.createTestingModule({
-      controllers: [ErrorsController],
-    }).compile();
+  describe('Express', () => {
+    let app: INestApplication;
+    beforeEach(async () => {
+      const module = await Test.createTestingModule({
+        controllers: [ErrorsController],
+      }).compile();
 
-    app = module.createNestApplication();
-    server = app.getHttpServer();
-    await app.init();
-  });
+      app = module.createNestApplication();
+      server = app.getHttpServer();
+      await app.init();
+    });
 
-  it(`/GET`, () => {
-    return request(server).get('/sync').expect(HttpStatus.BAD_REQUEST).expect({
-      statusCode: 400,
-      error: 'Bad Request',
-      message: 'Integration test',
+    it(`/GET`, () => {
+      return request(server)
+        .get('/sync')
+        .expect(HttpStatus.BAD_REQUEST)
+        .expect({
+          statusCode: 400,
+          error: 'Bad Request',
+          message: 'Integration test',
+        });
+    });
+
+    it(`/GET (Promise/async)`, () => {
+      return request(server)
+        .get('/async')
+        .expect(HttpStatus.BAD_REQUEST)
+        .expect({
+          statusCode: 400,
+          error: 'Bad Request',
+          message: 'Integration test',
+        });
     });
-  });
 
-  it(`/GET (Promise/async)`, () => {
-    return request(server).get('/async').expect(HttpStatus.BAD_REQUEST).expect({
-      statusCode: 400,
-      error: 'Bad Request',
-      message: 'Integration test',
+    it(`/GET (InternalServerError despite custom content-type)`, async () => {
+      return request(server)
+        .get('/unexpected-error')
+        .expect(HttpStatus.INTERNAL_SERVER_ERROR)
+        .expect({
+          statusCode: 500,
+          message: 'Internal server error',
+        });
+    });
+
+    afterEach(async () => {
+      await app.close();
     });
   });
 
-  afterEach(async () => {
-    await app.close();
+  describe('Fastify', () => {
+    let app: NestFastifyApplication;
+    beforeEach(async () => {
+      const module = await Test.createTestingModule({
+        controllers: [ErrorsController],
+      }).compile();
+
+      app = module.createNestApplication<NestFastifyApplication>(
+        new FastifyAdapter(),
+      );
+      server = app.getHttpServer();
+      await app.init();
+    });
+
+    it(`/GET`, async () => {
+      return app
+        .inject({
+          method: 'GET',
+          url: '/sync',
+        })
+        .then(({ payload, statusCode }) => {
+          expect(statusCode).to.equal(HttpStatus.BAD_REQUEST);
+          expect(payload).to.equal(
+            JSON.stringify({
+              statusCode: 400,
+              error: 'Bad Request',
+              message: 'Integration test',
+            }),
+          );
+        });
+    });
+
+    it(`/GET (Promise/async)`, async () => {
+      return app
+        .inject({
+          method: 'GET',
+          url: '/sync',
+        })
+        .then(({ payload, statusCode }) => {
+          expect(statusCode).to.equal(HttpStatus.BAD_REQUEST);
+          expect(payload).to.equal(
+            JSON.stringify({
+              statusCode: 400,
+              error: 'Bad Request',
+              message: 'Integration test',
+            }),
+          );
+        });
+    });
+
+    it(`/GET (InternalServerError despite custom content-type)`, async () => {
+      return app
+        .inject({
+          method: 'GET',
+          url: '/unexpected-error',
+        })
+        .then(({ payload, statusCode }) => {
+          expect(statusCode).to.equal(HttpStatus.INTERNAL_SERVER_ERROR);
+          expect(payload).to.equal(
+            JSON.stringify({
+              statusCode: 500,
+              message: 'Internal server error',
+            }),
+          );
+        });
+    });
+
+    afterEach(async () => {
+      await app.close();
+    });
   });
 });
diff --git a/integration/hello-world/e2e/middleware-fastify.spec.ts b/integration/hello-world/e2e/middleware-fastify.spec.ts
index de8040759..a71afa185 100644
--- a/integration/hello-world/e2e/middleware-fastify.spec.ts
+++ b/integration/hello-world/e2e/middleware-fastify.spec.ts
@@ -77,7 +77,7 @@ class TestModule {
       .apply((req, res, next) => res.end(SCOPED_VALUE))
       .forRoutes(TestController)
       .apply((req, res, next) => res.end(RETURN_VALUE))
-      .exclude({ path: QUERY_VALUE, method: -1 })
+      .exclude({ path: QUERY_VALUE, method: -1 as any })
       .forRoutes('(.*)');
   }
 }
diff --git a/integration/hello-world/e2e/middleware-with-versioning.spec.ts b/integration/hello-world/e2e/middleware-with-versioning.spec.ts
index c8d800a90..a16645b68 100644
--- a/integration/hello-world/e2e/middleware-with-versioning.spec.ts
+++ b/integration/hello-world/e2e/middleware-with-versioning.spec.ts
@@ -77,6 +77,26 @@ describe('Middleware', () => {
     });
   });
 
+  describe('when using default URI versioning with the global prefix', () => {
+    beforeEach(async () => {
+      app = await createAppWithVersioning(
+        {
+          type: VersioningType.URI,
+          defaultVersion: VERSION_NEUTRAL,
+        },
+        async (app: INestApplication) => {
+          app.setGlobalPrefix('api');
+        },
+      );
+    });
+
+    it(`forRoutes({ path: '/versioned', version: '1', method: RequestMethod.ALL })`, () => {
+      return request(app.getHttpServer())
+        .get('/api/v1/versioned')
+        .expect(200, VERSIONED_VALUE);
+    });
+  });
+
   describe('when using HEADER versioning', () => {
     beforeEach(async () => {
       app = await createAppWithVersioning({
@@ -133,6 +153,7 @@ describe('Middleware', () => {
 
 async function createAppWithVersioning(
   versioningOptions: VersioningOptions,
+  beforeInit?: (app: INestApplication) => Promise<void>,
 ): Promise<INestApplication> {
   const app = (
     await Test.createTestingModule({
@@ -141,6 +162,9 @@ async function createAppWithVersioning(
   ).createNestApplication();
 
   app.enableVersioning(versioningOptions);
+  if (beforeInit) {
+    await beforeInit(app);
+  }
   await app.init();
 
   return app;
diff --git a/integration/hello-world/e2e/middleware.spec.ts b/integration/hello-world/e2e/middleware.spec.ts
index ccb20b2ce..4d0fb315b 100644
--- a/integration/hello-world/e2e/middleware.spec.ts
+++ b/integration/hello-world/e2e/middleware.spec.ts
@@ -12,6 +12,7 @@ import { AppModule } from '../src/app.module';
 const RETURN_VALUE = 'test';
 const SCOPED_VALUE = 'test_scoped';
 const WILDCARD_VALUE = 'test_wildcard';
+const EXCLUDE_VALUE = 'test_exclude';
 
 @Controller()
 class TestController {
@@ -24,6 +25,11 @@ class TestController {
   wildcard_nested() {
     return RETURN_VALUE;
   }
+
+  @Get('exclude')
+  exclude() {
+    return EXCLUDE_VALUE;
+  }
 }
 
 @Module({
@@ -36,8 +42,10 @@ class TestModule {
       .apply((req, res, next) => res.send(WILDCARD_VALUE))
       .forRoutes('tests/*')
       .apply((req, res, next) => res.send(SCOPED_VALUE))
+      .exclude('exclude')
       .forRoutes(TestController)
       .apply((req, res, next) => res.send(RETURN_VALUE))
+      .exclude('exclude')
       .forRoutes('*');
   }
 }
@@ -45,25 +53,34 @@ class TestModule {
 describe('Middleware', () => {
   let app: INestApplication;
 
-  beforeEach(async () => {
-    app = (
-      await Test.createTestingModule({
-        imports: [TestModule],
-      }).compile()
-    ).createNestApplication();
-
-    await app.init();
+  it(`forRoutes(*)`, async () => {
+    app = await createApp();
+    await request(app.getHttpServer()).get('/hello').expect(200, RETURN_VALUE);
+    await request(app.getHttpServer())
+      .get('/exclude')
+      .expect(200, EXCLUDE_VALUE);
   });
 
-  it(`forRoutes(*)`, () => {
-    return request(app.getHttpServer()).get('/hello').expect(200, RETURN_VALUE);
+  it(`forRoutes(*) with global prefix`, async () => {
+    app = await createApp(app => app.setGlobalPrefix('api'));
+    await request(app.getHttpServer())
+      .get('/api/hello')
+      .expect(200, RETURN_VALUE);
+    await request(app.getHttpServer())
+      .get('/api/exclude')
+      .expect(200, EXCLUDE_VALUE);
   });
 
-  it(`forRoutes(TestController)`, () => {
-    return request(app.getHttpServer()).get('/test').expect(200, SCOPED_VALUE);
+  it(`forRoutes(TestController)`, async () => {
+    app = await createApp();
+    await request(app.getHttpServer()).get('/test').expect(200, SCOPED_VALUE);
+    await request(app.getHttpServer())
+      .get('/exclude')
+      .expect(200, EXCLUDE_VALUE);
   });
 
-  it(`forRoutes(tests/*)`, () => {
+  it(`forRoutes(tests/*)`, async () => {
+    app = await createApp();
     return request(app.getHttpServer())
       .get('/tests/wildcard')
       .expect(200, WILDCARD_VALUE);
@@ -73,3 +90,20 @@ describe('Middleware', () => {
     await app.close();
   });
 });
+
+async function createApp(
+  beforeInit?: (app: INestApplication) => void,
+): Promise<INestApplication> {
+  const app = (
+    await Test.createTestingModule({
+      imports: [TestModule],
+    }).compile()
+  ).createNestApplication();
+
+  if (beforeInit) {
+    beforeInit(app);
+  }
+  await app.init();
+
+  return app;
+}
diff --git a/integration/hello-world/src/errors/errors.controller.ts b/integration/hello-world/src/errors/errors.controller.ts
index 76f867bb7..7b2b9e1b8 100644
--- a/integration/hello-world/src/errors/errors.controller.ts
+++ b/integration/hello-world/src/errors/errors.controller.ts
@@ -1,4 +1,4 @@
-import { BadRequestException, Controller, Get } from '@nestjs/common';
+import { BadRequestException, Controller, Get, Header } from '@nestjs/common';
 
 @Controller()
 export class ErrorsController {
@@ -12,6 +12,12 @@ export class ErrorsController {
     this.throwError();
   }
 
+  @Get('unexpected-error')
+  @Header('Content-Type', 'application/pdf')
+  unexpectedError() {
+    throw new Error();
+  }
+
   throwError() {
     throw new BadRequestException({
       statusCode: 400,
diff --git a/integration/hello-world/tsconfig.json b/integration/hello-world/tsconfig.json
index c6354c564..cef623d14 100644
--- a/integration/hello-world/tsconfig.json
+++ b/integration/hello-world/tsconfig.json
@@ -7,10 +7,28 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
diff --git a/integration/hooks/tsconfig.json b/integration/hooks/tsconfig.json
index c6354c564..cef623d14 100644
--- a/integration/hooks/tsconfig.json
+++ b/integration/hooks/tsconfig.json
@@ -7,10 +7,28 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
diff --git a/integration/injector/e2e/optional-factory-provider-dep.spec.ts b/integration/injector/e2e/optional-factory-provider-dep.spec.ts
index 530db5286..d82f05136 100644
--- a/integration/injector/e2e/optional-factory-provider-dep.spec.ts
+++ b/integration/injector/e2e/optional-factory-provider-dep.spec.ts
@@ -121,6 +121,7 @@ describe('Optional factory provider deps', () => {
           .equal(`Nest can't resolve dependencies of the POSSIBLY_MISSING_DEP (?). Please make sure that the argument MISSING_DEP at index [0] is available in the RootTestModule context.
 
 Potential solutions:
+- Is RootTestModule a valid NestJS module?
 - If MISSING_DEP is a provider, is it part of the current RootTestModule?
 - If MISSING_DEP is exported from a separate @Module, is that module imported within RootTestModule?
   @Module({
diff --git a/integration/injector/src/self-injection/self-injection-provider.module.ts b/integration/injector/src/self-injection/self-injection-provider.module.ts
index 6850c75dc..1dcf6eecb 100644
--- a/integration/injector/src/self-injection/self-injection-provider.module.ts
+++ b/integration/injector/src/self-injection/self-injection-provider.module.ts
@@ -6,7 +6,7 @@ class ServiceInjectingItself {
 }
 
 @Injectable()
-class ServiceInjectingItselfForwared {
+class ServiceInjectingItselfForward {
   constructor(
     @Inject(forwardRef(() => ServiceInjectingItself))
     private readonly coreService: ServiceInjectingItself,
@@ -24,7 +24,7 @@ class ServiceInjectingItselfViaCustomToken {
 export class SelfInjectionProviderModule {}
 
 @Module({
-  providers: [ServiceInjectingItselfForwared],
+  providers: [ServiceInjectingItselfForward],
 })
 export class SelfInjectionForwardProviderModule {}
 
diff --git a/integration/injector/tsconfig.json b/integration/injector/tsconfig.json
index c6354c564..cef623d14 100644
--- a/integration/injector/tsconfig.json
+++ b/integration/injector/tsconfig.json
@@ -7,10 +7,28 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
diff --git a/integration/inspector/e2e/fixtures/post-init-graph.json b/integration/inspector/e2e/fixtures/post-init-graph.json
new file mode 100644
index 000000000..36ca478b2
--- /dev/null
+++ b/integration/inspector/e2e/fixtures/post-init-graph.json
@@ -0,0 +1,3171 @@
+{
+  "nodes": {
+    "18347652": {
+      "id": "18347652",
+      "label": "LoggingInterceptor",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "injectable",
+        "internal": false,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "LoggingInterceptor",
+        "subtype": "interceptor",
+        "initTime": 0
+      }
+    },
+    "55510001": {
+      "id": "55510001",
+      "label": "UsersService",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "UsersService",
+        "initTime": 0
+      }
+    },
+    "91819333": {
+      "id": "91819333",
+      "label": "ModuleRef",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "203550704": {
+      "id": "203550704",
+      "label": "ExternalContextCreator",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": true,
+        "token": "ExternalContextCreator"
+      }
+    },
+    "208171089": {
+      "id": "208171089",
+      "label": "RolesGuard",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "injectable",
+        "internal": false,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "RolesGuard",
+        "subtype": "guard",
+        "initTime": 0
+      }
+    },
+    "225063248": {
+      "id": "225063248",
+      "label": "InternalCoreModule",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "InternalCoreModule",
+        "initTime": 0
+      }
+    },
+    "256260345": {
+      "id": "256260345",
+      "label": "ApplicationConfig",
+      "parent": "1528017428",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DatabaseModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "345516396": {
+      "id": "345516396",
+      "label": "ApplicationConfig",
+      "parent": "1142369607",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelperModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "345719894": {
+      "id": "345719894",
+      "label": "CoreModule",
+      "parent": "-1125887048",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "CoreModule",
+        "initTime": 0
+      }
+    },
+    "437945905": {
+      "id": "437945905",
+      "label": "ApplicationConfig",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "519735830": {
+      "id": "519735830",
+      "label": "ApplicationConfig",
+      "parent": "-493958991",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ChatModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "521671888": {
+      "id": "521671888",
+      "label": "DogsModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "555176277": {
+      "id": "555176277",
+      "label": "InternalCoreModule",
+      "metadata": {
+        "type": "module",
+        "global": true,
+        "dynamic": true,
+        "internal": true
+      }
+    },
+    "594986539": {
+      "id": "594986539",
+      "label": "InputService",
+      "parent": "-1813741655",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "InputModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": true,
+        "token": "InputService",
+        "initTime": 0
+      }
+    },
+    "603011239": {
+      "id": "603011239",
+      "label": "UsersService",
+      "parent": "-2003726489",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "UsersModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "UsersService",
+        "initTime": 0
+      }
+    },
+    "671882984": {
+      "id": "671882984",
+      "label": "Reflector",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": true,
+        "token": "Reflector",
+        "initTime": 0
+      }
+    },
+    "791004148": {
+      "id": "791004148",
+      "label": "ExternalSvcModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "867482265": {
+      "id": "867482265",
+      "label": "Interceptor",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "injectable",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "Interceptor",
+        "subtype": "interceptor",
+        "initTime": 0
+      }
+    },
+    "927096496": {
+      "id": "927096496",
+      "label": "ApplicationConfig",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "928565345": {
+      "id": "928565345",
+      "label": "HelperService",
+      "parent": "1142369607",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "HelperModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": true,
+        "token": "HelperService",
+        "initTime": 0
+      }
+    },
+    "941957564": {
+      "id": "941957564",
+      "label": "RequestChainModule",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "RequestChainModule",
+        "initTime": 0
+      }
+    },
+    "980514911": {
+      "id": "980514911",
+      "label": "Symbol(token)",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "Symbol(token)"
+      }
+    },
+    "1004276345": {
+      "id": "1004276345",
+      "label": "Meta",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "META",
+        "initTime": 0
+      }
+    },
+    "1010833816": {
+      "id": "1010833816",
+      "label": "token",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "token"
+      }
+    },
+    "1047229654": {
+      "id": "1047229654",
+      "label": "CircularModule",
+      "parent": "-369869768",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CircularModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "CircularModule",
+        "initTime": 0
+      }
+    },
+    "1074192353": {
+      "id": "1074192353",
+      "label": "ChatService",
+      "parent": "-493958991",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "ChatModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "ChatService",
+        "initTime": 0
+      }
+    },
+    "1120316353": {
+      "id": "1120316353",
+      "label": "ModuleRef",
+      "parent": "1142369607",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelperModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "1131051184": {
+      "id": "1131051184",
+      "label": "ChatGateway",
+      "parent": "-493958991",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "ChatModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "ChatGateway",
+        "initTime": 0
+      }
+    },
+    "1142369607": {
+      "id": "1142369607",
+      "label": "HelperModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "1189153544": {
+      "id": "1189153544",
+      "label": "ChatModule",
+      "parent": "-493958991",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ChatModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ChatModule",
+        "initTime": 0
+      }
+    },
+    "1253818496": {
+      "id": "1253818496",
+      "label": "RootTestModule",
+      "parent": "-1251270035",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RootTestModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "RootTestModule",
+        "initTime": 0
+      }
+    },
+    "1433815174": {
+      "id": "1433815174",
+      "label": "DogsModule",
+      "parent": "521671888",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DogsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "DogsModule",
+        "initTime": 0
+      }
+    },
+    "1434441974": {
+      "id": "1434441974",
+      "label": "CatsModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "1434456218": {
+      "id": "1434456218",
+      "label": "Reflector",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": true,
+        "token": "Reflector",
+        "initTime": 0
+      }
+    },
+    "1472486160": {
+      "id": "1472486160",
+      "label": "HelloController",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "HelloController",
+        "initTime": 0,
+        "enhancers": [
+          {
+            "id": "-2010060263",
+            "methodKey": "greeting",
+            "subtype": "guard"
+          },
+          {
+            "id": "867482265",
+            "methodKey": "greeting",
+            "subtype": "interceptor"
+          },
+          {
+            "id": "1893794611",
+            "methodKey": "greeting",
+            "subtype": "pipe"
+          }
+        ]
+      }
+    },
+    "1528017428": {
+      "id": "1528017428",
+      "label": "DatabaseModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "1535366709": {
+      "id": "1535366709",
+      "label": "ApplicationConfig",
+      "parent": "521671888",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DogsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "1551182002": {
+      "id": "1551182002",
+      "label": "ModuleRef",
+      "parent": "-1125887048",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "1616075090": {
+      "id": "1616075090",
+      "label": "CatsModule",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "CatsModule",
+        "initTime": 0
+      }
+    },
+    "1634859874": {
+      "id": "1634859874",
+      "label": "LoggerMiddleware",
+      "parent": "-1125887048",
+      "metadata": {
+        "type": "middleware",
+        "internal": false,
+        "sourceModuleName": "CoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "LoggerMiddleware",
+        "initTime": 0
+      }
+    },
+    "1743739569": {
+      "id": "1743739569",
+      "label": "HelloModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": true,
+        "internal": false
+      }
+    },
+    "1771940178": {
+      "id": "1771940178",
+      "label": "ApplicationConfig",
+      "parent": "-1251270035",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RootTestModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "1809676814": {
+      "id": "1809676814",
+      "label": "ModuleRef",
+      "parent": "1528017428",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DatabaseModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "1893794611": {
+      "id": "1893794611",
+      "label": "UserByIdPipe",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "injectable",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "UserByIdPipe",
+        "subtype": "pipe",
+        "initTime": 0
+      }
+    },
+    "1919157847": {
+      "id": "1919157847",
+      "label": "REQUEST",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": true,
+        "token": "REQUEST",
+        "initTime": 0
+      }
+    },
+    "2018972420": {
+      "id": "2018972420",
+      "label": "TransformInterceptor",
+      "parent": "-1125887048",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "CoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "APP_INTERCEPTOR (UUID: -1146749753)",
+        "subtype": "interceptor",
+        "initTime": 0,
+        "global": true
+      }
+    },
+    "2133316171": {
+      "id": "2133316171",
+      "label": "RequestChainModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-1486320561": {
+      "id": "-1486320561",
+      "label": "ModuleRef",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-651043398": {
+      "id": "-651043398",
+      "label": "ApplicationConfig",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-255469305": {
+      "id": "-255469305",
+      "label": "INQUIRER",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 1,
+        "transient": true,
+        "exported": true,
+        "token": "INQUIRER",
+        "initTime": 0
+      }
+    },
+    "-26938366": {
+      "id": "-26938366",
+      "label": "ModulesContainer",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": true,
+        "token": "ModulesContainer"
+      }
+    },
+    "-326832201": {
+      "id": "-326832201",
+      "label": "HttpAdapterHost",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": true,
+        "token": "HttpAdapterHost"
+      }
+    },
+    "-553129559": {
+      "id": "-553129559",
+      "label": "HttpAdapterHost",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": true,
+        "token": "HttpAdapterHost",
+        "initTime": 0
+      }
+    },
+    "-702581189": {
+      "id": "-702581189",
+      "label": "LazyModuleLoader",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": true,
+        "token": "LazyModuleLoader",
+        "initTime": 0
+      }
+    },
+    "-1904419534": {
+      "id": "-1904419534",
+      "label": "SerializedGraph",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": true,
+        "token": "SerializedGraph"
+      }
+    },
+    "-1251270035": {
+      "id": "-1251270035",
+      "label": "RootTestModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-969610649": {
+      "id": "-969610649",
+      "label": "ModuleRef",
+      "parent": "-1251270035",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RootTestModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-19112576": {
+      "id": "-19112576",
+      "label": "AppModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-2139588960": {
+      "id": "-2139588960",
+      "label": "AppModule",
+      "parent": "-19112576",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "AppModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "AppModule",
+        "initTime": 0
+      }
+    },
+    "-71302842": {
+      "id": "-71302842",
+      "label": "ModuleRef",
+      "parent": "-19112576",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "AppModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-2064622725": {
+      "id": "-2064622725",
+      "label": "ApplicationConfig",
+      "parent": "-19112576",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "AppModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-365265483": {
+      "id": "-365265483",
+      "label": "AppV1Controller",
+      "parent": "-19112576",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "AppModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "AppV1Controller",
+        "initTime": 0
+      }
+    },
+    "-774089708": {
+      "id": "-774089708",
+      "label": "AppV2Controller",
+      "parent": "-19112576",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "AppModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "AppV2Controller",
+        "initTime": 0
+      }
+    },
+    "-1125887048": {
+      "id": "-1125887048",
+      "label": "CoreModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-112192227": {
+      "id": "-112192227",
+      "label": "ApplicationConfig",
+      "parent": "-1125887048",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-2007711503": {
+      "id": "-2007711503",
+      "label": "LoggingInterceptor",
+      "parent": "-1125887048",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "CoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "APP_INTERCEPTOR (UUID: 1780085433)",
+        "subtype": "interceptor",
+        "initTime": 0,
+        "global": true
+      }
+    },
+    "-183456272": {
+      "id": "-183456272",
+      "label": "ModuleRef",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-1846830501": {
+      "id": "-1846830501",
+      "label": "ApplicationConfig",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-593595711": {
+      "id": "-593595711",
+      "label": "CatsService",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "CatsService",
+        "initTime": 0
+      }
+    },
+    "-1550892030": {
+      "id": "-1550892030",
+      "label": "CatsController",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "CatsController",
+        "initTime": 0,
+        "enhancers": [
+          {
+            "id": "208171089",
+            "subtype": "guard"
+          },
+          {
+            "name": "ParseIntPipe",
+            "methodKey": "findOne",
+            "subtype": "pipe"
+          }
+        ]
+      }
+    },
+    "-1378706112": {
+      "id": "-1378706112",
+      "label": "HelloModule",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "HelloModule",
+        "initTime": 0
+      }
+    },
+    "-1166465801": {
+      "id": "-1166465801",
+      "label": "ModuleRef",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-1191459348": {
+      "id": "-1191459348",
+      "label": "ApplicationConfig",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-1758187461": {
+      "id": "-1758187461",
+      "label": "HelloService",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "HelloService",
+        "initTime": 0
+      }
+    },
+    "-2010060263": {
+      "id": "-2010060263",
+      "label": "Guard",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "injectable",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "Guard",
+        "subtype": "guard",
+        "initTime": 0
+      }
+    },
+    "-1124392646": {
+      "id": "-1124392646",
+      "label": "DurableModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-522935456": {
+      "id": "-522935456",
+      "label": "DurableModule",
+      "parent": "-1124392646",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DurableModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "DurableModule",
+        "initTime": 0
+      }
+    },
+    "-1808043520": {
+      "id": "-1808043520",
+      "label": "ModuleRef",
+      "parent": "-1124392646",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DurableModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-57038411": {
+      "id": "-57038411",
+      "label": "ApplicationConfig",
+      "parent": "-1124392646",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DurableModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-1673986099": {
+      "id": "-1673986099",
+      "label": "DurableService",
+      "parent": "-1124392646",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "DurableModule",
+        "durable": true,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "DurableService",
+        "initTime": 0
+      }
+    },
+    "-848516688": {
+      "id": "-848516688",
+      "label": "DurableController",
+      "parent": "-1124392646",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "DurableModule",
+        "durable": true,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "DurableController",
+        "initTime": 0
+      }
+    },
+    "-1096226358": {
+      "id": "-1096226358",
+      "label": "ModuleRef",
+      "parent": "521671888",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DogsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-335387007": {
+      "id": "-335387007",
+      "label": "DogsService",
+      "parent": "521671888",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "DogsModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "DogsService",
+        "initTime": 0
+      }
+    },
+    "-1558907338": {
+      "id": "-1558907338",
+      "label": "DogsController",
+      "parent": "521671888",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "DogsModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "DogsController",
+        "initTime": 0
+      }
+    },
+    "-2003726489": {
+      "id": "-2003726489",
+      "label": "UsersModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-495603840": {
+      "id": "-495603840",
+      "label": "UsersModule",
+      "parent": "-2003726489",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "UsersModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "UsersModule",
+        "initTime": 0
+      }
+    },
+    "-618964563": {
+      "id": "-618964563",
+      "label": "ModuleRef",
+      "parent": "-2003726489",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "UsersModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-643958110": {
+      "id": "-643958110",
+      "label": "ApplicationConfig",
+      "parent": "-2003726489",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "UsersModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-1102473136": {
+      "id": "-1102473136",
+      "label": "UsersController",
+      "parent": "-2003726489",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "UsersModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "UsersController",
+        "initTime": 0
+      }
+    },
+    "-1098322034": {
+      "id": "-1098322034",
+      "label": "DatabaseModule",
+      "parent": "1528017428",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DatabaseModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "DatabaseModule",
+        "initTime": 0
+      }
+    },
+    "-616397055": {
+      "id": "-616397055",
+      "label": "DatabaseService",
+      "parent": "1528017428",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "DatabaseModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "DatabaseService",
+        "initTime": 0
+      }
+    },
+    "-377928898": {
+      "id": "-377928898",
+      "label": "DatabaseController",
+      "parent": "1528017428",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "DatabaseModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "DatabaseController",
+        "initTime": 0
+      }
+    },
+    "-511735264": {
+      "id": "-511735264",
+      "label": "ExternalSvcModule",
+      "parent": "791004148",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ExternalSvcModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ExternalSvcModule",
+        "initTime": 0
+      }
+    },
+    "-660323910": {
+      "id": "-660323910",
+      "label": "ModuleRef",
+      "parent": "791004148",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ExternalSvcModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-217737489": {
+      "id": "-217737489",
+      "label": "ApplicationConfig",
+      "parent": "791004148",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ExternalSvcModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-1902429503": {
+      "id": "-1902429503",
+      "label": "ExternalSvcService",
+      "parent": "791004148",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "ExternalSvcModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "ExternalSvcService",
+        "initTime": 0
+      }
+    },
+    "-349899408": {
+      "id": "-349899408",
+      "label": "ExternalSvcController",
+      "parent": "791004148",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "ExternalSvcModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "ExternalSvcController",
+        "initTime": 0
+      }
+    },
+    "-493958991": {
+      "id": "-493958991",
+      "label": "ChatModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-2111857237": {
+      "id": "-2111857237",
+      "label": "ModuleRef",
+      "parent": "-493958991",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ChatModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-234035039": {
+      "id": "-234035039",
+      "label": "RequestChainService",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "RequestChainService",
+        "initTime": 0
+      }
+    },
+    "-1927427604": {
+      "id": "-1927427604",
+      "label": "RequestChainController",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "RequestChainController",
+        "initTime": 0,
+        "enhancers": [
+          {
+            "id": "18347652",
+            "methodKey": "greeting",
+            "subtype": "interceptor"
+          }
+        ]
+      }
+    },
+    "-162987852": {
+      "id": "-162987852",
+      "label": "HelperModule",
+      "parent": "1142369607",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelperModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "HelperModule",
+        "initTime": 0
+      }
+    },
+    "-1469176692": {
+      "id": "-1469176692",
+      "label": "PropertiesModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-1501313730": {
+      "id": "-1501313730",
+      "label": "PropertiesModule",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "PropertiesModule",
+        "initTime": 0
+      }
+    },
+    "-1377446394": {
+      "id": "-1377446394",
+      "label": "ModuleRef",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-1494077847": {
+      "id": "-1494077847",
+      "label": "DependencyService",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "DependencyService",
+        "initTime": 0
+      }
+    },
+    "-1803759743": {
+      "id": "-1803759743",
+      "label": "PropertiesService",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "PropertiesService",
+        "initTime": 0
+      }
+    },
+    "-1813741655": {
+      "id": "-1813741655",
+      "label": "InputModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-2113121728": {
+      "id": "-2113121728",
+      "label": "InputModule",
+      "parent": "-1813741655",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InputModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "InputModule",
+        "initTime": 0
+      }
+    },
+    "-428979729": {
+      "id": "-428979729",
+      "label": "ModuleRef",
+      "parent": "-1813741655",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InputModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-453973276": {
+      "id": "-453973276",
+      "label": "ApplicationConfig",
+      "parent": "-1813741655",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InputModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-369869768": {
+      "id": "-369869768",
+      "label": "CircularModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-88210382": {
+      "id": "-88210382",
+      "label": "ModuleRef",
+      "parent": "-369869768",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CircularModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-1641626851": {
+      "id": "-1641626851",
+      "label": "ApplicationConfig",
+      "parent": "-369869768",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CircularModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-1721730431": {
+      "id": "-1721730431",
+      "label": "CircularService",
+      "parent": "-369869768",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "CircularModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": true,
+        "token": "CircularService",
+        "initTime": 0
+      }
+    }
+  },
+  "edges": {
+    "22193019": {
+      "source": "-19112576",
+      "target": "521671888",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "DogsModule"
+      },
+      "id": "22193019"
+    },
+    "33333764": {
+      "source": "791004148",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "ExternalSvcModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "33333764"
+    },
+    "40501732": {
+      "source": "521671888",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "DogsModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "40501732"
+    },
+    "73947303": {
+      "source": "-1813741655",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "InputModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "73947303"
+    },
+    "182501115": {
+      "source": "1434441974",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "CatsModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "182501115"
+    },
+    "189694679": {
+      "source": "1434456218",
+      "target": "671882984",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "InternalCoreModule",
+        "sourceClassName": "Reflector",
+        "targetClassName": "Reflector",
+        "sourceClassToken": "Reflector",
+        "targetClassToken": "Reflector",
+        "targetModuleName": "InternalCoreModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor",
+        "internal": true
+      },
+      "id": "189694679"
+    },
+    "231469845": {
+      "source": "-1803759743",
+      "target": "-1494077847",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "PropertiesModule",
+        "sourceClassName": "PropertiesService",
+        "targetClassName": "DependencyService",
+        "sourceClassToken": "PropertiesService",
+        "targetClassToken": "DependencyService",
+        "targetModuleName": "PropertiesModule",
+        "keyOrIndex": "service",
+        "injectionType": "property"
+      },
+      "id": "231469845"
+    },
+    "250652665": {
+      "source": "2133316171",
+      "target": "1142369607",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "RequestChainModule",
+        "targetModuleName": "HelperModule"
+      },
+      "id": "250652665"
+    },
+    "393939926": {
+      "source": "-1813741655",
+      "target": "-369869768",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "InputModule",
+        "targetModuleName": "CircularModule"
+      },
+      "id": "393939926"
+    },
+    "417363164": {
+      "source": "-1251270035",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "RootTestModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "417363164"
+    },
+    "469401997": {
+      "source": "-493958991",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "ChatModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "469401997"
+    },
+    "654001290": {
+      "source": "1472486160",
+      "target": "867482265",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloController",
+        "targetClassName": "Interceptor",
+        "sourceClassToken": "HelloController",
+        "targetClassToken": "Interceptor",
+        "targetModuleName": "HelloModule",
+        "injectionType": "decorator"
+      },
+      "id": "654001290"
+    },
+    "676175891": {
+      "source": "-1251270035",
+      "target": "-19112576",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "RootTestModule",
+        "targetModuleName": "AppModule"
+      },
+      "id": "676175891"
+    },
+    "800268760": {
+      "source": "-1102473136",
+      "target": "603011239",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "UsersModule",
+        "sourceClassName": "UsersController",
+        "targetClassName": "UsersService",
+        "sourceClassToken": "UsersController",
+        "targetClassToken": "UsersService",
+        "targetModuleName": "UsersModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "800268760"
+    },
+    "804987620": {
+      "source": "-19112576",
+      "target": "-1125887048",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "CoreModule"
+      },
+      "id": "804987620"
+    },
+    "807697929": {
+      "source": "-19112576",
+      "target": "1528017428",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "DatabaseModule"
+      },
+      "id": "807697929"
+    },
+    "966350248": {
+      "source": "1131051184",
+      "target": "1074192353",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "ChatModule",
+        "sourceClassName": "ChatGateway",
+        "targetClassName": "ChatService",
+        "sourceClassToken": "ChatGateway",
+        "targetClassToken": "ChatService",
+        "targetModuleName": "ChatModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "966350248"
+    },
+    "987755577": {
+      "source": "-2003726489",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "UsersModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "987755577"
+    },
+    "1056428433": {
+      "source": "-19112576",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "1056428433"
+    },
+    "1059069749": {
+      "source": "-1558907338",
+      "target": "-335387007",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "DogsModule",
+        "sourceClassName": "DogsController",
+        "targetClassName": "DogsService",
+        "sourceClassToken": "DogsController",
+        "targetClassToken": "DogsService",
+        "targetModuleName": "DogsModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1059069749"
+    },
+    "1142343545": {
+      "source": "-1758187461",
+      "target": "1004276345",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloService",
+        "targetClassName": "Meta",
+        "sourceClassToken": "HelloService",
+        "targetClassToken": "META",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1142343545"
+    },
+    "1178436405": {
+      "source": "1893794611",
+      "target": "55510001",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "UserByIdPipe",
+        "targetClassName": "UsersService",
+        "sourceClassToken": "UserByIdPipe",
+        "targetClassToken": "UsersService",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1178436405"
+    },
+    "1195474320": {
+      "source": "-369869768",
+      "target": "-1813741655",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "CircularModule",
+        "targetModuleName": "InputModule"
+      },
+      "id": "1195474320"
+    },
+    "1247743823": {
+      "source": "2133316171",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "RequestChainModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "1247743823"
+    },
+    "1325313063": {
+      "source": "-1927427604",
+      "target": "18347652",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "RequestChainModule",
+        "sourceClassName": "RequestChainController",
+        "targetClassName": "LoggingInterceptor",
+        "sourceClassToken": "RequestChainController",
+        "targetClassToken": "LoggingInterceptor",
+        "targetModuleName": "RequestChainModule",
+        "injectionType": "decorator"
+      },
+      "id": "1325313063"
+    },
+    "1497653915": {
+      "source": "55510001",
+      "target": "1004276345",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "UsersService",
+        "targetClassName": "Meta",
+        "sourceClassToken": "UsersService",
+        "targetClassToken": "META",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1497653915"
+    },
+    "1615322974": {
+      "source": "-1469176692",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "PropertiesModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "1615322974"
+    },
+    "1856016815": {
+      "source": "-1721730431",
+      "target": "594986539",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "CircularModule",
+        "sourceClassName": "CircularService",
+        "targetClassName": "InputService",
+        "sourceClassToken": "CircularService",
+        "targetClassToken": "InputService",
+        "targetModuleName": "InputModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1856016815"
+    },
+    "1900414743": {
+      "source": "1472486160",
+      "target": "1893794611",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloController",
+        "targetClassName": "UserByIdPipe",
+        "sourceClassToken": "HelloController",
+        "targetClassToken": "UserByIdPipe",
+        "targetModuleName": "HelloModule",
+        "injectionType": "decorator"
+      },
+      "id": "1900414743"
+    },
+    "1904579661": {
+      "source": "18347652",
+      "target": "928565345",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "RequestChainModule",
+        "sourceClassName": "LoggingInterceptor",
+        "targetClassName": "HelperService",
+        "sourceClassToken": "LoggingInterceptor",
+        "targetClassToken": "HelperService",
+        "targetModuleName": "HelperModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1904579661"
+    },
+    "1960203007": {
+      "source": "-1803759743",
+      "target": "980514911",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "PropertiesModule",
+        "sourceClassName": "PropertiesService",
+        "targetClassName": "Symbol(token)",
+        "sourceClassToken": "PropertiesService",
+        "targetClassToken": "Symbol(token)",
+        "targetModuleName": "PropertiesModule",
+        "keyOrIndex": "symbolToken",
+        "injectionType": "property"
+      },
+      "id": "1960203007"
+    },
+    "1976848738": {
+      "source": "1528017428",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "DatabaseModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "1976848738"
+    },
+    "-1759625292": {
+      "source": "-553129559",
+      "target": "-326832201",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "InternalCoreModule",
+        "sourceClassName": "HttpAdapterHost",
+        "targetClassName": "HttpAdapterHost",
+        "sourceClassToken": "HttpAdapterHost",
+        "targetClassToken": "HttpAdapterHost",
+        "targetModuleName": "InternalCoreModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor",
+        "internal": true
+      },
+      "id": "-1759625292"
+    },
+    "-2105726668": {
+      "source": "-1803759743",
+      "target": "1010833816",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "PropertiesModule",
+        "sourceClassName": "PropertiesService",
+        "targetClassName": "token",
+        "sourceClassToken": "PropertiesService",
+        "targetClassToken": "token",
+        "targetModuleName": "PropertiesModule",
+        "keyOrIndex": "token",
+        "injectionType": "property"
+      },
+      "id": "-2105726668"
+    },
+    "-21463590": {
+      "source": "-1378706112",
+      "target": "1004276345",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloModule",
+        "targetClassName": "Meta",
+        "sourceClassToken": "HelloModule",
+        "targetClassToken": "META",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-21463590"
+    },
+    "-1657371464": {
+      "source": "-1673986099",
+      "target": "1919157847",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "DurableModule",
+        "sourceClassName": "DurableService",
+        "targetClassName": "REQUEST",
+        "sourceClassToken": "DurableService",
+        "targetClassToken": "REQUEST",
+        "targetModuleName": "InternalCoreModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor",
+        "internal": true
+      },
+      "id": "-1657371464"
+    },
+    "-1303681274": {
+      "source": "928565345",
+      "target": "1919157847",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelperModule",
+        "sourceClassName": "HelperService",
+        "targetClassName": "REQUEST",
+        "sourceClassToken": "HelperService",
+        "targetClassToken": "REQUEST",
+        "targetModuleName": "InternalCoreModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor",
+        "internal": true
+      },
+      "id": "-1303681274"
+    },
+    "-886102564": {
+      "source": "208171089",
+      "target": "671882984",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "CatsModule",
+        "sourceClassName": "RolesGuard",
+        "targetClassName": "Reflector",
+        "sourceClassToken": "RolesGuard",
+        "targetClassToken": "Reflector",
+        "targetModuleName": "InternalCoreModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor",
+        "internal": true
+      },
+      "id": "-886102564"
+    },
+    "-2003045613": {
+      "source": "-377928898",
+      "target": "-616397055",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "DatabaseModule",
+        "sourceClassName": "DatabaseController",
+        "targetClassName": "DatabaseService",
+        "sourceClassToken": "DatabaseController",
+        "targetClassToken": "DatabaseService",
+        "targetModuleName": "DatabaseModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-2003045613"
+    },
+    "-881420795": {
+      "source": "-349899408",
+      "target": "-1902429503",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "ExternalSvcModule",
+        "sourceClassName": "ExternalSvcController",
+        "targetClassName": "ExternalSvcService",
+        "sourceClassToken": "ExternalSvcController",
+        "targetClassToken": "ExternalSvcService",
+        "targetModuleName": "ExternalSvcModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-881420795"
+    },
+    "-831049991": {
+      "source": "594986539",
+      "target": "-1721730431",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "InputModule",
+        "sourceClassName": "InputService",
+        "targetClassName": "CircularService",
+        "sourceClassToken": "InputService",
+        "targetClassToken": "CircularService",
+        "targetModuleName": "CircularModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-831049991"
+    },
+    "-2146943494": {
+      "source": "-234035039",
+      "target": "928565345",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "RequestChainModule",
+        "sourceClassName": "RequestChainService",
+        "targetClassName": "HelperService",
+        "sourceClassToken": "RequestChainService",
+        "targetClassToken": "HelperService",
+        "targetModuleName": "HelperModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-2146943494"
+    },
+    "-1816180282": {
+      "source": "-848516688",
+      "target": "-1673986099",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "DurableModule",
+        "sourceClassName": "DurableController",
+        "targetClassName": "DurableService",
+        "sourceClassToken": "DurableController",
+        "targetClassToken": "DurableService",
+        "targetModuleName": "DurableModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-1816180282"
+    },
+    "-180350082": {
+      "source": "-1550892030",
+      "target": "-593595711",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "CatsModule",
+        "sourceClassName": "CatsController",
+        "targetClassName": "CatsService",
+        "sourceClassToken": "CatsController",
+        "targetClassToken": "CatsService",
+        "targetModuleName": "CatsModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-180350082"
+    },
+    "-1043628608": {
+      "source": "1472486160",
+      "target": "-1758187461",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloController",
+        "targetClassName": "HelloService",
+        "sourceClassToken": "HelloController",
+        "targetClassToken": "HelloService",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-1043628608"
+    },
+    "-1335121169": {
+      "source": "1472486160",
+      "target": "55510001",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloController",
+        "targetClassName": "UsersService",
+        "sourceClassToken": "HelloController",
+        "targetClassToken": "UsersService",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 1,
+        "injectionType": "constructor"
+      },
+      "id": "-1335121169"
+    },
+    "-296280311": {
+      "source": "-1927427604",
+      "target": "-234035039",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "RequestChainModule",
+        "sourceClassName": "RequestChainController",
+        "targetClassName": "RequestChainService",
+        "sourceClassToken": "RequestChainController",
+        "targetClassToken": "RequestChainService",
+        "targetModuleName": "RequestChainModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-296280311"
+    },
+    "-393224862": {
+      "source": "-19112576",
+      "target": "1434441974",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "CatsModule"
+      },
+      "id": "-393224862"
+    },
+    "-1675983900": {
+      "source": "-19112576",
+      "target": "1743739569",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "HelloModule"
+      },
+      "id": "-1675983900"
+    },
+    "-678699872": {
+      "source": "-19112576",
+      "target": "-1124392646",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "DurableModule"
+      },
+      "id": "-678699872"
+    },
+    "-158970266": {
+      "source": "-19112576",
+      "target": "-2003726489",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "UsersModule"
+      },
+      "id": "-158970266"
+    },
+    "-2086236431": {
+      "source": "-19112576",
+      "target": "791004148",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "ExternalSvcModule"
+      },
+      "id": "-2086236431"
+    },
+    "-192150092": {
+      "source": "-19112576",
+      "target": "-493958991",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "ChatModule"
+      },
+      "id": "-192150092"
+    },
+    "-1609022090": {
+      "source": "-19112576",
+      "target": "2133316171",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "RequestChainModule"
+      },
+      "id": "-1609022090"
+    },
+    "-773455435": {
+      "source": "-19112576",
+      "target": "-1469176692",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "PropertiesModule"
+      },
+      "id": "-773455435"
+    },
+    "-967144236": {
+      "source": "-19112576",
+      "target": "-1813741655",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "InputModule"
+      },
+      "id": "-967144236"
+    },
+    "-528424051": {
+      "source": "-1125887048",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "CoreModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "-528424051"
+    },
+    "-698929209": {
+      "source": "1743739569",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "HelloModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "-698929209"
+    },
+    "-1671708813": {
+      "source": "-1124392646",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "DurableModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "-1671708813"
+    },
+    "-665042842": {
+      "source": "1142369607",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "HelperModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "-665042842"
+    },
+    "-1891610441": {
+      "source": "-369869768",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "CircularModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "-1891610441"
+    },
+    "-878379437": {
+      "source": "-1550892030",
+      "target": "208171089",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "CatsModule",
+        "sourceClassName": "CatsController",
+        "targetClassName": "RolesGuard",
+        "sourceClassToken": "CatsController",
+        "targetClassToken": "RolesGuard",
+        "targetModuleName": "CatsModule",
+        "injectionType": "decorator"
+      },
+      "id": "-878379437"
+    },
+    "-822816169": {
+      "source": "1472486160",
+      "target": "-2010060263",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloController",
+        "targetClassName": "Guard",
+        "sourceClassToken": "HelloController",
+        "targetClassToken": "Guard",
+        "targetModuleName": "HelloModule",
+        "injectionType": "decorator"
+      },
+      "id": "-822816169"
+    }
+  },
+  "entrypoints": {
+    "1131051184": [
+      {
+        "type": "websocket",
+        "methodName": "create",
+        "className": "ChatGateway",
+        "classNodeId": "1131051184",
+        "metadata": {
+          "port": 0,
+          "key": "createChat",
+          "message": "createChat"
+        },
+        "id": "1131051184_create"
+      },
+      {
+        "type": "websocket",
+        "methodName": "findAll",
+        "className": "ChatGateway",
+        "classNodeId": "1131051184",
+        "metadata": {
+          "port": 0,
+          "key": "findAllChat",
+          "message": "findAllChat"
+        },
+        "id": "1131051184_findAll"
+      },
+      {
+        "type": "websocket",
+        "methodName": "findOne",
+        "className": "ChatGateway",
+        "classNodeId": "1131051184",
+        "metadata": {
+          "port": 0,
+          "key": "findOneChat",
+          "message": "findOneChat"
+        },
+        "id": "1131051184_findOne"
+      },
+      {
+        "type": "websocket",
+        "methodName": "update",
+        "className": "ChatGateway",
+        "classNodeId": "1131051184",
+        "metadata": {
+          "port": 0,
+          "key": "updateChat",
+          "message": "updateChat"
+        },
+        "id": "1131051184_update"
+      },
+      {
+        "type": "websocket",
+        "methodName": "remove",
+        "className": "ChatGateway",
+        "classNodeId": "1131051184",
+        "metadata": {
+          "port": 0,
+          "key": "removeChat",
+          "message": "removeChat"
+        },
+        "id": "1131051184_remove"
+      }
+    ],
+    "1472486160": [
+      {
+        "type": "http-endpoint",
+        "methodName": "greeting",
+        "className": "HelloController",
+        "classNodeId": "1472486160",
+        "metadata": {
+          "key": "/hello",
+          "path": "/hello",
+          "requestMethod": "GET"
+        },
+        "id": "1472486160_greeting"
+      }
+    ],
+    "1634859874": [
+      {
+        "type": "middleware",
+        "methodName": "use",
+        "className": "LoggerMiddleware",
+        "classNodeId": "1634859874",
+        "metadata": {
+          "key": "/cats/",
+          "path": "/cats/",
+          "requestMethod": "POST"
+        },
+        "id": "1634859874_use"
+      },
+      {
+        "type": "middleware",
+        "methodName": "use",
+        "className": "LoggerMiddleware",
+        "classNodeId": "1634859874",
+        "metadata": {
+          "key": "/cats/",
+          "path": "/cats/",
+          "requestMethod": "GET"
+        },
+        "id": "1634859874_use"
+      },
+      {
+        "type": "middleware",
+        "methodName": "use",
+        "className": "LoggerMiddleware",
+        "classNodeId": "1634859874",
+        "metadata": {
+          "key": "/cats/:id",
+          "path": "/cats/:id",
+          "requestMethod": "GET"
+        },
+        "id": "1634859874_use"
+      }
+    ],
+    "-349899408": [
+      {
+        "type": "microservice",
+        "methodName": "create",
+        "className": "ExternalSvcController",
+        "classNodeId": "-349899408",
+        "metadata": {
+          "key": "createExternalSvc",
+          "transportId": "TCP",
+          "patterns": [
+            "createExternalSvc"
+          ],
+          "isEventHandler": false
+        },
+        "id": "-349899408_create"
+      },
+      {
+        "type": "microservice",
+        "methodName": "findAll",
+        "className": "ExternalSvcController",
+        "classNodeId": "-349899408",
+        "metadata": {
+          "key": "findAllExternalSvc",
+          "transportId": "TCP",
+          "patterns": [
+            "findAllExternalSvc"
+          ],
+          "isEventHandler": false
+        },
+        "id": "-349899408_findAll"
+      },
+      {
+        "type": "microservice",
+        "methodName": "findOne",
+        "className": "ExternalSvcController",
+        "classNodeId": "-349899408",
+        "metadata": {
+          "key": "findOneExternalSvc",
+          "transportId": "TCP",
+          "patterns": [
+            "findOneExternalSvc"
+          ],
+          "isEventHandler": false
+        },
+        "id": "-349899408_findOne"
+      },
+      {
+        "type": "microservice",
+        "methodName": "update",
+        "className": "ExternalSvcController",
+        "classNodeId": "-349899408",
+        "metadata": {
+          "key": "updateExternalSvc",
+          "transportId": "TCP",
+          "patterns": [
+            "updateExternalSvc"
+          ],
+          "isEventHandler": false
+        },
+        "id": "-349899408_update"
+      },
+      {
+        "type": "microservice",
+        "methodName": "remove",
+        "className": "ExternalSvcController",
+        "classNodeId": "-349899408",
+        "metadata": {
+          "key": "removeExternalSvc",
+          "transportId": "TCP",
+          "patterns": [
+            "removeExternalSvc"
+          ],
+          "isEventHandler": false
+        },
+        "id": "-349899408_remove"
+      }
+    ],
+    "-365265483": [
+      {
+        "type": "http-endpoint",
+        "methodName": "helloWorldV1",
+        "className": "AppV1Controller",
+        "classNodeId": "-365265483",
+        "metadata": {
+          "key": "/v1",
+          "path": "/v1",
+          "requestMethod": "GET",
+          "controllerVersion": "1"
+        },
+        "id": "-365265483_helloWorldV1"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "paramV1",
+        "className": "AppV1Controller",
+        "classNodeId": "-365265483",
+        "metadata": {
+          "key": "/v1/:param/hello",
+          "path": "/v1/:param/hello",
+          "requestMethod": "GET",
+          "controllerVersion": "1"
+        },
+        "id": "-365265483_paramV1"
+      }
+    ],
+    "-774089708": [
+      {
+        "type": "http-endpoint",
+        "methodName": "helloWorldV2",
+        "className": "AppV2Controller",
+        "classNodeId": "-774089708",
+        "metadata": {
+          "key": "/v2",
+          "path": "/v2",
+          "requestMethod": "GET",
+          "controllerVersion": "2"
+        },
+        "id": "-774089708_helloWorldV2"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "paramV1",
+        "className": "AppV2Controller",
+        "classNodeId": "-774089708",
+        "metadata": {
+          "key": "/v3/:param/hello",
+          "path": "/v3/:param/hello",
+          "requestMethod": "GET",
+          "methodVersion": "3",
+          "controllerVersion": "2"
+        },
+        "id": "-774089708_paramV1"
+      }
+    ],
+    "-1550892030": [
+      {
+        "type": "http-endpoint",
+        "methodName": "create",
+        "className": "CatsController",
+        "classNodeId": "-1550892030",
+        "metadata": {
+          "key": "/cats",
+          "path": "/cats",
+          "requestMethod": "POST"
+        },
+        "id": "-1550892030_create"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "findAll",
+        "className": "CatsController",
+        "classNodeId": "-1550892030",
+        "metadata": {
+          "key": "/cats",
+          "path": "/cats",
+          "requestMethod": "GET"
+        },
+        "id": "-1550892030_findAll"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "findOne",
+        "className": "CatsController",
+        "classNodeId": "-1550892030",
+        "metadata": {
+          "key": "/cats/:id",
+          "path": "/cats/:id",
+          "requestMethod": "GET"
+        },
+        "id": "-1550892030_findOne"
+      }
+    ],
+    "-848516688": [
+      {
+        "type": "http-endpoint",
+        "methodName": "greeting",
+        "className": "DurableController",
+        "classNodeId": "-848516688",
+        "metadata": {
+          "key": "/durable",
+          "path": "/durable",
+          "requestMethod": "GET"
+        },
+        "id": "-848516688_greeting"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "echo",
+        "className": "DurableController",
+        "classNodeId": "-848516688",
+        "metadata": {
+          "key": "/durable/echo",
+          "path": "/durable/echo",
+          "requestMethod": "GET"
+        },
+        "id": "-848516688_echo"
+      }
+    ],
+    "-1558907338": [
+      {
+        "type": "http-endpoint",
+        "methodName": "create",
+        "className": "DogsController",
+        "classNodeId": "-1558907338",
+        "metadata": {
+          "key": "/dogs",
+          "path": "/dogs",
+          "requestMethod": "POST"
+        },
+        "id": "-1558907338_create"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "findAll",
+        "className": "DogsController",
+        "classNodeId": "-1558907338",
+        "metadata": {
+          "key": "/dogs",
+          "path": "/dogs",
+          "requestMethod": "GET"
+        },
+        "id": "-1558907338_findAll"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "findOne",
+        "className": "DogsController",
+        "classNodeId": "-1558907338",
+        "metadata": {
+          "key": "/dogs/:id",
+          "path": "/dogs/:id",
+          "requestMethod": "GET"
+        },
+        "id": "-1558907338_findOne"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "update",
+        "className": "DogsController",
+        "classNodeId": "-1558907338",
+        "metadata": {
+          "key": "/dogs/:id",
+          "path": "/dogs/:id",
+          "requestMethod": "PATCH"
+        },
+        "id": "-1558907338_update"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "remove",
+        "className": "DogsController",
+        "classNodeId": "-1558907338",
+        "metadata": {
+          "key": "/dogs/:id",
+          "path": "/dogs/:id",
+          "requestMethod": "DELETE"
+        },
+        "id": "-1558907338_remove"
+      }
+    ],
+    "-1102473136": [
+      {
+        "type": "http-endpoint",
+        "methodName": "create",
+        "className": "UsersController",
+        "classNodeId": "-1102473136",
+        "metadata": {
+          "key": "/users",
+          "path": "/users",
+          "requestMethod": "POST"
+        },
+        "id": "-1102473136_create"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "findAll",
+        "className": "UsersController",
+        "classNodeId": "-1102473136",
+        "metadata": {
+          "key": "/users",
+          "path": "/users",
+          "requestMethod": "GET"
+        },
+        "id": "-1102473136_findAll"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "findOne",
+        "className": "UsersController",
+        "classNodeId": "-1102473136",
+        "metadata": {
+          "key": "/users/:id",
+          "path": "/users/:id",
+          "requestMethod": "GET"
+        },
+        "id": "-1102473136_findOne"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "update",
+        "className": "UsersController",
+        "classNodeId": "-1102473136",
+        "metadata": {
+          "key": "/users/:id",
+          "path": "/users/:id",
+          "requestMethod": "PATCH"
+        },
+        "id": "-1102473136_update"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "remove",
+        "className": "UsersController",
+        "classNodeId": "-1102473136",
+        "metadata": {
+          "key": "/users/:id",
+          "path": "/users/:id",
+          "requestMethod": "DELETE"
+        },
+        "id": "-1102473136_remove"
+      }
+    ],
+    "-377928898": [
+      {
+        "type": "http-endpoint",
+        "methodName": "create",
+        "className": "DatabaseController",
+        "classNodeId": "-377928898",
+        "metadata": {
+          "key": "/database",
+          "path": "/database",
+          "requestMethod": "POST"
+        },
+        "id": "-377928898_create"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "findAll",
+        "className": "DatabaseController",
+        "classNodeId": "-377928898",
+        "metadata": {
+          "key": "/database",
+          "path": "/database",
+          "requestMethod": "GET"
+        },
+        "id": "-377928898_findAll"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "findOne",
+        "className": "DatabaseController",
+        "classNodeId": "-377928898",
+        "metadata": {
+          "key": "/database/:id",
+          "path": "/database/:id",
+          "requestMethod": "GET"
+        },
+        "id": "-377928898_findOne"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "update",
+        "className": "DatabaseController",
+        "classNodeId": "-377928898",
+        "metadata": {
+          "key": "/database/:id",
+          "path": "/database/:id",
+          "requestMethod": "PATCH"
+        },
+        "id": "-377928898_update"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "remove",
+        "className": "DatabaseController",
+        "classNodeId": "-377928898",
+        "metadata": {
+          "key": "/database/:id",
+          "path": "/database/:id",
+          "requestMethod": "DELETE"
+        },
+        "id": "-377928898_remove"
+      }
+    ],
+    "-1927427604": [
+      {
+        "type": "http-endpoint",
+        "methodName": "greeting",
+        "className": "RequestChainController",
+        "classNodeId": "-1927427604",
+        "metadata": {
+          "key": "/hello",
+          "path": "/hello",
+          "requestMethod": "GET"
+        },
+        "id": "-1927427604_greeting"
+      }
+    ]
+  },
+  "extras": {
+    "orphanedEnhancers": [
+      {
+        "subtype": "pipe",
+        "ref": "ValidationPipe"
+      },
+      {
+        "subtype": "filter",
+        "ref": "HttpExceptionFilter"
+      },
+      {
+        "subtype": "interceptor",
+        "ref": "TimeoutInterceptor"
+      }
+    ],
+    "attachedEnhancers": [
+      {
+        "nodeId": "2018972420"
+      },
+      {
+        "nodeId": "-2007711503"
+      }
+    ]
+  },
+  "status": "complete"
+}
\ No newline at end of file
diff --git a/integration/inspector/e2e/fixtures/pre-init-graph.json b/integration/inspector/e2e/fixtures/pre-init-graph.json
new file mode 100644
index 000000000..60aa1cc8e
--- /dev/null
+++ b/integration/inspector/e2e/fixtures/pre-init-graph.json
@@ -0,0 +1,2629 @@
+{
+  "nodes": {
+    "18347652": {
+      "id": "18347652",
+      "label": "LoggingInterceptor",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "injectable",
+        "internal": false,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "LoggingInterceptor",
+        "subtype": "interceptor",
+        "initTime": 0
+      }
+    },
+    "55510001": {
+      "id": "55510001",
+      "label": "UsersService",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "UsersService",
+        "initTime": 0
+      }
+    },
+    "91819333": {
+      "id": "91819333",
+      "label": "ModuleRef",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "203550704": {
+      "id": "203550704",
+      "label": "ExternalContextCreator",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": true,
+        "token": "ExternalContextCreator"
+      }
+    },
+    "208171089": {
+      "id": "208171089",
+      "label": "RolesGuard",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "injectable",
+        "internal": false,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "RolesGuard",
+        "subtype": "guard",
+        "initTime": 0
+      }
+    },
+    "225063248": {
+      "id": "225063248",
+      "label": "InternalCoreModule",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "InternalCoreModule",
+        "initTime": 0
+      }
+    },
+    "256260345": {
+      "id": "256260345",
+      "label": "ApplicationConfig",
+      "parent": "1528017428",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DatabaseModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "345516396": {
+      "id": "345516396",
+      "label": "ApplicationConfig",
+      "parent": "1142369607",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelperModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "345719894": {
+      "id": "345719894",
+      "label": "CoreModule",
+      "parent": "-1125887048",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "CoreModule",
+        "initTime": 0
+      }
+    },
+    "437945905": {
+      "id": "437945905",
+      "label": "ApplicationConfig",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "519735830": {
+      "id": "519735830",
+      "label": "ApplicationConfig",
+      "parent": "-493958991",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ChatModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "521671888": {
+      "id": "521671888",
+      "label": "DogsModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "555176277": {
+      "id": "555176277",
+      "label": "InternalCoreModule",
+      "metadata": {
+        "type": "module",
+        "global": true,
+        "dynamic": true,
+        "internal": true
+      }
+    },
+    "594986539": {
+      "id": "594986539",
+      "label": "InputService",
+      "parent": "-1813741655",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "InputModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": true,
+        "token": "InputService",
+        "initTime": 0
+      }
+    },
+    "603011239": {
+      "id": "603011239",
+      "label": "UsersService",
+      "parent": "-2003726489",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "UsersModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "UsersService",
+        "initTime": 0
+      }
+    },
+    "671882984": {
+      "id": "671882984",
+      "label": "Reflector",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": true,
+        "token": "Reflector",
+        "initTime": 0
+      }
+    },
+    "791004148": {
+      "id": "791004148",
+      "label": "ExternalSvcModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "867482265": {
+      "id": "867482265",
+      "label": "Interceptor",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "injectable",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "Interceptor",
+        "subtype": "interceptor",
+        "initTime": 0
+      }
+    },
+    "927096496": {
+      "id": "927096496",
+      "label": "ApplicationConfig",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "928565345": {
+      "id": "928565345",
+      "label": "HelperService",
+      "parent": "1142369607",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "HelperModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": true,
+        "token": "HelperService",
+        "initTime": 0
+      }
+    },
+    "941957564": {
+      "id": "941957564",
+      "label": "RequestChainModule",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "RequestChainModule",
+        "initTime": 0
+      }
+    },
+    "980514911": {
+      "id": "980514911",
+      "label": "Symbol(token)",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "Symbol(token)"
+      }
+    },
+    "1004276345": {
+      "id": "1004276345",
+      "label": "Meta",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "META",
+        "initTime": 0
+      }
+    },
+    "1010833816": {
+      "id": "1010833816",
+      "label": "token",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "token"
+      }
+    },
+    "1047229654": {
+      "id": "1047229654",
+      "label": "CircularModule",
+      "parent": "-369869768",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CircularModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "CircularModule",
+        "initTime": 0
+      }
+    },
+    "1074192353": {
+      "id": "1074192353",
+      "label": "ChatService",
+      "parent": "-493958991",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "ChatModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "ChatService",
+        "initTime": 0
+      }
+    },
+    "1120316353": {
+      "id": "1120316353",
+      "label": "ModuleRef",
+      "parent": "1142369607",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelperModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "1131051184": {
+      "id": "1131051184",
+      "label": "ChatGateway",
+      "parent": "-493958991",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "ChatModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "ChatGateway",
+        "initTime": 0
+      }
+    },
+    "1142369607": {
+      "id": "1142369607",
+      "label": "HelperModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "1189153544": {
+      "id": "1189153544",
+      "label": "ChatModule",
+      "parent": "-493958991",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ChatModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ChatModule",
+        "initTime": 0
+      }
+    },
+    "1253818496": {
+      "id": "1253818496",
+      "label": "RootTestModule",
+      "parent": "-1251270035",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RootTestModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "RootTestModule",
+        "initTime": 0
+      }
+    },
+    "1433815174": {
+      "id": "1433815174",
+      "label": "DogsModule",
+      "parent": "521671888",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DogsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "DogsModule",
+        "initTime": 0
+      }
+    },
+    "1434441974": {
+      "id": "1434441974",
+      "label": "CatsModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "1434456218": {
+      "id": "1434456218",
+      "label": "Reflector",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": true,
+        "token": "Reflector",
+        "initTime": 0
+      }
+    },
+    "1472486160": {
+      "id": "1472486160",
+      "label": "HelloController",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "HelloController",
+        "initTime": 0,
+        "enhancers": [
+          {
+            "id": "-2010060263",
+            "methodKey": "greeting",
+            "subtype": "guard"
+          },
+          {
+            "id": "867482265",
+            "methodKey": "greeting",
+            "subtype": "interceptor"
+          },
+          {
+            "id": "1893794611",
+            "methodKey": "greeting",
+            "subtype": "pipe"
+          }
+        ]
+      }
+    },
+    "1528017428": {
+      "id": "1528017428",
+      "label": "DatabaseModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "1535366709": {
+      "id": "1535366709",
+      "label": "ApplicationConfig",
+      "parent": "521671888",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DogsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "1551182002": {
+      "id": "1551182002",
+      "label": "ModuleRef",
+      "parent": "-1125887048",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "1616075090": {
+      "id": "1616075090",
+      "label": "CatsModule",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "CatsModule",
+        "initTime": 0
+      }
+    },
+    "1743739569": {
+      "id": "1743739569",
+      "label": "HelloModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": true,
+        "internal": false
+      }
+    },
+    "1771940178": {
+      "id": "1771940178",
+      "label": "ApplicationConfig",
+      "parent": "-1251270035",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RootTestModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "1809676814": {
+      "id": "1809676814",
+      "label": "ModuleRef",
+      "parent": "1528017428",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DatabaseModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "1893794611": {
+      "id": "1893794611",
+      "label": "UserByIdPipe",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "injectable",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "UserByIdPipe",
+        "subtype": "pipe",
+        "initTime": 0
+      }
+    },
+    "1919157847": {
+      "id": "1919157847",
+      "label": "REQUEST",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": true,
+        "token": "REQUEST",
+        "initTime": 0
+      }
+    },
+    "2018972420": {
+      "id": "2018972420",
+      "label": "TransformInterceptor",
+      "parent": "-1125887048",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "CoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "APP_INTERCEPTOR (UUID: -1146749753)",
+        "subtype": "interceptor",
+        "initTime": 0,
+        "global": true
+      }
+    },
+    "2133316171": {
+      "id": "2133316171",
+      "label": "RequestChainModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-1486320561": {
+      "id": "-1486320561",
+      "label": "ModuleRef",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-651043398": {
+      "id": "-651043398",
+      "label": "ApplicationConfig",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-255469305": {
+      "id": "-255469305",
+      "label": "INQUIRER",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 1,
+        "transient": true,
+        "exported": true,
+        "token": "INQUIRER",
+        "initTime": 0
+      }
+    },
+    "-26938366": {
+      "id": "-26938366",
+      "label": "ModulesContainer",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": true,
+        "token": "ModulesContainer"
+      }
+    },
+    "-326832201": {
+      "id": "-326832201",
+      "label": "HttpAdapterHost",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": true,
+        "token": "HttpAdapterHost"
+      }
+    },
+    "-553129559": {
+      "id": "-553129559",
+      "label": "HttpAdapterHost",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": true,
+        "token": "HttpAdapterHost",
+        "initTime": 0
+      }
+    },
+    "-702581189": {
+      "id": "-702581189",
+      "label": "LazyModuleLoader",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": true,
+        "token": "LazyModuleLoader",
+        "initTime": 0
+      }
+    },
+    "-1904419534": {
+      "id": "-1904419534",
+      "label": "SerializedGraph",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": true,
+        "token": "SerializedGraph"
+      }
+    },
+    "-1251270035": {
+      "id": "-1251270035",
+      "label": "RootTestModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-969610649": {
+      "id": "-969610649",
+      "label": "ModuleRef",
+      "parent": "-1251270035",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RootTestModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-19112576": {
+      "id": "-19112576",
+      "label": "AppModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-2139588960": {
+      "id": "-2139588960",
+      "label": "AppModule",
+      "parent": "-19112576",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "AppModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "AppModule",
+        "initTime": 0
+      }
+    },
+    "-71302842": {
+      "id": "-71302842",
+      "label": "ModuleRef",
+      "parent": "-19112576",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "AppModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-2064622725": {
+      "id": "-2064622725",
+      "label": "ApplicationConfig",
+      "parent": "-19112576",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "AppModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-365265483": {
+      "id": "-365265483",
+      "label": "AppV1Controller",
+      "parent": "-19112576",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "AppModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "AppV1Controller",
+        "initTime": 0
+      }
+    },
+    "-774089708": {
+      "id": "-774089708",
+      "label": "AppV2Controller",
+      "parent": "-19112576",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "AppModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "AppV2Controller",
+        "initTime": 0
+      }
+    },
+    "-1125887048": {
+      "id": "-1125887048",
+      "label": "CoreModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-112192227": {
+      "id": "-112192227",
+      "label": "ApplicationConfig",
+      "parent": "-1125887048",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-2007711503": {
+      "id": "-2007711503",
+      "label": "LoggingInterceptor",
+      "parent": "-1125887048",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "CoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "APP_INTERCEPTOR (UUID: 1780085433)",
+        "subtype": "interceptor",
+        "initTime": 0,
+        "global": true
+      }
+    },
+    "-183456272": {
+      "id": "-183456272",
+      "label": "ModuleRef",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-1846830501": {
+      "id": "-1846830501",
+      "label": "ApplicationConfig",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-593595711": {
+      "id": "-593595711",
+      "label": "CatsService",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "CatsService",
+        "initTime": 0
+      }
+    },
+    "-1550892030": {
+      "id": "-1550892030",
+      "label": "CatsController",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "CatsController",
+        "initTime": 0,
+        "enhancers": [
+          {
+            "id": "208171089",
+            "subtype": "guard"
+          },
+          {
+            "name": "ParseIntPipe",
+            "methodKey": "findOne",
+            "subtype": "pipe"
+          }
+        ]
+      }
+    },
+    "-1378706112": {
+      "id": "-1378706112",
+      "label": "HelloModule",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "HelloModule",
+        "initTime": 0
+      }
+    },
+    "-1166465801": {
+      "id": "-1166465801",
+      "label": "ModuleRef",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-1191459348": {
+      "id": "-1191459348",
+      "label": "ApplicationConfig",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-1758187461": {
+      "id": "-1758187461",
+      "label": "HelloService",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "HelloService",
+        "initTime": 0
+      }
+    },
+    "-2010060263": {
+      "id": "-2010060263",
+      "label": "Guard",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "injectable",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "Guard",
+        "subtype": "guard",
+        "initTime": 0
+      }
+    },
+    "-1124392646": {
+      "id": "-1124392646",
+      "label": "DurableModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-522935456": {
+      "id": "-522935456",
+      "label": "DurableModule",
+      "parent": "-1124392646",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DurableModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "DurableModule",
+        "initTime": 0
+      }
+    },
+    "-1808043520": {
+      "id": "-1808043520",
+      "label": "ModuleRef",
+      "parent": "-1124392646",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DurableModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-57038411": {
+      "id": "-57038411",
+      "label": "ApplicationConfig",
+      "parent": "-1124392646",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DurableModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-1673986099": {
+      "id": "-1673986099",
+      "label": "DurableService",
+      "parent": "-1124392646",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "DurableModule",
+        "durable": true,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "DurableService",
+        "initTime": 0
+      }
+    },
+    "-848516688": {
+      "id": "-848516688",
+      "label": "DurableController",
+      "parent": "-1124392646",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "DurableModule",
+        "durable": true,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "DurableController",
+        "initTime": 0
+      }
+    },
+    "-1096226358": {
+      "id": "-1096226358",
+      "label": "ModuleRef",
+      "parent": "521671888",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DogsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-335387007": {
+      "id": "-335387007",
+      "label": "DogsService",
+      "parent": "521671888",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "DogsModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "DogsService",
+        "initTime": 0
+      }
+    },
+    "-1558907338": {
+      "id": "-1558907338",
+      "label": "DogsController",
+      "parent": "521671888",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "DogsModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "DogsController",
+        "initTime": 0
+      }
+    },
+    "-2003726489": {
+      "id": "-2003726489",
+      "label": "UsersModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-495603840": {
+      "id": "-495603840",
+      "label": "UsersModule",
+      "parent": "-2003726489",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "UsersModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "UsersModule",
+        "initTime": 0
+      }
+    },
+    "-618964563": {
+      "id": "-618964563",
+      "label": "ModuleRef",
+      "parent": "-2003726489",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "UsersModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-643958110": {
+      "id": "-643958110",
+      "label": "ApplicationConfig",
+      "parent": "-2003726489",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "UsersModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-1102473136": {
+      "id": "-1102473136",
+      "label": "UsersController",
+      "parent": "-2003726489",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "UsersModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "UsersController",
+        "initTime": 0
+      }
+    },
+    "-1098322034": {
+      "id": "-1098322034",
+      "label": "DatabaseModule",
+      "parent": "1528017428",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DatabaseModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "DatabaseModule",
+        "initTime": 0
+      }
+    },
+    "-616397055": {
+      "id": "-616397055",
+      "label": "DatabaseService",
+      "parent": "1528017428",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "DatabaseModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "DatabaseService",
+        "initTime": 0
+      }
+    },
+    "-377928898": {
+      "id": "-377928898",
+      "label": "DatabaseController",
+      "parent": "1528017428",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "DatabaseModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "DatabaseController",
+        "initTime": 0
+      }
+    },
+    "-511735264": {
+      "id": "-511735264",
+      "label": "ExternalSvcModule",
+      "parent": "791004148",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ExternalSvcModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ExternalSvcModule",
+        "initTime": 0
+      }
+    },
+    "-660323910": {
+      "id": "-660323910",
+      "label": "ModuleRef",
+      "parent": "791004148",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ExternalSvcModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-217737489": {
+      "id": "-217737489",
+      "label": "ApplicationConfig",
+      "parent": "791004148",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ExternalSvcModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-1902429503": {
+      "id": "-1902429503",
+      "label": "ExternalSvcService",
+      "parent": "791004148",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "ExternalSvcModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "ExternalSvcService",
+        "initTime": 0
+      }
+    },
+    "-349899408": {
+      "id": "-349899408",
+      "label": "ExternalSvcController",
+      "parent": "791004148",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "ExternalSvcModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "ExternalSvcController",
+        "initTime": 0
+      }
+    },
+    "-493958991": {
+      "id": "-493958991",
+      "label": "ChatModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-2111857237": {
+      "id": "-2111857237",
+      "label": "ModuleRef",
+      "parent": "-493958991",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ChatModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-234035039": {
+      "id": "-234035039",
+      "label": "RequestChainService",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "RequestChainService",
+        "initTime": 0
+      }
+    },
+    "-1927427604": {
+      "id": "-1927427604",
+      "label": "RequestChainController",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "RequestChainController",
+        "initTime": 0,
+        "enhancers": [
+          {
+            "id": "18347652",
+            "methodKey": "greeting",
+            "subtype": "interceptor"
+          }
+        ]
+      }
+    },
+    "-162987852": {
+      "id": "-162987852",
+      "label": "HelperModule",
+      "parent": "1142369607",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelperModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "HelperModule",
+        "initTime": 0
+      }
+    },
+    "-1469176692": {
+      "id": "-1469176692",
+      "label": "PropertiesModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-1501313730": {
+      "id": "-1501313730",
+      "label": "PropertiesModule",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "PropertiesModule",
+        "initTime": 0
+      }
+    },
+    "-1377446394": {
+      "id": "-1377446394",
+      "label": "ModuleRef",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-1494077847": {
+      "id": "-1494077847",
+      "label": "DependencyService",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "DependencyService",
+        "initTime": 0
+      }
+    },
+    "-1803759743": {
+      "id": "-1803759743",
+      "label": "PropertiesService",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "PropertiesService",
+        "initTime": 0
+      }
+    },
+    "-1813741655": {
+      "id": "-1813741655",
+      "label": "InputModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-2113121728": {
+      "id": "-2113121728",
+      "label": "InputModule",
+      "parent": "-1813741655",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InputModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "InputModule",
+        "initTime": 0
+      }
+    },
+    "-428979729": {
+      "id": "-428979729",
+      "label": "ModuleRef",
+      "parent": "-1813741655",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InputModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-453973276": {
+      "id": "-453973276",
+      "label": "ApplicationConfig",
+      "parent": "-1813741655",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InputModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-369869768": {
+      "id": "-369869768",
+      "label": "CircularModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-88210382": {
+      "id": "-88210382",
+      "label": "ModuleRef",
+      "parent": "-369869768",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CircularModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-1641626851": {
+      "id": "-1641626851",
+      "label": "ApplicationConfig",
+      "parent": "-369869768",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CircularModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-1721730431": {
+      "id": "-1721730431",
+      "label": "CircularService",
+      "parent": "-369869768",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "CircularModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": true,
+        "token": "CircularService",
+        "initTime": 0
+      }
+    }
+  },
+  "edges": {
+    "22193019": {
+      "source": "-19112576",
+      "target": "521671888",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "DogsModule"
+      },
+      "id": "22193019"
+    },
+    "33333764": {
+      "source": "791004148",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "ExternalSvcModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "33333764"
+    },
+    "40501732": {
+      "source": "521671888",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "DogsModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "40501732"
+    },
+    "73947303": {
+      "source": "-1813741655",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "InputModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "73947303"
+    },
+    "182501115": {
+      "source": "1434441974",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "CatsModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "182501115"
+    },
+    "189694679": {
+      "source": "1434456218",
+      "target": "671882984",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "InternalCoreModule",
+        "sourceClassName": "Reflector",
+        "targetClassName": "Reflector",
+        "sourceClassToken": "Reflector",
+        "targetClassToken": "Reflector",
+        "targetModuleName": "InternalCoreModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor",
+        "internal": true
+      },
+      "id": "189694679"
+    },
+    "231469845": {
+      "source": "-1803759743",
+      "target": "-1494077847",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "PropertiesModule",
+        "sourceClassName": "PropertiesService",
+        "targetClassName": "DependencyService",
+        "sourceClassToken": "PropertiesService",
+        "targetClassToken": "DependencyService",
+        "targetModuleName": "PropertiesModule",
+        "keyOrIndex": "service",
+        "injectionType": "property"
+      },
+      "id": "231469845"
+    },
+    "250652665": {
+      "source": "2133316171",
+      "target": "1142369607",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "RequestChainModule",
+        "targetModuleName": "HelperModule"
+      },
+      "id": "250652665"
+    },
+    "393939926": {
+      "source": "-1813741655",
+      "target": "-369869768",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "InputModule",
+        "targetModuleName": "CircularModule"
+      },
+      "id": "393939926"
+    },
+    "417363164": {
+      "source": "-1251270035",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "RootTestModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "417363164"
+    },
+    "469401997": {
+      "source": "-493958991",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "ChatModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "469401997"
+    },
+    "654001290": {
+      "source": "1472486160",
+      "target": "867482265",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloController",
+        "targetClassName": "Interceptor",
+        "sourceClassToken": "HelloController",
+        "targetClassToken": "Interceptor",
+        "targetModuleName": "HelloModule",
+        "injectionType": "decorator"
+      },
+      "id": "654001290"
+    },
+    "676175891": {
+      "source": "-1251270035",
+      "target": "-19112576",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "RootTestModule",
+        "targetModuleName": "AppModule"
+      },
+      "id": "676175891"
+    },
+    "800268760": {
+      "source": "-1102473136",
+      "target": "603011239",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "UsersModule",
+        "sourceClassName": "UsersController",
+        "targetClassName": "UsersService",
+        "sourceClassToken": "UsersController",
+        "targetClassToken": "UsersService",
+        "targetModuleName": "UsersModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "800268760"
+    },
+    "804987620": {
+      "source": "-19112576",
+      "target": "-1125887048",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "CoreModule"
+      },
+      "id": "804987620"
+    },
+    "807697929": {
+      "source": "-19112576",
+      "target": "1528017428",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "DatabaseModule"
+      },
+      "id": "807697929"
+    },
+    "966350248": {
+      "source": "1131051184",
+      "target": "1074192353",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "ChatModule",
+        "sourceClassName": "ChatGateway",
+        "targetClassName": "ChatService",
+        "sourceClassToken": "ChatGateway",
+        "targetClassToken": "ChatService",
+        "targetModuleName": "ChatModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "966350248"
+    },
+    "987755577": {
+      "source": "-2003726489",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "UsersModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "987755577"
+    },
+    "1056428433": {
+      "source": "-19112576",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "1056428433"
+    },
+    "1059069749": {
+      "source": "-1558907338",
+      "target": "-335387007",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "DogsModule",
+        "sourceClassName": "DogsController",
+        "targetClassName": "DogsService",
+        "sourceClassToken": "DogsController",
+        "targetClassToken": "DogsService",
+        "targetModuleName": "DogsModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1059069749"
+    },
+    "1142343545": {
+      "source": "-1758187461",
+      "target": "1004276345",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloService",
+        "targetClassName": "Meta",
+        "sourceClassToken": "HelloService",
+        "targetClassToken": "META",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1142343545"
+    },
+    "1178436405": {
+      "source": "1893794611",
+      "target": "55510001",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "UserByIdPipe",
+        "targetClassName": "UsersService",
+        "sourceClassToken": "UserByIdPipe",
+        "targetClassToken": "UsersService",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1178436405"
+    },
+    "1195474320": {
+      "source": "-369869768",
+      "target": "-1813741655",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "CircularModule",
+        "targetModuleName": "InputModule"
+      },
+      "id": "1195474320"
+    },
+    "1247743823": {
+      "source": "2133316171",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "RequestChainModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "1247743823"
+    },
+    "1325313063": {
+      "source": "-1927427604",
+      "target": "18347652",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "RequestChainModule",
+        "sourceClassName": "RequestChainController",
+        "targetClassName": "LoggingInterceptor",
+        "sourceClassToken": "RequestChainController",
+        "targetClassToken": "LoggingInterceptor",
+        "targetModuleName": "RequestChainModule",
+        "injectionType": "decorator"
+      },
+      "id": "1325313063"
+    },
+    "1497653915": {
+      "source": "55510001",
+      "target": "1004276345",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "UsersService",
+        "targetClassName": "Meta",
+        "sourceClassToken": "UsersService",
+        "targetClassToken": "META",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1497653915"
+    },
+    "1615322974": {
+      "source": "-1469176692",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "PropertiesModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "1615322974"
+    },
+    "1856016815": {
+      "source": "-1721730431",
+      "target": "594986539",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "CircularModule",
+        "sourceClassName": "CircularService",
+        "targetClassName": "InputService",
+        "sourceClassToken": "CircularService",
+        "targetClassToken": "InputService",
+        "targetModuleName": "InputModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1856016815"
+    },
+    "1900414743": {
+      "source": "1472486160",
+      "target": "1893794611",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloController",
+        "targetClassName": "UserByIdPipe",
+        "sourceClassToken": "HelloController",
+        "targetClassToken": "UserByIdPipe",
+        "targetModuleName": "HelloModule",
+        "injectionType": "decorator"
+      },
+      "id": "1900414743"
+    },
+    "1904579661": {
+      "source": "18347652",
+      "target": "928565345",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "RequestChainModule",
+        "sourceClassName": "LoggingInterceptor",
+        "targetClassName": "HelperService",
+        "sourceClassToken": "LoggingInterceptor",
+        "targetClassToken": "HelperService",
+        "targetModuleName": "HelperModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1904579661"
+    },
+    "1960203007": {
+      "source": "-1803759743",
+      "target": "980514911",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "PropertiesModule",
+        "sourceClassName": "PropertiesService",
+        "targetClassName": "Symbol(token)",
+        "sourceClassToken": "PropertiesService",
+        "targetClassToken": "Symbol(token)",
+        "targetModuleName": "PropertiesModule",
+        "keyOrIndex": "symbolToken",
+        "injectionType": "property"
+      },
+      "id": "1960203007"
+    },
+    "1976848738": {
+      "source": "1528017428",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "DatabaseModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "1976848738"
+    },
+    "-1759625292": {
+      "source": "-553129559",
+      "target": "-326832201",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "InternalCoreModule",
+        "sourceClassName": "HttpAdapterHost",
+        "targetClassName": "HttpAdapterHost",
+        "sourceClassToken": "HttpAdapterHost",
+        "targetClassToken": "HttpAdapterHost",
+        "targetModuleName": "InternalCoreModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor",
+        "internal": true
+      },
+      "id": "-1759625292"
+    },
+    "-2105726668": {
+      "source": "-1803759743",
+      "target": "1010833816",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "PropertiesModule",
+        "sourceClassName": "PropertiesService",
+        "targetClassName": "token",
+        "sourceClassToken": "PropertiesService",
+        "targetClassToken": "token",
+        "targetModuleName": "PropertiesModule",
+        "keyOrIndex": "token",
+        "injectionType": "property"
+      },
+      "id": "-2105726668"
+    },
+    "-21463590": {
+      "source": "-1378706112",
+      "target": "1004276345",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloModule",
+        "targetClassName": "Meta",
+        "sourceClassToken": "HelloModule",
+        "targetClassToken": "META",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-21463590"
+    },
+    "-1657371464": {
+      "source": "-1673986099",
+      "target": "1919157847",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "DurableModule",
+        "sourceClassName": "DurableService",
+        "targetClassName": "REQUEST",
+        "sourceClassToken": "DurableService",
+        "targetClassToken": "REQUEST",
+        "targetModuleName": "InternalCoreModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor",
+        "internal": true
+      },
+      "id": "-1657371464"
+    },
+    "-1303681274": {
+      "source": "928565345",
+      "target": "1919157847",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelperModule",
+        "sourceClassName": "HelperService",
+        "targetClassName": "REQUEST",
+        "sourceClassToken": "HelperService",
+        "targetClassToken": "REQUEST",
+        "targetModuleName": "InternalCoreModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor",
+        "internal": true
+      },
+      "id": "-1303681274"
+    },
+    "-886102564": {
+      "source": "208171089",
+      "target": "671882984",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "CatsModule",
+        "sourceClassName": "RolesGuard",
+        "targetClassName": "Reflector",
+        "sourceClassToken": "RolesGuard",
+        "targetClassToken": "Reflector",
+        "targetModuleName": "InternalCoreModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor",
+        "internal": true
+      },
+      "id": "-886102564"
+    },
+    "-2003045613": {
+      "source": "-377928898",
+      "target": "-616397055",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "DatabaseModule",
+        "sourceClassName": "DatabaseController",
+        "targetClassName": "DatabaseService",
+        "sourceClassToken": "DatabaseController",
+        "targetClassToken": "DatabaseService",
+        "targetModuleName": "DatabaseModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-2003045613"
+    },
+    "-881420795": {
+      "source": "-349899408",
+      "target": "-1902429503",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "ExternalSvcModule",
+        "sourceClassName": "ExternalSvcController",
+        "targetClassName": "ExternalSvcService",
+        "sourceClassToken": "ExternalSvcController",
+        "targetClassToken": "ExternalSvcService",
+        "targetModuleName": "ExternalSvcModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-881420795"
+    },
+    "-831049991": {
+      "source": "594986539",
+      "target": "-1721730431",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "InputModule",
+        "sourceClassName": "InputService",
+        "targetClassName": "CircularService",
+        "sourceClassToken": "InputService",
+        "targetClassToken": "CircularService",
+        "targetModuleName": "CircularModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-831049991"
+    },
+    "-2146943494": {
+      "source": "-234035039",
+      "target": "928565345",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "RequestChainModule",
+        "sourceClassName": "RequestChainService",
+        "targetClassName": "HelperService",
+        "sourceClassToken": "RequestChainService",
+        "targetClassToken": "HelperService",
+        "targetModuleName": "HelperModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-2146943494"
+    },
+    "-1816180282": {
+      "source": "-848516688",
+      "target": "-1673986099",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "DurableModule",
+        "sourceClassName": "DurableController",
+        "targetClassName": "DurableService",
+        "sourceClassToken": "DurableController",
+        "targetClassToken": "DurableService",
+        "targetModuleName": "DurableModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-1816180282"
+    },
+    "-180350082": {
+      "source": "-1550892030",
+      "target": "-593595711",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "CatsModule",
+        "sourceClassName": "CatsController",
+        "targetClassName": "CatsService",
+        "sourceClassToken": "CatsController",
+        "targetClassToken": "CatsService",
+        "targetModuleName": "CatsModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-180350082"
+    },
+    "-1043628608": {
+      "source": "1472486160",
+      "target": "-1758187461",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloController",
+        "targetClassName": "HelloService",
+        "sourceClassToken": "HelloController",
+        "targetClassToken": "HelloService",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-1043628608"
+    },
+    "-1335121169": {
+      "source": "1472486160",
+      "target": "55510001",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloController",
+        "targetClassName": "UsersService",
+        "sourceClassToken": "HelloController",
+        "targetClassToken": "UsersService",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 1,
+        "injectionType": "constructor"
+      },
+      "id": "-1335121169"
+    },
+    "-296280311": {
+      "source": "-1927427604",
+      "target": "-234035039",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "RequestChainModule",
+        "sourceClassName": "RequestChainController",
+        "targetClassName": "RequestChainService",
+        "sourceClassToken": "RequestChainController",
+        "targetClassToken": "RequestChainService",
+        "targetModuleName": "RequestChainModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-296280311"
+    },
+    "-393224862": {
+      "source": "-19112576",
+      "target": "1434441974",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "CatsModule"
+      },
+      "id": "-393224862"
+    },
+    "-1675983900": {
+      "source": "-19112576",
+      "target": "1743739569",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "HelloModule"
+      },
+      "id": "-1675983900"
+    },
+    "-678699872": {
+      "source": "-19112576",
+      "target": "-1124392646",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "DurableModule"
+      },
+      "id": "-678699872"
+    },
+    "-158970266": {
+      "source": "-19112576",
+      "target": "-2003726489",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "UsersModule"
+      },
+      "id": "-158970266"
+    },
+    "-2086236431": {
+      "source": "-19112576",
+      "target": "791004148",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "ExternalSvcModule"
+      },
+      "id": "-2086236431"
+    },
+    "-192150092": {
+      "source": "-19112576",
+      "target": "-493958991",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "ChatModule"
+      },
+      "id": "-192150092"
+    },
+    "-1609022090": {
+      "source": "-19112576",
+      "target": "2133316171",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "RequestChainModule"
+      },
+      "id": "-1609022090"
+    },
+    "-773455435": {
+      "source": "-19112576",
+      "target": "-1469176692",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "PropertiesModule"
+      },
+      "id": "-773455435"
+    },
+    "-967144236": {
+      "source": "-19112576",
+      "target": "-1813741655",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "InputModule"
+      },
+      "id": "-967144236"
+    },
+    "-528424051": {
+      "source": "-1125887048",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "CoreModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "-528424051"
+    },
+    "-698929209": {
+      "source": "1743739569",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "HelloModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "-698929209"
+    },
+    "-1671708813": {
+      "source": "-1124392646",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "DurableModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "-1671708813"
+    },
+    "-665042842": {
+      "source": "1142369607",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "HelperModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "-665042842"
+    },
+    "-1891610441": {
+      "source": "-369869768",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "CircularModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "-1891610441"
+    },
+    "-878379437": {
+      "source": "-1550892030",
+      "target": "208171089",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "CatsModule",
+        "sourceClassName": "CatsController",
+        "targetClassName": "RolesGuard",
+        "sourceClassToken": "CatsController",
+        "targetClassToken": "RolesGuard",
+        "targetModuleName": "CatsModule",
+        "injectionType": "decorator"
+      },
+      "id": "-878379437"
+    },
+    "-822816169": {
+      "source": "1472486160",
+      "target": "-2010060263",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloController",
+        "targetClassName": "Guard",
+        "sourceClassToken": "HelloController",
+        "targetClassToken": "Guard",
+        "targetModuleName": "HelloModule",
+        "injectionType": "decorator"
+      },
+      "id": "-822816169"
+    }
+  },
+  "entrypoints": {},
+  "extras": {
+    "orphanedEnhancers": [],
+    "attachedEnhancers": [
+      {
+        "nodeId": "2018972420"
+      },
+      {
+        "nodeId": "-2007711503"
+      }
+    ]
+  },
+  "status": "complete"
+}
\ No newline at end of file
diff --git a/integration/inspector/e2e/graph-inspector.spec.ts b/integration/inspector/e2e/graph-inspector.spec.ts
new file mode 100644
index 000000000..1cc2283ae
--- /dev/null
+++ b/integration/inspector/e2e/graph-inspector.spec.ts
@@ -0,0 +1,69 @@
+import { ValidationPipe } from '@nestjs/common';
+import { Injector } from '@nestjs/core/injector/injector';
+import { SerializedGraph } from '@nestjs/core/inspector/serialized-graph';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
+import { Test, TestingModule } from '@nestjs/testing';
+import { expect } from 'chai';
+import { readFileSync, writeFileSync } from 'fs';
+import { join } from 'path';
+import * as sinon from 'sinon';
+import { AppModule } from '../src/app.module';
+import { HttpExceptionFilter } from '../src/common/filters/http-exception.filter';
+import { TimeoutInterceptor } from '../src/common/interceptors/timeout.interceptor';
+
+describe('Graph inspector', () => {
+  let testingModule: TestingModule;
+
+  before(async () => {
+    sinon.stub(Injector.prototype as any, 'getNowTimestamp').callsFake(() => 0);
+
+    testingModule = await Test.createTestingModule({
+      imports: [AppModule],
+    }).compile({ snapshot: true });
+  });
+
+  it('should generate a pre-initialization graph and match snapshot', () => {
+    const graph = testingModule.get(SerializedGraph);
+
+    // Update snapshot:
+    writeFileSync(
+      join(__dirname, 'fixtures', 'pre-init-graph.json'),
+      graph.toString(),
+    );
+
+    const snapshot = readFileSync(
+      join(__dirname, 'fixtures', 'pre-init-graph.json'),
+      'utf-8',
+    );
+
+    expect(JSON.parse(graph.toString())).to.deep.equal(JSON.parse(snapshot));
+  });
+
+  it('should generate a post-initialization graph and match snapshot', async () => {
+    const app = testingModule.createNestApplication({ preview: true });
+    app.useGlobalPipes(new ValidationPipe());
+    app.useGlobalFilters(new HttpExceptionFilter());
+    app.useGlobalInterceptors(new TimeoutInterceptor());
+    app.enableVersioning();
+    app.connectMicroservice<MicroserviceOptions>({
+      transport: Transport.TCP,
+      options: {},
+    });
+    await app.init();
+
+    const graph = testingModule.get(SerializedGraph);
+
+    // Update snapshot:
+    writeFileSync(
+      join(__dirname, 'fixtures', 'post-init-graph.json'),
+      graph.toString(),
+    );
+
+    const snapshot = readFileSync(
+      join(__dirname, 'fixtures', 'post-init-graph.json'),
+      'utf-8',
+    );
+
+    expect(graph.toString()).to.equal(snapshot);
+  });
+});
diff --git a/integration/inspector/src/app-v1.controller.ts b/integration/inspector/src/app-v1.controller.ts
new file mode 100644
index 000000000..90d1dacba
--- /dev/null
+++ b/integration/inspector/src/app-v1.controller.ts
@@ -0,0 +1,16 @@
+import { Controller, Get } from '@nestjs/common';
+
+@Controller({
+  version: '1',
+})
+export class AppV1Controller {
+  @Get('/')
+  helloWorldV1() {
+    return 'Hello World V1!';
+  }
+
+  @Get('/:param/hello')
+  paramV1() {
+    return 'Parameter V1!';
+  }
+}
diff --git a/integration/inspector/src/app-v2.controller.ts b/integration/inspector/src/app-v2.controller.ts
new file mode 100644
index 000000000..5be777871
--- /dev/null
+++ b/integration/inspector/src/app-v2.controller.ts
@@ -0,0 +1,17 @@
+import { Controller, Get, Version } from '@nestjs/common';
+
+@Controller({
+  version: '2',
+})
+export class AppV2Controller {
+  @Get('/')
+  helloWorldV2() {
+    return 'Hello World V2!';
+  }
+
+  @Version('3')
+  @Get('/:param/hello')
+  paramV1() {
+    return 'Parameter V2!';
+  }
+}
diff --git a/integration/inspector/src/app.module.ts b/integration/inspector/src/app.module.ts
new file mode 100644
index 000000000..1d395b9bf
--- /dev/null
+++ b/integration/inspector/src/app.module.ts
@@ -0,0 +1,46 @@
+import { Module, Scope } from '@nestjs/common';
+import { AppV1Controller } from './app-v1.controller';
+import { AppV2Controller } from './app-v2.controller';
+import { CatsModule } from './cats/cats.module';
+import { ChatModule } from './chat/chat.module';
+import { HelloModule as CircularHelloModule } from './circular-hello/hello.module';
+import { HelloService } from './circular-hello/hello.service';
+import { InputModule } from './circular-modules/input.module';
+import { CoreModule } from './core/core.module';
+import { DatabaseModule } from './database/database.module';
+import { DogsModule } from './dogs/dogs.module';
+import { DurableModule } from './durable/durable.module';
+import { ExternalSvcModule } from './external-svc/external-svc.module';
+import { PropertiesModule } from './properties/properties.module';
+import { RequestChainModule } from './request-chain/request-chain.module';
+import { UsersModule } from './users/users.module';
+
+class Meta {
+  static COUNTER = 0;
+  constructor(private readonly helloService: HelloService) {
+    Meta.COUNTER++;
+  }
+}
+
+@Module({
+  imports: [
+    CoreModule,
+    CatsModule,
+    CircularHelloModule.forRoot({
+      provide: 'META',
+      useClass: Meta,
+      scope: Scope.REQUEST,
+    }),
+    DurableModule,
+    DogsModule,
+    UsersModule,
+    DatabaseModule,
+    ExternalSvcModule,
+    ChatModule,
+    RequestChainModule,
+    PropertiesModule,
+    InputModule,
+  ],
+  controllers: [AppV1Controller, AppV2Controller],
+})
+export class AppModule {}
diff --git a/integration/inspector/src/cats/cats.controller.ts b/integration/inspector/src/cats/cats.controller.ts
new file mode 100644
index 000000000..b9f929a21
--- /dev/null
+++ b/integration/inspector/src/cats/cats.controller.ts
@@ -0,0 +1,30 @@
+import { Body, Controller, Get, Param, Post, UseGuards } from '@nestjs/common';
+import { RolesGuard } from '../common/guards/roles.guard';
+import { ParseIntPipe } from '../common/pipes/parse-int.pipe';
+import { CatsService } from './cats.service';
+import { CreateCatDto } from './dto/create-cat.dto';
+import { Cat } from './interfaces/cat.interface';
+
+@UseGuards(RolesGuard)
+@Controller('cats')
+export class CatsController {
+  constructor(private readonly catsService: CatsService) {}
+
+  @Post()
+  async create(@Body() createCatDto: CreateCatDto) {
+    this.catsService.create(createCatDto);
+  }
+
+  @Get()
+  async findAll(): Promise<Cat[]> {
+    return this.catsService.findAll();
+  }
+
+  @Get(':id')
+  findOne(
+    @Param('id', new ParseIntPipe())
+    id: number,
+  ) {
+    // get by ID logic
+  }
+}
diff --git a/integration/inspector/src/cats/cats.module.ts b/integration/inspector/src/cats/cats.module.ts
new file mode 100644
index 000000000..f3291c7d1
--- /dev/null
+++ b/integration/inspector/src/cats/cats.module.ts
@@ -0,0 +1,9 @@
+import { Module } from '@nestjs/common';
+import { CatsController } from './cats.controller';
+import { CatsService } from './cats.service';
+
+@Module({
+  controllers: [CatsController],
+  providers: [CatsService],
+})
+export class CatsModule {}
diff --git a/integration/inspector/src/cats/cats.service.ts b/integration/inspector/src/cats/cats.service.ts
new file mode 100644
index 000000000..2619cd717
--- /dev/null
+++ b/integration/inspector/src/cats/cats.service.ts
@@ -0,0 +1,15 @@
+import { Injectable } from '@nestjs/common';
+import { Cat } from './interfaces/cat.interface';
+
+@Injectable()
+export class CatsService {
+  private readonly cats: Cat[] = [];
+
+  create(cat: Cat) {
+    this.cats.push(cat);
+  }
+
+  findAll(): Cat[] {
+    return this.cats;
+  }
+}
diff --git a/integration/inspector/src/cats/dto/create-cat.dto.ts b/integration/inspector/src/cats/dto/create-cat.dto.ts
new file mode 100644
index 000000000..acd7d288b
--- /dev/null
+++ b/integration/inspector/src/cats/dto/create-cat.dto.ts
@@ -0,0 +1,12 @@
+import { IsInt, IsString } from 'class-validator';
+
+export class CreateCatDto {
+  @IsString()
+  readonly name: string;
+
+  @IsInt()
+  readonly age: number;
+
+  @IsString()
+  readonly breed: string;
+}
diff --git a/integration/inspector/src/cats/interfaces/cat.interface.ts b/integration/inspector/src/cats/interfaces/cat.interface.ts
new file mode 100644
index 000000000..961c97391
--- /dev/null
+++ b/integration/inspector/src/cats/interfaces/cat.interface.ts
@@ -0,0 +1,5 @@
+export interface Cat {
+  name: string;
+  age: number;
+  breed: string;
+}
diff --git a/integration/inspector/src/chat/chat.gateway.ts b/integration/inspector/src/chat/chat.gateway.ts
new file mode 100644
index 000000000..75e6c7c28
--- /dev/null
+++ b/integration/inspector/src/chat/chat.gateway.ts
@@ -0,0 +1,38 @@
+import {
+  WebSocketGateway,
+  SubscribeMessage,
+  MessageBody,
+} from '@nestjs/websockets';
+import { ChatService } from './chat.service';
+import { CreateChatDto } from './dto/create-chat.dto';
+import { UpdateChatDto } from './dto/update-chat.dto';
+
+@WebSocketGateway()
+export class ChatGateway {
+  constructor(private readonly chatService: ChatService) {}
+
+  @SubscribeMessage('createChat')
+  create(@MessageBody() createChatDto: CreateChatDto) {
+    return this.chatService.create(createChatDto);
+  }
+
+  @SubscribeMessage('findAllChat')
+  findAll() {
+    return this.chatService.findAll();
+  }
+
+  @SubscribeMessage('findOneChat')
+  findOne(@MessageBody() id: number) {
+    return this.chatService.findOne(id);
+  }
+
+  @SubscribeMessage('updateChat')
+  update(@MessageBody() updateChatDto: UpdateChatDto) {
+    return this.chatService.update(updateChatDto.id, updateChatDto);
+  }
+
+  @SubscribeMessage('removeChat')
+  remove(@MessageBody() id: number) {
+    return this.chatService.remove(id);
+  }
+}
diff --git a/integration/inspector/src/chat/chat.module.ts b/integration/inspector/src/chat/chat.module.ts
new file mode 100644
index 000000000..d3ad301f5
--- /dev/null
+++ b/integration/inspector/src/chat/chat.module.ts
@@ -0,0 +1,8 @@
+import { Module } from '@nestjs/common';
+import { ChatService } from './chat.service';
+import { ChatGateway } from './chat.gateway';
+
+@Module({
+  providers: [ChatGateway, ChatService],
+})
+export class ChatModule {}
diff --git a/integration/inspector/src/chat/chat.service.ts b/integration/inspector/src/chat/chat.service.ts
new file mode 100644
index 000000000..1fa0676de
--- /dev/null
+++ b/integration/inspector/src/chat/chat.service.ts
@@ -0,0 +1,26 @@
+import { Injectable } from '@nestjs/common';
+import { CreateChatDto } from './dto/create-chat.dto';
+import { UpdateChatDto } from './dto/update-chat.dto';
+
+@Injectable()
+export class ChatService {
+  create(createChatDto: CreateChatDto) {
+    return 'This action adds a new chat';
+  }
+
+  findAll() {
+    return `This action returns all chat`;
+  }
+
+  findOne(id: number) {
+    return `This action returns a #${id} chat`;
+  }
+
+  update(id: number, updateChatDto: UpdateChatDto) {
+    return `This action updates a #${id} chat`;
+  }
+
+  remove(id: number) {
+    return `This action removes a #${id} chat`;
+  }
+}
diff --git a/integration/inspector/src/chat/dto/create-chat.dto.ts b/integration/inspector/src/chat/dto/create-chat.dto.ts
new file mode 100644
index 000000000..d9fd9013a
--- /dev/null
+++ b/integration/inspector/src/chat/dto/create-chat.dto.ts
@@ -0,0 +1 @@
+export class CreateChatDto {}
diff --git a/integration/inspector/src/chat/dto/update-chat.dto.ts b/integration/inspector/src/chat/dto/update-chat.dto.ts
new file mode 100644
index 000000000..0a372f666
--- /dev/null
+++ b/integration/inspector/src/chat/dto/update-chat.dto.ts
@@ -0,0 +1,6 @@
+import { PartialType } from '@nestjs/mapped-types';
+import { CreateChatDto } from './create-chat.dto';
+
+export class UpdateChatDto extends PartialType(CreateChatDto) {
+  id: number;
+}
diff --git a/integration/inspector/src/chat/entities/chat.entity.ts b/integration/inspector/src/chat/entities/chat.entity.ts
new file mode 100644
index 000000000..7e881f92f
--- /dev/null
+++ b/integration/inspector/src/chat/entities/chat.entity.ts
@@ -0,0 +1 @@
+export class Chat {}
diff --git a/integration/inspector/src/circular-hello/dto/test.dto.ts b/integration/inspector/src/circular-hello/dto/test.dto.ts
new file mode 100644
index 000000000..b3a30f671
--- /dev/null
+++ b/integration/inspector/src/circular-hello/dto/test.dto.ts
@@ -0,0 +1,10 @@
+import { IsString, IsNotEmpty, IsNumber } from 'class-validator';
+
+export class TestDto {
+  @IsString()
+  @IsNotEmpty()
+  string: string;
+
+  @IsNumber()
+  number: number;
+}
diff --git a/integration/inspector/src/circular-hello/guards/request-scoped.guard.ts b/integration/inspector/src/circular-hello/guards/request-scoped.guard.ts
new file mode 100644
index 000000000..7e5fe1788
--- /dev/null
+++ b/integration/inspector/src/circular-hello/guards/request-scoped.guard.ts
@@ -0,0 +1,21 @@
+import {
+  CanActivate,
+  ExecutionContext,
+  Injectable,
+  Scope,
+} from '@nestjs/common';
+import { Observable } from 'rxjs';
+
+@Injectable({ scope: Scope.REQUEST })
+export class Guard implements CanActivate {
+  static COUNTER = 0;
+  constructor() {
+    Guard.COUNTER++;
+  }
+
+  canActivate(
+    context: ExecutionContext,
+  ): boolean | Promise<boolean> | Observable<boolean> {
+    return true;
+  }
+}
diff --git a/integration/inspector/src/circular-hello/hello.controller.ts b/integration/inspector/src/circular-hello/hello.controller.ts
new file mode 100644
index 000000000..5b4af7bf2
--- /dev/null
+++ b/integration/inspector/src/circular-hello/hello.controller.ts
@@ -0,0 +1,30 @@
+import {
+  Controller,
+  Get,
+  Param,
+  UseGuards,
+  UseInterceptors,
+} from '@nestjs/common';
+import { Guard } from './guards/request-scoped.guard';
+import { HelloService } from './hello.service';
+import { Interceptor } from './interceptors/logging.interceptor';
+import { UserByIdPipe } from './users/user-by-id.pipe';
+import { UsersService } from './users/users.service';
+
+@Controller('hello')
+export class HelloController {
+  static COUNTER = 0;
+  constructor(
+    private readonly helloService: HelloService,
+    private readonly usersService: UsersService,
+  ) {
+    HelloController.COUNTER++;
+  }
+
+  @UseGuards(Guard)
+  @UseInterceptors(Interceptor)
+  @Get()
+  greeting(@Param('id', UserByIdPipe) id): string {
+    return this.helloService.greeting();
+  }
+}
diff --git a/integration/inspector/src/circular-hello/hello.module.ts b/integration/inspector/src/circular-hello/hello.module.ts
new file mode 100644
index 000000000..1a0d0bbfd
--- /dev/null
+++ b/integration/inspector/src/circular-hello/hello.module.ts
@@ -0,0 +1,19 @@
+import { DynamicModule, Inject, Module, Provider } from '@nestjs/common';
+import { HelloController } from './hello.controller';
+import { HelloService } from './hello.service';
+import { UsersService } from './users/users.service';
+
+@Module({
+  controllers: [HelloController],
+  providers: [HelloService, UsersService],
+})
+export class HelloModule {
+  constructor(@Inject('META') private readonly meta) {}
+
+  static forRoot(meta: Provider): DynamicModule {
+    return {
+      module: HelloModule,
+      providers: [meta],
+    };
+  }
+}
diff --git a/integration/inspector/src/circular-hello/hello.service.ts b/integration/inspector/src/circular-hello/hello.service.ts
new file mode 100644
index 000000000..a0a346ebf
--- /dev/null
+++ b/integration/inspector/src/circular-hello/hello.service.ts
@@ -0,0 +1,13 @@
+import { Inject, Injectable, Scope } from '@nestjs/common';
+
+@Injectable({ scope: Scope.REQUEST })
+export class HelloService {
+  static COUNTER = 0;
+  constructor(@Inject('META') private readonly meta) {
+    HelloService.COUNTER++;
+  }
+
+  greeting(): string {
+    return 'Hello world!';
+  }
+}
diff --git a/integration/inspector/src/circular-hello/interceptors/logging.interceptor.ts b/integration/inspector/src/circular-hello/interceptors/logging.interceptor.ts
new file mode 100644
index 000000000..b8b4e5793
--- /dev/null
+++ b/integration/inspector/src/circular-hello/interceptors/logging.interceptor.ts
@@ -0,0 +1,19 @@
+import {
+  CallHandler,
+  ExecutionContext,
+  Injectable,
+  NestInterceptor,
+  Scope,
+} from '@nestjs/common';
+import { Observable } from 'rxjs';
+
+@Injectable({ scope: Scope.REQUEST })
+export class Interceptor implements NestInterceptor {
+  static COUNTER = 0;
+  constructor() {
+    Interceptor.COUNTER++;
+  }
+  intercept(context: ExecutionContext, call: CallHandler): Observable<any> {
+    return call.handle();
+  }
+}
diff --git a/integration/inspector/src/circular-hello/users/user-by-id.pipe.ts b/integration/inspector/src/circular-hello/users/user-by-id.pipe.ts
new file mode 100644
index 000000000..2b81cb6fb
--- /dev/null
+++ b/integration/inspector/src/circular-hello/users/user-by-id.pipe.ts
@@ -0,0 +1,14 @@
+import { ArgumentMetadata, Injectable, PipeTransform } from '@nestjs/common';
+import { UsersService } from './users.service';
+
+@Injectable()
+export class UserByIdPipe implements PipeTransform<string> {
+  static COUNTER = 0;
+  constructor(private readonly usersService: UsersService) {
+    UserByIdPipe.COUNTER++;
+  }
+
+  transform(value: string, metadata: ArgumentMetadata) {
+    return this.usersService.findById(value);
+  }
+}
diff --git a/integration/inspector/src/circular-hello/users/users.service.ts b/integration/inspector/src/circular-hello/users/users.service.ts
new file mode 100644
index 000000000..f1cb617e1
--- /dev/null
+++ b/integration/inspector/src/circular-hello/users/users.service.ts
@@ -0,0 +1,13 @@
+import { Inject, Injectable, Scope } from '@nestjs/common';
+
+@Injectable({ scope: Scope.REQUEST })
+export class UsersService {
+  static COUNTER = 0;
+  constructor(@Inject('META') private readonly meta) {
+    UsersService.COUNTER++;
+  }
+
+  findById(id: string) {
+    return { id };
+  }
+}
diff --git a/integration/inspector/src/circular-modules/circular.module.ts b/integration/inspector/src/circular-modules/circular.module.ts
new file mode 100644
index 000000000..bb6afb42a
--- /dev/null
+++ b/integration/inspector/src/circular-modules/circular.module.ts
@@ -0,0 +1,10 @@
+import { Module, forwardRef } from '@nestjs/common';
+import { CircularService } from './circular.service';
+import { InputModule } from './input.module';
+
+@Module({
+  imports: [forwardRef(() => InputModule)],
+  providers: [CircularService],
+  exports: [CircularService],
+})
+export class CircularModule {}
diff --git a/integration/inspector/src/circular-modules/circular.service.ts b/integration/inspector/src/circular-modules/circular.service.ts
new file mode 100644
index 000000000..546d63e6e
--- /dev/null
+++ b/integration/inspector/src/circular-modules/circular.service.ts
@@ -0,0 +1,10 @@
+import { Injectable, forwardRef, Inject } from '@nestjs/common';
+import { InputService } from './input.service';
+
+@Injectable()
+export class CircularService {
+  constructor(
+    @Inject(forwardRef(() => InputService))
+    public readonly service: InputService,
+  ) {}
+}
diff --git a/integration/inspector/src/circular-modules/input.module.ts b/integration/inspector/src/circular-modules/input.module.ts
new file mode 100644
index 000000000..c76dcaa85
--- /dev/null
+++ b/integration/inspector/src/circular-modules/input.module.ts
@@ -0,0 +1,10 @@
+import { Module, forwardRef } from '@nestjs/common';
+import { CircularModule } from './circular.module';
+import { InputService } from './input.service';
+
+@Module({
+  imports: [forwardRef(() => CircularModule)],
+  providers: [InputService],
+  exports: [InputService],
+})
+export class InputModule {}
diff --git a/integration/inspector/src/circular-modules/input.service.ts b/integration/inspector/src/circular-modules/input.service.ts
new file mode 100644
index 000000000..342e8bf0d
--- /dev/null
+++ b/integration/inspector/src/circular-modules/input.service.ts
@@ -0,0 +1,10 @@
+import { Injectable, Inject, forwardRef } from '@nestjs/common';
+import { CircularService } from './circular.service';
+
+@Injectable()
+export class InputService {
+  constructor(
+    @Inject(forwardRef(() => CircularService))
+    public readonly service: CircularService,
+  ) {}
+}
diff --git a/integration/inspector/src/common/filters/http-exception.filter.ts b/integration/inspector/src/common/filters/http-exception.filter.ts
new file mode 100644
index 000000000..acabf619c
--- /dev/null
+++ b/integration/inspector/src/common/filters/http-exception.filter.ts
@@ -0,0 +1,22 @@
+import {
+  ArgumentsHost,
+  Catch,
+  ExceptionFilter,
+  HttpException,
+} from '@nestjs/common';
+
+@Catch(HttpException)
+export class HttpExceptionFilter implements ExceptionFilter<HttpException> {
+  catch(exception: HttpException, host: ArgumentsHost) {
+    const ctx = host.switchToHttp();
+    const response = ctx.getResponse();
+    const request = ctx.getRequest();
+    const statusCode = exception.getStatus();
+
+    response.status(statusCode).json({
+      statusCode,
+      timestamp: new Date().toISOString(),
+      path: request.url,
+    });
+  }
+}
diff --git a/integration/inspector/src/common/guards/roles.guard.ts b/integration/inspector/src/common/guards/roles.guard.ts
new file mode 100644
index 000000000..0ae26c41d
--- /dev/null
+++ b/integration/inspector/src/common/guards/roles.guard.ts
@@ -0,0 +1,20 @@
+import { CanActivate, ExecutionContext, Injectable } from '@nestjs/common';
+import { Reflector } from '@nestjs/core';
+
+@Injectable()
+export class RolesGuard implements CanActivate {
+  constructor(private readonly reflector: Reflector) {}
+
+  canActivate(context: ExecutionContext): boolean {
+    const roles = this.reflector.get<string[]>('roles', context.getHandler());
+    if (!roles) {
+      return true;
+    }
+    const request = context.switchToHttp().getRequest();
+    const user = request.user;
+    const hasRole = () =>
+      user.roles.some(role => !!roles.find(item => item === role));
+
+    return user && user.roles && hasRole();
+  }
+}
diff --git a/integration/inspector/src/common/interceptors/timeout.interceptor.ts b/integration/inspector/src/common/interceptors/timeout.interceptor.ts
new file mode 100644
index 000000000..3bd0769ac
--- /dev/null
+++ b/integration/inspector/src/common/interceptors/timeout.interceptor.ts
@@ -0,0 +1,15 @@
+import {
+  CallHandler,
+  ExecutionContext,
+  Injectable,
+  NestInterceptor,
+} from '@nestjs/common';
+import { Observable } from 'rxjs';
+import { timeout } from 'rxjs/operators';
+
+@Injectable()
+export class TimeoutInterceptor implements NestInterceptor {
+  intercept(context: ExecutionContext, next: CallHandler): Observable<any> {
+    return next.handle().pipe(timeout(5000));
+  }
+}
diff --git a/integration/inspector/src/common/middleware/logger.middleware.ts b/integration/inspector/src/common/middleware/logger.middleware.ts
new file mode 100644
index 000000000..5ada9418d
--- /dev/null
+++ b/integration/inspector/src/common/middleware/logger.middleware.ts
@@ -0,0 +1,9 @@
+import { Injectable, NestMiddleware } from '@nestjs/common';
+
+@Injectable()
+export class LoggerMiddleware implements NestMiddleware {
+  use(req: any, res: any, next: () => void) {
+    console.log(`Request...`);
+    next();
+  }
+}
diff --git a/integration/inspector/src/common/pipes/parse-int.pipe.ts b/integration/inspector/src/common/pipes/parse-int.pipe.ts
new file mode 100644
index 000000000..abc041424
--- /dev/null
+++ b/integration/inspector/src/common/pipes/parse-int.pipe.ts
@@ -0,0 +1,17 @@
+import {
+  BadRequestException,
+  PipeTransform,
+  Injectable,
+  ArgumentMetadata,
+} from '@nestjs/common';
+
+@Injectable()
+export class ParseIntPipe implements PipeTransform<string> {
+  async transform(value: string, metadata: ArgumentMetadata) {
+    const val = parseInt(value, 10);
+    if (isNaN(val)) {
+      throw new BadRequestException('Validation failed');
+    }
+    return val;
+  }
+}
diff --git a/integration/inspector/src/core/core.module.ts b/integration/inspector/src/core/core.module.ts
new file mode 100644
index 000000000..5bc1990b1
--- /dev/null
+++ b/integration/inspector/src/core/core.module.ts
@@ -0,0 +1,18 @@
+import { MiddlewareConsumer, Module, NestModule } from '@nestjs/common';
+import { APP_INTERCEPTOR } from '@nestjs/core';
+import { CatsController } from '../cats/cats.controller';
+import { LoggerMiddleware } from '../common/middleware/logger.middleware';
+import { LoggingInterceptor } from './interceptors/logging.interceptor';
+import { TransformInterceptor } from './interceptors/transform.interceptor';
+
+@Module({
+  providers: [
+    { provide: APP_INTERCEPTOR, useClass: TransformInterceptor },
+    { provide: APP_INTERCEPTOR, useClass: LoggingInterceptor },
+  ],
+})
+export class CoreModule implements NestModule {
+  configure(consumer: MiddlewareConsumer) {
+    consumer.apply(LoggerMiddleware).forRoutes(CatsController);
+  }
+}
diff --git a/integration/inspector/src/core/interceptors/logging.interceptor.ts b/integration/inspector/src/core/interceptors/logging.interceptor.ts
new file mode 100644
index 000000000..82ff0baa1
--- /dev/null
+++ b/integration/inspector/src/core/interceptors/logging.interceptor.ts
@@ -0,0 +1,20 @@
+import {
+  CallHandler,
+  ExecutionContext,
+  Injectable,
+  NestInterceptor,
+} from '@nestjs/common';
+import { Observable } from 'rxjs';
+import { tap } from 'rxjs/operators';
+
+@Injectable()
+export class LoggingInterceptor implements NestInterceptor {
+  intercept(context: ExecutionContext, next: CallHandler): Observable<any> {
+    console.log('Before...');
+
+    const now = Date.now();
+    return next
+      .handle()
+      .pipe(tap(() => console.log(`After... ${Date.now() - now}ms`)));
+  }
+}
diff --git a/integration/inspector/src/core/interceptors/transform.interceptor.ts b/integration/inspector/src/core/interceptors/transform.interceptor.ts
new file mode 100644
index 000000000..c84c6428f
--- /dev/null
+++ b/integration/inspector/src/core/interceptors/transform.interceptor.ts
@@ -0,0 +1,24 @@
+import {
+  CallHandler,
+  ExecutionContext,
+  Injectable,
+  NestInterceptor,
+} from '@nestjs/common';
+import { Observable } from 'rxjs';
+import { map } from 'rxjs/operators';
+
+export interface Response<T> {
+  data: T;
+}
+
+@Injectable()
+export class TransformInterceptor<T>
+  implements NestInterceptor<T, Response<T>>
+{
+  intercept(
+    context: ExecutionContext,
+    next: CallHandler<T>,
+  ): Observable<Response<T>> {
+    return next.handle().pipe(map(data => ({ data })));
+  }
+}
diff --git a/integration/inspector/src/database/database.controller.ts b/integration/inspector/src/database/database.controller.ts
new file mode 100644
index 000000000..629762ae0
--- /dev/null
+++ b/integration/inspector/src/database/database.controller.ts
@@ -0,0 +1,45 @@
+import {
+  Controller,
+  Get,
+  Post,
+  Body,
+  Patch,
+  Param,
+  Delete,
+} from '@nestjs/common';
+import { DatabaseService } from './database.service';
+import { CreateDatabaseDto } from './dto/create-database.dto';
+import { UpdateDatabaseDto } from './dto/update-database.dto';
+
+@Controller('database')
+export class DatabaseController {
+  constructor(private readonly databaseService: DatabaseService) {}
+
+  @Post()
+  create(@Body() createDatabaseDto: CreateDatabaseDto) {
+    return this.databaseService.create(createDatabaseDto);
+  }
+
+  @Get()
+  findAll() {
+    return this.databaseService.findAll();
+  }
+
+  @Get(':id')
+  findOne(@Param('id') id: string) {
+    return this.databaseService.findOne(+id);
+  }
+
+  @Patch(':id')
+  update(
+    @Param('id') id: string,
+    @Body() updateDatabaseDto: UpdateDatabaseDto,
+  ) {
+    return this.databaseService.update(+id, updateDatabaseDto);
+  }
+
+  @Delete(':id')
+  remove(@Param('id') id: string) {
+    return this.databaseService.remove(+id);
+  }
+}
diff --git a/integration/inspector/src/database/database.module.ts b/integration/inspector/src/database/database.module.ts
new file mode 100644
index 000000000..2f37f674b
--- /dev/null
+++ b/integration/inspector/src/database/database.module.ts
@@ -0,0 +1,9 @@
+import { Module } from '@nestjs/common';
+import { DatabaseService } from './database.service';
+import { DatabaseController } from './database.controller';
+
+@Module({
+  controllers: [DatabaseController],
+  providers: [DatabaseService],
+})
+export class DatabaseModule {}
diff --git a/integration/inspector/src/database/database.service.ts b/integration/inspector/src/database/database.service.ts
new file mode 100644
index 000000000..845667895
--- /dev/null
+++ b/integration/inspector/src/database/database.service.ts
@@ -0,0 +1,26 @@
+import { Injectable } from '@nestjs/common';
+import { CreateDatabaseDto } from './dto/create-database.dto';
+import { UpdateDatabaseDto } from './dto/update-database.dto';
+
+@Injectable()
+export class DatabaseService {
+  create(createDatabaseDto: CreateDatabaseDto) {
+    return 'This action adds a new database';
+  }
+
+  findAll() {
+    return `This action returns all database`;
+  }
+
+  findOne(id: number) {
+    return `This action returns a #${id} database`;
+  }
+
+  update(id: number, updateDatabaseDto: UpdateDatabaseDto) {
+    return `This action updates a #${id} database`;
+  }
+
+  remove(id: number) {
+    return `This action removes a #${id} database`;
+  }
+}
diff --git a/integration/inspector/src/database/dto/create-database.dto.ts b/integration/inspector/src/database/dto/create-database.dto.ts
new file mode 100644
index 000000000..0b7bc753c
--- /dev/null
+++ b/integration/inspector/src/database/dto/create-database.dto.ts
@@ -0,0 +1 @@
+export class CreateDatabaseDto {}
diff --git a/integration/inspector/src/database/dto/update-database.dto.ts b/integration/inspector/src/database/dto/update-database.dto.ts
new file mode 100644
index 000000000..5cc666665
--- /dev/null
+++ b/integration/inspector/src/database/dto/update-database.dto.ts
@@ -0,0 +1,4 @@
+import { PartialType } from '@nestjs/mapped-types';
+import { CreateDatabaseDto } from './create-database.dto';
+
+export class UpdateDatabaseDto extends PartialType(CreateDatabaseDto) {}
diff --git a/integration/inspector/src/database/entities/database.entity.ts b/integration/inspector/src/database/entities/database.entity.ts
new file mode 100644
index 000000000..144f2990d
--- /dev/null
+++ b/integration/inspector/src/database/entities/database.entity.ts
@@ -0,0 +1 @@
+export class Database {}
diff --git a/integration/inspector/src/defaults/core.service.ts b/integration/inspector/src/defaults/core.service.ts
new file mode 100644
index 000000000..acbb46cc2
--- /dev/null
+++ b/integration/inspector/src/defaults/core.service.ts
@@ -0,0 +1,4 @@
+import { Injectable } from '@nestjs/common';
+
+@Injectable()
+export class CoreService {}
diff --git a/integration/inspector/src/defaults/defaults.module.ts b/integration/inspector/src/defaults/defaults.module.ts
new file mode 100644
index 000000000..f8a7ddb9f
--- /dev/null
+++ b/integration/inspector/src/defaults/defaults.module.ts
@@ -0,0 +1,7 @@
+import { Module } from '@nestjs/common';
+import { DefaultsService } from './defaults.service';
+
+@Module({
+  providers: [DefaultsService],
+})
+export class DefaultsModule {}
diff --git a/integration/inspector/src/defaults/defaults.service.ts b/integration/inspector/src/defaults/defaults.service.ts
new file mode 100644
index 000000000..edc4790f1
--- /dev/null
+++ b/integration/inspector/src/defaults/defaults.service.ts
@@ -0,0 +1,11 @@
+import { Inject, Injectable, Optional } from '@nestjs/common';
+import { CoreService } from './core.service';
+
+@Injectable()
+export class DefaultsService {
+  constructor(
+    @Inject(CoreService)
+    @Optional()
+    public readonly coreService = { default: true },
+  ) {}
+}
diff --git a/integration/inspector/src/dogs/dogs.controller.ts b/integration/inspector/src/dogs/dogs.controller.ts
new file mode 100644
index 000000000..8d5ab7d8a
--- /dev/null
+++ b/integration/inspector/src/dogs/dogs.controller.ts
@@ -0,0 +1,42 @@
+import {
+  Controller,
+  Get,
+  Post,
+  Body,
+  Patch,
+  Param,
+  Delete,
+} from '@nestjs/common';
+import { DogsService } from './dogs.service';
+import { CreateDogDto } from './dto/create-dog.dto';
+import { UpdateDogDto } from './dto/update-dog.dto';
+
+@Controller('dogs')
+export class DogsController {
+  constructor(private readonly dogsService: DogsService) {}
+
+  @Post()
+  create(@Body() createDogDto: CreateDogDto) {
+    return this.dogsService.create(createDogDto);
+  }
+
+  @Get()
+  findAll() {
+    return this.dogsService.findAll();
+  }
+
+  @Get(':id')
+  findOne(@Param('id') id: string) {
+    return this.dogsService.findOne(+id);
+  }
+
+  @Patch(':id')
+  update(@Param('id') id: string, @Body() updateDogDto: UpdateDogDto) {
+    return this.dogsService.update(+id, updateDogDto);
+  }
+
+  @Delete(':id')
+  remove(@Param('id') id: string) {
+    return this.dogsService.remove(+id);
+  }
+}
diff --git a/integration/inspector/src/dogs/dogs.module.ts b/integration/inspector/src/dogs/dogs.module.ts
new file mode 100644
index 000000000..3385a39e3
--- /dev/null
+++ b/integration/inspector/src/dogs/dogs.module.ts
@@ -0,0 +1,9 @@
+import { Module } from '@nestjs/common';
+import { DogsService } from './dogs.service';
+import { DogsController } from './dogs.controller';
+
+@Module({
+  controllers: [DogsController],
+  providers: [DogsService],
+})
+export class DogsModule {}
diff --git a/integration/inspector/src/dogs/dogs.service.ts b/integration/inspector/src/dogs/dogs.service.ts
new file mode 100644
index 000000000..f1f2d9347
--- /dev/null
+++ b/integration/inspector/src/dogs/dogs.service.ts
@@ -0,0 +1,26 @@
+import { Injectable } from '@nestjs/common';
+import { CreateDogDto } from './dto/create-dog.dto';
+import { UpdateDogDto } from './dto/update-dog.dto';
+
+@Injectable()
+export class DogsService {
+  create(createDogDto: CreateDogDto) {
+    return 'This action adds a new dog';
+  }
+
+  findAll() {
+    return `This action returns all dogs`;
+  }
+
+  findOne(id: number) {
+    return `This action returns a #${id} dog`;
+  }
+
+  update(id: number, updateDogDto: UpdateDogDto) {
+    return `This action updates a #${id} dog`;
+  }
+
+  remove(id: number) {
+    return `This action removes a #${id} dog`;
+  }
+}
diff --git a/integration/inspector/src/dogs/dto/create-dog.dto.ts b/integration/inspector/src/dogs/dto/create-dog.dto.ts
new file mode 100644
index 000000000..fd21dff8a
--- /dev/null
+++ b/integration/inspector/src/dogs/dto/create-dog.dto.ts
@@ -0,0 +1 @@
+export class CreateDogDto {}
diff --git a/integration/inspector/src/dogs/dto/update-dog.dto.ts b/integration/inspector/src/dogs/dto/update-dog.dto.ts
new file mode 100644
index 000000000..15d4939c8
--- /dev/null
+++ b/integration/inspector/src/dogs/dto/update-dog.dto.ts
@@ -0,0 +1,4 @@
+import { PartialType } from '@nestjs/mapped-types';
+import { CreateDogDto } from './create-dog.dto';
+
+export class UpdateDogDto extends PartialType(CreateDogDto) {}
diff --git a/integration/inspector/src/dogs/entities/dog.entity.ts b/integration/inspector/src/dogs/entities/dog.entity.ts
new file mode 100644
index 000000000..cbd6231a1
--- /dev/null
+++ b/integration/inspector/src/dogs/entities/dog.entity.ts
@@ -0,0 +1 @@
+export class Dog {}
diff --git a/integration/inspector/src/durable/durable-context-id.strategy.ts b/integration/inspector/src/durable/durable-context-id.strategy.ts
new file mode 100644
index 000000000..d4158f3e2
--- /dev/null
+++ b/integration/inspector/src/durable/durable-context-id.strategy.ts
@@ -0,0 +1,23 @@
+import { ContextId, ContextIdStrategy, HostComponentInfo } from '@nestjs/core';
+import { Request } from 'express';
+
+const tenants = new Map<string, ContextId>();
+
+export class DurableContextIdStrategy implements ContextIdStrategy {
+  attach(contextId: ContextId, request: Request) {
+    const tenantId = request.headers['x-tenant-id'] as string;
+    let tenantSubTreeId: ContextId;
+
+    if (tenants.has(tenantId)) {
+      tenantSubTreeId = tenants.get(tenantId);
+    } else {
+      tenantSubTreeId = { id: +tenantId } as ContextId;
+      tenants.set(tenantId, tenantSubTreeId);
+    }
+    return {
+      resolve: (info: HostComponentInfo) =>
+        info.isTreeDurable ? tenantSubTreeId : contextId,
+      payload: { tenantId },
+    };
+  }
+}
diff --git a/integration/inspector/src/durable/durable.controller.ts b/integration/inspector/src/durable/durable.controller.ts
new file mode 100644
index 000000000..be51ad2df
--- /dev/null
+++ b/integration/inspector/src/durable/durable.controller.ts
@@ -0,0 +1,17 @@
+import { Controller, Get } from '@nestjs/common';
+import { DurableService } from './durable.service';
+
+@Controller('durable')
+export class DurableController {
+  constructor(private readonly durableService: DurableService) {}
+
+  @Get()
+  greeting(): string {
+    return this.durableService.greeting();
+  }
+
+  @Get('echo')
+  echo() {
+    return this.durableService.requestPayload;
+  }
+}
diff --git a/integration/inspector/src/durable/durable.module.ts b/integration/inspector/src/durable/durable.module.ts
new file mode 100644
index 000000000..ed312900f
--- /dev/null
+++ b/integration/inspector/src/durable/durable.module.ts
@@ -0,0 +1,9 @@
+import { Module } from '@nestjs/common';
+import { DurableController } from './durable.controller';
+import { DurableService } from './durable.service';
+
+@Module({
+  controllers: [DurableController],
+  providers: [DurableService],
+})
+export class DurableModule {}
diff --git a/integration/inspector/src/durable/durable.service.ts b/integration/inspector/src/durable/durable.service.ts
new file mode 100644
index 000000000..6e25b01dd
--- /dev/null
+++ b/integration/inspector/src/durable/durable.service.ts
@@ -0,0 +1,14 @@
+import { Inject, Injectable, Scope } from '@nestjs/common';
+import { REQUEST } from '@nestjs/core';
+
+@Injectable({ scope: Scope.REQUEST, durable: true })
+export class DurableService {
+  public instanceCounter = 0;
+
+  constructor(@Inject(REQUEST) public readonly requestPayload: unknown) {}
+
+  greeting() {
+    ++this.instanceCounter;
+    return `Hello world! Counter: ${this.instanceCounter}`;
+  }
+}
diff --git a/integration/inspector/src/external-svc/dto/create-external-svc.dto.ts b/integration/inspector/src/external-svc/dto/create-external-svc.dto.ts
new file mode 100644
index 000000000..b37586bc5
--- /dev/null
+++ b/integration/inspector/src/external-svc/dto/create-external-svc.dto.ts
@@ -0,0 +1 @@
+export class CreateExternalSvcDto {}
diff --git a/integration/inspector/src/external-svc/dto/update-external-svc.dto.ts b/integration/inspector/src/external-svc/dto/update-external-svc.dto.ts
new file mode 100644
index 000000000..95be362d9
--- /dev/null
+++ b/integration/inspector/src/external-svc/dto/update-external-svc.dto.ts
@@ -0,0 +1,6 @@
+import { PartialType } from '@nestjs/mapped-types';
+import { CreateExternalSvcDto } from './create-external-svc.dto';
+
+export class UpdateExternalSvcDto extends PartialType(CreateExternalSvcDto) {
+  id: number;
+}
diff --git a/integration/inspector/src/external-svc/entities/external-svc.entity.ts b/integration/inspector/src/external-svc/entities/external-svc.entity.ts
new file mode 100644
index 000000000..645900058
--- /dev/null
+++ b/integration/inspector/src/external-svc/entities/external-svc.entity.ts
@@ -0,0 +1 @@
+export class ExternalSvc {}
diff --git a/integration/inspector/src/external-svc/external-svc.controller.ts b/integration/inspector/src/external-svc/external-svc.controller.ts
new file mode 100644
index 000000000..f2233620f
--- /dev/null
+++ b/integration/inspector/src/external-svc/external-svc.controller.ts
@@ -0,0 +1,38 @@
+import { Controller } from '@nestjs/common';
+import { MessagePattern, Payload } from '@nestjs/microservices';
+import { ExternalSvcService } from './external-svc.service';
+import { CreateExternalSvcDto } from './dto/create-external-svc.dto';
+import { UpdateExternalSvcDto } from './dto/update-external-svc.dto';
+
+@Controller()
+export class ExternalSvcController {
+  constructor(private readonly externalSvcService: ExternalSvcService) {}
+
+  @MessagePattern('createExternalSvc')
+  create(@Payload() createExternalSvcDto: CreateExternalSvcDto) {
+    return this.externalSvcService.create(createExternalSvcDto);
+  }
+
+  @MessagePattern('findAllExternalSvc')
+  findAll() {
+    return this.externalSvcService.findAll();
+  }
+
+  @MessagePattern('findOneExternalSvc')
+  findOne(@Payload() id: number) {
+    return this.externalSvcService.findOne(id);
+  }
+
+  @MessagePattern('updateExternalSvc')
+  update(@Payload() updateExternalSvcDto: UpdateExternalSvcDto) {
+    return this.externalSvcService.update(
+      updateExternalSvcDto.id,
+      updateExternalSvcDto,
+    );
+  }
+
+  @MessagePattern('removeExternalSvc')
+  remove(@Payload() id: number) {
+    return this.externalSvcService.remove(id);
+  }
+}
diff --git a/integration/inspector/src/external-svc/external-svc.module.ts b/integration/inspector/src/external-svc/external-svc.module.ts
new file mode 100644
index 000000000..f4b57fc02
--- /dev/null
+++ b/integration/inspector/src/external-svc/external-svc.module.ts
@@ -0,0 +1,9 @@
+import { Module } from '@nestjs/common';
+import { ExternalSvcService } from './external-svc.service';
+import { ExternalSvcController } from './external-svc.controller';
+
+@Module({
+  controllers: [ExternalSvcController],
+  providers: [ExternalSvcService],
+})
+export class ExternalSvcModule {}
diff --git a/integration/inspector/src/external-svc/external-svc.service.ts b/integration/inspector/src/external-svc/external-svc.service.ts
new file mode 100644
index 000000000..9620630c2
--- /dev/null
+++ b/integration/inspector/src/external-svc/external-svc.service.ts
@@ -0,0 +1,26 @@
+import { Injectable } from '@nestjs/common';
+import { CreateExternalSvcDto } from './dto/create-external-svc.dto';
+import { UpdateExternalSvcDto } from './dto/update-external-svc.dto';
+
+@Injectable()
+export class ExternalSvcService {
+  create(createExternalSvcDto: CreateExternalSvcDto) {
+    return 'This action adds a new externalSvc';
+  }
+
+  findAll() {
+    return `This action returns all externalSvc`;
+  }
+
+  findOne(id: number) {
+    return `This action returns a #${id} externalSvc`;
+  }
+
+  update(id: number, updateExternalSvcDto: UpdateExternalSvcDto) {
+    return `This action updates a #${id} externalSvc`;
+  }
+
+  remove(id: number) {
+    return `This action removes a #${id} externalSvc`;
+  }
+}
diff --git a/integration/inspector/src/properties/dependency.service.ts b/integration/inspector/src/properties/dependency.service.ts
new file mode 100644
index 000000000..cd71d8c80
--- /dev/null
+++ b/integration/inspector/src/properties/dependency.service.ts
@@ -0,0 +1,4 @@
+import { Injectable } from '@nestjs/common';
+
+@Injectable()
+export class DependencyService {}
diff --git a/integration/inspector/src/properties/properties.module.ts b/integration/inspector/src/properties/properties.module.ts
new file mode 100644
index 000000000..b2ad36ff3
--- /dev/null
+++ b/integration/inspector/src/properties/properties.module.ts
@@ -0,0 +1,19 @@
+import { Module } from '@nestjs/common';
+import { DependencyService } from './dependency.service';
+import { PropertiesService, SYMBOL_TOKEN } from './properties.service';
+
+@Module({
+  providers: [
+    DependencyService,
+    PropertiesService,
+    {
+      provide: 'token',
+      useValue: true,
+    },
+    {
+      provide: SYMBOL_TOKEN,
+      useValue: true,
+    },
+  ],
+})
+export class PropertiesModule {}
diff --git a/integration/inspector/src/properties/properties.service.ts b/integration/inspector/src/properties/properties.service.ts
new file mode 100644
index 000000000..cd4507524
--- /dev/null
+++ b/integration/inspector/src/properties/properties.service.ts
@@ -0,0 +1,11 @@
+import { Inject, Injectable } from '@nestjs/common';
+import { DependencyService } from './dependency.service';
+
+export const SYMBOL_TOKEN = Symbol('token');
+
+@Injectable()
+export class PropertiesService {
+  @Inject() service: DependencyService;
+  @Inject('token') token: boolean;
+  @Inject(SYMBOL_TOKEN) symbolToken: boolean;
+}
diff --git a/integration/inspector/src/request-chain/helper/helper.module.ts b/integration/inspector/src/request-chain/helper/helper.module.ts
new file mode 100644
index 000000000..1c154ea44
--- /dev/null
+++ b/integration/inspector/src/request-chain/helper/helper.module.ts
@@ -0,0 +1,8 @@
+import { Module } from '@nestjs/common';
+import { HelperService } from './helper.service';
+
+@Module({
+  providers: [HelperService],
+  exports: [HelperService],
+})
+export class HelperModule {}
diff --git a/integration/inspector/src/request-chain/helper/helper.service.ts b/integration/inspector/src/request-chain/helper/helper.service.ts
new file mode 100644
index 000000000..52efe0eb2
--- /dev/null
+++ b/integration/inspector/src/request-chain/helper/helper.service.ts
@@ -0,0 +1,9 @@
+import { Inject, Injectable, Scope } from '@nestjs/common';
+import { REQUEST } from '@nestjs/core';
+
+@Injectable({ scope: Scope.REQUEST })
+export class HelperService {
+  constructor(@Inject(REQUEST) public readonly request) {}
+
+  public noop() {}
+}
diff --git a/integration/inspector/src/request-chain/interceptors/logging.interceptor.ts b/integration/inspector/src/request-chain/interceptors/logging.interceptor.ts
new file mode 100644
index 000000000..008a69993
--- /dev/null
+++ b/integration/inspector/src/request-chain/interceptors/logging.interceptor.ts
@@ -0,0 +1,21 @@
+import {
+  CallHandler,
+  ExecutionContext,
+  Injectable,
+  NestInterceptor,
+} from '@nestjs/common';
+import { Observable } from 'rxjs';
+import { HelperService } from '../helper/helper.service';
+
+@Injectable()
+export class LoggingInterceptor implements NestInterceptor {
+  constructor(private readonly helperSvc: HelperService) {}
+
+  intercept(context: ExecutionContext, next: CallHandler): Observable<any> {
+    this.helperSvc.noop();
+    if (!this.helperSvc.request) {
+      throw new Error('error');
+    }
+    return next.handle();
+  }
+}
diff --git a/integration/inspector/src/request-chain/request-chain.controller.ts b/integration/inspector/src/request-chain/request-chain.controller.ts
new file mode 100644
index 000000000..03813352d
--- /dev/null
+++ b/integration/inspector/src/request-chain/request-chain.controller.ts
@@ -0,0 +1,14 @@
+import { Controller, Get, UseInterceptors } from '@nestjs/common';
+import { LoggingInterceptor } from './interceptors/logging.interceptor';
+import { RequestChainService } from './request-chain.service';
+
+@Controller('hello')
+export class RequestChainController {
+  constructor(private readonly chainService: RequestChainService) {}
+
+  @UseInterceptors(LoggingInterceptor)
+  @Get()
+  greeting(): void {
+    this.chainService.call();
+  }
+}
diff --git a/integration/inspector/src/request-chain/request-chain.module.ts b/integration/inspector/src/request-chain/request-chain.module.ts
new file mode 100644
index 000000000..eba8f451d
--- /dev/null
+++ b/integration/inspector/src/request-chain/request-chain.module.ts
@@ -0,0 +1,11 @@
+import { Module } from '@nestjs/common';
+import { HelperModule } from './helper/helper.module';
+import { RequestChainController } from './request-chain.controller';
+import { RequestChainService } from './request-chain.service';
+
+@Module({
+  imports: [HelperModule],
+  providers: [RequestChainService],
+  controllers: [RequestChainController],
+})
+export class RequestChainModule {}
diff --git a/integration/inspector/src/request-chain/request-chain.service.ts b/integration/inspector/src/request-chain/request-chain.service.ts
new file mode 100644
index 000000000..c8c00068d
--- /dev/null
+++ b/integration/inspector/src/request-chain/request-chain.service.ts
@@ -0,0 +1,15 @@
+import { Injectable } from '@nestjs/common';
+import { HelperService } from './helper/helper.service';
+
+@Injectable()
+export class RequestChainService {
+  static COUNTER = 0;
+  constructor(private readonly helperService: HelperService) {
+    helperService.noop();
+    RequestChainService.COUNTER += 1;
+  }
+
+  call() {
+    this.helperService.noop();
+  }
+}
diff --git a/integration/inspector/src/users/dto/create-user.dto.ts b/integration/inspector/src/users/dto/create-user.dto.ts
new file mode 100644
index 000000000..0311be138
--- /dev/null
+++ b/integration/inspector/src/users/dto/create-user.dto.ts
@@ -0,0 +1 @@
+export class CreateUserDto {}
diff --git a/integration/inspector/src/users/dto/update-user.dto.ts b/integration/inspector/src/users/dto/update-user.dto.ts
new file mode 100644
index 000000000..dfd37fb1e
--- /dev/null
+++ b/integration/inspector/src/users/dto/update-user.dto.ts
@@ -0,0 +1,4 @@
+import { PartialType } from '@nestjs/mapped-types';
+import { CreateUserDto } from './create-user.dto';
+
+export class UpdateUserDto extends PartialType(CreateUserDto) {}
diff --git a/integration/inspector/src/users/entities/user.entity.ts b/integration/inspector/src/users/entities/user.entity.ts
new file mode 100644
index 000000000..4f82c1457
--- /dev/null
+++ b/integration/inspector/src/users/entities/user.entity.ts
@@ -0,0 +1 @@
+export class User {}
diff --git a/integration/inspector/src/users/users.controller.ts b/integration/inspector/src/users/users.controller.ts
new file mode 100644
index 000000000..d5db3a65e
--- /dev/null
+++ b/integration/inspector/src/users/users.controller.ts
@@ -0,0 +1,42 @@
+import {
+  Controller,
+  Get,
+  Post,
+  Body,
+  Patch,
+  Param,
+  Delete,
+} from '@nestjs/common';
+import { UsersService } from './users.service';
+import { CreateUserDto } from './dto/create-user.dto';
+import { UpdateUserDto } from './dto/update-user.dto';
+
+@Controller('users')
+export class UsersController {
+  constructor(private readonly usersService: UsersService) {}
+
+  @Post()
+  create(@Body() createUserDto: CreateUserDto) {
+    return this.usersService.create(createUserDto);
+  }
+
+  @Get()
+  findAll() {
+    return this.usersService.findAll();
+  }
+
+  @Get(':id')
+  findOne(@Param('id') id: string) {
+    return this.usersService.findOne(+id);
+  }
+
+  @Patch(':id')
+  update(@Param('id') id: string, @Body() updateUserDto: UpdateUserDto) {
+    return this.usersService.update(+id, updateUserDto);
+  }
+
+  @Delete(':id')
+  remove(@Param('id') id: string) {
+    return this.usersService.remove(+id);
+  }
+}
diff --git a/integration/inspector/src/users/users.module.ts b/integration/inspector/src/users/users.module.ts
new file mode 100644
index 000000000..ecca17ad6
--- /dev/null
+++ b/integration/inspector/src/users/users.module.ts
@@ -0,0 +1,9 @@
+import { Module } from '@nestjs/common';
+import { UsersService } from './users.service';
+import { UsersController } from './users.controller';
+
+@Module({
+  controllers: [UsersController],
+  providers: [UsersService],
+})
+export class UsersModule {}
diff --git a/integration/inspector/src/users/users.service.ts b/integration/inspector/src/users/users.service.ts
new file mode 100644
index 000000000..0a55903da
--- /dev/null
+++ b/integration/inspector/src/users/users.service.ts
@@ -0,0 +1,26 @@
+import { Injectable } from '@nestjs/common';
+import { CreateUserDto } from './dto/create-user.dto';
+import { UpdateUserDto } from './dto/update-user.dto';
+
+@Injectable()
+export class UsersService {
+  create(createUserDto: CreateUserDto) {
+    return 'This action adds a new user';
+  }
+
+  findAll() {
+    return `This action returns all users`;
+  }
+
+  findOne(id: number) {
+    return `This action returns a #${id} user`;
+  }
+
+  update(id: number, updateUserDto: UpdateUserDto) {
+    return `This action updates a #${id} user`;
+  }
+
+  remove(id: number) {
+    return `This action removes a #${id} user`;
+  }
+}
diff --git a/integration/inspector/tsconfig.json b/integration/inspector/tsconfig.json
new file mode 100644
index 000000000..cef623d14
--- /dev/null
+++ b/integration/inspector/tsconfig.json
@@ -0,0 +1,40 @@
+{
+  "compilerOptions": {
+    "module": "commonjs",
+    "declaration": false,
+    "noImplicitAny": false,
+    "removeComments": true,
+    "noLib": false,
+    "emitDecoratorMetadata": true,
+    "experimentalDecorators": true,
+    "target": "ES2021",
+    "sourceMap": true,
+    "allowJs": true,
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
+  },
+  "include": [
+    "src/**/*",
+    "e2e/**/*"
+  ],
+  "exclude": [
+    "node_modules",
+  ]
+}
\ No newline at end of file
diff --git a/integration/microservices/e2e/broadcast-mqtt.spec.ts b/integration/microservices/e2e/broadcast-mqtt.spec.ts
index 6ace4d6b5..641bf442a 100644
--- a/integration/microservices/e2e/broadcast-mqtt.spec.ts
+++ b/integration/microservices/e2e/broadcast-mqtt.spec.ts
@@ -1,5 +1,5 @@
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
 import { MqttBroadcastController } from '../src/mqtt/mqtt-broadcast.controller';
@@ -16,13 +16,13 @@ describe('MQTT transport', () => {
     app = module.createNestApplication();
     server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.MQTT,
       options: {
         host: '0.0.0.0',
       },
     });
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.MQTT,
       options: {
         host: '0.0.0.0',
diff --git a/integration/microservices/e2e/broadcast-nats.spec.ts b/integration/microservices/e2e/broadcast-nats.spec.ts
index ecd45cd15..b8cf69b50 100644
--- a/integration/microservices/e2e/broadcast-nats.spec.ts
+++ b/integration/microservices/e2e/broadcast-nats.spec.ts
@@ -1,5 +1,5 @@
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
 import { NatsBroadcastController } from '../src/nats/nats-broadcast.controller';
@@ -16,13 +16,13 @@ describe('NATS transport', () => {
     app = module.createNestApplication();
     server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.NATS,
       options: {
         servers: 'nats://0.0.0.0:4222',
       },
     });
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.NATS,
       options: {
         servers: 'servers://0.0.0.0:4222',
diff --git a/integration/microservices/e2e/broadcast-redis.spec.ts b/integration/microservices/e2e/broadcast-redis.spec.ts
index 2a9106f2f..1cf8690ef 100644
--- a/integration/microservices/e2e/broadcast-redis.spec.ts
+++ b/integration/microservices/e2e/broadcast-redis.spec.ts
@@ -1,5 +1,5 @@
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
 import { RedisBroadcastController } from '../src/redis/redis-broadcast.controller';
@@ -16,16 +16,18 @@ describe('REDIS transport', () => {
     app = module.createNestApplication();
     server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.REDIS,
       options: {
-        url: 'redis://0.0.0.0:6379',
+        host: '0.0.0.0',
+        port: 6379,
       },
     });
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.REDIS,
       options: {
-        url: 'redis://0.0.0.0:6379',
+        host: '0.0.0.0',
+        port: 6379,
       },
     });
     await app.startAllMicroservices();
diff --git a/integration/microservices/e2e/concurrent-kafka.spec.ts b/integration/microservices/e2e/concurrent-kafka.spec.ts
index f50a7b329..86be67f77 100644
--- a/integration/microservices/e2e/concurrent-kafka.spec.ts
+++ b/integration/microservices/e2e/concurrent-kafka.spec.ts
@@ -1,5 +1,5 @@
 import { INestApplication, Logger } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import { Admin, ITopicMetadata, Kafka } from 'kafkajs';
 import * as request from 'supertest';
@@ -37,7 +37,7 @@ describe.skip('Kafka concurrent', function () {
 
     const server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.KAFKA,
       options: {
         client: {
diff --git a/integration/microservices/e2e/mqtt-record-builder.spec.ts b/integration/microservices/e2e/mqtt-record-builder.spec.ts
index 1edfddb2e..94d57d5be 100644
--- a/integration/microservices/e2e/mqtt-record-builder.spec.ts
+++ b/integration/microservices/e2e/mqtt-record-builder.spec.ts
@@ -1,5 +1,5 @@
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
 import { MqttController } from '../src/mqtt/mqtt.controller';
@@ -16,7 +16,7 @@ describe('MQTT transport', () => {
     app = module.createNestApplication();
     server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.MQTT,
       options: {
         url: 'mqtt://0.0.0.0:1883',
diff --git a/integration/microservices/e2e/orders-grpc.spec.ts b/integration/microservices/e2e/orders-grpc.spec.ts
index d3c293ef6..e34864f91 100644
--- a/integration/microservices/e2e/orders-grpc.spec.ts
+++ b/integration/microservices/e2e/orders-grpc.spec.ts
@@ -1,7 +1,7 @@
 import * as GRPC from '@grpc/grpc-js';
 import * as ProtoLoader from '@grpc/proto-loader';
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { ExpressAdapter } from '@nestjs/platform-express';
 import { Test } from '@nestjs/testing';
 import { fail } from 'assert';
@@ -26,7 +26,7 @@ describe('Advanced GRPC transport', () => {
     /*
      *  Create microservice configuration
      */
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.GRPC,
       options: {
         url: 'localhost:5001',
diff --git a/integration/microservices/e2e/sum-grpc.spec.ts b/integration/microservices/e2e/sum-grpc.spec.ts
index e29fcf7e7..cd6459e50 100644
--- a/integration/microservices/e2e/sum-grpc.spec.ts
+++ b/integration/microservices/e2e/sum-grpc.spec.ts
@@ -1,7 +1,7 @@
 import * as GRPC from '@grpc/grpc-js';
 import * as ProtoLoader from '@grpc/proto-loader';
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import { fail } from 'assert';
 import { expect } from 'chai';
@@ -22,7 +22,7 @@ describe('GRPC transport', () => {
     app = module.createNestApplication();
     server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.GRPC,
       options: {
         package: ['math', 'math2'],
diff --git a/integration/microservices/e2e/sum-kafka.spec.ts b/integration/microservices/e2e/sum-kafka.spec.ts
index 9fee99b9a..0ab86ec73 100644
--- a/integration/microservices/e2e/sum-kafka.spec.ts
+++ b/integration/microservices/e2e/sum-kafka.spec.ts
@@ -1,5 +1,5 @@
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import { expect } from 'chai';
 import * as request from 'supertest';
@@ -29,7 +29,7 @@ describe.skip('Kafka transport', function () {
     app = module.createNestApplication();
     server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.KAFKA,
       options: {
         client: {
diff --git a/integration/microservices/e2e/sum-mqtt.spec.ts b/integration/microservices/e2e/sum-mqtt.spec.ts
index 2b2320e67..5cbce8a9c 100644
--- a/integration/microservices/e2e/sum-mqtt.spec.ts
+++ b/integration/microservices/e2e/sum-mqtt.spec.ts
@@ -1,5 +1,5 @@
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import { expect } from 'chai';
 import * as request from 'supertest';
@@ -17,7 +17,7 @@ describe('MQTT transport', () => {
     app = module.createNestApplication();
     server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.MQTT,
       options: {
         url: 'mqtt://0.0.0.0:1883',
diff --git a/integration/microservices/e2e/sum-nats.spec.ts b/integration/microservices/e2e/sum-nats.spec.ts
index 6944535ae..7206d60ba 100644
--- a/integration/microservices/e2e/sum-nats.spec.ts
+++ b/integration/microservices/e2e/sum-nats.spec.ts
@@ -1,5 +1,5 @@
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import { expect } from 'chai';
 import * as request from 'supertest';
@@ -19,7 +19,7 @@ describe('NATS transport', () => {
     app = module.createNestApplication();
     server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.NATS,
       options: {
         servers: 'nats://0.0.0.0:4222',
diff --git a/integration/microservices/e2e/sum-redis.spec.ts b/integration/microservices/e2e/sum-redis.spec.ts
index 15b698573..10a9e396a 100644
--- a/integration/microservices/e2e/sum-redis.spec.ts
+++ b/integration/microservices/e2e/sum-redis.spec.ts
@@ -1,5 +1,5 @@
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import { expect } from 'chai';
 import * as request from 'supertest';
@@ -17,10 +17,11 @@ describe('REDIS transport', () => {
     app = module.createNestApplication();
     server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.REDIS,
       options: {
-        url: 'redis://0.0.0.0:6379',
+        host: '0.0.0.0',
+        port: 6379,
       },
     });
     await app.startAllMicroservices();
diff --git a/integration/microservices/e2e/sum-rmq.spec.ts b/integration/microservices/e2e/sum-rmq.spec.ts
index 97ac90749..0d23de554 100644
--- a/integration/microservices/e2e/sum-rmq.spec.ts
+++ b/integration/microservices/e2e/sum-rmq.spec.ts
@@ -1,5 +1,5 @@
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import { expect } from 'chai';
 import * as request from 'supertest';
@@ -17,7 +17,7 @@ describe('RabbitMQ transport', () => {
     app = module.createNestApplication();
     server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.RMQ,
       options: {
         urls: [`amqp://0.0.0.0:5672`],
diff --git a/integration/microservices/e2e/sum-rpc-tls.spec.ts b/integration/microservices/e2e/sum-rpc-tls.spec.ts
new file mode 100644
index 000000000..e32a726df
--- /dev/null
+++ b/integration/microservices/e2e/sum-rpc-tls.spec.ts
@@ -0,0 +1,142 @@
+import { INestApplication } from '@nestjs/common';
+import { Transport } from '@nestjs/microservices';
+import { Test } from '@nestjs/testing';
+import { expect } from 'chai';
+import * as request from 'supertest';
+import { AppController } from '../src/tcp-tls/app.controller';
+import { ApplicationModule } from '../src/tcp-tls/app.module';
+import * as fs from 'fs';
+import * as path from 'path';
+
+describe('RPC TLS transport', () => {
+  let server;
+  let app: INestApplication;
+  let key: string;
+  let cert: string;
+
+  before(() => {
+    // Generate a self-signed key pair
+    key = fs
+      .readFileSync(path.join(__dirname, '../src/tcp-tls/privkey.pem'), 'utf8')
+      .toString();
+    cert = fs
+      .readFileSync(path.join(__dirname, '../src/tcp-tls/ca.cert.pem'), 'utf8')
+      .toString();
+  });
+
+  beforeEach(async () => {
+    const module = await Test.createTestingModule({
+      imports: [ApplicationModule],
+    }).compile();
+
+    app = module.createNestApplication();
+    server = app.getHttpAdapter().getInstance();
+
+    app.connectMicroservice({
+      transport: Transport.TCP,
+      options: {
+        host: '0.0.0.0',
+        tlsOptions: { key: key, cert: cert },
+      },
+    });
+    await app.startAllMicroservices();
+    await app.init();
+  });
+
+  it(`/POST TLS`, () => {
+    return request(server)
+      .post('/?command=sum')
+      .send([1, 2, 3, 4, 5])
+      .expect(200, '15');
+  });
+
+  it(`/POST (Promise/async)`, () => {
+    return request(server)
+      .post('/?command=asyncSum')
+      .send([1, 2, 3, 4, 5])
+      .expect(200)
+      .expect(200, '15');
+  });
+
+  it(`/POST (Observable stream)`, () => {
+    return request(server)
+      .post('/?command=streamSum')
+      .send([1, 2, 3, 4, 5])
+      .expect(200, '15');
+  });
+
+  it(`/POST (useFactory client)`, () => {
+    return request(server)
+      .post('/useFactory?command=sum')
+      .send([1, 2, 3, 4, 5])
+      .expect(200, '15');
+  });
+
+  it(`/POST (useClass client)`, () => {
+    return request(server)
+      .post('/useClass?command=sum')
+      .send([1, 2, 3, 4, 5])
+      .expect(200, '15');
+  });
+
+  it(`/POST (concurrent)`, () => {
+    return request(server)
+      .post('/concurrent')
+      .send([
+        Array.from({ length: 10 }, (v, k) => k + 1),
+        Array.from({ length: 10 }, (v, k) => k + 11),
+        Array.from({ length: 10 }, (v, k) => k + 21),
+        Array.from({ length: 10 }, (v, k) => k + 31),
+        Array.from({ length: 10 }, (v, k) => k + 41),
+        Array.from({ length: 10 }, (v, k) => k + 51),
+        Array.from({ length: 10 }, (v, k) => k + 61),
+        Array.from({ length: 10 }, (v, k) => k + 71),
+        Array.from({ length: 10 }, (v, k) => k + 81),
+        Array.from({ length: 10 }, (v, k) => k + 91),
+      ])
+      .expect(200, 'true');
+  });
+
+  it(`/POST (streaming)`, () => {
+    return request(server)
+      .post('/stream')
+      .send([1, 2, 3, 4, 5])
+      .expect(200, '15');
+  });
+
+  it(`/POST (pattern not found)`, () => {
+    return request(server).post('/?command=test').expect(500);
+  });
+
+  it(`/POST (event notification)`, done => {
+    request(server)
+      .post('/notify')
+      .send([1, 2, 3, 4, 5])
+      .end(() => {
+        setTimeout(() => {
+          expect(AppController.IS_NOTIFIED).to.be.true;
+          done();
+        }, 1000);
+      });
+  });
+
+  it('/POST (custom client)', () => {
+    return request(server)
+      .post('/error?client=custom')
+      .send({})
+      .expect(200)
+      .expect('true');
+  });
+
+  it('/POST (standard client)', () => {
+    return request(server)
+      .post('/error?client=standard')
+      .send({})
+      .expect(200)
+      .expect('false');
+  });
+
+  afterEach(async () => {
+    await app.close();
+  });
+});
diff --git a/integration/microservices/e2e/sum-rpc.spec.ts b/integration/microservices/e2e/sum-rpc.spec.ts
index 54a9bc360..648d7a117 100644
--- a/integration/microservices/e2e/sum-rpc.spec.ts
+++ b/integration/microservices/e2e/sum-rpc.spec.ts
@@ -1,5 +1,5 @@
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import { expect } from 'chai';
 import * as request from 'supertest';
@@ -18,7 +18,7 @@ describe('RPC transport', () => {
     app = module.createNestApplication();
     server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.TCP,
       options: {
         host: '0.0.0.0',
diff --git a/integration/microservices/src/tcp-tls/app.controller.ts b/integration/microservices/src/tcp-tls/app.controller.ts
new file mode 100644
index 000000000..81101741f
--- /dev/null
+++ b/integration/microservices/src/tcp-tls/app.controller.ts
@@ -0,0 +1,141 @@
+import {
+  Body,
+  Controller,
+  HttpCode,
+  Inject,
+  Post,
+  Query,
+} from '@nestjs/common';
+import {
+  Client,
+  ClientProxy,
+  EventPattern,
+  MessagePattern,
+  RpcException,
+  Transport,
+} from '@nestjs/microservices';
+import { from, lastValueFrom, Observable, of, throwError } from 'rxjs';
+import { catchError, scan } from 'rxjs/operators';
+import * as fs from 'fs';
+import * as path from 'path';
+
+@Controller()
+export class AppController {
+  constructor(
+    @Inject('USE_CLASS_CLIENT') private useClassClient: ClientProxy,
+    @Inject('USE_FACTORY_CLIENT') private useFactoryClient: ClientProxy,
+    @Inject('CUSTOM_PROXY_CLIENT') private customClient: ClientProxy,
+  ) {}
+  static IS_NOTIFIED = false;
+
+  @Client({
+    transport: Transport.TCP,
+    options: {
+      tlsOptions: {
+        ca: [
+          fs
+            .readFileSync(path.join(__dirname, 'ca.cert.pem'), 'utf-8')
+            .toString(),
+        ],
+      },
+    },
+  })
+  client: ClientProxy;
+
+  @Post()
+  @HttpCode(200)
+  call(@Query('command') cmd, @Body() data: number[]): Observable<number> {
+    return this.client.send<number>({ cmd }, data);
+  }
+
+  @Post('useFactory')
+  @HttpCode(200)
+  callWithClientUseFactory(
+    @Query('command') cmd,
+    @Body() data: number[],
+  ): Observable<number> {
+    return this.useFactoryClient.send<number>({ cmd }, data);
+  }
+
+  @Post('useClass')
+  @HttpCode(200)
+  callWithClientUseClass(
+    @Query('command') cmd,
+    @Body() data: number[],
+  ): Observable<number> {
+    return this.useClassClient.send<number>({ cmd }, data);
+  }
+
+  @Post('stream')
+  @HttpCode(200)
+  stream(@Body() data: number[]): Observable<number> {
+    return this.client
+      .send<number>({ cmd: 'streaming' }, data)
+      .pipe(scan((a, b) => a + b));
+  }
+
+  @Post('concurrent')
+  @HttpCode(200)
+  concurrent(@Body() data: number[][]): Promise<boolean> {
+    const send = async (tab: number[]) => {
+      const expected = tab.reduce((a, b) => a + b);
+      const result = await lastValueFrom(
+        this.client.send<number>({ cmd: 'sum' }, tab),
+      );
+
+      return result === expected;
+    };
+    return data
+      .map(async tab => send(tab))
+      .reduce(async (a, b) => (await a) && b);
+  }
+
+  @Post('error')
+  @HttpCode(200)
+  serializeError(
+    @Query('client') query: 'custom' | 'standard' = 'standard',
+    @Body() body: Record<string, any>,
+  ): Observable<boolean> {
+    const client = query === 'custom' ? this.customClient : this.client;
+    return client.send({ cmd: 'err' }, {}).pipe(
+      catchError(err => {
+        return of(err instanceof RpcException);
+      }),
+    );
+  }
+
+  @MessagePattern({ cmd: 'sum' })
+  sum(data: number[]): number {
+    return (data || []).reduce((a, b) => a + b);
+  }
+
+  @MessagePattern({ cmd: 'asyncSum' })
+  async asyncSum(data: number[]): Promise<number> {
+    return (data || []).reduce((a, b) => a + b);
+  }
+
+  @MessagePattern({ cmd: 'streamSum' })
+  streamSum(data: number[]): Observable<number> {
+    return of((data || []).reduce((a, b) => a + b));
+  }
+
+  @MessagePattern({ cmd: 'streaming' })
+  streaming(data: number[]): Observable<number> {
+    return from(data);
+  }
+
+  @MessagePattern({ cmd: 'err' })
+  throwAnError() {
+    return throwError(() => new Error('err'));
+  }
+
+  @Post('notify')
+  async sendNotification(): Promise<any> {
+    return this.client.emit<number>('notification', true);
+  }
+
+  @EventPattern('notification')
+  eventHandler(data: boolean) {
+    AppController.IS_NOTIFIED = data;
+  }
+}
diff --git a/integration/microservices/src/tcp-tls/app.module.ts b/integration/microservices/src/tcp-tls/app.module.ts
new file mode 100644
index 000000000..79a167886
--- /dev/null
+++ b/integration/microservices/src/tcp-tls/app.module.ts
@@ -0,0 +1,90 @@
+import { Module, Injectable } from '@nestjs/common';
+import { AppController } from './app.controller';
+import {
+  ClientsModule,
+  Transport,
+  ClientsModuleOptionsFactory,
+  ClientOptions,
+  ClientTCP,
+  RpcException,
+} from '@nestjs/microservices';
+
+import * as fs from 'fs';
+import * as path from 'path';
+
+const caCert = fs.readFileSync(path.join(__dirname, 'ca.cert.pem')).toString();
+
+class ErrorHandlingProxy extends ClientTCP {
+  constructor() {
+    super({
+      tlsOptions: { ca: caCert },
+    });
+  }
+
+  serializeError(err) {
+    return new RpcException(err);
+  }
+}
+
+@Injectable()
+class ConfigService {
+  private readonly config = {
+    transport: Transport.TCP,
+  };
+  get(key: string, defaultValue?: any) {
+    return this.config[key] || defaultValue;
+  }
+}
+
+@Module({
+  providers: [ConfigService],
+  exports: [ConfigService],
+})
+class ConfigModule {}
+
+@Injectable()
+class ClientOptionService implements ClientsModuleOptionsFactory {
+  constructor(private readonly configService: ConfigService) {}
+  createClientOptions(): Promise<ClientOptions> | ClientOptions {
+    return {
+      transport: this.configService.get('transport'),
+      options: {
+        tlsOptions: { ca: caCert },
+      },
+    };
+  }
+}
+
+@Module({
+  imports: [
+    ClientsModule.registerAsync([
+      {
+        imports: [ConfigModule],
+        name: 'USE_FACTORY_CLIENT',
+        useFactory: (configService: ConfigService) => ({
+          transport: configService.get('transport'),
+          options: {
+            tlsOptions: { ca: caCert },
+          },
+        }),
+        inject: [ConfigService],
+      },
+      {
+        imports: [ConfigModule],
+        name: 'USE_CLASS_CLIENT',
+        useClass: ClientOptionService,
+        inject: [ConfigService],
+      },
+      {
+        imports: [ConfigModule],
+        inject: [ConfigService],
+        name: 'CUSTOM_PROXY_CLIENT',
+        useFactory: (config: ConfigService) => ({
+          customClass: ErrorHandlingProxy,
+        }),
+      },
+    ]),
+  ],
+  controllers: [AppController],
+})
+export class ApplicationModule {}
diff --git a/integration/microservices/src/tcp-tls/ca.cert.pem b/integration/microservices/src/tcp-tls/ca.cert.pem
new file mode 100644
index 000000000..dbc7d8a77
--- /dev/null
+++ b/integration/microservices/src/tcp-tls/ca.cert.pem
@@ -0,0 +1,17 @@
+-----BEGIN CERTIFICATE-----
+MIICpDCCAYwCCQCyP27z3r0PFjANBgkqhkiG9w0BAQsFADAUMRIwEAYDVQQDDAls
+b2NhbGhvc3QwHhcNMjIxMjAyMDQ0NTQ1WhcNMzIxMTI5MDQ0NTQ1WjAUMRIwEAYD
+VQQDDAlsb2NhbGhvc3QwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDZ
+1IdZZXqrwXql4AIOJnlfpoGKOKoIalnK7KaKHTsq1QOF8z2abFuNBVIIrO0etQ/0
+PPAaFGkXl6HHBuA5PrFpsw3V1wSnNs1Cns9NhvypHI2V71lkwBJrEaSicNWL2AOE
+QkQ9cZ4YsTGd0BrM8D5VvgXdrC7gOXfj7Hx3E4K+wFO/Gi4AUXl5CXxleSFcW4U+
+jFulfq/DE8rBZXs29IsGeVkkgUoICjQ4Ey4zE6EY7f3SPKgU8gfgzYyGSd/ZZ/E7
+6M2yakEUX448Nl4BeuNWroBHVm1pSiMo+Cm1g34pJScPrx1yw6qquziCc/2n1M6O
+B4WGIZAmJDWnAOEjjrxFAgMBAAEwDQYJKoZIhvcNAQELBQADggEBAABGByZZUjaq
+ZygICSH2qUGHPPIyrfaCe0qM7de6kYfxxPYQQZb0HDynzv780Lq1002XeT02fNR+
+5sBCVFuKvS8BNvTq6kHzO1FiWIk/E5fQcYNToYSeEcXgWFLhJMty7+R6sIc9y8PH
+2YNehf78Jjm9ukM52sLc4+JWl7AEeqPrOHZdh/ve8M2gTfimFKTrW5cEAVPIOPhp
+2t5BdDKt8ZxgrGC7iRxga+v80VUOHRGfrd3hf3NlDQZO8upVGY8DdJhPRDB72+R0
+kzJ7eyQwlGXM20atiFxPk43h0f273MneIJG8NgGiVU0ND4XnZkAB3KSAu7pB+nEw
+QRYMYDgo/8Q=
+-----END CERTIFICATE-----
diff --git a/integration/microservices/src/tcp-tls/privkey.pem b/integration/microservices/src/tcp-tls/privkey.pem
new file mode 100644
index 000000000..f8a90acff
--- /dev/null
+++ b/integration/microservices/src/tcp-tls/privkey.pem
@@ -0,0 +1,28 @@
+-----BEGIN PRIVATE KEY-----
+MIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQDZ1IdZZXqrwXql
+4AIOJnlfpoGKOKoIalnK7KaKHTsq1QOF8z2abFuNBVIIrO0etQ/0PPAaFGkXl6HH
+BuA5PrFpsw3V1wSnNs1Cns9NhvypHI2V71lkwBJrEaSicNWL2AOEQkQ9cZ4YsTGd
+0BrM8D5VvgXdrC7gOXfj7Hx3E4K+wFO/Gi4AUXl5CXxleSFcW4U+jFulfq/DE8rB
+ZXs29IsGeVkkgUoICjQ4Ey4zE6EY7f3SPKgU8gfgzYyGSd/ZZ/E76M2yakEUX448
+Nl4BeuNWroBHVm1pSiMo+Cm1g34pJScPrx1yw6qquziCc/2n1M6OB4WGIZAmJDWn
+AOEjjrxFAgMBAAECggEANUKZtWnyjHxKGLSkzADsPE7h7YHdUSFvwwYJ0ktDZD2h
+FudacJ994wUiAa0GbTOoKvebXUUQTQxuKdOsj1Kc3lNBVr+0C46CsX9TAIm4zUCF
+/dr/6HpuBm/R6UXdcMvoUDZDqSJWnYL1trhjVSiIlT5ZANJQw9JJVhlEdXj3xtuc
+I9aC+33f9hKO1wzei/mTjIRGyRIeKselZPpA7qJnE4s3hmZxnO/rSqyPIvh1XLfZ
+3Eoyyg+xNpTZ8JqlHB5d7hDSnj8cjboa7IYpHJDXN3r8Aui+R9e/sQkezHbF7fR0
+xHpBVYQvGMuqSnTBkdJfq4qPAR1K49UrpEXB2GHaIQKBgQDs3t/ZUA138AiPIeLd
+aTsEPhf5dWEZynfNvXZ0VcoSr8ckaiaq9OEllprAriYWj+XphTDsBUAh/R7KlOR4
+eb+m6OwH7LseGiLIEr54GGP0LzVXAkfH2/uR1cak8qAmHB00jNEg7sj0eVAsHO3f
+WQm67f+RNP/IgAa+V8JKIkgTwwKBgQDrbAH8eAQsq9rjpxcic1EUI7uFHzr+cKf/
+4Y8ThLUNAzNfAbQWRBYjS1R8GM79Wiuh+WT1ooHKLryuLF7LVukvKHJ5GiNFBmaO
+llf72Zf1y4tBE2RCXQbf6h8+ohSDC/hwYy+w20/i2KzSBKkS0+gQuAX/HzfTpRd3
+q3/uEniXVwKBgDNnElDIbIPQlSrqgZ7mzSXYi79Y15+PLnx5VxFb5KQ1fRPL7WRA
+C/PqQN77a8yNoakRfFJbuVUm5t2zffkfApYoCcCWgOzBYzbjym2pbVd6PysIlacr
+d+Zn69mzxUk/5J6YyHFLIFTdVqacCIrleZUVPNa4F6HdFpmL1d/cnKOdAoGAMDuB
+sKsaF9jh0LBkEf/URa8IdT6vxH9qPAeHW7VdrpvQQ4/CyKkMbBC772zZw5hcxiOl
+Zpnzw2uN5pVamohk3++GfH85aKPmESKGRigPdSFNl3iUmvAaP3flDN0CHNMwBD6d
+/7r/A/fmeGTSCvR1YC+DswA/XNI/G5p8bFdGc6MCgYBd9oQiZlkYMiDGPUAjx+DO
+kqtAmc8DLJEanSbWdIxL2bGL04cgBRPssM4m0UScx4PucvqWEPdN/5Ug0z5TrD77
+2K5nZSBUdy4DunBImz1NHRQEiytkrYX0LesGr02QlzIH4wmwb1TFu7rLkr6KfNuV
+xqWi+JVY8N4vuHAxCeEALw==
+-----END PRIVATE KEY-----
\ No newline at end of file
diff --git a/integration/microservices/tsconfig.json b/integration/microservices/tsconfig.json
index c6354c564..cef623d14 100644
--- a/integration/microservices/tsconfig.json
+++ b/integration/microservices/tsconfig.json
@@ -7,10 +7,28 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
diff --git a/integration/module-utils/tsconfig.json b/integration/module-utils/tsconfig.json
index c6354c564..cef623d14 100644
--- a/integration/module-utils/tsconfig.json
+++ b/integration/module-utils/tsconfig.json
@@ -7,10 +7,28 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
diff --git a/integration/mongoose/tsconfig.json b/integration/mongoose/tsconfig.json
index ea15af490..cef623d14 100644
--- a/integration/mongoose/tsconfig.json
+++ b/integration/mongoose/tsconfig.json
@@ -7,16 +7,34 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
-    "src/**/*"
+    "src/**/*",
+    "e2e/**/*"
   ],
   "exclude": [
     "node_modules",
-    "**/*.spec.ts"
   ]
 }
\ No newline at end of file
diff --git a/integration/nest-application/app-locals/tsconfig.json b/integration/nest-application/app-locals/tsconfig.json
index 2a0adf369..c3692649c 100644
--- a/integration/nest-application/app-locals/tsconfig.json
+++ b/integration/nest-application/app-locals/tsconfig.json
@@ -7,16 +7,34 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../../packages/common"],
+      "@nestjs/common/*": ["../../../packages/common/*"],
+      "@nestjs/core": ["../../../packages/core"],
+      "@nestjs/core/*": ["../../../packages/core/*"],
+      "@nestjs/microservices": ["../../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../../packages/websockets/*"],
+      "@nestjs/testing": ["../../../packages/websockets"],
+      "@nestjs/testing/*": ["../../../packages/websockets/*"],
+      "@nestjs/platform-express": ["../../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
     "e2e/**/*"
   ],
   "exclude": [
-    "node_modules"
+    "node_modules",
   ]
 }
\ No newline at end of file
diff --git a/integration/nest-application/get-url/tsconfig.json b/integration/nest-application/get-url/tsconfig.json
index 2a0adf369..c3692649c 100644
--- a/integration/nest-application/get-url/tsconfig.json
+++ b/integration/nest-application/get-url/tsconfig.json
@@ -7,16 +7,34 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../../packages/common"],
+      "@nestjs/common/*": ["../../../packages/common/*"],
+      "@nestjs/core": ["../../../packages/core"],
+      "@nestjs/core/*": ["../../../packages/core/*"],
+      "@nestjs/microservices": ["../../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../../packages/websockets/*"],
+      "@nestjs/testing": ["../../../packages/websockets"],
+      "@nestjs/testing/*": ["../../../packages/websockets/*"],
+      "@nestjs/platform-express": ["../../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
     "e2e/**/*"
   ],
   "exclude": [
-    "node_modules"
+    "node_modules",
   ]
 }
\ No newline at end of file
diff --git a/integration/nest-application/global-prefix/e2e/global-prefix.spec.ts b/integration/nest-application/global-prefix/e2e/global-prefix.spec.ts
index 131d2dd03..74f8e9ad6 100644
--- a/integration/nest-application/global-prefix/e2e/global-prefix.spec.ts
+++ b/integration/nest-application/global-prefix/e2e/global-prefix.spec.ts
@@ -119,6 +119,17 @@ describe('Global prefix', () => {
     await request(server).get('/api/v1/middleware/foo').expect(404);
   });
 
+  it(`should get the params in the global prefix`, async () => {
+    app.setGlobalPrefix('/api/:tenantId');
+
+    server = app.getHttpServer();
+    await app.init();
+
+    await request(server)
+      .get('/api/test/params')
+      .expect(200, { '0': 'params', tenantId: 'test' });
+  });
+
   afterEach(async () => {
     await app.close();
   });
diff --git a/integration/nest-application/global-prefix/src/app.controller.ts b/integration/nest-application/global-prefix/src/app.controller.ts
index 912c0d76c..d826cd0db 100644
--- a/integration/nest-application/global-prefix/src/app.controller.ts
+++ b/integration/nest-application/global-prefix/src/app.controller.ts
@@ -7,6 +7,11 @@ export class AppController {
     return 'Hello: ' + req.extras?.data;
   }
 
+  @Get('params')
+  getParams(@Req() req): any {
+    return req.middlewareParams;
+  }
+
   @Get('health')
   getHealth(): string {
     return 'up';
diff --git a/integration/nest-application/global-prefix/src/app.module.ts b/integration/nest-application/global-prefix/src/app.module.ts
index 85d1e6ac4..f182915c4 100644
--- a/integration/nest-application/global-prefix/src/app.module.ts
+++ b/integration/nest-application/global-prefix/src/app.module.ts
@@ -22,6 +22,11 @@ export class AppModule {
         req.extras = { data: 'Data attached in middleware' };
         next();
       })
+      .forRoutes({ path: '*', method: RequestMethod.GET })
+      .apply((req, res, next) => {
+        req.middlewareParams = req.params;
+        next();
+      })
       .forRoutes({ path: '*', method: RequestMethod.GET });
   }
 }
diff --git a/integration/nest-application/global-prefix/tsconfig.json b/integration/nest-application/global-prefix/tsconfig.json
index 2a0adf369..c3692649c 100644
--- a/integration/nest-application/global-prefix/tsconfig.json
+++ b/integration/nest-application/global-prefix/tsconfig.json
@@ -7,16 +7,34 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../../packages/common"],
+      "@nestjs/common/*": ["../../../packages/common/*"],
+      "@nestjs/core": ["../../../packages/core"],
+      "@nestjs/core/*": ["../../../packages/core/*"],
+      "@nestjs/microservices": ["../../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../../packages/websockets/*"],
+      "@nestjs/testing": ["../../../packages/websockets"],
+      "@nestjs/testing/*": ["../../../packages/websockets/*"],
+      "@nestjs/platform-express": ["../../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
     "e2e/**/*"
   ],
   "exclude": [
-    "node_modules"
+    "node_modules",
   ]
 }
\ No newline at end of file
diff --git a/integration/nest-application/raw-body/tsconfig.json b/integration/nest-application/raw-body/tsconfig.json
index 2a0adf369..c3692649c 100644
--- a/integration/nest-application/raw-body/tsconfig.json
+++ b/integration/nest-application/raw-body/tsconfig.json
@@ -7,16 +7,34 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../../packages/common"],
+      "@nestjs/common/*": ["../../../packages/common/*"],
+      "@nestjs/core": ["../../../packages/core"],
+      "@nestjs/core/*": ["../../../packages/core/*"],
+      "@nestjs/microservices": ["../../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../../packages/websockets/*"],
+      "@nestjs/testing": ["../../../packages/websockets"],
+      "@nestjs/testing/*": ["../../../packages/websockets/*"],
+      "@nestjs/platform-express": ["../../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
     "e2e/**/*"
   ],
   "exclude": [
-    "node_modules"
+    "node_modules",
   ]
 }
\ No newline at end of file
diff --git a/integration/nest-application/sse/tsconfig.json b/integration/nest-application/sse/tsconfig.json
index 261f9bff2..261e01453 100644
--- a/integration/nest-application/sse/tsconfig.json
+++ b/integration/nest-application/sse/tsconfig.json
@@ -4,20 +4,38 @@
     "declaration": false,
     "noImplicitAny": false,
     "removeComments": true,
-    "lib": ["dom"],
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "lib": ["dom"],
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../../packages/common"],
+      "@nestjs/common/*": ["../../../packages/common/*"],
+      "@nestjs/core": ["../../../packages/core"],
+      "@nestjs/core/*": ["../../../packages/core/*"],
+      "@nestjs/microservices": ["../../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../../packages/websockets/*"],
+      "@nestjs/testing": ["../../../packages/websockets"],
+      "@nestjs/testing/*": ["../../../packages/websockets/*"],
+      "@nestjs/platform-express": ["../../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
     "e2e/**/*"
   ],
   "exclude": [
-    "node_modules"
+    "node_modules",
   ]
-}
+}
\ No newline at end of file
diff --git a/integration/nest-application/use-body-parser/e2e/express.spec.ts b/integration/nest-application/use-body-parser/e2e/express.spec.ts
new file mode 100644
index 000000000..06e77086d
--- /dev/null
+++ b/integration/nest-application/use-body-parser/e2e/express.spec.ts
@@ -0,0 +1,95 @@
+import { NestExpressApplication } from '@nestjs/platform-express';
+import { Test } from '@nestjs/testing';
+import { OptionsUrlencoded } from 'body-parser';
+import { expect } from 'chai';
+import * as request from 'supertest';
+import { AppModule } from '../src/app.module';
+
+describe('Body Parser (Express Application)', () => {
+  const moduleFixture = Test.createTestingModule({
+    imports: [AppModule],
+  });
+  let app: NestExpressApplication;
+
+  afterEach(async () => {
+    await app.close();
+  });
+
+  describe('application/json', () => {
+    const stringLimit = '{ "msg": "Hello, World" }';
+    const stringOverLimit = '{ "msg": "Hello, World!" }';
+
+    beforeEach(async () => {
+      const testFixture = await moduleFixture.compile();
+
+      app = testFixture
+        .createNestApplication<NestExpressApplication>({
+          rawBody: true,
+          logger: false,
+        })
+        .useBodyParser('json', { limit: Buffer.from(stringLimit).byteLength });
+
+      await app.init();
+    });
+
+    it('should allow request with matching body limit', async () => {
+      const response = await request(app.getHttpServer())
+        .post('/')
+        .set('Content-Type', 'application/json')
+        .send(stringLimit)
+        .expect(201);
+
+      expect(response.body).to.eql({
+        raw: stringLimit,
+      });
+    });
+
+    it('should fail if post body is larger than limit', async () => {
+      await request(app.getHttpServer())
+        .post('/')
+        .set('Content-Type', 'application/json')
+        .send(stringOverLimit)
+        .expect(413);
+    });
+  });
+
+  describe('application/x-www-form-urlencoded', () => {
+    const stringLimit = 'msg=Hello, World';
+    const stringOverLimit = 'msg=Hello, World!';
+
+    beforeEach(async () => {
+      const testFixture = await moduleFixture.compile();
+
+      app = testFixture
+        .createNestApplication<NestExpressApplication>({
+          rawBody: true,
+          logger: false,
+        })
+        .useBodyParser<OptionsUrlencoded>('urlencoded', {
+          limit: Buffer.from(stringLimit).byteLength,
+          extended: true,
+        });
+
+      await app.init();
+    });
+    it('should allow request with matching body limit', async () => {
+      const response = await request(app.getHttpServer())
+        .post('/')
+        .set('Content-Type', 'application/x-www-form-urlencoded')
+        .send(stringLimit)
+        .expect(201);
+
+      expect(response.body).to.eql({
+        raw: stringLimit,
+      });
+    });
+
+    it('should fail if post body is larger than limit', async () => {
+      await request(app.getHttpServer())
+        .post('/')
+        .set('Content-Type', 'application/x-www-form-urlencoded')
+        .send(stringOverLimit)
+        .expect(413);
+    });
+  });
+});
diff --git a/integration/nest-application/use-body-parser/e2e/fastify.spec.ts b/integration/nest-application/use-body-parser/e2e/fastify.spec.ts
new file mode 100644
index 000000000..26a9240d2
--- /dev/null
+++ b/integration/nest-application/use-body-parser/e2e/fastify.spec.ts
@@ -0,0 +1,106 @@
+import {
+  FastifyAdapter,
+  NestFastifyApplication,
+} from '@nestjs/platform-fastify';
+import { Test } from '@nestjs/testing';
+import { expect } from 'chai';
+import { AppModule } from '../src/app.module';
+
+describe('Body Parser (Fastify Application)', () => {
+  const moduleFixture = Test.createTestingModule({
+    imports: [AppModule],
+  });
+  let app: NestFastifyApplication;
+
+  afterEach(async () => {
+    await app.close();
+  });
+
+  describe('application/json', () => {
+    const stringLimit = '{ "msg": "Hello, World" }';
+    const stringOverLimit = '{ "msg": "Hello, World!" }';
+
+    beforeEach(async () => {
+      const testFixture = await moduleFixture.compile();
+
+      app = testFixture
+        .createNestApplication<NestFastifyApplication>(new FastifyAdapter(), {
+          rawBody: true,
+          logger: false,
+        })
+        .useBodyParser('application/json', {
+          bodyLimit: Buffer.from(stringLimit).byteLength,
+        });
+
+      await app.init();
+    });
+
+    it('should allow request with matching body limit', async () => {
+      const response = await app.inject({
+        method: 'POST',
+        url: '/',
+        headers: { 'content-type': 'application/json' },
+        payload: stringLimit,
+      });
+
+      expect(JSON.parse(response.body)).to.eql({
+        raw: stringLimit,
+      });
+    });
+
+    it('should fail if post body is larger than limit', async () => {
+      const response = await app.inject({
+        method: 'POST',
+        url: '/',
+        headers: { 'content-type': 'application/json' },
+        payload: stringOverLimit,
+      });
+
+      expect(response.statusCode).to.equal(413);
+    });
+  });
+
+  describe('application/x-www-form-urlencoded', () => {
+    const stringLimit = 'msg=Hello, World';
+    const stringOverLimit = 'msg=Hello, World!';
+
+    beforeEach(async () => {
+      const testFixture = await moduleFixture.compile();
+
+      app = testFixture
+        .createNestApplication<NestFastifyApplication>(new FastifyAdapter(), {
+          rawBody: true,
+          logger: false,
+        })
+        .useBodyParser('application/x-www-form-urlencoded', {
+          bodyLimit: Buffer.from(stringLimit).byteLength,
+        });
+
+      await app.init();
+    });
+
+    it('should allow request with matching body limit', async () => {
+      const response = await app.inject({
+        method: 'POST',
+        url: '/',
+        headers: { 'content-type': 'application/x-www-form-urlencoded' },
+        payload: stringLimit,
+      });
+
+      expect(JSON.parse(response.body)).to.eql({
+        raw: stringLimit,
+      });
+    });
+
+    it('should fail if post body is larger than limit', async () => {
+      const response = await app.inject({
+        method: 'POST',
+        url: '/',
+        headers: { 'content-type': 'application/x-www-form-urlencoded' },
+        payload: stringOverLimit,
+      });
+
+      expect(response.statusCode).to.equal(413);
+    });
+  });
+});
diff --git a/integration/nest-application/use-body-parser/src/app.controller.ts b/integration/nest-application/use-body-parser/src/app.controller.ts
new file mode 100644
index 000000000..8c110580c
--- /dev/null
+++ b/integration/nest-application/use-body-parser/src/app.controller.ts
@@ -0,0 +1,12 @@
+import { Controller, Post, Req, RawBodyRequest } from '@nestjs/common';
+import { IncomingMessage } from 'http';
+
+@Controller()
+export class AppController {
+  @Post()
+  index(@Req() req: RawBodyRequest<IncomingMessage>) {
+    return {
+      raw: req.rawBody?.toString(),
+    };
+  }
+}
diff --git a/integration/nest-application/use-body-parser/src/app.module.ts b/integration/nest-application/use-body-parser/src/app.module.ts
new file mode 100644
index 000000000..848d4aaa7
--- /dev/null
+++ b/integration/nest-application/use-body-parser/src/app.module.ts
@@ -0,0 +1,7 @@
+import { Module } from '@nestjs/common';
+import { AppController } from './app.controller';
+
+@Module({
+  controllers: [AppController],
+})
+export class AppModule {}
diff --git a/integration/cache/src/multi-store/tsconfig.json b/integration/nest-application/use-body-parser/tsconfig.json
similarity index 85%
rename from integration/cache/src/multi-store/tsconfig.json
rename to integration/nest-application/use-body-parser/tsconfig.json
index 567a5c9e6..999ab15b7 100644
--- a/integration/cache/src/multi-store/tsconfig.json
+++ b/integration/nest-application/use-body-parser/tsconfig.json
@@ -4,10 +4,11 @@
     "declaration": false,
     "noImplicitAny": false,
     "removeComments": true,
+    "lib": ["dom"],
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
     "outDir": "./dist"
@@ -17,6 +18,6 @@
     "e2e/**/*"
   ],
   "exclude": [
-    "node_modules",
+    "node_modules"
   ]
 }
diff --git a/integration/repl/tsconfig.json b/integration/repl/tsconfig.json
index ea15af490..cef623d14 100644
--- a/integration/repl/tsconfig.json
+++ b/integration/repl/tsconfig.json
@@ -7,16 +7,34 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
-    "src/**/*"
+    "src/**/*",
+    "e2e/**/*"
   ],
   "exclude": [
     "node_modules",
-    "**/*.spec.ts"
   ]
 }
\ No newline at end of file
diff --git a/integration/scopes/e2e/msvc-request-scope.spec.ts b/integration/scopes/e2e/msvc-request-scope.spec.ts
index b6273c33d..7a6b6d649 100644
--- a/integration/scopes/e2e/msvc-request-scope.spec.ts
+++ b/integration/scopes/e2e/msvc-request-scope.spec.ts
@@ -1,5 +1,5 @@
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import { expect } from 'chai';
 import * as request from 'supertest';
@@ -31,7 +31,7 @@ describe('Request scope (microservices)', () => {
     }).compile();
 
     app = module.createNestApplication();
-    app.connectMicroservice({ transport: Transport.TCP });
+    app.connectMicroservice<MicroserviceOptions>({ transport: Transport.TCP });
 
     server = app.getHttpServer();
     await app.init();
diff --git a/integration/scopes/src/durable/durable.guard.ts b/integration/scopes/src/durable/durable.guard.ts
new file mode 100644
index 000000000..8868af809
--- /dev/null
+++ b/integration/scopes/src/durable/durable.guard.ts
@@ -0,0 +1,21 @@
+import {
+  CanActivate,
+  ExecutionContext,
+  Injectable,
+  Scope,
+} from '@nestjs/common';
+import { DurableService } from './durable.service';
+
+@Injectable({ scope: Scope.REQUEST, durable: true })
+export class DurableGuard implements CanActivate {
+  public instanceCounter = 0;
+  constructor(private readonly durableService: DurableService) {}
+
+  public async canActivate(context: ExecutionContext): Promise<boolean> {
+    if (typeof this.durableService === 'undefined') {
+      throw new Error('Durable service is undefined');
+    }
+    this.instanceCounter++;
+    return true;
+  }
+}
diff --git a/integration/scopes/src/durable/durable.module.ts b/integration/scopes/src/durable/durable.module.ts
index ed312900f..d749135bd 100644
--- a/integration/scopes/src/durable/durable.module.ts
+++ b/integration/scopes/src/durable/durable.module.ts
@@ -1,9 +1,17 @@
 import { Module } from '@nestjs/common';
+import { APP_GUARD } from '@nestjs/core';
 import { DurableController } from './durable.controller';
+import { DurableGuard } from './durable.guard';
 import { DurableService } from './durable.service';
 
 @Module({
   controllers: [DurableController],
-  providers: [DurableService],
+  providers: [
+    DurableService,
+    {
+      provide: APP_GUARD,
+      useClass: DurableGuard,
+    },
+  ],
 })
 export class DurableModule {}
diff --git a/integration/scopes/tsconfig.json b/integration/scopes/tsconfig.json
index c6354c564..cef623d14 100644
--- a/integration/scopes/tsconfig.json
+++ b/integration/scopes/tsconfig.json
@@ -7,10 +7,28 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
diff --git a/integration/send-files/e2e/express.spec.ts b/integration/send-files/e2e/express.spec.ts
index cf78184c0..c0b8e5661 100644
--- a/integration/send-files/e2e/express.spec.ts
+++ b/integration/send-files/e2e/express.spec.ts
@@ -73,11 +73,15 @@ describe('Express FileSend', () => {
   it('should return an error if the file does not exist', async () => {
     return request(app.getHttpServer()).get('/file/not/exist').expect(400);
   });
-  it('should allow for the client to end the response and be able to make another', async () => {
-    await app.listen(0);
-    const url = await getHttpBaseOptions(app);
-    await sendCanceledHttpRequest(new URL('/file/slow', url));
-    const res = await sendHttpRequest(new URL('/file/stream', url));
-    expect(res.statusCode).to.be.eq(200);
-  }).timeout(5000);
+  // TODO: temporarily turned off (flaky test)
+  it.skip(
+    'should allow for the client to end the response and be able to make another',
+    async () => {
+      await app.listen(0);
+      const url = await getHttpBaseOptions(app);
+      await sendCanceledHttpRequest(new URL('/file/slow', url));
+      const res = await sendHttpRequest(new URL('/file/stream', url));
+      expect(res.statusCode).to.be.eq(200);
+    },
+  ).timeout(5000);
 });
diff --git a/integration/send-files/e2e/utils.ts b/integration/send-files/e2e/utils.ts
index 88d6759e4..bc2f1f7b6 100644
--- a/integration/send-files/e2e/utils.ts
+++ b/integration/send-files/e2e/utils.ts
@@ -32,7 +32,7 @@ export const sendHttpRequest = async (url: URL) => {
       res.on('data', chunk => {
         // no op
       });
-      // fail the test if somethin goes wrong
+      // fail the test if something goes wrong
       res.on('error', err => {
         reject(err);
       });
diff --git a/integration/send-files/tsconfig.json b/integration/send-files/tsconfig.json
index c6354c564..cef623d14 100644
--- a/integration/send-files/tsconfig.json
+++ b/integration/send-files/tsconfig.json
@@ -7,10 +7,28 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
diff --git a/integration/typeorm/tsconfig.json b/integration/typeorm/tsconfig.json
index ea15af490..cef623d14 100644
--- a/integration/typeorm/tsconfig.json
+++ b/integration/typeorm/tsconfig.json
@@ -7,16 +7,34 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
-    "src/**/*"
+    "src/**/*",
+    "e2e/**/*"
   ],
   "exclude": [
     "node_modules",
-    "**/*.spec.ts"
   ]
 }
\ No newline at end of file
diff --git a/integration/versioning/tsconfig.json b/integration/versioning/tsconfig.json
index c6354c564..cef623d14 100644
--- a/integration/versioning/tsconfig.json
+++ b/integration/versioning/tsconfig.json
@@ -7,10 +7,28 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
diff --git a/integration/websockets/tsconfig.json b/integration/websockets/tsconfig.json
index c6354c564..cef623d14 100644
--- a/integration/websockets/tsconfig.json
+++ b/integration/websockets/tsconfig.json
@@ -7,10 +7,28 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
diff --git a/lerna.json b/lerna.json
index 2a6998ba6..366cd366e 100644
--- a/lerna.json
+++ b/lerna.json
@@ -3,5 +3,5 @@
   "packages": [
     "packages/*"
   ],
-  "version": "9.2.0"
+  "version": "9.4.0"
 }
diff --git a/package-lock.json b/package-lock.json
index b5f967f64..b921af460 100644
Binary files a/package-lock.json and b/package-lock.json differ
diff --git a/package.json b/package.json
index 897ac74e4..5bd361702 100644
--- a/package.json
+++ b/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/core",
-  "version": "9.1.2",
+  "version": "9.4.0",
   "description": "Modern, fast, powerful node.js web framework",
   "homepage": "https://nestjs.com",
   "repository": {
@@ -14,19 +14,25 @@
   "license": "MIT",
   "author": "Kamil Mysliwiec",
   "scripts": {
-    "build": "gulp build --dist node_modules/@nestjs",
-    "postbuild": "gulp move",
-    "changelog": "lerna-changelog",
+    "build": "tsc -b -v packages",
+    "postbuild": "npm run move:node_modules",
+    "build:dev": "tsc -b -v packages --watch",
     "prebuild:prod": "npm run clean",
-    "build:prod": "gulp build",
-    "build:samples": "gulp install:samples && npm run build && gulp build:samples && gulp test:samples && gulp test:e2e:samples",
-    "clean": "gulp clean:bundle",
+    "build:prod": "tsc -b -v packages",
+    "changelog": "lerna-changelog",
+    "clean": "tsc -b --clean packages",
+    "move:samples": "gulp move:samples",
+    "move:node_modules": "gulp move:node_modules",
+    "build:samples": "gulp install:samples && npm run build && npm run move:samples && gulp build:samples && gulp test:samples && gulp test:e2e:samples",
     "codechecks:benchmarks": "codechecks ./tools/benchmarks/check-benchmarks.ts",
     "coverage": "nyc report --reporter=text-lcov | coveralls",
     "format": "prettier \"**/*.ts\" \"packages/**/*.json\" --ignore-path ./.prettierignore --write && git status",
     "postinstall": "opencollective",
-    "test": "nyc mocha packages/**/*.spec.ts --reporter spec",
-    "test:integration": "mocha \"integration/*/{,!(node_modules)/**/}/*.spec.ts\" --reporter spec",
+    "test": "mocha packages/**/*.spec.ts",
+    "test:dev": "mocha -w --watch-files \"packages\" packages/**/*.spec.ts",
+    "pretest:cov": "npm run clean",
+    "test:cov": "nyc mocha packages/**/*.spec.ts --reporter spec",
+    "test:integration": "mocha \"integration/*/{,!(node_modules)/**/}/*.spec.ts\"",
     "test:docker:up": "docker-compose -f integration/docker-compose.yml up -d",
     "test:docker:down": "docker-compose -f integration/docker-compose.yml down",
     "lint": "concurrently 'npm run lint:packages' 'npm run lint:integration' 'npm run lint:spec'",
@@ -34,7 +40,7 @@
     "lint:integration": "eslint 'integration/*/{,!(node_modules)/**/}/*.ts'",
     "lint:packages": "eslint 'packages/**/**.ts' --ignore-pattern 'packages/**/*.spec.ts'",
     "lint:spec": "eslint 'packages/**/**.spec.ts'",
-    "prerelease": "gulp copy-misc && gulp build --dist node_modules/@nestjs",
+    "prerelease": "gulp copy-misc",
     "publish": "npm run prerelease && npm run build:prod && ./node_modules/.bin/lerna publish --force-publish --access public --exact -m \"chore(@nestjs) publish %s release\"",
     "prepublishOnly": "npm run changelog | pbcopy",
     "publish:beta": "npm run prerelease && npm run build:prod && ./node_modules/.bin/lerna publish --npm-tag=beta --access public -m \"chore(@nestjs) publish %s release\"",
@@ -54,83 +60,80 @@
   "dependencies": {
     "@nuxtjs/opencollective": "0.3.2",
     "class-transformer": "0.5.1",
-    "class-validator": "0.13.2",
+    "class-validator": "0.14.0",
     "cli-color": "2.0.3",
     "cors": "2.8.5",
     "express": "4.18.2",
-    "fast-json-stringify": "5.4.0",
+    "fast-json-stringify": "5.7.0",
     "fast-safe-stringify": "2.1.1",
     "graphql-subscriptions": "2.0.0",
     "iterare": "1.2.1",
     "object-hash": "3.0.0",
     "path-to-regexp": "3.2.0",
     "reflect-metadata": "0.1.13",
-    "rxjs": "7.5.7",
-    "socket.io": "4.5.3",
-    "tslib": "2.4.1",
+    "rxjs": "7.8.0",
+    "socket.io": "4.6.1",
+    "tslib": "2.5.0",
+    "uid": "2.0.2",
     "uuid": "9.0.0"
   },
   "devDependencies": {
+    "@apollo/server": "4.6.0",
     "@codechecks/client": "0.1.12",
-    "@commitlint/cli": "17.2.0",
-    "@commitlint/config-angular": "17.2.0",
+    "@commitlint/cli": "17.5.1",
+    "@commitlint/config-angular": "17.4.4",
     "@fastify/cors": "^8.0.0",
-    "@fastify/formbody": "7.3.0",
-    "@fastify/middie": "8.0.0",
-    "@fastify/multipart": "7.3.0",
-    "@fastify/static": "6.5.0",
-    "@fastify/view": "7.1.2",
-    "@grpc/grpc-js": "1.7.3",
-    "@grpc/proto-loader": "0.7.3",
-    "@nestjs/apollo": "10.1.4",
-    "@nestjs/graphql": "10.1.5",
-    "@nestjs/mongoose": "9.2.1",
+    "@fastify/formbody": "7.4.0",
+    "@fastify/middie": "8.1.0",
+    "@fastify/multipart": "7.5.0",
+    "@fastify/static": "6.10.0",
+    "@fastify/view": "7.4.1",
+    "@grpc/grpc-js": "1.8.13",
+    "@grpc/proto-loader": "0.7.6",
+    "@nestjs/apollo": "11.0.4",
+    "@nestjs/graphql": "11.0.4",
+    "@nestjs/mongoose": "9.2.2",
     "@nestjs/typeorm": "9.0.1",
-    "@types/amqplib": "0.8.2",
+    "@types/amqplib": "0.10.1",
     "@types/bytes": "3.1.1",
-    "@types/cache-manager": "4.0.2",
-    "@types/chai": "4.3.3",
+    "@types/chai": "4.3.4",
     "@types/chai-as-promised": "7.1.5",
-    "@types/cors": "2.8.12",
-    "@types/express": "4.17.14",
-    "@types/gulp": "4.0.9",
+    "@types/cors": "2.8.13",
+    "@types/express": "4.17.17",
+    "@types/gulp": "4.0.10",
     "@types/http-errors": "2.0.1",
-    "@types/mocha": "10.0.0",
-    "@types/node": "18.11.9",
-    "@types/redis": "4.0.11",
-    "@types/reflect-metadata": "0.1.0",
+    "@types/mocha": "10.0.1",
+    "@types/node": "18.15.11",
     "@types/sinon": "10.0.13",
     "@types/supertest": "2.0.12",
-    "@types/ws": "8.5.3",
+    "@types/ws": "8.5.4",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
-    "amqp-connection-manager": "4.1.9",
+    "amqp-connection-manager": "4.1.12",
     "amqplib": "0.10.3",
-    "apollo-server-core": "3.11.1",
-    "apollo-server-express": "3.11.1",
     "artillery": "1.7.9",
-    "body-parser": "1.20.1",
+    "body-parser": "1.20.2",
     "bytes": "3.1.2",
-    "cache-manager": "5.1.3",
+    "cache-manager": "5.2.0",
     "cache-manager-redis-store": "3.0.1",
-    "chai": "4.3.6",
+    "chai": "4.3.7",
     "chai-as-promised": "7.1.1",
     "clang-format": "1.8.0",
     "commitlint-circle": "1.0.0",
-    "concurrently": "7.5.0",
+    "concurrently": "8.0.1",
     "conventional-changelog": "3.1.25",
-    "core-js": "3.26.0",
+    "core-js": "3.30.0",
     "coveralls": "3.1.1",
     "delete-empty": "3.0.0",
-    "engine.io-client": "6.2.3",
+    "engine.io-client": "6.4.0",
     "eslint": "7.32.0",
-    "eslint-config-prettier": "8.5.0",
-    "eslint-plugin-import": "2.26.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-import": "2.27.5",
     "eventsource": "2.0.2",
     "fancy-log": "2.0.0",
-    "fastify": "4.9.2",
-    "graphql": "15.8.0",
-    "graphql-tools": "8.3.10",
+    "fastify": "4.15.0",
+    "graphql": "16.6.0",
+    "graphql-tools": "8.3.19",
     "gulp": "4.0.2",
     "gulp-clang-format": "1.0.27",
     "gulp-clean": "0.4.0",
@@ -138,42 +141,42 @@
     "gulp-typescript": "5.0.1",
     "gulp-watch": "5.0.1",
     "http-errors": "2.0.0",
-    "husky": "8.0.1",
+    "husky": "8.0.3",
     "imports-loader": "4.0.1",
-    "ioredis": "5.2.4",
+    "ioredis": "5.3.1",
     "json-loader": "0.5.7",
-    "kafkajs": "2.2.2",
+    "kafkajs": "2.2.4",
     "lerna": "2.11.0",
     "lerna-changelog": "2.2.0",
-    "light-my-request": "5.6.1",
-    "lint-staged": "13.0.3",
+    "light-my-request": "5.9.1",
+    "lint-staged": "13.2.0",
     "markdown-table": "2.0.0",
     "merge-graphql-schemas": "1.7.8",
-    "mocha": "10.1.0",
-    "mongoose": "6.7.1",
+    "mocha": "10.2.0",
+    "mongoose": "7.0.3",
     "mqtt": "4.3.7",
     "multer": "1.4.4",
-    "mysql2": "2.3.3",
-    "nats": "2.9.0",
-    "nodemon": "2.0.20",
+    "mysql2": "3.2.0",
+    "nats": "2.13.1",
+    "nodemon": "2.0.22",
     "nyc": "15.1.0",
-    "prettier": "2.7.1",
-    "redis": "4.4.0",
+    "prettier": "2.8.7",
+    "redis": "4.6.5",
     "rxjs-compat": "6.6.7",
-    "sinon": "14.0.1",
+    "sinon": "15.0.3",
     "sinon-chai": "3.7.0",
-    "socket.io-client": "4.5.3",
+    "socket.io-client": "4.6.1",
     "subscriptions-transport-ws": "0.11.0",
-    "supertest": "6.3.1",
-    "ts-morph": "16.0.0",
+    "supertest": "6.3.3",
+    "ts-morph": "18.0.0",
     "ts-node": "10.9.1",
-    "typeorm": "0.3.10",
-    "typescript": "4.8.4",
+    "typeorm": "0.3.12",
+    "typescript": "5.0.3",
     "wrk": "1.2.1",
-    "ws": "8.11.0"
+    "ws": "8.13.0"
   },
   "engines": {
-    "node": ">= 12.9.0"
+    "node": ">= 16"
   },
   "collective": {
     "type": "opencollective",
@@ -197,20 +200,23 @@
       "packages/**/*.ts"
     ],
     "exclude": [
-      "packages/**/*.spec.ts",
+      "**/*.js",
+      "**/*.d.ts",
+      "**/*.spec.ts",
       "packages/**/adapters/*.ts",
       "packages/**/nest-*.ts",
       "packages/**/test/**/*.ts",
       "packages/core/errors/**/*",
       "packages/common/exceptions/*.ts",
-      "packages/common/http/*.ts",
       "packages/common/utils/load-package.util.ts",
       "packages/microservices/exceptions/",
       "packages/microservices/microservices-module.ts",
       "packages/core/middleware/middleware-module.ts",
+      "packages/core/discovery/discovery-service.ts",
       "packages/core/injector/module-ref.ts",
       "packages/core/injector/instance-links-host.ts",
       "packages/core/helpers/context-id-factory.ts",
+      "packages/websockets/socket-module.ts",
       "packages/common/cache/**/*",
       "packages/common/serializer/**/*",
       "packages/common/services/*.ts"
@@ -231,6 +237,7 @@
   "mocha": {
     "require": [
       "ts-node/register",
+      "tsconfig-paths/register",
       "node_modules/reflect-metadata/Reflect.js",
       "hooks/mocha-init-hook.ts"
     ],
diff --git a/packages/common/Readme.md b/packages/common/Readme.md
index 5203ac4c2..16f48336d 100644
--- a/packages/common/Readme.md
+++ b/packages/common/Readme.md
@@ -11,7 +11,6 @@
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
 <a href="https://circleci.com/gh/nestjs/nest" target="_blank"><img src="https://img.shields.io/circleci/build/github/nestjs/nest/master" alt="CircleCI" /></a>
-<a href="https://coveralls.io/github/nestjs/nest?branch=master" target="_blank"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#9" alt="Coverage" /></a>
 <a href="https://discord.gg/G7Qnnhy" target="_blank"><img src="https://img.shields.io/badge/discord-online-brightgreen.svg" alt="Discord"/></a>
 <a href="https://opencollective.com/nest#backer" target="_blank"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
 <a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
@@ -78,7 +77,10 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
  <td>
 <a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
 <a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td><td>
-<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
+<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td>
+<td>
+<a href="https://ridicorp.com/career/" target="_blank"><img src="https://nestjs.com/img/ridi-logo.svg" width="105" valign="middle" /></a></td><td>
+<a href="https://www.movavi.com/imovie-for-windows.html" target="_blank"><img src="https://nestjs.com/img/movavi-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
@@ -91,7 +93,8 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td>
 <td><a href="https://n.inc" target="_blank"><img src="https://nestjs.com/img/n-inc-logo.svg" width="120" valign="middle" /></td></tr><tr>
 <td><a href="https://bilberrry.com/" target="_blank"><img src="https://nestjs.com/img/bilberrry-logo.svg" width="180" valign="middle" /></td>
-<td><a href="https://ipinfo.ai/" target="_blank"><img src="https://nestjs.com/img/ipinfo-logo.png" width="130" valign="middle" /></td></tr>
+<td><a href="https://ipinfo.ai/" target="_blank"><img src="https://nestjs.com/img/ipinfo-logo.png" width="130" valign="middle" /></td>
+<td><a href="https://chax.at" target="_blank"><img src="https://nestjs.com/img/chaxat-logo.png" width="100" valign="middle" /></td></tr>
 </table>
 
 #### Sponsors
@@ -132,7 +135,8 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
    <td align="center" valign="middle"><a href="https://mobilereality.pl/" target="_blank"><img src="https://nestjs.com/img/mobile-reality-logo.png" width="45" valign="middle" /></a></td>
      <td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/boringowl-logo.svg" width="120" valign="middle" /></a></td>
  <td align="center" valign="middle"><a href="https://www.mobilefactory.jp/" target="_blank"><img src="https://nestjs.com/img/mobilefactory-logo.png" width="100" valign="middle" /></a></td>
- <td align="center" valign="middle"><a href="https://db.nordbot.app/" target="_blank"><img src="https://nestjs.com/img/nord-logo.png" width="50" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://nordbot.app/" target="_blank"><img src="https://nestjs.com/img/nordbot-logo.png" width="120" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://doppio.sh/" target="_blank"><img src="https://nestjs.com/img/dopiosh-logo.png" width="50" valign="middle" /></a></td>
   </tr></table>
 
 ## Backers
diff --git a/packages/common/cache/cache.constants.ts b/packages/common/cache/cache.constants.ts
deleted file mode 100644
index aa1e752de..000000000
--- a/packages/common/cache/cache.constants.ts
+++ /dev/null
@@ -1,6 +0,0 @@
-import { MODULE_OPTIONS_TOKEN } from './cache.module-definition';
-
-export const CACHE_MANAGER = 'CACHE_MANAGER';
-export const CACHE_KEY_METADATA = 'cache_module:cache_key';
-export const CACHE_TTL_METADATA = 'cache_module:cache_ttl';
-export const CACHE_MODULE_OPTIONS = MODULE_OPTIONS_TOKEN;
diff --git a/packages/common/cache/cache.module-definition.ts b/packages/common/cache/cache.module-definition.ts
deleted file mode 100644
index 25d74e986..000000000
--- a/packages/common/cache/cache.module-definition.ts
+++ /dev/null
@@ -1,12 +0,0 @@
-import { ConfigurableModuleBuilder } from '../module-utils';
-import {
-  CacheModuleOptions,
-  CacheOptionsFactory,
-} from './interfaces/cache-module.interface';
-
-export const { ConfigurableModuleClass, MODULE_OPTIONS_TOKEN } =
-  new ConfigurableModuleBuilder<CacheModuleOptions>({
-    moduleName: 'Cache',
-  })
-    .setFactoryMethodName('createCacheOptions' as keyof CacheOptionsFactory)
-    .build();
diff --git a/packages/common/cache/cache.module.ts b/packages/common/cache/cache.module.ts
deleted file mode 100644
index e57c82666..000000000
--- a/packages/common/cache/cache.module.ts
+++ /dev/null
@@ -1,60 +0,0 @@
-import { Module } from '../decorators';
-import { DynamicModule } from '../interfaces';
-import { CACHE_MANAGER } from './cache.constants';
-import { ConfigurableModuleClass } from './cache.module-definition';
-import { createCacheManager } from './cache.providers';
-import {
-  CacheModuleAsyncOptions,
-  CacheModuleOptions,
-} from './interfaces/cache-module.interface';
-
-/**
- * Module that provides Nest cache-manager.
- *
- * @see [Caching](https://docs.nestjs.com/techniques/caching)
- *
- * @publicApi
- */
-@Module({
-  providers: [createCacheManager()],
-  exports: [CACHE_MANAGER],
-})
-export class CacheModule extends ConfigurableModuleClass {
-  /**
-   * Configure the cache manager statically.
-   *
-   * @param options options to configure the cache manager
-   *
-   * @see [Customize caching](https://docs.nestjs.com/techniques/caching#customize-caching)
-   */
-  static register<StoreConfig extends Record<any, any> = Record<string, any>>(
-    options: CacheModuleOptions<StoreConfig> = {} as any,
-  ): DynamicModule {
-    return {
-      global: options.isGlobal,
-      ...super.register(options),
-    };
-  }
-
-  /**
-   * Configure the cache manager dynamically.
-   *
-   * @param options method for dynamically supplying cache manager configuration
-   * options
-   *
-   * @see [Async configuration](https://docs.nestjs.com/techniques/caching#async-configuration)
-   */
-  static registerAsync<
-    StoreConfig extends Record<any, any> = Record<string, any>,
-  >(options: CacheModuleAsyncOptions<StoreConfig>): DynamicModule {
-    const moduleDefinition = super.registerAsync(options);
-
-    return {
-      global: options.isGlobal,
-      ...moduleDefinition,
-      providers: options.extraProviders
-        ? moduleDefinition.providers.concat(options.extraProviders)
-        : moduleDefinition.providers,
-    };
-  }
-}
diff --git a/packages/common/cache/cache.providers.ts b/packages/common/cache/cache.providers.ts
deleted file mode 100644
index 082c7029f..000000000
--- a/packages/common/cache/cache.providers.ts
+++ /dev/null
@@ -1,54 +0,0 @@
-import { Provider } from '../interfaces';
-import { loadPackage } from '../utils/load-package.util';
-import { CACHE_MANAGER } from './cache.constants';
-import { MODULE_OPTIONS_TOKEN } from './cache.module-definition';
-import { defaultCacheOptions } from './default-options';
-import { CacheManagerOptions } from './interfaces/cache-manager.interface';
-
-/**
- * Creates a CacheManager Provider.
- *
- * @publicApi
- */
-export function createCacheManager(): Provider {
-  return {
-    provide: CACHE_MANAGER,
-    useFactory: async (options: CacheManagerOptions) => {
-      const cacheManager = loadPackage('cache-manager', 'CacheModule', () =>
-        require('cache-manager'),
-      );
-      const cacheManagerIsv5OrGreater = 'memoryStore' in cacheManager;
-      const cachingFactory = async (
-        store: CacheManagerOptions['store'],
-        options: Omit<CacheManagerOptions, 'store'>,
-      ): Promise<Record<string, any>> => {
-        if (!cacheManagerIsv5OrGreater) {
-          return cacheManager.caching({
-            ...defaultCacheOptions,
-            ...{ ...options, store },
-          });
-        }
-        let cache: string | Function = 'memory';
-        defaultCacheOptions.ttl *= 1000;
-        if (typeof store === 'object' && 'create' in store) {
-          cache = store.create;
-        } else if (typeof store === 'function') {
-          cache = store;
-        }
-        return cacheManager.caching(cache, {
-          ...defaultCacheOptions,
-          ...options,
-        });
-      };
-
-      return Array.isArray(options)
-        ? cacheManager.multiCaching(
-            await Promise.all(
-              options.map(option => cachingFactory(option.store, option)),
-            ),
-          )
-        : cachingFactory(options.store, options);
-    },
-    inject: [MODULE_OPTIONS_TOKEN],
-  };
-}
diff --git a/packages/common/cache/decorators/cache-key.decorator.ts b/packages/common/cache/decorators/cache-key.decorator.ts
deleted file mode 100644
index b9aa7f3c1..000000000
--- a/packages/common/cache/decorators/cache-key.decorator.ts
+++ /dev/null
@@ -1,17 +0,0 @@
-import { SetMetadata } from '../../decorators';
-import { CACHE_KEY_METADATA } from '../cache.constants';
-
-/**
- * Decorator that sets the caching key used to store/retrieve cached items for
- * Web sockets or Microservice based apps.
- *
- * For example:
- * `@CacheKey('events')`
- *
- * @param key string naming the field to be used as a cache key
- *
- * @see [Caching](https://docs.nestjs.com/techniques/caching)
- *
- * @publicApi
- */
-export const CacheKey = (key: string) => SetMetadata(CACHE_KEY_METADATA, key);
diff --git a/packages/common/cache/decorators/cache-ttl.decorator.ts b/packages/common/cache/decorators/cache-ttl.decorator.ts
deleted file mode 100644
index e6b48ae93..000000000
--- a/packages/common/cache/decorators/cache-ttl.decorator.ts
+++ /dev/null
@@ -1,18 +0,0 @@
-import { SetMetadata } from '../../decorators';
-import { ExecutionContext } from '../../interfaces/features/execution-context.interface';
-import { CACHE_TTL_METADATA } from '../cache.constants';
-
-/**
- * Decorator that sets the cache ttl setting the duration for cache expiration.
- *
- * For example: `@CacheTTL(5)`
- *
- * @param ttl number set the cache expiration time
- *
- * @see [Caching](https://docs.nestjs.com/techniques/caching)
- *
- * @publicApi
- */
-type CacheTTLFactory = (ctx: ExecutionContext) => Promise<number> | number;
-export const CacheTTL = (ttl: number | CacheTTLFactory) =>
-  SetMetadata(CACHE_TTL_METADATA, ttl);
diff --git a/packages/common/cache/decorators/index.ts b/packages/common/cache/decorators/index.ts
deleted file mode 100644
index 9d60a27f5..000000000
--- a/packages/common/cache/decorators/index.ts
+++ /dev/null
@@ -1,2 +0,0 @@
-export * from './cache-key.decorator';
-export * from './cache-ttl.decorator';
diff --git a/packages/common/cache/default-options.ts b/packages/common/cache/default-options.ts
deleted file mode 100644
index cdd262e2d..000000000
--- a/packages/common/cache/default-options.ts
+++ /dev/null
@@ -1,5 +0,0 @@
-export const defaultCacheOptions = {
-  ttl: 5,
-  max: 100,
-  store: 'memory',
-};
diff --git a/packages/common/cache/index.ts b/packages/common/cache/index.ts
deleted file mode 100644
index 1a5dfc371..000000000
--- a/packages/common/cache/index.ts
+++ /dev/null
@@ -1,5 +0,0 @@
-export * from './cache.constants';
-export * from './cache.module';
-export * from './decorators';
-export * from './interceptors';
-export * from './interfaces';
diff --git a/packages/common/cache/interceptors/cache.interceptor.ts b/packages/common/cache/interceptors/cache.interceptor.ts
deleted file mode 100644
index f6fe79db6..000000000
--- a/packages/common/cache/interceptors/cache.interceptor.ts
+++ /dev/null
@@ -1,98 +0,0 @@
-import { Observable, of } from 'rxjs';
-import { tap } from 'rxjs/operators';
-import { Inject, Injectable, Optional } from '../../decorators';
-import {
-  CallHandler,
-  ExecutionContext,
-  HttpServer,
-  NestInterceptor,
-} from '../../interfaces';
-import { Logger } from '../../services/logger.service';
-import { isFunction, isNil } from '../../utils/shared.utils';
-import {
-  CACHE_KEY_METADATA,
-  CACHE_MANAGER,
-  CACHE_TTL_METADATA,
-} from '../cache.constants';
-
-const HTTP_ADAPTER_HOST = 'HttpAdapterHost';
-const REFLECTOR = 'Reflector';
-
-export interface HttpAdapterHost<T extends HttpServer = any> {
-  httpAdapter: T;
-}
-
-@Injectable()
-export class CacheInterceptor implements NestInterceptor {
-  @Optional()
-  @Inject(HTTP_ADAPTER_HOST)
-  protected readonly httpAdapterHost: HttpAdapterHost;
-
-  protected allowedMethods = ['GET'];
-  constructor(
-    @Inject(CACHE_MANAGER) protected readonly cacheManager: any,
-    @Inject(REFLECTOR) protected readonly reflector: any,
-  ) {}
-
-  async intercept(
-    context: ExecutionContext,
-    next: CallHandler,
-  ): Promise<Observable<any>> {
-    const key = this.trackBy(context);
-    const ttlValueOrFactory =
-      this.reflector.get(CACHE_TTL_METADATA, context.getHandler()) ?? null;
-
-    if (!key) {
-      return next.handle();
-    }
-    try {
-      const value = await this.cacheManager.get(key);
-      if (!isNil(value)) {
-        return of(value);
-      }
-      const ttl = isFunction(ttlValueOrFactory)
-        ? await ttlValueOrFactory(context)
-        : ttlValueOrFactory;
-      return next.handle().pipe(
-        tap(async response => {
-          const args = isNil(ttl) ? [key, response] : [key, response, { ttl }];
-
-          try {
-            await this.cacheManager.set(...args);
-          } catch (err) {
-            Logger.error(
-              `An error has occured when inserting "key: ${key}", "value: ${response}"`,
-              'CacheInterceptor',
-            );
-          }
-        }),
-      );
-    } catch {
-      return next.handle();
-    }
-  }
-
-  protected trackBy(context: ExecutionContext): string | undefined {
-    const httpAdapter = this.httpAdapterHost.httpAdapter;
-    const isHttpApp = httpAdapter && !!httpAdapter.getRequestMethod;
-    const cacheMetadata = this.reflector.get(
-      CACHE_KEY_METADATA,
-      context.getHandler(),
-    );
-
-    if (!isHttpApp || cacheMetadata) {
-      return cacheMetadata;
-    }
-
-    const request = context.getArgByIndex(0);
-    if (!this.isRequestCacheable(context)) {
-      return undefined;
-    }
-    return httpAdapter.getRequestUrl(request);
-  }
-
-  protected isRequestCacheable(context: ExecutionContext): boolean {
-    const req = context.switchToHttp().getRequest();
-    return this.allowedMethods.includes(req.method);
-  }
-}
diff --git a/packages/common/cache/interceptors/index.ts b/packages/common/cache/interceptors/index.ts
deleted file mode 100644
index 474887b1f..000000000
--- a/packages/common/cache/interceptors/index.ts
+++ /dev/null
@@ -1 +0,0 @@
-export * from './cache.interceptor';
diff --git a/packages/common/cache/interfaces/cache-manager.interface.ts b/packages/common/cache/interfaces/cache-manager.interface.ts
deleted file mode 100644
index 9e9d4d6f4..000000000
--- a/packages/common/cache/interfaces/cache-manager.interface.ts
+++ /dev/null
@@ -1,84 +0,0 @@
-export interface LiteralObject {
-  [key: string]: any;
-}
-
-/**
- * Interface defining a cache store. Implement this interface to create a custom
- * cache store.
- *
- * @publicApi
- */
-export interface CacheStore {
-  /**
-   * Create a key/value pair in the cache.
-   *
-   * @param key cache key
-   * @param value cache value
-   */
-  set<T>(
-    key: string,
-    value: T,
-    options?: CacheStoreSetOptions<T> | number,
-  ): Promise<void> | void;
-  /**
-   * Retrieve a key/value pair from the cache.
-   *
-   * @param key cache key
-   */
-  get<T>(key: string): Promise<T | undefined> | T | undefined;
-  /**
-   * Destroy a key/value pair from the cache.
-   *
-   * @param key cache key
-   */
-  del?(key: string): void | Promise<void>;
-}
-
-export interface CacheStoreSetOptions<T> {
-  /**
-   * Time to live - amount of time in seconds that a response is cached before it
-   * is deleted. Defaults based on your cache manager settings.
-   */
-  ttl?: ((value: T) => number) | number;
-}
-
-/**
- * Interface defining a factory to create a cache store.
- *
- * @publicApi
- */
-export interface CacheStoreFactory {
-  /**
-   * Return a configured cache store.
-   *
-   * @param args Cache manager options received from `CacheModule.register()`
-   * or `CacheModule.registerAsync()`
-   */
-  create(args: LiteralObject): CacheStore;
-}
-
-/**
- * Interface defining Cache Manager configuration options.
- *
- * @publicApi
- */
-export interface CacheManagerOptions {
-  /**
-   * Cache storage manager.  Default is `'memory'` (in-memory store).  See
-   * [Different stores](https://docs.nestjs.com/techniques/caching#different-stores)
-   * for more info.
-   */
-  store?: string | CacheStoreFactory | CacheStore;
-  /**
-   * Time to live - amount of time that a response is cached before it
-   * is deleted. Subsequent request will call through the route handler and refresh
-   * the cache.  Defaults to 5 seconds. In `cache-manager@^4` this value is in seconds.
-   * In `cache-manager@^5` this value is in milliseconds.
-   */
-  ttl?: number;
-  /**
-   * Maximum number of responses to store in the cache.  Defaults to 100.
-   */
-  max?: number;
-  isCacheableValue?: (value: any) => boolean;
-}
diff --git a/packages/common/cache/interfaces/cache-module.interface.ts b/packages/common/cache/interfaces/cache-module.interface.ts
deleted file mode 100644
index bac872a9d..000000000
--- a/packages/common/cache/interfaces/cache-module.interface.ts
+++ /dev/null
@@ -1,78 +0,0 @@
-import { Provider, Type } from '../../interfaces';
-import { ConfigurableModuleAsyncOptions } from '../../module-utils';
-import { CacheManagerOptions } from './cache-manager.interface';
-
-export type CacheModuleOptions<
-  StoreConfig extends Record<any, any> = Record<string, any>,
-> =
-  // Store-specific configuration takes precedence over cache module options due
-  // to how `createCacheManager` is implemented.
-  CacheManagerOptions &
-    StoreConfig & {
-      /**
-       * If "true', register `CacheModule` as a global module.
-       */
-      isGlobal?: boolean;
-    };
-
-/**
- * Interface describing a `CacheOptionsFactory`.  Providers supplying configuration
- * options for the Cache module must implement this interface.
- *
- * @see [Async configuration](https://docs.nestjs.com/techniques/caching#async-configuration)
- *
- * @publicApi
- */
-export interface CacheOptionsFactory<
-  StoreConfig extends Record<any, any> = Record<string, any>,
-> {
-  createCacheOptions():
-    | Promise<CacheModuleOptions<StoreConfig>>
-    | CacheModuleOptions<StoreConfig>;
-}
-
-/**
- * Options for dynamically configuring the Cache module.
- *
- * @see [Async configuration](https://docs.nestjs.com/techniques/caching#async-configuration)
- *
- * @publicApi
- */
-export interface CacheModuleAsyncOptions<
-  StoreConfig extends Record<any, any> = Record<string, any>,
-> extends ConfigurableModuleAsyncOptions<
-    CacheModuleOptions<StoreConfig>,
-    keyof CacheOptionsFactory
-  > {
-  /**
-   * Injection token resolving to an existing provider. The provider must implement
-   * the `CacheOptionsFactory` interface.
-   */
-  useExisting?: Type<CacheOptionsFactory<StoreConfig>>;
-  /**
-   * Injection token resolving to a class that will be instantiated as a provider.
-   * The class must implement the `CacheOptionsFactory` interface.
-   */
-  useClass?: Type<CacheOptionsFactory<StoreConfig>>;
-  /**
-   * Function returning options (or a Promise resolving to options) to configure the
-   * cache module.
-   */
-  useFactory?: (
-    ...args: any[]
-  ) =>
-    | Promise<CacheModuleOptions<StoreConfig>>
-    | CacheModuleOptions<StoreConfig>;
-  /**
-   * Dependencies that a Factory may inject.
-   */
-  inject?: any[];
-  /**
-   * Extra providers to be registered within a scope of this module.
-   */
-  extraProviders?: Provider[];
-  /**
-   * If "true', register `CacheModule` as a global module.
-   */
-  isGlobal?: boolean;
-}
diff --git a/packages/common/cache/interfaces/index.ts b/packages/common/cache/interfaces/index.ts
deleted file mode 100644
index 54aa4c3cb..000000000
--- a/packages/common/cache/interfaces/index.ts
+++ /dev/null
@@ -1,2 +0,0 @@
-export * from './cache-manager.interface';
-export * from './cache-module.interface';
diff --git a/packages/common/constants.ts b/packages/common/constants.ts
index 7d618b01c..71f27685d 100644
--- a/packages/common/constants.ts
+++ b/packages/common/constants.ts
@@ -4,6 +4,7 @@ export const MODULE_METADATA = {
   CONTROLLERS: 'controllers',
   EXPORTS: 'exports',
 };
+
 export const GLOBAL_MODULE_METADATA = '__module:global__';
 export const HOST_METADATA = 'host';
 export const PATH_METADATA = 'path';
@@ -16,16 +17,23 @@ export const SCOPE_OPTIONS_METADATA = 'scope:options';
 export const METHOD_METADATA = 'method';
 export const ROUTE_ARGS_METADATA = '__routeArguments__';
 export const CUSTOM_ROUTE_ARGS_METADATA = '__customRouteArgs__';
-/**
- * @deprecated Use `CUSTOM_ROUTE_ARGS_METADATA` instead
- */
-export const CUSTOM_ROUTE_AGRS_METADATA = CUSTOM_ROUTE_ARGS_METADATA;
-export const EXCEPTION_FILTERS_METADATA = '__exceptionFilters__';
 export const FILTER_CATCH_EXCEPTIONS = '__filterCatchExceptions__';
+
 export const PIPES_METADATA = '__pipes__';
 export const GUARDS_METADATA = '__guards__';
-export const RENDER_METADATA = '__renderTemplate__';
 export const INTERCEPTORS_METADATA = '__interceptors__';
+export const EXCEPTION_FILTERS_METADATA = '__exceptionFilters__';
+export const ENHANCER_KEY_TO_SUBTYPE_MAP = {
+  [GUARDS_METADATA]: 'guard',
+  [INTERCEPTORS_METADATA]: 'interceptor',
+  [PIPES_METADATA]: 'pipe',
+  [EXCEPTION_FILTERS_METADATA]: 'filter',
+} as const;
+
+export type EnhancerSubtype =
+  (typeof ENHANCER_KEY_TO_SUBTYPE_MAP)[keyof typeof ENHANCER_KEY_TO_SUBTYPE_MAP];
+
+export const RENDER_METADATA = '__renderTemplate__';
 export const HTTP_CODE_METADATA = '__httpCode__';
 export const MODULE_PATH = '__module_path__';
 export const HEADERS_METADATA = '__headers__';
@@ -36,3 +44,4 @@ export const VERSION_METADATA = '__version__';
 export const INJECTABLE_WATERMARK = '__injectable__';
 export const CONTROLLER_WATERMARK = '__controller__';
 export const CATCH_WATERMARK = '__catch__';
+export const ENTRY_PROVIDER_WATERMARK = '__entryProvider__';
diff --git a/packages/common/decorators/core/controller.decorator.ts b/packages/common/decorators/core/controller.decorator.ts
index ec13f5f7c..531ae5151 100644
--- a/packages/common/decorators/core/controller.decorator.ts
+++ b/packages/common/decorators/core/controller.decorator.ts
@@ -5,8 +5,7 @@ import {
   SCOPE_OPTIONS_METADATA,
   VERSION_METADATA,
 } from '../../constants';
-import { ScopeOptions } from '../../interfaces/scope-options.interface';
-import { VersionOptions } from '../../interfaces/version-options.interface';
+import { ScopeOptions, VersionOptions } from '../../interfaces';
 import { isString, isUndefined } from '../../utils/shared.utils';
 
 /**
@@ -70,7 +69,7 @@ export function Controller(): ClassDecorator;
  * It defines a class that provides a context for one or more message or event
  * handlers.
  *
- * @param {string, Array} prefix string that defines a `route path prefix`.  The prefix
+ * @param {string|Array} prefix string that defines a `route path prefix`.  The prefix
  * is pre-pended to the path specified in any request decorator in the class.
  *
  * @see [Routing](https://docs.nestjs.com/controllers#routing)
diff --git a/packages/common/decorators/core/dependencies.decorator.ts b/packages/common/decorators/core/dependencies.decorator.ts
index 984269524..b9657efa0 100644
--- a/packages/common/decorators/core/dependencies.decorator.ts
+++ b/packages/common/decorators/core/dependencies.decorator.ts
@@ -9,6 +9,8 @@ export function flatten<T extends Array<unknown> = any>(
 
 /**
  * Decorator that sets required dependencies (required with a vanilla JavaScript objects)
+ *
+ * @publicApi
  */
 export const Dependencies = (
   ...dependencies: Array<unknown>
diff --git a/packages/common/decorators/core/inject.decorator.ts b/packages/common/decorators/core/inject.decorator.ts
index 471c77c08..e8f559124 100644
--- a/packages/common/decorators/core/inject.decorator.ts
+++ b/packages/common/decorators/core/inject.decorator.ts
@@ -33,8 +33,10 @@ import { isUndefined } from '../../utils/shared.utils';
  *
  * @publicApi
  */
-export function Inject<T = any>(token?: T) {
-  return (target: object, key: string | symbol, index?: number) => {
+export function Inject<T = any>(
+  token?: T,
+): PropertyDecorator & ParameterDecorator {
+  return (target: object, key: string | symbol | undefined, index?: number) => {
     const type = token || Reflect.getMetadata('design:type', target, key);
 
     if (!isUndefined(index)) {
diff --git a/packages/common/decorators/core/injectable.decorator.ts b/packages/common/decorators/core/injectable.decorator.ts
index 453e7666f..ff7ae143c 100644
--- a/packages/common/decorators/core/injectable.decorator.ts
+++ b/packages/common/decorators/core/injectable.decorator.ts
@@ -1,4 +1,4 @@
-import { v4 as uuid } from 'uuid';
+import { uid } from 'uid';
 import { INJECTABLE_WATERMARK, SCOPE_OPTIONS_METADATA } from '../../constants';
 import { ScopeOptions } from '../../interfaces/scope-options.interface';
 import { Type } from '../../interfaces/type.interface';
@@ -47,9 +47,12 @@ export function Injectable(options?: InjectableOptions): ClassDecorator {
   };
 }
 
+/**
+ * @publicApi
+ */
 export function mixin<T>(mixinClass: Type<T>) {
   Object.defineProperty(mixinClass, 'name', {
-    value: uuid(),
+    value: uid(21),
   });
   Injectable()(mixinClass);
   return mixinClass;
diff --git a/packages/common/decorators/core/optional.decorator.ts b/packages/common/decorators/core/optional.decorator.ts
index 49d80eec1..0d94c20f0 100644
--- a/packages/common/decorators/core/optional.decorator.ts
+++ b/packages/common/decorators/core/optional.decorator.ts
@@ -17,8 +17,8 @@ import { isUndefined } from '../../utils/shared.utils';
  *
  * @publicApi
  */
-export function Optional() {
-  return (target: object, key: string | symbol, index?: number) => {
+export function Optional(): PropertyDecorator & ParameterDecorator {
+  return (target: object, key: string | symbol | undefined, index?: number) => {
     if (!isUndefined(index)) {
       const args = Reflect.getMetadata(OPTIONAL_DEPS_METADATA, target) || [];
       Reflect.defineMetadata(OPTIONAL_DEPS_METADATA, [...args, index], target);
diff --git a/packages/common/decorators/http/create-route-param-metadata.decorator.ts b/packages/common/decorators/http/create-route-param-metadata.decorator.ts
index f8582bf57..d070e47a7 100644
--- a/packages/common/decorators/http/create-route-param-metadata.decorator.ts
+++ b/packages/common/decorators/http/create-route-param-metadata.decorator.ts
@@ -1,4 +1,4 @@
-import { v4 as uuid } from 'uuid';
+import { uid } from 'uid';
 import { ROUTE_ARGS_METADATA } from '../../constants';
 import { PipeTransform } from '../../index';
 import { Type } from '../../interfaces';
@@ -12,6 +12,8 @@ export type ParamDecoratorEnhancer = ParameterDecorator;
  * Defines HTTP route param decorator
  *
  * @param factory
+ *
+ * @publicApi
  */
 export function createParamDecorator<
   FactoryData = any,
@@ -23,7 +25,7 @@ export function createParamDecorator<
 ): (
   ...dataOrPipes: (Type<PipeTransform> | PipeTransform | FactoryData)[]
 ) => ParameterDecorator {
-  const paramtype = uuid();
+  const paramtype = uid(21);
   return (
       data?,
       ...pipes: (Type<PipeTransform> | PipeTransform | FactoryData)[]
diff --git a/packages/common/decorators/http/request-mapping.decorator.ts b/packages/common/decorators/http/request-mapping.decorator.ts
index 62d61cde4..46ebc0d8f 100644
--- a/packages/common/decorators/http/request-mapping.decorator.ts
+++ b/packages/common/decorators/http/request-mapping.decorator.ts
@@ -109,12 +109,3 @@ export const Head = createMappingDecorator(RequestMethod.HEAD);
  * @publicApi
  */
 export const All = createMappingDecorator(RequestMethod.ALL);
-
-/**
- * Route handler (method) Decorator. Routes all HTTP requests to the specified path.
- *
- * @see [Routing](https://docs.nestjs.com/controllers#routing)
- *
- * @publicApi
- */
-export const Search = createMappingDecorator(RequestMethod.SEARCH);
diff --git a/packages/common/enums/http-status.enum.ts b/packages/common/enums/http-status.enum.ts
index 875597540..326001344 100644
--- a/packages/common/enums/http-status.enum.ts
+++ b/packages/common/enums/http-status.enum.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export enum HttpStatus {
   CONTINUE = 100,
   SWITCHING_PROTOCOLS = 101,
diff --git a/packages/common/enums/request-method.enum.ts b/packages/common/enums/request-method.enum.ts
index e28455633..d48f52b4d 100644
--- a/packages/common/enums/request-method.enum.ts
+++ b/packages/common/enums/request-method.enum.ts
@@ -7,5 +7,4 @@ export enum RequestMethod {
   ALL,
   OPTIONS,
   HEAD,
-  SEARCH,
 }
diff --git a/packages/common/exceptions/bad-gateway.exception.ts b/packages/common/exceptions/bad-gateway.exception.ts
index ba46421b5..2623d8727 100644
--- a/packages/common/exceptions/bad-gateway.exception.ts
+++ b/packages/common/exceptions/bad-gateway.exception.ts
@@ -1,5 +1,4 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { isString } from '../utils/shared.utils';
 import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
diff --git a/packages/common/exceptions/bad-request.exception.ts b/packages/common/exceptions/bad-request.exception.ts
index b9f04fe62..bedb7d095 100644
--- a/packages/common/exceptions/bad-request.exception.ts
+++ b/packages/common/exceptions/bad-request.exception.ts
@@ -1,4 +1,3 @@
-import { isString } from 'class-validator';
 import { HttpStatus } from '../enums/http-status.enum';
 import { HttpException, HttpExceptionOptions } from './http.exception';
 
diff --git a/packages/common/exceptions/http.exception.ts b/packages/common/exceptions/http.exception.ts
index bc166a8a1..ca07c5d6e 100644
--- a/packages/common/exceptions/http.exception.ts
+++ b/packages/common/exceptions/http.exception.ts
@@ -1,4 +1,3 @@
-import { Logger } from '../services';
 import { isObject, isString } from '../utils/shared.utils';
 
 export interface HttpExceptionOptions {
@@ -26,8 +25,6 @@ export class HttpException extends Error {
    * @example
    * throw new HttpException()
    * throw new HttpException('message', HttpStatus.BAD_REQUEST)
-   * throw new HttpException({ reason: 'this can be a human readable reason' }, HttpStatus.BAD_REQUEST)
-   * throw new HttpException(new Error('Cause Error'), HttpStatus.BAD_REQUEST)
    * throw new HttpException('custom message', HttpStatus.BAD_REQUEST, {
    *  cause: new Error('Cause Error'),
    * })
@@ -81,13 +78,6 @@ export class HttpException extends Error {
       this.cause = this.options.cause;
       return;
     }
-
-    if (this.response instanceof Error) {
-      Logger.warn(
-        'DEPRECATED! Passing the error cause as the first argument to HttpException constructor is deprecated. You should use the "options" parameter instead: new HttpException("message", 400, { cause: new Error("Some Error") }) ',
-      );
-      this.cause = this.response;
-    }
   }
 
   public initMessage() {
@@ -99,9 +89,9 @@ export class HttpException extends Error {
     ) {
       this.message = (this.response as Record<string, any>).message;
     } else if (this.constructor) {
-      this.message = this.constructor.name
-        .match(/[A-Z][a-z]+|[0-9]+/g)
-        .join(' ');
+      this.message =
+        this.constructor.name.match(/[A-Z][a-z]+|[0-9]+/g)?.join(' ') ??
+        'Error';
     }
   }
 
diff --git a/packages/common/file-stream/interfaces/index.ts b/packages/common/file-stream/interfaces/index.ts
new file mode 100644
index 000000000..9be413e21
--- /dev/null
+++ b/packages/common/file-stream/interfaces/index.ts
@@ -0,0 +1,2 @@
+export * from './streamable-options.interface';
+export * from './streamable-handler-response.interface';
diff --git a/packages/common/file-stream/interfaces/streamable-handler-response.interface.ts b/packages/common/file-stream/interfaces/streamable-handler-response.interface.ts
new file mode 100644
index 000000000..c1c77a922
--- /dev/null
+++ b/packages/common/file-stream/interfaces/streamable-handler-response.interface.ts
@@ -0,0 +1,12 @@
+export interface StreamableHandlerResponse {
+  /** `true` if the connection is destroyed, `false` otherwise. */
+  destroyed: boolean;
+  /** `true` if headers were sent, `false` otherwise. */
+  headersSent: boolean;
+  /** The status code that will be sent to the client when the headers get flushed. */
+  statusCode: number;
+  /** Sends the HTTP response. */
+  send: (body: string) => void;
+  /** Signals to the server that all of the response headers and body have been sent. */
+  end: () => void;
+}
diff --git a/packages/common/file-stream/streamable-options.interface.ts b/packages/common/file-stream/interfaces/streamable-options.interface.ts
similarity index 64%
rename from packages/common/file-stream/streamable-options.interface.ts
rename to packages/common/file-stream/interfaces/streamable-options.interface.ts
index 5d167b6b0..bd9616b5c 100644
--- a/packages/common/file-stream/streamable-options.interface.ts
+++ b/packages/common/file-stream/interfaces/streamable-options.interface.ts
@@ -1,3 +1,8 @@
+/**
+ * Options for `StreamableFile`
+ *
+ * @publicApi
+ */
 export interface StreamableFileOptions {
   type?: string;
   disposition?: string;
diff --git a/packages/common/file-stream/streamable-file.ts b/packages/common/file-stream/streamable-file.ts
index dae63beda..971741d5a 100644
--- a/packages/common/file-stream/streamable-file.ts
+++ b/packages/common/file-stream/streamable-file.ts
@@ -1,14 +1,14 @@
 import { Readable } from 'stream';
 import { types } from 'util';
+import { HttpStatus } from '../enums';
 import { isFunction } from '../utils/shared.utils';
-import { StreamableFileOptions } from './streamable-options.interface';
-
-export interface StreamableHandlerResponse {
-  destroyed: boolean;
-  statusCode: number;
-  send: (msg: string) => void;
-}
+import { StreamableFileOptions, StreamableHandlerResponse } from './interfaces';
 
+/**
+ * @see [Streaming files](https://docs.nestjs.com/techniques/streaming-files)
+ *
+ * @publicApi
+ */
 export class StreamableFile {
   private readonly stream: Readable;
 
@@ -16,10 +16,16 @@ export class StreamableFile {
     err: Error,
     response: StreamableHandlerResponse,
   ) => void = (err: Error, res) => {
-    if (!res.destroyed) {
-      res.statusCode = 400;
-      res.send(err.message);
+    if (res.destroyed) {
+      return;
     }
+    if (res.headersSent) {
+      res.end();
+      return;
+    }
+
+    res.statusCode = HttpStatus.BAD_REQUEST;
+    res.send(err.message);
   };
 
   constructor(buffer: Uint8Array, options?: StreamableFileOptions);
diff --git a/packages/common/index.ts b/packages/common/index.ts
index c8d815187..bfeb90f80 100644
--- a/packages/common/index.ts
+++ b/packages/common/index.ts
@@ -1,12 +1,11 @@
 /*
  * Nest @common
- * Copyright(c) 2017 - 2022 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2023 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
 import 'reflect-metadata';
 
-export * from './cache';
 export * from './decorators';
 export * from './enums';
 export * from './exceptions';
diff --git a/packages/common/interfaces/features/custom-route-param-factory.interface.ts b/packages/common/interfaces/features/custom-route-param-factory.interface.ts
index 3a6afd910..e022b6669 100644
--- a/packages/common/interfaces/features/custom-route-param-factory.interface.ts
+++ b/packages/common/interfaces/features/custom-route-param-factory.interface.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export type CustomParamFactory<TData = any, TInput = any, TOutput = any> = (
   data: TData,
   input: TInput,
diff --git a/packages/common/interfaces/features/paramtype.interface.ts b/packages/common/interfaces/features/paramtype.interface.ts
index d2c299dbc..a63184f8c 100644
--- a/packages/common/interfaces/features/paramtype.interface.ts
+++ b/packages/common/interfaces/features/paramtype.interface.ts
@@ -1 +1,4 @@
+/**
+ * @publicApi
+ */
 export type Paramtype = 'body' | 'query' | 'param' | 'custom';
diff --git a/packages/common/interfaces/http/http-exception-body.interface.ts b/packages/common/interfaces/http/http-exception-body.interface.ts
new file mode 100644
index 000000000..e0b923e5e
--- /dev/null
+++ b/packages/common/interfaces/http/http-exception-body.interface.ts
@@ -0,0 +1,7 @@
+export type HttpExceptionBodyMessage = string | string[];
+
+export interface HttpExceptionBody {
+  message: HttpExceptionBodyMessage;
+  error?: string;
+  statusCode: number;
+}
diff --git a/packages/common/interfaces/http/http-server.interface.ts b/packages/common/interfaces/http/http-server.interface.ts
index 99b7e55eb..8bf7e49a9 100644
--- a/packages/common/interfaces/http/http-server.interface.ts
+++ b/packages/common/interfaces/http/http-server.interface.ts
@@ -18,7 +18,11 @@ export type RequestHandler<TRequest = any, TResponse = any> = (
   next?: Function,
 ) => any;
 
-export interface HttpServer<TRequest = any, TResponse = any> {
+export interface HttpServer<
+  TRequest = any,
+  TResponse = any,
+  ServerInstance = any,
+> {
   use(
     handler:
       | RequestHandler<TRequest, TResponse>
@@ -30,6 +34,7 @@ export interface HttpServer<TRequest = any, TResponse = any> {
       | RequestHandler<TRequest, TResponse>
       | ErrorHandler<TRequest, TResponse>,
   ): any;
+  useBodyParser?(...args: any[]): any;
   get(handler: RequestHandler<TRequest, TResponse>): any;
   get(path: string, handler: RequestHandler<TRequest, TResponse>): any;
   post(handler: RequestHandler<TRequest, TResponse>): any;
@@ -68,7 +73,7 @@ export interface HttpServer<TRequest = any, TResponse = any> {
   getRequestHostname?(request: TRequest): string;
   getRequestMethod?(request: TRequest): string;
   getRequestUrl?(request: TRequest): string;
-  getInstance(): any;
+  getInstance(): ServerInstance;
   registerParserMiddleware(...args: any[]): any;
   enableCors(options: CorsOptions | CorsOptionsDelegate<TRequest>): any;
   getHttpServer(): any;
diff --git a/packages/common/interfaces/http/raw-body-request.interface.ts b/packages/common/interfaces/http/raw-body-request.interface.ts
index 77b6248f9..b87229083 100644
--- a/packages/common/interfaces/http/raw-body-request.interface.ts
+++ b/packages/common/interfaces/http/raw-body-request.interface.ts
@@ -1 +1,4 @@
+/**
+ * @publicApi
+ */
 export type RawBodyRequest<T> = T & { rawBody?: Buffer };
diff --git a/packages/common/interfaces/microservices/nest-hybrid-application-options.interface.ts b/packages/common/interfaces/microservices/nest-hybrid-application-options.interface.ts
index bc27552c5..5389cf5d1 100644
--- a/packages/common/interfaces/microservices/nest-hybrid-application-options.interface.ts
+++ b/packages/common/interfaces/microservices/nest-hybrid-application-options.interface.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export interface NestHybridApplicationOptions {
   inheritAppConfig?: boolean;
 }
diff --git a/packages/common/interfaces/microservices/nest-microservice-options.interface.ts b/packages/common/interfaces/microservices/nest-microservice-options.interface.ts
index 04057a09d..34f32c9f5 100644
--- a/packages/common/interfaces/microservices/nest-microservice-options.interface.ts
+++ b/packages/common/interfaces/microservices/nest-microservice-options.interface.ts
@@ -1,3 +1,6 @@
 import { NestApplicationContextOptions } from '../nest-application-context-options.interface';
 
+/**
+ * @publicApi
+ */
 export type NestMicroserviceOptions = NestApplicationContextOptions;
diff --git a/packages/common/interfaces/middleware/middleware-config-proxy.interface.ts b/packages/common/interfaces/middleware/middleware-config-proxy.interface.ts
index e23c3cf8a..b0d194b86 100644
--- a/packages/common/interfaces/middleware/middleware-config-proxy.interface.ts
+++ b/packages/common/interfaces/middleware/middleware-config-proxy.interface.ts
@@ -2,6 +2,9 @@ import { Type } from '../type.interface';
 import { RouteInfo } from './middleware-configuration.interface';
 import { MiddlewareConsumer } from './middleware-consumer.interface';
 
+/**
+ * @publicApi
+ */
 export interface MiddlewareConfigProxy {
   /**
    * Excludes routes from the currently processed middleware.
diff --git a/packages/common/interfaces/middleware/nest-middleware.interface.ts b/packages/common/interfaces/middleware/nest-middleware.interface.ts
index bf3106995..88c27bc5c 100644
--- a/packages/common/interfaces/middleware/nest-middleware.interface.ts
+++ b/packages/common/interfaces/middleware/nest-middleware.interface.ts
@@ -1,3 +1,8 @@
+/**
+ * @see [Middleware](https://docs.nestjs.com/middleware)
+ *
+ * @publicApi
+ */
 export interface NestMiddleware<TRequest = any, TResponse = any> {
   use(req: TRequest, res: TResponse, next: (error?: Error | any) => void): any;
 }
diff --git a/packages/common/interfaces/modules/injection-token.interface.ts b/packages/common/interfaces/modules/injection-token.interface.ts
index 01aa7b1a9..8a4d8d97f 100644
--- a/packages/common/interfaces/modules/injection-token.interface.ts
+++ b/packages/common/interfaces/modules/injection-token.interface.ts
@@ -1,6 +1,9 @@
 import { Abstract } from '../abstract.interface';
 import { Type } from '../type.interface';
 
+/**
+ * @publicApi
+ */
 export type InjectionToken =
   | string
   | symbol
diff --git a/packages/common/interfaces/modules/nest-module.interface.ts b/packages/common/interfaces/modules/nest-module.interface.ts
index bef5810c2..236658017 100644
--- a/packages/common/interfaces/modules/nest-module.interface.ts
+++ b/packages/common/interfaces/modules/nest-module.interface.ts
@@ -1,5 +1,8 @@
 import { MiddlewareConsumer } from '../middleware/middleware-consumer.interface';
 
+/**
+ * @publicApi
+ */
 export interface NestModule {
   configure(consumer: MiddlewareConsumer);
 }
diff --git a/packages/common/interfaces/modules/optional-factory-dependency.interface.ts b/packages/common/interfaces/modules/optional-factory-dependency.interface.ts
index be2ebb298..6c8db900e 100644
--- a/packages/common/interfaces/modules/optional-factory-dependency.interface.ts
+++ b/packages/common/interfaces/modules/optional-factory-dependency.interface.ts
@@ -1,5 +1,8 @@
 import { InjectionToken } from './injection-token.interface';
 
+/**
+ * @publicApi
+ */
 export type OptionalFactoryDependency = {
   token: InjectionToken;
   optional: boolean;
diff --git a/packages/common/interfaces/nest-application-context-options.interface.ts b/packages/common/interfaces/nest-application-context-options.interface.ts
index 2a04d09e4..d5204b55d 100644
--- a/packages/common/interfaces/nest-application-context-options.interface.ts
+++ b/packages/common/interfaces/nest-application-context-options.interface.ts
@@ -29,4 +29,19 @@ export class NestApplicationContextOptions {
    * @default true
    */
   autoFlushLogs?: boolean;
+
+  /**
+   * Whether to run application in the preview mode.
+   * In the preview mode, providers/controllers are not instantiated & resolved.
+   *
+   * @default false
+   */
+  preview?: boolean;
+
+  /**
+   * Whether to generate a serialized graph snapshot.
+   *
+   * @default false
+   */
+  snapshot?: boolean;
 }
diff --git a/packages/common/interfaces/nest-application.interface.ts b/packages/common/interfaces/nest-application.interface.ts
index 82e302dc8..eb2167e64 100644
--- a/packages/common/interfaces/nest-application.interface.ts
+++ b/packages/common/interfaces/nest-application.interface.ts
@@ -21,7 +21,8 @@ import { WebSocketAdapter } from './websockets/web-socket-adapter.interface';
  *
  * @publicApi
  */
-export interface INestApplication extends INestApplicationContext {
+export interface INestApplication<TServer = any>
+  extends INestApplicationContext {
   /**
    * A wrapper function around HTTP adapter method: `adapter.use()`.
    * Example `app.use(cors())`
@@ -110,9 +111,9 @@ export interface INestApplication extends INestApplicationContext {
   /**
    * Returns the underlying native HTTP server.
    *
-   * @returns {*}
+   * @returns {TServer}
    */
-  getHttpServer(): any;
+  getHttpServer(): TServer;
 
   /**
    * Returns the underlying HTTP adapter.
diff --git a/packages/common/interfaces/version-options.interface.ts b/packages/common/interfaces/version-options.interface.ts
index c6626436f..fc5a53b6e 100644
--- a/packages/common/interfaces/version-options.interface.ts
+++ b/packages/common/interfaces/version-options.interface.ts
@@ -7,6 +7,9 @@ import { VersioningType } from '../enums/version-type.enum';
  */
 export const VERSION_NEUTRAL = Symbol('VERSION_NEUTRAL');
 
+/**
+ * @publicApi
+ */
 export type VersionValue =
   | string
   | typeof VERSION_NEUTRAL
@@ -28,6 +31,9 @@ export interface VersionOptions {
   version?: VersionValue;
 }
 
+/**
+ * @publicApi
+ */
 export interface HeaderVersioningOptions {
   type: VersioningType.HEADER;
   /**
@@ -36,6 +42,9 @@ export interface HeaderVersioningOptions {
   header: string;
 }
 
+/**
+ * @publicApi
+ */
 export interface UriVersioningOptions {
   type: VersioningType.URI;
   /**
@@ -48,6 +57,9 @@ export interface UriVersioningOptions {
   prefix?: string | false;
 }
 
+/**
+ * @publicApi
+ */
 export interface MediaTypeVersioningOptions {
   type: VersioningType.MEDIA_TYPE;
   /**
@@ -58,6 +70,9 @@ export interface MediaTypeVersioningOptions {
   key: string;
 }
 
+/**
+ * @publicApi
+ */
 export interface CustomVersioningOptions {
   type: VersioningType.CUSTOM;
 
@@ -72,6 +87,9 @@ export interface CustomVersioningOptions {
   extractor: (request: unknown) => string | string[];
 }
 
+/**
+ * @publicApi
+ */
 interface VersioningCommonOptions {
   /**
    * The default version to be used as a fallback when you did not provide some
diff --git a/packages/common/interfaces/websockets/web-socket-adapter.interface.ts b/packages/common/interfaces/websockets/web-socket-adapter.interface.ts
index 4b1585672..e3baa1272 100644
--- a/packages/common/interfaces/websockets/web-socket-adapter.interface.ts
+++ b/packages/common/interfaces/websockets/web-socket-adapter.interface.ts
@@ -1,10 +1,16 @@
 import { Observable } from 'rxjs';
 
+/**
+ * @publicApi
+ */
 export interface WsMessageHandler<T = string> {
   message: T;
   callback: (...args: any[]) => Observable<any> | Promise<any>;
 }
 
+/**
+ * @publicApi
+ */
 export interface WebSocketAdapter<
   TServer = any,
   TClient = any,
diff --git a/packages/common/module-utils/configurable-module.builder.ts b/packages/common/module-utils/configurable-module.builder.ts
index c242267e6..17735f4ad 100644
--- a/packages/common/module-utils/configurable-module.builder.ts
+++ b/packages/common/module-utils/configurable-module.builder.ts
@@ -79,7 +79,7 @@ export class ConfigurableModuleBuilder<
 
   /**
    * Registers the "extras" object (a set of extra options that can be used to modify the dynamic module definition).
-   * Values you specify within the "extras" object will be used as default values (that can be overriden by module consumers).
+   * Values you specify within the "extras" object will be used as default values (that can be overridden by module consumers).
    *
    * This method also applies the so-called "module definition transform function" that takes the auto-generated
    * dynamic module object ("DynamicModule") and the actual consumer "extras" object as input parameters.
@@ -205,7 +205,7 @@ export class ConfigurableModuleBuilder<
       static [self.staticMethodKey](
         options: ModuleOptions & ExtraModuleDefinitionOptions,
       ): DynamicModule {
-        const providers = [
+        const providers: Array<Provider> = [
           {
             provide: self.options.optionsInjectionToken,
             useValue: this.omitExtras(options, self.extras),
diff --git a/packages/common/package.json b/packages/common/package.json
index c114967ef..697002f7a 100644
--- a/packages/common/package.json
+++ b/packages/common/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/common",
-  "version": "9.2.0",
+  "version": "9.4.0",
   "description": "Nest - modern, fast, powerful node.js web framework (@common)",
   "author": "Kamil Mysliwiec",
   "homepage": "https://nestjs.com",
@@ -18,20 +18,16 @@
   "license": "MIT",
   "dependencies": {
     "iterare": "1.2.1",
-    "tslib": "2.4.1",
-    "uuid": "9.0.0"
+    "tslib": "2.5.0",
+    "uid": "2.0.2"
   },
   "peerDependencies": {
-    "cache-manager": "<=5",
     "class-transformer": "*",
     "class-validator": "*",
     "reflect-metadata": "^0.1.12",
     "rxjs": "^7.1.0"
   },
   "peerDependenciesMeta": {
-    "cache-manager": {
-      "optional": true
-    },
     "class-validator": {
       "optional": true
     },
diff --git a/packages/common/pipes/file/file-type.validator.ts b/packages/common/pipes/file/file-type.validator.ts
index 240d3efe8..ffc3e54c5 100644
--- a/packages/common/pipes/file/file-type.validator.ts
+++ b/packages/common/pipes/file/file-type.validator.ts
@@ -1,4 +1,5 @@
 import { FileValidator } from './file-validator.interface';
+import { IFile } from './interfaces';
 
 export type FileTypeValidatorOptions = {
   fileType: string | RegExp;
@@ -20,17 +21,14 @@ export class FileTypeValidator extends FileValidator<FileTypeValidatorOptions> {
     return `Validation failed (expected type is ${this.validationOptions.fileType})`;
   }
 
-  isValid(file: any): boolean {
+  isValid<TFile extends IFile = any>(file: TFile): boolean {
     if (!this.validationOptions) {
       return true;
     }
 
-    if (!file.mimetype) {
-      return false;
-    }
-
-    return Boolean(
-      (file.mimetype as string).match(this.validationOptions.fileType),
+    return (
+      'mimetype' in file &&
+      !!file.mimetype.match(this.validationOptions.fileType)
     );
   }
 }
diff --git a/packages/common/pipes/file/file-validator.interface.ts b/packages/common/pipes/file/file-validator.interface.ts
index ad453cdae..bf43c0b6a 100644
--- a/packages/common/pipes/file/file-validator.interface.ts
+++ b/packages/common/pipes/file/file-validator.interface.ts
@@ -1,5 +1,10 @@
+import { IFile } from './interfaces';
+
 /**
- * Interface describing FileValidators, which can be added to a {@link ParseFilePipe}.
+ * Interface describing FileValidators, which can be added to a ParseFilePipe
+ *
+ * @see {ParseFilePipe}
+ * @publicApi
  */
 export abstract class FileValidator<TValidationOptions = Record<string, any>> {
   constructor(protected readonly validationOptions: TValidationOptions) {}
@@ -8,7 +13,9 @@ export abstract class FileValidator<TValidationOptions = Record<string, any>> {
    * Indicates if this file should be considered valid, according to the options passed in the constructor.
    * @param file the file from the request object
    */
-  abstract isValid(file?: any): boolean | Promise<boolean>;
+  abstract isValid<TFile extends IFile = any>(
+    file?: TFile,
+  ): boolean | Promise<boolean>;
 
   /**
    * Builds an error message in case the validation fails.
diff --git a/packages/common/pipes/file/interfaces/file.interface.ts b/packages/common/pipes/file/interfaces/file.interface.ts
new file mode 100644
index 000000000..37218734f
--- /dev/null
+++ b/packages/common/pipes/file/interfaces/file.interface.ts
@@ -0,0 +1,4 @@
+export interface IFile {
+  mimetype: string;
+  size: number;
+}
diff --git a/packages/common/pipes/file/interfaces/index.ts b/packages/common/pipes/file/interfaces/index.ts
new file mode 100644
index 000000000..09d8f3ca8
--- /dev/null
+++ b/packages/common/pipes/file/interfaces/index.ts
@@ -0,0 +1 @@
+export * from './file.interface';
diff --git a/packages/common/pipes/file/max-file-size.validator.ts b/packages/common/pipes/file/max-file-size.validator.ts
index 847ee19f0..c6274de91 100644
--- a/packages/common/pipes/file/max-file-size.validator.ts
+++ b/packages/common/pipes/file/max-file-size.validator.ts
@@ -1,4 +1,5 @@
 import { FileValidator } from './file-validator.interface';
+import { IFile } from './interfaces';
 
 export type MaxFileSizeValidatorOptions = {
   maxSize: number;
@@ -7,7 +8,7 @@ export type MaxFileSizeValidatorOptions = {
 /**
  * Defines the built-in MaxSize File Validator
  *
- * @see [File Validators](https://docs.nestjs.com/techniques/file-upload#validators)
+ * @see [File Validators](https://docs.nestjs.com/techniques/file-upload#file-validation)
  *
  * @publicApi
  */
@@ -16,11 +17,11 @@ export class MaxFileSizeValidator extends FileValidator<MaxFileSizeValidatorOpti
     return `Validation failed (expected size is less than ${this.validationOptions.maxSize})`;
   }
 
-  public isValid(file: any): boolean {
+  public isValid<TFile extends IFile = any>(file: TFile): boolean {
     if (!this.validationOptions) {
       return true;
     }
 
-    return file.size < this.validationOptions.maxSize;
+    return 'size' in file && file.size < this.validationOptions.maxSize;
   }
 }
diff --git a/packages/common/pipes/file/parse-file-options.interface.ts b/packages/common/pipes/file/parse-file-options.interface.ts
index 7602f6997..f9c67daa8 100644
--- a/packages/common/pipes/file/parse-file-options.interface.ts
+++ b/packages/common/pipes/file/parse-file-options.interface.ts
@@ -1,6 +1,9 @@
 import { ErrorHttpStatusCode } from '../../utils/http-error-by-code.util';
 import { FileValidator } from './file-validator.interface';
 
+/**
+ * @publicApi
+ */
 export interface ParseFileOptions {
   validators?: FileValidator[];
   errorHttpStatusCode?: ErrorHttpStatusCode;
diff --git a/packages/common/pipes/file/parse-file-pipe.builder.ts b/packages/common/pipes/file/parse-file-pipe.builder.ts
index fafbe78fe..9199fec3d 100644
--- a/packages/common/pipes/file/parse-file-pipe.builder.ts
+++ b/packages/common/pipes/file/parse-file-pipe.builder.ts
@@ -10,6 +10,9 @@ import {
 import { ParseFileOptions } from './parse-file-options.interface';
 import { ParseFilePipe } from './parse-file.pipe';
 
+/**
+ * @publicApi
+ */
 export class ParseFilePipeBuilder {
   private validators: FileValidator[] = [];
 
diff --git a/packages/common/pipes/file/parse-file.pipe.ts b/packages/common/pipes/file/parse-file.pipe.ts
index 3cda9a5fc..d2ea60e50 100644
--- a/packages/common/pipes/file/parse-file.pipe.ts
+++ b/packages/common/pipes/file/parse-file.pipe.ts
@@ -1,16 +1,16 @@
-import { isUndefined } from '../../utils/shared.utils';
 import { Injectable, Optional } from '../../decorators/core';
 import { HttpStatus } from '../../enums';
 import { PipeTransform } from '../../interfaces/features/pipe-transform.interface';
 import { HttpErrorByCode } from '../../utils/http-error-by-code.util';
+import { isEmpty, isObject, isUndefined } from '../../utils/shared.utils';
 import { FileValidator } from './file-validator.interface';
 import { ParseFileOptions } from './parse-file-options.interface';
 
 /**
  * Defines the built-in ParseFile Pipe. This pipe can be used to validate incoming files
  * with `@UploadedFile()` decorator. You can use either other specific built-in validators
- * or provide one of your own, simply implementing it through {@link FileValidator}
- * interface and adding it to ParseFilePipe's constructor.
+ * or provide one of your own, simply implementing it through FileValidator interface
+ * and adding it to ParseFilePipe's constructor.
  *
  * @see [Built-in Pipes](https://docs.nestjs.com/pipes#built-in-pipes)
  *
@@ -39,25 +39,36 @@ export class ParseFilePipe implements PipeTransform<any> {
   }
 
   async transform(value: any): Promise<any> {
-    if (isUndefined(value)) {
-      if (this.fileIsRequired) {
-        throw this.exceptionFactory('File is required');
-      }
+    const areThereAnyFilesIn = this.thereAreNoFilesIn(value);
 
-      return value;
+    if (areThereAnyFilesIn && this.fileIsRequired) {
+      throw this.exceptionFactory('File is required');
     }
+    if (!areThereAnyFilesIn && this.validators.length) {
+      await this.validateFilesOrFile(value);
+    }
+
+    return value;
+  }
 
-    if (this.validators.length) {
+  private async validateFilesOrFile(value: any): Promise<void> {
+    if (Array.isArray(value)) {
+      await Promise.all(value.map(f => this.validate(f)));
+    } else {
       await this.validate(value);
     }
-    return value;
+  }
+
+  private thereAreNoFilesIn(value: any): boolean {
+    const isEmptyArray = Array.isArray(value) && isEmpty(value);
+    const isEmptyObject = isObject(value) && isEmpty(Object.keys(value));
+    return isUndefined(value) || isEmptyArray || isEmptyObject;
   }
 
   protected async validate(file: any): Promise<any> {
     for (const validator of this.validators) {
       await this.validateOrThrow(file, validator);
     }
-
     return file;
   }
 
diff --git a/packages/common/pipes/parse-array.pipe.ts b/packages/common/pipes/parse-array.pipe.ts
index c9ed1c67d..a46acc8fd 100644
--- a/packages/common/pipes/parse-array.pipe.ts
+++ b/packages/common/pipes/parse-array.pipe.ts
@@ -13,6 +13,9 @@ import { ValidationPipe, ValidationPipeOptions } from './validation.pipe';
 const VALIDATION_ERROR_MESSAGE = 'Validation failed (parsable array expected)';
 const DEFAULT_ARRAY_SEPARATOR = ',';
 
+/**
+ * @publicApi
+ */
 export interface ParseArrayOptions
   extends Omit<
     ValidationPipeOptions,
@@ -85,10 +88,11 @@ export class ParseArrayPipe implements PipeTransform {
 
       const isExpectedTypePrimitive = this.isExpectedTypePrimitive();
       const toClassInstance = (item: any, index?: number) => {
-        try {
-          item = JSON.parse(item);
-        } catch {}
-
+        if (this.options.items !== String) {
+          try {
+            item = JSON.parse(item);
+          } catch {}
+        }
         if (isExpectedTypePrimitive) {
           return this.validatePrimitive(item, index);
         }
diff --git a/packages/common/pipes/parse-bool.pipe.ts b/packages/common/pipes/parse-bool.pipe.ts
index a5b6bcb6d..7f6bdffef 100644
--- a/packages/common/pipes/parse-bool.pipe.ts
+++ b/packages/common/pipes/parse-bool.pipe.ts
@@ -10,6 +10,9 @@ import {
   HttpErrorByCode,
 } from '../utils/http-error-by-code.util';
 
+/**
+ * @publicApi
+ */
 export interface ParseBoolPipeOptions {
   errorHttpStatusCode?: ErrorHttpStatusCode;
   exceptionFactory?: (error: string) => any;
diff --git a/packages/common/pipes/parse-enum.pipe.ts b/packages/common/pipes/parse-enum.pipe.ts
index 406f61727..11b4a6ca7 100644
--- a/packages/common/pipes/parse-enum.pipe.ts
+++ b/packages/common/pipes/parse-enum.pipe.ts
@@ -5,6 +5,9 @@ import {
   HttpErrorByCode,
 } from '../utils/http-error-by-code.util';
 
+/**
+ * @publicApi
+ */
 export interface ParseEnumPipeOptions {
   errorHttpStatusCode?: ErrorHttpStatusCode;
   exceptionFactory?: (error: string) => any;
diff --git a/packages/common/pipes/parse-float.pipe.ts b/packages/common/pipes/parse-float.pipe.ts
index 1f0fdb021..462077efd 100644
--- a/packages/common/pipes/parse-float.pipe.ts
+++ b/packages/common/pipes/parse-float.pipe.ts
@@ -5,6 +5,9 @@ import {
   HttpErrorByCode,
 } from '../utils/http-error-by-code.util';
 
+/**
+ * @publicApi
+ */
 export interface ParseFloatPipeOptions {
   errorHttpStatusCode?: ErrorHttpStatusCode;
   exceptionFactory?: (error: string) => any;
diff --git a/packages/common/pipes/parse-int.pipe.ts b/packages/common/pipes/parse-int.pipe.ts
index 9d79a2b4c..11303c7e4 100644
--- a/packages/common/pipes/parse-int.pipe.ts
+++ b/packages/common/pipes/parse-int.pipe.ts
@@ -10,6 +10,9 @@ import {
   HttpErrorByCode,
 } from '../utils/http-error-by-code.util';
 
+/**
+ * @publicApi
+ */
 export interface ParseIntPipeOptions {
   errorHttpStatusCode?: ErrorHttpStatusCode;
   exceptionFactory?: (error: string) => any;
diff --git a/packages/common/pipes/parse-uuid.pipe.ts b/packages/common/pipes/parse-uuid.pipe.ts
index 81fe2b4c1..2379e36b6 100644
--- a/packages/common/pipes/parse-uuid.pipe.ts
+++ b/packages/common/pipes/parse-uuid.pipe.ts
@@ -11,12 +11,22 @@ import {
 } from '../utils/http-error-by-code.util';
 import { isString } from '../utils/shared.utils';
 
+/**
+ * @publicApi
+ */
 export interface ParseUUIDPipeOptions {
   version?: '3' | '4' | '5';
   errorHttpStatusCode?: ErrorHttpStatusCode;
   exceptionFactory?: (errors: string) => any;
 }
 
+/**
+ * Defines the built-in ParseUUID Pipe
+ *
+ * @see [Built-in Pipes](https://docs.nestjs.com/pipes#built-in-pipes)
+ *
+ * @publicApi
+ */
 @Injectable()
 export class ParseUUIDPipe implements PipeTransform<string> {
   protected static uuidRegExps = {
diff --git a/packages/common/pipes/validation.pipe.ts b/packages/common/pipes/validation.pipe.ts
index fd37802b5..d86326181 100644
--- a/packages/common/pipes/validation.pipe.ts
+++ b/packages/common/pipes/validation.pipe.ts
@@ -18,8 +18,11 @@ import {
   HttpErrorByCode,
 } from '../utils/http-error-by-code.util';
 import { loadPackage } from '../utils/load-package.util';
-import { isNil } from '../utils/shared.utils';
+import { isNil, isUndefined } from '../utils/shared.utils';
 
+/**
+ * @publicApi
+ */
 export interface ValidationPipeOptions extends ValidatorOptions {
   transform?: boolean;
   disableErrorMessages?: boolean;
@@ -35,6 +38,11 @@ export interface ValidationPipeOptions extends ValidatorOptions {
 let classValidator: ValidatorPackage = {} as any;
 let classTransformer: TransformerPackage = {} as any;
 
+/**
+ * @see [Validation](https://docs.nestjs.com/techniques/validation)
+ *
+ * @publicApi
+ */
 @Injectable()
 export class ValidationPipe implements PipeTransform<any> {
   protected isTransformEnabled: boolean;
@@ -58,8 +66,10 @@ export class ValidationPipe implements PipeTransform<any> {
       ...validatorOptions
     } = options;
 
+    // @see https://github.com/nestjs/nest/issues/10683#issuecomment-1413690508
+    this.validatorOptions = { forbidUnknownValues: false, ...validatorOptions };
+
     this.isTransformEnabled = !!transform;
-    this.validatorOptions = validatorOptions;
     this.transformOptions = transformOptions;
     this.isDetailedOutputDisabled = disableErrorMessages;
     this.validateCustomDecorators = validateCustomDecorators || false;
@@ -145,7 +155,11 @@ export class ValidationPipe implements PipeTransform<any> {
       // if the value was originally undefined or null, revert it back
       return originalValue;
     }
-    return Object.keys(this.validatorOptions).length > 0
+    // we check if the number of keys of the "validatorOptions" is higher than 1 (instead of 0)
+    // because the "forbidUnknownValues" now fallbacks to "false" (in case it wasn't explicitly specified)
+    const shouldTransformToPlain =
+      Object.keys(this.validatorOptions).length > 1;
+    return shouldTransformToPlain
       ? classTransformer.classToPlain(entity, this.transformOptions)
       : value;
   }
@@ -179,6 +193,13 @@ export class ValidationPipe implements PipeTransform<any> {
       return value;
     }
     if (metatype === Boolean) {
+      if (isUndefined(value)) {
+        // This is an workaround to deal with optional boolean values since
+        // optional booleans shouldn't be parsed to a valid boolean when
+        // they were not defined
+        return undefined;
+      }
+      // Any fasly value but `undefined` will be parsed to `false`
       return value === true || value === 'true';
     }
     if (metatype === Number) {
diff --git a/packages/common/serializer/class-serializer.interceptor.ts b/packages/common/serializer/class-serializer.interceptor.ts
index c791b1e47..3773fddc0 100644
--- a/packages/common/serializer/class-serializer.interceptor.ts
+++ b/packages/common/serializer/class-serializer.interceptor.ts
@@ -21,11 +21,17 @@ export interface PlainLiteralObject {
 // between core and common packages
 const REFLECTOR = 'Reflector';
 
+/**
+ * @publicApi
+ */
 export interface ClassSerializerInterceptorOptions
   extends ClassTransformOptions {
   transformerPackage?: TransformerPackage;
 }
 
+/**
+ * @publicApi
+ */
 @Injectable()
 export class ClassSerializerInterceptor implements NestInterceptor {
   constructor(
diff --git a/packages/common/serializer/class-serializer.interfaces.ts b/packages/common/serializer/class-serializer.interfaces.ts
index 3b629605e..c5404177c 100644
--- a/packages/common/serializer/class-serializer.interfaces.ts
+++ b/packages/common/serializer/class-serializer.interfaces.ts
@@ -1,6 +1,9 @@
 import { ClassTransformOptions } from '../interfaces/external/class-transform-options.interface';
 import { Type } from '../interfaces';
 
+/**
+ * @publicApi
+ */
 export interface ClassSerializerContextOptions extends ClassTransformOptions {
   type?: Type<any>;
 }
diff --git a/packages/common/serializer/decorators/serialize-options.decorator.ts b/packages/common/serializer/decorators/serialize-options.decorator.ts
index bafdbae7a..bd92695fd 100644
--- a/packages/common/serializer/decorators/serialize-options.decorator.ts
+++ b/packages/common/serializer/decorators/serialize-options.decorator.ts
@@ -2,5 +2,8 @@ import { SetMetadata } from '../../decorators';
 import { ClassSerializerContextOptions } from '../class-serializer.interfaces';
 import { CLASS_SERIALIZER_OPTIONS } from '../class-serializer.constants';
 
+/**
+ * @publicApi
+ */
 export const SerializeOptions = (options: ClassSerializerContextOptions) =>
   SetMetadata(CLASS_SERIALIZER_OPTIONS, options);
diff --git a/packages/common/services/console-logger.service.ts b/packages/common/services/console-logger.service.ts
index addc31673..5b2f4c408 100644
--- a/packages/common/services/console-logger.service.ts
+++ b/packages/common/services/console-logger.service.ts
@@ -1,6 +1,11 @@
 import { Injectable, Optional } from '../decorators/core';
 import { clc, yellow } from '../utils/cli-colors.util';
-import { isPlainObject, isString } from '../utils/shared.utils';
+import {
+  isFunction,
+  isPlainObject,
+  isString,
+  isUndefined,
+} from '../utils/shared.utils';
 import { LoggerService, LogLevel } from './logger.service';
 import { isLogLevelEnabled } from './utils';
 
@@ -23,6 +28,15 @@ const DEFAULT_LOG_LEVELS: LogLevel[] = [
   'verbose',
 ];
 
+const dateTimeFormatter = new Intl.DateTimeFormat(undefined, {
+  year: 'numeric',
+  hour: 'numeric',
+  minute: 'numeric',
+  second: 'numeric',
+  day: '2-digit',
+  month: '2-digit',
+});
+
 @Injectable()
 export class ConsoleLogger implements LoggerService {
   private static lastTimestampAt?: number;
@@ -162,18 +176,7 @@ export class ConsoleLogger implements LoggerService {
   }
 
   protected getTimestamp(): string {
-    const localeStringOptions = {
-      year: 'numeric',
-      hour: 'numeric',
-      minute: 'numeric',
-      second: 'numeric',
-      day: '2-digit',
-      month: '2-digit',
-    };
-    return new Date(Date.now()).toLocaleString(
-      undefined,
-      localeStringOptions as Intl.DateTimeFormatOptions,
-    );
+    return dateTimeFormatter.format(Date.now());
   }
 
   protected printMessages(
@@ -223,7 +226,10 @@ export class ConsoleLogger implements LoggerService {
   }
 
   protected stringifyMessage(message: unknown, logLevel: LogLevel) {
-    return isPlainObject(message) || Array.isArray(message)
+    // If the message is a function, call it and re-resolve its value.
+    return isFunction(message)
+      ? this.stringifyMessage(message(), logLevel)
+      : isPlainObject(message) || Array.isArray(message)
       ? `${this.colorize('Object:', logLevel)}\n${JSON.stringify(
           message,
           (key, value) =>
@@ -245,7 +251,7 @@ export class ConsoleLogger implements LoggerService {
     process.stderr.write(`${stack}\n`);
   }
 
-  private updateAndGetTimestampDiff(): string {
+  protected updateAndGetTimestampDiff(): string {
     const includeTimestamp =
       ConsoleLogger.lastTimestampAt && this.options?.timestamp;
     const result = includeTimestamp
@@ -281,7 +287,8 @@ export class ConsoleLogger implements LoggerService {
     }
     const lastElement = messages[messages.length - 1];
     const isStack = isString(lastElement);
-    if (!isStack) {
+    // https://github.com/nestjs/nest/issues/11074#issuecomment-1421680060
+    if (!isStack && !isUndefined(lastElement)) {
       return { messages, context };
     }
     return {
diff --git a/packages/common/services/logger.service.ts b/packages/common/services/logger.service.ts
index 6f7f38712..0ac2c8378 100644
--- a/packages/common/services/logger.service.ts
+++ b/packages/common/services/logger.service.ts
@@ -1,11 +1,16 @@
-import { Injectable } from '../decorators/core/injectable.decorator';
-import { Optional } from '../decorators/core/optional.decorator';
+import { Injectable, Optional } from '../decorators/core';
 import { isObject } from '../utils/shared.utils';
 import { ConsoleLogger } from './console-logger.service';
 import { isLogLevelEnabled } from './utils';
 
+/**
+ * @publicApi
+ */
 export type LogLevel = 'log' | 'error' | 'warn' | 'debug' | 'verbose';
 
+/**
+ * @publicApi
+ */
 export interface LoggerService {
   /**
    * Write a 'log' level log.
@@ -53,6 +58,18 @@ interface LogBufferRecord {
 
 const DEFAULT_LOGGER = new ConsoleLogger();
 
+const dateTimeFormatter = new Intl.DateTimeFormat(undefined, {
+  year: 'numeric',
+  hour: 'numeric',
+  minute: 'numeric',
+  second: 'numeric',
+  day: '2-digit',
+  month: '2-digit',
+});
+
+/**
+ * @publicApi
+ */
 @Injectable()
 export class Logger implements LoggerService {
   protected static logBuffer = new Array<LogBufferRecord>();
@@ -108,7 +125,9 @@ export class Logger implements LoggerService {
   @Logger.WrapBuffer
   error(message: any, ...optionalParams: any[]) {
     optionalParams = this.context
-      ? optionalParams.concat(this.context)
+      ? (optionalParams.length ? optionalParams : [undefined]).concat(
+          this.context,
+        )
       : optionalParams;
 
     this.localInstance?.error(message, ...optionalParams);
@@ -234,7 +253,7 @@ export class Logger implements LoggerService {
 
   /**
    * Attach buffer.
-   * Turns on initialisation logs buffering.
+   * Turns on initialization logs buffering.
    */
   static attachBuffer() {
     this.isBufferAttached = true;
@@ -242,25 +261,14 @@ export class Logger implements LoggerService {
 
   /**
    * Detach buffer.
-   * Turns off initialisation logs buffering.
+   * Turns off initialization logs buffering.
    */
   static detachBuffer() {
     this.isBufferAttached = false;
   }
 
   static getTimestamp() {
-    const localeStringOptions = {
-      year: 'numeric',
-      hour: 'numeric',
-      minute: 'numeric',
-      second: 'numeric',
-      day: '2-digit',
-      month: '2-digit',
-    };
-    return new Date(Date.now()).toLocaleString(
-      undefined,
-      localeStringOptions as Intl.DateTimeFormatOptions,
-    );
+    return dateTimeFormatter.format(Date.now());
   }
 
   static overrideLogger(logger: LoggerService | LogLevel[] | boolean) {
diff --git a/packages/common/test/decorators/cache.decorator.spec.ts b/packages/common/test/decorators/cache.decorator.spec.ts
deleted file mode 100644
index a207b4180..000000000
--- a/packages/common/test/decorators/cache.decorator.spec.ts
+++ /dev/null
@@ -1,47 +0,0 @@
-import { expect } from 'chai';
-import { CacheKey, CacheInterceptor, CacheTTL } from '../../cache';
-import {
-  CACHE_KEY_METADATA,
-  CACHE_TTL_METADATA,
-} from '../../cache/cache.constants';
-import { UseInterceptors } from '../../decorators';
-import { Controller } from '../../decorators/core/controller.decorator';
-
-describe('@Cache', () => {
-  @Controller('test')
-  @CacheKey('/a_different_cache_key')
-  @CacheTTL(99999)
-  @UseInterceptors(CacheInterceptor)
-  class TestAll {}
-
-  @Controller()
-  @UseInterceptors(CacheInterceptor)
-  @CacheKey('/a_different_cache_key')
-  class TestKey {}
-
-  @Controller()
-  @UseInterceptors(CacheInterceptor)
-  @CacheTTL(99999)
-  class TestTTL {}
-
-  it('should override global defaults for CacheKey and CacheTTL', () => {
-    expect(Reflect.getMetadata(CACHE_KEY_METADATA, TestAll)).to.be.eql(
-      '/a_different_cache_key',
-    );
-    expect(Reflect.getMetadata(CACHE_TTL_METADATA, TestAll)).to.be.greaterThan(
-      9999,
-    );
-  });
-
-  it('should override only the TTL', () => {
-    expect(Reflect.getMetadata(CACHE_TTL_METADATA, TestTTL)).to.be.greaterThan(
-      9999,
-    );
-  });
-
-  it('should override only the Key', () => {
-    expect(Reflect.getMetadata(CACHE_KEY_METADATA, TestKey)).to.be.eql(
-      '/a_different_cache_key',
-    );
-  });
-});
diff --git a/packages/common/test/decorators/injectable.decorator.spec.ts b/packages/common/test/decorators/injectable.decorator.spec.ts
index aba23e043..388ecd710 100644
--- a/packages/common/test/decorators/injectable.decorator.spec.ts
+++ b/packages/common/test/decorators/injectable.decorator.spec.ts
@@ -51,7 +51,7 @@ describe('mixin', () => {
     expect(type.name).to.not.eql('Test');
   });
 
-  it('should not lost the design:parmatypes metadata', () => {
+  it('should not lost the design:paramtypes metadata', () => {
     const type = mixin(Test);
     const constructorParams = Reflect.getMetadata('design:paramtypes', type);
 
diff --git a/packages/common/test/decorators/route-params.decorator.spec.ts b/packages/common/test/decorators/route-params.decorator.spec.ts
index 93c26ab09..b96fcb2c0 100644
--- a/packages/common/test/decorators/route-params.decorator.spec.ts
+++ b/packages/common/test/decorators/route-params.decorator.spec.ts
@@ -1,5 +1,5 @@
 import { expect } from 'chai';
-import { Body, HostParam, Param, Query, Search } from '../../decorators';
+import { Body, HostParam, Param, Query } from '../../decorators';
 import { RequestMethod } from '../../enums/request-method.enum';
 import { All, Delete, Get, Patch, Post, Put } from '../../index';
 
@@ -311,63 +311,6 @@ describe('@Patch', () => {
   });
 });
 
-describe('@Search', () => {
-  const requestPath = 'test';
-  const requestProps = {
-    path: requestPath,
-    method: RequestMethod.SEARCH,
-  };
-
-  const requestPathUsingArray = ['foo', 'bar'];
-  const requestPropsUsingArray = {
-    path: requestPathUsingArray,
-    method: RequestMethod.SEARCH,
-  };
-
-  it('should enhance class with expected request metadata', () => {
-    class Test {
-      @Search(requestPath)
-      public static test() {}
-
-      @Search(requestPathUsingArray)
-      public static testUsingArray() {}
-    }
-
-    const path = Reflect.getMetadata('path', Test.test);
-    const method = Reflect.getMetadata('method', Test.test);
-    const pathUsingArray = Reflect.getMetadata('path', Test.testUsingArray);
-    const methodUsingArray = Reflect.getMetadata('method', Test.testUsingArray);
-
-    expect(path).to.be.eql(requestPath);
-    expect(method).to.be.eql(requestProps.method);
-    expect(pathUsingArray).to.be.eql(requestPathUsingArray);
-    expect(methodUsingArray).to.be.eql(requestPropsUsingArray.method);
-  });
-
-  it('should set path on "/" by default', () => {
-    class Test {
-      @Search()
-      public static test(
-        @Query() query,
-        @Param() params,
-        @HostParam() hostParams,
-      ) {}
-
-      @Search([])
-      public static testUsingArray(
-        @Query() query,
-        @Param() params,
-        @HostParam() hostParams,
-      ) {}
-    }
-
-    const path = Reflect.getMetadata('path', Test.test);
-    const pathUsingArray = Reflect.getMetadata('path', Test.testUsingArray);
-    expect(path).to.be.eql('/');
-    expect(pathUsingArray).to.be.eql('/');
-  });
-});
-
 describe('Inheritance', () => {
   const requestPath = 'test';
   const requestProps = {
diff --git a/packages/common/test/exceptions/http.exception.spec.ts b/packages/common/test/exceptions/http.exception.spec.ts
index 0b7f21ed7..9e8aad94d 100644
--- a/packages/common/test/exceptions/http.exception.spec.ts
+++ b/packages/common/test/exceptions/http.exception.spec.ts
@@ -240,7 +240,7 @@ describe('HttpException', () => {
       expect(cause).to.be.eql(errorCause);
     });
 
-    it('configures a cause when using a bult-in exception with options', () => {
+    it('configures a cause when using a built-in exception with options', () => {
       const builtInErrorClasses = [
         BadGatewayException,
         BadRequestException,
diff --git a/packages/common/test/pipes/file/file-type.validator.spec.ts b/packages/common/test/pipes/file/file-type.validator.spec.ts
index 8b58d1140..ec562aed0 100644
--- a/packages/common/test/pipes/file/file-type.validator.spec.ts
+++ b/packages/common/test/pipes/file/file-type.validator.spec.ts
@@ -1,5 +1,5 @@
-import { FileTypeValidator } from '../../../pipes';
 import { expect } from 'chai';
+import { FileTypeValidator } from '../../../pipes';
 
 describe('FileTypeValidator', () => {
   describe('isValid', () => {
@@ -10,7 +10,7 @@ describe('FileTypeValidator', () => {
 
       const requestFile = {
         mimetype: 'image/jpeg',
-      };
+      } as any;
 
       expect(fileTypeValidator.isValid(requestFile)).to.equal(true);
     });
@@ -22,7 +22,7 @@ describe('FileTypeValidator', () => {
 
       const requestFile = {
         mimetype: 'image/jpeg',
-      };
+      } as any;
 
       expect(fileTypeValidator.isValid(requestFile)).to.equal(true);
     });
@@ -34,7 +34,7 @@ describe('FileTypeValidator', () => {
 
       const requestFile = {
         mimetype: 'application/msword',
-      };
+      } as any;
 
       expect(fileTypeValidator.isValid(requestFile)).to.equal(true);
     });
@@ -46,7 +46,7 @@ describe('FileTypeValidator', () => {
 
       const requestFile = {
         mimetype: 'image/png',
-      };
+      } as any;
 
       expect(fileTypeValidator.isValid(requestFile)).to.equal(false);
     });
@@ -58,7 +58,7 @@ describe('FileTypeValidator', () => {
 
       const requestFile = {
         mimetype: 'image/png',
-      };
+      } as any;
 
       expect(fileTypeValidator.isValid(requestFile)).to.equal(false);
     });
@@ -68,7 +68,7 @@ describe('FileTypeValidator', () => {
         fileType: 'image/jpeg',
       });
 
-      const requestFile = {};
+      const requestFile = {} as any;
 
       expect(fileTypeValidator.isValid(requestFile)).to.equal(false);
     });
diff --git a/packages/common/test/pipes/file/max-file-size.validator.spec.ts b/packages/common/test/pipes/file/max-file-size.validator.spec.ts
index 9ba8e4283..61d49e6e8 100644
--- a/packages/common/test/pipes/file/max-file-size.validator.spec.ts
+++ b/packages/common/test/pipes/file/max-file-size.validator.spec.ts
@@ -12,7 +12,7 @@ describe('MaxFileSizeValidator', () => {
 
       const requestFile = {
         size: 100,
-      };
+      } as any;
 
       expect(maxFileSizeValidator.isValid(requestFile)).to.equal(true);
     });
@@ -24,7 +24,7 @@ describe('MaxFileSizeValidator', () => {
 
       const requestFile = {
         size: oneKb + 1,
-      };
+      } as any;
 
       expect(maxFileSizeValidator.isValid(requestFile)).to.equal(false);
     });
@@ -36,7 +36,7 @@ describe('MaxFileSizeValidator', () => {
 
       const requestFile = {
         size: oneKb,
-      };
+      } as any;
 
       expect(maxFileSizeValidator.isValid(requestFile)).to.equal(false);
     });
diff --git a/packages/common/test/pipes/file/parse-file-pipe.builder.spec.ts b/packages/common/test/pipes/file/parse-file-pipe.builder.spec.ts
index 43f1b29a1..784cea3de 100644
--- a/packages/common/test/pipes/file/parse-file-pipe.builder.spec.ts
+++ b/packages/common/test/pipes/file/parse-file-pipe.builder.spec.ts
@@ -1,7 +1,6 @@
 import { expect } from 'chai';
 import {
   FileTypeValidator,
-  FileTypeValidatorOptions,
   FileValidator,
   MaxFileSizeValidator,
   ParseFilePipeBuilder,
diff --git a/packages/common/test/pipes/parse-array.pipe.spec.ts b/packages/common/test/pipes/parse-array.pipe.spec.ts
index dd5833002..096ab3f9b 100644
--- a/packages/common/test/pipes/parse-array.pipe.spec.ts
+++ b/packages/common/test/pipes/parse-array.pipe.spec.ts
@@ -78,8 +78,11 @@ describe('ParseArrayPipe', () => {
         target = new ParseArrayPipe();
 
         expect(
-          await target.transform('1,2,3', {} as ArgumentMetadata),
-        ).to.be.deep.equal(['1', '2', '3']);
+          await target.transform(
+            '1,2.0,3,{},true,null,,',
+            {} as ArgumentMetadata,
+          ),
+        ).to.be.deep.equal(['1', '2.0', '3', '{}', 'true', 'null', '', '']);
 
         target = new ParseArrayPipe({ separator: '/' });
 
@@ -151,7 +154,10 @@ describe('ParseArrayPipe', () => {
       class ArrItem {}
 
       it('should validate and transform each item', async () => {
-        target = new ParseArrayPipe({ items: ArrItem });
+        target = new ParseArrayPipe({
+          items: ArrItem,
+          forbidUnknownValues: false,
+        });
 
         let items = await target.transform(
           [{}, {}, {}],
@@ -168,13 +174,16 @@ describe('ParseArrayPipe', () => {
 
         target = new ParseArrayPipe({ items: Number });
         expect(
-          await target.transform('1,2,3', {} as ArgumentMetadata),
+          await target.transform('1,2.0,3', {} as ArgumentMetadata),
         ).to.deep.equal([1, 2, 3]);
 
         target = new ParseArrayPipe({ items: String });
         expect(
-          await target.transform('1,2,3', {} as ArgumentMetadata),
-        ).to.deep.equal(['1', '2', '3']);
+          await target.transform(
+            '1,2.0,3,{},true,null,,',
+            {} as ArgumentMetadata,
+          ),
+        ).to.deep.equal(['1', '2.0', '3', '{}', 'true', 'null', '', '']);
 
         target = new ParseArrayPipe({ items: Boolean });
         expect(
diff --git a/packages/common/test/pipes/validation.pipe.spec.ts b/packages/common/test/pipes/validation.pipe.spec.ts
index 00a69a42d..980c43212 100644
--- a/packages/common/test/pipes/validation.pipe.spec.ts
+++ b/packages/common/test/pipes/validation.pipe.spec.ts
@@ -3,12 +3,12 @@ import { expect } from 'chai';
 import * as chaiAsPromised from 'chai-as-promised';
 import { Exclude, Expose, Type } from 'class-transformer';
 import {
+  IsArray,
   IsBoolean,
   IsDefined,
   IsOptional,
   IsString,
   ValidateNested,
-  IsArray,
 } from 'class-validator';
 import { HttpStatus } from '../../enums';
 import { UnprocessableEntityException } from '../../exceptions';
@@ -45,7 +45,7 @@ class TestModel {
   public optionalProp: string;
 }
 
-class TestModelNoValidaton {
+class TestModelNoValidation {
   constructor() {}
 
   public prop1: string;
@@ -221,7 +221,7 @@ describe('ValidationPipe', () => {
         });
       });
       describe('when input is a query parameter (boolean)', () => {
-        it('should parse to boolean', async () => {
+        it('should parse the string "true" to the boolean true', async () => {
           target = new ValidationPipe({ transform: true });
           const value = 'true';
 
@@ -233,9 +233,45 @@ describe('ValidationPipe', () => {
             }),
           ).to.be.true;
         });
+        it('should parse the string "false" to the boolean false', async () => {
+          target = new ValidationPipe({ transform: true });
+          const value = 'false';
+
+          expect(
+            await target.transform(value, {
+              metatype: Boolean,
+              data: 'test',
+              type: 'query',
+            }),
+          ).to.be.false;
+        });
+        it('should parse an empty string to false', async () => {
+          target = new ValidationPipe({ transform: true });
+          const value = '';
+
+          expect(
+            await target.transform(value, {
+              metatype: Boolean,
+              data: 'test',
+              type: 'query',
+            }),
+          ).to.be.false;
+        });
+        it('should parse undefined to undefined', async () => {
+          target = new ValidationPipe({ transform: true });
+          const value = undefined;
+
+          expect(
+            await target.transform(value, {
+              metatype: Boolean,
+              data: 'test',
+              type: 'query',
+            }),
+          ).to.be.undefined;
+        });
       });
       describe('when input is a path parameter (boolean)', () => {
-        it('should parse to boolean', async () => {
+        it('should parse the string "true" to boolean true', async () => {
           target = new ValidationPipe({ transform: true });
           const value = 'true';
 
@@ -247,6 +283,42 @@ describe('ValidationPipe', () => {
             }),
           ).to.be.true;
         });
+        it('should parse the string "false" to boolean false', async () => {
+          target = new ValidationPipe({ transform: true });
+          const value = 'false';
+
+          expect(
+            await target.transform(value, {
+              metatype: Boolean,
+              data: 'test',
+              type: 'param',
+            }),
+          ).to.be.false;
+        });
+        it('should parse an empty string to false', async () => {
+          target = new ValidationPipe({ transform: true });
+          const value = '';
+
+          expect(
+            await target.transform(value, {
+              metatype: Boolean,
+              data: 'test',
+              type: 'param',
+            }),
+          ).to.be.false;
+        });
+        it('should parse undefined to undefined', async () => {
+          target = new ValidationPipe({ transform: true });
+          const value = undefined;
+
+          expect(
+            await target.transform(value, {
+              metatype: Boolean,
+              data: 'test',
+              type: 'param',
+            }),
+          ).to.be.undefined;
+        });
       });
       describe('when validation strips', () => {
         it('should return a TestModel without extra properties', async () => {
@@ -367,7 +439,7 @@ describe('ValidationPipe', () => {
         });
       });
     });
-    describe('when type doesnt match', () => {
+    describe("when type doesn't match", () => {
       describe('when validation rules are applied', () => {
         it('should throw an error', async () => {
           target = new ValidationPipe();
@@ -389,7 +461,7 @@ describe('ValidationPipe', () => {
             { prop1: 'value1', prop2: 'value2', prop3: 'value3' },
           ];
 
-          const objMetadata = { ...metadata, metatype: TestModelNoValidaton };
+          const objMetadata = { ...metadata, metatype: TestModelNoValidation };
           const result = await target.transform(testObj, objMetadata);
 
           expect(result).to.not.be.instanceOf(TestModel);
@@ -447,7 +519,7 @@ describe('ValidationPipe', () => {
       target = new ValidationPipe({ expectedType: TestModel });
       const testObj = { prop1: 'value1', prop2: 'value2' };
 
-      expect(await target.transform(testObj, m)).to.equal(testObj);
+      expect(await target.transform(testObj, m)).to.deep.equal(testObj);
     });
 
     it('should validate against the expected type if presented and metatype is primitive type', async () => {
@@ -460,7 +532,7 @@ describe('ValidationPipe', () => {
       target = new ValidationPipe({ expectedType: TestModel });
       const testObj = { prop1: 'value1', prop2: 'value2' };
 
-      expect(await target.transform(testObj, m)).to.equal(testObj);
+      expect(await target.transform(testObj, m)).to.deep.equal(testObj);
     });
   });
 });
diff --git a/packages/common/test/services/logger.service.spec.ts b/packages/common/test/services/logger.service.spec.ts
index 258e78e6f..6ce8c96c0 100644
--- a/packages/common/test/services/logger.service.spec.ts
+++ b/packages/common/test/services/logger.service.spec.ts
@@ -256,6 +256,34 @@ describe('Logger', () => {
       loggerWithContext.resetContext();
       expect(loggerWithContext['context']).to.equal('context');
     });
+
+    describe('functions for message', () => {
+      let processStdoutWriteSpy: sinon.SinonSpy;
+      const logger = new ConsoleLogger();
+      const message = 'Hello World';
+
+      beforeEach(() => {
+        processStdoutWriteSpy = sinon.spy(process.stdout, 'write');
+      });
+      afterEach(() => {
+        processStdoutWriteSpy.restore();
+      });
+
+      it('works', () => {
+        logger.log(() => message);
+
+        expect(processStdoutWriteSpy.calledOnce).to.be.true;
+        expect(processStdoutWriteSpy.firstCall.firstArg).to.include(message);
+        // Ensure we didn't serialize the function itself.
+        expect(processStdoutWriteSpy.firstCall.firstArg).not.to.include(' => ');
+        expect(processStdoutWriteSpy.firstCall.firstArg).not.to.include(
+          'function',
+        );
+        expect(processStdoutWriteSpy.firstCall.firstArg).not.to.include(
+          'Function',
+        );
+      });
+    });
   });
 
   describe('[instance methods]', () => {
@@ -442,6 +470,17 @@ describe('Logger', () => {
         );
         expect(processStdoutWriteSpy.thirdCall.firstArg).to.include('ms');
       });
+      it('should log out an error to stderr but not include an undefined log', () => {
+        const message = 'message 1';
+
+        logger.error(message);
+
+        expect(processStderrWriteSpy.calledOnce).to.be.true;
+        expect(processStderrWriteSpy.firstCall.firstArg).to.include(
+          `[${globalContext}]`,
+        );
+        expect(processStderrWriteSpy.firstCall.firstArg).to.include(message);
+      });
     });
 
     describe('when logging is disabled', () => {
@@ -480,43 +519,87 @@ describe('Logger', () => {
         warn(message: any, context?: string) {}
       }
 
-      const customLogger = new CustomLogger();
-      const originalLogger = new Logger();
+      describe('with global context', () => {
+        const customLogger = new CustomLogger();
+        const globalContext = 'RandomContext';
+        const originalLogger = new Logger(globalContext);
 
-      let previousLoggerRef: LoggerService;
+        let previousLoggerRef: LoggerService;
 
-      beforeEach(() => {
-        previousLoggerRef =
-          Logger['localInstanceRef'] || Logger['staticInstanceRef'];
-        Logger.overrideLogger(customLogger);
-      });
+        beforeEach(() => {
+          previousLoggerRef =
+            Logger['localInstanceRef'] || Logger['staticInstanceRef'];
+          Logger.overrideLogger(customLogger);
+        });
 
-      afterEach(() => {
-        Logger.overrideLogger(previousLoggerRef);
-      });
+        afterEach(() => {
+          Logger.overrideLogger(previousLoggerRef);
+        });
 
-      it('should call custom logger "#log()" method', () => {
-        const message = 'random message';
-        const context = 'RandomContext';
+        it('should call custom logger "#log()" method with context as second argument', () => {
+          const message = 'random log message with global context';
 
-        const customLoggerLogSpy = sinon.spy(customLogger, 'log');
+          const customLoggerLogSpy = sinon.spy(customLogger, 'log');
 
-        originalLogger.log(message, context);
+          originalLogger.log(message);
 
-        expect(customLoggerLogSpy.called).to.be.true;
-        expect(customLoggerLogSpy.calledWith(message, context)).to.be.true;
+          expect(customLoggerLogSpy.called).to.be.true;
+          expect(customLoggerLogSpy.calledWith(message, globalContext)).to.be
+            .true;
+        });
+        it('should call custom logger "#error()" method with context as third argument', () => {
+          const message = 'random error message with global context';
+
+          const customLoggerErrorSpy = sinon.spy(customLogger, 'error');
+
+          originalLogger.error(message);
+
+          expect(customLoggerErrorSpy.called).to.be.true;
+          expect(
+            customLoggerErrorSpy.calledWith(message, undefined, globalContext),
+          ).to.be.true;
+        });
       });
+      describe('without global context', () => {
+        const customLogger = new CustomLogger();
+        const originalLogger = new Logger();
 
-      it('should call custom logger "#error()" method', () => {
-        const message = 'random message';
-        const context = 'RandomContext';
+        let previousLoggerRef: LoggerService;
 
-        const customLoggerErrorSpy = sinon.spy(customLogger, 'error');
+        beforeEach(() => {
+          previousLoggerRef =
+            Logger['localInstanceRef'] || Logger['staticInstanceRef'];
+          Logger.overrideLogger(customLogger);
+        });
 
-        originalLogger.error(message, context);
+        afterEach(() => {
+          Logger.overrideLogger(previousLoggerRef);
+        });
 
-        expect(customLoggerErrorSpy.called).to.be.true;
-        expect(customLoggerErrorSpy.calledWith(message, context)).to.be.true;
+        it('should call custom logger "#log()" method', () => {
+          const message = 'random message';
+          const context = 'RandomContext';
+
+          const customLoggerLogSpy = sinon.spy(customLogger, 'log');
+
+          originalLogger.log(message, context);
+
+          expect(customLoggerLogSpy.called).to.be.true;
+          expect(customLoggerLogSpy.calledWith(message, context)).to.be.true;
+        });
+
+        it('should call custom logger "#error()" method', () => {
+          const message = 'random message';
+          const context = 'RandomContext';
+
+          const customLoggerErrorSpy = sinon.spy(customLogger, 'error');
+
+          originalLogger.error(message, undefined, context);
+
+          expect(customLoggerErrorSpy.called).to.be.true;
+          expect(customLoggerErrorSpy.calledWith(message, undefined, context))
+            .to.be.true;
+        });
       });
     });
   });
diff --git a/packages/common/test/utils/select-exception-filter-metadata.util.spec.ts b/packages/common/test/utils/select-exception-filter-metadata.util.spec.ts
new file mode 100644
index 000000000..f2fb5b92f
--- /dev/null
+++ b/packages/common/test/utils/select-exception-filter-metadata.util.spec.ts
@@ -0,0 +1,85 @@
+import { expect } from 'chai';
+import { selectExceptionFilterMetadata } from '../../utils/select-exception-filter-metadata.util';
+
+class FirstError {}
+
+class SecondError {}
+
+class ThirdError {}
+
+class FourthError {}
+
+describe('selectExceptionFilterMetadata', () => {
+  it('should pass error handling to first suitable error handler', () => {
+    const metadataList = [
+      {
+        exceptionMetatypes: [FirstError, SecondError],
+        func: () => {},
+      },
+      {
+        exceptionMetatypes: [ThirdError, FourthError],
+        func: () => {},
+      },
+    ];
+
+    expect(
+      selectExceptionFilterMetadata(metadataList, new FourthError()),
+    ).to.be.equal(metadataList[1]);
+  });
+
+  describe('when multiple exception handlers are accepting error handling', () => {
+    it('should pass exception handling to the first one', () => {
+      const metadataList = [
+        {
+          exceptionMetatypes: [FirstError, SecondError],
+          func: () => {},
+        },
+        {
+          exceptionMetatypes: [FirstError, FourthError],
+          func: () => {},
+        },
+      ];
+
+      expect(
+        selectExceptionFilterMetadata(metadataList, new FirstError()),
+      ).to.be.equal(metadataList[0]);
+    });
+  });
+
+  describe('when no exception handler is accepting error handling', () => {
+    it('should return undefined', () => {
+      const metadataList = [
+        {
+          exceptionMetatypes: [FirstError, SecondError],
+          func: () => {},
+        },
+        {
+          exceptionMetatypes: [FirstError, FourthError],
+          func: () => {},
+        },
+      ];
+
+      expect(selectExceptionFilterMetadata(metadataList, new ThirdError())).to
+        .be.undefined;
+    });
+  });
+
+  describe('when exception handler has empty list of meta types', () => {
+    it('should pass any remaining error handling to it', () => {
+      const metadataList = [
+        {
+          exceptionMetatypes: [FirstError, SecondError],
+          func: () => {},
+        },
+        {
+          exceptionMetatypes: [],
+          func: () => {},
+        },
+      ];
+
+      expect(
+        selectExceptionFilterMetadata(metadataList, new ThirdError()),
+      ).to.be.equal(metadataList[1]);
+    });
+  });
+});
diff --git a/packages/common/tsconfig.build.json b/packages/common/tsconfig.build.json
new file mode 100644
index 000000000..2d16c3a20
--- /dev/null
+++ b/packages/common/tsconfig.build.json
@@ -0,0 +1,10 @@
+{
+  "extends": "../tsconfig.build.json",
+  "compilerOptions": {
+    "outDir": ".",
+    "rootDir": ".",
+    "paths": {}
+  },
+  "exclude": ["node_modules", "dist", "test/**/*", "*.spec.ts"],
+  "references": []
+}
diff --git a/packages/common/tsconfig.json b/packages/common/tsconfig.json
index b238080a4..2ae9e3c90 100644
--- a/packages/common/tsconfig.json
+++ b/packages/common/tsconfig.json
@@ -1,7 +1,13 @@
 {
-  "extends": "./../tsconfig.base.json",
+  "extends": "../tsconfig.build.json",
   "compilerOptions": {
-    "baseUrl": "./"
+    "types": ["node"]
   },
-  "include": ["*.ts", "**/*.ts"]
+  "files": [],
+  "include": [],
+  "references": [
+    {
+      "path": "./tsconfig.build.json"
+    }
+  ]
 }
diff --git a/packages/common/utils/forward-ref.util.ts b/packages/common/utils/forward-ref.util.ts
index a43ac6df2..1b380c022 100644
--- a/packages/common/utils/forward-ref.util.ts
+++ b/packages/common/utils/forward-ref.util.ts
@@ -1,5 +1,8 @@
 import { ForwardReference } from '../interfaces/modules/forward-reference.interface';
 
+/**
+ * @publicApi
+ */
 export const forwardRef = (fn: () => any): ForwardReference => ({
   forwardRef: fn,
 });
diff --git a/packages/common/utils/random-string-generator.util.ts b/packages/common/utils/random-string-generator.util.ts
index 6897e6e7d..7e39be7b5 100644
--- a/packages/common/utils/random-string-generator.util.ts
+++ b/packages/common/utils/random-string-generator.util.ts
@@ -1,3 +1,3 @@
-import { v4 as uuid } from 'uuid';
+import { uid } from 'uid';
 
-export const randomStringGenerator = () => uuid();
+export const randomStringGenerator = () => uid(21);
diff --git a/packages/common/utils/select-exception-filter-metadata.util.ts b/packages/common/utils/select-exception-filter-metadata.util.ts
new file mode 100644
index 000000000..e1e1661f5
--- /dev/null
+++ b/packages/common/utils/select-exception-filter-metadata.util.ts
@@ -0,0 +1,13 @@
+import { ExceptionFilterMetadata } from '../interfaces/exceptions';
+
+export const selectExceptionFilterMetadata = <T = any>(
+  filters: ExceptionFilterMetadata[],
+  exception: T,
+): ExceptionFilterMetadata | undefined =>
+  filters.find(
+    ({ exceptionMetatypes }) =>
+      !exceptionMetatypes.length ||
+      exceptionMetatypes.some(
+        ExceptionMetaType => exception instanceof ExceptionMetaType,
+      ),
+  );
diff --git a/packages/common/utils/shared.utils.ts b/packages/common/utils/shared.utils.ts
index 4f9ff6eea..876b41551 100644
--- a/packages/common/utils/shared.utils.ts
+++ b/packages/common/utils/shared.utils.ts
@@ -41,7 +41,8 @@ export const normalizePath = (path?: string): string =>
 export const stripEndSlash = (path: string) =>
   path[path.length - 1] === '/' ? path.slice(0, path.length - 1) : path;
 
-export const isFunction = (val: any): boolean => typeof val === 'function';
+export const isFunction = (val: any): val is Function =>
+  typeof val === 'function';
 export const isString = (val: any): val is string => typeof val === 'string';
 export const isNumber = (val: any): val is number => typeof val === 'number';
 export const isConstructor = (val: any): boolean => val === 'constructor';
diff --git a/packages/core/Readme.md b/packages/core/Readme.md
index 5203ac4c2..16f48336d 100644
--- a/packages/core/Readme.md
+++ b/packages/core/Readme.md
@@ -11,7 +11,6 @@
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
 <a href="https://circleci.com/gh/nestjs/nest" target="_blank"><img src="https://img.shields.io/circleci/build/github/nestjs/nest/master" alt="CircleCI" /></a>
-<a href="https://coveralls.io/github/nestjs/nest?branch=master" target="_blank"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#9" alt="Coverage" /></a>
 <a href="https://discord.gg/G7Qnnhy" target="_blank"><img src="https://img.shields.io/badge/discord-online-brightgreen.svg" alt="Discord"/></a>
 <a href="https://opencollective.com/nest#backer" target="_blank"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
 <a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
@@ -78,7 +77,10 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
  <td>
 <a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
 <a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td><td>
-<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
+<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td>
+<td>
+<a href="https://ridicorp.com/career/" target="_blank"><img src="https://nestjs.com/img/ridi-logo.svg" width="105" valign="middle" /></a></td><td>
+<a href="https://www.movavi.com/imovie-for-windows.html" target="_blank"><img src="https://nestjs.com/img/movavi-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
@@ -91,7 +93,8 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td>
 <td><a href="https://n.inc" target="_blank"><img src="https://nestjs.com/img/n-inc-logo.svg" width="120" valign="middle" /></td></tr><tr>
 <td><a href="https://bilberrry.com/" target="_blank"><img src="https://nestjs.com/img/bilberrry-logo.svg" width="180" valign="middle" /></td>
-<td><a href="https://ipinfo.ai/" target="_blank"><img src="https://nestjs.com/img/ipinfo-logo.png" width="130" valign="middle" /></td></tr>
+<td><a href="https://ipinfo.ai/" target="_blank"><img src="https://nestjs.com/img/ipinfo-logo.png" width="130" valign="middle" /></td>
+<td><a href="https://chax.at" target="_blank"><img src="https://nestjs.com/img/chaxat-logo.png" width="100" valign="middle" /></td></tr>
 </table>
 
 #### Sponsors
@@ -132,7 +135,8 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
    <td align="center" valign="middle"><a href="https://mobilereality.pl/" target="_blank"><img src="https://nestjs.com/img/mobile-reality-logo.png" width="45" valign="middle" /></a></td>
      <td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/boringowl-logo.svg" width="120" valign="middle" /></a></td>
  <td align="center" valign="middle"><a href="https://www.mobilefactory.jp/" target="_blank"><img src="https://nestjs.com/img/mobilefactory-logo.png" width="100" valign="middle" /></a></td>
- <td align="center" valign="middle"><a href="https://db.nordbot.app/" target="_blank"><img src="https://nestjs.com/img/nord-logo.png" width="50" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://nordbot.app/" target="_blank"><img src="https://nestjs.com/img/nordbot-logo.png" width="120" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://doppio.sh/" target="_blank"><img src="https://nestjs.com/img/dopiosh-logo.png" width="50" valign="middle" /></a></td>
   </tr></table>
 
 ## Backers
diff --git a/packages/core/adapters/http-adapter.ts b/packages/core/adapters/http-adapter.ts
index 6bfc4add7..45a01c163 100644
--- a/packages/core/adapters/http-adapter.ts
+++ b/packages/core/adapters/http-adapter.ts
@@ -68,12 +68,6 @@ export abstract class AbstractHttpAdapter<
     return this.instance.all(...args);
   }
 
-  public search(port: string | number, callback?: () => void);
-  public search(port: string | number, hostname: string, callback?: () => void);
-  public search(port: any, hostname?: any, callback?: any) {
-    return this.instance.search(port, hostname, callback);
-  }
-
   public options(handler: RequestHandler);
   public options(path: any, handler: RequestHandler);
   public options(...args: any[]) {
diff --git a/packages/core/constants.ts b/packages/core/constants.ts
index 877226690..6b0f56267 100644
--- a/packages/core/constants.ts
+++ b/packages/core/constants.ts
@@ -1,3 +1,5 @@
+import { EnhancerSubtype } from '@nestjs/common/constants';
+
 export const MESSAGES = {
   APPLICATION_START: `Starting Nest application...`,
   APPLICATION_READY: `Nest application successfully started`,
@@ -12,3 +14,15 @@ export const APP_INTERCEPTOR = 'APP_INTERCEPTOR';
 export const APP_PIPE = 'APP_PIPE';
 export const APP_GUARD = 'APP_GUARD';
 export const APP_FILTER = 'APP_FILTER';
+export const ENHANCER_TOKEN_TO_SUBTYPE_MAP: Record<
+  | typeof APP_GUARD
+  | typeof APP_PIPE
+  | typeof APP_FILTER
+  | typeof APP_INTERCEPTOR,
+  EnhancerSubtype
+> = {
+  [APP_GUARD]: 'guard',
+  [APP_INTERCEPTOR]: 'interceptor',
+  [APP_PIPE]: 'pipe',
+  [APP_FILTER]: 'filter',
+} as const;
diff --git a/packages/core/errors/exceptions/unknown-dependencies.exception.ts b/packages/core/errors/exceptions/unknown-dependencies.exception.ts
index d350952cb..57c7207c8 100644
--- a/packages/core/errors/exceptions/unknown-dependencies.exception.ts
+++ b/packages/core/errors/exceptions/unknown-dependencies.exception.ts
@@ -1,14 +1,18 @@
 import { InjectorDependencyContext } from '../../injector/injector';
+import { Module } from '../../injector/module';
 import { UNKNOWN_DEPENDENCIES_MESSAGE } from '../messages';
 import { RuntimeException } from './runtime.exception';
-import { Module } from '../../injector/module';
 
 export class UnknownDependenciesException extends RuntimeException {
+  public readonly moduleRef: { id: string } | undefined;
+
   constructor(
-    type: string | symbol,
-    unknownDependencyContext: InjectorDependencyContext,
-    module?: Module,
+    public readonly type: string | symbol,
+    public readonly context: InjectorDependencyContext,
+    moduleRef?: Module,
+    public readonly metadata?: { id: string },
   ) {
-    super(UNKNOWN_DEPENDENCIES_MESSAGE(type, unknownDependencyContext, module));
+    super(UNKNOWN_DEPENDENCIES_MESSAGE(type, context, moduleRef));
+    this.moduleRef = moduleRef && { id: moduleRef.id };
   }
 }
diff --git a/packages/core/errors/messages.ts b/packages/core/errors/messages.ts
index 2d327280e..ba33e4f85 100644
--- a/packages/core/errors/messages.ts
+++ b/packages/core/errors/messages.ts
@@ -26,7 +26,7 @@ const getInstanceName = (instance: unknown): string => {
  * Returns the name of the dependency
  * Tries to get the class name, otherwise the string value
  * (= injection token). As fallback it returns '+'
- * @param dependency The dependency whichs name should get displayed
+ * @param dependency The name of the dependency to be displayed
  */
 const getDependencyName = (dependency: InjectorDependency): string =>
   // use class name
@@ -60,20 +60,32 @@ export const UNKNOWN_DEPENDENCIES_MESSAGE = (
     dependencies,
     key,
   } = unknownDependencyContext;
-  const moduleName = getModuleName(module) || 'Module';
+  const moduleName = getModuleName(module);
   const dependencyName = getDependencyName(name);
 
-  let message = `Nest can't resolve dependencies of the ${type.toString()}`;
-
-  const potentialSolutions = `\n
+  const potentialSolutions =
+    // If module's name is well defined
+    moduleName !== 'current'
+      ? `\n
 Potential solutions:
+- Is ${moduleName} a valid NestJS module?
 - If ${dependencyName} is a provider, is it part of the current ${moduleName}?
 - If ${dependencyName} is exported from a separate @Module, is that module imported within ${moduleName}?
   @Module({
     imports: [ /* the Module containing ${dependencyName} */ ]
   })
+`
+      : `\n
+Potential solutions:
+- If ${dependencyName} is a provider, is it part of the current Module?
+- If ${dependencyName} is exported from a separate @Module, is that module imported within Module?
+  @Module({
+    imports: [ /* the Module containing ${dependencyName} */ ]
+  })
 `;
 
+  let message = `Nest can't resolve dependencies of the ${type.toString()}`;
+
   if (isNil(index)) {
     message += `. Please make sure that the "${key.toString()}" property is available in the current context.${potentialSolutions}`;
     return message;
@@ -83,9 +95,7 @@ Potential solutions:
 
   message += ` (`;
   message += dependenciesName.join(', ');
-  message += `). Please make sure that the argument ${dependencyName} at index [${index}] is available in the ${getModuleName(
-    module,
-  )} context.`;
+  message += `). Please make sure that the argument ${dependencyName} at index [${index}] is available in the ${moduleName} context.`;
   message += potentialSolutions;
 
   return message;
diff --git a/packages/core/exceptions/base-exception-filter-context.ts b/packages/core/exceptions/base-exception-filter-context.ts
index aa9971227..40ff0a156 100644
--- a/packages/core/exceptions/base-exception-filter-context.ts
+++ b/packages/core/exceptions/base-exception-filter-context.ts
@@ -50,7 +50,7 @@ export class BaseExceptionFilterContext extends ContextCreator {
       return null;
     }
     const instanceHost = instanceWrapper.getInstanceByContextId(
-      contextId,
+      this.getContextId(contextId, instanceWrapper),
       inquirerId,
     );
     return instanceHost && instanceHost.instance;
diff --git a/packages/core/exceptions/exceptions-handler.ts b/packages/core/exceptions/exceptions-handler.ts
index af54683ae..14290bcd9 100644
--- a/packages/core/exceptions/exceptions-handler.ts
+++ b/packages/core/exceptions/exceptions-handler.ts
@@ -1,9 +1,10 @@
-import { HttpException, Type } from '@nestjs/common';
-import { ExceptionFilterMetadata } from '@nestjs/common/interfaces/exceptions/exception-filter-metadata.interface';
-import { ArgumentsHost } from '@nestjs/common/interfaces/features/arguments-host.interface';
 import { isEmpty } from '@nestjs/common/utils/shared.utils';
-import { InvalidExceptionFilterException } from '../errors/exceptions/invalid-exception-filter.exception';
+import { HttpException } from '@nestjs/common';
+import { ArgumentsHost } from '@nestjs/common/interfaces/features/arguments-host.interface';
+import { ExceptionFilterMetadata } from '@nestjs/common/interfaces/exceptions/exception-filter-metadata.interface';
+import { selectExceptionFilterMetadata } from '@nestjs/common/utils/select-exception-filter-metadata.util';
 import { BaseExceptionFilter } from './base-exception-filter';
+import { InvalidExceptionFilterException } from '../errors/exceptions/invalid-exception-filter.exception';
 
 export class ExceptionsHandler extends BaseExceptionFilter {
   private filters: ExceptionFilterMetadata[] = [];
@@ -29,14 +30,8 @@ export class ExceptionsHandler extends BaseExceptionFilter {
     if (isEmpty(this.filters)) {
       return false;
     }
-    const isInstanceOf = (metatype: Type<unknown>) =>
-      exception instanceof metatype;
 
-    const filter = this.filters.find(({ exceptionMetatypes }) => {
-      const typeExists =
-        !exceptionMetatypes.length || exceptionMetatypes.some(isInstanceOf);
-      return typeExists;
-    });
+    const filter = selectExceptionFilterMetadata(this.filters, exception);
     filter && filter.func(exception, ctx);
     return !!filter;
   }
diff --git a/packages/core/exceptions/external-exceptions-handler.ts b/packages/core/exceptions/external-exceptions-handler.ts
index 15a6e6b3c..9e852ba35 100644
--- a/packages/core/exceptions/external-exceptions-handler.ts
+++ b/packages/core/exceptions/external-exceptions-handler.ts
@@ -1,9 +1,9 @@
-import { Type } from '@nestjs/common';
-import { ExceptionFilterMetadata } from '@nestjs/common/interfaces/exceptions';
-import { ArgumentsHost } from '@nestjs/common/interfaces/features/arguments-host.interface';
 import { isEmpty } from '@nestjs/common/utils/shared.utils';
-import { InvalidExceptionFilterException } from '../errors/exceptions/invalid-exception-filter.exception';
+import { ArgumentsHost } from '@nestjs/common/interfaces/features/arguments-host.interface';
+import { ExceptionFilterMetadata } from '@nestjs/common/interfaces/exceptions';
+import { selectExceptionFilterMetadata } from '@nestjs/common/utils/select-exception-filter-metadata.util';
 import { ExternalExceptionFilter } from './external-exception-filter';
+import { InvalidExceptionFilterException } from '../errors/exceptions/invalid-exception-filter.exception';
 
 export class ExternalExceptionsHandler extends ExternalExceptionFilter {
   private filters: ExceptionFilterMetadata[] = [];
@@ -30,14 +30,8 @@ export class ExternalExceptionsHandler extends ExternalExceptionFilter {
     if (isEmpty(this.filters)) {
       return null;
     }
-    const isInstanceOf = (metatype: Type<unknown>) =>
-      exception instanceof metatype;
 
-    const filter = this.filters.find(({ exceptionMetatypes }) => {
-      const typeExists =
-        !exceptionMetatypes.length || exceptionMetatypes.some(isInstanceOf);
-      return typeExists;
-    });
+    const filter = selectExceptionFilterMetadata(this.filters, exception);
     return filter ? filter.func(exception, host) : null;
   }
 }
diff --git a/packages/core/guards/guards-context-creator.ts b/packages/core/guards/guards-context-creator.ts
index e82a8fb04..7c9963b3a 100644
--- a/packages/core/guards/guards-context-creator.ts
+++ b/packages/core/guards/guards-context-creator.ts
@@ -69,7 +69,7 @@ export class GuardsContextCreator extends ContextCreator {
       return null;
     }
     const instanceHost = instanceWrapper.getInstanceByContextId(
-      contextId,
+      this.getContextId(contextId, instanceWrapper),
       inquirerId,
     );
     return instanceHost && instanceHost.instance;
@@ -104,7 +104,12 @@ export class GuardsContextCreator extends ContextCreator {
     const scopedGuardWrappers =
       this.config.getGlobalRequestGuards() as InstanceWrapper[];
     const scopedGuards = iterate(scopedGuardWrappers)
-      .map(wrapper => wrapper.getInstanceByContextId(contextId, inquirerId))
+      .map(wrapper =>
+        wrapper.getInstanceByContextId(
+          this.getContextId(contextId, wrapper),
+          inquirerId,
+        ),
+      )
       .filter(host => !!host)
       .map(host => host.instance)
       .toArray();
diff --git a/packages/core/helpers/context-creator.ts b/packages/core/helpers/context-creator.ts
index 5028cc973..fa8c9c4ac 100644
--- a/packages/core/helpers/context-creator.ts
+++ b/packages/core/helpers/context-creator.ts
@@ -1,6 +1,6 @@
 import { Controller } from '@nestjs/common/interfaces';
 import { STATIC_CONTEXT } from '../injector/constants';
-import { ContextId } from '../injector/instance-wrapper';
+import { ContextId, InstanceWrapper } from '../injector/instance-wrapper';
 
 export abstract class ContextCreator {
   public abstract createConcreteContext<T extends any[], R extends any[]>(
@@ -51,4 +51,16 @@ export abstract class ContextCreator {
   ): T {
     return Reflect.getMetadata(metadataKey, callback);
   }
+
+  protected getContextId(
+    contextId: ContextId,
+    instanceWrapper: InstanceWrapper,
+  ): ContextId {
+    return contextId.getParent
+      ? contextId.getParent({
+          token: instanceWrapper.token,
+          isTreeDurable: instanceWrapper.isDependencyTreeDurable(),
+        })
+      : contextId;
+  }
 }
diff --git a/packages/core/helpers/external-context-creator.ts b/packages/core/helpers/external-context-creator.ts
index 54212533e..83ef9994d 100644
--- a/packages/core/helpers/external-context-creator.ts
+++ b/packages/core/helpers/external-context-creator.ts
@@ -5,20 +5,20 @@ import {
   Controller,
   PipeTransform,
 } from '@nestjs/common/interfaces';
-import { isEmpty, isFunction } from '@nestjs/common/utils/shared.utils';
+import { isEmpty } from '@nestjs/common/utils/shared.utils';
 import { lastValueFrom, isObservable } from 'rxjs';
 import { ExternalExceptionFilterContext } from '../exceptions/external-exception-filter-context';
 import { FORBIDDEN_MESSAGE } from '../guards/constants';
-import { GuardsConsumer } from '../guards/guards-consumer';
-import { GuardsContextCreator } from '../guards/guards-context-creator';
+import { GuardsConsumer, GuardsContextCreator } from '../guards';
 import { STATIC_CONTEXT } from '../injector/constants';
 import { NestContainer } from '../injector/container';
 import { ContextId } from '../injector/instance-wrapper';
 import { ModulesContainer } from '../injector/modules-container';
-import { InterceptorsConsumer } from '../interceptors/interceptors-consumer';
-import { InterceptorsContextCreator } from '../interceptors/interceptors-context-creator';
-import { PipesConsumer } from '../pipes/pipes-consumer';
-import { PipesContextCreator } from '../pipes/pipes-context-creator';
+import {
+  InterceptorsConsumer,
+  InterceptorsContextCreator,
+} from '../interceptors';
+import { PipesConsumer, PipesContextCreator } from '../pipes';
 import { ContextUtils, ParamProperties } from './context-utils';
 import { ExternalErrorProxy } from './external-proxy';
 import { HandlerMetadataStorage } from './handler-metadata-storage';
diff --git a/packages/core/helpers/index.ts b/packages/core/helpers/index.ts
index 5319266f1..76f854606 100644
--- a/packages/core/helpers/index.ts
+++ b/packages/core/helpers/index.ts
@@ -1,2 +1,3 @@
 export * from './context-id-factory';
+export * from './external-context-creator';
 export * from './http-adapter-host';
diff --git a/packages/core/index.ts b/packages/core/index.ts
index 1babf6c15..511eac90d 100644
--- a/packages/core/index.ts
+++ b/packages/core/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @core
- * Copyright(c) 2017 - 2022 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2023 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
@@ -13,6 +13,7 @@ export * from './discovery';
 export * from './exceptions';
 export * from './helpers';
 export * from './injector';
+export * from './inspector';
 export * from './metadata-scanner';
 export * from './middleware';
 export * from './nest-application';
diff --git a/packages/core/injector/compiler.ts b/packages/core/injector/compiler.ts
index 6c707fd61..353e27581 100644
--- a/packages/core/injector/compiler.ts
+++ b/packages/core/injector/compiler.ts
@@ -1,4 +1,8 @@
-import { DynamicModule, Type } from '@nestjs/common/interfaces';
+import {
+  DynamicModule,
+  ForwardReference,
+  Type,
+} from '@nestjs/common/interfaces';
 import { ModuleTokenFactory } from './module-token-factory';
 
 export interface ModuleFactory {
@@ -18,19 +22,25 @@ export class ModuleCompiler {
     return { type, dynamicMetadata, token };
   }
 
-  public extractMetadata(metatype: Type<any> | DynamicModule): {
+  public extractMetadata(
+    metatype: Type<any> | ForwardReference | DynamicModule,
+  ): {
     type: Type<any>;
     dynamicMetadata?: Partial<DynamicModule> | undefined;
   } {
     if (!this.isDynamicModule(metatype)) {
-      return { type: metatype };
+      return {
+        type: (metatype as ForwardReference)?.forwardRef
+          ? (metatype as ForwardReference).forwardRef()
+          : metatype,
+      };
     }
     const { module: type, ...dynamicMetadata } = metatype;
     return { type, dynamicMetadata };
   }
 
   public isDynamicModule(
-    module: Type<any> | DynamicModule,
+    module: Type<any> | DynamicModule | ForwardReference,
   ): module is DynamicModule {
     return !!(module as DynamicModule).module;
   }
diff --git a/packages/core/injector/container.ts b/packages/core/injector/container.ts
index 6fed38280..2522eabed 100644
--- a/packages/core/injector/container.ts
+++ b/packages/core/injector/container.ts
@@ -1,13 +1,17 @@
 import { DynamicModule, Provider } from '@nestjs/common';
-import { GLOBAL_MODULE_METADATA } from '@nestjs/common/constants';
-import { Injectable } from '@nestjs/common/interfaces/injectable.interface';
-import { Type } from '@nestjs/common/interfaces/type.interface';
+import {
+  EnhancerSubtype,
+  GLOBAL_MODULE_METADATA,
+} from '@nestjs/common/constants';
+import { Injectable, Type } from '@nestjs/common/interfaces';
 import { ApplicationConfig } from '../application-config';
 import {
   CircularDependencyException,
   UndefinedForwardRefException,
   UnknownModuleException,
 } from '../errors/exceptions';
+import { InitializeOnPreviewAllowlist } from '../inspector/initialize-on-preview.allowlist';
+import { SerializedGraph } from '../inspector/serialized-graph';
 import { REQUEST } from '../router/request/request-constants';
 import { ModuleCompiler } from './compiler';
 import { ContextId } from './instance-wrapper';
@@ -27,12 +31,17 @@ export class NestContainer {
     Partial<DynamicModule>
   >();
   private readonly internalProvidersStorage = new InternalProvidersStorage();
+  private readonly _serializedGraph = new SerializedGraph();
   private internalCoreModule: Module;
 
   constructor(
     private readonly _applicationConfig: ApplicationConfig = undefined,
   ) {}
 
+  get serializedGraph(): SerializedGraph {
+    return this._serializedGraph;
+  }
+
   get applicationConfig(): ApplicationConfig | undefined {
     return this._applicationConfig;
   }
@@ -72,15 +81,14 @@ export class NestContainer {
     }
     const moduleRef = new Module(type, this);
     moduleRef.token = token;
+    moduleRef.initOnPreview = this.shouldInitOnPreview(type);
     this.modules.set(token, moduleRef);
 
-    await this.addDynamicMetadata(
-      token,
-      dynamicMetadata,
-      [].concat(scope, type),
-    );
+    const updatedScope = [].concat(scope, type);
+    await this.addDynamicMetadata(token, dynamicMetadata, updatedScope);
 
     if (this.isGlobalModule(type, dynamicMetadata)) {
+      moduleRef.isGlobal = true;
       this.addGlobalModule(moduleRef);
     }
     return moduleRef;
@@ -155,6 +163,7 @@ export class NestContainer {
   public addProvider(
     provider: Provider,
     token: string,
+    enhancerSubtype?: EnhancerSubtype,
   ): string | symbol | Function {
     const moduleRef = this.modules.get(token);
     if (!provider) {
@@ -163,19 +172,20 @@ export class NestContainer {
     if (!moduleRef) {
       throw new UnknownModuleException();
     }
-    return moduleRef.addProvider(provider);
+    return moduleRef.addProvider(provider, enhancerSubtype) as Function;
   }
 
   public addInjectable(
     injectable: Provider,
     token: string,
+    enhancerSubtype: EnhancerSubtype,
     host?: Type<Injectable>,
   ) {
     if (!this.modules.has(token)) {
       throw new UnknownModuleException();
     }
     const moduleRef = this.modules.get(token);
-    moduleRef.addInjectable(injectable, host);
+    return moduleRef.addInjectable(injectable, enhancerSubtype, host);
   }
 
   public addExportedProvider(provider: Type<any>, token: string) {
@@ -219,15 +229,16 @@ export class NestContainer {
     target.addRelatedModule(globalModule);
   }
 
+  public getDynamicMetadataByToken(token: string): Partial<DynamicModule>;
+  public getDynamicMetadataByToken<
+    K extends Exclude<keyof DynamicModule, 'global' | 'module'>,
+  >(token: string, metadataKey: K): DynamicModule[K];
   public getDynamicMetadataByToken(
     token: string,
-    metadataKey: keyof DynamicModule,
+    metadataKey?: Exclude<keyof DynamicModule, 'global' | 'module'>,
   ) {
     const metadata = this.dynamicModulesMetadata.get(token);
-    if (metadata && metadata[metadataKey]) {
-      return metadata[metadataKey] as any[];
-    }
-    return [];
+    return metadataKey ? metadata?.[metadataKey] ?? [] : metadata;
   }
 
   public registerCoreModuleRef(moduleRef: Module) {
@@ -246,4 +257,8 @@ export class NestContainer {
       isResolved: true,
     });
   }
+
+  private shouldInitOnPreview(type: Type) {
+    return InitializeOnPreviewAllowlist.has(type);
+  }
 }
diff --git a/packages/core/injector/helpers/transient-instances.ts b/packages/core/injector/helpers/transient-instances.ts
index 17287ef80..4e7f4afd6 100644
--- a/packages/core/injector/helpers/transient-instances.ts
+++ b/packages/core/injector/helpers/transient-instances.ts
@@ -1,13 +1,13 @@
+import { InjectionToken } from '@nestjs/common';
 import { iterate } from 'iterare';
 import { InstanceWrapper } from '../instance-wrapper';
-import { InstanceToken } from '../module';
 
 /**
  * Returns the instances which are transient
- * @param instances The instances which should be checked whether they are transcient
+ * @param instances The instances which should be checked whether they are transient
  */
 export function getTransientInstances(
-  instances: [InstanceToken, InstanceWrapper][],
+  instances: [InjectionToken, InstanceWrapper][],
 ): InstanceWrapper[] {
   return iterate(instances)
     .filter(([_, wrapper]) => wrapper.isDependencyTreeStatic())
@@ -20,10 +20,10 @@ export function getTransientInstances(
 
 /**
  * Returns the instances which are not transient
- * @param instances The instances which should be checked whether they are transcient
+ * @param instances The instances which should be checked whether they are transient
  */
 export function getNonTransientInstances(
-  instances: [InstanceToken, InstanceWrapper][],
+  instances: [InjectionToken, InstanceWrapper][],
 ): InstanceWrapper[] {
   return iterate(instances)
     .filter(
diff --git a/packages/core/injector/injector.ts b/packages/core/injector/injector.ts
index 525077ce3..07361bfd9 100644
--- a/packages/core/injector/injector.ts
+++ b/packages/core/injector/injector.ts
@@ -22,6 +22,7 @@ import {
   isUndefined,
 } from '@nestjs/common/utils/shared.utils';
 import { iterate } from 'iterare';
+import { performance } from 'perf_hooks';
 import { RuntimeException } from '../errors/exceptions/runtime.exception';
 import { UndefinedDependencyException } from '../errors/exceptions/undefined-dependency.exception';
 import { UnknownDependenciesException } from '../errors/exceptions/unknown-dependencies.exception';
@@ -33,7 +34,7 @@ import {
   InstanceWrapper,
   PropertyMetadata,
 } from './instance-wrapper';
-import { InstanceToken, Module } from './module';
+import { Module } from './module';
 
 /**
  * The type of an injectable dependency
@@ -77,9 +78,11 @@ export interface InjectorDependencyContext {
 export class Injector {
   private logger: LoggerService = new Logger('InjectorLogger');
 
+  constructor(private readonly options?: { preview: boolean }) {}
+
   public loadPrototype<T>(
     { token }: InstanceWrapper<T>,
-    collection: Map<InstanceToken, InstanceWrapper<T>>,
+    collection: Map<InjectionToken, InstanceWrapper<T>>,
     contextId = STATIC_CONTEXT,
   ) {
     if (!collection) {
@@ -98,7 +101,7 @@ export class Injector {
 
   public async loadInstance<T>(
     wrapper: InstanceWrapper<T>,
-    collection: Map<InstanceToken, InstanceWrapper>,
+    collection: Map<InjectionToken, InstanceWrapper>,
     moduleRef: Module,
     contextId = STATIC_CONTEXT,
     inquirer?: InstanceWrapper,
@@ -127,6 +130,7 @@ export class Injector {
       return done();
     }
     try {
+      const t0 = this.getNowTimestamp();
       const callback = async (instances: unknown[]) => {
         const properties = await this.resolveProperties(
           wrapper,
@@ -144,6 +148,7 @@ export class Injector {
           inquirer,
         );
         this.applyProperties(instance, properties);
+        wrapper.initTime = this.getNowTimestamp() - t0;
         done();
       };
       await this.resolveConstructorParams<T>(
@@ -163,7 +168,7 @@ export class Injector {
 
   public async loadMiddleware(
     wrapper: InstanceWrapper,
-    collection: Map<InstanceToken, InstanceWrapper>,
+    collection: Map<InjectionToken, InstanceWrapper>,
     moduleRef: Module,
     contextId = STATIC_CONTEXT,
     inquirer?: InstanceWrapper,
@@ -351,7 +356,9 @@ export class Injector {
   }
 
   public reflectConstructorParams<T>(type: Type<T>): any[] {
-    const paramtypes = Reflect.getMetadata(PARAMTYPES_METADATA, type) || [];
+    const paramtypes = [
+      ...(Reflect.getMetadata(PARAMTYPES_METADATA, type) || []),
+    ];
     const selfParams = this.reflectSelfParams<T>(type);
 
     selfParams.forEach(({ index, param }) => (paramtypes[index] = param));
@@ -410,7 +417,7 @@ export class Injector {
 
   public async resolveComponentInstance<T>(
     moduleRef: Module,
-    token: InstanceToken,
+    token: InjectionToken,
     dependencyContext: InjectorDependencyContext,
     wrapper: InstanceWrapper<T>,
     contextId = STATIC_CONTEXT,
@@ -500,6 +507,7 @@ export class Injector {
         wrapper.name,
         dependencyContext,
         moduleRef,
+        { id: wrapper.id },
       );
     }
     if (providers.has(name)) {
@@ -540,6 +548,7 @@ export class Injector {
         wrapper.name,
         dependencyContext,
         moduleRef,
+        { id: wrapper.id },
       );
     }
     return instanceWrapper;
@@ -547,7 +556,7 @@ export class Injector {
 
   public async lookupComponentInImports(
     moduleRef: Module,
-    name: InstanceToken,
+    name: InjectionToken,
     wrapper: InstanceWrapper,
     moduleRegistry: any[] = [],
     contextId = STATIC_CONTEXT,
@@ -713,6 +722,11 @@ export class Injector {
       wrapper.isLazyTransient(contextId, inquirer) ||
       wrapper.isExplicitlyRequested(contextId, inquirer);
 
+    if (this.options?.preview && !wrapper.host?.initOnPreview) {
+      instanceHost.isResolved = true;
+      return instanceHost.instance;
+    }
+
     if (isNil(inject) && isInContext) {
       instanceHost.instance = wrapper.forwardRef
         ? Object.assign(
@@ -733,7 +747,7 @@ export class Injector {
   public async loadPerContext<T = any>(
     instance: T,
     moduleRef: Module,
-    collection: Map<InstanceToken, InstanceWrapper>,
+    collection: Map<InjectionToken, InstanceWrapper>,
     ctx: ContextId,
     wrapper?: InstanceWrapper,
   ): Promise<T> {
@@ -864,12 +878,12 @@ export class Injector {
     }
   }
 
-  private getTokenName(token: InstanceToken): string {
+  private getTokenName(token: InjectionToken): string {
     return isFunction(token) ? (token as Function).name : token.toString();
   }
 
   private printResolvingDependenciesLog(
-    token: InstanceToken,
+    token: InjectionToken,
     inquirer?: InstanceWrapper,
   ): void {
     if (!this.isDebugMode()) {
@@ -890,7 +904,7 @@ export class Injector {
   }
 
   private printLookingForProviderLog(
-    token: InstanceToken,
+    token: InjectionToken,
     moduleRef: Module,
   ): void {
     if (!this.isDebugMode()) {
@@ -905,7 +919,10 @@ export class Injector {
     );
   }
 
-  private printFoundInModuleLog(token: InstanceToken, moduleRef: Module): void {
+  private printFoundInModuleLog(
+    token: InjectionToken,
+    moduleRef: Module,
+  ): void {
     if (!this.isDebugMode()) {
       return;
     }
@@ -933,4 +950,8 @@ export class Injector {
         })
       : contextId;
   }
+
+  private getNowTimestamp() {
+    return performance.now();
+  }
 }
diff --git a/packages/core/injector/instance-links-host.ts b/packages/core/injector/instance-links-host.ts
index e70f2e642..bd6839e30 100644
--- a/packages/core/injector/instance-links-host.ts
+++ b/packages/core/injector/instance-links-host.ts
@@ -1,32 +1,33 @@
+import { InjectionToken } from '@nestjs/common';
 import { isFunction } from '@nestjs/common/utils/shared.utils';
 import { UnknownElementException } from '../errors/exceptions/unknown-element.exception';
 import { NestContainer } from './container';
 import { InstanceWrapper } from './instance-wrapper';
-import { InstanceToken, Module } from './module';
+import { Module } from './module';
 
 type HostCollection = 'providers' | 'controllers' | 'injectables';
 
 export interface InstanceLink<T = any> {
-  token: InstanceToken;
+  token: InjectionToken;
   wrapperRef: InstanceWrapper<T>;
   collection: Map<any, InstanceWrapper>;
   moduleId: string;
 }
 
 export class InstanceLinksHost {
-  private readonly instanceLinks = new Map<InstanceToken, InstanceLink[]>();
+  private readonly instanceLinks = new Map<InjectionToken, InstanceLink[]>();
 
   constructor(private readonly container: NestContainer) {
     this.initialize();
   }
 
-  get<T = any>(token: InstanceToken): InstanceLink<T>;
+  get<T = any>(token: InjectionToken): InstanceLink<T>;
   get<T = any>(
-    token: InstanceToken,
+    token: InjectionToken,
     options?: { moduleId?: string; each?: boolean },
   ): InstanceLink<T> | Array<InstanceLink<T>>;
   get<T = any>(
-    token: InstanceToken,
+    token: InjectionToken,
     options: { moduleId?: string; each?: boolean } = {},
   ): InstanceLink<T> | Array<InstanceLink<T>> {
     const instanceLinksForGivenToken = this.instanceLinks.get(token);
@@ -69,7 +70,7 @@ export class InstanceLinksHost {
 
   private addLink(
     wrapper: InstanceWrapper,
-    token: InstanceToken,
+    token: InjectionToken,
     moduleRef: Module,
     collectionName: HostCollection,
   ) {
@@ -87,7 +88,7 @@ export class InstanceLinksHost {
     }
   }
 
-  private getInstanceNameByToken(token: InstanceToken): string {
+  private getInstanceNameByToken(token: InjectionToken): string {
     return isFunction(token) ? (token as Function)?.name : (token as string);
   }
 }
diff --git a/packages/core/injector/instance-loader.ts b/packages/core/injector/instance-loader.ts
index 1b9ecb656..489ffdef4 100644
--- a/packages/core/injector/instance-loader.ts
+++ b/packages/core/injector/instance-loader.ts
@@ -1,17 +1,19 @@
-import { Logger } from '@nestjs/common';
+import { Logger, LoggerService } from '@nestjs/common';
 import { Controller } from '@nestjs/common/interfaces/controllers/controller.interface';
 import { Injectable } from '@nestjs/common/interfaces/injectable.interface';
 import { MODULE_INIT_MESSAGE } from '../helpers/messages';
+import { GraphInspector } from '../inspector/graph-inspector';
 import { NestContainer } from './container';
 import { Injector } from './injector';
 import { InternalCoreModule } from './internal-core-module/internal-core-module';
 import { Module } from './module';
 
-export class InstanceLoader {
-  protected readonly injector = new Injector();
+export class InstanceLoader<TInjector extends Injector = Injector> {
   constructor(
     protected readonly container: NestContainer,
-    private logger = new Logger(InstanceLoader.name, {
+    protected readonly injector: TInjector,
+    protected readonly graphInspector: GraphInspector,
+    private logger: LoggerService = new Logger(InstanceLoader.name, {
       timestamp: true,
     }),
   ) {}
@@ -24,7 +26,15 @@ export class InstanceLoader {
     modules: Map<string, Module> = this.container.getModules(),
   ) {
     this.createPrototypes(modules);
-    await this.createInstances(modules);
+
+    try {
+      await this.createInstances(modules);
+    } catch (err) {
+      this.graphInspector.inspectModules(modules);
+      this.graphInspector.registerPartial(err);
+      throw err;
+    }
+    this.graphInspector.inspectModules(modules);
   }
 
   private createPrototypes(modules: Map<string, Module>) {
@@ -42,7 +52,7 @@ export class InstanceLoader {
         await this.createInstancesOfInjectables(moduleRef);
         await this.createInstancesOfControllers(moduleRef);
 
-        const { name } = moduleRef.metatype;
+        const { name } = moduleRef;
         this.isModuleWhitelisted(name) &&
           this.logger.log(MODULE_INIT_MESSAGE`${name}`);
       }),
@@ -60,7 +70,10 @@ export class InstanceLoader {
     const { providers } = moduleRef;
     const wrappers = [...providers.values()];
     await Promise.all(
-      wrappers.map(item => this.injector.loadProvider(item, moduleRef)),
+      wrappers.map(async item => {
+        await this.injector.loadProvider(item, moduleRef);
+        this.graphInspector.inspectInstanceWrapper(item, moduleRef);
+      }),
     );
   }
 
@@ -75,7 +88,10 @@ export class InstanceLoader {
     const { controllers } = moduleRef;
     const wrappers = [...controllers.values()];
     await Promise.all(
-      wrappers.map(item => this.injector.loadController(item, moduleRef)),
+      wrappers.map(async item => {
+        await this.injector.loadController(item, moduleRef);
+        this.graphInspector.inspectInstanceWrapper(item, moduleRef);
+      }),
     );
   }
 
@@ -90,7 +106,10 @@ export class InstanceLoader {
     const { injectables } = moduleRef;
     const wrappers = [...injectables.values()];
     await Promise.all(
-      wrappers.map(item => this.injector.loadInjectable(item, moduleRef)),
+      wrappers.map(async item => {
+        await this.injector.loadInjectable(item, moduleRef);
+        this.graphInspector.inspectInstanceWrapper(item, moduleRef);
+      }),
     );
   }
 
diff --git a/packages/core/injector/instance-wrapper.ts b/packages/core/injector/instance-wrapper.ts
index 7c8b93a07..d29ae711d 100644
--- a/packages/core/injector/instance-wrapper.ts
+++ b/packages/core/injector/instance-wrapper.ts
@@ -1,5 +1,6 @@
 import { Logger, LoggerService, Provider, Scope, Type } from '@nestjs/common';
-import { FactoryProvider } from '@nestjs/common/interfaces';
+import { EnhancerSubtype } from '@nestjs/common/constants';
+import { FactoryProvider, InjectionToken } from '@nestjs/common/interfaces';
 import { clc } from '@nestjs/common/utils/cli-colors.util';
 import { randomStringGenerator } from '@nestjs/common/utils/random-string-generator.util';
 import {
@@ -8,13 +9,14 @@ import {
   isUndefined,
 } from '@nestjs/common/utils/shared.utils';
 import { iterate } from 'iterare';
+import { UuidFactory } from '../inspector/uuid-factory';
 import { STATIC_CONTEXT } from './constants';
 import {
   isClassProvider,
   isFactoryProvider,
   isValueProvider,
 } from './helpers/provider-classifier';
-import { InstanceToken, Module } from './module';
+import { Module } from './module';
 
 export const INSTANCE_METADATA_SYMBOL = Symbol.for('instance_metadata:cache');
 export const INSTANCE_ID_SYMBOL = Symbol.for('instance_metadata:id');
@@ -23,7 +25,7 @@ export interface HostComponentInfo {
   /**
    * Injection token (or class reference)
    */
-  token: InstanceToken;
+  token: InjectionToken;
   /**
    * Flag that indicates whether DI subtree is durable
    */
@@ -56,16 +58,18 @@ interface InstanceMetadataStore {
 
 export class InstanceWrapper<T = any> {
   public readonly name: any;
-  public readonly token: InstanceToken;
+  public readonly token: InjectionToken;
   public readonly async?: boolean;
   public readonly host?: Module;
   public readonly isAlias: boolean = false;
+  public readonly subtype?: EnhancerSubtype;
 
   public scope?: Scope = Scope.DEFAULT;
   public metatype: Type<T> | Function;
   public inject?: FactoryProvider['inject'];
   public forwardRef?: boolean;
   public durable?: boolean;
+  public initTime?: number;
 
   private static logger: LoggerService = new Logger(InstanceWrapper.name);
 
@@ -81,8 +85,9 @@ export class InstanceWrapper<T = any> {
   constructor(
     metadata: Partial<InstanceWrapper<T>> & Partial<InstancePerContext<T>> = {},
   ) {
-    this[INSTANCE_ID_SYMBOL] = randomStringGenerator();
     this.initialize(metadata);
+    this[INSTANCE_ID_SYMBOL] =
+      metadata[INSTANCE_ID_SYMBOL] ?? this.generateUuid();
   }
 
   get id(): string {
@@ -199,23 +204,28 @@ export class InstanceWrapper<T = any> {
     if (!isUndefined(this.isTreeDurable)) {
       return this.isTreeDurable;
     }
-    if (this.durable === true) {
-      this.isTreeDurable = true;
-      this.printIntrospectedAsDurable();
+    if (this.scope === Scope.REQUEST) {
+      this.isTreeDurable = this.durable === undefined ? false : this.durable;
+      if (this.isTreeDurable) {
+        this.printIntrospectedAsDurable();
+      }
       return this.isTreeDurable;
     }
     const isStatic = this.isDependencyTreeStatic();
     if (isStatic) {
       return false;
     }
+
     const isTreeNonDurable = this.introspectDepsAttribute(
       (collection, registry) =>
-        collection.every(
-          (item: InstanceWrapper) => !item.isDependencyTreeDurable(registry),
+        collection.some(
+          (item: InstanceWrapper) =>
+            !item.isDependencyTreeStatic() &&
+            !item.isDependencyTreeDurable(registry),
         ),
       lookupRegistry,
     );
-    this.isTreeDurable = !isTreeNonDurable && this.durable !== false;
+    this.isTreeDurable = !isTreeNonDurable;
     if (this.isTreeDurable) {
       this.printIntrospectedAsDurable();
     }
@@ -230,26 +240,30 @@ export class InstanceWrapper<T = any> {
     lookupRegistry: string[] = [],
   ): boolean {
     if (lookupRegistry.includes(this[INSTANCE_ID_SYMBOL])) {
-      return true;
+      return false;
     }
     lookupRegistry = lookupRegistry.concat(this[INSTANCE_ID_SYMBOL]);
 
     const { dependencies, properties, enhancers } =
       this[INSTANCE_METADATA_SYMBOL];
 
-    let introspectionResult =
-      (dependencies && callback(dependencies, lookupRegistry)) || !dependencies;
+    let introspectionResult = dependencies
+      ? callback(dependencies, lookupRegistry)
+      : false;
 
-    if (!introspectionResult || !(properties || enhancers)) {
+    if (introspectionResult || !(properties || enhancers)) {
       return introspectionResult;
     }
-    const propertiesHosts = (properties || []).map(item => item.wrapper);
-    introspectionResult =
-      introspectionResult && callback(propertiesHosts, lookupRegistry);
-    if (!introspectionResult || !enhancers) {
+    introspectionResult = properties
+      ? callback(
+          properties.map(item => item.wrapper),
+          lookupRegistry,
+        )
+      : false;
+    if (introspectionResult || !enhancers) {
       return introspectionResult;
     }
-    return callback(enhancers, lookupRegistry);
+    return enhancers ? callback(enhancers, lookupRegistry) : false;
   }
 
   public isDependencyTreeStatic(lookupRegistry: string[] = []): boolean {
@@ -261,10 +275,10 @@ export class InstanceWrapper<T = any> {
       this.printIntrospectedAsRequestScoped();
       return this.isTreeStatic;
     }
-    this.isTreeStatic = this.introspectDepsAttribute(
+    this.isTreeStatic = !this.introspectDepsAttribute(
       (collection, registry) =>
-        collection.every((item: InstanceWrapper) =>
-          item.isDependencyTreeStatic(registry),
+        collection.some(
+          (item: InstanceWrapper) => !item.isDependencyTreeStatic(registry),
         ),
       lookupRegistry,
     );
@@ -452,4 +466,11 @@ export class InstanceWrapper<T = any> {
   private isDebugMode(): boolean {
     return !!process.env.NEST_DEBUG;
   }
+
+  private generateUuid(): string {
+    let key = this.name?.toString() ?? this.token?.toString();
+    key += this.host?.name ?? '';
+
+    return key ? UuidFactory.get(key) : randomStringGenerator();
+  }
 }
diff --git a/packages/core/injector/internal-core-module/internal-core-module-factory.ts b/packages/core/injector/internal-core-module/internal-core-module-factory.ts
index c1564e937..2e93650a9 100644
--- a/packages/core/injector/internal-core-module/internal-core-module-factory.ts
+++ b/packages/core/injector/internal-core-module/internal-core-module-factory.ts
@@ -1,9 +1,12 @@
 import { Logger } from '@nestjs/common';
 import { ExternalContextCreator } from '../../helpers/external-context-creator';
 import { HttpAdapterHost } from '../../helpers/http-adapter-host';
+import { GraphInspector } from '../../inspector/graph-inspector';
+import { SerializedGraph } from '../../inspector/serialized-graph';
 import { DependenciesScanner } from '../../scanner';
 import { ModuleCompiler } from '../compiler';
 import { NestContainer } from '../container';
+import { Injector } from '../injector';
 import { InstanceLoader } from '../instance-loader';
 import { LazyModuleLoader } from '../lazy-module-loader/lazy-module-loader';
 import { ModulesContainer } from '../modules-container';
@@ -15,7 +18,27 @@ export class InternalCoreModuleFactory {
     scanner: DependenciesScanner,
     moduleCompiler: ModuleCompiler,
     httpAdapterHost: HttpAdapterHost,
+    graphInspector: GraphInspector,
   ) {
+    const lazyModuleLoaderFactory = () => {
+      const logger = new Logger(LazyModuleLoader.name, {
+        timestamp: false,
+      });
+      const injector = new Injector();
+      const instanceLoader = new InstanceLoader(
+        container,
+        injector,
+        graphInspector,
+        logger,
+      );
+      return new LazyModuleLoader(
+        scanner,
+        instanceLoader,
+        moduleCompiler,
+        container.getModules(),
+      );
+    };
+
     return InternalCoreModule.register([
       {
         provide: ExternalContextCreator,
@@ -30,23 +53,12 @@ export class InternalCoreModuleFactory {
         useValue: httpAdapterHost,
       },
       {
-        provide: HttpAdapterHost.name,
-        useExisting: HttpAdapterHost,
+        provide: LazyModuleLoader,
+        useFactory: lazyModuleLoaderFactory,
       },
       {
-        provide: LazyModuleLoader,
-        useFactory: () => {
-          const logger = new Logger(LazyModuleLoader.name, {
-            timestamp: false,
-          });
-          const instanceLoader = new InstanceLoader(container, logger);
-          return new LazyModuleLoader(
-            scanner,
-            instanceLoader,
-            moduleCompiler,
-            container.getModules(),
-          );
-        },
+        provide: SerializedGraph,
+        useValue: container.serializedGraph,
       },
     ]);
   }
diff --git a/packages/core/injector/module-ref.ts b/packages/core/injector/module-ref.ts
index d512e0afc..83aa9c891 100644
--- a/packages/core/injector/module-ref.ts
+++ b/packages/core/injector/module-ref.ts
@@ -1,5 +1,4 @@
 import { IntrospectionResult, Scope, Type } from '@nestjs/common';
-import { GetOrResolveOptions } from '@nestjs/common/interfaces';
 import { getClassScope } from '../helpers/get-class-scope';
 import { isDurable } from '../helpers/is-durable';
 import { AbstractInstanceResolver } from './abstract-instance-resolver';
@@ -9,6 +8,20 @@ import { InstanceLinksHost } from './instance-links-host';
 import { ContextId, InstanceWrapper } from './instance-wrapper';
 import { Module } from './module';
 
+export interface ModuleRefGetOrResolveOpts {
+  /**
+   * If enabled, lookup will only be performed in the host module.
+   * @default true
+   */
+  strict?: boolean;
+  /**
+   * If enabled, instead of returning a first instance registered under a given token,
+   * a list of instances will be returned.
+   * @default false
+   */
+  each?: boolean;
+}
+
 export abstract class ModuleRef extends AbstractInstanceResolver {
   protected readonly injector = new Injector();
   private _instanceLinksHost: InstanceLinksHost;
@@ -37,7 +50,15 @@ export abstract class ModuleRef extends AbstractInstanceResolver {
    */
   abstract get<TInput = any, TResult = TInput>(
     typeOrToken: Type<TInput> | Function | string | symbol,
-    options: { strict?: boolean; each?: undefined | false },
+    options: {
+      /**
+       * If enabled, lookup will only be performed in the host module.
+       * @default true
+       */
+      strict?: boolean;
+      /** This indicates that only the first instance registered will be returned. */
+      each?: undefined | false;
+    },
   ): TResult;
   /**
    * Retrieves a list of instances of either injectables or controllers, otherwise, throws exception.
@@ -45,7 +66,15 @@ export abstract class ModuleRef extends AbstractInstanceResolver {
    */
   abstract get<TInput = any, TResult = TInput>(
     typeOrToken: Type<TInput> | Function | string | symbol,
-    options: { strict?: boolean; each: true },
+    options: {
+      /**
+       * If enabled, lookup will only be performed in the host module.
+       * @default true
+       */
+      strict?: boolean;
+      /** This indicates that a list of instances will be returned. */
+      each: true;
+    },
   ): Array<TResult>;
   /**
    * Retrieves an instance (or a list of instances) of either injectable or controller, otherwise, throws exception.
@@ -53,7 +82,7 @@ export abstract class ModuleRef extends AbstractInstanceResolver {
    */
   abstract get<TInput = any, TResult = TInput>(
     typeOrToken: Type<TInput> | Function | string | symbol,
-    options?: GetOrResolveOptions,
+    options?: ModuleRefGetOrResolveOpts,
   ): TResult | Array<TResult>;
 
   /**
@@ -96,7 +125,7 @@ export abstract class ModuleRef extends AbstractInstanceResolver {
   abstract resolve<TInput = any, TResult = TInput>(
     typeOrToken: Type<TInput> | Function | string | symbol,
     contextId?: { id: number },
-    options?: GetOrResolveOptions,
+    options?: ModuleRefGetOrResolveOpts,
   ): Promise<TResult | Array<TResult>>;
 
   public abstract create<T = any>(type: Type<T>): Promise<T>;
diff --git a/packages/core/injector/module-token-factory.ts b/packages/core/injector/module-token-factory.ts
index 65409ad09..4a407885c 100644
--- a/packages/core/injector/module-token-factory.ts
+++ b/packages/core/injector/module-token-factory.ts
@@ -2,10 +2,14 @@ import { DynamicModule } from '@nestjs/common';
 import { Type } from '@nestjs/common/interfaces/type.interface';
 import { randomStringGenerator } from '@nestjs/common/utils/random-string-generator.util';
 import { isFunction, isSymbol } from '@nestjs/common/utils/shared.utils';
+import { createHash } from 'crypto';
 import stringify from 'fast-safe-stringify';
-import * as hash from 'object-hash';
+
+const CLASS_STR = 'class ';
+const CLASS_STR_LEN = CLASS_STR.length;
 
 export class ModuleTokenFactory {
+  private readonly moduleTokenCache = new Map<string, string>();
   private readonly moduleIdsCache = new WeakMap<Type<unknown>, string>();
 
   public create(
@@ -13,23 +17,36 @@ export class ModuleTokenFactory {
     dynamicModuleMetadata?: Partial<DynamicModule> | undefined,
   ): string {
     const moduleId = this.getModuleId(metatype);
+
+    if (!dynamicModuleMetadata) {
+      return this.getStaticModuleToken(moduleId, this.getModuleName(metatype));
+    }
     const opaqueToken = {
       id: moduleId,
       module: this.getModuleName(metatype),
-      dynamic: this.getDynamicMetadataToken(dynamicModuleMetadata),
+      dynamic: dynamicModuleMetadata,
     };
-    return hash(opaqueToken, { ignoreUnknown: true });
+    const opaqueTokenString = this.getStringifiedOpaqueToken(opaqueToken);
+
+    return this.hashString(opaqueTokenString);
   }
 
-  public getDynamicMetadataToken(
-    dynamicModuleMetadata: Partial<DynamicModule> | undefined,
-  ): string {
+  public getStaticModuleToken(moduleId: string, moduleName: string): string {
+    const key = `${moduleId}_${moduleName}`;
+    if (this.moduleTokenCache.has(key)) {
+      return this.moduleTokenCache.get(key);
+    }
+
+    const hash = this.hashString(key);
+    this.moduleTokenCache.set(key, hash);
+    return hash;
+  }
+
+  public getStringifiedOpaqueToken(opaqueToken: object | undefined): string {
     // Uses safeStringify instead of JSON.stringify to support circular dynamic modules
     // The replacer function is also required in order to obtain real class names
     // instead of the unified "Function" key
-    return dynamicModuleMetadata
-      ? stringify(dynamicModuleMetadata, this.replacer)
-      : '';
+    return opaqueToken ? stringify(opaqueToken, this.replacer) : '';
   }
 
   public getModuleId(metatype: Type<unknown>): string {
@@ -46,14 +63,18 @@ export class ModuleTokenFactory {
     return metatype.name;
   }
 
+  private hashString(value: string): string {
+    return createHash('sha256').update(value).digest('hex');
+  }
+
   private replacer(key: string, value: any) {
     if (isFunction(value)) {
       const funcAsString = value.toString();
-      const isClass = /^class\s/.test(funcAsString);
+      const isClass = funcAsString.slice(0, CLASS_STR_LEN) === CLASS_STR;
       if (isClass) {
         return value.name;
       }
-      return hash(funcAsString, { ignoreUnknown: true });
+      return funcAsString;
     }
     if (isSymbol(value)) {
       return value.toString();
diff --git a/packages/core/injector/module.ts b/packages/core/injector/module.ts
index b8f408f7f..f6149ed5d 100644
--- a/packages/core/injector/module.ts
+++ b/packages/core/injector/module.ts
@@ -1,10 +1,13 @@
+import {
+  EnhancerSubtype,
+  ENTRY_PROVIDER_WATERMARK,
+} from '@nestjs/common/constants';
 import {
   ClassProvider,
   Controller,
   DynamicModule,
   ExistingProvider,
   FactoryProvider,
-  GetOrResolveOptions,
   Injectable,
   InjectionToken,
   NestModule,
@@ -16,6 +19,7 @@ import { randomStringGenerator } from '@nestjs/common/utils/random-string-genera
 import {
   isFunction,
   isNil,
+  isObject,
   isString,
   isSymbol,
   isUndefined,
@@ -30,38 +34,37 @@ import {
 import { createContextId } from '../helpers/context-id-factory';
 import { getClassScope } from '../helpers/get-class-scope';
 import { isDurable } from '../helpers/is-durable';
+import { UuidFactory } from '../inspector/uuid-factory';
 import { CONTROLLER_ID_KEY } from './constants';
 import { NestContainer } from './container';
 import { InstanceWrapper } from './instance-wrapper';
-import { ModuleRef } from './module-ref';
-
-/**
- * @note
- * Left for backward compatibility
- */
-export type InstanceToken = InjectionToken;
+import { ModuleRef, ModuleRefGetOrResolveOpts } from './module-ref';
 
 export class Module {
   private readonly _id: string;
   private readonly _imports = new Set<Module>();
   private readonly _providers = new Map<
-    InstanceToken,
+    InjectionToken,
     InstanceWrapper<Injectable>
   >();
   private readonly _injectables = new Map<
-    InstanceToken,
+    InjectionToken,
     InstanceWrapper<Injectable>
   >();
   private readonly _middlewares = new Map<
-    InstanceToken,
+    InjectionToken,
     InstanceWrapper<Injectable>
   >();
   private readonly _controllers = new Map<
-    InstanceToken,
+    InjectionToken,
     InstanceWrapper<Controller>
   >();
-  private readonly _exports = new Set<InstanceToken>();
+  private readonly _entryProviderKeys = new Set<InjectionToken>();
+  private readonly _exports = new Set<InjectionToken>();
+
   private _distance = 0;
+  private _initOnPreview = false;
+  private _isGlobal = false;
   private _token: string;
 
   constructor(
@@ -69,7 +72,7 @@ export class Module {
     private readonly container: NestContainer,
   ) {
     this.addCoreProviders();
-    this._id = randomStringGenerator();
+    this._id = this.generateUuid();
   }
 
   get id(): string {
@@ -84,48 +87,53 @@ export class Module {
     this._token = token;
   }
 
-  get providers(): Map<InstanceToken, InstanceWrapper<Injectable>> {
-    return this._providers;
+  get name() {
+    return this.metatype.name;
   }
 
-  get middlewares(): Map<InstanceToken, InstanceWrapper<Injectable>> {
-    return this._middlewares;
+  get isGlobal() {
+    return this._isGlobal;
   }
 
-  get imports(): Set<Module> {
-    return this._imports;
+  set isGlobal(global: boolean) {
+    this._isGlobal = global;
   }
 
-  /**
-   * Left for backward-compatibility reasons
-   */
-  get relatedModules(): Set<Module> {
-    return this._imports;
+  get initOnPreview() {
+    return this._initOnPreview;
   }
 
-  /**
-   * Left for backward-compatibility reasons
-   */
-  get components(): Map<InstanceToken, InstanceWrapper<Injectable>> {
+  set initOnPreview(initOnPreview: boolean) {
+    this._initOnPreview = initOnPreview;
+  }
+
+  get providers(): Map<InjectionToken, InstanceWrapper<Injectable>> {
     return this._providers;
   }
 
-  /**
-   * Left for backward-compatibility reasons
-   */
-  get routes(): Map<InstanceToken, InstanceWrapper<Controller>> {
-    return this._controllers;
+  get middlewares(): Map<InjectionToken, InstanceWrapper<Injectable>> {
+    return this._middlewares;
+  }
+
+  get imports(): Set<Module> {
+    return this._imports;
   }
 
-  get injectables(): Map<InstanceToken, InstanceWrapper<Injectable>> {
+  get injectables(): Map<InjectionToken, InstanceWrapper<Injectable>> {
     return this._injectables;
   }
 
-  get controllers(): Map<InstanceToken, InstanceWrapper<Controller>> {
+  get controllers(): Map<InjectionToken, InstanceWrapper<Controller>> {
     return this._controllers;
   }
 
-  get exports(): Set<InstanceToken> {
+  get entryProviders(): Array<InstanceWrapper<Injectable>> {
+    return Array.from(this._entryProviderKeys).map(token =>
+      this.providers.get(token),
+    );
+  }
+
+  get exports(): Set<InjectionToken> {
     return this._exports;
   }
 
@@ -199,10 +207,15 @@ export class Module {
 
   public addInjectable<T extends Injectable>(
     injectable: Provider,
+    enhancerSubtype: EnhancerSubtype,
     host?: Type<T>,
   ) {
     if (this.isCustomProvider(injectable)) {
-      return this.addCustomProvider(injectable, this._injectables);
+      return this.addCustomProvider(
+        injectable,
+        this._injectables,
+        enhancerSubtype,
+      );
     }
     let instanceWrapper = this.injectables.get(injectable);
     if (!instanceWrapper) {
@@ -214,6 +227,7 @@ export class Module {
         isResolved: false,
         scope: getClassScope(injectable),
         durable: isDurable(injectable),
+        subtype: enhancerSubtype,
         host: this,
       });
       this._injectables.set(injectable, instanceWrapper);
@@ -223,12 +237,22 @@ export class Module {
         this._controllers.get(host) || this._providers.get(host);
       hostWrapper && hostWrapper.addEnhancerMetadata(instanceWrapper);
     }
+    return instanceWrapper;
   }
 
-  public addProvider(provider: Provider) {
+  public addProvider(provider: Provider): Provider | InjectionToken;
+  public addProvider(
+    provider: Provider,
+    enhancerSubtype: EnhancerSubtype,
+  ): Provider | InjectionToken;
+  public addProvider(provider: Provider, enhancerSubtype?: EnhancerSubtype) {
     if (this.isCustomProvider(provider)) {
-      return this.addCustomProvider(provider, this._providers);
+      if (this.isEntryProvider(provider.provide)) {
+        this._entryProviderKeys.add(provider.provide);
+      }
+      return this.addCustomProvider(provider, this._providers, enhancerSubtype);
     }
+
     this._providers.set(
       provider,
       new InstanceWrapper({
@@ -242,6 +266,11 @@ export class Module {
         host: this,
       }),
     );
+
+    if (this.isEntryProvider(provider)) {
+      this._entryProviderKeys.add(provider);
+    }
+
     return provider as Type<Injectable>;
   }
 
@@ -270,15 +299,16 @@ export class Module {
       | ValueProvider
       | ExistingProvider,
     collection: Map<Function | string | symbol, any>,
+    enhancerSubtype?: EnhancerSubtype,
   ) {
     if (this.isCustomClass(provider)) {
-      this.addCustomClass(provider, collection);
+      this.addCustomClass(provider, collection, enhancerSubtype);
     } else if (this.isCustomValue(provider)) {
-      this.addCustomValue(provider, collection);
+      this.addCustomValue(provider, collection, enhancerSubtype);
     } else if (this.isCustomFactory(provider)) {
-      this.addCustomFactory(provider, collection);
+      this.addCustomFactory(provider, collection, enhancerSubtype);
     } else if (this.isCustomUseExisting(provider)) {
-      this.addCustomUseExisting(provider, collection);
+      this.addCustomUseExisting(provider, collection, enhancerSubtype);
     }
     return provider.provide;
   }
@@ -288,7 +318,10 @@ export class Module {
   }
 
   public isCustomValue(provider: any): provider is ValueProvider {
-    return !isUndefined((provider as ValueProvider).useValue);
+    return (
+      isObject(provider) &&
+      Object.prototype.hasOwnProperty.call(provider, 'useValue')
+    );
   }
 
   public isCustomFactory(provider: any): provider is FactoryProvider {
@@ -305,7 +338,8 @@ export class Module {
 
   public addCustomClass(
     provider: ClassProvider,
-    collection: Map<InstanceToken, InstanceWrapper>,
+    collection: Map<InjectionToken, InstanceWrapper>,
+    enhancerSubtype?: EnhancerSubtype,
   ) {
     let { scope, durable } = provider;
 
@@ -316,10 +350,12 @@ export class Module {
     if (isUndefined(durable)) {
       durable = isDurable(useClass);
     }
+
+    const token = provider.provide;
     collection.set(
-      provider.provide,
+      token,
       new InstanceWrapper({
-        token: provider.provide,
+        token,
         name: useClass?.name || useClass,
         metatype: useClass,
         instance: null,
@@ -327,6 +363,7 @@ export class Module {
         scope,
         durable,
         host: this,
+        subtype: enhancerSubtype,
       }),
     );
   }
@@ -334,6 +371,7 @@ export class Module {
   public addCustomValue(
     provider: ValueProvider,
     collection: Map<Function | string | symbol, InstanceWrapper>,
+    enhancerSubtype?: EnhancerSubtype,
   ) {
     const { useValue: value, provide: providerToken } = provider;
     collection.set(
@@ -346,6 +384,7 @@ export class Module {
         isResolved: true,
         async: value instanceof Promise,
         host: this,
+        subtype: enhancerSubtype,
       }),
     );
   }
@@ -353,6 +392,7 @@ export class Module {
   public addCustomFactory(
     provider: FactoryProvider,
     collection: Map<Function | string | symbol, InstanceWrapper>,
+    enhancerSubtype?: EnhancerSubtype,
   ) {
     const {
       useFactory: factory,
@@ -374,6 +414,7 @@ export class Module {
         scope,
         durable,
         host: this,
+        subtype: enhancerSubtype,
       }),
     );
   }
@@ -381,6 +422,7 @@ export class Module {
   public addCustomUseExisting(
     provider: ExistingProvider,
     collection: Map<Function | string | symbol, InstanceWrapper>,
+    enhancerSubtype?: EnhancerSubtype,
   ) {
     const { useExisting, provide: providerToken } = provider;
     collection.set(
@@ -394,6 +436,7 @@ export class Module {
         inject: [useExisting],
         host: this,
         isAlias: true,
+        subtype: enhancerSubtype,
       }),
     );
   }
@@ -401,7 +444,7 @@ export class Module {
   public addExportedProvider(
     provider: Provider | string | symbol | DynamicModule,
   ) {
-    const addExportedUnit = (token: InstanceToken) =>
+    const addExportedUnit = (token: InjectionToken) =>
       this._exports.add(this.validateExportedProvider(token));
 
     if (this.isCustomProvider(provider as any)) {
@@ -429,7 +472,7 @@ export class Module {
     this._exports.add(this.validateExportedProvider(provide));
   }
 
-  public validateExportedProvider(token: InstanceToken) {
+  public validateExportedProvider(token: InjectionToken) {
     if (this._providers.has(token)) {
       return token;
     }
@@ -478,7 +521,7 @@ export class Module {
     this._imports.add(module);
   }
 
-  public replace(toReplace: InstanceToken, options: any) {
+  public replace(toReplace: InjectionToken, options: any) {
     if (options.isProvider && this.hasProvider(toReplace)) {
       const originalProvider = this._providers.get(toReplace);
 
@@ -493,20 +536,50 @@ export class Module {
     }
   }
 
-  public hasProvider(token: InstanceToken): boolean {
+  public hasProvider(token: InjectionToken): boolean {
     return this._providers.has(token);
   }
 
-  public hasInjectable(token: InstanceToken): boolean {
+  public hasInjectable(token: InjectionToken): boolean {
     return this._injectables.has(token);
   }
 
-  public getProviderByKey<T = any>(name: InstanceToken): InstanceWrapper<T> {
+  public getProviderByKey<T = any>(name: InjectionToken): InstanceWrapper<T> {
     return this._providers.get(name) as InstanceWrapper<T>;
   }
 
+  public getProviderById<T = any>(id: string): InstanceWrapper<T> | undefined {
+    return Array.from(this._providers.values()).find(
+      item => item.id === id,
+    ) as InstanceWrapper<T>;
+  }
+
+  public getControllerById<T = any>(
+    id: string,
+  ): InstanceWrapper<T> | undefined {
+    return Array.from(this._controllers.values()).find(
+      item => item.id === id,
+    ) as InstanceWrapper<T>;
+  }
+
+  public getInjectableById<T = any>(
+    id: string,
+  ): InstanceWrapper<T> | undefined {
+    return Array.from(this._injectables.values()).find(
+      item => item.id === id,
+    ) as InstanceWrapper<T>;
+  }
+
+  public getMiddlewareById<T = any>(
+    id: string,
+  ): InstanceWrapper<T> | undefined {
+    return Array.from(this._middlewares.values()).find(
+      item => item.id === id,
+    ) as InstanceWrapper<T>;
+  }
+
   public getNonAliasProviders(): Array<
-    [InstanceToken, InstanceWrapper<Injectable>]
+    [InjectionToken, InstanceWrapper<Injectable>]
   > {
     return [...this._providers].filter(([_, wrapper]) => !wrapper.isAlias);
   }
@@ -521,21 +594,30 @@ export class Module {
 
       public get<TInput = any, TResult = TInput>(
         typeOrToken: Type<TInput> | string | symbol,
-        options: GetOrResolveOptions = { strict: true },
+        options: ModuleRefGetOrResolveOpts = {},
       ): TResult | Array<TResult> {
-        return !(options && options.strict)
-          ? this.find<TInput, TResult>(typeOrToken, options)
-          : this.find<TInput, TResult>(typeOrToken, {
-              moduleId: self.id,
-              each: options.each,
-            });
+        options.strict ??= true;
+        options.each ??= false;
+
+        return this.find<TInput, TResult>(
+          typeOrToken,
+          options.strict
+            ? {
+                moduleId: self.id,
+                each: options.each,
+              }
+            : options,
+        );
       }
 
       public resolve<TInput = any, TResult = TInput>(
         typeOrToken: Type<TInput> | string | symbol,
         contextId = createContextId(),
-        options: GetOrResolveOptions = { strict: true },
+        options: ModuleRefGetOrResolveOpts = {},
       ): Promise<TResult | Array<TResult>> {
+        options.strict ??= true;
+        options.each ??= false;
+
         return this.resolvePerContext<TInput, TResult>(
           typeOrToken,
           self,
@@ -552,4 +634,16 @@ export class Module {
       }
     };
   }
+
+  private isEntryProvider(metatype: InjectionToken): boolean {
+    return typeof metatype === 'function'
+      ? !!Reflect.getMetadata(ENTRY_PROVIDER_WATERMARK, metatype)
+      : false;
+  }
+
+  private generateUuid(): string {
+    const prefix = 'M_';
+    const key = this.name?.toString() ?? this.token?.toString();
+    return key ? UuidFactory.get(`${prefix}_${key}`) : randomStringGenerator();
+  }
 }
diff --git a/packages/core/injector/modules-container.ts b/packages/core/injector/modules-container.ts
index 8f1d9dec6..31777bec2 100644
--- a/packages/core/injector/modules-container.ts
+++ b/packages/core/injector/modules-container.ts
@@ -1,10 +1,14 @@
-import { v4 as uuid } from 'uuid';
+import { uid } from 'uid';
 import { Module } from './module';
 
 export class ModulesContainer extends Map<string, Module> {
-  private readonly _applicationId = uuid();
+  private readonly _applicationId = uid(21);
 
   get applicationId(): string {
     return this._applicationId;
   }
+
+  public getById(id: string): Module | undefined {
+    return Array.from(this.values()).find(moduleRef => moduleRef.id === id);
+  }
 }
diff --git a/packages/core/inspector/deterministic-uuid-registry.ts b/packages/core/inspector/deterministic-uuid-registry.ts
new file mode 100644
index 000000000..352942cde
--- /dev/null
+++ b/packages/core/inspector/deterministic-uuid-registry.ts
@@ -0,0 +1,23 @@
+export class DeterministicUuidRegistry {
+  private static readonly registry = new Map<string, boolean>();
+
+  static get(str: string, inc = 0) {
+    const id = inc ? this.hashCode(`${str}_${inc}`) : this.hashCode(str);
+    if (this.registry.has(id)) {
+      return this.get(str, inc + 1);
+    }
+    this.registry.set(id, true);
+    return id;
+  }
+
+  static clear() {
+    this.registry.clear();
+  }
+
+  private static hashCode(s: string) {
+    let h = 0;
+    for (let i = 0; i < s.length; i++)
+      h = (Math.imul(31, h) + s.charCodeAt(i)) | 0;
+    return h.toString();
+  }
+}
diff --git a/packages/core/inspector/graph-inspector.ts b/packages/core/inspector/graph-inspector.ts
new file mode 100644
index 000000000..a2146a543
--- /dev/null
+++ b/packages/core/inspector/graph-inspector.ts
@@ -0,0 +1,240 @@
+import { UnknownDependenciesException } from '../errors/exceptions/unknown-dependencies.exception';
+import { NestContainer } from '../injector/container';
+import { InstanceWrapper } from '../injector/instance-wrapper';
+import { Module } from '../injector/module';
+import { DeterministicUuidRegistry } from './deterministic-uuid-registry';
+import { EnhancerMetadataCacheEntry } from './interfaces/enhancer-metadata-cache-entry.interface';
+import { Entrypoint } from './interfaces/entrypoint.interface';
+import { OrphanedEnhancerDefinition } from './interfaces/extras.interface';
+import { ClassNode, Node } from './interfaces/node.interface';
+import { PartialGraphHost } from './partial-graph.host';
+import { SerializedGraph } from './serialized-graph';
+
+export class GraphInspector {
+  private readonly graph: SerializedGraph;
+  private readonly enhancersMetadataCache =
+    new Array<EnhancerMetadataCacheEntry>();
+
+  constructor(private readonly container: NestContainer) {
+    this.graph = container.serializedGraph;
+  }
+
+  public inspectModules(
+    modules: Map<string, Module> = this.container.getModules(),
+  ) {
+    for (const moduleRef of modules.values()) {
+      this.insertModuleNode(moduleRef);
+      this.insertClassNodes(moduleRef);
+      this.insertModuleToModuleEdges(moduleRef);
+    }
+
+    this.enhancersMetadataCache.forEach(entry =>
+      this.insertEnhancerEdge(entry),
+    );
+
+    DeterministicUuidRegistry.clear();
+  }
+
+  public registerPartial(error: unknown) {
+    this.graph.status = 'partial';
+
+    if (error instanceof UnknownDependenciesException) {
+      this.graph.metadata = {
+        cause: {
+          type: 'unknown-dependencies',
+          context: error.context,
+          moduleId: error.moduleRef?.id,
+          nodeId: error.metadata?.id,
+        },
+      };
+    } else {
+      this.graph.metadata = {
+        cause: {
+          type: 'unknown',
+          error,
+        },
+      };
+    }
+    PartialGraphHost.register(this.graph);
+  }
+
+  public inspectInstanceWrapper<T = any>(
+    source: InstanceWrapper<T>,
+    moduleRef: Module,
+  ) {
+    const ctorMetadata = source.getCtorMetadata();
+    ctorMetadata?.forEach((target, index) =>
+      this.insertClassToClassEdge(
+        source,
+        target,
+        moduleRef,
+        index,
+        'constructor',
+      ),
+    );
+
+    const propertiesMetadata = source.getPropertiesMetadata();
+    propertiesMetadata?.forEach(({ key, wrapper: target }) =>
+      this.insertClassToClassEdge(source, target, moduleRef, key, 'property'),
+    );
+  }
+
+  public insertEnhancerMetadataCache(entry: EnhancerMetadataCacheEntry) {
+    this.enhancersMetadataCache.push(entry);
+  }
+
+  public insertOrphanedEnhancer(entry: OrphanedEnhancerDefinition) {
+    this.graph.insertOrphanedEnhancer({
+      ...entry,
+      ref: entry.ref?.constructor?.name ?? 'Object',
+    });
+  }
+
+  public insertAttachedEnhancer(wrapper: InstanceWrapper) {
+    const existingNode = this.graph.getNodeById(wrapper.id);
+    existingNode.metadata.global = true;
+
+    this.graph.insertAttachedEnhancer(existingNode.id);
+  }
+
+  public insertEntrypointDefinition<T>(
+    definition: Entrypoint<T>,
+    parentId: string,
+  ) {
+    definition = {
+      ...definition,
+      id: `${definition.classNodeId}_${definition.methodName}`,
+    };
+    this.graph.insertEntrypoint(definition, parentId);
+  }
+
+  public insertClassNode(
+    moduleRef: Module,
+    wrapper: InstanceWrapper,
+    type: Exclude<Node['metadata']['type'], 'module'>,
+  ) {
+    this.graph.insertNode({
+      id: wrapper.id,
+      label: wrapper.name,
+      parent: moduleRef.id,
+      metadata: {
+        type,
+        internal: wrapper.metatype === moduleRef.metatype,
+        sourceModuleName: moduleRef.name,
+        durable: wrapper.isDependencyTreeDurable(),
+        static: wrapper.isDependencyTreeStatic(),
+        scope: wrapper.scope,
+        transient: wrapper.isTransient,
+        exported: moduleRef.exports.has(wrapper.token),
+        token: wrapper.token,
+        subtype: wrapper.subtype,
+        initTime: wrapper.initTime,
+      },
+    });
+  }
+
+  private insertModuleNode(moduleRef: Module) {
+    const dynamicMetadata = this.container.getDynamicMetadataByToken(
+      moduleRef.token,
+    );
+    const node: Node = {
+      id: moduleRef.id,
+      label: moduleRef.name,
+      metadata: {
+        type: 'module',
+        global: moduleRef.isGlobal,
+        dynamic: !!dynamicMetadata,
+        internal: moduleRef.name === 'InternalCoreModule',
+      },
+    };
+    this.graph.insertNode(node);
+  }
+
+  private insertModuleToModuleEdges(moduleRef: Module) {
+    for (const targetModuleRef of moduleRef.imports) {
+      this.graph.insertEdge({
+        source: moduleRef.id,
+        target: targetModuleRef.id,
+        metadata: {
+          type: 'module-to-module',
+          sourceModuleName: moduleRef.name,
+          targetModuleName: targetModuleRef.name,
+        },
+      });
+    }
+  }
+
+  private insertEnhancerEdge(entry: EnhancerMetadataCacheEntry) {
+    const moduleRef = this.container.getModuleByKey(entry.moduleToken);
+    const sourceInstanceWrapper =
+      moduleRef.controllers.get(entry.classRef) ??
+      moduleRef.providers.get(entry.classRef);
+    const existingSourceNode = this.graph.getNodeById(
+      sourceInstanceWrapper.id,
+    ) as ClassNode;
+    const enhancers = existingSourceNode.metadata.enhancers ?? [];
+
+    if (entry.enhancerInstanceWrapper) {
+      this.insertClassToClassEdge(
+        sourceInstanceWrapper,
+        entry.enhancerInstanceWrapper,
+        moduleRef,
+        undefined,
+        'decorator',
+      );
+
+      enhancers.push({
+        id: entry.enhancerInstanceWrapper.id,
+        methodKey: entry.methodKey,
+        subtype: entry.subtype,
+      });
+    } else {
+      const name =
+        entry.enhancerRef.constructor?.name ??
+        (entry.enhancerRef as Function).name;
+
+      enhancers.push({
+        name,
+        methodKey: entry.methodKey,
+        subtype: entry.subtype,
+      });
+    }
+    existingSourceNode.metadata.enhancers = enhancers;
+  }
+
+  private insertClassToClassEdge<T>(
+    source: InstanceWrapper<T>,
+    target: InstanceWrapper,
+    moduleRef: Module,
+    keyOrIndex: number | string | symbol | undefined,
+    injectionType: 'constructor' | 'property' | 'decorator',
+  ) {
+    this.graph.insertEdge({
+      source: source.id,
+      target: target.id,
+      metadata: {
+        type: 'class-to-class',
+        sourceModuleName: moduleRef.name,
+        sourceClassName: source.name,
+        targetClassName: target.name,
+        sourceClassToken: source.token,
+        targetClassToken: target.token,
+        targetModuleName: target.host?.name,
+        keyOrIndex,
+        injectionType,
+      },
+    });
+  }
+
+  private insertClassNodes(moduleRef: Module) {
+    moduleRef.providers.forEach(value =>
+      this.insertClassNode(moduleRef, value, 'provider'),
+    );
+    moduleRef.injectables.forEach(value =>
+      this.insertClassNode(moduleRef, value, 'injectable'),
+    );
+    moduleRef.controllers.forEach(value =>
+      this.insertClassNode(moduleRef, value, 'controller'),
+    );
+  }
+}
diff --git a/packages/core/inspector/index.ts b/packages/core/inspector/index.ts
new file mode 100644
index 000000000..db830f6e7
--- /dev/null
+++ b/packages/core/inspector/index.ts
@@ -0,0 +1,4 @@
+export * from './graph-inspector';
+export * from './initialize-on-preview.allowlist';
+export * from './partial-graph.host';
+export * from './serialized-graph';
diff --git a/packages/core/inspector/initialize-on-preview.allowlist.ts b/packages/core/inspector/initialize-on-preview.allowlist.ts
new file mode 100644
index 000000000..27d6ad593
--- /dev/null
+++ b/packages/core/inspector/initialize-on-preview.allowlist.ts
@@ -0,0 +1,13 @@
+import { Type } from '@nestjs/common';
+
+export class InitializeOnPreviewAllowlist {
+  private static readonly allowlist = new WeakMap<Type, boolean>();
+
+  public static add(type: Type) {
+    this.allowlist.set(type, true);
+  }
+
+  public static has(type: Type) {
+    return this.allowlist.has(type);
+  }
+}
diff --git a/packages/core/inspector/interfaces/edge.interface.ts b/packages/core/inspector/interfaces/edge.interface.ts
new file mode 100644
index 000000000..9151ab43b
--- /dev/null
+++ b/packages/core/inspector/interfaces/edge.interface.ts
@@ -0,0 +1,31 @@
+import { InjectionToken } from '@nestjs/common';
+
+type CommonEdgeMetadata = {
+  sourceModuleName: string;
+  targetModuleName: string;
+};
+
+type ModuleToModuleEdgeMetadata = {
+  type: 'module-to-module';
+} & CommonEdgeMetadata;
+
+type ClassToClassEdgeMetadata = {
+  type: 'class-to-class';
+  sourceClassName: string;
+  targetClassName: string;
+  sourceClassToken: InjectionToken;
+  targetClassToken: InjectionToken;
+  injectionType: 'constructor' | 'property' | 'decorator';
+  keyOrIndex?: string | number | symbol;
+  /**
+   * If true, indicates that this edge represents an internal providers connection
+   */
+  internal?: boolean;
+} & CommonEdgeMetadata;
+
+export interface Edge {
+  id: string;
+  source: string;
+  target: string;
+  metadata: ModuleToModuleEdgeMetadata | ClassToClassEdgeMetadata;
+}
diff --git a/packages/core/inspector/interfaces/enhancer-metadata-cache-entry.interface.ts b/packages/core/inspector/interfaces/enhancer-metadata-cache-entry.interface.ts
new file mode 100644
index 000000000..7f4574d94
--- /dev/null
+++ b/packages/core/inspector/interfaces/enhancer-metadata-cache-entry.interface.ts
@@ -0,0 +1,13 @@
+import { Type } from '@nestjs/common';
+import { EnhancerSubtype } from '@nestjs/common/constants';
+import { InstanceWrapper } from '../../injector/instance-wrapper';
+
+export interface EnhancerMetadataCacheEntry {
+  targetNodeId?: string;
+  moduleToken: string;
+  classRef: Type;
+  methodKey: string | undefined;
+  enhancerRef?: unknown;
+  enhancerInstanceWrapper?: InstanceWrapper;
+  subtype: EnhancerSubtype;
+}
diff --git a/packages/core/inspector/interfaces/entrypoint.interface.ts b/packages/core/inspector/interfaces/entrypoint.interface.ts
new file mode 100644
index 000000000..057c040c3
--- /dev/null
+++ b/packages/core/inspector/interfaces/entrypoint.interface.ts
@@ -0,0 +1,24 @@
+import { RequestMethod } from '@nestjs/common';
+import { VersionValue } from '@nestjs/common/interfaces';
+
+export type HttpEntrypointMetadata = {
+  path: string;
+  requestMethod: keyof typeof RequestMethod;
+  methodVersion?: VersionValue;
+  controllerVersion?: VersionValue;
+};
+
+export type MiddlewareEntrypointMetadata = {
+  path: string;
+  requestMethod: keyof typeof RequestMethod;
+  version?: VersionValue;
+};
+
+export type Entrypoint<T> = {
+  id?: string;
+  type: string;
+  methodName: string;
+  className: string;
+  classNodeId: string;
+  metadata: { key: string } & T;
+};
diff --git a/packages/core/inspector/interfaces/extras.interface.ts b/packages/core/inspector/interfaces/extras.interface.ts
new file mode 100644
index 000000000..37abd639f
--- /dev/null
+++ b/packages/core/inspector/interfaces/extras.interface.ts
@@ -0,0 +1,21 @@
+import { EnhancerSubtype } from '@nestjs/common/constants';
+
+/**
+ * Enhancers attached through APP_PIPE, APP_GUARD, APP_INTERCEPTOR, and APP_FILTER tokens.
+ */
+export interface AttachedEnhancerDefinition {
+  nodeId: string;
+}
+
+/**
+ * Enhancers registered through "app.useGlobalPipes()", "app.useGlobalGuards()", "app.useGlobalInterceptors()", and "app.useGlobalFilters()" methods.
+ */
+export interface OrphanedEnhancerDefinition {
+  subtype: EnhancerSubtype;
+  ref: unknown;
+}
+
+export interface Extras {
+  orphanedEnhancers: Array<OrphanedEnhancerDefinition>;
+  attachedEnhancers: Array<AttachedEnhancerDefinition>;
+}
diff --git a/packages/core/inspector/interfaces/node.interface.ts b/packages/core/inspector/interfaces/node.interface.ts
new file mode 100644
index 000000000..1d8589399
--- /dev/null
+++ b/packages/core/inspector/interfaces/node.interface.ts
@@ -0,0 +1,47 @@
+import { InjectionToken, Scope } from '@nestjs/common';
+import { EnhancerSubtype } from '@nestjs/common/constants';
+
+export type ModuleNode = {
+  metadata: {
+    type: 'module';
+    global: boolean;
+    dynamic: boolean;
+    internal: boolean;
+  };
+};
+
+export type ClassNode = {
+  parent: string;
+  metadata: {
+    type: 'provider' | 'controller' | 'middleware' | 'injectable';
+    subtype?: EnhancerSubtype;
+    sourceModuleName: string;
+    durable: boolean;
+    static: boolean;
+    transient: boolean;
+    exported: boolean;
+    scope: Scope;
+    token: InjectionToken;
+    initTime: number;
+    /**
+     * Enhancers metadata collection
+     */
+    enhancers?: Array<
+      | { id: string; subtype: EnhancerSubtype }
+      | { name: string; methodKey?: string; subtype: EnhancerSubtype }
+    >;
+    /**
+     * If true, node is a globally registered enhancer
+     */
+    global?: boolean;
+    /**
+     * If true, indicates that this node represents an internal provider
+     */
+    internal?: boolean;
+  };
+};
+
+export type Node = {
+  id: string;
+  label: string;
+} & (ClassNode | ModuleNode);
diff --git a/packages/core/inspector/interfaces/serialized-graph-json.interface.ts b/packages/core/inspector/interfaces/serialized-graph-json.interface.ts
new file mode 100644
index 000000000..9cd9d76cf
--- /dev/null
+++ b/packages/core/inspector/interfaces/serialized-graph-json.interface.ts
@@ -0,0 +1,15 @@
+import { SerializedGraphStatus } from '../serialized-graph';
+import { Edge } from './edge.interface';
+import { Entrypoint } from './entrypoint.interface';
+import { Extras } from './extras.interface';
+import { Node } from './node.interface';
+import { SerializedGraphMetadata } from './serialized-graph-metadata.interface';
+
+export interface SerializedGraphJson {
+  nodes: Record<string, Node>;
+  edges: Record<string, Edge>;
+  entrypoints: Record<string, Entrypoint<unknown>[]>;
+  extras: Extras;
+  status?: SerializedGraphStatus;
+  metadata?: SerializedGraphMetadata;
+}
diff --git a/packages/core/inspector/interfaces/serialized-graph-metadata.interface.ts b/packages/core/inspector/interfaces/serialized-graph-metadata.interface.ts
new file mode 100644
index 000000000..c88749d01
--- /dev/null
+++ b/packages/core/inspector/interfaces/serialized-graph-metadata.interface.ts
@@ -0,0 +1,11 @@
+import { InjectorDependencyContext } from '../../injector/injector';
+
+export interface SerializedGraphMetadata {
+  cause: {
+    type: 'unknown-dependencies' | 'unknown';
+    context?: InjectorDependencyContext;
+    moduleId?: string;
+    nodeId?: string;
+    error?: any;
+  };
+}
diff --git a/packages/core/inspector/noop-graph-inspector.ts b/packages/core/inspector/noop-graph-inspector.ts
new file mode 100644
index 000000000..f4a36ee0e
--- /dev/null
+++ b/packages/core/inspector/noop-graph-inspector.ts
@@ -0,0 +1,10 @@
+import { GraphInspector } from './graph-inspector';
+
+// eslint-disable-next-line @typescript-eslint/no-empty-function
+const noop = () => {};
+export const NoopGraphInspector: GraphInspector = new Proxy(
+  GraphInspector.prototype,
+  {
+    get: () => noop,
+  },
+);
diff --git a/packages/core/inspector/partial-graph.host.ts b/packages/core/inspector/partial-graph.host.ts
new file mode 100644
index 000000000..84ae71f51
--- /dev/null
+++ b/packages/core/inspector/partial-graph.host.ts
@@ -0,0 +1,17 @@
+import { SerializedGraph } from './serialized-graph';
+
+export class PartialGraphHost {
+  private static partialGraph: SerializedGraph;
+
+  static toJSON() {
+    return this.partialGraph?.toJSON();
+  }
+
+  static toString() {
+    return this.partialGraph?.toString();
+  }
+
+  static register(partialGraph: SerializedGraph) {
+    this.partialGraph = partialGraph;
+  }
+}
diff --git a/packages/core/inspector/serialized-graph.ts b/packages/core/inspector/serialized-graph.ts
new file mode 100644
index 000000000..9ba1b7d4c
--- /dev/null
+++ b/packages/core/inspector/serialized-graph.ts
@@ -0,0 +1,157 @@
+import { InjectionToken } from '@nestjs/common';
+import { ApplicationConfig } from '../application-config';
+import { ExternalContextCreator } from '../helpers/external-context-creator';
+import { HttpAdapterHost } from '../helpers/http-adapter-host';
+import { INQUIRER } from '../injector/inquirer/inquirer-constants';
+import { LazyModuleLoader } from '../injector/lazy-module-loader/lazy-module-loader';
+import { ModuleRef } from '../injector/module-ref';
+import { ModulesContainer } from '../injector/modules-container';
+import { REQUEST } from '../router/request/request-constants';
+import { Reflector } from '../services/reflector.service';
+import { DeterministicUuidRegistry } from './deterministic-uuid-registry';
+import { Edge } from './interfaces/edge.interface';
+import { Entrypoint } from './interfaces/entrypoint.interface';
+import {
+  Extras,
+  OrphanedEnhancerDefinition,
+} from './interfaces/extras.interface';
+import { Node } from './interfaces/node.interface';
+import { SerializedGraphJson } from './interfaces/serialized-graph-json.interface';
+import { SerializedGraphMetadata } from './interfaces/serialized-graph-metadata.interface';
+
+export type SerializedGraphStatus = 'partial' | 'complete';
+type WithOptionalId<T extends Record<'id', string>> = Omit<T, 'id'> &
+  Partial<Pick<T, 'id'>>;
+
+export class SerializedGraph {
+  private readonly nodes = new Map<string, Node>();
+  private readonly edges = new Map<string, Edge>();
+  private readonly entrypoints = new Map<string, Entrypoint<unknown>[]>();
+  private readonly extras: Extras = {
+    orphanedEnhancers: [],
+    attachedEnhancers: [],
+  };
+  private _status: SerializedGraphStatus = 'complete';
+  private _metadata?: SerializedGraphMetadata;
+
+  private static readonly INTERNAL_PROVIDERS: Array<InjectionToken> = [
+    ApplicationConfig,
+    ModuleRef,
+    HttpAdapterHost,
+    LazyModuleLoader,
+    ExternalContextCreator,
+    ModulesContainer,
+    Reflector,
+    SerializedGraph,
+    HttpAdapterHost.name,
+    Reflector.name,
+    REQUEST,
+    INQUIRER,
+  ];
+
+  set status(status: SerializedGraphStatus) {
+    this._status = status;
+  }
+
+  set metadata(metadata: SerializedGraphMetadata) {
+    this._metadata = metadata;
+  }
+
+  public insertNode(nodeDefinition: Node) {
+    if (
+      nodeDefinition.metadata.type === 'provider' &&
+      SerializedGraph.INTERNAL_PROVIDERS.includes(nodeDefinition.metadata.token)
+    ) {
+      nodeDefinition.metadata = {
+        ...nodeDefinition.metadata,
+        internal: true,
+      };
+    }
+    if (this.nodes.has(nodeDefinition.id)) {
+      return this.nodes.get(nodeDefinition.id);
+    }
+    this.nodes.set(nodeDefinition.id, nodeDefinition);
+    return nodeDefinition;
+  }
+
+  public insertEdge(edgeDefinition: WithOptionalId<Edge>) {
+    if (
+      edgeDefinition.metadata.type === 'class-to-class' &&
+      (SerializedGraph.INTERNAL_PROVIDERS.includes(
+        edgeDefinition.metadata.sourceClassToken,
+      ) ||
+        SerializedGraph.INTERNAL_PROVIDERS.includes(
+          edgeDefinition.metadata.targetClassToken,
+        ))
+    ) {
+      edgeDefinition.metadata = {
+        ...edgeDefinition.metadata,
+        internal: true,
+      };
+    }
+    const id =
+      edgeDefinition.id ?? this.generateUuidByEdgeDefinition(edgeDefinition);
+    const edge = {
+      ...edgeDefinition,
+      id,
+    };
+    this.edges.set(id, edge);
+    return edge;
+  }
+
+  public insertEntrypoint<T>(definition: Entrypoint<T>, parentId: string) {
+    if (this.entrypoints.has(parentId)) {
+      const existingCollection = this.entrypoints.get(parentId);
+      existingCollection.push(definition);
+    } else {
+      this.entrypoints.set(parentId, [definition]);
+    }
+  }
+
+  public insertOrphanedEnhancer(entry: OrphanedEnhancerDefinition) {
+    this.extras.orphanedEnhancers.push(entry);
+  }
+
+  public insertAttachedEnhancer(nodeId: string) {
+    this.extras.attachedEnhancers.push({
+      nodeId,
+    });
+  }
+
+  public getNodeById(id: string) {
+    return this.nodes.get(id);
+  }
+
+  public toJSON(): SerializedGraphJson {
+    const json: SerializedGraphJson = {
+      nodes: Object.fromEntries(this.nodes),
+      edges: Object.fromEntries(this.edges),
+      entrypoints: Object.fromEntries(this.entrypoints),
+      extras: this.extras,
+    };
+
+    if (this._status) {
+      json['status'] = this._status;
+    }
+    if (this._metadata) {
+      json['metadata'] = this._metadata;
+    }
+    return json;
+  }
+
+  public toString() {
+    const replacer = (key: string, value: unknown) => {
+      if (typeof value === 'symbol') {
+        return value.toString();
+      }
+      return typeof value === 'function' ? value.name ?? 'Function' : value;
+    };
+    return JSON.stringify(this.toJSON(), replacer, 2);
+  }
+
+  private generateUuidByEdgeDefinition(
+    edgeDefinition: WithOptionalId<Edge>,
+  ): string {
+    return DeterministicUuidRegistry.get(JSON.stringify(edgeDefinition));
+  }
+}
diff --git a/packages/core/inspector/uuid-factory.ts b/packages/core/inspector/uuid-factory.ts
new file mode 100644
index 000000000..1f89ad13d
--- /dev/null
+++ b/packages/core/inspector/uuid-factory.ts
@@ -0,0 +1,21 @@
+import { randomStringGenerator } from '@nestjs/common/utils/random-string-generator.util';
+import { DeterministicUuidRegistry } from './deterministic-uuid-registry';
+
+export enum UuidFactoryMode {
+  Random = 'random',
+  Deterministic = 'deterministic',
+}
+
+export class UuidFactory {
+  private static _mode = UuidFactoryMode.Random;
+
+  static set mode(value: UuidFactoryMode) {
+    this._mode = value;
+  }
+
+  static get(key = '') {
+    return this._mode === UuidFactoryMode.Deterministic
+      ? DeterministicUuidRegistry.get(key)
+      : randomStringGenerator();
+  }
+}
diff --git a/packages/core/interceptors/interceptors-consumer.ts b/packages/core/interceptors/interceptors-consumer.ts
index bcf3a5921..22f6d096e 100644
--- a/packages/core/interceptors/interceptors-consumer.ts
+++ b/packages/core/interceptors/interceptors-consumer.ts
@@ -24,19 +24,16 @@ export class InterceptorsConsumer {
     const context = this.createContext(args, instance, callback);
     context.setType<TContext>(type);
 
-    const start$ = defer(() => this.transformDeferred(next));
-    const nextFn =
-      (i = 0) =>
-      async () => {
-        if (i >= interceptors.length) {
-          return start$;
-        }
-        const handler: CallHandler = {
-          handle: () => fromPromise(nextFn(i + 1)()).pipe(mergeAll()),
-        };
-        return interceptors[i].intercept(context, handler);
+    const nextFn = async (i = 0) => {
+      if (i >= interceptors.length) {
+        return this.transformDeferred(next);
+      }
+      const handler: CallHandler = {
+        handle: () => fromPromise(nextFn(i + 1)).pipe(mergeAll()),
       };
-    return nextFn()();
+      return interceptors[i].intercept(context, handler);
+    };
+    return defer(() => nextFn()).pipe(mergeAll());
   }
 
   public createContext(
diff --git a/packages/core/interceptors/interceptors-context-creator.ts b/packages/core/interceptors/interceptors-context-creator.ts
index abc7dc903..b05dcb445 100644
--- a/packages/core/interceptors/interceptors-context-creator.ts
+++ b/packages/core/interceptors/interceptors-context-creator.ts
@@ -74,7 +74,7 @@ export class InterceptorsContextCreator extends ContextCreator {
       return null;
     }
     const instanceHost = instanceWrapper.getInstanceByContextId(
-      contextId,
+      this.getContextId(contextId, instanceWrapper),
       inquirerId,
     );
     return instanceHost && instanceHost.instance;
@@ -108,7 +108,12 @@ export class InterceptorsContextCreator extends ContextCreator {
     const scopedInterceptorWrappers =
       this.config.getGlobalRequestInterceptors() as InstanceWrapper[];
     const scopedInterceptors = iterate(scopedInterceptorWrappers)
-      .map(wrapper => wrapper.getInstanceByContextId(contextId, inquirerId))
+      .map(wrapper =>
+        wrapper.getInstanceByContextId(
+          this.getContextId(contextId, wrapper),
+          inquirerId,
+        ),
+      )
       .filter(host => !!host)
       .map(host => host.instance)
       .toArray();
diff --git a/packages/core/metadata-scanner.ts b/packages/core/metadata-scanner.ts
index 7365a7038..400764e00 100644
--- a/packages/core/metadata-scanner.ts
+++ b/packages/core/metadata-scanner.ts
@@ -4,36 +4,115 @@ import {
   isFunction,
   isNil,
 } from '@nestjs/common/utils/shared.utils';
-import { iterate } from 'iterare';
 
 export class MetadataScanner {
+  private readonly cachedScannedPrototypes: Map<object, string[]> = new Map();
+
+  /**
+   * @deprecated 
+   * @see {@link getAllMethodNames}
+   * @see getAllMethodNames
+   */
   public scanFromPrototype<T extends Injectable, R = any>(
     instance: T,
     prototype: object,
     callback: (name: string) => R,
   ): R[] {
-    const methodNames = new Set(this.getAllFilteredMethodNames(prototype));
-    return iterate(methodNames)
-      .map(callback)
-      .filter(metadata => !isNil(metadata))
-      .toArray();
-  }
+    if (!prototype) {
+      return [];
+    }
+
+    const visitedNames = new Map<string, boolean>();
+    const result: R[] = [];
+
+    do {
+      for (const property of Object.getOwnPropertyNames(prototype)) {
+        if (visitedNames.has(property)) {
+          continue;
+        }
+
+        visitedNames.set(property, true);
+
+        // reason: https://github.com/nestjs/nest/pull/10821#issuecomment-1411916533
+        const descriptor = Object.getOwnPropertyDescriptor(prototype, property);
+
+        if (
+          descriptor.set ||
+          descriptor.get ||
+          isConstructor(property) ||
+          !isFunction(prototype[property])
+        ) {
+          continue;
+        }
 
-  *getAllFilteredMethodNames(prototype: object): IterableIterator<string> {
-    const isMethod = (prop: string) => {
-      const descriptor = Object.getOwnPropertyDescriptor(prototype, prop);
-      if (descriptor.set || descriptor.get) {
-        return false;
+        const value = callback(property);
+
+        if (isNil(value)) {
+          continue;
+        }
+
+        result.push(value);
       }
-      return !isConstructor(prop) && isFunction(prototype[prop]);
-    };
+    } while (
+      (prototype = Reflect.getPrototypeOf(prototype)) &&
+      prototype !== Object.prototype
+    );
+
+    return result;
+  }
+
+  /**
+   * @deprecated 
+   * @see {@link getAllMethodNames}
+   * @see getAllMethodNames
+   */
+  public *getAllFilteredMethodNames(
+    prototype: object,
+  ): IterableIterator<string> {
+    yield* this.getAllMethodNames(prototype);
+  }
+
+  public getAllMethodNames(prototype: object | null): string[] {
+    if (!prototype) {
+      return [];
+    }
+
+    if (this.cachedScannedPrototypes.has(prototype)) {
+      return this.cachedScannedPrototypes.get(prototype);
+    }
+
+    const visitedNames = new Map<string, boolean>();
+    const result: string[] = [];
+
+    this.cachedScannedPrototypes.set(prototype, result);
+
     do {
-      yield* iterate(Object.getOwnPropertyNames(prototype))
-        .filter(isMethod)
-        .toArray();
+      for (const property of Object.getOwnPropertyNames(prototype)) {
+        if (visitedNames.has(property)) {
+          continue;
+        }
+
+        visitedNames.set(property, true);
+
+        // reason: https://github.com/nestjs/nest/pull/10821#issuecomment-1411916533
+        const descriptor = Object.getOwnPropertyDescriptor(prototype, property);
+
+        if (
+          descriptor.set ||
+          descriptor.get ||
+          isConstructor(property) ||
+          !isFunction(prototype[property])
+        ) {
+          continue;
+        }
+
+        result.push(property);
+      }
     } while (
       (prototype = Reflect.getPrototypeOf(prototype)) &&
       prototype !== Object.prototype
     );
+
+    return result;
   }
 }
diff --git a/packages/core/middleware/builder.ts b/packages/core/middleware/builder.ts
index 8cbed802a..ce347a143 100644
--- a/packages/core/middleware/builder.ts
+++ b/packages/core/middleware/builder.ts
@@ -6,10 +6,11 @@ import {
 } from '@nestjs/common/interfaces';
 import {
   MiddlewareConfigProxy,
-  RouteInfo,
   MiddlewareConfiguration,
+  RouteInfo,
 } from '@nestjs/common/interfaces/middleware';
 import { iterate } from 'iterare';
+import { RouteInfoPathExtractor } from './route-info-path-extractor';
 import { RoutesMapper } from './routes-mapper';
 import { filterMiddleware } from './utils';
 
@@ -19,12 +20,17 @@ export class MiddlewareBuilder implements MiddlewareConsumer {
   constructor(
     private readonly routesMapper: RoutesMapper,
     private readonly httpAdapter: HttpServer,
+    private readonly routeInfoPathExtractor: RouteInfoPathExtractor,
   ) {}
 
   public apply(
     ...middleware: Array<Type<any> | Function | any>
   ): MiddlewareConfigProxy {
-    return new MiddlewareBuilder.ConfigProxy(this, flatten(middleware));
+    return new MiddlewareBuilder.ConfigProxy(
+      this,
+      flatten(middleware),
+      this.routeInfoPathExtractor,
+    );
   }
 
   public build(): MiddlewareConfiguration[] {
@@ -41,6 +47,7 @@ export class MiddlewareBuilder implements MiddlewareConsumer {
     constructor(
       private readonly builder: MiddlewareBuilder,
       private readonly middleware: Array<Type<any> | Function | any>,
+      private routeInfoPathExtractor: RouteInfoPathExtractor,
     ) {}
 
     public getExcludedRoutes(): RouteInfo[] {
@@ -50,7 +57,10 @@ export class MiddlewareBuilder implements MiddlewareConsumer {
     public exclude(
       ...routes: Array<string | RouteInfo>
     ): MiddlewareConfigProxy {
-      this.excludedRoutes = this.getRoutesFlatList(routes);
+      this.excludedRoutes = this.getRoutesFlatList(routes).map(route => ({
+        ...route,
+        path: this.routeInfoPathExtractor.extractPathFrom(route),
+      }));
       return this;
     }
 
diff --git a/packages/core/middleware/container.ts b/packages/core/middleware/container.ts
index de8dc214b..5544f6827 100644
--- a/packages/core/middleware/container.ts
+++ b/packages/core/middleware/container.ts
@@ -1,15 +1,14 @@
-import { Type } from '@nestjs/common';
+import { InjectionToken, Type } from '@nestjs/common';
 import { MiddlewareConfiguration } from '@nestjs/common/interfaces/middleware/middleware-configuration.interface';
 import { getClassScope } from '../helpers/get-class-scope';
 import { isDurable } from '../helpers/is-durable';
 import { NestContainer } from '../injector/container';
 import { InstanceWrapper } from '../injector/instance-wrapper';
-import { InstanceToken } from '../injector/module';
 
 export class MiddlewareContainer {
   private readonly middleware = new Map<
     string,
-    Map<InstanceToken, InstanceWrapper>
+    Map<InjectionToken, InstanceWrapper>
   >();
   private readonly configurationSets = new Map<
     string,
@@ -20,7 +19,7 @@ export class MiddlewareContainer {
 
   public getMiddlewareCollection(
     moduleKey: string,
-  ): Map<InstanceToken, InstanceWrapper> {
+  ): Map<InjectionToken, InstanceWrapper> {
     if (!this.middleware.has(moduleKey)) {
       const moduleRef = this.container.getModuleByKey(moduleKey);
       this.middleware.set(moduleKey, moduleRef.middlewares);
@@ -47,7 +46,7 @@ export class MiddlewareContainer {
         new InstanceWrapper({
           scope: getClassScope(metatype),
           durable: isDurable(metatype),
-          name: token,
+          name: token?.name ?? token,
           metatype,
           token,
         }),
diff --git a/packages/core/middleware/middleware-module.ts b/packages/core/middleware/middleware-module.ts
index 777f58964..627ede62b 100644
--- a/packages/core/middleware/middleware-module.ts
+++ b/packages/core/middleware/middleware-module.ts
@@ -1,14 +1,12 @@
-import { HttpServer, VersioningType } from '@nestjs/common';
+import { HttpServer, InjectionToken, Logger } from '@nestjs/common';
 import { RequestMethod } from '@nestjs/common/enums/request-method.enum';
 import {
   MiddlewareConfiguration,
-  RouteInfo,
   NestMiddleware,
+  RouteInfo,
 } from '@nestjs/common/interfaces/middleware';
-import {
-  addLeadingSlash,
-  isUndefined,
-} from '@nestjs/common/utils/shared.utils';
+import { NestApplicationContextOptions } from '@nestjs/common/interfaces/nest-application-context-options.interface';
+import { isUndefined } from '@nestjs/common/utils/shared.utils';
 import { ApplicationConfig } from '../application-config';
 import { InvalidMiddlewareException } from '../errors/exceptions/invalid-middleware.exception';
 import { RuntimeException } from '../errors/exceptions/runtime.exception';
@@ -17,31 +15,39 @@ import { ExecutionContextHost } from '../helpers/execution-context-host';
 import { STATIC_CONTEXT } from '../injector/constants';
 import { NestContainer } from '../injector/container';
 import { Injector } from '../injector/injector';
-import { InstanceWrapper } from '../injector/instance-wrapper';
-import { InstanceToken, Module } from '../injector/module';
+import { ContextId, InstanceWrapper } from '../injector/instance-wrapper';
+import { Module } from '../injector/module';
+import { GraphInspector } from '../inspector/graph-inspector';
+import {
+  Entrypoint,
+  MiddlewareEntrypointMetadata,
+} from '../inspector/interfaces/entrypoint.interface';
 import { REQUEST_CONTEXT_ID } from '../router/request/request-constants';
-import { RoutePathFactory } from '../router/route-path-factory';
 import { RouterExceptionFilters } from '../router/router-exception-filters';
 import { RouterProxy } from '../router/router-proxy';
-import { isRequestMethodAll, isRouteExcluded } from '../router/utils';
+import { isRequestMethodAll } from '../router/utils';
 import { MiddlewareBuilder } from './builder';
 import { MiddlewareContainer } from './container';
 import { MiddlewareResolver } from './resolver';
+import { RouteInfoPathExtractor } from './route-info-path-extractor';
 import { RoutesMapper } from './routes-mapper';
 
-export class MiddlewareModule {
+export class MiddlewareModule<
+  TAppOptions extends NestApplicationContextOptions = NestApplicationContextOptions,
+> {
   private readonly routerProxy = new RouterProxy();
   private readonly exceptionFiltersCache = new WeakMap();
+  private readonly logger = new Logger(MiddlewareModule.name);
 
   private injector: Injector;
   private routerExceptionFilter: RouterExceptionFilters;
   private routesMapper: RoutesMapper;
   private resolver: MiddlewareResolver;
-  private config: ApplicationConfig;
   private container: NestContainer;
   private httpAdapter: HttpServer;
-
-  constructor(private readonly routePathFactory: RoutePathFactory) {}
+  private graphInspector: GraphInspector;
+  private appOptions: TAppOptions;
+  private routeInfoPathExtractor: RouteInfoPathExtractor;
 
   public async register(
     middlewareContainer: MiddlewareContainer,
@@ -49,7 +55,11 @@ export class MiddlewareModule {
     config: ApplicationConfig,
     injector: Injector,
     httpAdapter: HttpServer,
+    graphInspector: GraphInspector,
+    options: TAppOptions,
   ) {
+    this.appOptions = options;
+
     const appRef = container.getHttpAdapterRef();
     this.routerExceptionFilter = new RouterExceptionFilters(
       container,
@@ -57,12 +67,12 @@ export class MiddlewareModule {
       appRef,
     );
     this.routesMapper = new RoutesMapper(container);
-    this.resolver = new MiddlewareResolver(middlewareContainer);
-
-    this.config = config;
+    this.resolver = new MiddlewareResolver(middlewareContainer, injector);
+    this.routeInfoPathExtractor = new RouteInfoPathExtractor(config);
     this.injector = injector;
     this.container = container;
     this.httpAdapter = httpAdapter;
+    this.graphInspector = graphInspector;
 
     const modules = container.getModules();
     await this.resolveMiddleware(middlewareContainer, modules);
@@ -95,8 +105,19 @@ export class MiddlewareModule {
     const middlewareBuilder = new MiddlewareBuilder(
       this.routesMapper,
       this.httpAdapter,
+      this.routeInfoPathExtractor,
     );
-    await instance.configure(middlewareBuilder);
+    try {
+      await instance.configure(middlewareBuilder);
+    } catch (err) {
+      if (!this.appOptions.preview) {
+        throw err;
+      }
+      const warningMessage =
+        `Warning! "${moduleRef.name}" module exposes a "configure" method that throws an exception in the preview mode` +
+        ` (possibly due to missing dependencies). Note: you can ignore this message, just be aware that some of those conditional middlewares will not be reflected in your graph.`;
+      this.logger.warn(warningMessage);
+    }
 
     if (!(middlewareBuilder instanceof MiddlewareBuilder)) {
       return;
@@ -174,6 +195,30 @@ export class MiddlewareModule {
       if (instanceWrapper.isTransient) {
         return;
       }
+      this.graphInspector.insertClassNode(
+        moduleRef,
+        instanceWrapper,
+        'middleware',
+      );
+      const middlewareDefinition: Entrypoint<MiddlewareEntrypointMetadata> = {
+        type: 'middleware',
+        methodName: 'use',
+        className: instanceWrapper.name,
+        classNodeId: instanceWrapper.id,
+        metadata: {
+          key: routeInfo.path,
+          path: routeInfo.path,
+          requestMethod:
+            (RequestMethod[routeInfo.method] as keyof typeof RequestMethod) ??
+            'ALL',
+          version: routeInfo.version,
+        },
+      };
+      this.graphInspector.insertEntrypointDefinition(
+        middlewareDefinition,
+        instanceWrapper.id,
+      );
+
       await this.bindHandler(
         instanceWrapper,
         applicationRef,
@@ -189,7 +234,7 @@ export class MiddlewareModule {
     applicationRef: HttpServer,
     routeInfo: RouteInfo,
     moduleRef: Module,
-    collection: Map<InstanceToken, InstanceWrapper>,
+    collection: Map<InjectionToken, InstanceWrapper>,
   ) {
     const { instance, metatype } = wrapper;
     if (isUndefined(instance?.use)) {
@@ -200,6 +245,9 @@ export class MiddlewareModule {
       const proxy = await this.createProxy(instance);
       return this.registerHandler(applicationRef, routeInfo, proxy);
     }
+
+    const isTreeDurable = wrapper.isDependencyTreeDurable();
+
     await this.registerHandler(
       applicationRef,
       routeInfo,
@@ -209,19 +257,7 @@ export class MiddlewareModule {
         next: () => void,
       ) => {
         try {
-          const contextId = ContextIdFactory.getByRequest(req);
-          if (!req[REQUEST_CONTEXT_ID]) {
-            Object.defineProperty(req, REQUEST_CONTEXT_ID, {
-              value: contextId,
-              enumerable: false,
-              writable: false,
-              configurable: false,
-            });
-            this.container.registerRequestProvider(
-              contextId.getParent ? contextId.payload : req,
-              contextId,
-            );
-          }
+          const contextId = this.getContextId(req, isTreeDurable);
           const contextInstance = await this.injector.loadPerContext(
             instance,
             moduleRef,
@@ -266,56 +302,46 @@ export class MiddlewareModule {
 
   private async registerHandler(
     applicationRef: HttpServer,
-    { path, method, version }: RouteInfo,
+    routeInfo: RouteInfo,
     proxy: <TRequest, TResponse>(
       req: TRequest,
       res: TResponse,
       next: () => void,
     ) => void,
   ) {
-    const prefix = this.config.getGlobalPrefix();
-    const excludedRoutes = this.config.getGlobalPrefixOptions().exclude;
-    if (
-      (Array.isArray(excludedRoutes) &&
-        isRouteExcluded(excludedRoutes, path, method)) ||
-      ['*', '/*', '(.*)', '/(.*)'].includes(path)
-    ) {
-      path = addLeadingSlash(path);
-    } else {
-      const basePath = addLeadingSlash(prefix);
-      if (basePath?.endsWith('/') && path?.startsWith('/')) {
-        // strip slash when a wildcard is being used
-        // and global prefix has been set
-        path = path?.slice(1);
-      }
-      path = basePath + path;
-    }
-
-    const applicationVersioningConfig = this.config.getVersioning();
-    if (version && applicationVersioningConfig.type === VersioningType.URI) {
-      const versionPrefix = this.routePathFactory.getVersionPrefix(
-        applicationVersioningConfig,
-      );
-      path = `/${versionPrefix}${version.toString()}${path}`;
-    }
-
+    const { method } = routeInfo;
+    const paths = this.routeInfoPathExtractor.extractPathsFrom(routeInfo);
     const isMethodAll = isRequestMethodAll(method);
     const requestMethod = RequestMethod[method];
     const router = await applicationRef.createMiddlewareFactory(method);
-    router(
-      path,
-      isMethodAll
-        ? proxy
-        : <TRequest, TResponse>(
-            req: TRequest,
-            res: TResponse,
-            next: () => void,
-          ) => {
-            if (applicationRef.getRequestMethod(req) === requestMethod) {
-              return proxy(req, res, next);
-            }
-            return next();
-          },
-    );
+    const middlewareFunction = isMethodAll
+      ? proxy
+      : <TRequest, TResponse>(
+          req: TRequest,
+          res: TResponse,
+          next: () => void,
+        ) => {
+          if (applicationRef.getRequestMethod(req) === requestMethod) {
+            return proxy(req, res, next);
+          }
+          return next();
+        };
+    paths.forEach(path => router(path, middlewareFunction));
+  }
+
+  private getContextId(request: unknown, isTreeDurable: boolean): ContextId {
+    const contextId = ContextIdFactory.getByRequest(request);
+    if (!request[REQUEST_CONTEXT_ID]) {
+      Object.defineProperty(request, REQUEST_CONTEXT_ID, {
+        value: contextId,
+        enumerable: false,
+        writable: false,
+        configurable: false,
+      });
+
+      const requestProviderValue = isTreeDurable ? contextId.payload : request;
+      this.container.registerRequestProvider(requestProviderValue, contextId);
+    }
+    return contextId;
   }
 }
diff --git a/packages/core/middleware/resolver.ts b/packages/core/middleware/resolver.ts
index 168cd00c0..99d02f418 100644
--- a/packages/core/middleware/resolver.ts
+++ b/packages/core/middleware/resolver.ts
@@ -1,26 +1,28 @@
+import { InjectionToken } from '@nestjs/common';
 import { Injector } from '../injector/injector';
 import { InstanceWrapper } from '../injector/instance-wrapper';
-import { InstanceToken, Module } from '../injector/module';
+import { Module } from '../injector/module';
 import { MiddlewareContainer } from './container';
 
 export class MiddlewareResolver {
-  private readonly instanceLoader = new Injector();
-
-  constructor(private readonly middlewareContainer: MiddlewareContainer) {}
+  constructor(
+    private readonly middlewareContainer: MiddlewareContainer,
+    private readonly injector: Injector,
+  ) {}
 
   public async resolveInstances(moduleRef: Module, moduleName: string) {
-    const middleware =
+    const middlewareMap =
       this.middlewareContainer.getMiddlewareCollection(moduleName);
     const resolveInstance = async (wrapper: InstanceWrapper) =>
-      this.resolveMiddlewareInstance(wrapper, middleware, moduleRef);
-    await Promise.all([...middleware.values()].map(resolveInstance));
+      this.resolveMiddlewareInstance(wrapper, middlewareMap, moduleRef);
+    await Promise.all([...middlewareMap.values()].map(resolveInstance));
   }
 
   private async resolveMiddlewareInstance(
     wrapper: InstanceWrapper,
-    middleware: Map<InstanceToken, InstanceWrapper>,
+    middlewareMap: Map<InjectionToken, InstanceWrapper>,
     moduleRef: Module,
   ) {
-    await this.instanceLoader.loadMiddleware(wrapper, middleware, moduleRef);
+    await this.injector.loadMiddleware(wrapper, middlewareMap, moduleRef);
   }
 }
diff --git a/packages/core/middleware/route-info-path-extractor.ts b/packages/core/middleware/route-info-path-extractor.ts
new file mode 100644
index 000000000..c3d2bf8bf
--- /dev/null
+++ b/packages/core/middleware/route-info-path-extractor.ts
@@ -0,0 +1,87 @@
+import { VersioningType } from '@nestjs/common';
+import {
+  RouteInfo,
+  VersioningOptions,
+  VersionValue,
+} from '@nestjs/common/interfaces';
+import {
+  addLeadingSlash,
+  stripEndSlash,
+} from '@nestjs/common/utils/shared.utils';
+import { ApplicationConfig } from '../application-config';
+import { ExcludeRouteMetadata } from '../router/interfaces/exclude-route-metadata.interface';
+import { isRouteExcluded } from '../router/utils';
+import { RoutePathFactory } from './../router/route-path-factory';
+
+export class RouteInfoPathExtractor {
+  private routePathFactory: RoutePathFactory;
+  private readonly prefixPath: string;
+  private readonly excludedGlobalPrefixRoutes: ExcludeRouteMetadata[];
+  private readonly versioningConfig?: VersioningOptions;
+
+  constructor(private readonly applicationConfig: ApplicationConfig) {
+    this.routePathFactory = new RoutePathFactory(applicationConfig);
+    this.prefixPath = stripEndSlash(
+      addLeadingSlash(this.applicationConfig.getGlobalPrefix()),
+    );
+    this.excludedGlobalPrefixRoutes =
+      this.applicationConfig.getGlobalPrefixOptions().exclude;
+    this.versioningConfig = this.applicationConfig.getVersioning();
+  }
+
+  public extractPathsFrom({ path, method, version }: RouteInfo): string[] {
+    const versionPath = this.extractVersionPathFrom(version);
+
+    if (this.isAWildcard(path)) {
+      return Array.isArray(this.excludedGlobalPrefixRoutes)
+        ? [
+            this.prefixPath + versionPath + addLeadingSlash(path),
+            ...this.excludedGlobalPrefixRoutes.map(
+              route => versionPath + addLeadingSlash(route.path),
+            ),
+          ]
+        : [this.prefixPath + versionPath + addLeadingSlash(path)];
+    }
+
+    return [this.extractNonWildcardPathFrom({ path, method, version })];
+  }
+
+  public extractPathFrom(route: RouteInfo): string {
+    if (this.isAWildcard(route.path) && !route.version) {
+      return addLeadingSlash(route.path);
+    }
+
+    return this.extractNonWildcardPathFrom(route);
+  }
+
+  private isAWildcard(path: string): boolean {
+    return ['*', '/*', '/*/', '(.*)', '/(.*)'].includes(path);
+  }
+
+  private extractNonWildcardPathFrom({
+    path,
+    method,
+    version,
+  }: RouteInfo): string {
+    const versionPath = this.extractVersionPathFrom(version);
+
+    if (
+      Array.isArray(this.excludedGlobalPrefixRoutes) &&
+      isRouteExcluded(this.excludedGlobalPrefixRoutes, path, method)
+    ) {
+      return versionPath + addLeadingSlash(path);
+    }
+
+    return this.prefixPath + versionPath + addLeadingSlash(path);
+  }
+
+  private extractVersionPathFrom(version?: VersionValue): string {
+    if (!version || this.versioningConfig?.type !== VersioningType.URI)
+      return '';
+
+    const versionPrefix = this.routePathFactory.getVersionPrefix(
+      this.versioningConfig,
+    );
+    return addLeadingSlash(versionPrefix + version.toString());
+  }
+}
diff --git a/packages/core/middleware/routes-mapper.ts b/packages/core/middleware/routes-mapper.ts
index 5309bb109..d6f98ec57 100644
--- a/packages/core/middleware/routes-mapper.ts
+++ b/packages/core/middleware/routes-mapper.ts
@@ -1,5 +1,5 @@
 import { MODULE_PATH, PATH_METADATA } from '@nestjs/common/constants';
-import { RouteInfo, Type, VersionValue } from '@nestjs/common/interfaces';
+import { RouteInfo, Type } from '@nestjs/common/interfaces';
 import {
   addLeadingSlash,
   isString,
@@ -8,14 +8,14 @@ import {
 import { NestContainer } from '../injector/container';
 import { Module } from '../injector/module';
 import { MetadataScanner } from '../metadata-scanner';
-import { RouterExplorer } from '../router/router-explorer';
+import { PathsExplorer } from '../router/paths-explorer';
 import { targetModulesByContainer } from '../router/router-module';
 
 export class RoutesMapper {
-  private readonly routerExplorer: RouterExplorer;
+  private readonly pathsExplorer: PathsExplorer;
 
   constructor(private readonly container: NestContainer) {
-    this.routerExplorer = new RouterExplorer(new MetadataScanner(), container);
+    this.pathsExplorer = new PathsExplorer(new MetadataScanner());
   }
 
   public mapRouteToRouteInfo(
@@ -37,7 +37,7 @@ export class RoutesMapper {
     return [
       {
         path: addLeadingSlash(routePath),
-        method: defaultRequestMethod,
+        method: defaultRequestMethod as any,
       },
     ];
   }
@@ -58,7 +58,7 @@ export class RoutesMapper {
     controller: Type<any>,
     routePath: string,
   ): RouteInfo[] {
-    const controllerPaths = this.routerExplorer.scanForPaths(
+    const controllerPaths = this.pathsExplorer.scanForPaths(
       Object.create(controller),
       controller.prototype,
     );
@@ -125,7 +125,7 @@ export class RoutesMapper {
     const modules = Array.from(modulesContainer.values()).filter(moduleRef =>
       moduleRefsSet.has(moduleRef),
     );
-    return modules.find(({ routes }) => routes.has(metatype));
+    return modules.find(({ controllers }) => controllers.has(metatype));
   }
 
   private getModulePath(
diff --git a/packages/core/middleware/utils.ts b/packages/core/middleware/utils.ts
index 19418afc8..7a23e24d0 100644
--- a/packages/core/middleware/utils.ts
+++ b/packages/core/middleware/utils.ts
@@ -1,19 +1,33 @@
 import { RequestMethod } from '@nestjs/common';
 import { HttpServer, RouteInfo, Type } from '@nestjs/common/interfaces';
-import { isFunction } from '@nestjs/common/utils/shared.utils';
+import {
+  addLeadingSlash,
+  isFunction,
+  isString,
+} from '@nestjs/common/utils/shared.utils';
 import { iterate } from 'iterare';
 import * as pathToRegexp from 'path-to-regexp';
-import { v4 as uuid } from 'uuid';
+import { uid } from 'uid';
 import { ExcludeRouteMetadata } from '../router/interfaces/exclude-route-metadata.interface';
 import { isRouteExcluded } from '../router/utils';
 
 export const mapToExcludeRoute = (
-  routes: RouteInfo[],
+  routes: (string | RouteInfo)[],
 ): ExcludeRouteMetadata[] => {
-  return routes.map(({ path, method }) => ({
-    pathRegex: pathToRegexp(path),
-    requestMethod: method,
-  }));
+  return routes.map(route => {
+    if (isString(route)) {
+      return {
+        path: route,
+        requestMethod: RequestMethod.ALL,
+        pathRegex: pathToRegexp(addLeadingSlash(route)),
+      };
+    }
+    return {
+      path: route.path,
+      requestMethod: route.method,
+      pathRegex: pathToRegexp(addLeadingSlash(route.path)),
+    };
+  });
 };
 
 export const filterMiddleware = <T extends Function | Type<any> = any>(
@@ -85,7 +99,7 @@ export function isMiddlewareClass(middleware: any): middleware is Type<any> {
   );
 }
 
-export function assignToken(metatype: Type<any>, token = uuid()): Type<any> {
+export function assignToken(metatype: Type<any>, token = uid(21)): Type<any> {
   Object.defineProperty(metatype, 'name', { value: token });
   return metatype;
 }
diff --git a/packages/core/nest-application-context.ts b/packages/core/nest-application-context.ts
index d050b51d0..ac4d64957 100644
--- a/packages/core/nest-application-context.ts
+++ b/packages/core/nest-application-context.ts
@@ -11,6 +11,7 @@ import {
   GetOrResolveOptions,
   Type,
 } from '@nestjs/common/interfaces';
+import { NestApplicationContextOptions } from '@nestjs/common/interfaces/nest-application-context-options.interface';
 import { isEmpty } from '@nestjs/common/utils/shared.utils';
 import { iterate } from 'iterare';
 import { MESSAGES } from './constants';
@@ -34,19 +35,24 @@ import { Module } from './injector/module';
 /**
  * @publicApi
  */
-export class NestApplicationContext
+export class NestApplicationContext<
+    TOptions extends NestApplicationContextOptions = NestApplicationContextOptions,
+  >
   extends AbstractInstanceResolver
   implements INestApplicationContext
 {
   protected isInitialized = false;
-  protected readonly injector = new Injector();
+  protected injector: Injector;
+  protected readonly logger = new Logger(NestApplicationContext.name, {
+    timestamp: true,
+  });
 
   private shouldFlushLogsOnOverride = false;
   private readonly activeShutdownSignals = new Array<string>();
   private readonly moduleCompiler = new ModuleCompiler();
   private shutdownCleanupRef?: (...args: unknown[]) => unknown;
   private _instanceLinksHost: InstanceLinksHost;
-  private _moduleRefsByDistance?: Array<Module>;
+  private _moduleRefsForHooksByDistance?: Array<Module>;
 
   protected get instanceLinksHost() {
     if (!this._instanceLinksHost) {
@@ -57,10 +63,16 @@ export class NestApplicationContext
 
   constructor(
     protected readonly container: NestContainer,
-    private readonly scope = new Array<Type<any>>(),
+    protected readonly appOptions: TOptions = {} as TOptions,
     private contextModule: Module = null,
+    private readonly scope = new Array<Type<any>>(),
   ) {
     super();
+    this.injector = new Injector();
+
+    if (this.appOptions.preview) {
+      this.printInPreviewModeWarning();
+    }
   }
 
   public selectContextModule() {
@@ -88,7 +100,12 @@ export class NestApplicationContext
     if (!selectedModule) {
       throw new UnknownModuleException();
     }
-    return new NestApplicationContext(this.container, scope, selectedModule);
+    return new NestApplicationContext(
+      this.container,
+      this.appOptions,
+      selectedModule,
+      scope,
+    );
   }
 
   /**
@@ -227,11 +244,11 @@ export class NestApplicationContext
    * Terminates the application
    * @returns {Promise<void>}
    */
-  public async close(): Promise<void> {
+  public async close(signal?: string): Promise<void> {
     await this.callDestroyHook();
-    await this.callBeforeShutdownHook();
+    await this.callBeforeShutdownHook(signal);
     await this.dispose();
-    await this.callShutdownHook();
+    await this.callShutdownHook(signal);
     this.unsubscribeFromProcessSignals();
   }
 
@@ -306,13 +323,20 @@ export class NestApplicationContext
    * @param {string[]} signals The system signals it should listen to
    */
   protected listenToShutdownSignals(signals: string[]) {
+    let receivedSignal = false;
     const cleanup = async (signal: string) => {
       try {
-        signals.forEach(sig => process.removeListener(sig, cleanup));
+        if (receivedSignal) {
+          // If we receive another signal while we're waiting
+          // for the server to stop, just ignore it.
+          return;
+        }
+        receivedSignal = true;
         await this.callDestroyHook();
         await this.callBeforeShutdownHook(signal);
         await this.dispose();
         await this.callShutdownHook(signal);
+        signals.forEach(sig => process.removeListener(sig, cleanup));
         process.kill(process.pid, signal);
       } catch (err) {
         Logger.error(
@@ -348,7 +372,7 @@ export class NestApplicationContext
    * modules and its children.
    */
   protected async callInitHook(): Promise<void> {
-    const modulesSortedByDistance = this.getModulesSortedByDistance();
+    const modulesSortedByDistance = this.getModulesToTriggerHooksOn();
     for (const module of modulesSortedByDistance) {
       await callModuleInitHook(module);
     }
@@ -359,7 +383,7 @@ export class NestApplicationContext
    * modules and its children.
    */
   protected async callDestroyHook(): Promise<void> {
-    const modulesSortedByDistance = this.getModulesSortedByDistance();
+    const modulesSortedByDistance = this.getModulesToTriggerHooksOn();
     for (const module of modulesSortedByDistance) {
       await callModuleDestroyHook(module);
     }
@@ -370,7 +394,7 @@ export class NestApplicationContext
    * modules and its children.
    */
   protected async callBootstrapHook(): Promise<void> {
-    const modulesSortedByDistance = this.getModulesSortedByDistance();
+    const modulesSortedByDistance = this.getModulesToTriggerHooksOn();
     for (const module of modulesSortedByDistance) {
       await callModuleBootstrapHook(module);
     }
@@ -381,7 +405,7 @@ export class NestApplicationContext
    * modules and children.
    */
   protected async callShutdownHook(signal?: string): Promise<void> {
-    const modulesSortedByDistance = this.getModulesSortedByDistance();
+    const modulesSortedByDistance = this.getModulesToTriggerHooksOn();
     for (const module of modulesSortedByDistance) {
       await callAppShutdownHook(module, signal);
     }
@@ -392,22 +416,40 @@ export class NestApplicationContext
    * modules and children.
    */
   protected async callBeforeShutdownHook(signal?: string): Promise<void> {
-    const modulesSortedByDistance = this.getModulesSortedByDistance();
+    const modulesSortedByDistance = this.getModulesToTriggerHooksOn();
     for (const module of modulesSortedByDistance) {
       await callBeforeAppShutdownHook(module, signal);
     }
   }
 
-  private getModulesSortedByDistance(): Module[] {
-    if (this._moduleRefsByDistance) {
-      return this._moduleRefsByDistance;
+  protected assertNotInPreviewMode(methodName: string) {
+    if (this.appOptions.preview) {
+      const error = `Calling the "${methodName}" in the preview mode is not supported.`;
+      this.logger.error(error);
+      throw new Error(error);
+    }
+  }
+
+  private getModulesToTriggerHooksOn(): Module[] {
+    if (this._moduleRefsForHooksByDistance) {
+      return this._moduleRefsForHooksByDistance;
     }
     const modulesContainer = this.container.getModules();
     const compareFn = (a: Module, b: Module) => b.distance - a.distance;
-
-    this._moduleRefsByDistance = Array.from(modulesContainer.values()).sort(
+    const modulesSortedByDistance = Array.from(modulesContainer.values()).sort(
       compareFn,
     );
-    return this._moduleRefsByDistance;
+
+    this._moduleRefsForHooksByDistance = this.appOptions?.preview
+      ? modulesSortedByDistance.filter(moduleRef => moduleRef.initOnPreview)
+      : modulesSortedByDistance;
+    return this._moduleRefsForHooksByDistance;
+  }
+
+  private printInPreviewModeWarning() {
+    this.logger.warn('------------------------------------------------');
+    this.logger.warn('Application is running in the PREVIEW mode!');
+    this.logger.warn('Providers/controllers will not be instantiated.');
+    this.logger.warn('------------------------------------------------');
   }
 }
diff --git a/packages/core/nest-application.ts b/packages/core/nest-application.ts
index a06ee4c98..3b25d5877 100644
--- a/packages/core/nest-application.ts
+++ b/packages/core/nest-application.ts
@@ -7,13 +7,11 @@ import {
   NestHybridApplicationOptions,
   NestInterceptor,
   PipeTransform,
-  RequestMethod,
   VersioningOptions,
   VersioningType,
   WebSocketAdapter,
 } from '@nestjs/common';
 import {
-  RouteInfo,
   GlobalPrefixOptions,
   NestApplicationOptions,
 } from '@nestjs/common/interfaces';
@@ -31,18 +29,18 @@ import {
 } from '@nestjs/common/utils/shared.utils';
 import { iterate } from 'iterare';
 import { platform } from 'os';
-import * as pathToRegexp from 'path-to-regexp';
 import { AbstractHttpAdapter } from './adapters';
 import { ApplicationConfig } from './application-config';
 import { MESSAGES } from './constants';
 import { optionalRequire } from './helpers/optional-require';
 import { NestContainer } from './injector/container';
+import { Injector } from './injector/injector';
+import { GraphInspector } from './inspector/graph-inspector';
 import { MiddlewareContainer } from './middleware/container';
 import { MiddlewareModule } from './middleware/middleware-module';
+import { mapToExcludeRoute } from './middleware/utils';
 import { NestApplicationContext } from './nest-application-context';
-import { ExcludeRouteMetadata } from './router/interfaces/exclude-route-metadata.interface';
 import { Resolver } from './router/interfaces/resolver.interface';
-import { RoutePathFactory } from './router/route-path-factory';
 import { RoutesResolver } from './router/routes-resolver';
 
 const { SocketModule } = optionalRequire(
@@ -58,10 +56,10 @@ const { MicroservicesModule } = optionalRequire(
  * @publicApi
  */
 export class NestApplication
-  extends NestApplicationContext
+  extends NestApplicationContext<NestApplicationOptions>
   implements INestApplication
 {
-  private readonly logger = new Logger(NestApplication.name, {
+  protected readonly logger = new Logger(NestApplication.name, {
     timestamp: true,
   });
   private readonly middlewareModule: MiddlewareModule;
@@ -80,18 +78,20 @@ export class NestApplication
     container: NestContainer,
     private readonly httpAdapter: HttpServer,
     private readonly config: ApplicationConfig,
-    private readonly appOptions: NestApplicationOptions = {},
+    private readonly graphInspector: GraphInspector,
+    appOptions: NestApplicationOptions = {},
   ) {
-    super(container);
+    super(container, appOptions);
 
     this.selectContextModule();
     this.registerHttpServer();
-    this.middlewareModule = new MiddlewareModule(new RoutePathFactory(config));
-
+    this.injector = new Injector({ preview: this.appOptions.preview });
+    this.middlewareModule = new MiddlewareModule();
     this.routesResolver = new RoutesResolver(
       this.container,
       this.config,
       this.injector,
+      this.graphInspector,
     );
   }
 
@@ -143,15 +143,23 @@ export class NestApplication
     this.registerWsModule();
 
     if (this.microservicesModule) {
-      this.microservicesModule.register(this.container, this.config);
+      this.microservicesModule.register(
+        this.container,
+        this.graphInspector,
+        this.config,
+        this.appOptions,
+      );
       this.microservicesModule.setupClients(this.container);
     }
+
     await this.middlewareModule.register(
       this.middlewareContainer,
       this.container,
       this.config,
       this.injector,
       this.httpAdapter,
+      this.graphInspector,
+      this.appOptions,
     );
   }
 
@@ -159,7 +167,13 @@ export class NestApplication
     if (!this.socketModule) {
       return;
     }
-    this.socketModule.register(this.container, this.config, this.httpServer);
+    this.socketModule.register(
+      this.container,
+      this.config,
+      this.graphInspector,
+      this.appOptions,
+      this.httpServer,
+    );
   }
 
   public async init(): Promise<this> {
@@ -217,6 +231,7 @@ export class NestApplication
     const instance = new NestMicroservice(
       this.container,
       microserviceOptions,
+      this.graphInspector,
       applicationConfig,
     );
     instance.registerListeners();
@@ -236,6 +251,7 @@ export class NestApplication
   }
 
   public async startAllMicroservices(): Promise<this> {
+    this.assertNotInPreviewMode('startAllMicroservices');
     await Promise.all(this.microservices.map(msvc => msvc.listen()));
     return this;
   }
@@ -245,6 +261,20 @@ export class NestApplication
     return this;
   }
 
+  public useBodyParser(...args: [any, any?]): this {
+    if (!('useBodyParser' in this.httpAdapter)) {
+      this.logger.warn('Your HTTP Adapter does not support `.useBodyParser`.');
+      return this;
+    }
+
+    const [parserType, ...otherArgs] = args;
+    const rawBody = !!this.appOptions.rawBody;
+
+    this.httpAdapter.useBodyParser(...[parserType, rawBody, ...otherArgs]);
+
+    return this;
+  }
+
   public enableCors(options?: CorsOptions | CorsOptionsDelegate<any>): void {
     this.httpAdapter.enableCors(options);
   }
@@ -259,6 +289,7 @@ export class NestApplication
   public async listen(port: number | string): Promise<any>;
   public async listen(port: number | string, hostname: string): Promise<any>;
   public async listen(port: number | string, ...args: any[]): Promise<any> {
+    this.assertNotInPreviewMode('listen');
     !this.isInitialized && (await this.init());
 
     return new Promise((resolve, reject) => {
@@ -336,20 +367,9 @@ export class NestApplication
   public setGlobalPrefix(prefix: string, options?: GlobalPrefixOptions): this {
     this.config.setGlobalPrefix(prefix);
     if (options) {
-      const exclude = options?.exclude.map(
-        (route: string | RouteInfo): ExcludeRouteMetadata => {
-          if (isString(route)) {
-            return {
-              requestMethod: RequestMethod.ALL,
-              pathRegex: pathToRegexp(addLeadingSlash(route)),
-            };
-          }
-          return {
-            requestMethod: route.method,
-            pathRegex: pathToRegexp(addLeadingSlash(route.path)),
-          };
-        },
-      );
+      const exclude = options?.exclude
+        ? mapToExcludeRoute(options.exclude)
+        : [];
       this.config.setGlobalPrefixOptions({
         ...options,
         exclude,
@@ -365,21 +385,45 @@ export class NestApplication
 
   public useGlobalFilters(...filters: ExceptionFilter[]): this {
     this.config.useGlobalFilters(...filters);
+    filters.forEach(item =>
+      this.graphInspector.insertOrphanedEnhancer({
+        subtype: 'filter',
+        ref: item,
+      }),
+    );
     return this;
   }
 
   public useGlobalPipes(...pipes: PipeTransform<any>[]): this {
     this.config.useGlobalPipes(...pipes);
+    pipes.forEach(item =>
+      this.graphInspector.insertOrphanedEnhancer({
+        subtype: 'pipe',
+        ref: item,
+      }),
+    );
     return this;
   }
 
   public useGlobalInterceptors(...interceptors: NestInterceptor[]): this {
     this.config.useGlobalInterceptors(...interceptors);
+    interceptors.forEach(item =>
+      this.graphInspector.insertOrphanedEnhancer({
+        subtype: 'interceptor',
+        ref: item,
+      }),
+    );
     return this;
   }
 
   public useGlobalGuards(...guards: CanActivate[]): this {
     this.config.useGlobalGuards(...guards);
+    guards.forEach(item =>
+      this.graphInspector.insertOrphanedEnhancer({
+        subtype: 'guard',
+        ref: item,
+      }),
+    );
     return this;
   }
 
diff --git a/packages/core/nest-factory.ts b/packages/core/nest-factory.ts
index 617b11a97..9d4c2c8f9 100644
--- a/packages/core/nest-factory.ts
+++ b/packages/core/nest-factory.ts
@@ -17,7 +17,11 @@ import { ExceptionsZone } from './errors/exceptions-zone';
 import { loadAdapter } from './helpers/load-adapter';
 import { rethrow } from './helpers/rethrow';
 import { NestContainer } from './injector/container';
+import { Injector } from './injector/injector';
 import { InstanceLoader } from './injector/instance-loader';
+import { GraphInspector } from './inspector/graph-inspector';
+import { NoopGraphInspector } from './inspector/noop-graph-inspector';
+import { UuidFactory, UuidFactoryMode } from './inspector/uuid-factory';
 import { MetadataScanner } from './metadata-scanner';
 import { NestApplication } from './nest-application';
 import { NestApplicationContext } from './nest-application-context';
@@ -63,7 +67,7 @@ export class NestFactoryStatic {
     options?: NestApplicationOptions,
   ): Promise<T>;
   public async create<T extends INestApplication = INestApplication>(
-    module: any,
+    moduleCls: any,
     serverOrOptions?: AbstractHttpAdapter | NestApplicationOptions,
     options?: NestApplicationOptions,
   ): Promise<T> {
@@ -73,15 +77,25 @@ export class NestFactoryStatic {
 
     const applicationConfig = new ApplicationConfig();
     const container = new NestContainer(applicationConfig);
+    const graphInspector = this.createGraphInspector(appOptions, container);
+
     this.setAbortOnError(serverOrOptions, options);
     this.registerLoggerConfiguration(appOptions);
 
-    await this.initialize(module, container, applicationConfig, httpServer);
+    await this.initialize(
+      moduleCls,
+      container,
+      graphInspector,
+      applicationConfig,
+      appOptions,
+      httpServer,
+    );
 
     const instance = new NestApplication(
       container,
       httpServer,
       applicationConfig,
+      graphInspector,
       appOptions,
     );
     const target = this.createNestInstance(instance);
@@ -91,14 +105,14 @@ export class NestFactoryStatic {
   /**
    * Creates an instance of NestMicroservice.
    *
-   * @param module Entry (root) application module class
+   * @param moduleCls Entry (root) application module class
    * @param options Optional microservice configuration
    *
    * @returns A promise that, when resolved,
    * contains a reference to the NestMicroservice instance.
    */
   public async createMicroservice<T extends object>(
-    module: any,
+    moduleCls: any,
     options?: NestMicroserviceOptions & T,
   ): Promise<INestMicroservice> {
     const { NestMicroservice } = loadPackage(
@@ -108,39 +122,61 @@ export class NestFactoryStatic {
     );
     const applicationConfig = new ApplicationConfig();
     const container = new NestContainer(applicationConfig);
+    const graphInspector = this.createGraphInspector(options, container);
+
     this.setAbortOnError(options);
     this.registerLoggerConfiguration(options);
 
-    await this.initialize(module, container, applicationConfig);
+    await this.initialize(
+      moduleCls,
+      container,
+      graphInspector,
+      applicationConfig,
+      options,
+    );
     return this.createNestInstance<INestMicroservice>(
-      new NestMicroservice(container, options, applicationConfig),
+      new NestMicroservice(
+        container,
+        options,
+        graphInspector,
+        applicationConfig,
+      ),
     );
   }
 
   /**
    * Creates an instance of NestApplicationContext.
    *
-   * @param module Entry (root) application module class
+   * @param moduleCls Entry (root) application module class
    * @param options Optional Nest application configuration
    *
    * @returns A promise that, when resolved,
    * contains a reference to the NestApplicationContext instance.
    */
   public async createApplicationContext(
-    module: any,
+    moduleCls: any,
     options?: NestApplicationContextOptions,
   ): Promise<INestApplicationContext> {
     const container = new NestContainer();
+    const graphInspector = this.createGraphInspector(options, container);
+
     this.setAbortOnError(options);
     this.registerLoggerConfiguration(options);
 
-    await this.initialize(module, container);
+    const applicationConfig = undefined;
+    await this.initialize(
+      moduleCls,
+      container,
+      graphInspector,
+      applicationConfig,
+      options,
+    );
 
     const modules = container.getModules().values();
     const root = modules.next().value;
 
     const context = this.createNestInstance<NestApplicationContext>(
-      new NestApplicationContext(container, [], root),
+      new NestApplicationContext(container, options, root),
     );
     if (this.autoFlushLogs) {
       context.flushLogsOnOverride();
@@ -155,14 +191,26 @@ export class NestFactoryStatic {
   private async initialize(
     module: any,
     container: NestContainer,
+    graphInspector: GraphInspector,
     config = new ApplicationConfig(),
+    options: NestApplicationContextOptions = {},
     httpServer: HttpServer = null,
   ) {
-    const instanceLoader = new InstanceLoader(container);
+    UuidFactory.mode = options.snapshot
+      ? UuidFactoryMode.Deterministic
+      : UuidFactoryMode.Random;
+
+    const injector = new Injector({ preview: options.preview });
+    const instanceLoader = new InstanceLoader(
+      container,
+      injector,
+      graphInspector,
+    );
     const metadataScanner = new MetadataScanner();
     const dependenciesScanner = new DependenciesScanner(
       container,
       metadataScanner,
+      graphInspector,
       config,
     );
     container.setHttpAdapter(httpServer);
@@ -299,6 +347,15 @@ export class NestFactoryStatic {
     });
     return proxy as unknown as T;
   }
+
+  private createGraphInspector(
+    appOptions: NestApplicationContextOptions,
+    container: NestContainer,
+  ) {
+    return appOptions?.snapshot
+      ? new GraphInspector(container)
+      : NoopGraphInspector;
+  }
 }
 
 /**
diff --git a/packages/core/package.json b/packages/core/package.json
index 928e5a8be..99f801e00 100644
--- a/packages/core/package.json
+++ b/packages/core/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/core",
-  "version": "9.2.0",
+  "version": "9.4.0",
   "description": "Nest - modern, fast, powerful node.js web framework (@core)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -30,13 +30,12 @@
     "@nuxtjs/opencollective": "0.3.2",
     "fast-safe-stringify": "2.1.1",
     "iterare": "1.2.1",
-    "object-hash": "3.0.0",
     "path-to-regexp": "3.2.0",
-    "tslib": "2.4.1",
-    "uuid": "9.0.0"
+    "tslib": "2.5.0",
+    "uid": "2.0.2"
   },
   "devDependencies": {
-    "@nestjs/common": "9.2.0"
+    "@nestjs/common": "9.4.0"
   },
   "peerDependencies": {
     "@nestjs/common": "^9.0.0",
diff --git a/packages/core/pipes/pipes-context-creator.ts b/packages/core/pipes/pipes-context-creator.ts
index 7776f8552..fa8140237 100644
--- a/packages/core/pipes/pipes-context-creator.ts
+++ b/packages/core/pipes/pipes-context-creator.ts
@@ -64,7 +64,7 @@ export class PipesContextCreator extends ContextCreator {
       return null;
     }
     const instanceHost = instanceWrapper.getInstanceByContextId(
-      contextId,
+      this.getContextId(contextId, instanceWrapper),
       inquirerId,
     );
     return instanceHost && instanceHost.instance;
@@ -98,7 +98,12 @@ export class PipesContextCreator extends ContextCreator {
     const scopedPipeWrappers =
       this.config.getGlobalRequestPipes() as InstanceWrapper[];
     const scopedPipes = iterate(scopedPipeWrappers)
-      .map(wrapper => wrapper.getInstanceByContextId(contextId, inquirerId))
+      .map(wrapper =>
+        wrapper.getInstanceByContextId(
+          this.getContextId(contextId, wrapper),
+          inquirerId,
+        ),
+      )
       .filter(host => !!host)
       .map(host => host.instance)
       .toArray();
diff --git a/packages/core/repl/native-functions/debug-repl-fn.ts b/packages/core/repl/native-functions/debug-repl-fn.ts
index 910941584..2f1d4a97d 100644
--- a/packages/core/repl/native-functions/debug-repl-fn.ts
+++ b/packages/core/repl/native-functions/debug-repl-fn.ts
@@ -8,7 +8,7 @@ export class DebugReplFn extends ReplFunction {
   public fnDefinition: ReplFnDefinition = {
     name: 'debug',
     description:
-      'Print all registered modules as a list together with their controllers and providers. If the argument is passed in, for example, "debug(MyModule)" then it will only print components of this specific module.',
+      'Print all registered modules as a list together with their controllers and providers.\nIf the argument is passed in, for example, "debug(MyModule)" then it will only print components of this specific module.',
     signature: '(moduleCls?: ClassRef | string) => void',
   };
 
diff --git a/packages/core/repl/native-functions/methods-repl-fn.ts b/packages/core/repl/native-functions/methods-repl-fn.ts
index 3fb38e6ec..f44e1916e 100644
--- a/packages/core/repl/native-functions/methods-repl-fn.ts
+++ b/packages/core/repl/native-functions/methods-repl-fn.ts
@@ -20,9 +20,7 @@ export class MethodsReplFn extends ReplFunction {
         ? Object.getPrototypeOf(this.ctx.app.get(token))
         : token?.prototype;
 
-    const methods = new Set(
-      this.metadataScanner.getAllFilteredMethodNames(proto),
-    );
+    const methods = this.metadataScanner.getAllMethodNames(proto);
 
     this.ctx.writeToStdout('\n');
     this.ctx.writeToStdout(`${clc.green('Methods')}:\n`);
diff --git a/packages/core/repl/repl-context.ts b/packages/core/repl/repl-context.ts
index 4745b8f8e..e3f71b44f 100644
--- a/packages/core/repl/repl-context.ts
+++ b/packages/core/repl/repl-context.ts
@@ -127,15 +127,15 @@ export class ReplContext {
 
     this.nativeFunctions.set(nativeFunction.fnDefinition.name, nativeFunction);
 
-    nativeFunction.fnDefinition.aliases?.forEach(aliaseName => {
+    nativeFunction.fnDefinition.aliases?.forEach(aliasName => {
       const aliasNativeFunction: InstanceType<ReplFunctionClass> =
         Object.create(nativeFunction);
       aliasNativeFunction.fnDefinition = {
-        name: aliaseName,
+        name: aliasName,
         description: aliasNativeFunction.fnDefinition.description,
         signature: aliasNativeFunction.fnDefinition.signature,
       };
-      this.nativeFunctions.set(aliaseName, aliasNativeFunction);
+      this.nativeFunctions.set(aliasName, aliasNativeFunction);
       nativeFunctions.push(aliasNativeFunction);
     });
 
diff --git a/packages/core/repl/repl-logger.ts b/packages/core/repl/repl-logger.ts
index e6195269f..afaa04316 100644
--- a/packages/core/repl/repl-logger.ts
+++ b/packages/core/repl/repl-logger.ts
@@ -9,6 +9,7 @@ export class ReplLogger extends ConsoleLogger {
     RouterExplorer.name,
     NestApplication.name,
   ];
+
   log(_message: any, context?: string) {
     if (ReplLogger.ignoredContexts.includes(context)) {
       return;
diff --git a/packages/core/repl/repl-native-commands.ts b/packages/core/repl/repl-native-commands.ts
new file mode 100644
index 000000000..5cee6d9ff
--- /dev/null
+++ b/packages/core/repl/repl-native-commands.ts
@@ -0,0 +1,50 @@
+import type { REPLServer } from 'repl';
+
+/**
+ * Displays a list of available commands in the REPL alongside with their
+ * descriptions.
+ * (c) This code was inspired by the 'help' command from Node.js core:
+ * {@link https://github.com/nodejs/node/blob/58b60c1393dd65cd228a8b0084a19acd2c1d16aa/lib/repl.js#L1741-L1759}
+ */
+function listAllCommands(replServer: REPLServer) {
+  Object.keys(replServer.commands)
+    .sort()
+    .forEach(name => {
+      const cmd = replServer.commands[name];
+      if (cmd) {
+        replServer.output.write(`${name}\t${cmd.help || ''}\n`);
+      }
+    });
+}
+
+export function defineDefaultCommandsOnRepl(replServer: REPLServer): void {
+  replServer.defineCommand('help', {
+    help: 'Show REPL options',
+    action(name?: string) {
+      this.clearBufferedCommand();
+
+      if (name) {
+        // Considering native commands before native nestjs injected functions.
+        const nativeCommandOrFunction =
+          this.commands[name] || this.context[name];
+        // NOTE: If the command was retrieve from the context, it will have a `help`
+        // getter property that outputs the helper message and returns undefined.
+        // But if the command was retrieve from the `commands` object, it will
+        // have a `help` property that returns the helper message.
+        const helpMessage = nativeCommandOrFunction?.help;
+        if (helpMessage) {
+          this.output.write(`${helpMessage}\n`);
+        }
+      } else {
+        listAllCommands(this);
+        this.output.write('\n\n');
+        this.context.help();
+        this.output.write(
+          '\nPress Ctrl+C to abort current expression, Ctrl+D to exit the REPL\n',
+        );
+      }
+
+      this.displayPrompt();
+    },
+  });
+}
diff --git a/packages/core/repl/repl.ts b/packages/core/repl/repl.ts
index 980dd652c..2e021a1e4 100644
--- a/packages/core/repl/repl.ts
+++ b/packages/core/repl/repl.ts
@@ -5,6 +5,7 @@ import { assignToObject } from './assign-to-object.util';
 import { REPL_INITIALIZED_MESSAGE } from './constants';
 import { ReplContext } from './repl-context';
 import { ReplLogger } from './repl-logger';
+import { defineDefaultCommandsOnRepl } from './repl-native-commands';
 
 export async function repl(module: Type | DynamicModule) {
   const app = await NestFactory.createApplicationContext(module, {
@@ -23,5 +24,7 @@ export async function repl(module: Type | DynamicModule) {
   });
   assignToObject(replServer.context, replContext.globalScope);
 
+  defineDefaultCommandsOnRepl(replServer);
+
   return replServer;
 }
diff --git a/packages/core/router/interfaces/exclude-route-metadata.interface.ts b/packages/core/router/interfaces/exclude-route-metadata.interface.ts
index 1c143512f..b7f93b600 100644
--- a/packages/core/router/interfaces/exclude-route-metadata.interface.ts
+++ b/packages/core/router/interfaces/exclude-route-metadata.interface.ts
@@ -1,6 +1,11 @@
 import { RequestMethod } from '@nestjs/common';
 
 export interface ExcludeRouteMetadata {
+  /**
+   * Route path.
+   */
+  path: string;
+
   /**
    * Regular expression representing the route path.
    */
diff --git a/packages/core/router/paths-explorer.ts b/packages/core/router/paths-explorer.ts
new file mode 100644
index 000000000..34c9972eb
--- /dev/null
+++ b/packages/core/router/paths-explorer.ts
@@ -0,0 +1,84 @@
+import {
+  METHOD_METADATA,
+  PATH_METADATA,
+  VERSION_METADATA,
+} from '@nestjs/common/constants';
+import { RequestMethod } from '@nestjs/common/enums';
+import { Controller } from '@nestjs/common/interfaces/controllers/controller.interface';
+import { VersionValue } from '@nestjs/common/interfaces/version-options.interface';
+import {
+  addLeadingSlash,
+  isString,
+  isUndefined,
+} from '@nestjs/common/utils/shared.utils';
+import { MetadataScanner } from '../metadata-scanner';
+import { RouterProxyCallback } from './router-proxy';
+
+export interface RouteDefinition {
+  path: string[];
+  requestMethod: RequestMethod;
+  targetCallback: RouterProxyCallback;
+  methodName: string;
+  version?: VersionValue;
+}
+
+export class PathsExplorer {
+  constructor(private readonly metadataScanner: MetadataScanner) {}
+
+  public scanForPaths(
+    instance: Controller,
+    prototype?: object,
+  ): RouteDefinition[] {
+    const instancePrototype = isUndefined(prototype)
+      ? Object.getPrototypeOf(instance)
+      : prototype;
+
+    return this.metadataScanner
+      .getAllMethodNames(instancePrototype)
+      .reduce((acc, method) => {
+        const route = this.exploreMethodMetadata(
+          instance,
+          instancePrototype,
+          method,
+        );
+
+        if (route) {
+          acc.push(route);
+        }
+
+        return acc;
+      }, []);
+  }
+
+  public exploreMethodMetadata(
+    instance: Controller,
+    prototype: object,
+    methodName: string,
+  ): RouteDefinition | null {
+    const instanceCallback = instance[methodName];
+    const prototypeCallback = prototype[methodName];
+    const routePath = Reflect.getMetadata(PATH_METADATA, prototypeCallback);
+    if (isUndefined(routePath)) {
+      return null;
+    }
+    const requestMethod: RequestMethod = Reflect.getMetadata(
+      METHOD_METADATA,
+      prototypeCallback,
+    );
+    const version: VersionValue | undefined = Reflect.getMetadata(
+      VERSION_METADATA,
+      prototypeCallback,
+    );
+    const path = isString(routePath)
+      ? [addLeadingSlash(routePath)]
+      : routePath.map((p: string) => addLeadingSlash(p));
+
+    return {
+      path,
+      requestMethod,
+      targetCallback: instanceCallback,
+      methodName,
+      version,
+    };
+  }
+}
diff --git a/packages/core/router/router-explorer.ts b/packages/core/router/router-explorer.ts
index b158fd181..e7bbc6db1 100644
--- a/packages/core/router/router-explorer.ts
+++ b/packages/core/router/router-explorer.ts
@@ -1,9 +1,5 @@
 import { HttpServer } from '@nestjs/common';
-import {
-  METHOD_METADATA,
-  PATH_METADATA,
-  VERSION_METADATA,
-} from '@nestjs/common/constants';
+import { PATH_METADATA } from '@nestjs/common/constants';
 import { RequestMethod, VersioningType } from '@nestjs/common/enums';
 import { InternalServerErrorException } from '@nestjs/common/exceptions';
 import { Controller } from '@nestjs/common/interfaces/controllers/controller.interface';
@@ -12,14 +8,12 @@ import { VersionValue } from '@nestjs/common/interfaces/version-options.interfac
 import { Logger } from '@nestjs/common/services/logger.service';
 import {
   addLeadingSlash,
-  isString,
   isUndefined,
 } from '@nestjs/common/utils/shared.utils';
 import * as pathToRegexp from 'path-to-regexp';
 import { ApplicationConfig } from '../application-config';
 import { UnknownRequestMappingException } from '../errors/exceptions/unknown-request-mapping.exception';
-import { GuardsConsumer } from '../guards/guards-consumer';
-import { GuardsContextCreator } from '../guards/guards-context-creator';
+import { GuardsConsumer, GuardsContextCreator } from '../guards';
 import { ContextIdFactory } from '../helpers/context-id-factory';
 import { ExecutionContextHost } from '../helpers/execution-context-host';
 import {
@@ -32,13 +26,20 @@ import { NestContainer } from '../injector/container';
 import { Injector } from '../injector/injector';
 import { ContextId, InstanceWrapper } from '../injector/instance-wrapper';
 import { Module } from '../injector/module';
-import { InterceptorsConsumer } from '../interceptors/interceptors-consumer';
-import { InterceptorsContextCreator } from '../interceptors/interceptors-context-creator';
+import {
+  InterceptorsConsumer,
+  InterceptorsContextCreator,
+} from '../interceptors';
+import { GraphInspector } from '../inspector/graph-inspector';
+import {
+  Entrypoint,
+  HttpEntrypointMetadata,
+} from '../inspector/interfaces/entrypoint.interface';
 import { MetadataScanner } from '../metadata-scanner';
-import { PipesConsumer } from '../pipes/pipes-consumer';
-import { PipesContextCreator } from '../pipes/pipes-context-creator';
+import { PipesConsumer, PipesContextCreator } from '../pipes';
 import { ExceptionsFilter } from './interfaces/exceptions-filter.interface';
 import { RoutePathMetadata } from './interfaces/route-path-metadata.interface';
+import { PathsExplorer } from './paths-explorer';
 import { REQUEST_CONTEXT_ID } from './request/request-constants';
 import { RouteParamsFactory } from './route-params-factory';
 import { RoutePathFactory } from './route-path-factory';
@@ -55,6 +56,7 @@ export interface RouteDefinition {
 
 export class RouterExplorer {
   private readonly executionContextCreator: RouterExecutionContext;
+  private readonly pathsExplorer: PathsExplorer;
   private readonly routerMethodFactory = new RouterMethodFactory();
   private readonly logger = new Logger(RouterExplorer.name, {
     timestamp: true,
@@ -62,14 +64,17 @@ export class RouterExplorer {
   private readonly exceptionFiltersCache = new WeakMap();
 
   constructor(
-    private readonly metadataScanner: MetadataScanner,
+    metadataScanner: MetadataScanner,
     private readonly container: NestContainer,
-    private readonly injector?: Injector,
-    private readonly routerProxy?: RouterProxy,
-    private readonly exceptionsFilter?: ExceptionsFilter,
-    private readonly config?: ApplicationConfig,
-    private readonly routePathFactory?: RoutePathFactory,
+    private readonly injector: Injector,
+    private readonly routerProxy: RouterProxy,
+    private readonly exceptionsFilter: ExceptionsFilter,
+    config: ApplicationConfig,
+    private readonly routePathFactory: RoutePathFactory,
+    private readonly graphInspector: GraphInspector,
   ) {
+    this.pathsExplorer = new PathsExplorer(metadataScanner);
+
     const routeParamsFactory = new RouteParamsFactory();
     const pipesContextCreator = new PipesContextCreator(container, config);
     const pipesConsumer = new PipesConsumer();
@@ -101,7 +106,7 @@ export class RouterExplorer {
     routePathMetadata: RoutePathMetadata,
   ) {
     const { instance } = instanceWrapper;
-    const routerPaths = this.scanForPaths(instance);
+    const routerPaths = this.pathsExplorer.scanForPaths(instance);
     this.applyPathsToRouterProxy(
       applicationRef,
       routerPaths,
@@ -124,53 +129,6 @@ export class RouterExplorer {
     return [addLeadingSlash(path)];
   }
 
-  public scanForPaths(
-    instance: Controller,
-    prototype?: object,
-  ): RouteDefinition[] {
-    const instancePrototype = isUndefined(prototype)
-      ? Object.getPrototypeOf(instance)
-      : prototype;
-
-    return this.metadataScanner.scanFromPrototype<Controller, RouteDefinition>(
-      instance,
-      instancePrototype,
-      method => this.exploreMethodMetadata(instance, instancePrototype, method),
-    );
-  }
-
-  public exploreMethodMetadata(
-    instance: Controller,
-    prototype: object,
-    methodName: string,
-  ): RouteDefinition {
-    const instanceCallback = instance[methodName];
-    const prototypeCallback = prototype[methodName];
-    const routePath = Reflect.getMetadata(PATH_METADATA, prototypeCallback);
-    if (isUndefined(routePath)) {
-      return null;
-    }
-    const requestMethod: RequestMethod = Reflect.getMetadata(
-      METHOD_METADATA,
-      prototypeCallback,
-    );
-    const version: VersionValue | undefined = Reflect.getMetadata(
-      VERSION_METADATA,
-      prototypeCallback,
-    );
-    const path = isString(routePath)
-      ? [addLeadingSlash(routePath)]
-      : routePath.map((p: string) => addLeadingSlash(p));
-
-    return {
-      path,
-      requestMethod,
-      targetCallback: instanceCallback,
-      methodName,
-      version,
-    };
-  }
-
   public applyPathsToRouterProxy<T extends HttpServer>(
     router: T,
     routeDefinitions: RouteDefinition[],
@@ -255,7 +213,31 @@ export class RouterExplorer {
         routePathMetadata,
         requestMethod,
       );
-      pathsToRegister.forEach(path => routerMethodRef(path, routeHandler));
+      pathsToRegister.forEach(path => {
+        const entrypointDefinition: Entrypoint<HttpEntrypointMetadata> = {
+          type: 'http-endpoint',
+          methodName,
+          className: instanceWrapper.name,
+          classNodeId: instanceWrapper.id,
+          metadata: {
+            key: path,
+            path,
+            requestMethod: RequestMethod[
+              requestMethod
+            ] as keyof typeof RequestMethod,
+            methodVersion: routePathMetadata.methodVersion as VersionValue,
+            controllerVersion:
+              routePathMetadata.controllerVersion as VersionValue,
+          },
+        };
+
+        routerMethodRef(path, routeHandler);
+
+        this.graphInspector.insertEntrypointDefinition<HttpEntrypointMetadata>(
+          entrypointDefinition,
+          instanceWrapper.id,
+        );
+      });
 
       const pathsToLog = this.routePathFactory.create(
         {
@@ -310,7 +292,13 @@ export class RouterExplorer {
       for (const exp of hostRegExps) {
         const match = hostname.match(exp.regexp);
         if (match) {
-          exp.keys.forEach((key, i) => (req.hosts[key.name] = match[i + 1]));
+          if (exp.keys.length > 0) {
+            exp.keys.forEach((key, i) => (req.hosts[key.name] = match[i + 1]));
+          } else if (exp.regexp && match.groups) {
+            for (const groupName in match.groups) {
+              req.hosts[groupName] = match.groups[groupName];
+            }
+          }
           return handler(req, res, next);
         }
       }
@@ -373,13 +361,16 @@ export class RouterExplorer {
   ) {
     const { instance } = instanceWrapper;
     const collection = moduleRef.controllers;
+
+    const isTreeDurable = instanceWrapper.isDependencyTreeDurable();
+
     return async <TRequest extends Record<any, any>, TResponse>(
       req: TRequest,
       res: TResponse,
       next: () => void,
     ) => {
       try {
-        const contextId = this.getContextId(req);
+        const contextId = this.getContextId(req, isTreeDurable);
         const contextInstance = await this.injector.loadPerContext(
           instance,
           moduleRef,
@@ -415,6 +406,7 @@ export class RouterExplorer {
 
   private getContextId<T extends Record<any, unknown> = any>(
     request: T,
+    isTreeDurable: boolean,
   ): ContextId {
     const contextId = ContextIdFactory.getByRequest(request);
     if (!request[REQUEST_CONTEXT_ID as any]) {
@@ -424,10 +416,9 @@ export class RouterExplorer {
         writable: false,
         configurable: false,
       });
-      this.container.registerRequestProvider(
-        contextId.getParent ? contextId.payload : request,
-        contextId,
-      );
+
+      const requestProviderValue = isTreeDurable ? contextId.payload : request;
+      this.container.registerRequestProvider(requestProviderValue, contextId);
     }
     return contextId;
   }
diff --git a/packages/core/router/router-proxy.ts b/packages/core/router/router-proxy.ts
index c1384e545..30087b0c1 100644
--- a/packages/core/router/router-proxy.ts
+++ b/packages/core/router/router-proxy.ts
@@ -22,6 +22,7 @@ export class RouterProxy {
       } catch (e) {
         const host = new ExecutionContextHost([req, res, next]);
         exceptionsHandler.next(e, host);
+        return res;
       }
     };
   }
@@ -46,6 +47,7 @@ export class RouterProxy {
       } catch (e) {
         const host = new ExecutionContextHost([req, res, next]);
         exceptionsHandler.next(e, host);
+        return res;
       }
     };
   }
diff --git a/packages/core/router/routes-resolver.ts b/packages/core/router/routes-resolver.ts
index 1a0a1fc49..e03ade389 100644
--- a/packages/core/router/routes-resolver.ts
+++ b/packages/core/router/routes-resolver.ts
@@ -5,10 +5,10 @@ import {
   VERSION_METADATA,
 } from '@nestjs/common/constants';
 import {
+  Controller,
   HttpServer,
   Type,
   VersionValue,
-  Controller,
 } from '@nestjs/common/interfaces';
 import { Logger } from '@nestjs/common/services/logger.service';
 import { ApplicationConfig } from '../application-config';
@@ -19,6 +19,7 @@ import {
 import { NestContainer } from '../injector/container';
 import { Injector } from '../injector/injector';
 import { InstanceWrapper } from '../injector/instance-wrapper';
+import { GraphInspector } from '../inspector/graph-inspector';
 import { MetadataScanner } from '../metadata-scanner';
 import { Resolver } from './interfaces/resolver.interface';
 import { RoutePathMetadata } from './interfaces/route-path-metadata.interface';
@@ -40,6 +41,7 @@ export class RoutesResolver implements Resolver {
     private readonly container: NestContainer,
     private readonly applicationConfig: ApplicationConfig,
     private readonly injector: Injector,
+    graphInspector: GraphInspector,
   ) {
     const httpAdapterRef = container.getHttpAdapterRef();
     this.routerExceptionsFilter = new RouterExceptionFilters(
@@ -58,6 +60,7 @@ export class RoutesResolver implements Resolver {
       this.routerExceptionsFilter,
       this.applicationConfig,
       this.routePathFactory,
+      graphInspector,
     );
   }
 
diff --git a/packages/core/router/utils/exclude-route.util.ts b/packages/core/router/utils/exclude-route.util.ts
index 798260bf2..8670f18f4 100644
--- a/packages/core/router/utils/exclude-route.util.ts
+++ b/packages/core/router/utils/exclude-route.util.ts
@@ -1,4 +1,5 @@
 import { RequestMethod } from '@nestjs/common';
+import { addLeadingSlash } from '@nestjs/common/utils/shared.utils';
 import { ExcludeRouteMetadata } from '../interfaces/exclude-route-metadata.interface';
 
 export const isRequestMethodAll = (method: RequestMethod) => {
@@ -15,7 +16,7 @@ export function isRouteExcluded(
       isRequestMethodAll(route.requestMethod) ||
       route.requestMethod === requestMethod
     ) {
-      return route.pathRegex.exec(path);
+      return route.pathRegex.exec(addLeadingSlash(path));
     }
     return false;
   });
diff --git a/packages/core/scanner.ts b/packages/core/scanner.ts
index 0bf28015f..f11f4432e 100644
--- a/packages/core/scanner.ts
+++ b/packages/core/scanner.ts
@@ -1,12 +1,9 @@
-import {
-  DynamicModule,
-  flatten,
-  ForwardReference,
-  Provider,
-} from '@nestjs/common';
+import { DynamicModule, ForwardReference, Provider } from '@nestjs/common';
 import {
   CATCH_WATERMARK,
   CONTROLLER_WATERMARK,
+  EnhancerSubtype,
+  ENHANCER_KEY_TO_SUBTYPE_MAP,
   EXCEPTION_FILTERS_METADATA,
   GUARDS_METADATA,
   INJECTABLE_WATERMARK,
@@ -18,19 +15,18 @@ import {
 import {
   CanActivate,
   ClassProvider,
+  Controller,
   ExceptionFilter,
   ExistingProvider,
   FactoryProvider,
+  Injectable,
   InjectionToken,
   NestInterceptor,
   PipeTransform,
   Scope,
+  Type,
   ValueProvider,
 } from '@nestjs/common/interfaces';
-import { Controller } from '@nestjs/common/interfaces/controllers/controller.interface';
-import { Injectable } from '@nestjs/common/interfaces/injectable.interface';
-import { Type } from '@nestjs/common/interfaces/type.interface';
-import { randomStringGenerator } from '@nestjs/common/utils/random-string-generator.util';
 import {
   isFunction,
   isNil,
@@ -38,7 +34,13 @@ import {
 } from '@nestjs/common/utils/shared.utils';
 import { iterate } from 'iterare';
 import { ApplicationConfig } from './application-config';
-import { APP_FILTER, APP_GUARD, APP_INTERCEPTOR, APP_PIPE } from './constants';
+import {
+  APP_FILTER,
+  APP_GUARD,
+  APP_INTERCEPTOR,
+  APP_PIPE,
+  ENHANCER_TOKEN_TO_SUBTYPE_MAP,
+} from './constants';
 import { CircularDependencyException } from './errors/exceptions/circular-dependency.exception';
 import { InvalidClassModuleException } from './errors/exceptions/invalid-class-module.exception';
 import { InvalidModuleException } from './errors/exceptions/invalid-module.exception';
@@ -48,6 +50,8 @@ import { NestContainer } from './injector/container';
 import { InstanceWrapper } from './injector/instance-wrapper';
 import { InternalCoreModuleFactory } from './injector/internal-core-module/internal-core-module-factory';
 import { Module } from './injector/module';
+import { GraphInspector } from './inspector/graph-inspector';
+import { UuidFactory } from './inspector/uuid-factory';
 import { MetadataScanner } from './metadata-scanner';
 
 interface ApplicationProviderWrapper {
@@ -64,6 +68,7 @@ export class DependenciesScanner {
   constructor(
     private readonly container: NestContainer,
     private readonly metadataScanner: MetadataScanner,
+    private readonly graphInspector: GraphInspector,
     private readonly applicationConfig = new ApplicationConfig(),
   ) {}
 
@@ -211,15 +216,15 @@ export class DependenciesScanner {
     });
   }
 
-  public reflectDynamicMetadata(obj: Type<Injectable>, token: string) {
-    if (!obj || !obj.prototype) {
+  public reflectDynamicMetadata(cls: Type<Injectable>, token: string) {
+    if (!cls || !cls.prototype) {
       return;
     }
-    this.reflectInjectables(obj, token, GUARDS_METADATA);
-    this.reflectInjectables(obj, token, INTERCEPTORS_METADATA);
-    this.reflectInjectables(obj, token, EXCEPTION_FILTERS_METADATA);
-    this.reflectInjectables(obj, token, PIPES_METADATA);
-    this.reflectParamInjectables(obj, token, ROUTE_ARGS_METADATA);
+    this.reflectInjectables(cls, token, GUARDS_METADATA);
+    this.reflectInjectables(cls, token, INTERCEPTORS_METADATA);
+    this.reflectInjectables(cls, token, EXCEPTION_FILTERS_METADATA);
+    this.reflectInjectables(cls, token, PIPES_METADATA);
+    this.reflectParamInjectables(cls, token, ROUTE_ARGS_METADATA);
   }
 
   public reflectExports(module: Type<unknown>, token: string) {
@@ -240,23 +245,45 @@ export class DependenciesScanner {
     token: string,
     metadataKey: string,
   ) {
-    const controllerInjectables = this.reflectMetadata(metadataKey, component);
-    const methodsInjectables = this.metadataScanner.scanFromPrototype(
-      null,
-      component.prototype,
-      this.reflectKeyMetadata.bind(this, component, metadataKey),
+    const controllerInjectables = this.reflectMetadata<Type<Injectable>>(
+      metadataKey,
+      component,
     );
+    const methodInjectables = this.metadataScanner
+      .getAllMethodNames(component.prototype)
+      .reduce((acc, method) => {
+        const methodInjectable = this.reflectKeyMetadata(
+          component,
+          metadataKey,
+          method,
+        );
 
-    const flattenMethodsInjectables = this.flatten(methodsInjectables);
-    const combinedInjectables = [
-      ...controllerInjectables,
-      ...flattenMethodsInjectables,
-    ].filter(isFunction);
-    const injectables = Array.from(new Set(combinedInjectables));
+        if (methodInjectable) {
+          acc.push(methodInjectable);
+        }
+
+        return acc;
+      }, []);
 
-    injectables.forEach(injectable =>
-      this.insertInjectable(injectable, token, component),
+    controllerInjectables.forEach(injectable =>
+      this.insertInjectable(
+        injectable,
+        token,
+        component,
+        ENHANCER_KEY_TO_SUBTYPE_MAP[metadataKey],
+      ),
     );
+    methodInjectables.forEach(methodInjectable => {
+      methodInjectable.metadata.forEach(injectable =>
+        this.insertInjectable(
+          injectable,
+          token,
+          component,
+          ENHANCER_KEY_TO_SUBTYPE_MAP[metadataKey],
+          methodInjectable.methodKey,
+        ),
+      );
+    });
   }
 
   public reflectParamInjectables(
@@ -264,32 +291,56 @@ export class DependenciesScanner {
     token: string,
     metadataKey: string,
   ) {
-    const paramsMetadata = this.metadataScanner.scanFromPrototype(
-      null,
+    const paramsMethods = this.metadataScanner.getAllMethodNames(
       component.prototype,
-      method => Reflect.getMetadata(metadataKey, component, method),
-    );
-    const paramsInjectables = this.flatten(paramsMetadata).map(
-      (param: Record<string, any>) =>
-        flatten(Object.keys(param).map(k => param[k].pipes)).filter(isFunction),
-    );
-    flatten(paramsInjectables).forEach((injectable: Type<Injectable>) =>
-      this.insertInjectable(injectable, token, component),
     );
+
+    paramsMethods.forEach(methodKey => {
+      const metadata: Record<
+        string,
+        {
+          index: number;
+          data: unknown;
+          pipes: Array<Type<PipeTransform> | PipeTransform>;
+        }
+      > = Reflect.getMetadata(metadataKey, component, methodKey);
+
+      if (!metadata) {
+        return;
+      }
+
+      const params = Object.values(metadata);
+      params
+        .map(item => item.pipes)
+        .flat(1)
+        .forEach(injectable =>
+          this.insertInjectable(
+            injectable,
+            token,
+            component,
+            'pipe',
+            methodKey,
+          ),
+        );
+    });
   }
 
   public reflectKeyMetadata(
     component: Type<Injectable>,
     key: string,
-    method: string,
-  ) {
+    methodKey: string,
+  ): { methodKey: string; metadata: any } | undefined {
     let prototype = component.prototype;
     do {
-      const descriptor = Reflect.getOwnPropertyDescriptor(prototype, method);
+      const descriptor = Reflect.getOwnPropertyDescriptor(prototype, methodKey);
       if (!descriptor) {
         continue;
       }
-      return Reflect.getMetadata(key, descriptor.value);
+      const metadata = Reflect.getMetadata(key, descriptor.value);
+      if (!metadata) {
+        return;
+      }
+      return { methodKey, metadata };
     } while (
       (prototype = Reflect.getPrototypeOf(prototype)) &&
       prototype !== Object.prototype &&
@@ -298,7 +349,7 @@ export class DependenciesScanner {
     return undefined;
   }
 
-  public async calculateModulesDistance() {
+  public calculateModulesDistance() {
     const modulesGenerator = this.container.getModules().values();
 
     // Skip "InternalCoreModule" from calculating distance
@@ -306,7 +357,7 @@ export class DependenciesScanner {
 
     const modulesStack = [];
     const calculateDistance = (moduleRef: Module, distance = 1) => {
-      if (modulesStack.includes(moduleRef)) {
+      if (!moduleRef || modulesStack.includes(moduleRef)) {
         return;
       }
       modulesStack.push(moduleRef);
@@ -362,9 +413,8 @@ export class DependenciesScanner {
     if (!providersKeys.includes(type as string)) {
       return this.container.addProvider(provider as any, token);
     }
-    const providerToken = `${
-      type as string
-    } (UUID: ${randomStringGenerator()})`;
+    const uuid = UuidFactory.get(type.toString());
+    const providerToken = `${type as string} (UUID: ${uuid})`;
 
     let scope = (provider as ClassProvider | FactoryProvider).scope;
     if (isNil(scope) && (provider as ClassProvider).useClass) {
@@ -383,21 +433,56 @@ export class DependenciesScanner {
       scope,
     } as Provider;
 
+    const enhancerSubtype =
+      ENHANCER_TOKEN_TO_SUBTYPE_MAP[
+        type as
+          | typeof APP_GUARD
+          | typeof APP_PIPE
+          | typeof APP_FILTER
+          | typeof APP_INTERCEPTOR
+      ];
     const factoryOrClassProvider = newProvider as
       | FactoryProvider
       | ClassProvider;
     if (this.isRequestOrTransient(factoryOrClassProvider.scope)) {
-      return this.container.addInjectable(newProvider, token);
+      return this.container.addInjectable(newProvider, token, enhancerSubtype);
     }
-    this.container.addProvider(newProvider, token);
+    this.container.addProvider(newProvider, token, enhancerSubtype);
   }
 
   public insertInjectable(
-    injectable: Type<Injectable>,
+    injectable: Type<Injectable> | object,
     token: string,
     host: Type<Injectable>,
+    subtype: EnhancerSubtype,
+    methodKey?: string,
   ) {
-    this.container.addInjectable(injectable, token, host);
+    if (isFunction(injectable)) {
+      const instanceWrapper = this.container.addInjectable(
+        injectable as Type,
+        token,
+        subtype,
+        host,
+      ) as InstanceWrapper;
+
+      this.graphInspector.insertEnhancerMetadataCache({
+        moduleToken: token,
+        classRef: host,
+        enhancerInstanceWrapper: instanceWrapper,
+        targetNodeId: instanceWrapper.id,
+        subtype,
+        methodKey,
+      });
+      return instanceWrapper;
+    } else {
+      this.graphInspector.insertEnhancerMetadataCache({
+        moduleToken: token,
+        classRef: host,
+        enhancerRef: injectable,
+        methodKey,
+        subtype,
+      });
+    }
   }
 
   public insertExportedProvider(
@@ -411,7 +496,10 @@ export class DependenciesScanner {
     this.container.addController(controller, token);
   }
 
-  public reflectMetadata(metadataKey: string, metatype: Type<any>) {
+  public reflectMetadata<T = any>(
+    metadataKey: string,
+    metatype: Type<any>,
+  ): T[] {
     return Reflect.getMetadata(metadataKey, metatype) || [];
   }
 
@@ -421,6 +509,7 @@ export class DependenciesScanner {
       this,
       this.container.getModuleCompiler(),
       this.container.getHttpAdapterHostRef(),
+      this.graphInspector,
     );
     const [instance] = await this.scanForModules(moduleDefinition);
     this.container.registerCoreModuleRef(instance);
@@ -438,11 +527,16 @@ export class DependenciesScanner {
         const { injectables } = modulesContainer.get(moduleKey);
         const instanceWrapper = injectables.get(providerKey);
 
-        iterate(modulesContainer.values())
-          .map(module => module.controllers.values())
+        const iterableIterator = modulesContainer.values();
+        iterate(iterableIterator)
+          .map(moduleRef =>
+            Array.from<InstanceWrapper>(moduleRef.controllers.values()).concat(
+              moduleRef.entryProviders,
+            ),
+          )
           .flatten()
-          .forEach(controller =>
-            controller.addEnhancerMetadata(instanceWrapper),
+          .forEach(controllerOrEntryProvider =>
+            controllerOrEntryProvider.addEnhancerMetadata(instanceWrapper),
           );
       });
   }
@@ -471,6 +565,8 @@ export class DependenciesScanner {
             providerKey,
             'injectables',
           );
+
+          this.graphInspector.insertAttachedEnhancer(instanceWrapper);
           return applyRequestProvidersMap[type as string](instanceWrapper);
         }
         instanceWrapper = getInstanceWrapper(
@@ -478,6 +574,7 @@ export class DependenciesScanner {
           providerKey,
           'providers',
         );
+        this.graphInspector.insertAttachedEnhancer(instanceWrapper);
         applyProvidersMap[type as string](instanceWrapper.instance);
       },
     );
@@ -545,10 +642,6 @@ export class DependenciesScanner {
     return module && !!(module as ForwardReference).forwardRef;
   }
 
-  private flatten<T = any>(arr: T[][]): T[] {
-    return arr.flat(1);
-  }
-
   private isRequestOrTransient(scope: Scope): boolean {
     return scope === Scope.REQUEST || scope === Scope.TRANSIENT;
   }
diff --git a/packages/core/test/application-config.spec.ts b/packages/core/test/application-config.spec.ts
index 9418b13db..cff91bb11 100644
--- a/packages/core/test/application-config.spec.ts
+++ b/packages/core/test/application-config.spec.ts
@@ -23,7 +23,11 @@ describe('ApplicationConfig', () => {
     it('should set global path options', () => {
       const options: GlobalPrefixOptions<ExcludeRouteMetadata> = {
         exclude: [
-          { pathRegex: new RegExp(/health/), requestMethod: RequestMethod.GET },
+          {
+            path: '/health',
+            pathRegex: new RegExp(/health/),
+            requestMethod: RequestMethod.GET,
+          },
         ],
       };
       appConfig.setGlobalPrefixOptions(options);
diff --git a/packages/core/test/errors/test/messages.spec.ts b/packages/core/test/errors/test/messages.spec.ts
index 077f0b5cd..cbc3e15bd 100644
--- a/packages/core/test/errors/test/messages.spec.ts
+++ b/packages/core/test/errors/test/messages.spec.ts
@@ -18,8 +18,8 @@ describe('Error Messages', () => {
         stringCleaner(`Nest can't resolve dependencies of the CatService (?, CatService). Please make sure that the argument dependency at index [0] is available in the current context.
   
       Potential solutions:
-      - If dependency is a provider, is it part of the current current?
-      - If dependency is exported from a separate @Module, is that module imported within current?
+      - If dependency is a provider, is it part of the current Module?
+      - If dependency is exported from a separate @Module, is that module imported within Module?
       @Module({
         imports: [ /* the Module containing dependency */ ]
       })
@@ -41,8 +41,8 @@ describe('Error Messages', () => {
         stringCleaner(`Nest can't resolve dependencies of the CatService (?, MY_TOKEN). Please make sure that the argument dependency at index [0] is available in the current context.
   
       Potential solutions:
-      - If dependency is a provider, is it part of the current current?
-      - If dependency is exported from a separate @Module, is that module imported within current?
+      - If dependency is a provider, is it part of the current Module?
+      - If dependency is exported from a separate @Module, is that module imported within Module?
       @Module({
       imports: [ /* the Module containing dependency */ ]
       })
@@ -62,8 +62,8 @@ describe('Error Messages', () => {
         stringCleaner(`Nest can't resolve dependencies of the CatService (?, CatFunction). Please make sure that the argument dependency at index [0] is available in the current context.
   
       Potential solutions:
-      - If dependency is a provider, is it part of the current current?
-      - If dependency is exported from a separate @Module, is that module imported within current?
+      - If dependency is a provider, is it part of the current Module?
+      - If dependency is exported from a separate @Module, is that module imported within Module?
       @Module({
         imports: [ /* the Module containing dependency */ ]
       })
@@ -83,8 +83,8 @@ describe('Error Messages', () => {
         stringCleaner(`Nest can't resolve dependencies of the CatService (?, +). Please make sure that the argument dependency at index [0] is available in the current context.
   
       Potential solutions:
-      - If dependency is a provider, is it part of the current current?
-      - If dependency is exported from a separate @Module, is that module imported within current?
+      - If dependency is a provider, is it part of the current Module?
+      - If dependency is exported from a separate @Module, is that module imported within Module?
         @Module({
           imports: [ /* the Module containing dependency */ ]
         })
@@ -104,6 +104,7 @@ describe('Error Messages', () => {
         stringCleaner(`Nest can't resolve dependencies of the CatService (?, MY_TOKEN). Please make sure that the argument dependency at index [0] is available in the TestModule context.
   
       Potential solutions:
+      - Is TestModule a valid NestJS module?
       - If dependency is a provider, is it part of the current TestModule?
       - If dependency is exported from a separate @Module, is that module imported within TestModule?
         @Module({
@@ -137,8 +138,8 @@ describe('Error Messages', () => {
         stringCleaner(`Nest can't resolve dependencies of the Symbol(CatProvider) (?). Please make sure that the argument dependency at index [0] is available in the current context.
   
       Potential solutions:
-      - If dependency is a provider, is it part of the current current?
-      - If dependency is exported from a separate @Module, is that module imported within current?
+      - If dependency is a provider, is it part of the current Module?
+      - If dependency is exported from a separate @Module, is that module imported within Module?
         @Module({
           imports: [ /* the Module containing dependency */ ]
         })
@@ -158,8 +159,8 @@ describe('Error Messages', () => {
         stringCleaner(`Nest can't resolve dependencies of the CatProvider (?, Symbol(DogProvider)). Please make sure that the argument dependency at index [0] is available in the current context.
   
       Potential solutions:
-      - If dependency is a provider, is it part of the current current?
-      - If dependency is exported from a separate @Module, is that module imported within current?
+      - If dependency is a provider, is it part of the current Module?
+      - If dependency is exported from a separate @Module, is that module imported within Module?
         @Module({
           imports: [ /* the Module containing dependency */ ]
         })
diff --git a/packages/core/test/helpers/context-utils.spec.ts b/packages/core/test/helpers/context-utils.spec.ts
index 802b153e0..d344f954c 100644
--- a/packages/core/test/helpers/context-utils.spec.ts
+++ b/packages/core/test/helpers/context-utils.spec.ts
@@ -87,7 +87,7 @@ describe('ContextUtils', () => {
     });
   });
   describe('mergeParamsMetatypes', () => {
-    it('should return "paramsProperties" when paramtypes array doesnt exists', () => {
+    it('should return "paramsProperties" when paramtypes array doesn\'t exists', () => {
       const paramsProperties = ['1'];
       expect(
         contextUtils.mergeParamsMetatypes(paramsProperties as any, null),
diff --git a/packages/core/test/helpers/router-method-factory.spec.ts b/packages/core/test/helpers/router-method-factory.spec.ts
index 242fc51a3..4f904519f 100644
--- a/packages/core/test/helpers/router-method-factory.spec.ts
+++ b/packages/core/test/helpers/router-method-factory.spec.ts
@@ -29,6 +29,6 @@ describe('RouterMethodFactory', () => {
     expect(factory.get(target, RequestMethod.PATCH)).to.equal(target.patch);
     expect(factory.get(target, RequestMethod.OPTIONS)).to.equal(target.options);
     expect(factory.get(target, RequestMethod.HEAD)).to.equal(target.head);
-    expect(factory.get(target, -1)).to.equal(target.use);
+    expect(factory.get(target, -1 as any)).to.equal(target.use);
   });
 });
diff --git a/packages/core/test/injector/injector.spec.ts b/packages/core/test/injector/injector.spec.ts
index 9b6c8492c..03f400b6b 100644
--- a/packages/core/test/injector/injector.spec.ts
+++ b/packages/core/test/injector/injector.spec.ts
@@ -10,6 +10,8 @@ import { NestContainer } from '../../injector/container';
 import { Injector, PropertyDependency } from '../../injector/injector';
 import { InstanceWrapper } from '../../injector/instance-wrapper';
 import { Module } from '../../injector/module';
+import { PARAMTYPES_METADATA } from '@nestjs/common/constants';
+
 chai.use(chaiAsPromised);
 
 describe('Injector', () => {
@@ -838,6 +840,24 @@ describe('Injector', () => {
       expect(dependencies).to.deep.eq([FixtureDep1, FixtureDep2]);
       expect(optionalDependenciesIds).to.deep.eq([1]);
     });
+
+    it('should not mutate the constructor metadata', async () => {
+      class FixtureDep1 {}
+      /** This needs to be something other than FixtureDep1 so the test can ensure that the metadata was not mutated */
+      const injectionToken = 'test_token';
+
+      @Injectable()
+      class FixtureClass {
+        constructor(@Inject(injectionToken) private dep1: FixtureDep1) {}
+      }
+
+      const wrapper = new InstanceWrapper({ metatype: FixtureClass });
+      const [dependencies] = injector.getClassDependencies(wrapper);
+      expect(dependencies).to.deep.eq([injectionToken]);
+
+      const paramtypes = Reflect.getMetadata(PARAMTYPES_METADATA, FixtureClass);
+      expect(paramtypes).to.deep.eq([FixtureDep1]);
+    });
   });
 
   describe('getFactoryProviderDependencies', () => {
diff --git a/packages/core/test/injector/instance-loader.spec.ts b/packages/core/test/injector/instance-loader.spec.ts
index 8c34354eb..5ee507cdf 100644
--- a/packages/core/test/injector/instance-loader.spec.ts
+++ b/packages/core/test/injector/instance-loader.spec.ts
@@ -6,51 +6,64 @@ import { NestContainer } from '../../injector/container';
 import { Injector } from '../../injector/injector';
 import { InstanceLoader } from '../../injector/instance-loader';
 import { InstanceWrapper } from '../../injector/instance-wrapper';
+import { GraphInspector } from '../../inspector/graph-inspector';
 
 describe('InstanceLoader', () => {
-  let loader: InstanceLoader;
-  let container: NestContainer;
-  let mockContainer: sinon.SinonMock;
-
   @Controller('')
-  class TestRoute {}
+  class TestCtrl {}
 
   @Injectable()
   class TestProvider {}
 
+  let loader: InstanceLoader;
+  let injector: Injector;
+  let container: NestContainer;
+  let graphInspector: GraphInspector;
+  let inspectInstanceWrapperStub: sinon.SinonStub;
+  let mockContainer: sinon.SinonMock;
+  let moduleMock: Record<string, any>;
+
   beforeEach(() => {
     container = new NestContainer();
-    loader = new InstanceLoader(container);
-    mockContainer = sinon.mock(container);
-  });
+    graphInspector = new GraphInspector(container);
 
-  it('should call "loadPrototype" for each provider and route in each module', async () => {
-    const injector = new Injector();
-    (loader as any).injector = injector;
+    inspectInstanceWrapperStub = sinon.stub(
+      graphInspector,
+      'inspectInstanceWrapper',
+    );
 
-    const module = {
+    injector = new Injector();
+    loader = new InstanceLoader(container, injector, graphInspector);
+    mockContainer = sinon.mock(container);
+
+    moduleMock = {
+      imports: new Set(),
       providers: new Map(),
       controllers: new Map(),
       injectables: new Map(),
+      exports: new Set(),
       metatype: { name: 'test' },
     };
-    const providerWrapper: InstanceWrapper = {
+
+    const modules = new Map();
+    modules.set('Test', moduleMock);
+    mockContainer.expects('getModules').returns(modules);
+  });
+
+  it('should call "loadPrototype" for every provider and controller in every module', async () => {
+    const providerWrapper = new InstanceWrapper({
       instance: null,
       metatype: TestProvider,
       token: 'TestProvider',
-    } as any;
-    const routeWrapper: InstanceWrapper = {
+    });
+    const ctrlWrapper = new InstanceWrapper({
       instance: null,
-      metatype: TestRoute,
+      metatype: TestCtrl,
       token: 'TestRoute',
-    } as any;
+    });
 
-    module.providers.set('TestProvider', providerWrapper);
-    module.controllers.set('TestRoute', routeWrapper);
-
-    const modules = new Map();
-    modules.set('Test', module);
-    mockContainer.expects('getModules').returns(modules);
+    moduleMock.providers.set('TestProvider', providerWrapper);
+    moduleMock.controllers.set('TestRoute', ctrlWrapper);
 
     const loadProviderPrototypeStub = sinon.stub(injector, 'loadPrototype');
 
@@ -58,113 +71,125 @@ describe('InstanceLoader', () => {
     sinon.stub(injector, 'loadProvider');
 
     await loader.createInstancesOfDependencies();
+
     expect(
-      loadProviderPrototypeStub.calledWith(providerWrapper, module.providers),
+      loadProviderPrototypeStub.calledWith(
+        providerWrapper,
+        moduleMock.providers,
+      ),
     ).to.be.true;
     expect(
-      loadProviderPrototypeStub.calledWith(routeWrapper, module.controllers),
+      loadProviderPrototypeStub.calledWith(ctrlWrapper, moduleMock.controllers),
     ).to.be.true;
   });
 
-  it('should call "loadProvider" for each provider in each module', async () => {
-    const injector = new Injector();
-    (loader as any).injector = injector;
+  describe('for every provider in every module', () => {
+    const testProviderToken = 'TestProvider';
 
-    const module = {
-      providers: new Map(),
-      controllers: new Map(),
-      injectables: new Map(),
-      metatype: { name: 'test' },
-    };
-    const testComp = new InstanceWrapper({
-      instance: null,
-      metatype: TestProvider,
-      name: 'TestProvider',
-      token: 'TestProvider',
-    });
-    module.providers.set('TestProvider', testComp);
+    let loadProviderStub: sinon.SinonStub;
 
-    const modules = new Map();
-    modules.set('Test', module);
-    mockContainer.expects('getModules').returns(modules);
+    beforeEach(async () => {
+      const testProviderWrapper = new InstanceWrapper({
+        instance: null,
+        metatype: TestProvider,
+        name: testProviderToken,
+        token: testProviderToken,
+      });
+      moduleMock.providers.set(testProviderToken, testProviderWrapper);
 
-    const loadProviderStub = sinon.stub(injector, 'loadProvider');
-    sinon.stub(injector, 'loadController');
+      loadProviderStub = sinon.stub(injector, 'loadProvider');
+      sinon.stub(injector, 'loadController');
 
-    await loader.createInstancesOfDependencies();
-    expect(
-      loadProviderStub.calledWith(
-        module.providers.get('TestProvider'),
-        module as any,
-      ),
-    ).to.be.true;
-  });
+      await loader.createInstancesOfDependencies();
+    });
 
-  it('should call "loadController" for each route in each module', async () => {
-    const injector = new Injector();
-    (loader as any).injector = injector;
+    it('should call "loadProvider"', async () => {
+      expect(
+        loadProviderStub.calledWith(
+          moduleMock.providers.get(testProviderToken),
+          moduleMock as any,
+        ),
+      ).to.be.true;
+    });
 
-    const module = {
-      providers: new Map(),
-      controllers: new Map(),
-      injectables: new Map(),
-      metatype: { name: 'test' },
-    };
-    const wrapper = new InstanceWrapper({
-      name: 'TestRoute',
-      token: 'TestRoute',
-      instance: null,
-      metatype: TestRoute,
+    it('should call "inspectInstanceWrapper"', async () => {
+      expect(
+        inspectInstanceWrapperStub.calledWith(
+          moduleMock.providers.get(testProviderToken),
+          moduleMock as any,
+        ),
+      ).to.be.true;
     });
-    module.controllers.set('TestRoute', wrapper);
+  });
 
-    const modules = new Map();
-    modules.set('Test', module);
-    mockContainer.expects('getModules').returns(modules);
+  describe('for every controller in every module', () => {
+    let loadControllerStub: sinon.SinonStub;
 
-    sinon.stub(injector, 'loadProvider');
-    const loadRoutesStub = sinon.stub(injector, 'loadController');
+    beforeEach(async () => {
+      const wrapper = new InstanceWrapper({
+        name: 'TestRoute',
+        token: 'TestRoute',
+        instance: null,
+        metatype: TestCtrl,
+      });
+      moduleMock.controllers.set('TestRoute', wrapper);
 
-    await loader.createInstancesOfDependencies();
-    expect(
-      loadRoutesStub.calledWith(
-        module.controllers.get('TestRoute'),
-        module as any,
-      ),
-    ).to.be.true;
+      sinon.stub(injector, 'loadProvider');
+      loadControllerStub = sinon.stub(injector, 'loadController');
+
+      await loader.createInstancesOfDependencies();
+    });
+    it('should call "loadController"', async () => {
+      expect(
+        loadControllerStub.calledWith(
+          moduleMock.controllers.get('TestRoute'),
+          moduleMock as any,
+        ),
+      ).to.be.true;
+    });
+    it('should call "inspectInstanceWrapper"', async () => {
+      expect(
+        inspectInstanceWrapperStub.calledWith(
+          moduleMock.controllers.get('TestRoute'),
+          moduleMock as any,
+        ),
+      ).to.be.true;
+    });
   });
 
-  it('should call "loadInjectable" for each injectable in each module', async () => {
-    const injector = new Injector();
-    (loader as any).injector = injector;
+  describe('for every injectable in every module', () => {
+    let loadInjectableStub: sinon.SinonStub;
 
-    const module = {
-      providers: new Map(),
-      controllers: new Map(),
-      injectables: new Map(),
-      metatype: { name: 'test' },
-    };
-    const testComp = new InstanceWrapper({
-      instance: null,
-      metatype: TestProvider,
-      name: 'TestProvider',
-      token: 'TestProvider',
-    });
-    module.injectables.set('TestProvider', testComp);
+    beforeEach(async () => {
+      const testInjectable = new InstanceWrapper({
+        instance: null,
+        metatype: TestProvider,
+        name: 'TestProvider',
+        token: 'TestProvider',
+      });
+      moduleMock.injectables.set('TestProvider', testInjectable);
 
-    const modules = new Map();
-    modules.set('Test', module);
-    mockContainer.expects('getModules').returns(modules);
+      loadInjectableStub = sinon.stub(injector, 'loadInjectable');
+      sinon.stub(injector, 'loadController');
 
-    const loadInjectableStub = sinon.stub(injector, 'loadInjectable');
-    sinon.stub(injector, 'loadController');
+      await loader.createInstancesOfDependencies();
+    });
 
-    await loader.createInstancesOfDependencies();
-    expect(
-      loadInjectableStub.calledWith(
-        module.injectables.get('TestProvider'),
-        module as any,
-      ),
-    ).to.be.true;
+    it('should call "loadInjectable"', async () => {
+      expect(
+        loadInjectableStub.calledWith(
+          moduleMock.injectables.get('TestProvider'),
+          moduleMock as any,
+        ),
+      ).to.be.true;
+    });
+    it('should call "inspectInstanceWrapper"', async () => {
+      expect(
+        inspectInstanceWrapperStub.calledWith(
+          moduleMock.injectables.get('TestProvider'),
+          moduleMock as any,
+        ),
+      ).to.be.true;
+    });
   });
 });
diff --git a/packages/core/test/injector/instance-wrapper.spec.ts b/packages/core/test/injector/instance-wrapper.spec.ts
index d5ab67c15..aedbf5d21 100644
--- a/packages/core/test/injector/instance-wrapper.spec.ts
+++ b/packages/core/test/injector/instance-wrapper.spec.ts
@@ -31,6 +31,39 @@ describe('InstanceWrapper', () => {
   });
 
   describe('isDependencyTreeStatic', () => {
+    describe('when circular reference', () => {
+      it('should return true', () => {
+        const wrapper = new InstanceWrapper();
+        const otherWrapper = new InstanceWrapper();
+        wrapper.addCtorMetadata(0, otherWrapper);
+        otherWrapper.addCtorMetadata(0, wrapper);
+        expect(wrapper.isDependencyTreeStatic()).to.be.true;
+        expect(otherWrapper.isDependencyTreeStatic()).to.be.true;
+      });
+    });
+    describe('when circular reference and one non static', () => {
+      it('should return false', () => {
+        const wrapper = new InstanceWrapper();
+        const otherWrapper = new InstanceWrapper({ scope: Scope.REQUEST });
+        wrapper.addCtorMetadata(0, otherWrapper);
+        otherWrapper.addCtorMetadata(0, wrapper);
+        expect(wrapper.isDependencyTreeStatic()).to.be.false;
+        expect(otherWrapper.isDependencyTreeStatic()).to.be.false;
+      });
+    });
+    describe('when circular reference and one durable', () => {
+      it('should return false', () => {
+        const wrapper = new InstanceWrapper();
+        const otherWrapper = new InstanceWrapper({
+          scope: Scope.REQUEST,
+          durable: true,
+        });
+        wrapper.addCtorMetadata(0, otherWrapper);
+        otherWrapper.addCtorMetadata(0, wrapper);
+        expect(wrapper.isDependencyTreeStatic()).to.be.false;
+        expect(otherWrapper.isDependencyTreeStatic()).to.be.false;
+      });
+    });
     describe('when request scoped', () => {
       it('should return false', () => {
         const wrapper = new InstanceWrapper({
@@ -39,7 +72,68 @@ describe('InstanceWrapper', () => {
         expect(wrapper.isDependencyTreeStatic()).to.be.false;
       });
     });
+    describe('when request scoped durable', () => {
+      it('should return false', () => {
+        const wrapper = new InstanceWrapper({
+          scope: Scope.REQUEST,
+          durable: true,
+        });
+        expect(wrapper.isDependencyTreeStatic()).to.be.false;
+      });
+    });
+    describe('when request scoped explicit non durable', () => {
+      it('should return false', () => {
+        const wrapper = new InstanceWrapper({
+          scope: Scope.REQUEST,
+          durable: false,
+        });
+        expect(wrapper.isDependencyTreeStatic()).to.be.false;
+      });
+    });
+    describe('when default', () => {
+      it('should return true', () => {
+        const wrapper = new InstanceWrapper({});
+        expect(wrapper.isDependencyTreeStatic()).to.be.true;
+      });
+    });
     describe('when statically scoped', () => {
+      describe('dependencies, properties, enhancers', () => {
+        describe('dependencies non static, properties static, enhancers static', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addCtorMetadata(
+              0,
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            wrapper.addPropertiesMetadata('key1', new InstanceWrapper());
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            expect(wrapper.isDependencyTreeStatic()).to.be.false;
+          });
+        });
+        describe('dependencies static, properties non static, enhancers static', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addCtorMetadata(0, new InstanceWrapper());
+            wrapper.addPropertiesMetadata(
+              'key1',
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            expect(wrapper.isDependencyTreeStatic()).to.be.false;
+          });
+        });
+        describe('dependencies static, properties static, enhancers non static', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addCtorMetadata(0, new InstanceWrapper());
+            wrapper.addPropertiesMetadata('key1', new InstanceWrapper());
+            wrapper.addEnhancerMetadata(
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            expect(wrapper.isDependencyTreeStatic()).to.be.false;
+          });
+        });
+      });
       describe('dependencies', () => {
         describe('when each is static', () => {
           it('should return true', () => {
@@ -107,6 +201,39 @@ describe('InstanceWrapper', () => {
   });
 
   describe('isDependencyTreeDurable', () => {
+    describe('when circular reference and default scope', () => {
+      it('should return false', () => {
+        const wrapper = new InstanceWrapper();
+        const otherWrapper = new InstanceWrapper();
+        wrapper.addCtorMetadata(0, otherWrapper);
+        otherWrapper.addCtorMetadata(0, wrapper);
+        expect(wrapper.isDependencyTreeDurable()).to.be.false;
+        expect(otherWrapper.isDependencyTreeDurable()).to.be.false;
+      });
+    });
+    describe('when circular reference and one non durable', () => {
+      it('should return false', () => {
+        const wrapper = new InstanceWrapper();
+        const otherWrapper = new InstanceWrapper({ scope: Scope.REQUEST });
+        wrapper.addCtorMetadata(0, otherWrapper);
+        otherWrapper.addCtorMetadata(0, wrapper);
+        expect(wrapper.isDependencyTreeDurable()).to.be.false;
+        expect(otherWrapper.isDependencyTreeDurable()).to.be.false;
+      });
+    });
+    describe('when circular reference and one durable', () => {
+      it('should return true', () => {
+        const wrapper = new InstanceWrapper();
+        const otherWrapper = new InstanceWrapper({
+          scope: Scope.REQUEST,
+          durable: true,
+        });
+        wrapper.addCtorMetadata(0, otherWrapper);
+        otherWrapper.addCtorMetadata(0, wrapper);
+        expect(wrapper.isDependencyTreeDurable()).to.be.true;
+        expect(otherWrapper.isDependencyTreeDurable()).to.be.true;
+      });
+    });
     describe('when request scoped and durable', () => {
       it('should return true', () => {
         const wrapper = new InstanceWrapper({
@@ -116,8 +243,157 @@ describe('InstanceWrapper', () => {
         expect(wrapper.isDependencyTreeDurable()).to.be.true;
       });
     });
+    describe('when request scoped and non durable', () => {
+      it('should return false', () => {
+        const wrapper = new InstanceWrapper({
+          scope: Scope.REQUEST,
+        });
+        expect(wrapper.isDependencyTreeDurable()).to.be.false;
+      });
+    });
+    describe('when request scoped and explicit non durable', () => {
+      it('should return false', () => {
+        const wrapper = new InstanceWrapper({
+          scope: Scope.REQUEST,
+          durable: false,
+        });
+        expect(wrapper.isDependencyTreeDurable()).to.be.false;
+      });
+    });
+    describe('when default scope', () => {
+      it('should return false', () => {
+        const wrapper = new InstanceWrapper();
+        expect(wrapper.isDependencyTreeDurable()).to.be.false;
+      });
+    });
     describe('when statically scoped', () => {
+      describe('dependencies, properties, enhancers', () => {
+        describe('dependencies non durable, properties non durable, enhancers durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addCtorMetadata(
+              0,
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            wrapper.addCtorMetadata(1, new InstanceWrapper());
+            wrapper.addPropertiesMetadata('key1', new InstanceWrapper());
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('dependencies non durable, properties durable, enhancers durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addCtorMetadata(
+              0,
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            wrapper.addCtorMetadata(1, new InstanceWrapper());
+            wrapper.addPropertiesMetadata(
+              'key1',
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('dependencies non durable, properties durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addCtorMetadata(
+              0,
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            wrapper.addCtorMetadata(1, new InstanceWrapper());
+            wrapper.addPropertiesMetadata('key1', new InstanceWrapper());
+            wrapper.addPropertiesMetadata(
+              'key2',
+              new InstanceWrapper({ scope: Scope.REQUEST, durable: true }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('properties durable, enhancers non durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addPropertiesMetadata('key1', new InstanceWrapper());
+            wrapper.addPropertiesMetadata(
+              'key2',
+              new InstanceWrapper({ scope: Scope.REQUEST, durable: true }),
+            );
+            wrapper.addEnhancerMetadata(
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('dependencies durable, enhancers non durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addCtorMetadata(
+              0,
+              new InstanceWrapper({ scope: Scope.REQUEST, durable: true }),
+            );
+            wrapper.addEnhancerMetadata(
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+      });
       describe('dependencies', () => {
+        describe('when wrapper is non durable and dependency is static', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper({ scope: Scope.REQUEST });
+            wrapper.addCtorMetadata(0, new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when wrapper is durable and dependency is static', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+              durable: true,
+            });
+            wrapper.addCtorMetadata(0, new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
+        describe('when wrapper is non durable and dependency is durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+            });
+            wrapper.addCtorMetadata(
+              0,
+              new InstanceWrapper({ scope: Scope.REQUEST, durable: true }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when wrapper is durable and dependency is static', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+              durable: true,
+            });
+            wrapper.addCtorMetadata(0, new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
+        describe('when wrapper is durable and dependency is non durable', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+              durable: true,
+            });
+            wrapper.addCtorMetadata(
+              0,
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
         describe('when each is static', () => {
           it('should return false', () => {
             const wrapper = new InstanceWrapper();
@@ -152,8 +428,80 @@ describe('InstanceWrapper', () => {
             expect(wrapper.isDependencyTreeDurable()).to.be.true;
           });
         });
+        describe('when one is not static, durable and non durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addCtorMetadata(0, new InstanceWrapper());
+            wrapper.addCtorMetadata(
+              1,
+              new InstanceWrapper({
+                scope: Scope.REQUEST,
+                durable: true,
+              }),
+            );
+            wrapper.addCtorMetadata(
+              2,
+              new InstanceWrapper({
+                scope: Scope.REQUEST,
+              }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
       });
       describe('properties', () => {
+        describe('when wrapper is non durable and dependency is static', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper({ scope: Scope.REQUEST });
+            wrapper.addPropertiesMetadata('key1', new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when wrapper is durable and dependency is static', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+              durable: true,
+            });
+            wrapper.addPropertiesMetadata('key1', new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
+        describe('when wrapper is non durable and dependency is durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+            });
+            wrapper.addPropertiesMetadata(
+              'key1',
+              new InstanceWrapper({ scope: Scope.REQUEST, durable: true }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when wrapper is durable and dependency is static', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+              durable: true,
+            });
+            wrapper.addPropertiesMetadata('key1', new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
+        describe('when wrapper is durable and dependency is non durable', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+              durable: true,
+            });
+            wrapper.addPropertiesMetadata(
+              'key1',
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
         describe('when each is static', () => {
           it('should return false', () => {
             const wrapper = new InstanceWrapper();
@@ -184,8 +532,73 @@ describe('InstanceWrapper', () => {
             expect(wrapper.isDependencyTreeDurable()).to.be.true;
           });
         });
+        describe('when one is not static, non durable and durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addPropertiesMetadata(
+              'key1',
+              new InstanceWrapper({ scope: Scope.REQUEST, durable: true }),
+            );
+            wrapper.addPropertiesMetadata('key2', new InstanceWrapper());
+            wrapper.addPropertiesMetadata(
+              'key3',
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
       });
       describe('enhancers', () => {
+        describe('when wrapper is non durable and dependency is static', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper({ scope: Scope.REQUEST });
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when wrapper is durable and dependency is static', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+              durable: true,
+            });
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
+        describe('when wrapper is non durable and dependency is durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+            });
+            wrapper.addEnhancerMetadata(
+              new InstanceWrapper({ scope: Scope.REQUEST, durable: true }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when wrapper is durable and dependency is static', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+              durable: true,
+            });
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
+        describe('when wrapper is durable and dependency is non durable', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+              durable: true,
+            });
+            wrapper.addEnhancerMetadata(
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
         describe('when each is static', () => {
           it('should return false', () => {
             const wrapper = new InstanceWrapper();
@@ -214,6 +627,19 @@ describe('InstanceWrapper', () => {
             expect(wrapper.isDependencyTreeDurable()).to.be.true;
           });
         });
+        describe('when one is not static, non durable and durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addEnhancerMetadata(
+              new InstanceWrapper({ scope: Scope.REQUEST, durable: true }),
+            );
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            wrapper.addEnhancerMetadata(
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
       });
     });
   });
diff --git a/packages/core/test/injector/internal-core-module/internal-core-module-factory.spec.ts b/packages/core/test/injector/internal-core-module/internal-core-module-factory.spec.ts
index 6222e4d2a..989170044 100644
--- a/packages/core/test/injector/internal-core-module/internal-core-module-factory.spec.ts
+++ b/packages/core/test/injector/internal-core-module/internal-core-module-factory.spec.ts
@@ -6,6 +6,7 @@ import { LazyModuleLoader, ModulesContainer } from '../../../injector';
 import { NestContainer } from '../../../injector/container';
 import { InternalCoreModule } from '../../../injector/internal-core-module/internal-core-module';
 import { InternalCoreModuleFactory } from '../../../injector/internal-core-module/internal-core-module-factory';
+import { SerializedGraph } from '../../../inspector/serialized-graph';
 
 describe('InternalCoreModuleFactory', () => {
   it('should return the internal core module definition', () => {
@@ -14,6 +15,7 @@ describe('InternalCoreModuleFactory', () => {
       null,
       null,
       null,
+      null,
     );
 
     expect(moduleDefinition.module).to.equal(InternalCoreModule);
@@ -25,8 +27,8 @@ describe('InternalCoreModuleFactory', () => {
       ExternalContextCreator,
       ModulesContainer,
       HttpAdapterHost,
-      HttpAdapterHost.name,
       LazyModuleLoader,
+      SerializedGraph,
     ]);
 
     const lazyModuleLoaderProvider = moduleDefinition.providers.find(
diff --git a/packages/core/test/injector/lazy-module-loader/lazy-module-loader.spec.ts b/packages/core/test/injector/lazy-module-loader/lazy-module-loader.spec.ts
index 24cb6f7af..4f2645272 100644
--- a/packages/core/test/injector/lazy-module-loader/lazy-module-loader.spec.ts
+++ b/packages/core/test/injector/lazy-module-loader/lazy-module-loader.spec.ts
@@ -6,7 +6,9 @@ import {
   ModulesContainer,
   NestContainer,
 } from '../../../injector';
+import { Injector } from '../../../injector/injector';
 import { InstanceLoader } from '../../../injector/instance-loader';
+import { GraphInspector } from '../../../inspector/graph-inspector';
 import { MetadataScanner } from '../../../metadata-scanner';
 import { DependenciesScanner } from '../../../scanner';
 
@@ -18,15 +20,26 @@ describe('LazyModuleLoader', () => {
 
   class NoopLogger {
     log() {}
+    error() {}
+    warn() {}
   }
 
   beforeEach(() => {
     const nestContainer = new NestContainer();
+    const graphInspector = new GraphInspector(nestContainer);
     dependenciesScanner = new DependenciesScanner(
       nestContainer,
       new MetadataScanner(),
+      graphInspector,
+    );
+
+    const injector = new Injector();
+    instanceLoader = new InstanceLoader(
+      nestContainer,
+      injector,
+      graphInspector,
+      new NoopLogger(),
     );
-    instanceLoader = new InstanceLoader(nestContainer, new NoopLogger() as any);
     modulesContainer = nestContainer.getModules();
     lazyModuleLoader = new LazyModuleLoader(
       dependenciesScanner,
diff --git a/packages/core/test/injector/module-token-factory.spec.ts b/packages/core/test/injector/module-token-factory.spec.ts
index 9f753773c..22bda3e37 100644
--- a/packages/core/test/injector/module-token-factory.spec.ts
+++ b/packages/core/test/injector/module-token-factory.spec.ts
@@ -1,6 +1,4 @@
 import { expect } from 'chai';
-import stringify from 'fast-safe-stringify';
-import * as hash from 'object-hash';
 import * as sinon from 'sinon';
 import { ModuleTokenFactory } from '../../injector/module-token-factory';
 
@@ -16,30 +14,20 @@ describe('ModuleTokenFactory', () => {
     class Module {}
     it('should return expected token', () => {
       const type = Module;
-      const token = factory.create(type, undefined);
-      expect(token).to.be.deep.eq(
-        hash({
-          id: moduleId,
-          module: Module.name,
-          dynamic: '',
-        }),
-      );
+      const token1 = factory.create(type, undefined);
+      const token2 = factory.create(type, undefined);
+      expect(token1).to.be.deep.eq(token2);
     });
     it('should include dynamic metadata', () => {
       const type = Module;
-      const token = factory.create(type, {
+      const token1 = factory.create(type, {
+        providers: [{}],
+      } as any);
+      const token2 = factory.create(type, {
         providers: [{}],
       } as any);
 
-      expect(token).to.be.deep.eq(
-        hash({
-          id: moduleId,
-          module: Module.name,
-          dynamic: stringify({
-            providers: [{}],
-          }),
-        }),
-      );
+      expect(token1).to.be.deep.eq(token2);
     });
   });
   describe('getModuleName', () => {
@@ -48,18 +36,18 @@ describe('ModuleTokenFactory', () => {
       expect(factory.getModuleName(metatype as any)).to.be.eql(metatype.name);
     });
   });
-  describe('getDynamicMetadataToken', () => {
+  describe('getStringifiedOpaqueToken', () => {
     describe('when metadata exists', () => {
       it('should return hash', () => {
         const metadata = { providers: ['', {}] };
-        expect(factory.getDynamicMetadataToken(metadata as any)).to.be.eql(
+        expect(factory.getStringifiedOpaqueToken(metadata as any)).to.be.eql(
           JSON.stringify(metadata),
         );
       });
       it('should return hash with class', () => {
         class Provider {}
         const metadata = { providers: [Provider], exports: [Provider] };
-        expect(factory.getDynamicMetadataToken(metadata)).to.be.eql(
+        expect(factory.getStringifiedOpaqueToken(metadata)).to.be.eql(
           '{"providers":["Provider"],"exports":["Provider"]}',
         );
       });
@@ -69,10 +57,8 @@ describe('ModuleTokenFactory', () => {
           useValue: function Provider() {},
         };
         const metadata = { providers: [provider] };
-        expect(factory.getDynamicMetadataToken(metadata)).to.be.eql(
-          `{"providers":[{"provide":"ProvideValue","useValue":"${hash(
-            provider.useValue.toString(),
-          )}"}]}`,
+        expect(factory.getStringifiedOpaqueToken(metadata)).to.be.eql(
+          `{"providers":[{"provide":"ProvideValue","useValue":"${provider.useValue.toString()}"}]}`,
         );
       });
       it('should serialize symbols in a dynamic metadata object', () => {
@@ -89,14 +75,14 @@ describe('ModuleTokenFactory', () => {
           ],
         };
 
-        expect(factory.getDynamicMetadataToken(metadata)).to.be.eql(
+        expect(factory.getStringifiedOpaqueToken(metadata)).to.be.eql(
           '{"providers":[{"provide":"Symbol(a)","useValue":"a"},{"provide":"Symbol(b)","useValue":"b"}]}',
         );
       });
     });
     describe('when metadata does not exist', () => {
       it('should return empty string', () => {
-        expect(factory.getDynamicMetadataToken(undefined)).to.be.eql('');
+        expect(factory.getStringifiedOpaqueToken(undefined)).to.be.eql('');
       });
     });
   });
diff --git a/packages/core/test/injector/module.spec.ts b/packages/core/test/injector/module.spec.ts
index 9bddc5aa1..fb8665d15 100644
--- a/packages/core/test/injector/module.spec.ts
+++ b/packages/core/test/injector/module.spec.ts
@@ -56,7 +56,7 @@ describe('Module', () => {
     const setSpy = sinon.spy(collection, 'set');
     (module as any)._injectables = collection;
 
-    module.addInjectable(TestProvider, TestModule);
+    module.addInjectable(TestProvider, 'interceptor', TestModule);
     expect(
       setSpy.calledWith(
         TestProvider,
@@ -69,6 +69,7 @@ describe('Module', () => {
           instance: null,
           durable: undefined,
           isResolved: false,
+          subtype: 'interceptor',
         }),
       ),
     ).to.be.true;
@@ -78,7 +79,7 @@ describe('Module', () => {
     it('should call `addCustomProvider`', () => {
       const addCustomProviderSpy = sinon.spy(module, 'addCustomProvider');
 
-      module.addInjectable({ provide: 'test' } as any);
+      module.addInjectable({ provide: 'test' } as any, 'guard');
       expect(addCustomProviderSpy.called).to.be.true;
     });
   });
@@ -136,6 +137,16 @@ describe('Module', () => {
     expect((addCustomValue as sinon.SinonSpy).called).to.be.true;
   });
 
+  it('should call "addCustomValue" when "useValue" property exists but its value is `undefined`', () => {
+    const addCustomValue = sinon.spy();
+    module.addCustomValue = addCustomValue;
+
+    const provider = { provide: 'test', useValue: undefined };
+
+    module.addCustomProvider(provider as any, new Map());
+    expect((addCustomValue as sinon.SinonSpy).called).to.be.true;
+  });
+
   it('should call "addCustomFactory" when "useFactory" property exists', () => {
     const addCustomFactory = sinon.spy();
     module.addCustomFactory = addCustomFactory;
@@ -180,6 +191,7 @@ describe('Module', () => {
             durable: true,
             instance: null,
             isResolved: false,
+            subtype: undefined,
           }),
         ),
       ).to.be.true;
@@ -211,6 +223,7 @@ describe('Module', () => {
             instance: value,
             isResolved: true,
             async: false,
+            subtype: undefined,
           }),
         ),
       ).to.be.true;
@@ -244,6 +257,7 @@ describe('Module', () => {
             instance: null,
             isResolved: false,
             inject: inject as any,
+            subtype: undefined,
           }),
         ),
       ).to.be.true;
@@ -279,6 +293,7 @@ describe('Module', () => {
             inject: [provider.useExisting as any],
             isResolved: false,
             isAlias: true,
+            subtype: undefined,
           }),
         ),
       ).to.be.true;
diff --git a/packages/core/test/inspector/graph-inspector.spec.ts b/packages/core/test/inspector/graph-inspector.spec.ts
new file mode 100644
index 000000000..e7dea4142
--- /dev/null
+++ b/packages/core/test/inspector/graph-inspector.spec.ts
@@ -0,0 +1,219 @@
+import { Scope } from '@nestjs/common';
+import { expect } from 'chai';
+import * as sinon from 'sinon';
+import { NestContainer } from '../../injector/container';
+import { InstanceWrapper } from '../../injector/instance-wrapper';
+import { Module } from '../../injector/module';
+import { GraphInspector } from '../../inspector/graph-inspector';
+import { EnhancerMetadataCacheEntry } from '../../inspector/interfaces/enhancer-metadata-cache-entry.interface';
+import { SerializedGraph } from '../../inspector/serialized-graph';
+
+describe('GraphInspector', () => {
+  let graphInspector: GraphInspector;
+  let enhancersMetadataCache: Array<EnhancerMetadataCacheEntry>;
+  let graph: SerializedGraph;
+  let container: NestContainer;
+
+  beforeEach(() => {
+    container = new NestContainer();
+    graphInspector = new GraphInspector(container);
+
+    enhancersMetadataCache = graphInspector['enhancersMetadataCache'];
+    graph = graphInspector['graph'];
+  });
+
+  describe('insertEnhancerMetadataCache', () => {
+    it('should insert an enhancer metadata cache entry', () => {
+      const entry = {
+        moduleToken: 'moduleToken',
+        classRef: class AppService {},
+        methodKey: undefined,
+        subtype: 'guard' as const,
+      };
+      graphInspector.insertEnhancerMetadataCache(entry);
+      expect(enhancersMetadataCache).includes(entry);
+    });
+  });
+
+  describe('inspectInstanceWrapper', () => {
+    class AppService {}
+
+    it('should inspect given instance wrapper and insert appropriate edges', () => {
+      const moduleRef = new Module(class TestModule {}, container);
+      const instanceWrapper = new InstanceWrapper({
+        token: AppService,
+        name: AppService.name,
+        metatype: AppService,
+      });
+
+      const param1 = new InstanceWrapper({
+        token: 'PARAM_1',
+        metatype: class A {},
+        host: new Module(class AModule {}, container),
+      });
+      const param2 = new InstanceWrapper({
+        token: 'PARAM_2',
+        metatype: class B {},
+        host: new Module(class BModule {}, container),
+      });
+      const dependency = new InstanceWrapper({
+        name: 'PROPERTY',
+        token: 'PROPERTY',
+        metatype: class C {},
+        host: new Module(class CModule {}, container),
+      });
+
+      instanceWrapper.addCtorMetadata(0, param1);
+      instanceWrapper.addCtorMetadata(1, param2);
+      instanceWrapper.addCtorMetadata(2, dependency);
+
+      graphInspector.inspectInstanceWrapper(instanceWrapper, moduleRef);
+
+      const edgesArr = [...graph['edges'].values()];
+      expect(edgesArr).to.deep.equal([
+        {
+          id: edgesArr[0].id,
+          metadata: {
+            injectionType: 'constructor',
+            keyOrIndex: 0,
+            sourceClassName: instanceWrapper.metatype.name,
+            sourceClassToken: instanceWrapper.token,
+            sourceModuleName: 'TestModule',
+            targetClassName: param1.name,
+            targetClassToken: 'PARAM_1',
+            targetModuleName: 'AModule',
+            type: 'class-to-class',
+          },
+          source: instanceWrapper.id,
+          target: param1.id,
+        },
+        {
+          id: edgesArr[1].id,
+          metadata: {
+            injectionType: 'constructor',
+            keyOrIndex: 1,
+            sourceClassName: instanceWrapper.metatype.name,
+            sourceClassToken: instanceWrapper.token,
+            sourceModuleName: 'TestModule',
+            targetClassName: param2.name,
+            targetClassToken: 'PARAM_2',
+            targetModuleName: 'BModule',
+            type: 'class-to-class',
+          },
+          source: instanceWrapper.id,
+          target: param2.id,
+        },
+        {
+          id: edgesArr[2].id,
+          metadata: {
+            injectionType: 'constructor',
+            keyOrIndex: 2,
+            sourceClassName: 'AppService',
+            sourceClassToken: AppService,
+            sourceModuleName: 'TestModule',
+            targetClassName: dependency.name,
+            targetClassToken: 'PROPERTY',
+            targetModuleName: 'CModule',
+            type: 'class-to-class',
+          },
+          source: instanceWrapper.id,
+          target: dependency.id,
+        },
+      ]);
+    });
+  });
+
+  describe('inspectModules', () => {
+    class TestModule {}
+    class AController {}
+    class RandomPipe {}
+
+    it('should inspect all modules', async () => {
+      const moduleRef = await container.addModule(TestModule, []);
+      moduleRef.addController(AController);
+
+      const subtype = 'interceptor';
+      const enhancerInstanceWrapper = moduleRef.addInjectable(
+        class Enhancer {},
+        subtype,
+      ) as InstanceWrapper;
+
+      const methodKey = 'findOne';
+      enhancersMetadataCache.push(
+        {
+          moduleToken: moduleRef.token,
+          classRef: AController,
+          enhancerRef: new RandomPipe(),
+          methodKey,
+          subtype,
+        },
+        {
+          moduleToken: moduleRef.token,
+          classRef: AController,
+          enhancerRef: function test() {},
+          methodKey,
+          subtype,
+        },
+        {
+          moduleToken: moduleRef.token,
+          classRef: AController,
+          enhancerInstanceWrapper,
+          methodKey: undefined,
+          subtype,
+        },
+      );
+
+      const serializedNode = { metadata: {} };
+      sinon.stub(graph, 'getNodeById').callsFake(() => serializedNode as any);
+
+      graphInspector.inspectModules();
+
+      expect(serializedNode).to.deep.equal({
+        metadata: {
+          enhancers: [
+            { methodKey, name: RandomPipe.name, subtype },
+            { methodKey, name: 'Function', subtype },
+            { methodKey: undefined, id: enhancerInstanceWrapper.id, subtype },
+          ],
+        },
+      });
+    });
+  });
+
+  describe('insertAttachedEnhancer', () => {
+    it('should upsert existing node (update metadata) and add node to "attachedEnhancers" array', () => {
+      const instanceWrapper = new InstanceWrapper({
+        metatype: class A {},
+        token: 'A',
+      });
+
+      const nodeDefinition = {
+        id: instanceWrapper.id,
+        label: 'A',
+        parent: '2c989d11-2731-4828-a2eb-c86d10c73621',
+        metadata: {
+          type: 'provider' as const,
+          sourceModuleName: 'AppModule',
+          durable: false,
+          static: true,
+          scope: Scope.DEFAULT,
+          transient: false,
+          token: class A {},
+          exported: false,
+          initTime: 100,
+        },
+      };
+      const insertedNode = graph.insertNode(nodeDefinition);
+
+      graphInspector.insertAttachedEnhancer(instanceWrapper);
+
+      expect(insertedNode.metadata).to.deep.equal({
+        ...nodeDefinition.metadata,
+        global: true,
+      });
+      expect(graph['extras'].attachedEnhancers).to.deep.contain({
+        nodeId: insertedNode.id,
+      });
+    });
+  });
+});
diff --git a/packages/core/test/inspector/serialized-graph.spec.ts b/packages/core/test/inspector/serialized-graph.spec.ts
new file mode 100644
index 000000000..25c5bd15a
--- /dev/null
+++ b/packages/core/test/inspector/serialized-graph.spec.ts
@@ -0,0 +1,160 @@
+import { Scope } from '@nestjs/common';
+import { expect } from 'chai';
+import { ApplicationConfig } from '../../application-config';
+import { Edge } from '../../inspector/interfaces/edge.interface';
+import { Node } from '../../inspector/interfaces/node.interface';
+import { SerializedGraph } from '../../inspector/serialized-graph';
+
+describe('SerializedGraph', () => {
+  let serializedGraph: SerializedGraph;
+  let nodesCollection: Map<string, Node>;
+  let edgesCollection: Map<string, Edge>;
+
+  beforeEach(() => {
+    serializedGraph = new SerializedGraph();
+    nodesCollection = serializedGraph['nodes'];
+    edgesCollection = serializedGraph['edges'];
+  });
+
+  describe('insertNode', () => {
+    describe('when node definition represents an internal provider', () => {
+      it('should insert a node with the expected schema (internal: true)', () => {
+        const nodeDefinition = {
+          id: '11430093-e992-4ae6-8ba4-c7db80419de8',
+          label: 'ApplicationConfig',
+          parent: '2c989d11-2731-4828-a2eb-c86d10c73621',
+          metadata: {
+            type: 'provider' as const,
+            sourceModuleName: 'AppModule',
+            durable: false,
+            static: true,
+            transient: false,
+            token: ApplicationConfig,
+            scope: Scope.DEFAULT,
+            exported: false,
+            initTime: 100,
+          },
+        };
+        serializedGraph.insertNode(nodeDefinition);
+
+        expect(nodesCollection.get(nodeDefinition.id)).to.deep.equal({
+          ...nodeDefinition,
+          metadata: {
+            ...nodeDefinition.metadata,
+            internal: true,
+          },
+        });
+      });
+    });
+    describe('otherwise', () => {
+      it('should insert a node with the expected schema', () => {
+        class AppService {}
+
+        const nodeDefinition = {
+          id: '11430093-e992-4ae6-8ba4-c7db80419de8',
+          label: 'AppService',
+          parent: '2c989d11-2731-4828-a2eb-c86d10c73621',
+          metadata: {
+            type: 'provider' as const,
+            sourceModuleName: 'AppModule',
+            durable: false,
+            static: true,
+            transient: false,
+            token: AppService,
+            scope: Scope.DEFAULT,
+            exported: false,
+            initTime: 100,
+          },
+        };
+        serializedGraph.insertNode(nodeDefinition);
+
+        expect(nodesCollection.get(nodeDefinition.id)).to.equal(nodeDefinition);
+      });
+    });
+  });
+
+  describe('insertEdge', () => {
+    describe('when edge definition represents internal providers connection', () => {
+      it('should insert an edge with the expected schema (internal: true)', () => {
+        const edgeDefinition = {
+          source: '8920252f-4e7d-4f9e-9eeb-71da467a35cc',
+          target: 'c97bc04d-cfcf-41b1-96ec-db729f33676e',
+          metadata: {
+            type: 'class-to-class' as const,
+            sourceModuleName: 'UtilsExceptionsModule',
+            sourceClassName: 'AllExceptionsFilter',
+            targetClassName: 'HttpAdapterHost',
+            sourceClassToken:
+              'APP_FILTER (UUID: 4187828c-5c76-4aed-a29f-a6eb40054b9d)',
+            targetClassToken: 'HttpAdapterHost',
+            targetModuleName: 'InternalCoreModule',
+            keyOrIndex: 0,
+            injectionType: 'constructor' as const,
+          },
+        };
+        const edge = serializedGraph.insertEdge(edgeDefinition);
+
+        expect(edgesCollection.get(edge.id)).to.deep.equal({
+          ...edgeDefinition,
+          metadata: {
+            ...edgeDefinition.metadata,
+            internal: true,
+          },
+          id: edge.id,
+        });
+      });
+    });
+    describe('otherwise', () => {
+      it('should insert an edge with the expected schema', () => {
+        const edgeDefinition = {
+          source: '8920252f-4e7d-4f9e-9eeb-71da467a35cc',
+          target: 'c97bc04d-cfcf-41b1-96ec-db729f33676e',
+          metadata: {
+            type: 'class-to-class' as const,
+            sourceModuleName: 'UtilsExceptionsModule',
+            sourceClassName: 'AllExceptionsFilter',
+            targetClassName: 'AppService',
+            sourceClassToken:
+              'APP_FILTER (UUID: 4187828c-5c76-4aed-a29f-a6eb40054b9d)',
+            targetClassToken: 'AppService',
+            targetModuleName: 'InternalCoreModule',
+            keyOrIndex: 0,
+            injectionType: 'constructor' as const,
+          },
+        };
+        const edge = serializedGraph.insertEdge(edgeDefinition);
+
+        expect(edgesCollection.get(edge.id)).to.deep.equal({
+          ...edgeDefinition,
+          id: edge.id,
+        });
+      });
+    });
+  });
+
+  describe('getNodeById', () => {
+    it('should return a given node', () => {
+      const nodeDefinition = {
+        id: '11430093-e992-4ae6-8ba4-c7db80419de8',
+        label: 'AppService',
+        parent: '2c989d11-2731-4828-a2eb-c86d10c73621',
+        metadata: {
+          type: 'provider' as const,
+          sourceModuleName: 'AppModule',
+          durable: false,
+          static: true,
+          transient: false,
+          scope: Scope.DEFAULT,
+          token: 'AppService',
+          exported: true,
+          initTime: 100,
+        },
+      };
+
+      nodesCollection.set(nodeDefinition.id, nodeDefinition);
+      expect(serializedGraph.getNodeById(nodeDefinition.id)).to.eq(
+        nodeDefinition,
+      );
+    });
+  });
+});
diff --git a/packages/core/test/interceptors/interceptors-consumer.spec.ts b/packages/core/test/interceptors/interceptors-consumer.spec.ts
index d2efbcaf4..268950fcf 100644
--- a/packages/core/test/interceptors/interceptors-consumer.spec.ts
+++ b/packages/core/test/interceptors/interceptors-consumer.spec.ts
@@ -1,5 +1,7 @@
+import { CallHandler, ExecutionContext, NestInterceptor } from '@nestjs/common';
+import { AsyncLocalStorage } from 'async_hooks';
 import { expect } from 'chai';
-import { lastValueFrom, of } from 'rxjs';
+import { lastValueFrom, Observable, of } from 'rxjs';
 import * as sinon from 'sinon';
 import { InterceptorsConsumer } from '../../interceptors/interceptors-consumer';
 
@@ -35,7 +37,7 @@ describe('InterceptorsConsumer', () => {
       beforeEach(() => {
         next = sinon.stub().returns(Promise.resolve(''));
       });
-      it('should call every `intercept` method', async () => {
+      it('does not call `intercept` (lazy evaluation)', async () => {
         await consumer.intercept(
           interceptors,
           null,
@@ -44,6 +46,19 @@ describe('InterceptorsConsumer', () => {
           next,
         );
 
+        expect(interceptors[0].intercept.called).to.be.false;
+        expect(interceptors[1].intercept.called).to.be.false;
+      });
+      it('should call every `intercept` method when subscribe', async () => {
+        const intercepted = await consumer.intercept(
+          interceptors,
+          null,
+          { constructor: null },
+          null,
+          next,
+        );
+        await transformToResult(intercepted);
+
         expect(interceptors[0].intercept.calledOnce).to.be.true;
         expect(interceptors[1].intercept.calledOnce).to.be.true;
       });
@@ -58,15 +73,6 @@ describe('InterceptorsConsumer', () => {
         expect(next.called).to.be.false;
       });
       it('should call `next` when subscribe', async () => {
-        async function transformToResult(resultOrDeferred: any) {
-          if (
-            resultOrDeferred &&
-            typeof resultOrDeferred.subscribe === 'function'
-          ) {
-            return lastValueFrom(resultOrDeferred);
-          }
-          return resultOrDeferred;
-        }
         const intercepted = await consumer.intercept(
           interceptors,
           null,
@@ -78,6 +84,30 @@ describe('InterceptorsConsumer', () => {
         expect(next.called).to.be.true;
       });
     });
+
+    describe('AsyncLocalStorage', () => {
+      it('Allows an interceptor to set values in AsyncLocalStorage that are accesible from the controller', async () => {
+        const storage = new AsyncLocalStorage<Record<string, any>>({});
+        class StorageInterceptor implements NestInterceptor {
+          intercept(
+            _context: ExecutionContext,
+            next: CallHandler<any>,
+          ): Observable<any> | Promise<Observable<any>> {
+            return storage.run({ value: 'hello' }, () => next.handle());
+          }
+        }
+        const next = () => Promise.resolve(storage.getStore().value);
+        const intercepted = await consumer.intercept(
+          [new StorageInterceptor()],
+          null,
+          { constructor: null },
+          null,
+          next,
+        );
+        const result = await transformToResult(intercepted);
+        expect(result).to.equal('hello');
+      });
+    });
   });
   describe('createContext', () => {
     it('should return execution context object', () => {
@@ -119,3 +149,10 @@ describe('InterceptorsConsumer', () => {
     });
   });
 });
+
+async function transformToResult(resultOrDeferred: any) {
+  if (resultOrDeferred && typeof resultOrDeferred.subscribe === 'function') {
+    return lastValueFrom(resultOrDeferred);
+  }
+  return resultOrDeferred;
+}
diff --git a/packages/core/test/metadata-scanner.spec.ts b/packages/core/test/metadata-scanner.spec.ts
index f0a51b6d0..dd2c78b3f 100644
--- a/packages/core/test/metadata-scanner.spec.ts
+++ b/packages/core/test/metadata-scanner.spec.ts
@@ -30,12 +30,32 @@ describe('MetadataScanner', () => {
     }
 
     it('should return only methods', () => {
-      const methods = scanner.scanFromPrototype(
+      const methods = scanner.getAllMethodNames(Test.prototype);
+      expect(methods).to.eql(['test', 'test2', 'testParent', 'testParent2']);
+    });
+
+    it('should return the same instance for the same prototype', () => {
+      const methods1 = scanner.getAllMethodNames(Test.prototype);
+      const methods2 = scanner.getAllMethodNames(Test.prototype);
+      expect(methods1 === methods2).to.eql(true);
+    });
+
+    it('should keep compatibility with older methods', () => {
+      const methods1 = scanner.getAllMethodNames(Test.prototype).map(m => m[0]);
+      const methods2 = scanner.scanFromPrototype(
         new Test(),
         Test.prototype,
-        a => a,
+        r => r[0],
       );
-      expect(methods).to.eql(['test', 'test2', 'testParent', 'testParent2']);
+
+      expect(methods1).to.eql(methods2);
+
+      const methods3 = scanner.getAllMethodNames(Test.prototype);
+      const methods4 = [
+        ...new Set(scanner.getAllFilteredMethodNames(Test.prototype)),
+      ];
+
+      expect(methods3).to.eql(methods4);
     });
   });
 });
diff --git a/packages/core/test/middleware/builder.spec.ts b/packages/core/test/middleware/builder.spec.ts
index 2ff40229d..bba4943a9 100644
--- a/packages/core/test/middleware/builder.spec.ts
+++ b/packages/core/test/middleware/builder.spec.ts
@@ -1,7 +1,9 @@
 import { expect } from 'chai';
 import { Controller, Get, RequestMethod, Version } from '../../../common';
+import { ApplicationConfig } from '../../application-config';
 import { NestContainer } from '../../injector/container';
 import { MiddlewareBuilder } from '../../middleware/builder';
+import { RouteInfoPathExtractor } from '../../middleware/route-info-path-extractor';
 import { RoutesMapper } from '../../middleware/routes-mapper';
 import { NoopHttpAdapter } from './../utils/noop-adapter.spec';
 
@@ -10,9 +12,11 @@ describe('MiddlewareBuilder', () => {
 
   beforeEach(() => {
     const container = new NestContainer();
+    const appConfig = new ApplicationConfig();
     builder = new MiddlewareBuilder(
       new RoutesMapper(container),
       new NoopHttpAdapter({}),
+      new RouteInfoPathExtractor(appConfig),
     );
   });
   describe('apply', () => {
@@ -72,7 +76,7 @@ describe('MiddlewareBuilder', () => {
       expect(proxy.getExcludedRoutes()).to.be.eql([
         {
           path,
-          method: -1,
+          method: -1 as any,
         },
       ]);
     });
diff --git a/packages/core/test/middleware/middleware-module.spec.ts b/packages/core/test/middleware/middleware-module.spec.ts
index 65e87b6b1..91639e3f0 100644
--- a/packages/core/test/middleware/middleware-module.spec.ts
+++ b/packages/core/test/middleware/middleware-module.spec.ts
@@ -1,6 +1,8 @@
 import { Injectable } from '@nestjs/common';
-import { RoutePathFactory } from '@nestjs/core/router/route-path-factory';
+import { RouteInfoPathExtractor } from '@nestjs/core/middleware/route-info-path-extractor';
+import * as chai from 'chai';
 import { expect } from 'chai';
+import * as chaiAsPromised from 'chai-as-promised';
 import * as sinon from 'sinon';
 import { Controller } from '../../../common/decorators/core/controller.decorator';
 import { RequestMapping } from '../../../common/decorators/http/request-mapping.decorator';
@@ -12,14 +14,18 @@ import { RuntimeException } from '../../errors/exceptions/runtime.exception';
 import { NestContainer } from '../../injector/container';
 import { InstanceWrapper } from '../../injector/instance-wrapper';
 import { Module } from '../../injector/module';
+import { GraphInspector } from '../../inspector/graph-inspector';
 import { MiddlewareBuilder } from '../../middleware/builder';
 import { MiddlewareContainer } from '../../middleware/container';
 import { MiddlewareModule } from '../../middleware/middleware-module';
 import { RouterExceptionFilters } from '../../router/router-exception-filters';
 import { NoopHttpAdapter } from '../utils/noop-adapter.spec';
 
+chai.use(chaiAsPromised);
+
 describe('MiddlewareModule', () => {
   let middlewareModule: MiddlewareModule;
+  let graphInspector: GraphInspector;
 
   @Controller('test')
   class BasicController {}
@@ -39,15 +45,24 @@ describe('MiddlewareModule', () => {
   }
 
   beforeEach(() => {
+    const container = new NestContainer();
     const appConfig = new ApplicationConfig();
-    middlewareModule = new MiddlewareModule(new RoutePathFactory(appConfig));
-    (middlewareModule as any).routerExceptionFilter =
-      new RouterExceptionFilters(
-        new NestContainer(),
-        appConfig,
-        new NoopHttpAdapter({}),
-      );
-    (middlewareModule as any).config = appConfig;
+    graphInspector = new GraphInspector(container);
+    middlewareModule = new MiddlewareModule();
+    middlewareModule['routerExceptionFilter'] = new RouterExceptionFilters(
+      new NestContainer(),
+      appConfig,
+      new NoopHttpAdapter({}),
+    );
+    middlewareModule['routeInfoPathExtractor'] = new RouteInfoPathExtractor(
+      appConfig,
+    );
+    middlewareModule['routerExceptionFilter'] = new RouterExceptionFilters(
+      container,
+      appConfig,
+      new NoopHttpAdapter({}),
+    );
+    middlewareModule['graphInspector'] = graphInspector;
   });
 
   describe('loadConfiguration', () => {
@@ -77,6 +92,7 @@ describe('MiddlewareModule', () => {
           new MiddlewareBuilder(
             (middlewareModule as any).routesMapper,
             undefined,
+            new RouteInfoPathExtractor(new ApplicationConfig()),
           ),
         ),
       ).to.be.true;
@@ -195,5 +211,69 @@ describe('MiddlewareModule', () => {
       );
       expect(createMiddlewareFactoryStub.calledOnce).to.be.true;
     });
+
+    it('should insert the expected middleware definition', async () => {
+      const route = 'testPath';
+      const configuration = {
+        middleware: [TestMiddleware],
+        forRoutes: ['test', BasicController, BaseController],
+      };
+      const instance = new TestMiddleware();
+      const instanceWrapper = new InstanceWrapper({
+        metatype: TestMiddleware,
+        instance,
+        name: TestMiddleware.name,
+      });
+      const createMiddlewareFactoryStub = sinon
+        .stub()
+        .callsFake(() => () => null);
+      const app = {
+        createMiddlewareFactory: createMiddlewareFactoryStub,
+      };
+
+      const stubContainer = new NestContainer();
+      stubContainer
+        .getModules()
+        .set('Test', new Module(TestModule, stubContainer));
+      const container = new MiddlewareContainer(stubContainer);
+      const moduleKey = 'Test';
+      container.insertConfig([configuration], moduleKey);
+      container
+        .getMiddlewareCollection(moduleKey)
+        .set(TestMiddleware, instanceWrapper);
+      sinon
+        .stub(stubContainer, 'getModuleByKey')
+        .callsFake(() => new Module(class {}, stubContainer));
+      middlewareModule['container'] = stubContainer;
+
+      const insertEntrypointDefinitionSpy = sinon.spy(
+        graphInspector,
+        'insertEntrypointDefinition',
+      );
+
+      await middlewareModule.registerRouteMiddleware(
+        container,
+        { path: route, method: RequestMethod.ALL },
+        configuration,
+        moduleKey,
+        app,
+      );
+
+      expect(createMiddlewareFactoryStub.calledOnce).to.be.true;
+      expect(
+        insertEntrypointDefinitionSpy.calledWith({
+          type: 'middleware',
+          methodName: 'use',
+          className: instanceWrapper.name,
+          classNodeId: instanceWrapper.id,
+          metadata: {
+            key: route,
+            path: route,
+            requestMethod: 'ALL',
+            version: undefined,
+          } as any,
+        }),
+      ).to.be.true;
+    });
   });
 });
diff --git a/packages/core/test/middleware/resolver.spec.ts b/packages/core/test/middleware/resolver.spec.ts
index 870e1ecfc..d57e4ee65 100644
--- a/packages/core/test/middleware/resolver.spec.ts
+++ b/packages/core/test/middleware/resolver.spec.ts
@@ -3,6 +3,7 @@ import * as sinon from 'sinon';
 import { Injectable } from '../../../common';
 import { NestMiddleware } from '../../../common/interfaces/middleware/nest-middleware.interface';
 import { NestContainer } from '../../injector';
+import { Injector } from '../../injector/injector';
 import { MiddlewareContainer } from '../../middleware/container';
 import { MiddlewareResolver } from '../../middleware/resolver';
 
@@ -17,16 +18,14 @@ describe('MiddlewareResolver', () => {
   let mockContainer: sinon.SinonMock;
 
   beforeEach(() => {
+    const injector = new Injector();
     container = new MiddlewareContainer(new NestContainer());
-    resolver = new MiddlewareResolver(container);
+    resolver = new MiddlewareResolver(container, injector);
     mockContainer = sinon.mock(container);
   });
 
   it('should resolve middleware instances from container', () => {
-    const loadMiddleware = sinon.stub(
-      resolver['instanceLoader'],
-      'loadMiddleware',
-    );
+    const loadMiddleware = sinon.stub(resolver['injector'], 'loadMiddleware');
     const middleware = new Map();
     const wrapper = {
       instance: { metatype: {} },
diff --git a/packages/core/test/middleware/route-info-path-extractor.spec.ts b/packages/core/test/middleware/route-info-path-extractor.spec.ts
new file mode 100644
index 000000000..967b26243
--- /dev/null
+++ b/packages/core/test/middleware/route-info-path-extractor.spec.ts
@@ -0,0 +1,185 @@
+import { RequestMethod, VersioningType } from '@nestjs/common';
+import { ApplicationConfig } from '@nestjs/core';
+import { mapToExcludeRoute } from '@nestjs/core/middleware/utils';
+import { expect } from 'chai';
+import { RouteInfoPathExtractor } from './../../middleware/route-info-path-extractor';
+
+describe('RouteInfoPathExtractor', () => {
+  describe('extractPathsFrom', () => {
+    let appConfig: ApplicationConfig;
+    let routeInfoPathExtractor: RouteInfoPathExtractor;
+
+    beforeEach(() => {
+      appConfig = new ApplicationConfig();
+      appConfig.enableVersioning({
+        type: VersioningType.URI,
+      });
+      routeInfoPathExtractor = new RouteInfoPathExtractor(appConfig);
+    });
+
+    it(`should return correct paths`, () => {
+      expect(
+        routeInfoPathExtractor.extractPathsFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+        }),
+      ).to.eql(['/*']);
+
+      expect(
+        routeInfoPathExtractor.extractPathsFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+          version: '1',
+        }),
+      ).to.eql(['/v1/*']);
+    });
+
+    it(`should return correct paths when set global prefix`, () => {
+      Reflect.set(routeInfoPathExtractor, 'prefixPath', '/api');
+
+      expect(
+        routeInfoPathExtractor.extractPathsFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+        }),
+      ).to.eql(['/api/*']);
+
+      expect(
+        routeInfoPathExtractor.extractPathsFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+          version: '1',
+        }),
+      ).to.eql(['/api/v1/*']);
+    });
+
+    it(`should return correct paths when set global prefix and global prefix options`, () => {
+      Reflect.set(routeInfoPathExtractor, 'prefixPath', '/api');
+      Reflect.set(
+        routeInfoPathExtractor,
+        'excludedGlobalPrefixRoutes',
+        mapToExcludeRoute(['foo']),
+      );
+
+      expect(
+        routeInfoPathExtractor.extractPathsFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+        }),
+      ).to.eql(['/api/*', '/foo']);
+
+      expect(
+        routeInfoPathExtractor.extractPathsFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+          version: '1',
+        }),
+      ).to.eql(['/api/v1/*', '/v1/foo']);
+
+      expect(
+        routeInfoPathExtractor.extractPathsFrom({
+          path: 'foo',
+          method: RequestMethod.ALL,
+          version: '1',
+        }),
+      ).to.eql(['/v1/foo']);
+
+      expect(
+        routeInfoPathExtractor.extractPathsFrom({
+          path: 'bar',
+          method: RequestMethod.ALL,
+          version: '1',
+        }),
+      ).to.eql(['/api/v1/bar']);
+    });
+  });
+
+  describe('extractPathFrom', () => {
+    let appConfig: ApplicationConfig;
+    let routeInfoPathExtractor: RouteInfoPathExtractor;
+
+    beforeEach(() => {
+      appConfig = new ApplicationConfig();
+      appConfig.enableVersioning({
+        type: VersioningType.URI,
+      });
+      routeInfoPathExtractor = new RouteInfoPathExtractor(appConfig);
+    });
+
+    it(`should return correct path`, () => {
+      expect(
+        routeInfoPathExtractor.extractPathFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+        }),
+      ).to.eql('/*');
+
+      expect(
+        routeInfoPathExtractor.extractPathFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+          version: '1',
+        }),
+      ).to.eql('/v1/*');
+    });
+
+    it(`should return correct path when set global prefix`, () => {
+      Reflect.set(routeInfoPathExtractor, 'prefixPath', '/api');
+
+      expect(
+        routeInfoPathExtractor.extractPathFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+        }),
+      ).to.eql('/*');
+
+      expect(
+        routeInfoPathExtractor.extractPathFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+          version: '1',
+        }),
+      ).to.eql('/api/v1/*');
+    });
+
+    it(`should return correct path when set global prefix and global prefix options`, () => {
+      Reflect.set(routeInfoPathExtractor, 'prefixPath', '/api');
+      Reflect.set(
+        routeInfoPathExtractor,
+        'excludedGlobalPrefixRoutes',
+        mapToExcludeRoute(['foo']),
+      );
+
+      expect(
+        routeInfoPathExtractor.extractPathFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+        }),
+      ).to.eql('/*');
+
+      expect(
+        routeInfoPathExtractor.extractPathFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+          version: '1',
+        }),
+      ).to.eql('/api/v1/*');
+
+      expect(
+        routeInfoPathExtractor.extractPathFrom({
+          path: 'foo',
+          method: RequestMethod.ALL,
+          version: '1',
+        }),
+      ).to.eql('/v1/foo');
+
+      expect(
+        routeInfoPathExtractor.extractPathFrom({
+          path: 'bar',
+          method: RequestMethod.ALL,
+          version: '1',
+        }),
+      ).to.eql('/api/v1/bar');
+    });
+  });
+});
diff --git a/packages/core/test/middleware/utils.spec.ts b/packages/core/test/middleware/utils.spec.ts
index 754878c22..a1c91d77b 100644
--- a/packages/core/test/middleware/utils.spec.ts
+++ b/packages/core/test/middleware/utils.spec.ts
@@ -1,4 +1,5 @@
 import { RequestMethod, Type } from '@nestjs/common';
+import { addLeadingSlash } from '@nestjs/common/utils/shared.utils';
 import { expect } from 'chai';
 import * as sinon from 'sinon';
 import {
@@ -10,6 +11,7 @@ import {
   mapToExcludeRoute,
 } from '../../middleware/utils';
 import { NoopHttpAdapter } from '../utils/noop-adapter.spec';
+import * as pathToRegexp from 'path-to-regexp';
 
 describe('middleware utils', () => {
   const noopAdapter = new NoopHttpAdapter({});
@@ -17,6 +19,27 @@ describe('middleware utils', () => {
   class Test {}
   function fnMiddleware(req, res, next) {}
 
+  describe('mapToExcludeRoute', () => {
+    it('should return exclude route metadata', () => {
+      const stringRoute = 'foo';
+      const routeInfo = {
+        path: 'bar',
+        method: RequestMethod.GET,
+      };
+      expect(mapToExcludeRoute([stringRoute, routeInfo])).to.eql([
+        {
+          path: stringRoute,
+          requestMethod: RequestMethod.ALL,
+          pathRegex: pathToRegexp(addLeadingSlash(stringRoute)),
+        },
+        {
+          path: routeInfo.path,
+          requestMethod: routeInfo.method,
+          pathRegex: pathToRegexp(addLeadingSlash(routeInfo.path)),
+        },
+      ]);
+    });
+  });
   describe('filterMiddleware', () => {
     let middleware: any[];
     beforeEach(() => {
diff --git a/packages/core/test/nest-application-context.spec.ts b/packages/core/test/nest-application-context.spec.ts
index 10f9659c8..db2a6ef28 100644
--- a/packages/core/test/nest-application-context.spec.ts
+++ b/packages/core/test/nest-application-context.spec.ts
@@ -1,9 +1,12 @@
+import { InjectionToken, Scope } from '@nestjs/common';
 import { expect } from 'chai';
-import { InjectionToken, Logger, Scope } from '@nestjs/common';
 import { ContextIdFactory } from '../helpers/context-id-factory';
-import { InstanceLoader } from '../injector/instance-loader';
 import { NestContainer } from '../injector/container';
+import { Injector } from '../injector/injector';
+import { InstanceLoader } from '../injector/instance-loader';
+import { GraphInspector } from '../inspector/graph-inspector';
 import { NestApplicationContext } from '../nest-application-context';
+import * as sinon from 'sinon';
 
 describe('NestApplicationContext', () => {
   class A {}
@@ -13,7 +16,12 @@ describe('NestApplicationContext', () => {
     scope: Scope,
   ): Promise<NestApplicationContext> {
     const nestContainer = new NestContainer();
-    const instanceLoader = new InstanceLoader(nestContainer);
+    const injector = new Injector();
+    const instanceLoader = new InstanceLoader(
+      nestContainer,
+      injector,
+      new GraphInspector(nestContainer),
+    );
     const module = await nestContainer.addModule(class T {}, []);
 
     nestContainer.addProvider(
@@ -32,15 +40,64 @@ describe('NestApplicationContext', () => {
         scope,
       },
       module.token,
+      'interceptor',
     );
 
     const modules = nestContainer.getModules();
     await instanceLoader.createInstancesOfDependencies(modules);
 
-    const applicationContext = new NestApplicationContext(nestContainer, []);
+    const applicationContext = new NestApplicationContext(nestContainer);
     return applicationContext;
   }
 
+  describe('listenToShutdownSignals', () => {
+    it('shutdown process should not be interrupted by another handler', async () => {
+      const signal = 'SIGTERM';
+      let processUp = true;
+      let promisesResolved = false;
+      const applicationContext = await testHelper(A, Scope.DEFAULT);
+      applicationContext.enableShutdownHooks([signal]);
+
+      const waitProcessDown = new Promise(resolve => {
+        const shutdownCleanupRef = applicationContext['shutdownCleanupRef'];
+        const handler = () => {
+          if (
+            !process
+              .listeners(signal)
+              .find(handler => handler == shutdownCleanupRef)
+          ) {
+            processUp = false;
+            process.removeListener(signal, handler);
+            resolve(undefined);
+          }
+          return undefined;
+        };
+        process.on(signal, handler);
+      });
+
+      // add some third party handler
+      process.on(signal, signal => {
+        // do some work
+        process.kill(process.pid, signal);
+      });
+
+      const hookStub = sinon
+        .stub(applicationContext as any, 'callShutdownHook')
+        .callsFake(async () => {
+          // run some async code
+          await new Promise(resolve => setImmediate(() => resolve(undefined)));
+          if (processUp) {
+            promisesResolved = true;
+          }
+        });
+      process.kill(process.pid, signal);
+      await waitProcessDown;
+      hookStub.restore();
+      expect(processUp).to.be.false;
+      expect(promisesResolved).to.be.true;
+    });
+  });
+
   describe('get', () => {
     describe('when scope = DEFAULT', () => {
       it('should get value with function injection key', async () => {
diff --git a/packages/core/test/nest-application.spec.ts b/packages/core/test/nest-application.spec.ts
index 19f9825b3..e9fb0ab66 100644
--- a/packages/core/test/nest-application.spec.ts
+++ b/packages/core/test/nest-application.spec.ts
@@ -1,8 +1,12 @@
+import { RequestMethod } from '@nestjs/common';
 import { expect } from 'chai';
 import { ApplicationConfig } from '../application-config';
 import { NestContainer } from '../injector/container';
+import { GraphInspector } from '../inspector/graph-inspector';
 import { NestApplication } from '../nest-application';
+import { mapToExcludeRoute } from './../middleware/utils';
 import { NoopHttpAdapter } from './utils/noop-adapter.spec';
+import { MicroserviceOptions } from '@nestjs/microservices';
 
 describe('NestApplication', () => {
   describe('Hybrid Application', () => {
@@ -18,10 +22,13 @@ describe('NestApplication', () => {
         container,
         new NoopHttpAdapter({}),
         applicationConfig,
+        new GraphInspector(container),
         {},
       );
       instance.useGlobalInterceptors(new Interceptor());
-      const microservice = instance.connectMicroservice({});
+      const microservice = instance.connectMicroservice<MicroserviceOptions>(
+        {},
+      );
       expect((instance as any).config.getGlobalInterceptors().length).to.equal(
         1,
       );
@@ -36,10 +43,11 @@ describe('NestApplication', () => {
         container,
         new NoopHttpAdapter({}),
         applicationConfig,
+        new GraphInspector(container),
         {},
       );
       instance.useGlobalInterceptors(new Interceptor());
-      const microservice = instance.connectMicroservice(
+      const microservice = instance.connectMicroservice<MicroserviceOptions>(
         {},
         { inheritAppConfig: true },
       );
@@ -51,4 +59,24 @@ describe('NestApplication', () => {
       ).to.equal(1);
     });
   });
+  describe('Global Prefix', () => {
+    it('should get correct global prefix options', () => {
+      const applicationConfig = new ApplicationConfig();
+      const container = new NestContainer(applicationConfig);
+      const instance = new NestApplication(
+        container,
+        new NoopHttpAdapter({}),
+        applicationConfig,
+        new GraphInspector(container),
+        {},
+      );
+      const excludeRoute = ['foo', { path: 'bar', method: RequestMethod.GET }];
+      instance.setGlobalPrefix('api', {
+        exclude: excludeRoute,
+      });
+      expect(applicationConfig.getGlobalPrefixOptions()).to.eql({
+        exclude: mapToExcludeRoute(excludeRoute),
+      });
+    });
+  });
 });
diff --git a/packages/core/test/pipes/params-token-factory.spec.ts b/packages/core/test/pipes/params-token-factory.spec.ts
index 752f118de..6bc83aadd 100644
--- a/packages/core/test/pipes/params-token-factory.spec.ts
+++ b/packages/core/test/pipes/params-token-factory.spec.ts
@@ -32,7 +32,7 @@ describe('ParamsTokenFactory', () => {
       });
       describe('not available', () => {
         it('should return "custom"', () => {
-          expect(factory.exchangeEnumForString(-1)).to.be.eql('custom');
+          expect(factory.exchangeEnumForString(-1 as any)).to.be.eql('custom');
         });
       });
     });
diff --git a/packages/core/test/repl/native-functions/help-repl-fn.spec.ts b/packages/core/test/repl/native-functions/help-repl-fn.spec.ts
index 441d14c43..09f041153 100644
--- a/packages/core/test/repl/native-functions/help-repl-fn.spec.ts
+++ b/packages/core/test/repl/native-functions/help-repl-fn.spec.ts
@@ -55,7 +55,8 @@ describe('HelpReplFn', () => {
         .equal(`You can call .help on any function listed below (e.g.: help.help):
 
 $ - Retrieves an instance of either injectable or controller, otherwise, throws exception.
-debug - Print all registered modules as a list together with their controllers and providers. If the argument is passed in, for example, "debug(MyModule)" then it will only print components of this specific module.
+debug - Print all registered modules as a list together with their controllers and providers.
+If the argument is passed in, for example, "debug(MyModule)" then it will only print components of this specific module.
 get - Retrieves an instance of either injectable or controller, otherwise, throws exception.
 help - Display all available REPL native functions.
 methods - Display all public methods available on a given provider or controller.
diff --git a/packages/core/test/router/paths-explorer.spec.ts b/packages/core/test/router/paths-explorer.spec.ts
new file mode 100644
index 000000000..6607cd814
--- /dev/null
+++ b/packages/core/test/router/paths-explorer.spec.ts
@@ -0,0 +1,218 @@
+import { expect } from 'chai';
+import { Controller } from '../../../common/decorators/core/controller.decorator';
+import {
+  All,
+  Get,
+  Post,
+} from '../../../common/decorators/http/request-mapping.decorator';
+import { RequestMethod } from '../../../common/enums/request-method.enum';
+import { MetadataScanner } from '../../metadata-scanner';
+import { PathsExplorer } from '../../router/paths-explorer';
+
+describe('PathsExplorer', () => {
+  @Controller('global')
+  class TestRoute {
+    @Get('test')
+    public getTest() {}
+
+    @Post('test')
+    public postTest() {}
+
+    @All('another-test')
+    public anotherTest() {}
+
+    @Get(['foo', 'bar'])
+    public getTestUsingArray() {}
+  }
+
+  @Controller(['global', 'global-alias'])
+  class TestRouteAlias {
+    @Get('test')
+    public getTest() {}
+
+    @Post('test')
+    public postTest() {}
+
+    @All('another-test')
+    public anotherTest() {}
+
+    @Get(['foo', 'bar'])
+    public getTestUsingArray() {}
+  }
+
+  let pathsExplorer: PathsExplorer;
+
+  beforeEach(() => {
+    pathsExplorer = new PathsExplorer(new MetadataScanner());
+  });
+
+  describe('scanForPaths', () => {
+    it('should method return expected list of route paths', () => {
+      const paths = pathsExplorer.scanForPaths(new TestRoute());
+
+      expect(paths).to.have.length(4);
+
+      expect(paths[0].path).to.eql(['/test']);
+      expect(paths[1].path).to.eql(['/test']);
+      expect(paths[2].path).to.eql(['/another-test']);
+      expect(paths[3].path).to.eql(['/foo', '/bar']);
+
+      expect(paths[0].requestMethod).to.eql(RequestMethod.GET);
+      expect(paths[1].requestMethod).to.eql(RequestMethod.POST);
+      expect(paths[2].requestMethod).to.eql(RequestMethod.ALL);
+      expect(paths[3].requestMethod).to.eql(RequestMethod.GET);
+    });
+
+    it('should method return expected list of route paths alias', () => {
+      const paths = pathsExplorer.scanForPaths(new TestRouteAlias());
+
+      expect(paths).to.have.length(4);
+
+      expect(paths[0].path).to.eql(['/test']);
+      expect(paths[1].path).to.eql(['/test']);
+      expect(paths[2].path).to.eql(['/another-test']);
+      expect(paths[3].path).to.eql(['/foo', '/bar']);
+
+      expect(paths[0].requestMethod).to.eql(RequestMethod.GET);
+      expect(paths[1].requestMethod).to.eql(RequestMethod.POST);
+      expect(paths[2].requestMethod).to.eql(RequestMethod.ALL);
+      expect(paths[3].requestMethod).to.eql(RequestMethod.GET);
+    });
+  });
+
+  describe('exploreMethodMetadata', () => {
+    it('should method return expected object which represent single route', () => {
+      const instance = new TestRoute();
+      const instanceProto = Object.getPrototypeOf(instance);
+
+      const route = pathsExplorer.exploreMethodMetadata(
+        instance,
+        instanceProto,
+        'getTest',
+      );
+
+      expect(route.path).to.eql(['/test']);
+      expect(route.requestMethod).to.eql(RequestMethod.GET);
+      expect(route.targetCallback).to.eq(instance.getTest);
+    });
+
+    it('should method return expected object which represent single route with alias', () => {
+      const instance = new TestRouteAlias();
+      const instanceProto = Object.getPrototypeOf(instance);
+
+      const route = pathsExplorer.exploreMethodMetadata(
+        instance,
+        instanceProto,
+        'getTest',
+      );
+
+      expect(route.path).to.eql(['/test']);
+      expect(route.requestMethod).to.eql(RequestMethod.GET);
+      expect(route.targetCallback).to.eq(instance.getTest);
+    });
+
+    it('should method return expected object which represent multiple routes', () => {
+      const instance = new TestRoute();
+      const instanceProto = Object.getPrototypeOf(instance);
+
+      const route = pathsExplorer.exploreMethodMetadata(
+        instance,
+        instanceProto,
+        'getTestUsingArray',
+      );
+
+      expect(route.path).to.eql(['/foo', '/bar']);
+      expect(route.requestMethod).to.eql(RequestMethod.GET);
+      expect(route.targetCallback).to.eq(instance.getTestUsingArray);
+    });
+
+    it('should method return expected object which represent multiple routes with alias', () => {
+      const instance = new TestRouteAlias();
+      const instanceProto = Object.getPrototypeOf(instance);
+
+      const route = pathsExplorer.exploreMethodMetadata(
+        instance,
+        instanceProto,
+        'getTestUsingArray',
+      );
+
+      expect(route.path).to.eql(['/foo', '/bar']);
+      expect(route.requestMethod).to.eql(RequestMethod.GET);
+      expect(route.targetCallback).to.eq(instance.getTestUsingArray);
+    });
+
+    describe('when new implementation is injected into router', () => {
+      it('should method return changed impl of single route', () => {
+        const instance = new TestRoute();
+        const instanceProto = Object.getPrototypeOf(instance);
+
+        const newImpl = function () {};
+        instance.getTest = newImpl;
+
+        const route = pathsExplorer.exploreMethodMetadata(
+          instance,
+          instanceProto,
+          'getTest',
+        );
+
+        expect(route.targetCallback).to.eq(newImpl);
+        expect(route.path).to.eql(['/test']);
+        expect(route.requestMethod).to.eql(RequestMethod.GET);
+      });
+
+      it('should method return changed impl of single route which alias applied', () => {
+        const instance = new TestRouteAlias();
+        const instanceProto = Object.getPrototypeOf(instance);
+
+        const newImpl = function () {};
+        instance.getTest = newImpl;
+
+        const route = pathsExplorer.exploreMethodMetadata(
+          instance,
+          instanceProto,
+          'getTest',
+        );
+
+        expect(route.targetCallback).to.eq(newImpl);
+        expect(route.path).to.eql(['/test']);
+        expect(route.requestMethod).to.eql(RequestMethod.GET);
+      });
+
+      it('should method return changed impl of multiple routes', () => {
+        const instance = new TestRoute();
+        const instanceProto = Object.getPrototypeOf(instance);
+
+        const newImpl = function () {};
+        instance.getTestUsingArray = newImpl;
+
+        const route = pathsExplorer.exploreMethodMetadata(
+          instance,
+          instanceProto,
+          'getTestUsingArray',
+        );
+
+        expect(route.targetCallback).to.eq(newImpl);
+        expect(route.path).to.eql(['/foo', '/bar']);
+        expect(route.requestMethod).to.eql(RequestMethod.GET);
+      });
+
+      it('should method return changed impl of multiple routes which alias applied', () => {
+        const instance = new TestRouteAlias();
+        const instanceProto = Object.getPrototypeOf(instance);
+
+        const newImpl = function () {};
+        instance.getTestUsingArray = newImpl;
+
+        const route = pathsExplorer.exploreMethodMetadata(
+          instance,
+          instanceProto,
+          'getTestUsingArray',
+        );
+
+        expect(route.targetCallback).to.eq(newImpl);
+        expect(route.path).to.eql(['/foo', '/bar']);
+        expect(route.requestMethod).to.eql(RequestMethod.GET);
+      });
+    });
+  });
+});
diff --git a/packages/core/test/router/route-path-factory.spec.ts b/packages/core/test/router/route-path-factory.spec.ts
index 84b9275a7..4c110651d 100644
--- a/packages/core/test/router/route-path-factory.spec.ts
+++ b/packages/core/test/router/route-path-factory.spec.ts
@@ -247,6 +247,7 @@ describe('RoutePathFactory', () => {
           sinon.stub(applicationConfig, 'getGlobalPrefixOptions').returns({
             exclude: [
               {
+                path: '/random',
                 pathRegex: pathToRegexp('/random'),
                 requestMethod: RequestMethod.ALL,
               },
@@ -265,6 +266,7 @@ describe('RoutePathFactory', () => {
           sinon.stub(applicationConfig, 'getGlobalPrefixOptions').returns({
             exclude: [
               {
+                path: '/cats',
                 pathRegex: pathToRegexp('/cats'),
                 requestMethod: RequestMethod.ALL,
               },
@@ -283,6 +285,7 @@ describe('RoutePathFactory', () => {
             sinon.stub(applicationConfig, 'getGlobalPrefixOptions').returns({
               exclude: [
                 {
+                  path: '/cats',
                   pathRegex: pathToRegexp('/cats'),
                   requestMethod: RequestMethod.GET,
                 },
diff --git a/packages/core/test/router/router-explorer.spec.ts b/packages/core/test/router/router-explorer.spec.ts
index cf0d49cb9..82ec5f51f 100644
--- a/packages/core/test/router/router-explorer.spec.ts
+++ b/packages/core/test/router/router-explorer.spec.ts
@@ -10,16 +10,17 @@ import { RequestMethod } from '../../../common/enums/request-method.enum';
 import { VersioningType } from '../../../common/enums/version-type.enum';
 import { Injector } from '../../../core/injector/injector';
 import { ApplicationConfig } from '../../application-config';
+import { UnknownRequestMappingException } from '../../errors/exceptions/unknown-request-mapping.exception';
 import { ExecutionContextHost } from '../../helpers/execution-context-host';
 import { NestContainer } from '../../injector/container';
 import { InstanceWrapper } from '../../injector/instance-wrapper';
+import { GraphInspector } from '../../inspector/graph-inspector';
 import { MetadataScanner } from '../../metadata-scanner';
 import { RoutePathMetadata } from '../../router/interfaces/route-path-metadata.interface';
 import { RoutePathFactory } from '../../router/route-path-factory';
 import { RouterExceptionFilters } from '../../router/router-exception-filters';
 import { RouterExplorer } from '../../router/router-explorer';
 import { NoopHttpAdapter } from '../utils/noop-adapter.spec';
-import { UnknownRequestMappingException } from '../../errors/exceptions/unknown-request-mapping.exception';
 
 describe('RouterExplorer', () => {
   @Controller('global')
@@ -59,6 +60,7 @@ describe('RouterExplorer', () => {
   let exceptionsFilter: RouterExceptionFilters;
   let applicationConfig: ApplicationConfig;
   let routePathFactory: RoutePathFactory;
+  let graphInspector: GraphInspector;
 
   beforeEach(() => {
     const container = new NestContainer();
@@ -66,6 +68,7 @@ describe('RouterExplorer', () => {
     applicationConfig = new ApplicationConfig();
     injector = new Injector();
     routePathFactory = new RoutePathFactory(applicationConfig);
+    graphInspector = new GraphInspector(container);
     exceptionsFilter = new RouterExceptionFilters(
       container,
       applicationConfig,
@@ -79,179 +82,10 @@ describe('RouterExplorer', () => {
       exceptionsFilter,
       applicationConfig,
       routePathFactory,
+      graphInspector,
     );
   });
 
-  describe('scanForPaths', () => {
-    it('should method return expected list of route paths', () => {
-      const paths = routerBuilder.scanForPaths(new TestRoute());
-
-      expect(paths).to.have.length(4);
-
-      expect(paths[0].path).to.eql(['/test']);
-      expect(paths[1].path).to.eql(['/test']);
-      expect(paths[2].path).to.eql(['/another-test']);
-      expect(paths[3].path).to.eql(['/foo', '/bar']);
-
-      expect(paths[0].requestMethod).to.eql(RequestMethod.GET);
-      expect(paths[1].requestMethod).to.eql(RequestMethod.POST);
-      expect(paths[2].requestMethod).to.eql(RequestMethod.ALL);
-      expect(paths[3].requestMethod).to.eql(RequestMethod.GET);
-    });
-
-    it('should method return expected list of route paths alias', () => {
-      const paths = routerBuilder.scanForPaths(new TestRouteAlias());
-
-      expect(paths).to.have.length(4);
-
-      expect(paths[0].path).to.eql(['/test']);
-      expect(paths[1].path).to.eql(['/test']);
-      expect(paths[2].path).to.eql(['/another-test']);
-      expect(paths[3].path).to.eql(['/foo', '/bar']);
-
-      expect(paths[0].requestMethod).to.eql(RequestMethod.GET);
-      expect(paths[1].requestMethod).to.eql(RequestMethod.POST);
-      expect(paths[2].requestMethod).to.eql(RequestMethod.ALL);
-      expect(paths[3].requestMethod).to.eql(RequestMethod.GET);
-    });
-  });
-
-  describe('exploreMethodMetadata', () => {
-    it('should method return expected object which represent single route', () => {
-      const instance = new TestRoute();
-      const instanceProto = Object.getPrototypeOf(instance);
-
-      const route = routerBuilder.exploreMethodMetadata(
-        instance,
-        instanceProto,
-        'getTest',
-      );
-
-      expect(route.path).to.eql(['/test']);
-      expect(route.requestMethod).to.eql(RequestMethod.GET);
-      expect(route.targetCallback).to.eq(instance.getTest);
-    });
-
-    it('should method return expected object which represent single route with alias', () => {
-      const instance = new TestRouteAlias();
-      const instanceProto = Object.getPrototypeOf(instance);
-
-      const route = routerBuilder.exploreMethodMetadata(
-        instance,
-        instanceProto,
-        'getTest',
-      );
-
-      expect(route.path).to.eql(['/test']);
-      expect(route.requestMethod).to.eql(RequestMethod.GET);
-      expect(route.targetCallback).to.eq(instance.getTest);
-    });
-
-    it('should method return expected object which represent multiple routes', () => {
-      const instance = new TestRoute();
-      const instanceProto = Object.getPrototypeOf(instance);
-
-      const route = routerBuilder.exploreMethodMetadata(
-        instance,
-        instanceProto,
-        'getTestUsingArray',
-      );
-
-      expect(route.path).to.eql(['/foo', '/bar']);
-      expect(route.requestMethod).to.eql(RequestMethod.GET);
-      expect(route.targetCallback).to.eq(instance.getTestUsingArray);
-    });
-
-    it('should method return expected object which represent multiple routes with alias', () => {
-      const instance = new TestRouteAlias();
-      const instanceProto = Object.getPrototypeOf(instance);
-
-      const route = routerBuilder.exploreMethodMetadata(
-        instance,
-        instanceProto,
-        'getTestUsingArray',
-      );
-
-      expect(route.path).to.eql(['/foo', '/bar']);
-      expect(route.requestMethod).to.eql(RequestMethod.GET);
-      expect(route.targetCallback).to.eq(instance.getTestUsingArray);
-    });
-
-    describe('when new implementation is injected into router', () => {
-      it('should method return changed impl of single route', () => {
-        const instance = new TestRoute();
-        const instanceProto = Object.getPrototypeOf(instance);
-
-        const newImpl = function () {};
-        instance.getTest = newImpl;
-
-        const route = routerBuilder.exploreMethodMetadata(
-          instance,
-          instanceProto,
-          'getTest',
-        );
-
-        expect(route.targetCallback).to.eq(newImpl);
-        expect(route.path).to.eql(['/test']);
-        expect(route.requestMethod).to.eql(RequestMethod.GET);
-      });
-
-      it('should method return changed impl of single route which alias applied', () => {
-        const instance = new TestRouteAlias();
-        const instanceProto = Object.getPrototypeOf(instance);
-
-        const newImpl = function () {};
-        instance.getTest = newImpl;
-
-        const route = routerBuilder.exploreMethodMetadata(
-          instance,
-          instanceProto,
-          'getTest',
-        );
-
-        expect(route.targetCallback).to.eq(newImpl);
-        expect(route.path).to.eql(['/test']);
-        expect(route.requestMethod).to.eql(RequestMethod.GET);
-      });
-
-      it('should method return changed impl of multiple routes', () => {
-        const instance = new TestRoute();
-        const instanceProto = Object.getPrototypeOf(instance);
-
-        const newImpl = function () {};
-        instance.getTestUsingArray = newImpl;
-
-        const route = routerBuilder.exploreMethodMetadata(
-          instance,
-          instanceProto,
-          'getTestUsingArray',
-        );
-
-        expect(route.targetCallback).to.eq(newImpl);
-        expect(route.path).to.eql(['/foo', '/bar']);
-        expect(route.requestMethod).to.eql(RequestMethod.GET);
-      });
-
-      it('should method return changed impl of multiple routes which alias applied', () => {
-        const instance = new TestRouteAlias();
-        const instanceProto = Object.getPrototypeOf(instance);
-
-        const newImpl = function () {};
-        instance.getTestUsingArray = newImpl;
-
-        const route = routerBuilder.exploreMethodMetadata(
-          instance,
-          instanceProto,
-          'getTestUsingArray',
-        );
-
-        expect(route.targetCallback).to.eq(newImpl);
-        expect(route.path).to.eql(['/foo', '/bar']);
-        expect(route.requestMethod).to.eql(RequestMethod.GET);
-      });
-    });
-  });
-
   describe('applyPathsToRouterProxy', () => {
     it('should method return expected object which represent single route', () => {
       const bindStub = sinon.stub(
@@ -355,7 +189,7 @@ describe('RouterExplorer', () => {
         instance: { [methodKey]: {} },
       });
 
-      it('should delegete error to exception filters', async () => {
+      it('should delegate error to exception filters', async () => {
         const handler = routerBuilder.createRequestScopedHandler(
           wrapper,
           RequestMethod.ALL,
diff --git a/packages/core/test/router/routes-resolver.spec.ts b/packages/core/test/router/routes-resolver.spec.ts
index 36b67f1c6..9819f4aae 100644
--- a/packages/core/test/router/routes-resolver.spec.ts
+++ b/packages/core/test/router/routes-resolver.spec.ts
@@ -13,6 +13,8 @@ import { ApplicationConfig } from '../../application-config';
 import { NestContainer } from '../../injector';
 import { Injector } from '../../injector/injector';
 import { InstanceWrapper } from '../../injector/instance-wrapper';
+import { GraphInspector } from '../../inspector/graph-inspector';
+import { SerializedGraph } from '../../inspector/serialized-graph';
 import { RoutesResolver } from '../../router/routes-resolver';
 import { NoopHttpAdapter } from '../utils/noop-adapter.spec';
 
@@ -65,6 +67,7 @@ describe('RoutesResolver', () => {
       getModules: () => modules,
       getModuleByKey: (key: string) => modules.get(key),
       getHttpAdapterRef: () => applicationRef,
+      serializedGraph: new SerializedGraph(),
     } as any;
     router = {
       get() {},
@@ -77,6 +80,7 @@ describe('RoutesResolver', () => {
       container,
       new ApplicationConfig(),
       new Injector(),
+      new GraphInspector(container),
     );
   });
 
@@ -175,6 +179,7 @@ describe('RoutesResolver', () => {
         container,
         applicationConfig,
         new Injector(),
+        new GraphInspector(container),
       );
 
       const routes = new Map();
diff --git a/packages/core/test/scanner.spec.ts b/packages/core/test/scanner.spec.ts
index f2ef6b2ac..e7b5b2b52 100644
--- a/packages/core/test/scanner.spec.ts
+++ b/packages/core/test/scanner.spec.ts
@@ -1,4 +1,4 @@
-import { Catch, Injectable, Logger } from '@nestjs/common';
+import { Catch, Injectable } from '@nestjs/common';
 import { expect } from 'chai';
 import * as sinon from 'sinon';
 import { GUARDS_METADATA } from '../../common/constants';
@@ -8,13 +8,15 @@ import { Module } from '../../common/decorators/modules/module.decorator';
 import { Scope } from '../../common/interfaces';
 import { ApplicationConfig } from '../application-config';
 import { APP_FILTER, APP_GUARD, APP_INTERCEPTOR, APP_PIPE } from '../constants';
-import { InvalidModuleException } from '../errors/exceptions/invalid-module.exception';
 import { InvalidClassModuleException } from '../errors/exceptions/invalid-class-module.exception';
+import { InvalidModuleException } from '../errors/exceptions/invalid-module.exception';
 import { UndefinedModuleException } from '../errors/exceptions/undefined-module.exception';
 import { NestContainer } from '../injector/container';
 import { InstanceWrapper } from '../injector/instance-wrapper';
+import { GraphInspector } from '../inspector/graph-inspector';
 import { MetadataScanner } from '../metadata-scanner';
 import { DependenciesScanner } from '../scanner';
+import Sinon = require('sinon');
 
 describe('DependenciesScanner', () => {
   class Guard {}
@@ -55,14 +57,17 @@ describe('DependenciesScanner', () => {
   let scanner: DependenciesScanner;
   let mockContainer: sinon.SinonMock;
   let container: NestContainer;
+  let graphInspector: GraphInspector;
 
   beforeEach(() => {
     container = new NestContainer();
     mockContainer = sinon.mock(container);
+    graphInspector = new GraphInspector(container);
 
     scanner = new DependenciesScanner(
       container,
       new MetadataScanner(),
+      graphInspector,
       new ApplicationConfig(),
     );
     sinon.stub(scanner, 'registerCoreModule').callsFake(async () => {});
@@ -75,7 +80,7 @@ describe('DependenciesScanner', () => {
   it('should "insertModule" call twice (2 modules) container method "addModule"', async () => {
     const expectation = mockContainer.expects('addModule').twice();
 
-    await scanner.scan(TestModule as any);
+    await scanner.scan(TestModule);
     expectation.verify();
   });
 
@@ -134,34 +139,115 @@ describe('DependenciesScanner', () => {
   });
 
   describe('insertInjectable', () => {
-    it('should call "addInjectable"', () => {
-      const addInjectable = sinon
+    class InjectableCls {}
+    class HostCls {}
+
+    const instanceWrapper = { id: 'random_id' };
+    const token = 'token';
+    const methodKey = 'methodKey';
+
+    let addInjectableStub: Sinon.SinonStub;
+    let insertEnhancerMetadataCacheStub: Sinon.SinonStub;
+
+    beforeEach(() => {
+      addInjectableStub = sinon
         .stub((scanner as any).container, 'addInjectable')
+        .callsFake(() => instanceWrapper);
+      insertEnhancerMetadataCacheStub = sinon
+        .stub(graphInspector, 'insertEnhancerMetadataCache')
         .callsFake(() => undefined);
-      const comp = {};
-      const token = 'token';
+    });
+
+    describe('when injectable is of type function', () => {
+      const subtype = 'filter';
+      beforeEach(() => {
+        scanner.insertInjectable(
+          InjectableCls,
+          token,
+          HostCls,
+          subtype,
+          methodKey,
+        );
+      });
 
-      scanner.insertInjectable(comp as any, token, null);
-      expect(addInjectable.calledWith(comp, token)).to.be.true;
+      it('should call "addInjectable"', () => {
+        expect(addInjectableStub.calledWith(InjectableCls, token)).to.be.true;
+      });
+
+      it('should call "insertEnhancerMetadataCache"', () => {
+        expect(
+          insertEnhancerMetadataCacheStub.calledWith({
+            moduleToken: token,
+            classRef: HostCls,
+            enhancerInstanceWrapper: instanceWrapper,
+            targetNodeId: instanceWrapper.id,
+            methodKey,
+            subtype,
+          }),
+        ).to.be.true;
+      });
+    });
+    describe('when injectable is not of type function', () => {
+      const injectableRef = new InjectableCls();
+      const subtype = 'interceptor';
+
+      beforeEach(() => {
+        scanner.insertInjectable(
+          injectableRef,
+          token,
+          HostCls,
+          subtype,
+          methodKey,
+        );
+      });
+
+      it('should not call "addInjectable"', () => {
+        expect(addInjectableStub.notCalled).to.be.true;
+      });
+
+      it('should call "insertEnhancerMetadataCache"', () => {
+        expect(
+          insertEnhancerMetadataCacheStub.calledWith({
+            moduleToken: token,
+            classRef: HostCls,
+            enhancerRef: injectableRef,
+            methodKey,
+            subtype,
+          }),
+        ).to.be.true;
+      });
     });
   });
 
   class CompMethod {
     @UseGuards(Guard)
     public method() {}
+
+    @UseGuards(Guard, Guard)
+    public method2() {}
   }
   describe('reflectKeyMetadata', () => {
     it('should return undefined', () => {
       const result = scanner.reflectKeyMetadata(TestComponent, 'key', 'method');
       expect(result).to.be.undefined;
     });
-    it('should return array', () => {
+    it('should return an array that consists of 1 element', () => {
+      const methodKey = 'method';
+      const result = scanner.reflectKeyMetadata(
+        CompMethod,
+        GUARDS_METADATA,
+        methodKey,
+      );
+      expect(result).to.be.deep.equal({ methodKey, metadata: [Guard] });
+    });
+    it('should return an array that consists of 2 elements', () => {
+      const methodKey = 'method2';
       const result = scanner.reflectKeyMetadata(
         CompMethod,
         GUARDS_METADATA,
-        'method',
+        methodKey,
       );
-      expect(result).to.be.eql([Guard]);
+      expect(result).to.be.deep.equal({ methodKey, metadata: [Guard, Guard] });
     });
   });
 
@@ -174,21 +260,21 @@ describe('DependenciesScanner', () => {
 
       expect(module.forwardRef.called).to.be.true;
     });
-    it('should throw "InvalidClassModuleException" exception when suppling a class annotated with `@Injectable()` decorator', () => {
+    it('should throw "InvalidClassModuleException" exception when supplying a class annotated with `@Injectable()` decorator', () => {
       sinon.stub(container, 'addModule').returns({} as any);
 
       expect(scanner.insertModule(TestComponent, [])).to.be.rejectedWith(
         InvalidClassModuleException,
       );
     });
-    it('should throw "InvalidClassModuleException" exception when suppling a class annotated with `@Controller()` decorator', () => {
+    it('should throw "InvalidClassModuleException" exception when supplying a class annotated with `@Controller()` decorator', () => {
       sinon.stub(container, 'addModule').returns({} as any);
 
       expect(scanner.insertModule(TestController, [])).to.be.rejectedWith(
         InvalidClassModuleException,
       );
     });
-    it('should throw "InvalidClassModuleException" exception when suppling a class annotated with (only) `@Catch()` decorator', () => {
+    it('should throw "InvalidClassModuleException" exception when supplying a class annotated with (only) `@Catch()` decorator', () => {
       sinon.stub(container, 'addModule').returns({} as any);
 
       expect(
@@ -312,18 +398,30 @@ describe('DependenciesScanner', () => {
       (scanner as any).applicationProvidersApplyMap = [provider];
 
       const expectedInstance = {};
+      const instanceWrapper = {
+        instance: expectedInstance,
+      } as unknown as InstanceWrapper;
       mockContainer.expects('getModules').callsFake(() => ({
         get: () => ({
-          providers: { get: () => ({ instance: expectedInstance }) },
+          providers: { get: () => instanceWrapper },
         }),
       }));
+
       const applySpy = sinon.spy();
       sinon.stub(scanner, 'getApplyProvidersMap').callsFake(() => ({
         [provider.type]: applySpy,
       }));
+
+      const insertAttachedEnhancerStub = sinon.stub(
+        graphInspector,
+        'insertAttachedEnhancer',
+      );
+
       scanner.applyApplicationProviders();
+
       expect(applySpy.called).to.be.true;
       expect(applySpy.calledWith(expectedInstance)).to.be.true;
+      expect(insertAttachedEnhancerStub.calledWith(instanceWrapper)).to.be.true;
     });
     it('should apply each globally scoped provider', () => {
       const provider = {
@@ -340,13 +438,23 @@ describe('DependenciesScanner', () => {
           injectables: { get: () => expectedInstanceWrapper },
         }),
       }));
+
       const applySpy = sinon.spy();
       sinon.stub(scanner, 'getApplyRequestProvidersMap').callsFake(() => ({
         [provider.type]: applySpy,
       }));
+
+      const insertAttachedEnhancerStub = sinon.stub(
+        graphInspector,
+        'insertAttachedEnhancer',
+      );
+
       scanner.applyApplicationProviders();
+
       expect(applySpy.called).to.be.true;
       expect(applySpy.calledWith(expectedInstanceWrapper)).to.be.true;
+      expect(insertAttachedEnhancerStub.calledWith(expectedInstanceWrapper)).to
+        .be.true;
     });
   });
 
@@ -358,31 +466,45 @@ describe('DependenciesScanner', () => {
       scope: Scope.REQUEST,
     };
 
-    it('should add enhancers metadata to every controller', () => {
+    it('should add enhancers metadata to every controller and every entry provider', () => {
       (scanner as any).applicationProvidersApplyMap = [provider];
 
       const instance = new InstanceWrapper({ name: 'test' });
       const controllers = new Map();
-      const mockController = new InstanceWrapper();
+      const providers = new Map();
+
+      const fakeController = new InstanceWrapper();
+      const fakeProvider = new InstanceWrapper();
+
+      const providerToken = 'entryProvider';
+      controllers.set('test', fakeController);
+      providers.set(providerToken, fakeProvider);
 
-      controllers.set('test', mockController);
       mockContainer.expects('getModules').callsFake(() => ({
         get: () => ({
           injectables: { get: () => instance },
           controllers,
+          entryProviders: Array.from(providers.values()),
         }),
         values() {
           return [this.get()];
         },
       }));
-      const addEnhancerMetadataSpy = sinon.spy(
-        mockController,
+
+      const addEnhancerMetadataControllerSpy = sinon.spy(
+        fakeController,
+        'addEnhancerMetadata',
+      );
+      const addEnhancerMetadataProviderSpy = sinon.spy(
+        fakeProvider,
         'addEnhancerMetadata',
       );
       scanner.addScopedEnhancersMetadata();
 
-      expect(addEnhancerMetadataSpy.called).to.be.true;
-      expect(addEnhancerMetadataSpy.calledWith(instance)).to.be.true;
+      expect(addEnhancerMetadataControllerSpy.called).to.be.true;
+      expect(addEnhancerMetadataControllerSpy.calledWith(instance)).to.be.true;
+      expect(addEnhancerMetadataProviderSpy.called).to.be.true;
+      expect(addEnhancerMetadataProviderSpy.calledWith(instance)).to.be.true;
     });
   });
 
diff --git a/packages/core/tsconfig.build.json b/packages/core/tsconfig.build.json
new file mode 100644
index 000000000..99c13372d
--- /dev/null
+++ b/packages/core/tsconfig.build.json
@@ -0,0 +1,21 @@
+{
+  "extends": "../tsconfig.build.json",
+  "compilerOptions": {
+    "outDir": ".",
+    "rootDir": ".",
+    "paths": {
+      "@nestjs/common": ["../common"],
+      "@nestjs/common/*": ["../common/*"],
+      "@nestjs/microservices": ["../microservices"],
+      "@nestjs/microservices/*": ["../microservices/*"],
+      "@nestjs/websockets": ["../websockets"],
+      "@nestjs/websockets/*": ["../websockets/*"]
+    }
+  },
+  "exclude": ["node_modules", "dist", "test/**/*", "*.spec.ts"],
+  "references": [
+    {
+      "path": "../common/tsconfig.build.json"
+    }
+  ]
+}
diff --git a/packages/core/tsconfig.json b/packages/core/tsconfig.json
index b238080a4..2ae9e3c90 100644
--- a/packages/core/tsconfig.json
+++ b/packages/core/tsconfig.json
@@ -1,7 +1,13 @@
 {
-  "extends": "./../tsconfig.base.json",
+  "extends": "../tsconfig.build.json",
   "compilerOptions": {
-    "baseUrl": "./"
+    "types": ["node"]
   },
-  "include": ["*.ts", "**/*.ts"]
+  "files": [],
+  "include": [],
+  "references": [
+    {
+      "path": "./tsconfig.build.json"
+    }
+  ]
 }
diff --git a/packages/microservices/Readme.md b/packages/microservices/Readme.md
index 5203ac4c2..16f48336d 100644
--- a/packages/microservices/Readme.md
+++ b/packages/microservices/Readme.md
@@ -11,7 +11,6 @@
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
 <a href="https://circleci.com/gh/nestjs/nest" target="_blank"><img src="https://img.shields.io/circleci/build/github/nestjs/nest/master" alt="CircleCI" /></a>
-<a href="https://coveralls.io/github/nestjs/nest?branch=master" target="_blank"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#9" alt="Coverage" /></a>
 <a href="https://discord.gg/G7Qnnhy" target="_blank"><img src="https://img.shields.io/badge/discord-online-brightgreen.svg" alt="Discord"/></a>
 <a href="https://opencollective.com/nest#backer" target="_blank"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
 <a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
@@ -78,7 +77,10 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
  <td>
 <a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
 <a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td><td>
-<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
+<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td>
+<td>
+<a href="https://ridicorp.com/career/" target="_blank"><img src="https://nestjs.com/img/ridi-logo.svg" width="105" valign="middle" /></a></td><td>
+<a href="https://www.movavi.com/imovie-for-windows.html" target="_blank"><img src="https://nestjs.com/img/movavi-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
@@ -91,7 +93,8 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td>
 <td><a href="https://n.inc" target="_blank"><img src="https://nestjs.com/img/n-inc-logo.svg" width="120" valign="middle" /></td></tr><tr>
 <td><a href="https://bilberrry.com/" target="_blank"><img src="https://nestjs.com/img/bilberrry-logo.svg" width="180" valign="middle" /></td>
-<td><a href="https://ipinfo.ai/" target="_blank"><img src="https://nestjs.com/img/ipinfo-logo.png" width="130" valign="middle" /></td></tr>
+<td><a href="https://ipinfo.ai/" target="_blank"><img src="https://nestjs.com/img/ipinfo-logo.png" width="130" valign="middle" /></td>
+<td><a href="https://chax.at" target="_blank"><img src="https://nestjs.com/img/chaxat-logo.png" width="100" valign="middle" /></td></tr>
 </table>
 
 #### Sponsors
@@ -132,7 +135,8 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
    <td align="center" valign="middle"><a href="https://mobilereality.pl/" target="_blank"><img src="https://nestjs.com/img/mobile-reality-logo.png" width="45" valign="middle" /></a></td>
      <td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/boringowl-logo.svg" width="120" valign="middle" /></a></td>
  <td align="center" valign="middle"><a href="https://www.mobilefactory.jp/" target="_blank"><img src="https://nestjs.com/img/mobilefactory-logo.png" width="100" valign="middle" /></a></td>
- <td align="center" valign="middle"><a href="https://db.nordbot.app/" target="_blank"><img src="https://nestjs.com/img/nord-logo.png" width="50" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://nordbot.app/" target="_blank"><img src="https://nestjs.com/img/nordbot-logo.png" width="120" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://doppio.sh/" target="_blank"><img src="https://nestjs.com/img/dopiosh-logo.png" width="50" valign="middle" /></a></td>
   </tr></table>
 
 ## Backers
diff --git a/packages/microservices/client/client-grpc.ts b/packages/microservices/client/client-grpc.ts
index 3110ca0d4..a03c1e78d 100644
--- a/packages/microservices/client/client-grpc.ts
+++ b/packages/microservices/client/client-grpc.ts
@@ -14,6 +14,9 @@ import { ChannelOptions } from '../external/grpc-options.interface';
 let grpcPackage: any = {};
 let grpcProtoLoaderPackage: any = {};
 
+/**
+ * @publicApi
+ */
 export class ClientGrpcProxy extends ClientProxy implements ClientGrpc {
   protected readonly logger = new Logger(ClientProxy.name);
   protected readonly clients = new Map<string, any>();
diff --git a/packages/microservices/client/client-kafka.ts b/packages/microservices/client/client-kafka.ts
index ba9ad099a..618993d6f 100644
--- a/packages/microservices/client/client-kafka.ts
+++ b/packages/microservices/client/client-kafka.ts
@@ -40,15 +40,18 @@ import { ClientProxy } from './client-proxy';
 
 let kafkaPackage: any = {};
 
+/**
+ * @publicApi
+ */
 export class ClientKafka extends ClientProxy {
   protected logger = new Logger(ClientKafka.name);
-  protected client: Kafka = null;
-  protected consumer: Consumer = null;
-  protected producer: Producer = null;
-  protected parser: KafkaParser = null;
+  protected client: Kafka | null = null;
+  protected consumer: Consumer | null = null;
+  protected producer: Producer | null = null;
+  protected parser: KafkaParser | null = null;
+  protected initialized: Promise<void> | null = null;
   protected responsePatterns: string[] = [];
   protected consumerAssignments: { [key: string]: number } = {};
-
   protected brokers: string[] | BrokersFunction;
   protected clientId: string;
   protected groupId: string;
@@ -57,14 +60,22 @@ export class ClientKafka extends ClientProxy {
   constructor(protected readonly options: KafkaOptions['options']) {
     super();
 
-    const clientOptions =
-      this.getOptionsProp(this.options, 'client') || ({} as KafkaConfig);
-    const consumerOptions =
-      this.getOptionsProp(this.options, 'consumer') || ({} as ConsumerConfig);
-    const postfixId =
-      this.getOptionsProp(this.options, 'postfixId') ?? '-client';
-    this.producerOnlyMode =
-      this.getOptionsProp(this.options, 'producerOnlyMode') || false;
+    const clientOptions = this.getOptionsProp(
+      this.options,
+      'client',
+      {} as KafkaConfig,
+    );
+    const consumerOptions = this.getOptionsProp(
+      this.options,
+      'consumer',
+      {} as ConsumerConfig,
+    );
+    const postfixId = this.getOptionsProp(this.options, 'postfixId', '-client');
+    this.producerOnlyMode = this.getOptionsProp(
+      this.options,
+      'producerOnlyMode',
+      false,
+    );
 
     this.brokers = clientOptions.brokers || [KAFKA_DEFAULT_BROKER];
 
@@ -94,46 +105,56 @@ export class ClientKafka extends ClientProxy {
     this.consumer && (await this.consumer.disconnect());
     this.producer = null;
     this.consumer = null;
+    this.initialized = null;
     this.client = null;
   }
 
   public async connect(): Promise<Producer> {
-    if (this.client) {
-      return this.producer;
+    if (this.initialized) {
+      return this.initialized.then(() => this.producer);
     }
-    this.client = this.createClient();
-
-    if (!this.producerOnlyMode) {
-      const partitionAssigners = [
-        (
-          config: ConstructorParameters<typeof KafkaReplyPartitionAssigner>[1],
-        ) => new KafkaReplyPartitionAssigner(this, config),
-      ] as any[];
-
-      const consumerOptions = Object.assign(
-        {
-          partitionAssigners,
-        },
-        this.options.consumer || {},
-        {
-          groupId: this.groupId,
-        },
-      );
+    this.initialized = new Promise(async (resolve, reject) => {
+      try {
+        this.client = this.createClient();
+
+        if (!this.producerOnlyMode) {
+          const partitionAssigners = [
+            (
+              config: ConstructorParameters<
+                typeof KafkaReplyPartitionAssigner
+              >[1],
+            ) => new KafkaReplyPartitionAssigner(this, config),
+          ];
+
+          const consumerOptions = Object.assign(
+            {
+              partitionAssigners,
+            },
+            this.options.consumer || {},
+            {
+              groupId: this.groupId,
+            },
+          );
 
-      this.consumer = this.client.consumer(consumerOptions);
-      // set member assignments on join and rebalance
-      this.consumer.on(
-        this.consumer.events.GROUP_JOIN,
-        this.setConsumerAssignments.bind(this),
-      );
-      await this.consumer.connect();
-      await this.bindTopics();
-    }
+          this.consumer = this.client.consumer(consumerOptions);
+          // set member assignments on join and rebalance
+          this.consumer.on(
+            this.consumer.events.GROUP_JOIN,
+            this.setConsumerAssignments.bind(this),
+          );
+          await this.consumer.connect();
+          await this.bindTopics();
+        }
 
-    this.producer = this.client.producer(this.options.producer || {});
-    await this.producer.connect();
+        this.producer = this.client.producer(this.options.producer || {});
+        await this.producer.connect();
 
-    return this.producer;
+        resolve();
+      } catch (err) {
+        reject(err);
+      }
+    });
+    return this.initialized.then(() => this.producer);
   }
 
   public async bindTopics(): Promise<void> {
diff --git a/packages/microservices/client/client-mqtt.ts b/packages/microservices/client/client-mqtt.ts
index 44cf246b1..c2e7c6cf3 100644
--- a/packages/microservices/client/client-mqtt.ts
+++ b/packages/microservices/client/client-mqtt.ts
@@ -20,6 +20,9 @@ import { ClientProxy } from './client-proxy';
 
 let mqttPackage: any = {};
 
+/**
+ * @publicApi
+ */
 export class ClientMqtt extends ClientProxy {
   protected readonly logger = new Logger(ClientProxy.name);
   protected readonly subscriptionsCount = new Map<string, number>();
diff --git a/packages/microservices/client/client-nats.ts b/packages/microservices/client/client-nats.ts
index f85bf2e83..bf541cbbd 100644
--- a/packages/microservices/client/client-nats.ts
+++ b/packages/microservices/client/client-nats.ts
@@ -12,6 +12,9 @@ import { ClientProxy } from './client-proxy';
 
 let natsPackage = {} as any;
 
+/**
+ * @publicApi
+ */
 export class ClientNats extends ClientProxy {
   protected readonly logger = new Logger(ClientNats.name);
   protected natsClient: Client;
@@ -52,17 +55,28 @@ export class ClientNats extends ClientProxy {
         status.data && isObject(status.data)
           ? JSON.stringify(status.data)
           : status.data;
-      if (status.type === 'disconnect' || status.type === 'error') {
-        this.logger.error(
-          `NatsError: type: "${status.type}", data: "${data}".`,
-        );
-      } else {
-        const message = `NatsStatus: type: "${status.type}", data: "${data}".`;
-        if (status.type === 'pingTimer') {
-          this.logger.debug(message);
-        } else {
-          this.logger.log(message);
-        }
+
+      switch (status.type) {
+        case 'error':
+        case 'disconnect':
+          this.logger.error(
+            `NatsError: type: "${status.type}", data: "${data}".`,
+          );
+          break;
+
+        case 'pingTimer':
+          if (this.options.debug) {
+            this.logger.debug(
+              `NatsStatus: type: "${status.type}", data: "${data}".`,
+            );
+          }
+          break;
+
+        default:
+          this.logger.log(
+            `NatsStatus: type: "${status.type}", data: "${data}".`,
+          );
+          break;
       }
     }
   }
diff --git a/packages/microservices/client/client-proxy-factory.ts b/packages/microservices/client/client-proxy-factory.ts
index f6bd89227..a19200990 100644
--- a/packages/microservices/client/client-proxy-factory.ts
+++ b/packages/microservices/client/client-proxy-factory.ts
@@ -26,6 +26,9 @@ export interface IClientProxyFactory {
   create(clientOptions: ClientOptions): ClientProxy & Closeable;
 }
 
+/**
+ * @publicApi
+ */
 export class ClientProxyFactory {
   public static create(
     clientOptions: { transport: Transport.GRPC } & ClientOptions,
diff --git a/packages/microservices/client/client-proxy.ts b/packages/microservices/client/client-proxy.ts
index bdd3484d7..3950cf3db 100644
--- a/packages/microservices/client/client-proxy.ts
+++ b/packages/microservices/client/client-proxy.ts
@@ -130,7 +130,7 @@ export abstract class ClientProxy {
     T extends ClientOptions['options'],
     K extends keyof T,
   >(obj: T, prop: K, defaultValue: T[K] = undefined) {
-    return (obj && obj[prop]) || defaultValue;
+    return obj && prop in obj ? obj[prop] : defaultValue;
   }
 
   protected normalizePattern(pattern: MsPattern): string {
diff --git a/packages/microservices/client/client-redis.ts b/packages/microservices/client/client-redis.ts
index 517ea271c..9148a450f 100644
--- a/packages/microservices/client/client-redis.ts
+++ b/packages/microservices/client/client-redis.ts
@@ -13,6 +13,9 @@ type Redis = any;
 
 let redisPackage = {} as any;
 
+/**
+ * @publicApi
+ */
 export class ClientRedis extends ClientProxy {
   protected readonly logger = new Logger(ClientProxy.name);
   protected readonly subscriptionsCount = new Map<string, number>();
diff --git a/packages/microservices/client/client-rmq.ts b/packages/microservices/client/client-rmq.ts
index 5c6616f7f..f68ef3bec 100644
--- a/packages/microservices/client/client-rmq.ts
+++ b/packages/microservices/client/client-rmq.ts
@@ -3,21 +3,29 @@ import { loadPackage } from '@nestjs/common/utils/load-package.util';
 import { randomStringGenerator } from '@nestjs/common/utils/random-string-generator.util';
 import { isFunction } from '@nestjs/common/utils/shared.utils';
 import { EventEmitter } from 'events';
-import { EmptyError, fromEvent, lastValueFrom, merge, Observable } from 'rxjs';
-import { first, map, retryWhen, scan, share, switchMap } from 'rxjs/operators';
 import {
+  EmptyError,
+  firstValueFrom,
+  fromEvent,
+  merge,
+  Observable,
+  ReplaySubject,
+} from 'rxjs';
+import { first, map, retryWhen, scan, skip, switchMap } from 'rxjs/operators';
+import {
+  CONNECT_EVENT,
   CONNECT_FAILED_EVENT,
   DISCONNECTED_RMQ_MESSAGE,
   DISCONNECT_EVENT,
   ERROR_EVENT,
   RQM_DEFAULT_IS_GLOBAL_PREFETCH_COUNT,
   RQM_DEFAULT_NOACK,
+  RQM_DEFAULT_NO_ASSERT,
   RQM_DEFAULT_PERSISTENT,
   RQM_DEFAULT_PREFETCH_COUNT,
   RQM_DEFAULT_QUEUE,
   RQM_DEFAULT_QUEUE_OPTIONS,
   RQM_DEFAULT_URL,
-  RQM_DEFAULT_NO_ASSERT,
 } from '../constants';
 import { RmqUrl } from '../external/rmq-url.interface';
 import { ReadPacket, RmqOptions, WritePacket } from '../interfaces';
@@ -25,18 +33,33 @@ import { RmqRecord } from '../record-builders';
 import { RmqRecordSerializer } from '../serializers/rmq-record.serializer';
 import { ClientProxy } from './client-proxy';
 
+// import type {
+//   AmqpConnectionManager,
+//   ChannelWrapper,
+// } from 'amqp-connection-manager';
+// import type { Channel, ConsumeMessage } from 'amqplib';
+
+type Channel = any;
+type ChannelWrapper = any;
+type ConsumeMessage = any;
+type AmqpConnectionManager = any;
+
 let rqmPackage: any = {};
 
 const REPLY_QUEUE = 'amq.rabbitmq.reply-to';
 
+/**
+ * @publicApi
+ */
 export class ClientRMQ extends ClientProxy {
   protected readonly logger = new Logger(ClientProxy.name);
+  protected connection$: ReplaySubject<any>;
   protected connection: Promise<any>;
-  protected client: any = null;
-  protected channel: any = null;
+  protected client: AmqpConnectionManager = null;
+  protected channel: ChannelWrapper = null;
   protected urls: string[] | RmqUrl[];
   protected queue: string;
-  protected queueOptions: any;
+  protected queueOptions: Record<string, any>;
   protected responseEmitter: EventEmitter;
   protected replyQueue: string;
   protected persistent: boolean;
@@ -75,42 +98,44 @@ export class ClientRMQ extends ClientProxy {
 
   public connect(): Promise<any> {
     if (this.client) {
-      return this.connection;
+      return this.convertConnectionToPromise();
     }
     this.client = this.createClient();
     this.handleError(this.client);
     this.handleDisconnectError(this.client);
 
+    this.responseEmitter = new EventEmitter();
+    this.responseEmitter.setMaxListeners(0);
+
     const connect$ = this.connect$(this.client);
-    this.connection = lastValueFrom(
-      this.mergeDisconnectEvent(this.client, connect$).pipe(
-        switchMap(() => this.createChannel()),
-        share(),
-      ),
-    ).catch(err => {
-      if (err instanceof EmptyError) {
-        return;
-      }
-      throw err;
-    });
+    const withDisconnect$ = this.mergeDisconnectEvent(
+      this.client,
+      connect$,
+    ).pipe(switchMap(() => this.createChannel()));
+
+    const withReconnect$ = fromEvent(this.client, CONNECT_EVENT).pipe(skip(1));
+    const source$ = merge(withDisconnect$, withReconnect$);
 
-    return this.connection;
+    this.connection$ = new ReplaySubject(1);
+    source$.subscribe(this.connection$);
+
+    return this.convertConnectionToPromise();
   }
 
   public createChannel(): Promise<void> {
     return new Promise(resolve => {
       this.channel = this.client.createChannel({
         json: false,
-        setup: (channel: any) => this.setupChannel(channel, resolve),
+        setup: (channel: Channel) => this.setupChannel(channel, resolve),
       });
     });
   }
 
-  public createClient<T = any>(): T {
+  public createClient(): AmqpConnectionManager {
     const socketOptions = this.getOptionsProp(this.options, 'socketOptions');
     return rqmPackage.connect(this.urls, {
       connectionOptions: socketOptions,
-    }) as T;
+    });
   }
 
   public mergeDisconnectEvent<T = any>(
@@ -119,7 +144,7 @@ export class ClientRMQ extends ClientProxy {
   ): Observable<T> {
     const eventToError = (eventType: string) =>
       fromEvent(instance, eventType).pipe(
-        map((err: any) => {
+        map((err: unknown) => {
           throw err;
         }),
       );
@@ -138,10 +163,23 @@ export class ClientRMQ extends ClientProxy {
         ),
       ),
     );
+    // If we ever decide to propagate all disconnect errors & re-emit them through
+    // the "connection" stream then comment out "first()" operator.
     return merge(source$, disconnect$, connectFailed$).pipe(first());
   }
 
-  public async setupChannel(channel: any, resolve: Function) {
+  public async convertConnectionToPromise() {
+    try {
+      return await firstValueFrom(this.connection$);
+    } catch (err) {
+      if (err instanceof EmptyError) {
+        return;
+      }
+      throw err;
+    }
+  }
+
+  public async setupChannel(channel: Channel, resolve: Function) {
     const prefetchCount =
       this.getOptionsProp(this.options, 'prefetchCount') ||
       RQM_DEFAULT_PREFETCH_COUNT;
@@ -153,18 +191,15 @@ export class ClientRMQ extends ClientProxy {
       await channel.assertQueue(this.queue, this.queueOptions);
     }
     await channel.prefetch(prefetchCount, isGlobalPrefetchCount);
-
-    this.responseEmitter = new EventEmitter();
-    this.responseEmitter.setMaxListeners(0);
     await this.consumeChannel(channel);
     resolve();
   }
 
-  public async consumeChannel(channel: any) {
+  public async consumeChannel(channel: Channel) {
     const noAck = this.getOptionsProp(this.options, 'noAck', RQM_DEFAULT_NOACK);
     await channel.consume(
       this.replyQueue,
-      (msg: any) =>
+      (msg: ConsumeMessage) =>
         this.responseEmitter.emit(msg.properties.correlationId, msg),
       {
         noAck,
@@ -172,16 +207,14 @@ export class ClientRMQ extends ClientProxy {
     );
   }
 
-  public handleError(client: any): void {
+  public handleError(client: AmqpConnectionManager): void {
     client.addListener(ERROR_EVENT, (err: any) => this.logger.error(err));
   }
 
-  public handleDisconnectError(client: any): void {
+  public handleDisconnectError(client: AmqpConnectionManager): void {
     client.addListener(DISCONNECT_EVENT, (err: any) => {
       this.logger.error(DISCONNECTED_RMQ_MESSAGE);
       this.logger.error(err);
-
-      this.close();
     });
   }
 
@@ -231,7 +264,7 @@ export class ClientRMQ extends ClientProxy {
         content,
         options,
       }: {
-        content: any;
+        content: Buffer;
         options: Record<string, unknown>;
       }) =>
         this.handleMessage(JSON.parse(content.toString()), options, callback);
@@ -244,17 +277,19 @@ export class ClientRMQ extends ClientProxy {
       delete serializedPacket.options;
 
       this.responseEmitter.on(correlationId, listener);
-      this.channel.sendToQueue(
-        this.queue,
-        Buffer.from(JSON.stringify(serializedPacket)),
-        {
-          replyTo: this.replyQueue,
-          persistent: this.persistent,
-          ...options,
-          headers: this.mergeHeaders(options?.headers),
-          correlationId,
-        },
-      );
+      this.channel
+        .sendToQueue(
+          this.queue,
+          Buffer.from(JSON.stringify(serializedPacket)),
+          {
+            replyTo: this.replyQueue,
+            persistent: this.persistent,
+            ...options,
+            headers: this.mergeHeaders(options?.headers),
+            correlationId,
+          },
+        )
+        .catch(err => callback({ err }));
       return () => this.responseEmitter.removeListener(correlationId, listener);
     } catch (err) {
       callback({ err });
diff --git a/packages/microservices/client/client-tcp.ts b/packages/microservices/client/client-tcp.ts
index 17b7e4a7e..e0b1ddb91 100644
--- a/packages/microservices/client/client-tcp.ts
+++ b/packages/microservices/client/client-tcp.ts
@@ -2,6 +2,7 @@ import { Logger, Type } from '@nestjs/common';
 import * as net from 'net';
 import { EmptyError, lastValueFrom } from 'rxjs';
 import { share, tap } from 'rxjs/operators';
+import { ConnectionOptions } from 'tls';
 import {
   CLOSE_EVENT,
   ECONNREFUSED,
@@ -11,10 +12,14 @@ import {
   TCP_DEFAULT_PORT,
 } from '../constants';
 import { JsonSocket, TcpSocket } from '../helpers';
+import { connect as tlsConnect, TLSSocket } from 'tls';
 import { PacketId, ReadPacket, WritePacket } from '../interfaces';
 import { TcpClientOptions } from '../interfaces/client-metadata.interface';
 import { ClientProxy } from './client-proxy';
 
+/**
+ * @publicApi
+ */
 export class ClientTCP extends ClientProxy {
   protected connection: Promise<any>;
   private readonly logger = new Logger(ClientTCP.name);
@@ -23,6 +28,7 @@ export class ClientTCP extends ClientProxy {
   private readonly socketClass: Type<TcpSocket>;
   private isConnected = false;
   private socket: TcpSocket;
+  public tlsOptions?: ConnectionOptions;
 
   constructor(options: TcpClientOptions['options']) {
     super();
@@ -30,6 +36,7 @@ export class ClientTCP extends ClientProxy {
     this.host = this.getOptionsProp(options, 'host') || TCP_DEFAULT_HOST;
     this.socketClass =
       this.getOptionsProp(options, 'socketClass') || JsonSocket;
+    this.tlsOptions = this.getOptionsProp(options, 'tlsOptions');
 
     this.initializeSerializer(options);
     this.initializeDeserializer(options);
@@ -52,7 +59,10 @@ export class ClientTCP extends ClientProxy {
       share(),
     );
 
-    this.socket.connect(this.port, this.host);
+    // For TLS connections, the connection is initiated when the socket is created
+    if (!this.tlsOptions) {
+      this.socket.connect(this.port, this.host);
+    }
     this.connection = lastValueFrom(source$).catch(err => {
       if (err instanceof EmptyError) {
         return;
@@ -84,7 +94,21 @@ export class ClientTCP extends ClientProxy {
   }
 
   public createSocket(): TcpSocket {
-    return new this.socketClass(new net.Socket());
+    let socket: net.Socket | TLSSocket;
+    /**
+     * TLS enabled, "upgrade" the TCP Socket to TLS
+     */
+    if (this.tlsOptions) {
+      socket = tlsConnect({
+        ...this.tlsOptions,
+        port: this.port,
+        host: this.host,
+        socket,
+      });
+    } else {
+      socket = new net.Socket();
+    }
+    return new this.socketClass(socket);
   }
 
   public close() {
diff --git a/packages/microservices/context/exception-filters-context.ts b/packages/microservices/context/exception-filters-context.ts
index 3f8ab49bd..14d42da91 100644
--- a/packages/microservices/context/exception-filters-context.ts
+++ b/packages/microservices/context/exception-filters-context.ts
@@ -6,10 +6,13 @@ import { BaseExceptionFilterContext } from '@nestjs/core/exceptions/base-excepti
 import { STATIC_CONTEXT } from '@nestjs/core/injector/constants';
 import { NestContainer } from '@nestjs/core/injector/container';
 import { InstanceWrapper } from '@nestjs/core/injector/instance-wrapper';
+import { iterate } from 'iterare';
 import { Observable } from 'rxjs';
 import { RpcExceptionsHandler } from '../exceptions/rpc-exceptions-handler';
-import { iterate } from 'iterare';
 
+/**
+ * @publicApi
+ */
 export class ExceptionFiltersContext extends BaseExceptionFilterContext {
   constructor(
     container: NestContainer,
@@ -53,7 +56,12 @@ export class ExceptionFiltersContext extends BaseExceptionFilterContext {
     const scopedFilterWrappers =
       this.config.getGlobalRequestFilters() as InstanceWrapper[];
     const scopedFilters = iterate(scopedFilterWrappers)
-      .map(wrapper => wrapper.getInstanceByContextId(contextId, inquirerId))
+      .map(wrapper =>
+        wrapper.getInstanceByContextId(
+          this.getContextId(contextId, wrapper),
+          inquirerId,
+        ),
+      )
       .filter(host => !!host)
       .map(host => host.instance)
       .toArray();
diff --git a/packages/microservices/context/request-context-host.ts b/packages/microservices/context/request-context-host.ts
index 2d221cca7..f15eb29d8 100644
--- a/packages/microservices/context/request-context-host.ts
+++ b/packages/microservices/context/request-context-host.ts
@@ -1,6 +1,9 @@
 import { BaseRpcContext } from '../ctx-host/base-rpc.context';
 import { RequestContext } from '../interfaces';
 
+/**
+ * @publicApi
+ */
 export class RequestContextHost<
   TData = any,
   TContext extends BaseRpcContext = any,
diff --git a/packages/microservices/decorators/client.decorator.ts b/packages/microservices/decorators/client.decorator.ts
index 53d99d4fb..48848b6a4 100644
--- a/packages/microservices/decorators/client.decorator.ts
+++ b/packages/microservices/decorators/client.decorator.ts
@@ -5,6 +5,9 @@ import { ClientOptions } from '../interfaces/client-metadata.interface';
  * Attaches the `ClientProxy` instance to the given property
  *
  * @param  {ClientOptions} metadata optional client metadata
+ *
+ * @publicApi
+ *
  */
 export function Client(metadata?: ClientOptions): PropertyDecorator {
   return (target: object, propertyKey: string | symbol): void => {
diff --git a/packages/microservices/decorators/event-pattern.decorator.ts b/packages/microservices/decorators/event-pattern.decorator.ts
index b44825d63..ead1830b9 100644
--- a/packages/microservices/decorators/event-pattern.decorator.ts
+++ b/packages/microservices/decorators/event-pattern.decorator.ts
@@ -15,6 +15,8 @@ import { Transport } from '../enums';
 
 /**
  * Subscribes to incoming events which fulfils chosen pattern.
+ *
+ * @publicApi
  */
 export const EventPattern: {
   <T = string>(metadata?: T): MethodDecorator;
@@ -59,7 +61,14 @@ export const EventPattern: {
       descriptor.value,
     );
     Reflect.defineMetadata(TRANSPORT_METADATA, transport, descriptor.value);
-    Reflect.defineMetadata(PATTERN_EXTRAS_METADATA, extras, descriptor.value);
+    Reflect.defineMetadata(
+      PATTERN_EXTRAS_METADATA,
+      {
+        ...Reflect.getMetadata(PATTERN_EXTRAS_METADATA, descriptor.value),
+        ...extras,
+      },
+      descriptor.value,
+    );
     return descriptor;
   };
 };
diff --git a/packages/microservices/decorators/message-pattern.decorator.ts b/packages/microservices/decorators/message-pattern.decorator.ts
index 6cb4ed1d8..86d460f1f 100644
--- a/packages/microservices/decorators/message-pattern.decorator.ts
+++ b/packages/microservices/decorators/message-pattern.decorator.ts
@@ -23,6 +23,8 @@ export enum GrpcMethodStreamingType {
 
 /**
  * Subscribes to incoming messages which fulfils chosen pattern.
+ *
+ * @publicApi
  */
 export const MessagePattern: {
   <T = PatternMetadata | string>(metadata?: T): MethodDecorator;
@@ -73,7 +75,14 @@ export const MessagePattern: {
       descriptor.value,
     );
     Reflect.defineMetadata(TRANSPORT_METADATA, transport, descriptor.value);
-    Reflect.defineMetadata(PATTERN_EXTRAS_METADATA, extras, descriptor.value);
+    Reflect.defineMetadata(
+      PATTERN_EXTRAS_METADATA,
+      {
+        ...Reflect.getMetadata(PATTERN_EXTRAS_METADATA, descriptor.value),
+        ...extras,
+      },
+      descriptor.value,
+    );
     return descriptor;
   };
 };
diff --git a/packages/microservices/deserializers/identity.deserializer.ts b/packages/microservices/deserializers/identity.deserializer.ts
index 9eccb6621..7a6d1e0d4 100644
--- a/packages/microservices/deserializers/identity.deserializer.ts
+++ b/packages/microservices/deserializers/identity.deserializer.ts
@@ -1,5 +1,8 @@
 import { Deserializer } from '../interfaces/deserializer.interface';
 
+/**
+ * @publicApi
+ */
 export class IdentityDeserializer implements Deserializer {
   deserialize(value: any) {
     return value;
diff --git a/packages/microservices/deserializers/incoming-request.deserializer.ts b/packages/microservices/deserializers/incoming-request.deserializer.ts
index 3e3a6f6f0..537e9b715 100644
--- a/packages/microservices/deserializers/incoming-request.deserializer.ts
+++ b/packages/microservices/deserializers/incoming-request.deserializer.ts
@@ -5,6 +5,9 @@ import {
   IncomingRequest,
 } from '../interfaces';
 
+/**
+ * @publicApi
+ */
 export class IncomingRequestDeserializer implements ConsumerDeserializer {
   deserialize(
     value: any,
diff --git a/packages/microservices/deserializers/incoming-response.deserializer.ts b/packages/microservices/deserializers/incoming-response.deserializer.ts
index 5ea343b1f..55ecc4684 100644
--- a/packages/microservices/deserializers/incoming-response.deserializer.ts
+++ b/packages/microservices/deserializers/incoming-response.deserializer.ts
@@ -1,6 +1,9 @@
 import { isUndefined } from '@nestjs/common/utils/shared.utils';
 import { IncomingResponse, ProducerDeserializer } from '../interfaces';
 
+/**
+ * @publicApi
+ */
 export class IncomingResponseDeserializer implements ProducerDeserializer {
   deserialize(value: any, options?: Record<string, any>): IncomingResponse {
     return this.isExternal(value) ? this.mapToSchema(value) : value;
diff --git a/packages/microservices/deserializers/kafka-request.deserializer.ts b/packages/microservices/deserializers/kafka-request.deserializer.ts
index 99dae3119..359321728 100644
--- a/packages/microservices/deserializers/kafka-request.deserializer.ts
+++ b/packages/microservices/deserializers/kafka-request.deserializer.ts
@@ -2,6 +2,9 @@ import { IncomingEvent, IncomingRequest } from '../interfaces';
 import { KafkaRequest } from '../serializers/kafka-request.serializer';
 import { IncomingRequestDeserializer } from './incoming-request.deserializer';
 
+/**
+ * @publicApi
+ */
 export class KafkaRequestDeserializer extends IncomingRequestDeserializer {
   mapToSchema(
     data: KafkaRequest,
diff --git a/packages/microservices/deserializers/kafka-response.deserializer.ts b/packages/microservices/deserializers/kafka-response.deserializer.ts
index 2b5385458..93d2977b2 100644
--- a/packages/microservices/deserializers/kafka-response.deserializer.ts
+++ b/packages/microservices/deserializers/kafka-response.deserializer.ts
@@ -2,6 +2,9 @@ import { isUndefined } from '@nestjs/common/utils/shared.utils';
 import { KafkaHeaders } from '../enums/kafka-headers.enum';
 import { Deserializer, IncomingResponse } from '../interfaces';
 
+/**
+ * @publicApi
+ */
 export class KafkaResponseDeserializer
   implements Deserializer<any, IncomingResponse>
 {
diff --git a/packages/microservices/deserializers/nats-request-json.deserializer.ts b/packages/microservices/deserializers/nats-request-json.deserializer.ts
index e46851751..68763e17f 100644
--- a/packages/microservices/deserializers/nats-request-json.deserializer.ts
+++ b/packages/microservices/deserializers/nats-request-json.deserializer.ts
@@ -5,6 +5,9 @@ import { IncomingRequestDeserializer } from './incoming-request.deserializer';
 
 let natsPackage = {} as any;
 
+/**
+ * @publicApi
+ */
 export class NatsRequestJSONDeserializer extends IncomingRequestDeserializer {
   private readonly jsonCodec: NatsCodec<unknown>;
 
diff --git a/packages/microservices/deserializers/nats-response-json.deserializer.ts b/packages/microservices/deserializers/nats-response-json.deserializer.ts
index 70787afc7..51a809726 100644
--- a/packages/microservices/deserializers/nats-response-json.deserializer.ts
+++ b/packages/microservices/deserializers/nats-response-json.deserializer.ts
@@ -6,6 +6,9 @@ import { NatsRequestJSONDeserializer } from './nats-request-json.deserializer';
 
 let natsPackage = {} as any;
 
+/**
+ * @publicApi
+ */
 export class NatsResponseJSONDeserializer extends IncomingResponseDeserializer {
   private readonly jsonCodec: NatsCodec<unknown>;
 
diff --git a/packages/microservices/enums/kafka-headers.enum.ts b/packages/microservices/enums/kafka-headers.enum.ts
index c4c622873..82d5eead2 100644
--- a/packages/microservices/enums/kafka-headers.enum.ts
+++ b/packages/microservices/enums/kafka-headers.enum.ts
@@ -1,5 +1,7 @@
 /**
  * @see https://docs.spring.io/spring-kafka/api/org/springframework/kafka/support/KafkaHeaders.html
+ *
+ * @publicApi
  */
 export enum KafkaHeaders {
   ACKNOWLEDGMENT = 'kafka_acknowledgment',
diff --git a/packages/microservices/errors/corrupted-packet-length.exception.ts b/packages/microservices/errors/corrupted-packet-length.exception.ts
index c00e20a6e..8dea792c5 100644
--- a/packages/microservices/errors/corrupted-packet-length.exception.ts
+++ b/packages/microservices/errors/corrupted-packet-length.exception.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export class CorruptedPacketLengthException extends Error {
   constructor(rawContentLength: string) {
     super(`Corrupted length value "${rawContentLength}" supplied in a packet`);
diff --git a/packages/microservices/errors/empty-response.exception.ts b/packages/microservices/errors/empty-response.exception.ts
index d0b0d7330..1151f8dc4 100644
--- a/packages/microservices/errors/empty-response.exception.ts
+++ b/packages/microservices/errors/empty-response.exception.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export class EmptyResponseException extends Error {
   constructor(pattern: string) {
     super(
diff --git a/packages/microservices/errors/invalid-grpc-package.exception.ts b/packages/microservices/errors/invalid-grpc-package.exception.ts
index fe9a4d59b..a0599e457 100644
--- a/packages/microservices/errors/invalid-grpc-package.exception.ts
+++ b/packages/microservices/errors/invalid-grpc-package.exception.ts
@@ -1,5 +1,8 @@
 import { RuntimeException } from '@nestjs/core/errors/exceptions/runtime.exception';
 
+/**
+ * @publicApi
+ */
 export class InvalidGrpcPackageException extends RuntimeException {
   constructor(name: string) {
     super(`The invalid gRPC package (package "${name}" not found)`);
diff --git a/packages/microservices/errors/invalid-grpc-service.exception.ts b/packages/microservices/errors/invalid-grpc-service.exception.ts
index 5c37f1601..1da6a18c8 100644
--- a/packages/microservices/errors/invalid-grpc-service.exception.ts
+++ b/packages/microservices/errors/invalid-grpc-service.exception.ts
@@ -1,5 +1,8 @@
 import { RuntimeException } from '@nestjs/core/errors/exceptions/runtime.exception';
 
+/**
+ * @publicApi
+ */
 export class InvalidGrpcServiceException extends RuntimeException {
   constructor(name: string) {
     super(`The invalid gRPC service (service "${name}" not found)`);
diff --git a/packages/microservices/errors/invalid-json-format.exception.ts b/packages/microservices/errors/invalid-json-format.exception.ts
index ef7f69108..ac830a49b 100644
--- a/packages/microservices/errors/invalid-json-format.exception.ts
+++ b/packages/microservices/errors/invalid-json-format.exception.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export class InvalidJSONFormatException extends Error {
   constructor(err: Error, data: string) {
     super(`Could not parse JSON: ${err.message}\nRequest data: ${data}`);
diff --git a/packages/microservices/errors/invalid-kafka-client-topic.exception.ts b/packages/microservices/errors/invalid-kafka-client-topic.exception.ts
index aa0062569..12871369f 100644
--- a/packages/microservices/errors/invalid-kafka-client-topic.exception.ts
+++ b/packages/microservices/errors/invalid-kafka-client-topic.exception.ts
@@ -1,5 +1,8 @@
 import { RuntimeException } from '@nestjs/core/errors/exceptions/runtime.exception';
 
+/**
+ * @publicApi
+ */
 export class InvalidKafkaClientTopicException extends RuntimeException {
   constructor(topic?: string) {
     super(
diff --git a/packages/microservices/errors/invalid-message.exception.ts b/packages/microservices/errors/invalid-message.exception.ts
index cc1627b87..6b8c0e9ee 100644
--- a/packages/microservices/errors/invalid-message.exception.ts
+++ b/packages/microservices/errors/invalid-message.exception.ts
@@ -1,5 +1,8 @@
 import { RuntimeException } from '@nestjs/core/errors/exceptions/runtime.exception';
 
+/**
+ * @publicApi
+ */
 export class InvalidMessageException extends RuntimeException {
   constructor() {
     super(`The invalid data or message pattern (undefined/null)`);
diff --git a/packages/microservices/errors/invalid-proto-definition.exception.ts b/packages/microservices/errors/invalid-proto-definition.exception.ts
index 46559050a..28ce445a0 100644
--- a/packages/microservices/errors/invalid-proto-definition.exception.ts
+++ b/packages/microservices/errors/invalid-proto-definition.exception.ts
@@ -1,5 +1,8 @@
 import { RuntimeException } from '@nestjs/core/errors/exceptions/runtime.exception';
 
+/**
+ * @publicApi
+ */
 export class InvalidProtoDefinitionException extends RuntimeException {
   constructor(path: string) {
     super(`The invalid .proto definition (file at "${path}" not found)`);
diff --git a/packages/microservices/errors/net-socket-closed.exception.ts b/packages/microservices/errors/net-socket-closed.exception.ts
index 3453aaaa7..9f20bbd0d 100644
--- a/packages/microservices/errors/net-socket-closed.exception.ts
+++ b/packages/microservices/errors/net-socket-closed.exception.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export class NetSocketClosedException extends Error {
   constructor() {
     super(`The net socket is closed.`);
diff --git a/packages/microservices/exceptions/base-rpc-exception-filter.ts b/packages/microservices/exceptions/base-rpc-exception-filter.ts
index 1c42d24b6..837330fac 100644
--- a/packages/microservices/exceptions/base-rpc-exception-filter.ts
+++ b/packages/microservices/exceptions/base-rpc-exception-filter.ts
@@ -5,6 +5,9 @@ import { MESSAGES } from '@nestjs/core/constants';
 import { Observable, throwError as _throw } from 'rxjs';
 import { RpcException } from './rpc-exception';
 
+/**
+ * @publicApi
+ */
 export class BaseRpcExceptionFilter<T = any, R = any>
   implements RpcExceptionFilter<T>
 {
diff --git a/packages/microservices/exceptions/rpc-exception.ts b/packages/microservices/exceptions/rpc-exception.ts
index 1d59c61c7..60d77f5c1 100644
--- a/packages/microservices/exceptions/rpc-exception.ts
+++ b/packages/microservices/exceptions/rpc-exception.ts
@@ -1,5 +1,8 @@
 import { isObject, isString } from '@nestjs/common/utils/shared.utils';
 
+/**
+ * @publicApi
+ */
 export class RpcException extends Error {
   constructor(private readonly error: string | object) {
     super();
diff --git a/packages/microservices/exceptions/rpc-exceptions-handler.ts b/packages/microservices/exceptions/rpc-exceptions-handler.ts
index 7815c80d1..97ee23270 100644
--- a/packages/microservices/exceptions/rpc-exceptions-handler.ts
+++ b/packages/microservices/exceptions/rpc-exceptions-handler.ts
@@ -1,11 +1,15 @@
-import { RpcExceptionFilterMetadata } from '@nestjs/common/interfaces/exceptions';
-import { ArgumentsHost } from '@nestjs/common/interfaces/features/arguments-host.interface';
 import { isEmpty } from '@nestjs/common/utils/shared.utils';
-import { InvalidExceptionFilterException } from '@nestjs/core/errors/exceptions/invalid-exception-filter.exception';
 import { Observable } from 'rxjs';
-import { BaseRpcExceptionFilter } from './base-rpc-exception-filter';
+import { ArgumentsHost } from '@nestjs/common/interfaces/features/arguments-host.interface';
+import { RpcExceptionFilterMetadata } from '@nestjs/common/interfaces/exceptions';
+import { selectExceptionFilterMetadata } from '@nestjs/common/utils/select-exception-filter-metadata.util';
+import { InvalidExceptionFilterException } from '@nestjs/core/errors/exceptions/invalid-exception-filter.exception';
 import { RpcException } from './rpc-exception';
+import { BaseRpcExceptionFilter } from './base-rpc-exception-filter';
 
+/**
+ * @publicApi
+ */
 export class RpcExceptionsHandler extends BaseRpcExceptionFilter {
   private filters: RpcExceptionFilterMetadata[] = [];
 
@@ -34,14 +38,8 @@ export class RpcExceptionsHandler extends BaseRpcExceptionFilter {
     if (isEmpty(this.filters)) {
       return null;
     }
-    const filter = this.filters.find(({ exceptionMetatypes }) => {
-      const hasMetatype =
-        !exceptionMetatypes.length ||
-        exceptionMetatypes.some(
-          ExceptionMetatype => exception instanceof ExceptionMetatype,
-        );
-      return hasMetatype;
-    });
+
+    const filter = selectExceptionFilterMetadata(this.filters, exception);
     return filter ? filter.func(exception, host) : null;
   }
 }
diff --git a/packages/microservices/external/grpc-options.interface.ts b/packages/microservices/external/grpc-options.interface.ts
index 3c5bd22c2..51ceac477 100644
--- a/packages/microservices/external/grpc-options.interface.ts
+++ b/packages/microservices/external/grpc-options.interface.ts
@@ -1,6 +1,8 @@
 /**
  * An interface that contains options used when initializing a Channel instance.
  * This listing is incomplete. Full reference: https://grpc.github.io/grpc/core/group__grpc__arg__keys.html
+ *
+ * @publicApi
  */
 export interface ChannelOptions {
   'grpc.max_send_message_length'?: number;
diff --git a/packages/microservices/external/kafka.interface.ts b/packages/microservices/external/kafka.interface.ts
index cdb95dff0..ed7a07bef 100644
--- a/packages/microservices/external/kafka.interface.ts
+++ b/packages/microservices/external/kafka.interface.ts
@@ -2,6 +2,9 @@
  * Do NOT add NestJS logic to this interface.  It is meant to ONLY represent the types for the kafkajs package.
  *
  * @see https://github.com/tulios/kafkajs/blob/master/types/index.d.ts
+ *
+ * @publicApi
+ *
  */
 
 /// <reference types="node" />
@@ -971,7 +974,7 @@ export type ConsumerRebalancingEvent = InstrumentationEvent<{
   groupId: string;
   memberId: string;
 }>;
-export type ConsumerReceivedUnsubcribedTopicsEvent = InstrumentationEvent<{
+export type ConsumerReceivedUnsubscribedTopicsEvent = InstrumentationEvent<{
   groupId: string;
   generationId: number;
   memberId: string;
@@ -1106,7 +1109,7 @@ export type Consumer = {
   ): RemoveInstrumentationEventListener<typeof eventName>;
   on(
     eventName: ConsumerEvents['RECEIVED_UNSUBSCRIBED_TOPICS'],
-    listener: (event: ConsumerReceivedUnsubcribedTopicsEvent) => void,
+    listener: (event: ConsumerReceivedUnsubscribedTopicsEvent) => void,
   ): RemoveInstrumentationEventListener<typeof eventName>;
   on(
     eventName: ConsumerEvents['REQUEST'],
diff --git a/packages/microservices/external/mqtt-client.interface.ts b/packages/microservices/external/mqtt-client.interface.ts
index 506081338..0429c850d 100644
--- a/packages/microservices/external/mqtt-client.interface.ts
+++ b/packages/microservices/external/mqtt-client.interface.ts
@@ -2,6 +2,9 @@ import { EventEmitter } from 'events';
 
 /**
  * @see https://github.com/mqttjs/MQTT.js/
+ *
+ * @publicApi
+ *
  */
 export declare class MqttClient extends EventEmitter {
   public connected: boolean;
@@ -75,7 +78,7 @@ export declare class MqttClient extends EventEmitter {
   /**
    * unsubscribe - unsubscribe from topic(s)
    *
-   * @param {String, Array} topic - topics to unsubscribe from
+   * @param {string|Array} topic - topics to unsubscribe from
    * @param {Function} [callback] - callback fired on unsuback
    * @returns {MqttClient} this - for chaining
    * @api public
diff --git a/packages/microservices/external/mqtt-options.interface.ts b/packages/microservices/external/mqtt-options.interface.ts
index 47c0d12b8..3eba9f18d 100644
--- a/packages/microservices/external/mqtt-options.interface.ts
+++ b/packages/microservices/external/mqtt-options.interface.ts
@@ -1,5 +1,7 @@
 /**
  * @see https://github.com/mqttjs/MQTT.js/
+ *
+ * @publicApi
  */
 export declare type QoS = 0 | 1 | 2;
 
diff --git a/packages/microservices/external/nats-client.interface.ts b/packages/microservices/external/nats-client.interface.ts
index b40cd679e..637883a42 100644
--- a/packages/microservices/external/nats-client.interface.ts
+++ b/packages/microservices/external/nats-client.interface.ts
@@ -1,5 +1,7 @@
 /**
  * @see https://github.com/nats-io/nats.js
+ *
+ * @publicApi
  */
 export interface NatsCodec<T> {
   encode(d: T): Uint8Array;
diff --git a/packages/microservices/external/redis.interface.ts b/packages/microservices/external/redis.interface.ts
index 6de36c439..506d3669c 100644
--- a/packages/microservices/external/redis.interface.ts
+++ b/packages/microservices/external/redis.interface.ts
@@ -2,6 +2,8 @@ import { ConnectionOptions } from 'tls';
 
 /**
  * @see https://github.dev/luin/ioredis/blob/df04dd8d87a44d3b64b385c86581915248554508/lib/redis/RedisOptions.ts#L184
+ *
+ * @publicApi
  */
 export interface IORedisOptions {
   Connector?: any;
diff --git a/packages/microservices/external/rmq-url.interface.ts b/packages/microservices/external/rmq-url.interface.ts
index c19501e59..9899d2a93 100644
--- a/packages/microservices/external/rmq-url.interface.ts
+++ b/packages/microservices/external/rmq-url.interface.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export interface RmqUrl {
   protocol?: string;
   hostname?: string;
@@ -10,6 +13,9 @@ export interface RmqUrl {
   vhost?: string;
 }
 
+/**
+ * @publicApi
+ */
 export interface AmqpConnectionManagerSocketOptions {
   reconnectTimeInSeconds?: number;
   heartbeatIntervalInSeconds?: number;
@@ -17,6 +23,9 @@ export interface AmqpConnectionManagerSocketOptions {
   connectionOptions?: any;
 }
 
+/**
+ * @publicApi
+ */
 export interface AmqplibQueueOptions {
   durable?: boolean;
   autoDelete?: boolean;
diff --git a/packages/microservices/index.ts b/packages/microservices/index.ts
index 886c0be72..bf44f34f7 100644
--- a/packages/microservices/index.ts
+++ b/packages/microservices/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @microservices
- * Copyright(c) 2017 - 2022 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2023 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
diff --git a/packages/microservices/interfaces/client-grpc.interface.ts b/packages/microservices/interfaces/client-grpc.interface.ts
index ebb73f466..95815ef0f 100644
--- a/packages/microservices/interfaces/client-grpc.interface.ts
+++ b/packages/microservices/interfaces/client-grpc.interface.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export interface ClientGrpc {
   getService<T extends {}>(name: string): T;
   getClientByServiceName<T = any>(name: string): T;
diff --git a/packages/microservices/interfaces/client-metadata.interface.ts b/packages/microservices/interfaces/client-metadata.interface.ts
index ace44c265..53bb8b556 100644
--- a/packages/microservices/interfaces/client-metadata.interface.ts
+++ b/packages/microservices/interfaces/client-metadata.interface.ts
@@ -12,6 +12,7 @@ import {
   RmqOptions,
 } from './microservice-configuration.interface';
 import { Serializer } from './serializer.interface';
+import { ConnectionOptions } from 'tls';
 
 export type ClientOptions =
   | RedisOptions
@@ -22,11 +23,17 @@ export type ClientOptions =
   | TcpClientOptions
   | RmqOptions;
 
+/**
+ * @publicApi
+ */
 export interface CustomClientOptions {
   customClass: Type<ClientProxy>;
   options?: Record<string, any>;
 }
 
+/**
+ * @publicApi
+ */
 export interface TcpClientOptions {
   transport: Transport.TCP;
   options?: {
@@ -34,6 +41,7 @@ export interface TcpClientOptions {
     port?: number;
     serializer?: Serializer;
     deserializer?: Deserializer;
+    tlsOptions?: ConnectionOptions;
     socketClass?: Type<TcpSocket>;
   };
 }
diff --git a/packages/microservices/interfaces/custom-transport-strategy.interface.ts b/packages/microservices/interfaces/custom-transport-strategy.interface.ts
index 358d77b97..c7b4e9e44 100644
--- a/packages/microservices/interfaces/custom-transport-strategy.interface.ts
+++ b/packages/microservices/interfaces/custom-transport-strategy.interface.ts
@@ -1,5 +1,8 @@
 import { Transport } from '../enums';
 
+/**
+ * @publicApi
+ */
 export interface CustomTransportStrategy {
   readonly transportId?: Transport | symbol;
   listen(callback: (...optionalParams: unknown[]) => any): any;
diff --git a/packages/microservices/interfaces/deserializer.interface.ts b/packages/microservices/interfaces/deserializer.interface.ts
index 69d3af4ad..d5529b697 100644
--- a/packages/microservices/interfaces/deserializer.interface.ts
+++ b/packages/microservices/interfaces/deserializer.interface.ts
@@ -4,6 +4,9 @@ import {
   IncomingResponse,
 } from './packet.interface';
 
+/**
+ * @publicApi
+ */
 export interface Deserializer<TInput = any, TOutput = any> {
   deserialize(
     value: TInput,
diff --git a/packages/microservices/interfaces/message-handler.interface.ts b/packages/microservices/interfaces/message-handler.interface.ts
index 00aecaa6e..8568262d2 100644
--- a/packages/microservices/interfaces/message-handler.interface.ts
+++ b/packages/microservices/interfaces/message-handler.interface.ts
@@ -1,5 +1,8 @@
 import { Observable } from 'rxjs';
 
+/**
+ * @publicApi
+ */
 export interface MessageHandler<TInput = any, TContext = any, TResult = any> {
   (data: TInput, ctx?: TContext):
     | Promise<Observable<TResult>>
diff --git a/packages/microservices/interfaces/microservice-configuration.interface.ts b/packages/microservices/interfaces/microservice-configuration.interface.ts
index 11e5b414e..0f2da17d5 100644
--- a/packages/microservices/interfaces/microservice-configuration.interface.ts
+++ b/packages/microservices/interfaces/microservice-configuration.interface.ts
@@ -1,10 +1,11 @@
 import { Type } from '@nestjs/common';
+import { ConnectionOptions } from 'tls';
 import { Transport } from '../enums/transport.enum';
 import { ChannelOptions } from '../external/grpc-options.interface';
 import {
   ConsumerConfig,
   ConsumerRunConfig,
-  ConsumerSubscribeTopic,
+  ConsumerSubscribeTopics,
   KafkaConfig,
   ProducerConfig,
   ProducerRecord,
@@ -27,11 +28,17 @@ export type MicroserviceOptions =
   | KafkaOptions
   | CustomStrategy;
 
+/**
+ * @publicApi
+ */
 export interface CustomStrategy {
   strategy: CustomTransportStrategy;
   options?: {};
 }
 
+/**
+ * @publicApi
+ */
 export interface GrpcOptions {
   transport?: Transport.GRPC;
   options: {
@@ -70,6 +77,9 @@ export interface GrpcOptions {
   };
 }
 
+/**
+ * @publicApi
+ */
 export interface TcpOptions {
   transport?: Transport.TCP;
   options?: {
@@ -78,11 +88,15 @@ export interface TcpOptions {
     retryAttempts?: number;
     retryDelay?: number;
     serializer?: Serializer;
+    tlsOptions?: ConnectionOptions;
     deserializer?: Deserializer;
     socketClass?: Type<TcpSocket>;
   };
 }
 
+/**
+ * @publicApi
+ */
 export interface RedisOptions {
   transport?: Transport.REDIS;
   options?: {
@@ -90,11 +104,18 @@ export interface RedisOptions {
     port?: number;
     retryAttempts?: number;
     retryDelay?: number;
+    /**
+     * Use `psubscribe`/`pmessage` to enable wildcards in the patterns
+     */
+    wildcards?: boolean;
     serializer?: Serializer;
     deserializer?: Deserializer;
   } & IORedisOptions;
 }
 
+/**
+ * @publicApi
+ */
 export interface MqttOptions {
   transport?: Transport.MQTT;
   options?: MqttClientOptions & {
@@ -123,6 +144,9 @@ export interface MqttOptions {
   };
 }
 
+/**
+ * @publicApi
+ */
 export interface NatsOptions {
   transport?: Transport.NATS;
   options?: {
@@ -167,6 +191,9 @@ export interface NatsOptions {
   };
 }
 
+/**
+ * @publicApi
+ */
 export interface RmqOptions {
   transport?: Transport.RMQ;
   options?: {
@@ -193,10 +220,16 @@ export interface RmqOptions {
   };
 }
 
+/**
+ * @publicApi
+ */
 export interface KafkaParserConfig {
   keepBinary?: boolean;
 }
 
+/**
+ * @publicApi
+ */
 export interface KafkaOptions {
   transport?: Transport.KAFKA;
   options?: {
@@ -207,7 +240,7 @@ export interface KafkaOptions {
     client?: KafkaConfig;
     consumer?: ConsumerConfig;
     run?: Omit<ConsumerRunConfig, 'eachBatch' | 'eachMessage'>;
-    subscribe?: Omit<ConsumerSubscribeTopic, 'topic'>;
+    subscribe?: Omit<ConsumerSubscribeTopics, 'topic'>;
     producer?: ProducerConfig;
     send?: Omit<ProducerRecord, 'topic' | 'messages'>;
     serializer?: Serializer;
diff --git a/packages/microservices/interfaces/microservice-entrypoint-metadata.interface.ts b/packages/microservices/interfaces/microservice-entrypoint-metadata.interface.ts
new file mode 100644
index 000000000..9993c7d77
--- /dev/null
+++ b/packages/microservices/interfaces/microservice-entrypoint-metadata.interface.ts
@@ -0,0 +1,9 @@
+import { Transport } from '../enums';
+import { PatternMetadata } from './pattern-metadata.interface';
+
+export type MicroserviceEntrypointMetadata = {
+  transportId: keyof typeof Transport | symbol;
+  patterns: PatternMetadata[];
+  isEventHandler: boolean;
+  extras?: Record<string, any>;
+};
diff --git a/packages/microservices/interfaces/serializer.interface.ts b/packages/microservices/interfaces/serializer.interface.ts
index f8d0c8c25..4c090467c 100644
--- a/packages/microservices/interfaces/serializer.interface.ts
+++ b/packages/microservices/interfaces/serializer.interface.ts
@@ -4,6 +4,9 @@ import {
   OutgoingResponse,
 } from './packet.interface';
 
+/**
+ * @publicApi
+ */
 export interface Serializer<TInput = any, TOutput = any> {
   serialize(value: TInput, options?: Record<string, any>): TOutput;
 }
diff --git a/packages/microservices/listener-metadata-explorer.ts b/packages/microservices/listener-metadata-explorer.ts
index 66ddffaf0..faa98b71b 100644
--- a/packages/microservices/listener-metadata-explorer.ts
+++ b/packages/microservices/listener-metadata-explorer.ts
@@ -4,15 +4,14 @@ import { MetadataScanner } from '@nestjs/core/metadata-scanner';
 import {
   CLIENT_CONFIGURATION_METADATA,
   CLIENT_METADATA,
+  PATTERN_EXTRAS_METADATA,
   PATTERN_HANDLER_METADATA,
   PATTERN_METADATA,
   TRANSPORT_METADATA,
-  PATTERN_EXTRAS_METADATA,
 } from './constants';
 import { Transport } from './enums';
 import { PatternHandler } from './enums/pattern-handler.enum';
-import { ClientOptions } from './interfaces/client-metadata.interface';
-import { PatternMetadata } from './interfaces/pattern-metadata.interface';
+import { ClientOptions, PatternMetadata } from './interfaces';
 
 export interface ClientProperties {
   property: string;
@@ -38,12 +37,10 @@ export class ListenerMetadataExplorer {
 
   public explore(instance: Controller): EventOrMessageListenerDefinition[] {
     const instancePrototype = Object.getPrototypeOf(instance);
-    return this.metadataScanner.scanFromPrototype<
-      Controller,
-      EventOrMessageListenerDefinition
-    >(instance, instancePrototype, method =>
-      this.exploreMethodMetadata(instancePrototype, method),
-    );
+    return this.metadataScanner
+      .getAllMethodNames(instancePrototype)
+      .map(method => this.exploreMethodMetadata(instancePrototype, method))
+      .filter(metadata => metadata);
   }
 
   public exploreMethodMetadata(
diff --git a/packages/microservices/listeners-controller.ts b/packages/microservices/listeners-controller.ts
index 12119790f..cba398269 100644
--- a/packages/microservices/listeners-controller.ts
+++ b/packages/microservices/listeners-controller.ts
@@ -11,9 +11,18 @@ import {
   InstanceWrapper,
 } from '@nestjs/core/injector/instance-wrapper';
 import { Module } from '@nestjs/core/injector/module';
+import { GraphInspector } from '@nestjs/core/inspector/graph-inspector';
 import { MetadataScanner } from '@nestjs/core/metadata-scanner';
 import { REQUEST_CONTEXT_ID } from '@nestjs/core/router/request/request-constants';
-import { connectable, Observable, Subject } from 'rxjs';
+import {
+  forkJoin,
+  from as fromPromise,
+  isObservable,
+  mergeMap,
+  Observable,
+  ObservedValueOf,
+  of,
+} from 'rxjs';
 import { IClientProxyFactory } from './client/client-proxy-factory';
 import { ClientsContainer } from './container';
 import { ExceptionFiltersContext } from './context/exception-filters-context';
@@ -24,13 +33,18 @@ import {
   DEFAULT_GRPC_CALLBACK_METADATA,
 } from './context/rpc-metadata-constants';
 import { BaseRpcContext } from './ctx-host/base-rpc.context';
+import { Transport } from './enums';
 import {
   CustomTransportStrategy,
   MessageHandler,
   PatternMetadata,
   RequestContext,
 } from './interfaces';
-import { ListenerMetadataExplorer } from './listener-metadata-explorer';
+import { MicroserviceEntrypointMetadata } from './interfaces/microservice-entrypoint-metadata.interface';
+import {
+  EventOrMessageListenerDefinition,
+  ListenerMetadataExplorer,
+} from './listener-metadata-explorer';
 import { ServerGrpc } from './server';
 import { Server } from './server/server';
 
@@ -47,6 +61,7 @@ export class ListenersController {
     private readonly injector: Injector,
     private readonly clientFactory: IClientProxyFactory,
     private readonly exceptionFiltersContext: ExceptionFiltersContext,
+    private readonly graphInspector: GraphInspector,
   ) {}
 
   public registerPatternHandlers(
@@ -72,67 +87,114 @@ export class ListenersController {
           transport === server.transportId,
       )
       .reduce((acc, handler) => {
-        // Optional chaining for backward-compatibility
-        handler.patterns?.forEach(pattern =>
+        handler.patterns.forEach(pattern =>
           acc.push({ ...handler, patterns: [pattern] }),
         );
         return acc;
       }, [])
-      .forEach(
-        ({
+      .forEach((definition: EventOrMessageListenerDefinition) => {
+        const {
           patterns: [pattern],
           targetCallback,
           methodKey,
           extras,
           isEventHandler,
-        }) => {
-          if (isStatic) {
-            const proxy = this.contextCreator.create(
-              instance as object,
-              targetCallback,
-              moduleKey,
-              methodKey,
-              STATIC_CONTEXT,
-              undefined,
-              defaultCallMetadata,
-            );
-            if (isEventHandler) {
-              const eventHandler: MessageHandler = (...args: unknown[]) => {
-                const originalArgs = args;
-                const [dataOrContextHost] = originalArgs;
-                if (dataOrContextHost instanceof RequestContextHost) {
-                  args = args.slice(1, args.length);
-                }
-                const originalReturnValue = proxy(...args);
-                const returnedValueWrapper = eventHandler.next?.(
-                  ...(originalArgs as Parameters<MessageHandler>),
-                );
-                returnedValueWrapper?.then(returnedValue =>
-                  this.connectIfStream(returnedValue as Observable<unknown>),
-                );
-                return originalReturnValue;
-              };
-              return server.addHandler(
-                pattern,
-                eventHandler,
-                isEventHandler,
-                extras,
-              );
-            } else {
-              return server.addHandler(pattern, proxy, isEventHandler, extras);
-            }
-          }
-          const asyncHandler = this.createRequestScopedHandler(
-            instanceWrapper,
-            pattern,
-            moduleRef,
+        } = definition;
+
+        this.insertEntrypointDefinition(
+          instanceWrapper,
+          definition,
+          server.transportId,
+        );
+
+        if (isStatic) {
+          const proxy = this.contextCreator.create(
+            instance as object,
+            targetCallback,
             moduleKey,
             methodKey,
+            STATIC_CONTEXT,
+            undefined,
             defaultCallMetadata,
           );
-          server.addHandler(pattern, asyncHandler, isEventHandler, extras);
+          if (isEventHandler) {
+            const eventHandler: MessageHandler = async (...args: unknown[]) => {
+              const originalArgs = args;
+              const [dataOrContextHost] = originalArgs;
+              if (dataOrContextHost instanceof RequestContextHost) {
+                args = args.slice(1, args.length);
+              }
+              const returnValue = proxy(...args);
+              return this.forkJoinHandlersIfAttached(
+                returnValue,
+                originalArgs,
+                eventHandler,
+              );
+            };
+            return server.addHandler(
+              pattern,
+              eventHandler,
+              isEventHandler,
+              extras,
+            );
+          } else {
+            return server.addHandler(pattern, proxy, isEventHandler, extras);
+          }
+        }
+        const asyncHandler = this.createRequestScopedHandler(
+          instanceWrapper,
+          pattern,
+          moduleRef,
+          moduleKey,
+          methodKey,
+          defaultCallMetadata,
+          isEventHandler,
+        );
+        server.addHandler(pattern, asyncHandler, isEventHandler, extras);
+      });
+  }
+
+  public insertEntrypointDefinition(
+    instanceWrapper: InstanceWrapper,
+    definition: EventOrMessageListenerDefinition,
+    transportId: Transport | symbol,
+  ) {
+    this.graphInspector.insertEntrypointDefinition<MicroserviceEntrypointMetadata>(
+      {
+        type: 'microservice',
+        methodName: definition.methodKey,
+        className: instanceWrapper.metatype?.name,
+        classNodeId: instanceWrapper.id,
+        metadata: {
+          key: definition.patterns.toString(),
+          transportId:
+            typeof transportId === 'number'
+              ? (Transport[transportId] as keyof typeof Transport)
+              : transportId,
+          patterns: definition.patterns,
+          isEventHandler: definition.isEventHandler,
+          extras: definition.extras,
         },
+      },
+      instanceWrapper.id,
+    );
+  }
+
+  public forkJoinHandlersIfAttached(
+    currentReturnValue: Promise<unknown> | Observable<unknown>,
+    originalArgs: unknown[],
+    handlerRef: MessageHandler,
+  ) {
+    if (handlerRef.next) {
+      const returnedValueWrapper = handlerRef.next(
+        ...(originalArgs as Parameters<MessageHandler>),
       );
+      return forkJoin({
+        current: this.transformToObservable(currentReturnValue),
+        next: this.transformToObservable(returnedValueWrapper),
+      });
+    }
+    return currentReturnValue;
   }
 
   public assignClientsToProperties(instance: Controller | Injectable) {
@@ -162,17 +224,20 @@ export class ListenersController {
     moduleKey: string,
     methodKey: string,
     defaultCallMetadata: Record<string, any> = DEFAULT_CALLBACK_METADATA,
+    isEventHandler = false,
   ) {
     const collection = moduleRef.controllers;
     const { instance } = wrapper;
 
+    const isTreeDurable = wrapper.isDependencyTreeDurable();
+
     const requestScopedHandler: MessageHandler = async (...args: unknown[]) => {
       try {
         let contextId: ContextId;
 
         let [dataOrContextHost] = args;
         if (dataOrContextHost instanceof RequestContextHost) {
-          contextId = this.getContextId(dataOrContextHost);
+          contextId = this.getContextId(dataOrContextHost, isTreeDurable);
           args.shift();
         } else {
           const [data, reqCtx] = args;
@@ -181,13 +246,10 @@ export class ListenersController {
             data,
             reqCtx as BaseRpcContext,
           );
-          contextId = this.getContextId(request);
-          this.container.registerRequestProvider(
-            contextId.getParent ? contextId.payload : request,
-            contextId,
-          );
+          contextId = this.getContextId(request, isTreeDurable);
           dataOrContextHost = request;
         }
+
         const contextInstance = await this.injector.loadPerContext(
           instance,
           moduleRef,
@@ -203,14 +265,16 @@ export class ListenersController {
           wrapper.id,
           defaultCallMetadata,
         );
-        const returnedValueWrapper = requestScopedHandler.next?.(
-          dataOrContextHost,
-          ...args,
-        );
-        returnedValueWrapper?.then(returnedValue =>
-          this.connectIfStream(returnedValue as Observable<unknown>),
-        );
-        return proxy(...args);
+
+        const returnValue = proxy(...args);
+        if (isEventHandler) {
+          return this.forkJoinHandlersIfAttached(
+            returnValue,
+            [dataOrContextHost, ...args],
+            requestScopedHandler,
+          );
+        }
+        return returnValue;
       } catch (err) {
         let exceptionFilter = this.exceptionFiltersCache.get(
           instance[methodKey],
@@ -231,7 +295,10 @@ export class ListenersController {
     return requestScopedHandler;
   }
 
-  private getContextId<T extends RequestContext = any>(request: T): ContextId {
+  private getContextId<T extends RequestContext = any>(
+    request: T,
+    isTreeDurable: boolean,
+  ): ContextId {
     const contextId = ContextIdFactory.getByRequest(request);
     if (!request[REQUEST_CONTEXT_ID as any]) {
       Object.defineProperty(request, REQUEST_CONTEXT_ID, {
@@ -240,22 +307,32 @@ export class ListenersController {
         writable: false,
         configurable: false,
       });
-      this.container.registerRequestProvider(
-        contextId.getParent ? contextId.payload : request,
-        contextId,
-      );
+
+      const requestProviderValue = isTreeDurable ? contextId.payload : request;
+      this.container.registerRequestProvider(requestProviderValue, contextId);
     }
     return contextId;
   }
 
-  private connectIfStream(source: Observable<unknown>) {
-    if (!source) {
-      return;
+  public transformToObservable<T>(
+    resultOrDeferred: Observable<T> | Promise<T>,
+  ): Observable<T>;
+  public transformToObservable<T>(
+    resultOrDeferred: T,
+  ): never extends Observable<ObservedValueOf<T>>
+    ? Observable<T>
+    : Observable<ObservedValueOf<T>>;
+  public transformToObservable(resultOrDeferred: any) {
+    if (resultOrDeferred instanceof Promise) {
+      return fromPromise(resultOrDeferred).pipe(
+        mergeMap(val => (isObservable(val) ? val : of(val))),
+      );
     }
-    const connectableSource = connectable(source, {
-      connector: () => new Subject(),
-      resetOnDisconnect: false,
-    });
-    connectableSource.connect();
+
+    if (isObservable(resultOrDeferred)) {
+      return resultOrDeferred;
+    }
+
+    return of(resultOrDeferred);
   }
 }
diff --git a/packages/microservices/microservices-module.ts b/packages/microservices/microservices-module.ts
index 54632e412..3dbda4464 100644
--- a/packages/microservices/microservices-module.ts
+++ b/packages/microservices/microservices-module.ts
@@ -1,15 +1,17 @@
 import { Controller } from '@nestjs/common/interfaces/controllers/controller.interface';
+import { NestApplicationContextOptions } from '@nestjs/common/interfaces/nest-application-context-options.interface';
 import { ApplicationConfig } from '@nestjs/core/application-config';
 import { RuntimeException } from '@nestjs/core/errors/exceptions/runtime.exception';
-import { GuardsConsumer } from '@nestjs/core/guards/guards-consumer';
-import { GuardsContextCreator } from '@nestjs/core/guards/guards-context-creator';
+import { GuardsConsumer, GuardsContextCreator } from '@nestjs/core/guards';
 import { NestContainer } from '@nestjs/core/injector/container';
 import { Injector } from '@nestjs/core/injector/injector';
 import { InstanceWrapper } from '@nestjs/core/injector/instance-wrapper';
-import { InterceptorsConsumer } from '@nestjs/core/interceptors/interceptors-consumer';
-import { InterceptorsContextCreator } from '@nestjs/core/interceptors/interceptors-context-creator';
-import { PipesConsumer } from '@nestjs/core/pipes/pipes-consumer';
-import { PipesContextCreator } from '@nestjs/core/pipes/pipes-context-creator';
+import { GraphInspector } from '@nestjs/core/inspector/graph-inspector';
+import {
+  InterceptorsConsumer,
+  InterceptorsContextCreator,
+} from '@nestjs/core/interceptors';
+import { PipesConsumer, PipesContextCreator } from '@nestjs/core/pipes';
 import { ClientProxyFactory } from './client';
 import { ClientsContainer } from './container';
 import { ExceptionFiltersContext } from './context/exception-filters-context';
@@ -19,11 +21,20 @@ import { CustomTransportStrategy } from './interfaces';
 import { ListenersController } from './listeners-controller';
 import { Server } from './server/server';
 
-export class MicroservicesModule {
+export class MicroservicesModule<
+  TAppOptions extends NestApplicationContextOptions = NestApplicationContextOptions,
+> {
   private readonly clientsContainer = new ClientsContainer();
   private listenersController: ListenersController;
+  private appOptions: TAppOptions;
 
-  public register(container: NestContainer, config: ApplicationConfig) {
+  public register(
+    container: NestContainer,
+    graphInspector: GraphInspector,
+    config: ApplicationConfig,
+    options: TAppOptions,
+  ) {
+    this.appOptions = options;
     const exceptionFiltersContext = new ExceptionFiltersContext(
       container,
       config,
@@ -47,6 +58,7 @@ export class MicroservicesModule {
       injector,
       ClientProxyFactory,
       exceptionFiltersContext,
+      graphInspector,
     );
   }
 
@@ -67,6 +79,9 @@ export class MicroservicesModule {
     if (!this.listenersController) {
       throw new RuntimeException();
     }
+    if (this.appOptions?.preview) {
+      return;
+    }
     const modules = container.getModules();
     modules.forEach(({ controllers, providers }) => {
       this.bindClients(controllers);
diff --git a/packages/microservices/nest-microservice.ts b/packages/microservices/nest-microservice.ts
index 3455f3acb..7b0930e69 100644
--- a/packages/microservices/nest-microservice.ts
+++ b/packages/microservices/nest-microservice.ts
@@ -12,6 +12,8 @@ import { ApplicationConfig } from '@nestjs/core/application-config';
 import { MESSAGES } from '@nestjs/core/constants';
 import { optionalRequire } from '@nestjs/core/helpers/optional-require';
 import { NestContainer } from '@nestjs/core/injector/container';
+import { Injector } from '@nestjs/core/injector/injector';
+import { GraphInspector } from '@nestjs/core/inspector/graph-inspector';
 import { NestApplicationContext } from '@nestjs/core/nest-application-context';
 import { Transport } from './enums/transport.enum';
 import { CustomTransportStrategy } from './interfaces/custom-transport-strategy.interface';
@@ -26,10 +28,10 @@ const { SocketModule } = optionalRequire(
 );
 
 export class NestMicroservice
-  extends NestApplicationContext
+  extends NestApplicationContext<NestMicroserviceOptions>
   implements INestMicroservice
 {
-  private readonly logger = new Logger(NestMicroservice.name, {
+  protected readonly logger = new Logger(NestMicroservice.name, {
     timestamp: true,
   });
   private readonly microservicesModule = new MicroservicesModule();
@@ -42,11 +44,18 @@ export class NestMicroservice
   constructor(
     container: NestContainer,
     config: NestMicroserviceOptions & MicroserviceOptions = {},
+    private readonly graphInspector: GraphInspector,
     private readonly applicationConfig: ApplicationConfig,
   ) {
-    super(container);
-
-    this.microservicesModule.register(container, this.applicationConfig);
+    super(container, config);
+
+    this.injector = new Injector({ preview: config.preview });
+    this.microservicesModule.register(
+      container,
+      this.graphInspector,
+      this.applicationConfig,
+      this.appOptions,
+    );
     this.createServer(config);
     this.selectContextModule();
   }
@@ -69,10 +78,18 @@ export class NestMicroservice
 
   public async registerModules(): Promise<any> {
     this.socketModule &&
-      this.socketModule.register(this.container, this.applicationConfig);
-    this.microservicesModule.setupClients(this.container);
+      this.socketModule.register(
+        this.container,
+        this.applicationConfig,
+        this.graphInspector,
+        this.appOptions,
+      );
+
+    if (!this.appOptions.preview) {
+      this.microservicesModule.setupClients(this.container);
+      this.registerListeners();
+    }
 
-    this.registerListeners();
     this.setIsInitialized(true);
 
     if (!this.isInitHookCalled) {
@@ -92,21 +109,45 @@ export class NestMicroservice
 
   public useGlobalFilters(...filters: ExceptionFilter[]): this {
     this.applicationConfig.useGlobalFilters(...filters);
+    filters.forEach(item =>
+      this.graphInspector.insertOrphanedEnhancer({
+        subtype: 'filter',
+        ref: item,
+      }),
+    );
     return this;
   }
 
   public useGlobalPipes(...pipes: PipeTransform<any>[]): this {
     this.applicationConfig.useGlobalPipes(...pipes);
+    pipes.forEach(item =>
+      this.graphInspector.insertOrphanedEnhancer({
+        subtype: 'pipe',
+        ref: item,
+      }),
+    );
     return this;
   }
 
   public useGlobalInterceptors(...interceptors: NestInterceptor[]): this {
     this.applicationConfig.useGlobalInterceptors(...interceptors);
+    interceptors.forEach(item =>
+      this.graphInspector.insertOrphanedEnhancer({
+        subtype: 'interceptor',
+        ref: item,
+      }),
+    );
     return this;
   }
 
   public useGlobalGuards(...guards: CanActivate[]): this {
     this.applicationConfig.useGlobalGuards(...guards);
+    guards.forEach(item =>
+      this.graphInspector.insertOrphanedEnhancer({
+        subtype: 'guard',
+        ref: item,
+      }),
+    );
     return this;
   }
 
@@ -120,6 +161,7 @@ export class NestMicroservice
   }
 
   public async listen() {
+    this.assertNotInPreviewMode('listen');
     !this.isInitialized && (await this.registerModules());
 
     return new Promise<any>((resolve, reject) => {
diff --git a/packages/microservices/package.json b/packages/microservices/package.json
index bd3cbd239..994bf9dc0 100644
--- a/packages/microservices/package.json
+++ b/packages/microservices/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/microservices",
-  "version": "9.2.0",
+  "version": "9.4.0",
   "description": "Nest - modern, fast, powerful node.js web framework (@microservices)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -18,11 +18,11 @@
   },
   "dependencies": {
     "iterare": "1.2.1",
-    "tslib": "2.4.1"
+    "tslib": "2.5.0"
   },
   "devDependencies": {
-    "@nestjs/common": "9.2.0",
-    "@nestjs/core": "9.2.0"
+    "@nestjs/common": "9.4.0",
+    "@nestjs/core": "9.4.0"
   },
   "peerDependencies": {
     "@grpc/grpc-js": "*",
diff --git a/packages/microservices/serializers/kafka-request.serializer.ts b/packages/microservices/serializers/kafka-request.serializer.ts
index 732275497..7c519c458 100644
--- a/packages/microservices/serializers/kafka-request.serializer.ts
+++ b/packages/microservices/serializers/kafka-request.serializer.ts
@@ -13,6 +13,9 @@ export interface KafkaRequest<T = any> {
   headers: Record<string, any>;
 }
 
+/**
+ * @publicApi
+ */
 export class KafkaRequestSerializer
   implements Serializer<any, KafkaRequest | Promise<KafkaRequest>>
 {
diff --git a/packages/microservices/server/server-kafka.ts b/packages/microservices/server/server-kafka.ts
index 7ac52f9fa..292cbb384 100644
--- a/packages/microservices/server/server-kafka.ts
+++ b/packages/microservices/server/server-kafka.ts
@@ -191,7 +191,7 @@ export class ServerKafka extends Server implements CustomTransportStrategy {
     }
 
     const response$ = this.transformToObservable(
-      await handler(packet.data, kafkaContext),
+      handler(packet.data, kafkaContext),
     );
 
     const replayStream$ = new ReplaySubject();
@@ -218,6 +218,8 @@ export class ServerKafka extends Server implements CustomTransportStrategy {
           if (err instanceof KafkaRetriableException && !isPromiseResolved) {
             isPromiseResolved = true;
             reject(err);
+          } else {
+            resolve();
           }
           replayStream$.error(err);
         },
diff --git a/packages/microservices/server/server-nats.ts b/packages/microservices/server/server-nats.ts
index 768fe3664..73206ee77 100644
--- a/packages/microservices/server/server-nats.ts
+++ b/packages/microservices/server/server-nats.ts
@@ -1,5 +1,4 @@
 import { isUndefined, isObject } from '@nestjs/common/utils/shared.utils';
-import { Observable } from 'rxjs';
 import { NATS_DEFAULT_URL, NO_MESSAGE_HANDLER } from '../constants';
 import { NatsContext } from '../ctx-host/nats.context';
 import { NatsRequestJSONDeserializer } from '../deserializers/nats-request-json.deserializer';
@@ -137,17 +136,28 @@ export class ServerNats extends Server implements CustomTransportStrategy {
         status.data && isObject(status.data)
           ? JSON.stringify(status.data)
           : status.data;
-      if (status.type === 'disconnect' || status.type === 'error') {
-        this.logger.error(
-          `NatsError: type: "${status.type}", data: "${data}".`,
-        );
-      } else {
-        const message = `NatsStatus: type: "${status.type}", data: "${data}".`;
-        if (status.type === 'pingTimer') {
-          this.logger.debug(message);
-        } else {
-          this.logger.log(message);
-        }
+
+      switch (status.type) {
+        case 'error':
+        case 'disconnect':
+          this.logger.error(
+            `NatsError: type: "${status.type}", data: "${data}".`,
+          );
+          break;
+
+        case 'pingTimer':
+          if (this.options.debug) {
+            this.logger.debug(
+              `NatsStatus: type: "${status.type}", data: "${data}".`,
+            );
+          }
+          break;
+
+        default:
+          this.logger.log(
+            `NatsStatus: type: "${status.type}", data: "${data}".`,
+          );
+          break;
       }
     }
   }
diff --git a/packages/microservices/server/server-redis.ts b/packages/microservices/server/server-redis.ts
index 6e5530165..09c619f13 100644
--- a/packages/microservices/server/server-redis.ts
+++ b/packages/microservices/server/server-redis.ts
@@ -1,5 +1,4 @@
 import { isUndefined } from '@nestjs/common/utils/shared.utils';
-import { Observable } from 'rxjs';
 import {
   ERROR_EVENT,
   MESSAGE_EVENT,
@@ -64,13 +63,23 @@ export class ServerRedis extends Server implements CustomTransportStrategy {
   }
 
   public bindEvents(subClient: Redis, pubClient: Redis) {
-    subClient.on(MESSAGE_EVENT, this.getMessageHandler(pubClient).bind(this));
+    subClient.on(
+      this.options.wildcards ? 'pmessage' : MESSAGE_EVENT,
+      this.getMessageHandler(pubClient).bind(this),
+    );
     const subscribePatterns = [...this.messageHandlers.keys()];
     subscribePatterns.forEach(pattern => {
       const { isEventHandler } = this.messageHandlers.get(pattern);
-      subClient.subscribe(
-        isEventHandler ? pattern : this.getRequestPattern(pattern),
-      );
+
+      const channel = isEventHandler
+        ? pattern
+        : this.getRequestPattern(pattern);
+
+      if (this.options.wildcards) {
+        subClient.psubscribe(channel);
+      } else {
+        subClient.subscribe(channel);
+      }
     });
   }
 
@@ -90,18 +99,22 @@ export class ServerRedis extends Server implements CustomTransportStrategy {
   }
 
   public getMessageHandler(pub: Redis) {
-    return async (channel: string, buffer: string | any) =>
-      this.handleMessage(channel, buffer, pub);
+    return this.options.wildcards
+      ? (channel: string, pattern: string, buffer: string | any) =>
+          this.handleMessage(channel, buffer, pub, pattern)
+      : (channel: string, buffer: string | any) =>
+          this.handleMessage(channel, buffer, pub, channel);
   }
 
   public async handleMessage(
     channel: string,
     buffer: string | any,
     pub: Redis,
+    pattern: string,
   ) {
     const rawMessage = this.parseMessage(buffer);
     const packet = await this.deserializer.deserialize(rawMessage, { channel });
-    const redisCtx = new RedisContext([channel]);
+    const redisCtx = new RedisContext([pattern]);
 
     if (isUndefined((packet as IncomingRequest).id)) {
       return this.handleEvent(channel, packet, redisCtx);
diff --git a/packages/microservices/server/server-tcp.ts b/packages/microservices/server/server-tcp.ts
index bffeb158a..655fcd003 100644
--- a/packages/microservices/server/server-tcp.ts
+++ b/packages/microservices/server/server-tcp.ts
@@ -15,6 +15,7 @@ import {
 import { TcpContext } from '../ctx-host/tcp.context';
 import { Transport } from '../enums';
 import { JsonSocket, TcpSocket } from '../helpers';
+import { createServer as tlsCreateServer } from 'tls';
 import {
   CustomTransportStrategy,
   IncomingRequest,
@@ -35,6 +36,7 @@ export class ServerTCP extends Server implements CustomTransportStrategy {
   private readonly socketClass: Type<TcpSocket>;
   private isExplicitlyTerminated = false;
   private retryAttemptsCount = 0;
+  private tlsOptions?;
 
   constructor(private readonly options: TcpOptions['options']) {
     super();
@@ -42,6 +44,7 @@ export class ServerTCP extends Server implements CustomTransportStrategy {
     this.host = this.getOptionsProp(options, 'host') || TCP_DEFAULT_HOST;
     this.socketClass =
       this.getOptionsProp(options, 'socketClass') || JsonSocket;
+    this.tlsOptions = this.getOptionsProp(options, 'tlsOptions');
 
     this.init();
     this.initializeSerializer(options);
@@ -124,7 +127,16 @@ export class ServerTCP extends Server implements CustomTransportStrategy {
   }
 
   private init() {
-    this.server = net.createServer(this.bindHandler.bind(this));
+    if (this.tlsOptions) {
+      // TLS enabled, use tls server
+      this.server = tlsCreateServer(
+        this.tlsOptions,
+        this.bindHandler.bind(this),
+      );
+    } else {
+      // TLS disabled, use net server
+      this.server = net.createServer(this.bindHandler.bind(this));
+    }
     this.server.on(ERROR_EVENT, this.handleError.bind(this));
     this.server.on(CLOSE_EVENT, this.handleClose.bind(this));
   }
diff --git a/packages/microservices/server/server.ts b/packages/microservices/server/server.ts
index 4e8ee9bf6..8a88a1296 100644
--- a/packages/microservices/server/server.ts
+++ b/packages/microservices/server/server.ts
@@ -11,7 +11,7 @@ import {
   Subject,
   Subscription,
 } from 'rxjs';
-import { catchError, finalize } from 'rxjs/operators';
+import { catchError, finalize, mergeMap } from 'rxjs/operators';
 import { NO_EVENT_HANDLER } from '../constants';
 import { BaseRpcContext } from '../ctx-host/base-rpc.context';
 import { IncomingRequestDeserializer } from '../deserializers/incoming-request.deserializer';
@@ -133,7 +133,9 @@ export abstract class Server {
     : Observable<ObservedValueOf<T>>;
   public transformToObservable(resultOrDeferred: any) {
     if (resultOrDeferred instanceof Promise) {
-      return fromPromise(resultOrDeferred);
+      return fromPromise(resultOrDeferred).pipe(
+        mergeMap(val => (isObservable(val) ? val : of(val))),
+      );
     }
 
     if (isObservable(resultOrDeferred)) {
diff --git a/packages/microservices/test/client/client-grpc.spec.ts b/packages/microservices/test/client/client-grpc.spec.ts
index 6d38e5941..83699cdc2 100644
--- a/packages/microservices/test/client/client-grpc.spec.ts
+++ b/packages/microservices/test/client/client-grpc.spec.ts
@@ -351,13 +351,13 @@ describe('ClientGrpcProxy', () => {
 
         const stream$ = client.createUnaryServiceMethod(obj, methodName)();
 
-        const subsciption = stream$.subscribe({
+        const subscription = stream$.subscribe({
           next: dataSpy,
           error: errorSpy,
           complete: completeSpy,
         });
 
-        subsciption.unsubscribe();
+        subscription.unsubscribe();
         handler(null, 'a');
 
         expect(dataSpy.called).to.be.false;
diff --git a/packages/microservices/test/client/client-kafka.spec.ts b/packages/microservices/test/client/client-kafka.spec.ts
index 39743da52..4bc9e6eca 100644
--- a/packages/microservices/test/client/client-kafka.spec.ts
+++ b/packages/microservices/test/client/client-kafka.spec.ts
@@ -11,7 +11,6 @@ import {
 } from '../../external/kafka.interface';
 
 describe('ClientKafka', () => {
-  // static
   const topic = 'test.topic';
   const partition = 0;
   const replyTopic = 'test.topic.reply';
@@ -25,7 +24,6 @@ describe('ClientKafka', () => {
   const heartbeat = async () => {};
   const pause = () => () => {};
 
-  // message
   const message: KafkaMessage = {
     key: Buffer.from(key),
     offset,
@@ -35,7 +33,6 @@ describe('ClientKafka', () => {
     attributes,
   };
 
-  // deserialized message
   const deserializedMessage: any = {
     key,
     offset,
@@ -47,7 +44,6 @@ describe('ClientKafka', () => {
     partition,
   };
 
-  // payloads
   const payload: EachMessagePayload = {
     topic,
     partition,
@@ -152,26 +148,6 @@ describe('ClientKafka', () => {
     pause,
   };
 
-  const deserializedPayloadError: EachMessagePayload = {
-    topic,
-    partition,
-    message: Object.assign(
-      {
-        headers: {
-          [KafkaHeaders.CORRELATION_ID]: correlationId,
-          [KafkaHeaders.NEST_ERR]: NO_MESSAGE_HANDLER,
-        },
-      },
-      deserializedMessage,
-      {
-        size: 0,
-        value: null,
-      },
-    ),
-    heartbeat,
-    pause,
-  };
-
   let client: ClientKafka;
   let callback: sinon.SinonSpy;
   let connect: sinon.SinonSpy;
@@ -182,7 +158,7 @@ describe('ClientKafka', () => {
   let consumerStub: sinon.SinonStub;
   let producerStub: sinon.SinonStub;
   let createClientStub: sinon.SinonStub;
-  let kafkaClient;
+  let kafkaClient: any;
 
   beforeEach(() => {
     client = new ClientKafka({});
@@ -322,7 +298,8 @@ describe('ClientKafka', () => {
       });
 
       it('should expect the connection to be reused', async () => {
-        (client as any).client = kafkaClient;
+        (client as any).initialized = Promise.resolve({});
+
         await client.connect();
 
         expect(createClientStub.calledOnce).to.be.false;
@@ -368,7 +345,8 @@ describe('ClientKafka', () => {
       });
 
       it('should expect the connection to be reused', async () => {
-        (client as any).client = kafkaClient;
+        (client as any).initialized = Promise.resolve({});
+
         await client.connect();
 
         expect(createClientStub.calledOnce).to.be.false;
diff --git a/packages/microservices/test/client/client-rmq.spec.ts b/packages/microservices/test/client/client-rmq.spec.ts
index 2c764b57f..6b1533d66 100644
--- a/packages/microservices/test/client/client-rmq.spec.ts
+++ b/packages/microservices/test/client/client-rmq.spec.ts
@@ -15,7 +15,6 @@ describe('ClientRMQ', function () {
     let createClientStub: sinon.SinonStub;
     let handleErrorsSpy: sinon.SinonSpy;
     let connect$Stub: sinon.SinonStub;
-    let mergeDisconnectEvent: sinon.SinonStub;
 
     beforeEach(async () => {
       client = new ClientRMQ({});
@@ -33,7 +32,7 @@ describe('ClientRMQ', function () {
           return this;
         },
       }));
-      mergeDisconnectEvent = sinon
+      sinon
         .stub(client, 'mergeDisconnectEvent')
         .callsFake((_, source) => source);
     });
@@ -173,7 +172,7 @@ describe('ClientRMQ', function () {
     const pattern = 'test';
     let msg: ReadPacket;
     let connectSpy: sinon.SinonSpy,
-      sendToQueueSpy: sinon.SinonSpy,
+      sendToQueueStub: sinon.SinonStub,
       eventSpy: sinon.SinonSpy;
 
     beforeEach(() => {
@@ -181,10 +180,10 @@ describe('ClientRMQ', function () {
       msg = { pattern, data: 'data' };
       connectSpy = sinon.spy(client, 'connect');
       eventSpy = sinon.spy();
-      sendToQueueSpy = sinon.spy();
+      sendToQueueStub = sinon.stub().callsFake(() => ({ catch: sinon.spy() }));
 
       client['channel'] = {
-        sendToQueue: sendToQueueSpy,
+        sendToQueue: sendToQueueStub,
       };
       client['responseEmitter'] = new EventEmitter();
       client['responseEmitter'].on(pattern, eventSpy);
@@ -196,15 +195,15 @@ describe('ClientRMQ', function () {
 
     it('should send message to a proper queue', () => {
       client['publish'](msg, () => {
-        expect(sendToQueueSpy.called).to.be.true;
-        expect(sendToQueueSpy.getCall(0).args[0]).to.be.eql(client['queue']);
+        expect(sendToQueueStub.called).to.be.true;
+        expect(sendToQueueStub.getCall(0).args[0]).to.be.eql(client['queue']);
       });
     });
 
     it('should send buffer from stringified message', () => {
       client['publish'](msg, () => {
-        expect(sendToQueueSpy.called).to.be.true;
-        expect(sendToQueueSpy.getCall(1).args[1]).to.be.eql(
+        expect(sendToQueueStub.called).to.be.true;
+        expect(sendToQueueStub.getCall(1).args[1]).to.be.eql(
           Buffer.from(JSON.stringify(msg)),
         );
       });
@@ -231,7 +230,7 @@ describe('ClientRMQ', function () {
     describe('headers', () => {
       it('should not generate headers if none are configured', () => {
         client['publish'](msg, () => {
-          expect(sendToQueueSpy.getCall(0).args[2].headers).to.be.undefined;
+          expect(sendToQueueStub.getCall(0).args[2].headers).to.be.undefined;
         });
       });
 
@@ -240,7 +239,7 @@ describe('ClientRMQ', function () {
         msg.data = new RmqRecord('data', { headers: requestHeaders });
 
         client['publish'](msg, () => {
-          expect(sendToQueueSpy.getCall(0).args[2].headers).to.eql(
+          expect(sendToQueueStub.getCall(0).args[2].headers).to.eql(
             requestHeaders,
           );
         });
@@ -254,7 +253,7 @@ describe('ClientRMQ', function () {
         msg.data = new RmqRecord('data', { headers: requestHeaders });
 
         client['publish'](msg, () => {
-          expect(sendToQueueSpy.getCall(0).args[2].headers).to.eql({
+          expect(sendToQueueStub.getCall(0).args[2].headers).to.eql({
             ...staticHeaders,
             ...requestHeaders,
           });
@@ -269,7 +268,7 @@ describe('ClientRMQ', function () {
         msg.data = new RmqRecord('data', { headers: requestHeaders });
 
         client['publish'](msg, () => {
-          expect(sendToQueueSpy.getCall(0).args[2].headers).to.eql(
+          expect(sendToQueueStub.getCall(0).args[2].headers).to.eql(
             requestHeaders,
           );
         });
diff --git a/packages/microservices/test/client/client-tcp.spec.ts b/packages/microservices/test/client/client-tcp.spec.ts
index 1a5c1617e..d3b36c172 100644
--- a/packages/microservices/test/client/client-tcp.spec.ts
+++ b/packages/microservices/test/client/client-tcp.spec.ts
@@ -1,5 +1,7 @@
 import { expect } from 'chai';
 import * as sinon from 'sinon';
+import { TLSSocket } from 'tls';
+import { Socket as NetSocket } from 'net';
 import { ClientTCP } from '../../client/client-tcp';
 import { ERROR_EVENT } from '../../constants';
 
@@ -214,4 +216,17 @@ describe('ClientTCP', () => {
       expect(sendMessageStub.called).to.be.true;
     });
   });
+
+  describe('tls', () => {
+    it('should upgrade to TLS', () => {
+      const client = new ClientTCP({ tlsOptions: {} });
+      console.log(client);
+      const jsonSocket = client.createSocket();
+      expect(jsonSocket.socket).instanceOf(TLSSocket);
+    });
+    it('should not upgrade to TLS, if not requested', () => {
+      const jsonSocket = new ClientTCP({}).createSocket();
+      expect(jsonSocket.socket).instanceOf(NetSocket);
+    });
+  });
 });
diff --git a/packages/microservices/test/decorators/event-pattern.decorator.spec.ts b/packages/microservices/test/decorators/event-pattern.decorator.spec.ts
index dbfb07696..3a78e602d 100644
--- a/packages/microservices/test/decorators/event-pattern.decorator.spec.ts
+++ b/packages/microservices/test/decorators/event-pattern.decorator.spec.ts
@@ -54,6 +54,8 @@ describe('@EventPattern', () => {
   });
 
   describe('decorator overloads', () => {
+    const additionalExtras = { foo: 'bar' };
+
     class TestComponent1 {
       @EventPattern(pattern)
       public static test() {}
@@ -70,6 +72,18 @@ describe('@EventPattern', () => {
       @EventPattern(pattern, Transport.TCP, extras)
       public static test() {}
     }
+    class TestComponent5 {
+      @EventPattern(pattern, Transport.TCP, extras)
+      @((
+        (): MethodDecorator => (_target, _key, descriptor) =>
+          Reflect.defineMetadata(
+            PATTERN_EXTRAS_METADATA,
+            additionalExtras,
+            descriptor.value,
+          )
+      )())
+      public static test() {}
+    }
 
     it(`should enhance method with ${PATTERN_METADATA} metadata`, () => {
       const [metadataArg] = Reflect.getMetadata(
@@ -86,7 +100,7 @@ describe('@EventPattern', () => {
       );
       expect(metadataArg).to.be.eql(pattern);
       expect(transportArg).to.be.undefined;
-      expect(extrasArg).to.be.undefined;
+      expect(extrasArg).to.be.eql({});
     });
 
     it(`should enhance method with ${PATTERN_METADATA}, ${TRANSPORT_METADATA} metadata`, () => {
@@ -104,7 +118,7 @@ describe('@EventPattern', () => {
       );
       expect(metadataArg).to.be.eql(pattern);
       expect(transportArg).to.be.eql(Transport.TCP);
-      expect(extrasArg).to.be.undefined;
+      expect(extrasArg).to.be.eql({});
     });
 
     it(`should enhance method with ${PATTERN_METADATA}, ${PATTERN_EXTRAS_METADATA} metadata`, () => {
@@ -143,5 +157,26 @@ ${PATTERN_EXTRAS_METADATA} metadata`, () => {
       expect(transportArg).to.be.eql(Transport.TCP);
       expect(extrasArg).to.be.eql(extras);
     });
+
+    it(`should merge with existing ${PATTERN_EXTRAS_METADATA} metadata`, () => {
+      const [metadataArg] = Reflect.getMetadata(
+        PATTERN_METADATA,
+        TestComponent5.test,
+      );
+      const transportArg = Reflect.getMetadata(
+        TRANSPORT_METADATA,
+        TestComponent5.test,
+      );
+      const extrasArg = Reflect.getMetadata(
+        PATTERN_EXTRAS_METADATA,
+        TestComponent5.test,
+      );
+      expect(metadataArg).to.be.eql(pattern);
+      expect(transportArg).to.be.eql(Transport.TCP);
+      expect(extrasArg).to.be.eql({
+        ...additionalExtras,
+        ...extras,
+      });
+    });
   });
 });
diff --git a/packages/microservices/test/decorators/message-pattern.decorator.spec.ts b/packages/microservices/test/decorators/message-pattern.decorator.spec.ts
index d8b62d2f5..4980c3ff1 100644
--- a/packages/microservices/test/decorators/message-pattern.decorator.spec.ts
+++ b/packages/microservices/test/decorators/message-pattern.decorator.spec.ts
@@ -36,6 +36,8 @@ describe('@MessagePattern', () => {
   });
 
   describe('decorator overloads', () => {
+    const additionalExtras = { foo: 'bar' };
+
     class TestComponent1 {
       @MessagePattern(pattern)
       public static test() {}
@@ -52,6 +54,18 @@ describe('@MessagePattern', () => {
       @MessagePattern(pattern, Transport.TCP, extras)
       public static test() {}
     }
+    class TestComponent5 {
+      @MessagePattern(pattern, Transport.TCP, extras)
+      @((
+        (): MethodDecorator => (_target, _key, descriptor) =>
+          Reflect.defineMetadata(
+            PATTERN_EXTRAS_METADATA,
+            additionalExtras,
+            descriptor.value,
+          )
+      )())
+      public static test() {}
+    }
 
     it(`should enhance method with ${PATTERN_METADATA} metadata`, () => {
       const [metadataArg] = Reflect.getMetadata(
@@ -68,7 +82,7 @@ describe('@MessagePattern', () => {
       );
       expect(metadataArg).to.be.eql(pattern);
       expect(transportArg).to.be.undefined;
-      expect(extrasArg).to.be.undefined;
+      expect(extrasArg).to.be.eql({});
     });
 
     it(`should enhance method with ${PATTERN_METADATA}, ${TRANSPORT_METADATA} metadata`, () => {
@@ -86,7 +100,7 @@ describe('@MessagePattern', () => {
       );
       expect(metadataArg).to.be.eql(pattern);
       expect(transportArg).to.be.eql(Transport.TCP);
-      expect(extrasArg).to.be.undefined;
+      expect(extrasArg).to.be.eql({});
     });
 
     it(`should enhance method with ${PATTERN_METADATA}, ${PATTERN_EXTRAS_METADATA} metadata`, () => {
@@ -125,6 +139,27 @@ ${PATTERN_EXTRAS_METADATA} metadata`, () => {
       expect(transportArg).to.be.eql(Transport.TCP);
       expect(extrasArg).to.be.eql(extras);
     });
+
+    it(`should merge with existing ${PATTERN_EXTRAS_METADATA} metadata`, () => {
+      const [metadataArg] = Reflect.getMetadata(
+        PATTERN_METADATA,
+        TestComponent5.test,
+      );
+      const transportArg = Reflect.getMetadata(
+        TRANSPORT_METADATA,
+        TestComponent5.test,
+      );
+      const extrasArg = Reflect.getMetadata(
+        PATTERN_EXTRAS_METADATA,
+        TestComponent5.test,
+      );
+      expect(metadataArg).to.be.eql(pattern);
+      expect(transportArg).to.be.eql(Transport.TCP);
+      expect(extrasArg).to.be.eql({
+        ...additionalExtras,
+        ...extras,
+      });
+    });
   });
 });
 
diff --git a/packages/microservices/test/json-socket/message-parsing.spec.ts b/packages/microservices/test/json-socket/message-parsing.spec.ts
index 853ddff2b..f714eb9bb 100644
--- a/packages/microservices/test/json-socket/message-parsing.spec.ts
+++ b/packages/microservices/test/json-socket/message-parsing.spec.ts
@@ -108,8 +108,8 @@ describe('JsonSocket message parsing', () => {
   describe('Error handling', () => {
     describe('JSON Error', () => {
       const errorMsg = `Could not parse JSON: Unexpected end of JSON input\nRequest data: "Hel`;
-      const packetStrin = '4#"Hel';
-      const packet = Buffer.from(packetStrin);
+      const packetString = '4#"Hel';
+      const packet = Buffer.from(packetString);
 
       it('should fail to parse invalid JSON', () => {
         try {
@@ -146,12 +146,12 @@ describe('JsonSocket message parsing', () => {
 
     describe('Corrupted length value', () => {
       const errorMsg = `Corrupted length value "wtf" supplied in a packet`;
-      const packetStrin = 'wtf#"Hello"';
-      const packet = Buffer.from(packetStrin);
+      const packetString = 'wtf#"Hello"';
+      const packet = Buffer.from(packetString);
 
       it('should not accept invalid content length', () => {
         try {
-          socket['handleData'](packetStrin);
+          socket['handleData'](packetString);
         } catch (err) {
           expect(err.message).to.deep.equal(errorMsg);
         }
diff --git a/packages/microservices/test/listeners-controller.spec.ts b/packages/microservices/test/listeners-controller.spec.ts
index 83d5f43a7..dd9cadb09 100644
--- a/packages/microservices/test/listeners-controller.spec.ts
+++ b/packages/microservices/test/listeners-controller.spec.ts
@@ -6,13 +6,17 @@ import { Injector } from '@nestjs/core/injector/injector';
 import { InstanceWrapper } from '@nestjs/core/injector/instance-wrapper';
 import { expect } from 'chai';
 import * as sinon from 'sinon';
+import { GraphInspector } from '../../core/inspector/graph-inspector';
 import { MetadataScanner } from '../../core/metadata-scanner';
 import { ClientProxyFactory } from '../client';
 import { ClientsContainer } from '../container';
 import { ExceptionFiltersContext } from '../context/exception-filters-context';
 import { RpcContextCreator } from '../context/rpc-context-creator';
 import { Transport } from '../enums/transport.enum';
-import { ListenerMetadataExplorer } from '../listener-metadata-explorer';
+import {
+  EventOrMessageListenerDefinition,
+  ListenerMetadataExplorer,
+} from '../listener-metadata-explorer';
 import { ListenersController } from '../listeners-controller';
 
 describe('ListenersController', () => {
@@ -28,6 +32,7 @@ describe('ListenersController', () => {
     addSpyCustom: sinon.SinonSpy,
     proxySpy: sinon.SinonSpy,
     container: NestContainer,
+    graphInspector: GraphInspector,
     injector: Injector,
     rpcContextCreator: RpcContextCreator,
     exceptionFiltersContext: ExceptionFiltersContext;
@@ -38,6 +43,7 @@ describe('ListenersController', () => {
   });
   beforeEach(() => {
     container = new NestContainer();
+    graphInspector = new GraphInspector(container);
     injector = new Injector();
     exceptionFiltersContext = new ExceptionFiltersContext(
       container,
@@ -46,6 +52,7 @@ describe('ListenersController', () => {
     rpcContextCreator = sinon.createStubInstance(RpcContextCreator) as any;
     proxySpy = sinon.spy();
     (rpcContextCreator as any).create.callsFake(() => proxySpy);
+
     instance = new ListenersController(
       new ClientsContainer(),
       rpcContextCreator,
@@ -53,6 +60,7 @@ describe('ListenersController', () => {
       injector,
       ClientProxyFactory,
       exceptionFiltersContext,
+      graphInspector,
     );
     (instance as any).metadataExplorer = metadataExplorer;
     addSpy = sinon.spy();
@@ -240,7 +248,7 @@ describe('ListenersController', () => {
       const patterns = [{}];
       const wrapper = new InstanceWrapper({ instance: { [methodKey]: {} } });
 
-      it('should delegete error to exception filters', async () => {
+      it('should delegate error to exception filters', async () => {
         sinon.stub(injector, 'loadPerContext').callsFake(() => {
           throw new Error();
         });
@@ -262,6 +270,49 @@ describe('ListenersController', () => {
     });
   });
 
+  describe('insertEntrypointDefinition', () => {
+    it('should inspect & insert corresponding entrypoint definitions', () => {
+      class TestCtrl {}
+      const instanceWrapper = new InstanceWrapper({
+        metatype: TestCtrl,
+        name: TestCtrl.name,
+      });
+      const definition: EventOrMessageListenerDefinition = {
+        patterns: ['findOne'],
+        methodKey: 'find',
+        isEventHandler: false,
+        targetCallback: null,
+        extras: { qos: 2 },
+      };
+      const transportId = Transport.MQTT;
+
+      const insertEntrypointDefinitionSpy = sinon.spy(
+        graphInspector,
+        'insertEntrypointDefinition',
+      );
+      instance.insertEntrypointDefinition(
+        instanceWrapper,
+        definition,
+        transportId,
+      );
+      expect(
+        insertEntrypointDefinitionSpy.calledWith({
+          type: 'microservice',
+          methodName: definition.methodKey,
+          className: 'TestCtrl',
+          classNodeId: instanceWrapper.id,
+          metadata: {
+            key: definition.patterns.toString(),
+            transportId: 'MQTT',
+            patterns: definition.patterns,
+            isEventHandler: definition.isEventHandler,
+            extras: definition.extras,
+          } as any,
+        }),
+      ).to.be.true;
+    });
+  });
+
   describe('assignClientToInstance', () => {
     it('should assign client to instance', () => {
       const propertyKey = 'key';
diff --git a/packages/microservices/test/listeners-metadata-explorer.spec.ts b/packages/microservices/test/listeners-metadata-explorer.spec.ts
index 2bb04a763..18ccdc2f7 100644
--- a/packages/microservices/test/listeners-metadata-explorer.spec.ts
+++ b/packages/microservices/test/listeners-metadata-explorer.spec.ts
@@ -52,17 +52,16 @@ describe('ListenerMetadataExplorer', () => {
     instance = new ListenerMetadataExplorer(scanner);
   });
   describe('explore', () => {
-    let scanFromPrototype: sinon.SinonSpy;
+    let getAllMethodNames: sinon.SinonSpy;
     beforeEach(() => {
-      scanFromPrototype = sinon.spy(scanner, 'scanFromPrototype');
+      getAllMethodNames = sinon.spy(scanner, 'getAllMethodNames');
     });
     it(`should call "scanFromPrototype" with expected arguments`, () => {
       const obj = new Test();
       instance.explore(obj);
 
-      const { args } = scanFromPrototype.getCall(0);
-      expect(args[0]).to.be.eql(obj);
-      expect(args[1]).to.be.eql(Object.getPrototypeOf(obj));
+      const { args } = getAllMethodNames.getCall(0);
+      expect(args[0]).to.be.eql(Object.getPrototypeOf(obj));
     });
   });
   describe('exploreMethodMetadata', () => {
diff --git a/packages/microservices/test/server/server-redis.spec.ts b/packages/microservices/test/server/server-redis.spec.ts
index 2f0602f90..8a831ff6b 100644
--- a/packages/microservices/test/server/server-redis.spec.ts
+++ b/packages/microservices/test/server/server-redis.spec.ts
@@ -67,7 +67,7 @@ describe('ServerRedis', () => {
     });
   });
   describe('handleConnection', () => {
-    let onSpy: sinon.SinonSpy, subscribeSpy: sinon.SinonSpy, sub;
+    let onSpy: sinon.SinonSpy, subscribeSpy: sinon.SinonSpy, sub, psub;
 
     beforeEach(() => {
       onSpy = sinon.spy();
@@ -76,12 +76,24 @@ describe('ServerRedis', () => {
         on: onSpy,
         subscribe: subscribeSpy,
       };
+      psub = {
+        on: onSpy,
+        psubscribe: subscribeSpy,
+      };
     });
-    it('should bind "message" event to handler', () => {
+    it('should bind "message" event to handler if wildcards are disabled', () => {
       server.bindEvents(sub, null);
       expect(onSpy.getCall(0).args[0]).to.be.equal('message');
     });
-    it('should subscribe to each pattern', () => {
+    it('should bind "pmessage" event to handler if wildcards are enabled', () => {
+      (server as any).options = {};
+      (server as any).options.wildcards = true;
+
+      server.bindEvents(psub, null);
+      expect(onSpy.getCall(0).args[0]).to.be.equal('pmessage');
+    });
+
+    it('should "subscribe" to each pattern if wildcards are disabled', () => {
       const pattern = 'test';
       const handler = sinon.spy();
       (server as any).messageHandlers = objectToMap({
@@ -90,6 +102,19 @@ describe('ServerRedis', () => {
       server.bindEvents(sub, null);
       expect(subscribeSpy.calledWith(pattern)).to.be.true;
     });
+
+    it('should "psubscribe" to each pattern if wildcards are enabled', () => {
+      (server as any).options = {};
+      (server as any).options.wildcards = true;
+
+      const pattern = 'test';
+      const handler = sinon.spy();
+      (server as any).messageHandlers = objectToMap({
+        [pattern]: handler,
+      });
+      server.bindEvents(psub, null);
+      expect(subscribeSpy.calledWith(pattern)).to.be.true;
+    });
   });
   describe('getMessageHandler', () => {
     it(`should return function`, () => {
@@ -111,12 +136,17 @@ describe('ServerRedis', () => {
       const handleEventSpy = sinon.spy(server, 'handleEvent');
       sinon.stub(server, 'parseMessage').callsFake(() => ({ data } as any));
 
-      await server.handleMessage(channel, JSON.stringify({}), null);
+      await server.handleMessage(channel, JSON.stringify({}), null, channel);
       expect(handleEventSpy.called).to.be.true;
     });
     it(`should publish NO_MESSAGE_HANDLER if pattern not exists in messageHandlers object`, async () => {
       sinon.stub(server, 'parseMessage').callsFake(() => ({ id, data } as any));
-      await server.handleMessage(channel, JSON.stringify({ id }), null);
+      await server.handleMessage(
+        channel,
+        JSON.stringify({ id }),
+        null,
+        channel,
+      );
       expect(
         getPublisherSpy.calledWith({
           id,
@@ -132,7 +162,7 @@ describe('ServerRedis', () => {
       });
       sinon.stub(server, 'parseMessage').callsFake(() => ({ id, data } as any));
 
-      await server.handleMessage(channel, {}, null);
+      await server.handleMessage(channel, {}, null, channel);
       expect(handler.calledWith(data)).to.be.true;
     });
   });
diff --git a/packages/microservices/tsconfig.build.json b/packages/microservices/tsconfig.build.json
new file mode 100644
index 000000000..e8b71a07a
--- /dev/null
+++ b/packages/microservices/tsconfig.build.json
@@ -0,0 +1,27 @@
+{
+  "extends": "../tsconfig.build.json",
+  "compilerOptions": {
+    "outDir": ".",
+    "rootDir": ".",
+    "paths": {
+      "@nestjs/common": ["../common"],
+      "@nestjs/common/*": ["../common/*"],
+      "@nestjs/core": ["../core"],
+      "@nestjs/core/*": ["../core/*"],
+      "@nestjs/websockets": ["../websockets"],
+      "@nestjs/websockets/*": ["../websockets/*"]
+    }
+  },
+  "exclude": ["node_modules", "dist", "test/**/*", "*.spec.ts"],
+  "references": [
+    {
+      "path": "../common/tsconfig.build.json"
+    },
+    {
+      "path": "../core/tsconfig.build.json"
+    },
+    {
+      "path": "../websockets/tsconfig.build.json"
+    }
+  ]
+}
diff --git a/packages/microservices/tsconfig.json b/packages/microservices/tsconfig.json
index b238080a4..2ae9e3c90 100644
--- a/packages/microservices/tsconfig.json
+++ b/packages/microservices/tsconfig.json
@@ -1,7 +1,13 @@
 {
-  "extends": "./../tsconfig.base.json",
+  "extends": "../tsconfig.build.json",
   "compilerOptions": {
-    "baseUrl": "./"
+    "types": ["node"]
   },
-  "include": ["*.ts", "**/*.ts"]
+  "files": [],
+  "include": [],
+  "references": [
+    {
+      "path": "./tsconfig.build.json"
+    }
+  ]
 }
diff --git a/packages/platform-express/Readme.md b/packages/platform-express/Readme.md
index 5203ac4c2..16f48336d 100644
--- a/packages/platform-express/Readme.md
+++ b/packages/platform-express/Readme.md
@@ -11,7 +11,6 @@
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
 <a href="https://circleci.com/gh/nestjs/nest" target="_blank"><img src="https://img.shields.io/circleci/build/github/nestjs/nest/master" alt="CircleCI" /></a>
-<a href="https://coveralls.io/github/nestjs/nest?branch=master" target="_blank"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#9" alt="Coverage" /></a>
 <a href="https://discord.gg/G7Qnnhy" target="_blank"><img src="https://img.shields.io/badge/discord-online-brightgreen.svg" alt="Discord"/></a>
 <a href="https://opencollective.com/nest#backer" target="_blank"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
 <a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
@@ -78,7 +77,10 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
  <td>
 <a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
 <a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td><td>
-<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
+<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td>
+<td>
+<a href="https://ridicorp.com/career/" target="_blank"><img src="https://nestjs.com/img/ridi-logo.svg" width="105" valign="middle" /></a></td><td>
+<a href="https://www.movavi.com/imovie-for-windows.html" target="_blank"><img src="https://nestjs.com/img/movavi-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
@@ -91,7 +93,8 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td>
 <td><a href="https://n.inc" target="_blank"><img src="https://nestjs.com/img/n-inc-logo.svg" width="120" valign="middle" /></td></tr><tr>
 <td><a href="https://bilberrry.com/" target="_blank"><img src="https://nestjs.com/img/bilberrry-logo.svg" width="180" valign="middle" /></td>
-<td><a href="https://ipinfo.ai/" target="_blank"><img src="https://nestjs.com/img/ipinfo-logo.png" width="130" valign="middle" /></td></tr>
+<td><a href="https://ipinfo.ai/" target="_blank"><img src="https://nestjs.com/img/ipinfo-logo.png" width="130" valign="middle" /></td>
+<td><a href="https://chax.at" target="_blank"><img src="https://nestjs.com/img/chaxat-logo.png" width="100" valign="middle" /></td></tr>
 </table>
 
 #### Sponsors
@@ -132,7 +135,8 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
    <td align="center" valign="middle"><a href="https://mobilereality.pl/" target="_blank"><img src="https://nestjs.com/img/mobile-reality-logo.png" width="45" valign="middle" /></a></td>
      <td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/boringowl-logo.svg" width="120" valign="middle" /></a></td>
  <td align="center" valign="middle"><a href="https://www.mobilefactory.jp/" target="_blank"><img src="https://nestjs.com/img/mobilefactory-logo.png" width="100" valign="middle" /></a></td>
- <td align="center" valign="middle"><a href="https://db.nordbot.app/" target="_blank"><img src="https://nestjs.com/img/nord-logo.png" width="50" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://nordbot.app/" target="_blank"><img src="https://nestjs.com/img/nordbot-logo.png" width="120" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://doppio.sh/" target="_blank"><img src="https://nestjs.com/img/dopiosh-logo.png" width="50" valign="middle" /></a></td>
   </tr></table>
 
 ## Backers
diff --git a/packages/platform-express/adapters/express-adapter.ts b/packages/platform-express/adapters/express-adapter.ts
index 9d02e8b1f..7a0597778 100644
--- a/packages/platform-express/adapters/express-adapter.ts
+++ b/packages/platform-express/adapters/express-adapter.ts
@@ -1,11 +1,12 @@
-import type { Server } from 'net';
+import type { Server } from 'http';
 import {
+  HttpStatus,
   InternalServerErrorException,
   Logger,
   RequestMethod,
   StreamableFile,
-  VersioningType,
   VersioningOptions,
+  VersioningType,
   VERSION_NEUTRAL,
 } from '@nestjs/common';
 import { VersionValue } from '@nestjs/common/interfaces';
@@ -25,15 +26,16 @@ import { AbstractHttpAdapter } from '@nestjs/core/adapters/http-adapter';
 import { RouterMethodFactory } from '@nestjs/core/helpers/router-method-factory';
 import {
   json as bodyParserJson,
-  OptionsJson,
-  OptionsUrlencoded,
   urlencoded as bodyParserUrlencoded,
 } from 'body-parser';
+import * as bodyparser from 'body-parser';
 import * as cors from 'cors';
 import * as express from 'express';
 import * as http from 'http';
 import * as https from 'https';
 import { Duplex, pipeline } from 'stream';
+import { NestExpressBodyParserOptions } from '../interfaces/nest-express-body-parser-options.interface';
+import { NestExpressBodyParserType } from '../interfaces/nest-express-body-parser.interface';
 import { ServeStaticOptions } from '../interfaces/serve-static-options.interface';
 import { getBodyParserOptions } from './utils/get-body-parser-options.util';
 
@@ -46,7 +48,12 @@ type VersionedRoute = <
   next: () => void,
 ) => any;
 
-export class ExpressAdapter extends AbstractHttpAdapter {
+/**
+ * @publicApi
+ */
+export class ExpressAdapter extends AbstractHttpAdapter<
+  http.Server | https.Server
+> {
   private readonly routerMethodFactory = new RouterMethodFactory();
   private readonly logger = new Logger(ExpressAdapter.name);
   private readonly openConnections = new Set<Duplex>();
@@ -94,6 +101,16 @@ export class ExpressAdapter extends AbstractHttpAdapter {
         },
       );
     }
+    if (
+      response.getHeader('Content-Type') !== undefined &&
+      response.getHeader('Content-Type') !== 'application/json' &&
+      body?.statusCode >= HttpStatus.BAD_REQUEST
+    ) {
+      this.logger.warn(
+        "Content-Type doesn't match Reply body, you might need a custom ExceptionFilter for non-JSON responses",
+      );
+      response.setHeader('Content-Type', 'application/json');
+    }
     return isObject(body) ? response.json(body) : response.send(String(body));
   }
 
@@ -220,11 +237,10 @@ export class ExpressAdapter extends AbstractHttpAdapter {
   }
 
   public registerParserMiddleware(prefix?: string, rawBody?: boolean) {
-    const bodyParserJsonOptions = getBodyParserOptions<OptionsJson>(rawBody);
-    const bodyParserUrlencodedOptions = getBodyParserOptions<OptionsUrlencoded>(
-      rawBody,
-      { extended: true },
-    );
+    const bodyParserJsonOptions = getBodyParserOptions(rawBody);
+    const bodyParserUrlencodedOptions = getBodyParserOptions(rawBody, {
+      extended: true,
+    });
 
     const parserMiddleware = {
       jsonParser: bodyParserJson(bodyParserJsonOptions),
@@ -235,6 +251,19 @@ export class ExpressAdapter extends AbstractHttpAdapter {
       .forEach(parserKey => this.use(parserMiddleware[parserKey]));
   }
 
+  public useBodyParser<Options = NestExpressBodyParserOptions>(
+    type: NestExpressBodyParserType,
+    rawBody: boolean,
+    options?: Omit<Options, 'verify'>,
+  ): this {
+    const parserOptions = getBodyParserOptions<Options>(rawBody, options);
+    const parser = bodyparser[type](parserOptions);
+
+    this.use(parser);
+
+    return this;
+  }
+
   public setLocal(key: string, value: any) {
     this.instance.locals[key] = value;
     return this;
diff --git a/packages/platform-express/adapters/utils/get-body-parser-options.util.ts b/packages/platform-express/adapters/utils/get-body-parser-options.util.ts
index 0f1513243..c89ed92ab 100644
--- a/packages/platform-express/adapters/utils/get-body-parser-options.util.ts
+++ b/packages/platform-express/adapters/utils/get-body-parser-options.util.ts
@@ -1,6 +1,6 @@
 import type { RawBodyRequest } from '@nestjs/common';
-import type { Options } from 'body-parser';
 import type { IncomingMessage, ServerResponse } from 'http';
+import type { NestExpressBodyParserOptions } from '../../interfaces';
 
 const rawBodyParser = (
   req: RawBodyRequest<IncomingMessage>,
@@ -13,11 +13,11 @@ const rawBodyParser = (
   return true;
 };
 
-export function getBodyParserOptions<ParserOptions extends Options>(
+export function getBodyParserOptions<Options = NestExpressBodyParserOptions>(
   rawBody: boolean,
-  options?: ParserOptions | undefined,
-): ParserOptions {
-  let parserOptions: ParserOptions = options ?? ({} as ParserOptions);
+  options?: Omit<Options, 'verify'> | undefined,
+): Options {
+  let parserOptions: Options = (options || {}) as Options;
 
   if (rawBody === true) {
     parserOptions = {
diff --git a/packages/platform-express/index.ts b/packages/platform-express/index.ts
index 0ed4c2d76..ce3dbc432 100644
--- a/packages/platform-express/index.ts
+++ b/packages/platform-express/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @platform-express
- * Copyright(c) 2017 - 2022 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2023 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
diff --git a/packages/platform-express/interfaces/index.ts b/packages/platform-express/interfaces/index.ts
index 3238b1c16..ac057435a 100644
--- a/packages/platform-express/interfaces/index.ts
+++ b/packages/platform-express/interfaces/index.ts
@@ -1 +1,3 @@
 export * from './nest-express-application.interface';
+export { NestExpressBodyParserOptions } from './nest-express-body-parser-options.interface';
+export * from './nest-express-body-parser.interface';
diff --git a/packages/platform-express/interfaces/nest-express-application.interface.ts b/packages/platform-express/interfaces/nest-express-application.interface.ts
index 75da409d2..62e31ebb8 100644
--- a/packages/platform-express/interfaces/nest-express-application.interface.ts
+++ b/packages/platform-express/interfaces/nest-express-application.interface.ts
@@ -1,5 +1,10 @@
-import { Server } from 'net';
-import { INestApplication } from '@nestjs/common';
+import { INestApplication, HttpServer } from '@nestjs/common';
+import type { Server as CoreHttpServer } from 'http';
+import type { Server as CoreHttpsServer } from 'https';
+import type { Server } from 'net';
+import type { Express } from 'express';
+import { NestExpressBodyParserOptions } from './nest-express-body-parser-options.interface';
+import { NestExpressBodyParserType } from './nest-express-body-parser.interface';
 import { ServeStaticOptions } from './serve-static-options.interface';
 
 /**
@@ -9,7 +14,16 @@ import { ServeStaticOptions } from './serve-static-options.interface';
  *
  * @publicApi
  */
-export interface NestExpressApplication extends INestApplication {
+export interface NestExpressApplication<
+  TServer extends CoreHttpServer | CoreHttpsServer = CoreHttpServer,
+> extends INestApplication<TServer> {
+  /**
+   * Returns the underlying HTTP adapter bounded to the Express.js app.
+   *
+   * @returns {HttpServer}
+   */
+  getHttpAdapter(): HttpServer<Express.Request, Express.Response, Express>;
+
   /**
    * Starts the application.
    *
@@ -73,6 +87,24 @@ export interface NestExpressApplication extends INestApplication {
    */
   useStaticAssets(path: string, options?: ServeStaticOptions): this;
 
+  /**
+   * Register Express body parsers on the fly. Will respect
+   * the application's `rawBody` option.
+   *
+   * @example
+   * const app = await NestFactory.create<NestExpressApplication>(
+   *   AppModule,
+   *   { rawBody: true }
+   * );
+   * app.useBodyParser('json', { limit: '50mb' });
+   *
+   * @returns {this}
+   */
+  useBodyParser<Options = NestExpressBodyParserOptions>(
+    parser: NestExpressBodyParserType,
+    options?: Omit<Options, 'verify'>,
+  ): this;
+
   /**
    * Sets one or multiple base directories for templates (views).
    *
diff --git a/packages/platform-express/interfaces/nest-express-body-parser-options.interface.ts b/packages/platform-express/interfaces/nest-express-body-parser-options.interface.ts
new file mode 100644
index 000000000..93df3c5f6
--- /dev/null
+++ b/packages/platform-express/interfaces/nest-express-body-parser-options.interface.ts
@@ -0,0 +1,26 @@
+import type { IncomingMessage } from 'http';
+
+/**
+ * Type alias to keep compatibility with @types/body-parser
+ * @see https://github.com/DefinitelyTyped/DefinitelyTyped/blob/dcd1673c4fa18a15ea8cd8ff8af7d563bb6dc8e6/types/body-parser/index.d.ts#L48-L66#L48-L66
+ * @publicApi
+ */
+export interface NestExpressBodyParserOptions {
+  /** When set to true, then deflated (compressed) bodies will be inflated; when false, deflated bodies are rejected. Defaults to true. */
+  inflate?: boolean | undefined;
+
+  /**
+   * Controls the maximum request body size. If this is a number,
+   * then the value specifies the number of bytes; if it is a string,
+   * the value is passed to the bytes library for parsing. Defaults to '100kb'.
+   */
+  limit?: number | string | undefined;
+
+  /**
+   * The type option is used to determine what media type the middleware will parse
+   */
+  type?: string | string[] | ((req: IncomingMessage) => any) | undefined;
+
+  // Catch-all for body-parser type specific options
+  [key: string]: unknown;
+}
diff --git a/packages/platform-express/interfaces/nest-express-body-parser.interface.ts b/packages/platform-express/interfaces/nest-express-body-parser.interface.ts
new file mode 100644
index 000000000..9cb003054
--- /dev/null
+++ b/packages/platform-express/interfaces/nest-express-body-parser.interface.ts
@@ -0,0 +1,4 @@
+/**
+ * Interface defining possible body parser types, to be used with `NestExpressApplication.useBodyParser()`.
+ */
+export type NestExpressBodyParserType = 'json' | 'urlencoded' | 'text' | 'raw';
diff --git a/packages/platform-express/multer/multer/multer.constants.ts b/packages/platform-express/multer/multer/multer.constants.ts
index e3c7b4557..5a6f6aaa4 100644
--- a/packages/platform-express/multer/multer/multer.constants.ts
+++ b/packages/platform-express/multer/multer/multer.constants.ts
@@ -1,4 +1,5 @@
 export const multerExceptions = {
+  // from https://github.com/expressjs/multer/blob/master/lib/multer-error.js
   LIMIT_PART_COUNT: 'Too many parts',
   LIMIT_FILE_SIZE: 'File too large',
   LIMIT_FILE_COUNT: 'Too many files',
@@ -6,4 +7,13 @@ export const multerExceptions = {
   LIMIT_FIELD_VALUE: 'Field value too long',
   LIMIT_FIELD_COUNT: 'Too many fields',
   LIMIT_UNEXPECTED_FILE: 'Unexpected field',
+  MISSING_FIELD_NAME: 'Field name missing',
+};
+
+export const busboyExceptions = {
+  // from https://github.com/mscdex/busboy/blob/master/lib/types/multipart.js
+  MULTIPART_BOUNDARY_NOT_FOUND: 'Multipart: Boundary not found',
+  MULTIPART_MALFORMED_PART_HEADER: 'Malformed part header',
+  MULTIPART_UNEXPECTED_END_OF_FORM: 'Unexpected end of form',
+  MULTIPART_UNEXPECTED_END_OF_FILE: 'Unexpected end of file',
 };
diff --git a/packages/platform-express/multer/multer/multer.utils.ts b/packages/platform-express/multer/multer/multer.utils.ts
index 81e19739c..9df215832 100644
--- a/packages/platform-express/multer/multer/multer.utils.ts
+++ b/packages/platform-express/multer/multer/multer.utils.ts
@@ -3,7 +3,7 @@ import {
   HttpException,
   PayloadTooLargeException,
 } from '@nestjs/common';
-import { multerExceptions } from './multer.constants';
+import { multerExceptions, busboyExceptions } from './multer.constants';
 
 export function transformException(error: Error | undefined) {
   if (!error || error instanceof HttpException) {
@@ -18,7 +18,14 @@ export function transformException(error: Error | undefined) {
     case multerExceptions.LIMIT_FIELD_COUNT:
     case multerExceptions.LIMIT_UNEXPECTED_FILE:
     case multerExceptions.LIMIT_PART_COUNT:
+    case multerExceptions.MISSING_FIELD_NAME:
       return new BadRequestException(error.message);
+    case busboyExceptions.MULTIPART_BOUNDARY_NOT_FOUND:
+      return new BadRequestException(error.message);
+    case busboyExceptions.MULTIPART_MALFORMED_PART_HEADER:
+    case busboyExceptions.MULTIPART_UNEXPECTED_END_OF_FORM:
+    case busboyExceptions.MULTIPART_UNEXPECTED_END_OF_FILE:
+      return new BadRequestException(`Multipart: ${error.message}`);
   }
   return error;
 }
diff --git a/packages/platform-express/package.json b/packages/platform-express/package.json
index 65b0b6788..e113761f2 100644
--- a/packages/platform-express/package.json
+++ b/packages/platform-express/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/platform-express",
-  "version": "9.2.0",
+  "version": "9.4.0",
   "description": "Nest - modern, fast, powerful node.js web framework (@platform-express)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -17,15 +17,15 @@
     "access": "public"
   },
   "dependencies": {
-    "body-parser": "1.20.1",
+    "body-parser": "1.20.2",
     "cors": "2.8.5",
     "express": "4.18.2",
     "multer": "1.4.4-lts.1",
-    "tslib": "2.4.1"
+    "tslib": "2.5.0"
   },
   "devDependencies": {
-    "@nestjs/common": "9.2.0",
-    "@nestjs/core": "9.2.0"
+    "@nestjs/common": "9.4.0",
+    "@nestjs/core": "9.4.0"
   },
   "peerDependencies": {
     "@nestjs/common": "^9.0.0",
diff --git a/packages/platform-express/test/multer/multer/multer.utils.spec.ts b/packages/platform-express/test/multer/multer/multer.utils.spec.ts
index 7ad1eec90..f3745b936 100644
--- a/packages/platform-express/test/multer/multer/multer.utils.spec.ts
+++ b/packages/platform-express/test/multer/multer/multer.utils.spec.ts
@@ -4,18 +4,21 @@ import {
   PayloadTooLargeException,
 } from '@nestjs/common';
 import { expect } from 'chai';
-import { multerExceptions } from '../../../multer/multer/multer.constants';
+import {
+  multerExceptions,
+  busboyExceptions,
+} from '../../../multer/multer/multer.constants';
 import { transformException } from '../../../multer/multer/multer.utils';
 
 describe('transformException', () => {
   describe('if error does not exist', () => {
-    it('behave as identity', () => {
+    it('should behave as identity', () => {
       const err = undefined;
       expect(transformException(err)).to.be.eq(err);
     });
   });
   describe('if error is instance of HttpException', () => {
-    it('behave as identity', () => {
+    it('should behave as identity', () => {
       const err = new HttpException('response', 500);
       expect(transformException(err)).to.be.eq(err);
     });
@@ -37,5 +40,22 @@ describe('transformException', () => {
         );
       });
     });
+    describe('and is busboy/multipart exception', () => {
+      it('should return "BadRequestException"', () => {
+        const err = { message: busboyExceptions.MULTIPART_BOUNDARY_NOT_FOUND };
+        expect(transformException(err as any)).to.be.instanceof(
+          BadRequestException,
+        );
+      });
+
+      it('should return "BadRequestException"', () => {
+        const err = {
+          message: busboyExceptions.MULTIPART_UNEXPECTED_END_OF_FORM,
+        };
+        expect(transformException(err as any)).to.be.instanceof(
+          BadRequestException,
+        );
+      });
+    });
   });
 });
diff --git a/packages/platform-express/tsconfig.build.json b/packages/platform-express/tsconfig.build.json
new file mode 100644
index 000000000..732ca00cb
--- /dev/null
+++ b/packages/platform-express/tsconfig.build.json
@@ -0,0 +1,22 @@
+{
+  "extends": "../tsconfig.build.json",
+  "compilerOptions": {
+    "outDir": ".",
+    "rootDir": ".",
+    "paths": {
+      "@nestjs/common": ["../common"],
+      "@nestjs/common/*": ["../common/*"],
+      "@nestjs/core": ["../core"],
+      "@nestjs/core/*": ["../core/*"]
+    }
+  },
+  "exclude": ["node_modules", "dist", "test/**/*", "*.spec.ts"],
+  "references": [
+    {
+      "path": "../common/tsconfig.build.json"
+    },
+    {
+      "path": "../core/tsconfig.build.json"
+    }
+  ]
+}
diff --git a/packages/platform-express/tsconfig.json b/packages/platform-express/tsconfig.json
index b238080a4..2ae9e3c90 100644
--- a/packages/platform-express/tsconfig.json
+++ b/packages/platform-express/tsconfig.json
@@ -1,7 +1,13 @@
 {
-  "extends": "./../tsconfig.base.json",
+  "extends": "../tsconfig.build.json",
   "compilerOptions": {
-    "baseUrl": "./"
+    "types": ["node"]
   },
-  "include": ["*.ts", "**/*.ts"]
+  "files": [],
+  "include": [],
+  "references": [
+    {
+      "path": "./tsconfig.build.json"
+    }
+  ]
 }
diff --git a/packages/platform-fastify/Readme.md b/packages/platform-fastify/Readme.md
index 5203ac4c2..16f48336d 100644
--- a/packages/platform-fastify/Readme.md
+++ b/packages/platform-fastify/Readme.md
@@ -11,7 +11,6 @@
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
 <a href="https://circleci.com/gh/nestjs/nest" target="_blank"><img src="https://img.shields.io/circleci/build/github/nestjs/nest/master" alt="CircleCI" /></a>
-<a href="https://coveralls.io/github/nestjs/nest?branch=master" target="_blank"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#9" alt="Coverage" /></a>
 <a href="https://discord.gg/G7Qnnhy" target="_blank"><img src="https://img.shields.io/badge/discord-online-brightgreen.svg" alt="Discord"/></a>
 <a href="https://opencollective.com/nest#backer" target="_blank"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
 <a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
@@ -78,7 +77,10 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
  <td>
 <a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
 <a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td><td>
-<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
+<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td>
+<td>
+<a href="https://ridicorp.com/career/" target="_blank"><img src="https://nestjs.com/img/ridi-logo.svg" width="105" valign="middle" /></a></td><td>
+<a href="https://www.movavi.com/imovie-for-windows.html" target="_blank"><img src="https://nestjs.com/img/movavi-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
@@ -91,7 +93,8 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td>
 <td><a href="https://n.inc" target="_blank"><img src="https://nestjs.com/img/n-inc-logo.svg" width="120" valign="middle" /></td></tr><tr>
 <td><a href="https://bilberrry.com/" target="_blank"><img src="https://nestjs.com/img/bilberrry-logo.svg" width="180" valign="middle" /></td>
-<td><a href="https://ipinfo.ai/" target="_blank"><img src="https://nestjs.com/img/ipinfo-logo.png" width="130" valign="middle" /></td></tr>
+<td><a href="https://ipinfo.ai/" target="_blank"><img src="https://nestjs.com/img/ipinfo-logo.png" width="130" valign="middle" /></td>
+<td><a href="https://chax.at" target="_blank"><img src="https://nestjs.com/img/chaxat-logo.png" width="100" valign="middle" /></td></tr>
 </table>
 
 #### Sponsors
@@ -132,7 +135,8 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
    <td align="center" valign="middle"><a href="https://mobilereality.pl/" target="_blank"><img src="https://nestjs.com/img/mobile-reality-logo.png" width="45" valign="middle" /></a></td>
      <td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/boringowl-logo.svg" width="120" valign="middle" /></a></td>
  <td align="center" valign="middle"><a href="https://www.mobilefactory.jp/" target="_blank"><img src="https://nestjs.com/img/mobilefactory-logo.png" width="100" valign="middle" /></a></td>
- <td align="center" valign="middle"><a href="https://db.nordbot.app/" target="_blank"><img src="https://nestjs.com/img/nord-logo.png" width="50" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://nordbot.app/" target="_blank"><img src="https://nestjs.com/img/nordbot-logo.png" width="120" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://doppio.sh/" target="_blank"><img src="https://nestjs.com/img/dopiosh-logo.png" width="50" valign="middle" /></a></td>
   </tr></table>
 
 ## Backers
diff --git a/packages/platform-fastify/adapters/fastify-adapter.ts b/packages/platform-fastify/adapters/fastify-adapter.ts
index e18ba56a8..06aa48d7e 100644
--- a/packages/platform-fastify/adapters/fastify-adapter.ts
+++ b/packages/platform-fastify/adapters/fastify-adapter.ts
@@ -18,11 +18,13 @@ import { isString, isUndefined } from '@nestjs/common/utils/shared.utils';
 import { AbstractHttpAdapter } from '@nestjs/core/adapters/http-adapter';
 import {
   fastify,
+  FastifyBaseLogger,
   FastifyBodyParser,
   FastifyInstance,
-  FastifyLoggerInstance,
+  FastifyListenOptions,
   FastifyPluginAsync,
   FastifyPluginCallback,
+  FastifyRegister,
   FastifyReply,
   FastifyRequest,
   FastifyServerOptions,
@@ -33,6 +35,7 @@ import {
   RequestGenericInterface,
 } from 'fastify';
 import * as Reply from 'fastify/lib/reply';
+import { kRouteContext } from 'fastify/lib/symbols';
 import { RouteShorthandMethod } from 'fastify/types/route';
 import * as http2 from 'http2';
 import * as https from 'https';
@@ -43,14 +46,15 @@ import {
 } from 'light-my-request';
 // `querystring` is used internally in fastify for registering urlencoded body parser.
 import { parse as querystringParse } from 'querystring';
+import { NestFastifyBodyParserOptions } from '../interfaces';
 import {
   FastifyStaticOptions,
-  PointOfViewOptions,
+  FastifyViewOptions,
 } from '../interfaces/external';
 
 type FastifyHttp2SecureOptions<
   Server extends http2.Http2SecureServer,
-  Logger extends FastifyLoggerInstance = FastifyLoggerInstance,
+  Logger extends FastifyBaseLogger = FastifyBaseLogger,
 > = FastifyServerOptions<Server, Logger> & {
   http2: true;
   https: http2.SecureServerOptions;
@@ -58,7 +62,7 @@ type FastifyHttp2SecureOptions<
 
 type FastifyHttp2Options<
   Server extends http2.Http2Server,
-  Logger extends FastifyLoggerInstance = FastifyLoggerInstance,
+  Logger extends FastifyBaseLogger = FastifyBaseLogger,
 > = FastifyServerOptions<Server, Logger> & {
   http2: true;
   http2SessionTimeout?: number;
@@ -66,7 +70,7 @@ type FastifyHttp2Options<
 
 type FastifyHttpsOptions<
   Server extends https.Server,
-  Logger extends FastifyLoggerInstance = FastifyLoggerInstance,
+  Logger extends FastifyBaseLogger = FastifyBaseLogger,
 > = FastifyServerOptions<Server, Logger> & {
   https: https.ServerOptions;
 };
@@ -89,6 +93,9 @@ type VersionedRoute<TRequest, TResponse> = ((
 type FastifyRawRequest<TServer extends RawServerBase> =
   RawRequestDefaultExpression<TServer> & { originalUrl?: string };
 
+/**
+ * @publicApi
+ */
 export class FastifyAdapter<
   TServer extends RawServerBase = RawServerDefault,
   TRawRequest extends FastifyRawRequest<TServer> = FastifyRawRequest<TServer>,
@@ -225,12 +232,27 @@ export class FastifyAdapter<
     hostname: string,
     callback?: () => void,
   ): void;
-  public listen(port: string | number, ...args: any[]): void {
+  public listen(
+    listenOptions: string | number | FastifyListenOptions,
+    ...args: any[]
+  ): void {
     const isFirstArgTypeofFunction = typeof args[0] === 'function';
     const callback = isFirstArgTypeofFunction ? args[0] : args[1];
-    const options: Record<string, any> = {
-      port: +port,
-    };
+
+    let options: Record<string, any>;
+    if (
+      typeof listenOptions === 'object' &&
+      (listenOptions.host !== undefined ||
+        listenOptions.port !== undefined ||
+        listenOptions.path !== undefined)
+    ) {
+      // First parameter is an object with a path, port and/or host attributes
+      options = listenOptions;
+    } else {
+      options = {
+        port: +listenOptions,
+      };
+    }
     if (!isFirstArgTypeofFunction) {
       options.host = args[0];
     }
@@ -287,7 +309,7 @@ export class FastifyAdapter<
       ? new Reply(
           response,
           {
-            context: {
+            [kRouteContext]: {
               preSerialization: null,
               preValidation: [],
               preHandler: [],
@@ -324,6 +346,17 @@ export class FastifyAdapter<
       }
       body = body.getStream();
     }
+    if (
+      fastifyReply.getHeader('Content-Type') !== undefined &&
+      fastifyReply.getHeader('Content-Type') !== 'application/json' &&
+      body?.statusCode >= HttpStatus.BAD_REQUEST
+    ) {
+      Logger.warn(
+        "Content-Type doesn't match Reply body, you might need a custom ExceptionFilter for non-JSON responses",
+        FastifyAdapter.name,
+      );
+      fastifyReply.header('Content-Type', 'application/json');
+    }
     return fastifyReply.send(body);
   }
 
@@ -368,7 +401,7 @@ export class FastifyAdapter<
     return this.instance as unknown as T;
   }
 
-  public register<TRegister extends Parameters<TInstance['register']>>(
+  public register<TRegister extends Parameters<FastifyRegister<TInstance>>>(
     plugin: TRegister['0'],
     opts?: TRegister['1'],
   ) {
@@ -408,7 +441,7 @@ export class FastifyAdapter<
     );
   }
 
-  public setViewEngine(options: PointOfViewOptions | string) {
+  public setViewEngine(options: FastifyViewOptions | string) {
     if (isString(options)) {
       new Logger('FastifyAdapter').error(
         "setViewEngine() doesn't support a string argument.",
@@ -463,6 +496,43 @@ export class FastifyAdapter<
     this._isParserRegistered = true;
   }
 
+  public useBodyParser(
+    type: string | string[] | RegExp,
+    rawBody: boolean,
+    options?: NestFastifyBodyParserOptions,
+    parser?: FastifyBodyParser<Buffer, TServer>,
+  ) {
+    const parserOptions = {
+      ...(options || {}),
+      parseAs: 'buffer' as const,
+    };
+
+    this.getInstance().addContentTypeParser<Buffer>(
+      type,
+      parserOptions,
+      (
+        req: RawBodyRequest<FastifyRequest<unknown, TServer, TRawRequest>>,
+        body: Buffer,
+        done,
+      ) => {
+        if (rawBody === true && Buffer.isBuffer(body)) {
+          req.rawBody = body;
+        }
+
+        if (parser) {
+          parser(req, body, done);
+          return;
+        }
+
+        done(null, body);
+      },
+    );
+
+    // To avoid the Nest application init to override our custom
+    // body parser, we mark the parsers as registered.
+    this._isParserRegistered = true;
+  }
+
   public async createMiddlewareFactory(
     requestMethod: RequestMethod,
   ): Promise<(path: string, callback: Function) => any> {
@@ -508,20 +578,15 @@ export class FastifyAdapter<
   }
 
   private registerJsonContentParser(rawBody?: boolean) {
+    const contentType = 'application/json';
+    const withRawBody = !!rawBody;
     const { bodyLimit } = this.getInstance().initialConfig;
 
-    this.getInstance().addContentTypeParser<Buffer>(
-      'application/json',
-      { parseAs: 'buffer', bodyLimit },
-      (
-        req: RawBodyRequest<FastifyRequest<unknown, TServer, TRawRequest>>,
-        body: Buffer,
-        done,
-      ) => {
-        if (rawBody === true && Buffer.isBuffer(body)) {
-          req.rawBody = body;
-        }
-
+    this.useBodyParser(
+      contentType,
+      withRawBody,
+      { bodyLimit },
+      (req, body, done) => {
         const { onProtoPoisoning, onConstructorPoisoning } =
           this.instance.initialConfig;
         const defaultJsonParser = this.instance.getDefaultJsonParser(
@@ -534,20 +599,15 @@ export class FastifyAdapter<
   }
 
   private registerUrlencodedContentParser(rawBody?: boolean) {
+    const contentType = 'application/x-www-form-urlencoded';
+    const withRawBody = !!rawBody;
     const { bodyLimit } = this.getInstance().initialConfig;
 
-    this.getInstance().addContentTypeParser<Buffer>(
-      'application/x-www-form-urlencoded',
-      { parseAs: 'buffer', bodyLimit },
-      (
-        req: RawBodyRequest<FastifyRequest<unknown, TServer, TRawRequest>>,
-        body: Buffer,
-        done,
-      ) => {
-        if (rawBody === true && Buffer.isBuffer(body)) {
-          req.rawBody = body;
-        }
-
+    this.useBodyParser(
+      contentType,
+      withRawBody,
+      { bodyLimit },
+      (_req, body, done) => {
         done(null, querystringParse(body.toString()));
       },
     );
diff --git a/packages/platform-fastify/index.ts b/packages/platform-fastify/index.ts
index 2918a05af..6d28e2ccd 100644
--- a/packages/platform-fastify/index.ts
+++ b/packages/platform-fastify/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @platform-fastify
- * Copyright(c) 2017 - 2022 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2023 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
diff --git a/packages/platform-fastify/interfaces/external/fastify-static-options.interface.ts b/packages/platform-fastify/interfaces/external/fastify-static-options.interface.ts
index a0ccb1f22..8bd294c0f 100644
--- a/packages/platform-fastify/interfaces/external/fastify-static-options.interface.ts
+++ b/packages/platform-fastify/interfaces/external/fastify-static-options.interface.ts
@@ -1,6 +1,7 @@
 /**
  * "fastify-static" interfaces
- * @see https://github.com/fastify/fastify-static/blob/master/index.d.ts
+ * @see https://github.com/fastify/fastify-static/blob/master/types/index.d.ts
+ * @publicApi
  */
 import { Stats } from 'fs';
 
@@ -49,6 +50,7 @@ interface SendOptions {
   index?: string[] | false;
   lastModified?: boolean;
   maxAge?: string | number;
+  serveDotFiles?: boolean;
 }
 
 export interface FastifyStaticOptions extends SendOptions {
diff --git a/packages/platform-fastify/interfaces/external/point-of-view-options.interface.ts b/packages/platform-fastify/interfaces/external/fastify-view-options.interface.ts
similarity index 74%
rename from packages/platform-fastify/interfaces/external/point-of-view-options.interface.ts
rename to packages/platform-fastify/interfaces/external/fastify-view-options.interface.ts
index f7ce1adeb..c6774c65d 100644
--- a/packages/platform-fastify/interfaces/external/point-of-view-options.interface.ts
+++ b/packages/platform-fastify/interfaces/external/fastify-view-options.interface.ts
@@ -1,8 +1,9 @@
 /**
- * @see https://github.com/fastify/point-of-view/blob/master/index.d.ts
+ * "fastify/view" interfaces
+ * @see https://github.com/fastify/point-of-view/blob/master/types/index.d.ts
+ * @publicApi
  */
-
-export interface PointOfViewOptions {
+export interface FastifyViewOptions {
   engine: {
     ejs?: any;
     eta?: any;
diff --git a/packages/platform-fastify/interfaces/external/index.ts b/packages/platform-fastify/interfaces/external/index.ts
index df4df129f..a80eb8a36 100644
--- a/packages/platform-fastify/interfaces/external/index.ts
+++ b/packages/platform-fastify/interfaces/external/index.ts
@@ -1,2 +1,2 @@
 export * from './fastify-static-options.interface';
-export * from './point-of-view-options.interface';
+export * from './fastify-view-options.interface';
diff --git a/packages/platform-fastify/interfaces/index.ts b/packages/platform-fastify/interfaces/index.ts
index ee1841f2f..ae18b9a3c 100644
--- a/packages/platform-fastify/interfaces/index.ts
+++ b/packages/platform-fastify/interfaces/index.ts
@@ -1 +1,2 @@
 export * from './nest-fastify-application.interface';
+export * from './nest-fastify-body-parser-options.interface';
diff --git a/packages/platform-fastify/interfaces/nest-fastify-application.interface.ts b/packages/platform-fastify/interfaces/nest-fastify-application.interface.ts
index 71908f43a..e77c715fd 100644
--- a/packages/platform-fastify/interfaces/nest-fastify-application.interface.ts
+++ b/packages/platform-fastify/interfaces/nest-fastify-application.interface.ts
@@ -1,19 +1,37 @@
-import { INestApplication } from '@nestjs/common';
+import { INestApplication, HttpServer } from '@nestjs/common';
 import {
+  FastifyBodyParser,
   FastifyInstance,
   FastifyPluginAsync,
   FastifyPluginCallback,
   FastifyPluginOptions,
   FastifyRegisterOptions,
+  FastifyRequest,
+  FastifyReply,
+  RawServerBase,
+  RawServerDefault,
 } from 'fastify';
 import {
   Chain as LightMyRequestChain,
   InjectOptions,
   Response as LightMyRequestResponse,
 } from 'light-my-request';
-import { FastifyStaticOptions, PointOfViewOptions } from './external';
+import { FastifyStaticOptions, FastifyViewOptions } from './external';
+import { NestFastifyBodyParserOptions } from './nest-fastify-body-parser-options.interface';
+
+/**
+ * @publicApi
+ */
+export interface NestFastifyApplication<
+  TServer extends RawServerBase = RawServerDefault,
+> extends INestApplication<TServer> {
+  /**
+   * Returns the underlying HTTP adapter bounded to a Fastify app.
+   *
+   * @returns {HttpServer}
+   */
+  getHttpAdapter(): HttpServer<FastifyRequest, FastifyReply, FastifyInstance>;
 
-export interface NestFastifyApplication extends INestApplication {
   /**
    * A wrapper function around native `fastify.register()` method.
    * Example `app.register(require('@fastify/formbody'))
@@ -28,6 +46,27 @@ export interface NestFastifyApplication extends INestApplication {
     opts?: FastifyRegisterOptions<Options>,
   ): Promise<FastifyInstance>;
 
+  /**
+   * Register Fastify body parsers on the fly. Will respect
+   * the application's `rawBody` option.
+   *
+   * @example
+   * const app = await NestFactory.create<NestFastifyApplication>(
+   *   AppModule,
+   *   new FastifyAdapter(),
+   *   { rawBody: true }
+   * );
+   * // enable the json parser with a parser limit of 50mb
+   * app.useBodyParser('application/json', { bodyLimit: 50 * 1000 * 1024 });
+   *
+   * @returns {this}
+   */
+  useBodyParser<TServer extends RawServerBase = RawServerBase>(
+    type: string | string[] | RegExp,
+    options?: NestFastifyBodyParserOptions,
+    parser?: FastifyBodyParser<Buffer, TServer>,
+  ): this;
+
   /**
    * Sets a base directory for public assets.
    * Example `app.useStaticAssets({ root: 'public' })`
@@ -38,10 +77,10 @@ export interface NestFastifyApplication extends INestApplication {
   /**
    * Sets a view engine for templates (views), for example: `pug`, `handlebars`, or `ejs`.
    *
-   * Don't pass in a string. The string type in the argument is for compatibilility reason and will cause an exception.
+   * Don't pass in a string. The string type in the argument is for compatibility reason and will cause an exception.
    * @returns {this}
    */
-  setViewEngine(options: PointOfViewOptions | string): this;
+  setViewEngine(options: FastifyViewOptions | string): this;
 
   /**
    * A wrapper function around native `fastify.inject()` method.
diff --git a/packages/platform-fastify/interfaces/nest-fastify-body-parser-options.interface.ts b/packages/platform-fastify/interfaces/nest-fastify-body-parser-options.interface.ts
new file mode 100644
index 000000000..9f7ecc054
--- /dev/null
+++ b/packages/platform-fastify/interfaces/nest-fastify-body-parser-options.interface.ts
@@ -0,0 +1,6 @@
+import type { AddContentTypeParser } from 'fastify';
+
+export type NestFastifyBodyParserOptions = Omit<
+  Parameters<AddContentTypeParser>[1],
+  'parseAs'
+>;
diff --git a/packages/platform-fastify/package.json b/packages/platform-fastify/package.json
index 5a8f47967..8a2b0a470 100644
--- a/packages/platform-fastify/package.json
+++ b/packages/platform-fastify/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/platform-fastify",
-  "version": "9.2.0",
+  "version": "9.4.0",
   "description": "Nest - modern, fast, powerful node.js web framework (@platform-fastify)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -17,13 +17,13 @@
     "access": "public"
   },
   "dependencies": {
-    "@fastify/cors": "8.1.1",
-    "@fastify/formbody": "7.3.0",
-    "@fastify/middie": "8.0.0",
-    "fastify": "4.9.2",
-    "light-my-request": "5.6.1",
+    "@fastify/cors": "8.2.1",
+    "@fastify/formbody": "7.4.0",
+    "@fastify/middie": "8.1.0",
+    "fastify": "4.15.0",
+    "light-my-request": "5.9.1",
     "path-to-regexp": "3.2.0",
-    "tslib": "2.4.1"
+    "tslib": "2.5.0"
   },
   "peerDependencies": {
     "@fastify/static": "^6.0.0",
diff --git a/packages/platform-fastify/tsconfig.build.json b/packages/platform-fastify/tsconfig.build.json
new file mode 100644
index 000000000..732ca00cb
--- /dev/null
+++ b/packages/platform-fastify/tsconfig.build.json
@@ -0,0 +1,22 @@
+{
+  "extends": "../tsconfig.build.json",
+  "compilerOptions": {
+    "outDir": ".",
+    "rootDir": ".",
+    "paths": {
+      "@nestjs/common": ["../common"],
+      "@nestjs/common/*": ["../common/*"],
+      "@nestjs/core": ["../core"],
+      "@nestjs/core/*": ["../core/*"]
+    }
+  },
+  "exclude": ["node_modules", "dist", "test/**/*", "*.spec.ts"],
+  "references": [
+    {
+      "path": "../common/tsconfig.build.json"
+    },
+    {
+      "path": "../core/tsconfig.build.json"
+    }
+  ]
+}
diff --git a/packages/platform-fastify/tsconfig.json b/packages/platform-fastify/tsconfig.json
index b238080a4..2ae9e3c90 100644
--- a/packages/platform-fastify/tsconfig.json
+++ b/packages/platform-fastify/tsconfig.json
@@ -1,7 +1,13 @@
 {
-  "extends": "./../tsconfig.base.json",
+  "extends": "../tsconfig.build.json",
   "compilerOptions": {
-    "baseUrl": "./"
+    "types": ["node"]
   },
-  "include": ["*.ts", "**/*.ts"]
+  "files": [],
+  "include": [],
+  "references": [
+    {
+      "path": "./tsconfig.build.json"
+    }
+  ]
 }
diff --git a/packages/platform-socket.io/Readme.md b/packages/platform-socket.io/Readme.md
index 5203ac4c2..16f48336d 100644
--- a/packages/platform-socket.io/Readme.md
+++ b/packages/platform-socket.io/Readme.md
@@ -11,7 +11,6 @@
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
 <a href="https://circleci.com/gh/nestjs/nest" target="_blank"><img src="https://img.shields.io/circleci/build/github/nestjs/nest/master" alt="CircleCI" /></a>
-<a href="https://coveralls.io/github/nestjs/nest?branch=master" target="_blank"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#9" alt="Coverage" /></a>
 <a href="https://discord.gg/G7Qnnhy" target="_blank"><img src="https://img.shields.io/badge/discord-online-brightgreen.svg" alt="Discord"/></a>
 <a href="https://opencollective.com/nest#backer" target="_blank"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
 <a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
@@ -78,7 +77,10 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
  <td>
 <a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
 <a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td><td>
-<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
+<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td>
+<td>
+<a href="https://ridicorp.com/career/" target="_blank"><img src="https://nestjs.com/img/ridi-logo.svg" width="105" valign="middle" /></a></td><td>
+<a href="https://www.movavi.com/imovie-for-windows.html" target="_blank"><img src="https://nestjs.com/img/movavi-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
@@ -91,7 +93,8 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td>
 <td><a href="https://n.inc" target="_blank"><img src="https://nestjs.com/img/n-inc-logo.svg" width="120" valign="middle" /></td></tr><tr>
 <td><a href="https://bilberrry.com/" target="_blank"><img src="https://nestjs.com/img/bilberrry-logo.svg" width="180" valign="middle" /></td>
-<td><a href="https://ipinfo.ai/" target="_blank"><img src="https://nestjs.com/img/ipinfo-logo.png" width="130" valign="middle" /></td></tr>
+<td><a href="https://ipinfo.ai/" target="_blank"><img src="https://nestjs.com/img/ipinfo-logo.png" width="130" valign="middle" /></td>
+<td><a href="https://chax.at" target="_blank"><img src="https://nestjs.com/img/chaxat-logo.png" width="100" valign="middle" /></td></tr>
 </table>
 
 #### Sponsors
@@ -132,7 +135,8 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
    <td align="center" valign="middle"><a href="https://mobilereality.pl/" target="_blank"><img src="https://nestjs.com/img/mobile-reality-logo.png" width="45" valign="middle" /></a></td>
      <td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/boringowl-logo.svg" width="120" valign="middle" /></a></td>
  <td align="center" valign="middle"><a href="https://www.mobilefactory.jp/" target="_blank"><img src="https://nestjs.com/img/mobilefactory-logo.png" width="100" valign="middle" /></a></td>
- <td align="center" valign="middle"><a href="https://db.nordbot.app/" target="_blank"><img src="https://nestjs.com/img/nord-logo.png" width="50" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://nordbot.app/" target="_blank"><img src="https://nestjs.com/img/nordbot-logo.png" width="120" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://doppio.sh/" target="_blank"><img src="https://nestjs.com/img/dopiosh-logo.png" width="50" valign="middle" /></a></td>
   </tr></table>
 
 ## Backers
diff --git a/packages/platform-socket.io/adapters/io-adapter.ts b/packages/platform-socket.io/adapters/io-adapter.ts
index 22eb9155c..d3c8d161d 100644
--- a/packages/platform-socket.io/adapters/io-adapter.ts
+++ b/packages/platform-socket.io/adapters/io-adapter.ts
@@ -8,6 +8,9 @@ import { fromEvent, Observable } from 'rxjs';
 import { filter, first, map, mergeMap, share, takeUntil } from 'rxjs/operators';
 import { Server, ServerOptions, Socket } from 'socket.io';
 
+/**
+ * @publicApi
+ */
 export class IoAdapter extends AbstractWsAdapter {
   public create(
     port: number,
diff --git a/packages/platform-socket.io/index.ts b/packages/platform-socket.io/index.ts
index 2805fc831..434d79eb4 100644
--- a/packages/platform-socket.io/index.ts
+++ b/packages/platform-socket.io/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @platform-socket.io
- * Copyright(c) 2017 - 2022 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2023 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
diff --git a/packages/platform-socket.io/package.json b/packages/platform-socket.io/package.json
index 057b5e2bf..8a1eda801 100644
--- a/packages/platform-socket.io/package.json
+++ b/packages/platform-socket.io/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/platform-socket.io",
-  "version": "9.2.0",
+  "version": "9.4.0",
   "description": "Nest - modern, fast, powerful node.js web framework (@platform-socket.io)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -17,8 +17,8 @@
     "access": "public"
   },
   "dependencies": {
-    "socket.io": "4.5.3",
-    "tslib": "2.4.1"
+    "socket.io": "4.6.1",
+    "tslib": "2.5.0"
   },
   "peerDependencies": {
     "@nestjs/common": "^9.0.0",
diff --git a/packages/platform-socket.io/tsconfig.build.json b/packages/platform-socket.io/tsconfig.build.json
new file mode 100644
index 000000000..b9ccddc22
--- /dev/null
+++ b/packages/platform-socket.io/tsconfig.build.json
@@ -0,0 +1,22 @@
+{
+  "extends": "../tsconfig.build.json",
+  "compilerOptions": {
+    "outDir": ".",
+    "rootDir": ".",
+    "paths": {
+      "@nestjs/common": ["../common"],
+      "@nestjs/common/*": ["../common/*"],
+      "@nestjs/websockets": ["../websockets"],
+      "@nestjs/websockets/*": ["../websockets/*"]
+    }
+  },
+  "exclude": ["node_modules", "dist", "test/**/*", "*.spec.ts"],
+  "references": [
+    {
+      "path": "../common/tsconfig.build.json"
+    },
+    {
+      "path": "../websockets/tsconfig.build.json"
+    }
+  ]
+}
diff --git a/packages/platform-socket.io/tsconfig.json b/packages/platform-socket.io/tsconfig.json
index b238080a4..2ae9e3c90 100644
--- a/packages/platform-socket.io/tsconfig.json
+++ b/packages/platform-socket.io/tsconfig.json
@@ -1,7 +1,13 @@
 {
-  "extends": "./../tsconfig.base.json",
+  "extends": "../tsconfig.build.json",
   "compilerOptions": {
-    "baseUrl": "./"
+    "types": ["node"]
   },
-  "include": ["*.ts", "**/*.ts"]
+  "files": [],
+  "include": [],
+  "references": [
+    {
+      "path": "./tsconfig.build.json"
+    }
+  ]
 }
diff --git a/packages/platform-ws/Readme.md b/packages/platform-ws/Readme.md
index 5203ac4c2..16f48336d 100644
--- a/packages/platform-ws/Readme.md
+++ b/packages/platform-ws/Readme.md
@@ -11,7 +11,6 @@
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
 <a href="https://circleci.com/gh/nestjs/nest" target="_blank"><img src="https://img.shields.io/circleci/build/github/nestjs/nest/master" alt="CircleCI" /></a>
-<a href="https://coveralls.io/github/nestjs/nest?branch=master" target="_blank"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#9" alt="Coverage" /></a>
 <a href="https://discord.gg/G7Qnnhy" target="_blank"><img src="https://img.shields.io/badge/discord-online-brightgreen.svg" alt="Discord"/></a>
 <a href="https://opencollective.com/nest#backer" target="_blank"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
 <a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
@@ -78,7 +77,10 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
  <td>
 <a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
 <a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td><td>
-<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
+<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td>
+<td>
+<a href="https://ridicorp.com/career/" target="_blank"><img src="https://nestjs.com/img/ridi-logo.svg" width="105" valign="middle" /></a></td><td>
+<a href="https://www.movavi.com/imovie-for-windows.html" target="_blank"><img src="https://nestjs.com/img/movavi-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
@@ -91,7 +93,8 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td>
 <td><a href="https://n.inc" target="_blank"><img src="https://nestjs.com/img/n-inc-logo.svg" width="120" valign="middle" /></td></tr><tr>
 <td><a href="https://bilberrry.com/" target="_blank"><img src="https://nestjs.com/img/bilberrry-logo.svg" width="180" valign="middle" /></td>
-<td><a href="https://ipinfo.ai/" target="_blank"><img src="https://nestjs.com/img/ipinfo-logo.png" width="130" valign="middle" /></td></tr>
+<td><a href="https://ipinfo.ai/" target="_blank"><img src="https://nestjs.com/img/ipinfo-logo.png" width="130" valign="middle" /></td>
+<td><a href="https://chax.at" target="_blank"><img src="https://nestjs.com/img/chaxat-logo.png" width="100" valign="middle" /></td></tr>
 </table>
 
 #### Sponsors
@@ -132,7 +135,8 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
    <td align="center" valign="middle"><a href="https://mobilereality.pl/" target="_blank"><img src="https://nestjs.com/img/mobile-reality-logo.png" width="45" valign="middle" /></a></td>
      <td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/boringowl-logo.svg" width="120" valign="middle" /></a></td>
  <td align="center" valign="middle"><a href="https://www.mobilefactory.jp/" target="_blank"><img src="https://nestjs.com/img/mobilefactory-logo.png" width="100" valign="middle" /></a></td>
- <td align="center" valign="middle"><a href="https://db.nordbot.app/" target="_blank"><img src="https://nestjs.com/img/nord-logo.png" width="50" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://nordbot.app/" target="_blank"><img src="https://nestjs.com/img/nordbot-logo.png" width="120" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://doppio.sh/" target="_blank"><img src="https://nestjs.com/img/dopiosh-logo.png" width="50" valign="middle" /></a></td>
   </tr></table>
 
 ## Backers
diff --git a/packages/platform-ws/adapters/ws-adapter.ts b/packages/platform-ws/adapters/ws-adapter.ts
index 973bce7b9..d0791be91 100644
--- a/packages/platform-ws/adapters/ws-adapter.ts
+++ b/packages/platform-ws/adapters/ws-adapter.ts
@@ -1,5 +1,6 @@
 import { INestApplicationContext, Logger } from '@nestjs/common';
 import { loadPackage } from '@nestjs/common/utils/load-package.util';
+import { normalizePath, isNil } from '@nestjs/common/utils/shared.utils';
 import { AbstractWsAdapter } from '@nestjs/websockets';
 import {
   CLOSE_EVENT,
@@ -27,6 +28,9 @@ type WsServerRegistryEntry = any[];
 
 const UNDERLYING_HTTP_SERVER_PORT = 0;
 
+/**
+ * @publicApi
+ */
 export class WsAdapter extends AbstractWsAdapter {
   protected readonly logger = new Logger(WsAdapter.name);
   protected readonly httpServersRegistry = new Map<
@@ -45,9 +49,13 @@ export class WsAdapter extends AbstractWsAdapter {
 
   public create(
     port: number,
-    options?: Record<string, any> & { namespace?: string; server?: any },
+    options?: Record<string, any> & {
+      namespace?: string;
+      server?: any;
+      path?: string;
+    },
   ) {
-    const { server, ...wsOptions } = options;
+    const { server, path, ...wsOptions } = options;
     if (wsOptions?.namespace) {
       const error = new Error(
         '"WsAdapter" does not support namespaces. If you need namespaces in your project, consider using the "@nestjs/platform-socket.io" package instead.',
@@ -65,14 +73,14 @@ export class WsAdapter extends AbstractWsAdapter {
         }),
       );
 
-      this.addWsServerToRegistry(wsServer, port, options.path || '/');
+      this.addWsServerToRegistry(wsServer, port, path);
       return wsServer;
     }
 
     if (server) {
       return server;
     }
-    if (options.path && port !== UNDERLYING_HTTP_SERVER_PORT) {
+    if (path && port !== UNDERLYING_HTTP_SERVER_PORT) {
       // Multiple servers with different paths
       // sharing a single HTTP/S server running on different port
       // than a regular HTTP application
@@ -85,12 +93,13 @@ export class WsAdapter extends AbstractWsAdapter {
           ...wsOptions,
         }),
       );
-      this.addWsServerToRegistry(wsServer, port, options.path);
+      this.addWsServerToRegistry(wsServer, port, path);
       return wsServer;
     }
     const wsServer = this.bindErrorHandler(
       new wsPackage.Server({
         port,
+        path,
         ...wsOptions,
       }),
     );
@@ -106,7 +115,7 @@ export class WsAdapter extends AbstractWsAdapter {
     const source$ = fromEvent(client, 'message').pipe(
       mergeMap(data =>
         this.bindMessageHandler(data, handlers, transform).pipe(
-          filter(result => result),
+          filter(result => !isNil(result)),
         ),
       ),
       takeUntil(close$),
@@ -198,7 +207,7 @@ export class WsAdapter extends AbstractWsAdapter {
     const entries = this.wsServersRegistry.get(port) ?? [];
     entries.push(wsServer);
 
-    wsServer.path = path;
+    wsServer.path = normalizePath(path);
     this.wsServersRegistry.set(port, entries);
   }
 }
diff --git a/packages/platform-ws/index.ts b/packages/platform-ws/index.ts
index 0fb20dd10..e83223e11 100644
--- a/packages/platform-ws/index.ts
+++ b/packages/platform-ws/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @platform-ws
- * Copyright(c) 2017 - 2022 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2023 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
diff --git a/packages/platform-ws/package.json b/packages/platform-ws/package.json
index 495095fbc..9410fb4b2 100644
--- a/packages/platform-ws/package.json
+++ b/packages/platform-ws/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/platform-ws",
-  "version": "9.2.0",
+  "version": "9.4.0",
   "description": "Nest - modern, fast, powerful node.js web framework (@platform-ws)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -17,8 +17,8 @@
     "access": "public"
   },
   "dependencies": {
-    "tslib": "2.4.1",
-    "ws": "8.11.0"
+    "tslib": "2.5.0",
+    "ws": "8.13.0"
   },
   "peerDependencies": {
     "@nestjs/common": "^9.0.0",
diff --git a/packages/platform-ws/tsconfig.build.json b/packages/platform-ws/tsconfig.build.json
new file mode 100644
index 000000000..b9ccddc22
--- /dev/null
+++ b/packages/platform-ws/tsconfig.build.json
@@ -0,0 +1,22 @@
+{
+  "extends": "../tsconfig.build.json",
+  "compilerOptions": {
+    "outDir": ".",
+    "rootDir": ".",
+    "paths": {
+      "@nestjs/common": ["../common"],
+      "@nestjs/common/*": ["../common/*"],
+      "@nestjs/websockets": ["../websockets"],
+      "@nestjs/websockets/*": ["../websockets/*"]
+    }
+  },
+  "exclude": ["node_modules", "dist", "test/**/*", "*.spec.ts"],
+  "references": [
+    {
+      "path": "../common/tsconfig.build.json"
+    },
+    {
+      "path": "../websockets/tsconfig.build.json"
+    }
+  ]
+}
diff --git a/packages/platform-ws/tsconfig.json b/packages/platform-ws/tsconfig.json
index b238080a4..2ae9e3c90 100644
--- a/packages/platform-ws/tsconfig.json
+++ b/packages/platform-ws/tsconfig.json
@@ -1,7 +1,13 @@
 {
-  "extends": "./../tsconfig.base.json",
+  "extends": "../tsconfig.build.json",
   "compilerOptions": {
-    "baseUrl": "./"
+    "types": ["node"]
   },
-  "include": ["*.ts", "**/*.ts"]
+  "files": [],
+  "include": [],
+  "references": [
+    {
+      "path": "./tsconfig.build.json"
+    }
+  ]
 }
diff --git a/packages/testing/Readme.md b/packages/testing/Readme.md
index 5203ac4c2..16f48336d 100644
--- a/packages/testing/Readme.md
+++ b/packages/testing/Readme.md
@@ -11,7 +11,6 @@
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
 <a href="https://circleci.com/gh/nestjs/nest" target="_blank"><img src="https://img.shields.io/circleci/build/github/nestjs/nest/master" alt="CircleCI" /></a>
-<a href="https://coveralls.io/github/nestjs/nest?branch=master" target="_blank"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#9" alt="Coverage" /></a>
 <a href="https://discord.gg/G7Qnnhy" target="_blank"><img src="https://img.shields.io/badge/discord-online-brightgreen.svg" alt="Discord"/></a>
 <a href="https://opencollective.com/nest#backer" target="_blank"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
 <a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
@@ -78,7 +77,10 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
  <td>
 <a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
 <a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td><td>
-<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
+<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td>
+<td>
+<a href="https://ridicorp.com/career/" target="_blank"><img src="https://nestjs.com/img/ridi-logo.svg" width="105" valign="middle" /></a></td><td>
+<a href="https://www.movavi.com/imovie-for-windows.html" target="_blank"><img src="https://nestjs.com/img/movavi-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
@@ -91,7 +93,8 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td>
 <td><a href="https://n.inc" target="_blank"><img src="https://nestjs.com/img/n-inc-logo.svg" width="120" valign="middle" /></td></tr><tr>
 <td><a href="https://bilberrry.com/" target="_blank"><img src="https://nestjs.com/img/bilberrry-logo.svg" width="180" valign="middle" /></td>
-<td><a href="https://ipinfo.ai/" target="_blank"><img src="https://nestjs.com/img/ipinfo-logo.png" width="130" valign="middle" /></td></tr>
+<td><a href="https://ipinfo.ai/" target="_blank"><img src="https://nestjs.com/img/ipinfo-logo.png" width="130" valign="middle" /></td>
+<td><a href="https://chax.at" target="_blank"><img src="https://nestjs.com/img/chaxat-logo.png" width="100" valign="middle" /></td></tr>
 </table>
 
 #### Sponsors
@@ -132,7 +135,8 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
    <td align="center" valign="middle"><a href="https://mobilereality.pl/" target="_blank"><img src="https://nestjs.com/img/mobile-reality-logo.png" width="45" valign="middle" /></a></td>
      <td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/boringowl-logo.svg" width="120" valign="middle" /></a></td>
  <td align="center" valign="middle"><a href="https://www.mobilefactory.jp/" target="_blank"><img src="https://nestjs.com/img/mobilefactory-logo.png" width="100" valign="middle" /></a></td>
- <td align="center" valign="middle"><a href="https://db.nordbot.app/" target="_blank"><img src="https://nestjs.com/img/nord-logo.png" width="50" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://nordbot.app/" target="_blank"><img src="https://nestjs.com/img/nordbot-logo.png" width="120" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://doppio.sh/" target="_blank"><img src="https://nestjs.com/img/dopiosh-logo.png" width="50" valign="middle" /></a></td>
   </tr></table>
 
 ## Backers
diff --git a/packages/testing/index.ts b/packages/testing/index.ts
index 0a4a47f73..d760d09f7 100644
--- a/packages/testing/index.ts
+++ b/packages/testing/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @testing
- * Copyright(c) 2017 - 2022 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2023 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
diff --git a/packages/testing/interfaces/mock-factory.ts b/packages/testing/interfaces/mock-factory.ts
index 6dc400fb1..0b67435ea 100644
--- a/packages/testing/interfaces/mock-factory.ts
+++ b/packages/testing/interfaces/mock-factory.ts
@@ -1,3 +1,3 @@
-import { InstanceToken } from '@nestjs/core/injector/module';
+import { InjectionToken } from '@nestjs/common';
 
-export type MockFactory = (token?: InstanceToken) => any;
+export type MockFactory = (token?: InjectionToken) => any;
diff --git a/packages/testing/interfaces/override-by-factory-options.interface.ts b/packages/testing/interfaces/override-by-factory-options.interface.ts
index 59a78d657..a2d58ec91 100644
--- a/packages/testing/interfaces/override-by-factory-options.interface.ts
+++ b/packages/testing/interfaces/override-by-factory-options.interface.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export interface OverrideByFactoryOptions {
   factory: (...args: any[]) => any;
   inject?: any[];
diff --git a/packages/testing/interfaces/override-by.interface.ts b/packages/testing/interfaces/override-by.interface.ts
index 25fc60a95..fafc82e46 100644
--- a/packages/testing/interfaces/override-by.interface.ts
+++ b/packages/testing/interfaces/override-by.interface.ts
@@ -1,6 +1,9 @@
 import { TestingModuleBuilder } from '../testing-module.builder';
 import { OverrideByFactoryOptions } from './override-by-factory-options.interface';
 
+/**
+ * @publicApi
+ */
 export interface OverrideBy {
   useValue: (value: any) => TestingModuleBuilder;
   useFactory: (options: OverrideByFactoryOptions) => TestingModuleBuilder;
diff --git a/packages/testing/package.json b/packages/testing/package.json
index 2733cf44a..81c012bb0 100644
--- a/packages/testing/package.json
+++ b/packages/testing/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/testing",
-  "version": "9.2.0",
+  "version": "9.4.0",
   "description": "Nest - modern, fast, powerful node.js web framework (@testing)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -17,7 +17,7 @@
     "access": "public"
   },
   "dependencies": {
-    "tslib": "2.4.1"
+    "tslib": "2.5.0"
   },
   "peerDependencies": {
     "@nestjs/common": "^9.0.0",
diff --git a/packages/testing/services/testing-logger.service.ts b/packages/testing/services/testing-logger.service.ts
index 1e7b44b2a..3e4b89bf8 100644
--- a/packages/testing/services/testing-logger.service.ts
+++ b/packages/testing/services/testing-logger.service.ts
@@ -2,6 +2,9 @@
 /* eslint-disable @typescript-eslint/no-unused-vars */
 import { ConsoleLogger } from '@nestjs/common';
 
+/**
+ * @publicApi
+ */
 export class TestingLogger extends ConsoleLogger {
   constructor() {
     super('Testing');
diff --git a/packages/testing/testing-injector.ts b/packages/testing/testing-injector.ts
index 417ef295c..4847e4122 100644
--- a/packages/testing/testing-injector.ts
+++ b/packages/testing/testing-injector.ts
@@ -8,6 +8,9 @@ import { InstanceWrapper } from '@nestjs/core/injector/instance-wrapper';
 import { Module } from '@nestjs/core/injector/module';
 import { MockFactory } from './interfaces';
 
+/**
+ * @publicApi
+ */
 export class TestingInjector extends Injector {
   protected mocker?: MockFactory;
   protected container: NestContainer;
diff --git a/packages/testing/testing-instance-loader.ts b/packages/testing/testing-instance-loader.ts
index e11062210..6c4aead48 100644
--- a/packages/testing/testing-instance-loader.ts
+++ b/packages/testing/testing-instance-loader.ts
@@ -3,9 +3,7 @@ import { Module } from '@nestjs/core/injector/module';
 import { MockFactory } from './interfaces';
 import { TestingInjector } from './testing-injector';
 
-export class TestingInstanceLoader extends InstanceLoader {
-  protected injector = new TestingInjector();
-
+export class TestingInstanceLoader extends InstanceLoader<TestingInjector> {
   public async createInstancesOfDependencies(
     modules: Map<string, Module> = this.container.getModules(),
     mocker?: MockFactory,
diff --git a/packages/testing/testing-module.builder.ts b/packages/testing/testing-module.builder.ts
index e72f67785..673d7455d 100644
--- a/packages/testing/testing-module.builder.ts
+++ b/packages/testing/testing-module.builder.ts
@@ -1,7 +1,13 @@
-import { Logger, LoggerService, Module } from '@nestjs/common';
-import { ModuleMetadata } from '@nestjs/common/interfaces';
+import { Logger, LoggerService, Module, ModuleMetadata } from '@nestjs/common';
+import { NestApplicationContextOptions } from '@nestjs/common/interfaces/nest-application-context-options.interface';
 import { ApplicationConfig } from '@nestjs/core/application-config';
 import { NestContainer } from '@nestjs/core/injector/container';
+import { GraphInspector } from '@nestjs/core/inspector/graph-inspector';
+import { NoopGraphInspector } from '@nestjs/core/inspector/noop-graph-inspector';
+import {
+  UuidFactory,
+  UuidFactoryMode,
+} from '@nestjs/core/inspector/uuid-factory';
 import { MetadataScanner } from '@nestjs/core/metadata-scanner';
 import { DependenciesScanner } from '@nestjs/core/scanner';
 import {
@@ -10,25 +16,25 @@ import {
   OverrideByFactoryOptions,
 } from './interfaces';
 import { TestingLogger } from './services/testing-logger.service';
+import { TestingInjector } from './testing-injector';
 import { TestingInstanceLoader } from './testing-instance-loader';
 import { TestingModule } from './testing-module';
 
+/**
+ * @publicApi
+ */
 export class TestingModuleBuilder {
   private readonly applicationConfig = new ApplicationConfig();
   private readonly container = new NestContainer(this.applicationConfig);
   private readonly overloadsMap = new Map();
-  private readonly scanner: DependenciesScanner;
-  private readonly instanceLoader = new TestingInstanceLoader(this.container);
   private readonly module: any;
   private testingLogger: LoggerService;
   private mocker?: MockFactory;
 
-  constructor(metadataScanner: MetadataScanner, metadata: ModuleMetadata) {
-    this.scanner = new DependenciesScanner(
-      this.container,
-      metadataScanner,
-      this.applicationConfig,
-    );
+  constructor(
+    private readonly metadataScanner: MetadataScanner,
+    metadata: ModuleMetadata,
+  ) {
     this.module = this.createModule(metadata);
   }
 
@@ -62,19 +68,39 @@ export class TestingModuleBuilder {
     return this.override(typeOrToken, true);
   }
 
-  public async compile(): Promise<TestingModule> {
+  public async compile(
+    options: Pick<NestApplicationContextOptions, 'snapshot' | 'preview'> = {},
+  ): Promise<TestingModule> {
     this.applyLogger();
-    await this.scanner.scan(this.module);
 
-    this.applyOverloadsMap();
-    await this.instanceLoader.createInstancesOfDependencies(
-      this.container.getModules(),
-      this.mocker,
+    let graphInspector: GraphInspector;
+    if (options?.snapshot) {
+      graphInspector = new GraphInspector(this.container);
+      UuidFactory.mode = UuidFactoryMode.Deterministic;
+    } else {
+      graphInspector = NoopGraphInspector;
+      UuidFactory.mode = UuidFactoryMode.Random;
+    }
+
+    const scanner = new DependenciesScanner(
+      this.container,
+      this.metadataScanner,
+      graphInspector,
+      this.applicationConfig,
     );
-    this.scanner.applyApplicationProviders();
+    await scanner.scan(this.module);
+
+    this.applyOverloadsMap();
+    await this.createInstancesOfDependencies(graphInspector, options);
+    scanner.applyApplicationProviders();
 
     const root = this.getRootModule();
-    return new TestingModule(this.container, [], root, this.applicationConfig);
+    return new TestingModule(
+      this.container,
+      graphInspector,
+      root,
+      this.applicationConfig,
+    );
   }
 
   private override<T = any>(typeOrToken: T, isProvider: boolean): OverrideBy {
@@ -110,6 +136,24 @@ export class TestingModuleBuilder {
     return modules.next().value;
   }
 
+  private async createInstancesOfDependencies(
+    graphInspector: GraphInspector,
+    options: { preview?: boolean },
+  ) {
+    const injector = new TestingInjector({
+      preview: options?.preview ?? false,
+    });
+    const instanceLoader = new TestingInstanceLoader(
+      this.container,
+      injector,
+      graphInspector,
+    );
+    await instanceLoader.createInstancesOfDependencies(
+      this.container.getModules(),
+      this.mocker,
+    );
+  }
+
   private createModule(metadata: ModuleMetadata) {
     class RootTestModule {}
     Module(metadata)(RootTestModule);
diff --git a/packages/testing/testing-module.ts b/packages/testing/testing-module.ts
index ec632c453..79d2e86c3 100644
--- a/packages/testing/testing-module.ts
+++ b/packages/testing/testing-module.ts
@@ -18,15 +18,25 @@ import {
 import { ApplicationConfig } from '@nestjs/core/application-config';
 import { NestContainer } from '@nestjs/core/injector/container';
 import { Module } from '@nestjs/core/injector/module';
+import { GraphInspector } from '@nestjs/core/inspector/graph-inspector';
 
+/**
+ * @publicApi
+ */
 export class TestingModule extends NestApplicationContext {
+  protected readonly graphInspector: GraphInspector;
+
   constructor(
     container: NestContainer,
-    scope: Type<any>[],
+    graphInspector: GraphInspector,
     contextModule: Module,
     private readonly applicationConfig: ApplicationConfig,
+    scope: Type<any>[] = [],
   ) {
-    super(container, scope, contextModule);
+    const options = {};
+    super(container, options, contextModule, scope);
+
+    this.graphInspector = graphInspector;
   }
 
   private isHttpServer(
@@ -65,6 +75,7 @@ export class TestingModule extends NestApplicationContext {
       this.container,
       httpAdapter,
       this.applicationConfig,
+      this.graphInspector,
       appOptions,
     );
     return this.createAdapterProxy<T>(instance, httpAdapter);
@@ -82,6 +93,7 @@ export class TestingModule extends NestApplicationContext {
     return new NestMicroservice(
       this.container,
       options,
+      this.graphInspector,
       this.applicationConfig,
     );
   }
diff --git a/packages/testing/tsconfig.build.json b/packages/testing/tsconfig.build.json
new file mode 100644
index 000000000..a5a3a6305
--- /dev/null
+++ b/packages/testing/tsconfig.build.json
@@ -0,0 +1,32 @@
+{
+  "extends": "../tsconfig.build.json",
+  "compilerOptions": {
+    "outDir": ".",
+    "rootDir": ".",
+    "paths": {
+      "@nestjs/common": ["../common"],
+      "@nestjs/common/*": ["../common/*"],
+      "@nestjs/core": ["../core"],
+      "@nestjs/core/*": ["../core/*"],
+      "@nestjs/microservices": ["../microservices"],
+      "@nestjs/microservices/*": ["../microservices/*"],
+      "@nestjs/platform-express": ["../platform-express"],
+      "@nestjs/platform-express/*": ["../platform-express/*"]
+    }
+  },
+  "exclude": ["node_modules", "dist", "test/**/*", "*.spec.ts"],
+  "references": [
+    {
+      "path": "../common/tsconfig.build.json"
+    },
+    {
+      "path": "../core/tsconfig.build.json"
+    },
+    {
+      "path": "../microservices/tsconfig.build.json"
+    },
+    {
+      "path": "../platform-express/tsconfig.build.json"
+    }
+  ]
+}
diff --git a/packages/testing/tsconfig.json b/packages/testing/tsconfig.json
index b238080a4..2ae9e3c90 100644
--- a/packages/testing/tsconfig.json
+++ b/packages/testing/tsconfig.json
@@ -1,7 +1,13 @@
 {
-  "extends": "./../tsconfig.base.json",
+  "extends": "../tsconfig.build.json",
   "compilerOptions": {
-    "baseUrl": "./"
+    "types": ["node"]
   },
-  "include": ["*.ts", "**/*.ts"]
+  "files": [],
+  "include": [],
+  "references": [
+    {
+      "path": "./tsconfig.build.json"
+    }
+  ]
 }
diff --git a/packages/tsconfig.base.json b/packages/tsconfig.build.json
similarity index 83%
rename from packages/tsconfig.base.json
rename to packages/tsconfig.build.json
index d8d4c2be0..f91353d5b 100644
--- a/packages/tsconfig.base.json
+++ b/packages/tsconfig.build.json
@@ -1,10 +1,10 @@
 {
   "compilerOptions": {
+    "composite": true,
     "module": "commonjs",
     "declaration": true,
     "noImplicitAny": false,
     "skipLibCheck": true,
-    "suppressImplicitAnyIndexErrors": true,
     "noUnusedLocals": false,
     "importHelpers": true,
     "removeComments": false,
@@ -18,6 +18,5 @@
     "strict": true,
     "strictNullChecks": false,
     "types": ["node"]
-  },
-  "exclude": ["../node_modules", "./**/*.spec.ts"]
+  }
 }
diff --git a/packages/tsconfig.json b/packages/tsconfig.json
new file mode 100644
index 000000000..b980bbe84
--- /dev/null
+++ b/packages/tsconfig.json
@@ -0,0 +1,32 @@
+{
+  "files": [],
+  "references": [
+    {
+      "path": "./common/tsconfig.build.json"
+    },
+    {
+      "path": "./core/tsconfig.build.json"
+    },
+    {
+      "path": "./microservices/tsconfig.build.json"
+    },
+    {
+      "path": "./platform-express/tsconfig.build.json"
+    },
+    {
+      "path": "./platform-fastify/tsconfig.build.json"
+    },
+    {
+      "path": "./platform-socket.io/tsconfig.build.json"
+    },
+    {
+      "path": "./platform-ws/tsconfig.build.json"
+    },
+    {
+      "path": "./testing/tsconfig.build.json"
+    },
+    {
+      "path": "./websockets/tsconfig.build.json"
+    }
+  ]
+}
diff --git a/packages/websockets/Readme.md b/packages/websockets/Readme.md
index 5203ac4c2..16f48336d 100644
--- a/packages/websockets/Readme.md
+++ b/packages/websockets/Readme.md
@@ -11,7 +11,6 @@
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
 <a href="https://circleci.com/gh/nestjs/nest" target="_blank"><img src="https://img.shields.io/circleci/build/github/nestjs/nest/master" alt="CircleCI" /></a>
-<a href="https://coveralls.io/github/nestjs/nest?branch=master" target="_blank"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#9" alt="Coverage" /></a>
 <a href="https://discord.gg/G7Qnnhy" target="_blank"><img src="https://img.shields.io/badge/discord-online-brightgreen.svg" alt="Discord"/></a>
 <a href="https://opencollective.com/nest#backer" target="_blank"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
 <a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
@@ -78,7 +77,10 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
  <td>
 <a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
 <a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td><td>
-<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
+<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td>
+<td>
+<a href="https://ridicorp.com/career/" target="_blank"><img src="https://nestjs.com/img/ridi-logo.svg" width="105" valign="middle" /></a></td><td>
+<a href="https://www.movavi.com/imovie-for-windows.html" target="_blank"><img src="https://nestjs.com/img/movavi-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
@@ -91,7 +93,8 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td>
 <td><a href="https://n.inc" target="_blank"><img src="https://nestjs.com/img/n-inc-logo.svg" width="120" valign="middle" /></td></tr><tr>
 <td><a href="https://bilberrry.com/" target="_blank"><img src="https://nestjs.com/img/bilberrry-logo.svg" width="180" valign="middle" /></td>
-<td><a href="https://ipinfo.ai/" target="_blank"><img src="https://nestjs.com/img/ipinfo-logo.png" width="130" valign="middle" /></td></tr>
+<td><a href="https://ipinfo.ai/" target="_blank"><img src="https://nestjs.com/img/ipinfo-logo.png" width="130" valign="middle" /></td>
+<td><a href="https://chax.at" target="_blank"><img src="https://nestjs.com/img/chaxat-logo.png" width="100" valign="middle" /></td></tr>
 </table>
 
 #### Sponsors
@@ -132,7 +135,8 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
    <td align="center" valign="middle"><a href="https://mobilereality.pl/" target="_blank"><img src="https://nestjs.com/img/mobile-reality-logo.png" width="45" valign="middle" /></a></td>
      <td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/boringowl-logo.svg" width="120" valign="middle" /></a></td>
  <td align="center" valign="middle"><a href="https://www.mobilefactory.jp/" target="_blank"><img src="https://nestjs.com/img/mobilefactory-logo.png" width="100" valign="middle" /></a></td>
- <td align="center" valign="middle"><a href="https://db.nordbot.app/" target="_blank"><img src="https://nestjs.com/img/nord-logo.png" width="50" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://nordbot.app/" target="_blank"><img src="https://nestjs.com/img/nordbot-logo.png" width="120" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://doppio.sh/" target="_blank"><img src="https://nestjs.com/img/dopiosh-logo.png" width="50" valign="middle" /></a></td>
   </tr></table>
 
 ## Backers
diff --git a/packages/websockets/context/exception-filters-context.ts b/packages/websockets/context/exception-filters-context.ts
index 319aedc54..6ec95a1f9 100644
--- a/packages/websockets/context/exception-filters-context.ts
+++ b/packages/websockets/context/exception-filters-context.ts
@@ -4,6 +4,9 @@ import { BaseExceptionFilterContext } from '@nestjs/core/exceptions/base-excepti
 import { NestContainer } from '@nestjs/core/injector/container';
 import { WsExceptionsHandler } from '../exceptions/ws-exceptions-handler';
 
+/**
+ * @publicApi
+ */
 export class ExceptionFiltersContext extends BaseExceptionFilterContext {
   constructor(container: NestContainer) {
     super(container);
diff --git a/packages/websockets/context/ws-context-creator.ts b/packages/websockets/context/ws-context-creator.ts
index 7d575ef46..3dca71f95 100644
--- a/packages/websockets/context/ws-context-creator.ts
+++ b/packages/websockets/context/ws-context-creator.ts
@@ -18,10 +18,11 @@ import {
 import { ExecutionContextHost } from '@nestjs/core/helpers/execution-context-host';
 import { HandlerMetadataStorage } from '@nestjs/core/helpers/handler-metadata-storage';
 import { ParamsMetadata } from '@nestjs/core/helpers/interfaces';
-import { InterceptorsConsumer } from '@nestjs/core/interceptors/interceptors-consumer';
-import { InterceptorsContextCreator } from '@nestjs/core/interceptors/interceptors-context-creator';
-import { PipesConsumer } from '@nestjs/core/pipes/pipes-consumer';
-import { PipesContextCreator } from '@nestjs/core/pipes/pipes-context-creator';
+import {
+  InterceptorsConsumer,
+  InterceptorsContextCreator,
+} from '@nestjs/core/interceptors';
+import { PipesConsumer, PipesContextCreator } from '@nestjs/core/pipes';
 import { PARAM_ARGS_METADATA } from '../constants';
 import { WsException } from '../errors/ws-exception';
 import { WsParamsFactory } from '../factories/ws-params-factory';
diff --git a/packages/websockets/decorators/connected-socket.decorator.ts b/packages/websockets/decorators/connected-socket.decorator.ts
index 32bd663c7..c21e4f8a1 100644
--- a/packages/websockets/decorators/connected-socket.decorator.ts
+++ b/packages/websockets/decorators/connected-socket.decorator.ts
@@ -1,6 +1,9 @@
 import { WsParamtype } from '../enums/ws-paramtype.enum';
 import { createWsParamDecorator } from '../utils/param.utils';
 
+/**
+ * @publicApi
+ */
 export const ConnectedSocket: () => ParameterDecorator = createWsParamDecorator(
   WsParamtype.SOCKET,
 );
diff --git a/packages/websockets/decorators/gateway-server.decorator.ts b/packages/websockets/decorators/gateway-server.decorator.ts
index a3a21b634..3a0832639 100644
--- a/packages/websockets/decorators/gateway-server.decorator.ts
+++ b/packages/websockets/decorators/gateway-server.decorator.ts
@@ -2,6 +2,8 @@ import { GATEWAY_SERVER_METADATA } from '../constants';
 
 /**
  * Attaches native Web Socket Server to a given property.
+ *
+ * @publicApi
  */
 export const WebSocketServer = (): PropertyDecorator => {
   return (target: object, propertyKey: string | symbol) => {
diff --git a/packages/websockets/decorators/socket-gateway.decorator.ts b/packages/websockets/decorators/socket-gateway.decorator.ts
index 4361b121d..8fc1c9bae 100644
--- a/packages/websockets/decorators/socket-gateway.decorator.ts
+++ b/packages/websockets/decorators/socket-gateway.decorator.ts
@@ -4,6 +4,8 @@ import { GatewayMetadata } from '../interfaces';
 /**
  * Decorator that marks a class as a Nest gateway that enables real-time, bidirectional
  * and event-based communication between the browser and the server.
+ *
+ * @publicApi
  */
 export function WebSocketGateway(port?: number): ClassDecorator;
 export function WebSocketGateway<
diff --git a/packages/websockets/decorators/subscribe-message.decorator.ts b/packages/websockets/decorators/subscribe-message.decorator.ts
index 2b22c9376..4e3329900 100644
--- a/packages/websockets/decorators/subscribe-message.decorator.ts
+++ b/packages/websockets/decorators/subscribe-message.decorator.ts
@@ -2,6 +2,8 @@ import { MESSAGE_MAPPING_METADATA, MESSAGE_METADATA } from '../constants';
 
 /**
  * Subscribes to messages that fulfils chosen pattern.
+ *
+ * @publicApi
  */
 export const SubscribeMessage = <T = string>(message: T): MethodDecorator => {
   return (
diff --git a/packages/websockets/exceptions/base-ws-exception-filter.ts b/packages/websockets/exceptions/base-ws-exception-filter.ts
index 5c29d5a03..bcc48b0a6 100644
--- a/packages/websockets/exceptions/base-ws-exception-filter.ts
+++ b/packages/websockets/exceptions/base-ws-exception-filter.ts
@@ -3,6 +3,9 @@ import { isObject } from '@nestjs/common/utils/shared.utils';
 import { MESSAGES } from '@nestjs/core/constants';
 import { WsException } from '../errors/ws-exception';
 
+/**
+ * @publicApi
+ */
 export class BaseWsExceptionFilter<TError = any>
   implements WsExceptionFilter<TError>
 {
diff --git a/packages/websockets/exceptions/ws-exceptions-handler.ts b/packages/websockets/exceptions/ws-exceptions-handler.ts
index e1b09589d..feed7d397 100644
--- a/packages/websockets/exceptions/ws-exceptions-handler.ts
+++ b/packages/websockets/exceptions/ws-exceptions-handler.ts
@@ -1,10 +1,14 @@
+import { isEmpty } from '@nestjs/common/utils/shared.utils';
 import { ArgumentsHost } from '@nestjs/common';
 import { ExceptionFilterMetadata } from '@nestjs/common/interfaces/exceptions/exception-filter-metadata.interface';
-import { isEmpty } from '@nestjs/common/utils/shared.utils';
+import { selectExceptionFilterMetadata } from '@nestjs/common/utils/select-exception-filter-metadata.util';
 import { InvalidExceptionFilterException } from '@nestjs/core/errors/exceptions/invalid-exception-filter.exception';
 import { WsException } from '../errors/ws-exception';
 import { BaseWsExceptionFilter } from './base-ws-exception-filter';
 
+/**
+ * @publicApi
+ */
 export class WsExceptionsHandler extends BaseWsExceptionFilter {
   private filters: ExceptionFilterMetadata[] = [];
 
@@ -29,14 +33,7 @@ export class WsExceptionsHandler extends BaseWsExceptionFilter {
   ): boolean {
     if (isEmpty(this.filters)) return false;
 
-    const filter = this.filters.find(({ exceptionMetatypes }) => {
-      const hasMetatype =
-        !exceptionMetatypes.length ||
-        exceptionMetatypes.some(
-          ExceptionMetatype => exception instanceof ExceptionMetatype,
-        );
-      return hasMetatype;
-    });
+    const filter = selectExceptionFilterMetadata(this.filters, exception);
     filter && filter.func(exception, args);
     return !!filter;
   }
diff --git a/packages/websockets/gateway-metadata-explorer.ts b/packages/websockets/gateway-metadata-explorer.ts
index dc20cfbe3..65a0c4077 100644
--- a/packages/websockets/gateway-metadata-explorer.ts
+++ b/packages/websockets/gateway-metadata-explorer.ts
@@ -19,12 +19,10 @@ export class GatewayMetadataExplorer {
 
   public explore(instance: NestGateway): MessageMappingProperties[] {
     const instancePrototype = Object.getPrototypeOf(instance);
-    return this.metadataScanner.scanFromPrototype<
-      NestGateway,
-      MessageMappingProperties
-    >(instance, instancePrototype, method =>
-      this.exploreMethodMetadata(instancePrototype, method),
-    );
+    return this.metadataScanner
+      .getAllMethodNames(instancePrototype)
+      .map(method => this.exploreMethodMetadata(instancePrototype, method))
+      .filter(metadata => metadata);
   }
 
   public exploreMethodMetadata(
diff --git a/packages/websockets/index.ts b/packages/websockets/index.ts
index e8baa6f07..bccb398b5 100644
--- a/packages/websockets/index.ts
+++ b/packages/websockets/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @websockets
- * Copyright(c) 2017 - 2022 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2023 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
diff --git a/packages/websockets/interfaces/gateway-metadata.interface.ts b/packages/websockets/interfaces/gateway-metadata.interface.ts
index 9221f68ab..383287682 100644
--- a/packages/websockets/interfaces/gateway-metadata.interface.ts
+++ b/packages/websockets/interfaces/gateway-metadata.interface.ts
@@ -1,9 +1,10 @@
-/**
- * @external https://github.com/socketio/socket.io/blob/master/lib/index.ts
- */
-
 import { CorsOptions } from '@nestjs/common/interfaces/external/cors-options.interface';
 
+/**
+ * External interface
+ * @see https://github.com/socketio/socket.io/blob/master/lib/index.ts 
+ * @publicApi
+ */
 export interface GatewayMetadata {
   /**
    * The name of a namespace
diff --git a/packages/websockets/interfaces/hooks/on-gateway-connection.interface.ts b/packages/websockets/interfaces/hooks/on-gateway-connection.interface.ts
index b3ca0f51c..7f39dbdcf 100644
--- a/packages/websockets/interfaces/hooks/on-gateway-connection.interface.ts
+++ b/packages/websockets/interfaces/hooks/on-gateway-connection.interface.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export interface OnGatewayConnection<T = any> {
   handleConnection(client: T, ...args: any[]): any;
 }
diff --git a/packages/websockets/interfaces/hooks/on-gateway-disconnect.interface.ts b/packages/websockets/interfaces/hooks/on-gateway-disconnect.interface.ts
index f038c2162..e86e27d8f 100644
--- a/packages/websockets/interfaces/hooks/on-gateway-disconnect.interface.ts
+++ b/packages/websockets/interfaces/hooks/on-gateway-disconnect.interface.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export interface OnGatewayDisconnect<T = any> {
   handleDisconnect(client: T): any;
 }
diff --git a/packages/websockets/interfaces/hooks/on-gateway-init.interface.ts b/packages/websockets/interfaces/hooks/on-gateway-init.interface.ts
index 81096e55c..c90f5d8c6 100644
--- a/packages/websockets/interfaces/hooks/on-gateway-init.interface.ts
+++ b/packages/websockets/interfaces/hooks/on-gateway-init.interface.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export interface OnGatewayInit<T = any> {
   afterInit(server: T): any;
 }
diff --git a/packages/websockets/interfaces/nest-gateway.interface.ts b/packages/websockets/interfaces/nest-gateway.interface.ts
index 1011bb053..89472d362 100644
--- a/packages/websockets/interfaces/nest-gateway.interface.ts
+++ b/packages/websockets/interfaces/nest-gateway.interface.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export interface NestGateway {
   afterInit?: (server: any) => void;
   handleConnection?: (...args: any[]) => void;
diff --git a/packages/websockets/interfaces/server-and-event-streams-host.interface.ts b/packages/websockets/interfaces/server-and-event-streams-host.interface.ts
index 4b04a81e5..5049dc959 100644
--- a/packages/websockets/interfaces/server-and-event-streams-host.interface.ts
+++ b/packages/websockets/interfaces/server-and-event-streams-host.interface.ts
@@ -1,5 +1,8 @@
 import { ReplaySubject, Subject } from 'rxjs';
 
+/**
+ * @publicApi
+ */
 export interface ServerAndEventStreamsHost<T = any> {
   server: T;
   init: ReplaySubject<T>;
diff --git a/packages/websockets/interfaces/web-socket-server.interface.ts b/packages/websockets/interfaces/web-socket-server.interface.ts
index 0c0387acf..d573038c1 100644
--- a/packages/websockets/interfaces/web-socket-server.interface.ts
+++ b/packages/websockets/interfaces/web-socket-server.interface.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export interface WebSocketServerOptions {
   port: number;
   namespace: string;
diff --git a/packages/websockets/interfaces/websockets-entrypoint-metadata.interface.ts b/packages/websockets/interfaces/websockets-entrypoint-metadata.interface.ts
new file mode 100644
index 000000000..bd80cd5d2
--- /dev/null
+++ b/packages/websockets/interfaces/websockets-entrypoint-metadata.interface.ts
@@ -0,0 +1,4 @@
+export type WebsocketEntrypointMetadata = {
+  port: number;
+  message: unknown;
+};
diff --git a/packages/websockets/interfaces/ws-response.interface.ts b/packages/websockets/interfaces/ws-response.interface.ts
index 04e815cbf..bf04aa48a 100644
--- a/packages/websockets/interfaces/ws-response.interface.ts
+++ b/packages/websockets/interfaces/ws-response.interface.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export interface WsResponse<T = any> {
   event: string;
   data: T;
diff --git a/packages/websockets/package.json b/packages/websockets/package.json
index e059154f2..faf4ff219 100644
--- a/packages/websockets/package.json
+++ b/packages/websockets/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/websockets",
-  "version": "9.2.0",
+  "version": "9.4.0",
   "description": "Nest - modern, fast, powerful node.js web framework (@websockets)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -14,11 +14,11 @@
   "dependencies": {
     "iterare": "1.2.1",
     "object-hash": "3.0.0",
-    "tslib": "2.4.1"
+    "tslib": "2.5.0"
   },
   "devDependencies": {
-    "@nestjs/common": "9.2.0",
-    "@nestjs/core": "9.2.0"
+    "@nestjs/common": "9.4.0",
+    "@nestjs/core": "9.4.0"
   },
   "peerDependencies": {
     "@nestjs/common": "^9.0.0",
diff --git a/packages/websockets/socket-module.ts b/packages/websockets/socket-module.ts
index 681cb0a08..d22e45067 100644
--- a/packages/websockets/socket-module.ts
+++ b/packages/websockets/socket-module.ts
@@ -1,11 +1,13 @@
+import { InjectionToken } from '@nestjs/common/interfaces';
 import { Injectable } from '@nestjs/common/interfaces/injectable.interface';
+import { NestApplicationContextOptions } from '@nestjs/common/interfaces/nest-application-context-options.interface';
 import { ApplicationConfig } from '@nestjs/core/application-config';
 import { GuardsConsumer } from '@nestjs/core/guards/guards-consumer';
 import { GuardsContextCreator } from '@nestjs/core/guards/guards-context-creator';
 import { loadAdapter } from '@nestjs/core/helpers/load-adapter';
 import { NestContainer } from '@nestjs/core/injector/container';
 import { InstanceWrapper } from '@nestjs/core/injector/instance-wrapper';
-import { InstanceToken } from '@nestjs/core/injector/module';
+import { GraphInspector } from '@nestjs/core/inspector/graph-inspector';
 import { InterceptorsConsumer } from '@nestjs/core/interceptors/interceptors-consumer';
 import { InterceptorsContextCreator } from '@nestjs/core/interceptors/interceptors-context-creator';
 import { PipesConsumer } from '@nestjs/core/pipes/pipes-consumer';
@@ -21,30 +23,39 @@ import { SocketServerProvider } from './socket-server-provider';
 import { SocketsContainer } from './sockets-container';
 import { WebSocketsController } from './web-sockets-controller';
 
-export class SocketModule<HttpServer = any> {
+export class SocketModule<
+  THttpServer = any,
+  TAppOptions extends NestApplicationContextOptions = NestApplicationContextOptions,
+> {
   private readonly socketsContainer = new SocketsContainer();
   private applicationConfig: ApplicationConfig;
   private webSocketsController: WebSocketsController;
   private isAdapterInitialized: boolean;
-  private httpServer: HttpServer | undefined;
+  private httpServer: THttpServer | undefined;
+  private appOptions: TAppOptions;
 
   public register(
     container: NestContainer,
-    config: ApplicationConfig,
-    httpServer?: HttpServer,
+    applicationConfig: ApplicationConfig,
+    graphInspector: GraphInspector,
+    appOptions: TAppOptions,
+    httpServer?: THttpServer,
   ) {
-    this.applicationConfig = config;
+    this.applicationConfig = applicationConfig;
+    this.appOptions = appOptions;
     this.httpServer = httpServer;
 
     const contextCreator = this.getContextCreator(container);
     const serverProvider = new SocketServerProvider(
       this.socketsContainer,
-      config,
+      applicationConfig,
     );
     this.webSocketsController = new WebSocketsController(
       serverProvider,
-      config,
+      applicationConfig,
       contextCreator,
+      graphInspector,
+      this.appOptions,
     );
     const modules = container.getModules();
     modules.forEach(({ providers }, moduleName: string) =>
@@ -53,7 +64,7 @@ export class SocketModule<HttpServer = any> {
   }
 
   public connectAllGateways(
-    providers: Map<InstanceToken, InstanceWrapper<Injectable>>,
+    providers: Map<InjectionToken, InstanceWrapper<Injectable>>,
     moduleName: string,
   ) {
     iterate(providers.values())
@@ -77,6 +88,7 @@ export class SocketModule<HttpServer = any> {
       instance as NestGateway,
       metatype,
       moduleName,
+      wrapper.id,
     );
   }
 
diff --git a/packages/websockets/test/gateway-metadata-explorer.spec.ts b/packages/websockets/test/gateway-metadata-explorer.spec.ts
index b495fea5f..cfef62f0c 100644
--- a/packages/websockets/test/gateway-metadata-explorer.spec.ts
+++ b/packages/websockets/test/gateway-metadata-explorer.spec.ts
@@ -38,16 +38,15 @@ describe('GatewayMetadataExplorer', () => {
     instance = new GatewayMetadataExplorer(scanner);
   });
   describe('explore', () => {
-    let scanFromPrototype: sinon.SinonSpy;
+    let getAllMethodNames: sinon.SinonSpy;
     beforeEach(() => {
-      scanFromPrototype = sinon.spy(scanner, 'scanFromPrototype');
+      getAllMethodNames = sinon.spy(scanner, 'getAllMethodNames');
     });
     it(`should call "scanFromPrototype" with expected arguments`, () => {
       const obj = new Test();
       instance.explore(obj as any);
 
-      const [argObj, argProto] = scanFromPrototype.getCall(0).args;
-      expect(argObj).to.be.eql(obj);
+      const [argProto] = getAllMethodNames.getCall(0).args;
       expect(argProto).to.be.eql(Object.getPrototypeOf(obj));
     });
   });
diff --git a/packages/websockets/test/web-sockets-controller.spec.ts b/packages/websockets/test/web-sockets-controller.spec.ts
index 659afff09..3edb1c27e 100644
--- a/packages/websockets/test/web-sockets-controller.spec.ts
+++ b/packages/websockets/test/web-sockets-controller.spec.ts
@@ -1,14 +1,19 @@
+import { NestContainer } from '@nestjs/core';
 import { ApplicationConfig } from '@nestjs/core/application-config';
 import { expect } from 'chai';
 import { fromEvent, lastValueFrom, Observable, of } from 'rxjs';
 import * as sinon from 'sinon';
+import { GraphInspector } from '../../core/inspector/graph-inspector';
 import { MetadataScanner } from '../../core/metadata-scanner';
 import { AbstractWsAdapter } from '../adapters/ws-adapter';
 import { PORT_METADATA } from '../constants';
 import { WsContextCreator } from '../context/ws-context-creator';
 import { WebSocketGateway } from '../decorators/socket-gateway.decorator';
 import { InvalidSocketPortException } from '../errors/invalid-socket-port.exception';
-import { GatewayMetadataExplorer } from '../gateway-metadata-explorer';
+import {
+  GatewayMetadataExplorer,
+  MessageMappingProperties,
+} from '../gateway-metadata-explorer';
 import { SocketServerProvider } from '../socket-server-provider';
 import { WebSocketsController } from '../web-sockets-controller';
 
@@ -29,8 +34,10 @@ class NoopAdapter extends AbstractWsAdapter {
 describe('WebSocketsController', () => {
   let instance: WebSocketsController;
   let provider: SocketServerProvider,
+    graphInspector: GraphInspector,
     config: ApplicationConfig,
     mockProvider: sinon.SinonMock;
+
   const messageHandlerCallback = () => Promise.resolve();
   const port = 90,
     namespace = '/';
@@ -40,6 +47,7 @@ describe('WebSocketsController', () => {
   beforeEach(() => {
     config = new ApplicationConfig(new NoopAdapter());
     provider = new SocketServerProvider(null, config);
+    graphInspector = new GraphInspector(new NestContainer());
     mockProvider = sinon.mock(provider);
 
     const contextCreator = sinon.createStubInstance(WsContextCreator);
@@ -48,6 +56,7 @@ describe('WebSocketsController', () => {
       provider,
       config,
       contextCreator as any,
+      graphInspector,
     );
   });
   describe('connectGatewayToServer', () => {
@@ -69,20 +78,37 @@ describe('WebSocketsController', () => {
         instance.connectGatewayToServer(
           new InvalidGateway(),
           InvalidGateway,
-          '',
+          'moduleKey',
+          'instanceWrapperId',
         ),
       ).throws(InvalidSocketPortException);
     });
     it('should call "subscribeToServerEvents" with default values when metadata is empty', () => {
       const gateway = new DefaultGateway();
-      instance.connectGatewayToServer(gateway, DefaultGateway, '');
-      expect(subscribeToServerEvents.calledWith(gateway, {}, 0, '')).to.be.true;
+      instance.connectGatewayToServer(
+        gateway,
+        DefaultGateway,
+        'moduleKey',
+        'instanceWrapperId',
+      );
+      expect(subscribeToServerEvents.calledWith(gateway, {}, 0, 'moduleKey')).to
+        .be.true;
     });
     it('should call "subscribeToServerEvents" when metadata is valid', () => {
       const gateway = new Test();
-      instance.connectGatewayToServer(gateway, Test, '');
+      instance.connectGatewayToServer(
+        gateway,
+        Test,
+        'moduleKey',
+        'instanceWrapperId',
+      );
       expect(
-        subscribeToServerEvents.calledWith(gateway, { namespace }, port, ''),
+        subscribeToServerEvents.calledWith(
+          gateway,
+          { namespace },
+          port,
+          'moduleKey',
+        ),
       ).to.be.true;
     });
   });
@@ -116,16 +142,28 @@ describe('WebSocketsController', () => {
 
       assignServerToProperties = sinon.spy();
       subscribeEvents = sinon.spy();
-      (instance as any).assignServerToProperties = assignServerToProperties;
-      (instance as any).subscribeEvents = subscribeEvents;
+      instance['assignServerToProperties'] = assignServerToProperties;
+      instance['subscribeEvents'] = subscribeEvents;
     });
     it('should call "assignServerToProperties" with expected arguments', () => {
-      instance.subscribeToServerEvents(gateway, { namespace }, port, '');
+      instance.subscribeToServerEvents(
+        gateway,
+        { namespace },
+        port,
+        'moduleKey',
+        'instanceWrapperId',
+      );
       expect(assignServerToProperties.calledWith(gateway, server.server)).to.be
         .true;
     });
     it('should call "subscribeEvents" with expected arguments', () => {
-      instance.subscribeToServerEvents(gateway, { namespace }, port, '');
+      instance.subscribeToServerEvents(
+        gateway,
+        { namespace },
+        port,
+        'moduleKey',
+        'instanceWrapperId',
+      );
       expect(subscribeEvents.firstCall.args[0]).to.be.equal(gateway);
       expect(subscribeEvents.firstCall.args[2]).to.be.equal(server);
       expect(subscribeEvents.firstCall.args[1]).to.be.eql([
@@ -137,11 +175,69 @@ describe('WebSocketsController', () => {
       ]);
     });
   });
+  describe('inspectEntrypointDefinitions', () => {
+    it('should inspect & insert corresponding entrypoint definitions', () => {
+      class GatewayHostCls {}
+
+      const port = 80;
+      const instanceWrapperId = '1234';
+      const messageHandlers: MessageMappingProperties[] = [
+        {
+          methodName: 'findOne',
+          message: 'find',
+          callback: null,
+        },
+        {
+          methodName: 'create',
+          message: 'insert',
+          callback: null,
+        },
+      ];
+      const insertEntrypointDefinitionSpy = sinon.spy(
+        graphInspector,
+        'insertEntrypointDefinition',
+      );
+      instance.inspectEntrypointDefinitions(
+        new GatewayHostCls(),
+        port,
+        messageHandlers,
+        instanceWrapperId,
+      );
+
+      expect(insertEntrypointDefinitionSpy.calledTwice).to.be.true;
+      expect(
+        insertEntrypointDefinitionSpy.calledWith({
+          type: 'websocket',
+          methodName: messageHandlers[0].methodName,
+          className: GatewayHostCls.name,
+          classNodeId: instanceWrapperId,
+          metadata: {
+            port,
+            key: messageHandlers[0].message,
+            message: messageHandlers[0].message,
+          } as any,
+        }),
+      ).to.be.true;
+      expect(
+        insertEntrypointDefinitionSpy.calledWith({
+          type: 'websocket',
+          methodName: messageHandlers[1].methodName,
+          className: GatewayHostCls.name,
+          classNodeId: instanceWrapperId,
+          metadata: {
+            port,
+            key: messageHandlers[1].message,
+            message: messageHandlers[1].message,
+          } as any,
+        }),
+      ).to.be.true;
+    });
+  });
   describe('subscribeEvents', () => {
     const gateway = new Test();
 
-    let handlers;
-    let server,
+    let handlers: any;
+    let server: any,
       subscribeConnectionEvent: sinon.SinonSpy,
       subscribeDisconnectEvent: sinon.SinonSpy,
       nextSpy: sinon.SinonSpy,
diff --git a/packages/websockets/tsconfig.build.json b/packages/websockets/tsconfig.build.json
new file mode 100644
index 000000000..732ca00cb
--- /dev/null
+++ b/packages/websockets/tsconfig.build.json
@@ -0,0 +1,22 @@
+{
+  "extends": "../tsconfig.build.json",
+  "compilerOptions": {
+    "outDir": ".",
+    "rootDir": ".",
+    "paths": {
+      "@nestjs/common": ["../common"],
+      "@nestjs/common/*": ["../common/*"],
+      "@nestjs/core": ["../core"],
+      "@nestjs/core/*": ["../core/*"]
+    }
+  },
+  "exclude": ["node_modules", "dist", "test/**/*", "*.spec.ts"],
+  "references": [
+    {
+      "path": "../common/tsconfig.build.json"
+    },
+    {
+      "path": "../core/tsconfig.build.json"
+    }
+  ]
+}
diff --git a/packages/websockets/tsconfig.json b/packages/websockets/tsconfig.json
index b238080a4..2ae9e3c90 100644
--- a/packages/websockets/tsconfig.json
+++ b/packages/websockets/tsconfig.json
@@ -1,7 +1,13 @@
 {
-  "extends": "./../tsconfig.base.json",
+  "extends": "../tsconfig.build.json",
   "compilerOptions": {
-    "baseUrl": "./"
+    "types": ["node"]
   },
-  "include": ["*.ts", "**/*.ts"]
+  "files": [],
+  "include": [],
+  "references": [
+    {
+      "path": "./tsconfig.build.json"
+    }
+  ]
 }
diff --git a/packages/websockets/web-sockets-controller.ts b/packages/websockets/web-sockets-controller.ts
index d01811e17..bb29f373f 100644
--- a/packages/websockets/web-sockets-controller.ts
+++ b/packages/websockets/web-sockets-controller.ts
@@ -1,11 +1,13 @@
+import { NestApplicationContextOptions } from '@nestjs/common/interfaces/nest-application-context-options.interface';
 import { Type } from '@nestjs/common/interfaces/type.interface';
 import { Logger } from '@nestjs/common/services/logger.service';
 import { ApplicationConfig } from '@nestjs/core/application-config';
+import { GraphInspector } from '@nestjs/core/inspector/graph-inspector';
 import { MetadataScanner } from '@nestjs/core/metadata-scanner';
 import {
   from as fromPromise,
-  Observable,
   isObservable,
+  Observable,
   of,
   Subject,
 } from 'rxjs';
@@ -20,6 +22,7 @@ import {
 import { GatewayMetadata } from './interfaces/gateway-metadata.interface';
 import { NestGateway } from './interfaces/nest-gateway.interface';
 import { ServerAndEventStreamsHost } from './interfaces/server-and-event-streams-host.interface';
+import { WebsocketEntrypointMetadata } from './interfaces/websockets-entrypoint-metadata.interface';
 import { SocketServerProvider } from './socket-server-provider';
 import { compareElementAt } from './utils/compare-element.util';
 
@@ -35,12 +38,15 @@ export class WebSocketsController {
     private readonly socketServerProvider: SocketServerProvider,
     private readonly config: ApplicationConfig,
     private readonly contextCreator: WsContextCreator,
+    private readonly graphInspector: GraphInspector,
+    private readonly appOptions: NestApplicationContextOptions = {},
   ) {}
 
   public connectGatewayToServer(
     instance: NestGateway,
     metatype: Type<unknown> | Function,
     moduleKey: string,
+    instanceWrapperId: string,
   ) {
     const options = Reflect.getMetadata(GATEWAY_OPTIONS, metatype) || {};
     const port = Reflect.getMetadata(PORT_METADATA, metatype) || 0;
@@ -48,7 +54,13 @@ export class WebSocketsController {
     if (!Number.isInteger(port)) {
       throw new InvalidSocketPortException(port, metatype);
     }
-    this.subscribeToServerEvents(instance, options, port, moduleKey);
+    this.subscribeToServerEvents(
+      instance,
+      options,
+      port,
+      moduleKey,
+      instanceWrapperId,
+    );
   }
 
   public subscribeToServerEvents<T extends GatewayMetadata>(
@@ -56,6 +68,7 @@ export class WebSocketsController {
     options: T,
     port: number,
     moduleKey: string,
+    instanceWrapperId: string,
   ) {
     const nativeMessageHandlers = this.metadataExplorer.explore(instance);
     const messageHandlers = nativeMessageHandlers.map(
@@ -70,6 +83,17 @@ export class WebSocketsController {
         ),
       }),
     );
+
+    this.inspectEntrypointDefinitions(
+      instance,
+      port,
+      messageHandlers,
+      instanceWrapperId,
+    );
+
+    if (this.appOptions.preview) {
+      return;
+    }
     const observableServer = this.socketServerProvider.scanForSocketServer<T>(
       options,
       port,
@@ -172,6 +196,30 @@ export class WebSocketsController {
     return of(result);
   }
 
+  public inspectEntrypointDefinitions(
+    instance: NestGateway,
+    port: number,
+    messageHandlers: MessageMappingProperties[],
+    instanceWrapperId: string,
+  ) {
+    messageHandlers.forEach(handler => {
+      this.graphInspector.insertEntrypointDefinition<WebsocketEntrypointMetadata>(
+        {
+          type: 'websocket',
+          methodName: handler.methodName,
+          className: instance.constructor?.name,
+          classNodeId: instanceWrapperId,
+          metadata: {
+            port,
+            key: handler.message,
+            message: handler.message,
+          },
+        },
+        instanceWrapperId,
+      );
+    });
+  }
+
   private assignServerToProperties<T = any>(
     instance: NestGateway,
     server: object,
diff --git a/renovate.json b/renovate.json
index 0bb2d8556..26c1d72d6 100644
--- a/renovate.json
+++ b/renovate.json
@@ -1,5 +1,5 @@
 {
-  "extends": ["config:base"],
+  "extends": ["config:base", ":dependencyDashboard"],
   "labels": ["dependencies"],
   "packageRules": [
     {
diff --git a/sample/01-cats-app/package-lock.json b/sample/01-cats-app/package-lock.json
index b5c189a2f..641754f8f 100644
Binary files a/sample/01-cats-app/package-lock.json and b/sample/01-cats-app/package-lock.json differ
diff --git a/sample/01-cats-app/package.json b/sample/01-cats-app/package.json
index 20504858a..ee1ed2a48 100644
--- a/sample/01-cats-app/package.json
+++ b/sample/01-cats-app/package.json
@@ -19,19 +19,19 @@
     "test:e2e": "jest --config ./e2e/jest-e2e.json"
   },
   "dependencies": {
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
-    "@nestjs/platform-express": "9.0.1",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
     "class-transformer": "0.5.1",
-    "class-validator": "0.13.2",
+    "class-validator": "0.14.0",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
+    "rimraf": "4.4.1",
     "rxjs": "7.5.5"
   },
   "devDependencies": {
     "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
-    "@nestjs/testing": "9.0.1",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
     "@types/jest": "28.1.4",
     "@types/node": "18.0.3",
@@ -39,16 +39,16 @@
     "jest": "28.1.2",
     "prettier": "2.7.1",
     "supertest": "6.2.4",
-    "ts-jest": "28.0.5",
+    "ts-jest": "28.0.8",
     "ts-loader": "9.3.1",
     "ts-node": "10.8.2",
     "tsconfig-paths": "4.0.0",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
     "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
+    "eslint-config-prettier": "8.8.0",
     "eslint-plugin-import": "2.26.0",
-    "typescript": "4.7.4"
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/01-cats-app/tsconfig.json b/sample/01-cats-app/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/01-cats-app/tsconfig.json
+++ b/sample/01-cats-app/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/02-gateways/e2e/events-gateway/gateway.e2e-spec.ts b/sample/02-gateways/e2e/events-gateway/gateway.e2e-spec.ts
new file mode 100644
index 000000000..26b9f42ed
--- /dev/null
+++ b/sample/02-gateways/e2e/events-gateway/gateway.e2e-spec.ts
@@ -0,0 +1,53 @@
+import { INestApplication } from '@nestjs/common';
+import { Test } from '@nestjs/testing';
+import { AppModule } from '../../src/app.module';
+import { io, Socket } from 'socket.io-client';
+
+describe('EventsGateway', () => {
+  let app: INestApplication;
+  let socket: Socket;
+
+  beforeAll(async () => {
+    const moduleRef = await Test.createTestingModule({
+      imports: [AppModule],
+    }).compile();
+
+    app = moduleRef.createNestApplication();
+    await app.listen(3000);
+  });
+
+  beforeEach(() => {
+    socket = io('http://localhost:3000');
+    socket.connect();
+  });
+
+  describe('findAll', () => {
+    it('should receive 3 numbers', done => {
+      let eventCount = 1;
+      socket.emit('events', { test: 'test' });
+      socket.on('events', data => {
+        expect(data).toBe(eventCount);
+        if (++eventCount > 3) {
+          done();
+        }
+      });
+    });
+  });
+
+  describe('identity', () => {
+    it('should return the same number has what was sent', done => {
+      socket.emit('identity', 0, response => {
+        expect(response).toBe(0);
+        done();
+      });
+    });
+  });
+
+  afterEach(() => {
+    socket.disconnect();
+  });
+
+  afterAll(async () => {
+    await app.close();
+  });
+});
diff --git a/sample/02-gateways/e2e/jest-e2e.json b/sample/02-gateways/e2e/jest-e2e.json
new file mode 100644
index 000000000..72eb5c3c0
--- /dev/null
+++ b/sample/02-gateways/e2e/jest-e2e.json
@@ -0,0 +1,14 @@
+{
+    "moduleFileExtensions": [
+        "ts",
+        "tsx",
+        "js",
+        "json"
+    ],
+    "transform": {
+        "^.+\\.tsx?$": "ts-jest"
+    },
+    "testRegex": "/e2e/.*\\.(e2e-test|e2e-spec).(ts|tsx|js)$",
+    "collectCoverageFrom" : ["src/**/*.{js,jsx,tsx,ts}", "!**/node_modules/**", "!**/vendor/**"],
+    "coverageReporters": ["json", "lcov"]
+}
\ No newline at end of file
diff --git a/sample/02-gateways/jest.json b/sample/02-gateways/jest.json
new file mode 100644
index 000000000..591de12b6
--- /dev/null
+++ b/sample/02-gateways/jest.json
@@ -0,0 +1,14 @@
+{
+  "moduleFileExtensions": [
+        "ts",
+        "tsx",
+        "js",
+        "json"
+    ],
+    "transform": {
+        "^.+\\.tsx?$": "ts-jest"
+    },
+    "testRegex": "/src/.*\\.(test|spec).(ts|tsx|js)$",
+    "collectCoverageFrom" : ["src/**/*.{js,jsx,tsx,ts}", "!**/node_modules/**", "!**/vendor/**"],
+    "coverageReporters": ["json", "lcov"]
+}
\ No newline at end of file
diff --git a/sample/02-gateways/package-lock.json b/sample/02-gateways/package-lock.json
index 321c7ce45..365bf5d6a 100644
Binary files a/sample/02-gateways/package-lock.json and b/sample/02-gateways/package-lock.json differ
diff --git a/sample/02-gateways/package.json b/sample/02-gateways/package.json
index 0317efb04..4e8c9c557 100644
--- a/sample/02-gateways/package.json
+++ b/sample/02-gateways/package.json
@@ -16,43 +16,61 @@
     "test:watch": "jest --watch",
     "test:cov": "jest --coverage",
     "test:debug": "node --inspect-brk -r tsconfig-paths/register -r ts-node/register node_modules/.bin/jest --runInBand",
-    "test:e2e": "echo 'No e2e tests implemented yet.'"
+    "test:e2e": "jest --config ./e2e/jest-e2e.json"
   },
   "dependencies": {
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
-    "@nestjs/platform-express": "9.0.1",
-    "@nestjs/platform-socket.io": "9.0.1",
-    "@nestjs/websockets": "9.0.1",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
+    "@nestjs/platform-socket.io": "9.3.12",
+    "@nestjs/websockets": "9.3.12",
     "@socket.io/redis-adapter": "7.2.0",
     "class-transformer": "0.5.1",
-    "class-validator": "0.13.2",
+    "class-validator": "0.14.0",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
+    "rimraf": "4.4.1",
     "rxjs": "7.5.5",
-    "socket.io": "4.5.1"
+    "socket.io": "4.6.1"
   },
   "devDependencies": {
     "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
-    "@nestjs/testing": "9.0.1",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
+    "@types/jest": "28.1.4",
     "@types/node": "18.0.3",
     "@types/supertest": "2.0.12",
     "@types/ws": "8.5.3",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
     "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
+    "eslint-config-prettier": "8.8.0",
     "eslint-plugin-import": "2.26.0",
     "jest": "28.1.2",
     "prettier": "2.7.1",
-    "redis": "4.2.0",
+    "redis": "4.6.5",
     "supertest": "6.2.4",
-    "ts-jest": "28.0.5",
+    "ts-jest": "28.0.8",
     "ts-loader": "9.3.1",
     "ts-node": "10.8.2",
     "tsconfig-paths": "4.0.0",
-    "typescript": "4.7.4"
+    "typescript": "4.9.5"
+  },
+  "jest": {
+    "moduleFileExtensions": [
+      "js",
+      "json",
+      "ts"
+    ],
+    "rootDir": "src",
+    "testRegex": ".*\\.spec\\.ts$",
+    "transform": {
+      "^.+\\.(t|j)s$": "ts-jest"
+    },
+    "collectCoverageFrom": [
+      "**/*.(t|j)s"
+    ],
+    "coverageDirectory": "../coverage",
+    "testEnvironment": "node"
   }
 }
diff --git a/sample/02-gateways/src/events/events.gateway.spec.ts b/sample/02-gateways/src/events/events.gateway.spec.ts
new file mode 100644
index 000000000..e40de3deb
--- /dev/null
+++ b/sample/02-gateways/src/events/events.gateway.spec.ts
@@ -0,0 +1,40 @@
+import { Test, TestingModule } from '@nestjs/testing';
+import { reduce } from 'rxjs/operators';
+import { EventsGateway } from './events.gateway';
+
+describe('EventsGateway', () => {
+  let gateway: EventsGateway;
+
+  beforeEach(async () => {
+    const module: TestingModule = await Test.createTestingModule({
+      providers: [EventsGateway],
+    }).compile();
+
+    gateway = module.get<EventsGateway>(EventsGateway);
+  });
+
+  it('should be defined', () => {
+    expect(gateway).toBeDefined();
+  });
+
+  describe('findAll', () => {
+    it('should return 3 numbers', done => {
+      gateway
+        .findAll({})
+        .pipe(reduce((acc, item) => [...acc, item], []))
+        .subscribe(results => {
+          expect(results.length).toBe(3);
+          results.forEach((result, index) =>
+            expect(result.data).toBe(index + 1),
+          );
+          done();
+        });
+    });
+  });
+
+  describe('identity', () => {
+    it('should return the same number has what was sent', async () => {
+      await expect(gateway.identity(1)).resolves.toBe(1);
+    });
+  });
+});
diff --git a/sample/02-gateways/tsconfig.json b/sample/02-gateways/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/02-gateways/tsconfig.json
+++ b/sample/02-gateways/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/03-microservices/package-lock.json b/sample/03-microservices/package-lock.json
index 37931ba11..5f916f6cd 100644
Binary files a/sample/03-microservices/package-lock.json and b/sample/03-microservices/package-lock.json differ
diff --git a/sample/03-microservices/package.json b/sample/03-microservices/package.json
index 9be88ca1f..873bf9a5d 100644
--- a/sample/03-microservices/package.json
+++ b/sample/03-microservices/package.json
@@ -19,36 +19,36 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
-    "@nestjs/microservices": "9.0.1",
-    "@nestjs/platform-express": "9.0.1",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/microservices": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
     "class-transformer": "0.5.1",
-    "class-validator": "0.13.2",
+    "class-validator": "0.14.0",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
+    "rimraf": "4.4.1",
     "rxjs": "7.5.5"
   },
   "devDependencies": {
     "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
-    "@nestjs/testing": "9.0.1",
-    "@types/amqplib": "0.8.2",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
+    "@types/amqplib": "0.10.1",
     "@types/express": "4.17.13",
     "@types/node": "18.0.3",
     "@types/supertest": "2.0.12",
     "jest": "28.1.2",
     "prettier": "2.7.1",
     "supertest": "6.2.4",
-    "ts-jest": "28.0.5",
+    "ts-jest": "28.0.8",
     "ts-loader": "9.3.1",
     "ts-node": "10.8.2",
     "tsconfig-paths": "4.0.0",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
     "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
+    "eslint-config-prettier": "8.8.0",
     "eslint-plugin-import": "2.26.0",
-    "typescript": "4.7.4"
+    "typescript": "4.9.5"
   }
 }
diff --git a/sample/03-microservices/tsconfig.json b/sample/03-microservices/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/03-microservices/tsconfig.json
+++ b/sample/03-microservices/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/04-grpc/package-lock.json b/sample/04-grpc/package-lock.json
index 4323b0754..6cbfff115 100644
Binary files a/sample/04-grpc/package-lock.json and b/sample/04-grpc/package-lock.json differ
diff --git a/sample/04-grpc/package.json b/sample/04-grpc/package.json
index 9a4ba80c1..8cfe27426 100644
--- a/sample/04-grpc/package.json
+++ b/sample/04-grpc/package.json
@@ -20,35 +20,35 @@
   },
   "dependencies": {
     "@grpc/grpc-js": "1.6.7",
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
-    "@nestjs/microservices": "9.0.1",
-    "@nestjs/platform-express": "9.0.1",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/microservices": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
     "class-transformer": "0.5.1",
-    "class-validator": "0.13.2",
+    "class-validator": "0.14.0",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
+    "rimraf": "4.4.1",
     "rxjs": "7.5.5"
   },
   "devDependencies": {
     "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
-    "@nestjs/testing": "9.0.1",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
     "@types/node": "18.0.3",
     "@types/supertest": "2.0.12",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
     "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
+    "eslint-config-prettier": "8.8.0",
     "eslint-plugin-import": "2.26.0",
     "jest": "28.1.2",
     "prettier": "2.7.1",
     "supertest": "6.2.4",
-    "ts-jest": "28.0.5",
+    "ts-jest": "28.0.8",
     "ts-loader": "9.3.1",
     "ts-node": "10.8.2",
     "tsconfig-paths": "4.0.0",
-    "typescript": "4.7.4"
+    "typescript": "4.9.5"
   }
 }
diff --git a/sample/04-grpc/tsconfig.json b/sample/04-grpc/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/04-grpc/tsconfig.json
+++ b/sample/04-grpc/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/05-sql-typeorm/package-lock.json b/sample/05-sql-typeorm/package-lock.json
index 215f6af7f..9f90795a7 100644
Binary files a/sample/05-sql-typeorm/package-lock.json and b/sample/05-sql-typeorm/package-lock.json differ
diff --git a/sample/05-sql-typeorm/package.json b/sample/05-sql-typeorm/package.json
index 761db7920..885ab90e0 100644
--- a/sample/05-sql-typeorm/package.json
+++ b/sample/05-sql-typeorm/package.json
@@ -19,37 +19,37 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
-    "@nestjs/platform-express": "9.0.1",
-    "@nestjs/typeorm": "9.0.0",
-    "mysql2": "2.3.3",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
+    "@nestjs/typeorm": "9.0.1",
+    "mysql2": "3.2.0",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
+    "rimraf": "4.4.1",
     "rxjs": "7.5.5",
-    "typeorm": "0.3.7"
+    "typeorm": "0.3.12"
   },
   "devDependencies": {
     "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
-    "@nestjs/testing": "9.0.1",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
     "@types/jest": "28.1.4",
     "@types/node": "18.0.3",
     "@types/supertest": "2.0.12",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
     "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
+    "eslint-config-prettier": "8.8.0",
     "eslint-plugin-import": "2.26.0",
     "jest": "28.1.2",
     "prettier": "2.7.1",
     "supertest": "6.2.4",
-    "ts-jest": "28.0.5",
+    "ts-jest": "28.0.8",
     "ts-loader": "9.3.1",
     "ts-node": "10.8.2",
     "tsconfig-paths": "4.0.0",
-    "typescript": "4.7.4"
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/05-sql-typeorm/tsconfig.json b/sample/05-sql-typeorm/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/05-sql-typeorm/tsconfig.json
+++ b/sample/05-sql-typeorm/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/06-mongoose/package-lock.json b/sample/06-mongoose/package-lock.json
index 218af59e7..984b5c1fa 100644
Binary files a/sample/06-mongoose/package-lock.json and b/sample/06-mongoose/package-lock.json differ
diff --git a/sample/06-mongoose/package.json b/sample/06-mongoose/package.json
index 6b1767957..361b025cb 100644
--- a/sample/06-mongoose/package.json
+++ b/sample/06-mongoose/package.json
@@ -19,36 +19,36 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
-    "@nestjs/mongoose": "9.2.0",
-    "@nestjs/platform-express": "9.0.1",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/mongoose": "9.2.2",
+    "@nestjs/platform-express": "9.3.12",
     "mongoose": "6.4.6",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
+    "rimraf": "4.4.1",
     "rxjs": "7.5.5"
   },
   "devDependencies": {
     "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
-    "@nestjs/testing": "9.0.1",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
     "@types/jest": "28.1.4",
     "@types/node": "18.0.3",
     "@types/supertest": "2.0.12",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
     "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
+    "eslint-config-prettier": "8.8.0",
     "eslint-plugin-import": "2.26.0",
     "jest": "28.1.2",
     "prettier": "2.7.1",
     "supertest": "6.2.4",
-    "ts-jest": "28.0.5",
+    "ts-jest": "28.0.8",
     "ts-loader": "9.3.1",
     "ts-node": "10.8.2",
     "tsconfig-paths": "4.0.0",
-    "typescript": "4.7.4"
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/06-mongoose/src/cats/cats.service.ts b/sample/06-mongoose/src/cats/cats.service.ts
index 46069489a..27020406f 100644
--- a/sample/06-mongoose/src/cats/cats.service.ts
+++ b/sample/06-mongoose/src/cats/cats.service.ts
@@ -2,13 +2,11 @@ import { Injectable } from '@nestjs/common';
 import { InjectModel } from '@nestjs/mongoose';
 import { Model } from 'mongoose';
 import { CreateCatDto } from './dto/create-cat.dto';
-import { Cat, CatDocument } from './schemas/cat.schema';
+import { Cat } from './schemas/cat.schema';
 
 @Injectable()
 export class CatsService {
-  constructor(
-    @InjectModel(Cat.name) private readonly catModel: Model<CatDocument>,
-  ) {}
+  constructor(@InjectModel(Cat.name) private readonly catModel: Model<Cat>) {}
 
   async create(createCatDto: CreateCatDto): Promise<Cat> {
     const createdCat = await this.catModel.create(createCatDto);
diff --git a/sample/06-mongoose/tsconfig.json b/sample/06-mongoose/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/06-mongoose/tsconfig.json
+++ b/sample/06-mongoose/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/07-sequelize/package-lock.json b/sample/07-sequelize/package-lock.json
index b5b037026..9d3e6f502 100644
Binary files a/sample/07-sequelize/package-lock.json and b/sample/07-sequelize/package-lock.json differ
diff --git a/sample/07-sequelize/package.json b/sample/07-sequelize/package.json
index b1233cdea..138ed58f6 100644
--- a/sample/07-sequelize/package.json
+++ b/sample/07-sequelize/package.json
@@ -19,39 +19,39 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
-    "@nestjs/platform-express": "9.0.1",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
     "@nestjs/sequelize": "9.0.0",
-    "mysql2": "2.3.3",
+    "mysql2": "3.2.0",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
+    "rimraf": "4.4.1",
     "rxjs": "7.5.5",
-    "sequelize": "6.21.2",
-    "sequelize-typescript": "2.1.3",
-    "typescript": "4.7.4"
+    "sequelize": "6.29.0",
+    "sequelize-typescript": "2.1.5",
+    "typescript": "4.9.5"
   },
   "devDependencies": {
     "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
-    "@nestjs/testing": "9.0.1",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
     "@types/jest": "28.1.4",
     "@types/node": "18.0.3",
     "@types/supertest": "2.0.12",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
     "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
+    "eslint-config-prettier": "8.8.0",
     "eslint-plugin-import": "2.26.0",
     "jest": "28.1.2",
     "prettier": "2.7.1",
     "supertest": "6.2.4",
-    "ts-jest": "28.0.5",
+    "ts-jest": "28.0.8",
     "ts-loader": "9.3.1",
     "ts-node": "10.8.2",
     "tsconfig-paths": "4.0.0",
-    "typescript": "4.7.4"
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/07-sequelize/tsconfig.json b/sample/07-sequelize/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/07-sequelize/tsconfig.json
+++ b/sample/07-sequelize/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/08-webpack/package-lock.json b/sample/08-webpack/package-lock.json
index 932922722..a840162e4 100644
Binary files a/sample/08-webpack/package-lock.json and b/sample/08-webpack/package-lock.json differ
diff --git a/sample/08-webpack/package.json b/sample/08-webpack/package.json
index de629c430..ea33f0a0d 100644
--- a/sample/08-webpack/package.json
+++ b/sample/08-webpack/package.json
@@ -12,26 +12,26 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
-    "@nestjs/platform-express": "9.0.1",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
     "reflect-metadata": "0.1.13",
     "rxjs": "7.5.5",
-    "typescript": "4.7.4"
+    "typescript": "4.9.5"
   },
   "devDependencies": {
     "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
+    "@nestjs/schematics": "9.0.4",
     "@types/node": "18.0.3",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
     "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
+    "eslint-config-prettier": "8.8.0",
     "eslint-plugin-import": "2.26.0",
     "start-server-webpack-plugin": "2.2.5",
     "ts-loader": "9.3.1",
     "ts-node": "10.8.2",
-    "webpack": "5.73.0",
+    "webpack": "5.76.3",
     "webpack-cli": "4.10.0",
     "webpack-node-externals": "3.0.0"
   }
diff --git a/sample/08-webpack/tsconfig.json b/sample/08-webpack/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/08-webpack/tsconfig.json
+++ b/sample/08-webpack/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/09-babel-example/package-lock.json b/sample/09-babel-example/package-lock.json
index d8924b330..040b41422 100644
Binary files a/sample/09-babel-example/package-lock.json and b/sample/09-babel-example/package-lock.json differ
diff --git a/sample/09-babel-example/package.json b/sample/09-babel-example/package.json
index 91eb2b03d..9ecb4f240 100644
--- a/sample/09-babel-example/package.json
+++ b/sample/09-babel-example/package.json
@@ -13,26 +13,26 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
-    "@nestjs/platform-express": "9.0.1",
-    "@nestjs/microservices": "9.0.1",
-    "@nestjs/websockets": "9.0.1",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
+    "@nestjs/microservices": "9.3.12",
+    "@nestjs/websockets": "9.3.12",
     "reflect-metadata": "0.1.13",
     "rxjs": "7.5.5"
   },
   "devDependencies": {
-    "@babel/cli": "7.18.6",
-    "@babel/core": "7.18.6",
-    "@babel/node": "7.18.6",
-    "@babel/plugin-proposal-decorators": "7.18.6",
-    "@babel/plugin-transform-runtime": "7.18.6",
-    "@babel/preset-env": "7.18.6",
-    "@babel/register": "7.18.6",
-    "@babel/runtime": "7.18.6",
-    "@nestjs/testing": "9.0.1",
+    "@babel/cli": "7.21.0",
+    "@babel/core": "7.21.3",
+    "@babel/node": "7.20.7",
+    "@babel/plugin-proposal-decorators": "7.21.0",
+    "@babel/plugin-transform-runtime": "7.21.0",
+    "@babel/preset-env": "7.20.2",
+    "@babel/register": "7.21.0",
+    "@babel/runtime": "7.21.0",
+    "@nestjs/testing": "9.3.12",
     "jest": "28.1.2",
-    "nodemon": "2.0.19",
+    "nodemon": "2.0.22",
     "prettier": "2.7.1",
     "supertest": "6.2.4"
   },
diff --git a/sample/10-fastify/package-lock.json b/sample/10-fastify/package-lock.json
index 9cb252ee4..b8804b6a9 100644
Binary files a/sample/10-fastify/package-lock.json and b/sample/10-fastify/package-lock.json differ
diff --git a/sample/10-fastify/package.json b/sample/10-fastify/package.json
index e47a1fa77..0746b1379 100644
--- a/sample/10-fastify/package.json
+++ b/sample/10-fastify/package.json
@@ -19,34 +19,34 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
-    "@nestjs/platform-fastify": "9.0.1",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-fastify": "9.3.12",
     "class-transformer": "0.5.1",
-    "class-validator": "0.13.2",
+    "class-validator": "0.14.0",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
+    "rimraf": "4.4.1",
     "rxjs": "7.5.5"
   },
   "devDependencies": {
     "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
-    "@nestjs/testing": "9.0.1",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
     "@types/node": "18.0.3",
     "@types/supertest": "2.0.12",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
     "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
+    "eslint-config-prettier": "8.8.0",
     "eslint-plugin-import": "2.26.0",
     "jest": "28.1.2",
     "prettier": "2.7.1",
     "supertest": "6.2.4",
-    "ts-jest": "28.0.5",
+    "ts-jest": "28.0.8",
     "ts-loader": "9.3.1",
     "ts-node": "10.8.2",
     "tsconfig-paths": "4.0.0",
-    "typescript": "4.7.4"
+    "typescript": "4.9.5"
   }
 }
diff --git a/sample/10-fastify/tsconfig.json b/sample/10-fastify/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/10-fastify/tsconfig.json
+++ b/sample/10-fastify/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/11-swagger/package-lock.json b/sample/11-swagger/package-lock.json
index c11a4c7d1..ac7915151 100644
Binary files a/sample/11-swagger/package-lock.json and b/sample/11-swagger/package-lock.json differ
diff --git a/sample/11-swagger/package.json b/sample/11-swagger/package.json
index 32d80f423..e3aaba9a4 100644
--- a/sample/11-swagger/package.json
+++ b/sample/11-swagger/package.json
@@ -19,35 +19,35 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
-    "@nestjs/platform-express": "9.0.1",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
     "@nestjs/swagger": "6.0.1",
     "class-transformer": "0.5.1",
-    "class-validator": "0.13.2",
+    "class-validator": "0.14.0",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
+    "rimraf": "4.4.1",
     "rxjs": "7.5.5"
   },
   "devDependencies": {
     "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
-    "@nestjs/testing": "9.0.1",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
     "@types/node": "18.0.3",
     "@types/supertest": "2.0.12",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
     "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
+    "eslint-config-prettier": "8.8.0",
     "eslint-plugin-import": "2.26.0",
     "jest": "28.1.2",
     "prettier": "2.7.1",
     "supertest": "6.2.4",
-    "ts-jest": "28.0.5",
+    "ts-jest": "28.0.8",
     "ts-loader": "9.3.1",
     "ts-node": "10.8.2",
     "tsconfig-paths": "4.0.0",
-    "typescript": "4.7.4"
+    "typescript": "4.9.5"
   }
 }
diff --git a/sample/11-swagger/tsconfig.json b/sample/11-swagger/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/11-swagger/tsconfig.json
+++ b/sample/11-swagger/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/12-graphql-schema-first/package-lock.json b/sample/12-graphql-schema-first/package-lock.json
index b62db5ea8..eed73df26 100644
Binary files a/sample/12-graphql-schema-first/package-lock.json and b/sample/12-graphql-schema-first/package-lock.json differ
diff --git a/sample/12-graphql-schema-first/package.json b/sample/12-graphql-schema-first/package.json
index 308efcc4e..03db9cc2d 100644
--- a/sample/12-graphql-schema-first/package.json
+++ b/sample/12-graphql-schema-first/package.json
@@ -19,42 +19,41 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@graphql-tools/utils": "8.8.0",
-    "@nestjs/apollo": "10.0.17",
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
-    "@nestjs/graphql": "10.0.18",
-    "@nestjs/platform-express": "9.0.1",
-    "apollo-server": "3.9.0",
-    "apollo-server-express": "3.9.0",
+    "@apollo/server": "4.5.0",
+    "@graphql-tools/utils": "9.2.1",
+    "@nestjs/apollo": "11.0.4",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/graphql": "11.0.0",
+    "@nestjs/platform-express": "9.3.12",
     "class-transformer": "0.5.1",
-    "class-validator": "0.13.2",
-    "graphql": "16.5.0",
+    "class-validator": "0.14.0",
+    "graphql": "16.6.0",
     "graphql-subscriptions": "2.0.0",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.5.5"
+    "rimraf": "4.4.1",
+    "rxjs": "7.8.0"
   },
   "devDependencies": {
-    "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
-    "@nestjs/testing": "9.0.1",
-    "@types/express": "4.17.13",
-    "@types/node": "18.0.3",
+    "@nestjs/cli": "9.2.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
+    "@types/express": "4.17.17",
+    "@types/node": "18.15.0",
     "@types/supertest": "2.0.12",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
-    "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
-    "eslint-plugin-import": "2.26.0",
-    "jest": "28.1.2",
-    "prettier": "2.7.1",
-    "supertest": "6.2.4",
-    "ts-jest": "28.0.5",
-    "ts-loader": "9.3.1",
-    "ts-morph": "15.1.0",
-    "ts-node": "10.8.2",
-    "tsconfig-paths": "4.0.0",
-    "typescript": "4.7.4"
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.35.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-import": "2.27.5",
+    "jest": "29.5.0",
+    "prettier": "2.8.4",
+    "supertest": "6.3.3",
+    "ts-jest": "29.0.5",
+    "ts-loader": "9.4.2",
+    "ts-morph": "17.0.1",
+    "ts-node": "10.9.1",
+    "tsconfig-paths": "4.1.2",
+    "typescript": "4.9.5"
   }
 }
diff --git a/sample/12-graphql-schema-first/src/common/plugins/logging.plugin.ts b/sample/12-graphql-schema-first/src/common/plugins/logging.plugin.ts
index 449d257f4..77c23a96c 100644
--- a/sample/12-graphql-schema-first/src/common/plugins/logging.plugin.ts
+++ b/sample/12-graphql-schema-first/src/common/plugins/logging.plugin.ts
@@ -1,12 +1,9 @@
+import { ApolloServerPlugin, GraphQLRequestListener } from '@apollo/server';
 import { Plugin } from '@nestjs/apollo';
-import {
-  ApolloServerPlugin,
-  GraphQLRequestListener,
-} from 'apollo-server-plugin-base';
 
 @Plugin()
 export class LoggingPlugin implements ApolloServerPlugin {
-  async requestDidStart(): Promise<GraphQLRequestListener> {
+  async requestDidStart(): Promise<GraphQLRequestListener<any>> {
     console.log('Request started');
     return {
       async willSendResponse() {
diff --git a/sample/12-graphql-schema-first/tsconfig.json b/sample/12-graphql-schema-first/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/12-graphql-schema-first/tsconfig.json
+++ b/sample/12-graphql-schema-first/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/13-mongo-typeorm/docker-compose.yml b/sample/13-mongo-typeorm/docker-compose.yml
index 834d04a17..e4adc7194 100644
--- a/sample/13-mongo-typeorm/docker-compose.yml
+++ b/sample/13-mongo-typeorm/docker-compose.yml
@@ -2,7 +2,7 @@ version: "3"
 
 services:
   mongodb:
-    image: mongo:5.0
+    image: mongo:6.0
     environment:
       - MONGODB_DATABASE="test"
     ports:
diff --git a/sample/13-mongo-typeorm/package-lock.json b/sample/13-mongo-typeorm/package-lock.json
index e9465dbf6..28b93e391 100644
Binary files a/sample/13-mongo-typeorm/package-lock.json and b/sample/13-mongo-typeorm/package-lock.json differ
diff --git a/sample/13-mongo-typeorm/package.json b/sample/13-mongo-typeorm/package.json
index 067b16796..a5714a958 100644
--- a/sample/13-mongo-typeorm/package.json
+++ b/sample/13-mongo-typeorm/package.json
@@ -19,37 +19,37 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
-    "@nestjs/platform-express": "9.0.1",
-    "@nestjs/typeorm": "9.0.0",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
+    "@nestjs/typeorm": "9.0.1",
     "mongodb": "3.6.0",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
+    "rimraf": "4.4.1",
     "rxjs": "7.5.5",
-    "typeorm": "0.3.7"
+    "typeorm": "0.3.12"
   },
   "devDependencies": {
     "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
-    "@nestjs/testing": "9.0.1",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
     "@types/jest": "28.1.4",
     "@types/node": "18.0.3",
     "@types/supertest": "2.0.12",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
     "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
+    "eslint-config-prettier": "8.8.0",
     "eslint-plugin-import": "2.26.0",
     "jest": "28.1.2",
     "prettier": "2.7.1",
     "supertest": "6.2.4",
-    "ts-jest": "28.0.5",
+    "ts-jest": "28.0.8",
     "ts-loader": "9.3.1",
     "ts-node": "10.8.2",
     "tsconfig-paths": "4.0.0",
-    "typescript": "4.7.4"
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/13-mongo-typeorm/tsconfig.json b/sample/13-mongo-typeorm/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/13-mongo-typeorm/tsconfig.json
+++ b/sample/13-mongo-typeorm/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/14-mongoose-base/package-lock.json b/sample/14-mongoose-base/package-lock.json
index e601d1149..0f621b706 100644
Binary files a/sample/14-mongoose-base/package-lock.json and b/sample/14-mongoose-base/package-lock.json differ
diff --git a/sample/14-mongoose-base/package.json b/sample/14-mongoose-base/package.json
index 2ad1c11fa..8e395ef6b 100644
--- a/sample/14-mongoose-base/package.json
+++ b/sample/14-mongoose-base/package.json
@@ -19,35 +19,35 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
-    "@nestjs/platform-express": "9.0.1",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
     "mongoose": "6.4.6",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
+    "rimraf": "4.4.1",
     "rxjs": "7.5.5"
   },
   "devDependencies": {
     "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
-    "@nestjs/testing": "9.0.1",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
     "@types/jest": "28.1.4",
     "@types/node": "18.0.3",
     "@types/supertest": "2.0.12",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
     "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
+    "eslint-config-prettier": "8.8.0",
     "eslint-plugin-import": "2.26.0",
     "jest": "28.1.2",
     "prettier": "2.7.1",
     "supertest": "6.2.4",
-    "ts-jest": "28.0.5",
+    "ts-jest": "28.0.8",
     "ts-loader": "9.3.1",
     "ts-node": "10.8.2",
     "tsconfig-paths": "4.0.0",
-    "typescript": "4.7.4"
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/14-mongoose-base/tsconfig.json b/sample/14-mongoose-base/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/14-mongoose-base/tsconfig.json
+++ b/sample/14-mongoose-base/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/15-mvc/package-lock.json b/sample/15-mvc/package-lock.json
index aef59f5fa..e03fca618 100644
Binary files a/sample/15-mvc/package-lock.json and b/sample/15-mvc/package-lock.json differ
diff --git a/sample/15-mvc/package.json b/sample/15-mvc/package.json
index 6fac51a12..92be8e8a3 100644
--- a/sample/15-mvc/package.json
+++ b/sample/15-mvc/package.json
@@ -19,34 +19,33 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
-    "@nestjs/platform-express": "9.0.1",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
     "hbs": "4.2.0",
-    "pug": "3.0.2",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
+    "rimraf": "4.4.1",
     "rxjs": "7.5.5"
   },
   "devDependencies": {
     "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
-    "@nestjs/testing": "9.0.1",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
     "@types/node": "18.0.3",
     "@types/supertest": "2.0.12",
     "jest": "28.1.2",
     "prettier": "2.7.1",
     "supertest": "6.2.4",
-    "ts-jest": "28.0.5",
+    "ts-jest": "28.0.8",
     "ts-loader": "9.3.1",
     "ts-node": "10.8.2",
     "tsconfig-paths": "4.0.0",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
     "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
+    "eslint-config-prettier": "8.8.0",
     "eslint-plugin-import": "2.26.0",
-    "typescript": "4.7.4"
+    "typescript": "4.9.5"
   }
 }
diff --git a/sample/15-mvc/tsconfig.json b/sample/15-mvc/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/15-mvc/tsconfig.json
+++ b/sample/15-mvc/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/16-gateways-ws/package-lock.json b/sample/16-gateways-ws/package-lock.json
index e9aff7cb6..bbd22ca3c 100644
Binary files a/sample/16-gateways-ws/package-lock.json and b/sample/16-gateways-ws/package-lock.json differ
diff --git a/sample/16-gateways-ws/package.json b/sample/16-gateways-ws/package.json
index b6c1e534c..5089aed07 100644
--- a/sample/16-gateways-ws/package.json
+++ b/sample/16-gateways-ws/package.json
@@ -19,14 +19,14 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
-    "@nestjs/platform-express": "9.0.1",
-    "@nestjs/platform-ws": "9.0.1",
-    "@nestjs/websockets": "9.0.1",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
+    "@nestjs/platform-ws": "9.3.12",
+    "@nestjs/websockets": "9.3.12",
     "class-transformer": "0.5.1",
-    "class-validator": "0.13.2",
-    "rimraf": "3.0.2",
+    "class-validator": "0.14.0",
+    "rimraf": "4.4.1",
     "reflect-metadata": "0.1.13",
     "rxjs": "7.5.5",
     "ws": "8.8.0"
@@ -34,23 +34,23 @@
   "devDependencies": {
     "@types/ws": "8.5.3",
     "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
-    "@nestjs/testing": "9.0.1",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
     "@types/node": "18.0.3",
     "@types/supertest": "2.0.12",
     "jest": "28.1.2",
     "prettier": "2.7.1",
     "supertest": "6.2.4",
-    "ts-jest": "28.0.5",
+    "ts-jest": "28.0.8",
     "ts-loader": "9.3.1",
     "ts-node": "10.8.2",
     "tsconfig-paths": "4.0.0",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
     "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
+    "eslint-config-prettier": "8.8.0",
     "eslint-plugin-import": "2.26.0",
-    "typescript": "4.7.4"
+    "typescript": "4.9.5"
   }
 }
diff --git a/sample/16-gateways-ws/tsconfig.json b/sample/16-gateways-ws/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/16-gateways-ws/tsconfig.json
+++ b/sample/16-gateways-ws/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/17-mvc-fastify/package-lock.json b/sample/17-mvc-fastify/package-lock.json
index d3a46d14b..0ce71c566 100644
Binary files a/sample/17-mvc-fastify/package-lock.json and b/sample/17-mvc-fastify/package-lock.json differ
diff --git a/sample/17-mvc-fastify/package.json b/sample/17-mvc-fastify/package.json
index 60c0a2486..bc007d7aa 100644
--- a/sample/17-mvc-fastify/package.json
+++ b/sample/17-mvc-fastify/package.json
@@ -19,35 +19,35 @@
         "test:e2e": "echo 'No e2e tests implemented yet.'"
     },
     "dependencies": {
-        "@nestjs/common": "9.0.1",
-        "@nestjs/core": "9.0.1",
-        "@nestjs/platform-fastify": "9.0.1",
+        "@nestjs/common": "9.3.12",
+        "@nestjs/core": "9.3.12",
+        "@nestjs/platform-fastify": "9.3.12",
         "@fastify/static": "6.4.0",
         "handlebars": "4.7.7",
-        "@fastify/view": "7.0.0",
+        "@fastify/view": "7.4.1",
         "reflect-metadata": "0.1.13",
-        "rimraf": "3.0.2",
+        "rimraf": "4.4.1",
         "rxjs": "7.5.5"
     },
     "devDependencies": {
         "@nestjs/cli": "9.0.0",
-        "@nestjs/schematics": "9.0.1",
-        "@nestjs/testing": "9.0.1",
+        "@nestjs/schematics": "9.0.4",
+        "@nestjs/testing": "9.3.12",
         "@types/express": "4.17.13",
         "@types/node": "18.0.3",
         "@types/supertest": "2.0.12",
-        "@typescript-eslint/eslint-plugin": "5.30.5",
-        "@typescript-eslint/parser": "5.30.5",
+        "@typescript-eslint/eslint-plugin": "5.56.0",
+        "@typescript-eslint/parser": "5.56.0",
         "eslint": "8.19.0",
-        "eslint-config-prettier": "8.5.0",
+        "eslint-config-prettier": "8.8.0",
         "eslint-plugin-import": "2.26.0",
         "jest": "28.1.2",
         "prettier": "2.7.1",
         "supertest": "6.2.4",
-        "ts-jest": "28.0.5",
+        "ts-jest": "28.0.8",
         "ts-loader": "9.3.1",
         "ts-node": "10.8.2",
         "tsconfig-paths": "4.0.0",
-        "typescript": "4.7.4"
+        "typescript": "4.9.5"
     }
 }
diff --git a/sample/17-mvc-fastify/tsconfig.json b/sample/17-mvc-fastify/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/17-mvc-fastify/tsconfig.json
+++ b/sample/17-mvc-fastify/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/18-context/package-lock.json b/sample/18-context/package-lock.json
index 7532c6fa4..9bd55509f 100644
Binary files a/sample/18-context/package-lock.json and b/sample/18-context/package-lock.json differ
diff --git a/sample/18-context/package.json b/sample/18-context/package.json
index 11dccf00e..489a53079 100644
--- a/sample/18-context/package.json
+++ b/sample/18-context/package.json
@@ -19,29 +19,29 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
+    "rimraf": "4.4.1",
     "rxjs": "7.5.5"
   },
   "devDependencies": {
     "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
+    "@nestjs/schematics": "9.0.4",
     "@types/node": "18.0.3",
     "@types/supertest": "2.0.12",
     "jest": "28.1.2",
     "prettier": "2.7.1",
     "supertest": "6.2.4",
-    "ts-jest": "28.0.5",
+    "ts-jest": "28.0.8",
     "ts-loader": "9.3.1",
     "ts-node": "10.8.2",
     "tsconfig-paths": "4.0.0",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
     "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
+    "eslint-config-prettier": "8.8.0",
     "eslint-plugin-import": "2.26.0",
-    "typescript": "4.7.4"
+    "typescript": "4.9.5"
   }
 }
diff --git a/sample/18-context/tsconfig.json b/sample/18-context/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/18-context/tsconfig.json
+++ b/sample/18-context/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/19-auth-jwt/e2e/app/app.e2e-spec.ts b/sample/19-auth-jwt/e2e/app/app.e2e-spec.ts
index 7c07c91cc..066c288ff 100644
--- a/sample/19-auth-jwt/e2e/app/app.e2e-spec.ts
+++ b/sample/19-auth-jwt/e2e/app/app.e2e-spec.ts
@@ -1,5 +1,6 @@
 import { INestApplication } from '@nestjs/common';
 import { Test } from '@nestjs/testing';
+import { expect } from 'chai';
 import * as request from 'supertest';
 import { AppModule } from '../../src/app.module';
 
@@ -19,14 +20,17 @@ describe('E2E JWT Sample', () => {
     const loginReq = await request(app.getHttpServer())
       .post('/auth/login')
       .send({ username: 'john', password: 'changeme' })
-      .expect(201);
+      .expect(200);
 
     const token = loginReq.body.access_token;
     return request(app.getHttpServer())
-      .get('/profile')
+      .get('/auth/profile')
       .set('Authorization', 'Bearer ' + token)
       .expect(200)
-      .expect({ userId: 1, username: 'john' });
+      .expect(({ body }) => {
+        expect(body.sub).to.equal(1);
+        expect(body.username).to.equal('john');
+      });
   });
 
   afterAll(async () => {
diff --git a/sample/19-auth-jwt/package-lock.json b/sample/19-auth-jwt/package-lock.json
index 44e64794c..9850e515b 100644
Binary files a/sample/19-auth-jwt/package-lock.json and b/sample/19-auth-jwt/package-lock.json differ
diff --git a/sample/19-auth-jwt/package.json b/sample/19-auth-jwt/package.json
index d2dce9331..0dfa5a90c 100644
--- a/sample/19-auth-jwt/package.json
+++ b/sample/19-auth-jwt/package.json
@@ -20,39 +20,36 @@
     "test:e2e": "jest --config ./e2e/jest-e2e.json"
   },
   "dependencies": {
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
-    "@nestjs/jwt": "9.0.0",
-    "@nestjs/passport": "9.0.0",
-    "@nestjs/platform-express": "9.0.1",
-    "passport": "0.6.0",
-    "passport-jwt": "4.0.0",
-    "passport-local": "1.0.0",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/jwt": "10.0.3",
+    "@nestjs/passport": "9.0.3",
+    "@nestjs/platform-express": "9.3.12",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
+    "rimraf": "4.4.1",
     "rxjs": "7.5.5"
   },
   "devDependencies": {
     "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
-    "@nestjs/testing": "9.0.1",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
     "@types/jest": "28.1.4",
     "@types/node": "18.0.3",
     "@types/supertest": "2.0.12",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.19.0",
+    "eslint-config-prettier": "8.5.0",
+    "eslint-plugin-import": "2.26.0",
     "jest": "28.1.2",
     "prettier": "2.7.1",
     "supertest": "6.2.4",
-    "ts-jest": "28.0.5",
+    "ts-jest": "28.0.8",
     "ts-loader": "9.3.1",
     "ts-node": "10.8.2",
     "tsconfig-paths": "4.0.0",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
-    "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
-    "eslint-plugin-import": "2.26.0",
-    "typescript": "4.7.4"
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/19-auth-jwt/src/app.controller.ts b/sample/19-auth-jwt/src/app.controller.ts
index 4c6b68ca9..24fa19368 100644
--- a/sample/19-auth-jwt/src/app.controller.ts
+++ b/sample/19-auth-jwt/src/app.controller.ts
@@ -1,21 +1,4 @@
-import { Controller, Get, Post, Request, UseGuards } from '@nestjs/common';
-import { AuthService } from './auth/auth.service';
-import { JwtAuthGuard } from './auth/guards/jwt-auth.guard';
-import { LocalAuthGuard } from './auth/guards/local-auth.guard';
+import { Controller } from '@nestjs/common';
 
 @Controller()
-export class AppController {
-  constructor(private readonly authService: AuthService) {}
-
-  @UseGuards(LocalAuthGuard)
-  @Post('auth/login')
-  async login(@Request() req) {
-    return this.authService.login(req.user);
-  }
-
-  @UseGuards(JwtAuthGuard)
-  @Get('profile')
-  getProfile(@Request() req) {
-    return req.user;
-  }
-}
+export class AppController {}
diff --git a/sample/19-auth-jwt/src/auth/auth.controller.ts b/sample/19-auth-jwt/src/auth/auth.controller.ts
new file mode 100644
index 000000000..8e7b51642
--- /dev/null
+++ b/sample/19-auth-jwt/src/auth/auth.controller.ts
@@ -0,0 +1,28 @@
+import {
+  Body,
+  Controller,
+  Get,
+  HttpCode,
+  HttpStatus,
+  Post,
+  Request,
+} from '@nestjs/common';
+import { AuthService } from './auth.service';
+import { Public } from './decorators/public.decorator';
+
+@Controller('auth')
+export class AuthController {
+  constructor(private authService: AuthService) {}
+
+  @Public()
+  @HttpCode(HttpStatus.OK)
+  @Post('login')
+  signIn(@Body() signInDto: Record<string, any>) {
+    return this.authService.signIn(signInDto.username, signInDto.password);
+  }
+
+  @Get('profile')
+  getProfile(@Request() req) {
+    return req.user;
+  }
+}
diff --git a/sample/19-auth-jwt/src/auth/auth.guard.ts b/sample/19-auth-jwt/src/auth/auth.guard.ts
new file mode 100644
index 000000000..2fd63a07a
--- /dev/null
+++ b/sample/19-auth-jwt/src/auth/auth.guard.ts
@@ -0,0 +1,49 @@
+import {
+  CanActivate,
+  ExecutionContext,
+  Injectable,
+  UnauthorizedException,
+} from '@nestjs/common';
+import { Reflector } from '@nestjs/core';
+import { JwtService } from '@nestjs/jwt';
+import { Request } from 'express';
+import { jwtConstants } from './constants';
+import { IS_PUBLIC_KEY } from './decorators/public.decorator';
+
+@Injectable()
+export class AuthGuard implements CanActivate {
+  constructor(private jwtService: JwtService, private reflector: Reflector) {}
+
+  async canActivate(context: ExecutionContext): Promise<boolean> {
+    const isPublic = this.reflector.getAllAndOverride<boolean>(IS_PUBLIC_KEY, [
+      context.getHandler(),
+      context.getClass(),
+    ]);
+    if (isPublic) {
+      //  See this condition
+      return true;
+    }
+
+    const request = context.switchToHttp().getRequest();
+    const token = this.extractTokenFromHeader(request);
+    if (!token) {
+      throw new UnauthorizedException();
+    }
+    try {
+      const payload = await this.jwtService.verifyAsync(token, {
+        secret: jwtConstants.secret,
+      });
+      //  We're assigning the payload to the request object here
+      // so that we can access it in our route handlers
+      request['user'] = payload;
+    } catch {
+      throw new UnauthorizedException();
+    }
+    return true;
+  }
+
+  private extractTokenFromHeader(request: Request): string | undefined {
+    const [type, token] = request.headers.authorization?.split(' ') ?? [];
+    return type === 'Bearer' ? token : undefined;
+  }
+}
diff --git a/sample/19-auth-jwt/src/auth/auth.module.ts b/sample/19-auth-jwt/src/auth/auth.module.ts
index 7e853d5b7..9361229eb 100644
--- a/sample/19-auth-jwt/src/auth/auth.module.ts
+++ b/sample/19-auth-jwt/src/auth/auth.module.ts
@@ -1,22 +1,29 @@
 import { Module } from '@nestjs/common';
+import { APP_GUARD } from '@nestjs/core';
 import { JwtModule } from '@nestjs/jwt';
-import { PassportModule } from '@nestjs/passport';
 import { UsersModule } from '../users/users.module';
+import { AuthController } from './auth.controller';
+import { AuthGuard } from './auth.guard';
 import { AuthService } from './auth.service';
 import { jwtConstants } from './constants';
-import { JwtStrategy } from './strategies/jwt.strategy';
-import { LocalStrategy } from './strategies/local.strategy';
 
 @Module({
   imports: [
     UsersModule,
-    PassportModule,
     JwtModule.register({
+      global: true,
       secret: jwtConstants.secret,
       signOptions: { expiresIn: '60s' },
     }),
   ],
-  providers: [AuthService, LocalStrategy, JwtStrategy],
+  providers: [
+    AuthService,
+    {
+      provide: APP_GUARD,
+      useClass: AuthGuard,
+    },
+  ],
+  controllers: [AuthController],
   exports: [AuthService],
 })
 export class AuthModule {}
diff --git a/sample/19-auth-jwt/src/auth/auth.service.spec.ts b/sample/19-auth-jwt/src/auth/auth.service.spec.ts
deleted file mode 100644
index 7f1241107..000000000
--- a/sample/19-auth-jwt/src/auth/auth.service.spec.ts
+++ /dev/null
@@ -1,87 +0,0 @@
-import { JwtModule } from '@nestjs/jwt';
-import { PassportModule } from '@nestjs/passport';
-import { Test, TestingModule } from '@nestjs/testing';
-import { UsersModule } from '../users/users.module';
-import { AuthService } from './auth.service';
-import { jwtConstants } from './constants';
-import { JwtStrategy } from './strategies/jwt.strategy';
-import { LocalStrategy } from './strategies/local.strategy';
-
-describe('AuthService', () => {
-  let service: AuthService;
-
-  beforeEach(async () => {
-    const moduleRef: TestingModule = await Test.createTestingModule({
-      imports: [
-        UsersModule,
-        PassportModule,
-        JwtModule.register({
-          secret: jwtConstants.secret,
-          signOptions: { expiresIn: '60s' },
-        }),
-      ],
-      providers: [AuthService, LocalStrategy, JwtStrategy],
-    }).compile();
-
-    service = moduleRef.get<AuthService>(AuthService);
-  });
-
-  it('should be defined', () => {
-    expect(service).toBeDefined();
-  });
-});
-
-describe('validateUser', () => {
-  let service: AuthService;
-
-  beforeEach(async () => {
-    const moduleRef: TestingModule = await Test.createTestingModule({
-      imports: [
-        UsersModule,
-        PassportModule,
-        JwtModule.register({
-          secret: jwtConstants.secret,
-          signOptions: { expiresIn: '60s' },
-        }),
-      ],
-      providers: [AuthService, LocalStrategy, JwtStrategy],
-    }).compile();
-
-    service = moduleRef.get<AuthService>(AuthService);
-  });
-
-  it('should return a user object when credentials are valid', async () => {
-    const res = await service.validateUser('maria', 'guess');
-    expect(res.userId).toEqual(3);
-  });
-
-  it('should return null when credentials are invalid', async () => {
-    const res = await service.validateUser('xxx', 'xxx');
-    expect(res).toBeNull();
-  });
-});
-
-describe('validateLogin', () => {
-  let service: AuthService;
-
-  beforeEach(async () => {
-    const moduleRef: TestingModule = await Test.createTestingModule({
-      imports: [
-        UsersModule,
-        PassportModule,
-        JwtModule.register({
-          secret: jwtConstants.secret,
-          signOptions: { expiresIn: '60s' },
-        }),
-      ],
-      providers: [AuthService, LocalStrategy, JwtStrategy],
-    }).compile();
-
-    service = moduleRef.get<AuthService>(AuthService);
-  });
-
-  it('should return JWT object when credentials are valid', async () => {
-    const res = await service.login({ username: 'maria', userId: 3 });
-    expect(res.access_token).toBeDefined();
-  });
-});
diff --git a/sample/19-auth-jwt/src/auth/auth.service.ts b/sample/19-auth-jwt/src/auth/auth.service.ts
index c477d52b2..6321d1c3e 100644
--- a/sample/19-auth-jwt/src/auth/auth.service.ts
+++ b/sample/19-auth-jwt/src/auth/auth.service.ts
@@ -1,27 +1,22 @@
-import { Injectable } from '@nestjs/common';
-import { UsersService } from '../users/users.service';
+import { Injectable, UnauthorizedException } from '@nestjs/common';
 import { JwtService } from '@nestjs/jwt';
+import { UsersService } from '../users/users.service';
 
 @Injectable()
 export class AuthService {
   constructor(
-    private readonly usersService: UsersService,
-    private readonly jwtService: JwtService,
+    private usersService: UsersService,
+    private jwtService: JwtService,
   ) {}
 
-  async validateUser(username: string, pass: string): Promise<any> {
+  async signIn(username, pass) {
     const user = await this.usersService.findOne(username);
-    if (user && user.password === pass) {
-      const { password, ...result } = user;
-      return result;
+    if (user?.password !== pass) {
+      throw new UnauthorizedException();
     }
-    return null;
-  }
-
-  async login(user: any) {
     const payload = { username: user.username, sub: user.userId };
     return {
-      access_token: this.jwtService.sign(payload),
+      access_token: await this.jwtService.signAsync(payload),
     };
   }
 }
diff --git a/sample/19-auth-jwt/src/auth/constants.ts b/sample/19-auth-jwt/src/auth/constants.ts
index 8b22f8b64..9e8c4061f 100644
--- a/sample/19-auth-jwt/src/auth/constants.ts
+++ b/sample/19-auth-jwt/src/auth/constants.ts
@@ -1,3 +1,4 @@
 export const jwtConstants = {
-  secret: 'secretKey',
+  secret:
+    'DO NOT USE THIS VALUE. INSTEAD, CREATE A COMPLEX SECRET AND KEEP IT SAFE OUTSIDE OF THE SOURCE CODE.',
 };
diff --git a/sample/19-auth-jwt/src/auth/decorators/public.decorator.ts b/sample/19-auth-jwt/src/auth/decorators/public.decorator.ts
new file mode 100644
index 000000000..b3845e122
--- /dev/null
+++ b/sample/19-auth-jwt/src/auth/decorators/public.decorator.ts
@@ -0,0 +1,4 @@
+import { SetMetadata } from '@nestjs/common';
+
+export const IS_PUBLIC_KEY = 'isPublic';
+export const Public = () => SetMetadata(IS_PUBLIC_KEY, true);
diff --git a/sample/19-auth-jwt/src/auth/guards/jwt-auth.guard.ts b/sample/19-auth-jwt/src/auth/guards/jwt-auth.guard.ts
deleted file mode 100644
index 2155290ed..000000000
--- a/sample/19-auth-jwt/src/auth/guards/jwt-auth.guard.ts
+++ /dev/null
@@ -1,5 +0,0 @@
-import { Injectable } from '@nestjs/common';
-import { AuthGuard } from '@nestjs/passport';
-
-@Injectable()
-export class JwtAuthGuard extends AuthGuard('jwt') {}
diff --git a/sample/19-auth-jwt/src/auth/guards/local-auth.guard.ts b/sample/19-auth-jwt/src/auth/guards/local-auth.guard.ts
deleted file mode 100644
index ccf962b67..000000000
--- a/sample/19-auth-jwt/src/auth/guards/local-auth.guard.ts
+++ /dev/null
@@ -1,5 +0,0 @@
-import { Injectable } from '@nestjs/common';
-import { AuthGuard } from '@nestjs/passport';
-
-@Injectable()
-export class LocalAuthGuard extends AuthGuard('local') {}
diff --git a/sample/19-auth-jwt/src/auth/strategies/jwt.strategy.ts b/sample/19-auth-jwt/src/auth/strategies/jwt.strategy.ts
deleted file mode 100644
index 08524da5a..000000000
--- a/sample/19-auth-jwt/src/auth/strategies/jwt.strategy.ts
+++ /dev/null
@@ -1,19 +0,0 @@
-import { Injectable } from '@nestjs/common';
-import { PassportStrategy } from '@nestjs/passport';
-import { ExtractJwt, Strategy } from 'passport-jwt';
-import { jwtConstants } from '../constants';
-
-@Injectable()
-export class JwtStrategy extends PassportStrategy(Strategy) {
-  constructor() {
-    super({
-      jwtFromRequest: ExtractJwt.fromAuthHeaderAsBearerToken(),
-      ignoreExpiration: false,
-      secretOrKey: jwtConstants.secret,
-    });
-  }
-
-  async validate(payload: any) {
-    return { userId: payload.sub, username: payload.username };
-  }
-}
diff --git a/sample/19-auth-jwt/src/auth/strategies/local.strategy.ts b/sample/19-auth-jwt/src/auth/strategies/local.strategy.ts
deleted file mode 100644
index 79f85280f..000000000
--- a/sample/19-auth-jwt/src/auth/strategies/local.strategy.ts
+++ /dev/null
@@ -1,19 +0,0 @@
-import { Injectable, UnauthorizedException } from '@nestjs/common';
-import { PassportStrategy } from '@nestjs/passport';
-import { Strategy } from 'passport-local';
-import { AuthService } from '../auth.service';
-
-@Injectable()
-export class LocalStrategy extends PassportStrategy(Strategy) {
-  constructor(private readonly authService: AuthService) {
-    super();
-  }
-
-  async validate(username: string, password: string): Promise<any> {
-    const user = await this.authService.validateUser(username, password);
-    if (!user) {
-      throw new UnauthorizedException();
-    }
-    return user;
-  }
-}
diff --git a/sample/19-auth-jwt/src/users/users.service.spec.ts b/sample/19-auth-jwt/src/users/users.service.spec.ts
index 71c5e2da4..62815ba64 100644
--- a/sample/19-auth-jwt/src/users/users.service.spec.ts
+++ b/sample/19-auth-jwt/src/users/users.service.spec.ts
@@ -1,27 +1,18 @@
 import { Test, TestingModule } from '@nestjs/testing';
-import { User, UsersService } from './users.service';
+import { UsersService } from './users.service';
 
 describe('UsersService', () => {
   let service: UsersService;
 
   beforeEach(async () => {
-    const moduleRef: TestingModule = await Test.createTestingModule({
+    const module: TestingModule = await Test.createTestingModule({
       providers: [UsersService],
     }).compile();
 
-    service = moduleRef.get<UsersService>(UsersService);
+    service = module.get<UsersService>(UsersService);
   });
 
   it('should be defined', () => {
     expect(service).toBeDefined();
   });
-  it.each`
-    name      | returnVal
-    ${'john'} | ${{ userId: 1, username: 'john', password: 'changeme' }}
-  `(
-    'should call findOne for $name and return $returnVal',
-    async ({ name, returnVal }: { name: string; returnVal: User }) => {
-      expect(await service.findOne(name)).toEqual(returnVal);
-    },
-  );
 });
diff --git a/sample/19-auth-jwt/src/users/users.service.ts b/sample/19-auth-jwt/src/users/users.service.ts
index f24f26b30..47e5cde7b 100644
--- a/sample/19-auth-jwt/src/users/users.service.ts
+++ b/sample/19-auth-jwt/src/users/users.service.ts
@@ -1,30 +1,22 @@
 import { Injectable } from '@nestjs/common';
 
+// This should be a real class/interface representing a user entity
 export type User = any;
 
 @Injectable()
 export class UsersService {
-  private readonly users: User[];
-
-  constructor() {
-    this.users = [
-      {
-        userId: 1,
-        username: 'john',
-        password: 'changeme',
-      },
-      {
-        userId: 2,
-        username: 'chris',
-        password: 'secret',
-      },
-      {
-        userId: 3,
-        username: 'maria',
-        password: 'guess',
-      },
-    ];
-  }
+  private readonly users = [
+    {
+      userId: 1,
+      username: 'john',
+      password: 'changeme',
+    },
+    {
+      userId: 2,
+      username: 'maria',
+      password: 'guess',
+    },
+  ];
 
   async findOne(username: string): Promise<User | undefined> {
     return this.users.find(user => user.username === username);
diff --git a/sample/19-auth-jwt/tsconfig.json b/sample/19-auth-jwt/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/19-auth-jwt/tsconfig.json
+++ b/sample/19-auth-jwt/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/20-cache/package-lock.json b/sample/20-cache/package-lock.json
index b99936b33..1d13a94a7 100644
Binary files a/sample/20-cache/package-lock.json and b/sample/20-cache/package-lock.json differ
diff --git a/sample/20-cache/package.json b/sample/20-cache/package.json
index 2ef757339..392d9c6f8 100644
--- a/sample/20-cache/package.json
+++ b/sample/20-cache/package.json
@@ -19,36 +19,36 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
-    "@nestjs/platform-express": "9.0.1",
+    "@nestjs/cache-manager": "1.0.0",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
     "cache-manager": "^4.1.0",
-    "cache-manager-redis-store": "2.0.0",
     "class-transformer": "0.5.1",
-    "class-validator": "0.13.2",
+    "class-validator": "0.14.0",
     "reflect-metadata": "0.1.13",
     "rxjs": "7.5.5"
   },
   "devDependencies": {
     "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
-    "@nestjs/testing": "9.0.1",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/cache-manager": "^4.0.1",
     "@types/express": "4.17.13",
     "@types/node": "18.0.3",
     "@types/supertest": "2.0.12",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
     "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
+    "eslint-config-prettier": "8.8.0",
     "eslint-plugin-import": "2.26.0",
     "jest": "28.1.2",
     "prettier": "2.7.1",
     "supertest": "6.2.4",
-    "ts-jest": "28.0.5",
+    "ts-jest": "28.0.8",
     "ts-loader": "9.3.1",
     "ts-node": "10.8.2",
     "tsconfig-paths": "4.0.0",
-    "typescript": "4.7.4"
+    "typescript": "4.9.5"
   }
 }
diff --git a/sample/20-cache/src/app.controller.ts b/sample/20-cache/src/app.controller.ts
index d2ba94e99..19a3b181f 100644
--- a/sample/20-cache/src/app.controller.ts
+++ b/sample/20-cache/src/app.controller.ts
@@ -1,9 +1,5 @@
-import {
-  CacheInterceptor,
-  Controller,
-  Get,
-  UseInterceptors,
-} from '@nestjs/common';
+import { CacheInterceptor } from '@nestjs/cache-manager';
+import { Controller, Get, UseInterceptors } from '@nestjs/common';
 
 @Controller()
 @UseInterceptors(CacheInterceptor)
diff --git a/sample/20-cache/src/app.module.ts b/sample/20-cache/src/app.module.ts
index a85f2b5fb..310d05226 100644
--- a/sample/20-cache/src/app.module.ts
+++ b/sample/20-cache/src/app.module.ts
@@ -1,4 +1,5 @@
-import { CacheModule, Module } from '@nestjs/common';
+import { CacheModule } from '@nestjs/cache-manager';
+import { Module } from '@nestjs/common';
 import { AppController } from './app.controller';
 
 @Module({
diff --git a/sample/20-cache/src/common/http-cache.interceptor.ts b/sample/20-cache/src/common/http-cache.interceptor.ts
index c0d3638c7..f2bc578ef 100644
--- a/sample/20-cache/src/common/http-cache.interceptor.ts
+++ b/sample/20-cache/src/common/http-cache.interceptor.ts
@@ -1,4 +1,5 @@
-import { CacheInterceptor, ExecutionContext, Injectable } from '@nestjs/common';
+import { CacheInterceptor } from '@nestjs/cache-manager';
+import { ExecutionContext, Injectable } from '@nestjs/common';
 
 @Injectable()
 export class HttpCacheInterceptor extends CacheInterceptor {
diff --git a/sample/20-cache/tsconfig.json b/sample/20-cache/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/20-cache/tsconfig.json
+++ b/sample/20-cache/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/21-serializer/package-lock.json b/sample/21-serializer/package-lock.json
index 24e2726f0..7f568dfb1 100644
Binary files a/sample/21-serializer/package-lock.json and b/sample/21-serializer/package-lock.json differ
diff --git a/sample/21-serializer/package.json b/sample/21-serializer/package.json
index 75e40184b..a06427aee 100644
--- a/sample/21-serializer/package.json
+++ b/sample/21-serializer/package.json
@@ -19,33 +19,33 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
-    "@nestjs/platform-express": "9.0.1",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
     "class-transformer": "0.5.1",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
+    "rimraf": "4.4.1",
     "rxjs": "7.5.5"
   },
   "devDependencies": {
     "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
-    "@nestjs/testing": "9.0.1",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
     "@types/node": "18.0.3",
     "@types/supertest": "2.0.12",
     "jest": "28.1.2",
     "prettier": "2.7.1",
     "supertest": "6.2.4",
-    "ts-jest": "28.0.5",
+    "ts-jest": "28.0.8",
     "ts-loader": "9.3.1",
     "ts-node": "10.8.2",
     "tsconfig-paths": "4.0.0",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
     "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
+    "eslint-config-prettier": "8.8.0",
     "eslint-plugin-import": "2.26.0",
-    "typescript": "4.7.4"
+    "typescript": "4.9.5"
   }
 }
diff --git a/sample/21-serializer/tsconfig.json b/sample/21-serializer/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/21-serializer/tsconfig.json
+++ b/sample/21-serializer/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/22-graphql-prisma/package-lock.json b/sample/22-graphql-prisma/package-lock.json
index 907e39eb2..8cc786aba 100644
Binary files a/sample/22-graphql-prisma/package-lock.json and b/sample/22-graphql-prisma/package-lock.json differ
diff --git a/sample/22-graphql-prisma/package.json b/sample/22-graphql-prisma/package.json
old mode 100755
new mode 100644
index f808c73d6..839c0a723
--- a/sample/22-graphql-prisma/package.json
+++ b/sample/22-graphql-prisma/package.json
@@ -20,43 +20,42 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/apollo": "^10.0.17",
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
-    "@nestjs/graphql": "10.0.18",
-    "@nestjs/platform-express": "9.0.1",
-    "@prisma/client": "3.8.1",
-    "apollo-server": "3.6.2",
-    "apollo-server-express": "3.6.2",
+    "@apollo/server": "4.5.0",
+    "@nestjs/apollo": "11.0.4",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/graphql": "11.0.0",
+    "@nestjs/platform-express": "9.3.12",
+    "@prisma/client": "4.11.0",
     "class-transformer": "0.5.1",
-    "class-validator": "0.13.2",
-    "graphql": "15.8.0",
+    "class-validator": "0.14.0",
+    "graphql": "16.6.0",
     "graphql-subscriptions": "2.0.0",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.5.5"
+    "rimraf": "4.4.1",
+    "rxjs": "7.8.0"
   },
   "devDependencies": {
-    "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
-    "@nestjs/testing": "9.0.1",
-    "@types/express": "4.17.13",
-    "@types/node": "18.0.3",
+    "@nestjs/cli": "9.2.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
+    "@types/express": "4.17.17",
+    "@types/node": "18.15.0",
     "@types/supertest": "2.0.12",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
-    "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
-    "eslint-plugin-import": "2.26.0",
-    "jest": "28.1.2",
-    "prettier": "2.7.1",
-    "prisma": "^4.0.0",
-    "supertest": "6.2.4",
-    "ts-jest": "28.0.5",
-    "ts-loader": "9.3.1",
-    "ts-morph": "15.1.0",
-    "ts-node": "10.8.2",
-    "tsconfig-paths": "4.0.0",
-    "typescript": "4.7.4"
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.35.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-import": "2.27.5",
+    "jest": "29.5.0",
+    "prettier": "2.8.4",
+    "prisma": "^4.11.0",
+    "supertest": "6.3.3",
+    "ts-jest": "29.0.5",
+    "ts-loader": "9.4.2",
+    "ts-morph": "17.0.1",
+    "ts-node": "10.9.1",
+    "tsconfig-paths": "4.1.2",
+    "typescript": "4.9.5"
   }
 }
diff --git a/sample/22-graphql-prisma/tsconfig.json b/sample/22-graphql-prisma/tsconfig.json
index e268e37aa..d9c82ca97 100755
--- a/sample/22-graphql-prisma/tsconfig.json
+++ b/sample/22-graphql-prisma/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/23-graphql-code-first/package-lock.json b/sample/23-graphql-code-first/package-lock.json
index 0b6986378..f40dee72a 100644
Binary files a/sample/23-graphql-code-first/package-lock.json and b/sample/23-graphql-code-first/package-lock.json differ
diff --git a/sample/23-graphql-code-first/package.json b/sample/23-graphql-code-first/package.json
index 6a811d88e..febc762b8 100644
--- a/sample/23-graphql-code-first/package.json
+++ b/sample/23-graphql-code-first/package.json
@@ -19,40 +19,39 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/apollo": "10.0.17",
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
-    "@nestjs/graphql": "10.0.18",
-    "@nestjs/platform-express": "9.0.1",
-    "apollo-server": "3.9.0",
-    "apollo-server-express": "3.9.0",
+    "@apollo/server": "4.5.0",
+    "@nestjs/apollo": "11.0.4",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/graphql": "11.0.0",
+    "@nestjs/platform-express": "9.3.12",
     "class-transformer": "0.5.1",
-    "class-validator": "0.13.2",
-    "graphql": "16.5.0",
-    "graphql-query-complexity": "0.11.0",
+    "class-validator": "0.14.0",
+    "graphql": "16.6.0",
+    "graphql-query-complexity": "0.12.0",
     "graphql-subscriptions": "2.0.0",
     "reflect-metadata": "0.1.13",
-    "rxjs": "7.5.5"
+    "rxjs": "7.8.0"
   },
   "devDependencies": {
-    "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
-    "@nestjs/testing": "9.0.1",
-    "@types/express": "4.17.13",
-    "@types/node": "18.0.3",
+    "@nestjs/cli": "9.2.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
+    "@types/express": "4.17.17",
+    "@types/node": "18.15.0",
     "@types/supertest": "2.0.12",
-    "jest": "28.1.2",
-    "prettier": "2.7.1",
-    "supertest": "6.2.4",
-    "ts-jest": "28.0.5",
-    "ts-loader": "9.3.1",
-    "ts-node": "10.8.2",
-    "tsconfig-paths": "4.0.0",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
-    "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
-    "eslint-plugin-import": "2.26.0",
-    "typescript": "4.7.4"
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.35.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-import": "2.27.5",
+    "jest": "29.5.0",
+    "prettier": "2.8.4",
+    "supertest": "6.3.3",
+    "ts-jest": "29.0.5",
+    "ts-loader": "9.4.2",
+    "ts-node": "10.9.1",
+    "tsconfig-paths": "4.1.2",
+    "typescript": "4.9.5"
   }
 }
diff --git a/sample/23-graphql-code-first/schema.gql b/sample/23-graphql-code-first/schema.gql
index 4df716415..7a46060d1 100644
--- a/sample/23-graphql-code-first/schema.gql
+++ b/sample/23-graphql-code-first/schema.gql
@@ -18,7 +18,7 @@ scalar Date
 
 type Query {
   recipe(id: String!): Recipe!
-  recipes(skip: Int = 0, take: Int = 25): [Recipe!]!
+  recipes(skip: Int! = 0, take: Int! = 25): [Recipe!]!
 }
 
 type Mutation {
diff --git a/sample/23-graphql-code-first/src/common/plugins/complexity.plugin.ts b/sample/23-graphql-code-first/src/common/plugins/complexity.plugin.ts
index b58cafeb2..d7e3699e9 100644
--- a/sample/23-graphql-code-first/src/common/plugins/complexity.plugin.ts
+++ b/sample/23-graphql-code-first/src/common/plugins/complexity.plugin.ts
@@ -1,9 +1,6 @@
+import { ApolloServerPlugin, GraphQLRequestListener } from '@apollo/server';
 import { Plugin } from '@nestjs/apollo';
 import { GraphQLSchemaHost } from '@nestjs/graphql';
-import {
-  ApolloServerPlugin,
-  GraphQLRequestListener,
-} from 'apollo-server-plugin-base';
 import { GraphQLError } from 'graphql';
 import {
   fieldExtensionsEstimator,
@@ -15,7 +12,7 @@ import {
 export class ComplexityPlugin implements ApolloServerPlugin {
   constructor(private gqlSchemaHost: GraphQLSchemaHost) {}
 
-  async requestDidStart(): Promise<GraphQLRequestListener> {
+  async requestDidStart(): Promise<GraphQLRequestListener<any>> {
     const { schema } = this.gqlSchemaHost;
 
     return {
diff --git a/sample/23-graphql-code-first/src/common/plugins/logging.plugin.ts b/sample/23-graphql-code-first/src/common/plugins/logging.plugin.ts
index 449d257f4..77c23a96c 100644
--- a/sample/23-graphql-code-first/src/common/plugins/logging.plugin.ts
+++ b/sample/23-graphql-code-first/src/common/plugins/logging.plugin.ts
@@ -1,12 +1,9 @@
+import { ApolloServerPlugin, GraphQLRequestListener } from '@apollo/server';
 import { Plugin } from '@nestjs/apollo';
-import {
-  ApolloServerPlugin,
-  GraphQLRequestListener,
-} from 'apollo-server-plugin-base';
 
 @Plugin()
 export class LoggingPlugin implements ApolloServerPlugin {
-  async requestDidStart(): Promise<GraphQLRequestListener> {
+  async requestDidStart(): Promise<GraphQLRequestListener<any>> {
     console.log('Request started');
     return {
       async willSendResponse() {
diff --git a/sample/23-graphql-code-first/tsconfig.json b/sample/23-graphql-code-first/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/23-graphql-code-first/tsconfig.json
+++ b/sample/23-graphql-code-first/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/24-serve-static/package-lock.json b/sample/24-serve-static/package-lock.json
index e2e656b81..01d8f21ad 100644
Binary files a/sample/24-serve-static/package-lock.json and b/sample/24-serve-static/package-lock.json differ
diff --git a/sample/24-serve-static/package.json b/sample/24-serve-static/package.json
index f618b0c8d..e7f0ec201 100644
--- a/sample/24-serve-static/package.json
+++ b/sample/24-serve-static/package.json
@@ -19,35 +19,35 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
-    "@nestjs/serve-static": "3.0.0",
-    "@nestjs/platform-express": "9.0.1",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/serve-static": "3.0.1",
+    "@nestjs/platform-express": "9.3.12",
     "class-transformer": "0.5.1",
-    "class-validator": "0.13.2",
+    "class-validator": "0.14.0",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
+    "rimraf": "4.4.1",
     "rxjs": "7.5.5"
   },
   "devDependencies": {
     "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
-    "@nestjs/testing": "9.0.1",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
     "@types/node": "18.0.3",
     "@types/supertest": "2.0.12",
     "jest": "28.1.2",
     "prettier": "2.7.1",
     "supertest": "6.2.4",
-    "ts-jest": "28.0.5",
+    "ts-jest": "28.0.8",
     "ts-loader": "9.3.1",
     "ts-node": "10.8.2",
     "tsconfig-paths": "4.0.0",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
     "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
+    "eslint-config-prettier": "8.8.0",
     "eslint-plugin-import": "2.26.0",
-    "typescript": "4.7.4"
+    "typescript": "4.9.5"
   }
 }
diff --git a/sample/24-serve-static/src/app.module.ts b/sample/24-serve-static/src/app.module.ts
index 3f4864ce5..4fbea3cf2 100644
--- a/sample/24-serve-static/src/app.module.ts
+++ b/sample/24-serve-static/src/app.module.ts
@@ -7,7 +7,7 @@ import { AppController } from './app.controller';
   imports: [
     ServeStaticModule.forRoot({
       rootPath: join(__dirname, '..', 'client'),
-      exclude: ['/api*'],
+      exclude: ['/api/(.*)'],
     }),
   ],
   controllers: [AppController],
diff --git a/sample/24-serve-static/tsconfig.json b/sample/24-serve-static/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/24-serve-static/tsconfig.json
+++ b/sample/24-serve-static/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/25-dynamic-modules/package-lock.json b/sample/25-dynamic-modules/package-lock.json
index 187f4695d..9bb761fd3 100644
Binary files a/sample/25-dynamic-modules/package-lock.json and b/sample/25-dynamic-modules/package-lock.json differ
diff --git a/sample/25-dynamic-modules/package.json b/sample/25-dynamic-modules/package.json
index dd483bccd..337372628 100644
--- a/sample/25-dynamic-modules/package.json
+++ b/sample/25-dynamic-modules/package.json
@@ -19,19 +19,19 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
-    "@nestjs/platform-express": "9.0.1",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
     "dotenv": "16.0.1",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
+    "rimraf": "4.4.1",
     "rxjs": "7.5.5"
   },
   "devDependencies": {
     "@types/dotenv": "8.2.0",
     "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
-    "@nestjs/testing": "9.0.1",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
     "@types/jest": "28.1.4",
     "@types/node": "18.0.3",
@@ -39,16 +39,16 @@
     "jest": "28.1.2",
     "prettier": "2.7.1",
     "supertest": "6.2.4",
-    "ts-jest": "28.0.5",
+    "ts-jest": "28.0.8",
     "ts-loader": "9.3.1",
     "ts-node": "10.8.2",
     "tsconfig-paths": "4.0.0",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
     "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
+    "eslint-config-prettier": "8.8.0",
     "eslint-plugin-import": "2.26.0",
-    "typescript": "4.7.4"
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/25-dynamic-modules/tsconfig.json b/sample/25-dynamic-modules/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/25-dynamic-modules/tsconfig.json
+++ b/sample/25-dynamic-modules/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/26-queues/package-lock.json b/sample/26-queues/package-lock.json
index e01b48f03..d432abc4c 100644
Binary files a/sample/26-queues/package-lock.json and b/sample/26-queues/package-lock.json differ
diff --git a/sample/26-queues/package.json b/sample/26-queues/package.json
index 98546675e..5b1c44d02 100644
--- a/sample/26-queues/package.json
+++ b/sample/26-queues/package.json
@@ -19,21 +19,21 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/bull": "0.6.0",
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
-    "@nestjs/platform-express": "9.0.1",
+    "@nestjs/bull": "0.6.3",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
     "bull": "4.8.4",
     "dotenv": "16.0.1",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
+    "rimraf": "4.4.1",
     "rxjs": "7.5.5"
   },
   "devDependencies": {
     "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
-    "@nestjs/testing": "9.0.1",
-    "@types/bull": "3.15.8",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
+    "@types/bull": "3.15.9",
     "@types/dotenv": "8.2.0",
     "@types/express": "4.17.13",
     "@types/jest": "28.1.4",
@@ -42,16 +42,16 @@
     "jest": "28.1.2",
     "prettier": "2.7.1",
     "supertest": "6.2.4",
-    "ts-jest": "28.0.5",
+    "ts-jest": "28.0.8",
     "ts-loader": "9.3.1",
     "ts-node": "10.8.2",
     "tsconfig-paths": "4.0.0",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
     "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
+    "eslint-config-prettier": "8.8.0",
     "eslint-plugin-import": "2.26.0",
-    "typescript": "4.7.4"
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/26-queues/tsconfig.json b/sample/26-queues/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/26-queues/tsconfig.json
+++ b/sample/26-queues/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/27-scheduling/package-lock.json b/sample/27-scheduling/package-lock.json
index a9a748432..19e418ab2 100644
Binary files a/sample/27-scheduling/package-lock.json and b/sample/27-scheduling/package-lock.json differ
diff --git a/sample/27-scheduling/package.json b/sample/27-scheduling/package.json
index 886433e40..4eda6d526 100644
--- a/sample/27-scheduling/package.json
+++ b/sample/27-scheduling/package.json
@@ -19,20 +19,20 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
-    "@nestjs/platform-express": "9.0.1",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
     "@nestjs/schedule": "2.1.0",
     "dotenv": "16.0.1",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
+    "rimraf": "4.4.1",
     "rxjs": "7.5.5"
   },
   "devDependencies": {
     "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
-    "@nestjs/testing": "9.0.1",
-    "@types/bull": "3.15.8",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
+    "@types/bull": "3.15.9",
     "@types/dotenv": "8.2.0",
     "@types/express": "4.17.13",
     "@types/jest": "28.1.4",
@@ -41,16 +41,16 @@
     "jest": "28.1.2",
     "prettier": "2.7.1",
     "supertest": "6.2.4",
-    "ts-jest": "28.0.5",
+    "ts-jest": "28.0.8",
     "ts-loader": "9.3.1",
     "ts-node": "10.8.2",
     "tsconfig-paths": "4.0.0",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
     "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
+    "eslint-config-prettier": "8.8.0",
     "eslint-plugin-import": "2.26.0",
-    "typescript": "4.7.4"
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/27-scheduling/tsconfig.json b/sample/27-scheduling/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/27-scheduling/tsconfig.json
+++ b/sample/27-scheduling/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/28-sse/package-lock.json b/sample/28-sse/package-lock.json
index 990122155..ca85e404e 100644
Binary files a/sample/28-sse/package-lock.json and b/sample/28-sse/package-lock.json differ
diff --git a/sample/28-sse/package.json b/sample/28-sse/package.json
index 232662582..5e46008b2 100644
--- a/sample/28-sse/package.json
+++ b/sample/28-sse/package.json
@@ -19,17 +19,17 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
-    "@nestjs/platform-express": "9.0.1",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
+    "rimraf": "4.4.1",
     "rxjs": "7.5.5"
   },
   "devDependencies": {
     "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
-    "@nestjs/testing": "9.0.1",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/dotenv": "8.2.0",
     "@types/express": "4.17.13",
     "@types/jest": "28.1.4",
@@ -38,16 +38,16 @@
     "jest": "28.1.2",
     "prettier": "2.7.1",
     "supertest": "6.2.4",
-    "ts-jest": "28.0.5",
+    "ts-jest": "28.0.8",
     "ts-loader": "9.3.1",
     "ts-node": "10.8.2",
     "tsconfig-paths": "4.0.0",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
     "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
+    "eslint-config-prettier": "8.8.0",
     "eslint-plugin-import": "2.26.0",
-    "typescript": "4.7.4"
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/28-sse/tsconfig.json b/sample/28-sse/tsconfig.json
index 4e6e210f1..1bbdea209 100644
--- a/sample/28-sse/tsconfig.json
+++ b/sample/28-sse/tsconfig.json
@@ -5,7 +5,7 @@
     "removeComments": true,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/29-file-upload/package-lock.json b/sample/29-file-upload/package-lock.json
index 4cca07d6a..2b858006d 100644
Binary files a/sample/29-file-upload/package-lock.json and b/sample/29-file-upload/package-lock.json differ
diff --git a/sample/29-file-upload/package.json b/sample/29-file-upload/package.json
index 5d80b6566..88a0effb5 100644
--- a/sample/29-file-upload/package.json
+++ b/sample/29-file-upload/package.json
@@ -19,19 +19,19 @@
     "test:e2e": "jest --config ./e2e/jest-e2e.json"
   },
   "dependencies": {
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
-    "@nestjs/platform-express": "9.0.1",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
     "class-transformer": "0.5.1",
-    "class-validator": "0.13.2",
+    "class-validator": "0.14.0",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
+    "rimraf": "4.4.1",
     "rxjs": "7.5.5"
   },
   "devDependencies": {
     "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
-    "@nestjs/testing": "9.0.1",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
     "@types/jest": "28.1.4",
     "@types/multer": "1.4.7",
@@ -40,16 +40,16 @@
     "jest": "28.1.2",
     "prettier": "2.7.1",
     "supertest": "6.2.4",
-    "ts-jest": "28.0.5",
+    "ts-jest": "28.0.8",
     "ts-loader": "9.3.1",
     "ts-node": "10.8.2",
     "tsconfig-paths": "4.0.0",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
     "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
+    "eslint-config-prettier": "8.8.0",
     "eslint-plugin-import": "2.26.0",
-    "typescript": "4.7.4"
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/29-file-upload/tsconfig.json b/sample/29-file-upload/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/29-file-upload/tsconfig.json
+++ b/sample/29-file-upload/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/30-event-emitter/package-lock.json b/sample/30-event-emitter/package-lock.json
index 2bc542628..6808ed49d 100644
Binary files a/sample/30-event-emitter/package-lock.json and b/sample/30-event-emitter/package-lock.json differ
diff --git a/sample/30-event-emitter/package.json b/sample/30-event-emitter/package.json
index c989c709c..ae503c037 100644
--- a/sample/30-event-emitter/package.json
+++ b/sample/30-event-emitter/package.json
@@ -19,35 +19,35 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
     "@nestjs/event-emitter": "1.2.0",
-    "@nestjs/platform-express": "9.0.1",
+    "@nestjs/platform-express": "9.3.12",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
+    "rimraf": "4.4.1",
     "rxjs": "7.5.5"
   },
   "devDependencies": {
     "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
-    "@nestjs/testing": "9.0.1",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
     "@types/jest": "28.1.4",
     "@types/node": "18.0.3",
     "@types/supertest": "2.0.12",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
     "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
+    "eslint-config-prettier": "8.8.0",
     "eslint-plugin-import": "2.26.0",
     "jest": "28.1.2",
     "prettier": "2.7.1",
     "supertest": "6.2.4",
-    "ts-jest": "28.0.5",
+    "ts-jest": "28.0.8",
     "ts-loader": "9.3.1",
     "ts-node": "10.8.2",
     "tsconfig-paths": "4.0.0",
-    "typescript": "4.7.4"
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/30-event-emitter/tsconfig.json b/sample/30-event-emitter/tsconfig.json
index a0e283732..d670b01d5 100644
--- a/sample/30-event-emitter/tsconfig.json
+++ b/sample/30-event-emitter/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/31-graphql-federation-code-first/README.md b/sample/31-graphql-federation-code-first/README.md
index e7b90c765..bbe0acfd8 100644
--- a/sample/31-graphql-federation-code-first/README.md
+++ b/sample/31-graphql-federation-code-first/README.md
@@ -4,7 +4,7 @@ A simple example of GraphQL Federation using Code First approach.
 
 ## Execution
 
-Make sure to start the two sub-graph applications first, then the gatway. Otherwise the gateway won't be able to fetch schemas from the sub-graphs.
+Make sure to start the two sub-graph applications first, then the gateway. Otherwise the gateway won't be able to fetch schemas from the sub-graphs.
 
 ```sh
 cd users-application && npm run start
diff --git a/sample/31-graphql-federation-code-first/gateway/package-lock.json b/sample/31-graphql-federation-code-first/gateway/package-lock.json
index 04e55ac61..9f8bf7aae 100644
Binary files a/sample/31-graphql-federation-code-first/gateway/package-lock.json and b/sample/31-graphql-federation-code-first/gateway/package-lock.json differ
diff --git a/sample/31-graphql-federation-code-first/gateway/package.json b/sample/31-graphql-federation-code-first/gateway/package.json
index 781d850bd..cf98ac931 100644
--- a/sample/31-graphql-federation-code-first/gateway/package.json
+++ b/sample/31-graphql-federation-code-first/gateway/package.json
@@ -21,41 +21,41 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@apollo/gateway": "2.0.5",
-    "@nestjs/apollo": "10.0.17",
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
-    "@nestjs/graphql": "10.0.18",
-    "@nestjs/platform-express": "9.0.1",
-    "apollo-server-express": "3.9.0",
-    "graphql": "16.5.0",
-    "graphql-tools": "8.3.0",
+    "@apollo/gateway": "2.4.0",
+    "@apollo/server": "4.5.0",
+    "@nestjs/apollo": "11.0.4",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/graphql": "11.0.0",
+    "@nestjs/platform-express": "9.3.12",
+    "graphql": "16.6.0",
+    "graphql-tools": "8.3.19",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.5.5",
-    "ts-morph": "15.1.0"
+    "rimraf": "4.4.1",
+    "rxjs": "7.8.0",
+    "ts-morph": "17.0.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
-    "@nestjs/testing": "9.0.1",
-    "@types/express": "4.17.13",
-    "@types/jest": "28.1.4",
-    "@types/node": "18.0.3",
+    "@nestjs/cli": "9.2.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
+    "@types/express": "4.17.17",
+    "@types/jest": "29.4.0",
+    "@types/node": "18.15.0",
     "@types/supertest": "2.0.12",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
-    "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.35.0",
+    "eslint-config-prettier": "8.8.0",
     "eslint-plugin-prettier": "4.2.1",
-    "jest": "28.1.2",
-    "prettier": "2.7.1",
-    "supertest": "6.2.4",
-    "ts-jest": "28.0.5",
-    "ts-loader": "9.3.1",
-    "ts-node": "10.8.2",
-    "tsconfig-paths": "4.0.0",
-    "typescript": "4.7.4"
+    "jest": "29.5.0",
+    "prettier": "2.8.4",
+    "supertest": "6.3.3",
+    "ts-jest": "29.0.5",
+    "ts-loader": "9.4.2",
+    "ts-node": "10.9.1",
+    "tsconfig-paths": "4.1.2",
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/31-graphql-federation-code-first/gateway/tsconfig.json b/sample/31-graphql-federation-code-first/gateway/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/31-graphql-federation-code-first/gateway/tsconfig.json
+++ b/sample/31-graphql-federation-code-first/gateway/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/31-graphql-federation-code-first/posts-application/package-lock.json b/sample/31-graphql-federation-code-first/posts-application/package-lock.json
index 5f4c2ce91..b0c7e5696 100644
Binary files a/sample/31-graphql-federation-code-first/posts-application/package-lock.json and b/sample/31-graphql-federation-code-first/posts-application/package-lock.json differ
diff --git a/sample/31-graphql-federation-code-first/posts-application/package.json b/sample/31-graphql-federation-code-first/posts-application/package.json
index 67cb5f415..6bcdf34d4 100644
--- a/sample/31-graphql-federation-code-first/posts-application/package.json
+++ b/sample/31-graphql-federation-code-first/posts-application/package.json
@@ -21,43 +21,42 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@apollo/federation": "0.36.1",
-    "@apollo/gateway": "2.0.5",
-    "@apollo/subgraph": "2.0.5",
-    "@nestjs/apollo": "10.0.17",
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
-    "@nestjs/graphql": "10.0.18",
-    "@nestjs/platform-express": "9.0.1",
-    "apollo-server-express": "3.9.0",
-    "graphql": "16.5.0",
-    "graphql-tools": "8.3.0",
+    "@apollo/gateway": "2.4.0",
+    "@apollo/server": "4.5.0",
+    "@apollo/subgraph": "2.4.0",
+    "@nestjs/apollo": "11.0.4",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/graphql": "11.0.0",
+    "@nestjs/platform-express": "9.3.12",
+    "graphql": "16.6.0",
+    "graphql-tools": "8.3.19",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.5.5",
-    "ts-morph": "15.1.0"
+    "rimraf": "4.4.1",
+    "rxjs": "7.8.0",
+    "ts-morph": "17.0.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
-    "@nestjs/testing": "9.0.1",
-    "@types/express": "4.17.13",
-    "@types/jest": "28.1.4",
-    "@types/node": "18.0.3",
+    "@nestjs/cli": "9.2.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
+    "@types/express": "4.17.17",
+    "@types/jest": "29.4.0",
+    "@types/node": "18.15.0",
     "@types/supertest": "2.0.12",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
-    "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.35.0",
+    "eslint-config-prettier": "8.8.0",
     "eslint-plugin-prettier": "4.2.1",
-    "jest": "28.1.2",
-    "prettier": "2.7.1",
-    "supertest": "6.2.4",
-    "ts-jest": "28.0.5",
-    "ts-loader": "9.3.1",
-    "ts-node": "10.8.2",
-    "tsconfig-paths": "4.0.0",
-    "typescript": "4.7.4"
+    "jest": "29.5.0",
+    "prettier": "2.8.4",
+    "supertest": "6.3.3",
+    "ts-jest": "29.0.5",
+    "ts-loader": "9.4.2",
+    "ts-node": "10.9.1",
+    "tsconfig-paths": "4.1.2",
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/31-graphql-federation-code-first/posts-application/tsconfig.json b/sample/31-graphql-federation-code-first/posts-application/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/31-graphql-federation-code-first/posts-application/tsconfig.json
+++ b/sample/31-graphql-federation-code-first/posts-application/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/31-graphql-federation-code-first/users-application/package-lock.json b/sample/31-graphql-federation-code-first/users-application/package-lock.json
index 2b31ae855..0af9f34e7 100644
Binary files a/sample/31-graphql-federation-code-first/users-application/package-lock.json and b/sample/31-graphql-federation-code-first/users-application/package-lock.json differ
diff --git a/sample/31-graphql-federation-code-first/users-application/package.json b/sample/31-graphql-federation-code-first/users-application/package.json
index 922a4a5cd..87bfa1797 100644
--- a/sample/31-graphql-federation-code-first/users-application/package.json
+++ b/sample/31-graphql-federation-code-first/users-application/package.json
@@ -20,43 +20,42 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@apollo/federation": "0.36.1",
-    "@apollo/gateway": "2.0.5",
-    "@apollo/subgraph": "2.0.5",
-    "@nestjs/apollo": "10.0.17",
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
-    "@nestjs/graphql": "10.0.19",
-    "@nestjs/platform-express": "9.0.1",
-    "apollo-server-express": "3.9.0",
-    "graphql": "16.5.0",
-    "graphql-tools": "8.3.0",
+    "@apollo/gateway": "2.4.0",
+    "@apollo/server": "4.5.0",
+    "@apollo/subgraph": "2.4.0",
+    "@nestjs/apollo": "11.0.4",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/graphql": "11.0.0",
+    "@nestjs/platform-express": "9.3.12",
+    "graphql": "16.6.0",
+    "graphql-tools": "8.3.19",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.5.5",
-    "ts-morph": "15.1.0"
+    "rimraf": "4.4.1",
+    "rxjs": "7.8.0",
+    "ts-morph": "17.0.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
-    "@nestjs/testing": "9.0.1",
-    "@types/express": "4.17.13",
-    "@types/jest": "28.1.4",
-    "@types/node": "18.0.3",
+    "@nestjs/cli": "9.2.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
+    "@types/express": "4.17.17",
+    "@types/jest": "29.4.0",
+    "@types/node": "18.15.0",
     "@types/supertest": "2.0.12",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
-    "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.35.0",
+    "eslint-config-prettier": "8.8.0",
     "eslint-plugin-prettier": "4.2.1",
-    "jest": "28.1.2",
-    "prettier": "2.7.1",
-    "supertest": "6.2.4",
-    "ts-jest": "28.0.5",
-    "ts-loader": "9.3.1",
-    "ts-node": "10.8.2",
-    "tsconfig-paths": "4.0.0",
-    "typescript": "4.7.4"
+    "jest": "29.5.0",
+    "prettier": "2.8.4",
+    "supertest": "6.3.3",
+    "ts-jest": "29.0.5",
+    "ts-loader": "9.4.2",
+    "ts-node": "10.9.1",
+    "tsconfig-paths": "4.1.2",
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/31-graphql-federation-code-first/users-application/tsconfig.json b/sample/31-graphql-federation-code-first/users-application/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/31-graphql-federation-code-first/users-application/tsconfig.json
+++ b/sample/31-graphql-federation-code-first/users-application/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/32-graphql-federation-schema-first/README.md b/sample/32-graphql-federation-schema-first/README.md
index 1f3fd3dc1..7a0f47a9d 100644
--- a/sample/32-graphql-federation-schema-first/README.md
+++ b/sample/32-graphql-federation-schema-first/README.md
@@ -4,7 +4,7 @@ A simple example of GraphQL Federation using Schema First approach.
 
 ## Execution
 
-Make sure to start the two sub-graph applications first, then the gatway. Otherwise the gateway won't be able to fetch schemas from the sub-graphs.
+Make sure to start the two sub-graph applications first, then the gateway. Otherwise the gateway won't be able to fetch schemas from the sub-graphs.
 
 ```sh
 cd users-application && npm run start
diff --git a/sample/32-graphql-federation-schema-first/gateway/package-lock.json b/sample/32-graphql-federation-schema-first/gateway/package-lock.json
index 04e55ac61..9b0805d5d 100644
Binary files a/sample/32-graphql-federation-schema-first/gateway/package-lock.json and b/sample/32-graphql-federation-schema-first/gateway/package-lock.json differ
diff --git a/sample/32-graphql-federation-schema-first/gateway/package.json b/sample/32-graphql-federation-schema-first/gateway/package.json
index 781d850bd..ff3ff8bf0 100644
--- a/sample/32-graphql-federation-schema-first/gateway/package.json
+++ b/sample/32-graphql-federation-schema-first/gateway/package.json
@@ -21,41 +21,41 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@apollo/gateway": "2.0.5",
-    "@nestjs/apollo": "10.0.17",
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
-    "@nestjs/graphql": "10.0.18",
-    "@nestjs/platform-express": "9.0.1",
-    "apollo-server-express": "3.9.0",
-    "graphql": "16.5.0",
-    "graphql-tools": "8.3.0",
+    "@apollo/gateway": "2.4.0",
+    "@apollo/server": "^4.4.1",
+    "@nestjs/apollo": "11.0.4",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/graphql": "11.0.0",
+    "@nestjs/platform-express": "9.3.12",
+    "graphql": "16.6.0",
+    "graphql-tools": "8.3.19",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.5.5",
-    "ts-morph": "15.1.0"
+    "rimraf": "4.4.1",
+    "rxjs": "7.8.0",
+    "ts-morph": "17.0.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
-    "@nestjs/testing": "9.0.1",
-    "@types/express": "4.17.13",
-    "@types/jest": "28.1.4",
-    "@types/node": "18.0.3",
+    "@nestjs/cli": "9.2.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
+    "@types/express": "4.17.17",
+    "@types/jest": "29.4.0",
+    "@types/node": "18.15.0",
     "@types/supertest": "2.0.12",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
-    "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.35.0",
+    "eslint-config-prettier": "8.8.0",
     "eslint-plugin-prettier": "4.2.1",
-    "jest": "28.1.2",
-    "prettier": "2.7.1",
-    "supertest": "6.2.4",
-    "ts-jest": "28.0.5",
-    "ts-loader": "9.3.1",
-    "ts-node": "10.8.2",
-    "tsconfig-paths": "4.0.0",
-    "typescript": "4.7.4"
+    "jest": "29.5.0",
+    "prettier": "2.8.4",
+    "supertest": "6.3.3",
+    "ts-jest": "29.0.5",
+    "ts-loader": "9.4.2",
+    "ts-node": "10.9.1",
+    "tsconfig-paths": "4.1.2",
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/32-graphql-federation-schema-first/gateway/tsconfig.json b/sample/32-graphql-federation-schema-first/gateway/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/32-graphql-federation-schema-first/gateway/tsconfig.json
+++ b/sample/32-graphql-federation-schema-first/gateway/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/32-graphql-federation-schema-first/posts-application/package-lock.json b/sample/32-graphql-federation-schema-first/posts-application/package-lock.json
index 5f4c2ce91..2eefbed12 100644
Binary files a/sample/32-graphql-federation-schema-first/posts-application/package-lock.json and b/sample/32-graphql-federation-schema-first/posts-application/package-lock.json differ
diff --git a/sample/32-graphql-federation-schema-first/posts-application/package.json b/sample/32-graphql-federation-schema-first/posts-application/package.json
index 67cb5f415..2f071dace 100644
--- a/sample/32-graphql-federation-schema-first/posts-application/package.json
+++ b/sample/32-graphql-federation-schema-first/posts-application/package.json
@@ -21,43 +21,42 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@apollo/federation": "0.36.1",
-    "@apollo/gateway": "2.0.5",
-    "@apollo/subgraph": "2.0.5",
-    "@nestjs/apollo": "10.0.17",
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
-    "@nestjs/graphql": "10.0.18",
-    "@nestjs/platform-express": "9.0.1",
-    "apollo-server-express": "3.9.0",
-    "graphql": "16.5.0",
-    "graphql-tools": "8.3.0",
+    "@apollo/gateway": "2.4.0",
+    "@apollo/server": "^4.4.1",
+    "@apollo/subgraph": "2.4.0",
+    "@nestjs/apollo": "11.0.4",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/graphql": "11.0.0",
+    "@nestjs/platform-express": "9.3.12",
+    "graphql": "16.6.0",
+    "graphql-tools": "8.3.19",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.5.5",
-    "ts-morph": "15.1.0"
+    "rimraf": "4.4.1",
+    "rxjs": "7.8.0",
+    "ts-morph": "17.0.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
-    "@nestjs/testing": "9.0.1",
-    "@types/express": "4.17.13",
-    "@types/jest": "28.1.4",
-    "@types/node": "18.0.3",
+    "@nestjs/cli": "9.2.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
+    "@types/express": "4.17.17",
+    "@types/jest": "29.4.0",
+    "@types/node": "18.15.0",
     "@types/supertest": "2.0.12",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
-    "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.35.0",
+    "eslint-config-prettier": "8.8.0",
     "eslint-plugin-prettier": "4.2.1",
-    "jest": "28.1.2",
-    "prettier": "2.7.1",
-    "supertest": "6.2.4",
-    "ts-jest": "28.0.5",
-    "ts-loader": "9.3.1",
-    "ts-node": "10.8.2",
-    "tsconfig-paths": "4.0.0",
-    "typescript": "4.7.4"
+    "jest": "29.5.0",
+    "prettier": "2.8.4",
+    "supertest": "6.3.3",
+    "ts-jest": "29.0.5",
+    "ts-loader": "9.4.2",
+    "ts-node": "10.9.1",
+    "tsconfig-paths": "4.1.2",
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/32-graphql-federation-schema-first/posts-application/tsconfig.json b/sample/32-graphql-federation-schema-first/posts-application/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/32-graphql-federation-schema-first/posts-application/tsconfig.json
+++ b/sample/32-graphql-federation-schema-first/posts-application/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/32-graphql-federation-schema-first/users-application/package-lock.json b/sample/32-graphql-federation-schema-first/users-application/package-lock.json
index e88571d7f..4f6f15d4c 100644
Binary files a/sample/32-graphql-federation-schema-first/users-application/package-lock.json and b/sample/32-graphql-federation-schema-first/users-application/package-lock.json differ
diff --git a/sample/32-graphql-federation-schema-first/users-application/package.json b/sample/32-graphql-federation-schema-first/users-application/package.json
index 9628d9320..0c016b1b6 100644
--- a/sample/32-graphql-federation-schema-first/users-application/package.json
+++ b/sample/32-graphql-federation-schema-first/users-application/package.json
@@ -20,43 +20,42 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@apollo/federation": "0.36.1",
-    "@apollo/gateway": "2.0.5",
-    "@apollo/subgraph": "2.0.5",
-    "@nestjs/apollo": "10.0.17",
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
-    "@nestjs/graphql": "10.0.18",
-    "@nestjs/platform-express": "9.0.1",
-    "apollo-server-express": "3.9.0",
-    "graphql": "15.8.0",
-    "graphql-tools": "8.3.0",
+    "@apollo/gateway": "2.4.0",
+    "@apollo/server": "^4.4.1",
+    "@apollo/subgraph": "2.4.0",
+    "@nestjs/apollo": "11.0.4",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/graphql": "11.0.0",
+    "@nestjs/platform-express": "9.3.12",
+    "graphql": "16.6.0",
+    "graphql-tools": "8.3.19",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.5.5",
-    "ts-morph": "15.1.0"
+    "rimraf": "4.4.1",
+    "rxjs": "7.8.0",
+    "ts-morph": "17.0.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
-    "@nestjs/testing": "9.0.1",
-    "@types/express": "4.17.13",
-    "@types/jest": "28.1.4",
-    "@types/node": "18.0.3",
+    "@nestjs/cli": "9.2.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
+    "@types/express": "4.17.17",
+    "@types/jest": "29.4.0",
+    "@types/node": "18.15.0",
     "@types/supertest": "2.0.12",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
-    "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.35.0",
+    "eslint-config-prettier": "8.8.0",
     "eslint-plugin-prettier": "4.2.1",
-    "jest": "28.1.2",
-    "prettier": "2.7.1",
-    "supertest": "6.2.4",
-    "ts-jest": "28.0.5",
-    "ts-loader": "9.3.1",
-    "ts-node": "10.8.2",
-    "tsconfig-paths": "4.0.0",
-    "typescript": "4.7.4"
+    "jest": "29.5.0",
+    "prettier": "2.8.4",
+    "supertest": "6.3.3",
+    "ts-jest": "29.0.5",
+    "ts-loader": "9.4.2",
+    "ts-node": "10.9.1",
+    "tsconfig-paths": "4.1.2",
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/32-graphql-federation-schema-first/users-application/tsconfig.json b/sample/32-graphql-federation-schema-first/users-application/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/32-graphql-federation-schema-first/users-application/tsconfig.json
+++ b/sample/32-graphql-federation-schema-first/users-application/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/33-graphql-mercurius/package-lock.json b/sample/33-graphql-mercurius/package-lock.json
index e428d5cf6..c0711430a 100644
Binary files a/sample/33-graphql-mercurius/package-lock.json and b/sample/33-graphql-mercurius/package-lock.json differ
diff --git a/sample/33-graphql-mercurius/package.json b/sample/33-graphql-mercurius/package.json
index 14aad90bf..b05ea311d 100644
--- a/sample/33-graphql-mercurius/package.json
+++ b/sample/33-graphql-mercurius/package.json
@@ -19,37 +19,37 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "9.0.1",
-    "@nestjs/core": "9.0.1",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
     "@nestjs/graphql": "10.0.18",
     "@nestjs/mercurius": "10.0.17",
-    "@nestjs/platform-fastify": "9.0.1",
+    "@nestjs/platform-fastify": "9.3.12",
     "class-transformer": "0.5.1",
-    "class-validator": "0.13.2",
+    "class-validator": "0.14.0",
     "graphql": "16.5.0",
-    "mercurius": "10.1.0",
+    "mercurius": "12.2.0",
     "reflect-metadata": "0.1.13",
     "rxjs": "7.5.5"
   },
   "devDependencies": {
     "@nestjs/cli": "9.0.0",
-    "@nestjs/schematics": "9.0.1",
-    "@nestjs/testing": "9.0.1",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
     "@types/node": "18.0.3",
     "@types/supertest": "2.0.12",
     "jest": "28.1.2",
     "prettier": "2.7.1",
     "supertest": "6.2.4",
-    "ts-jest": "28.0.5",
+    "ts-jest": "28.0.8",
     "ts-loader": "9.3.1",
     "ts-node": "10.8.2",
     "tsconfig-paths": "4.0.0",
-    "@typescript-eslint/eslint-plugin": "5.30.5",
-    "@typescript-eslint/parser": "5.30.5",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
     "eslint": "8.19.0",
-    "eslint-config-prettier": "8.5.0",
+    "eslint-config-prettier": "8.8.0",
     "eslint-plugin-import": "2.26.0",
-    "typescript": "4.7.4"
+    "typescript": "4.9.5"
   }
 }
diff --git a/sample/33-graphql-mercurius/tsconfig.json b/sample/33-graphql-mercurius/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/33-graphql-mercurius/tsconfig.json
+++ b/sample/33-graphql-mercurius/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/tools/gulp/gulpfile.ts b/tools/gulp/gulpfile.ts
index de25610c2..1e6200761 100644
--- a/tools/gulp/gulpfile.ts
+++ b/tools/gulp/gulpfile.ts
@@ -1,5 +1,4 @@
-import './tasks/copy-misc';
 import './tasks/clean';
-import './tasks/packages';
+import './tasks/copy-misc';
 import './tasks/move';
 import './tasks/samples';
diff --git a/tools/gulp/tasks/move.ts b/tools/gulp/tasks/move.ts
index d01a29d59..0991e1e6f 100644
--- a/tools/gulp/tasks/move.ts
+++ b/tools/gulp/tasks/move.ts
@@ -3,12 +3,24 @@ import { join } from 'path';
 import { samplePath } from '../config';
 import { containsPackageJson, getDirs } from '../util/task-helpers';
 
+const distFiles = src([
+  'packages/**/*',
+  '!packages/**/*.ts',
+  'packages/**/*.d.ts',
+]);
+
+/**
+ * Moves the compiled nest files into "node_module" folder.
+ */
+function moveToNodeModules() {
+  return distFiles.pipe(dest('node_modules/@nestjs'));
+}
+
 /**
  * Moves the compiled nest files into the `samples/*` dirs.
  */
-function move() {
+function moveToSamples() {
   const samplesDirs = getDirs(samplePath);
-  const distFiles = src(['node_modules/@nestjs/**/*']);
 
   /**
    * Flatten the sampleDirs
@@ -31,4 +43,5 @@ function move() {
   );
 }
 
-task('move', move);
+task('move:node_modules', moveToNodeModules);
+task('move:samples', moveToSamples);
diff --git a/tools/gulp/tasks/packages.ts b/tools/gulp/tasks/packages.ts
deleted file mode 100644
index 28682443f..000000000
--- a/tools/gulp/tasks/packages.ts
+++ /dev/null
@@ -1,78 +0,0 @@
-import { source } from '../config';
-import { task, watch, series, dest } from 'gulp';
-import { createProject } from 'gulp-typescript';
-import * as sourcemaps from 'gulp-sourcemaps';
-import * as log from 'fancy-log';
-
-// Has to be a hardcoded object due to build order
-const packages = {
-  common: createProject('packages/common/tsconfig.json'),
-  core: createProject('packages/core/tsconfig.json'),
-  microservices: createProject('packages/microservices/tsconfig.json'),
-  websockets: createProject('packages/websockets/tsconfig.json'),
-  testing: createProject('packages/testing/tsconfig.json'),
-  'platform-express': createProject('packages/platform-express/tsconfig.json'),
-  'platform-fastify': createProject('packages/platform-fastify/tsconfig.json'),
-  'platform-socket.io': createProject(
-    'packages/platform-socket.io/tsconfig.json',
-  ),
-  'platform-ws': createProject('packages/platform-ws/tsconfig.json'),
-};
-
-const modules = Object.keys(packages);
-
-const distId = process.argv.indexOf('--dist');
-const dist = distId < 0 ? source : process.argv[distId + 1];
-
-/**
- * Watches the packages/* folder and
- * builds the package on file change
- */
-function defaultTask() {
-  log.info('Watching files..');
-  modules.forEach(packageName => {
-    watch(
-      [`${source}/${packageName}/**/*.ts`, `${source}/${packageName}/*.ts`],
-      series(packageName),
-    );
-  });
-}
-
-/**
- * Builds the given package
- * @param packageName The name of the package
- */
-function buildPackage(packageName: string) {
-  return packages[packageName]
-    .src()
-    .pipe(packages[packageName]())
-    .pipe(dest(`${dist}/${packageName}`));
-}
-
-/**
- * Builds the given package and adds sourcemaps
- * @param packageName The name of the package
- */
-function buildPackageDev(packageName: string) {
-  return packages[packageName]
-    .src()
-    .pipe(sourcemaps.init())
-    .pipe(packages[packageName]())
-    .pipe(
-      sourcemaps.mapSources(
-        (sourcePath: string) => './' + sourcePath.split('/').pop(),
-      ),
-    )
-    .pipe(sourcemaps.write('.', {}))
-    .pipe(dest(`${dist}/${packageName}`));
-}
-
-modules.forEach(packageName => {
-  task(packageName, () => buildPackage(packageName));
-  task(`${packageName}:dev`, () => buildPackageDev(packageName));
-});
-
-task('common:dev', series(modules.map(packageName => `${packageName}:dev`)));
-task('build', series(modules));
-task('build:dev', series('common:dev'));
-task('default', defaultTask);
diff --git a/tools/gulp/tsconfig.json b/tools/gulp/tsconfig.json
index 6438b3c5a..043217830 100644
--- a/tools/gulp/tsconfig.json
+++ b/tools/gulp/tsconfig.json
@@ -3,7 +3,6 @@
     "experimentalDecorators": true,
     "noUnusedParameters": false,
     "noUnusedLocals": false,
-    "lib": ["es2015", "dom", "es2016.array.include"],
     "module": "commonjs",
     "moduleResolution": "node",
     "outDir": "../../dist/tools/gulp",
@@ -12,7 +11,7 @@
     "noImplicitThis": true,
     "noEmitOnError": true,
     "noImplicitAny": false,
-    "target": "es5",
+    "target": "ES2021",
     "types": [
       "node"
     ],
diff --git a/tools/gulp/util/task-helpers.ts b/tools/gulp/util/task-helpers.ts
index 736a1087c..9e9e65e3c 100644
--- a/tools/gulp/util/task-helpers.ts
+++ b/tools/gulp/util/task-helpers.ts
@@ -15,7 +15,7 @@ export function getDirs(base: string) {
 
 /**
  * Checks if the directory contains a package.json file
- * @param dir Path to the dircetory
+ * @param dir Path to the directory
  * @returns True if the directory contains a package.json
  */
 export function containsPackageJson(dir: string) {
diff --git a/tsconfig.json b/tsconfig.json
index 5712f3c0c..89fc99832 100644
--- a/tsconfig.json
+++ b/tsconfig.json
@@ -1,7 +1,6 @@
 {
   "compilerOptions": {
     "module": "commonjs",
-    "declaration": false,
     "noImplicitAny": false,
     "noUnusedLocals": false,
     "removeComments": true,
@@ -9,11 +8,11 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "useUnknownInCatchVariables": false,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
-    "allowJs": true,
+    "allowJs": false,
     "outDir": "dist",
-    "lib": ["es7"],
+    "baseUrl": ".",
     "paths": {
       "@nestjs/common": ["./packages/common"],
       "@nestjs/common/*": ["./packages/common/*"],
@@ -31,7 +30,7 @@
       "@nestjs/platform-ws/*": ["./packages/platform-ws/*"],
       "@nestjs/platform-fastify": ["./packages/platform-fastify"],
       "@nestjs/platform-fastify/*": ["./packages/platform-fastify/*"],
-      "@nestjs/platform-socket.io": ["./packages/platform-ws"],
+      "@nestjs/platform-socket.io": ["./packages/platform-socket.io"],
       "@nestjs/platform-socket.io/*": ["./packages/platform-socket.io/*"],
     }
   },
diff --git a/tsconfig.spec.json b/tsconfig.spec.json
index 60e239b85..95af08508 100644
--- a/tsconfig.spec.json
+++ b/tsconfig.spec.json
@@ -2,4 +2,4 @@
   "extends": "./tsconfig.json",
   "include": ["integration/**/*", "**/*.spec.ts"],
   "exclude": ["node_modules", "dist"]
-}
+}
\ No newline at end of file
