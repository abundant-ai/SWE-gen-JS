diff --git a/.circleci/config.yml b/.circleci/config.yml
index 8fa94ead5..e4abf77ba 100644
--- a/.circleci/config.yml
+++ b/.circleci/config.yml
@@ -3,19 +3,19 @@ version: 2
 aliases:
   - &restore-cache
     restore_cache:
-        key: dependency-cache-{{ checksum "package.json" }}
+      key: dependency-cache-{{ checksum "package.json" }}
   - &install-deps
     run:
-        name: Install dependencies
-        command: npm ci
+      name: Install dependencies
+      command: npm ci
   - &build-packages
     run:
-        name: Build
-        command: npm run build
+      name: Build
+      command: npm run build
   - &run-unit-tests
     run:
-        name: Test
-        command: npm run test
+      name: Test
+      command: npm run test
 
 unit-tests-template: &unit-tests-template
   working_directory: ~/nest
@@ -30,12 +30,12 @@ jobs:
   build:
     working_directory: ~/nest
     docker:
-      - image: circleci/node:12
+      - image: cimg/node:16.19
     steps:
       - checkout
       - run:
           name: Update NPM version
-          command: 'sudo npm install -g npm@latest'
+          command: 'sudo npm install -g npm@^8'
       - restore_cache:
           key: dependency-cache-{{ checksum "package.json" }}
       - run:
@@ -48,42 +48,39 @@ jobs:
       - run:
           name: Build
           command: npm run build
-        
-  test_node_12:
+
+  test_node_16:
     working_directory: ~/nest
     docker:
-      - image: circleci/node:12
+      - image: cimg/node:16.19
     steps:
       - checkout
       - *restore-cache
       - *install-deps
       - *build-packages
-      - *run-unit-tests
+      - run:
+          name: Test (coverage)
+          command: npm run test:cov
       - run:
           name: Collect coverage
           command: npm run coverage
       - store_artifacts:
           path: coverage
 
-  test_node_10:
+  test_node_18:
     <<: *unit-tests-template
     docker:
-      - image: circleci/node:10
+      - image: cimg/node:18.14
 
-  test_node_14:
+  test_node_19:
     <<: *unit-tests-template
     docker:
-      - image: circleci/node:14
-    
-  test_node_16:
-    <<: *unit-tests-template
-    docker:
-      - image: circleci/node:16
+      - image: cimg/node:19.8
 
   lint:
     working_directory: ~/nest
     docker:
-      - image: circleci/node:12
+      - image: circleci/node:16
     steps:
       - checkout
       - *restore-cache
@@ -100,17 +97,17 @@ jobs:
     machine: true
     steps:
       - checkout
-      - run: 
+      - run:
           name: Prepare nvm
           command: |
             echo 'export NVM_DIR="/opt/circleci/.nvm"' >> $BASH_ENV
             echo ' [ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"' >> $BASH_ENV
-      - run: 
+      - run:
           name: Upgrade Node.js
           command: |
-            nvm install v12
+            nvm install v16
             node -v
-            nvm alias default v12
+            nvm alias default v16
       - run:
           name: Install Docker Compose
           command: |
@@ -129,11 +126,11 @@ jobs:
       - run:
           name: Integration tests
           command: npm run test:integration
-          
+
   codechecks_benchmarks:
     working_directory: ~/nest
     docker:
-      - image: circleci/node:12
+      - image: cimg/node:16.19
     steps:
       - checkout
       - *restore-cache
@@ -149,7 +146,7 @@ jobs:
   samples:
     working_directory: ~/nest
     docker:
-      - image: circleci/node:12
+      - image: cimg/node:16.19
     environment:
       - DISABLE_OPENCOLLECTIVE: true
     steps:
@@ -168,13 +165,10 @@ workflows:
       - test_node_16:
           requires:
             - build
-      - test_node_14:
-          requires:
-            - build
-      - test_node_12:
+      - test_node_18:
           requires:
             - build
-      - test_node_10:
+      - test_node_19:
           requires:
             - build
       - lint:
diff --git a/.commitlintrc.json b/.commitlintrc.json
index 5c5e64d4b..d541ae390 100644
--- a/.commitlintrc.json
+++ b/.commitlintrc.json
@@ -23,6 +23,22 @@
         "test",
         "sample"
       ]
+    ],
+    "scope-enum": [
+      1,
+      "always",
+      [
+        "common",
+        "core",
+        "sample",
+        "microservices",
+        "express",
+        "fastify",
+        "socket.io",
+        "ws",
+        "testing",
+        "websockets"
+      ]
     ]
   }
 }
diff --git a/.eslintignore b/.eslintignore
index 4197b94e5..07c71c90c 100644
--- a/.eslintignore
+++ b/.eslintignore
@@ -1 +1,3 @@
-**/node_modules/**
\ No newline at end of file
+**/node_modules/**
+*.d.ts
+*.js
\ No newline at end of file
diff --git a/.eslintrc.js b/.eslintrc.js
index 280fe9a37..5280ee09d 100644
--- a/.eslintrc.js
+++ b/.eslintrc.js
@@ -1,25 +1,46 @@
 module.exports = {
-  parser: '@typescript-eslint/parser',
-  parserOptions: {
-    project: 'tsconfig.json',
-    sourceType: 'module',
+  root: true,
+  env: {
+    node: true,
   },
   plugins: ['@typescript-eslint/eslint-plugin'],
   extends: [
-    'plugin:@typescript-eslint/eslint-recommended',
     'plugin:@typescript-eslint/recommended',
     'prettier',
   ],
-  root: true,
-  env: {
-    node: true,
-  },
-  rules: {
-    '@typescript-eslint/interface-name-prefix': 'off',
-    '@typescript-eslint/explicit-function-return-type': 'off',
-    '@typescript-eslint/no-explicit-any': 'off',
-    '@typescript-eslint/explicit-module-boundary-types': 'off',
-    '@typescript-eslint/no-unused-vars': 'off',
-    '@typescript-eslint/ban-types': 'off',
-  },
+  overrides: [
+    {
+      files: ['**/*.ts'],
+      parser: '@typescript-eslint/parser',
+      parserOptions: {
+        project: 'tsconfig.json',
+        sourceType: 'module',
+      },
+      rules: {
+        '@typescript-eslint/interface-name-prefix': 'off',
+        '@typescript-eslint/explicit-function-return-type': 'off',
+        '@typescript-eslint/no-explicit-any': 'off',
+        '@typescript-eslint/explicit-module-boundary-types': 'off',
+        '@typescript-eslint/no-unused-vars': 'off',
+        '@typescript-eslint/ban-types': 'off',
+      },
+    },
+    {
+      files: ['**/*.spec.ts', 'integration/**/*.ts'],
+      parser: '@typescript-eslint/parser',
+      parserOptions: {
+        project: 'tsconfig.spec.json',
+        sourceType: 'module',
+      },
+      rules: {
+        '@typescript-eslint/interface-name-prefix': 'off',
+        '@typescript-eslint/explicit-function-return-type': 'off',
+        '@typescript-eslint/no-explicit-any': 'off',
+        '@typescript-eslint/explicit-module-boundary-types': 'off',
+        '@typescript-eslint/no-unused-vars': 'off',
+        '@typescript-eslint/ban-types': 'off',
+        '@typescript-eslint/no-empty-function': 'off',
+      },
+    }
+  ]
 };
diff --git a/.eslintrc.spec.js b/.eslintrc.spec.js
deleted file mode 100644
index f7b2e8ed7..000000000
--- a/.eslintrc.spec.js
+++ /dev/null
@@ -1,13 +0,0 @@
-const baseConfig = require('./.eslintrc');
-
-module.exports = {
-  ...baseConfig,
-  parserOptions: {
-    project: 'tsconfig.spec.json',
-    sourceType: 'module',
-  },
-  rules: {
-    ...baseConfig.rules,
-    '@typescript-eslint/no-empty-function': 'off',
-  },
-};
diff --git a/.github/ISSUE_TEMPLATE/Bug_report.yml b/.github/ISSUE_TEMPLATE/Bug_report.yml
index 56ff8ecf7..6ed7830d8 100644
--- a/.github/ISSUE_TEMPLATE/Bug_report.yml
+++ b/.github/ISSUE_TEMPLATE/Bug_report.yml
@@ -9,6 +9,7 @@ body:
  
         If you are not sure that your issue is a bug, you could:
 
+        - read the [FAQ's common errors](https://docs.nestjs.com/faq/common-errors) page
         - use our [Discord community](https://discord.gg/NestJS)
         - use [StackOverflow using the tag `nestjs`](https://stackoverflow.com/questions/tagged/nestjs)
         - If it's just a quick question you can ping [our Twitter](https://twitter.com/nestframework)
@@ -20,7 +21,7 @@ body:
   - type: checkboxes
     attributes:
       label: "Is there an existing issue for this?"
-      description: "Please search [here](https://github.com/nestjs/nest/issues?q=is%3Aissue) to see if an issue already exists for the bug you encountered"
+      description: "Please search [here](../issues?q=is%3Aissue) to see if an issue already exists for the bug you encountered"
       options:
       - label: "I have searched the existing issues"
         required: true
@@ -37,7 +38,7 @@ body:
       required: true
     attributes:
       label: "Minimum reproduction code"
-      description: "An URL to some git repository that reproduces this issue. [Wtf is a minimum reproduction?](https://jmcdo29.github.io/wtf-is-a-minimum-reproduction)"
+      description: "An URL to some Git repository/[StackBlitz](https://stackblitz.com/fork/github/nestjs/typescript-starter)/[CodeSandbox](https://codesandbox.io/s/github/nestjs/typescript-starter/tree/master) project that reproduces your issue. [Wtf is a minimum reproduction?](https://jmcdo29.github.io/wtf-is-a-minimum-reproduction)"
       placeholder: "https://github.com/..."
 
   - type: textarea
@@ -47,7 +48,7 @@ body:
         How the issue manifests?
         You could leave this blank if you alread write this in your reproduction code
       placeholder: |
-        1. `npm i`
+        1. `npm ci`
         2. `npm start:dev`
         3. See error...
 
@@ -56,7 +57,7 @@ body:
       required: true
     attributes:
       label: "Expected behavior"
-      description: "A clear and concise description of what you expected to happend (or code)"
+      description: "A clear and concise description of what you expected to happened (or code)"
 
   - type: markdown
     attributes:
@@ -104,10 +105,13 @@ body:
       required: true
     attributes:
       label: "Packages versions"
-      description: "You could leave your whole `package.json` dependencies list here, or just indicates which version of `@nestjs/*` are you using"
-      placeholder: |
-        - `@nestjs/common`: 8.1.3
-        - `@nestjs/platform-express`: 8.1.3
+      description: |
+        You could leave your whole `package.json` dependencies list here, or just indicate which version of `@nestjs/*` you are using
+        **Tip**: run _npx nest info_
+      value: |
+        ```json
+
+        ```
 
   - type: input
     attributes:
diff --git a/.github/ISSUE_TEMPLATE/Feature_request.yml b/.github/ISSUE_TEMPLATE/Feature_request.yml
index d2d432009..4bd28c420 100644
--- a/.github/ISSUE_TEMPLATE/Feature_request.yml
+++ b/.github/ISSUE_TEMPLATE/Feature_request.yml
@@ -9,6 +9,7 @@ body:
  
         If you are not sure that your issue is a bug, you could:
 
+        - read the [FAQ's common errors](https://docs.nestjs.com/faq/common-errors) page
         - use our [Discord community](https://discord.gg/NestJS)
         - use [StackOverflow using the tag `nestjs`](https://stackoverflow.com/questions/tagged/nestjs)
         - If it's just a quick question you can ping [our Twitter](https://twitter.com/nestframework)
@@ -18,7 +19,7 @@ body:
   - type: checkboxes
     attributes:
       label: "Is there an existing issue that is already proposing this?"
-      description: "Please search [here](https://github.com/nestjs/nest/issues?q=is%3Aissue) to see if an issue already exists for the feature you are requesting"
+      description: "Please search [here](../issues?q=is%3Aissue) to see if an issue already exists for the feature you are requesting"
       options:
       - label: "I have searched the existing issues"
         required: true
diff --git a/.github/ISSUE_TEMPLATE/Regression.yml b/.github/ISSUE_TEMPLATE/Regression.yml
index 85df74216..3da97a602 100644
--- a/.github/ISSUE_TEMPLATE/Regression.yml
+++ b/.github/ISSUE_TEMPLATE/Regression.yml
@@ -9,6 +9,7 @@ body:
  
         If you are not sure that your issue is a bug, you could:
 
+        - read the [FAQ's common errors](https://docs.nestjs.com/faq/common-errors) page
         - use our [Discord community](https://discord.gg/NestJS)
         - use [StackOverflow using the tag `nestjs`](https://stackoverflow.com/questions/tagged/nestjs)
         - If it's just a quick question you can ping [our Twitter](https://twitter.com/nestframework)
@@ -28,7 +29,7 @@ body:
   - type: checkboxes
     attributes:
       label: "Is there an existing issue that is already proposing this?"
-      description: "Please search [here](https://github.com/nestjs/nest/issues?q=is%3Aissue) to see if an issue already exists for the feature you are requesting"
+      description: "Please search [here](../issues?q=is%3Aissue) to see if an issue already exists for the feature you are requesting"
       options:
       - label: "I have searched the existing issues"
         required: true
@@ -73,7 +74,7 @@ body:
       required: true
     attributes:
       label: "Expected behavior"
-      description: "A clear and concise description of what you expected to happend (or code)"
+      description: "A clear and concise description of what you expected to happened (or code)"
 
   - type: textarea
     attributes:
diff --git a/.github/ISSUE_TEMPLATE/Suggestion_improve_performance.yml b/.github/ISSUE_TEMPLATE/Suggestion_improve_performance.yml
index 9af904576..90652b6ef 100644
--- a/.github/ISSUE_TEMPLATE/Suggestion_improve_performance.yml
+++ b/.github/ISSUE_TEMPLATE/Suggestion_improve_performance.yml
@@ -6,7 +6,7 @@ body:
   - type: checkboxes
     attributes:
       label: "Is there an existing issue that is already proposing this?"
-      description: "Please search [here](https://github.com/nestjs/nest/issues?q=is%3Aissue) to see if an issue already exists for this"
+      description: "Please search [here](../issues?q=is%3Aissue) to see if an issue already exists for this"
       options:
       - label: "I have searched the existing issues"
         required: true
@@ -34,7 +34,7 @@ body:
 
   - type: textarea
     validations:
-      required: true
+     required: true
     attributes:
       label: "Benchmarks result or another proof (eg: POC)"
       description: |
diff --git a/.github/ISSUE_TEMPLATE/config.yml b/.github/ISSUE_TEMPLATE/config.yml
index b080c8139..0bf87e036 100644
--- a/.github/ISSUE_TEMPLATE/config.yml
+++ b/.github/ISSUE_TEMPLATE/config.yml
@@ -2,6 +2,9 @@
 blank_issues_enabled: false
 
 contact_links:
+  - name: "\u2049 FAQ"
+    url: "https://docs.nestjs.com/faq"
+    about: "Make sure you have read the Frequently Asked Questions page."
   - name: "\u2753 Discord Community of NestJS"
     url: "https://discord.gg/NestJS"
     about: "Please ask support questions or discuss suggestions/enhancements here."
diff --git a/.github/dependabot.yml b/.github/dependabot.yml
index 4872c5afd..b31110af1 100644
--- a/.github/dependabot.yml
+++ b/.github/dependabot.yml
@@ -5,3 +5,8 @@ updates:
   schedule:
     interval: daily
   open-pull-requests-limit: 10
+- package-ecosystem: "github-actions"
+  directory: "/"
+  schedule:
+    interval: daily
+  open-pull-requests-limit: 10
diff --git a/.github/workflows/codeql-analysis.yml b/.github/workflows/codeql-analysis.yml
index d148be272..2c6f54c5a 100644
--- a/.github/workflows/codeql-analysis.yml
+++ b/.github/workflows/codeql-analysis.yml
@@ -9,14 +9,19 @@ on:
   schedule:
     - cron: '0 17 * * 4'
 
+permissions:
+  contents: read
+
 jobs:
   analyse:
+    permissions:
+      security-events: write
     name: Analyse
     runs-on: ubuntu-latest
 
     steps:
     - name: Checkout repository
-      uses: actions/checkout@v2
+      uses: actions/checkout@v3
       with:
         # We must fetch at least the immediate parents so that if this is
         # a pull request then we can checkout the head.
@@ -29,7 +34,9 @@ jobs:
 
     # Initializes the CodeQL tools for scanning.
     - name: Initialize CodeQL
-      uses: github/codeql-action/init@v1
+      uses: github/codeql-action/init@v2
+      with:
+        queries: +security-extended
       # Override language selection by uncommenting this and choosing your languages
       # with:
       #   languages: go, javascript, csharp, python, cpp, java
@@ -37,7 +44,7 @@ jobs:
     # Autobuild attempts to build any compiled languages  (C/C++, C#, or Java).
     # If this step fails, then you should remove it and run the build manually (see below)
     - name: Autobuild
-      uses: github/codeql-action/autobuild@v1
+      uses: github/codeql-action/autobuild@v2
 
     # ‚ÑπÔ∏è Command-line programs to run using the OS shell.
     # üìö https://git.io/JvXDl
@@ -51,4 +58,4 @@ jobs:
     #   make release
 
     - name: Perform CodeQL Analysis
-      uses: github/codeql-action/analyze@v1
+      uses: github/codeql-action/analyze@v2
diff --git a/.gitignore b/.gitignore
index e4ac8a641..68db39d62 100644
--- a/.gitignore
+++ b/.gitignore
@@ -5,8 +5,16 @@ node_modules/
 /.idea
 /.awcache
 /.vscode
+/.devcontainer
 *.code-workspace
 
+# Vim
+[._]*.s[a-v][a-z]
+[._]*.sw[a-p]
+[._]s[a-rt-v][a-z]
+[._]ss[a-gi-z]
+[._]sw[a-p]
+
 # bundle
 packages/**/*.d.ts
 packages/**/*.js
@@ -19,6 +27,7 @@ yarn-error.log
 /**/npm-debug.log
 /packages/**/.npmignore
 /packages/**/LICENSE
+*.tsbuildinfo
 
 # example
 /quick-start
@@ -33,3 +42,6 @@ yarn-error.log
 /packages/graphql
 /benchmarks/memory
 build/config\.gypi
+
+.npmrc
+pnpm-lock.yaml
\ No newline at end of file
diff --git a/.mocharc.js b/.mocharc.js
deleted file mode 100644
index b9cef9d6d..000000000
--- a/.mocharc.js
+++ /dev/null
@@ -1,7 +0,0 @@
-module.exports = {
-  mochaHooks: {
-    beforeAll: function() {
-      require('reflect-metadata');
-    }
-  }
-};
diff --git a/.npmignore b/.npmignore
index adb8e0dd6..d70d45ce9 100644
--- a/.npmignore
+++ b/.npmignore
@@ -10,4 +10,6 @@
 package-lock.json
 tslint.json
 tsconfig.json
-.prettierrc
\ No newline at end of file
+.prettierrc
+
+*.tsbuildinfo
\ No newline at end of file
diff --git a/.prettierignore b/.prettierignore
index 59fc75a6f..cb4f4fe93 100644
--- a/.prettierignore
+++ b/.prettierignore
@@ -1,2 +1,3 @@
 packages/**/*.d.ts
-packages/**/*.js
\ No newline at end of file
+packages/**/*.js
+.nyc_output
diff --git a/CONTRIBUTING.md b/CONTRIBUTING.md
index a00cda048..585848980 100755
--- a/CONTRIBUTING.md
+++ b/CONTRIBUTING.md
@@ -19,7 +19,7 @@ Help us keep Nest open and inclusive. Please read and follow our [Code of Conduc
 
 ## <a name="question"></a> Got a Question or Problem?
 
-**Do not open issues for general support questions as we want to keep GitHub issues for bug reports and feature requests.** You've got much better chances of getting your question answered on [Stack Overflow](https://stackoverflow.com/questions/tagged/nestjs) where the questions should be tagged with tag `nestjs`.
+**Do not open issues for general support questions as we want to keep GitHub issues for bug reports and feature requests.** You've got much better chances of getting your question answered on [Stack Overflow][stackoverflow] where the questions should be tagged with tag `nestjs`.
 
 Stack Overflow is a much better place to ask questions since:
 
@@ -71,7 +71,7 @@ A minimal reproduce scenario using a repository or Gist allows us to quickly con
 
 Unfortunately, we are not able to investigate / fix bugs without a minimal reproduction, so if we don't hear back from you we are going to close an issue that doesn't have enough info to be reproduced.
 
-You can file new issues by filling out our [new issue form](https://github.com/nestjs/nest/issues/new).
+You can file new issues by filling out our [new issue form][new_issue].
 
 ### <a name="submit-pr"></a> Submitting a Pull Request (PR)
 
@@ -84,9 +84,9 @@ To the first point
 We cannot accept code without this.
 -->
 
-1. Search [GitHub](https://github.com/nestjs/nest/pulls) for an open or closed PR
+1. Search [GitHub Pull Requests][gh_prs] for an open or closed PR
    that relates to your submission. You don't want to duplicate effort.
-1. Fork the nestjs/nest repo.
+1. Fork this repository.
 1. Make your changes in a new git branch:
 
    ```shell
@@ -159,12 +159,12 @@ from the main (upstream) repository:
 
 ## <a name="development"></a> Development Setup
 
-You will need Node.js version 8.9.0+.
+You will need [Node.js](https://nodejs.org) version >= 10.13.0 (except for v13).
 
 1. After cloning the repo, run:
 
 ```bash
-$ npm i # (or yarn install)
+$ npm ci # (or yarn install)
 ```
 
 2. In order to prepare your environment run `prepare.sh` shell script:
@@ -233,7 +233,7 @@ to read on GitHub as well as in various git tools.
 
 Footer should contain a [closing reference to an issue](https://help.github.com/articles/closing-issues-via-commit-messages/) if any.
 
-Samples: (even more [samples](https://github.com/nestjs/nest/commits/master))
+Samples: (even more [samples][commits_samples])
 
 ```
 docs(changelog): update change log to beta.5
@@ -262,16 +262,22 @@ Must be one of the following:
 
 ### Scope
 
-The scope should be the name of the npm package affected (as perceived by person reading changelog generated from commit messages.
+The scope should have the name of the npm package affected (as perceived by person reading changelog generated from commit messages).
 
 The following is the list of supported scopes:
 
-- **common**
-- **core**
-- **sample**
-- **microservices**
-- **testing**
-- **websockets**
+- **common**: for changes made on `packages/common` directory
+- **core**: for changes made on `packages/core` directory
+- **sample**: for changes made on `packages/sample` directory
+- **microservices**: for changes made on `packages/microservices` directory
+- **express**: for changes made on `packages/platform-express` directory
+- **fastify**: for changes made on `packages/platform-fastify` directory
+- **socket.io**: for changes made on `packages/platform-socket.io` directory
+- **ws**: for changes made on `packages/platform-ws` directory
+- **testing**: for changes made on `packages/testing` directory
+- **websockets**: for changes made on `packages/websockets` directory
+
+If your change affect more than one package, separate the scopes with a comma (e.g. `common,core`).
 
 There are currently a few exceptions to the "use package name" rule:
 
@@ -279,7 +285,6 @@ There are currently a few exceptions to the "use package name" rule:
 - **changelog**: used for updating the release notes in CHANGELOG.md
 - **sample/#**: for the example apps directory, replacing # with the example app number
 - none/empty string: useful for `style`, `test` and `refactor` changes that are done across all packages (e.g. `style: add missing semicolons`)
-  <!-- * **aio**: used for docs-app (angular.io) related changes within the /aio directory of the repo -->
 
 ### Subject
 
@@ -317,14 +322,13 @@ changes to be accepted, the CLA must be signed. It's a quick process, we promise
 <!-- [coc]: https://github.com/angular/code-of-conduct/blob/master/CODE_OF_CONDUCT.md -->
 
 [commit-message-format]: https://docs.google.com/document/d/1QrDFcIiPjSLDn3EL15IJygNPiHORgU1_OOAqWjiDU5Y/edit#
-[corporate-cla]: http://code.google.com/legal/corporate-cla-v1.0.html
+<!-- [individual-cla]: http://code.google.com/legal/individual-cla-v1.0.html -->
+<!-- [corporate-cla]: http://code.google.com/legal/corporate-cla-v1.0.html -->
 [dev-doc]: https://github.com/nestjs/nest/blob/master/docs/DEVELOPER.md
 [github]: https://github.com/nestjs/nest
+[stackoverflow]: https://stackoverflow.com/questions/tagged/nestjs
 [discord]: https://discordapp.com/invite/G7Qnnhy
-[individual-cla]: http://code.google.com/legal/individual-cla-v1.0.html
 [js-style-guide]: https://google.github.io/styleguide/jsguide.html
-[jsfiddle]: http://jsfiddle.net
-[plunker]: http://plnkr.co/edit
-[runnable]: http://runnable.com
-
-<!-- [stackoverflow]: http://stackoverflow.com/questions/tagged/angular -->
+[new_issue]: https://github.com/nestjs/nest/issues/new
+[gh_prs]: https://github.com/nestjs/nest/pulls
+[commits_samples]: https://github.com/nestjs/nest/commits/master
diff --git a/LICENSE b/LICENSE
index e0006437c..63c013f03 100644
--- a/LICENSE
+++ b/LICENSE
@@ -1,6 +1,6 @@
 (The MIT License)
 
-Copyright (c) 2017-2021 Kamil Mysliwiec <https://kamilmysliwiec.com>
+Copyright (c) 2017-2023 Kamil Mysliwiec <https://kamilmysliwiec.com>
 
 Permission is hereby granted, free of charge, to any person obtaining
 a copy of this software and associated documentation files (the
diff --git a/Readme.md b/Readme.md
index f288809a9..16f48336d 100644
--- a/Readme.md
+++ b/Readme.md
@@ -11,7 +11,6 @@
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
 <a href="https://circleci.com/gh/nestjs/nest" target="_blank"><img src="https://img.shields.io/circleci/build/github/nestjs/nest/master" alt="CircleCI" /></a>
-<a href="https://coveralls.io/github/nestjs/nest?branch=master" target="_blank"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#9" alt="Coverage" /></a>
 <a href="https://discord.gg/G7Qnnhy" target="_blank"><img src="https://img.shields.io/badge/discord-online-brightgreen.svg" alt="Discord"/></a>
 <a href="https://opencollective.com/nest#backer" target="_blank"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
 <a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
@@ -37,8 +36,8 @@ Nest is a framework for building efficient, scalable <a href="http://nodejs.org"
 
 * To check out the [guide](https://docs.nestjs.com), visit [docs.nestjs.com](https://docs.nestjs.com). :books:
 * Ë¶ÅÊü•Áúã‰∏≠Êñá [ÊåáÂçó](readme_zh.md), ËØ∑ËÆøÈóÆ [docs.nestjs.cn](https://docs.nestjs.cn). :books:
-* [Í∞ÄÏù¥Îìú](readme_kr.md)Î•º ÌôïÏù∏ÌïòÎ†§Î©¥, [docs.nestjs.com](https://docs.nestjs.com)Î•º Î∞©Î¨∏ÌïòÏÑ∏Ïöî.:books: 
-* „ÉÅ„Çß„ÉÉ„ÇØ„Åô„Çã„Å´„ÅØ [„Ç¨„Ç§„Éâ](readme_jp.md), Ë©≥„Åó„Åè„ÅØ [docs.nestjs.com](https://docs.nestjs.com). :books: 
+* [Í∞ÄÏù¥Îìú](readme_kr.md) Î¨∏ÏÑúÎäî [docs.nestjs.com](https://docs.nestjs.com)ÏóêÏÑú ÌôïÏù∏ÌïòÏã§ Ïàò ÏûàÏäµÎãàÎã§. :books:
+* [„Ç¨„Ç§„Éâ](readme_jp.md)„ÅØ [docs.nestjs.com](https://docs.nestjs.com)„Åß„ÅîÁ¢∫Ë™ç„Åè„Å†„Åï„ÅÑ„ÄÇ :books:
 
 ## Questions
 
@@ -54,36 +53,49 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
 <table style="text-align:center;"><tr>
   <td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
+  <td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/red-hat-logo.svg" width="200" valign="middle" /></a></td>
 <td>
 <a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
 <td>
 <a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
+    <td>
+<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td><td>
+<a href="https://amplication.com/" target="_blank"><img src="https://nestjs.com/img/amplication-logo.svg" width="190" valign="middle" /></a></td>
 </tr></table>
 
 #### Gold Sponsors
 
 <table style="text-align:center;"><tr><td>
-  <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
-  <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
+<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="140" valign="middle" /></a></td>
 <td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
+<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td>
+ <td>
+<a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
+<a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td><td>
+<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td>
+<td>
+<a href="https://ridicorp.com/career/" target="_blank"><img src="https://nestjs.com/img/ridi-logo.svg" width="105" valign="middle" /></a></td><td>
+<a href="https://www.movavi.com/imovie-for-windows.html" target="_blank"><img src="https://nestjs.com/img/movavi-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
 <table style="text-align:center;"><tr><td>
 <a href="https://neoteric.eu/" target="_blank"><img src="https://nestjs.com/img/neoteric-cut.png" width="120" valign="middle" /></a> </td><td>
   <a href="http://gojob.com" target="_blank"><img src="http://nestjs.com/img/gojob-logo.png" valign="middle" width="100" /></a> </td><td>
-<a href="http://www.leogistics.com" target="_blank"><img src="https://nestjs.com/img/leogistics-logo.jpeg" width="150" valign="middle" /></td><td>
+<a href="https://www.myleodsc.com/" target="_blank"><img src="https://nestjs.com/img/myleo-logo.png" width="180" valign="middle" /></td><td>
 <a href="https://careers.meetdandy.com/?gh_src=063ba61e3us" target="_blank"><img src="https://nestjs.com/img/dandy-roles-logo.svg" width="150" valign="middle" /></td><td>
 <a href="https://www.castlecraft.in" target="_blank"><img src="https://nestjs.com/img/castlecraft-logo.png" width="150" valign="middle" /></td>
-<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td></tr></table>
+<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td>
+<td><a href="https://n.inc" target="_blank"><img src="https://nestjs.com/img/n-inc-logo.svg" width="120" valign="middle" /></td></tr><tr>
+<td><a href="https://bilberrry.com/" target="_blank"><img src="https://nestjs.com/img/bilberrry-logo.svg" width="180" valign="middle" /></td>
+<td><a href="https://ipinfo.ai/" target="_blank"><img src="https://nestjs.com/img/ipinfo-logo.png" width="130" valign="middle" /></td>
+<td><a href="https://chax.at" target="_blank"><img src="https://nestjs.com/img/chaxat-logo.png" width="100" valign="middle" /></td></tr>
+</table>
 
 #### Sponsors
 
@@ -91,7 +103,7 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <a href="https://www.swingdev.io" target="_blank"><img src="https://nestjs.com/img/swingdev-logo.svg#1" width="110" valign="middle" /> </a></td><td align="center" valign="middle">
 <a href="https://www.novologic.com/" target="_blank"><img src="https://nestjs.com/img/novologic.png" width="110" valign="middle" /></a> </td><td align="center" valign="middle">
 <a href="https://ever.co/" target="_blank"><img src="https://nestjs.com/img/ever-logo.png" width="72" valign="middle" /></a>  </td><td align="center" valign="middle">
-<a href="https://blokt.com" target="_blank"><img src="https://nestjs.com/img/blokt-logo.png" width="120" valign="middle" /></a>  </td><td align="center" valign="middle"> 
+<a href="https://blokt.com" target="_blank"><img src="https://nestjs.com/img/blokt-logo.png" width="120" valign="middle" /></a>  </td><td align="center" valign="middle">
   <a href="http://architectnow.net/" target="_blank"><img src="https://nestjs.com/img/architectnow.png" width="125" valign="middle" /></a> </td><td align="center" valign="middle">
   <a href="https://quander.io/" target="_blank"><img src="https://nestjs.com/img/quander.png" width="100" valign="middle" /></a> </td></tr><tr><td align="center" valign="middle">
   <a href="https://mantro.net/" target="_blank"><img src="https://nestjs.com/img/mantro-logo.svg" width="95" valign="middle" /></a> </td><td align="center" valign="middle">
@@ -117,6 +129,14 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/naologic-logo.svg" width="125" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://messaged.com/" target="_blank"><img src="https://nestjs.com/img/messaged-logo.png" width="50" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/triplecore-logo.svg" width="50" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://klqc.de" target="_blank"><img src="https://nestjs.com/img/klcqcl-logo.png" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://thecasinowizard.com/bonuses/no-deposit-bonuses/" target="_blank"><img src="https://nestjs.com/img/casinowizard-logo.png" width="120" valign="middle" /></a></td></tr><tr>
+     <td align="center" valign="middle"><a href="https://polygon-software.ch/" target="_blank"><img src="https://nestjs.com/img/polygon-logo.svg" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://mobilereality.pl/" target="_blank"><img src="https://nestjs.com/img/mobile-reality-logo.png" width="45" valign="middle" /></a></td>
+     <td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/boringowl-logo.svg" width="120" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://www.mobilefactory.jp/" target="_blank"><img src="https://nestjs.com/img/mobilefactory-logo.png" width="100" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://nordbot.app/" target="_blank"><img src="https://nestjs.com/img/nordbot-logo.png" width="120" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://doppio.sh/" target="_blank"><img src="https://nestjs.com/img/dopiosh-logo.png" width="50" valign="middle" /></a></td>
   </tr></table>
 
 ## Backers
diff --git a/benchmarks/fastify.js b/benchmarks/fastify.js
index baf5e7ab8..eb70ea0ba 100644
--- a/benchmarks/fastify.js
+++ b/benchmarks/fastify.js
@@ -2,4 +2,6 @@
 
 const fastify = require('fastify')();
 fastify.get('/', async (req, reply) => reply.send('Hello world'));
-fastify.listen(3000);
+fastify.listen({
+  port: 3000
+});
diff --git a/hooks/mocha-init-hook.ts b/hooks/mocha-init-hook.ts
new file mode 100644
index 000000000..82b14a111
--- /dev/null
+++ b/hooks/mocha-init-hook.ts
@@ -0,0 +1,7 @@
+export const mochaHooks = (): Mocha.RootHookObject => {
+  return {
+    async beforeAll(this: Mocha.Context) {
+      await import('reflect-metadata');
+    },
+  };
+};
diff --git a/integration/auto-mock/src/bar.service.ts b/integration/auto-mock/src/bar.service.ts
index d4224329a..5b75933f9 100644
--- a/integration/auto-mock/src/bar.service.ts
+++ b/integration/auto-mock/src/bar.service.ts
@@ -3,10 +3,9 @@ import { FooService } from './foo.service';
 
 @Injectable()
 export class BarService {
-
   constructor(private readonly foo: FooService) {}
 
   bar() {
     this.foo.foo();
   }
-}
\ No newline at end of file
+}
diff --git a/integration/auto-mock/test/bar.service.spec.ts b/integration/auto-mock/test/bar.service.spec.ts
index 754306ff3..5c8343167 100644
--- a/integration/auto-mock/test/bar.service.spec.ts
+++ b/integration/auto-mock/test/bar.service.spec.ts
@@ -36,7 +36,7 @@ describe('Auto-Mocking with token in factory', () => {
     const moduleRef = await Test.createTestingModule({
       providers: [BarService],
     })
-      .useMocker((token) => {
+      .useMocker(token => {
         if (token === FooService) {
           return { foo: sinon.stub };
         }
@@ -48,16 +48,13 @@ describe('Auto-Mocking with token in factory', () => {
     expect(fooServ.foo.called);
   });
   it('cannot mock the dependencies', async () => {
-
     const moduleRef = Test.createTestingModule({
       providers: [BarService],
-    })
-      .useMocker((token) => {
-        if (token === FooService.name + 'something that fails the token') {
-          return { foo: sinon.stub };
-        }
-      })
-      .compile;
-    expect(moduleRef()).to.eventually.throw()
+    }).useMocker(token => {
+      if (token === FooService.name + 'something that fails the token') {
+        return { foo: sinon.stub };
+      }
+    }).compile;
+    expect(moduleRef()).to.eventually.throw();
   });
 });
diff --git a/integration/auto-mock/tsconfig.json b/integration/auto-mock/tsconfig.json
index c6354c564..cef623d14 100644
--- a/integration/auto-mock/tsconfig.json
+++ b/integration/auto-mock/tsconfig.json
@@ -7,10 +7,28 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
diff --git a/integration/cache/e2e/multi-store.spec.ts b/integration/cache/e2e/multi-store.spec.ts
deleted file mode 100644
index bae2dea08..000000000
--- a/integration/cache/e2e/multi-store.spec.ts
+++ /dev/null
@@ -1,31 +0,0 @@
-import { INestApplication } from '@nestjs/common';
-import { Test } from '@nestjs/testing';
-import * as request from 'supertest';
-import { MultiStoreModule } from '../src/multi-store/multi-store.module';
-
-describe('Caching Multi Store', () => {
-  let server;
-  let app: INestApplication;
-
-  before(async () => {
-    const module = await Test.createTestingModule({
-      imports: [MultiStoreModule],
-    }).compile();
-
-    app = module.createNestApplication();
-    server = app.getHttpServer();
-    await app.init();
-  });
-
-  it(`should return empty`, async () => {
-    return request(server).get('/').expect(200, '');
-  });
-
-  it(`should return data`, async () => {
-    return request(server).get('/').expect(200, 'multi-store-value');
-  });
-
-  after(async () => {
-    await app.close();
-  });
-});
diff --git a/integration/cache/src/multi-store/multi-store.controller.ts b/integration/cache/src/multi-store/multi-store.controller.ts
deleted file mode 100644
index ce4a446a8..000000000
--- a/integration/cache/src/multi-store/multi-store.controller.ts
+++ /dev/null
@@ -1,16 +0,0 @@
-import { Controller, Get, Inject, CACHE_MANAGER } from '@nestjs/common';
-import { Cache } from 'cache-manager';
-
-@Controller()
-export class MultiStoreController {
-  constructor(@Inject(CACHE_MANAGER) private cacheManager: Cache) {}
-
-  @Get()
-  async getFromMultiStore(): Promise<unknown> {
-    const value = await this.cacheManager.get('multi-store-key');
-    if (!value) {
-      await this.cacheManager.set('multi-store-key', 'multi-store-value');
-    }
-    return value;
-  }
-}
diff --git a/integration/cache/src/multi-store/multi-store.module.ts b/integration/cache/src/multi-store/multi-store.module.ts
deleted file mode 100644
index 8ebc34e5b..000000000
--- a/integration/cache/src/multi-store/multi-store.module.ts
+++ /dev/null
@@ -1,24 +0,0 @@
-import { CacheModule, Module } from '@nestjs/common';
-import * as redisStore from 'cache-manager-redis-store';
-import { MultiStoreController } from './multi-store.controller';
-
-@Module({
-  imports: [
-    CacheModule.register([
-      {
-        store: 'memory',
-        max: 100,
-        ttl: 10,
-      },
-      {
-        store: redisStore,
-        host: 'localhost',
-        port: 6379,
-        db: 0,
-        ttl: 600,
-      },
-    ]),
-  ],
-  controllers: [MultiStoreController],
-})
-export class MultiStoreModule {}
diff --git a/integration/cors/e2e/express.spec.ts b/integration/cors/e2e/express.spec.ts
index c13abf4d9..8e268c316 100644
--- a/integration/cors/e2e/express.spec.ts
+++ b/integration/cors/e2e/express.spec.ts
@@ -1,10 +1,10 @@
-import { NestFastifyApplication } from '@nestjs/platform-fastify';
+import { NestExpressApplication } from '@nestjs/platform-express';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
 import { AppModule } from '../src/app.module';
 
 describe('Express Cors', () => {
-  let app: NestFastifyApplication;
+  let app: NestExpressApplication;
   const configs = [
     {
       origin: 'example.com',
@@ -30,7 +30,7 @@ describe('Express Cors', () => {
           imports: [AppModule],
         }).compile();
 
-        app = module.createNestApplication<NestFastifyApplication>();
+        app = module.createNestApplication<NestExpressApplication>();
 
         let requestId = 0;
         const configDelegation = function (req, cb) {
@@ -84,7 +84,7 @@ describe('Express Cors', () => {
           cb(null, config);
         };
 
-        app = module.createNestApplication<NestFastifyApplication>(null, {
+        app = module.createNestApplication<NestExpressApplication>({
           cors: configDelegation,
         });
 
@@ -126,7 +126,7 @@ describe('Express Cors', () => {
           imports: [AppModule],
         }).compile();
 
-        app = module.createNestApplication<NestFastifyApplication>();
+        app = module.createNestApplication<NestExpressApplication>();
         app.enableCors(configs[0]);
 
         await app.init();
@@ -153,7 +153,7 @@ describe('Express Cors', () => {
           imports: [AppModule],
         }).compile();
 
-        app = module.createNestApplication<NestFastifyApplication>(null, {
+        app = module.createNestApplication<NestExpressApplication>({
           cors: configs[0],
         });
         await app.init();
diff --git a/integration/cors/e2e/fastify.spec.ts b/integration/cors/e2e/fastify.spec.ts
index b98d12328..df8caba43 100644
--- a/integration/cors/e2e/fastify.spec.ts
+++ b/integration/cors/e2e/fastify.spec.ts
@@ -1,9 +1,12 @@
-import { NestFastifyApplication } from '@nestjs/platform-fastify';
+import {
+  FastifyAdapter,
+  NestFastifyApplication,
+} from '@nestjs/platform-fastify';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
 import { AppModule } from '../src/app.module';
 
-describe('Fastify Cors', () => {
+describe.skip('Fastify Cors', () => {
   let app: NestFastifyApplication;
   const configs = [
     {
@@ -30,7 +33,9 @@ describe('Fastify Cors', () => {
           imports: [AppModule],
         }).compile();
 
-        app = module.createNestApplication<NestFastifyApplication>();
+        app = module.createNestApplication<NestFastifyApplication>(
+          new FastifyAdapter(),
+        );
 
         let requestId = 0;
         const configDelegation = function (req, cb) {
@@ -84,9 +89,12 @@ describe('Fastify Cors', () => {
           cb(null, config);
         };
 
-        app = module.createNestApplication<NestFastifyApplication>(null, {
-          cors: configDelegation,
-        });
+        app = module.createNestApplication<NestFastifyApplication>(
+          new FastifyAdapter(),
+          {
+            cors: configDelegation,
+          },
+        );
 
         await app.init();
       });
@@ -127,7 +135,9 @@ describe('Fastify Cors', () => {
           imports: [AppModule],
         }).compile();
 
-        app = module.createNestApplication<NestFastifyApplication>();
+        app = module.createNestApplication<NestFastifyApplication>(
+          new FastifyAdapter(),
+        );
         app.enableCors(configs[0]);
 
         await app.init();
@@ -147,16 +157,19 @@ describe('Fastify Cors', () => {
     after(async () => {
       await app.close();
     });
-    
+
     describe('Application Options', () => {
       before(async () => {
         const module = await Test.createTestingModule({
           imports: [AppModule],
         }).compile();
 
-        app = module.createNestApplication<NestFastifyApplication>(null, {
-          cors: configs[0],
-        });
+        app = module.createNestApplication<NestFastifyApplication>(
+          new FastifyAdapter(),
+          {
+            cors: configs[0],
+          },
+        );
         await app.init();
       });
 
diff --git a/integration/cors/tsconfig.json b/integration/cors/tsconfig.json
index c6354c564..cef623d14 100644
--- a/integration/cors/tsconfig.json
+++ b/integration/cors/tsconfig.json
@@ -7,10 +7,28 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
diff --git a/integration/docker-compose.yml b/integration/docker-compose.yml
index 7ee1a96ac..bbf95d3a9 100644
--- a/integration/docker-compose.yml
+++ b/integration/docker-compose.yml
@@ -17,13 +17,15 @@ services:
     restart: always
   mqtt:
     container_name: test-mqtt
-    image: toke/mosquitto
+    image: eclipse-mosquitto
+    volumes:
+      - ./mosquitto.conf:/mosquitto/config/mosquitto.conf
     ports:
       - "1883:1883"
       - "9001:9001"
     restart: always
   mysql:
-    image: mysql:8.0.27
+    image: mysql:8.0.32
     environment:
       MYSQL_ROOT_PASSWORD: root
       MYSQL_DATABASE: test
@@ -48,7 +50,7 @@ services:
   zookeeper:
     container_name: test-zookeeper
     hostname: zookeeper
-    image: confluentinc/cp-zookeeper:7.0.0
+    image: confluentinc/cp-zookeeper:7.3.2
     ports:
       - "2181:2181"
     environment:
@@ -57,7 +59,7 @@ services:
   kafka:
     container_name: test-kafka
     hostname: kafka
-    image: confluentinc/cp-kafka:7.0.0
+    image: confluentinc/cp-kafka:7.3.2
     depends_on:
       - zookeeper
     ports:
diff --git a/integration/graphql-code-first/e2e/code-first.spec.ts b/integration/graphql-code-first/e2e/code-first.spec.ts
index 3a2cb97b3..258edd8a9 100644
--- a/integration/graphql-code-first/e2e/code-first.spec.ts
+++ b/integration/graphql-code-first/e2e/code-first.spec.ts
@@ -1,14 +1,14 @@
 import { INestApplication } from '@nestjs/common';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 describe('GraphQL - Code-first', () => {
   let app: INestApplication;
 
   beforeEach(async () => {
     const module = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
 
     app = module.createNestApplication();
diff --git a/integration/graphql-code-first/e2e/guards-filters.spec.ts b/integration/graphql-code-first/e2e/guards-filters.spec.ts
index 6e3307b5b..4953d771c 100644
--- a/integration/graphql-code-first/e2e/guards-filters.spec.ts
+++ b/integration/graphql-code-first/e2e/guards-filters.spec.ts
@@ -1,14 +1,14 @@
 import { INestApplication } from '@nestjs/common';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 describe('GraphQL - Guards', () => {
   let app: INestApplication;
 
   beforeEach(async () => {
     const module = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
 
     app = module.createNestApplication();
diff --git a/integration/graphql-code-first/e2e/pipes.spec.ts b/integration/graphql-code-first/e2e/pipes.spec.ts
index bdd928fd9..e14e31df1 100644
--- a/integration/graphql-code-first/e2e/pipes.spec.ts
+++ b/integration/graphql-code-first/e2e/pipes.spec.ts
@@ -1,14 +1,14 @@
 import { INestApplication, ValidationPipe } from '@nestjs/common';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 describe('GraphQL Pipes', () => {
   let app: INestApplication;
 
   beforeEach(async () => {
     const module = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
 
     app = module.createNestApplication();
@@ -30,8 +30,8 @@ describe('GraphQL Pipes', () => {
         errors: [
           {
             extensions: {
-              code: 'BAD_USER_INPUT',
-              response: {
+              code: 'BAD_REQUEST',
+              originalError: {
                 error: 'Bad Request',
                 message: [
                   'description must be longer than or equal to 30 characters',
@@ -39,7 +39,14 @@ describe('GraphQL Pipes', () => {
                 statusCode: 400,
               },
             },
+            locations: [
+              {
+                column: 3,
+                line: 2,
+              },
+            ],
             message: 'Bad Request Exception',
+            path: ['addRecipe'],
           },
         ],
       });
diff --git a/integration/graphql-code-first/schema.gql b/integration/graphql-code-first/schema.gql
index 59f110694..c196e332d 100644
--- a/integration/graphql-code-first/schema.gql
+++ b/integration/graphql-code-first/schema.gql
@@ -15,7 +15,7 @@ scalar Date
 
 type Query {
   recipe(id: String!): Recipe!
-  recipes(skip: Int = 0, take: Int = 25): [Recipe!]!
+  recipes(skip: Int! = 0, take: Int! = 25): [Recipe!]!
 }
 
 type Mutation {
@@ -31,4 +31,4 @@ input NewRecipeInput {
 
 type Subscription {
   recipeAdded: Recipe!
-}
+}
\ No newline at end of file
diff --git a/integration/graphql-code-first/src/app.module.ts b/integration/graphql-code-first/src/app.module.ts
index 4fd71db94..5da27fa35 100644
--- a/integration/graphql-code-first/src/app.module.ts
+++ b/integration/graphql-code-first/src/app.module.ts
@@ -1,3 +1,4 @@
+import { ApolloDriver, ApolloDriverConfig } from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
 import { GraphQLModule } from '@nestjs/graphql';
 import { join } from 'path';
@@ -6,8 +7,9 @@ import { RecipesModule } from './recipes/recipes.module';
 @Module({
   imports: [
     RecipesModule,
-    GraphQLModule.forRoot({
-      debug: false,
+    GraphQLModule.forRoot<ApolloDriverConfig>({
+      driver: ApolloDriver,
+      includeStacktraceInErrorResponses: false,
       installSubscriptionHandlers: true,
       autoSchemaFile: join(
         process.cwd(),
@@ -16,4 +18,4 @@ import { RecipesModule } from './recipes/recipes.module';
     }),
   ],
 })
-export class ApplicationModule {}
+export class AppModule {}
diff --git a/integration/graphql-code-first/src/main.ts b/integration/graphql-code-first/src/main.ts
index c04a543a1..5a5fd57ce 100644
--- a/integration/graphql-code-first/src/main.ts
+++ b/integration/graphql-code-first/src/main.ts
@@ -1,9 +1,9 @@
 import { ValidationPipe } from '@nestjs/common';
 import { NestFactory } from '@nestjs/core';
-import { ApplicationModule } from './app.module';
+import { AppModule } from './app.module';
 
 async function bootstrap() {
-  const app = await NestFactory.create(ApplicationModule);
+  const app = await NestFactory.create(AppModule);
   app.useGlobalPipes(new ValidationPipe());
   await app.listen(3000);
 }
diff --git a/integration/graphql-code-first/tsconfig.json b/integration/graphql-code-first/tsconfig.json
index ea15af490..cef623d14 100644
--- a/integration/graphql-code-first/tsconfig.json
+++ b/integration/graphql-code-first/tsconfig.json
@@ -7,16 +7,34 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
-    "src/**/*"
+    "src/**/*",
+    "e2e/**/*"
   ],
   "exclude": [
     "node_modules",
-    "**/*.spec.ts"
   ]
 }
\ No newline at end of file
diff --git a/integration/graphql-schema-first/e2e/graphql-request-scoped.spec.ts b/integration/graphql-schema-first/e2e/graphql-request-scoped.spec.ts
index fa470c2c6..5f2309689 100644
--- a/integration/graphql-schema-first/e2e/graphql-request-scoped.spec.ts
+++ b/integration/graphql-schema-first/e2e/graphql-request-scoped.spec.ts
@@ -1,3 +1,4 @@
+import { ApolloDriver } from '@nestjs/apollo';
 import { INestApplication } from '@nestjs/common';
 import { GraphQLModule } from '@nestjs/graphql';
 import { Test } from '@nestjs/testing';
@@ -15,6 +16,7 @@ describe('GraphQL request scoped', () => {
       imports: [
         CatsModule.enableRequestScope(),
         GraphQLModule.forRoot({
+          driver: ApolloDriver,
           typePaths: [join(__dirname, '..', 'src', '**', '*.graphql')],
         }),
       ],
diff --git a/integration/graphql-schema-first/e2e/graphql.spec.ts b/integration/graphql-schema-first/e2e/graphql.spec.ts
index 376244f1a..e8ced186f 100644
--- a/integration/graphql-schema-first/e2e/graphql.spec.ts
+++ b/integration/graphql-schema-first/e2e/graphql.spec.ts
@@ -1,14 +1,14 @@
 import { INestApplication } from '@nestjs/common';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 describe('GraphQL', () => {
   let app: INestApplication;
 
   beforeEach(async () => {
     const module = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
 
     app = module.createNestApplication();
diff --git a/integration/graphql-schema-first/src/app.module.ts b/integration/graphql-schema-first/src/app.module.ts
index a3cfa7a6d..2879cfc9f 100644
--- a/integration/graphql-schema-first/src/app.module.ts
+++ b/integration/graphql-schema-first/src/app.module.ts
@@ -1,3 +1,4 @@
+import { ApolloDriver, ApolloDriverConfig } from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
 import { GraphQLModule } from '@nestjs/graphql';
 import { join } from 'path';
@@ -6,9 +7,11 @@ import { CatsModule } from './cats/cats.module';
 @Module({
   imports: [
     CatsModule,
-    GraphQLModule.forRoot({
+    GraphQLModule.forRoot<ApolloDriverConfig>({
+      driver: ApolloDriver,
+      includeStacktraceInErrorResponses: true,
       typePaths: [join(__dirname, '**', '*.graphql')],
     }),
   ],
 })
-export class ApplicationModule {}
+export class AppModule {}
diff --git a/integration/graphql-schema-first/src/async-options-class.module.ts b/integration/graphql-schema-first/src/async-options-class.module.ts
index 749492e8c..5e702348d 100644
--- a/integration/graphql-schema-first/src/async-options-class.module.ts
+++ b/integration/graphql-schema-first/src/async-options-class.module.ts
@@ -1,14 +1,11 @@
+import { ApolloDriver, ApolloDriverConfig } from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
-import {
-  GqlModuleOptions,
-  GqlOptionsFactory,
-  GraphQLModule,
-} from '@nestjs/graphql';
+import { GqlOptionsFactory, GraphQLModule } from '@nestjs/graphql';
 import { join } from 'path';
 import { CatsModule } from './cats/cats.module';
 
 class ConfigService implements GqlOptionsFactory {
-  createGqlOptions(): GqlModuleOptions {
+  createGqlOptions(): ApolloDriverConfig {
     return {
       typePaths: [join(__dirname, '**', '*.graphql')],
     };
@@ -18,7 +15,8 @@ class ConfigService implements GqlOptionsFactory {
 @Module({
   imports: [
     CatsModule,
-    GraphQLModule.forRootAsync({
+    GraphQLModule.forRootAsync<ApolloDriverConfig>({
+      driver: ApolloDriver,
       useClass: ConfigService,
     }),
   ],
diff --git a/integration/graphql-schema-first/src/async-options-existing.module.ts b/integration/graphql-schema-first/src/async-options-existing.module.ts
index 9bfe86369..e68b65ada 100644
--- a/integration/graphql-schema-first/src/async-options-existing.module.ts
+++ b/integration/graphql-schema-first/src/async-options-existing.module.ts
@@ -1,3 +1,4 @@
+import { ApolloDriver, ApolloDriverConfig } from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
 import { GraphQLModule } from '@nestjs/graphql';
 import { CatsModule } from './cats/cats.module';
@@ -7,7 +8,8 @@ import { ConfigService } from './config.service';
 @Module({
   imports: [
     CatsModule,
-    GraphQLModule.forRootAsync({
+    GraphQLModule.forRootAsync<ApolloDriverConfig>({
+      driver: ApolloDriver,
       imports: [ConfigModule],
       useExisting: ConfigService,
     }),
diff --git a/integration/graphql-schema-first/src/async-options.module.ts b/integration/graphql-schema-first/src/async-options.module.ts
index 77dfb471d..c123cbc97 100644
--- a/integration/graphql-schema-first/src/async-options.module.ts
+++ b/integration/graphql-schema-first/src/async-options.module.ts
@@ -1,3 +1,4 @@
+import { ApolloDriver, ApolloDriverConfig } from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
 import { GraphQLModule } from '@nestjs/graphql';
 import { join } from 'path';
@@ -6,7 +7,8 @@ import { CatsModule } from './cats/cats.module';
 @Module({
   imports: [
     CatsModule,
-    GraphQLModule.forRootAsync({
+    GraphQLModule.forRootAsync<ApolloDriverConfig>({
+      driver: ApolloDriver,
       useFactory: async () => ({
         typePaths: [join(__dirname, '**', '*.graphql')],
       }),
diff --git a/integration/graphql-schema-first/src/main.ts b/integration/graphql-schema-first/src/main.ts
index afb93ba07..13cad38cf 100644
--- a/integration/graphql-schema-first/src/main.ts
+++ b/integration/graphql-schema-first/src/main.ts
@@ -1,8 +1,8 @@
 import { NestFactory } from '@nestjs/core';
-import { ApplicationModule } from './app.module';
+import { AppModule } from './app.module';
 
 async function bootstrap() {
-  const app = await NestFactory.create(ApplicationModule);
+  const app = await NestFactory.create(AppModule);
   await app.listen(3000);
 }
 bootstrap();
diff --git a/integration/graphql-schema-first/tsconfig.json b/integration/graphql-schema-first/tsconfig.json
index 3229c5596..cef623d14 100644
--- a/integration/graphql-schema-first/tsconfig.json
+++ b/integration/graphql-schema-first/tsconfig.json
@@ -7,17 +7,34 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
     "outDir": "./dist",
-    "skipLibCheck": true
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
-    "src/**/*"
+    "src/**/*",
+    "e2e/**/*"
   ],
   "exclude": [
     "node_modules",
-    "**/*.spec.ts"
   ]
 }
\ No newline at end of file
diff --git a/integration/hello-world/e2e/exceptions.spec.ts b/integration/hello-world/e2e/exceptions.spec.ts
index 7cf8223ab..581964807 100644
--- a/integration/hello-world/e2e/exceptions.spec.ts
+++ b/integration/hello-world/e2e/exceptions.spec.ts
@@ -1,39 +1,135 @@
 import { HttpStatus, INestApplication } from '@nestjs/common';
+import {
+  FastifyAdapter,
+  NestFastifyApplication,
+} from '@nestjs/platform-fastify';
 import { Test } from '@nestjs/testing';
+import { expect } from 'chai';
+import { RawServerDefault } from 'fastify';
 import * as request from 'supertest';
 import { ErrorsController } from '../src/errors/errors.controller';
 
 describe('Error messages', () => {
-  let server;
-  let app: INestApplication;
+  let server: RawServerDefault;
 
-  beforeEach(async () => {
-    const module = await Test.createTestingModule({
-      controllers: [ErrorsController],
-    }).compile();
+  describe('Express', () => {
+    let app: INestApplication;
+    beforeEach(async () => {
+      const module = await Test.createTestingModule({
+        controllers: [ErrorsController],
+      }).compile();
 
-    app = module.createNestApplication();
-    server = app.getHttpServer();
-    await app.init();
-  });
+      app = module.createNestApplication();
+      server = app.getHttpServer();
+      await app.init();
+    });
 
-  it(`/GET`, () => {
-    return request(server).get('/sync').expect(HttpStatus.BAD_REQUEST).expect({
-      statusCode: 400,
-      error: 'Bad Request',
-      message: 'Integration test',
+    it(`/GET`, () => {
+      return request(server)
+        .get('/sync')
+        .expect(HttpStatus.BAD_REQUEST)
+        .expect({
+          statusCode: 400,
+          error: 'Bad Request',
+          message: 'Integration test',
+        });
+    });
+
+    it(`/GET (Promise/async)`, () => {
+      return request(server)
+        .get('/async')
+        .expect(HttpStatus.BAD_REQUEST)
+        .expect({
+          statusCode: 400,
+          error: 'Bad Request',
+          message: 'Integration test',
+        });
     });
-  });
 
-  it(`/GET (Promise/async)`, () => {
-    return request(server).get('/async').expect(HttpStatus.BAD_REQUEST).expect({
-      statusCode: 400,
-      error: 'Bad Request',
-      message: 'Integration test',
+    it(`/GET (InternalServerError despite custom content-type)`, async () => {
+      return request(server)
+        .get('/unexpected-error')
+        .expect(HttpStatus.INTERNAL_SERVER_ERROR)
+        .expect({
+          statusCode: 500,
+          message: 'Internal server error',
+        });
+    });
+
+    afterEach(async () => {
+      await app.close();
     });
   });
 
-  afterEach(async () => {
-    await app.close();
+  describe('Fastify', () => {
+    let app: NestFastifyApplication;
+    beforeEach(async () => {
+      const module = await Test.createTestingModule({
+        controllers: [ErrorsController],
+      }).compile();
+
+      app = module.createNestApplication<NestFastifyApplication>(
+        new FastifyAdapter(),
+      );
+      server = app.getHttpServer();
+      await app.init();
+    });
+
+    it(`/GET`, async () => {
+      return app
+        .inject({
+          method: 'GET',
+          url: '/sync',
+        })
+        .then(({ payload, statusCode }) => {
+          expect(statusCode).to.equal(HttpStatus.BAD_REQUEST);
+          expect(payload).to.equal(
+            JSON.stringify({
+              statusCode: 400,
+              error: 'Bad Request',
+              message: 'Integration test',
+            }),
+          );
+        });
+    });
+
+    it(`/GET (Promise/async)`, async () => {
+      return app
+        .inject({
+          method: 'GET',
+          url: '/sync',
+        })
+        .then(({ payload, statusCode }) => {
+          expect(statusCode).to.equal(HttpStatus.BAD_REQUEST);
+          expect(payload).to.equal(
+            JSON.stringify({
+              statusCode: 400,
+              error: 'Bad Request',
+              message: 'Integration test',
+            }),
+          );
+        });
+    });
+
+    it(`/GET (InternalServerError despite custom content-type)`, async () => {
+      return app
+        .inject({
+          method: 'GET',
+          url: '/unexpected-error',
+        })
+        .then(({ payload, statusCode }) => {
+          expect(statusCode).to.equal(HttpStatus.INTERNAL_SERVER_ERROR);
+          expect(payload).to.equal(
+            JSON.stringify({
+              statusCode: 500,
+              message: 'Internal server error',
+            }),
+          );
+        });
+    });
+
+    afterEach(async () => {
+      await app.close();
+    });
   });
 });
diff --git a/integration/hello-world/e2e/exclude-middleware-fastify.spec.ts b/integration/hello-world/e2e/exclude-middleware-fastify.spec.ts
index b3bbca679..2622d4cd0 100644
--- a/integration/hello-world/e2e/exclude-middleware-fastify.spec.ts
+++ b/integration/hello-world/e2e/exclude-middleware-fastify.spec.ts
@@ -13,7 +13,7 @@ import {
 } from '@nestjs/platform-fastify';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 const RETURN_VALUE = 'test';
 const MIDDLEWARE_VALUE = 'middleware';
@@ -57,7 +57,7 @@ class TestController {
 }
 
 @Module({
-  imports: [ApplicationModule],
+  imports: [AppModule],
   controllers: [TestController],
 })
 class TestModule {
diff --git a/integration/hello-world/e2e/exclude-middleware.spec.ts b/integration/hello-world/e2e/exclude-middleware.spec.ts
index 0b0fe2d74..1bc6f3df2 100644
--- a/integration/hello-world/e2e/exclude-middleware.spec.ts
+++ b/integration/hello-world/e2e/exclude-middleware.spec.ts
@@ -9,7 +9,7 @@ import {
 } from '@nestjs/common';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 const RETURN_VALUE = 'test';
 const MIDDLEWARE_VALUE = 'middleware';
@@ -48,7 +48,7 @@ class TestController {
 }
 
 @Module({
-  imports: [ApplicationModule],
+  imports: [AppModule],
   controllers: [TestController],
 })
 class TestModule {
diff --git a/integration/hello-world/e2e/express-instance.spec.ts b/integration/hello-world/e2e/express-instance.spec.ts
index 9774487a2..9d5840e65 100644
--- a/integration/hello-world/e2e/express-instance.spec.ts
+++ b/integration/hello-world/e2e/express-instance.spec.ts
@@ -3,7 +3,7 @@ import { ExpressAdapter } from '@nestjs/platform-express';
 import { Test } from '@nestjs/testing';
 import * as express from 'express';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 describe('Hello world (express instance)', () => {
   let server;
@@ -11,7 +11,7 @@ describe('Hello world (express instance)', () => {
 
   beforeEach(async () => {
     const module = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
 
     app = module.createNestApplication(new ExpressAdapter(express()));
diff --git a/integration/hello-world/e2e/express-multiple.spec.ts b/integration/hello-world/e2e/express-multiple.spec.ts
index 431e896b7..1f799d479 100644
--- a/integration/hello-world/e2e/express-multiple.spec.ts
+++ b/integration/hello-world/e2e/express-multiple.spec.ts
@@ -3,7 +3,7 @@ import { ExpressAdapter } from '@nestjs/platform-express';
 import { Test } from '@nestjs/testing';
 import * as express from 'express';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 describe('Hello world (express instance with multiple applications)', () => {
   let server;
@@ -11,10 +11,10 @@ describe('Hello world (express instance with multiple applications)', () => {
 
   beforeEach(async () => {
     const module1 = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
     const module2 = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
 
     const adapter = new ExpressAdapter(express());
diff --git a/integration/hello-world/e2e/fastify-adapter.spec.ts b/integration/hello-world/e2e/fastify-adapter.spec.ts
index 2846b0edd..25d263b20 100644
--- a/integration/hello-world/e2e/fastify-adapter.spec.ts
+++ b/integration/hello-world/e2e/fastify-adapter.spec.ts
@@ -4,14 +4,14 @@ import {
 } from '@nestjs/platform-fastify';
 import { Test } from '@nestjs/testing';
 import { expect } from 'chai';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 describe('Hello world (fastify adapter)', () => {
   let app: NestFastifyApplication;
 
   beforeEach(async () => {
     const module = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
 
     app = module.createNestApplication<NestFastifyApplication>(
diff --git a/integration/hello-world/e2e/guards.spec.ts b/integration/hello-world/e2e/guards.spec.ts
index 08e372e00..970826123 100644
--- a/integration/hello-world/e2e/guards.spec.ts
+++ b/integration/hello-world/e2e/guards.spec.ts
@@ -6,7 +6,7 @@ import {
 import { APP_GUARD } from '@nestjs/core';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 @Injectable()
 export class AuthGuard {
@@ -20,7 +20,7 @@ export class AuthGuard {
 
 function createTestModule(guard) {
   return Test.createTestingModule({
-    imports: [ApplicationModule],
+    imports: [AppModule],
     providers: [
       {
         provide: APP_GUARD,
diff --git a/integration/hello-world/e2e/hello-world.spec.ts b/integration/hello-world/e2e/hello-world.spec.ts
index 531a65160..e2f3a895f 100644
--- a/integration/hello-world/e2e/hello-world.spec.ts
+++ b/integration/hello-world/e2e/hello-world.spec.ts
@@ -1,7 +1,7 @@
 import * as request from 'supertest';
 import { Test } from '@nestjs/testing';
 import { INestApplication } from '@nestjs/common';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 describe('Hello world (default adapter)', () => {
   let server;
@@ -9,7 +9,7 @@ describe('Hello world (default adapter)', () => {
 
   beforeEach(async () => {
     const module = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
 
     app = module.createNestApplication();
diff --git a/integration/hello-world/e2e/interceptors.spec.ts b/integration/hello-world/e2e/interceptors.spec.ts
index 11222c514..c9a0c3179 100644
--- a/integration/hello-world/e2e/interceptors.spec.ts
+++ b/integration/hello-world/e2e/interceptors.spec.ts
@@ -10,7 +10,7 @@ import { Test } from '@nestjs/testing';
 import { of } from 'rxjs';
 import { map } from 'rxjs/operators';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 const RETURN_VALUE = 'test';
 
@@ -58,7 +58,7 @@ export class HeaderInterceptor {
 
 function createTestModule(interceptor) {
   return Test.createTestingModule({
-    imports: [ApplicationModule],
+    imports: [AppModule],
     providers: [
       {
         provide: APP_INTERCEPTOR,
diff --git a/integration/hello-world/e2e/local-pipes.spec.ts b/integration/hello-world/e2e/local-pipes.spec.ts
index 5bc4a66d8..e982bc4ae 100644
--- a/integration/hello-world/e2e/local-pipes.spec.ts
+++ b/integration/hello-world/e2e/local-pipes.spec.ts
@@ -1,7 +1,7 @@
 import { INestApplication } from '@nestjs/common';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 describe('Hello world (default adapter)', () => {
   let server;
@@ -9,7 +9,7 @@ describe('Hello world (default adapter)', () => {
 
   beforeEach(async () => {
     const module = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
 
     app = module.createNestApplication();
diff --git a/integration/hello-world/e2e/middleware-class.spec.ts b/integration/hello-world/e2e/middleware-class.spec.ts
index 134222611..e71a12ec5 100644
--- a/integration/hello-world/e2e/middleware-class.spec.ts
+++ b/integration/hello-world/e2e/middleware-class.spec.ts
@@ -9,7 +9,7 @@ import {
 } from '@nestjs/common';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 import { Response } from 'express';
 
 const INCLUDED_VALUE = 'test_included';
@@ -32,7 +32,7 @@ class TestController {
 }
 
 @Module({
-  imports: [ApplicationModule],
+  imports: [AppModule],
   controllers: [TestController],
 })
 class TestModule {
diff --git a/integration/hello-world/e2e/middleware-fastify.spec.ts b/integration/hello-world/e2e/middleware-fastify.spec.ts
index 4fe34a0b3..a71afa185 100644
--- a/integration/hello-world/e2e/middleware-fastify.spec.ts
+++ b/integration/hello-world/e2e/middleware-fastify.spec.ts
@@ -12,7 +12,7 @@ import {
 } from '@nestjs/platform-fastify';
 import { Test } from '@nestjs/testing';
 import { expect } from 'chai';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 const INCLUDED_VALUE = 'test_included';
 const QUERY_VALUE = 'test_query';
@@ -58,7 +58,7 @@ class TestQueryController {
 }
 
 @Module({
-  imports: [ApplicationModule],
+  imports: [AppModule],
   controllers: [TestController, TestQueryController],
 })
 class TestModule {
@@ -77,7 +77,7 @@ class TestModule {
       .apply((req, res, next) => res.end(SCOPED_VALUE))
       .forRoutes(TestController)
       .apply((req, res, next) => res.end(RETURN_VALUE))
-      .exclude({ path: QUERY_VALUE, method: -1 })
+      .exclude({ path: QUERY_VALUE, method: -1 as any })
       .forRoutes('(.*)');
   }
 }
diff --git a/integration/hello-world/e2e/middleware-with-versioning.spec.ts b/integration/hello-world/e2e/middleware-with-versioning.spec.ts
new file mode 100644
index 000000000..a16645b68
--- /dev/null
+++ b/integration/hello-world/e2e/middleware-with-versioning.spec.ts
@@ -0,0 +1,171 @@
+import {
+  Controller,
+  Get,
+  INestApplication,
+  MiddlewareConsumer,
+  Module,
+  RequestMethod,
+  Version,
+  VersioningOptions,
+  VersioningType,
+  VERSION_NEUTRAL,
+} from '@nestjs/common';
+import { CustomVersioningOptions } from '@nestjs/common/interfaces';
+import { Test } from '@nestjs/testing';
+import * as request from 'supertest';
+import { AppModule } from '../src/app.module';
+
+const RETURN_VALUE = 'test';
+const VERSIONED_VALUE = 'test_versioned';
+
+@Controller()
+class TestController {
+  @Version('1')
+  @Get('versioned')
+  versionedTest() {
+    return RETURN_VALUE;
+  }
+}
+
+@Module({
+  imports: [AppModule],
+  controllers: [TestController],
+})
+class TestModule {
+  configure(consumer: MiddlewareConsumer) {
+    consumer
+      .apply((req, res, next) => res.send(VERSIONED_VALUE))
+      .forRoutes({
+        path: '/versioned',
+        version: '1',
+        method: RequestMethod.ALL,
+      });
+  }
+}
+
+describe('Middleware', () => {
+  let app: INestApplication;
+
+  describe('when using default URI versioning', () => {
+    beforeEach(async () => {
+      app = await createAppWithVersioning({
+        type: VersioningType.URI,
+        defaultVersion: VERSION_NEUTRAL,
+      });
+    });
+
+    it(`forRoutes({ path: '/versioned', version: '1', method: RequestMethod.ALL })`, () => {
+      return request(app.getHttpServer())
+        .get('/v1/versioned')
+        .expect(200, VERSIONED_VALUE);
+    });
+  });
+
+  describe('when default URI versioning with an alternative prefix', () => {
+    beforeEach(async () => {
+      app = await createAppWithVersioning({
+        type: VersioningType.URI,
+        defaultVersion: VERSION_NEUTRAL,
+        prefix: 'version',
+      });
+    });
+
+    it(`forRoutes({ path: '/versioned', version: '1', method: RequestMethod.ALL })`, () => {
+      return request(app.getHttpServer())
+        .get('/version1/versioned')
+        .expect(200, VERSIONED_VALUE);
+    });
+  });
+
+  describe('when using default URI versioning with the global prefix', () => {
+    beforeEach(async () => {
+      app = await createAppWithVersioning(
+        {
+          type: VersioningType.URI,
+          defaultVersion: VERSION_NEUTRAL,
+        },
+        async (app: INestApplication) => {
+          app.setGlobalPrefix('api');
+        },
+      );
+    });
+
+    it(`forRoutes({ path: '/versioned', version: '1', method: RequestMethod.ALL })`, () => {
+      return request(app.getHttpServer())
+        .get('/api/v1/versioned')
+        .expect(200, VERSIONED_VALUE);
+    });
+  });
+
+  describe('when using HEADER versioning', () => {
+    beforeEach(async () => {
+      app = await createAppWithVersioning({
+        type: VersioningType.HEADER,
+        header: 'version',
+      });
+    });
+
+    it(`forRoutes({ path: '/versioned', version: '1', method: RequestMethod.ALL })`, () => {
+      return request(app.getHttpServer())
+        .get('/versioned')
+        .set('version', '1')
+        .expect(200, VERSIONED_VALUE);
+    });
+  });
+
+  describe('when using MEDIA TYPE versioning', () => {
+    beforeEach(async () => {
+      app = await createAppWithVersioning({
+        type: VersioningType.MEDIA_TYPE,
+        key: 'v',
+        defaultVersion: VERSION_NEUTRAL,
+      });
+    });
+
+    it(`forRoutes({ path: '/versioned', version: '1', method: RequestMethod.ALL })`, () => {
+      return request(app.getHttpServer())
+        .get('/versioned')
+        .expect(200, VERSIONED_VALUE);
+    });
+  });
+
+  describe('when using CUSTOM TYPE versioning', () => {
+    beforeEach(async () => {
+      const extractor: CustomVersioningOptions['extractor'] = () => '1';
+
+      app = await createAppWithVersioning({
+        type: VersioningType.CUSTOM,
+        extractor,
+      });
+    });
+
+    it(`forRoutes({ path: '/versioned', version: '1', method: RequestMethod.ALL })`, () => {
+      return request(app.getHttpServer())
+        .get('/versioned')
+        .expect(200, VERSIONED_VALUE);
+    });
+  });
+
+  afterEach(async () => {
+    await app.close();
+  });
+});
+
+async function createAppWithVersioning(
+  versioningOptions: VersioningOptions,
+  beforeInit?: (app: INestApplication) => Promise<void>,
+): Promise<INestApplication> {
+  const app = (
+    await Test.createTestingModule({
+      imports: [TestModule],
+    }).compile()
+  ).createNestApplication();
+
+  app.enableVersioning(versioningOptions);
+  if (beforeInit) {
+    await beforeInit(app);
+  }
+  await app.init();
+
+  return app;
+}
diff --git a/integration/hello-world/e2e/middleware.spec.ts b/integration/hello-world/e2e/middleware.spec.ts
index d6347464f..4d0fb315b 100644
--- a/integration/hello-world/e2e/middleware.spec.ts
+++ b/integration/hello-world/e2e/middleware.spec.ts
@@ -7,11 +7,12 @@ import {
 } from '@nestjs/common';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 const RETURN_VALUE = 'test';
 const SCOPED_VALUE = 'test_scoped';
 const WILDCARD_VALUE = 'test_wildcard';
+const EXCLUDE_VALUE = 'test_exclude';
 
 @Controller()
 class TestController {
@@ -24,10 +25,15 @@ class TestController {
   wildcard_nested() {
     return RETURN_VALUE;
   }
+
+  @Get('exclude')
+  exclude() {
+    return EXCLUDE_VALUE;
+  }
 }
 
 @Module({
-  imports: [ApplicationModule],
+  imports: [AppModule],
   controllers: [TestController],
 })
 class TestModule {
@@ -36,8 +42,10 @@ class TestModule {
       .apply((req, res, next) => res.send(WILDCARD_VALUE))
       .forRoutes('tests/*')
       .apply((req, res, next) => res.send(SCOPED_VALUE))
+      .exclude('exclude')
       .forRoutes(TestController)
       .apply((req, res, next) => res.send(RETURN_VALUE))
+      .exclude('exclude')
       .forRoutes('*');
   }
 }
@@ -45,25 +53,34 @@ class TestModule {
 describe('Middleware', () => {
   let app: INestApplication;
 
-  beforeEach(async () => {
-    app = (
-      await Test.createTestingModule({
-        imports: [TestModule],
-      }).compile()
-    ).createNestApplication();
-
-    await app.init();
+  it(`forRoutes(*)`, async () => {
+    app = await createApp();
+    await request(app.getHttpServer()).get('/hello').expect(200, RETURN_VALUE);
+    await request(app.getHttpServer())
+      .get('/exclude')
+      .expect(200, EXCLUDE_VALUE);
   });
 
-  it(`forRoutes(*)`, () => {
-    return request(app.getHttpServer()).get('/hello').expect(200, RETURN_VALUE);
+  it(`forRoutes(*) with global prefix`, async () => {
+    app = await createApp(app => app.setGlobalPrefix('api'));
+    await request(app.getHttpServer())
+      .get('/api/hello')
+      .expect(200, RETURN_VALUE);
+    await request(app.getHttpServer())
+      .get('/api/exclude')
+      .expect(200, EXCLUDE_VALUE);
   });
 
-  it(`forRoutes(TestController)`, () => {
-    return request(app.getHttpServer()).get('/test').expect(200, SCOPED_VALUE);
+  it(`forRoutes(TestController)`, async () => {
+    app = await createApp();
+    await request(app.getHttpServer()).get('/test').expect(200, SCOPED_VALUE);
+    await request(app.getHttpServer())
+      .get('/exclude')
+      .expect(200, EXCLUDE_VALUE);
   });
 
-  it(`forRoutes(tests/*)`, () => {
+  it(`forRoutes(tests/*)`, async () => {
+    app = await createApp();
     return request(app.getHttpServer())
       .get('/tests/wildcard')
       .expect(200, WILDCARD_VALUE);
@@ -73,3 +90,20 @@ describe('Middleware', () => {
     await app.close();
   });
 });
+
+async function createApp(
+  beforeInit?: (app: INestApplication) => void,
+): Promise<INestApplication> {
+  const app = (
+    await Test.createTestingModule({
+      imports: [TestModule],
+    }).compile()
+  ).createNestApplication();
+
+  if (beforeInit) {
+    beforeInit(app);
+  }
+  await app.init();
+
+  return app;
+}
diff --git a/integration/hello-world/e2e/router-module-middleware.spec.ts b/integration/hello-world/e2e/router-module-middleware.spec.ts
index bc386e404..52fe55ced 100644
--- a/integration/hello-world/e2e/router-module-middleware.spec.ts
+++ b/integration/hello-world/e2e/router-module-middleware.spec.ts
@@ -8,7 +8,7 @@ import {
 import { RouterModule } from '@nestjs/core';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 const RETURN_VALUE = 'test';
 const SCOPED_VALUE = 'test_scoped';
@@ -27,7 +27,7 @@ class TestController {
 }
 
 @Module({
-  imports: [ApplicationModule],
+  imports: [AppModule],
   controllers: [TestController],
 })
 class TestModule {
diff --git a/integration/hello-world/src/app.module.ts b/integration/hello-world/src/app.module.ts
index 982d6c65f..b34bf1cfe 100644
--- a/integration/hello-world/src/app.module.ts
+++ b/integration/hello-world/src/app.module.ts
@@ -6,4 +6,4 @@ import { HostModule } from './host/host.module';
 @Module({
   imports: [HelloModule, HostModule, HostArrayModule],
 })
-export class ApplicationModule {}
+export class AppModule {}
diff --git a/integration/hello-world/src/errors/errors.controller.ts b/integration/hello-world/src/errors/errors.controller.ts
index 76f867bb7..7b2b9e1b8 100644
--- a/integration/hello-world/src/errors/errors.controller.ts
+++ b/integration/hello-world/src/errors/errors.controller.ts
@@ -1,4 +1,4 @@
-import { BadRequestException, Controller, Get } from '@nestjs/common';
+import { BadRequestException, Controller, Get, Header } from '@nestjs/common';
 
 @Controller()
 export class ErrorsController {
@@ -12,6 +12,12 @@ export class ErrorsController {
     this.throwError();
   }
 
+  @Get('unexpected-error')
+  @Header('Content-Type', 'application/pdf')
+  unexpectedError() {
+    throw new Error();
+  }
+
   throwError() {
     throw new BadRequestException({
       statusCode: 400,
diff --git a/integration/hello-world/tsconfig.json b/integration/hello-world/tsconfig.json
index c6354c564..cef623d14 100644
--- a/integration/hello-world/tsconfig.json
+++ b/integration/hello-world/tsconfig.json
@@ -7,10 +7,28 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
diff --git a/integration/hooks/tsconfig.json b/integration/hooks/tsconfig.json
index c6354c564..cef623d14 100644
--- a/integration/hooks/tsconfig.json
+++ b/integration/hooks/tsconfig.json
@@ -7,10 +7,28 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
diff --git a/integration/injector/e2e/injector.spec.ts b/integration/injector/e2e/injector.spec.ts
index 95208f618..5fd489676 100644
--- a/integration/injector/e2e/injector.spec.ts
+++ b/integration/injector/e2e/injector.spec.ts
@@ -1,7 +1,10 @@
 import { RuntimeException } from '@nestjs/core/errors/exceptions/runtime.exception';
+import { UnknownDependenciesException } from '@nestjs/core/errors/exceptions/unknown-dependencies.exception';
 import { UnknownExportException } from '@nestjs/core/errors/exceptions/unknown-export.exception';
 import { Test } from '@nestjs/testing';
 import { expect } from 'chai';
+import * as chai from 'chai';
+import * as chaiAsPromised from 'chai-as-promised';
 import {
   DYNAMIC_TOKEN,
   DYNAMIC_VALUE,
@@ -9,6 +12,13 @@ import {
 } from '../src/dynamic/dynamic.module';
 import { ExportsModule } from '../src/exports/exports.module';
 import { InjectModule } from '../src/inject/inject.module';
+import { InjectSameNameModule } from '../src/inject/inject-same-name.module';
+import {
+  SelfInjectionProviderModule,
+  SelfInjectionProviderCustomTokenModule,
+  SelfInjectionForwardProviderModule,
+} from '../src/self-injection/self-injection-provider.module';
+chai.use(chaiAsPromised);
 
 describe('Injector', () => {
   describe('when "providers" and "exports" properties are inconsistent', () => {
@@ -24,6 +34,16 @@ describe('Injector', () => {
     });
   });
 
+  describe("When class injects a provider with the same as class's name", () => {
+    it('should compile with success', async () => {
+      const builder = Test.createTestingModule({
+        imports: [InjectSameNameModule],
+      });
+
+      await expect(builder.compile()).to.eventually.be.fulfilled;
+    });
+  });
+
   describe('when Nest cannot resolve dependencies', () => {
     it(`should fail with "RuntimeException"`, async () => {
       try {
@@ -35,6 +55,42 @@ describe('Injector', () => {
         expect(err).to.be.instanceof(RuntimeException);
       }
     });
+
+    describe('due to self-injection providers', () => {
+      it('should fail with "UnknownDependenciesException" due to self-injection via same class reference', async () => {
+        const builder = Test.createTestingModule({
+          imports: [SelfInjectionProviderModule],
+        });
+
+        await expect(
+          builder.compile(),
+        ).to.eventually.be.rejected.and.be.an.instanceOf(
+          UnknownDependenciesException,
+        );
+      });
+      it('should fail with "UnknownDependenciesException" due to self-injection via forwardRef to the same class reference', async () => {
+        const builder = Test.createTestingModule({
+          imports: [SelfInjectionForwardProviderModule],
+        });
+
+        await expect(
+          builder.compile(),
+        ).to.eventually.be.rejected.and.be.an.instanceOf(
+          UnknownDependenciesException,
+        );
+      });
+      it('should fail with "UnknownDependenciesException" due to self-injection via custom provider', async () => {
+        const builder = Test.createTestingModule({
+          imports: [SelfInjectionProviderCustomTokenModule],
+        });
+
+        await expect(
+          builder.compile(),
+        ).to.eventually.be.rejected.and.be.an.instanceOf(
+          UnknownDependenciesException,
+        );
+      });
+    });
   });
 
   describe('when dynamic module', () => {
diff --git a/integration/injector/e2e/multiple-providers.spec.ts b/integration/injector/e2e/multiple-providers.spec.ts
new file mode 100644
index 000000000..26daa0e43
--- /dev/null
+++ b/integration/injector/e2e/multiple-providers.spec.ts
@@ -0,0 +1,47 @@
+import { Test } from '@nestjs/testing';
+import { expect } from 'chai';
+import { MultipleProvidersModule } from '../src/multiple-providers/multiple-providers.module';
+
+describe('Multiple providers under the same token ("each" feature)', () => {
+  describe('get()', () => {
+    it('should return an array of providers', async () => {
+      const builder = Test.createTestingModule({
+        imports: [MultipleProvidersModule],
+      });
+      const testingModule = await builder.compile();
+
+      const multiProviderInstances = testingModule.get<string>(
+        'MULTI_PROVIDER',
+        {
+          each: true,
+        },
+      );
+
+      // @ts-expect-error: make sure "multiProviderInstances" is string[] not string
+      multiProviderInstances.charAt;
+
+      expect(multiProviderInstances).to.be.eql(['A', 'B', 'C']);
+    });
+  });
+  describe('resolve()', () => {
+    it('should return an array of providers', async () => {
+      const builder = Test.createTestingModule({
+        imports: [MultipleProvidersModule],
+      });
+      const testingModule = await builder.compile();
+
+      const multiProviderInstances = await testingModule.resolve<string>(
+        'REQ_SCOPED_MULTI_PROVIDER',
+        undefined,
+        {
+          each: true,
+        },
+      );
+
+      // @ts-expect-error: make sure "multiProviderInstances" is string[] not string
+      multiProviderInstances.charAt;
+
+      expect(multiProviderInstances).to.be.eql(['A', 'B', 'C']);
+    });
+  });
+});
diff --git a/integration/injector/e2e/optional-factory-provider-dep.spec.ts b/integration/injector/e2e/optional-factory-provider-dep.spec.ts
new file mode 100644
index 000000000..d82f05136
--- /dev/null
+++ b/integration/injector/e2e/optional-factory-provider-dep.spec.ts
@@ -0,0 +1,134 @@
+import { Scope } from '@nestjs/common';
+import { UnknownDependenciesException } from '@nestjs/core/errors/exceptions/unknown-dependencies.exception';
+import { Test } from '@nestjs/testing';
+import { expect } from 'chai';
+
+describe('Optional factory provider deps', () => {
+  describe('when dependency is optional', () => {
+    describe('and it is available', () => {
+      it('then it should be injected into the factory function', async () => {
+        const defaultValue = 'DEFAULT_VALUE';
+        const moduleRef = await Test.createTestingModule({
+          providers: [
+            {
+              provide: 'FACTORY',
+              useFactory: dep => dep ?? defaultValue,
+              inject: [{ token: 'MISSING_DEP', optional: true }],
+            },
+            { provide: 'MISSING_DEP', useValue: 'OPTIONAL_DEP_VALUE' },
+          ],
+        }).compile();
+
+        const factoryProvider = moduleRef.get('FACTORY');
+        expect(factoryProvider).to.equal('OPTIONAL_DEP_VALUE');
+      });
+    });
+    describe('otherwise', () => {
+      it('"undefined" should be injected into the factory function', async () => {
+        const defaultValue = 'DEFAULT_VALUE';
+        const moduleRef = await Test.createTestingModule({
+          providers: [
+            {
+              provide: 'FACTORY',
+              useFactory: dep => dep ?? defaultValue,
+              inject: [{ token: 'MISSING_DEP', optional: true }],
+            },
+          ],
+        }).compile();
+
+        const factoryProvider = moduleRef.get('FACTORY');
+        expect(factoryProvider).to.equal(defaultValue);
+      });
+      it('"undefined" should be injected into the factory function (scoped provider)', async () => {
+        const MY_PROVIDER = 'MY_PROVIDER';
+        const FIRST_OPTIONAL_DEPENDENCY = 'FIRST_OPTIONAL_DEPENDENCY';
+        const SECOND_OPTIONAL_DEPENDENCY = 'SECOND_OPTIONAL_DEPENDENCY';
+
+        const module = await Test.createTestingModule({
+          providers: [
+            {
+              provide: SECOND_OPTIONAL_DEPENDENCY,
+              useValue: 'second',
+            },
+            {
+              provide: MY_PROVIDER,
+              scope: Scope.REQUEST,
+              inject: [
+                {
+                  token: FIRST_OPTIONAL_DEPENDENCY,
+                  optional: true,
+                },
+                {
+                  token: SECOND_OPTIONAL_DEPENDENCY,
+                  optional: true,
+                },
+              ],
+              useFactory: (first?: string, second?: string) => {
+                return { first, second };
+              },
+            },
+          ],
+        }).compile();
+
+        expect(await module.resolve(MY_PROVIDER)).to.deep.equal({
+          first: undefined,
+          second: 'second',
+        });
+      });
+    });
+  });
+  describe('otherwise', () => {
+    describe('and dependency is not registered', () => {
+      it('should error out', async () => {
+        try {
+          const builder = Test.createTestingModule({
+            providers: [
+              {
+                provide: 'FACTORY',
+                useFactory: () => 'RETURNED_VALUE',
+                inject: ['MISSING_DEP'],
+              },
+            ],
+          });
+          await builder.compile();
+        } catch (err) {
+          expect(err).to.be.instanceOf(UnknownDependenciesException);
+        }
+      });
+    });
+  });
+  describe('and dependency is registered but it cannot be instantiated', () => {
+    it('should error out', async () => {
+      try {
+        const builder = Test.createTestingModule({
+          providers: [
+            {
+              provide: 'POSSIBLY_MISSING_DEP',
+              useFactory: () => null,
+              inject: ['MISSING_DEP'],
+            },
+            {
+              provide: 'FACTORY',
+              useFactory: () => 'RETURNED_VALUE',
+              inject: [{ token: 'POSSIBLY_MISSING_DEP', optional: false }],
+            },
+          ],
+        });
+        await builder.compile();
+      } catch (err) {
+        expect(err).to.be.instanceOf(UnknownDependenciesException);
+        expect(err.message).to
+          .equal(`Nest can't resolve dependencies of the POSSIBLY_MISSING_DEP (?). Please make sure that the argument MISSING_DEP at index [0] is available in the RootTestModule context.
+
+Potential solutions:
+- Is RootTestModule a valid NestJS module?
+- If MISSING_DEP is a provider, is it part of the current RootTestModule?
+- If MISSING_DEP is exported from a separate @Module, is that module imported within RootTestModule?
+  @Module({
+    imports: [ /* the Module containing MISSING_DEP */ ]
+  })
+`);
+      }
+    });
+  });
+});
diff --git a/integration/injector/src/inject/inject-same-name.module.ts b/integration/injector/src/inject/inject-same-name.module.ts
new file mode 100644
index 000000000..f66fd51a7
--- /dev/null
+++ b/integration/injector/src/inject/inject-same-name.module.ts
@@ -0,0 +1,16 @@
+import { Module, Injectable, Inject } from '@nestjs/common';
+
+@Injectable()
+class CoreService {
+  constructor(@Inject(CoreService.name) private readonly coreService: any) {}
+}
+
+@Module({
+  providers: [
+    {
+      provide: CoreService.name,
+      useValue: 'anything',
+    },
+  ],
+})
+export class InjectSameNameModule {}
diff --git a/integration/injector/src/multiple-providers/a.module.ts b/integration/injector/src/multiple-providers/a.module.ts
new file mode 100644
index 000000000..95ae5eea1
--- /dev/null
+++ b/integration/injector/src/multiple-providers/a.module.ts
@@ -0,0 +1,16 @@
+import { Module, Scope } from '@nestjs/common';
+
+@Module({
+  providers: [
+    {
+      provide: 'MULTI_PROVIDER',
+      useValue: 'A',
+    },
+    {
+      provide: 'REQ_SCOPED_MULTI_PROVIDER',
+      useFactory: () => 'A',
+      scope: Scope.REQUEST,
+    },
+  ],
+})
+export class AModule {}
diff --git a/integration/injector/src/multiple-providers/b.module.ts b/integration/injector/src/multiple-providers/b.module.ts
new file mode 100644
index 000000000..1ed8ac423
--- /dev/null
+++ b/integration/injector/src/multiple-providers/b.module.ts
@@ -0,0 +1,16 @@
+import { Module, Scope } from '@nestjs/common';
+
+@Module({
+  providers: [
+    {
+      provide: 'MULTI_PROVIDER',
+      useValue: 'B',
+    },
+    {
+      provide: 'REQ_SCOPED_MULTI_PROVIDER',
+      useFactory: () => 'B',
+      scope: Scope.REQUEST,
+    },
+  ],
+})
+export class BModule {}
diff --git a/integration/injector/src/multiple-providers/c.module.ts b/integration/injector/src/multiple-providers/c.module.ts
new file mode 100644
index 000000000..4def2a71a
--- /dev/null
+++ b/integration/injector/src/multiple-providers/c.module.ts
@@ -0,0 +1,16 @@
+import { Module, Scope } from '@nestjs/common';
+
+@Module({
+  providers: [
+    {
+      provide: 'MULTI_PROVIDER',
+      useValue: 'C',
+    },
+    {
+      provide: 'REQ_SCOPED_MULTI_PROVIDER',
+      useFactory: () => 'C',
+      scope: Scope.REQUEST,
+    },
+  ],
+})
+export class CModule {}
diff --git a/integration/injector/src/multiple-providers/multiple-providers.module.ts b/integration/injector/src/multiple-providers/multiple-providers.module.ts
new file mode 100644
index 000000000..1bb2345ee
--- /dev/null
+++ b/integration/injector/src/multiple-providers/multiple-providers.module.ts
@@ -0,0 +1,9 @@
+import { Module } from '@nestjs/common';
+import { AModule } from './a.module';
+import { BModule } from './b.module';
+import { CModule } from './c.module';
+
+@Module({
+  imports: [AModule, BModule, CModule],
+})
+export class MultipleProvidersModule {}
diff --git a/integration/injector/src/self-injection/self-injection-provider.module.ts b/integration/injector/src/self-injection/self-injection-provider.module.ts
new file mode 100644
index 000000000..1dcf6eecb
--- /dev/null
+++ b/integration/injector/src/self-injection/self-injection-provider.module.ts
@@ -0,0 +1,40 @@
+import { Module, Injectable, Inject, forwardRef } from '@nestjs/common';
+
+@Injectable()
+class ServiceInjectingItself {
+  constructor(private readonly coreService: ServiceInjectingItself) {}
+}
+
+@Injectable()
+class ServiceInjectingItselfForward {
+  constructor(
+    @Inject(forwardRef(() => ServiceInjectingItself))
+    private readonly coreService: ServiceInjectingItself,
+  ) {}
+}
+
+@Injectable()
+class ServiceInjectingItselfViaCustomToken {
+  constructor(@Inject('AnotherToken') private readonly coreService: any) {}
+}
+
+@Module({
+  providers: [ServiceInjectingItself],
+})
+export class SelfInjectionProviderModule {}
+
+@Module({
+  providers: [ServiceInjectingItselfForward],
+})
+export class SelfInjectionForwardProviderModule {}
+
+@Module({
+  providers: [
+    ServiceInjectingItselfViaCustomToken,
+    {
+      provide: 'AnotherToken',
+      useClass: ServiceInjectingItselfViaCustomToken,
+    },
+  ],
+})
+export class SelfInjectionProviderCustomTokenModule {}
diff --git a/integration/injector/tsconfig.json b/integration/injector/tsconfig.json
index c6354c564..cef623d14 100644
--- a/integration/injector/tsconfig.json
+++ b/integration/injector/tsconfig.json
@@ -7,10 +7,28 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
diff --git a/integration/inspector/e2e/fixtures/post-init-graph.json b/integration/inspector/e2e/fixtures/post-init-graph.json
new file mode 100644
index 000000000..36ca478b2
--- /dev/null
+++ b/integration/inspector/e2e/fixtures/post-init-graph.json
@@ -0,0 +1,3171 @@
+{
+  "nodes": {
+    "18347652": {
+      "id": "18347652",
+      "label": "LoggingInterceptor",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "injectable",
+        "internal": false,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "LoggingInterceptor",
+        "subtype": "interceptor",
+        "initTime": 0
+      }
+    },
+    "55510001": {
+      "id": "55510001",
+      "label": "UsersService",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "UsersService",
+        "initTime": 0
+      }
+    },
+    "91819333": {
+      "id": "91819333",
+      "label": "ModuleRef",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "203550704": {
+      "id": "203550704",
+      "label": "ExternalContextCreator",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": true,
+        "token": "ExternalContextCreator"
+      }
+    },
+    "208171089": {
+      "id": "208171089",
+      "label": "RolesGuard",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "injectable",
+        "internal": false,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "RolesGuard",
+        "subtype": "guard",
+        "initTime": 0
+      }
+    },
+    "225063248": {
+      "id": "225063248",
+      "label": "InternalCoreModule",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "InternalCoreModule",
+        "initTime": 0
+      }
+    },
+    "256260345": {
+      "id": "256260345",
+      "label": "ApplicationConfig",
+      "parent": "1528017428",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DatabaseModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "345516396": {
+      "id": "345516396",
+      "label": "ApplicationConfig",
+      "parent": "1142369607",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelperModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "345719894": {
+      "id": "345719894",
+      "label": "CoreModule",
+      "parent": "-1125887048",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "CoreModule",
+        "initTime": 0
+      }
+    },
+    "437945905": {
+      "id": "437945905",
+      "label": "ApplicationConfig",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "519735830": {
+      "id": "519735830",
+      "label": "ApplicationConfig",
+      "parent": "-493958991",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ChatModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "521671888": {
+      "id": "521671888",
+      "label": "DogsModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "555176277": {
+      "id": "555176277",
+      "label": "InternalCoreModule",
+      "metadata": {
+        "type": "module",
+        "global": true,
+        "dynamic": true,
+        "internal": true
+      }
+    },
+    "594986539": {
+      "id": "594986539",
+      "label": "InputService",
+      "parent": "-1813741655",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "InputModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": true,
+        "token": "InputService",
+        "initTime": 0
+      }
+    },
+    "603011239": {
+      "id": "603011239",
+      "label": "UsersService",
+      "parent": "-2003726489",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "UsersModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "UsersService",
+        "initTime": 0
+      }
+    },
+    "671882984": {
+      "id": "671882984",
+      "label": "Reflector",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": true,
+        "token": "Reflector",
+        "initTime": 0
+      }
+    },
+    "791004148": {
+      "id": "791004148",
+      "label": "ExternalSvcModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "867482265": {
+      "id": "867482265",
+      "label": "Interceptor",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "injectable",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "Interceptor",
+        "subtype": "interceptor",
+        "initTime": 0
+      }
+    },
+    "927096496": {
+      "id": "927096496",
+      "label": "ApplicationConfig",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "928565345": {
+      "id": "928565345",
+      "label": "HelperService",
+      "parent": "1142369607",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "HelperModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": true,
+        "token": "HelperService",
+        "initTime": 0
+      }
+    },
+    "941957564": {
+      "id": "941957564",
+      "label": "RequestChainModule",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "RequestChainModule",
+        "initTime": 0
+      }
+    },
+    "980514911": {
+      "id": "980514911",
+      "label": "Symbol(token)",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "Symbol(token)"
+      }
+    },
+    "1004276345": {
+      "id": "1004276345",
+      "label": "Meta",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "META",
+        "initTime": 0
+      }
+    },
+    "1010833816": {
+      "id": "1010833816",
+      "label": "token",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "token"
+      }
+    },
+    "1047229654": {
+      "id": "1047229654",
+      "label": "CircularModule",
+      "parent": "-369869768",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CircularModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "CircularModule",
+        "initTime": 0
+      }
+    },
+    "1074192353": {
+      "id": "1074192353",
+      "label": "ChatService",
+      "parent": "-493958991",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "ChatModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "ChatService",
+        "initTime": 0
+      }
+    },
+    "1120316353": {
+      "id": "1120316353",
+      "label": "ModuleRef",
+      "parent": "1142369607",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelperModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "1131051184": {
+      "id": "1131051184",
+      "label": "ChatGateway",
+      "parent": "-493958991",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "ChatModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "ChatGateway",
+        "initTime": 0
+      }
+    },
+    "1142369607": {
+      "id": "1142369607",
+      "label": "HelperModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "1189153544": {
+      "id": "1189153544",
+      "label": "ChatModule",
+      "parent": "-493958991",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ChatModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ChatModule",
+        "initTime": 0
+      }
+    },
+    "1253818496": {
+      "id": "1253818496",
+      "label": "RootTestModule",
+      "parent": "-1251270035",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RootTestModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "RootTestModule",
+        "initTime": 0
+      }
+    },
+    "1433815174": {
+      "id": "1433815174",
+      "label": "DogsModule",
+      "parent": "521671888",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DogsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "DogsModule",
+        "initTime": 0
+      }
+    },
+    "1434441974": {
+      "id": "1434441974",
+      "label": "CatsModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "1434456218": {
+      "id": "1434456218",
+      "label": "Reflector",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": true,
+        "token": "Reflector",
+        "initTime": 0
+      }
+    },
+    "1472486160": {
+      "id": "1472486160",
+      "label": "HelloController",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "HelloController",
+        "initTime": 0,
+        "enhancers": [
+          {
+            "id": "-2010060263",
+            "methodKey": "greeting",
+            "subtype": "guard"
+          },
+          {
+            "id": "867482265",
+            "methodKey": "greeting",
+            "subtype": "interceptor"
+          },
+          {
+            "id": "1893794611",
+            "methodKey": "greeting",
+            "subtype": "pipe"
+          }
+        ]
+      }
+    },
+    "1528017428": {
+      "id": "1528017428",
+      "label": "DatabaseModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "1535366709": {
+      "id": "1535366709",
+      "label": "ApplicationConfig",
+      "parent": "521671888",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DogsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "1551182002": {
+      "id": "1551182002",
+      "label": "ModuleRef",
+      "parent": "-1125887048",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "1616075090": {
+      "id": "1616075090",
+      "label": "CatsModule",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "CatsModule",
+        "initTime": 0
+      }
+    },
+    "1634859874": {
+      "id": "1634859874",
+      "label": "LoggerMiddleware",
+      "parent": "-1125887048",
+      "metadata": {
+        "type": "middleware",
+        "internal": false,
+        "sourceModuleName": "CoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "LoggerMiddleware",
+        "initTime": 0
+      }
+    },
+    "1743739569": {
+      "id": "1743739569",
+      "label": "HelloModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": true,
+        "internal": false
+      }
+    },
+    "1771940178": {
+      "id": "1771940178",
+      "label": "ApplicationConfig",
+      "parent": "-1251270035",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RootTestModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "1809676814": {
+      "id": "1809676814",
+      "label": "ModuleRef",
+      "parent": "1528017428",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DatabaseModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "1893794611": {
+      "id": "1893794611",
+      "label": "UserByIdPipe",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "injectable",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "UserByIdPipe",
+        "subtype": "pipe",
+        "initTime": 0
+      }
+    },
+    "1919157847": {
+      "id": "1919157847",
+      "label": "REQUEST",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": true,
+        "token": "REQUEST",
+        "initTime": 0
+      }
+    },
+    "2018972420": {
+      "id": "2018972420",
+      "label": "TransformInterceptor",
+      "parent": "-1125887048",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "CoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "APP_INTERCEPTOR (UUID: -1146749753)",
+        "subtype": "interceptor",
+        "initTime": 0,
+        "global": true
+      }
+    },
+    "2133316171": {
+      "id": "2133316171",
+      "label": "RequestChainModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-1486320561": {
+      "id": "-1486320561",
+      "label": "ModuleRef",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-651043398": {
+      "id": "-651043398",
+      "label": "ApplicationConfig",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-255469305": {
+      "id": "-255469305",
+      "label": "INQUIRER",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 1,
+        "transient": true,
+        "exported": true,
+        "token": "INQUIRER",
+        "initTime": 0
+      }
+    },
+    "-26938366": {
+      "id": "-26938366",
+      "label": "ModulesContainer",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": true,
+        "token": "ModulesContainer"
+      }
+    },
+    "-326832201": {
+      "id": "-326832201",
+      "label": "HttpAdapterHost",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": true,
+        "token": "HttpAdapterHost"
+      }
+    },
+    "-553129559": {
+      "id": "-553129559",
+      "label": "HttpAdapterHost",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": true,
+        "token": "HttpAdapterHost",
+        "initTime": 0
+      }
+    },
+    "-702581189": {
+      "id": "-702581189",
+      "label": "LazyModuleLoader",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": true,
+        "token": "LazyModuleLoader",
+        "initTime": 0
+      }
+    },
+    "-1904419534": {
+      "id": "-1904419534",
+      "label": "SerializedGraph",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": true,
+        "token": "SerializedGraph"
+      }
+    },
+    "-1251270035": {
+      "id": "-1251270035",
+      "label": "RootTestModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-969610649": {
+      "id": "-969610649",
+      "label": "ModuleRef",
+      "parent": "-1251270035",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RootTestModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-19112576": {
+      "id": "-19112576",
+      "label": "AppModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-2139588960": {
+      "id": "-2139588960",
+      "label": "AppModule",
+      "parent": "-19112576",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "AppModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "AppModule",
+        "initTime": 0
+      }
+    },
+    "-71302842": {
+      "id": "-71302842",
+      "label": "ModuleRef",
+      "parent": "-19112576",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "AppModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-2064622725": {
+      "id": "-2064622725",
+      "label": "ApplicationConfig",
+      "parent": "-19112576",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "AppModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-365265483": {
+      "id": "-365265483",
+      "label": "AppV1Controller",
+      "parent": "-19112576",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "AppModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "AppV1Controller",
+        "initTime": 0
+      }
+    },
+    "-774089708": {
+      "id": "-774089708",
+      "label": "AppV2Controller",
+      "parent": "-19112576",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "AppModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "AppV2Controller",
+        "initTime": 0
+      }
+    },
+    "-1125887048": {
+      "id": "-1125887048",
+      "label": "CoreModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-112192227": {
+      "id": "-112192227",
+      "label": "ApplicationConfig",
+      "parent": "-1125887048",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-2007711503": {
+      "id": "-2007711503",
+      "label": "LoggingInterceptor",
+      "parent": "-1125887048",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "CoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "APP_INTERCEPTOR (UUID: 1780085433)",
+        "subtype": "interceptor",
+        "initTime": 0,
+        "global": true
+      }
+    },
+    "-183456272": {
+      "id": "-183456272",
+      "label": "ModuleRef",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-1846830501": {
+      "id": "-1846830501",
+      "label": "ApplicationConfig",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-593595711": {
+      "id": "-593595711",
+      "label": "CatsService",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "CatsService",
+        "initTime": 0
+      }
+    },
+    "-1550892030": {
+      "id": "-1550892030",
+      "label": "CatsController",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "CatsController",
+        "initTime": 0,
+        "enhancers": [
+          {
+            "id": "208171089",
+            "subtype": "guard"
+          },
+          {
+            "name": "ParseIntPipe",
+            "methodKey": "findOne",
+            "subtype": "pipe"
+          }
+        ]
+      }
+    },
+    "-1378706112": {
+      "id": "-1378706112",
+      "label": "HelloModule",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "HelloModule",
+        "initTime": 0
+      }
+    },
+    "-1166465801": {
+      "id": "-1166465801",
+      "label": "ModuleRef",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-1191459348": {
+      "id": "-1191459348",
+      "label": "ApplicationConfig",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-1758187461": {
+      "id": "-1758187461",
+      "label": "HelloService",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "HelloService",
+        "initTime": 0
+      }
+    },
+    "-2010060263": {
+      "id": "-2010060263",
+      "label": "Guard",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "injectable",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "Guard",
+        "subtype": "guard",
+        "initTime": 0
+      }
+    },
+    "-1124392646": {
+      "id": "-1124392646",
+      "label": "DurableModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-522935456": {
+      "id": "-522935456",
+      "label": "DurableModule",
+      "parent": "-1124392646",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DurableModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "DurableModule",
+        "initTime": 0
+      }
+    },
+    "-1808043520": {
+      "id": "-1808043520",
+      "label": "ModuleRef",
+      "parent": "-1124392646",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DurableModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-57038411": {
+      "id": "-57038411",
+      "label": "ApplicationConfig",
+      "parent": "-1124392646",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DurableModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-1673986099": {
+      "id": "-1673986099",
+      "label": "DurableService",
+      "parent": "-1124392646",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "DurableModule",
+        "durable": true,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "DurableService",
+        "initTime": 0
+      }
+    },
+    "-848516688": {
+      "id": "-848516688",
+      "label": "DurableController",
+      "parent": "-1124392646",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "DurableModule",
+        "durable": true,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "DurableController",
+        "initTime": 0
+      }
+    },
+    "-1096226358": {
+      "id": "-1096226358",
+      "label": "ModuleRef",
+      "parent": "521671888",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DogsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-335387007": {
+      "id": "-335387007",
+      "label": "DogsService",
+      "parent": "521671888",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "DogsModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "DogsService",
+        "initTime": 0
+      }
+    },
+    "-1558907338": {
+      "id": "-1558907338",
+      "label": "DogsController",
+      "parent": "521671888",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "DogsModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "DogsController",
+        "initTime": 0
+      }
+    },
+    "-2003726489": {
+      "id": "-2003726489",
+      "label": "UsersModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-495603840": {
+      "id": "-495603840",
+      "label": "UsersModule",
+      "parent": "-2003726489",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "UsersModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "UsersModule",
+        "initTime": 0
+      }
+    },
+    "-618964563": {
+      "id": "-618964563",
+      "label": "ModuleRef",
+      "parent": "-2003726489",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "UsersModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-643958110": {
+      "id": "-643958110",
+      "label": "ApplicationConfig",
+      "parent": "-2003726489",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "UsersModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-1102473136": {
+      "id": "-1102473136",
+      "label": "UsersController",
+      "parent": "-2003726489",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "UsersModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "UsersController",
+        "initTime": 0
+      }
+    },
+    "-1098322034": {
+      "id": "-1098322034",
+      "label": "DatabaseModule",
+      "parent": "1528017428",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DatabaseModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "DatabaseModule",
+        "initTime": 0
+      }
+    },
+    "-616397055": {
+      "id": "-616397055",
+      "label": "DatabaseService",
+      "parent": "1528017428",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "DatabaseModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "DatabaseService",
+        "initTime": 0
+      }
+    },
+    "-377928898": {
+      "id": "-377928898",
+      "label": "DatabaseController",
+      "parent": "1528017428",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "DatabaseModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "DatabaseController",
+        "initTime": 0
+      }
+    },
+    "-511735264": {
+      "id": "-511735264",
+      "label": "ExternalSvcModule",
+      "parent": "791004148",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ExternalSvcModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ExternalSvcModule",
+        "initTime": 0
+      }
+    },
+    "-660323910": {
+      "id": "-660323910",
+      "label": "ModuleRef",
+      "parent": "791004148",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ExternalSvcModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-217737489": {
+      "id": "-217737489",
+      "label": "ApplicationConfig",
+      "parent": "791004148",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ExternalSvcModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-1902429503": {
+      "id": "-1902429503",
+      "label": "ExternalSvcService",
+      "parent": "791004148",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "ExternalSvcModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "ExternalSvcService",
+        "initTime": 0
+      }
+    },
+    "-349899408": {
+      "id": "-349899408",
+      "label": "ExternalSvcController",
+      "parent": "791004148",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "ExternalSvcModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "ExternalSvcController",
+        "initTime": 0
+      }
+    },
+    "-493958991": {
+      "id": "-493958991",
+      "label": "ChatModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-2111857237": {
+      "id": "-2111857237",
+      "label": "ModuleRef",
+      "parent": "-493958991",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ChatModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-234035039": {
+      "id": "-234035039",
+      "label": "RequestChainService",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "RequestChainService",
+        "initTime": 0
+      }
+    },
+    "-1927427604": {
+      "id": "-1927427604",
+      "label": "RequestChainController",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "RequestChainController",
+        "initTime": 0,
+        "enhancers": [
+          {
+            "id": "18347652",
+            "methodKey": "greeting",
+            "subtype": "interceptor"
+          }
+        ]
+      }
+    },
+    "-162987852": {
+      "id": "-162987852",
+      "label": "HelperModule",
+      "parent": "1142369607",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelperModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "HelperModule",
+        "initTime": 0
+      }
+    },
+    "-1469176692": {
+      "id": "-1469176692",
+      "label": "PropertiesModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-1501313730": {
+      "id": "-1501313730",
+      "label": "PropertiesModule",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "PropertiesModule",
+        "initTime": 0
+      }
+    },
+    "-1377446394": {
+      "id": "-1377446394",
+      "label": "ModuleRef",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-1494077847": {
+      "id": "-1494077847",
+      "label": "DependencyService",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "DependencyService",
+        "initTime": 0
+      }
+    },
+    "-1803759743": {
+      "id": "-1803759743",
+      "label": "PropertiesService",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "PropertiesService",
+        "initTime": 0
+      }
+    },
+    "-1813741655": {
+      "id": "-1813741655",
+      "label": "InputModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-2113121728": {
+      "id": "-2113121728",
+      "label": "InputModule",
+      "parent": "-1813741655",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InputModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "InputModule",
+        "initTime": 0
+      }
+    },
+    "-428979729": {
+      "id": "-428979729",
+      "label": "ModuleRef",
+      "parent": "-1813741655",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InputModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-453973276": {
+      "id": "-453973276",
+      "label": "ApplicationConfig",
+      "parent": "-1813741655",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InputModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-369869768": {
+      "id": "-369869768",
+      "label": "CircularModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-88210382": {
+      "id": "-88210382",
+      "label": "ModuleRef",
+      "parent": "-369869768",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CircularModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-1641626851": {
+      "id": "-1641626851",
+      "label": "ApplicationConfig",
+      "parent": "-369869768",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CircularModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-1721730431": {
+      "id": "-1721730431",
+      "label": "CircularService",
+      "parent": "-369869768",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "CircularModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": true,
+        "token": "CircularService",
+        "initTime": 0
+      }
+    }
+  },
+  "edges": {
+    "22193019": {
+      "source": "-19112576",
+      "target": "521671888",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "DogsModule"
+      },
+      "id": "22193019"
+    },
+    "33333764": {
+      "source": "791004148",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "ExternalSvcModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "33333764"
+    },
+    "40501732": {
+      "source": "521671888",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "DogsModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "40501732"
+    },
+    "73947303": {
+      "source": "-1813741655",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "InputModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "73947303"
+    },
+    "182501115": {
+      "source": "1434441974",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "CatsModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "182501115"
+    },
+    "189694679": {
+      "source": "1434456218",
+      "target": "671882984",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "InternalCoreModule",
+        "sourceClassName": "Reflector",
+        "targetClassName": "Reflector",
+        "sourceClassToken": "Reflector",
+        "targetClassToken": "Reflector",
+        "targetModuleName": "InternalCoreModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor",
+        "internal": true
+      },
+      "id": "189694679"
+    },
+    "231469845": {
+      "source": "-1803759743",
+      "target": "-1494077847",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "PropertiesModule",
+        "sourceClassName": "PropertiesService",
+        "targetClassName": "DependencyService",
+        "sourceClassToken": "PropertiesService",
+        "targetClassToken": "DependencyService",
+        "targetModuleName": "PropertiesModule",
+        "keyOrIndex": "service",
+        "injectionType": "property"
+      },
+      "id": "231469845"
+    },
+    "250652665": {
+      "source": "2133316171",
+      "target": "1142369607",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "RequestChainModule",
+        "targetModuleName": "HelperModule"
+      },
+      "id": "250652665"
+    },
+    "393939926": {
+      "source": "-1813741655",
+      "target": "-369869768",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "InputModule",
+        "targetModuleName": "CircularModule"
+      },
+      "id": "393939926"
+    },
+    "417363164": {
+      "source": "-1251270035",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "RootTestModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "417363164"
+    },
+    "469401997": {
+      "source": "-493958991",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "ChatModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "469401997"
+    },
+    "654001290": {
+      "source": "1472486160",
+      "target": "867482265",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloController",
+        "targetClassName": "Interceptor",
+        "sourceClassToken": "HelloController",
+        "targetClassToken": "Interceptor",
+        "targetModuleName": "HelloModule",
+        "injectionType": "decorator"
+      },
+      "id": "654001290"
+    },
+    "676175891": {
+      "source": "-1251270035",
+      "target": "-19112576",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "RootTestModule",
+        "targetModuleName": "AppModule"
+      },
+      "id": "676175891"
+    },
+    "800268760": {
+      "source": "-1102473136",
+      "target": "603011239",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "UsersModule",
+        "sourceClassName": "UsersController",
+        "targetClassName": "UsersService",
+        "sourceClassToken": "UsersController",
+        "targetClassToken": "UsersService",
+        "targetModuleName": "UsersModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "800268760"
+    },
+    "804987620": {
+      "source": "-19112576",
+      "target": "-1125887048",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "CoreModule"
+      },
+      "id": "804987620"
+    },
+    "807697929": {
+      "source": "-19112576",
+      "target": "1528017428",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "DatabaseModule"
+      },
+      "id": "807697929"
+    },
+    "966350248": {
+      "source": "1131051184",
+      "target": "1074192353",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "ChatModule",
+        "sourceClassName": "ChatGateway",
+        "targetClassName": "ChatService",
+        "sourceClassToken": "ChatGateway",
+        "targetClassToken": "ChatService",
+        "targetModuleName": "ChatModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "966350248"
+    },
+    "987755577": {
+      "source": "-2003726489",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "UsersModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "987755577"
+    },
+    "1056428433": {
+      "source": "-19112576",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "1056428433"
+    },
+    "1059069749": {
+      "source": "-1558907338",
+      "target": "-335387007",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "DogsModule",
+        "sourceClassName": "DogsController",
+        "targetClassName": "DogsService",
+        "sourceClassToken": "DogsController",
+        "targetClassToken": "DogsService",
+        "targetModuleName": "DogsModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1059069749"
+    },
+    "1142343545": {
+      "source": "-1758187461",
+      "target": "1004276345",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloService",
+        "targetClassName": "Meta",
+        "sourceClassToken": "HelloService",
+        "targetClassToken": "META",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1142343545"
+    },
+    "1178436405": {
+      "source": "1893794611",
+      "target": "55510001",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "UserByIdPipe",
+        "targetClassName": "UsersService",
+        "sourceClassToken": "UserByIdPipe",
+        "targetClassToken": "UsersService",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1178436405"
+    },
+    "1195474320": {
+      "source": "-369869768",
+      "target": "-1813741655",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "CircularModule",
+        "targetModuleName": "InputModule"
+      },
+      "id": "1195474320"
+    },
+    "1247743823": {
+      "source": "2133316171",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "RequestChainModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "1247743823"
+    },
+    "1325313063": {
+      "source": "-1927427604",
+      "target": "18347652",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "RequestChainModule",
+        "sourceClassName": "RequestChainController",
+        "targetClassName": "LoggingInterceptor",
+        "sourceClassToken": "RequestChainController",
+        "targetClassToken": "LoggingInterceptor",
+        "targetModuleName": "RequestChainModule",
+        "injectionType": "decorator"
+      },
+      "id": "1325313063"
+    },
+    "1497653915": {
+      "source": "55510001",
+      "target": "1004276345",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "UsersService",
+        "targetClassName": "Meta",
+        "sourceClassToken": "UsersService",
+        "targetClassToken": "META",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1497653915"
+    },
+    "1615322974": {
+      "source": "-1469176692",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "PropertiesModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "1615322974"
+    },
+    "1856016815": {
+      "source": "-1721730431",
+      "target": "594986539",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "CircularModule",
+        "sourceClassName": "CircularService",
+        "targetClassName": "InputService",
+        "sourceClassToken": "CircularService",
+        "targetClassToken": "InputService",
+        "targetModuleName": "InputModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1856016815"
+    },
+    "1900414743": {
+      "source": "1472486160",
+      "target": "1893794611",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloController",
+        "targetClassName": "UserByIdPipe",
+        "sourceClassToken": "HelloController",
+        "targetClassToken": "UserByIdPipe",
+        "targetModuleName": "HelloModule",
+        "injectionType": "decorator"
+      },
+      "id": "1900414743"
+    },
+    "1904579661": {
+      "source": "18347652",
+      "target": "928565345",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "RequestChainModule",
+        "sourceClassName": "LoggingInterceptor",
+        "targetClassName": "HelperService",
+        "sourceClassToken": "LoggingInterceptor",
+        "targetClassToken": "HelperService",
+        "targetModuleName": "HelperModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1904579661"
+    },
+    "1960203007": {
+      "source": "-1803759743",
+      "target": "980514911",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "PropertiesModule",
+        "sourceClassName": "PropertiesService",
+        "targetClassName": "Symbol(token)",
+        "sourceClassToken": "PropertiesService",
+        "targetClassToken": "Symbol(token)",
+        "targetModuleName": "PropertiesModule",
+        "keyOrIndex": "symbolToken",
+        "injectionType": "property"
+      },
+      "id": "1960203007"
+    },
+    "1976848738": {
+      "source": "1528017428",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "DatabaseModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "1976848738"
+    },
+    "-1759625292": {
+      "source": "-553129559",
+      "target": "-326832201",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "InternalCoreModule",
+        "sourceClassName": "HttpAdapterHost",
+        "targetClassName": "HttpAdapterHost",
+        "sourceClassToken": "HttpAdapterHost",
+        "targetClassToken": "HttpAdapterHost",
+        "targetModuleName": "InternalCoreModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor",
+        "internal": true
+      },
+      "id": "-1759625292"
+    },
+    "-2105726668": {
+      "source": "-1803759743",
+      "target": "1010833816",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "PropertiesModule",
+        "sourceClassName": "PropertiesService",
+        "targetClassName": "token",
+        "sourceClassToken": "PropertiesService",
+        "targetClassToken": "token",
+        "targetModuleName": "PropertiesModule",
+        "keyOrIndex": "token",
+        "injectionType": "property"
+      },
+      "id": "-2105726668"
+    },
+    "-21463590": {
+      "source": "-1378706112",
+      "target": "1004276345",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloModule",
+        "targetClassName": "Meta",
+        "sourceClassToken": "HelloModule",
+        "targetClassToken": "META",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-21463590"
+    },
+    "-1657371464": {
+      "source": "-1673986099",
+      "target": "1919157847",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "DurableModule",
+        "sourceClassName": "DurableService",
+        "targetClassName": "REQUEST",
+        "sourceClassToken": "DurableService",
+        "targetClassToken": "REQUEST",
+        "targetModuleName": "InternalCoreModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor",
+        "internal": true
+      },
+      "id": "-1657371464"
+    },
+    "-1303681274": {
+      "source": "928565345",
+      "target": "1919157847",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelperModule",
+        "sourceClassName": "HelperService",
+        "targetClassName": "REQUEST",
+        "sourceClassToken": "HelperService",
+        "targetClassToken": "REQUEST",
+        "targetModuleName": "InternalCoreModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor",
+        "internal": true
+      },
+      "id": "-1303681274"
+    },
+    "-886102564": {
+      "source": "208171089",
+      "target": "671882984",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "CatsModule",
+        "sourceClassName": "RolesGuard",
+        "targetClassName": "Reflector",
+        "sourceClassToken": "RolesGuard",
+        "targetClassToken": "Reflector",
+        "targetModuleName": "InternalCoreModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor",
+        "internal": true
+      },
+      "id": "-886102564"
+    },
+    "-2003045613": {
+      "source": "-377928898",
+      "target": "-616397055",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "DatabaseModule",
+        "sourceClassName": "DatabaseController",
+        "targetClassName": "DatabaseService",
+        "sourceClassToken": "DatabaseController",
+        "targetClassToken": "DatabaseService",
+        "targetModuleName": "DatabaseModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-2003045613"
+    },
+    "-881420795": {
+      "source": "-349899408",
+      "target": "-1902429503",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "ExternalSvcModule",
+        "sourceClassName": "ExternalSvcController",
+        "targetClassName": "ExternalSvcService",
+        "sourceClassToken": "ExternalSvcController",
+        "targetClassToken": "ExternalSvcService",
+        "targetModuleName": "ExternalSvcModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-881420795"
+    },
+    "-831049991": {
+      "source": "594986539",
+      "target": "-1721730431",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "InputModule",
+        "sourceClassName": "InputService",
+        "targetClassName": "CircularService",
+        "sourceClassToken": "InputService",
+        "targetClassToken": "CircularService",
+        "targetModuleName": "CircularModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-831049991"
+    },
+    "-2146943494": {
+      "source": "-234035039",
+      "target": "928565345",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "RequestChainModule",
+        "sourceClassName": "RequestChainService",
+        "targetClassName": "HelperService",
+        "sourceClassToken": "RequestChainService",
+        "targetClassToken": "HelperService",
+        "targetModuleName": "HelperModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-2146943494"
+    },
+    "-1816180282": {
+      "source": "-848516688",
+      "target": "-1673986099",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "DurableModule",
+        "sourceClassName": "DurableController",
+        "targetClassName": "DurableService",
+        "sourceClassToken": "DurableController",
+        "targetClassToken": "DurableService",
+        "targetModuleName": "DurableModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-1816180282"
+    },
+    "-180350082": {
+      "source": "-1550892030",
+      "target": "-593595711",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "CatsModule",
+        "sourceClassName": "CatsController",
+        "targetClassName": "CatsService",
+        "sourceClassToken": "CatsController",
+        "targetClassToken": "CatsService",
+        "targetModuleName": "CatsModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-180350082"
+    },
+    "-1043628608": {
+      "source": "1472486160",
+      "target": "-1758187461",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloController",
+        "targetClassName": "HelloService",
+        "sourceClassToken": "HelloController",
+        "targetClassToken": "HelloService",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-1043628608"
+    },
+    "-1335121169": {
+      "source": "1472486160",
+      "target": "55510001",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloController",
+        "targetClassName": "UsersService",
+        "sourceClassToken": "HelloController",
+        "targetClassToken": "UsersService",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 1,
+        "injectionType": "constructor"
+      },
+      "id": "-1335121169"
+    },
+    "-296280311": {
+      "source": "-1927427604",
+      "target": "-234035039",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "RequestChainModule",
+        "sourceClassName": "RequestChainController",
+        "targetClassName": "RequestChainService",
+        "sourceClassToken": "RequestChainController",
+        "targetClassToken": "RequestChainService",
+        "targetModuleName": "RequestChainModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-296280311"
+    },
+    "-393224862": {
+      "source": "-19112576",
+      "target": "1434441974",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "CatsModule"
+      },
+      "id": "-393224862"
+    },
+    "-1675983900": {
+      "source": "-19112576",
+      "target": "1743739569",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "HelloModule"
+      },
+      "id": "-1675983900"
+    },
+    "-678699872": {
+      "source": "-19112576",
+      "target": "-1124392646",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "DurableModule"
+      },
+      "id": "-678699872"
+    },
+    "-158970266": {
+      "source": "-19112576",
+      "target": "-2003726489",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "UsersModule"
+      },
+      "id": "-158970266"
+    },
+    "-2086236431": {
+      "source": "-19112576",
+      "target": "791004148",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "ExternalSvcModule"
+      },
+      "id": "-2086236431"
+    },
+    "-192150092": {
+      "source": "-19112576",
+      "target": "-493958991",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "ChatModule"
+      },
+      "id": "-192150092"
+    },
+    "-1609022090": {
+      "source": "-19112576",
+      "target": "2133316171",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "RequestChainModule"
+      },
+      "id": "-1609022090"
+    },
+    "-773455435": {
+      "source": "-19112576",
+      "target": "-1469176692",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "PropertiesModule"
+      },
+      "id": "-773455435"
+    },
+    "-967144236": {
+      "source": "-19112576",
+      "target": "-1813741655",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "InputModule"
+      },
+      "id": "-967144236"
+    },
+    "-528424051": {
+      "source": "-1125887048",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "CoreModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "-528424051"
+    },
+    "-698929209": {
+      "source": "1743739569",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "HelloModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "-698929209"
+    },
+    "-1671708813": {
+      "source": "-1124392646",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "DurableModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "-1671708813"
+    },
+    "-665042842": {
+      "source": "1142369607",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "HelperModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "-665042842"
+    },
+    "-1891610441": {
+      "source": "-369869768",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "CircularModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "-1891610441"
+    },
+    "-878379437": {
+      "source": "-1550892030",
+      "target": "208171089",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "CatsModule",
+        "sourceClassName": "CatsController",
+        "targetClassName": "RolesGuard",
+        "sourceClassToken": "CatsController",
+        "targetClassToken": "RolesGuard",
+        "targetModuleName": "CatsModule",
+        "injectionType": "decorator"
+      },
+      "id": "-878379437"
+    },
+    "-822816169": {
+      "source": "1472486160",
+      "target": "-2010060263",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloController",
+        "targetClassName": "Guard",
+        "sourceClassToken": "HelloController",
+        "targetClassToken": "Guard",
+        "targetModuleName": "HelloModule",
+        "injectionType": "decorator"
+      },
+      "id": "-822816169"
+    }
+  },
+  "entrypoints": {
+    "1131051184": [
+      {
+        "type": "websocket",
+        "methodName": "create",
+        "className": "ChatGateway",
+        "classNodeId": "1131051184",
+        "metadata": {
+          "port": 0,
+          "key": "createChat",
+          "message": "createChat"
+        },
+        "id": "1131051184_create"
+      },
+      {
+        "type": "websocket",
+        "methodName": "findAll",
+        "className": "ChatGateway",
+        "classNodeId": "1131051184",
+        "metadata": {
+          "port": 0,
+          "key": "findAllChat",
+          "message": "findAllChat"
+        },
+        "id": "1131051184_findAll"
+      },
+      {
+        "type": "websocket",
+        "methodName": "findOne",
+        "className": "ChatGateway",
+        "classNodeId": "1131051184",
+        "metadata": {
+          "port": 0,
+          "key": "findOneChat",
+          "message": "findOneChat"
+        },
+        "id": "1131051184_findOne"
+      },
+      {
+        "type": "websocket",
+        "methodName": "update",
+        "className": "ChatGateway",
+        "classNodeId": "1131051184",
+        "metadata": {
+          "port": 0,
+          "key": "updateChat",
+          "message": "updateChat"
+        },
+        "id": "1131051184_update"
+      },
+      {
+        "type": "websocket",
+        "methodName": "remove",
+        "className": "ChatGateway",
+        "classNodeId": "1131051184",
+        "metadata": {
+          "port": 0,
+          "key": "removeChat",
+          "message": "removeChat"
+        },
+        "id": "1131051184_remove"
+      }
+    ],
+    "1472486160": [
+      {
+        "type": "http-endpoint",
+        "methodName": "greeting",
+        "className": "HelloController",
+        "classNodeId": "1472486160",
+        "metadata": {
+          "key": "/hello",
+          "path": "/hello",
+          "requestMethod": "GET"
+        },
+        "id": "1472486160_greeting"
+      }
+    ],
+    "1634859874": [
+      {
+        "type": "middleware",
+        "methodName": "use",
+        "className": "LoggerMiddleware",
+        "classNodeId": "1634859874",
+        "metadata": {
+          "key": "/cats/",
+          "path": "/cats/",
+          "requestMethod": "POST"
+        },
+        "id": "1634859874_use"
+      },
+      {
+        "type": "middleware",
+        "methodName": "use",
+        "className": "LoggerMiddleware",
+        "classNodeId": "1634859874",
+        "metadata": {
+          "key": "/cats/",
+          "path": "/cats/",
+          "requestMethod": "GET"
+        },
+        "id": "1634859874_use"
+      },
+      {
+        "type": "middleware",
+        "methodName": "use",
+        "className": "LoggerMiddleware",
+        "classNodeId": "1634859874",
+        "metadata": {
+          "key": "/cats/:id",
+          "path": "/cats/:id",
+          "requestMethod": "GET"
+        },
+        "id": "1634859874_use"
+      }
+    ],
+    "-349899408": [
+      {
+        "type": "microservice",
+        "methodName": "create",
+        "className": "ExternalSvcController",
+        "classNodeId": "-349899408",
+        "metadata": {
+          "key": "createExternalSvc",
+          "transportId": "TCP",
+          "patterns": [
+            "createExternalSvc"
+          ],
+          "isEventHandler": false
+        },
+        "id": "-349899408_create"
+      },
+      {
+        "type": "microservice",
+        "methodName": "findAll",
+        "className": "ExternalSvcController",
+        "classNodeId": "-349899408",
+        "metadata": {
+          "key": "findAllExternalSvc",
+          "transportId": "TCP",
+          "patterns": [
+            "findAllExternalSvc"
+          ],
+          "isEventHandler": false
+        },
+        "id": "-349899408_findAll"
+      },
+      {
+        "type": "microservice",
+        "methodName": "findOne",
+        "className": "ExternalSvcController",
+        "classNodeId": "-349899408",
+        "metadata": {
+          "key": "findOneExternalSvc",
+          "transportId": "TCP",
+          "patterns": [
+            "findOneExternalSvc"
+          ],
+          "isEventHandler": false
+        },
+        "id": "-349899408_findOne"
+      },
+      {
+        "type": "microservice",
+        "methodName": "update",
+        "className": "ExternalSvcController",
+        "classNodeId": "-349899408",
+        "metadata": {
+          "key": "updateExternalSvc",
+          "transportId": "TCP",
+          "patterns": [
+            "updateExternalSvc"
+          ],
+          "isEventHandler": false
+        },
+        "id": "-349899408_update"
+      },
+      {
+        "type": "microservice",
+        "methodName": "remove",
+        "className": "ExternalSvcController",
+        "classNodeId": "-349899408",
+        "metadata": {
+          "key": "removeExternalSvc",
+          "transportId": "TCP",
+          "patterns": [
+            "removeExternalSvc"
+          ],
+          "isEventHandler": false
+        },
+        "id": "-349899408_remove"
+      }
+    ],
+    "-365265483": [
+      {
+        "type": "http-endpoint",
+        "methodName": "helloWorldV1",
+        "className": "AppV1Controller",
+        "classNodeId": "-365265483",
+        "metadata": {
+          "key": "/v1",
+          "path": "/v1",
+          "requestMethod": "GET",
+          "controllerVersion": "1"
+        },
+        "id": "-365265483_helloWorldV1"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "paramV1",
+        "className": "AppV1Controller",
+        "classNodeId": "-365265483",
+        "metadata": {
+          "key": "/v1/:param/hello",
+          "path": "/v1/:param/hello",
+          "requestMethod": "GET",
+          "controllerVersion": "1"
+        },
+        "id": "-365265483_paramV1"
+      }
+    ],
+    "-774089708": [
+      {
+        "type": "http-endpoint",
+        "methodName": "helloWorldV2",
+        "className": "AppV2Controller",
+        "classNodeId": "-774089708",
+        "metadata": {
+          "key": "/v2",
+          "path": "/v2",
+          "requestMethod": "GET",
+          "controllerVersion": "2"
+        },
+        "id": "-774089708_helloWorldV2"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "paramV1",
+        "className": "AppV2Controller",
+        "classNodeId": "-774089708",
+        "metadata": {
+          "key": "/v3/:param/hello",
+          "path": "/v3/:param/hello",
+          "requestMethod": "GET",
+          "methodVersion": "3",
+          "controllerVersion": "2"
+        },
+        "id": "-774089708_paramV1"
+      }
+    ],
+    "-1550892030": [
+      {
+        "type": "http-endpoint",
+        "methodName": "create",
+        "className": "CatsController",
+        "classNodeId": "-1550892030",
+        "metadata": {
+          "key": "/cats",
+          "path": "/cats",
+          "requestMethod": "POST"
+        },
+        "id": "-1550892030_create"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "findAll",
+        "className": "CatsController",
+        "classNodeId": "-1550892030",
+        "metadata": {
+          "key": "/cats",
+          "path": "/cats",
+          "requestMethod": "GET"
+        },
+        "id": "-1550892030_findAll"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "findOne",
+        "className": "CatsController",
+        "classNodeId": "-1550892030",
+        "metadata": {
+          "key": "/cats/:id",
+          "path": "/cats/:id",
+          "requestMethod": "GET"
+        },
+        "id": "-1550892030_findOne"
+      }
+    ],
+    "-848516688": [
+      {
+        "type": "http-endpoint",
+        "methodName": "greeting",
+        "className": "DurableController",
+        "classNodeId": "-848516688",
+        "metadata": {
+          "key": "/durable",
+          "path": "/durable",
+          "requestMethod": "GET"
+        },
+        "id": "-848516688_greeting"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "echo",
+        "className": "DurableController",
+        "classNodeId": "-848516688",
+        "metadata": {
+          "key": "/durable/echo",
+          "path": "/durable/echo",
+          "requestMethod": "GET"
+        },
+        "id": "-848516688_echo"
+      }
+    ],
+    "-1558907338": [
+      {
+        "type": "http-endpoint",
+        "methodName": "create",
+        "className": "DogsController",
+        "classNodeId": "-1558907338",
+        "metadata": {
+          "key": "/dogs",
+          "path": "/dogs",
+          "requestMethod": "POST"
+        },
+        "id": "-1558907338_create"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "findAll",
+        "className": "DogsController",
+        "classNodeId": "-1558907338",
+        "metadata": {
+          "key": "/dogs",
+          "path": "/dogs",
+          "requestMethod": "GET"
+        },
+        "id": "-1558907338_findAll"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "findOne",
+        "className": "DogsController",
+        "classNodeId": "-1558907338",
+        "metadata": {
+          "key": "/dogs/:id",
+          "path": "/dogs/:id",
+          "requestMethod": "GET"
+        },
+        "id": "-1558907338_findOne"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "update",
+        "className": "DogsController",
+        "classNodeId": "-1558907338",
+        "metadata": {
+          "key": "/dogs/:id",
+          "path": "/dogs/:id",
+          "requestMethod": "PATCH"
+        },
+        "id": "-1558907338_update"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "remove",
+        "className": "DogsController",
+        "classNodeId": "-1558907338",
+        "metadata": {
+          "key": "/dogs/:id",
+          "path": "/dogs/:id",
+          "requestMethod": "DELETE"
+        },
+        "id": "-1558907338_remove"
+      }
+    ],
+    "-1102473136": [
+      {
+        "type": "http-endpoint",
+        "methodName": "create",
+        "className": "UsersController",
+        "classNodeId": "-1102473136",
+        "metadata": {
+          "key": "/users",
+          "path": "/users",
+          "requestMethod": "POST"
+        },
+        "id": "-1102473136_create"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "findAll",
+        "className": "UsersController",
+        "classNodeId": "-1102473136",
+        "metadata": {
+          "key": "/users",
+          "path": "/users",
+          "requestMethod": "GET"
+        },
+        "id": "-1102473136_findAll"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "findOne",
+        "className": "UsersController",
+        "classNodeId": "-1102473136",
+        "metadata": {
+          "key": "/users/:id",
+          "path": "/users/:id",
+          "requestMethod": "GET"
+        },
+        "id": "-1102473136_findOne"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "update",
+        "className": "UsersController",
+        "classNodeId": "-1102473136",
+        "metadata": {
+          "key": "/users/:id",
+          "path": "/users/:id",
+          "requestMethod": "PATCH"
+        },
+        "id": "-1102473136_update"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "remove",
+        "className": "UsersController",
+        "classNodeId": "-1102473136",
+        "metadata": {
+          "key": "/users/:id",
+          "path": "/users/:id",
+          "requestMethod": "DELETE"
+        },
+        "id": "-1102473136_remove"
+      }
+    ],
+    "-377928898": [
+      {
+        "type": "http-endpoint",
+        "methodName": "create",
+        "className": "DatabaseController",
+        "classNodeId": "-377928898",
+        "metadata": {
+          "key": "/database",
+          "path": "/database",
+          "requestMethod": "POST"
+        },
+        "id": "-377928898_create"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "findAll",
+        "className": "DatabaseController",
+        "classNodeId": "-377928898",
+        "metadata": {
+          "key": "/database",
+          "path": "/database",
+          "requestMethod": "GET"
+        },
+        "id": "-377928898_findAll"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "findOne",
+        "className": "DatabaseController",
+        "classNodeId": "-377928898",
+        "metadata": {
+          "key": "/database/:id",
+          "path": "/database/:id",
+          "requestMethod": "GET"
+        },
+        "id": "-377928898_findOne"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "update",
+        "className": "DatabaseController",
+        "classNodeId": "-377928898",
+        "metadata": {
+          "key": "/database/:id",
+          "path": "/database/:id",
+          "requestMethod": "PATCH"
+        },
+        "id": "-377928898_update"
+      },
+      {
+        "type": "http-endpoint",
+        "methodName": "remove",
+        "className": "DatabaseController",
+        "classNodeId": "-377928898",
+        "metadata": {
+          "key": "/database/:id",
+          "path": "/database/:id",
+          "requestMethod": "DELETE"
+        },
+        "id": "-377928898_remove"
+      }
+    ],
+    "-1927427604": [
+      {
+        "type": "http-endpoint",
+        "methodName": "greeting",
+        "className": "RequestChainController",
+        "classNodeId": "-1927427604",
+        "metadata": {
+          "key": "/hello",
+          "path": "/hello",
+          "requestMethod": "GET"
+        },
+        "id": "-1927427604_greeting"
+      }
+    ]
+  },
+  "extras": {
+    "orphanedEnhancers": [
+      {
+        "subtype": "pipe",
+        "ref": "ValidationPipe"
+      },
+      {
+        "subtype": "filter",
+        "ref": "HttpExceptionFilter"
+      },
+      {
+        "subtype": "interceptor",
+        "ref": "TimeoutInterceptor"
+      }
+    ],
+    "attachedEnhancers": [
+      {
+        "nodeId": "2018972420"
+      },
+      {
+        "nodeId": "-2007711503"
+      }
+    ]
+  },
+  "status": "complete"
+}
\ No newline at end of file
diff --git a/integration/inspector/e2e/fixtures/pre-init-graph.json b/integration/inspector/e2e/fixtures/pre-init-graph.json
new file mode 100644
index 000000000..60aa1cc8e
--- /dev/null
+++ b/integration/inspector/e2e/fixtures/pre-init-graph.json
@@ -0,0 +1,2629 @@
+{
+  "nodes": {
+    "18347652": {
+      "id": "18347652",
+      "label": "LoggingInterceptor",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "injectable",
+        "internal": false,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "LoggingInterceptor",
+        "subtype": "interceptor",
+        "initTime": 0
+      }
+    },
+    "55510001": {
+      "id": "55510001",
+      "label": "UsersService",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "UsersService",
+        "initTime": 0
+      }
+    },
+    "91819333": {
+      "id": "91819333",
+      "label": "ModuleRef",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "203550704": {
+      "id": "203550704",
+      "label": "ExternalContextCreator",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": true,
+        "token": "ExternalContextCreator"
+      }
+    },
+    "208171089": {
+      "id": "208171089",
+      "label": "RolesGuard",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "injectable",
+        "internal": false,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "RolesGuard",
+        "subtype": "guard",
+        "initTime": 0
+      }
+    },
+    "225063248": {
+      "id": "225063248",
+      "label": "InternalCoreModule",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "InternalCoreModule",
+        "initTime": 0
+      }
+    },
+    "256260345": {
+      "id": "256260345",
+      "label": "ApplicationConfig",
+      "parent": "1528017428",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DatabaseModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "345516396": {
+      "id": "345516396",
+      "label": "ApplicationConfig",
+      "parent": "1142369607",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelperModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "345719894": {
+      "id": "345719894",
+      "label": "CoreModule",
+      "parent": "-1125887048",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "CoreModule",
+        "initTime": 0
+      }
+    },
+    "437945905": {
+      "id": "437945905",
+      "label": "ApplicationConfig",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "519735830": {
+      "id": "519735830",
+      "label": "ApplicationConfig",
+      "parent": "-493958991",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ChatModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "521671888": {
+      "id": "521671888",
+      "label": "DogsModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "555176277": {
+      "id": "555176277",
+      "label": "InternalCoreModule",
+      "metadata": {
+        "type": "module",
+        "global": true,
+        "dynamic": true,
+        "internal": true
+      }
+    },
+    "594986539": {
+      "id": "594986539",
+      "label": "InputService",
+      "parent": "-1813741655",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "InputModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": true,
+        "token": "InputService",
+        "initTime": 0
+      }
+    },
+    "603011239": {
+      "id": "603011239",
+      "label": "UsersService",
+      "parent": "-2003726489",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "UsersModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "UsersService",
+        "initTime": 0
+      }
+    },
+    "671882984": {
+      "id": "671882984",
+      "label": "Reflector",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": true,
+        "token": "Reflector",
+        "initTime": 0
+      }
+    },
+    "791004148": {
+      "id": "791004148",
+      "label": "ExternalSvcModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "867482265": {
+      "id": "867482265",
+      "label": "Interceptor",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "injectable",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "Interceptor",
+        "subtype": "interceptor",
+        "initTime": 0
+      }
+    },
+    "927096496": {
+      "id": "927096496",
+      "label": "ApplicationConfig",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "928565345": {
+      "id": "928565345",
+      "label": "HelperService",
+      "parent": "1142369607",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "HelperModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": true,
+        "token": "HelperService",
+        "initTime": 0
+      }
+    },
+    "941957564": {
+      "id": "941957564",
+      "label": "RequestChainModule",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "RequestChainModule",
+        "initTime": 0
+      }
+    },
+    "980514911": {
+      "id": "980514911",
+      "label": "Symbol(token)",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "Symbol(token)"
+      }
+    },
+    "1004276345": {
+      "id": "1004276345",
+      "label": "Meta",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "META",
+        "initTime": 0
+      }
+    },
+    "1010833816": {
+      "id": "1010833816",
+      "label": "token",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "token"
+      }
+    },
+    "1047229654": {
+      "id": "1047229654",
+      "label": "CircularModule",
+      "parent": "-369869768",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CircularModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "CircularModule",
+        "initTime": 0
+      }
+    },
+    "1074192353": {
+      "id": "1074192353",
+      "label": "ChatService",
+      "parent": "-493958991",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "ChatModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "ChatService",
+        "initTime": 0
+      }
+    },
+    "1120316353": {
+      "id": "1120316353",
+      "label": "ModuleRef",
+      "parent": "1142369607",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelperModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "1131051184": {
+      "id": "1131051184",
+      "label": "ChatGateway",
+      "parent": "-493958991",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "ChatModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "ChatGateway",
+        "initTime": 0
+      }
+    },
+    "1142369607": {
+      "id": "1142369607",
+      "label": "HelperModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "1189153544": {
+      "id": "1189153544",
+      "label": "ChatModule",
+      "parent": "-493958991",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ChatModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ChatModule",
+        "initTime": 0
+      }
+    },
+    "1253818496": {
+      "id": "1253818496",
+      "label": "RootTestModule",
+      "parent": "-1251270035",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RootTestModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "RootTestModule",
+        "initTime": 0
+      }
+    },
+    "1433815174": {
+      "id": "1433815174",
+      "label": "DogsModule",
+      "parent": "521671888",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DogsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "DogsModule",
+        "initTime": 0
+      }
+    },
+    "1434441974": {
+      "id": "1434441974",
+      "label": "CatsModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "1434456218": {
+      "id": "1434456218",
+      "label": "Reflector",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": true,
+        "token": "Reflector",
+        "initTime": 0
+      }
+    },
+    "1472486160": {
+      "id": "1472486160",
+      "label": "HelloController",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "HelloController",
+        "initTime": 0,
+        "enhancers": [
+          {
+            "id": "-2010060263",
+            "methodKey": "greeting",
+            "subtype": "guard"
+          },
+          {
+            "id": "867482265",
+            "methodKey": "greeting",
+            "subtype": "interceptor"
+          },
+          {
+            "id": "1893794611",
+            "methodKey": "greeting",
+            "subtype": "pipe"
+          }
+        ]
+      }
+    },
+    "1528017428": {
+      "id": "1528017428",
+      "label": "DatabaseModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "1535366709": {
+      "id": "1535366709",
+      "label": "ApplicationConfig",
+      "parent": "521671888",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DogsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "1551182002": {
+      "id": "1551182002",
+      "label": "ModuleRef",
+      "parent": "-1125887048",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "1616075090": {
+      "id": "1616075090",
+      "label": "CatsModule",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "CatsModule",
+        "initTime": 0
+      }
+    },
+    "1743739569": {
+      "id": "1743739569",
+      "label": "HelloModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": true,
+        "internal": false
+      }
+    },
+    "1771940178": {
+      "id": "1771940178",
+      "label": "ApplicationConfig",
+      "parent": "-1251270035",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RootTestModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "1809676814": {
+      "id": "1809676814",
+      "label": "ModuleRef",
+      "parent": "1528017428",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DatabaseModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "1893794611": {
+      "id": "1893794611",
+      "label": "UserByIdPipe",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "injectable",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "UserByIdPipe",
+        "subtype": "pipe",
+        "initTime": 0
+      }
+    },
+    "1919157847": {
+      "id": "1919157847",
+      "label": "REQUEST",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": true,
+        "token": "REQUEST",
+        "initTime": 0
+      }
+    },
+    "2018972420": {
+      "id": "2018972420",
+      "label": "TransformInterceptor",
+      "parent": "-1125887048",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "CoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "APP_INTERCEPTOR (UUID: -1146749753)",
+        "subtype": "interceptor",
+        "initTime": 0,
+        "global": true
+      }
+    },
+    "2133316171": {
+      "id": "2133316171",
+      "label": "RequestChainModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-1486320561": {
+      "id": "-1486320561",
+      "label": "ModuleRef",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-651043398": {
+      "id": "-651043398",
+      "label": "ApplicationConfig",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-255469305": {
+      "id": "-255469305",
+      "label": "INQUIRER",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 1,
+        "transient": true,
+        "exported": true,
+        "token": "INQUIRER",
+        "initTime": 0
+      }
+    },
+    "-26938366": {
+      "id": "-26938366",
+      "label": "ModulesContainer",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": true,
+        "token": "ModulesContainer"
+      }
+    },
+    "-326832201": {
+      "id": "-326832201",
+      "label": "HttpAdapterHost",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": true,
+        "token": "HttpAdapterHost"
+      }
+    },
+    "-553129559": {
+      "id": "-553129559",
+      "label": "HttpAdapterHost",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": true,
+        "token": "HttpAdapterHost",
+        "initTime": 0
+      }
+    },
+    "-702581189": {
+      "id": "-702581189",
+      "label": "LazyModuleLoader",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": true,
+        "token": "LazyModuleLoader",
+        "initTime": 0
+      }
+    },
+    "-1904419534": {
+      "id": "-1904419534",
+      "label": "SerializedGraph",
+      "parent": "555176277",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InternalCoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": true,
+        "token": "SerializedGraph"
+      }
+    },
+    "-1251270035": {
+      "id": "-1251270035",
+      "label": "RootTestModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-969610649": {
+      "id": "-969610649",
+      "label": "ModuleRef",
+      "parent": "-1251270035",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "RootTestModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-19112576": {
+      "id": "-19112576",
+      "label": "AppModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-2139588960": {
+      "id": "-2139588960",
+      "label": "AppModule",
+      "parent": "-19112576",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "AppModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "AppModule",
+        "initTime": 0
+      }
+    },
+    "-71302842": {
+      "id": "-71302842",
+      "label": "ModuleRef",
+      "parent": "-19112576",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "AppModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-2064622725": {
+      "id": "-2064622725",
+      "label": "ApplicationConfig",
+      "parent": "-19112576",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "AppModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-365265483": {
+      "id": "-365265483",
+      "label": "AppV1Controller",
+      "parent": "-19112576",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "AppModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "AppV1Controller",
+        "initTime": 0
+      }
+    },
+    "-774089708": {
+      "id": "-774089708",
+      "label": "AppV2Controller",
+      "parent": "-19112576",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "AppModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "AppV2Controller",
+        "initTime": 0
+      }
+    },
+    "-1125887048": {
+      "id": "-1125887048",
+      "label": "CoreModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-112192227": {
+      "id": "-112192227",
+      "label": "ApplicationConfig",
+      "parent": "-1125887048",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CoreModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-2007711503": {
+      "id": "-2007711503",
+      "label": "LoggingInterceptor",
+      "parent": "-1125887048",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "CoreModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "APP_INTERCEPTOR (UUID: 1780085433)",
+        "subtype": "interceptor",
+        "initTime": 0,
+        "global": true
+      }
+    },
+    "-183456272": {
+      "id": "-183456272",
+      "label": "ModuleRef",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-1846830501": {
+      "id": "-1846830501",
+      "label": "ApplicationConfig",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-593595711": {
+      "id": "-593595711",
+      "label": "CatsService",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "CatsService",
+        "initTime": 0
+      }
+    },
+    "-1550892030": {
+      "id": "-1550892030",
+      "label": "CatsController",
+      "parent": "1434441974",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "CatsModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "CatsController",
+        "initTime": 0,
+        "enhancers": [
+          {
+            "id": "208171089",
+            "subtype": "guard"
+          },
+          {
+            "name": "ParseIntPipe",
+            "methodKey": "findOne",
+            "subtype": "pipe"
+          }
+        ]
+      }
+    },
+    "-1378706112": {
+      "id": "-1378706112",
+      "label": "HelloModule",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "HelloModule",
+        "initTime": 0
+      }
+    },
+    "-1166465801": {
+      "id": "-1166465801",
+      "label": "ModuleRef",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-1191459348": {
+      "id": "-1191459348",
+      "label": "ApplicationConfig",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-1758187461": {
+      "id": "-1758187461",
+      "label": "HelloService",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "HelloService",
+        "initTime": 0
+      }
+    },
+    "-2010060263": {
+      "id": "-2010060263",
+      "label": "Guard",
+      "parent": "1743739569",
+      "metadata": {
+        "type": "injectable",
+        "internal": false,
+        "sourceModuleName": "HelloModule",
+        "durable": false,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "Guard",
+        "subtype": "guard",
+        "initTime": 0
+      }
+    },
+    "-1124392646": {
+      "id": "-1124392646",
+      "label": "DurableModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-522935456": {
+      "id": "-522935456",
+      "label": "DurableModule",
+      "parent": "-1124392646",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DurableModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "DurableModule",
+        "initTime": 0
+      }
+    },
+    "-1808043520": {
+      "id": "-1808043520",
+      "label": "ModuleRef",
+      "parent": "-1124392646",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DurableModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-57038411": {
+      "id": "-57038411",
+      "label": "ApplicationConfig",
+      "parent": "-1124392646",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DurableModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-1673986099": {
+      "id": "-1673986099",
+      "label": "DurableService",
+      "parent": "-1124392646",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "DurableModule",
+        "durable": true,
+        "static": false,
+        "scope": 2,
+        "transient": false,
+        "exported": false,
+        "token": "DurableService",
+        "initTime": 0
+      }
+    },
+    "-848516688": {
+      "id": "-848516688",
+      "label": "DurableController",
+      "parent": "-1124392646",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "DurableModule",
+        "durable": true,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "DurableController",
+        "initTime": 0
+      }
+    },
+    "-1096226358": {
+      "id": "-1096226358",
+      "label": "ModuleRef",
+      "parent": "521671888",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DogsModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-335387007": {
+      "id": "-335387007",
+      "label": "DogsService",
+      "parent": "521671888",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "DogsModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "DogsService",
+        "initTime": 0
+      }
+    },
+    "-1558907338": {
+      "id": "-1558907338",
+      "label": "DogsController",
+      "parent": "521671888",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "DogsModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "DogsController",
+        "initTime": 0
+      }
+    },
+    "-2003726489": {
+      "id": "-2003726489",
+      "label": "UsersModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-495603840": {
+      "id": "-495603840",
+      "label": "UsersModule",
+      "parent": "-2003726489",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "UsersModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "UsersModule",
+        "initTime": 0
+      }
+    },
+    "-618964563": {
+      "id": "-618964563",
+      "label": "ModuleRef",
+      "parent": "-2003726489",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "UsersModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-643958110": {
+      "id": "-643958110",
+      "label": "ApplicationConfig",
+      "parent": "-2003726489",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "UsersModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-1102473136": {
+      "id": "-1102473136",
+      "label": "UsersController",
+      "parent": "-2003726489",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "UsersModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "UsersController",
+        "initTime": 0
+      }
+    },
+    "-1098322034": {
+      "id": "-1098322034",
+      "label": "DatabaseModule",
+      "parent": "1528017428",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "DatabaseModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "DatabaseModule",
+        "initTime": 0
+      }
+    },
+    "-616397055": {
+      "id": "-616397055",
+      "label": "DatabaseService",
+      "parent": "1528017428",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "DatabaseModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "DatabaseService",
+        "initTime": 0
+      }
+    },
+    "-377928898": {
+      "id": "-377928898",
+      "label": "DatabaseController",
+      "parent": "1528017428",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "DatabaseModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "DatabaseController",
+        "initTime": 0
+      }
+    },
+    "-511735264": {
+      "id": "-511735264",
+      "label": "ExternalSvcModule",
+      "parent": "791004148",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ExternalSvcModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ExternalSvcModule",
+        "initTime": 0
+      }
+    },
+    "-660323910": {
+      "id": "-660323910",
+      "label": "ModuleRef",
+      "parent": "791004148",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ExternalSvcModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-217737489": {
+      "id": "-217737489",
+      "label": "ApplicationConfig",
+      "parent": "791004148",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ExternalSvcModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-1902429503": {
+      "id": "-1902429503",
+      "label": "ExternalSvcService",
+      "parent": "791004148",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "ExternalSvcModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "ExternalSvcService",
+        "initTime": 0
+      }
+    },
+    "-349899408": {
+      "id": "-349899408",
+      "label": "ExternalSvcController",
+      "parent": "791004148",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "ExternalSvcModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "ExternalSvcController",
+        "initTime": 0
+      }
+    },
+    "-493958991": {
+      "id": "-493958991",
+      "label": "ChatModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-2111857237": {
+      "id": "-2111857237",
+      "label": "ModuleRef",
+      "parent": "-493958991",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "ChatModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-234035039": {
+      "id": "-234035039",
+      "label": "RequestChainService",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "RequestChainService",
+        "initTime": 0
+      }
+    },
+    "-1927427604": {
+      "id": "-1927427604",
+      "label": "RequestChainController",
+      "parent": "2133316171",
+      "metadata": {
+        "type": "controller",
+        "internal": false,
+        "sourceModuleName": "RequestChainModule",
+        "durable": false,
+        "static": false,
+        "transient": false,
+        "exported": false,
+        "token": "RequestChainController",
+        "initTime": 0,
+        "enhancers": [
+          {
+            "id": "18347652",
+            "methodKey": "greeting",
+            "subtype": "interceptor"
+          }
+        ]
+      }
+    },
+    "-162987852": {
+      "id": "-162987852",
+      "label": "HelperModule",
+      "parent": "1142369607",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "HelperModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "HelperModule",
+        "initTime": 0
+      }
+    },
+    "-1469176692": {
+      "id": "-1469176692",
+      "label": "PropertiesModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-1501313730": {
+      "id": "-1501313730",
+      "label": "PropertiesModule",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "PropertiesModule",
+        "initTime": 0
+      }
+    },
+    "-1377446394": {
+      "id": "-1377446394",
+      "label": "ModuleRef",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-1494077847": {
+      "id": "-1494077847",
+      "label": "DependencyService",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "DependencyService",
+        "initTime": 0
+      }
+    },
+    "-1803759743": {
+      "id": "-1803759743",
+      "label": "PropertiesService",
+      "parent": "-1469176692",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "PropertiesModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": false,
+        "token": "PropertiesService",
+        "initTime": 0
+      }
+    },
+    "-1813741655": {
+      "id": "-1813741655",
+      "label": "InputModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-2113121728": {
+      "id": "-2113121728",
+      "label": "InputModule",
+      "parent": "-1813741655",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InputModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "InputModule",
+        "initTime": 0
+      }
+    },
+    "-428979729": {
+      "id": "-428979729",
+      "label": "ModuleRef",
+      "parent": "-1813741655",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InputModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-453973276": {
+      "id": "-453973276",
+      "label": "ApplicationConfig",
+      "parent": "-1813741655",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "InputModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-369869768": {
+      "id": "-369869768",
+      "label": "CircularModule",
+      "metadata": {
+        "type": "module",
+        "global": false,
+        "dynamic": false,
+        "internal": false
+      }
+    },
+    "-88210382": {
+      "id": "-88210382",
+      "label": "ModuleRef",
+      "parent": "-369869768",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CircularModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ModuleRef"
+      }
+    },
+    "-1641626851": {
+      "id": "-1641626851",
+      "label": "ApplicationConfig",
+      "parent": "-369869768",
+      "metadata": {
+        "type": "provider",
+        "internal": true,
+        "sourceModuleName": "CircularModule",
+        "durable": false,
+        "static": true,
+        "scope": 0,
+        "transient": false,
+        "exported": false,
+        "token": "ApplicationConfig"
+      }
+    },
+    "-1721730431": {
+      "id": "-1721730431",
+      "label": "CircularService",
+      "parent": "-369869768",
+      "metadata": {
+        "type": "provider",
+        "internal": false,
+        "sourceModuleName": "CircularModule",
+        "durable": false,
+        "static": true,
+        "transient": false,
+        "exported": true,
+        "token": "CircularService",
+        "initTime": 0
+      }
+    }
+  },
+  "edges": {
+    "22193019": {
+      "source": "-19112576",
+      "target": "521671888",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "DogsModule"
+      },
+      "id": "22193019"
+    },
+    "33333764": {
+      "source": "791004148",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "ExternalSvcModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "33333764"
+    },
+    "40501732": {
+      "source": "521671888",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "DogsModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "40501732"
+    },
+    "73947303": {
+      "source": "-1813741655",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "InputModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "73947303"
+    },
+    "182501115": {
+      "source": "1434441974",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "CatsModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "182501115"
+    },
+    "189694679": {
+      "source": "1434456218",
+      "target": "671882984",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "InternalCoreModule",
+        "sourceClassName": "Reflector",
+        "targetClassName": "Reflector",
+        "sourceClassToken": "Reflector",
+        "targetClassToken": "Reflector",
+        "targetModuleName": "InternalCoreModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor",
+        "internal": true
+      },
+      "id": "189694679"
+    },
+    "231469845": {
+      "source": "-1803759743",
+      "target": "-1494077847",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "PropertiesModule",
+        "sourceClassName": "PropertiesService",
+        "targetClassName": "DependencyService",
+        "sourceClassToken": "PropertiesService",
+        "targetClassToken": "DependencyService",
+        "targetModuleName": "PropertiesModule",
+        "keyOrIndex": "service",
+        "injectionType": "property"
+      },
+      "id": "231469845"
+    },
+    "250652665": {
+      "source": "2133316171",
+      "target": "1142369607",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "RequestChainModule",
+        "targetModuleName": "HelperModule"
+      },
+      "id": "250652665"
+    },
+    "393939926": {
+      "source": "-1813741655",
+      "target": "-369869768",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "InputModule",
+        "targetModuleName": "CircularModule"
+      },
+      "id": "393939926"
+    },
+    "417363164": {
+      "source": "-1251270035",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "RootTestModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "417363164"
+    },
+    "469401997": {
+      "source": "-493958991",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "ChatModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "469401997"
+    },
+    "654001290": {
+      "source": "1472486160",
+      "target": "867482265",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloController",
+        "targetClassName": "Interceptor",
+        "sourceClassToken": "HelloController",
+        "targetClassToken": "Interceptor",
+        "targetModuleName": "HelloModule",
+        "injectionType": "decorator"
+      },
+      "id": "654001290"
+    },
+    "676175891": {
+      "source": "-1251270035",
+      "target": "-19112576",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "RootTestModule",
+        "targetModuleName": "AppModule"
+      },
+      "id": "676175891"
+    },
+    "800268760": {
+      "source": "-1102473136",
+      "target": "603011239",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "UsersModule",
+        "sourceClassName": "UsersController",
+        "targetClassName": "UsersService",
+        "sourceClassToken": "UsersController",
+        "targetClassToken": "UsersService",
+        "targetModuleName": "UsersModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "800268760"
+    },
+    "804987620": {
+      "source": "-19112576",
+      "target": "-1125887048",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "CoreModule"
+      },
+      "id": "804987620"
+    },
+    "807697929": {
+      "source": "-19112576",
+      "target": "1528017428",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "DatabaseModule"
+      },
+      "id": "807697929"
+    },
+    "966350248": {
+      "source": "1131051184",
+      "target": "1074192353",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "ChatModule",
+        "sourceClassName": "ChatGateway",
+        "targetClassName": "ChatService",
+        "sourceClassToken": "ChatGateway",
+        "targetClassToken": "ChatService",
+        "targetModuleName": "ChatModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "966350248"
+    },
+    "987755577": {
+      "source": "-2003726489",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "UsersModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "987755577"
+    },
+    "1056428433": {
+      "source": "-19112576",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "1056428433"
+    },
+    "1059069749": {
+      "source": "-1558907338",
+      "target": "-335387007",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "DogsModule",
+        "sourceClassName": "DogsController",
+        "targetClassName": "DogsService",
+        "sourceClassToken": "DogsController",
+        "targetClassToken": "DogsService",
+        "targetModuleName": "DogsModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1059069749"
+    },
+    "1142343545": {
+      "source": "-1758187461",
+      "target": "1004276345",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloService",
+        "targetClassName": "Meta",
+        "sourceClassToken": "HelloService",
+        "targetClassToken": "META",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1142343545"
+    },
+    "1178436405": {
+      "source": "1893794611",
+      "target": "55510001",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "UserByIdPipe",
+        "targetClassName": "UsersService",
+        "sourceClassToken": "UserByIdPipe",
+        "targetClassToken": "UsersService",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1178436405"
+    },
+    "1195474320": {
+      "source": "-369869768",
+      "target": "-1813741655",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "CircularModule",
+        "targetModuleName": "InputModule"
+      },
+      "id": "1195474320"
+    },
+    "1247743823": {
+      "source": "2133316171",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "RequestChainModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "1247743823"
+    },
+    "1325313063": {
+      "source": "-1927427604",
+      "target": "18347652",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "RequestChainModule",
+        "sourceClassName": "RequestChainController",
+        "targetClassName": "LoggingInterceptor",
+        "sourceClassToken": "RequestChainController",
+        "targetClassToken": "LoggingInterceptor",
+        "targetModuleName": "RequestChainModule",
+        "injectionType": "decorator"
+      },
+      "id": "1325313063"
+    },
+    "1497653915": {
+      "source": "55510001",
+      "target": "1004276345",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "UsersService",
+        "targetClassName": "Meta",
+        "sourceClassToken": "UsersService",
+        "targetClassToken": "META",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1497653915"
+    },
+    "1615322974": {
+      "source": "-1469176692",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "PropertiesModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "1615322974"
+    },
+    "1856016815": {
+      "source": "-1721730431",
+      "target": "594986539",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "CircularModule",
+        "sourceClassName": "CircularService",
+        "targetClassName": "InputService",
+        "sourceClassToken": "CircularService",
+        "targetClassToken": "InputService",
+        "targetModuleName": "InputModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1856016815"
+    },
+    "1900414743": {
+      "source": "1472486160",
+      "target": "1893794611",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloController",
+        "targetClassName": "UserByIdPipe",
+        "sourceClassToken": "HelloController",
+        "targetClassToken": "UserByIdPipe",
+        "targetModuleName": "HelloModule",
+        "injectionType": "decorator"
+      },
+      "id": "1900414743"
+    },
+    "1904579661": {
+      "source": "18347652",
+      "target": "928565345",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "RequestChainModule",
+        "sourceClassName": "LoggingInterceptor",
+        "targetClassName": "HelperService",
+        "sourceClassToken": "LoggingInterceptor",
+        "targetClassToken": "HelperService",
+        "targetModuleName": "HelperModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "1904579661"
+    },
+    "1960203007": {
+      "source": "-1803759743",
+      "target": "980514911",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "PropertiesModule",
+        "sourceClassName": "PropertiesService",
+        "targetClassName": "Symbol(token)",
+        "sourceClassToken": "PropertiesService",
+        "targetClassToken": "Symbol(token)",
+        "targetModuleName": "PropertiesModule",
+        "keyOrIndex": "symbolToken",
+        "injectionType": "property"
+      },
+      "id": "1960203007"
+    },
+    "1976848738": {
+      "source": "1528017428",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "DatabaseModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "1976848738"
+    },
+    "-1759625292": {
+      "source": "-553129559",
+      "target": "-326832201",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "InternalCoreModule",
+        "sourceClassName": "HttpAdapterHost",
+        "targetClassName": "HttpAdapterHost",
+        "sourceClassToken": "HttpAdapterHost",
+        "targetClassToken": "HttpAdapterHost",
+        "targetModuleName": "InternalCoreModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor",
+        "internal": true
+      },
+      "id": "-1759625292"
+    },
+    "-2105726668": {
+      "source": "-1803759743",
+      "target": "1010833816",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "PropertiesModule",
+        "sourceClassName": "PropertiesService",
+        "targetClassName": "token",
+        "sourceClassToken": "PropertiesService",
+        "targetClassToken": "token",
+        "targetModuleName": "PropertiesModule",
+        "keyOrIndex": "token",
+        "injectionType": "property"
+      },
+      "id": "-2105726668"
+    },
+    "-21463590": {
+      "source": "-1378706112",
+      "target": "1004276345",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloModule",
+        "targetClassName": "Meta",
+        "sourceClassToken": "HelloModule",
+        "targetClassToken": "META",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-21463590"
+    },
+    "-1657371464": {
+      "source": "-1673986099",
+      "target": "1919157847",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "DurableModule",
+        "sourceClassName": "DurableService",
+        "targetClassName": "REQUEST",
+        "sourceClassToken": "DurableService",
+        "targetClassToken": "REQUEST",
+        "targetModuleName": "InternalCoreModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor",
+        "internal": true
+      },
+      "id": "-1657371464"
+    },
+    "-1303681274": {
+      "source": "928565345",
+      "target": "1919157847",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelperModule",
+        "sourceClassName": "HelperService",
+        "targetClassName": "REQUEST",
+        "sourceClassToken": "HelperService",
+        "targetClassToken": "REQUEST",
+        "targetModuleName": "InternalCoreModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor",
+        "internal": true
+      },
+      "id": "-1303681274"
+    },
+    "-886102564": {
+      "source": "208171089",
+      "target": "671882984",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "CatsModule",
+        "sourceClassName": "RolesGuard",
+        "targetClassName": "Reflector",
+        "sourceClassToken": "RolesGuard",
+        "targetClassToken": "Reflector",
+        "targetModuleName": "InternalCoreModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor",
+        "internal": true
+      },
+      "id": "-886102564"
+    },
+    "-2003045613": {
+      "source": "-377928898",
+      "target": "-616397055",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "DatabaseModule",
+        "sourceClassName": "DatabaseController",
+        "targetClassName": "DatabaseService",
+        "sourceClassToken": "DatabaseController",
+        "targetClassToken": "DatabaseService",
+        "targetModuleName": "DatabaseModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-2003045613"
+    },
+    "-881420795": {
+      "source": "-349899408",
+      "target": "-1902429503",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "ExternalSvcModule",
+        "sourceClassName": "ExternalSvcController",
+        "targetClassName": "ExternalSvcService",
+        "sourceClassToken": "ExternalSvcController",
+        "targetClassToken": "ExternalSvcService",
+        "targetModuleName": "ExternalSvcModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-881420795"
+    },
+    "-831049991": {
+      "source": "594986539",
+      "target": "-1721730431",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "InputModule",
+        "sourceClassName": "InputService",
+        "targetClassName": "CircularService",
+        "sourceClassToken": "InputService",
+        "targetClassToken": "CircularService",
+        "targetModuleName": "CircularModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-831049991"
+    },
+    "-2146943494": {
+      "source": "-234035039",
+      "target": "928565345",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "RequestChainModule",
+        "sourceClassName": "RequestChainService",
+        "targetClassName": "HelperService",
+        "sourceClassToken": "RequestChainService",
+        "targetClassToken": "HelperService",
+        "targetModuleName": "HelperModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-2146943494"
+    },
+    "-1816180282": {
+      "source": "-848516688",
+      "target": "-1673986099",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "DurableModule",
+        "sourceClassName": "DurableController",
+        "targetClassName": "DurableService",
+        "sourceClassToken": "DurableController",
+        "targetClassToken": "DurableService",
+        "targetModuleName": "DurableModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-1816180282"
+    },
+    "-180350082": {
+      "source": "-1550892030",
+      "target": "-593595711",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "CatsModule",
+        "sourceClassName": "CatsController",
+        "targetClassName": "CatsService",
+        "sourceClassToken": "CatsController",
+        "targetClassToken": "CatsService",
+        "targetModuleName": "CatsModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-180350082"
+    },
+    "-1043628608": {
+      "source": "1472486160",
+      "target": "-1758187461",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloController",
+        "targetClassName": "HelloService",
+        "sourceClassToken": "HelloController",
+        "targetClassToken": "HelloService",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-1043628608"
+    },
+    "-1335121169": {
+      "source": "1472486160",
+      "target": "55510001",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloController",
+        "targetClassName": "UsersService",
+        "sourceClassToken": "HelloController",
+        "targetClassToken": "UsersService",
+        "targetModuleName": "HelloModule",
+        "keyOrIndex": 1,
+        "injectionType": "constructor"
+      },
+      "id": "-1335121169"
+    },
+    "-296280311": {
+      "source": "-1927427604",
+      "target": "-234035039",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "RequestChainModule",
+        "sourceClassName": "RequestChainController",
+        "targetClassName": "RequestChainService",
+        "sourceClassToken": "RequestChainController",
+        "targetClassToken": "RequestChainService",
+        "targetModuleName": "RequestChainModule",
+        "keyOrIndex": 0,
+        "injectionType": "constructor"
+      },
+      "id": "-296280311"
+    },
+    "-393224862": {
+      "source": "-19112576",
+      "target": "1434441974",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "CatsModule"
+      },
+      "id": "-393224862"
+    },
+    "-1675983900": {
+      "source": "-19112576",
+      "target": "1743739569",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "HelloModule"
+      },
+      "id": "-1675983900"
+    },
+    "-678699872": {
+      "source": "-19112576",
+      "target": "-1124392646",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "DurableModule"
+      },
+      "id": "-678699872"
+    },
+    "-158970266": {
+      "source": "-19112576",
+      "target": "-2003726489",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "UsersModule"
+      },
+      "id": "-158970266"
+    },
+    "-2086236431": {
+      "source": "-19112576",
+      "target": "791004148",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "ExternalSvcModule"
+      },
+      "id": "-2086236431"
+    },
+    "-192150092": {
+      "source": "-19112576",
+      "target": "-493958991",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "ChatModule"
+      },
+      "id": "-192150092"
+    },
+    "-1609022090": {
+      "source": "-19112576",
+      "target": "2133316171",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "RequestChainModule"
+      },
+      "id": "-1609022090"
+    },
+    "-773455435": {
+      "source": "-19112576",
+      "target": "-1469176692",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "PropertiesModule"
+      },
+      "id": "-773455435"
+    },
+    "-967144236": {
+      "source": "-19112576",
+      "target": "-1813741655",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "AppModule",
+        "targetModuleName": "InputModule"
+      },
+      "id": "-967144236"
+    },
+    "-528424051": {
+      "source": "-1125887048",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "CoreModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "-528424051"
+    },
+    "-698929209": {
+      "source": "1743739569",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "HelloModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "-698929209"
+    },
+    "-1671708813": {
+      "source": "-1124392646",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "DurableModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "-1671708813"
+    },
+    "-665042842": {
+      "source": "1142369607",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "HelperModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "-665042842"
+    },
+    "-1891610441": {
+      "source": "-369869768",
+      "target": "555176277",
+      "metadata": {
+        "type": "module-to-module",
+        "sourceModuleName": "CircularModule",
+        "targetModuleName": "InternalCoreModule"
+      },
+      "id": "-1891610441"
+    },
+    "-878379437": {
+      "source": "-1550892030",
+      "target": "208171089",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "CatsModule",
+        "sourceClassName": "CatsController",
+        "targetClassName": "RolesGuard",
+        "sourceClassToken": "CatsController",
+        "targetClassToken": "RolesGuard",
+        "targetModuleName": "CatsModule",
+        "injectionType": "decorator"
+      },
+      "id": "-878379437"
+    },
+    "-822816169": {
+      "source": "1472486160",
+      "target": "-2010060263",
+      "metadata": {
+        "type": "class-to-class",
+        "sourceModuleName": "HelloModule",
+        "sourceClassName": "HelloController",
+        "targetClassName": "Guard",
+        "sourceClassToken": "HelloController",
+        "targetClassToken": "Guard",
+        "targetModuleName": "HelloModule",
+        "injectionType": "decorator"
+      },
+      "id": "-822816169"
+    }
+  },
+  "entrypoints": {},
+  "extras": {
+    "orphanedEnhancers": [],
+    "attachedEnhancers": [
+      {
+        "nodeId": "2018972420"
+      },
+      {
+        "nodeId": "-2007711503"
+      }
+    ]
+  },
+  "status": "complete"
+}
\ No newline at end of file
diff --git a/integration/inspector/e2e/graph-inspector.spec.ts b/integration/inspector/e2e/graph-inspector.spec.ts
new file mode 100644
index 000000000..1cc2283ae
--- /dev/null
+++ b/integration/inspector/e2e/graph-inspector.spec.ts
@@ -0,0 +1,69 @@
+import { ValidationPipe } from '@nestjs/common';
+import { Injector } from '@nestjs/core/injector/injector';
+import { SerializedGraph } from '@nestjs/core/inspector/serialized-graph';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
+import { Test, TestingModule } from '@nestjs/testing';
+import { expect } from 'chai';
+import { readFileSync, writeFileSync } from 'fs';
+import { join } from 'path';
+import * as sinon from 'sinon';
+import { AppModule } from '../src/app.module';
+import { HttpExceptionFilter } from '../src/common/filters/http-exception.filter';
+import { TimeoutInterceptor } from '../src/common/interceptors/timeout.interceptor';
+
+describe('Graph inspector', () => {
+  let testingModule: TestingModule;
+
+  before(async () => {
+    sinon.stub(Injector.prototype as any, 'getNowTimestamp').callsFake(() => 0);
+
+    testingModule = await Test.createTestingModule({
+      imports: [AppModule],
+    }).compile({ snapshot: true });
+  });
+
+  it('should generate a pre-initialization graph and match snapshot', () => {
+    const graph = testingModule.get(SerializedGraph);
+
+    // Update snapshot:
+    writeFileSync(
+      join(__dirname, 'fixtures', 'pre-init-graph.json'),
+      graph.toString(),
+    );
+
+    const snapshot = readFileSync(
+      join(__dirname, 'fixtures', 'pre-init-graph.json'),
+      'utf-8',
+    );
+
+    expect(JSON.parse(graph.toString())).to.deep.equal(JSON.parse(snapshot));
+  });
+
+  it('should generate a post-initialization graph and match snapshot', async () => {
+    const app = testingModule.createNestApplication({ preview: true });
+    app.useGlobalPipes(new ValidationPipe());
+    app.useGlobalFilters(new HttpExceptionFilter());
+    app.useGlobalInterceptors(new TimeoutInterceptor());
+    app.enableVersioning();
+    app.connectMicroservice<MicroserviceOptions>({
+      transport: Transport.TCP,
+      options: {},
+    });
+    await app.init();
+
+    const graph = testingModule.get(SerializedGraph);
+
+    // Update snapshot:
+    writeFileSync(
+      join(__dirname, 'fixtures', 'post-init-graph.json'),
+      graph.toString(),
+    );
+
+    const snapshot = readFileSync(
+      join(__dirname, 'fixtures', 'post-init-graph.json'),
+      'utf-8',
+    );
+
+    expect(graph.toString()).to.equal(snapshot);
+  });
+});
diff --git a/integration/inspector/src/app-v1.controller.ts b/integration/inspector/src/app-v1.controller.ts
new file mode 100644
index 000000000..90d1dacba
--- /dev/null
+++ b/integration/inspector/src/app-v1.controller.ts
@@ -0,0 +1,16 @@
+import { Controller, Get } from '@nestjs/common';
+
+@Controller({
+  version: '1',
+})
+export class AppV1Controller {
+  @Get('/')
+  helloWorldV1() {
+    return 'Hello World V1!';
+  }
+
+  @Get('/:param/hello')
+  paramV1() {
+    return 'Parameter V1!';
+  }
+}
diff --git a/integration/inspector/src/app-v2.controller.ts b/integration/inspector/src/app-v2.controller.ts
new file mode 100644
index 000000000..5be777871
--- /dev/null
+++ b/integration/inspector/src/app-v2.controller.ts
@@ -0,0 +1,17 @@
+import { Controller, Get, Version } from '@nestjs/common';
+
+@Controller({
+  version: '2',
+})
+export class AppV2Controller {
+  @Get('/')
+  helloWorldV2() {
+    return 'Hello World V2!';
+  }
+
+  @Version('3')
+  @Get('/:param/hello')
+  paramV1() {
+    return 'Parameter V2!';
+  }
+}
diff --git a/integration/inspector/src/app.module.ts b/integration/inspector/src/app.module.ts
new file mode 100644
index 000000000..1d395b9bf
--- /dev/null
+++ b/integration/inspector/src/app.module.ts
@@ -0,0 +1,46 @@
+import { Module, Scope } from '@nestjs/common';
+import { AppV1Controller } from './app-v1.controller';
+import { AppV2Controller } from './app-v2.controller';
+import { CatsModule } from './cats/cats.module';
+import { ChatModule } from './chat/chat.module';
+import { HelloModule as CircularHelloModule } from './circular-hello/hello.module';
+import { HelloService } from './circular-hello/hello.service';
+import { InputModule } from './circular-modules/input.module';
+import { CoreModule } from './core/core.module';
+import { DatabaseModule } from './database/database.module';
+import { DogsModule } from './dogs/dogs.module';
+import { DurableModule } from './durable/durable.module';
+import { ExternalSvcModule } from './external-svc/external-svc.module';
+import { PropertiesModule } from './properties/properties.module';
+import { RequestChainModule } from './request-chain/request-chain.module';
+import { UsersModule } from './users/users.module';
+
+class Meta {
+  static COUNTER = 0;
+  constructor(private readonly helloService: HelloService) {
+    Meta.COUNTER++;
+  }
+}
+
+@Module({
+  imports: [
+    CoreModule,
+    CatsModule,
+    CircularHelloModule.forRoot({
+      provide: 'META',
+      useClass: Meta,
+      scope: Scope.REQUEST,
+    }),
+    DurableModule,
+    DogsModule,
+    UsersModule,
+    DatabaseModule,
+    ExternalSvcModule,
+    ChatModule,
+    RequestChainModule,
+    PropertiesModule,
+    InputModule,
+  ],
+  controllers: [AppV1Controller, AppV2Controller],
+})
+export class AppModule {}
diff --git a/integration/inspector/src/cats/cats.controller.ts b/integration/inspector/src/cats/cats.controller.ts
new file mode 100644
index 000000000..b9f929a21
--- /dev/null
+++ b/integration/inspector/src/cats/cats.controller.ts
@@ -0,0 +1,30 @@
+import { Body, Controller, Get, Param, Post, UseGuards } from '@nestjs/common';
+import { RolesGuard } from '../common/guards/roles.guard';
+import { ParseIntPipe } from '../common/pipes/parse-int.pipe';
+import { CatsService } from './cats.service';
+import { CreateCatDto } from './dto/create-cat.dto';
+import { Cat } from './interfaces/cat.interface';
+
+@UseGuards(RolesGuard)
+@Controller('cats')
+export class CatsController {
+  constructor(private readonly catsService: CatsService) {}
+
+  @Post()
+  async create(@Body() createCatDto: CreateCatDto) {
+    this.catsService.create(createCatDto);
+  }
+
+  @Get()
+  async findAll(): Promise<Cat[]> {
+    return this.catsService.findAll();
+  }
+
+  @Get(':id')
+  findOne(
+    @Param('id', new ParseIntPipe())
+    id: number,
+  ) {
+    // get by ID logic
+  }
+}
diff --git a/integration/inspector/src/cats/cats.module.ts b/integration/inspector/src/cats/cats.module.ts
new file mode 100644
index 000000000..f3291c7d1
--- /dev/null
+++ b/integration/inspector/src/cats/cats.module.ts
@@ -0,0 +1,9 @@
+import { Module } from '@nestjs/common';
+import { CatsController } from './cats.controller';
+import { CatsService } from './cats.service';
+
+@Module({
+  controllers: [CatsController],
+  providers: [CatsService],
+})
+export class CatsModule {}
diff --git a/integration/inspector/src/cats/cats.service.ts b/integration/inspector/src/cats/cats.service.ts
new file mode 100644
index 000000000..2619cd717
--- /dev/null
+++ b/integration/inspector/src/cats/cats.service.ts
@@ -0,0 +1,15 @@
+import { Injectable } from '@nestjs/common';
+import { Cat } from './interfaces/cat.interface';
+
+@Injectable()
+export class CatsService {
+  private readonly cats: Cat[] = [];
+
+  create(cat: Cat) {
+    this.cats.push(cat);
+  }
+
+  findAll(): Cat[] {
+    return this.cats;
+  }
+}
diff --git a/integration/inspector/src/cats/dto/create-cat.dto.ts b/integration/inspector/src/cats/dto/create-cat.dto.ts
new file mode 100644
index 000000000..acd7d288b
--- /dev/null
+++ b/integration/inspector/src/cats/dto/create-cat.dto.ts
@@ -0,0 +1,12 @@
+import { IsInt, IsString } from 'class-validator';
+
+export class CreateCatDto {
+  @IsString()
+  readonly name: string;
+
+  @IsInt()
+  readonly age: number;
+
+  @IsString()
+  readonly breed: string;
+}
diff --git a/integration/inspector/src/cats/interfaces/cat.interface.ts b/integration/inspector/src/cats/interfaces/cat.interface.ts
new file mode 100644
index 000000000..961c97391
--- /dev/null
+++ b/integration/inspector/src/cats/interfaces/cat.interface.ts
@@ -0,0 +1,5 @@
+export interface Cat {
+  name: string;
+  age: number;
+  breed: string;
+}
diff --git a/integration/inspector/src/chat/chat.gateway.ts b/integration/inspector/src/chat/chat.gateway.ts
new file mode 100644
index 000000000..75e6c7c28
--- /dev/null
+++ b/integration/inspector/src/chat/chat.gateway.ts
@@ -0,0 +1,38 @@
+import {
+  WebSocketGateway,
+  SubscribeMessage,
+  MessageBody,
+} from '@nestjs/websockets';
+import { ChatService } from './chat.service';
+import { CreateChatDto } from './dto/create-chat.dto';
+import { UpdateChatDto } from './dto/update-chat.dto';
+
+@WebSocketGateway()
+export class ChatGateway {
+  constructor(private readonly chatService: ChatService) {}
+
+  @SubscribeMessage('createChat')
+  create(@MessageBody() createChatDto: CreateChatDto) {
+    return this.chatService.create(createChatDto);
+  }
+
+  @SubscribeMessage('findAllChat')
+  findAll() {
+    return this.chatService.findAll();
+  }
+
+  @SubscribeMessage('findOneChat')
+  findOne(@MessageBody() id: number) {
+    return this.chatService.findOne(id);
+  }
+
+  @SubscribeMessage('updateChat')
+  update(@MessageBody() updateChatDto: UpdateChatDto) {
+    return this.chatService.update(updateChatDto.id, updateChatDto);
+  }
+
+  @SubscribeMessage('removeChat')
+  remove(@MessageBody() id: number) {
+    return this.chatService.remove(id);
+  }
+}
diff --git a/integration/inspector/src/chat/chat.module.ts b/integration/inspector/src/chat/chat.module.ts
new file mode 100644
index 000000000..d3ad301f5
--- /dev/null
+++ b/integration/inspector/src/chat/chat.module.ts
@@ -0,0 +1,8 @@
+import { Module } from '@nestjs/common';
+import { ChatService } from './chat.service';
+import { ChatGateway } from './chat.gateway';
+
+@Module({
+  providers: [ChatGateway, ChatService],
+})
+export class ChatModule {}
diff --git a/integration/inspector/src/chat/chat.service.ts b/integration/inspector/src/chat/chat.service.ts
new file mode 100644
index 000000000..1fa0676de
--- /dev/null
+++ b/integration/inspector/src/chat/chat.service.ts
@@ -0,0 +1,26 @@
+import { Injectable } from '@nestjs/common';
+import { CreateChatDto } from './dto/create-chat.dto';
+import { UpdateChatDto } from './dto/update-chat.dto';
+
+@Injectable()
+export class ChatService {
+  create(createChatDto: CreateChatDto) {
+    return 'This action adds a new chat';
+  }
+
+  findAll() {
+    return `This action returns all chat`;
+  }
+
+  findOne(id: number) {
+    return `This action returns a #${id} chat`;
+  }
+
+  update(id: number, updateChatDto: UpdateChatDto) {
+    return `This action updates a #${id} chat`;
+  }
+
+  remove(id: number) {
+    return `This action removes a #${id} chat`;
+  }
+}
diff --git a/integration/inspector/src/chat/dto/create-chat.dto.ts b/integration/inspector/src/chat/dto/create-chat.dto.ts
new file mode 100644
index 000000000..d9fd9013a
--- /dev/null
+++ b/integration/inspector/src/chat/dto/create-chat.dto.ts
@@ -0,0 +1 @@
+export class CreateChatDto {}
diff --git a/integration/inspector/src/chat/dto/update-chat.dto.ts b/integration/inspector/src/chat/dto/update-chat.dto.ts
new file mode 100644
index 000000000..0a372f666
--- /dev/null
+++ b/integration/inspector/src/chat/dto/update-chat.dto.ts
@@ -0,0 +1,6 @@
+import { PartialType } from '@nestjs/mapped-types';
+import { CreateChatDto } from './create-chat.dto';
+
+export class UpdateChatDto extends PartialType(CreateChatDto) {
+  id: number;
+}
diff --git a/integration/inspector/src/chat/entities/chat.entity.ts b/integration/inspector/src/chat/entities/chat.entity.ts
new file mode 100644
index 000000000..7e881f92f
--- /dev/null
+++ b/integration/inspector/src/chat/entities/chat.entity.ts
@@ -0,0 +1 @@
+export class Chat {}
diff --git a/integration/inspector/src/circular-hello/dto/test.dto.ts b/integration/inspector/src/circular-hello/dto/test.dto.ts
new file mode 100644
index 000000000..b3a30f671
--- /dev/null
+++ b/integration/inspector/src/circular-hello/dto/test.dto.ts
@@ -0,0 +1,10 @@
+import { IsString, IsNotEmpty, IsNumber } from 'class-validator';
+
+export class TestDto {
+  @IsString()
+  @IsNotEmpty()
+  string: string;
+
+  @IsNumber()
+  number: number;
+}
diff --git a/integration/inspector/src/circular-hello/guards/request-scoped.guard.ts b/integration/inspector/src/circular-hello/guards/request-scoped.guard.ts
new file mode 100644
index 000000000..7e5fe1788
--- /dev/null
+++ b/integration/inspector/src/circular-hello/guards/request-scoped.guard.ts
@@ -0,0 +1,21 @@
+import {
+  CanActivate,
+  ExecutionContext,
+  Injectable,
+  Scope,
+} from '@nestjs/common';
+import { Observable } from 'rxjs';
+
+@Injectable({ scope: Scope.REQUEST })
+export class Guard implements CanActivate {
+  static COUNTER = 0;
+  constructor() {
+    Guard.COUNTER++;
+  }
+
+  canActivate(
+    context: ExecutionContext,
+  ): boolean | Promise<boolean> | Observable<boolean> {
+    return true;
+  }
+}
diff --git a/integration/inspector/src/circular-hello/hello.controller.ts b/integration/inspector/src/circular-hello/hello.controller.ts
new file mode 100644
index 000000000..5b4af7bf2
--- /dev/null
+++ b/integration/inspector/src/circular-hello/hello.controller.ts
@@ -0,0 +1,30 @@
+import {
+  Controller,
+  Get,
+  Param,
+  UseGuards,
+  UseInterceptors,
+} from '@nestjs/common';
+import { Guard } from './guards/request-scoped.guard';
+import { HelloService } from './hello.service';
+import { Interceptor } from './interceptors/logging.interceptor';
+import { UserByIdPipe } from './users/user-by-id.pipe';
+import { UsersService } from './users/users.service';
+
+@Controller('hello')
+export class HelloController {
+  static COUNTER = 0;
+  constructor(
+    private readonly helloService: HelloService,
+    private readonly usersService: UsersService,
+  ) {
+    HelloController.COUNTER++;
+  }
+
+  @UseGuards(Guard)
+  @UseInterceptors(Interceptor)
+  @Get()
+  greeting(@Param('id', UserByIdPipe) id): string {
+    return this.helloService.greeting();
+  }
+}
diff --git a/integration/inspector/src/circular-hello/hello.module.ts b/integration/inspector/src/circular-hello/hello.module.ts
new file mode 100644
index 000000000..1a0d0bbfd
--- /dev/null
+++ b/integration/inspector/src/circular-hello/hello.module.ts
@@ -0,0 +1,19 @@
+import { DynamicModule, Inject, Module, Provider } from '@nestjs/common';
+import { HelloController } from './hello.controller';
+import { HelloService } from './hello.service';
+import { UsersService } from './users/users.service';
+
+@Module({
+  controllers: [HelloController],
+  providers: [HelloService, UsersService],
+})
+export class HelloModule {
+  constructor(@Inject('META') private readonly meta) {}
+
+  static forRoot(meta: Provider): DynamicModule {
+    return {
+      module: HelloModule,
+      providers: [meta],
+    };
+  }
+}
diff --git a/integration/inspector/src/circular-hello/hello.service.ts b/integration/inspector/src/circular-hello/hello.service.ts
new file mode 100644
index 000000000..a0a346ebf
--- /dev/null
+++ b/integration/inspector/src/circular-hello/hello.service.ts
@@ -0,0 +1,13 @@
+import { Inject, Injectable, Scope } from '@nestjs/common';
+
+@Injectable({ scope: Scope.REQUEST })
+export class HelloService {
+  static COUNTER = 0;
+  constructor(@Inject('META') private readonly meta) {
+    HelloService.COUNTER++;
+  }
+
+  greeting(): string {
+    return 'Hello world!';
+  }
+}
diff --git a/integration/inspector/src/circular-hello/interceptors/logging.interceptor.ts b/integration/inspector/src/circular-hello/interceptors/logging.interceptor.ts
new file mode 100644
index 000000000..b8b4e5793
--- /dev/null
+++ b/integration/inspector/src/circular-hello/interceptors/logging.interceptor.ts
@@ -0,0 +1,19 @@
+import {
+  CallHandler,
+  ExecutionContext,
+  Injectable,
+  NestInterceptor,
+  Scope,
+} from '@nestjs/common';
+import { Observable } from 'rxjs';
+
+@Injectable({ scope: Scope.REQUEST })
+export class Interceptor implements NestInterceptor {
+  static COUNTER = 0;
+  constructor() {
+    Interceptor.COUNTER++;
+  }
+  intercept(context: ExecutionContext, call: CallHandler): Observable<any> {
+    return call.handle();
+  }
+}
diff --git a/integration/inspector/src/circular-hello/users/user-by-id.pipe.ts b/integration/inspector/src/circular-hello/users/user-by-id.pipe.ts
new file mode 100644
index 000000000..2b81cb6fb
--- /dev/null
+++ b/integration/inspector/src/circular-hello/users/user-by-id.pipe.ts
@@ -0,0 +1,14 @@
+import { ArgumentMetadata, Injectable, PipeTransform } from '@nestjs/common';
+import { UsersService } from './users.service';
+
+@Injectable()
+export class UserByIdPipe implements PipeTransform<string> {
+  static COUNTER = 0;
+  constructor(private readonly usersService: UsersService) {
+    UserByIdPipe.COUNTER++;
+  }
+
+  transform(value: string, metadata: ArgumentMetadata) {
+    return this.usersService.findById(value);
+  }
+}
diff --git a/integration/inspector/src/circular-hello/users/users.service.ts b/integration/inspector/src/circular-hello/users/users.service.ts
new file mode 100644
index 000000000..f1cb617e1
--- /dev/null
+++ b/integration/inspector/src/circular-hello/users/users.service.ts
@@ -0,0 +1,13 @@
+import { Inject, Injectable, Scope } from '@nestjs/common';
+
+@Injectable({ scope: Scope.REQUEST })
+export class UsersService {
+  static COUNTER = 0;
+  constructor(@Inject('META') private readonly meta) {
+    UsersService.COUNTER++;
+  }
+
+  findById(id: string) {
+    return { id };
+  }
+}
diff --git a/integration/inspector/src/circular-modules/circular.module.ts b/integration/inspector/src/circular-modules/circular.module.ts
new file mode 100644
index 000000000..bb6afb42a
--- /dev/null
+++ b/integration/inspector/src/circular-modules/circular.module.ts
@@ -0,0 +1,10 @@
+import { Module, forwardRef } from '@nestjs/common';
+import { CircularService } from './circular.service';
+import { InputModule } from './input.module';
+
+@Module({
+  imports: [forwardRef(() => InputModule)],
+  providers: [CircularService],
+  exports: [CircularService],
+})
+export class CircularModule {}
diff --git a/integration/inspector/src/circular-modules/circular.service.ts b/integration/inspector/src/circular-modules/circular.service.ts
new file mode 100644
index 000000000..546d63e6e
--- /dev/null
+++ b/integration/inspector/src/circular-modules/circular.service.ts
@@ -0,0 +1,10 @@
+import { Injectable, forwardRef, Inject } from '@nestjs/common';
+import { InputService } from './input.service';
+
+@Injectable()
+export class CircularService {
+  constructor(
+    @Inject(forwardRef(() => InputService))
+    public readonly service: InputService,
+  ) {}
+}
diff --git a/integration/inspector/src/circular-modules/input.module.ts b/integration/inspector/src/circular-modules/input.module.ts
new file mode 100644
index 000000000..c76dcaa85
--- /dev/null
+++ b/integration/inspector/src/circular-modules/input.module.ts
@@ -0,0 +1,10 @@
+import { Module, forwardRef } from '@nestjs/common';
+import { CircularModule } from './circular.module';
+import { InputService } from './input.service';
+
+@Module({
+  imports: [forwardRef(() => CircularModule)],
+  providers: [InputService],
+  exports: [InputService],
+})
+export class InputModule {}
diff --git a/integration/inspector/src/circular-modules/input.service.ts b/integration/inspector/src/circular-modules/input.service.ts
new file mode 100644
index 000000000..342e8bf0d
--- /dev/null
+++ b/integration/inspector/src/circular-modules/input.service.ts
@@ -0,0 +1,10 @@
+import { Injectable, Inject, forwardRef } from '@nestjs/common';
+import { CircularService } from './circular.service';
+
+@Injectable()
+export class InputService {
+  constructor(
+    @Inject(forwardRef(() => CircularService))
+    public readonly service: CircularService,
+  ) {}
+}
diff --git a/integration/inspector/src/common/filters/http-exception.filter.ts b/integration/inspector/src/common/filters/http-exception.filter.ts
new file mode 100644
index 000000000..acabf619c
--- /dev/null
+++ b/integration/inspector/src/common/filters/http-exception.filter.ts
@@ -0,0 +1,22 @@
+import {
+  ArgumentsHost,
+  Catch,
+  ExceptionFilter,
+  HttpException,
+} from '@nestjs/common';
+
+@Catch(HttpException)
+export class HttpExceptionFilter implements ExceptionFilter<HttpException> {
+  catch(exception: HttpException, host: ArgumentsHost) {
+    const ctx = host.switchToHttp();
+    const response = ctx.getResponse();
+    const request = ctx.getRequest();
+    const statusCode = exception.getStatus();
+
+    response.status(statusCode).json({
+      statusCode,
+      timestamp: new Date().toISOString(),
+      path: request.url,
+    });
+  }
+}
diff --git a/integration/inspector/src/common/guards/roles.guard.ts b/integration/inspector/src/common/guards/roles.guard.ts
new file mode 100644
index 000000000..0ae26c41d
--- /dev/null
+++ b/integration/inspector/src/common/guards/roles.guard.ts
@@ -0,0 +1,20 @@
+import { CanActivate, ExecutionContext, Injectable } from '@nestjs/common';
+import { Reflector } from '@nestjs/core';
+
+@Injectable()
+export class RolesGuard implements CanActivate {
+  constructor(private readonly reflector: Reflector) {}
+
+  canActivate(context: ExecutionContext): boolean {
+    const roles = this.reflector.get<string[]>('roles', context.getHandler());
+    if (!roles) {
+      return true;
+    }
+    const request = context.switchToHttp().getRequest();
+    const user = request.user;
+    const hasRole = () =>
+      user.roles.some(role => !!roles.find(item => item === role));
+
+    return user && user.roles && hasRole();
+  }
+}
diff --git a/integration/inspector/src/common/interceptors/timeout.interceptor.ts b/integration/inspector/src/common/interceptors/timeout.interceptor.ts
new file mode 100644
index 000000000..3bd0769ac
--- /dev/null
+++ b/integration/inspector/src/common/interceptors/timeout.interceptor.ts
@@ -0,0 +1,15 @@
+import {
+  CallHandler,
+  ExecutionContext,
+  Injectable,
+  NestInterceptor,
+} from '@nestjs/common';
+import { Observable } from 'rxjs';
+import { timeout } from 'rxjs/operators';
+
+@Injectable()
+export class TimeoutInterceptor implements NestInterceptor {
+  intercept(context: ExecutionContext, next: CallHandler): Observable<any> {
+    return next.handle().pipe(timeout(5000));
+  }
+}
diff --git a/integration/inspector/src/common/middleware/logger.middleware.ts b/integration/inspector/src/common/middleware/logger.middleware.ts
new file mode 100644
index 000000000..5ada9418d
--- /dev/null
+++ b/integration/inspector/src/common/middleware/logger.middleware.ts
@@ -0,0 +1,9 @@
+import { Injectable, NestMiddleware } from '@nestjs/common';
+
+@Injectable()
+export class LoggerMiddleware implements NestMiddleware {
+  use(req: any, res: any, next: () => void) {
+    console.log(`Request...`);
+    next();
+  }
+}
diff --git a/integration/inspector/src/common/pipes/parse-int.pipe.ts b/integration/inspector/src/common/pipes/parse-int.pipe.ts
new file mode 100644
index 000000000..abc041424
--- /dev/null
+++ b/integration/inspector/src/common/pipes/parse-int.pipe.ts
@@ -0,0 +1,17 @@
+import {
+  BadRequestException,
+  PipeTransform,
+  Injectable,
+  ArgumentMetadata,
+} from '@nestjs/common';
+
+@Injectable()
+export class ParseIntPipe implements PipeTransform<string> {
+  async transform(value: string, metadata: ArgumentMetadata) {
+    const val = parseInt(value, 10);
+    if (isNaN(val)) {
+      throw new BadRequestException('Validation failed');
+    }
+    return val;
+  }
+}
diff --git a/integration/inspector/src/core/core.module.ts b/integration/inspector/src/core/core.module.ts
new file mode 100644
index 000000000..5bc1990b1
--- /dev/null
+++ b/integration/inspector/src/core/core.module.ts
@@ -0,0 +1,18 @@
+import { MiddlewareConsumer, Module, NestModule } from '@nestjs/common';
+import { APP_INTERCEPTOR } from '@nestjs/core';
+import { CatsController } from '../cats/cats.controller';
+import { LoggerMiddleware } from '../common/middleware/logger.middleware';
+import { LoggingInterceptor } from './interceptors/logging.interceptor';
+import { TransformInterceptor } from './interceptors/transform.interceptor';
+
+@Module({
+  providers: [
+    { provide: APP_INTERCEPTOR, useClass: TransformInterceptor },
+    { provide: APP_INTERCEPTOR, useClass: LoggingInterceptor },
+  ],
+})
+export class CoreModule implements NestModule {
+  configure(consumer: MiddlewareConsumer) {
+    consumer.apply(LoggerMiddleware).forRoutes(CatsController);
+  }
+}
diff --git a/integration/inspector/src/core/interceptors/logging.interceptor.ts b/integration/inspector/src/core/interceptors/logging.interceptor.ts
new file mode 100644
index 000000000..82ff0baa1
--- /dev/null
+++ b/integration/inspector/src/core/interceptors/logging.interceptor.ts
@@ -0,0 +1,20 @@
+import {
+  CallHandler,
+  ExecutionContext,
+  Injectable,
+  NestInterceptor,
+} from '@nestjs/common';
+import { Observable } from 'rxjs';
+import { tap } from 'rxjs/operators';
+
+@Injectable()
+export class LoggingInterceptor implements NestInterceptor {
+  intercept(context: ExecutionContext, next: CallHandler): Observable<any> {
+    console.log('Before...');
+
+    const now = Date.now();
+    return next
+      .handle()
+      .pipe(tap(() => console.log(`After... ${Date.now() - now}ms`)));
+  }
+}
diff --git a/integration/inspector/src/core/interceptors/transform.interceptor.ts b/integration/inspector/src/core/interceptors/transform.interceptor.ts
new file mode 100644
index 000000000..c84c6428f
--- /dev/null
+++ b/integration/inspector/src/core/interceptors/transform.interceptor.ts
@@ -0,0 +1,24 @@
+import {
+  CallHandler,
+  ExecutionContext,
+  Injectable,
+  NestInterceptor,
+} from '@nestjs/common';
+import { Observable } from 'rxjs';
+import { map } from 'rxjs/operators';
+
+export interface Response<T> {
+  data: T;
+}
+
+@Injectable()
+export class TransformInterceptor<T>
+  implements NestInterceptor<T, Response<T>>
+{
+  intercept(
+    context: ExecutionContext,
+    next: CallHandler<T>,
+  ): Observable<Response<T>> {
+    return next.handle().pipe(map(data => ({ data })));
+  }
+}
diff --git a/integration/inspector/src/database/database.controller.ts b/integration/inspector/src/database/database.controller.ts
new file mode 100644
index 000000000..629762ae0
--- /dev/null
+++ b/integration/inspector/src/database/database.controller.ts
@@ -0,0 +1,45 @@
+import {
+  Controller,
+  Get,
+  Post,
+  Body,
+  Patch,
+  Param,
+  Delete,
+} from '@nestjs/common';
+import { DatabaseService } from './database.service';
+import { CreateDatabaseDto } from './dto/create-database.dto';
+import { UpdateDatabaseDto } from './dto/update-database.dto';
+
+@Controller('database')
+export class DatabaseController {
+  constructor(private readonly databaseService: DatabaseService) {}
+
+  @Post()
+  create(@Body() createDatabaseDto: CreateDatabaseDto) {
+    return this.databaseService.create(createDatabaseDto);
+  }
+
+  @Get()
+  findAll() {
+    return this.databaseService.findAll();
+  }
+
+  @Get(':id')
+  findOne(@Param('id') id: string) {
+    return this.databaseService.findOne(+id);
+  }
+
+  @Patch(':id')
+  update(
+    @Param('id') id: string,
+    @Body() updateDatabaseDto: UpdateDatabaseDto,
+  ) {
+    return this.databaseService.update(+id, updateDatabaseDto);
+  }
+
+  @Delete(':id')
+  remove(@Param('id') id: string) {
+    return this.databaseService.remove(+id);
+  }
+}
diff --git a/integration/inspector/src/database/database.module.ts b/integration/inspector/src/database/database.module.ts
new file mode 100644
index 000000000..2f37f674b
--- /dev/null
+++ b/integration/inspector/src/database/database.module.ts
@@ -0,0 +1,9 @@
+import { Module } from '@nestjs/common';
+import { DatabaseService } from './database.service';
+import { DatabaseController } from './database.controller';
+
+@Module({
+  controllers: [DatabaseController],
+  providers: [DatabaseService],
+})
+export class DatabaseModule {}
diff --git a/integration/inspector/src/database/database.service.ts b/integration/inspector/src/database/database.service.ts
new file mode 100644
index 000000000..845667895
--- /dev/null
+++ b/integration/inspector/src/database/database.service.ts
@@ -0,0 +1,26 @@
+import { Injectable } from '@nestjs/common';
+import { CreateDatabaseDto } from './dto/create-database.dto';
+import { UpdateDatabaseDto } from './dto/update-database.dto';
+
+@Injectable()
+export class DatabaseService {
+  create(createDatabaseDto: CreateDatabaseDto) {
+    return 'This action adds a new database';
+  }
+
+  findAll() {
+    return `This action returns all database`;
+  }
+
+  findOne(id: number) {
+    return `This action returns a #${id} database`;
+  }
+
+  update(id: number, updateDatabaseDto: UpdateDatabaseDto) {
+    return `This action updates a #${id} database`;
+  }
+
+  remove(id: number) {
+    return `This action removes a #${id} database`;
+  }
+}
diff --git a/integration/inspector/src/database/dto/create-database.dto.ts b/integration/inspector/src/database/dto/create-database.dto.ts
new file mode 100644
index 000000000..0b7bc753c
--- /dev/null
+++ b/integration/inspector/src/database/dto/create-database.dto.ts
@@ -0,0 +1 @@
+export class CreateDatabaseDto {}
diff --git a/integration/inspector/src/database/dto/update-database.dto.ts b/integration/inspector/src/database/dto/update-database.dto.ts
new file mode 100644
index 000000000..5cc666665
--- /dev/null
+++ b/integration/inspector/src/database/dto/update-database.dto.ts
@@ -0,0 +1,4 @@
+import { PartialType } from '@nestjs/mapped-types';
+import { CreateDatabaseDto } from './create-database.dto';
+
+export class UpdateDatabaseDto extends PartialType(CreateDatabaseDto) {}
diff --git a/integration/inspector/src/database/entities/database.entity.ts b/integration/inspector/src/database/entities/database.entity.ts
new file mode 100644
index 000000000..144f2990d
--- /dev/null
+++ b/integration/inspector/src/database/entities/database.entity.ts
@@ -0,0 +1 @@
+export class Database {}
diff --git a/integration/inspector/src/defaults/core.service.ts b/integration/inspector/src/defaults/core.service.ts
new file mode 100644
index 000000000..acbb46cc2
--- /dev/null
+++ b/integration/inspector/src/defaults/core.service.ts
@@ -0,0 +1,4 @@
+import { Injectable } from '@nestjs/common';
+
+@Injectable()
+export class CoreService {}
diff --git a/integration/inspector/src/defaults/defaults.module.ts b/integration/inspector/src/defaults/defaults.module.ts
new file mode 100644
index 000000000..f8a7ddb9f
--- /dev/null
+++ b/integration/inspector/src/defaults/defaults.module.ts
@@ -0,0 +1,7 @@
+import { Module } from '@nestjs/common';
+import { DefaultsService } from './defaults.service';
+
+@Module({
+  providers: [DefaultsService],
+})
+export class DefaultsModule {}
diff --git a/integration/inspector/src/defaults/defaults.service.ts b/integration/inspector/src/defaults/defaults.service.ts
new file mode 100644
index 000000000..edc4790f1
--- /dev/null
+++ b/integration/inspector/src/defaults/defaults.service.ts
@@ -0,0 +1,11 @@
+import { Inject, Injectable, Optional } from '@nestjs/common';
+import { CoreService } from './core.service';
+
+@Injectable()
+export class DefaultsService {
+  constructor(
+    @Inject(CoreService)
+    @Optional()
+    public readonly coreService = { default: true },
+  ) {}
+}
diff --git a/integration/inspector/src/dogs/dogs.controller.ts b/integration/inspector/src/dogs/dogs.controller.ts
new file mode 100644
index 000000000..8d5ab7d8a
--- /dev/null
+++ b/integration/inspector/src/dogs/dogs.controller.ts
@@ -0,0 +1,42 @@
+import {
+  Controller,
+  Get,
+  Post,
+  Body,
+  Patch,
+  Param,
+  Delete,
+} from '@nestjs/common';
+import { DogsService } from './dogs.service';
+import { CreateDogDto } from './dto/create-dog.dto';
+import { UpdateDogDto } from './dto/update-dog.dto';
+
+@Controller('dogs')
+export class DogsController {
+  constructor(private readonly dogsService: DogsService) {}
+
+  @Post()
+  create(@Body() createDogDto: CreateDogDto) {
+    return this.dogsService.create(createDogDto);
+  }
+
+  @Get()
+  findAll() {
+    return this.dogsService.findAll();
+  }
+
+  @Get(':id')
+  findOne(@Param('id') id: string) {
+    return this.dogsService.findOne(+id);
+  }
+
+  @Patch(':id')
+  update(@Param('id') id: string, @Body() updateDogDto: UpdateDogDto) {
+    return this.dogsService.update(+id, updateDogDto);
+  }
+
+  @Delete(':id')
+  remove(@Param('id') id: string) {
+    return this.dogsService.remove(+id);
+  }
+}
diff --git a/integration/inspector/src/dogs/dogs.module.ts b/integration/inspector/src/dogs/dogs.module.ts
new file mode 100644
index 000000000..3385a39e3
--- /dev/null
+++ b/integration/inspector/src/dogs/dogs.module.ts
@@ -0,0 +1,9 @@
+import { Module } from '@nestjs/common';
+import { DogsService } from './dogs.service';
+import { DogsController } from './dogs.controller';
+
+@Module({
+  controllers: [DogsController],
+  providers: [DogsService],
+})
+export class DogsModule {}
diff --git a/integration/inspector/src/dogs/dogs.service.ts b/integration/inspector/src/dogs/dogs.service.ts
new file mode 100644
index 000000000..f1f2d9347
--- /dev/null
+++ b/integration/inspector/src/dogs/dogs.service.ts
@@ -0,0 +1,26 @@
+import { Injectable } from '@nestjs/common';
+import { CreateDogDto } from './dto/create-dog.dto';
+import { UpdateDogDto } from './dto/update-dog.dto';
+
+@Injectable()
+export class DogsService {
+  create(createDogDto: CreateDogDto) {
+    return 'This action adds a new dog';
+  }
+
+  findAll() {
+    return `This action returns all dogs`;
+  }
+
+  findOne(id: number) {
+    return `This action returns a #${id} dog`;
+  }
+
+  update(id: number, updateDogDto: UpdateDogDto) {
+    return `This action updates a #${id} dog`;
+  }
+
+  remove(id: number) {
+    return `This action removes a #${id} dog`;
+  }
+}
diff --git a/integration/inspector/src/dogs/dto/create-dog.dto.ts b/integration/inspector/src/dogs/dto/create-dog.dto.ts
new file mode 100644
index 000000000..fd21dff8a
--- /dev/null
+++ b/integration/inspector/src/dogs/dto/create-dog.dto.ts
@@ -0,0 +1 @@
+export class CreateDogDto {}
diff --git a/integration/inspector/src/dogs/dto/update-dog.dto.ts b/integration/inspector/src/dogs/dto/update-dog.dto.ts
new file mode 100644
index 000000000..15d4939c8
--- /dev/null
+++ b/integration/inspector/src/dogs/dto/update-dog.dto.ts
@@ -0,0 +1,4 @@
+import { PartialType } from '@nestjs/mapped-types';
+import { CreateDogDto } from './create-dog.dto';
+
+export class UpdateDogDto extends PartialType(CreateDogDto) {}
diff --git a/integration/inspector/src/dogs/entities/dog.entity.ts b/integration/inspector/src/dogs/entities/dog.entity.ts
new file mode 100644
index 000000000..cbd6231a1
--- /dev/null
+++ b/integration/inspector/src/dogs/entities/dog.entity.ts
@@ -0,0 +1 @@
+export class Dog {}
diff --git a/integration/inspector/src/durable/durable-context-id.strategy.ts b/integration/inspector/src/durable/durable-context-id.strategy.ts
new file mode 100644
index 000000000..d4158f3e2
--- /dev/null
+++ b/integration/inspector/src/durable/durable-context-id.strategy.ts
@@ -0,0 +1,23 @@
+import { ContextId, ContextIdStrategy, HostComponentInfo } from '@nestjs/core';
+import { Request } from 'express';
+
+const tenants = new Map<string, ContextId>();
+
+export class DurableContextIdStrategy implements ContextIdStrategy {
+  attach(contextId: ContextId, request: Request) {
+    const tenantId = request.headers['x-tenant-id'] as string;
+    let tenantSubTreeId: ContextId;
+
+    if (tenants.has(tenantId)) {
+      tenantSubTreeId = tenants.get(tenantId);
+    } else {
+      tenantSubTreeId = { id: +tenantId } as ContextId;
+      tenants.set(tenantId, tenantSubTreeId);
+    }
+    return {
+      resolve: (info: HostComponentInfo) =>
+        info.isTreeDurable ? tenantSubTreeId : contextId,
+      payload: { tenantId },
+    };
+  }
+}
diff --git a/integration/inspector/src/durable/durable.controller.ts b/integration/inspector/src/durable/durable.controller.ts
new file mode 100644
index 000000000..be51ad2df
--- /dev/null
+++ b/integration/inspector/src/durable/durable.controller.ts
@@ -0,0 +1,17 @@
+import { Controller, Get } from '@nestjs/common';
+import { DurableService } from './durable.service';
+
+@Controller('durable')
+export class DurableController {
+  constructor(private readonly durableService: DurableService) {}
+
+  @Get()
+  greeting(): string {
+    return this.durableService.greeting();
+  }
+
+  @Get('echo')
+  echo() {
+    return this.durableService.requestPayload;
+  }
+}
diff --git a/integration/inspector/src/durable/durable.module.ts b/integration/inspector/src/durable/durable.module.ts
new file mode 100644
index 000000000..ed312900f
--- /dev/null
+++ b/integration/inspector/src/durable/durable.module.ts
@@ -0,0 +1,9 @@
+import { Module } from '@nestjs/common';
+import { DurableController } from './durable.controller';
+import { DurableService } from './durable.service';
+
+@Module({
+  controllers: [DurableController],
+  providers: [DurableService],
+})
+export class DurableModule {}
diff --git a/integration/inspector/src/durable/durable.service.ts b/integration/inspector/src/durable/durable.service.ts
new file mode 100644
index 000000000..6e25b01dd
--- /dev/null
+++ b/integration/inspector/src/durable/durable.service.ts
@@ -0,0 +1,14 @@
+import { Inject, Injectable, Scope } from '@nestjs/common';
+import { REQUEST } from '@nestjs/core';
+
+@Injectable({ scope: Scope.REQUEST, durable: true })
+export class DurableService {
+  public instanceCounter = 0;
+
+  constructor(@Inject(REQUEST) public readonly requestPayload: unknown) {}
+
+  greeting() {
+    ++this.instanceCounter;
+    return `Hello world! Counter: ${this.instanceCounter}`;
+  }
+}
diff --git a/integration/inspector/src/external-svc/dto/create-external-svc.dto.ts b/integration/inspector/src/external-svc/dto/create-external-svc.dto.ts
new file mode 100644
index 000000000..b37586bc5
--- /dev/null
+++ b/integration/inspector/src/external-svc/dto/create-external-svc.dto.ts
@@ -0,0 +1 @@
+export class CreateExternalSvcDto {}
diff --git a/integration/inspector/src/external-svc/dto/update-external-svc.dto.ts b/integration/inspector/src/external-svc/dto/update-external-svc.dto.ts
new file mode 100644
index 000000000..95be362d9
--- /dev/null
+++ b/integration/inspector/src/external-svc/dto/update-external-svc.dto.ts
@@ -0,0 +1,6 @@
+import { PartialType } from '@nestjs/mapped-types';
+import { CreateExternalSvcDto } from './create-external-svc.dto';
+
+export class UpdateExternalSvcDto extends PartialType(CreateExternalSvcDto) {
+  id: number;
+}
diff --git a/integration/inspector/src/external-svc/entities/external-svc.entity.ts b/integration/inspector/src/external-svc/entities/external-svc.entity.ts
new file mode 100644
index 000000000..645900058
--- /dev/null
+++ b/integration/inspector/src/external-svc/entities/external-svc.entity.ts
@@ -0,0 +1 @@
+export class ExternalSvc {}
diff --git a/integration/inspector/src/external-svc/external-svc.controller.ts b/integration/inspector/src/external-svc/external-svc.controller.ts
new file mode 100644
index 000000000..f2233620f
--- /dev/null
+++ b/integration/inspector/src/external-svc/external-svc.controller.ts
@@ -0,0 +1,38 @@
+import { Controller } from '@nestjs/common';
+import { MessagePattern, Payload } from '@nestjs/microservices';
+import { ExternalSvcService } from './external-svc.service';
+import { CreateExternalSvcDto } from './dto/create-external-svc.dto';
+import { UpdateExternalSvcDto } from './dto/update-external-svc.dto';
+
+@Controller()
+export class ExternalSvcController {
+  constructor(private readonly externalSvcService: ExternalSvcService) {}
+
+  @MessagePattern('createExternalSvc')
+  create(@Payload() createExternalSvcDto: CreateExternalSvcDto) {
+    return this.externalSvcService.create(createExternalSvcDto);
+  }
+
+  @MessagePattern('findAllExternalSvc')
+  findAll() {
+    return this.externalSvcService.findAll();
+  }
+
+  @MessagePattern('findOneExternalSvc')
+  findOne(@Payload() id: number) {
+    return this.externalSvcService.findOne(id);
+  }
+
+  @MessagePattern('updateExternalSvc')
+  update(@Payload() updateExternalSvcDto: UpdateExternalSvcDto) {
+    return this.externalSvcService.update(
+      updateExternalSvcDto.id,
+      updateExternalSvcDto,
+    );
+  }
+
+  @MessagePattern('removeExternalSvc')
+  remove(@Payload() id: number) {
+    return this.externalSvcService.remove(id);
+  }
+}
diff --git a/integration/inspector/src/external-svc/external-svc.module.ts b/integration/inspector/src/external-svc/external-svc.module.ts
new file mode 100644
index 000000000..f4b57fc02
--- /dev/null
+++ b/integration/inspector/src/external-svc/external-svc.module.ts
@@ -0,0 +1,9 @@
+import { Module } from '@nestjs/common';
+import { ExternalSvcService } from './external-svc.service';
+import { ExternalSvcController } from './external-svc.controller';
+
+@Module({
+  controllers: [ExternalSvcController],
+  providers: [ExternalSvcService],
+})
+export class ExternalSvcModule {}
diff --git a/integration/inspector/src/external-svc/external-svc.service.ts b/integration/inspector/src/external-svc/external-svc.service.ts
new file mode 100644
index 000000000..9620630c2
--- /dev/null
+++ b/integration/inspector/src/external-svc/external-svc.service.ts
@@ -0,0 +1,26 @@
+import { Injectable } from '@nestjs/common';
+import { CreateExternalSvcDto } from './dto/create-external-svc.dto';
+import { UpdateExternalSvcDto } from './dto/update-external-svc.dto';
+
+@Injectable()
+export class ExternalSvcService {
+  create(createExternalSvcDto: CreateExternalSvcDto) {
+    return 'This action adds a new externalSvc';
+  }
+
+  findAll() {
+    return `This action returns all externalSvc`;
+  }
+
+  findOne(id: number) {
+    return `This action returns a #${id} externalSvc`;
+  }
+
+  update(id: number, updateExternalSvcDto: UpdateExternalSvcDto) {
+    return `This action updates a #${id} externalSvc`;
+  }
+
+  remove(id: number) {
+    return `This action removes a #${id} externalSvc`;
+  }
+}
diff --git a/integration/inspector/src/properties/dependency.service.ts b/integration/inspector/src/properties/dependency.service.ts
new file mode 100644
index 000000000..cd71d8c80
--- /dev/null
+++ b/integration/inspector/src/properties/dependency.service.ts
@@ -0,0 +1,4 @@
+import { Injectable } from '@nestjs/common';
+
+@Injectable()
+export class DependencyService {}
diff --git a/integration/inspector/src/properties/properties.module.ts b/integration/inspector/src/properties/properties.module.ts
new file mode 100644
index 000000000..b2ad36ff3
--- /dev/null
+++ b/integration/inspector/src/properties/properties.module.ts
@@ -0,0 +1,19 @@
+import { Module } from '@nestjs/common';
+import { DependencyService } from './dependency.service';
+import { PropertiesService, SYMBOL_TOKEN } from './properties.service';
+
+@Module({
+  providers: [
+    DependencyService,
+    PropertiesService,
+    {
+      provide: 'token',
+      useValue: true,
+    },
+    {
+      provide: SYMBOL_TOKEN,
+      useValue: true,
+    },
+  ],
+})
+export class PropertiesModule {}
diff --git a/integration/inspector/src/properties/properties.service.ts b/integration/inspector/src/properties/properties.service.ts
new file mode 100644
index 000000000..cd4507524
--- /dev/null
+++ b/integration/inspector/src/properties/properties.service.ts
@@ -0,0 +1,11 @@
+import { Inject, Injectable } from '@nestjs/common';
+import { DependencyService } from './dependency.service';
+
+export const SYMBOL_TOKEN = Symbol('token');
+
+@Injectable()
+export class PropertiesService {
+  @Inject() service: DependencyService;
+  @Inject('token') token: boolean;
+  @Inject(SYMBOL_TOKEN) symbolToken: boolean;
+}
diff --git a/integration/inspector/src/request-chain/helper/helper.module.ts b/integration/inspector/src/request-chain/helper/helper.module.ts
new file mode 100644
index 000000000..1c154ea44
--- /dev/null
+++ b/integration/inspector/src/request-chain/helper/helper.module.ts
@@ -0,0 +1,8 @@
+import { Module } from '@nestjs/common';
+import { HelperService } from './helper.service';
+
+@Module({
+  providers: [HelperService],
+  exports: [HelperService],
+})
+export class HelperModule {}
diff --git a/integration/inspector/src/request-chain/helper/helper.service.ts b/integration/inspector/src/request-chain/helper/helper.service.ts
new file mode 100644
index 000000000..52efe0eb2
--- /dev/null
+++ b/integration/inspector/src/request-chain/helper/helper.service.ts
@@ -0,0 +1,9 @@
+import { Inject, Injectable, Scope } from '@nestjs/common';
+import { REQUEST } from '@nestjs/core';
+
+@Injectable({ scope: Scope.REQUEST })
+export class HelperService {
+  constructor(@Inject(REQUEST) public readonly request) {}
+
+  public noop() {}
+}
diff --git a/integration/inspector/src/request-chain/interceptors/logging.interceptor.ts b/integration/inspector/src/request-chain/interceptors/logging.interceptor.ts
new file mode 100644
index 000000000..008a69993
--- /dev/null
+++ b/integration/inspector/src/request-chain/interceptors/logging.interceptor.ts
@@ -0,0 +1,21 @@
+import {
+  CallHandler,
+  ExecutionContext,
+  Injectable,
+  NestInterceptor,
+} from '@nestjs/common';
+import { Observable } from 'rxjs';
+import { HelperService } from '../helper/helper.service';
+
+@Injectable()
+export class LoggingInterceptor implements NestInterceptor {
+  constructor(private readonly helperSvc: HelperService) {}
+
+  intercept(context: ExecutionContext, next: CallHandler): Observable<any> {
+    this.helperSvc.noop();
+    if (!this.helperSvc.request) {
+      throw new Error('error');
+    }
+    return next.handle();
+  }
+}
diff --git a/integration/inspector/src/request-chain/request-chain.controller.ts b/integration/inspector/src/request-chain/request-chain.controller.ts
new file mode 100644
index 000000000..03813352d
--- /dev/null
+++ b/integration/inspector/src/request-chain/request-chain.controller.ts
@@ -0,0 +1,14 @@
+import { Controller, Get, UseInterceptors } from '@nestjs/common';
+import { LoggingInterceptor } from './interceptors/logging.interceptor';
+import { RequestChainService } from './request-chain.service';
+
+@Controller('hello')
+export class RequestChainController {
+  constructor(private readonly chainService: RequestChainService) {}
+
+  @UseInterceptors(LoggingInterceptor)
+  @Get()
+  greeting(): void {
+    this.chainService.call();
+  }
+}
diff --git a/integration/inspector/src/request-chain/request-chain.module.ts b/integration/inspector/src/request-chain/request-chain.module.ts
new file mode 100644
index 000000000..eba8f451d
--- /dev/null
+++ b/integration/inspector/src/request-chain/request-chain.module.ts
@@ -0,0 +1,11 @@
+import { Module } from '@nestjs/common';
+import { HelperModule } from './helper/helper.module';
+import { RequestChainController } from './request-chain.controller';
+import { RequestChainService } from './request-chain.service';
+
+@Module({
+  imports: [HelperModule],
+  providers: [RequestChainService],
+  controllers: [RequestChainController],
+})
+export class RequestChainModule {}
diff --git a/integration/inspector/src/request-chain/request-chain.service.ts b/integration/inspector/src/request-chain/request-chain.service.ts
new file mode 100644
index 000000000..c8c00068d
--- /dev/null
+++ b/integration/inspector/src/request-chain/request-chain.service.ts
@@ -0,0 +1,15 @@
+import { Injectable } from '@nestjs/common';
+import { HelperService } from './helper/helper.service';
+
+@Injectable()
+export class RequestChainService {
+  static COUNTER = 0;
+  constructor(private readonly helperService: HelperService) {
+    helperService.noop();
+    RequestChainService.COUNTER += 1;
+  }
+
+  call() {
+    this.helperService.noop();
+  }
+}
diff --git a/integration/inspector/src/users/dto/create-user.dto.ts b/integration/inspector/src/users/dto/create-user.dto.ts
new file mode 100644
index 000000000..0311be138
--- /dev/null
+++ b/integration/inspector/src/users/dto/create-user.dto.ts
@@ -0,0 +1 @@
+export class CreateUserDto {}
diff --git a/integration/inspector/src/users/dto/update-user.dto.ts b/integration/inspector/src/users/dto/update-user.dto.ts
new file mode 100644
index 000000000..dfd37fb1e
--- /dev/null
+++ b/integration/inspector/src/users/dto/update-user.dto.ts
@@ -0,0 +1,4 @@
+import { PartialType } from '@nestjs/mapped-types';
+import { CreateUserDto } from './create-user.dto';
+
+export class UpdateUserDto extends PartialType(CreateUserDto) {}
diff --git a/integration/inspector/src/users/entities/user.entity.ts b/integration/inspector/src/users/entities/user.entity.ts
new file mode 100644
index 000000000..4f82c1457
--- /dev/null
+++ b/integration/inspector/src/users/entities/user.entity.ts
@@ -0,0 +1 @@
+export class User {}
diff --git a/integration/inspector/src/users/users.controller.ts b/integration/inspector/src/users/users.controller.ts
new file mode 100644
index 000000000..d5db3a65e
--- /dev/null
+++ b/integration/inspector/src/users/users.controller.ts
@@ -0,0 +1,42 @@
+import {
+  Controller,
+  Get,
+  Post,
+  Body,
+  Patch,
+  Param,
+  Delete,
+} from '@nestjs/common';
+import { UsersService } from './users.service';
+import { CreateUserDto } from './dto/create-user.dto';
+import { UpdateUserDto } from './dto/update-user.dto';
+
+@Controller('users')
+export class UsersController {
+  constructor(private readonly usersService: UsersService) {}
+
+  @Post()
+  create(@Body() createUserDto: CreateUserDto) {
+    return this.usersService.create(createUserDto);
+  }
+
+  @Get()
+  findAll() {
+    return this.usersService.findAll();
+  }
+
+  @Get(':id')
+  findOne(@Param('id') id: string) {
+    return this.usersService.findOne(+id);
+  }
+
+  @Patch(':id')
+  update(@Param('id') id: string, @Body() updateUserDto: UpdateUserDto) {
+    return this.usersService.update(+id, updateUserDto);
+  }
+
+  @Delete(':id')
+  remove(@Param('id') id: string) {
+    return this.usersService.remove(+id);
+  }
+}
diff --git a/integration/inspector/src/users/users.module.ts b/integration/inspector/src/users/users.module.ts
new file mode 100644
index 000000000..ecca17ad6
--- /dev/null
+++ b/integration/inspector/src/users/users.module.ts
@@ -0,0 +1,9 @@
+import { Module } from '@nestjs/common';
+import { UsersService } from './users.service';
+import { UsersController } from './users.controller';
+
+@Module({
+  controllers: [UsersController],
+  providers: [UsersService],
+})
+export class UsersModule {}
diff --git a/integration/inspector/src/users/users.service.ts b/integration/inspector/src/users/users.service.ts
new file mode 100644
index 000000000..0a55903da
--- /dev/null
+++ b/integration/inspector/src/users/users.service.ts
@@ -0,0 +1,26 @@
+import { Injectable } from '@nestjs/common';
+import { CreateUserDto } from './dto/create-user.dto';
+import { UpdateUserDto } from './dto/update-user.dto';
+
+@Injectable()
+export class UsersService {
+  create(createUserDto: CreateUserDto) {
+    return 'This action adds a new user';
+  }
+
+  findAll() {
+    return `This action returns all users`;
+  }
+
+  findOne(id: number) {
+    return `This action returns a #${id} user`;
+  }
+
+  update(id: number, updateUserDto: UpdateUserDto) {
+    return `This action updates a #${id} user`;
+  }
+
+  remove(id: number) {
+    return `This action removes a #${id} user`;
+  }
+}
diff --git a/integration/inspector/tsconfig.json b/integration/inspector/tsconfig.json
new file mode 100644
index 000000000..cef623d14
--- /dev/null
+++ b/integration/inspector/tsconfig.json
@@ -0,0 +1,40 @@
+{
+  "compilerOptions": {
+    "module": "commonjs",
+    "declaration": false,
+    "noImplicitAny": false,
+    "removeComments": true,
+    "noLib": false,
+    "emitDecoratorMetadata": true,
+    "experimentalDecorators": true,
+    "target": "ES2021",
+    "sourceMap": true,
+    "allowJs": true,
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
+  },
+  "include": [
+    "src/**/*",
+    "e2e/**/*"
+  ],
+  "exclude": [
+    "node_modules",
+  ]
+}
\ No newline at end of file
diff --git a/integration/microservices/e2e/broadcast-mqtt.spec.ts b/integration/microservices/e2e/broadcast-mqtt.spec.ts
index 6ace4d6b5..641bf442a 100644
--- a/integration/microservices/e2e/broadcast-mqtt.spec.ts
+++ b/integration/microservices/e2e/broadcast-mqtt.spec.ts
@@ -1,5 +1,5 @@
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
 import { MqttBroadcastController } from '../src/mqtt/mqtt-broadcast.controller';
@@ -16,13 +16,13 @@ describe('MQTT transport', () => {
     app = module.createNestApplication();
     server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.MQTT,
       options: {
         host: '0.0.0.0',
       },
     });
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.MQTT,
       options: {
         host: '0.0.0.0',
diff --git a/integration/microservices/e2e/broadcast-nats.spec.ts b/integration/microservices/e2e/broadcast-nats.spec.ts
index ecd45cd15..b8cf69b50 100644
--- a/integration/microservices/e2e/broadcast-nats.spec.ts
+++ b/integration/microservices/e2e/broadcast-nats.spec.ts
@@ -1,5 +1,5 @@
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
 import { NatsBroadcastController } from '../src/nats/nats-broadcast.controller';
@@ -16,13 +16,13 @@ describe('NATS transport', () => {
     app = module.createNestApplication();
     server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.NATS,
       options: {
         servers: 'nats://0.0.0.0:4222',
       },
     });
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.NATS,
       options: {
         servers: 'servers://0.0.0.0:4222',
diff --git a/integration/microservices/e2e/broadcast-redis.spec.ts b/integration/microservices/e2e/broadcast-redis.spec.ts
index 2a9106f2f..1cf8690ef 100644
--- a/integration/microservices/e2e/broadcast-redis.spec.ts
+++ b/integration/microservices/e2e/broadcast-redis.spec.ts
@@ -1,5 +1,5 @@
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
 import { RedisBroadcastController } from '../src/redis/redis-broadcast.controller';
@@ -16,16 +16,18 @@ describe('REDIS transport', () => {
     app = module.createNestApplication();
     server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.REDIS,
       options: {
-        url: 'redis://0.0.0.0:6379',
+        host: '0.0.0.0',
+        port: 6379,
       },
     });
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.REDIS,
       options: {
-        url: 'redis://0.0.0.0:6379',
+        host: '0.0.0.0',
+        port: 6379,
       },
     });
     await app.startAllMicroservices();
diff --git a/integration/microservices/e2e/concurrent-kafka.spec.ts b/integration/microservices/e2e/concurrent-kafka.spec.ts
index f50a7b329..86be67f77 100644
--- a/integration/microservices/e2e/concurrent-kafka.spec.ts
+++ b/integration/microservices/e2e/concurrent-kafka.spec.ts
@@ -1,5 +1,5 @@
 import { INestApplication, Logger } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import { Admin, ITopicMetadata, Kafka } from 'kafkajs';
 import * as request from 'supertest';
@@ -37,7 +37,7 @@ describe.skip('Kafka concurrent', function () {
 
     const server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.KAFKA,
       options: {
         client: {
diff --git a/integration/microservices/e2e/disconnected-client.spec.ts b/integration/microservices/e2e/disconnected-client.spec.ts
index dcd4c03cc..35b65dfb6 100644
--- a/integration/microservices/e2e/disconnected-client.spec.ts
+++ b/integration/microservices/e2e/disconnected-client.spec.ts
@@ -34,7 +34,7 @@ describe('Disconnected client', () => {
       .send({
         transport: Transport.REDIS,
         options: {
-          url: 'redis://localhost:3333',
+          port: '3333',
         },
       })
       .expect(408);
@@ -65,6 +65,19 @@ describe('Disconnected client', () => {
       .expect(408);
   });
 
+  it(`RMQ`, () => {
+    return request(server)
+      .post('/')
+      .send({
+        transport: Transport.RMQ,
+        options: {
+          urls: [`amqp://0.0.0.0:3333`],
+          queue: 'test',
+        },
+      })
+      .expect(408);
+  });
+
   afterEach(async () => {
     await app.close();
   });
diff --git a/integration/microservices/e2e/mqtt-record-builder.spec.ts b/integration/microservices/e2e/mqtt-record-builder.spec.ts
index 1edfddb2e..94d57d5be 100644
--- a/integration/microservices/e2e/mqtt-record-builder.spec.ts
+++ b/integration/microservices/e2e/mqtt-record-builder.spec.ts
@@ -1,5 +1,5 @@
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
 import { MqttController } from '../src/mqtt/mqtt.controller';
@@ -16,7 +16,7 @@ describe('MQTT transport', () => {
     app = module.createNestApplication();
     server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.MQTT,
       options: {
         url: 'mqtt://0.0.0.0:1883',
diff --git a/integration/microservices/e2e/orders-grpc.spec.ts b/integration/microservices/e2e/orders-grpc.spec.ts
index 82f1d69e0..e34864f91 100644
--- a/integration/microservices/e2e/orders-grpc.spec.ts
+++ b/integration/microservices/e2e/orders-grpc.spec.ts
@@ -1,7 +1,7 @@
 import * as GRPC from '@grpc/grpc-js';
 import * as ProtoLoader from '@grpc/proto-loader';
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { ExpressAdapter } from '@nestjs/platform-express';
 import { Test } from '@nestjs/testing';
 import { fail } from 'assert';
@@ -26,7 +26,7 @@ describe('Advanced GRPC transport', () => {
     /*
      *  Create microservice configuration
      */
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.GRPC,
       options: {
         url: 'localhost:5001',
@@ -134,7 +134,7 @@ describe('Advanced GRPC transport', () => {
     callHandler.on('error', (err: any) => {
       // We want to fail only on real errors while Cancellation error
       // is expected
-      if (String(err).toLowerCase().indexOf('cancelled') === -1) {
+      if (!String(err).toLowerCase().includes('cancelled')) {
         fail('gRPC Stream error happened, error: ' + err);
       }
     });
@@ -166,7 +166,7 @@ describe('Advanced GRPC transport', () => {
     callHandler.on('error', (err: any) => {
       // We want to fail only on real errors while Cancellation error
       // is expected
-      if (String(err).toLowerCase().indexOf('cancelled') === -1) {
+      if (!String(err).toLowerCase().includes('cancelled')) {
         fail('gRPC Stream error happened, error: ' + err);
       }
     });
diff --git a/integration/microservices/e2e/sum-grpc.spec.ts b/integration/microservices/e2e/sum-grpc.spec.ts
index 23cc9a886..cd6459e50 100644
--- a/integration/microservices/e2e/sum-grpc.spec.ts
+++ b/integration/microservices/e2e/sum-grpc.spec.ts
@@ -1,7 +1,7 @@
 import * as GRPC from '@grpc/grpc-js';
 import * as ProtoLoader from '@grpc/proto-loader';
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import { fail } from 'assert';
 import { expect } from 'chai';
@@ -22,7 +22,7 @@ describe('GRPC transport', () => {
     app = module.createNestApplication();
     server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.GRPC,
       options: {
         package: ['math', 'math2'],
@@ -48,11 +48,28 @@ describe('GRPC transport', () => {
     );
   });
 
-  it(`GRPC Sending and Receiving HTTP POST`, () => {
-    return request(server)
+  it(`GRPC Sending and Receiving HTTP POST`, async () => {
+    await request(server)
       .post('/sum')
       .send([1, 2, 3, 4, 5])
       .expect(200, { result: 15 });
+
+    await request(server)
+      .post('/upperMethod/sum')
+      .send([1, 2, 3, 4, 5])
+      .expect(200, { result: 15 });
+  });
+
+  it(`GRPC Receiving serialized Error`, async () => {
+    await request(server)
+      .post('/error?client=standard')
+      .expect(200)
+      .expect('false');
+
+    await request(server)
+      .post('/error?client=custom')
+      .expect(200)
+      .expect('true');
   });
 
   it(`GRPC Sending and Receiving HTTP POST (multiple proto)`, async () => {
@@ -78,7 +95,7 @@ describe('GRPC transport', () => {
     callHandler.on('error', (err: any) => {
       // We want to fail only on real errors while Cancellation error
       // is expected
-      if (String(err).toLowerCase().indexOf('cancelled') === -1) {
+      if (!String(err).toLowerCase().includes('cancelled')) {
         fail('gRPC Stream error happened, error: ' + err);
       }
     });
@@ -100,7 +117,7 @@ describe('GRPC transport', () => {
     callHandler.on('error', (err: any) => {
       // We want to fail only on real errors while Cancellation error
       // is expected
-      if (String(err).toLowerCase().indexOf('cancelled') === -1) {
+      if (!String(err).toLowerCase().includes('cancelled')) {
         fail('gRPC Stream error happened, error: ' + err);
       }
     });
diff --git a/integration/microservices/e2e/sum-kafka.spec.ts b/integration/microservices/e2e/sum-kafka.spec.ts
index 9fee99b9a..0ab86ec73 100644
--- a/integration/microservices/e2e/sum-kafka.spec.ts
+++ b/integration/microservices/e2e/sum-kafka.spec.ts
@@ -1,5 +1,5 @@
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import { expect } from 'chai';
 import * as request from 'supertest';
@@ -29,7 +29,7 @@ describe.skip('Kafka transport', function () {
     app = module.createNestApplication();
     server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.KAFKA,
       options: {
         client: {
diff --git a/integration/microservices/e2e/sum-mqtt.spec.ts b/integration/microservices/e2e/sum-mqtt.spec.ts
index 7d81b9f1f..5cbce8a9c 100644
--- a/integration/microservices/e2e/sum-mqtt.spec.ts
+++ b/integration/microservices/e2e/sum-mqtt.spec.ts
@@ -1,5 +1,5 @@
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import { expect } from 'chai';
 import * as request from 'supertest';
@@ -17,7 +17,7 @@ describe('MQTT transport', () => {
     app = module.createNestApplication();
     server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.MQTT,
       options: {
         url: 'mqtt://0.0.0.0:1883',
@@ -47,7 +47,7 @@ describe('MQTT transport', () => {
       .post('/?command=streamSum')
       .send([1, 2, 3, 4, 5])
       .expect(200, '15');
-  });
+  }).timeout(5000);
 
   it(`/POST (concurrent)`, function () {
     return request(server)
@@ -72,7 +72,7 @@ describe('MQTT transport', () => {
       .post('/stream')
       .send([1, 2, 3, 4, 5])
       .expect(200, '15');
-  });
+  }).timeout(5000);
 
   it(`/POST (event notification)`, done => {
     request(server)
@@ -124,6 +124,44 @@ describe('MQTT transport', () => {
       .expect(201, '15');
   });
 
+  it(`/POST (shared wildcard EVENT #)`, done => {
+    request(server)
+      .post('/shared-wildcard-event')
+      .send([1, 2, 3, 4, 5])
+      .end(() => {
+        setTimeout(() => {
+          expect(MqttController.IS_SHARED_WILDCARD_EVENT_RECEIVED).to.be.true;
+          done();
+        }, 1000);
+      });
+  });
+
+  it(`/POST (shared wildcard MESSAGE #)`, () => {
+    return request(server)
+      .post('/shared-wildcard-message')
+      .send([1, 2, 3, 4, 5])
+      .expect(201, '15');
+  });
+
+  it(`/POST (shared wildcard EVENT +)`, done => {
+    request(server)
+      .post('/shared-wildcard-event2')
+      .send([1, 2, 3, 4, 5])
+      .end(() => {
+        setTimeout(() => {
+          expect(MqttController.IS_SHARED_WILDCARD2_EVENT_RECEIVED).to.be.true;
+          done();
+        }, 1000);
+      });
+  });
+
+  it(`/POST (shared wildcard MESSAGE +)`, () => {
+    return request(server)
+      .post('/shared-wildcard-message2')
+      .send([1, 2, 3, 4, 5])
+      .expect(201, '15');
+  });
+
   afterEach(async () => {
     await app.close();
   });
diff --git a/integration/microservices/e2e/sum-nats.spec.ts b/integration/microservices/e2e/sum-nats.spec.ts
index 6944535ae..7206d60ba 100644
--- a/integration/microservices/e2e/sum-nats.spec.ts
+++ b/integration/microservices/e2e/sum-nats.spec.ts
@@ -1,5 +1,5 @@
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import { expect } from 'chai';
 import * as request from 'supertest';
@@ -19,7 +19,7 @@ describe('NATS transport', () => {
     app = module.createNestApplication();
     server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.NATS,
       options: {
         servers: 'nats://0.0.0.0:4222',
diff --git a/integration/microservices/e2e/sum-redis.spec.ts b/integration/microservices/e2e/sum-redis.spec.ts
index 15b698573..10a9e396a 100644
--- a/integration/microservices/e2e/sum-redis.spec.ts
+++ b/integration/microservices/e2e/sum-redis.spec.ts
@@ -1,5 +1,5 @@
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import { expect } from 'chai';
 import * as request from 'supertest';
@@ -17,10 +17,11 @@ describe('REDIS transport', () => {
     app = module.createNestApplication();
     server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.REDIS,
       options: {
-        url: 'redis://0.0.0.0:6379',
+        host: '0.0.0.0',
+        port: 6379,
       },
     });
     await app.startAllMicroservices();
diff --git a/integration/microservices/e2e/sum-rmq.spec.ts b/integration/microservices/e2e/sum-rmq.spec.ts
index f5f0e0a36..0d23de554 100644
--- a/integration/microservices/e2e/sum-rmq.spec.ts
+++ b/integration/microservices/e2e/sum-rmq.spec.ts
@@ -1,5 +1,5 @@
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import { expect } from 'chai';
 import * as request from 'supertest';
@@ -17,7 +17,7 @@ describe('RabbitMQ transport', () => {
     app = module.createNestApplication();
     server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.RMQ,
       options: {
         urls: [`amqp://0.0.0.0:5672`],
@@ -77,6 +77,13 @@ describe('RabbitMQ transport', () => {
       .expect(200, '15');
   });
 
+  it(`/POST (multiple-urls)`, () => {
+    return request(server)
+      .post('/multiple-urls')
+      .send([1, 2, 3, 4, 5])
+      .expect(200, '15');
+  }).timeout(10000);
+
   it(`/POST (event notification)`, done => {
     request(server)
       .post('/notify')
diff --git a/integration/microservices/e2e/sum-rpc-tls.spec.ts b/integration/microservices/e2e/sum-rpc-tls.spec.ts
new file mode 100644
index 000000000..e32a726df
--- /dev/null
+++ b/integration/microservices/e2e/sum-rpc-tls.spec.ts
@@ -0,0 +1,142 @@
+import { INestApplication } from '@nestjs/common';
+import { Transport } from '@nestjs/microservices';
+import { Test } from '@nestjs/testing';
+import { expect } from 'chai';
+import * as request from 'supertest';
+import { AppController } from '../src/tcp-tls/app.controller';
+import { ApplicationModule } from '../src/tcp-tls/app.module';
+import * as fs from 'fs';
+import * as path from 'path';
+
+describe('RPC TLS transport', () => {
+  let server;
+  let app: INestApplication;
+  let key: string;
+  let cert: string;
+
+  before(() => {
+    // Generate a self-signed key pair
+    key = fs
+      .readFileSync(path.join(__dirname, '../src/tcp-tls/privkey.pem'), 'utf8')
+      .toString();
+    cert = fs
+      .readFileSync(path.join(__dirname, '../src/tcp-tls/ca.cert.pem'), 'utf8')
+      .toString();
+  });
+
+  beforeEach(async () => {
+    const module = await Test.createTestingModule({
+      imports: [ApplicationModule],
+    }).compile();
+
+    app = module.createNestApplication();
+    server = app.getHttpAdapter().getInstance();
+
+    app.connectMicroservice({
+      transport: Transport.TCP,
+      options: {
+        host: '0.0.0.0',
+        tlsOptions: { key: key, cert: cert },
+      },
+    });
+    await app.startAllMicroservices();
+    await app.init();
+  });
+
+  it(`/POST TLS`, () => {
+    return request(server)
+      .post('/?command=sum')
+      .send([1, 2, 3, 4, 5])
+      .expect(200, '15');
+  });
+
+  it(`/POST (Promise/async)`, () => {
+    return request(server)
+      .post('/?command=asyncSum')
+      .send([1, 2, 3, 4, 5])
+      .expect(200)
+      .expect(200, '15');
+  });
+
+  it(`/POST (Observable stream)`, () => {
+    return request(server)
+      .post('/?command=streamSum')
+      .send([1, 2, 3, 4, 5])
+      .expect(200, '15');
+  });
+
+  it(`/POST (useFactory client)`, () => {
+    return request(server)
+      .post('/useFactory?command=sum')
+      .send([1, 2, 3, 4, 5])
+      .expect(200, '15');
+  });
+
+  it(`/POST (useClass client)`, () => {
+    return request(server)
+      .post('/useClass?command=sum')
+      .send([1, 2, 3, 4, 5])
+      .expect(200, '15');
+  });
+
+  it(`/POST (concurrent)`, () => {
+    return request(server)
+      .post('/concurrent')
+      .send([
+        Array.from({ length: 10 }, (v, k) => k + 1),
+        Array.from({ length: 10 }, (v, k) => k + 11),
+        Array.from({ length: 10 }, (v, k) => k + 21),
+        Array.from({ length: 10 }, (v, k) => k + 31),
+        Array.from({ length: 10 }, (v, k) => k + 41),
+        Array.from({ length: 10 }, (v, k) => k + 51),
+        Array.from({ length: 10 }, (v, k) => k + 61),
+        Array.from({ length: 10 }, (v, k) => k + 71),
+        Array.from({ length: 10 }, (v, k) => k + 81),
+        Array.from({ length: 10 }, (v, k) => k + 91),
+      ])
+      .expect(200, 'true');
+  });
+
+  it(`/POST (streaming)`, () => {
+    return request(server)
+      .post('/stream')
+      .send([1, 2, 3, 4, 5])
+      .expect(200, '15');
+  });
+
+  it(`/POST (pattern not found)`, () => {
+    return request(server).post('/?command=test').expect(500);
+  });
+
+  it(`/POST (event notification)`, done => {
+    request(server)
+      .post('/notify')
+      .send([1, 2, 3, 4, 5])
+      .end(() => {
+        setTimeout(() => {
+          expect(AppController.IS_NOTIFIED).to.be.true;
+          done();
+        }, 1000);
+      });
+  });
+
+  it('/POST (custom client)', () => {
+    return request(server)
+      .post('/error?client=custom')
+      .send({})
+      .expect(200)
+      .expect('true');
+  });
+
+  it('/POST (standard client)', () => {
+    return request(server)
+      .post('/error?client=standard')
+      .send({})
+      .expect(200)
+      .expect('false');
+  });
+
+  afterEach(async () => {
+    await app.close();
+  });
+});
diff --git a/integration/microservices/e2e/sum-rpc.spec.ts b/integration/microservices/e2e/sum-rpc.spec.ts
index 85cf67705..648d7a117 100644
--- a/integration/microservices/e2e/sum-rpc.spec.ts
+++ b/integration/microservices/e2e/sum-rpc.spec.ts
@@ -1,10 +1,10 @@
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import { expect } from 'chai';
 import * as request from 'supertest';
 import { AppController } from '../src/app.controller';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 describe('RPC transport', () => {
   let server;
@@ -12,13 +12,13 @@ describe('RPC transport', () => {
 
   beforeEach(async () => {
     const module = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
 
     app = module.createNestApplication();
     server = app.getHttpAdapter().getInstance();
 
-    app.connectMicroservice({
+    app.connectMicroservice<MicroserviceOptions>({
       transport: Transport.TCP,
       options: {
         host: '0.0.0.0',
diff --git a/integration/microservices/src/app.module.ts b/integration/microservices/src/app.module.ts
index c9ac72909..dacf646e4 100644
--- a/integration/microservices/src/app.module.ts
+++ b/integration/microservices/src/app.module.ts
@@ -72,4 +72,4 @@ class ClientOptionService implements ClientsModuleOptionsFactory {
   ],
   controllers: [AppController],
 })
-export class ApplicationModule {}
+export class AppModule {}
diff --git a/integration/microservices/src/disconnected.controller.ts b/integration/microservices/src/disconnected.controller.ts
index 0f529c948..a804614a7 100644
--- a/integration/microservices/src/disconnected.controller.ts
+++ b/integration/microservices/src/disconnected.controller.ts
@@ -15,16 +15,17 @@ export class DisconnectedClientController {
   call(@Body() options): Observable<number> {
     const client = ClientProxyFactory.create(options);
     return client.send<number, number[]>({ cmd: 'none' }, [1, 2, 3]).pipe(
-      /*tap(
-          console.log.bind(console, 'data'),
-          console.error.bind(console, 'error'),
-        ),*/
+      // tap(
+      //   console.log.bind(console, 'data'),
+      //   console.error.bind(console, 'error'),
+      // ),
       catchError(error => {
-        const { code } = error || { code: 'CONN_ERR' };
+        const { code } = error?.err ?? error ?? { code: 'CONN_ERR' };
         return throwError(() =>
           code === 'ECONNREFUSED' ||
           code === 'CONN_ERR' ||
-          code === 'CONNECTION_REFUSED'
+          code === 'CONNECTION_REFUSED' ||
+          error.message === 'Connection is closed.'
             ? new RequestTimeoutException('ECONNREFUSED')
             : new InternalServerErrorException(),
         );
diff --git a/integration/microservices/src/grpc-advanced/advanced.grpc.controller.ts b/integration/microservices/src/grpc-advanced/advanced.grpc.controller.ts
index 930644909..e4aa0234b 100644
--- a/integration/microservices/src/grpc-advanced/advanced.grpc.controller.ts
+++ b/integration/microservices/src/grpc-advanced/advanced.grpc.controller.ts
@@ -134,8 +134,8 @@ export class AdvancedGrpcController {
   async streamReq(messages: Observable<any>): Promise<any> {
     const s = new Subject();
     const o = s.asObservable();
-    messages.subscribe(
-      msg => {
+    messages.subscribe({
+      next: () => {
         s.next({
           id: 1,
           itemTypes: [1],
@@ -146,9 +146,8 @@ export class AdvancedGrpcController {
           },
         });
       },
-      null,
-      () => s.complete(),
-    );
+      complete: () => s.complete(),
+    });
     return o;
   }
 
diff --git a/integration/microservices/src/grpc/grpc.controller.ts b/integration/microservices/src/grpc/grpc.controller.ts
index 9414de5f2..11c75e37b 100644
--- a/integration/microservices/src/grpc/grpc.controller.ts
+++ b/integration/microservices/src/grpc/grpc.controller.ts
@@ -1,4 +1,4 @@
-import { Body, Controller, HttpCode, Post } from '@nestjs/common';
+import { Body, Controller, HttpCode, Post, Query } from '@nestjs/common';
 import {
   Client,
   ClientGrpc,
@@ -6,12 +6,28 @@ import {
   GrpcStreamCall,
   GrpcStreamMethod,
   Transport,
+  ClientGrpcProxy,
+  RpcException,
 } from '@nestjs/microservices';
 import { join } from 'path';
-import { Observable, of } from 'rxjs';
+import { Observable, of, catchError } from 'rxjs';
+
+class ErrorHandlingProxy extends ClientGrpcProxy {
+  serializeError(err) {
+    return new RpcException(err);
+  }
+}
 
 @Controller()
 export class GrpcController {
+  private readonly customClient: ClientGrpc;
+  constructor() {
+    this.customClient = new ErrorHandlingProxy({
+      package: 'math',
+      protoPath: join(__dirname, 'math.proto'),
+    });
+  }
+
   @Client({
     transport: Transport.GRPC,
     options: {
@@ -40,6 +56,14 @@ export class GrpcController {
     return svc.sum({ data });
   }
 
+  // Test that getService generate both lower and uppercase method
+  @Post('upperMethod/sum')
+  @HttpCode(200)
+  callWithOptions(@Body() data: number[]): Observable<number> {
+    const svc = this.client.getService<any>('Math');
+    return svc.Sum({ data });
+  }
+
   @GrpcMethod('Math')
   async sum({ data }: { data: number[] }): Promise<any> {
     return of({
@@ -50,16 +74,16 @@ export class GrpcController {
   @GrpcStreamMethod('Math')
   async sumStream(messages: Observable<any>): Promise<any> {
     return new Promise<any>((resolve, reject) => {
-      messages.subscribe(
-        msg => {
+      messages.subscribe({
+        next: msg => {
           resolve({
             result: msg.data.reduce((a, b) => a + b),
           });
         },
-        err => {
+        error: err => {
           reject(err);
         },
-      );
+      });
     });
   }
 
@@ -70,6 +94,19 @@ export class GrpcController {
     });
   }
 
+  @GrpcMethod('Math')
+  async divide(request: { dividend: number; divisor: number }): Promise<any> {
+    if (request.divisor === 0) {
+      throw new RpcException({
+        code: 3,
+        message: 'dividing by 0 is not possible',
+      });
+    }
+    return {
+      result: request.dividend / request.divisor,
+    };
+  }
+
   @GrpcMethod('Math2')
   async sum2({ data }: { data: number[] }): Promise<any> {
     return of({
@@ -90,4 +127,24 @@ export class GrpcController {
     const svc = this.clientMulti.getService<any>('Math2');
     return svc.sum2({ data });
   }
+
+  @Post('error')
+  @HttpCode(200)
+  serializeError(
+    @Query('client') query: 'custom' | 'standard' = 'standard',
+    @Body() body: Record<string, any>,
+  ): Observable<boolean> {
+    const client = query === 'custom' ? this.customClient : this.client;
+    const svc = client.getService<any>('Math');
+
+    const errorDivideRequest = {
+      dividend: 1,
+      divisor: 0,
+    };
+    return svc.divide(errorDivideRequest).pipe(
+      catchError(err => {
+        return of(err instanceof RpcException);
+      }),
+    );
+  }
 }
diff --git a/integration/microservices/src/grpc/math.proto b/integration/microservices/src/grpc/math.proto
index 43c835cb7..0ca9b3509 100644
--- a/integration/microservices/src/grpc/math.proto
+++ b/integration/microservices/src/grpc/math.proto
@@ -6,6 +6,7 @@ service Math {
   rpc Sum (RequestSum) returns (SumResult);
   rpc SumStream(stream RequestSum) returns(stream SumResult);
   rpc SumStreamPass(stream RequestSum) returns(stream SumResult);
+  rpc Divide (RequestDivide) returns (DivideResult);
 }
 
 message SumResult {
@@ -14,4 +15,13 @@ message SumResult {
 
 message RequestSum {
   repeated int32 data = 1;
-}
\ No newline at end of file
+}
+
+message RequestDivide {
+  int32 dividend = 1;
+  int32 divisor = 2 ;
+}
+
+message DivideResult {
+  int32 result = 1;
+}
diff --git a/integration/microservices/src/mqtt/mqtt.controller.ts b/integration/microservices/src/mqtt/mqtt.controller.ts
index c8d813efa..72de41d5c 100644
--- a/integration/microservices/src/mqtt/mqtt.controller.ts
+++ b/integration/microservices/src/mqtt/mqtt.controller.ts
@@ -18,6 +18,8 @@ export class MqttController {
   static IS_NOTIFIED = false;
   static IS_WILDCARD_EVENT_RECEIVED = false;
   static IS_WILDCARD2_EVENT_RECEIVED = false;
+  static IS_SHARED_WILDCARD_EVENT_RECEIVED = false;
+  static IS_SHARED_WILDCARD2_EVENT_RECEIVED = false;
 
   @Client({ transport: Transport.MQTT })
   client: ClientProxy;
@@ -93,7 +95,7 @@ export class MqttController {
   @Post('record-builder-duplex')
   @HttpCode(200)
   useRecordBuilderDuplex(@Body() data: Record<string, any>) {
-    const record = new MqttRecordBuilder(data).setQoS(2).build();
+    const record = new MqttRecordBuilder(data).setQoS(1).build();
     return this.client.send('record-builder-duplex', record);
   }
 
@@ -109,6 +111,32 @@ export class MqttController {
     };
   }
 
+  @Post('shared-wildcard-event')
+  async sendSharedWildcardEvent(): Promise<any> {
+    return this.client.emit<number>('shared-wildcard-event/test', true);
+  }
+
+  @Post('shared-wildcard-message')
+  async sendSharedWildcardMessage(
+    @Body() data: number[],
+  ): Promise<Observable<number>> {
+    await this.client.connect();
+    return this.client.send<number>('shared-wildcard-message/test', data);
+  }
+
+  @Post('shared-wildcard-event2')
+  async sendSharedWildcardEvent2(): Promise<any> {
+    return this.client.emit<number>('shared-wildcard-event2/test/test', true);
+  }
+
+  @Post('shared-wildcard-message2')
+  async sendSharedWildcardMessage2(
+    @Body() data: number[],
+  ): Promise<Observable<number>> {
+    await this.client.connect();
+    return this.client.send<number>('shared-wildcard-message2/test/test', data);
+  }
+
   @MessagePattern('wildcard-message/#')
   wildcardMessageHandler(data: number[]): number {
     if ((data as any).response) {
@@ -156,4 +184,27 @@ export class MqttController {
   streaming(data: number[]): Observable<number> {
     return from(data);
   }
+
+  @MessagePattern('$share/test-group/shared-wildcard-message/#')
+  sharedWildcardMessageHandler(data: number[]): number {
+    if ((data as any).response) {
+      return;
+    }
+    return (data || []).reduce((a, b) => a + b);
+  }
+
+  @EventPattern('$share/test-group/shared-wildcard-event/#')
+  sharedWildcardEventHandler(data: boolean) {
+    MqttController.IS_SHARED_WILDCARD_EVENT_RECEIVED = data;
+  }
+
+  @MessagePattern('$share/test-group/shared-wildcard-message2/+/test')
+  sharedWildcardMessageHandler2(data: number[]): number {
+    return (data || []).reduce((a, b) => a + b);
+  }
+
+  @EventPattern('$share/test-group/shared-wildcard-event2/+/test')
+  sharedWildcardEventHandler2(data: boolean) {
+    MqttController.IS_SHARED_WILDCARD2_EVENT_RECEIVED = data;
+  }
 }
diff --git a/integration/microservices/src/rmq/rmq.controller.ts b/integration/microservices/src/rmq/rmq.controller.ts
index 932bb46a9..07f8075e6 100644
--- a/integration/microservices/src/rmq/rmq.controller.ts
+++ b/integration/microservices/src/rmq/rmq.controller.ts
@@ -61,6 +61,21 @@ export class RMQController {
       .reduce(async (a, b) => (await a) && b);
   }
 
+  @Post('multiple-urls')
+  @HttpCode(200)
+  multipleUrls(@Body() data: number[]) {
+    const clientWithMultipleUrls = ClientProxyFactory.create({
+      transport: Transport.RMQ,
+      options: {
+        urls: [`amqp://localhost:5671`, `amqp://localhost:5672`],
+        queue: 'test',
+        queueOptions: { durable: false },
+        socketOptions: { noDelay: true },
+      },
+    });
+    return clientWithMultipleUrls.send<number>({ cmd: 'multiple-urls' }, data);
+  }
+
   @Post('record-builder-duplex')
   @HttpCode(200)
   useRecordBuilderDuplex(@Body() data: Record<string, any>) {
@@ -109,6 +124,11 @@ export class RMQController {
     return from(data);
   }
 
+  @MessagePattern({ cmd: 'multiple-urls' })
+  handleMultipleUrls(data: number[]): number {
+    return (data || []).reduce((a, b) => a + b);
+  }
+
   @Post('notify')
   async sendNotification(): Promise<any> {
     return this.client.emit<number>('notification', true);
diff --git a/integration/microservices/src/tcp-tls/app.controller.ts b/integration/microservices/src/tcp-tls/app.controller.ts
new file mode 100644
index 000000000..81101741f
--- /dev/null
+++ b/integration/microservices/src/tcp-tls/app.controller.ts
@@ -0,0 +1,141 @@
+import {
+  Body,
+  Controller,
+  HttpCode,
+  Inject,
+  Post,
+  Query,
+} from '@nestjs/common';
+import {
+  Client,
+  ClientProxy,
+  EventPattern,
+  MessagePattern,
+  RpcException,
+  Transport,
+} from '@nestjs/microservices';
+import { from, lastValueFrom, Observable, of, throwError } from 'rxjs';
+import { catchError, scan } from 'rxjs/operators';
+import * as fs from 'fs';
+import * as path from 'path';
+
+@Controller()
+export class AppController {
+  constructor(
+    @Inject('USE_CLASS_CLIENT') private useClassClient: ClientProxy,
+    @Inject('USE_FACTORY_CLIENT') private useFactoryClient: ClientProxy,
+    @Inject('CUSTOM_PROXY_CLIENT') private customClient: ClientProxy,
+  ) {}
+  static IS_NOTIFIED = false;
+
+  @Client({
+    transport: Transport.TCP,
+    options: {
+      tlsOptions: {
+        ca: [
+          fs
+            .readFileSync(path.join(__dirname, 'ca.cert.pem'), 'utf-8')
+            .toString(),
+        ],
+      },
+    },
+  })
+  client: ClientProxy;
+
+  @Post()
+  @HttpCode(200)
+  call(@Query('command') cmd, @Body() data: number[]): Observable<number> {
+    return this.client.send<number>({ cmd }, data);
+  }
+
+  @Post('useFactory')
+  @HttpCode(200)
+  callWithClientUseFactory(
+    @Query('command') cmd,
+    @Body() data: number[],
+  ): Observable<number> {
+    return this.useFactoryClient.send<number>({ cmd }, data);
+  }
+
+  @Post('useClass')
+  @HttpCode(200)
+  callWithClientUseClass(
+    @Query('command') cmd,
+    @Body() data: number[],
+  ): Observable<number> {
+    return this.useClassClient.send<number>({ cmd }, data);
+  }
+
+  @Post('stream')
+  @HttpCode(200)
+  stream(@Body() data: number[]): Observable<number> {
+    return this.client
+      .send<number>({ cmd: 'streaming' }, data)
+      .pipe(scan((a, b) => a + b));
+  }
+
+  @Post('concurrent')
+  @HttpCode(200)
+  concurrent(@Body() data: number[][]): Promise<boolean> {
+    const send = async (tab: number[]) => {
+      const expected = tab.reduce((a, b) => a + b);
+      const result = await lastValueFrom(
+        this.client.send<number>({ cmd: 'sum' }, tab),
+      );
+
+      return result === expected;
+    };
+    return data
+      .map(async tab => send(tab))
+      .reduce(async (a, b) => (await a) && b);
+  }
+
+  @Post('error')
+  @HttpCode(200)
+  serializeError(
+    @Query('client') query: 'custom' | 'standard' = 'standard',
+    @Body() body: Record<string, any>,
+  ): Observable<boolean> {
+    const client = query === 'custom' ? this.customClient : this.client;
+    return client.send({ cmd: 'err' }, {}).pipe(
+      catchError(err => {
+        return of(err instanceof RpcException);
+      }),
+    );
+  }
+
+  @MessagePattern({ cmd: 'sum' })
+  sum(data: number[]): number {
+    return (data || []).reduce((a, b) => a + b);
+  }
+
+  @MessagePattern({ cmd: 'asyncSum' })
+  async asyncSum(data: number[]): Promise<number> {
+    return (data || []).reduce((a, b) => a + b);
+  }
+
+  @MessagePattern({ cmd: 'streamSum' })
+  streamSum(data: number[]): Observable<number> {
+    return of((data || []).reduce((a, b) => a + b));
+  }
+
+  @MessagePattern({ cmd: 'streaming' })
+  streaming(data: number[]): Observable<number> {
+    return from(data);
+  }
+
+  @MessagePattern({ cmd: 'err' })
+  throwAnError() {
+    return throwError(() => new Error('err'));
+  }
+
+  @Post('notify')
+  async sendNotification(): Promise<any> {
+    return this.client.emit<number>('notification', true);
+  }
+
+  @EventPattern('notification')
+  eventHandler(data: boolean) {
+    AppController.IS_NOTIFIED = data;
+  }
+}
diff --git a/integration/microservices/src/tcp-tls/app.module.ts b/integration/microservices/src/tcp-tls/app.module.ts
new file mode 100644
index 000000000..79a167886
--- /dev/null
+++ b/integration/microservices/src/tcp-tls/app.module.ts
@@ -0,0 +1,90 @@
+import { Module, Injectable } from '@nestjs/common';
+import { AppController } from './app.controller';
+import {
+  ClientsModule,
+  Transport,
+  ClientsModuleOptionsFactory,
+  ClientOptions,
+  ClientTCP,
+  RpcException,
+} from '@nestjs/microservices';
+
+import * as fs from 'fs';
+import * as path from 'path';
+
+const caCert = fs.readFileSync(path.join(__dirname, 'ca.cert.pem')).toString();
+
+class ErrorHandlingProxy extends ClientTCP {
+  constructor() {
+    super({
+      tlsOptions: { ca: caCert },
+    });
+  }
+
+  serializeError(err) {
+    return new RpcException(err);
+  }
+}
+
+@Injectable()
+class ConfigService {
+  private readonly config = {
+    transport: Transport.TCP,
+  };
+  get(key: string, defaultValue?: any) {
+    return this.config[key] || defaultValue;
+  }
+}
+
+@Module({
+  providers: [ConfigService],
+  exports: [ConfigService],
+})
+class ConfigModule {}
+
+@Injectable()
+class ClientOptionService implements ClientsModuleOptionsFactory {
+  constructor(private readonly configService: ConfigService) {}
+  createClientOptions(): Promise<ClientOptions> | ClientOptions {
+    return {
+      transport: this.configService.get('transport'),
+      options: {
+        tlsOptions: { ca: caCert },
+      },
+    };
+  }
+}
+
+@Module({
+  imports: [
+    ClientsModule.registerAsync([
+      {
+        imports: [ConfigModule],
+        name: 'USE_FACTORY_CLIENT',
+        useFactory: (configService: ConfigService) => ({
+          transport: configService.get('transport'),
+          options: {
+            tlsOptions: { ca: caCert },
+          },
+        }),
+        inject: [ConfigService],
+      },
+      {
+        imports: [ConfigModule],
+        name: 'USE_CLASS_CLIENT',
+        useClass: ClientOptionService,
+        inject: [ConfigService],
+      },
+      {
+        imports: [ConfigModule],
+        inject: [ConfigService],
+        name: 'CUSTOM_PROXY_CLIENT',
+        useFactory: (config: ConfigService) => ({
+          customClass: ErrorHandlingProxy,
+        }),
+      },
+    ]),
+  ],
+  controllers: [AppController],
+})
+export class ApplicationModule {}
diff --git a/integration/microservices/src/tcp-tls/ca.cert.pem b/integration/microservices/src/tcp-tls/ca.cert.pem
new file mode 100644
index 000000000..dbc7d8a77
--- /dev/null
+++ b/integration/microservices/src/tcp-tls/ca.cert.pem
@@ -0,0 +1,17 @@
+-----BEGIN CERTIFICATE-----
+MIICpDCCAYwCCQCyP27z3r0PFjANBgkqhkiG9w0BAQsFADAUMRIwEAYDVQQDDAls
+b2NhbGhvc3QwHhcNMjIxMjAyMDQ0NTQ1WhcNMzIxMTI5MDQ0NTQ1WjAUMRIwEAYD
+VQQDDAlsb2NhbGhvc3QwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDZ
+1IdZZXqrwXql4AIOJnlfpoGKOKoIalnK7KaKHTsq1QOF8z2abFuNBVIIrO0etQ/0
+PPAaFGkXl6HHBuA5PrFpsw3V1wSnNs1Cns9NhvypHI2V71lkwBJrEaSicNWL2AOE
+QkQ9cZ4YsTGd0BrM8D5VvgXdrC7gOXfj7Hx3E4K+wFO/Gi4AUXl5CXxleSFcW4U+
+jFulfq/DE8rBZXs29IsGeVkkgUoICjQ4Ey4zE6EY7f3SPKgU8gfgzYyGSd/ZZ/E7
+6M2yakEUX448Nl4BeuNWroBHVm1pSiMo+Cm1g34pJScPrx1yw6qquziCc/2n1M6O
+B4WGIZAmJDWnAOEjjrxFAgMBAAEwDQYJKoZIhvcNAQELBQADggEBAABGByZZUjaq
+ZygICSH2qUGHPPIyrfaCe0qM7de6kYfxxPYQQZb0HDynzv780Lq1002XeT02fNR+
+5sBCVFuKvS8BNvTq6kHzO1FiWIk/E5fQcYNToYSeEcXgWFLhJMty7+R6sIc9y8PH
+2YNehf78Jjm9ukM52sLc4+JWl7AEeqPrOHZdh/ve8M2gTfimFKTrW5cEAVPIOPhp
+2t5BdDKt8ZxgrGC7iRxga+v80VUOHRGfrd3hf3NlDQZO8upVGY8DdJhPRDB72+R0
+kzJ7eyQwlGXM20atiFxPk43h0f273MneIJG8NgGiVU0ND4XnZkAB3KSAu7pB+nEw
+QRYMYDgo/8Q=
+-----END CERTIFICATE-----
diff --git a/integration/microservices/src/tcp-tls/privkey.pem b/integration/microservices/src/tcp-tls/privkey.pem
new file mode 100644
index 000000000..f8a90acff
--- /dev/null
+++ b/integration/microservices/src/tcp-tls/privkey.pem
@@ -0,0 +1,28 @@
+-----BEGIN PRIVATE KEY-----
+MIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQDZ1IdZZXqrwXql
+4AIOJnlfpoGKOKoIalnK7KaKHTsq1QOF8z2abFuNBVIIrO0etQ/0PPAaFGkXl6HH
+BuA5PrFpsw3V1wSnNs1Cns9NhvypHI2V71lkwBJrEaSicNWL2AOEQkQ9cZ4YsTGd
+0BrM8D5VvgXdrC7gOXfj7Hx3E4K+wFO/Gi4AUXl5CXxleSFcW4U+jFulfq/DE8rB
+ZXs29IsGeVkkgUoICjQ4Ey4zE6EY7f3SPKgU8gfgzYyGSd/ZZ/E76M2yakEUX448
+Nl4BeuNWroBHVm1pSiMo+Cm1g34pJScPrx1yw6qquziCc/2n1M6OB4WGIZAmJDWn
+AOEjjrxFAgMBAAECggEANUKZtWnyjHxKGLSkzADsPE7h7YHdUSFvwwYJ0ktDZD2h
+FudacJ994wUiAa0GbTOoKvebXUUQTQxuKdOsj1Kc3lNBVr+0C46CsX9TAIm4zUCF
+/dr/6HpuBm/R6UXdcMvoUDZDqSJWnYL1trhjVSiIlT5ZANJQw9JJVhlEdXj3xtuc
+I9aC+33f9hKO1wzei/mTjIRGyRIeKselZPpA7qJnE4s3hmZxnO/rSqyPIvh1XLfZ
+3Eoyyg+xNpTZ8JqlHB5d7hDSnj8cjboa7IYpHJDXN3r8Aui+R9e/sQkezHbF7fR0
+xHpBVYQvGMuqSnTBkdJfq4qPAR1K49UrpEXB2GHaIQKBgQDs3t/ZUA138AiPIeLd
+aTsEPhf5dWEZynfNvXZ0VcoSr8ckaiaq9OEllprAriYWj+XphTDsBUAh/R7KlOR4
+eb+m6OwH7LseGiLIEr54GGP0LzVXAkfH2/uR1cak8qAmHB00jNEg7sj0eVAsHO3f
+WQm67f+RNP/IgAa+V8JKIkgTwwKBgQDrbAH8eAQsq9rjpxcic1EUI7uFHzr+cKf/
+4Y8ThLUNAzNfAbQWRBYjS1R8GM79Wiuh+WT1ooHKLryuLF7LVukvKHJ5GiNFBmaO
+llf72Zf1y4tBE2RCXQbf6h8+ohSDC/hwYy+w20/i2KzSBKkS0+gQuAX/HzfTpRd3
+q3/uEniXVwKBgDNnElDIbIPQlSrqgZ7mzSXYi79Y15+PLnx5VxFb5KQ1fRPL7WRA
+C/PqQN77a8yNoakRfFJbuVUm5t2zffkfApYoCcCWgOzBYzbjym2pbVd6PysIlacr
+d+Zn69mzxUk/5J6YyHFLIFTdVqacCIrleZUVPNa4F6HdFpmL1d/cnKOdAoGAMDuB
+sKsaF9jh0LBkEf/URa8IdT6vxH9qPAeHW7VdrpvQQ4/CyKkMbBC772zZw5hcxiOl
+Zpnzw2uN5pVamohk3++GfH85aKPmESKGRigPdSFNl3iUmvAaP3flDN0CHNMwBD6d
+/7r/A/fmeGTSCvR1YC+DswA/XNI/G5p8bFdGc6MCgYBd9oQiZlkYMiDGPUAjx+DO
+kqtAmc8DLJEanSbWdIxL2bGL04cgBRPssM4m0UScx4PucvqWEPdN/5Ug0z5TrD77
+2K5nZSBUdy4DunBImz1NHRQEiytkrYX0LesGr02QlzIH4wmwb1TFu7rLkr6KfNuV
+xqWi+JVY8N4vuHAxCeEALw==
+-----END PRIVATE KEY-----
\ No newline at end of file
diff --git a/integration/microservices/tsconfig.json b/integration/microservices/tsconfig.json
index c6354c564..cef623d14 100644
--- a/integration/microservices/tsconfig.json
+++ b/integration/microservices/tsconfig.json
@@ -7,10 +7,28 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
diff --git a/integration/module-utils/src/integration.module-definition.ts b/integration/module-utils/src/integration.module-definition.ts
new file mode 100644
index 000000000..89d7a9842
--- /dev/null
+++ b/integration/module-utils/src/integration.module-definition.ts
@@ -0,0 +1,17 @@
+import { ConfigurableModuleBuilder } from '@nestjs/common';
+import { IntegrationModuleOptions } from './interfaces/integration-module-options.interface';
+
+export const { ConfigurableModuleClass, MODULE_OPTIONS_TOKEN } =
+  new ConfigurableModuleBuilder<IntegrationModuleOptions>()
+    .setClassMethodName('forRoot')
+    .setFactoryMethodName('construct')
+    .setExtras(
+      {
+        isGlobal: true,
+      },
+      (definition, extras) => ({
+        ...definition,
+        global: extras.isGlobal,
+      }),
+    )
+    .build();
diff --git a/integration/module-utils/src/integration.module.ts b/integration/module-utils/src/integration.module.ts
new file mode 100644
index 000000000..3b994f4bd
--- /dev/null
+++ b/integration/module-utils/src/integration.module.ts
@@ -0,0 +1,16 @@
+import { Inject, Module } from '@nestjs/common';
+import {
+  ConfigurableModuleClass,
+  MODULE_OPTIONS_TOKEN,
+} from './integration.module-definition';
+import { IntegrationModuleOptions } from './interfaces/integration-module-options.interface';
+
+@Module({})
+export class IntegrationModule extends ConfigurableModuleClass {
+  constructor(
+    @Inject(MODULE_OPTIONS_TOKEN)
+    public readonly options: IntegrationModuleOptions,
+  ) {
+    super();
+  }
+}
diff --git a/integration/module-utils/src/interfaces/integration-module-options.interface.ts b/integration/module-utils/src/interfaces/integration-module-options.interface.ts
new file mode 100644
index 000000000..802e02076
--- /dev/null
+++ b/integration/module-utils/src/interfaces/integration-module-options.interface.ts
@@ -0,0 +1,4 @@
+export interface IntegrationModuleOptions {
+  url: string;
+  secure?: boolean;
+}
diff --git a/integration/module-utils/test/integration-module.spec.ts b/integration/module-utils/test/integration-module.spec.ts
new file mode 100644
index 000000000..ea22a71c5
--- /dev/null
+++ b/integration/module-utils/test/integration-module.spec.ts
@@ -0,0 +1,47 @@
+import { Test } from '@nestjs/testing';
+import { expect } from 'chai';
+import { IntegrationModule } from '../src/integration.module';
+
+describe('Module utils (ConfigurableModuleBuilder)', () => {
+  it('should auto-generate "forRoot" method', async () => {
+    const moduleRef = await Test.createTestingModule({
+      imports: [
+        IntegrationModule.forRoot({
+          isGlobal: true,
+          url: 'test_url',
+          secure: false,
+        }),
+      ],
+    }).compile();
+
+    const integrationModule = moduleRef.get(IntegrationModule);
+
+    expect(integrationModule.options).to.deep.equal({
+      url: 'test_url',
+      secure: false,
+    });
+  });
+
+  it('should auto-generate "forRootAsync" method', async () => {
+    const moduleRef = await Test.createTestingModule({
+      imports: [
+        IntegrationModule.forRootAsync({
+          isGlobal: true,
+          useFactory: () => {
+            return {
+              url: 'test_url',
+              secure: false,
+            };
+          },
+        }),
+      ],
+    }).compile();
+
+    const integrationModule = moduleRef.get(IntegrationModule);
+
+    expect(integrationModule.options).to.deep.equal({
+      url: 'test_url',
+      secure: false,
+    });
+  });
+});
diff --git a/integration/module-utils/tsconfig.json b/integration/module-utils/tsconfig.json
new file mode 100644
index 000000000..cef623d14
--- /dev/null
+++ b/integration/module-utils/tsconfig.json
@@ -0,0 +1,40 @@
+{
+  "compilerOptions": {
+    "module": "commonjs",
+    "declaration": false,
+    "noImplicitAny": false,
+    "removeComments": true,
+    "noLib": false,
+    "emitDecoratorMetadata": true,
+    "experimentalDecorators": true,
+    "target": "ES2021",
+    "sourceMap": true,
+    "allowJs": true,
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
+  },
+  "include": [
+    "src/**/*",
+    "e2e/**/*"
+  ],
+  "exclude": [
+    "node_modules",
+  ]
+}
\ No newline at end of file
diff --git a/integration/mongoose/tsconfig.json b/integration/mongoose/tsconfig.json
index ea15af490..cef623d14 100644
--- a/integration/mongoose/tsconfig.json
+++ b/integration/mongoose/tsconfig.json
@@ -7,16 +7,34 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
-    "src/**/*"
+    "src/**/*",
+    "e2e/**/*"
   ],
   "exclude": [
     "node_modules",
-    "**/*.spec.ts"
   ]
 }
\ No newline at end of file
diff --git a/integration/mosquitto.conf b/integration/mosquitto.conf
new file mode 100644
index 000000000..440823741
--- /dev/null
+++ b/integration/mosquitto.conf
@@ -0,0 +1,906 @@
+# Config file for mosquitto
+#
+# See mosquitto.conf(5) for more information.
+#
+# Default values are shown, uncomment to change.
+#
+# Use the # character to indicate a comment, but only if it is the
+# very first character on the line.
+
+# =================================================================
+# General configuration
+# =================================================================
+
+# Use per listener security settings.
+#
+# It is recommended this option be set before any other options.
+#
+# If this option is set to true, then all authentication and access control
+# options are controlled on a per listener basis. The following options are
+# affected:
+#
+# acl_file
+# allow_anonymous
+# allow_zero_length_clientid
+# auto_id_prefix
+# password_file
+# plugin
+# plugin_opt_*
+# psk_file
+#
+# Note that if set to true, then a durable client (i.e. with clean session set
+# to false) that has disconnected will use the ACL settings defined for the
+# listener that it was most recently connected to.
+#
+# The default behaviour is for this to be set to false, which maintains the
+# setting behaviour from previous versions of mosquitto.
+#per_listener_settings false
+
+
+# This option controls whether a client is allowed to connect with a zero
+# length client id or not. This option only affects clients using MQTT v3.1.1
+# and later. If set to false, clients connecting with a zero length client id
+# are disconnected. If set to true, clients will be allocated a client id by
+# the broker. This means it is only useful for clients with clean session set
+# to true.
+#allow_zero_length_clientid true
+
+# If allow_zero_length_clientid is true, this option allows you to set a prefix
+# to automatically generated client ids to aid visibility in logs.
+# Defaults to 'auto-'
+#auto_id_prefix auto-
+
+# This option affects the scenario when a client subscribes to a topic that has
+# retained messages. It is possible that the client that published the retained
+# message to the topic had access at the time they published, but that access
+# has been subsequently removed. If check_retain_source is set to true, the
+# default, the source of a retained message will be checked for access rights
+# before it is republished. When set to false, no check will be made and the
+# retained message will always be published. This affects all listeners.
+#check_retain_source true
+
+# QoS 1 and 2 messages will be allowed inflight per client until this limit
+# is exceeded.  Defaults to 0. (No maximum)
+# See also max_inflight_messages
+#max_inflight_bytes 0
+
+# The maximum number of QoS 1 and 2 messages currently inflight per
+# client.
+# This includes messages that are partway through handshakes and
+# those that are being retried. Defaults to 20. Set to 0 for no
+# maximum. Setting to 1 will guarantee in-order delivery of QoS 1
+# and 2 messages.
+#max_inflight_messages 20
+
+# For MQTT v5 clients, it is possible to have the server send a "server
+# keepalive" value that will override the keepalive value set by the client.
+# This is intended to be used as a mechanism to say that the server will
+# disconnect the client earlier than it anticipated, and that the client should
+# use the new keepalive value. The max_keepalive option allows you to specify
+# that clients may only connect with keepalive less than or equal to this
+# value, otherwise they will be sent a server keepalive telling them to use
+# max_keepalive. This only applies to MQTT v5 clients. The default, and maximum
+# value allowable, is 65535.
+#
+# Set to 0 to allow clients to set keepalive = 0, which means no keepalive
+# checks are made and the client will never be disconnected by the broker if no
+# messages are received. You should be very sure this is the behaviour that you
+# want.
+#
+# For MQTT v3.1.1 and v3.1 clients, there is no mechanism to tell the client
+# what keepalive value they should use. If an MQTT v3.1.1 or v3.1 client
+# specifies a keepalive time greater than max_keepalive they will be sent a
+# CONNACK message with the "identifier rejected" reason code, and disconnected.
+#
+#max_keepalive 65535
+
+# For MQTT v5 clients, it is possible to have the server send a "maximum packet
+# size" value that will instruct the client it will not accept MQTT packets
+# with size greater than max_packet_size bytes. This applies to the full MQTT
+# packet, not just the payload. Setting this option to a positive value will
+# set the maximum packet size to that number of bytes. If a client sends a
+# packet which is larger than this value, it will be disconnected. This applies
+# to all clients regardless of the protocol version they are using, but v3.1.1
+# and earlier clients will of course not have received the maximum packet size
+# information. Defaults to no limit. Setting below 20 bytes is forbidden
+# because it is likely to interfere with ordinary client operation, even with
+# very small payloads.
+#max_packet_size 0
+
+# QoS 1 and 2 messages above those currently in-flight will be queued per
+# client until this limit is exceeded.  Defaults to 0. (No maximum)
+# See also max_queued_messages.
+# If both max_queued_messages and max_queued_bytes are specified, packets will
+# be queued until the first limit is reached.
+#max_queued_bytes 0
+
+# Set the maximum QoS supported. Clients publishing at a QoS higher than
+# specified here will be disconnected.
+#max_qos 2
+
+# The maximum number of QoS 1 and 2 messages to hold in a queue per client
+# above those that are currently in-flight.  Defaults to 1000. Set
+# to 0 for no maximum (not recommended).
+# See also queue_qos0_messages.
+# See also max_queued_bytes.
+#max_queued_messages 1000
+#
+# This option sets the maximum number of heap memory bytes that the broker will
+# allocate, and hence sets a hard limit on memory use by the broker.  Memory
+# requests that exceed this value will be denied. The effect will vary
+# depending on what has been denied. If an incoming message is being processed,
+# then the message will be dropped and the publishing client will be
+# disconnected. If an outgoing message is being sent, then the individual
+# message will be dropped and the receiving client will be disconnected.
+# Defaults to no limit.
+#memory_limit 0
+
+# This option sets the maximum publish payload size that the broker will allow.
+# Received messages that exceed this size will not be accepted by the broker.
+# The default value is 0, which means that all valid MQTT messages are
+# accepted. MQTT imposes a maximum payload size of 268435455 bytes.
+#message_size_limit 0
+
+# This option allows persistent clients (those with clean session set to false)
+# to be removed if they do not reconnect within a certain time frame.
+#
+# This is a non-standard option in MQTT V3.1 but allowed in MQTT v3.1.1.
+#
+# Badly designed clients may set clean session to false whilst using a randomly
+# generated client id. This leads to persistent clients that will never
+# reconnect. This option allows these clients to be removed.
+#
+# The expiration period should be an integer followed by one of h d w m y for
+# hour, day, week, month and year respectively. For example
+#
+# persistent_client_expiration 2m
+# persistent_client_expiration 14d
+# persistent_client_expiration 1y
+#
+# The default if not set is to never expire persistent clients.
+#persistent_client_expiration
+
+# Write process id to a file. Default is a blank string which means
+# a pid file shouldn't be written.
+# This should be set to /var/run/mosquitto/mosquitto.pid if mosquitto is
+# being run automatically on boot with an init script and
+# start-stop-daemon or similar.
+#pid_file
+
+# Set to true to queue messages with QoS 0 when a persistent client is
+# disconnected. These messages are included in the limit imposed by
+# max_queued_messages and max_queued_bytes
+# Defaults to false.
+# This is a non-standard option for the MQTT v3.1 spec but is allowed in
+# v3.1.1.
+#queue_qos0_messages false
+
+# Set to false to disable retained message support. If a client publishes a
+# message with the retain bit set, it will be disconnected if this is set to
+# false.
+#retain_available true
+
+# Disable Nagle's algorithm on client sockets. This has the effect of reducing
+# latency of individual messages at the potential cost of increasing the number
+# of packets being sent.
+#set_tcp_nodelay false
+
+# Time in seconds between updates of the $SYS tree.
+# Set to 0 to disable the publishing of the $SYS tree.
+#sys_interval 10
+
+# The MQTT specification requires that the QoS of a message delivered to a
+# subscriber is never upgraded to match the QoS of the subscription. Enabling
+# this option changes this behaviour. If upgrade_outgoing_qos is set true,
+# messages sent to a subscriber will always match the QoS of its subscription.
+# This is a non-standard option explicitly disallowed by the spec.
+#upgrade_outgoing_qos false
+
+# When run as root, drop privileges to this user and its primary
+# group.
+# Set to root to stay as root, but this is not recommended.
+# If set to "mosquitto", or left unset, and the "mosquitto" user does not exist
+# then it will drop privileges to the "nobody" user instead.
+# If run as a non-root user, this setting has no effect.
+# Note that on Windows this has no effect and so mosquitto should be started by
+# the user you wish it to run as.
+#user mosquitto
+
+# =================================================================
+# Listeners
+# =================================================================
+
+# Listen on a port/ip address combination. By using this variable
+# multiple times, mosquitto can listen on more than one port. If
+# this variable is used and neither bind_address nor port given,
+# then the default listener will not be started.
+# The port number to listen on must be given. Optionally, an ip
+# address or host name may be supplied as a second argument. In
+# this case, mosquitto will attempt to bind the listener to that
+# address and so restrict access to the associated network and
+# interface. By default, mosquitto will listen on all interfaces.
+# Note that for a websockets listener it is not possible to bind to a host
+# name.
+#
+# On systems that support Unix Domain Sockets, it is also possible
+# to create a # Unix socket rather than opening a TCP socket. In
+# this case, the port number should be set to 0 and a unix socket
+# path must be provided, e.g.
+# listener 0 /tmp/mosquitto.sock
+#
+# listener port-number [ip address/host name/unix socket path]
+#listener
+
+# By default, a listener will attempt to listen on all supported IP protocol
+# versions. If you do not have an IPv4 or IPv6 interface you may wish to
+# disable support for either of those protocol versions. In particular, note
+# that due to the limitations of the websockets library, it will only ever
+# attempt to open IPv6 sockets if IPv6 support is compiled in, and so will fail
+# if IPv6 is not available.
+#
+# Set to `ipv4` to force the listener to only use IPv4, or set to `ipv6` to
+# force the listener to only use IPv6. If you want support for both IPv4 and
+# IPv6, then do not use the socket_domain option.
+#
+#socket_domain
+
+# Bind the listener to a specific interface. This is similar to
+# the [ip address/host name] part of the listener definition, but is useful
+# when an interface has multiple addresses or the address may change. If used
+# with the [ip address/host name] part of the listener definition, then the
+# bind_interface option will take priority.
+# Not available on Windows.
+#
+# Example: bind_interface eth0
+#bind_interface
+
+# When a listener is using the websockets protocol, it is possible to serve
+# http data as well. Set http_dir to a directory which contains the files you
+# wish to serve. If this option is not specified, then no normal http
+# connections will be possible.
+#http_dir
+
+# The maximum number of client connections to allow. This is
+# a per listener setting.
+# Default is -1, which means unlimited connections.
+# Note that other process limits mean that unlimited connections
+# are not really possible. Typically the default maximum number of
+# connections possible is around 1024.
+#max_connections -1
+
+# The listener can be restricted to operating within a topic hierarchy using
+# the mount_point option. This is achieved be prefixing the mount_point string
+# to all topics for any clients connected to this listener. This prefixing only
+# happens internally to the broker; the client will not see the prefix.
+#mount_point
+
+# Choose the protocol to use when listening.
+# This can be either mqtt or websockets.
+# Certificate based TLS may be used with websockets, except that only the
+# cafile, certfile, keyfile, ciphers, and ciphers_tls13 options are supported.
+#protocol mqtt
+listener 1883
+protocol mqtt
+
+listener 9001
+protocol websockets
+
+# Set use_username_as_clientid to true to replace the clientid that a client
+# connected with with its username. This allows authentication to be tied to
+# the clientid, which means that it is possible to prevent one client
+# disconnecting another by using the same clientid.
+# If a client connects with no username it will be disconnected as not
+# authorised when this option is set to true.
+# Do not use in conjunction with clientid_prefixes.
+# See also use_identity_as_username.
+#use_username_as_clientid
+
+# Change the websockets headers size. This is a global option, it is not
+# possible to set per listener. This option sets the size of the buffer used in
+# the libwebsockets library when reading HTTP headers. If you are passing large
+# header data such as cookies then you may need to increase this value. If left
+# unset, or set to 0, then the default of 1024 bytes will be used.
+#websockets_headers_size
+
+# -----------------------------------------------------------------
+# Certificate based SSL/TLS support
+# -----------------------------------------------------------------
+# The following options can be used to enable certificate based SSL/TLS support
+# for this listener. Note that the recommended port for MQTT over TLS is 8883,
+# but this must be set manually.
+#
+# See also the mosquitto-tls man page and the "Pre-shared-key based SSL/TLS
+# support" section. Only one of certificate or PSK encryption support can be
+# enabled for any listener.
+
+# Both of certfile and keyfile must be defined to enable certificate based
+# TLS encryption.
+
+# Path to the PEM encoded server certificate.
+#certfile
+
+# Path to the PEM encoded keyfile.
+#keyfile
+
+# If you wish to control which encryption ciphers are used, use the ciphers
+# option. The list of available ciphers can be optained using the "openssl
+# ciphers" command and should be provided in the same format as the output of
+# that command. This applies to TLS 1.2 and earlier versions only. Use
+# ciphers_tls1.3 for TLS v1.3.
+#ciphers
+
+# Choose which TLS v1.3 ciphersuites are used for this listener.
+# Defaults to "TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256"
+#ciphers_tls1.3
+
+# If you have require_certificate set to true, you can create a certificate
+# revocation list file to revoke access to particular client certificates. If
+# you have done this, use crlfile to point to the PEM encoded revocation file.
+#crlfile
+
+# To allow the use of ephemeral DH key exchange, which provides forward
+# security, the listener must load DH parameters. This can be specified with
+# the dhparamfile option. The dhparamfile can be generated with the command
+# e.g. "openssl dhparam -out dhparam.pem 2048"
+#dhparamfile
+
+# By default an TLS enabled listener will operate in a similar fashion to a
+# https enabled web server, in that the server has a certificate signed by a CA
+# and the client will verify that it is a trusted certificate. The overall aim
+# is encryption of the network traffic. By setting require_certificate to true,
+# the client must provide a valid certificate in order for the network
+# connection to proceed. This allows access to the broker to be controlled
+# outside of the mechanisms provided by MQTT.
+#require_certificate false
+
+# cafile and capath define methods of accessing the PEM encoded
+# Certificate Authority certificates that will be considered trusted when
+# checking incoming client certificates.
+# cafile defines the path to a file containing the CA certificates.
+# capath defines a directory that will be searched for files
+# containing the CA certificates. For capath to work correctly, the
+# certificate files must have ".crt" as the file ending and you must run
+# "openssl rehash <path to capath>" each time you add/remove a certificate.
+#cafile
+#capath
+
+
+# If require_certificate is true, you may set use_identity_as_username to true
+# to use the CN value from the client certificate as a username. If this is
+# true, the password_file option will not be used for this listener.
+#use_identity_as_username false
+
+# -----------------------------------------------------------------
+# Pre-shared-key based SSL/TLS support
+# -----------------------------------------------------------------
+# The following options can be used to enable PSK based SSL/TLS support for
+# this listener. Note that the recommended port for MQTT over TLS is 8883, but
+# this must be set manually.
+#
+# See also the mosquitto-tls man page and the "Certificate based SSL/TLS
+# support" section. Only one of certificate or PSK encryption support can be
+# enabled for any listener.
+
+# The psk_hint option enables pre-shared-key support for this listener and also
+# acts as an identifier for this listener. The hint is sent to clients and may
+# be used locally to aid authentication. The hint is a free form string that
+# doesn't have much meaning in itself, so feel free to be creative.
+# If this option is provided, see psk_file to define the pre-shared keys to be
+# used or create a security plugin to handle them.
+#psk_hint
+
+# When using PSK, the encryption ciphers used will be chosen from the list of
+# available PSK ciphers. If you want to control which ciphers are available,
+# use the "ciphers" option.  The list of available ciphers can be optained
+# using the "openssl ciphers" command and should be provided in the same format
+# as the output of that command.
+#ciphers
+
+# Set use_identity_as_username to have the psk identity sent by the client used
+# as its username. Authentication will be carried out using the PSK rather than
+# the MQTT username/password and so password_file will not be used for this
+# listener.
+#use_identity_as_username false
+
+
+# =================================================================
+# Persistence
+# =================================================================
+
+# If persistence is enabled, save the in-memory database to disk
+# every autosave_interval seconds. If set to 0, the persistence
+# database will only be written when mosquitto exits. See also
+# autosave_on_changes.
+# Note that writing of the persistence database can be forced by
+# sending mosquitto a SIGUSR1 signal.
+#autosave_interval 1800
+
+# If true, mosquitto will count the number of subscription changes, retained
+# messages received and queued messages and if the total exceeds
+# autosave_interval then the in-memory database will be saved to disk.
+# If false, mosquitto will save the in-memory database to disk by treating
+# autosave_interval as a time in seconds.
+#autosave_on_changes false
+
+# Save persistent message data to disk (true/false).
+# This saves information about all messages, including
+# subscriptions, currently in-flight messages and retained
+# messages.
+# retained_persistence is a synonym for this option.
+#persistence false
+
+# The filename to use for the persistent database, not including
+# the path.
+#persistence_file mosquitto.db
+
+# Location for persistent database.
+# Default is an empty string (current directory).
+# Set to e.g. /var/lib/mosquitto if running as a proper service on Linux or
+# similar.
+#persistence_location
+
+
+# =================================================================
+# Logging
+# =================================================================
+
+# Places to log to. Use multiple log_dest lines for multiple
+# logging destinations.
+# Possible destinations are: stdout stderr syslog topic file dlt
+#
+# stdout and stderr log to the console on the named output.
+#
+# syslog uses the userspace syslog facility which usually ends up
+# in /var/log/messages or similar.
+#
+# topic logs to the broker topic '$SYS/broker/log/<severity>',
+# where severity is one of D, E, W, N, I, M which are debug, error,
+# warning, notice, information and message. Message type severity is used by
+# the subscribe/unsubscribe log_types and publishes log messages to
+# $SYS/broker/log/M/susbcribe or $SYS/broker/log/M/unsubscribe.
+#
+# The file destination requires an additional parameter which is the file to be
+# logged to, e.g. "log_dest file /var/log/mosquitto.log". The file will be
+# closed and reopened when the broker receives a HUP signal. Only a single file
+# destination may be configured.
+#
+# The dlt destination is for the automotive `Diagnostic Log and Trace` tool.
+# This requires that Mosquitto has been compiled with DLT support.
+#
+# Note that if the broker is running as a Windows service it will default to
+# "log_dest none" and neither stdout nor stderr logging is available.
+# Use "log_dest none" if you wish to disable logging.
+#log_dest stderr
+
+# Types of messages to log. Use multiple log_type lines for logging
+# multiple types of messages.
+# Possible types are: debug, error, warning, notice, information,
+# none, subscribe, unsubscribe, websockets, all.
+# Note that debug type messages are for decoding the incoming/outgoing
+# network packets. They are not logged in "topics".
+#log_type error
+#log_type warning
+#log_type notice
+#log_type information
+
+
+# If set to true, client connection and disconnection messages will be included
+# in the log.
+#connection_messages true
+
+# If using syslog logging (not on Windows), messages will be logged to the
+# "daemon" facility by default. Use the log_facility option to choose which of
+# local0 to local7 to log to instead. The option value should be an integer
+# value, e.g. "log_facility 5" to use local5.
+#log_facility
+
+# If set to true, add a timestamp value to each log message.
+#log_timestamp true
+
+# Set the format of the log timestamp. If left unset, this is the number of
+# seconds since the Unix epoch.
+# This is a free text string which will be passed to the strftime function. To
+# get an ISO 8601 datetime, for example:
+# log_timestamp_format %Y-%m-%dT%H:%M:%S
+#log_timestamp_format
+
+# Change the websockets logging level. This is a global option, it is not
+# possible to set per listener. This is an integer that is interpreted by
+# libwebsockets as a bit mask for its lws_log_levels enum. See the
+# libwebsockets documentation for more details. "log_type websockets" must also
+# be enabled.
+#websockets_log_level 0
+
+
+# =================================================================
+# Security
+# =================================================================
+
+# If set, only clients that have a matching prefix on their
+# clientid will be allowed to connect to the broker. By default,
+# all clients may connect.
+# For example, setting "secure-" here would mean a client "secure-
+# client" could connect but another with clientid "mqtt" couldn't.
+#clientid_prefixes
+
+# Boolean value that determines whether clients that connect
+# without providing a username are allowed to connect. If set to
+# false then a password file should be created (see the
+# password_file option) to control authenticated client access.
+#
+# Defaults to false, unless there are no listeners defined in the configuration
+# file, in which case it is set to true, but connections are only allowed from
+# the local machine.
+allow_anonymous true
+
+# -----------------------------------------------------------------
+# Default authentication and topic access control
+# -----------------------------------------------------------------
+
+# Control access to the broker using a password file. This file can be
+# generated using the mosquitto_passwd utility. If TLS support is not compiled
+# into mosquitto (it is recommended that TLS support should be included) then
+# plain text passwords are used, in which case the file should be a text file
+# with lines in the format:
+# username:password
+# The password (and colon) may be omitted if desired, although this
+# offers very little in the way of security.
+#
+# See the TLS client require_certificate and use_identity_as_username options
+# for alternative authentication options. If a plugin is used as well as
+# password_file, the plugin check will be made first.
+#password_file
+
+# Access may also be controlled using a pre-shared-key file. This requires
+# TLS-PSK support and a listener configured to use it. The file should be text
+# lines in the format:
+# identity:key
+# The key should be in hexadecimal format without a leading "0x".
+# If an plugin is used as well, the plugin check will be made first.
+#psk_file
+
+# Control access to topics on the broker using an access control list
+# file. If this parameter is defined then only the topics listed will
+# have access.
+# If the first character of a line of the ACL file is a # it is treated as a
+# comment.
+# Topic access is added with lines of the format:
+#
+# topic [read|write|readwrite|deny] <topic>
+#
+# The access type is controlled using "read", "write", "readwrite" or "deny".
+# This parameter is optional (unless <topic> contains a space character) - if
+# not given then the access is read/write.  <topic> can contain the + or #
+# wildcards as in subscriptions.
+#
+# The "deny" option can used to explicity deny access to a topic that would
+# otherwise be granted by a broader read/write/readwrite statement. Any "deny"
+# topics are handled before topics that grant read/write access.
+#
+# The first set of topics are applied to anonymous clients, assuming
+# allow_anonymous is true. User specific topic ACLs are added after a
+# user line as follows:
+#
+# user <username>
+#
+# The username referred to here is the same as in password_file. It is
+# not the clientid.
+#
+#
+# If is also possible to define ACLs based on pattern substitution within the
+# topic. The patterns available for substition are:
+#
+# %c to match the client id of the client
+# %u to match the username of the client
+#
+# The substitution pattern must be the only text for that level of hierarchy.
+#
+# The form is the same as for the topic keyword, but using pattern as the
+# keyword.
+# Pattern ACLs apply to all users even if the "user" keyword has previously
+# been given.
+#
+# If using bridges with usernames and ACLs, connection messages can be allowed
+# with the following pattern:
+# pattern write $SYS/broker/connection/%c/state
+#
+# pattern [read|write|readwrite] <topic>
+#
+# Example:
+#
+# pattern write sensor/%u/data
+#
+# If an plugin is used as well as acl_file, the plugin check will be
+# made first.
+#acl_file
+
+# -----------------------------------------------------------------
+# External authentication and topic access plugin options
+# -----------------------------------------------------------------
+
+# External authentication and access control can be supported with the
+# plugin option. This is a path to a loadable plugin. See also the
+# plugin_opt_* options described below.
+#
+# The plugin option can be specified multiple times to load multiple
+# plugins. The plugins will be processed in the order that they are specified
+# here. If the plugin option is specified alongside either of
+# password_file or acl_file then the plugin checks will be made first.
+#
+# If the per_listener_settings option is false, the plugin will be apply to all
+# listeners. If per_listener_settings is true, then the plugin will apply to
+# the current listener being defined only.
+#
+# This option is also available as `auth_plugin`, but this use is deprecated
+# and will be removed in the future.
+#
+#plugin
+
+# If the plugin option above is used, define options to pass to the
+# plugin here as described by the plugin instructions. All options named
+# using the format plugin_opt_* will be passed to the plugin, for example:
+#
+# This option is also available as `auth_opt_*`, but this use is deprecated
+# and will be removed in the future.
+#
+# plugin_opt_db_host
+# plugin_opt_db_port
+# plugin_opt_db_username
+# plugin_opt_db_password
+
+
+# =================================================================
+# Bridges
+# =================================================================
+
+# A bridge is a way of connecting multiple MQTT brokers together.
+# Create a new bridge using the "connection" option as described below. Set
+# options for the bridges using the remaining parameters. You must specify the
+# address and at least one topic to subscribe to.
+#
+# Each connection must have a unique name.
+#
+# The address line may have multiple host address and ports specified. See
+# below in the round_robin description for more details on bridge behaviour if
+# multiple addresses are used. Note that if you use an IPv6 address, then you
+# are required to specify a port.
+#
+# The direction that the topic will be shared can be chosen by
+# specifying out, in or both, where the default value is out.
+# The QoS level of the bridged communication can be specified with the next
+# topic option. The default QoS level is 0, to change the QoS the topic
+# direction must also be given.
+#
+# The local and remote prefix options allow a topic to be remapped when it is
+# bridged to/from the remote broker. This provides the ability to place a topic
+# tree in an appropriate location.
+#
+# For more details see the mosquitto.conf man page.
+#
+# Multiple topics can be specified per connection, but be careful
+# not to create any loops.
+#
+# If you are using bridges with cleansession set to false (the default), then
+# you may get unexpected behaviour from incoming topics if you change what
+# topics you are subscribing to. This is because the remote broker keeps the
+# subscription for the old topic. If you have this problem, connect your bridge
+# with cleansession set to true, then reconnect with cleansession set to false
+# as normal.
+#connection <name>
+#address <host>[:<port>] [<host>[:<port>]]
+#topic <topic> [[[out | in | both] qos-level] local-prefix remote-prefix]
+
+# If you need to have the bridge connect over a particular network interface,
+# use bridge_bind_address to tell the bridge which local IP address the socket
+# should bind to, e.g. `bridge_bind_address 192.168.1.10`
+#bridge_bind_address
+
+# If a bridge has topics that have "out" direction, the default behaviour is to
+# send an unsubscribe request to the remote broker on that topic. This means
+# that changing a topic direction from "in" to "out" will not keep receiving
+# incoming messages. Sending these unsubscribe requests is not always
+# desirable, setting bridge_attempt_unsubscribe to false will disable sending
+# the unsubscribe request.
+#bridge_attempt_unsubscribe true
+
+# Set the version of the MQTT protocol to use with for this bridge. Can be one
+# of mqttv50, mqttv311 or mqttv31. Defaults to mqttv311.
+#bridge_protocol_version mqttv311
+
+# Set the clean session variable for this bridge.
+# When set to true, when the bridge disconnects for any reason, all
+# messages and subscriptions will be cleaned up on the remote
+# broker. Note that with cleansession set to true, there may be a
+# significant amount of retained messages sent when the bridge
+# reconnects after losing its connection.
+# When set to false, the subscriptions and messages are kept on the
+# remote broker, and delivered when the bridge reconnects.
+#cleansession false
+
+# Set the amount of time a bridge using the lazy start type must be idle before
+# it will be stopped. Defaults to 60 seconds.
+#idle_timeout 60
+
+# Set the keepalive interval for this bridge connection, in
+# seconds.
+#keepalive_interval 60
+
+# Set the clientid to use on the local broker. If not defined, this defaults to
+# 'local.<clientid>'. If you are bridging a broker to itself, it is important
+# that local_clientid and clientid do not match.
+#local_clientid
+
+# If set to true, publish notification messages to the local and remote brokers
+# giving information about the state of the bridge connection. Retained
+# messages are published to the topic $SYS/broker/connection/<clientid>/state
+# unless the notification_topic option is used.
+# If the message is 1 then the connection is active, or 0 if the connection has
+# failed.
+# This uses the last will and testament feature.
+#notifications true
+
+# Choose the topic on which notification messages for this bridge are
+# published. If not set, messages are published on the topic
+# $SYS/broker/connection/<clientid>/state
+#notification_topic
+
+# Set the client id to use on the remote end of this bridge connection. If not
+# defined, this defaults to 'name.hostname' where name is the connection name
+# and hostname is the hostname of this computer.
+# This replaces the old "clientid" option to avoid confusion. "clientid"
+# remains valid for the time being.
+#remote_clientid
+
+# Set the password to use when connecting to a broker that requires
+# authentication. This option is only used if remote_username is also set.
+# This replaces the old "password" option to avoid confusion. "password"
+# remains valid for the time being.
+#remote_password
+
+# Set the username to use when connecting to a broker that requires
+# authentication.
+# This replaces the old "username" option to avoid confusion. "username"
+# remains valid for the time being.
+#remote_username
+
+# Set the amount of time a bridge using the automatic start type will wait
+# until attempting to reconnect.
+# This option can be configured to use a constant delay time in seconds, or to
+# use a backoff mechanism based on "Decorrelated Jitter", which adds a degree
+# of randomness to when the restart occurs.
+#
+# Set a constant timeout of 20 seconds:
+# restart_timeout 20
+#
+# Set backoff with a base (start value) of 10 seconds and a cap (upper limit) of
+# 60 seconds:
+# restart_timeout 10 30
+#
+# Defaults to jitter with a base of 5 and cap of 30
+#restart_timeout 5 30
+
+# If the bridge has more than one address given in the address/addresses
+# configuration, the round_robin option defines the behaviour of the bridge on
+# a failure of the bridge connection. If round_robin is false, the default
+# value, then the first address is treated as the main bridge connection. If
+# the connection fails, the other secondary addresses will be attempted in
+# turn. Whilst connected to a secondary bridge, the bridge will periodically
+# attempt to reconnect to the main bridge until successful.
+# If round_robin is true, then all addresses are treated as equals. If a
+# connection fails, the next address will be tried and if successful will
+# remain connected until it fails
+#round_robin false
+
+# Set the start type of the bridge. This controls how the bridge starts and
+# can be one of three types: automatic, lazy and once. Note that RSMB provides
+# a fourth start type "manual" which isn't currently supported by mosquitto.
+#
+# "automatic" is the default start type and means that the bridge connection
+# will be started automatically when the broker starts and also restarted
+# after a short delay (30 seconds) if the connection fails.
+#
+# Bridges using the "lazy" start type will be started automatically when the
+# number of queued messages exceeds the number set with the "threshold"
+# parameter. It will be stopped automatically after the time set by the
+# "idle_timeout" parameter. Use this start type if you wish the connection to
+# only be active when it is needed.
+#
+# A bridge using the "once" start type will be started automatically when the
+# broker starts but will not be restarted if the connection fails.
+#start_type automatic
+
+# Set the number of messages that need to be queued for a bridge with lazy
+# start type to be restarted. Defaults to 10 messages.
+# Must be less than max_queued_messages.
+#threshold 10
+
+# If try_private is set to true, the bridge will attempt to indicate to the
+# remote broker that it is a bridge not an ordinary client. If successful, this
+# means that loop detection will be more effective and that retained messages
+# will be propagated correctly. Not all brokers support this feature so it may
+# be necessary to set try_private to false if your bridge does not connect
+# properly.
+#try_private true
+
+# Some MQTT brokers do not allow retained messages. MQTT v5 gives a mechanism
+# for brokers to tell clients that they do not support retained messages, but
+# this is not possible for MQTT v3.1.1 or v3.1. If you need to bridge to a
+# v3.1.1 or v3.1 broker that does not support retained messages, set the
+# bridge_outgoing_retain option to false. This will remove the retain bit on
+# all outgoing messages to that bridge, regardless of any other setting.
+#bridge_outgoing_retain true
+
+# If you wish to restrict the size of messages sent to a remote bridge, use the
+# bridge_max_packet_size option. This sets the maximum number of bytes for
+# the total message, including headers and payload.
+# Note that MQTT v5 brokers may provide their own maximum-packet-size property.
+# In this case, the smaller of the two limits will be used.
+# Set to 0 for "unlimited".
+#bridge_max_packet_size 0
+
+
+# -----------------------------------------------------------------
+# Certificate based SSL/TLS support
+# -----------------------------------------------------------------
+# Either bridge_cafile or bridge_capath must be defined to enable TLS support
+# for this bridge.
+# bridge_cafile defines the path to a file containing the
+# Certificate Authority certificates that have signed the remote broker
+# certificate.
+# bridge_capath defines a directory that will be searched for files containing
+# the CA certificates. For bridge_capath to work correctly, the certificate
+# files must have ".crt" as the file ending and you must run "openssl rehash
+# <path to capath>" each time you add/remove a certificate.
+#bridge_cafile
+#bridge_capath
+
+
+# If the remote broker has more than one protocol available on its port, e.g.
+# MQTT and WebSockets, then use bridge_alpn to configure which protocol is
+# requested. Note that WebSockets support for bridges is not yet available.
+#bridge_alpn
+
+# When using certificate based encryption, bridge_insecure disables
+# verification of the server hostname in the server certificate. This can be
+# useful when testing initial server configurations, but makes it possible for
+# a malicious third party to impersonate your server through DNS spoofing, for
+# example. Use this option in testing only. If you need to resort to using this
+# option in a production environment, your setup is at fault and there is no
+# point using encryption.
+#bridge_insecure false
+
+# Path to the PEM encoded client certificate, if required by the remote broker.
+#bridge_certfile
+
+# Path to the PEM encoded client private key, if required by the remote broker.
+#bridge_keyfile
+
+# -----------------------------------------------------------------
+# PSK based SSL/TLS support
+# -----------------------------------------------------------------
+# Pre-shared-key encryption provides an alternative to certificate based
+# encryption. A bridge can be configured to use PSK with the bridge_identity
+# and bridge_psk options. These are the client PSK identity, and pre-shared-key
+# in hexadecimal format with no "0x". Only one of certificate and PSK based
+# encryption can be used on one
+# bridge at once.
+#bridge_identity
+#bridge_psk
+
+
+# =================================================================
+# External config files
+# =================================================================
+
+# External configuration files may be included by using the
+# include_dir option. This defines a directory that will be searched
+# for config files. All files that end in '.conf' will be loaded as
+# a configuration file. It is best to have this as the last option
+# in the main file. This option will only be processed from the main
+# configuration file. The directory specified must not contain the
+# main configuration file.
+# Files within include_dir will be loaded sorted in case-sensitive
+# alphabetical order, with capital letters ordered first. If this option is
+# given multiple times, all of the files from the first instance will be
+# processed before the next instance. See the man page for examples.
+#include_dir
diff --git a/integration/nest-application/app-locals/tsconfig.json b/integration/nest-application/app-locals/tsconfig.json
index 2a0adf369..c3692649c 100644
--- a/integration/nest-application/app-locals/tsconfig.json
+++ b/integration/nest-application/app-locals/tsconfig.json
@@ -7,16 +7,34 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../../packages/common"],
+      "@nestjs/common/*": ["../../../packages/common/*"],
+      "@nestjs/core": ["../../../packages/core"],
+      "@nestjs/core/*": ["../../../packages/core/*"],
+      "@nestjs/microservices": ["../../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../../packages/websockets/*"],
+      "@nestjs/testing": ["../../../packages/websockets"],
+      "@nestjs/testing/*": ["../../../packages/websockets/*"],
+      "@nestjs/platform-express": ["../../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
     "e2e/**/*"
   ],
   "exclude": [
-    "node_modules"
+    "node_modules",
   ]
 }
\ No newline at end of file
diff --git a/integration/nest-application/get-url/tsconfig.json b/integration/nest-application/get-url/tsconfig.json
index 2a0adf369..c3692649c 100644
--- a/integration/nest-application/get-url/tsconfig.json
+++ b/integration/nest-application/get-url/tsconfig.json
@@ -7,16 +7,34 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../../packages/common"],
+      "@nestjs/common/*": ["../../../packages/common/*"],
+      "@nestjs/core": ["../../../packages/core"],
+      "@nestjs/core/*": ["../../../packages/core/*"],
+      "@nestjs/microservices": ["../../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../../packages/websockets/*"],
+      "@nestjs/testing": ["../../../packages/websockets"],
+      "@nestjs/testing/*": ["../../../packages/websockets/*"],
+      "@nestjs/platform-express": ["../../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
     "e2e/**/*"
   ],
   "exclude": [
-    "node_modules"
+    "node_modules",
   ]
 }
\ No newline at end of file
diff --git a/integration/nest-application/global-prefix/e2e/global-prefix.spec.ts b/integration/nest-application/global-prefix/e2e/global-prefix.spec.ts
index b11becd24..74f8e9ad6 100644
--- a/integration/nest-application/global-prefix/e2e/global-prefix.spec.ts
+++ b/integration/nest-application/global-prefix/e2e/global-prefix.spec.ts
@@ -108,15 +108,26 @@ describe('Global prefix', () => {
     server = app.getHttpServer();
     await app.init();
 
-    await request(server).get('/hello/foo').expect(200);
+    await request(server)
+      .get('/hello/foo')
+      .expect(200, 'Hello: Data attached in middleware');
 
     await request(server)
       .get('/middleware/foo')
       .expect(200, MIDDLEWARE_PARAM_VALUE);
 
+    await request(server).get('/api/v1/middleware/foo').expect(404);
+  });
+
+  it(`should get the params in the global prefix`, async () => {
+    app.setGlobalPrefix('/api/:tenantId');
+
+    server = app.getHttpServer();
+    await app.init();
+
     await request(server)
-      .get('/api/v1/middleware/foo')
-      .expect(404);
+      .get('/api/test/params')
+      .expect(200, { '0': 'params', tenantId: 'test' });
   });
 
   afterEach(async () => {
diff --git a/integration/nest-application/global-prefix/src/app.controller.ts b/integration/nest-application/global-prefix/src/app.controller.ts
index 8d1472a2f..d826cd0db 100644
--- a/integration/nest-application/global-prefix/src/app.controller.ts
+++ b/integration/nest-application/global-prefix/src/app.controller.ts
@@ -1,10 +1,15 @@
-import { Controller, Get, Post } from '@nestjs/common';
+import { Controller, Get, Post, Req } from '@nestjs/common';
 
 @Controller()
 export class AppController {
   @Get('hello/:name')
-  getHello(): string {
-    return 'hello';
+  getHello(@Req() req): string {
+    return 'Hello: ' + req.extras?.data;
+  }
+
+  @Get('params')
+  getParams(@Req() req): any {
+    return req.middlewareParams;
   }
 
   @Get('health')
diff --git a/integration/nest-application/global-prefix/src/app.module.ts b/integration/nest-application/global-prefix/src/app.module.ts
index 2123145a8..f182915c4 100644
--- a/integration/nest-application/global-prefix/src/app.module.ts
+++ b/integration/nest-application/global-prefix/src/app.module.ts
@@ -17,6 +17,16 @@ export class AppModule {
       .apply((req, res, next) => res.end(MIDDLEWARE_PARAM_VALUE))
       .forRoutes({ path: MIDDLEWARE_VALUE + '/*', method: RequestMethod.GET })
       .apply((req, res, next) => res.status(201).end(MIDDLEWARE_PARAM_VALUE))
-      .forRoutes({ path: MIDDLEWARE_VALUE + '/*', method: RequestMethod.POST });
+      .forRoutes({ path: MIDDLEWARE_VALUE + '/*', method: RequestMethod.POST })
+      .apply((req, res, next) => {
+        req.extras = { data: 'Data attached in middleware' };
+        next();
+      })
+      .forRoutes({ path: '*', method: RequestMethod.GET })
+      .apply((req, res, next) => {
+        req.middlewareParams = req.params;
+        next();
+      })
+      .forRoutes({ path: '*', method: RequestMethod.GET });
   }
 }
diff --git a/integration/nest-application/global-prefix/tsconfig.json b/integration/nest-application/global-prefix/tsconfig.json
index 2a0adf369..c3692649c 100644
--- a/integration/nest-application/global-prefix/tsconfig.json
+++ b/integration/nest-application/global-prefix/tsconfig.json
@@ -7,16 +7,34 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../../packages/common"],
+      "@nestjs/common/*": ["../../../packages/common/*"],
+      "@nestjs/core": ["../../../packages/core"],
+      "@nestjs/core/*": ["../../../packages/core/*"],
+      "@nestjs/microservices": ["../../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../../packages/websockets/*"],
+      "@nestjs/testing": ["../../../packages/websockets"],
+      "@nestjs/testing/*": ["../../../packages/websockets/*"],
+      "@nestjs/platform-express": ["../../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
     "e2e/**/*"
   ],
   "exclude": [
-    "node_modules"
+    "node_modules",
   ]
 }
\ No newline at end of file
diff --git a/integration/nest-application/raw-body/e2e/express.spec.ts b/integration/nest-application/raw-body/e2e/express.spec.ts
new file mode 100644
index 000000000..762ecd92c
--- /dev/null
+++ b/integration/nest-application/raw-body/e2e/express.spec.ts
@@ -0,0 +1,77 @@
+import { NestExpressApplication } from '@nestjs/platform-express';
+import { Test } from '@nestjs/testing';
+import { expect } from 'chai';
+import * as request from 'supertest';
+import { ExpressModule } from '../src/express.module';
+
+describe('Raw body (Express Application)', () => {
+  let app: NestExpressApplication;
+
+  beforeEach(async () => {
+    const moduleFixture = await Test.createTestingModule({
+      imports: [ExpressModule],
+    }).compile();
+
+    app = moduleFixture.createNestApplication<NestExpressApplication>({
+      rawBody: true,
+    });
+
+    await app.init();
+  });
+
+  afterEach(async () => {
+    await app.close();
+  });
+
+  describe('application/json', () => {
+    const body = '{ "amount":0.0 }';
+
+    it('should return exact post body', async () => {
+      const response = await request(app.getHttpServer())
+        .post('/')
+        .set('Content-Type', 'application/json')
+        .send(body)
+        .expect(201);
+
+      expect(response.body).to.eql({
+        parsed: {
+          amount: 0,
+        },
+        raw: body,
+      });
+    });
+
+    it('should work if post body is empty', async () => {
+      await request(app.getHttpServer())
+        .post('/')
+        .set('Content-Type', 'application/json')
+        .expect(201);
+    });
+  });
+
+  describe('application/x-www-form-urlencoded', () => {
+    const body = 'content=this is a post\'s content by "Nest"';
+
+    it('should return exact post body', async () => {
+      const response = await request(app.getHttpServer())
+        .post('/')
+        .set('Content-Type', 'application/x-www-form-urlencoded')
+        .send(body)
+        .expect(201);
+
+      expect(response.body).to.eql({
+        parsed: {
+          content: 'this is a post\'s content by "Nest"',
+        },
+        raw: body,
+      });
+    });
+
+    it('should work if post body is empty', async () => {
+      await request(app.getHttpServer())
+        .post('/')
+        .set('Content-Type', 'application/x-www-form-urlencoded')
+        .expect(201);
+    });
+  });
+});
diff --git a/integration/nest-application/raw-body/e2e/fastify.spec.ts b/integration/nest-application/raw-body/e2e/fastify.spec.ts
new file mode 100644
index 000000000..03db3f137
--- /dev/null
+++ b/integration/nest-application/raw-body/e2e/fastify.spec.ts
@@ -0,0 +1,98 @@
+import {
+  NestFastifyApplication,
+  FastifyAdapter,
+} from '@nestjs/platform-fastify';
+import { Test } from '@nestjs/testing';
+import { expect } from 'chai';
+import { FastifyModule } from '../src/fastify.module';
+
+describe('Raw body (Fastify Application)', () => {
+  let app: NestFastifyApplication;
+
+  beforeEach(async () => {
+    const moduleFixture = await Test.createTestingModule({
+      imports: [FastifyModule],
+    }).compile();
+
+    app = moduleFixture.createNestApplication<NestFastifyApplication>(
+      new FastifyAdapter(),
+      {
+        rawBody: true,
+      },
+    );
+
+    await app.init();
+  });
+
+  afterEach(async () => {
+    await app.close();
+  });
+
+  describe('application/json', () => {
+    const body = '{ "amount":0.0 }';
+
+    it('should return exact post body', async () => {
+      const response = await app.inject({
+        method: 'POST',
+        url: '/',
+        headers: { 'content-type': 'application/json' },
+        payload: body,
+      });
+
+      expect(JSON.parse(response.body)).to.eql({
+        parsed: {
+          amount: 0,
+        },
+        raw: body,
+      });
+    });
+
+    it('should fail if post body is empty', async () => {
+      const response = await app.inject({
+        method: 'POST',
+        url: '/',
+        headers: {
+          'content-type': 'application/json',
+          accept: 'application/json',
+        },
+      });
+
+      // Unlike Express, when you send a POST request without a body
+      // with Fastify, Fastify will throw an error because it isn't valid
+      // JSON. See fastify/fastify#297.
+      expect(response.statusCode).to.equal(400);
+    });
+  });
+
+  describe('application/x-www-form-urlencoded', () => {
+    const body = 'content=this is a post\'s content by "Nest"';
+
+    it('should return exact post body', async () => {
+      const response = await app.inject({
+        method: 'POST',
+        url: '/',
+        headers: { 'content-type': 'application/x-www-form-urlencoded' },
+        payload: body,
+      });
+
+      expect(JSON.parse(response.body)).to.eql({
+        parsed: {
+          content: 'this is a post\'s content by "Nest"',
+        },
+        raw: body,
+      });
+    });
+
+    it('should work if post body is empty', async () => {
+      const response = await app.inject({
+        method: 'POST',
+        url: '/',
+        headers: {
+          'content-type': 'application/x-www-form-urlencoded',
+        },
+      });
+
+      expect(response.statusCode).to.equal(201);
+    });
+  });
+});
diff --git a/integration/nest-application/raw-body/src/express.controller.ts b/integration/nest-application/raw-body/src/express.controller.ts
new file mode 100644
index 000000000..5f504ede0
--- /dev/null
+++ b/integration/nest-application/raw-body/src/express.controller.ts
@@ -0,0 +1,13 @@
+import { Controller, Post, RawBodyRequest, Req } from '@nestjs/common';
+import { Request } from 'express';
+
+@Controller()
+export class ExpressController {
+  @Post()
+  getRawBody(@Req() req: RawBodyRequest<Request>) {
+    return {
+      parsed: req.body,
+      raw: req.rawBody.toString(),
+    };
+  }
+}
diff --git a/integration/nest-application/raw-body/src/express.module.ts b/integration/nest-application/raw-body/src/express.module.ts
new file mode 100644
index 000000000..5ddb71426
--- /dev/null
+++ b/integration/nest-application/raw-body/src/express.module.ts
@@ -0,0 +1,7 @@
+import { Module } from '@nestjs/common';
+import { ExpressController } from './express.controller';
+
+@Module({
+  controllers: [ExpressController],
+})
+export class ExpressModule {}
diff --git a/integration/nest-application/raw-body/src/fastify.controller.ts b/integration/nest-application/raw-body/src/fastify.controller.ts
new file mode 100644
index 000000000..3cdf8484e
--- /dev/null
+++ b/integration/nest-application/raw-body/src/fastify.controller.ts
@@ -0,0 +1,13 @@
+import { Controller, Post, RawBodyRequest, Req } from '@nestjs/common';
+import type { FastifyRequest } from 'fastify';
+
+@Controller()
+export class FastifyController {
+  @Post()
+  getRawBody(@Req() req: RawBodyRequest<FastifyRequest>) {
+    return {
+      parsed: req.body,
+      raw: req.rawBody.toString(),
+    };
+  }
+}
diff --git a/integration/nest-application/raw-body/src/fastify.module.ts b/integration/nest-application/raw-body/src/fastify.module.ts
new file mode 100644
index 000000000..462f427ba
--- /dev/null
+++ b/integration/nest-application/raw-body/src/fastify.module.ts
@@ -0,0 +1,7 @@
+import { Module } from '@nestjs/common';
+import { FastifyController } from './fastify.controller';
+
+@Module({
+  controllers: [FastifyController],
+})
+export class FastifyModule {}
diff --git a/integration/nest-application/raw-body/tsconfig.json b/integration/nest-application/raw-body/tsconfig.json
new file mode 100644
index 000000000..c3692649c
--- /dev/null
+++ b/integration/nest-application/raw-body/tsconfig.json
@@ -0,0 +1,40 @@
+{
+  "compilerOptions": {
+    "module": "commonjs",
+    "declaration": false,
+    "noImplicitAny": false,
+    "removeComments": true,
+    "noLib": false,
+    "emitDecoratorMetadata": true,
+    "experimentalDecorators": true,
+    "target": "ES2021",
+    "sourceMap": true,
+    "allowJs": true,
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../../packages/common"],
+      "@nestjs/common/*": ["../../../packages/common/*"],
+      "@nestjs/core": ["../../../packages/core"],
+      "@nestjs/core/*": ["../../../packages/core/*"],
+      "@nestjs/microservices": ["../../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../../packages/websockets/*"],
+      "@nestjs/testing": ["../../../packages/websockets"],
+      "@nestjs/testing/*": ["../../../packages/websockets/*"],
+      "@nestjs/platform-express": ["../../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../../packages/platform-ws/*"]
+    }
+  },
+  "include": [
+    "src/**/*",
+    "e2e/**/*"
+  ],
+  "exclude": [
+    "node_modules",
+  ]
+}
\ No newline at end of file
diff --git a/integration/nest-application/sse/e2e/express.spec.ts b/integration/nest-application/sse/e2e/express.spec.ts
new file mode 100644
index 000000000..363dc807f
--- /dev/null
+++ b/integration/nest-application/sse/e2e/express.spec.ts
@@ -0,0 +1,79 @@
+import { NestExpressApplication } from '@nestjs/platform-express';
+import { Test } from '@nestjs/testing';
+import { expect } from 'chai';
+import * as EventSource from 'eventsource';
+import { AppModule } from '../src/app.module';
+
+describe('Sse (Express Application)', () => {
+  let app: NestExpressApplication;
+  let eventSource: EventSource;
+
+  describe('without forceCloseConnections', () => {
+    beforeEach(async () => {
+      const moduleFixture = await Test.createTestingModule({
+        imports: [AppModule],
+      }).compile();
+
+      app = moduleFixture.createNestApplication<NestExpressApplication>();
+
+      await app.listen(3000);
+      const url = await app.getUrl();
+
+      eventSource = new EventSource(url + '/sse', {
+        headers: { connection: 'keep-alive' },
+      });
+    });
+
+    // The order of actions is very important here. When not using `forceCloseConnections`,
+    // the SSe eventsource should close the connections in order to signal the server that
+    // the keep-alive connection can be ended.
+    afterEach(async () => {
+      eventSource.close();
+
+      await app.close();
+    });
+
+    it('receives events from server', done => {
+      eventSource.addEventListener('message', event => {
+        expect(JSON.parse(event.data)).to.eql({
+          hello: 'world',
+        });
+        done();
+      });
+    });
+  });
+
+  describe('with forceCloseConnections', () => {
+    beforeEach(async () => {
+      const moduleFixture = await Test.createTestingModule({
+        imports: [AppModule],
+      }).compile();
+
+      app = moduleFixture.createNestApplication<NestExpressApplication>({
+        forceCloseConnections: true,
+      });
+
+      await app.listen(3000);
+      const url = await app.getUrl();
+
+      eventSource = new EventSource(url + '/sse', {
+        headers: { connection: 'keep-alive' },
+      });
+    });
+
+    afterEach(async () => {
+      await app.close();
+
+      eventSource.close();
+    });
+
+    it('receives events from server', done => {
+      eventSource.addEventListener('message', event => {
+        expect(JSON.parse(event.data)).to.eql({
+          hello: 'world',
+        });
+        done();
+      });
+    });
+  });
+});
diff --git a/integration/nest-application/sse/e2e/fastify.spec.ts b/integration/nest-application/sse/e2e/fastify.spec.ts
new file mode 100644
index 000000000..4fc1ebf20
--- /dev/null
+++ b/integration/nest-application/sse/e2e/fastify.spec.ts
@@ -0,0 +1,86 @@
+import {
+  FastifyAdapter,
+  NestFastifyApplication,
+} from '@nestjs/platform-fastify';
+import { Test } from '@nestjs/testing';
+import { expect } from 'chai';
+import * as EventSource from 'eventsource';
+import { AppModule } from '../src/app.module';
+
+describe('Sse (Fastify Application)', () => {
+  let app: NestFastifyApplication;
+  let eventSource: EventSource;
+
+  describe('without forceCloseConnections', () => {
+    beforeEach(async () => {
+      const moduleFixture = await Test.createTestingModule({
+        imports: [AppModule],
+      }).compile();
+
+      app = moduleFixture.createNestApplication<NestFastifyApplication>(
+        new FastifyAdapter(),
+      );
+
+      await app.listen(3000);
+      const url = await app.getUrl();
+
+      eventSource = new EventSource(url + '/sse', {
+        headers: { connection: 'keep-alive' },
+      });
+    });
+
+    // The order of actions is very important here. When not using `forceCloseConnections`,
+    // the SSe eventsource should close the connections in order to signal the server that
+    // the keep-alive connection can be ended.
+    afterEach(async () => {
+      eventSource.close();
+
+      await app.close();
+    });
+
+    it('receives events from server', done => {
+      eventSource.addEventListener('message', event => {
+        expect(JSON.parse(event.data)).to.eql({
+          hello: 'world',
+        });
+        done();
+      });
+    });
+  });
+
+  describe('with forceCloseConnections', () => {
+    beforeEach(async () => {
+      const moduleFixture = await Test.createTestingModule({
+        imports: [AppModule],
+      }).compile();
+
+      app = moduleFixture.createNestApplication<NestFastifyApplication>(
+        new FastifyAdapter({
+          forceCloseConnections: true,
+        }),
+      );
+
+      await app.listen(3000);
+      const url = await app.getUrl();
+
+      eventSource = new EventSource(url + '/sse', {
+        headers: { connection: 'keep-alive' },
+      });
+    });
+
+    afterEach(async () => {
+      await app.close();
+
+      eventSource.close();
+    });
+
+    it('receives events from server', done => {
+      eventSource.addEventListener('message', event => {
+        expect(JSON.parse(event.data)).to.eql({
+          hello: 'world',
+        });
+        done();
+      });
+    });
+  });
+});
diff --git a/integration/nest-application/sse/src/app.controller.ts b/integration/nest-application/sse/src/app.controller.ts
new file mode 100644
index 000000000..2e36fa3d3
--- /dev/null
+++ b/integration/nest-application/sse/src/app.controller.ts
@@ -0,0 +1,12 @@
+import { Controller, MessageEvent, Sse } from '@nestjs/common';
+import { interval, map, Observable } from 'rxjs';
+
+@Controller()
+export class AppController {
+  @Sse('sse')
+  sse(): Observable<MessageEvent> {
+    return interval(1000).pipe(
+      map(_ => ({ data: { hello: 'world' } } as MessageEvent)),
+    );
+  }
+}
diff --git a/integration/nest-application/sse/src/app.module.ts b/integration/nest-application/sse/src/app.module.ts
new file mode 100644
index 000000000..848d4aaa7
--- /dev/null
+++ b/integration/nest-application/sse/src/app.module.ts
@@ -0,0 +1,7 @@
+import { Module } from '@nestjs/common';
+import { AppController } from './app.controller';
+
+@Module({
+  controllers: [AppController],
+})
+export class AppModule {}
diff --git a/integration/nest-application/sse/tsconfig.json b/integration/nest-application/sse/tsconfig.json
new file mode 100644
index 000000000..261e01453
--- /dev/null
+++ b/integration/nest-application/sse/tsconfig.json
@@ -0,0 +1,41 @@
+{
+  "compilerOptions": {
+    "module": "commonjs",
+    "declaration": false,
+    "noImplicitAny": false,
+    "removeComments": true,
+    "noLib": false,
+    "emitDecoratorMetadata": true,
+    "experimentalDecorators": true,
+    "target": "ES2021",
+    "sourceMap": true,
+    "allowJs": true,
+    "lib": ["dom"],
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../../packages/common"],
+      "@nestjs/common/*": ["../../../packages/common/*"],
+      "@nestjs/core": ["../../../packages/core"],
+      "@nestjs/core/*": ["../../../packages/core/*"],
+      "@nestjs/microservices": ["../../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../../packages/websockets/*"],
+      "@nestjs/testing": ["../../../packages/websockets"],
+      "@nestjs/testing/*": ["../../../packages/websockets/*"],
+      "@nestjs/platform-express": ["../../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../../packages/platform-ws/*"]
+    }
+  },
+  "include": [
+    "src/**/*",
+    "e2e/**/*"
+  ],
+  "exclude": [
+    "node_modules",
+  ]
+}
\ No newline at end of file
diff --git a/integration/nest-application/use-body-parser/e2e/express.spec.ts b/integration/nest-application/use-body-parser/e2e/express.spec.ts
new file mode 100644
index 000000000..06e77086d
--- /dev/null
+++ b/integration/nest-application/use-body-parser/e2e/express.spec.ts
@@ -0,0 +1,95 @@
+import { NestExpressApplication } from '@nestjs/platform-express';
+import { Test } from '@nestjs/testing';
+import { OptionsUrlencoded } from 'body-parser';
+import { expect } from 'chai';
+import * as request from 'supertest';
+import { AppModule } from '../src/app.module';
+
+describe('Body Parser (Express Application)', () => {
+  const moduleFixture = Test.createTestingModule({
+    imports: [AppModule],
+  });
+  let app: NestExpressApplication;
+
+  afterEach(async () => {
+    await app.close();
+  });
+
+  describe('application/json', () => {
+    const stringLimit = '{ "msg": "Hello, World" }';
+    const stringOverLimit = '{ "msg": "Hello, World!" }';
+
+    beforeEach(async () => {
+      const testFixture = await moduleFixture.compile();
+
+      app = testFixture
+        .createNestApplication<NestExpressApplication>({
+          rawBody: true,
+          logger: false,
+        })
+        .useBodyParser('json', { limit: Buffer.from(stringLimit).byteLength });
+
+      await app.init();
+    });
+
+    it('should allow request with matching body limit', async () => {
+      const response = await request(app.getHttpServer())
+        .post('/')
+        .set('Content-Type', 'application/json')
+        .send(stringLimit)
+        .expect(201);
+
+      expect(response.body).to.eql({
+        raw: stringLimit,
+      });
+    });
+
+    it('should fail if post body is larger than limit', async () => {
+      await request(app.getHttpServer())
+        .post('/')
+        .set('Content-Type', 'application/json')
+        .send(stringOverLimit)
+        .expect(413);
+    });
+  });
+
+  describe('application/x-www-form-urlencoded', () => {
+    const stringLimit = 'msg=Hello, World';
+    const stringOverLimit = 'msg=Hello, World!';
+
+    beforeEach(async () => {
+      const testFixture = await moduleFixture.compile();
+
+      app = testFixture
+        .createNestApplication<NestExpressApplication>({
+          rawBody: true,
+          logger: false,
+        })
+        .useBodyParser<OptionsUrlencoded>('urlencoded', {
+          limit: Buffer.from(stringLimit).byteLength,
+          extended: true,
+        });
+
+      await app.init();
+    });
+    it('should allow request with matching body limit', async () => {
+      const response = await request(app.getHttpServer())
+        .post('/')
+        .set('Content-Type', 'application/x-www-form-urlencoded')
+        .send(stringLimit)
+        .expect(201);
+
+      expect(response.body).to.eql({
+        raw: stringLimit,
+      });
+    });
+
+    it('should fail if post body is larger than limit', async () => {
+      await request(app.getHttpServer())
+        .post('/')
+        .set('Content-Type', 'application/x-www-form-urlencoded')
+        .send(stringOverLimit)
+        .expect(413);
+    });
+  });
+});
diff --git a/integration/nest-application/use-body-parser/e2e/fastify.spec.ts b/integration/nest-application/use-body-parser/e2e/fastify.spec.ts
new file mode 100644
index 000000000..26a9240d2
--- /dev/null
+++ b/integration/nest-application/use-body-parser/e2e/fastify.spec.ts
@@ -0,0 +1,106 @@
+import {
+  FastifyAdapter,
+  NestFastifyApplication,
+} from '@nestjs/platform-fastify';
+import { Test } from '@nestjs/testing';
+import { expect } from 'chai';
+import { AppModule } from '../src/app.module';
+
+describe('Body Parser (Fastify Application)', () => {
+  const moduleFixture = Test.createTestingModule({
+    imports: [AppModule],
+  });
+  let app: NestFastifyApplication;
+
+  afterEach(async () => {
+    await app.close();
+  });
+
+  describe('application/json', () => {
+    const stringLimit = '{ "msg": "Hello, World" }';
+    const stringOverLimit = '{ "msg": "Hello, World!" }';
+
+    beforeEach(async () => {
+      const testFixture = await moduleFixture.compile();
+
+      app = testFixture
+        .createNestApplication<NestFastifyApplication>(new FastifyAdapter(), {
+          rawBody: true,
+          logger: false,
+        })
+        .useBodyParser('application/json', {
+          bodyLimit: Buffer.from(stringLimit).byteLength,
+        });
+
+      await app.init();
+    });
+
+    it('should allow request with matching body limit', async () => {
+      const response = await app.inject({
+        method: 'POST',
+        url: '/',
+        headers: { 'content-type': 'application/json' },
+        payload: stringLimit,
+      });
+
+      expect(JSON.parse(response.body)).to.eql({
+        raw: stringLimit,
+      });
+    });
+
+    it('should fail if post body is larger than limit', async () => {
+      const response = await app.inject({
+        method: 'POST',
+        url: '/',
+        headers: { 'content-type': 'application/json' },
+        payload: stringOverLimit,
+      });
+
+      expect(response.statusCode).to.equal(413);
+    });
+  });
+
+  describe('application/x-www-form-urlencoded', () => {
+    const stringLimit = 'msg=Hello, World';
+    const stringOverLimit = 'msg=Hello, World!';
+
+    beforeEach(async () => {
+      const testFixture = await moduleFixture.compile();
+
+      app = testFixture
+        .createNestApplication<NestFastifyApplication>(new FastifyAdapter(), {
+          rawBody: true,
+          logger: false,
+        })
+        .useBodyParser('application/x-www-form-urlencoded', {
+          bodyLimit: Buffer.from(stringLimit).byteLength,
+        });
+
+      await app.init();
+    });
+
+    it('should allow request with matching body limit', async () => {
+      const response = await app.inject({
+        method: 'POST',
+        url: '/',
+        headers: { 'content-type': 'application/x-www-form-urlencoded' },
+        payload: stringLimit,
+      });
+
+      expect(JSON.parse(response.body)).to.eql({
+        raw: stringLimit,
+      });
+    });
+
+    it('should fail if post body is larger than limit', async () => {
+      const response = await app.inject({
+        method: 'POST',
+        url: '/',
+        headers: { 'content-type': 'application/x-www-form-urlencoded' },
+        payload: stringOverLimit,
+      });
+
+      expect(response.statusCode).to.equal(413);
+    });
+  });
+});
diff --git a/integration/nest-application/use-body-parser/src/app.controller.ts b/integration/nest-application/use-body-parser/src/app.controller.ts
new file mode 100644
index 000000000..8c110580c
--- /dev/null
+++ b/integration/nest-application/use-body-parser/src/app.controller.ts
@@ -0,0 +1,12 @@
+import { Controller, Post, Req, RawBodyRequest } from '@nestjs/common';
+import { IncomingMessage } from 'http';
+
+@Controller()
+export class AppController {
+  @Post()
+  index(@Req() req: RawBodyRequest<IncomingMessage>) {
+    return {
+      raw: req.rawBody?.toString(),
+    };
+  }
+}
diff --git a/integration/nest-application/use-body-parser/src/app.module.ts b/integration/nest-application/use-body-parser/src/app.module.ts
new file mode 100644
index 000000000..848d4aaa7
--- /dev/null
+++ b/integration/nest-application/use-body-parser/src/app.module.ts
@@ -0,0 +1,7 @@
+import { Module } from '@nestjs/common';
+import { AppController } from './app.controller';
+
+@Module({
+  controllers: [AppController],
+})
+export class AppModule {}
diff --git a/integration/cache/src/multi-store/tsconfig.json b/integration/nest-application/use-body-parser/tsconfig.json
similarity index 85%
rename from integration/cache/src/multi-store/tsconfig.json
rename to integration/nest-application/use-body-parser/tsconfig.json
index 567a5c9e6..999ab15b7 100644
--- a/integration/cache/src/multi-store/tsconfig.json
+++ b/integration/nest-application/use-body-parser/tsconfig.json
@@ -4,10 +4,11 @@
     "declaration": false,
     "noImplicitAny": false,
     "removeComments": true,
+    "lib": ["dom"],
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
     "outDir": "./dist"
@@ -17,6 +18,6 @@
     "e2e/**/*"
   ],
   "exclude": [
-    "node_modules",
+    "node_modules"
   ]
 }
diff --git a/integration/repl/e2e/repl.spec.ts b/integration/repl/e2e/repl.spec.ts
new file mode 100644
index 000000000..b239776ee
--- /dev/null
+++ b/integration/repl/e2e/repl.spec.ts
@@ -0,0 +1,262 @@
+import { clc } from '@nestjs/common/utils/cli-colors.util';
+import { repl } from '@nestjs/core';
+import { ReplContext } from '@nestjs/core/repl/repl-context';
+import {
+  HelpReplFn,
+  GetReplFn,
+  ResolveReplFn,
+  SelectReplFn,
+  DebugReplFn,
+  MethodsReplFn,
+} from '@nestjs/core/repl/native-functions';
+import { expect } from 'chai';
+import * as sinon from 'sinon';
+import { AppModule } from '../src/app.module';
+
+const PROMPT = '\u001b[1G\u001b[0J> \u001b[3G';
+
+describe('REPL', () => {
+  beforeEach(() => {
+    // To avoid coloring the output:
+    sinon.stub(clc, 'bold').callsFake(text => text);
+    sinon.stub(clc, 'green').callsFake(text => text);
+    sinon.stub(clc, 'yellow').callsFake(text => text);
+    sinon.stub(clc, 'red').callsFake(text => text);
+    sinon.stub(clc, 'magentaBright').callsFake(text => text);
+    sinon.stub(clc, 'cyanBright').callsFake(text => text);
+  });
+  afterEach(() => {
+    sinon.restore();
+  });
+
+  it('get()', async () => {
+    const server = await repl(AppModule);
+    server.context;
+    let outputText = '';
+    sinon.stub(process.stdout, 'write').callsFake(text => {
+      outputText += text;
+      return true;
+    });
+    server.emit('line', 'get(UsersService)');
+
+    expect(outputText).to.equal(
+      `UsersService { usersRepository: UsersRepository {} }
+${PROMPT}`,
+    );
+
+    outputText = '';
+    server.emit('line', 'get(UsersService).findAll()');
+
+    expect(outputText).to
+      .equal(`\u001b[32m'This action returns all users'\u001b[39m
+${PROMPT}`);
+
+    outputText = '';
+    server.emit('line', 'get("UsersRepository")');
+
+    expect(outputText).to.equal(`UsersRepository {}
+${PROMPT}`);
+  });
+
+  it('$()', async () => {
+    const server = await repl(AppModule);
+    server.context;
+    let outputText = '';
+    sinon.stub(process.stdout, 'write').callsFake(text => {
+      outputText += text;
+      return true;
+    });
+    server.emit('line', '$(UsersService)');
+
+    expect(outputText).to.equal(
+      `UsersService { usersRepository: UsersRepository {} }
+${PROMPT}`,
+    );
+
+    outputText = '';
+    server.emit('line', '$(UsersService).findAll()');
+
+    expect(outputText).to
+      .equal(`\u001b[32m'This action returns all users'\u001b[39m
+${PROMPT}`);
+
+    outputText = '';
+    server.emit('line', '$("UsersRepository")');
+
+    expect(outputText).to.equal(`UsersRepository {}
+${PROMPT}`);
+  });
+
+  it('debug()', async () => {
+    const server = await repl(AppModule);
+
+    let outputText = '';
+    sinon.stub(process.stdout, 'write').callsFake(text => {
+      outputText += text;
+      return true;
+    });
+    server.emit('line', 'debug(UsersModule)');
+
+    expect(outputText).to.equal(
+      `
+UsersModule:
+ - controllers:
+  ‚óª UsersController
+ - providers:
+  ‚óª UsersService
+  ‚óª "UsersRepository"
+
+${PROMPT}`,
+    );
+  });
+
+  it('methods()', async () => {
+    const server = await repl(AppModule);
+
+    let outputText = '';
+    sinon.stub(process.stdout, 'write').callsFake(text => {
+      outputText += text;
+      return true;
+    });
+    server.emit('line', 'methods("UsersRepository")');
+
+    expect(outputText).to.equal(
+      `
+Methods:
+ ‚óª find
+
+${PROMPT}`,
+    );
+
+    outputText = '';
+    server.emit('line', 'methods(UsersService)');
+
+    expect(outputText).to.equal(
+      `
+Methods:
+ ‚óª create
+ ‚óª findAll
+ ‚óª findOne
+ ‚óª update
+ ‚óª remove
+
+${PROMPT}`,
+    );
+  });
+
+  describe('<native_function>.help', () => {
+    it(`Typing "help.help" should print function's description and interface`, async () => {
+      const replServer = await repl(AppModule);
+
+      const { description, signature } = new HelpReplFn(
+        sinon.stub() as unknown as ReplContext,
+      ).fnDefinition;
+      let outputText = '';
+      sinon.stub(process.stdout, 'write').callsFake(text => {
+        outputText += text;
+        return true;
+      });
+
+      replServer.emit('line', 'help.help');
+
+      expect(outputText).to.equal(`${description}
+Interface: help${signature}
+${PROMPT}`);
+    });
+
+    it(`Typing "get.help" should print function's description and interface`, async () => {
+      const replServer = await repl(AppModule);
+
+      const { description, signature } = new GetReplFn(
+        sinon.stub() as unknown as ReplContext,
+      ).fnDefinition;
+      let outputText = '';
+      sinon.stub(process.stdout, 'write').callsFake(text => {
+        outputText += text;
+        return true;
+      });
+
+      replServer.emit('line', 'get.help');
+
+      expect(outputText).to.equal(`${description}
+Interface: get${signature}
+${PROMPT}`);
+    });
+
+    it(`Typing "resolve.help" should print function's description and interface`, async () => {
+      const replServer = await repl(AppModule);
+
+      const { description, signature } = new ResolveReplFn(
+        sinon.stub() as unknown as ReplContext,
+      ).fnDefinition;
+      let outputText = '';
+      sinon.stub(process.stdout, 'write').callsFake(text => {
+        outputText += text;
+        return true;
+      });
+
+      replServer.emit('line', 'resolve.help');
+
+      expect(outputText).to.equal(`${description}
+Interface: resolve${signature}
+${PROMPT}`);
+    });
+
+    it(`Typing "select.help" should print function's description and interface`, async () => {
+      const replServer = await repl(AppModule);
+
+      const { description, signature } = new SelectReplFn(
+        sinon.stub() as unknown as ReplContext,
+      ).fnDefinition;
+      let outputText = '';
+      sinon.stub(process.stdout, 'write').callsFake(text => {
+        outputText += text;
+        return true;
+      });
+
+      replServer.emit('line', 'select.help');
+
+      expect(outputText).to.equal(`${description}
+Interface: select${signature}
+${PROMPT}`);
+    });
+
+    it(`Typing "debug.help" should print function's description and interface`, async () => {
+      const replServer = await repl(AppModule);
+
+      const { description, signature } = new DebugReplFn(
+        sinon.stub() as unknown as ReplContext,
+      ).fnDefinition;
+      let outputText = '';
+      sinon.stub(process.stdout, 'write').callsFake(text => {
+        outputText += text;
+        return true;
+      });
+
+      replServer.emit('line', 'debug.help');
+
+      expect(outputText).to.equal(`${description}
+Interface: debug${signature}
+${PROMPT}`);
+    });
+
+    it(`Typing "methods.help" should print function's description and interface`, async () => {
+      const replServer = await repl(AppModule);
+
+      const { description, signature } = new MethodsReplFn(
+        sinon.stub() as unknown as ReplContext,
+      ).fnDefinition;
+      let outputText = '';
+      sinon.stub(process.stdout, 'write').callsFake(text => {
+        outputText += text;
+        return true;
+      });
+
+      replServer.emit('line', 'methods.help');
+
+      expect(outputText).to.equal(`${description}
+Interface: methods${signature}
+${PROMPT}`);
+    });
+  });
+});
diff --git a/integration/repl/src/app.module.ts b/integration/repl/src/app.module.ts
new file mode 100644
index 000000000..867c4b1b3
--- /dev/null
+++ b/integration/repl/src/app.module.ts
@@ -0,0 +1,7 @@
+import { Module } from '@nestjs/common';
+import { UsersModule } from './users/users.module';
+
+@Module({
+  imports: [UsersModule],
+})
+export class AppModule {}
diff --git a/integration/repl/src/users/dto/create-user.dto.ts b/integration/repl/src/users/dto/create-user.dto.ts
new file mode 100644
index 000000000..0311be138
--- /dev/null
+++ b/integration/repl/src/users/dto/create-user.dto.ts
@@ -0,0 +1 @@
+export class CreateUserDto {}
diff --git a/integration/repl/src/users/dto/update-user.dto.ts b/integration/repl/src/users/dto/update-user.dto.ts
new file mode 100644
index 000000000..dfd37fb1e
--- /dev/null
+++ b/integration/repl/src/users/dto/update-user.dto.ts
@@ -0,0 +1,4 @@
+import { PartialType } from '@nestjs/mapped-types';
+import { CreateUserDto } from './create-user.dto';
+
+export class UpdateUserDto extends PartialType(CreateUserDto) {}
diff --git a/integration/repl/src/users/entities/user.entity.ts b/integration/repl/src/users/entities/user.entity.ts
new file mode 100644
index 000000000..4f82c1457
--- /dev/null
+++ b/integration/repl/src/users/entities/user.entity.ts
@@ -0,0 +1 @@
+export class User {}
diff --git a/integration/repl/src/users/users.controller.ts b/integration/repl/src/users/users.controller.ts
new file mode 100644
index 000000000..d5db3a65e
--- /dev/null
+++ b/integration/repl/src/users/users.controller.ts
@@ -0,0 +1,42 @@
+import {
+  Controller,
+  Get,
+  Post,
+  Body,
+  Patch,
+  Param,
+  Delete,
+} from '@nestjs/common';
+import { UsersService } from './users.service';
+import { CreateUserDto } from './dto/create-user.dto';
+import { UpdateUserDto } from './dto/update-user.dto';
+
+@Controller('users')
+export class UsersController {
+  constructor(private readonly usersService: UsersService) {}
+
+  @Post()
+  create(@Body() createUserDto: CreateUserDto) {
+    return this.usersService.create(createUserDto);
+  }
+
+  @Get()
+  findAll() {
+    return this.usersService.findAll();
+  }
+
+  @Get(':id')
+  findOne(@Param('id') id: string) {
+    return this.usersService.findOne(+id);
+  }
+
+  @Patch(':id')
+  update(@Param('id') id: string, @Body() updateUserDto: UpdateUserDto) {
+    return this.usersService.update(+id, updateUserDto);
+  }
+
+  @Delete(':id')
+  remove(@Param('id') id: string) {
+    return this.usersService.remove(+id);
+  }
+}
diff --git a/integration/repl/src/users/users.module.ts b/integration/repl/src/users/users.module.ts
new file mode 100644
index 000000000..86d73a3f0
--- /dev/null
+++ b/integration/repl/src/users/users.module.ts
@@ -0,0 +1,16 @@
+import { Module } from '@nestjs/common';
+import { UsersController } from './users.controller';
+import { UsersRepository } from './users.repository';
+import { UsersService } from './users.service';
+
+@Module({
+  controllers: [UsersController],
+  providers: [
+    UsersService,
+    {
+      provide: UsersRepository.name,
+      useValue: new UsersRepository(),
+    },
+  ],
+})
+export class UsersModule {}
diff --git a/integration/repl/src/users/users.repository.ts b/integration/repl/src/users/users.repository.ts
new file mode 100644
index 000000000..4a6166586
--- /dev/null
+++ b/integration/repl/src/users/users.repository.ts
@@ -0,0 +1,8 @@
+import { Injectable } from '@nestjs/common';
+
+@Injectable()
+export class UsersRepository {
+  async find() {
+    return [{ id: 1, email: 'test@nestjs.com' }];
+  }
+}
diff --git a/integration/repl/src/users/users.service.ts b/integration/repl/src/users/users.service.ts
new file mode 100644
index 000000000..ab3191152
--- /dev/null
+++ b/integration/repl/src/users/users.service.ts
@@ -0,0 +1,32 @@
+import { Inject, Injectable } from '@nestjs/common';
+import { CreateUserDto } from './dto/create-user.dto';
+import { UpdateUserDto } from './dto/update-user.dto';
+import { UsersRepository } from './users.repository';
+
+@Injectable()
+export class UsersService {
+  constructor(
+    @Inject('UsersRepository')
+    private readonly usersRepository: UsersRepository,
+  ) {}
+
+  create(createUserDto: CreateUserDto) {
+    return 'This action adds a new user';
+  }
+
+  findAll() {
+    return `This action returns all users`;
+  }
+
+  findOne(id: number) {
+    return `This action returns a #${id} user`;
+  }
+
+  update(id: number, updateUserDto: UpdateUserDto) {
+    return `This action updates a #${id} user`;
+  }
+
+  remove(id: number) {
+    return `This action removes a #${id} user`;
+  }
+}
diff --git a/integration/repl/tsconfig.json b/integration/repl/tsconfig.json
new file mode 100644
index 000000000..cef623d14
--- /dev/null
+++ b/integration/repl/tsconfig.json
@@ -0,0 +1,40 @@
+{
+  "compilerOptions": {
+    "module": "commonjs",
+    "declaration": false,
+    "noImplicitAny": false,
+    "removeComments": true,
+    "noLib": false,
+    "emitDecoratorMetadata": true,
+    "experimentalDecorators": true,
+    "target": "ES2021",
+    "sourceMap": true,
+    "allowJs": true,
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
+  },
+  "include": [
+    "src/**/*",
+    "e2e/**/*"
+  ],
+  "exclude": [
+    "node_modules",
+  ]
+}
\ No newline at end of file
diff --git a/integration/scopes/e2e/durable-providers.spec.ts b/integration/scopes/e2e/durable-providers.spec.ts
new file mode 100644
index 000000000..325bd4ee0
--- /dev/null
+++ b/integration/scopes/e2e/durable-providers.spec.ts
@@ -0,0 +1,93 @@
+import { INestApplication } from '@nestjs/common';
+import { ContextIdFactory } from '@nestjs/core';
+import { Test } from '@nestjs/testing';
+import { expect } from 'chai';
+import * as request from 'supertest';
+import { DurableContextIdStrategy } from '../src/durable/durable-context-id.strategy';
+import { DurableModule } from '../src/durable/durable.module';
+
+describe('Durable providers', () => {
+  let server: any;
+  let app: INestApplication;
+
+  before(async () => {
+    const moduleRef = await Test.createTestingModule({
+      imports: [DurableModule],
+    }).compile();
+
+    app = moduleRef.createNestApplication();
+    server = app.getHttpServer();
+    await app.init();
+
+    ContextIdFactory.apply(new DurableContextIdStrategy());
+  });
+
+  describe('when service is durable', () => {
+    const performHttpCall = (
+      tenantId: number,
+      end: (err?: any) => void,
+      endpoint = '/durable',
+    ) =>
+      request(server)
+        .get(endpoint)
+        .set({ ['x-tenant-id']: tenantId })
+        .end((err, res) => {
+          if (err) return end(err);
+          end(res);
+        });
+
+    it(`should share durable providers per tenant`, async () => {
+      let result: request.Response;
+      result = await new Promise<request.Response>(resolve =>
+        performHttpCall(1, resolve),
+      );
+      expect(result.text).equal('Hello world! Counter: 1');
+
+      result = await new Promise<request.Response>(resolve =>
+        performHttpCall(1, resolve),
+      );
+      expect(result.text).equal('Hello world! Counter: 2');
+
+      result = await new Promise<request.Response>(resolve =>
+        performHttpCall(1, resolve),
+      );
+      expect(result.text).equal('Hello world! Counter: 3');
+    });
+
+    it(`should create per-tenant DI sub-tree`, async () => {
+      let result: request.Response;
+      result = await new Promise<request.Response>(resolve =>
+        performHttpCall(4, resolve),
+      );
+      expect(result.text).equal('Hello world! Counter: 1');
+
+      result = await new Promise<request.Response>(resolve =>
+        performHttpCall(5, resolve),
+      );
+      expect(result.text).equal('Hello world! Counter: 1');
+
+      result = await new Promise<request.Response>(resolve =>
+        performHttpCall(6, resolve),
+      );
+      expect(result.text).equal('Hello world! Counter: 1');
+    });
+
+    it(`should register a custom per-tenant request payload`, async () => {
+      let result: request.Response;
+      result = await new Promise<request.Response>(resolve =>
+        performHttpCall(1, resolve, '/durable/echo'),
+      );
+      expect(result.body).deep.equal({ tenantId: '1' });
+
+      result = await new Promise<request.Response>(resolve =>
+        performHttpCall(3, resolve, '/durable/echo'),
+      );
+      expect(result.body).deep.equal({ tenantId: '3' });
+    });
+  });
+
+  after(async () => {
+    ContextIdFactory['strategy'] = undefined;
+    await app.close();
+  });
+});
diff --git a/integration/scopes/e2e/msvc-request-scope.spec.ts b/integration/scopes/e2e/msvc-request-scope.spec.ts
index b6273c33d..7a6b6d649 100644
--- a/integration/scopes/e2e/msvc-request-scope.spec.ts
+++ b/integration/scopes/e2e/msvc-request-scope.spec.ts
@@ -1,5 +1,5 @@
 import { INestApplication } from '@nestjs/common';
-import { Transport } from '@nestjs/microservices';
+import { MicroserviceOptions, Transport } from '@nestjs/microservices';
 import { Test } from '@nestjs/testing';
 import { expect } from 'chai';
 import * as request from 'supertest';
@@ -31,7 +31,7 @@ describe('Request scope (microservices)', () => {
     }).compile();
 
     app = module.createNestApplication();
-    app.connectMicroservice({ transport: Transport.TCP });
+    app.connectMicroservice<MicroserviceOptions>({ transport: Transport.TCP });
 
     server = app.getHttpServer();
     await app.init();
diff --git a/integration/scopes/src/durable/durable-context-id.strategy.ts b/integration/scopes/src/durable/durable-context-id.strategy.ts
new file mode 100644
index 000000000..d4158f3e2
--- /dev/null
+++ b/integration/scopes/src/durable/durable-context-id.strategy.ts
@@ -0,0 +1,23 @@
+import { ContextId, ContextIdStrategy, HostComponentInfo } from '@nestjs/core';
+import { Request } from 'express';
+
+const tenants = new Map<string, ContextId>();
+
+export class DurableContextIdStrategy implements ContextIdStrategy {
+  attach(contextId: ContextId, request: Request) {
+    const tenantId = request.headers['x-tenant-id'] as string;
+    let tenantSubTreeId: ContextId;
+
+    if (tenants.has(tenantId)) {
+      tenantSubTreeId = tenants.get(tenantId);
+    } else {
+      tenantSubTreeId = { id: +tenantId } as ContextId;
+      tenants.set(tenantId, tenantSubTreeId);
+    }
+    return {
+      resolve: (info: HostComponentInfo) =>
+        info.isTreeDurable ? tenantSubTreeId : contextId,
+      payload: { tenantId },
+    };
+  }
+}
diff --git a/integration/scopes/src/durable/durable.controller.ts b/integration/scopes/src/durable/durable.controller.ts
new file mode 100644
index 000000000..be51ad2df
--- /dev/null
+++ b/integration/scopes/src/durable/durable.controller.ts
@@ -0,0 +1,17 @@
+import { Controller, Get } from '@nestjs/common';
+import { DurableService } from './durable.service';
+
+@Controller('durable')
+export class DurableController {
+  constructor(private readonly durableService: DurableService) {}
+
+  @Get()
+  greeting(): string {
+    return this.durableService.greeting();
+  }
+
+  @Get('echo')
+  echo() {
+    return this.durableService.requestPayload;
+  }
+}
diff --git a/integration/scopes/src/durable/durable.guard.ts b/integration/scopes/src/durable/durable.guard.ts
new file mode 100644
index 000000000..8868af809
--- /dev/null
+++ b/integration/scopes/src/durable/durable.guard.ts
@@ -0,0 +1,21 @@
+import {
+  CanActivate,
+  ExecutionContext,
+  Injectable,
+  Scope,
+} from '@nestjs/common';
+import { DurableService } from './durable.service';
+
+@Injectable({ scope: Scope.REQUEST, durable: true })
+export class DurableGuard implements CanActivate {
+  public instanceCounter = 0;
+  constructor(private readonly durableService: DurableService) {}
+
+  public async canActivate(context: ExecutionContext): Promise<boolean> {
+    if (typeof this.durableService === 'undefined') {
+      throw new Error('Durable service is undefined');
+    }
+    this.instanceCounter++;
+    return true;
+  }
+}
diff --git a/integration/scopes/src/durable/durable.module.ts b/integration/scopes/src/durable/durable.module.ts
new file mode 100644
index 000000000..d749135bd
--- /dev/null
+++ b/integration/scopes/src/durable/durable.module.ts
@@ -0,0 +1,17 @@
+import { Module } from '@nestjs/common';
+import { APP_GUARD } from '@nestjs/core';
+import { DurableController } from './durable.controller';
+import { DurableGuard } from './durable.guard';
+import { DurableService } from './durable.service';
+
+@Module({
+  controllers: [DurableController],
+  providers: [
+    DurableService,
+    {
+      provide: APP_GUARD,
+      useClass: DurableGuard,
+    },
+  ],
+})
+export class DurableModule {}
diff --git a/integration/scopes/src/durable/durable.service.ts b/integration/scopes/src/durable/durable.service.ts
new file mode 100644
index 000000000..6e25b01dd
--- /dev/null
+++ b/integration/scopes/src/durable/durable.service.ts
@@ -0,0 +1,14 @@
+import { Inject, Injectable, Scope } from '@nestjs/common';
+import { REQUEST } from '@nestjs/core';
+
+@Injectable({ scope: Scope.REQUEST, durable: true })
+export class DurableService {
+  public instanceCounter = 0;
+
+  constructor(@Inject(REQUEST) public readonly requestPayload: unknown) {}
+
+  greeting() {
+    ++this.instanceCounter;
+    return `Hello world! Counter: ${this.instanceCounter}`;
+  }
+}
diff --git a/integration/scopes/tsconfig.json b/integration/scopes/tsconfig.json
index c6354c564..cef623d14 100644
--- a/integration/scopes/tsconfig.json
+++ b/integration/scopes/tsconfig.json
@@ -7,10 +7,28 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
diff --git a/integration/send-files/e2e/express.spec.ts b/integration/send-files/e2e/express.spec.ts
index 425ce6695..c0b8e5661 100644
--- a/integration/send-files/e2e/express.spec.ts
+++ b/integration/send-files/e2e/express.spec.ts
@@ -8,8 +8,14 @@ import { readFileSync } from 'fs';
 import { join } from 'path';
 import * as request from 'supertest';
 import { AppModule } from '../src/app.module';
+import {
+  getHttpBaseOptions,
+  sendCanceledHttpRequest,
+  sendHttpRequest,
+} from './utils';
 
-const readmeString = readFileSync(join(process.cwd(), 'Readme.md')).toString();
+const readme = readFileSync(join(process.cwd(), 'Readme.md'));
+const readmeString = readme.toString();
 
 describe('Express FileSend', () => {
   let app: NestExpressApplication;
@@ -53,14 +59,29 @@ describe('Express FileSend', () => {
         expect(res.body.toString()).to.be.eq(readmeString);
       });
   });
-  it('should return a file with correct content type and disposition', async () => {
+  it('should return a file with correct headers', async () => {
     return request(app.getHttpServer())
       .get('/file/with/headers')
       .expect(200)
       .expect('Content-Type', 'text/markdown')
       .expect('Content-Disposition', 'attachment; filename="Readme.md"')
+      .expect('Content-Length', readme.byteLength.toString())
       .expect(res => {
         expect(res.text).to.be.eq(readmeString);
       });
   });
+  it('should return an error if the file does not exist', async () => {
+    return request(app.getHttpServer()).get('/file/not/exist').expect(400);
+  });
+  // TODO: temporarily turned off (flaky test)
+  it.skip(
+    'should allow for the client to end the response and be able to make another',
+    async () => {
+      await app.listen(0);
+      const url = await getHttpBaseOptions(app);
+      await sendCanceledHttpRequest(new URL('/file/slow', url));
+      const res = await sendHttpRequest(new URL('/file/stream', url));
+      expect(res.statusCode).to.be.eq(200);
+    },
+  ).timeout(5000);
 });
diff --git a/integration/send-files/e2e/fastify.spec.ts b/integration/send-files/e2e/fastify.spec.ts
index 9e7ee5b5e..8b821ba7c 100644
--- a/integration/send-files/e2e/fastify.spec.ts
+++ b/integration/send-files/e2e/fastify.spec.ts
@@ -8,7 +8,8 @@ import { readFileSync } from 'fs';
 import { join } from 'path';
 import { AppModule } from '../src/app.module';
 
-const readmeString = readFileSync(join(process.cwd(), 'Readme.md')).toString();
+const readme = readFileSync(join(process.cwd(), 'Readme.md'));
+const readmeString = readme.toString();
 
 describe('Fastify FileSend', () => {
   let app: NestFastifyApplication;
@@ -67,4 +68,17 @@ describe('Fastify FileSend', () => {
         expect(payload.toString()).to.be.eq(readmeString);
       });
   });
+  it('should return a file with correct headers', async () => {
+    return app
+      .inject({ url: '/file/with/headers', method: 'get' })
+      .then(({ statusCode, headers, payload }) => {
+        expect(statusCode).to.equal(200);
+        expect(headers['content-type']).to.equal('text/markdown');
+        expect(headers['content-disposition']).to.equal(
+          'attachment; filename="Readme.md"',
+        );
+        expect(headers['content-length']).to.equal(readme.byteLength);
+        expect(payload).to.equal(readmeString);
+      });
+  });
 });
diff --git a/integration/send-files/e2e/utils.ts b/integration/send-files/e2e/utils.ts
new file mode 100644
index 000000000..bc2f1f7b6
--- /dev/null
+++ b/integration/send-files/e2e/utils.ts
@@ -0,0 +1,47 @@
+import { INestApplication } from '@nestjs/common';
+import { IncomingMessage, request, RequestOptions } from 'http';
+import { URL } from 'url';
+
+export const getHttpBaseOptions = async (
+  app: INestApplication,
+): Promise<URL> => {
+  const url = await app.getUrl();
+  return new URL(url);
+};
+
+export const sendCanceledHttpRequest = async (url: URL) => {
+  return new Promise((resolve, reject) => {
+    const req = request(url, res => {
+      // close the request once we get the first response of data
+      res.on('data', () => {
+        req.destroy();
+      });
+      // response is closed, move on to next request and verify it's doable
+      res.on('close', resolve);
+    });
+    // fire the request
+    req.end();
+  });
+};
+
+export const sendHttpRequest = async (url: URL) => {
+  return new Promise<IncomingMessage>((resolve, reject) => {
+    const req = request(url, res => {
+      // this makes sure that the response actually starts and is read. We could verify this value against the same
+      // that is in an earlier test, but all we care about in _this_ test is that the status code is 200
+      res.on('data', chunk => {
+        // no op
+      });
+      // fail the test if something goes wrong
+      res.on('error', err => {
+        reject(err);
+      });
+      // pass the response back so we can verify values in the test
+      res.on('end', () => {
+        resolve(res);
+      });
+    });
+    // fire the request
+    req.end();
+  });
+};
diff --git a/integration/send-files/src/app.controller.ts b/integration/send-files/src/app.controller.ts
index 606e2d598..69fa20ec0 100644
--- a/integration/send-files/src/app.controller.ts
+++ b/integration/send-files/src/app.controller.ts
@@ -31,4 +31,14 @@ export class AppController {
   getFileWithHeaders(): StreamableFile {
     return this.appService.getFileWithHeaders();
   }
+
+  @Get('file/not/exist')
+  getNonExistantFile(): StreamableFile {
+    return this.appService.getFileThatDoesNotExist();
+  }
+
+  @Get('/file/slow')
+  getSlowFile(): StreamableFile {
+    return this.appService.getSlowStream();
+  }
 }
diff --git a/integration/send-files/src/app.service.ts b/integration/send-files/src/app.service.ts
index a83e6a4f6..e5f920c48 100644
--- a/integration/send-files/src/app.service.ts
+++ b/integration/send-files/src/app.service.ts
@@ -1,11 +1,16 @@
 import { Injectable, StreamableFile } from '@nestjs/common';
+import { randomBytes } from 'crypto';
 import { createReadStream, readFileSync } from 'fs';
 import { join } from 'path';
 import { Observable, of } from 'rxjs';
+import { Readable } from 'stream';
 import { NonFile } from './non-file';
 
 @Injectable()
 export class AppService {
+  // `randomBytes` has a max value of 2^31 -1. That's all this is
+  private readonly MAX_BITES = Math.pow(2, 31) - 1;
+
   getReadStream(): StreamableFile {
     return new StreamableFile(
       createReadStream(join(process.cwd(), 'Readme.md')),
@@ -25,12 +30,26 @@ export class AppService {
   }
 
   getFileWithHeaders(): StreamableFile {
+    const file = readFileSync(join(process.cwd(), 'Readme.md'));
     return new StreamableFile(
       createReadStream(join(process.cwd(), 'Readme.md')),
       {
         type: 'text/markdown',
         disposition: 'attachment; filename="Readme.md"',
+        length: file.byteLength,
       },
     );
   }
+
+  getFileThatDoesNotExist(): StreamableFile {
+    return new StreamableFile(createReadStream('does-not-exist.txt'));
+  }
+
+  getSlowStream(): StreamableFile {
+    const stream = new Readable();
+    stream.push(Buffer.from(randomBytes(this.MAX_BITES)));
+    // necessary for a `new Readable()`. Doesn't do anything
+    stream._read = () => {};
+    return new StreamableFile(stream);
+  }
 }
diff --git a/integration/send-files/tsconfig.json b/integration/send-files/tsconfig.json
index c6354c564..cef623d14 100644
--- a/integration/send-files/tsconfig.json
+++ b/integration/send-files/tsconfig.json
@@ -7,10 +7,28 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
diff --git a/integration/testing-module-override/e2e/circular-dependency/a.module.ts b/integration/testing-module-override/e2e/circular-dependency/a.module.ts
deleted file mode 100644
index 695a9edbd..000000000
--- a/integration/testing-module-override/e2e/circular-dependency/a.module.ts
+++ /dev/null
@@ -1,12 +0,0 @@
-import { Injectable, Module, forwardRef } from '@nestjs/common';
-import { BModule, BProvider } from './b.module';
-
-@Injectable()
-export class AProvider {}
-
-@Module({
-  imports: [forwardRef(() => BModule)],
-  providers: [AProvider],
-  exports: [AProvider],
-})
-export class AModule {}
diff --git a/integration/testing-module-override/e2e/circular-dependency/b.module.ts b/integration/testing-module-override/e2e/circular-dependency/b.module.ts
deleted file mode 100644
index 6671d82a6..000000000
--- a/integration/testing-module-override/e2e/circular-dependency/b.module.ts
+++ /dev/null
@@ -1,12 +0,0 @@
-import { Injectable, Module, forwardRef } from '@nestjs/common';
-import { AModule, AProvider } from './a.module';
-
-@Injectable()
-export class BProvider {}
-
-@Module({
-  imports: [forwardRef(() => AModule)],
-  providers: [BProvider],
-  exports: [BProvider],
-})
-export class BModule {}
diff --git a/integration/testing-module-override/e2e/modules-override.spec.ts b/integration/testing-module-override/e2e/modules-override.spec.ts
deleted file mode 100644
index 991d9ae6b..000000000
--- a/integration/testing-module-override/e2e/modules-override.spec.ts
+++ /dev/null
@@ -1,309 +0,0 @@
-import {
-  Controller,
-  Module,
-  DynamicModule,
-  forwardRef,
-  Injectable,
-  Global,
-} from '@nestjs/common';
-import { LazyModuleLoader } from '@nestjs/core';
-import { Test, TestingModule } from '@nestjs/testing';
-import { expect } from 'chai';
-
-import { AModule, AProvider } from './circular-dependency/a.module';
-import { BModule, BProvider } from './circular-dependency/b.module';
-
-describe('modules override', () => {
-  describe('top-level module', () => {
-    @Controller()
-    class ControllerOverwritten {}
-
-    @Module({
-      controllers: [ControllerOverwritten],
-    })
-    class ModuleToBeOverwritten {}
-
-    @Controller()
-    class ControllerOverride {}
-
-    @Module({
-      controllers: [ControllerOverride],
-    })
-    class ModuleOverride {}
-
-    let testingModule: TestingModule;
-
-    beforeEach(async () => {
-      testingModule = await Test.createTestingModule({
-        imports: [ModuleToBeOverwritten],
-      })
-        .overrideModule(ModuleToBeOverwritten)
-        .useModule(ModuleOverride)
-        .compile();
-    });
-
-    it('should be possible to override top-level modules using testing module builder', () => {
-      expect(() =>
-        testingModule.get<ControllerOverwritten>(ControllerOverwritten),
-      ).to.throw();
-      expect(
-        testingModule.get<ControllerOverride>(ControllerOverride),
-      ).to.be.an.instanceof(ControllerOverride);
-    });
-  });
-
-  describe('dynamic module', () => {
-    @Controller()
-    class ControllerOverwritten {}
-
-    @Module({})
-    class DynamicModuleToBeOverwritten {}
-
-    const dynamicModuleOverwritten: DynamicModule = {
-      module: DynamicModuleToBeOverwritten,
-      controllers: [ControllerOverwritten],
-    };
-
-    @Controller()
-    class ControllerOverride {}
-
-    @Module({})
-    class DynamicModuleOverride {}
-
-    const dynamicModuleOverride: DynamicModule = {
-      module: DynamicModuleOverride,
-      controllers: [ControllerOverride],
-    };
-
-    let testingModule: TestingModule;
-
-    beforeEach(async () => {
-      testingModule = await Test.createTestingModule({
-        imports: [dynamicModuleOverwritten],
-      })
-        .overrideModule(dynamicModuleOverwritten)
-        .useModule(dynamicModuleOverride)
-        .compile();
-    });
-
-    it('should be possible to override dynamic modules using testing module builder', () => {
-      expect(() =>
-        testingModule.get<ControllerOverwritten>(ControllerOverwritten),
-      ).to.throw();
-      expect(
-        testingModule.get<ControllerOverride>(ControllerOverride),
-      ).to.be.an.instanceof(ControllerOverride);
-    });
-  });
-
-  describe('circular dependency module', () => {
-    let testingModule: TestingModule;
-
-    @Injectable()
-    class CProvider {}
-
-    @Module({
-      providers: [CProvider],
-    })
-    class CModule {}
-
-    @Injectable()
-    class BProviderOverride {}
-
-    @Module({
-      imports: [forwardRef(() => AModule), forwardRef(() => CModule)],
-      providers: [BProviderOverride],
-      exports: [BProviderOverride],
-    })
-    class BModuleOverride {}
-
-    beforeEach(async () => {
-      testingModule = await Test.createTestingModule({
-        imports: [AModule],
-      })
-        .overrideModule(BModule)
-        .useModule(BModuleOverride)
-        .compile();
-    });
-
-    it('should be possible to override top-level modules using testing module builder', () => {
-      expect(testingModule.get<AProvider>(AProvider)).to.be.an.instanceof(
-        AProvider,
-      );
-      expect(() => testingModule.get<BProvider>(BProvider)).to.throw();
-      expect(testingModule.get<CProvider>(CProvider)).to.be.an.instanceof(
-        CProvider,
-      );
-      expect(
-        testingModule.get<BProviderOverride>(BProviderOverride),
-      ).to.be.an.instanceof(BProviderOverride);
-    });
-  });
-
-  describe('nested module', () => {
-    let testingModule: TestingModule;
-
-    @Controller()
-    class OverwrittenNestedModuleController {}
-
-    @Module({
-      controllers: [OverwrittenNestedModuleController],
-    })
-    class OverwrittenNestedModule {}
-
-    @Controller()
-    class OverrideNestedModuleController {}
-
-    @Module({
-      controllers: [OverrideNestedModuleController],
-    })
-    class OverrideNestedModule {}
-
-    @Module({
-      imports: [OverwrittenNestedModule],
-    })
-    class AppModule {}
-
-    beforeEach(async () => {
-      testingModule = await Test.createTestingModule({
-        imports: [AppModule],
-      })
-        .overrideModule(OverwrittenNestedModule)
-        .useModule(OverrideNestedModule)
-        .compile();
-    });
-
-    it('should be possible to override nested modules using testing module builder', () => {
-      expect(
-        testingModule.get<OverrideNestedModuleController>(
-          OverrideNestedModuleController,
-        ),
-      ).to.be.an.instanceof(OverrideNestedModuleController);
-      expect(() =>
-        testingModule.get<OverwrittenNestedModuleController>(
-          OverwrittenNestedModuleController,
-        ),
-      ).to.throw();
-    });
-  });
-
-  describe('lazy-loaded module', () => {
-    let testingModule: TestingModule;
-
-    @Injectable()
-    class OverwrittenLazyProvider {
-      value() {
-        return 'overwritten lazy';
-      }
-    }
-
-    @Module({
-      providers: [
-        {
-          provide: 'LAZY_PROVIDER',
-          useClass: OverwrittenLazyProvider,
-        },
-      ],
-    })
-    class OverwrittenLazyModule {}
-
-    @Injectable()
-    class OverrideLazyProvider {
-      value() {
-        return 'override lazy';
-      }
-    }
-
-    @Module({
-      providers: [
-        {
-          provide: 'LAZY_PROVIDER',
-          useClass: OverrideLazyProvider,
-        },
-      ],
-    })
-    class OverrideLazyModule {}
-
-    @Injectable()
-    class AppService {
-      constructor(private lazyModuleLoader: LazyModuleLoader) {}
-
-      async value() {
-        const moduleRef = await this.lazyModuleLoader.load(
-          () => OverwrittenLazyModule,
-        );
-        return moduleRef.get('LAZY_PROVIDER').value();
-      }
-    }
-
-    @Module({
-      imports: [],
-      providers: [AppService],
-    })
-    class AppModule {}
-
-    beforeEach(async () => {
-      testingModule = await Test.createTestingModule({
-        imports: [AppModule],
-      })
-        .overrideModule(OverwrittenLazyModule)
-        .useModule(OverrideLazyModule)
-        .compile();
-    });
-
-    it('should be possible to override lazy loaded modules using testing module builder', async () => {
-      const result = await testingModule.get<AppService>(AppService).value();
-      expect(result).to.be.equal('override lazy');
-    });
-  });
-
-  describe('global module', () => {
-    let testingModule: TestingModule;
-
-    @Injectable()
-    class OverwrittenProvider {
-      value() {
-        return 'overwritten lazy';
-      }
-    }
-
-    @Global()
-    @Module({
-      providers: [OverwrittenProvider],
-      exports: [OverwrittenProvider],
-    })
-    class OverwrittenModule {}
-
-    @Injectable()
-    class OverrideProvider {
-      value() {
-        return 'override lazy';
-      }
-    }
-
-    @Global()
-    @Module({
-      providers: [OverrideProvider],
-      exports: [OverrideProvider],
-    })
-    class OverrideModule {}
-
-    beforeEach(async () => {
-      testingModule = await Test.createTestingModule({
-        imports: [OverwrittenModule],
-      })
-        .overrideModule(OverwrittenModule)
-        .useModule(OverrideModule)
-        .compile();
-    });
-
-    it('should be possible to override global modules using testing module builder', () => {
-      expect(
-        testingModule.get<OverrideProvider>(OverrideProvider),
-      ).to.be.an.instanceof(OverrideProvider);
-      expect(() =>
-        testingModule.get<OverwrittenProvider>(OverwrittenProvider),
-      ).to.throw();
-    });
-  });
-});
diff --git a/integration/typeorm/e2e/typeorm.spec.ts b/integration/typeorm/e2e/typeorm.spec.ts
index 60ab18303..958713903 100644
--- a/integration/typeorm/e2e/typeorm.spec.ts
+++ b/integration/typeorm/e2e/typeorm.spec.ts
@@ -1,7 +1,7 @@
 import { INestApplication } from '@nestjs/common';
 import { Test } from '@nestjs/testing';
 import * as request from 'supertest';
-import { ApplicationModule } from '../src/app.module';
+import { AppModule } from '../src/app.module';
 
 describe('TypeOrm', () => {
   let server;
@@ -9,7 +9,7 @@ describe('TypeOrm', () => {
 
   beforeEach(async () => {
     const module = await Test.createTestingModule({
-      imports: [ApplicationModule],
+      imports: [AppModule],
     }).compile();
 
     app = module.createNestApplication();
diff --git a/integration/typeorm/src/app.module.ts b/integration/typeorm/src/app.module.ts
index 32fbf84fd..96bdb7bb1 100644
--- a/integration/typeorm/src/app.module.ts
+++ b/integration/typeorm/src/app.module.ts
@@ -21,4 +21,4 @@ import { PhotoModule } from './photo/photo.module';
     PhotoModule,
   ],
 })
-export class ApplicationModule {}
+export class AppModule {}
diff --git a/integration/typeorm/tsconfig.json b/integration/typeorm/tsconfig.json
index ea15af490..cef623d14 100644
--- a/integration/typeorm/tsconfig.json
+++ b/integration/typeorm/tsconfig.json
@@ -7,16 +7,34 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
-    "src/**/*"
+    "src/**/*",
+    "e2e/**/*"
   ],
   "exclude": [
     "node_modules",
-    "**/*.spec.ts"
   ]
 }
\ No newline at end of file
diff --git a/integration/versioning/e2e/custom-versioning-fastify.spec.ts b/integration/versioning/e2e/custom-versioning-fastify.spec.ts
new file mode 100644
index 000000000..0deaf4e59
--- /dev/null
+++ b/integration/versioning/e2e/custom-versioning-fastify.spec.ts
@@ -0,0 +1,967 @@
+import { INestApplication, VersioningType } from '@nestjs/common';
+import {
+  FastifyAdapter,
+  NestFastifyApplication,
+} from '@nestjs/platform-fastify';
+import { Test } from '@nestjs/testing';
+import { FastifyRequest } from 'fastify';
+import * as request from 'supertest';
+import { AppModule } from '../src/app.module';
+
+describe('Custom Versioning (fastify)', () => {
+  const extractor = (request: FastifyRequest): string | string[] => {
+    const versions = [request.headers['accept'] ?? '']
+      .flatMap(v => v.split(','))
+      .map(header => header.match(/v(\d+\.?\d*)\+json$/))
+      .filter(match => match && match.length)
+      .map(matchArray => matchArray[1])
+      .sort()
+      .reverse();
+
+    return versions;
+  };
+  let app: INestApplication;
+
+  // ======================================================================== //
+  describe('without global default version', () => {
+    before(async () => {
+      const moduleRef = await Test.createTestingModule({
+        imports: [AppModule],
+      }).compile();
+
+      app = moduleRef.createNestApplication<NestFastifyApplication>(
+        new FastifyAdapter(),
+      );
+      app.enableVersioning({
+        type: VersioningType.CUSTOM,
+        extractor,
+      });
+      await app.init();
+      await app.getHttpAdapter().getInstance().ready();
+    });
+
+    describe('GET /', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Hello World V1!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Hello World V2!');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Hello World V2!');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Hello World V2!');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/').expect(404);
+      });
+    });
+
+    describe('GET /:param', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Parameter V1!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Parameter V2!');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Parameter V2!');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Parameter V2!');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: '',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/').expect(404);
+      });
+    });
+
+    describe('GET /multiple', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/multiple').expect(404);
+      });
+    });
+
+    describe('GET /neutral', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .expect(200)
+          .expect('Neutral');
+      });
+    });
+
+    describe('GET /override', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Override Version 1');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Version 2');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Version 2');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Override Version 2');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/override').expect(404);
+      });
+    });
+
+    describe('GET /override-partial', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 1');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 2');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 2');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 2');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .expect(404);
+      });
+    });
+
+    describe('GET /foo/bar', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+    });
+
+    after(async () => {
+      await app.close();
+    });
+  });
+
+  // ======================================================================== //
+  describe('with the global default version: "1"', () => {
+    before(async () => {
+      const moduleRef = await Test.createTestingModule({
+        imports: [AppModule],
+      }).compile();
+
+      app = moduleRef.createNestApplication<NestFastifyApplication>(
+        new FastifyAdapter(),
+      );
+      app.enableVersioning({
+        type: VersioningType.CUSTOM,
+        extractor,
+        defaultVersion: '1',
+      });
+      await app.init();
+      await app.getHttpAdapter().getInstance().ready();
+    });
+
+    describe('GET /', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Hello World V1!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Hello World V2!');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Hello World V2!');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Hello World V2!');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/').expect(404);
+      });
+    });
+
+    describe('GET /:param', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Parameter V1!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Parameter V2!');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Parameter V2!');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Parameter V2!');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: '',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/').expect(404);
+      });
+    });
+
+    describe('GET /multiple', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/multiple').expect(404);
+      });
+    });
+
+    describe('GET /neutral', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .expect(200)
+          .expect('Neutral');
+      });
+    });
+
+    describe('GET /override', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Override Version 1');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Version 2');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Version 2');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Override Version 2');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/override').expect(404);
+      });
+    });
+
+    describe('GET /override-partial', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 1');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 2');
+      });
+
+      it('V2, if two versions are requested, select the highest version', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 2');
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept:
+              'application/foo.v1+json, application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 2');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .expect(404);
+      });
+    });
+
+    describe('GET /foo/bar', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(404);
+      });
+
+      it('V2, if a non-existent version is requested, select the highest supported version', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v1+json, application/foo.v2+json',
+          })
+          .expect('Hello FooBar!');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/foo/bar').expect(404);
+      });
+    });
+
+    after(async () => {
+      await app.close();
+    });
+  });
+});
diff --git a/integration/versioning/e2e/custom-versioning.spec.ts b/integration/versioning/e2e/custom-versioning.spec.ts
new file mode 100644
index 000000000..9cff09d2f
--- /dev/null
+++ b/integration/versioning/e2e/custom-versioning.spec.ts
@@ -0,0 +1,712 @@
+import { INestApplication, VersioningType } from '@nestjs/common';
+import { Test } from '@nestjs/testing';
+import { Request } from 'express';
+import * as request from 'supertest';
+import { AppModule } from '../src/app.module';
+
+describe('Custom Versioning', () => {
+  const extractor = (request: Request): string | string[] => {
+    const versions = request
+      .header('Accept')
+      ?.split(',')
+      .map(header => header.match(/v(\d+\.?\d*)\+json$/))
+      .filter(match => match && match.length)
+      .map(matchArray => matchArray[1])
+      .sort()
+      .reverse();
+
+    return versions;
+  };
+  let app: INestApplication;
+
+  // ======================================================================== //
+  describe('without global default version', () => {
+    before(async () => {
+      const moduleRef = await Test.createTestingModule({
+        imports: [AppModule],
+      }).compile();
+
+      app = moduleRef.createNestApplication();
+      app.enableVersioning({
+        type: VersioningType.CUSTOM,
+        extractor,
+      });
+      await app.init();
+    });
+
+    describe('GET /', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Hello World V1!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Hello World V2!');
+      });
+
+      // There's a known limitation of the express-adapter, where
+      // it cannot handle selection of the highest matched version properly.
+      //
+      // it('V2, if two versions are requested, select the highest version', () => {
+      //   return request(app.getHttpServer())
+      //     .get('/')
+      //     .set({
+      //       Accept: 'application/foo.v1+json, application/foo.v2+json',
+      //     })
+      //     .expect(200)
+      //     .expect('Hello World V2!');
+      // });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/').expect(404);
+      });
+    });
+
+    describe('GET /:param', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Parameter V1!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Parameter V2!');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: '',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/').expect(404);
+      });
+    });
+
+    describe('GET /multiple', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V2, if an unsupported version is specified, select the lower supported version', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v2+json, application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/multiple').expect(404);
+      });
+    });
+
+    describe('GET /neutral', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .expect(200)
+          .expect('Neutral');
+      });
+    });
+
+    describe('GET /override', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Override Version 1');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Version 2');
+      });
+
+      // There's a known limitation of the express-adapter, where
+      // it cannot handle selection of the highest matched version properly.
+      //
+      // it('V2, if two versions are requested, select the highest version', () => {
+      //   return request(app.getHttpServer())
+      //     .get('/override')
+      //     .set({
+      //       Accept: 'application/foo.v1+json, application/foo.v2+json',
+      //     })
+      //     .expect(200)
+      //     .expect('Override Version 2');
+      // });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/override').expect(404);
+      });
+    });
+
+    describe('GET /override-partial', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 1');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 2');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .expect(404);
+      });
+    });
+
+    describe('GET /foo/bar', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+    });
+
+    after(async () => {
+      await app.close();
+    });
+  });
+
+  // ======================================================================== //
+  describe('with the global default version: "1"', () => {
+    before(async () => {
+      const moduleRef = await Test.createTestingModule({
+        imports: [AppModule],
+      }).compile();
+
+      app = moduleRef.createNestApplication();
+      app.enableVersioning({
+        type: VersioningType.CUSTOM,
+        extractor,
+        defaultVersion: '1',
+      });
+      await app.init();
+    });
+
+    describe('GET /', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Hello World V1!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Hello World V2!');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/').expect(404);
+      });
+    });
+
+    describe('GET /:param', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Parameter V1!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Parameter V2!');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/param/hello')
+          .set({
+            Accept: '',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/').expect(404);
+      });
+    });
+
+    describe('GET /multiple', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Multiple Versions 1 or 2');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/multiple')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/multiple').expect(404);
+      });
+    });
+
+    describe('GET /neutral', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(200)
+          .expect('Neutral');
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer())
+          .get('/neutral')
+          .expect(200)
+          .expect('Neutral');
+      });
+    });
+
+    describe('GET /override', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Override Version 1');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Version 2');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/override')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/override').expect(404);
+      });
+    });
+
+    describe('GET /override-partial', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 1');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(200)
+          .expect('Override Partial Version 2');
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer())
+          .get('/override-partial')
+          .expect(404);
+      });
+    });
+
+    describe('GET /foo/bar', () => {
+      it('V1', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v1+json',
+          })
+          .expect(200)
+          .expect('Hello FooBar!');
+      });
+
+      it('V2', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v2+json',
+          })
+          .expect(404);
+      });
+
+      it('V3', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/foo.v3+json',
+          })
+          .expect(404);
+      });
+
+      it('No Version', () => {
+        return request(app.getHttpServer())
+          .get('/foo/bar')
+          .set({
+            Accept: 'application/json',
+          })
+          .expect(404);
+      });
+
+      it('No Header', () => {
+        return request(app.getHttpServer()).get('/foo/bar').expect(404);
+      });
+    });
+
+    after(async () => {
+      await app.close();
+    });
+  });
+});
diff --git a/integration/versioning/tsconfig.json b/integration/versioning/tsconfig.json
index c6354c564..cef623d14 100644
--- a/integration/versioning/tsconfig.json
+++ b/integration/versioning/tsconfig.json
@@ -7,10 +7,28 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
diff --git a/integration/websockets/e2e/ws-gateway.spec.ts b/integration/websockets/e2e/ws-gateway.spec.ts
index c68883ba3..973e7c839 100644
--- a/integration/websockets/e2e/ws-gateway.spec.ts
+++ b/integration/websockets/e2e/ws-gateway.spec.ts
@@ -14,7 +14,7 @@ async function createNestApp(...gateways): Promise<INestApplication> {
   const testingModule = await Test.createTestingModule({
     providers: gateways,
   }).compile();
-  const app = await testingModule.createNestApplication();
+  const app = testingModule.createNestApplication();
   app.useWebSocketAdapter(new WsAdapter(app) as any);
   return app;
 }
@@ -40,6 +40,7 @@ describe('WebSocketGateway (WsAdapter)', () => {
     await new Promise<void>(resolve =>
       ws.on('message', data => {
         expect(JSON.parse(data).data.test).to.be.eql('test');
+        ws.close();
         resolve();
       }),
     );
@@ -63,6 +64,7 @@ describe('WebSocketGateway (WsAdapter)', () => {
     await new Promise<void>(resolve =>
       ws.on('message', data => {
         expect(JSON.parse(data).data.test).to.be.eql('test');
+        ws.close();
         resolve();
       }),
     );
@@ -70,7 +72,7 @@ describe('WebSocketGateway (WsAdapter)', () => {
 
   it(`should handle message on a different path`, async () => {
     app = await createNestApp(WsPathGateway);
-    await app.listenAsync(3000);
+    await app.listen(3000);
     try {
       ws = new WebSocket('ws://localhost:3000/ws-path');
       await new Promise((resolve, reject) => {
@@ -89,6 +91,7 @@ describe('WebSocketGateway (WsAdapter)', () => {
       await new Promise<void>(resolve =>
         ws.on('message', data => {
           expect(JSON.parse(data).data.test).to.be.eql('test');
+          ws.close();
           resolve();
         }),
       );
@@ -101,7 +104,7 @@ describe('WebSocketGateway (WsAdapter)', () => {
     this.retries(10);
 
     app = await createNestApp(ExamplePathGateway, WsPathGateway2);
-    await app.listenAsync(3000);
+    await app.listen(3000);
 
     // open websockets delay
     await new Promise(resolve => setTimeout(resolve, 1000));
@@ -113,6 +116,7 @@ describe('WebSocketGateway (WsAdapter)', () => {
       ws.on('open', () => {
         ws.on('message', data => {
           expect(JSON.parse(data).data.test).to.be.eql('test');
+          ws.close();
           resolve();
         });
         ws.send(
@@ -129,6 +133,7 @@ describe('WebSocketGateway (WsAdapter)', () => {
     await new Promise<void>(resolve => {
       ws2.on('message', data => {
         expect(JSON.parse(data).data.test).to.be.eql('test');
+        ws2.close();
         resolve();
       });
       ws2.send(
@@ -158,6 +163,7 @@ describe('WebSocketGateway (WsAdapter)', () => {
       ws.on('open', () => {
         ws.on('message', data => {
           expect(JSON.parse(data).data.test).to.be.eql('test');
+          ws.close();
           resolve();
         });
         ws.send(
@@ -174,6 +180,7 @@ describe('WebSocketGateway (WsAdapter)', () => {
     await new Promise<void>(resolve => {
       ws2.on('message', data => {
         expect(JSON.parse(data).data.test).to.be.eql('test');
+        ws2.close();
         resolve();
       });
       ws2.send(
@@ -187,5 +194,7 @@ describe('WebSocketGateway (WsAdapter)', () => {
     });
   });
 
-  afterEach(() => app.close());
+  afterEach(async function () {
+    await app.close();
+  });
 });
diff --git a/integration/websockets/tsconfig.json b/integration/websockets/tsconfig.json
index c6354c564..cef623d14 100644
--- a/integration/websockets/tsconfig.json
+++ b/integration/websockets/tsconfig.json
@@ -7,10 +7,28 @@
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "target": "ES2021",
     "sourceMap": true,
     "allowJs": true,
-    "outDir": "./dist"
+    "outDir": "./dist",
+    "paths": {
+      "@nestjs/common": ["../../packages/common"],
+      "@nestjs/common/*": ["../../packages/common/*"],
+      "@nestjs/core": ["../../packages/core"],
+      "@nestjs/core/*": ["../../packages/core/*"],
+      "@nestjs/microservices": ["../../packages/microservices"],
+      "@nestjs/microservices/*": ["../../packages/microservices/*"],
+      "@nestjs/websockets": ["../../packages/websockets"],
+      "@nestjs/websockets/*": ["../../packages/websockets/*"],
+      "@nestjs/testing": ["../../packages/testing"],
+      "@nestjs/testing/*": ["../../packages/testing/*"],
+      "@nestjs/platform-express": ["../../packages/platform-express"],
+      "@nestjs/platform-express/*": ["../../packages/platform-express/*"],
+      "@nestjs/platform-socket.io": ["../../packages/platform-socket.io"],
+      "@nestjs/platform-socket.io/*": ["../../packages/platform-socket.io/*"],
+      "@nestjs/platform-ws": ["../../packages/platform-ws"],
+      "@nestjs/platform-ws/*": ["../../packages/platform-ws/*"]
+    }
   },
   "include": [
     "src/**/*",
diff --git a/lerna.json b/lerna.json
index 042e9d281..366cd366e 100644
--- a/lerna.json
+++ b/lerna.json
@@ -3,5 +3,5 @@
   "packages": [
     "packages/*"
   ],
-  "version": "8.2.3"
+  "version": "9.4.0"
 }
diff --git a/package-lock.json b/package-lock.json
index e3bd09a7e..b921af460 100644
Binary files a/package-lock.json and b/package-lock.json differ
diff --git a/package.json b/package.json
index 0bba506cc..5bd361702 100644
--- a/package.json
+++ b/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/core",
-  "version": "8.2.3",
+  "version": "9.4.0",
   "description": "Modern, fast, powerful node.js web framework",
   "homepage": "https://nestjs.com",
   "repository": {
@@ -14,28 +14,35 @@
   "license": "MIT",
   "author": "Kamil Mysliwiec",
   "scripts": {
-    "build": "gulp build --dist node_modules/@nestjs",
-    "postbuild": "gulp move",
-    "changelog": "lerna-changelog",
+    "build": "tsc -b -v packages",
+    "postbuild": "npm run move:node_modules",
+    "build:dev": "tsc -b -v packages --watch",
     "prebuild:prod": "npm run clean",
-    "build:prod": "gulp build",
-    "build:samples": "gulp install:samples && npm run build && gulp build:samples && gulp test:samples && gulp test:e2e:samples",
-    "clean": "gulp clean:bundle",
+    "build:prod": "tsc -b -v packages",
+    "changelog": "lerna-changelog",
+    "clean": "tsc -b --clean packages",
+    "move:samples": "gulp move:samples",
+    "move:node_modules": "gulp move:node_modules",
+    "build:samples": "gulp install:samples && npm run build && npm run move:samples && gulp build:samples && gulp test:samples && gulp test:e2e:samples",
     "codechecks:benchmarks": "codechecks ./tools/benchmarks/check-benchmarks.ts",
     "coverage": "nyc report --reporter=text-lcov | coveralls",
-    "format": "prettier \"**/*.ts\" --ignore-path ./.prettierignore --write && git status",
+    "format": "prettier \"**/*.ts\" \"packages/**/*.json\" --ignore-path ./.prettierignore --write && git status",
     "postinstall": "opencollective",
-    "test": "nyc --require ts-node/register mocha packages/**/*.spec.ts --reporter spec --require 'node_modules/reflect-metadata/Reflect.js' --exit",
-    "test:integration": "mocha \"integration/*/{,!(node_modules)/**/}/*.spec.ts\" --reporter spec --require ts-node/register --require 'node_modules/reflect-metadata/Reflect.js' --exit",
+    "test": "mocha packages/**/*.spec.ts",
+    "test:dev": "mocha -w --watch-files \"packages\" packages/**/*.spec.ts",
+    "pretest:cov": "npm run clean",
+    "test:cov": "nyc mocha packages/**/*.spec.ts --reporter spec",
+    "test:integration": "mocha \"integration/*/{,!(node_modules)/**/}/*.spec.ts\"",
     "test:docker:up": "docker-compose -f integration/docker-compose.yml up -d",
     "test:docker:down": "docker-compose -f integration/docker-compose.yml down",
     "lint": "concurrently 'npm run lint:packages' 'npm run lint:integration' 'npm run lint:spec'",
     "lint:fix": "concurrently 'npm run lint:packages -- --fix' 'npm run lint:integration -- --fix' 'npm run lint:spec -- --fix'",
-    "lint:integration": "eslint 'integration/*/{,!(node_modules)/**/}/*.ts' -c '.eslintrc.spec.js'",
+    "lint:integration": "eslint 'integration/*/{,!(node_modules)/**/}/*.ts'",
     "lint:packages": "eslint 'packages/**/**.ts' --ignore-pattern 'packages/**/*.spec.ts'",
-    "lint:spec": "eslint 'packages/**/**.spec.ts' -c '.eslintrc.spec.js'",
-    "prerelease": "gulp copy-misc && gulp build --dist node_modules/@nestjs && npm run changelog | pbcopy",
+    "lint:spec": "eslint 'packages/**/**.spec.ts'",
+    "prerelease": "gulp copy-misc",
     "publish": "npm run prerelease && npm run build:prod && ./node_modules/.bin/lerna publish --force-publish --access public --exact -m \"chore(@nestjs) publish %s release\"",
+    "prepublishOnly": "npm run changelog | pbcopy",
     "publish:beta": "npm run prerelease && npm run build:prod && ./node_modules/.bin/lerna publish --npm-tag=beta --access public -m \"chore(@nestjs) publish %s release\"",
     "publish:next": "npm run prerelease && npm run build:prod && ./node_modules/.bin/lerna publish --npm-tag=next --access public --skip-git -m \"chore(@nestjs) publish %s release\"",
     "publish:rc": "npm run prerelease && npm run build:prod && ./node_modules/.bin/lerna publish --npm-tag=rc --access public -m \"chore(@nestjs) publish %s release\"",
@@ -43,132 +50,133 @@
     "prepare": "husky install"
   },
   "lint-staged": {
-    "packages/**/*.{ts,json}": [
+    "**/*.ts": [
+      "prettier --ignore-path ./.prettierignore --write"
+    ],
+    "packages/**/*.json": [
       "prettier --ignore-path ./.prettierignore --write"
     ]
   },
   "dependencies": {
     "@nuxtjs/opencollective": "0.3.2",
-    "axios": "0.24.0",
-    "class-transformer": "0.4.0",
-    "class-validator": "0.13.2",
-    "cli-color": "2.0.1",
+    "class-transformer": "0.5.1",
+    "class-validator": "0.14.0",
+    "cli-color": "2.0.3",
     "cors": "2.8.5",
-    "express": "4.17.1",
-    "fast-json-stringify": "2.7.12",
+    "express": "4.18.2",
+    "fast-json-stringify": "5.7.0",
     "fast-safe-stringify": "2.1.1",
     "graphql-subscriptions": "2.0.0",
     "iterare": "1.2.1",
-    "object-hash": "2.2.0",
+    "object-hash": "3.0.0",
     "path-to-regexp": "3.2.0",
     "reflect-metadata": "0.1.13",
-    "rxjs": "7.4.0",
-    "socket.io": "4.4.0",
-    "tslib": "2.3.1",
-    "uuid": "8.3.2"
+    "rxjs": "7.8.0",
+    "socket.io": "4.6.1",
+    "tslib": "2.5.0",
+    "uid": "2.0.2",
+    "uuid": "9.0.0"
   },
   "devDependencies": {
+    "@apollo/server": "4.6.0",
     "@codechecks/client": "0.1.12",
-    "@commitlint/cli": "15.0.0",
-    "@commitlint/config-angular": "15.0.0",
-    "@grpc/grpc-js": "1.4.4",
-    "@grpc/proto-loader": "0.6.7",
-    "@nestjs/graphql": "9.1.2",
-    "@nestjs/mongoose": "9.0.1",
-    "@nestjs/typeorm": "8.0.2",
-    "@types/amqplib": "0.8.2",
+    "@commitlint/cli": "17.5.1",
+    "@commitlint/config-angular": "17.4.4",
+    "@fastify/cors": "^8.0.0",
+    "@fastify/formbody": "7.4.0",
+    "@fastify/middie": "8.1.0",
+    "@fastify/multipart": "7.5.0",
+    "@fastify/static": "6.10.0",
+    "@fastify/view": "7.4.1",
+    "@grpc/grpc-js": "1.8.13",
+    "@grpc/proto-loader": "0.7.6",
+    "@nestjs/apollo": "11.0.4",
+    "@nestjs/graphql": "11.0.4",
+    "@nestjs/mongoose": "9.2.2",
+    "@nestjs/typeorm": "9.0.1",
+    "@types/amqplib": "0.10.1",
     "@types/bytes": "3.1.1",
-    "@types/cache-manager": "3.4.2",
-    "@types/chai": "4.2.22",
-    "@types/chai-as-promised": "7.1.4",
-    "@types/cors": "2.8.12",
-    "@types/express": "4.17.13",
-    "@types/gulp": "4.0.9",
-    "@types/http-errors": "1.8.1",
-    "@types/mocha": "9.0.0",
-    "@types/node": "16.11.11",
-    "@types/redis": "2.8.32",
-    "@types/reflect-metadata": "0.1.0",
-    "@types/sinon": "10.0.6",
-    "@types/socket.io": "3.0.2",
-    "@types/ws": "8.2.0",
+    "@types/chai": "4.3.4",
+    "@types/chai-as-promised": "7.1.5",
+    "@types/cors": "2.8.13",
+    "@types/express": "4.17.17",
+    "@types/gulp": "4.0.10",
+    "@types/http-errors": "2.0.1",
+    "@types/mocha": "10.0.1",
+    "@types/node": "18.15.11",
+    "@types/sinon": "10.0.13",
+    "@types/supertest": "2.0.12",
+    "@types/ws": "8.5.4",
     "@typescript-eslint/eslint-plugin": "4.33.0",
     "@typescript-eslint/parser": "4.33.0",
-    "amqp-connection-manager": "3.7.0",
-    "amqplib": "0.8.0",
-    "apollo-server-core": "3.5.0",
-    "apollo-server-express": "3.5.0",
+    "amqp-connection-manager": "4.1.12",
+    "amqplib": "0.10.3",
     "artillery": "1.7.9",
-    "body-parser": "1.19.0",
-    "bytes": "3.1.1",
-    "cache-manager": "3.6.0",
-    "cache-manager-redis-store": "2.0.0",
-    "chai": "4.3.4",
+    "body-parser": "1.20.2",
+    "bytes": "3.1.2",
+    "cache-manager": "5.2.0",
+    "cache-manager-redis-store": "3.0.1",
+    "chai": "4.3.7",
     "chai-as-promised": "7.1.1",
-    "clang-format": "1.6.0",
+    "clang-format": "1.8.0",
     "commitlint-circle": "1.0.0",
-    "concurrently": "6.4.0",
-    "conventional-changelog": "3.1.24",
-    "core-js": "3.19.2",
+    "concurrently": "8.0.1",
+    "conventional-changelog": "3.1.25",
+    "core-js": "3.30.0",
     "coveralls": "3.1.1",
     "delete-empty": "3.0.0",
-    "engine.io-client": "6.1.1",
+    "engine.io-client": "6.4.0",
     "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "eventsource": "1.1.0",
-    "fancy-log": "1.3.3",
-    "fastify": "3.24.1",
-    "fastify-cors": "6.0.2",
-    "fastify-formbody": "5.2.0",
-    "fastify-multipart": "5.1.0",
-    "fastify-static": "4.5.0",
-    "graphql": "15.7.2",
-    "graphql-tools": "7.0.5",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-import": "2.27.5",
+    "eventsource": "2.0.2",
+    "fancy-log": "2.0.0",
+    "fastify": "4.15.0",
+    "graphql": "16.6.0",
+    "graphql-tools": "8.3.19",
     "gulp": "4.0.2",
     "gulp-clang-format": "1.0.27",
     "gulp-clean": "0.4.0",
     "gulp-sourcemaps": "3.0.0",
     "gulp-typescript": "5.0.1",
     "gulp-watch": "5.0.1",
-    "http-errors": "1.8.1",
-    "husky": "7.0.4",
-    "imports-loader": "3.1.1",
+    "http-errors": "2.0.0",
+    "husky": "8.0.3",
+    "imports-loader": "4.0.1",
+    "ioredis": "5.3.1",
     "json-loader": "0.5.7",
-    "kafkajs": "1.15.0",
+    "kafkajs": "2.2.4",
     "lerna": "2.11.0",
     "lerna-changelog": "2.2.0",
-    "light-my-request": "4.7.0",
-    "lint-staged": "12.1.2",
+    "light-my-request": "5.9.1",
+    "lint-staged": "13.2.0",
     "markdown-table": "2.0.0",
     "merge-graphql-schemas": "1.7.8",
-    "middie": "5.3.0",
-    "mocha": "9.1.3",
-    "mongoose": "6.0.14",
-    "mqtt": "4.2.8",
-    "multer": "1.4.3",
-    "mysql2": "2.3.3",
-    "nats": "2.4.0",
-    "nodemon": "2.0.15",
+    "mocha": "10.2.0",
+    "mongoose": "7.0.3",
+    "mqtt": "4.3.7",
+    "multer": "1.4.4",
+    "mysql2": "3.2.0",
+    "nats": "2.13.1",
+    "nodemon": "2.0.22",
     "nyc": "15.1.0",
-    "point-of-view": "4.15.3",
-    "prettier": "2.5.0",
-    "redis": "3.1.2",
+    "prettier": "2.8.7",
+    "redis": "4.6.5",
     "rxjs-compat": "6.6.7",
-    "sinon": "12.0.1",
+    "sinon": "15.0.3",
     "sinon-chai": "3.7.0",
-    "socket.io-client": "4.4.0",
+    "socket.io-client": "4.6.1",
     "subscriptions-transport-ws": "0.11.0",
-    "supertest": "6.1.6",
-    "ts-morph": "13.0.2",
-    "ts-node": "10.4.0",
-    "typeorm": "0.2.41",
-    "typescript": "4.3.5",
+    "supertest": "6.3.3",
+    "ts-morph": "18.0.0",
+    "ts-node": "10.9.1",
+    "typeorm": "0.3.12",
+    "typescript": "5.0.3",
     "wrk": "1.2.1",
-    "ws": "7.5.6"
+    "ws": "8.13.0"
   },
   "engines": {
-    "node": ">= 10.13.0"
+    "node": ">= 16"
   },
   "collective": {
     "type": "opencollective",
@@ -183,6 +191,7 @@
       "type: bug :sob:": "Bug fixes",
       "type: enhancement :wolf:": "Enhancements",
       "type: docs :page_facing_up:": "Docs",
+      "type: code style": "Code style tweaks",
       "dependencies": "Dependencies"
     }
   },
@@ -191,20 +200,23 @@
       "packages/**/*.ts"
     ],
     "exclude": [
-      "packages/**/*.spec.ts",
+      "**/*.js",
+      "**/*.d.ts",
+      "**/*.spec.ts",
       "packages/**/adapters/*.ts",
       "packages/**/nest-*.ts",
       "packages/**/test/**/*.ts",
       "packages/core/errors/**/*",
       "packages/common/exceptions/*.ts",
-      "packages/common/http/*.ts",
       "packages/common/utils/load-package.util.ts",
       "packages/microservices/exceptions/",
       "packages/microservices/microservices-module.ts",
       "packages/core/middleware/middleware-module.ts",
+      "packages/core/discovery/discovery-service.ts",
       "packages/core/injector/module-ref.ts",
       "packages/core/injector/instance-links-host.ts",
       "packages/core/helpers/context-id-factory.ts",
+      "packages/websockets/socket-module.ts",
       "packages/common/cache/**/*",
       "packages/common/serializer/**/*",
       "packages/common/services/*.ts"
@@ -221,5 +233,14 @@
     ],
     "sourceMap": true,
     "instrument": true
+  },
+  "mocha": {
+    "require": [
+      "ts-node/register",
+      "tsconfig-paths/register",
+      "node_modules/reflect-metadata/Reflect.js",
+      "hooks/mocha-init-hook.ts"
+    ],
+    "exit": true
   }
 }
diff --git a/packages/common/CHANGELOG.md b/packages/common/CHANGELOG.md
deleted file mode 100644
index 5d699e1d6..000000000
--- a/packages/common/CHANGELOG.md
+++ /dev/null
@@ -1,18 +0,0 @@
-# Change Log
-
-All notable changes to this project will be documented in this file.
-See [Conventional Commits](https://conventionalcommits.org) for commit guidelines.
-
-<a name="8.2.0"></a>
-# [8.2.0](https://github.com/nestjs/nest/compare/v8.1.2...v8.2.0) (2021-11-08)
-
-
-### Bug Fixes
-
-* **deps:** update dependency axios to v0.24.0 ([fc77e4f](https://github.com/nestjs/nest/commit/fc77e4f))
-
-
-### Features
-
-* **common:** add the ability to set some extra metadata about returned files ([5100573](https://github.com/nestjs/nest/commit/5100573))
-* **common:** allow to swap out class-validator and class-transformer ([2a1cc62](https://github.com/nestjs/nest/commit/2a1cc62))
diff --git a/packages/common/Readme.md b/packages/common/Readme.md
index f288809a9..16f48336d 100644
--- a/packages/common/Readme.md
+++ b/packages/common/Readme.md
@@ -11,7 +11,6 @@
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
 <a href="https://circleci.com/gh/nestjs/nest" target="_blank"><img src="https://img.shields.io/circleci/build/github/nestjs/nest/master" alt="CircleCI" /></a>
-<a href="https://coveralls.io/github/nestjs/nest?branch=master" target="_blank"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#9" alt="Coverage" /></a>
 <a href="https://discord.gg/G7Qnnhy" target="_blank"><img src="https://img.shields.io/badge/discord-online-brightgreen.svg" alt="Discord"/></a>
 <a href="https://opencollective.com/nest#backer" target="_blank"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
 <a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
@@ -37,8 +36,8 @@ Nest is a framework for building efficient, scalable <a href="http://nodejs.org"
 
 * To check out the [guide](https://docs.nestjs.com), visit [docs.nestjs.com](https://docs.nestjs.com). :books:
 * Ë¶ÅÊü•Áúã‰∏≠Êñá [ÊåáÂçó](readme_zh.md), ËØ∑ËÆøÈóÆ [docs.nestjs.cn](https://docs.nestjs.cn). :books:
-* [Í∞ÄÏù¥Îìú](readme_kr.md)Î•º ÌôïÏù∏ÌïòÎ†§Î©¥, [docs.nestjs.com](https://docs.nestjs.com)Î•º Î∞©Î¨∏ÌïòÏÑ∏Ïöî.:books: 
-* „ÉÅ„Çß„ÉÉ„ÇØ„Åô„Çã„Å´„ÅØ [„Ç¨„Ç§„Éâ](readme_jp.md), Ë©≥„Åó„Åè„ÅØ [docs.nestjs.com](https://docs.nestjs.com). :books: 
+* [Í∞ÄÏù¥Îìú](readme_kr.md) Î¨∏ÏÑúÎäî [docs.nestjs.com](https://docs.nestjs.com)ÏóêÏÑú ÌôïÏù∏ÌïòÏã§ Ïàò ÏûàÏäµÎãàÎã§. :books:
+* [„Ç¨„Ç§„Éâ](readme_jp.md)„ÅØ [docs.nestjs.com](https://docs.nestjs.com)„Åß„ÅîÁ¢∫Ë™ç„Åè„Å†„Åï„ÅÑ„ÄÇ :books:
 
 ## Questions
 
@@ -54,36 +53,49 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
 <table style="text-align:center;"><tr>
   <td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
+  <td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/red-hat-logo.svg" width="200" valign="middle" /></a></td>
 <td>
 <a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
 <td>
 <a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
+    <td>
+<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td><td>
+<a href="https://amplication.com/" target="_blank"><img src="https://nestjs.com/img/amplication-logo.svg" width="190" valign="middle" /></a></td>
 </tr></table>
 
 #### Gold Sponsors
 
 <table style="text-align:center;"><tr><td>
-  <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
-  <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
+<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="140" valign="middle" /></a></td>
 <td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
+<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td>
+ <td>
+<a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
+<a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td><td>
+<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td>
+<td>
+<a href="https://ridicorp.com/career/" target="_blank"><img src="https://nestjs.com/img/ridi-logo.svg" width="105" valign="middle" /></a></td><td>
+<a href="https://www.movavi.com/imovie-for-windows.html" target="_blank"><img src="https://nestjs.com/img/movavi-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
 <table style="text-align:center;"><tr><td>
 <a href="https://neoteric.eu/" target="_blank"><img src="https://nestjs.com/img/neoteric-cut.png" width="120" valign="middle" /></a> </td><td>
   <a href="http://gojob.com" target="_blank"><img src="http://nestjs.com/img/gojob-logo.png" valign="middle" width="100" /></a> </td><td>
-<a href="http://www.leogistics.com" target="_blank"><img src="https://nestjs.com/img/leogistics-logo.jpeg" width="150" valign="middle" /></td><td>
+<a href="https://www.myleodsc.com/" target="_blank"><img src="https://nestjs.com/img/myleo-logo.png" width="180" valign="middle" /></td><td>
 <a href="https://careers.meetdandy.com/?gh_src=063ba61e3us" target="_blank"><img src="https://nestjs.com/img/dandy-roles-logo.svg" width="150" valign="middle" /></td><td>
 <a href="https://www.castlecraft.in" target="_blank"><img src="https://nestjs.com/img/castlecraft-logo.png" width="150" valign="middle" /></td>
-<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td></tr></table>
+<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td>
+<td><a href="https://n.inc" target="_blank"><img src="https://nestjs.com/img/n-inc-logo.svg" width="120" valign="middle" /></td></tr><tr>
+<td><a href="https://bilberrry.com/" target="_blank"><img src="https://nestjs.com/img/bilberrry-logo.svg" width="180" valign="middle" /></td>
+<td><a href="https://ipinfo.ai/" target="_blank"><img src="https://nestjs.com/img/ipinfo-logo.png" width="130" valign="middle" /></td>
+<td><a href="https://chax.at" target="_blank"><img src="https://nestjs.com/img/chaxat-logo.png" width="100" valign="middle" /></td></tr>
+</table>
 
 #### Sponsors
 
@@ -91,7 +103,7 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <a href="https://www.swingdev.io" target="_blank"><img src="https://nestjs.com/img/swingdev-logo.svg#1" width="110" valign="middle" /> </a></td><td align="center" valign="middle">
 <a href="https://www.novologic.com/" target="_blank"><img src="https://nestjs.com/img/novologic.png" width="110" valign="middle" /></a> </td><td align="center" valign="middle">
 <a href="https://ever.co/" target="_blank"><img src="https://nestjs.com/img/ever-logo.png" width="72" valign="middle" /></a>  </td><td align="center" valign="middle">
-<a href="https://blokt.com" target="_blank"><img src="https://nestjs.com/img/blokt-logo.png" width="120" valign="middle" /></a>  </td><td align="center" valign="middle"> 
+<a href="https://blokt.com" target="_blank"><img src="https://nestjs.com/img/blokt-logo.png" width="120" valign="middle" /></a>  </td><td align="center" valign="middle">
   <a href="http://architectnow.net/" target="_blank"><img src="https://nestjs.com/img/architectnow.png" width="125" valign="middle" /></a> </td><td align="center" valign="middle">
   <a href="https://quander.io/" target="_blank"><img src="https://nestjs.com/img/quander.png" width="100" valign="middle" /></a> </td></tr><tr><td align="center" valign="middle">
   <a href="https://mantro.net/" target="_blank"><img src="https://nestjs.com/img/mantro-logo.svg" width="95" valign="middle" /></a> </td><td align="center" valign="middle">
@@ -117,6 +129,14 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/naologic-logo.svg" width="125" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://messaged.com/" target="_blank"><img src="https://nestjs.com/img/messaged-logo.png" width="50" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/triplecore-logo.svg" width="50" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://klqc.de" target="_blank"><img src="https://nestjs.com/img/klcqcl-logo.png" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://thecasinowizard.com/bonuses/no-deposit-bonuses/" target="_blank"><img src="https://nestjs.com/img/casinowizard-logo.png" width="120" valign="middle" /></a></td></tr><tr>
+     <td align="center" valign="middle"><a href="https://polygon-software.ch/" target="_blank"><img src="https://nestjs.com/img/polygon-logo.svg" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://mobilereality.pl/" target="_blank"><img src="https://nestjs.com/img/mobile-reality-logo.png" width="45" valign="middle" /></a></td>
+     <td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/boringowl-logo.svg" width="120" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://www.mobilefactory.jp/" target="_blank"><img src="https://nestjs.com/img/mobilefactory-logo.png" width="100" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://nordbot.app/" target="_blank"><img src="https://nestjs.com/img/nordbot-logo.png" width="120" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://doppio.sh/" target="_blank"><img src="https://nestjs.com/img/dopiosh-logo.png" width="50" valign="middle" /></a></td>
   </tr></table>
 
 ## Backers
diff --git a/packages/common/cache/cache.constants.ts b/packages/common/cache/cache.constants.ts
deleted file mode 100644
index 0ecf5c94e..000000000
--- a/packages/common/cache/cache.constants.ts
+++ /dev/null
@@ -1,4 +0,0 @@
-export const CACHE_MANAGER = 'CACHE_MANAGER';
-export const CACHE_MODULE_OPTIONS = 'CACHE_MODULE_OPTIONS';
-export const CACHE_KEY_METADATA = 'cache_module:cache_key';
-export const CACHE_TTL_METADATA = 'cache_module:cache_ttl';
diff --git a/packages/common/cache/cache.module.ts b/packages/common/cache/cache.module.ts
deleted file mode 100644
index 4e2c63d48..000000000
--- a/packages/common/cache/cache.module.ts
+++ /dev/null
@@ -1,94 +0,0 @@
-import { Module } from '../decorators';
-import { DynamicModule, Provider } from '../interfaces';
-import { CACHE_MANAGER, CACHE_MODULE_OPTIONS } from './cache.constants';
-import { createCacheManager } from './cache.providers';
-import {
-  CacheModuleAsyncOptions,
-  CacheModuleOptions,
-  CacheOptionsFactory,
-} from './interfaces/cache-module.interface';
-
-/**
- * Module that provides Nest cache-manager.
- *
- * @see [Caching](https://docs.nestjs.com/techniques/caching)
- *
- * @publicApi
- */
-@Module({
-  providers: [createCacheManager()],
-  exports: [CACHE_MANAGER],
-})
-export class CacheModule {
-  /**
-   * Configure the cache manager statically.
-   *
-   * @param options options to configure the cache manager
-   *
-   * @see [Customize caching](https://docs.nestjs.com/techniques/caching#customize-caching)
-   */
-  static register<StoreConfig extends Record<any, any> = Record<string, any>>(
-    options: CacheModuleOptions<StoreConfig> = {} as any,
-  ): DynamicModule {
-    return {
-      module: CacheModule,
-      global: options.isGlobal,
-      providers: [{ provide: CACHE_MODULE_OPTIONS, useValue: options }],
-    };
-  }
-
-  /**
-   * Configure the cache manager dynamically.
-   *
-   * @param options method for dynamically supplying cache manager configuration
-   * options
-   *
-   * @see [Async configuration](https://docs.nestjs.com/techniques/caching#async-configuration)
-   */
-  static registerAsync<
-    StoreConfig extends Record<any, any> = Record<string, any>,
-  >(options: CacheModuleAsyncOptions<StoreConfig>): DynamicModule {
-    return {
-      module: CacheModule,
-      global: options.isGlobal,
-      imports: options.imports,
-      providers: [
-        ...this.createAsyncProviders<StoreConfig>(options),
-        ...(options.extraProviders || []),
-      ],
-    };
-  }
-
-  private static createAsyncProviders<StoreConfig extends Record<any, any>>(
-    options: CacheModuleAsyncOptions<StoreConfig>,
-  ): Provider[] {
-    if (options.useExisting || options.useFactory) {
-      return [this.createAsyncOptionsProvider(options)];
-    }
-    return [
-      this.createAsyncOptionsProvider(options),
-      {
-        provide: options.useClass,
-        useClass: options.useClass,
-      },
-    ];
-  }
-
-  private static createAsyncOptionsProvider<
-    StoreConfig extends Record<any, any>,
-  >(options: CacheModuleAsyncOptions<StoreConfig>): Provider {
-    if (options.useFactory) {
-      return {
-        provide: CACHE_MODULE_OPTIONS,
-        useFactory: options.useFactory,
-        inject: options.inject || [],
-      };
-    }
-    return {
-      provide: CACHE_MODULE_OPTIONS,
-      useFactory: async (optionsFactory: CacheOptionsFactory<StoreConfig>) =>
-        optionsFactory.createCacheOptions(),
-      inject: [options.useExisting || options.useClass],
-    };
-  }
-}
diff --git a/packages/common/cache/cache.providers.ts b/packages/common/cache/cache.providers.ts
deleted file mode 100644
index 2e6df398d..000000000
--- a/packages/common/cache/cache.providers.ts
+++ /dev/null
@@ -1,36 +0,0 @@
-import { Provider } from '../interfaces';
-import { loadPackage } from '../utils/load-package.util';
-import { CACHE_MANAGER, CACHE_MODULE_OPTIONS } from './cache.constants';
-import { defaultCacheOptions } from './default-options';
-import { CacheManagerOptions } from './interfaces/cache-manager.interface';
-
-/**
- * Creates a CacheManager Provider.
- *
- * @publicApi
- */
-export function createCacheManager(): Provider {
-  return {
-    provide: CACHE_MANAGER,
-    useFactory: (options: CacheManagerOptions) => {
-      const cacheManager = loadPackage('cache-manager', 'CacheModule', () =>
-        require('cache-manager'),
-      );
-
-      return Array.isArray(options)
-        ? cacheManager.multiCaching(
-            options.map(store =>
-              cacheManager.caching({
-                ...defaultCacheOptions,
-                ...(store || {}),
-              }),
-            ),
-          )
-        : cacheManager.caching({
-            ...defaultCacheOptions,
-            ...(options || {}),
-          });
-    },
-    inject: [CACHE_MODULE_OPTIONS],
-  };
-}
diff --git a/packages/common/cache/decorators/cache-key.decorator.ts b/packages/common/cache/decorators/cache-key.decorator.ts
deleted file mode 100644
index b9aa7f3c1..000000000
--- a/packages/common/cache/decorators/cache-key.decorator.ts
+++ /dev/null
@@ -1,17 +0,0 @@
-import { SetMetadata } from '../../decorators';
-import { CACHE_KEY_METADATA } from '../cache.constants';
-
-/**
- * Decorator that sets the caching key used to store/retrieve cached items for
- * Web sockets or Microservice based apps.
- *
- * For example:
- * `@CacheKey('events')`
- *
- * @param key string naming the field to be used as a cache key
- *
- * @see [Caching](https://docs.nestjs.com/techniques/caching)
- *
- * @publicApi
- */
-export const CacheKey = (key: string) => SetMetadata(CACHE_KEY_METADATA, key);
diff --git a/packages/common/cache/decorators/cache-ttl.decorator.ts b/packages/common/cache/decorators/cache-ttl.decorator.ts
deleted file mode 100644
index e6b48ae93..000000000
--- a/packages/common/cache/decorators/cache-ttl.decorator.ts
+++ /dev/null
@@ -1,18 +0,0 @@
-import { SetMetadata } from '../../decorators';
-import { ExecutionContext } from '../../interfaces/features/execution-context.interface';
-import { CACHE_TTL_METADATA } from '../cache.constants';
-
-/**
- * Decorator that sets the cache ttl setting the duration for cache expiration.
- *
- * For example: `@CacheTTL(5)`
- *
- * @param ttl number set the cache expiration time
- *
- * @see [Caching](https://docs.nestjs.com/techniques/caching)
- *
- * @publicApi
- */
-type CacheTTLFactory = (ctx: ExecutionContext) => Promise<number> | number;
-export const CacheTTL = (ttl: number | CacheTTLFactory) =>
-  SetMetadata(CACHE_TTL_METADATA, ttl);
diff --git a/packages/common/cache/decorators/index.ts b/packages/common/cache/decorators/index.ts
deleted file mode 100644
index 9d60a27f5..000000000
--- a/packages/common/cache/decorators/index.ts
+++ /dev/null
@@ -1,2 +0,0 @@
-export * from './cache-key.decorator';
-export * from './cache-ttl.decorator';
diff --git a/packages/common/cache/default-options.ts b/packages/common/cache/default-options.ts
deleted file mode 100644
index cdd262e2d..000000000
--- a/packages/common/cache/default-options.ts
+++ /dev/null
@@ -1,5 +0,0 @@
-export const defaultCacheOptions = {
-  ttl: 5,
-  max: 100,
-  store: 'memory',
-};
diff --git a/packages/common/cache/index.ts b/packages/common/cache/index.ts
deleted file mode 100644
index 1a5dfc371..000000000
--- a/packages/common/cache/index.ts
+++ /dev/null
@@ -1,5 +0,0 @@
-export * from './cache.constants';
-export * from './cache.module';
-export * from './decorators';
-export * from './interceptors';
-export * from './interfaces';
diff --git a/packages/common/cache/interceptors/cache.interceptor.ts b/packages/common/cache/interceptors/cache.interceptor.ts
deleted file mode 100644
index 7a27c9d73..000000000
--- a/packages/common/cache/interceptors/cache.interceptor.ts
+++ /dev/null
@@ -1,89 +0,0 @@
-import { Observable, of } from 'rxjs';
-import { tap } from 'rxjs/operators';
-import { Inject, Injectable, Optional } from '../../decorators';
-import {
-  CallHandler,
-  ExecutionContext,
-  HttpServer,
-  NestInterceptor,
-} from '../../interfaces';
-import { isFunction, isNil } from '../../utils/shared.utils';
-import {
-  CACHE_KEY_METADATA,
-  CACHE_MANAGER,
-  CACHE_TTL_METADATA,
-} from '../cache.constants';
-
-const HTTP_ADAPTER_HOST = 'HttpAdapterHost';
-const REFLECTOR = 'Reflector';
-
-export interface HttpAdapterHost<T extends HttpServer = any> {
-  httpAdapter: T;
-}
-
-@Injectable()
-export class CacheInterceptor implements NestInterceptor {
-  @Optional()
-  @Inject(HTTP_ADAPTER_HOST)
-  protected readonly httpAdapterHost: HttpAdapterHost;
-
-  protected allowedMethods = ['GET'];
-  constructor(
-    @Inject(CACHE_MANAGER) protected readonly cacheManager: any,
-    @Inject(REFLECTOR) protected readonly reflector: any,
-  ) {}
-
-  async intercept(
-    context: ExecutionContext,
-    next: CallHandler,
-  ): Promise<Observable<any>> {
-    const key = this.trackBy(context);
-    const ttlValueOrFactory =
-      this.reflector.get(CACHE_TTL_METADATA, context.getHandler()) ?? null;
-
-    if (!key) {
-      return next.handle();
-    }
-    try {
-      const value = await this.cacheManager.get(key);
-      if (!isNil(value)) {
-        return of(value);
-      }
-      const ttl = isFunction(ttlValueOrFactory)
-        ? await ttlValueOrFactory(context)
-        : ttlValueOrFactory;
-      return next.handle().pipe(
-        tap(response => {
-          const args = isNil(ttl) ? [key, response] : [key, response, { ttl }];
-          this.cacheManager.set(...args);
-        }),
-      );
-    } catch {
-      return next.handle();
-    }
-  }
-
-  protected trackBy(context: ExecutionContext): string | undefined {
-    const httpAdapter = this.httpAdapterHost.httpAdapter;
-    const isHttpApp = httpAdapter && !!httpAdapter.getRequestMethod;
-    const cacheMetadata = this.reflector.get(
-      CACHE_KEY_METADATA,
-      context.getHandler(),
-    );
-
-    if (!isHttpApp || cacheMetadata) {
-      return cacheMetadata;
-    }
-
-    const request = context.getArgByIndex(0);
-    if (!this.isRequestCacheable(context)) {
-      return undefined;
-    }
-    return httpAdapter.getRequestUrl(request);
-  }
-
-  protected isRequestCacheable(context: ExecutionContext): boolean {
-    const req = context.switchToHttp().getRequest();
-    return this.allowedMethods.includes(req.method);
-  }
-}
diff --git a/packages/common/cache/interceptors/index.ts b/packages/common/cache/interceptors/index.ts
deleted file mode 100644
index 474887b1f..000000000
--- a/packages/common/cache/interceptors/index.ts
+++ /dev/null
@@ -1 +0,0 @@
-export * from './cache.interceptor';
diff --git a/packages/common/cache/interfaces/cache-manager.interface.ts b/packages/common/cache/interfaces/cache-manager.interface.ts
deleted file mode 100644
index 13e34127d..000000000
--- a/packages/common/cache/interfaces/cache-manager.interface.ts
+++ /dev/null
@@ -1,83 +0,0 @@
-export interface LiteralObject {
-  [key: string]: any;
-}
-
-/**
- * Interface defining a cache store. Implement this interface to create a custom
- * cache store.
- *
- * @publicApi
- */
-export interface CacheStore {
-  /**
-   * Create a key/value pair in the cache.
-   *
-   * @param key cache key
-   * @param value cache value
-   */
-  set<T>(
-    key: string,
-    value: T,
-    options?: CacheStoreSetOptions<T>,
-  ): Promise<void> | void;
-  /**
-   * Retrieve a key/value pair from the cache.
-   *
-   * @param key cache key
-   */
-  get<T>(key: string): Promise<T | undefined> | T | undefined;
-  /**
-   * Destroy a key/value pair from the cache.
-   *
-   * @param key cache key
-   */
-  del?(key: string): void | Promise<void>;
-}
-
-export interface CacheStoreSetOptions<T> {
-  /**
-   * Time to live - amount of time in seconds that a response is cached before it
-   * is deleted. Defaults based on your cache manager settings.
-   */
-  ttl?: ((value: T) => number) | number;
-}
-
-/**
- * Interface defining a factory to create a cache store.
- *
- * @publicApi
- */
-export interface CacheStoreFactory {
-  /**
-   * Return a configured cache store.
-   *
-   * @param args Cache manager options received from `CacheModule.register()`
-   * or `CacheModule.registerAsync()`
-   */
-  create(args: LiteralObject): CacheStore;
-}
-
-/**
- * Interface defining Cache Manager configuration options.
- *
- * @publicApi
- */
-export interface CacheManagerOptions {
-  /**
-   * Cache storage manager.  Default is `'memory'` (in-memory store).  See
-   * [Different stores](https://docs.nestjs.com/techniques/caching#different-stores)
-   * for more info.
-   */
-  store?: string | CacheStoreFactory | CacheStore;
-  /**
-   * Time to live - amount of time in seconds that a response is cached before it
-   * is deleted. Subsequent request will call through the route handler and refresh
-   * the cache.  Defaults to 5 seconds.
-   */
-  ttl?: number;
-  /**
-   * Maximum number of responses to store in the cache.  Defaults to 100.
-   */
-  max?: number;
-  isCacheableValue?: (value: any) => boolean;
-}
diff --git a/packages/common/cache/interfaces/cache-module.interface.ts b/packages/common/cache/interfaces/cache-module.interface.ts
deleted file mode 100644
index 5beb769c8..000000000
--- a/packages/common/cache/interfaces/cache-module.interface.ts
+++ /dev/null
@@ -1,71 +0,0 @@
-import { ModuleMetadata, Provider, Type } from '../../interfaces';
-import { CacheManagerOptions } from './cache-manager.interface';
-
-export type CacheModuleOptions<
-  StoreConfig extends Record<any, any> = Record<string, any>,
-> =
-  // Store-specfic configuration takes precedence over cache module options due
-  // to how `createCacheManager` is implemented.
-  CacheManagerOptions &
-    StoreConfig & {
-      /**
-       * If "true', register `CacheModule` as a global module.
-       */
-      isGlobal?: boolean;
-    };
-
-/**
- * Interface describing a `CacheOptionsFactory`.  Providers supplying configuration
- * options for the Cache module must implement this interface.
- *
- * @see [Async configuration](https://docs.nestjs.com/techniques/caching#async-configuration)
- *
- * @publicApi
- */
-export interface CacheOptionsFactory<
-  StoreConfig extends Record<any, any> = Record<string, any>,
-> {
-  createCacheOptions():
-    | Promise<CacheModuleOptions<StoreConfig>>
-    | CacheModuleOptions<StoreConfig>;
-}
-
-/**
- * Options for dynamically configuring the Cache module.
- *
- * @see [Async configuration](https://docs.nestjs.com/techniques/caching#async-configuration)
- *
- * @publicApi
- */
-export interface CacheModuleAsyncOptions<
-  StoreConfig extends Record<any, any> = Record<string, any>,
-> extends Pick<ModuleMetadata, 'imports'> {
-  /**
-   * Injection token resolving to an existing provider. The provider must implement
-   * the `CacheOptionsFactory` interface.
-   */
-  useExisting?: Type<CacheOptionsFactory<StoreConfig>>;
-  /**
-   * Injection token resolving to a class that will be instantiated as a provider.
-   * The class must implement the `CacheOptionsFactory` interface.
-   */
-  useClass?: Type<CacheOptionsFactory<StoreConfig>>;
-  /**
-   * Function returning options (or a Promise resolving to options) to configure the
-   * cache module.
-   */
-  useFactory?: (
-    ...args: any[]
-  ) =>
-    | Promise<CacheModuleOptions<StoreConfig>>
-    | CacheModuleOptions<StoreConfig>;
-  /**
-   * Dependencies that a Factory may inject.
-   */
-  inject?: any[];
-  extraProviders?: Provider[];
-  /**
-   * If "true', register `CacheModule` as a global module.
-   */
-  isGlobal?: boolean;
-}
diff --git a/packages/common/cache/interfaces/index.ts b/packages/common/cache/interfaces/index.ts
deleted file mode 100644
index 54aa4c3cb..000000000
--- a/packages/common/cache/interfaces/index.ts
+++ /dev/null
@@ -1,2 +0,0 @@
-export * from './cache-manager.interface';
-export * from './cache-module.interface';
diff --git a/packages/common/constants.ts b/packages/common/constants.ts
index d6ded9f97..71f27685d 100644
--- a/packages/common/constants.ts
+++ b/packages/common/constants.ts
@@ -4,6 +4,7 @@ export const MODULE_METADATA = {
   CONTROLLERS: 'controllers',
   EXPORTS: 'exports',
 };
+
 export const GLOBAL_MODULE_METADATA = '__module:global__';
 export const HOST_METADATA = 'host';
 export const PATH_METADATA = 'path';
@@ -15,13 +16,24 @@ export const OPTIONAL_PROPERTY_DEPS_METADATA = 'optional:properties_metadata';
 export const SCOPE_OPTIONS_METADATA = 'scope:options';
 export const METHOD_METADATA = 'method';
 export const ROUTE_ARGS_METADATA = '__routeArguments__';
-export const CUSTOM_ROUTE_AGRS_METADATA = '__customRouteArgs__';
-export const EXCEPTION_FILTERS_METADATA = '__exceptionFilters__';
+export const CUSTOM_ROUTE_ARGS_METADATA = '__customRouteArgs__';
 export const FILTER_CATCH_EXCEPTIONS = '__filterCatchExceptions__';
+
 export const PIPES_METADATA = '__pipes__';
 export const GUARDS_METADATA = '__guards__';
-export const RENDER_METADATA = '__renderTemplate__';
 export const INTERCEPTORS_METADATA = '__interceptors__';
+export const EXCEPTION_FILTERS_METADATA = '__exceptionFilters__';
+export const ENHANCER_KEY_TO_SUBTYPE_MAP = {
+  [GUARDS_METADATA]: 'guard',
+  [INTERCEPTORS_METADATA]: 'interceptor',
+  [PIPES_METADATA]: 'pipe',
+  [EXCEPTION_FILTERS_METADATA]: 'filter',
+} as const;
+
+export type EnhancerSubtype =
+  (typeof ENHANCER_KEY_TO_SUBTYPE_MAP)[keyof typeof ENHANCER_KEY_TO_SUBTYPE_MAP];
+
+export const RENDER_METADATA = '__renderTemplate__';
 export const HTTP_CODE_METADATA = '__httpCode__';
 export const MODULE_PATH = '__module_path__';
 export const HEADERS_METADATA = '__headers__';
@@ -29,3 +41,7 @@ export const REDIRECT_METADATA = '__redirect__';
 export const RESPONSE_PASSTHROUGH_METADATA = '__responsePassthrough__';
 export const SSE_METADATA = '__sse__';
 export const VERSION_METADATA = '__version__';
+export const INJECTABLE_WATERMARK = '__injectable__';
+export const CONTROLLER_WATERMARK = '__controller__';
+export const CATCH_WATERMARK = '__catch__';
+export const ENTRY_PROVIDER_WATERMARK = '__entryProvider__';
diff --git a/packages/common/decorators/core/catch.decorator.ts b/packages/common/decorators/core/catch.decorator.ts
index d211a6d82..cd3cdb161 100644
--- a/packages/common/decorators/core/catch.decorator.ts
+++ b/packages/common/decorators/core/catch.decorator.ts
@@ -1,5 +1,5 @@
-import { FILTER_CATCH_EXCEPTIONS } from '../../constants';
-import { Type } from '../../interfaces';
+import { CATCH_WATERMARK, FILTER_CATCH_EXCEPTIONS } from '../../constants';
+import { Type, Abstract } from '../../interfaces';
 
 /**
  * Decorator that marks a class as a Nest exception filter. An exception filter
@@ -18,8 +18,11 @@ import { Type } from '../../interfaces';
  *
  * @publicApi
  */
-export function Catch(...exceptions: Type<any>[]): ClassDecorator {
+export function Catch(
+  ...exceptions: Array<Type<any> | Abstract<any>>
+): ClassDecorator {
   return (target: object) => {
+    Reflect.defineMetadata(CATCH_WATERMARK, true, target);
     Reflect.defineMetadata(FILTER_CATCH_EXCEPTIONS, exceptions, target);
   };
 }
diff --git a/packages/common/decorators/core/controller.decorator.ts b/packages/common/decorators/core/controller.decorator.ts
index 9f17a9fb5..531ae5151 100644
--- a/packages/common/decorators/core/controller.decorator.ts
+++ b/packages/common/decorators/core/controller.decorator.ts
@@ -1,11 +1,11 @@
 import {
+  CONTROLLER_WATERMARK,
   HOST_METADATA,
   PATH_METADATA,
   SCOPE_OPTIONS_METADATA,
   VERSION_METADATA,
 } from '../../constants';
-import { ScopeOptions } from '../../interfaces/scope-options.interface';
-import { VersionOptions } from '../../interfaces/version-options.interface';
+import { ScopeOptions, VersionOptions } from '../../interfaces';
 import { isString, isUndefined } from '../../utils/shared.utils';
 
 /**
@@ -69,7 +69,7 @@ export function Controller(): ClassDecorator;
  * It defines a class that provides a context for one or more message or event
  * handlers.
  *
- * @param {string, Array} prefix string that defines a `route path prefix`.  The prefix
+ * @param {string|Array} prefix string that defines a `route path prefix`.  The prefix
  * is pre-pended to the path specified in any request decorator in the class.
  *
  * @see [Routing](https://docs.nestjs.com/controllers#routing)
@@ -162,11 +162,14 @@ export function Controller(
     : [
         prefixOrOptions.path || defaultPath,
         prefixOrOptions.host,
-        { scope: prefixOrOptions.scope },
-        prefixOrOptions.version,
+        { scope: prefixOrOptions.scope, durable: prefixOrOptions.durable },
+        Array.isArray(prefixOrOptions.version)
+          ? Array.from(new Set(prefixOrOptions.version))
+          : prefixOrOptions.version,
       ];
 
   return (target: object) => {
+    Reflect.defineMetadata(CONTROLLER_WATERMARK, true, target);
     Reflect.defineMetadata(PATH_METADATA, path, target);
     Reflect.defineMetadata(HOST_METADATA, host, target);
     Reflect.defineMetadata(SCOPE_OPTIONS_METADATA, scopeOptions, target);
diff --git a/packages/common/decorators/core/dependencies.decorator.ts b/packages/common/decorators/core/dependencies.decorator.ts
index 984269524..b9657efa0 100644
--- a/packages/common/decorators/core/dependencies.decorator.ts
+++ b/packages/common/decorators/core/dependencies.decorator.ts
@@ -9,6 +9,8 @@ export function flatten<T extends Array<unknown> = any>(
 
 /**
  * Decorator that sets required dependencies (required with a vanilla JavaScript objects)
+ *
+ * @publicApi
  */
 export const Dependencies = (
   ...dependencies: Array<unknown>
diff --git a/packages/common/decorators/core/inject.decorator.ts b/packages/common/decorators/core/inject.decorator.ts
index 471c77c08..e8f559124 100644
--- a/packages/common/decorators/core/inject.decorator.ts
+++ b/packages/common/decorators/core/inject.decorator.ts
@@ -33,8 +33,10 @@ import { isUndefined } from '../../utils/shared.utils';
  *
  * @publicApi
  */
-export function Inject<T = any>(token?: T) {
-  return (target: object, key: string | symbol, index?: number) => {
+export function Inject<T = any>(
+  token?: T,
+): PropertyDecorator & ParameterDecorator {
+  return (target: object, key: string | symbol | undefined, index?: number) => {
     const type = token || Reflect.getMetadata('design:type', target, key);
 
     if (!isUndefined(index)) {
diff --git a/packages/common/decorators/core/injectable.decorator.ts b/packages/common/decorators/core/injectable.decorator.ts
index 91910dfc5..ff7ae143c 100644
--- a/packages/common/decorators/core/injectable.decorator.ts
+++ b/packages/common/decorators/core/injectable.decorator.ts
@@ -1,5 +1,5 @@
-import { v4 as uuid } from 'uuid';
-import { SCOPE_OPTIONS_METADATA } from '../../constants';
+import { uid } from 'uid';
+import { INJECTABLE_WATERMARK, SCOPE_OPTIONS_METADATA } from '../../constants';
 import { ScopeOptions } from '../../interfaces/scope-options.interface';
 import { Type } from '../../interfaces/type.interface';
 
@@ -42,13 +42,17 @@ export type InjectableOptions = ScopeOptions;
  */
 export function Injectable(options?: InjectableOptions): ClassDecorator {
   return (target: object) => {
+    Reflect.defineMetadata(INJECTABLE_WATERMARK, true, target);
     Reflect.defineMetadata(SCOPE_OPTIONS_METADATA, options, target);
   };
 }
 
+/**
+ * @publicApi
+ */
 export function mixin<T>(mixinClass: Type<T>) {
   Object.defineProperty(mixinClass, 'name', {
-    value: uuid(),
+    value: uid(21),
   });
   Injectable()(mixinClass);
   return mixinClass;
diff --git a/packages/common/decorators/core/optional.decorator.ts b/packages/common/decorators/core/optional.decorator.ts
index 49d80eec1..0d94c20f0 100644
--- a/packages/common/decorators/core/optional.decorator.ts
+++ b/packages/common/decorators/core/optional.decorator.ts
@@ -17,8 +17,8 @@ import { isUndefined } from '../../utils/shared.utils';
  *
  * @publicApi
  */
-export function Optional() {
-  return (target: object, key: string | symbol, index?: number) => {
+export function Optional(): PropertyDecorator & ParameterDecorator {
+  return (target: object, key: string | symbol | undefined, index?: number) => {
     if (!isUndefined(index)) {
       const args = Reflect.getMetadata(OPTIONAL_DEPS_METADATA, target) || [];
       Reflect.defineMetadata(OPTIONAL_DEPS_METADATA, [...args, index], target);
diff --git a/packages/common/decorators/core/version.decorator.ts b/packages/common/decorators/core/version.decorator.ts
index d82d079e2..9ab8fc887 100644
--- a/packages/common/decorators/core/version.decorator.ts
+++ b/packages/common/decorators/core/version.decorator.ts
@@ -7,6 +7,11 @@ import { VersionValue } from '../../interfaces/version-options.interface';
  * @publicApi
  */
 export function Version(version: VersionValue): MethodDecorator {
+  if (Array.isArray(version)) {
+    // Drop duplicated versions
+    version = Array.from(new Set(version));
+  }
+
   return (
     target: any,
     key: string | symbol,
diff --git a/packages/common/decorators/http/create-route-param-metadata.decorator.ts b/packages/common/decorators/http/create-route-param-metadata.decorator.ts
index f8582bf57..d070e47a7 100644
--- a/packages/common/decorators/http/create-route-param-metadata.decorator.ts
+++ b/packages/common/decorators/http/create-route-param-metadata.decorator.ts
@@ -1,4 +1,4 @@
-import { v4 as uuid } from 'uuid';
+import { uid } from 'uid';
 import { ROUTE_ARGS_METADATA } from '../../constants';
 import { PipeTransform } from '../../index';
 import { Type } from '../../interfaces';
@@ -12,6 +12,8 @@ export type ParamDecoratorEnhancer = ParameterDecorator;
  * Defines HTTP route param decorator
  *
  * @param factory
+ *
+ * @publicApi
  */
 export function createParamDecorator<
   FactoryData = any,
@@ -23,7 +25,7 @@ export function createParamDecorator<
 ): (
   ...dataOrPipes: (Type<PipeTransform> | PipeTransform | FactoryData)[]
 ) => ParameterDecorator {
-  const paramtype = uuid();
+  const paramtype = uid(21);
   return (
       data?,
       ...pipes: (Type<PipeTransform> | PipeTransform | FactoryData)[]
diff --git a/packages/common/decorators/http/render.decorator.ts b/packages/common/decorators/http/render.decorator.ts
index 6e9f22a1c..92d2f8d20 100644
--- a/packages/common/decorators/http/render.decorator.ts
+++ b/packages/common/decorators/http/render.decorator.ts
@@ -7,7 +7,7 @@ import { RENDER_METADATA } from '../../constants';
  *
  * @param template name of the render engine template file
  *
- * @see [Model-View-Controller](https://docs.nestjs.com/techniques.mvc)
+ * @see [Model-View-Controller](https://docs.nestjs.com/techniques/mvc)
  *
  * @publicApi
  */
diff --git a/packages/common/decorators/http/request-mapping.decorator.ts b/packages/common/decorators/http/request-mapping.decorator.ts
index 46ebc0d8f..62d61cde4 100644
--- a/packages/common/decorators/http/request-mapping.decorator.ts
+++ b/packages/common/decorators/http/request-mapping.decorator.ts
@@ -109,3 +109,12 @@ export const Head = createMappingDecorator(RequestMethod.HEAD);
  * @publicApi
  */
 export const All = createMappingDecorator(RequestMethod.ALL);
+
+/**
+ * Route handler (method) Decorator. Routes all HTTP requests to the specified path.
+ *
+ * @see [Routing](https://docs.nestjs.com/controllers#routing)
+ *
+ * @publicApi
+ */
+export const Search = createMappingDecorator(RequestMethod.SEARCH);
diff --git a/packages/common/decorators/modules/module.decorator.ts b/packages/common/decorators/modules/module.decorator.ts
index c5df824d9..b0547b6d3 100644
--- a/packages/common/decorators/modules/module.decorator.ts
+++ b/packages/common/decorators/modules/module.decorator.ts
@@ -5,7 +5,7 @@ import { validateModuleKeys } from '../../utils/validate-module-keys.util';
  * Decorator that marks a class as a [module](https://docs.nestjs.com/modules).
  *
  * Modules are used by Nest to organize the application structure into scopes. Controllers
- * and Providers are scoped by the module they are declared in.  Modules and their
+ * and Providers are scoped by the module they are declared in. Modules and their
  * classes (Controllers and Providers) form a graph that determines how Nest
  * performs [Dependency Injection (DI)](https://docs.nestjs.com/providers#dependency-injection).
  *
diff --git a/packages/common/enums/http-status.enum.ts b/packages/common/enums/http-status.enum.ts
index 875597540..326001344 100644
--- a/packages/common/enums/http-status.enum.ts
+++ b/packages/common/enums/http-status.enum.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export enum HttpStatus {
   CONTINUE = 100,
   SWITCHING_PROTOCOLS = 101,
diff --git a/packages/common/enums/request-method.enum.ts b/packages/common/enums/request-method.enum.ts
index d48f52b4d..e28455633 100644
--- a/packages/common/enums/request-method.enum.ts
+++ b/packages/common/enums/request-method.enum.ts
@@ -7,4 +7,5 @@ export enum RequestMethod {
   ALL,
   OPTIONS,
   HEAD,
+  SEARCH,
 }
diff --git a/packages/common/enums/version-type.enum.ts b/packages/common/enums/version-type.enum.ts
index 981986e87..abe4c6416 100644
--- a/packages/common/enums/version-type.enum.ts
+++ b/packages/common/enums/version-type.enum.ts
@@ -5,4 +5,5 @@ export enum VersioningType {
   URI,
   HEADER,
   MEDIA_TYPE,
+  CUSTOM,
 }
diff --git a/packages/common/exceptions/bad-gateway.exception.ts b/packages/common/exceptions/bad-gateway.exception.ts
index 78667996c..2623d8727 100644
--- a/packages/common/exceptions/bad-gateway.exception.ts
+++ b/packages/common/exceptions/bad-gateway.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Bad Gateway* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class BadGatewayException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 502.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 502.
@@ -31,12 +31,15 @@ export class BadGatewayException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
     objectOrError?: string | object | any,
-    description = 'Bad Gateway',
+    descriptionOrOptions: string | HttpExceptionOptions = 'Bad Gateway',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
@@ -44,6 +47,7 @@ export class BadGatewayException extends HttpException {
         HttpStatus.BAD_GATEWAY,
       ),
       HttpStatus.BAD_GATEWAY,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/bad-request.exception.ts b/packages/common/exceptions/bad-request.exception.ts
index b5385d09c..bedb7d095 100644
--- a/packages/common/exceptions/bad-request.exception.ts
+++ b/packages/common/exceptions/bad-request.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Bad Request* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class BadRequestException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 400.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 400.
@@ -31,12 +31,15 @@ export class BadRequestException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
     objectOrError?: string | object | any,
-    description = 'Bad Request',
+    descriptionOrOptions: string | HttpExceptionOptions = 'Bad Request',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
@@ -44,6 +47,7 @@ export class BadRequestException extends HttpException {
         HttpStatus.BAD_REQUEST,
       ),
       HttpStatus.BAD_REQUEST,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/conflict.exception.ts b/packages/common/exceptions/conflict.exception.ts
index d67cc30f4..f7810ffbe 100644
--- a/packages/common/exceptions/conflict.exception.ts
+++ b/packages/common/exceptions/conflict.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Conflict* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class ConflictException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 409.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 409.
@@ -31,12 +31,19 @@ export class ConflictException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
-  constructor(objectOrError?: string | object | any, description = 'Conflict') {
+  constructor(
+    objectOrError?: string | object | any,
+    descriptionOrOptions: string | HttpExceptionOptions = 'Conflict',
+  ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(objectOrError, description, HttpStatus.CONFLICT),
       HttpStatus.CONFLICT,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/forbidden.exception.ts b/packages/common/exceptions/forbidden.exception.ts
index 7c3ae92fb..8079823d8 100644
--- a/packages/common/exceptions/forbidden.exception.ts
+++ b/packages/common/exceptions/forbidden.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Forbidden* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class ForbiddenException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 403.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 403.
@@ -31,12 +31,15 @@ export class ForbiddenException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
     objectOrError?: string | object | any,
-    description = 'Forbidden',
+    descriptionOrOptions: string | HttpExceptionOptions = 'Forbidden',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
@@ -44,6 +47,7 @@ export class ForbiddenException extends HttpException {
         HttpStatus.FORBIDDEN,
       ),
       HttpStatus.FORBIDDEN,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/gateway-timeout.exception.ts b/packages/common/exceptions/gateway-timeout.exception.ts
index 2648ddfec..6953f0cb2 100644
--- a/packages/common/exceptions/gateway-timeout.exception.ts
+++ b/packages/common/exceptions/gateway-timeout.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Gateway Timeout* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class GatewayTimeoutException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 504.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 504.
@@ -31,12 +31,15 @@ export class GatewayTimeoutException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
     objectOrError?: string | object | any,
-    description = 'Gateway Timeout',
+    descriptionOrOptions: string | HttpExceptionOptions = 'Gateway Timeout',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
@@ -44,6 +47,7 @@ export class GatewayTimeoutException extends HttpException {
         HttpStatus.GATEWAY_TIMEOUT,
       ),
       HttpStatus.GATEWAY_TIMEOUT,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/gone.exception.ts b/packages/common/exceptions/gone.exception.ts
index 48b141dfe..3e080906a 100644
--- a/packages/common/exceptions/gone.exception.ts
+++ b/packages/common/exceptions/gone.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Gone* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class GoneException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 410.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 410.
@@ -31,12 +31,19 @@ export class GoneException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
-  constructor(objectOrError?: string | object | any, description = 'Gone') {
+  constructor(
+    objectOrError?: string | object | any,
+    descriptionOrOptions: string | HttpExceptionOptions = 'Gone',
+  ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(objectOrError, description, HttpStatus.GONE),
       HttpStatus.GONE,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/http-version-not-supported.exception.ts b/packages/common/exceptions/http-version-not-supported.exception.ts
index 41b340291..922d75ff0 100644
--- a/packages/common/exceptions/http-version-not-supported.exception.ts
+++ b/packages/common/exceptions/http-version-not-supported.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Http Version Not Supported* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class HttpVersionNotSupportedException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 505.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 505.
@@ -31,12 +31,17 @@ export class HttpVersionNotSupportedException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
     objectOrError?: string | object | any,
-    description = 'HTTP Version Not Supported',
+    descriptionOrOptions:
+      | string
+      | HttpExceptionOptions = 'HTTP Version Not Supported',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
@@ -44,6 +49,7 @@ export class HttpVersionNotSupportedException extends HttpException {
         HttpStatus.HTTP_VERSION_NOT_SUPPORTED,
       ),
       HttpStatus.HTTP_VERSION_NOT_SUPPORTED,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/http.exception.ts b/packages/common/exceptions/http.exception.ts
index e907834c8..ca07c5d6e 100644
--- a/packages/common/exceptions/http.exception.ts
+++ b/packages/common/exceptions/http.exception.ts
@@ -1,10 +1,20 @@
 import { isObject, isString } from '../utils/shared.utils';
 
+export interface HttpExceptionOptions {
+  cause?: Error;
+  description?: string;
+}
+
+export interface DescriptionAndOptions {
+  description?: string;
+  httpExceptionOptions?: HttpExceptionOptions;
+}
+
 /**
  * Defines the base Nest HTTP exception, which is handled by the default
  * Exceptions Handler.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -13,12 +23,20 @@ export class HttpException extends Error {
    * Instantiate a plain HTTP Exception.
    *
    * @example
-   * `throw new HttpException()`
+   * throw new HttpException()
+   * throw new HttpException('message', HttpStatus.BAD_REQUEST)
+   * throw new HttpException('custom message', HttpStatus.BAD_REQUEST, {
+   *  cause: new Error('Cause Error'),
+   * })
+   *
    *
    * @usageNotes
    * The constructor arguments define the response and the HTTP response status code.
-   * - The `response` argument (required) defines the JSON response body.
+   * - The `response` argument (required) defines the JSON response body. alternatively, it can also be
+   *  an error object that is used to define an error [cause](https://nodejs.org/en/blog/release/v16.9.0/#error-cause).
    * - The `status` argument (required) defines the HTTP Status Code.
+   * - The `options` argument (optional) defines additional error options. Currently, it supports the `cause` attribute,
+   *  and can be used as an alternative way to specify the error cause: `const error = new HttpException('description', 400, { cause: new Error() });`
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: the Http Status Code.
@@ -31,16 +49,35 @@ export class HttpException extends Error {
    * The `status` argument is required, and should be a valid HTTP status code.
    * Best practice is to use the `HttpStatus` enum imported from `nestjs/common`.
    *
-   * @param response string or object describing the error condition.
+   * @param response string, object describing the error condition or the error cause.
    * @param status HTTP response status code.
+   * @param options An object used to add an error cause.
    */
   constructor(
     private readonly response: string | Record<string, any>,
     private readonly status: number,
+    private readonly options?: HttpExceptionOptions,
   ) {
     super();
     this.initMessage();
     this.initName();
+    this.initCause();
+  }
+
+  public cause: Error | undefined;
+
+  /**
+   * Configures error chaining support
+   *
+   * See:
+   * - https://nodejs.org/en/blog/release/v16.9.0/#error-cause
+   * - https://github.com/microsoft/TypeScript/issues/45167
+   */
+  public initCause(): void {
+    if (this.options?.cause) {
+      this.cause = this.options.cause;
+      return;
+    }
   }
 
   public initMessage() {
@@ -52,9 +89,9 @@ export class HttpException extends Error {
     ) {
       this.message = (this.response as Record<string, any>).message;
     } else if (this.constructor) {
-      this.message = this.constructor.name
-        .match(/[A-Z][a-z]+|[0-9]+/g)
-        .join(' ');
+      this.message =
+        this.constructor.name.match(/[A-Z][a-z]+|[0-9]+/g)?.join(' ') ??
+        'Error';
     }
   }
 
@@ -71,15 +108,52 @@ export class HttpException extends Error {
   }
 
   public static createBody(
-    objectOrError: object | string,
+    objectOrErrorMessage: object | string,
     description?: string,
     statusCode?: number,
   ) {
-    if (!objectOrError) {
+    if (!objectOrErrorMessage) {
       return { statusCode, message: description };
     }
-    return isObject(objectOrError) && !Array.isArray(objectOrError)
-      ? objectOrError
-      : { statusCode, message: objectOrError, error: description };
+    return isObject(objectOrErrorMessage) &&
+      !Array.isArray(objectOrErrorMessage)
+      ? objectOrErrorMessage
+      : { statusCode, message: objectOrErrorMessage, error: description };
+  }
+
+  public static getDescriptionFrom(
+    descriptionOrOptions: string | HttpExceptionOptions,
+  ): string {
+    return isString(descriptionOrOptions)
+      ? descriptionOrOptions
+      : descriptionOrOptions?.description;
+  }
+
+  public static getHttpExceptionOptionsFrom(
+    descriptionOrOptions: string | HttpExceptionOptions,
+  ): HttpExceptionOptions {
+    return isString(descriptionOrOptions) ? {} : descriptionOrOptions;
+  }
+
+  /**
+   * Utility method used to extract the error description and httpExceptionOptions from the given argument.
+   * This is used by inheriting classes to correctly parse both options.
+   * @returns the error description and the httpExceptionOptions as an object.
+   */
+  public static extractDescriptionAndOptionsFrom(
+    descriptionOrOptions: string | HttpExceptionOptions,
+  ): DescriptionAndOptions {
+    const description = isString(descriptionOrOptions)
+      ? descriptionOrOptions
+      : descriptionOrOptions?.description;
+
+    const httpExceptionOptions = isString(descriptionOrOptions)
+      ? {}
+      : descriptionOrOptions;
+
+    return {
+      description,
+      httpExceptionOptions,
+    };
   }
 }
diff --git a/packages/common/exceptions/im-a-teapot.exception.ts b/packages/common/exceptions/im-a-teapot.exception.ts
index db640cd90..76c67861e 100644
--- a/packages/common/exceptions/im-a-teapot.exception.ts
+++ b/packages/common/exceptions/im-a-teapot.exception.ts
@@ -1,5 +1,5 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *ImATeapotException* type errors.
@@ -7,7 +7,7 @@ import { HttpException } from './http.exception';
  * Any attempt to brew coffee with a teapot should result in the error code
  * "418 I'm a teapot". The resulting entity body MAY be short and stout.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -21,7 +21,7 @@ export class ImATeapotException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 418.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 418.
@@ -34,12 +34,15 @@ export class ImATeapotException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
     objectOrError?: string | object | any,
-    description = `I'm a teapot`,
+    descriptionOrOptions: string | HttpExceptionOptions = `I'm a teapot`,
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
@@ -47,6 +50,7 @@ export class ImATeapotException extends HttpException {
         HttpStatus.I_AM_A_TEAPOT,
       ),
       HttpStatus.I_AM_A_TEAPOT,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/internal-server-error.exception.ts b/packages/common/exceptions/internal-server-error.exception.ts
index 06a04d7d8..c3393cf37 100644
--- a/packages/common/exceptions/internal-server-error.exception.ts
+++ b/packages/common/exceptions/internal-server-error.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Internal Server Error* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class InternalServerErrorException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 500.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 500.
@@ -31,12 +31,17 @@ export class InternalServerErrorException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
     objectOrError?: string | object | any,
-    description = 'Internal Server Error',
+    descriptionOrOptions:
+      | string
+      | HttpExceptionOptions = 'Internal Server Error',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
@@ -44,6 +49,7 @@ export class InternalServerErrorException extends HttpException {
         HttpStatus.INTERNAL_SERVER_ERROR,
       ),
       HttpStatus.INTERNAL_SERVER_ERROR,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/method-not-allowed.exception.ts b/packages/common/exceptions/method-not-allowed.exception.ts
index df7666b00..9cf0d8381 100644
--- a/packages/common/exceptions/method-not-allowed.exception.ts
+++ b/packages/common/exceptions/method-not-allowed.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Method Not Allowed* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class MethodNotAllowedException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 405.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 405.
@@ -31,12 +31,15 @@ export class MethodNotAllowedException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
     objectOrError?: string | object | any,
-    description = 'Method Not Allowed',
+    descriptionOrOptions: string | HttpExceptionOptions = 'Method Not Allowed',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
@@ -44,6 +47,7 @@ export class MethodNotAllowedException extends HttpException {
         HttpStatus.METHOD_NOT_ALLOWED,
       ),
       HttpStatus.METHOD_NOT_ALLOWED,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/misdirected.exception.ts b/packages/common/exceptions/misdirected.exception.ts
index 11ae29bae..547ab4431 100644
--- a/packages/common/exceptions/misdirected.exception.ts
+++ b/packages/common/exceptions/misdirected.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Misdirected* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class MisdirectedException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 421.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 421.
@@ -31,12 +31,15 @@ export class MisdirectedException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
     objectOrError?: string | object | any,
-    description = 'Misdirected',
+    descriptionOrOptions: string | HttpExceptionOptions = 'Misdirected',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
@@ -44,6 +47,7 @@ export class MisdirectedException extends HttpException {
         HttpStatus.MISDIRECTED,
       ),
       HttpStatus.MISDIRECTED,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/not-acceptable.exception.ts b/packages/common/exceptions/not-acceptable.exception.ts
index e836d3447..548b2dd79 100644
--- a/packages/common/exceptions/not-acceptable.exception.ts
+++ b/packages/common/exceptions/not-acceptable.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Not Acceptable* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class NotAcceptableException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 406.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 406.
@@ -31,12 +31,15 @@ export class NotAcceptableException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
     objectOrError?: string | object | any,
-    description = 'Not Acceptable',
+    descriptionOrOptions: string | HttpExceptionOptions = 'Not Acceptable',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
@@ -44,6 +47,7 @@ export class NotAcceptableException extends HttpException {
         HttpStatus.NOT_ACCEPTABLE,
       ),
       HttpStatus.NOT_ACCEPTABLE,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/not-found.exception.ts b/packages/common/exceptions/not-found.exception.ts
index d8c38ca7f..b44a744e0 100644
--- a/packages/common/exceptions/not-found.exception.ts
+++ b/packages/common/exceptions/not-found.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Not Found* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class NotFoundException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 404.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 404.
@@ -31,12 +31,15 @@ export class NotFoundException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
     objectOrError?: string | object | any,
-    description = 'Not Found',
+    descriptionOrOptions: string | HttpExceptionOptions = 'Not Found',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
@@ -44,6 +47,7 @@ export class NotFoundException extends HttpException {
         HttpStatus.NOT_FOUND,
       ),
       HttpStatus.NOT_FOUND,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/not-implemented.exception.ts b/packages/common/exceptions/not-implemented.exception.ts
index 4702fe384..6f6912649 100644
--- a/packages/common/exceptions/not-implemented.exception.ts
+++ b/packages/common/exceptions/not-implemented.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Not Implemented* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class NotImplementedException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 501.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 501.
@@ -30,13 +30,16 @@ export class NotImplementedException extends HttpException {
    * entire JSON response body, pass an object instead. Nest will serialize the object
    * and return it as the JSON response body.
    *
-   * @param description string or object describing the error condition.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    * @param error a short description of the HTTP error.
    */
   constructor(
     objectOrError?: string | object | any,
-    description = 'Not Implemented',
+    descriptionOrOptions: string | HttpExceptionOptions = 'Not Implemented',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
@@ -44,6 +47,7 @@ export class NotImplementedException extends HttpException {
         HttpStatus.NOT_IMPLEMENTED,
       ),
       HttpStatus.NOT_IMPLEMENTED,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/payload-too-large.exception.ts b/packages/common/exceptions/payload-too-large.exception.ts
index 968b94d3f..73de7d1f2 100644
--- a/packages/common/exceptions/payload-too-large.exception.ts
+++ b/packages/common/exceptions/payload-too-large.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Payload Too Large* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class PayloadTooLargeException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 413.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 413.
@@ -31,12 +31,15 @@ export class PayloadTooLargeException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
     objectOrError?: string | object | any,
-    description = 'Payload Too Large',
+    descriptionOrOptions: string | HttpExceptionOptions = 'Payload Too Large',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
@@ -44,6 +47,7 @@ export class PayloadTooLargeException extends HttpException {
         HttpStatus.PAYLOAD_TOO_LARGE,
       ),
       HttpStatus.PAYLOAD_TOO_LARGE,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/precondition-failed.exception.ts b/packages/common/exceptions/precondition-failed.exception.ts
index ca9c3a70d..d03da41d0 100644
--- a/packages/common/exceptions/precondition-failed.exception.ts
+++ b/packages/common/exceptions/precondition-failed.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Precondition Failed* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class PreconditionFailedException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 412.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 412.
@@ -31,12 +31,15 @@ export class PreconditionFailedException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
     objectOrError?: string | object | any,
-    description = 'Precondition Failed',
+    descriptionOrOptions: string | HttpExceptionOptions = 'Precondition Failed',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
@@ -44,6 +47,7 @@ export class PreconditionFailedException extends HttpException {
         HttpStatus.PRECONDITION_FAILED,
       ),
       HttpStatus.PRECONDITION_FAILED,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/request-timeout.exception.ts b/packages/common/exceptions/request-timeout.exception.ts
index 3bcd193ce..d91c3cfd1 100644
--- a/packages/common/exceptions/request-timeout.exception.ts
+++ b/packages/common/exceptions/request-timeout.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Request Timeout* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class RequestTimeoutException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 408.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 408.
@@ -31,12 +31,15 @@ export class RequestTimeoutException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
     objectOrError?: string | object | any,
-    description = 'Request Timeout',
+    descriptionOrOptions: string | HttpExceptionOptions = 'Request Timeout',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
@@ -44,6 +47,7 @@ export class RequestTimeoutException extends HttpException {
         HttpStatus.REQUEST_TIMEOUT,
       ),
       HttpStatus.REQUEST_TIMEOUT,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/service-unavailable.exception.ts b/packages/common/exceptions/service-unavailable.exception.ts
index f0270b7e6..2d1c6bd03 100644
--- a/packages/common/exceptions/service-unavailable.exception.ts
+++ b/packages/common/exceptions/service-unavailable.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Service Unavailable* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class ServiceUnavailableException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 503.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 503.
@@ -31,12 +31,15 @@ export class ServiceUnavailableException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
     objectOrError?: string | object | any,
-    description = 'Service Unavailable',
+    descriptionOrOptions: string | HttpExceptionOptions = 'Service Unavailable',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
@@ -44,6 +47,7 @@ export class ServiceUnavailableException extends HttpException {
         HttpStatus.SERVICE_UNAVAILABLE,
       ),
       HttpStatus.SERVICE_UNAVAILABLE,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/unauthorized.exception.ts b/packages/common/exceptions/unauthorized.exception.ts
index 7d9379816..b85fa847e 100644
--- a/packages/common/exceptions/unauthorized.exception.ts
+++ b/packages/common/exceptions/unauthorized.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Unauthorized* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class UnauthorizedException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 401.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 401.
@@ -31,12 +31,15 @@ export class UnauthorizedException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
     objectOrError?: string | object | any,
-    description = 'Unauthorized',
+    descriptionOrOptions: string | HttpExceptionOptions = 'Unauthorized',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
@@ -44,6 +47,7 @@ export class UnauthorizedException extends HttpException {
         HttpStatus.UNAUTHORIZED,
       ),
       HttpStatus.UNAUTHORIZED,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/unprocessable-entity.exception.ts b/packages/common/exceptions/unprocessable-entity.exception.ts
index f76c8d24e..a4e012cac 100644
--- a/packages/common/exceptions/unprocessable-entity.exception.ts
+++ b/packages/common/exceptions/unprocessable-entity.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Unprocessable Entity* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class UnprocessableEntityException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 422.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 422.
@@ -31,12 +31,17 @@ export class UnprocessableEntityException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
     objectOrError?: string | object | any,
-    description = 'Unprocessable Entity',
+    descriptionOrOptions:
+      | string
+      | HttpExceptionOptions = 'Unprocessable Entity',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
@@ -44,6 +49,7 @@ export class UnprocessableEntityException extends HttpException {
         HttpStatus.UNPROCESSABLE_ENTITY,
       ),
       HttpStatus.UNPROCESSABLE_ENTITY,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/exceptions/unsupported-media-type.exception.ts b/packages/common/exceptions/unsupported-media-type.exception.ts
index 49e4ab14f..fb8a0e1df 100644
--- a/packages/common/exceptions/unsupported-media-type.exception.ts
+++ b/packages/common/exceptions/unsupported-media-type.exception.ts
@@ -1,10 +1,10 @@
 import { HttpStatus } from '../enums/http-status.enum';
-import { HttpException } from './http.exception';
+import { HttpException, HttpExceptionOptions } from './http.exception';
 
 /**
  * Defines an HTTP exception for *Unsupported Media Type* type errors.
  *
- * @see [Base Exceptions](https://docs.nestjs.com/exception-filters#base-exceptions)
+ * @see [Built-in HTTP exceptions](https://docs.nestjs.com/exception-filters#built-in-http-exceptions)
  *
  * @publicApi
  */
@@ -18,7 +18,7 @@ export class UnsupportedMediaTypeException extends HttpException {
    * @usageNotes
    * The HTTP response status code will be 415.
    * - The `objectOrError` argument defines the JSON response body or the message string.
-   * - The `description` argument contains a short description of the HTTP error.
+   * - The `descriptionOrOptions` argument contains either a short description of the HTTP error or an options object used to provide an underlying error cause.
    *
    * By default, the JSON response body contains two properties:
    * - `statusCode`: this will be the value 415.
@@ -31,12 +31,17 @@ export class UnsupportedMediaTypeException extends HttpException {
    * and return it as the JSON response body.
    *
    * @param objectOrError string or object describing the error condition.
-   * @param description a short description of the HTTP error.
+   * @param descriptionOrOptions either a short description of the HTTP error or an options object used to provide an underlying error cause
    */
   constructor(
     objectOrError?: string | object | any,
-    description = 'Unsupported Media Type',
+    descriptionOrOptions:
+      | string
+      | HttpExceptionOptions = 'Unsupported Media Type',
   ) {
+    const { description, httpExceptionOptions } =
+      HttpException.extractDescriptionAndOptionsFrom(descriptionOrOptions);
+
     super(
       HttpException.createBody(
         objectOrError,
@@ -44,6 +49,7 @@ export class UnsupportedMediaTypeException extends HttpException {
         HttpStatus.UNSUPPORTED_MEDIA_TYPE,
       ),
       HttpStatus.UNSUPPORTED_MEDIA_TYPE,
+      httpExceptionOptions,
     );
   }
 }
diff --git a/packages/common/file-stream/interfaces/index.ts b/packages/common/file-stream/interfaces/index.ts
new file mode 100644
index 000000000..9be413e21
--- /dev/null
+++ b/packages/common/file-stream/interfaces/index.ts
@@ -0,0 +1,2 @@
+export * from './streamable-options.interface';
+export * from './streamable-handler-response.interface';
diff --git a/packages/common/file-stream/interfaces/streamable-handler-response.interface.ts b/packages/common/file-stream/interfaces/streamable-handler-response.interface.ts
new file mode 100644
index 000000000..c1c77a922
--- /dev/null
+++ b/packages/common/file-stream/interfaces/streamable-handler-response.interface.ts
@@ -0,0 +1,12 @@
+export interface StreamableHandlerResponse {
+  /** `true` if the connection is destroyed, `false` otherwise. */
+  destroyed: boolean;
+  /** `true` if headers were sent, `false` otherwise. */
+  headersSent: boolean;
+  /** The status code that will be sent to the client when the headers get flushed. */
+  statusCode: number;
+  /** Sends the HTTP response. */
+  send: (body: string) => void;
+  /** Signals to the server that all of the response headers and body have been sent. */
+  end: () => void;
+}
diff --git a/packages/common/file-stream/streamable-options.interface.ts b/packages/common/file-stream/interfaces/streamable-options.interface.ts
similarity index 51%
rename from packages/common/file-stream/streamable-options.interface.ts
rename to packages/common/file-stream/interfaces/streamable-options.interface.ts
index 4b7bbee4e..bd9616b5c 100644
--- a/packages/common/file-stream/streamable-options.interface.ts
+++ b/packages/common/file-stream/interfaces/streamable-options.interface.ts
@@ -1,4 +1,10 @@
+/**
+ * Options for `StreamableFile`
+ *
+ * @publicApi
+ */
 export interface StreamableFileOptions {
   type?: string;
   disposition?: string;
-}
\ No newline at end of file
+  length?: number;
+}
diff --git a/packages/common/file-stream/streamable-file.ts b/packages/common/file-stream/streamable-file.ts
index 305ee624b..971741d5a 100644
--- a/packages/common/file-stream/streamable-file.ts
+++ b/packages/common/file-stream/streamable-file.ts
@@ -1,23 +1,45 @@
 import { Readable } from 'stream';
-import { StreamableFileOptions } from './streamable-options.interface';
+import { types } from 'util';
+import { HttpStatus } from '../enums';
+import { isFunction } from '../utils/shared.utils';
+import { StreamableFileOptions, StreamableHandlerResponse } from './interfaces';
 
+/**
+ * @see [Streaming files](https://docs.nestjs.com/techniques/streaming-files)
+ *
+ * @publicApi
+ */
 export class StreamableFile {
   private readonly stream: Readable;
 
-  constructor(buffer: Buffer, options?: StreamableFileOptions);
+  protected handleError: (
+    err: Error,
+    response: StreamableHandlerResponse,
+  ) => void = (err: Error, res) => {
+    if (res.destroyed) {
+      return;
+    }
+    if (res.headersSent) {
+      res.end();
+      return;
+    }
+
+    res.statusCode = HttpStatus.BAD_REQUEST;
+    res.send(err.message);
+  };
+
+  constructor(buffer: Uint8Array, options?: StreamableFileOptions);
   constructor(readable: Readable, options?: StreamableFileOptions);
   constructor(
-    bufferOrReadStream: Buffer | Readable,
+    bufferOrReadStream: Uint8Array | Readable,
     readonly options: StreamableFileOptions = {},
   ) {
-    if (Buffer.isBuffer(bufferOrReadStream)) {
+    if (types.isUint8Array(bufferOrReadStream)) {
       this.stream = new Readable();
       this.stream.push(bufferOrReadStream);
       this.stream.push(null);
-    } else if (
-      bufferOrReadStream.pipe &&
-      typeof bufferOrReadStream.pipe === 'function'
-    ) {
+      this.options.length ??= bufferOrReadStream.length;
+    } else if (bufferOrReadStream.pipe && isFunction(bufferOrReadStream.pipe)) {
       this.stream = bufferOrReadStream;
     }
   }
@@ -27,8 +49,29 @@ export class StreamableFile {
   }
 
   getHeaders() {
-    const { type = 'application/octet-stream', disposition = null } =
-      this.options;
-    return { type, disposition };
+    const {
+      type = 'application/octet-stream',
+      disposition = undefined,
+      length = undefined,
+    } = this.options;
+    return {
+      type,
+      disposition,
+      length,
+    };
+  }
+
+  get errorHandler(): (
+    err: Error,
+    response: StreamableHandlerResponse,
+  ) => void {
+    return this.handleError;
+  }
+
+  setErrorHandler(
+    handler: (err: Error, response: StreamableHandlerResponse) => void,
+  ) {
+    this.handleError = handler;
+    return this;
   }
 }
diff --git a/packages/common/http/http.constants.ts b/packages/common/http/http.constants.ts
deleted file mode 100644
index 21f6d8499..000000000
--- a/packages/common/http/http.constants.ts
+++ /dev/null
@@ -1,3 +0,0 @@
-export const AXIOS_INSTANCE_TOKEN = 'AXIOS_INSTANCE_TOKEN';
-export const HTTP_MODULE_ID = 'HTTP_MODULE_ID';
-export const HTTP_MODULE_OPTIONS = 'HTTP_MODULE_OPTIONS';
diff --git a/packages/common/http/http.module.ts b/packages/common/http/http.module.ts
deleted file mode 100644
index cc0367673..000000000
--- a/packages/common/http/http.module.ts
+++ /dev/null
@@ -1,99 +0,0 @@
-import Axios from 'axios';
-import { Module } from '../decorators/modules/module.decorator';
-import { DynamicModule, Provider } from '../interfaces';
-import { randomStringGenerator } from '../utils/random-string-generator.util';
-import {
-  AXIOS_INSTANCE_TOKEN,
-  HTTP_MODULE_ID,
-  HTTP_MODULE_OPTIONS,
-} from './http.constants';
-import { HttpService } from './http.service';
-import {
-  HttpModuleAsyncOptions,
-  HttpModuleOptions,
-  HttpModuleOptionsFactory,
-} from './interfaces';
-
-/**
- * @deprecated "HttpModule" (from the "@nestjs/common" package) is deprecated and will be removed in the next major release. Please, use the "@nestjs/axios" package instead.
- */
-@Module({
-  providers: [
-    HttpService,
-    {
-      provide: AXIOS_INSTANCE_TOKEN,
-      useValue: Axios,
-    },
-  ],
-  exports: [HttpService],
-})
-export class HttpModule {
-  static register(config: HttpModuleOptions): DynamicModule {
-    return {
-      module: HttpModule,
-      providers: [
-        {
-          provide: AXIOS_INSTANCE_TOKEN,
-          useValue: Axios.create(config),
-        },
-        {
-          provide: HTTP_MODULE_ID,
-          useValue: randomStringGenerator(),
-        },
-      ],
-    };
-  }
-
-  static registerAsync(options: HttpModuleAsyncOptions): DynamicModule {
-    return {
-      module: HttpModule,
-      imports: options.imports,
-      providers: [
-        ...this.createAsyncProviders(options),
-        {
-          provide: AXIOS_INSTANCE_TOKEN,
-          useFactory: (config: HttpModuleOptions) => Axios.create(config),
-          inject: [HTTP_MODULE_OPTIONS],
-        },
-        {
-          provide: HTTP_MODULE_ID,
-          useValue: randomStringGenerator(),
-        },
-        ...(options.extraProviders || []),
-      ],
-    };
-  }
-
-  private static createAsyncProviders(
-    options: HttpModuleAsyncOptions,
-  ): Provider[] {
-    if (options.useExisting || options.useFactory) {
-      return [this.createAsyncOptionsProvider(options)];
-    }
-    return [
-      this.createAsyncOptionsProvider(options),
-      {
-        provide: options.useClass,
-        useClass: options.useClass,
-      },
-    ];
-  }
-
-  private static createAsyncOptionsProvider(
-    options: HttpModuleAsyncOptions,
-  ): Provider {
-    if (options.useFactory) {
-      return {
-        provide: HTTP_MODULE_OPTIONS,
-        useFactory: options.useFactory,
-        inject: options.inject || [],
-      };
-    }
-    return {
-      provide: HTTP_MODULE_OPTIONS,
-      useFactory: async (optionsFactory: HttpModuleOptionsFactory) =>
-        optionsFactory.createHttpOptions(),
-      inject: [options.useExisting || options.useClass],
-    };
-  }
-}
diff --git a/packages/common/http/http.service.ts b/packages/common/http/http.service.ts
deleted file mode 100644
index 7c6e2ded2..000000000
--- a/packages/common/http/http.service.ts
+++ /dev/null
@@ -1,113 +0,0 @@
-import Axios, {
-  AxiosInstance,
-  AxiosPromise,
-  AxiosRequestConfig,
-  AxiosResponse,
-  CancelTokenSource,
-} from 'axios';
-import { Observable } from 'rxjs';
-import { Inject } from '../decorators';
-import { Logger } from '../services';
-import { AXIOS_INSTANCE_TOKEN } from './http.constants';
-
-/**
- * @deprecated "HttpModule" (from the "@nestjs/common" package) is deprecated and will be removed in the next major release. Please, use the "@nestjs/axios" package instead.
- */
-export class HttpService {
-  private readonly logger = new Logger(HttpService.name);
-
-  constructor(
-    @Inject(AXIOS_INSTANCE_TOKEN)
-    private readonly instance: AxiosInstance = Axios,
-  ) {
-    this.logger.warn(
-      'DEPRECATED! "HttpModule" (from the "@nestjs/common" package) is deprecated and will be removed in the next major release. Please, use the "@nestjs/axios" package instead.',
-    );
-  }
-
-  request<T = any>(config: AxiosRequestConfig): Observable<AxiosResponse<T>> {
-    return this.makeObservable<T>(this.instance.request, config);
-  }
-
-  get<T = any>(
-    url: string,
-    config?: AxiosRequestConfig,
-  ): Observable<AxiosResponse<T>> {
-    return this.makeObservable<T>(this.instance.get, url, config);
-  }
-
-  delete<T = any>(
-    url: string,
-    config?: AxiosRequestConfig,
-  ): Observable<AxiosResponse<T>> {
-    return this.makeObservable<T>(this.instance.delete, url, config);
-  }
-
-  head<T = any>(
-    url: string,
-    config?: AxiosRequestConfig,
-  ): Observable<AxiosResponse<T>> {
-    return this.makeObservable<T>(this.instance.head, url, config);
-  }
-
-  post<T = any>(
-    url: string,
-    data?: any,
-    config?: AxiosRequestConfig,
-  ): Observable<AxiosResponse<T>> {
-    return this.makeObservable<T>(this.instance.post, url, data, config);
-  }
-
-  put<T = any>(
-    url: string,
-    data?: any,
-    config?: AxiosRequestConfig,
-  ): Observable<AxiosResponse<T>> {
-    return this.makeObservable<T>(this.instance.put, url, data, config);
-  }
-
-  patch<T = any>(
-    url: string,
-    data?: any,
-    config?: AxiosRequestConfig,
-  ): Observable<AxiosResponse<T>> {
-    return this.makeObservable<T>(this.instance.patch, url, data, config);
-  }
-
-  get axiosRef(): AxiosInstance {
-    return this.instance;
-  }
-
-  private makeObservable<T>(
-    axios: (...args: any[]) => AxiosPromise<T>,
-    ...args: any[]
-  ) {
-    return new Observable<AxiosResponse<T>>(subscriber => {
-      const config: AxiosRequestConfig = { ...(args[args.length - 1] || {}) };
-
-      let cancelSource: CancelTokenSource;
-      if (!config.cancelToken) {
-        cancelSource = Axios.CancelToken.source();
-        config.cancelToken = cancelSource.token;
-      }
-
-      axios(...args)
-        .then(res => {
-          subscriber.next(res);
-          subscriber.complete();
-        })
-        .catch(err => {
-          subscriber.error(err);
-        });
-      return () => {
-        if (config.responseType === 'stream') {
-          return;
-        }
-
-        if (cancelSource) {
-          cancelSource.cancel();
-        }
-      };
-    });
-  }
-}
diff --git a/packages/common/http/index.ts b/packages/common/http/index.ts
deleted file mode 100644
index 2e7a1fead..000000000
--- a/packages/common/http/index.ts
+++ /dev/null
@@ -1,3 +0,0 @@
-export * from './http.module';
-export * from './http.service';
-export * from './interfaces';
diff --git a/packages/common/http/interfaces/http-module.interface.ts b/packages/common/http/interfaces/http-module.interface.ts
deleted file mode 100644
index 794f9385c..000000000
--- a/packages/common/http/interfaces/http-module.interface.ts
+++ /dev/null
@@ -1,19 +0,0 @@
-import { AxiosRequestConfig } from 'axios';
-import { ModuleMetadata, Provider, Type } from '../../interfaces';
-
-export type HttpModuleOptions = AxiosRequestConfig;
-
-export interface HttpModuleOptionsFactory {
-  createHttpOptions(): Promise<HttpModuleOptions> | HttpModuleOptions;
-}
-
-export interface HttpModuleAsyncOptions
-  extends Pick<ModuleMetadata, 'imports'> {
-  useExisting?: Type<HttpModuleOptionsFactory>;
-  useClass?: Type<HttpModuleOptionsFactory>;
-  useFactory?: (
-    ...args: any[]
-  ) => Promise<HttpModuleOptions> | HttpModuleOptions;
-  inject?: any[];
-  extraProviders?: Provider[];
-}
diff --git a/packages/common/http/interfaces/index.ts b/packages/common/http/interfaces/index.ts
deleted file mode 100644
index 692e7247e..000000000
--- a/packages/common/http/interfaces/index.ts
+++ /dev/null
@@ -1 +0,0 @@
-export * from './http-module.interface';
diff --git a/packages/common/index.ts b/packages/common/index.ts
index 6a6107762..bfeb90f80 100644
--- a/packages/common/index.ts
+++ b/packages/common/index.ts
@@ -1,17 +1,15 @@
 /*
  * Nest @common
- * Copyright(c) 2017 - 2021 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2023 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
 import 'reflect-metadata';
 
-export * from './cache';
 export * from './decorators';
 export * from './enums';
 export * from './exceptions';
 export * from './file-stream';
-export * from './http';
 export {
   Abstract,
   ArgumentMetadata,
@@ -31,6 +29,7 @@ export {
   INestApplication,
   INestApplicationContext,
   INestMicroservice,
+  InjectionToken,
   IntrospectionResult,
   MessageEvent,
   MiddlewareConsumer,
@@ -44,9 +43,11 @@ export {
   OnApplicationShutdown,
   OnModuleDestroy,
   OnModuleInit,
+  OptionalFactoryDependency,
   Paramtype,
   PipeTransform,
   Provider,
+  RawBodyRequest,
   RpcExceptionFilter,
   Scope,
   ScopeOptions,
@@ -59,6 +60,7 @@ export {
   WsExceptionFilter,
   WsMessageHandler,
 } from './interfaces';
+export * from './module-utils';
 export * from './pipes';
 export * from './serializer';
 export * from './services';
diff --git a/packages/common/interfaces/features/custom-route-param-factory.interface.ts b/packages/common/interfaces/features/custom-route-param-factory.interface.ts
index 3a6afd910..e022b6669 100644
--- a/packages/common/interfaces/features/custom-route-param-factory.interface.ts
+++ b/packages/common/interfaces/features/custom-route-param-factory.interface.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export type CustomParamFactory<TData = any, TInput = any, TOutput = any> = (
   data: TData,
   input: TInput,
diff --git a/packages/common/interfaces/features/paramtype.interface.ts b/packages/common/interfaces/features/paramtype.interface.ts
index d2c299dbc..a63184f8c 100644
--- a/packages/common/interfaces/features/paramtype.interface.ts
+++ b/packages/common/interfaces/features/paramtype.interface.ts
@@ -1 +1,4 @@
+/**
+ * @publicApi
+ */
 export type Paramtype = 'body' | 'query' | 'param' | 'custom';
diff --git a/packages/common/interfaces/http/http-exception-body.interface.ts b/packages/common/interfaces/http/http-exception-body.interface.ts
new file mode 100644
index 000000000..e0b923e5e
--- /dev/null
+++ b/packages/common/interfaces/http/http-exception-body.interface.ts
@@ -0,0 +1,7 @@
+export type HttpExceptionBodyMessage = string | string[];
+
+export interface HttpExceptionBody {
+  message: HttpExceptionBodyMessage;
+  error?: string;
+  statusCode: number;
+}
diff --git a/packages/common/interfaces/http/http-server.interface.ts b/packages/common/interfaces/http/http-server.interface.ts
index b85595c41..8bf7e49a9 100644
--- a/packages/common/interfaces/http/http-server.interface.ts
+++ b/packages/common/interfaces/http/http-server.interface.ts
@@ -18,7 +18,11 @@ export type RequestHandler<TRequest = any, TResponse = any> = (
   next?: Function,
 ) => any;
 
-export interface HttpServer<TRequest = any, TResponse = any> {
+export interface HttpServer<
+  TRequest = any,
+  TResponse = any,
+  ServerInstance = any,
+> {
   use(
     handler:
       | RequestHandler<TRequest, TResponse>
@@ -30,6 +34,7 @@ export interface HttpServer<TRequest = any, TResponse = any> {
       | RequestHandler<TRequest, TResponse>
       | ErrorHandler<TRequest, TResponse>,
   ): any;
+  useBodyParser?(...args: any[]): any;
   get(handler: RequestHandler<TRequest, TResponse>): any;
   get(path: string, handler: RequestHandler<TRequest, TResponse>): any;
   post(handler: RequestHandler<TRequest, TResponse>): any;
@@ -50,8 +55,10 @@ export interface HttpServer<TRequest = any, TResponse = any> {
   listen(port: number | string, hostname: string, callback?: () => void): any;
   reply(response: any, body: any, statusCode?: number): any;
   status(response: any, statusCode: number): any;
+  end(response: any, message?: string): any;
   render(response: any, view: string, options: any): any;
   redirect(response: any, statusCode: number, url: string): any;
+  isHeadersSent(response: any): boolean;
   setHeader(response: any, name: string, value: string): any;
   setErrorHandler?(handler: Function, prefix?: string): any;
   setNotFoundHandler?(handler: Function, prefix?: string): any;
@@ -66,21 +73,17 @@ export interface HttpServer<TRequest = any, TResponse = any> {
   getRequestHostname?(request: TRequest): string;
   getRequestMethod?(request: TRequest): string;
   getRequestUrl?(request: TRequest): string;
-  getInstance(): any;
-  registerParserMiddleware(): any;
+  getInstance(): ServerInstance;
+  registerParserMiddleware(...args: any[]): any;
   enableCors(options: CorsOptions | CorsOptionsDelegate<TRequest>): any;
   getHttpServer(): any;
   initHttpServer(options: NestApplicationOptions): void;
   close(): any;
   getType(): string;
   init?(): Promise<void>;
-  applyVersionFilter?(
+  applyVersionFilter(
     handler: Function,
     version: VersionValue,
     versioningOptions: VersioningOptions,
-  ): <TRequest extends Record<string, any> = any, TResponse = any>(
-    req: TRequest,
-    res: TResponse,
-    next: () => void,
-  ) => any;
+  ): (req: TRequest, res: TResponse, next: () => void) => Function;
 }
diff --git a/packages/common/interfaces/http/index.ts b/packages/common/interfaces/http/index.ts
index f57d218dd..8c9eed173 100644
--- a/packages/common/interfaces/http/index.ts
+++ b/packages/common/interfaces/http/index.ts
@@ -1,2 +1,3 @@
 export * from './http-server.interface';
 export * from './message-event.interface';
+export * from './raw-body-request.interface';
diff --git a/packages/common/interfaces/http/raw-body-request.interface.ts b/packages/common/interfaces/http/raw-body-request.interface.ts
new file mode 100644
index 000000000..b87229083
--- /dev/null
+++ b/packages/common/interfaces/http/raw-body-request.interface.ts
@@ -0,0 +1,4 @@
+/**
+ * @publicApi
+ */
+export type RawBodyRequest<T> = T & { rawBody?: Buffer };
diff --git a/packages/common/interfaces/microservices/nest-hybrid-application-options.interface.ts b/packages/common/interfaces/microservices/nest-hybrid-application-options.interface.ts
index bc27552c5..5389cf5d1 100644
--- a/packages/common/interfaces/microservices/nest-hybrid-application-options.interface.ts
+++ b/packages/common/interfaces/microservices/nest-hybrid-application-options.interface.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export interface NestHybridApplicationOptions {
   inheritAppConfig?: boolean;
 }
diff --git a/packages/common/interfaces/microservices/nest-microservice-options.interface.ts b/packages/common/interfaces/microservices/nest-microservice-options.interface.ts
index 04057a09d..34f32c9f5 100644
--- a/packages/common/interfaces/microservices/nest-microservice-options.interface.ts
+++ b/packages/common/interfaces/microservices/nest-microservice-options.interface.ts
@@ -1,3 +1,6 @@
 import { NestApplicationContextOptions } from '../nest-application-context-options.interface';
 
+/**
+ * @publicApi
+ */
 export type NestMicroserviceOptions = NestApplicationContextOptions;
diff --git a/packages/common/interfaces/middleware/middleware-config-proxy.interface.ts b/packages/common/interfaces/middleware/middleware-config-proxy.interface.ts
index e23c3cf8a..b0d194b86 100644
--- a/packages/common/interfaces/middleware/middleware-config-proxy.interface.ts
+++ b/packages/common/interfaces/middleware/middleware-config-proxy.interface.ts
@@ -2,6 +2,9 @@ import { Type } from '../type.interface';
 import { RouteInfo } from './middleware-configuration.interface';
 import { MiddlewareConsumer } from './middleware-consumer.interface';
 
+/**
+ * @publicApi
+ */
 export interface MiddlewareConfigProxy {
   /**
    * Excludes routes from the currently processed middleware.
diff --git a/packages/common/interfaces/middleware/middleware-configuration.interface.ts b/packages/common/interfaces/middleware/middleware-configuration.interface.ts
index aef5012ed..15414b6cb 100644
--- a/packages/common/interfaces/middleware/middleware-configuration.interface.ts
+++ b/packages/common/interfaces/middleware/middleware-configuration.interface.ts
@@ -1,9 +1,11 @@
 import { RequestMethod } from '../../enums';
 import { Type } from '../type.interface';
+import { VersionValue } from '../version-options.interface';
 
 export interface RouteInfo {
   path: string;
   method: RequestMethod;
+  version?: VersionValue;
 }
 
 export interface MiddlewareConfiguration<T = any> {
diff --git a/packages/common/interfaces/middleware/nest-middleware.interface.ts b/packages/common/interfaces/middleware/nest-middleware.interface.ts
index d392d052d..88c27bc5c 100644
--- a/packages/common/interfaces/middleware/nest-middleware.interface.ts
+++ b/packages/common/interfaces/middleware/nest-middleware.interface.ts
@@ -1,3 +1,8 @@
+/**
+ * @see [Middleware](https://docs.nestjs.com/middleware)
+ *
+ * @publicApi
+ */
 export interface NestMiddleware<TRequest = any, TResponse = any> {
-  use(req: TRequest, res: TResponse, next: () => void): any;
+  use(req: TRequest, res: TResponse, next: (error?: Error | any) => void): any;
 }
diff --git a/packages/common/interfaces/modules/index.ts b/packages/common/interfaces/modules/index.ts
index 612adb82b..458f952a3 100644
--- a/packages/common/interfaces/modules/index.ts
+++ b/packages/common/interfaces/modules/index.ts
@@ -1,6 +1,8 @@
 export * from './dynamic-module.interface';
 export * from './forward-reference.interface';
+export * from './injection-token.interface';
 export * from './introspection-result.interface';
 export * from './module-metadata.interface';
 export * from './nest-module.interface';
+export * from './optional-factory-dependency.interface';
 export * from './provider.interface';
diff --git a/packages/common/interfaces/modules/injection-token.interface.ts b/packages/common/interfaces/modules/injection-token.interface.ts
new file mode 100644
index 000000000..8a4d8d97f
--- /dev/null
+++ b/packages/common/interfaces/modules/injection-token.interface.ts
@@ -0,0 +1,12 @@
+import { Abstract } from '../abstract.interface';
+import { Type } from '../type.interface';
+
+/**
+ * @publicApi
+ */
+export type InjectionToken =
+  | string
+  | symbol
+  | Type<any>
+  | Abstract<any>
+  | Function;
diff --git a/packages/common/interfaces/modules/nest-module.interface.ts b/packages/common/interfaces/modules/nest-module.interface.ts
index bef5810c2..236658017 100644
--- a/packages/common/interfaces/modules/nest-module.interface.ts
+++ b/packages/common/interfaces/modules/nest-module.interface.ts
@@ -1,5 +1,8 @@
 import { MiddlewareConsumer } from '../middleware/middleware-consumer.interface';
 
+/**
+ * @publicApi
+ */
 export interface NestModule {
   configure(consumer: MiddlewareConsumer);
 }
diff --git a/packages/common/interfaces/modules/optional-factory-dependency.interface.ts b/packages/common/interfaces/modules/optional-factory-dependency.interface.ts
new file mode 100644
index 000000000..6c8db900e
--- /dev/null
+++ b/packages/common/interfaces/modules/optional-factory-dependency.interface.ts
@@ -0,0 +1,9 @@
+import { InjectionToken } from './injection-token.interface';
+
+/**
+ * @publicApi
+ */
+export type OptionalFactoryDependency = {
+  token: InjectionToken;
+  optional: boolean;
+};
diff --git a/packages/common/interfaces/modules/provider.interface.ts b/packages/common/interfaces/modules/provider.interface.ts
index c868b3c97..2fd7f85b6 100644
--- a/packages/common/interfaces/modules/provider.interface.ts
+++ b/packages/common/interfaces/modules/provider.interface.ts
@@ -1,6 +1,7 @@
-import { Abstract } from '../abstract.interface';
 import { Scope } from '../scope-options.interface';
 import { Type } from '../type.interface';
+import { InjectionToken } from './injection-token.interface';
+import { OptionalFactoryDependency } from './optional-factory-dependency.interface';
 
 /**
  *
@@ -27,7 +28,7 @@ export type Provider<T = any> =
  * };
  * ```
  *
- * @see [Use class](https://docs.nestjs.com/fundamentals/custom-providers#use-class)
+ * @see [Class providers](https://docs.nestjs.com/fundamentals/custom-providers#class-providers-useclass)
  * @see [Injection scopes](https://docs.nestjs.com/fundamentals/injection-scopes)
  *
  * @publicApi
@@ -36,7 +37,7 @@ export interface ClassProvider<T = any> {
   /**
    * Injection token
    */
-  provide: string | symbol | Type<any> | Abstract<any> | Function;
+  provide: InjectionToken;
   /**
    * Type (class name) of provider (instance to be injected).
    */
@@ -45,6 +46,19 @@ export interface ClassProvider<T = any> {
    * Optional enum defining lifetime of the provider that is injected.
    */
   scope?: Scope;
+  /**
+   * This option is only available on factory providers!
+   *
+   * @see [Use factory](https://docs.nestjs.com/fundamentals/custom-providers#factory-providers-usefactory)
+   */
+  inject?: never;
+  /**
+   * Flags provider as durable. This flag can be used in combination with custom context id
+   * factory strategy to construct lazy DI subtrees.
+   *
+   * This flag can be used only in conjunction with scope = Scope.REQUEST.
+   */
+  durable?: boolean;
 }
 
 /**
@@ -58,7 +72,7 @@ export interface ClassProvider<T = any> {
  * };
  * ```
  *
- * @see [Use value](https://docs.nestjs.com/fundamentals/custom-providers#use-value)
+ * @see [Value providers](https://docs.nestjs.com/fundamentals/custom-providers#value-providers-usevalue)
  *
  * @publicApi
  */
@@ -66,11 +80,17 @@ export interface ValueProvider<T = any> {
   /**
    * Injection token
    */
-  provide: string | symbol | Type<any> | Abstract<any> | Function;
+  provide: InjectionToken;
   /**
    * Instance of a provider to be injected.
    */
   useValue: T;
+  /**
+   * This option is only available on factory providers!
+   *
+   * @see [Use factory](https://docs.nestjs.com/fundamentals/custom-providers#factory-providers-usefactory)
+   */
+  inject?: never;
 }
 
 /**
@@ -88,7 +108,7 @@ export interface ValueProvider<T = any> {
  * };
  * ```
  *
- * @see [Use factory](https://docs.nestjs.com/fundamentals/custom-providers#use-factory)
+ * @see [Factory providers](https://docs.nestjs.com/fundamentals/custom-providers#factory-providers-usefactory)
  * @see [Injection scopes](https://docs.nestjs.com/fundamentals/injection-scopes)
  *
  * @publicApi
@@ -97,19 +117,26 @@ export interface FactoryProvider<T = any> {
   /**
    * Injection token
    */
-  provide: string | symbol | Type<any> | Abstract<any> | Function;
+  provide: InjectionToken;
   /**
    * Factory function that returns an instance of the provider to be injected.
    */
-  useFactory: (...args: any[]) => T;
+  useFactory: (...args: any[]) => T | Promise<T>;
   /**
    * Optional list of providers to be injected into the context of the Factory function.
    */
-  inject?: Array<Type<any> | string | symbol | Abstract<any> | Function>;
+  inject?: Array<InjectionToken | OptionalFactoryDependency>;
   /**
    * Optional enum defining lifetime of the provider that is returned by the Factory function.
    */
   scope?: Scope;
+  /**
+   * Flags provider as durable. This flag can be used in combination with custom context id
+   * factory strategy to construct lazy DI subtrees.
+   *
+   * This flag can be used only in conjunction with scope = Scope.REQUEST.
+   */
+  durable?: boolean;
 }
 
 /**
@@ -123,7 +150,7 @@ export interface FactoryProvider<T = any> {
  * };
  * ```
  *
- * @see [Use existing](https://docs.nestjs.com/fundamentals/custom-providers#use-existing)
+ * @see [Alias providers](https://docs.nestjs.com/fundamentals/custom-providers#alias-providers-useexisting)
  *
  * @publicApi
  */
@@ -131,7 +158,7 @@ export interface ExistingProvider<T = any> {
   /**
    * Injection token
    */
-  provide: string | symbol | Type<any> | Abstract<any> | Function;
+  provide: InjectionToken;
   /**
    * Provider to be aliased by the Injection token.
    */
diff --git a/packages/common/interfaces/nest-application-context-options.interface.ts b/packages/common/interfaces/nest-application-context-options.interface.ts
index 6126a1dc7..d5204b55d 100644
--- a/packages/common/interfaces/nest-application-context-options.interface.ts
+++ b/packages/common/interfaces/nest-application-context-options.interface.ts
@@ -25,8 +25,23 @@ export class NestApplicationContextOptions {
 
   /**
    * If enabled, logs will be automatically flushed and buffer detached when
-   * application initialisation process either completes or fails.
+   * application initialization process either completes or fails.
    * @default true
    */
   autoFlushLogs?: boolean;
+
+  /**
+   * Whether to run application in the preview mode.
+   * In the preview mode, providers/controllers are not instantiated & resolved.
+   *
+   * @default false
+   */
+  preview?: boolean;
+
+  /**
+   * Whether to generate a serialized graph snapshot.
+   *
+   * @default false
+   */
+  snapshot?: boolean;
 }
diff --git a/packages/common/interfaces/nest-application-context.interface.ts b/packages/common/interfaces/nest-application-context.interface.ts
index 47ec30cad..554fa1d1b 100644
--- a/packages/common/interfaces/nest-application-context.interface.ts
+++ b/packages/common/interfaces/nest-application-context.interface.ts
@@ -3,6 +3,20 @@ import { LoggerService, LogLevel } from '../services/logger.service';
 import { DynamicModule } from './modules';
 import { Type } from './type.interface';
 
+export interface GetOrResolveOptions {
+  /**
+   * If enabled, lookup will only be performed in the host module.
+   * @default false
+   */
+  strict?: boolean;
+  /**
+   * If enabled, instead of returning a first instance registered under a given token,
+   * a list of instances will be returned.
+   * @default false
+   */
+  each?: boolean;
+}
+
 /**
  * Interface defining NestApplicationContext.
  *
@@ -21,18 +35,74 @@ export interface INestApplicationContext {
    */
   get<TInput = any, TResult = TInput>(
     typeOrToken: Type<TInput> | Function | string | symbol,
-    options?: { strict: boolean },
   ): TResult;
+  /**
+   * Retrieves an instance of either injectable or controller, otherwise, throws exception.
+   * @returns {TResult}
+   */
+  get<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    options: { strict?: boolean; each?: undefined | false },
+  ): TResult;
+  /**
+   * Retrieves a list of instances of either injectables or controllers, otherwise, throws exception.
+   * @returns {Array<TResult>}
+   */
+  get<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    options: { strict?: boolean; each: true },
+  ): Array<TResult>;
+  /**
+   * Retrieves an instance (or a list of instances) of either injectable or controller, otherwise, throws exception.
+   * @returns {TResult | Array<TResult>}
+   */
+  get<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    options?: GetOrResolveOptions,
+  ): TResult | Array<TResult>;
 
   /**
    * Resolves transient or request-scoped instance of either injectable or controller, otherwise, throws exception.
-   * @returns {Promise<TResult>}
+   * @returns {Array<TResult>}
+   */
+  resolve<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+  ): Promise<TResult>;
+  /**
+   * Resolves transient or request-scoped instance of either injectable or controller, otherwise, throws exception.
+   * @returns {Array<TResult>}
+   */
+  resolve<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    contextId?: { id: number },
+  ): Promise<TResult>;
+  /**
+   * Resolves transient or request-scoped instance of either injectable or controller, otherwise, throws exception.
+   * @returns {Array<TResult>}
    */
   resolve<TInput = any, TResult = TInput>(
     typeOrToken: Type<TInput> | Function | string | symbol,
     contextId?: { id: number },
-    options?: { strict: boolean },
+    options?: { strict?: boolean; each?: undefined | false },
   ): Promise<TResult>;
+  /**
+   * Resolves transient or request-scoped instances of either injectables or controllers, otherwise, throws exception.
+   * @returns {Array<TResult>}
+   */
+  resolve<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    contextId?: { id: number },
+    options?: { strict?: boolean; each: true },
+  ): Promise<Array<TResult>>;
+  /**
+   * Resolves transient or request-scoped instance (or a list of instances) of either injectable or controller, otherwise, throws exception.
+   * @returns {Promise<TResult | Array<TResult>>}
+   */
+  resolve<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    contextId?: { id: number },
+    options?: GetOrResolveOptions,
+  ): Promise<TResult | Array<TResult>>;
 
   /**
    * Registers the request/context object for a given context ID (DI container sub-tree).
@@ -50,7 +120,8 @@ export interface INestApplicationContext {
   close(): Promise<void>;
 
   /**
-   * Sets custom logger service
+   * Sets custom logger service.
+   * Flushes buffered logs if auto flush is on.
    * @returns {void}
    */
   useLogger(logger: LoggerService | LogLevel[] | false): void;
@@ -71,7 +142,7 @@ export interface INestApplicationContext {
   enableShutdownHooks(signals?: ShutdownSignal[] | string[]): this;
 
   /**
-   * Initalizes the Nest application.
+   * Initializes the Nest application.
    * Calls the Nest lifecycle events.
    * It isn't mandatory to call this method directly.
    *
diff --git a/packages/common/interfaces/nest-application-options.interface.ts b/packages/common/interfaces/nest-application-options.interface.ts
index a21bfed98..5d4c89cbc 100644
--- a/packages/common/interfaces/nest-application-options.interface.ts
+++ b/packages/common/interfaces/nest-application-options.interface.ts
@@ -21,4 +21,13 @@ export interface NestApplicationOptions extends NestApplicationContextOptions {
    * Set of configurable HTTPS options
    */
   httpsOptions?: HttpsOptions;
+  /**
+   * Whether to register the raw request body on the request. Use `req.rawBody`.
+   */
+  rawBody?: boolean;
+  /**
+   * Force close open HTTP connections. Useful if restarting your application hangs due to
+   * keep-alive connections in the HTTP adapter.
+   */
+  forceCloseConnections?: boolean;
 }
diff --git a/packages/common/interfaces/nest-application.interface.ts b/packages/common/interfaces/nest-application.interface.ts
index ec04c5180..eb2167e64 100644
--- a/packages/common/interfaces/nest-application.interface.ts
+++ b/packages/common/interfaces/nest-application.interface.ts
@@ -21,7 +21,8 @@ import { WebSocketAdapter } from './websockets/web-socket-adapter.interface';
  *
  * @publicApi
  */
-export interface INestApplication extends INestApplicationContext {
+export interface INestApplication<TServer = any>
+  extends INestApplicationContext {
   /**
    * A wrapper function around HTTP adapter method: `adapter.use()`.
    * Example `app.use(cors())`
@@ -61,16 +62,6 @@ export interface INestApplication extends INestApplicationContext {
     callback?: () => void,
   ): Promise<any>;
 
-  /**
-   * Starts the application (can be awaited).
-   * @deprecated use "listen" instead.
-   *
-   * @param {number|string} port
-   * @param {string} [hostname]
-   * @returns {Promise}
-   */
-  listenAsync(port: number | string, hostname?: string): Promise<any>;
-
   /**
    * Returns the url the application is listening at, based on OS and IP version. Returns as an IP value either in IPv6 or IPv4
    *
@@ -120,9 +111,9 @@ export interface INestApplication extends INestApplicationContext {
   /**
    * Returns the underlying native HTTP server.
    *
-   * @returns {*}
+   * @returns {TServer}
    */
-  getHttpServer(): any;
+  getHttpServer(): TServer;
 
   /**
    * Returns the underlying HTTP adapter.
@@ -138,14 +129,6 @@ export interface INestApplication extends INestApplicationContext {
    */
   startAllMicroservices(): Promise<this>;
 
-  /**
-   * Starts all connected microservices and can be awaited.
-   * @deprecated use "startAllMicroservices" instead.
-   *
-   * @returns {Promise}
-   */
-  startAllMicroservicesAsync(): Promise<this>;
-
   /**
    * Registers exception filters as global filters (will be used within
    * every HTTP route handler)
diff --git a/packages/common/interfaces/nest-microservice.interface.ts b/packages/common/interfaces/nest-microservice.interface.ts
index 857f1d66c..025c331bc 100644
--- a/packages/common/interfaces/nest-microservice.interface.ts
+++ b/packages/common/interfaces/nest-microservice.interface.ts
@@ -18,14 +18,6 @@ export interface INestMicroservice extends INestApplicationContext {
    */
   listen(): Promise<any>;
 
-  /**
-   * Starts the microservice (can be awaited).
-   * @deprecated use "listen" instead.
-   *
-   * @returns {Promise}
-   */
-  listenAsync(): Promise<any>;
-
   /**
    * Register Ws Adapter which will be used inside Gateways.
    * Use when you want to override default `socket.io` library.
diff --git a/packages/common/interfaces/scope-options.interface.ts b/packages/common/interfaces/scope-options.interface.ts
index f958c393b..4cca74275 100644
--- a/packages/common/interfaces/scope-options.interface.ts
+++ b/packages/common/interfaces/scope-options.interface.ts
@@ -28,4 +28,11 @@ export interface ScopeOptions {
    * Specifies the lifetime of an injected Provider or Controller.
    */
   scope?: Scope;
+  /**
+   * Flags provider as durable. This flag can be used in combination with custom context id
+   * factory strategy to construct lazy DI subtrees.
+   *
+   * This flag can be used only in conjunction with scope = Scope.REQUEST.
+   */
+  durable?: boolean;
 }
diff --git a/packages/common/interfaces/version-options.interface.ts b/packages/common/interfaces/version-options.interface.ts
index 3c214e64a..fc5a53b6e 100644
--- a/packages/common/interfaces/version-options.interface.ts
+++ b/packages/common/interfaces/version-options.interface.ts
@@ -7,7 +7,13 @@ import { VersioningType } from '../enums/version-type.enum';
  */
 export const VERSION_NEUTRAL = Symbol('VERSION_NEUTRAL');
 
-export type VersionValue = string | string[] | typeof VERSION_NEUTRAL;
+/**
+ * @publicApi
+ */
+export type VersionValue =
+  | string
+  | typeof VERSION_NEUTRAL
+  | Array<string | typeof VERSION_NEUTRAL>;
 
 /**
  * @publicApi
@@ -15,7 +21,7 @@ export type VersionValue = string | string[] | typeof VERSION_NEUTRAL;
 export interface VersionOptions {
   /**
    * Specifies an optional API Version. When configured, methods
-   * withing the controller will only be routed if the request version
+   * within the controller will only be routed if the request version
    * matches the specified value.
    *
    * Supported only by HTTP-based applications (does not apply to non-HTTP microservices).
@@ -25,6 +31,9 @@ export interface VersionOptions {
   version?: VersionValue;
 }
 
+/**
+ * @publicApi
+ */
 export interface HeaderVersioningOptions {
   type: VersioningType.HEADER;
   /**
@@ -33,6 +42,9 @@ export interface HeaderVersioningOptions {
   header: string;
 }
 
+/**
+ * @publicApi
+ */
 export interface UriVersioningOptions {
   type: VersioningType.URI;
   /**
@@ -45,6 +57,9 @@ export interface UriVersioningOptions {
   prefix?: string | false;
 }
 
+/**
+ * @publicApi
+ */
 export interface MediaTypeVersioningOptions {
   type: VersioningType.MEDIA_TYPE;
   /**
@@ -55,6 +70,26 @@ export interface MediaTypeVersioningOptions {
   key: string;
 }
 
+/**
+ * @publicApi
+ */
+export interface CustomVersioningOptions {
+  type: VersioningType.CUSTOM;
+
+  /**
+   * A function that accepts a request object (specific to the underlying platform, ie Express or Fastify)
+   * and returns a single version value or an ordered array of versions, in order from HIGHEST to LOWEST.
+   *
+   * Ex. Returned version array = ['3.1', '3.0', '2.5', '2', '1.9']
+   *
+   * Use type assertion or narrowing to identify the specific request type.
+   */
+  extractor: (request: unknown) => string | string[];
+}
+
+/**
+ * @publicApi
+ */
 interface VersioningCommonOptions {
   /**
    * The default version to be used as a fallback when you did not provide some
@@ -67,4 +102,9 @@ interface VersioningCommonOptions {
  * @publicApi
  */
 export type VersioningOptions = VersioningCommonOptions &
-  (HeaderVersioningOptions | UriVersioningOptions | MediaTypeVersioningOptions);
+  (
+    | HeaderVersioningOptions
+    | UriVersioningOptions
+    | MediaTypeVersioningOptions
+    | CustomVersioningOptions
+  );
diff --git a/packages/common/interfaces/websockets/web-socket-adapter.interface.ts b/packages/common/interfaces/websockets/web-socket-adapter.interface.ts
index 4b1585672..e3baa1272 100644
--- a/packages/common/interfaces/websockets/web-socket-adapter.interface.ts
+++ b/packages/common/interfaces/websockets/web-socket-adapter.interface.ts
@@ -1,10 +1,16 @@
 import { Observable } from 'rxjs';
 
+/**
+ * @publicApi
+ */
 export interface WsMessageHandler<T = string> {
   message: T;
   callback: (...args: any[]) => Observable<any> | Promise<any>;
 }
 
+/**
+ * @publicApi
+ */
 export interface WebSocketAdapter<
   TServer = any,
   TClient = any,
diff --git a/packages/common/module-utils/configurable-module.builder.ts b/packages/common/module-utils/configurable-module.builder.ts
new file mode 100644
index 000000000..17735f4ad
--- /dev/null
+++ b/packages/common/module-utils/configurable-module.builder.ts
@@ -0,0 +1,345 @@
+import { DynamicModule, Provider } from '../interfaces';
+import { Logger } from '../services/logger.service';
+import { randomStringGenerator } from '../utils/random-string-generator.util';
+import {
+  ASYNC_METHOD_SUFFIX,
+  CONFIGURABLE_MODULE_ID,
+  DEFAULT_FACTORY_CLASS_METHOD_KEY,
+  DEFAULT_METHOD_KEY,
+} from './constants';
+import {
+  ConfigurableModuleAsyncOptions,
+  ConfigurableModuleCls,
+  ConfigurableModuleHost,
+  ConfigurableModuleOptionsFactory,
+} from './interfaces';
+import { generateOptionsInjectionToken, getInjectionProviders } from './utils';
+
+/**
+ * @publicApi
+ */
+export interface ConfigurableModuleBuilderOptions {
+  /**
+   * Specified what injection token should be used for the module options provider.
+   * By default, an auto-generated UUID will be used.
+   */
+  optionsInjectionToken?: string | symbol;
+  /**
+   * By default, an UUID will be used as a module options provider token.
+   * Explicitly specifying the "moduleName" will instruct the "ConfigurableModuleBuilder"
+   * to use a more descriptive provider token.
+   *
+   * For example, if `moduleName: "Cache"` then auto-generated provider token will be "CACHE_MODULE_OPTIONS".
+   */
+  moduleName?: string;
+  /**
+   * Indicates whether module should always be "transient", meaning,
+   * every time you call the static method to construct a dynamic module,
+   * regardless of what arguments you pass in, a new "unique" module will be created.
+   *
+   * @default false
+   */
+  alwaysTransient?: boolean;
+}
+
+/**
+ * Factory that lets you create configurable modules and
+ * provides a way to reduce the majority of dynamic module boilerplate.
+ *
+ * @publicApi
+ */
+export class ConfigurableModuleBuilder<
+  ModuleOptions,
+  StaticMethodKey extends string = typeof DEFAULT_METHOD_KEY,
+  FactoryClassMethodKey extends string = typeof DEFAULT_FACTORY_CLASS_METHOD_KEY,
+  ExtraModuleDefinitionOptions = {},
+> {
+  protected staticMethodKey: StaticMethodKey;
+  protected factoryClassMethodKey: FactoryClassMethodKey;
+  protected extras: ExtraModuleDefinitionOptions;
+  protected transformModuleDefinition: (
+    definition: DynamicModule,
+    extraOptions: ExtraModuleDefinitionOptions,
+  ) => DynamicModule;
+
+  protected readonly logger = new Logger(ConfigurableModuleBuilder.name);
+
+  constructor(
+    protected readonly options: ConfigurableModuleBuilderOptions = {},
+    parentBuilder?: ConfigurableModuleBuilder<ModuleOptions>,
+  ) {
+    if (parentBuilder) {
+      this.staticMethodKey = parentBuilder.staticMethodKey as StaticMethodKey;
+      this.factoryClassMethodKey =
+        parentBuilder.factoryClassMethodKey as FactoryClassMethodKey;
+      this.transformModuleDefinition = parentBuilder.transformModuleDefinition;
+      this.extras = parentBuilder.extras as ExtraModuleDefinitionOptions;
+    }
+  }
+
+  /**
+   * Registers the "extras" object (a set of extra options that can be used to modify the dynamic module definition).
+   * Values you specify within the "extras" object will be used as default values (that can be overridden by module consumers).
+   *
+   * This method also applies the so-called "module definition transform function" that takes the auto-generated
+   * dynamic module object ("DynamicModule") and the actual consumer "extras" object as input parameters.
+   * The "extras" object consists of values explicitly specified by module consumers and default values.
+   *
+   * @example
+   * ```typescript
+   * .setExtras<{ isGlobal?: boolean }>({ isGlobal: false }, (definition, extras) =>
+   *    ({ ...definition, global: extras.isGlobal })
+   * )
+   * ```
+   */
+  setExtras<ExtraModuleDefinitionOptions>(
+    extras: ExtraModuleDefinitionOptions,
+    transformDefinition: (
+      definition: DynamicModule,
+      extras: ExtraModuleDefinitionOptions,
+    ) => DynamicModule = def => def,
+  ) {
+    const builder = new ConfigurableModuleBuilder<
+      ModuleOptions,
+      StaticMethodKey,
+      FactoryClassMethodKey,
+      ExtraModuleDefinitionOptions
+    >(this.options, this as any);
+    builder.extras = extras;
+    builder.transformModuleDefinition = transformDefinition;
+    return builder;
+  }
+
+  /**
+   * Dynamic modules must expose public static methods that let you pass in
+   * configuration parameters (control the module's behavior from the outside).
+   * Some frequently used names that you may have seen in other modules are:
+   * "forRoot", "forFeature", "register", "configure".
+   *
+   * This method "setClassMethodName" lets you specify the name of the
+   * method that will be auto-generated.
+   *
+   * @param key name of the method
+   */
+  setClassMethodName<StaticMethodKey extends string>(key: StaticMethodKey) {
+    const builder = new ConfigurableModuleBuilder<
+      ModuleOptions,
+      StaticMethodKey,
+      FactoryClassMethodKey,
+      ExtraModuleDefinitionOptions
+    >(this.options, this as any);
+    builder.staticMethodKey = key;
+    return builder;
+  }
+
+  /**
+   * Asynchronously configured modules (that rely on other modules, i.e. "ConfigModule")
+   * let you pass the configuration factory class that will be registered and instantiated as a provider.
+   * This provider then will be used to retrieve the module's configuration. To provide the configuration,
+   * the corresponding factory method must be implemented.
+   *
+   * This method ("setFactoryMethodName") lets you control what method name will have to be
+   * implemented by the config factory (default is "create").
+   *
+   * @param key name of the method
+   */
+  setFactoryMethodName<FactoryClassMethodKey extends string>(
+    key: FactoryClassMethodKey,
+  ) {
+    const builder = new ConfigurableModuleBuilder<
+      ModuleOptions,
+      StaticMethodKey,
+      FactoryClassMethodKey,
+      ExtraModuleDefinitionOptions
+    >(this.options, this as any);
+    builder.factoryClassMethodKey = key;
+    return builder;
+  }
+
+  /**
+   * Returns an object consisting of multiple properties that lets you
+   * easily construct dynamic configurable modules. See "ConfigurableModuleHost" interface for more details.
+   */
+  build(): ConfigurableModuleHost<
+    ModuleOptions,
+    StaticMethodKey,
+    FactoryClassMethodKey,
+    ExtraModuleDefinitionOptions
+  > {
+    this.staticMethodKey ??= DEFAULT_METHOD_KEY as StaticMethodKey;
+    this.factoryClassMethodKey ??=
+      DEFAULT_FACTORY_CLASS_METHOD_KEY as FactoryClassMethodKey;
+    this.options.optionsInjectionToken ??= this.options.moduleName
+      ? this.constructInjectionTokenString()
+      : generateOptionsInjectionToken();
+    this.transformModuleDefinition ??= definition => definition;
+
+    return {
+      ConfigurableModuleClass:
+        this.createConfigurableModuleCls<ModuleOptions>(),
+      MODULE_OPTIONS_TOKEN: this.options.optionsInjectionToken,
+      ASYNC_OPTIONS_TYPE: this.createTypeProxy('ASYNC_OPTIONS_TYPE'),
+      OPTIONS_TYPE: this.createTypeProxy('OPTIONS_TYPE'),
+    };
+  }
+
+  private constructInjectionTokenString(): string {
+    const moduleNameInSnakeCase = this.options.moduleName
+      .trim()
+      .split(/(?=[A-Z])/)
+      .join('_')
+      .toUpperCase();
+    return `${moduleNameInSnakeCase}_MODULE_OPTIONS`;
+  }
+
+  private createConfigurableModuleCls<ModuleOptions>(): ConfigurableModuleCls<
+    ModuleOptions,
+    StaticMethodKey,
+    FactoryClassMethodKey
+  > {
+    // eslint-disable-next-line @typescript-eslint/no-this-alias
+    const self = this;
+    const asyncMethodKey = this.staticMethodKey + ASYNC_METHOD_SUFFIX;
+
+    class InternalModuleClass {
+      static [self.staticMethodKey](
+        options: ModuleOptions & ExtraModuleDefinitionOptions,
+      ): DynamicModule {
+        const providers: Array<Provider> = [
+          {
+            provide: self.options.optionsInjectionToken,
+            useValue: this.omitExtras(options, self.extras),
+          },
+        ];
+        if (self.options.alwaysTransient) {
+          providers.push({
+            provide: CONFIGURABLE_MODULE_ID,
+            useValue: randomStringGenerator(),
+          });
+        }
+        return self.transformModuleDefinition(
+          {
+            module: this,
+            providers,
+          },
+          {
+            ...self.extras,
+            ...options,
+          },
+        );
+      }
+
+      static [asyncMethodKey](
+        options: ConfigurableModuleAsyncOptions<ModuleOptions> &
+          ExtraModuleDefinitionOptions,
+      ): DynamicModule {
+        const providers = this.createAsyncProviders(options);
+        if (self.options.alwaysTransient) {
+          providers.push({
+            provide: CONFIGURABLE_MODULE_ID,
+            useValue: randomStringGenerator(),
+          });
+        }
+        return self.transformModuleDefinition(
+          {
+            module: this,
+            imports: options.imports || [],
+            providers,
+          },
+          {
+            ...self.extras,
+            ...options,
+          },
+        );
+      }
+
+      private static omitExtras(
+        input: ModuleOptions & ExtraModuleDefinitionOptions,
+        extras: ExtraModuleDefinitionOptions | undefined,
+      ): ModuleOptions {
+        if (!extras) {
+          return input;
+        }
+        const moduleOptions = {};
+        const extrasKeys = Object.keys(extras);
+
+        Object.keys(input)
+          .filter(key => !extrasKeys.includes(key))
+          .forEach(key => {
+            moduleOptions[key] = input[key];
+          });
+        return moduleOptions as ModuleOptions;
+      }
+
+      private static createAsyncProviders(
+        options: ConfigurableModuleAsyncOptions<ModuleOptions>,
+      ): Provider[] {
+        if (options.useExisting || options.useFactory) {
+          if (options.inject && options.provideInjectionTokensFrom) {
+            return [
+              this.createAsyncOptionsProvider(options),
+              ...getInjectionProviders(
+                options.provideInjectionTokensFrom,
+                options.inject,
+              ),
+            ];
+          }
+          return [this.createAsyncOptionsProvider(options)];
+        }
+        return [
+          this.createAsyncOptionsProvider(options),
+          {
+            provide: options.useClass,
+            useClass: options.useClass,
+          },
+        ];
+      }
+
+      private static createAsyncOptionsProvider(
+        options: ConfigurableModuleAsyncOptions<ModuleOptions>,
+      ): Provider {
+        if (options.useFactory) {
+          return {
+            provide: self.options.optionsInjectionToken,
+            useFactory: options.useFactory,
+            inject: options.inject || [],
+          };
+        }
+        return {
+          provide: self.options.optionsInjectionToken,
+          useFactory: async (
+            optionsFactory: ConfigurableModuleOptionsFactory<
+              ModuleOptions,
+              FactoryClassMethodKey
+            >,
+          ) =>
+            await optionsFactory[
+              self.factoryClassMethodKey as keyof typeof optionsFactory
+            ](),
+          inject: [options.useExisting || options.useClass],
+        };
+      }
+    }
+    return InternalModuleClass as unknown as ConfigurableModuleCls<
+      ModuleOptions,
+      StaticMethodKey,
+      FactoryClassMethodKey
+    >;
+  }
+
+  private createTypeProxy(
+    typeName: 'OPTIONS_TYPE' | 'ASYNC_OPTIONS_TYPE' | 'OptionsFactoryInterface',
+  ) {
+    const proxy = new Proxy(
+      {},
+      {
+        get: () => {
+          throw new Error(
+            `"${typeName}" is not supposed to be used as a value.`,
+          );
+        },
+      },
+    );
+    return proxy as any;
+  }
+}
diff --git a/packages/common/module-utils/constants.ts b/packages/common/module-utils/constants.ts
new file mode 100644
index 000000000..2d97c0c8c
--- /dev/null
+++ b/packages/common/module-utils/constants.ts
@@ -0,0 +1,5 @@
+export const DEFAULT_METHOD_KEY = 'register';
+export const DEFAULT_FACTORY_CLASS_METHOD_KEY = 'create';
+
+export const ASYNC_METHOD_SUFFIX = 'Async';
+export const CONFIGURABLE_MODULE_ID = 'CONFIGURABLE_MODULE_ID';
diff --git a/packages/common/module-utils/index.ts b/packages/common/module-utils/index.ts
new file mode 100644
index 000000000..4393992bd
--- /dev/null
+++ b/packages/common/module-utils/index.ts
@@ -0,0 +1,2 @@
+export * from './configurable-module.builder';
+export * from './interfaces';
diff --git a/packages/common/module-utils/interfaces/configurable-module-async-options.interface.ts b/packages/common/module-utils/interfaces/configurable-module-async-options.interface.ts
new file mode 100644
index 000000000..ed1ec6288
--- /dev/null
+++ b/packages/common/module-utils/interfaces/configurable-module-async-options.interface.ts
@@ -0,0 +1,62 @@
+import {
+  FactoryProvider,
+  ModuleMetadata,
+  Provider,
+  Type,
+} from '../../interfaces';
+import { DEFAULT_FACTORY_CLASS_METHOD_KEY } from '../constants';
+
+/**
+ * Interface that must be implemented by the module options factory class.
+ * Method key varies depending on the "FactoryClassMethodKey" type argument.
+ *
+ * @publicApi
+ */
+export type ConfigurableModuleOptionsFactory<
+  ModuleOptions,
+  FactoryClassMethodKey extends string,
+> = Record<
+  `${FactoryClassMethodKey}`,
+  () => Promise<ModuleOptions> | ModuleOptions
+>;
+
+/**
+ * Interface that represents the module async options object
+ * Factory method name varies depending on the "FactoryClassMethodKey" type argument.
+ *
+ * @publicApi
+ */
+export interface ConfigurableModuleAsyncOptions<
+  ModuleOptions,
+  FactoryClassMethodKey extends string = typeof DEFAULT_FACTORY_CLASS_METHOD_KEY,
+> extends Pick<ModuleMetadata, 'imports'> {
+  /**
+   * Injection token resolving to an existing provider. The provider must implement
+   * the corresponding interface.
+   */
+  useExisting?: Type<
+    ConfigurableModuleOptionsFactory<ModuleOptions, FactoryClassMethodKey>
+  >;
+  /**
+   * Injection token resolving to a class that will be instantiated as a provider.
+   * The class must implement the corresponding interface.
+   */
+  useClass?: Type<
+    ConfigurableModuleOptionsFactory<ModuleOptions, FactoryClassMethodKey>
+  >;
+  /**
+   * Function returning options (or a Promise resolving to options) to configure the
+   * cache module.
+   */
+  useFactory?: (...args: any[]) => Promise<ModuleOptions> | ModuleOptions;
+  /**
+   * Dependencies that a Factory may inject.
+   */
+  inject?: FactoryProvider['inject'];
+  /**
+   * List of parent module's providers that will be filtered to only provide necessary
+   * providers for the 'inject' array
+   * useful to pass options to nested async modules
+   */
+  provideInjectionTokensFrom?: Provider[];
+}
diff --git a/packages/common/module-utils/interfaces/configurable-module-cls.interface.ts b/packages/common/module-utils/interfaces/configurable-module-cls.interface.ts
new file mode 100644
index 000000000..0335bda2c
--- /dev/null
+++ b/packages/common/module-utils/interfaces/configurable-module-cls.interface.ts
@@ -0,0 +1,37 @@
+import { DynamicModule } from '../../interfaces';
+import {
+  DEFAULT_FACTORY_CLASS_METHOD_KEY,
+  DEFAULT_METHOD_KEY,
+} from '../constants';
+import { ConfigurableModuleAsyncOptions } from './configurable-module-async-options.interface';
+
+/**
+ * Class that represents a blueprint/prototype for a configurable Nest module.
+ * This class provides static methods for constructing dynamic modules. Their names
+ * can be controlled through the "MethodKey" type argument.
+ *
+ * @publicApi
+ */
+export type ConfigurableModuleCls<
+  ModuleOptions,
+  MethodKey extends string = typeof DEFAULT_METHOD_KEY,
+  FactoryClassMethodKey extends string = typeof DEFAULT_FACTORY_CLASS_METHOD_KEY,
+  ExtraModuleDefinitionOptions = {},
+> = {
+  new (): any;
+} & Record<
+  `${MethodKey}`,
+  (
+    options: ModuleOptions & Partial<ExtraModuleDefinitionOptions>,
+  ) => DynamicModule
+> &
+  Record<
+    `${MethodKey}Async`,
+    (
+      options: ConfigurableModuleAsyncOptions<
+        ModuleOptions,
+        FactoryClassMethodKey
+      > &
+        Partial<ExtraModuleDefinitionOptions>,
+    ) => DynamicModule
+  >;
diff --git a/packages/common/module-utils/interfaces/configurable-module-host.interface.ts b/packages/common/module-utils/interfaces/configurable-module-host.interface.ts
new file mode 100644
index 000000000..c20654d73
--- /dev/null
+++ b/packages/common/module-utils/interfaces/configurable-module-host.interface.ts
@@ -0,0 +1,77 @@
+import { ConfigurableModuleAsyncOptions } from './configurable-module-async-options.interface';
+import { ConfigurableModuleCls } from './configurable-module-cls.interface';
+
+/**
+ * Configurable module host. See properties for more details
+ *
+ * @publicApi
+ */
+export interface ConfigurableModuleHost<
+  ModuleOptions = Record<string, unknown>,
+  MethodKey extends string = string,
+  FactoryClassMethodKey extends string = string,
+  ExtraModuleDefinitionOptions = {},
+> {
+  /**
+   * Class that represents a blueprint/prototype for a configurable Nest module.
+   * This class provides static methods for constructing dynamic modules. Their names
+   * can be controlled through the "MethodKey" type argument.
+   *
+   * Your module class should inherit from this class to make the static methods available.
+   *
+   * @example
+   * ```typescript
+   * @Module({})
+   * class IntegrationModule extends ConfigurableModuleCls {
+   *  // ...
+   * }
+   * ```
+   */
+  ConfigurableModuleClass: ConfigurableModuleCls<
+    ModuleOptions,
+    MethodKey,
+    FactoryClassMethodKey,
+    ExtraModuleDefinitionOptions
+  >;
+  /**
+   * Module options provider token. Can be used to inject the "options object" to
+   * providers registered within the host module.
+   */
+  MODULE_OPTIONS_TOKEN: string | symbol;
+  /**
+   * Can be used to auto-infer the compound "async module options" type.
+   * Note: this property is not supposed to be used as a value.
+   *
+   * @example
+   * ```typescript
+   * @Module({})
+   * class IntegrationModule extends ConfigurableModuleCls {
+   *  static module = initializer(IntegrationModule);
+   *
+   * static registerAsync(options: typeof ASYNC_OPTIONS_TYPE): DynamicModule {
+   *  return super.registerAsync(options);
+   * }
+   * ```
+   */
+  ASYNC_OPTIONS_TYPE: ConfigurableModuleAsyncOptions<
+    ModuleOptions,
+    FactoryClassMethodKey
+  > &
+    Partial<ExtraModuleDefinitionOptions>;
+  /**
+   * Can be used to auto-infer the compound "module options" type (options interface + extra module definition options).
+   * Note: this property is not supposed to be used as a value.
+   *
+   * @example
+   * ```typescript
+   * @Module({})
+   * class IntegrationModule extends ConfigurableModuleCls {
+   *  static module = initializer(IntegrationModule);
+   *
+   * static register(options: typeof OPTIONS_TYPE): DynamicModule {
+   *  return super.register(options);
+   * }
+   * ```
+   */
+  OPTIONS_TYPE: ModuleOptions & Partial<ExtraModuleDefinitionOptions>;
+}
diff --git a/packages/common/module-utils/interfaces/index.ts b/packages/common/module-utils/interfaces/index.ts
new file mode 100644
index 000000000..35c523076
--- /dev/null
+++ b/packages/common/module-utils/interfaces/index.ts
@@ -0,0 +1,3 @@
+export * from './configurable-module-async-options.interface';
+export * from './configurable-module-cls.interface';
+export * from './configurable-module-host.interface';
diff --git a/packages/common/module-utils/utils/generate-options-injection-token.util.ts b/packages/common/module-utils/utils/generate-options-injection-token.util.ts
new file mode 100644
index 000000000..259a6afa3
--- /dev/null
+++ b/packages/common/module-utils/utils/generate-options-injection-token.util.ts
@@ -0,0 +1,6 @@
+import { randomStringGenerator } from '../../utils/random-string-generator.util';
+
+export function generateOptionsInjectionToken() {
+  const hash = randomStringGenerator();
+  return `CONFIGURABLE_MODULE_OPTIONS[${hash}]`;
+}
diff --git a/packages/common/module-utils/utils/get-injection-providers.util.ts b/packages/common/module-utils/utils/get-injection-providers.util.ts
new file mode 100644
index 000000000..26743580b
--- /dev/null
+++ b/packages/common/module-utils/utils/get-injection-providers.util.ts
@@ -0,0 +1,50 @@
+import {
+  InjectionToken,
+  Provider,
+  FactoryProvider,
+  OptionalFactoryDependency,
+} from '../../interfaces';
+
+/**
+ * check if x is OptionalFactoryDependency, based on prototype presence
+ * (to avoid classes with a static 'token' field)
+ * @param x
+ * @returns x is OptionalFactoryDependency
+ */
+function isOptionalFactoryDependency(
+  x: InjectionToken | OptionalFactoryDependency,
+): x is OptionalFactoryDependency {
+  return !!((x as any)?.token && !(x as any)?.prototype);
+}
+
+const mapInjectToTokens = (t: InjectionToken | OptionalFactoryDependency) =>
+  isOptionalFactoryDependency(t) ? t.token : t;
+
+/**
+ *
+ * @param providers List of a module's providers
+ * @param tokens Injection tokens needed for a useFactory function (usually the module's options' token)
+ * @returns All the providers needed for the tokens' injection (searched recursively)
+ */
+export function getInjectionProviders(
+  providers: Provider[],
+  tokens: FactoryProvider['inject'],
+): Provider[] {
+  const result: Provider[] = [];
+  let search: InjectionToken[] = tokens.map(mapInjectToTokens);
+  while (search.length > 0) {
+    const match = (providers ?? []).filter(
+      p =>
+        !result.includes(p) && // this prevents circular loops and duplication
+        (search.includes(p as any) || search.includes((p as any)?.provide)),
+    );
+    result.push(...match);
+    // get injection tokens of the matched providers, if any
+    search = match
+      .filter(p => (p as any)?.inject)
+      .map(p => (p as FactoryProvider).inject)
+      .flat()
+      .map(mapInjectToTokens);
+  }
+  return result;
+}
diff --git a/packages/common/module-utils/utils/index.ts b/packages/common/module-utils/utils/index.ts
new file mode 100644
index 000000000..7125be0f7
--- /dev/null
+++ b/packages/common/module-utils/utils/index.ts
@@ -0,0 +1,2 @@
+export * from './generate-options-injection-token.util';
+export * from './get-injection-providers.util';
diff --git a/packages/common/package.json b/packages/common/package.json
index 3d75eef42..697002f7a 100644
--- a/packages/common/package.json
+++ b/packages/common/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/common",
-  "version": "8.2.3",
+  "version": "9.4.0",
   "description": "Nest - modern, fast, powerful node.js web framework (@common)",
   "author": "Kamil Mysliwiec",
   "homepage": "https://nestjs.com",
@@ -17,22 +17,17 @@
   },
   "license": "MIT",
   "dependencies": {
-    "axios": "0.24.0",
     "iterare": "1.2.1",
-    "tslib": "2.3.1",
-    "uuid": "8.3.2"
+    "tslib": "2.5.0",
+    "uid": "2.0.2"
   },
   "peerDependencies": {
-    "cache-manager": "*",
     "class-transformer": "*",
     "class-validator": "*",
     "reflect-metadata": "^0.1.12",
     "rxjs": "^7.1.0"
   },
   "peerDependenciesMeta": {
-    "cache-manager": {
-      "optional": true
-    },
     "class-validator": {
       "optional": true
     },
diff --git a/packages/common/pipes/default-value.pipe.ts b/packages/common/pipes/default-value.pipe.ts
index ee99ecc2f..65716f497 100644
--- a/packages/common/pipes/default-value.pipe.ts
+++ b/packages/common/pipes/default-value.pipe.ts
@@ -3,7 +3,7 @@ import {
   ArgumentMetadata,
   PipeTransform,
 } from '../interfaces/features/pipe-transform.interface';
-import { isNil } from '../utils/shared.utils';
+import { isNil, isNumber } from '../utils/shared.utils';
 
 /**
  * Defines the built-in DefaultValue Pipe
@@ -16,12 +16,12 @@ import { isNil } from '../utils/shared.utils';
 export class DefaultValuePipe<T = any, R = any>
   implements PipeTransform<T, T | R>
 {
-  constructor(private readonly defaultValue: R) {}
+  constructor(protected readonly defaultValue: R) {}
 
   transform(value?: T, _metadata?: ArgumentMetadata): T | R {
     if (
       isNil(value) ||
-      (typeof value === 'number' && isNaN(value as unknown as number))
+      (isNumber(value) && isNaN(value as unknown as number))
     ) {
       return this.defaultValue;
     }
diff --git a/packages/common/pipes/file/file-type.validator.ts b/packages/common/pipes/file/file-type.validator.ts
new file mode 100644
index 000000000..ffc3e54c5
--- /dev/null
+++ b/packages/common/pipes/file/file-type.validator.ts
@@ -0,0 +1,34 @@
+import { FileValidator } from './file-validator.interface';
+import { IFile } from './interfaces';
+
+export type FileTypeValidatorOptions = {
+  fileType: string | RegExp;
+};
+
+/**
+ * Defines the built-in FileType File Validator. It validates incoming files mime-type
+ * matching a string or a regular expression. Note that this validator uses a naive strategy
+ * to check the mime-type and could be fooled if the client provided a file with renamed extension.
+ * (for instance, renaming a 'malicious.bat' to 'malicious.jpeg'). To handle such security issues
+ * with more reliability, consider checking against the file's [magic-numbers](https://en.wikipedia.org/wiki/Magic_number_%28programming%29)
+ *
+ * @see [File Validators](https://docs.nestjs.com/techniques/file-upload#validators)
+ *
+ * @publicApi
+ */
+export class FileTypeValidator extends FileValidator<FileTypeValidatorOptions> {
+  buildErrorMessage(): string {
+    return `Validation failed (expected type is ${this.validationOptions.fileType})`;
+  }
+
+  isValid<TFile extends IFile = any>(file: TFile): boolean {
+    if (!this.validationOptions) {
+      return true;
+    }
+
+    return (
+      'mimetype' in file &&
+      !!file.mimetype.match(this.validationOptions.fileType)
+    );
+  }
+}
diff --git a/packages/common/pipes/file/file-validator.interface.ts b/packages/common/pipes/file/file-validator.interface.ts
new file mode 100644
index 000000000..bf43c0b6a
--- /dev/null
+++ b/packages/common/pipes/file/file-validator.interface.ts
@@ -0,0 +1,25 @@
+import { IFile } from './interfaces';
+
+/**
+ * Interface describing FileValidators, which can be added to a ParseFilePipe
+ *
+ * @see {ParseFilePipe}
+ * @publicApi
+ */
+export abstract class FileValidator<TValidationOptions = Record<string, any>> {
+  constructor(protected readonly validationOptions: TValidationOptions) {}
+
+  /**
+   * Indicates if this file should be considered valid, according to the options passed in the constructor.
+   * @param file the file from the request object
+   */
+  abstract isValid<TFile extends IFile = any>(
+    file?: TFile,
+  ): boolean | Promise<boolean>;
+
+  /**
+   * Builds an error message in case the validation fails.
+   * @param file the file from the request object
+   */
+  abstract buildErrorMessage(file: any): string;
+}
diff --git a/packages/common/pipes/file/index.ts b/packages/common/pipes/file/index.ts
new file mode 100644
index 000000000..11d19e318
--- /dev/null
+++ b/packages/common/pipes/file/index.ts
@@ -0,0 +1,6 @@
+export * from './file-type.validator';
+export * from './file-validator.interface';
+export * from './max-file-size.validator';
+export * from './parse-file-options.interface';
+export * from './parse-file.pipe';
+export * from './parse-file-pipe.builder';
diff --git a/packages/common/pipes/file/interfaces/file.interface.ts b/packages/common/pipes/file/interfaces/file.interface.ts
new file mode 100644
index 000000000..37218734f
--- /dev/null
+++ b/packages/common/pipes/file/interfaces/file.interface.ts
@@ -0,0 +1,4 @@
+export interface IFile {
+  mimetype: string;
+  size: number;
+}
diff --git a/packages/common/pipes/file/interfaces/index.ts b/packages/common/pipes/file/interfaces/index.ts
new file mode 100644
index 000000000..09d8f3ca8
--- /dev/null
+++ b/packages/common/pipes/file/interfaces/index.ts
@@ -0,0 +1 @@
+export * from './file.interface';
diff --git a/packages/common/pipes/file/max-file-size.validator.ts b/packages/common/pipes/file/max-file-size.validator.ts
new file mode 100644
index 000000000..c6274de91
--- /dev/null
+++ b/packages/common/pipes/file/max-file-size.validator.ts
@@ -0,0 +1,27 @@
+import { FileValidator } from './file-validator.interface';
+import { IFile } from './interfaces';
+
+export type MaxFileSizeValidatorOptions = {
+  maxSize: number;
+};
+
+/**
+ * Defines the built-in MaxSize File Validator
+ *
+ * @see [File Validators](https://docs.nestjs.com/techniques/file-upload#file-validation)
+ *
+ * @publicApi
+ */
+export class MaxFileSizeValidator extends FileValidator<MaxFileSizeValidatorOptions> {
+  buildErrorMessage(): string {
+    return `Validation failed (expected size is less than ${this.validationOptions.maxSize})`;
+  }
+
+  public isValid<TFile extends IFile = any>(file: TFile): boolean {
+    if (!this.validationOptions) {
+      return true;
+    }
+
+    return 'size' in file && file.size < this.validationOptions.maxSize;
+  }
+}
diff --git a/packages/common/pipes/file/parse-file-options.interface.ts b/packages/common/pipes/file/parse-file-options.interface.ts
new file mode 100644
index 000000000..f9c67daa8
--- /dev/null
+++ b/packages/common/pipes/file/parse-file-options.interface.ts
@@ -0,0 +1,17 @@
+import { ErrorHttpStatusCode } from '../../utils/http-error-by-code.util';
+import { FileValidator } from './file-validator.interface';
+
+/**
+ * @publicApi
+ */
+export interface ParseFileOptions {
+  validators?: FileValidator[];
+  errorHttpStatusCode?: ErrorHttpStatusCode;
+  exceptionFactory?: (error: string) => any;
+
+  /**
+   * Defines if file parameter is required.
+   * @default true
+   */
+  fileIsRequired?: boolean;
+}
diff --git a/packages/common/pipes/file/parse-file-pipe.builder.ts b/packages/common/pipes/file/parse-file-pipe.builder.ts
new file mode 100644
index 000000000..9199fec3d
--- /dev/null
+++ b/packages/common/pipes/file/parse-file-pipe.builder.ts
@@ -0,0 +1,43 @@
+import {
+  FileTypeValidator,
+  FileTypeValidatorOptions,
+} from './file-type.validator';
+import { FileValidator } from './file-validator.interface';
+import {
+  MaxFileSizeValidator,
+  MaxFileSizeValidatorOptions,
+} from './max-file-size.validator';
+import { ParseFileOptions } from './parse-file-options.interface';
+import { ParseFilePipe } from './parse-file.pipe';
+
+/**
+ * @publicApi
+ */
+export class ParseFilePipeBuilder {
+  private validators: FileValidator[] = [];
+
+  addMaxSizeValidator(options: MaxFileSizeValidatorOptions) {
+    return this.addValidator(new MaxFileSizeValidator(options));
+  }
+
+  addFileTypeValidator(options: FileTypeValidatorOptions) {
+    return this.addValidator(new FileTypeValidator(options));
+  }
+
+  addValidator(validator: FileValidator) {
+    this.validators.push(validator);
+    return this;
+  }
+
+  build(
+    additionalOptions?: Omit<ParseFileOptions, 'validators'>,
+  ): ParseFilePipe {
+    const parseFilePipe = new ParseFilePipe({
+      ...additionalOptions,
+      validators: this.validators,
+    });
+
+    this.validators = [];
+    return parseFilePipe;
+  }
+}
diff --git a/packages/common/pipes/file/parse-file.pipe.ts b/packages/common/pipes/file/parse-file.pipe.ts
new file mode 100644
index 000000000..d2ea60e50
--- /dev/null
+++ b/packages/common/pipes/file/parse-file.pipe.ts
@@ -0,0 +1,90 @@
+import { Injectable, Optional } from '../../decorators/core';
+import { HttpStatus } from '../../enums';
+import { PipeTransform } from '../../interfaces/features/pipe-transform.interface';
+import { HttpErrorByCode } from '../../utils/http-error-by-code.util';
+import { isEmpty, isObject, isUndefined } from '../../utils/shared.utils';
+import { FileValidator } from './file-validator.interface';
+import { ParseFileOptions } from './parse-file-options.interface';
+
+/**
+ * Defines the built-in ParseFile Pipe. This pipe can be used to validate incoming files
+ * with `@UploadedFile()` decorator. You can use either other specific built-in validators
+ * or provide one of your own, simply implementing it through FileValidator interface
+ * and adding it to ParseFilePipe's constructor.
+ *
+ * @see [Built-in Pipes](https://docs.nestjs.com/pipes#built-in-pipes)
+ *
+ * @publicApi
+ */
+@Injectable()
+export class ParseFilePipe implements PipeTransform<any> {
+  protected exceptionFactory: (error: string) => any;
+  private readonly validators: FileValidator[];
+  private readonly fileIsRequired: boolean;
+
+  constructor(@Optional() options: ParseFileOptions = {}) {
+    const {
+      exceptionFactory,
+      errorHttpStatusCode = HttpStatus.BAD_REQUEST,
+      validators = [],
+      fileIsRequired,
+    } = options;
+
+    this.exceptionFactory =
+      exceptionFactory ||
+      (error => new HttpErrorByCode[errorHttpStatusCode](error));
+
+    this.validators = validators;
+    this.fileIsRequired = fileIsRequired ?? true;
+  }
+
+  async transform(value: any): Promise<any> {
+    const areThereAnyFilesIn = this.thereAreNoFilesIn(value);
+
+    if (areThereAnyFilesIn && this.fileIsRequired) {
+      throw this.exceptionFactory('File is required');
+    }
+    if (!areThereAnyFilesIn && this.validators.length) {
+      await this.validateFilesOrFile(value);
+    }
+
+    return value;
+  }
+
+  private async validateFilesOrFile(value: any): Promise<void> {
+    if (Array.isArray(value)) {
+      await Promise.all(value.map(f => this.validate(f)));
+    } else {
+      await this.validate(value);
+    }
+  }
+
+  private thereAreNoFilesIn(value: any): boolean {
+    const isEmptyArray = Array.isArray(value) && isEmpty(value);
+    const isEmptyObject = isObject(value) && isEmpty(Object.keys(value));
+    return isUndefined(value) || isEmptyArray || isEmptyObject;
+  }
+
+  protected async validate(file: any): Promise<any> {
+    for (const validator of this.validators) {
+      await this.validateOrThrow(file, validator);
+    }
+    return file;
+  }
+
+  private async validateOrThrow(file: any, validator: FileValidator) {
+    const isValid = await validator.isValid(file);
+
+    if (!isValid) {
+      const errorMessage = validator.buildErrorMessage(file);
+      throw this.exceptionFactory(errorMessage);
+    }
+  }
+
+  /**
+   * @returns list of validators used in this pipe.
+   */
+  getValidators() {
+    return this.validators;
+  }
+}
diff --git a/packages/common/pipes/index.ts b/packages/common/pipes/index.ts
index a69365493..ebbc55f27 100644
--- a/packages/common/pipes/index.ts
+++ b/packages/common/pipes/index.ts
@@ -6,3 +6,4 @@ export * from './parse-float.pipe';
 export * from './parse-enum.pipe';
 export * from './parse-uuid.pipe';
 export * from './validation.pipe';
+export * from './file';
diff --git a/packages/common/pipes/parse-array.pipe.ts b/packages/common/pipes/parse-array.pipe.ts
index 125676458..a46acc8fd 100644
--- a/packages/common/pipes/parse-array.pipe.ts
+++ b/packages/common/pipes/parse-array.pipe.ts
@@ -7,12 +7,15 @@ import {
   PipeTransform,
 } from '../interfaces/features/pipe-transform.interface';
 import { HttpErrorByCode } from '../utils/http-error-by-code.util';
-import { isNil, isString } from '../utils/shared.utils';
+import { isNil, isUndefined, isString } from '../utils/shared.utils';
 import { ValidationPipe, ValidationPipeOptions } from './validation.pipe';
 
 const VALIDATION_ERROR_MESSAGE = 'Validation failed (parsable array expected)';
 const DEFAULT_ARRAY_SEPARATOR = ',';
 
+/**
+ * @publicApi
+ */
 export interface ParseArrayOptions
   extends Omit<
     ValidationPipeOptions,
@@ -36,7 +39,7 @@ export class ParseArrayPipe implements PipeTransform {
   protected readonly validationPipe: ValidationPipe;
   protected exceptionFactory: (error: string) => any;
 
-  constructor(@Optional() private readonly options: ParseArrayOptions = {}) {
+  constructor(@Optional() protected readonly options: ParseArrayOptions = {}) {
     this.validationPipe = new ValidationPipe({
       transform: true,
       validateCustomDecorators: true,
@@ -85,10 +88,11 @@ export class ParseArrayPipe implements PipeTransform {
 
       const isExpectedTypePrimitive = this.isExpectedTypePrimitive();
       const toClassInstance = (item: any, index?: number) => {
-        try {
-          item = JSON.parse(item);
-        } catch {}
-
+        if (this.options.items !== String) {
+          try {
+            item = JSON.parse(item);
+          } catch {}
+        }
         if (isExpectedTypePrimitive) {
           return this.validatePrimitive(item, index);
         }
@@ -141,21 +145,19 @@ export class ParseArrayPipe implements PipeTransform {
         originalValue !== null && originalValue !== '' ? +originalValue : NaN;
       if (isNaN(value)) {
         throw this.exceptionFactory(
-          `${
-            typeof index !== 'undefined' ? `[${index}] ` : ''
-          }item must be a number`,
+          `${isUndefined(index) ? '' : `[${index}] `}item must be a number`,
         );
       }
       return value;
     } else if (this.options.items === String) {
-      if (typeof originalValue !== 'string') {
+      if (!isString(originalValue)) {
         return `${originalValue}`;
       }
     } else if (this.options.items === Boolean) {
       if (typeof originalValue !== 'boolean') {
         throw this.exceptionFactory(
           `${
-            typeof index !== 'undefined' ? `[${index}] ` : ''
+            isUndefined(index) ? '' : `[${index}] `
           }item must be a boolean value`,
         );
       }
diff --git a/packages/common/pipes/parse-bool.pipe.ts b/packages/common/pipes/parse-bool.pipe.ts
index 5876144d9..7f6bdffef 100644
--- a/packages/common/pipes/parse-bool.pipe.ts
+++ b/packages/common/pipes/parse-bool.pipe.ts
@@ -10,6 +10,9 @@ import {
   HttpErrorByCode,
 } from '../utils/http-error-by-code.util';
 
+/**
+ * @publicApi
+ */
 export interface ParseBoolPipeOptions {
   errorHttpStatusCode?: ErrorHttpStatusCode;
   exceptionFactory?: (error: string) => any;
@@ -48,14 +51,32 @@ export class ParseBoolPipe
     value: string | boolean,
     metadata: ArgumentMetadata,
   ): Promise<boolean> {
-    if (value === true || value === 'true') {
+    if (this.isTrue(value)) {
       return true;
     }
-    if (value === false || value === 'false') {
+    if (this.isFalse(value)) {
       return false;
     }
     throw this.exceptionFactory(
       'Validation failed (boolean string is expected)',
     );
   }
+
+  /**
+   * @param value currently processed route argument
+   * @returns `true` if `value` is said 'true', ie., if it is equal to the boolean
+   * `true` or the string `"true"`
+   */
+  protected isTrue(value: string | boolean): boolean {
+    return value === true || value === 'true';
+  }
+
+  /**
+   * @param value currently processed route argument
+   * @returns `true` if `value` is said 'false', ie., if it is equal to the boolean
+   * `false` or the string `"false"`
+   */
+  protected isFalse(value: string | boolean): boolean {
+    return value === false || value === 'false';
+  }
 }
diff --git a/packages/common/pipes/parse-enum.pipe.ts b/packages/common/pipes/parse-enum.pipe.ts
index 4f0fc8537..11b4a6ca7 100644
--- a/packages/common/pipes/parse-enum.pipe.ts
+++ b/packages/common/pipes/parse-enum.pipe.ts
@@ -5,6 +5,9 @@ import {
   HttpErrorByCode,
 } from '../utils/http-error-by-code.util';
 
+/**
+ * @publicApi
+ */
 export interface ParseEnumPipeOptions {
   errorHttpStatusCode?: ErrorHttpStatusCode;
   exceptionFactory?: (error: string) => any;
@@ -59,6 +62,6 @@ export class ParseEnumPipe<T = any> implements PipeTransform<T> {
     const enumValues = Object.keys(this.enumType).map(
       item => this.enumType[item],
     );
-    return enumValues.indexOf(value) >= 0;
+    return enumValues.includes(value);
   }
 }
diff --git a/packages/common/pipes/parse-float.pipe.ts b/packages/common/pipes/parse-float.pipe.ts
index 086152a9b..462077efd 100644
--- a/packages/common/pipes/parse-float.pipe.ts
+++ b/packages/common/pipes/parse-float.pipe.ts
@@ -5,6 +5,9 @@ import {
   HttpErrorByCode,
 } from '../utils/http-error-by-code.util';
 
+/**
+ * @publicApi
+ */
 export interface ParseFloatPipeOptions {
   errorHttpStatusCode?: ErrorHttpStatusCode;
   exceptionFactory?: (error: string) => any;
@@ -39,15 +42,23 @@ export class ParseFloatPipe implements PipeTransform<string> {
    * @param metadata contains metadata about the currently processed route argument
    */
   async transform(value: string, metadata: ArgumentMetadata): Promise<number> {
-    const isNumeric =
-      ['string', 'number'].includes(typeof value) &&
-      !isNaN(parseFloat(value)) &&
-      isFinite(value as any);
-    if (!isNumeric) {
+    if (!this.isNumeric(value)) {
       throw this.exceptionFactory(
         'Validation failed (numeric string is expected)',
       );
     }
     return parseFloat(value);
   }
+
+  /**
+   * @param value currently processed route argument
+   * @returns `true` if `value` is a valid float number
+   */
+  protected isNumeric(value: string): boolean {
+    return (
+      ['string', 'number'].includes(typeof value) &&
+      !isNaN(parseFloat(value)) &&
+      isFinite(value as any)
+    );
+  }
 }
diff --git a/packages/common/pipes/parse-int.pipe.ts b/packages/common/pipes/parse-int.pipe.ts
index 2ba713f85..11303c7e4 100644
--- a/packages/common/pipes/parse-int.pipe.ts
+++ b/packages/common/pipes/parse-int.pipe.ts
@@ -10,6 +10,9 @@ import {
   HttpErrorByCode,
 } from '../utils/http-error-by-code.util';
 
+/**
+ * @publicApi
+ */
 export interface ParseIntPipeOptions {
   errorHttpStatusCode?: ErrorHttpStatusCode;
   exceptionFactory?: (error: string) => any;
@@ -44,15 +47,23 @@ export class ParseIntPipe implements PipeTransform<string> {
    * @param metadata contains metadata about the currently processed route argument
    */
   async transform(value: string, metadata: ArgumentMetadata): Promise<number> {
-    const isNumeric =
-      ['string', 'number'].includes(typeof value) &&
-      /^-?\d+$/.test(value) &&
-      isFinite(value as any);
-    if (!isNumeric) {
+    if (!this.isNumeric(value)) {
       throw this.exceptionFactory(
         'Validation failed (numeric string is expected)',
       );
     }
     return parseInt(value, 10);
   }
+
+  /**
+   * @param value currently processed route argument
+   * @returns `true` if `value` is a valid integer number
+   */
+  protected isNumeric(value: string): boolean {
+    return (
+      ['string', 'number'].includes(typeof value) &&
+      /^-?\d+$/.test(value) &&
+      isFinite(value as any)
+    );
+  }
 }
diff --git a/packages/common/pipes/parse-uuid.pipe.ts b/packages/common/pipes/parse-uuid.pipe.ts
index 2679e8f93..2379e36b6 100644
--- a/packages/common/pipes/parse-uuid.pipe.ts
+++ b/packages/common/pipes/parse-uuid.pipe.ts
@@ -9,16 +9,32 @@ import {
   ErrorHttpStatusCode,
   HttpErrorByCode,
 } from '../utils/http-error-by-code.util';
-import { isUUID } from '../utils/is-uuid';
+import { isString } from '../utils/shared.utils';
 
+/**
+ * @publicApi
+ */
 export interface ParseUUIDPipeOptions {
   version?: '3' | '4' | '5';
   errorHttpStatusCode?: ErrorHttpStatusCode;
   exceptionFactory?: (errors: string) => any;
 }
 
+/**
+ * Defines the built-in ParseUUID Pipe
+ *
+ * @see [Built-in Pipes](https://docs.nestjs.com/pipes#built-in-pipes)
+ *
+ * @publicApi
+ */
 @Injectable()
 export class ParseUUIDPipe implements PipeTransform<string> {
+  protected static uuidRegExps = {
+    3: /^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,
+    4: /^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,
+    5: /^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,
+    all: /^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i,
+  };
   private readonly version: '3' | '4' | '5';
   protected exceptionFactory: (errors: string) => any;
 
@@ -35,14 +51,23 @@ export class ParseUUIDPipe implements PipeTransform<string> {
       exceptionFactory ||
       (error => new HttpErrorByCode[errorHttpStatusCode](error));
   }
+
   async transform(value: string, metadata: ArgumentMetadata): Promise<string> {
-    if (!isUUID(value, this.version)) {
+    if (!this.isUUID(value, this.version)) {
       throw this.exceptionFactory(
-        `Validation failed (uuid ${
-          this.version ? 'v' + this.version : ''
+        `Validation failed (uuid${
+          this.version ? ` v ${this.version}` : ''
         } is expected)`,
       );
     }
     return value;
   }
+
+  protected isUUID(str: unknown, version = 'all') {
+    if (!isString(str)) {
+      throw this.exceptionFactory('The value passed as UUID is not a string');
+    }
+    const pattern = ParseUUIDPipe.uuidRegExps[version];
+    return pattern?.test(str);
+  }
 }
diff --git a/packages/common/pipes/validation.pipe.ts b/packages/common/pipes/validation.pipe.ts
index 483498796..d86326181 100644
--- a/packages/common/pipes/validation.pipe.ts
+++ b/packages/common/pipes/validation.pipe.ts
@@ -1,4 +1,5 @@
 import { iterate } from 'iterare';
+import { types } from 'util';
 import { Optional } from '../decorators';
 import { Injectable } from '../decorators/core';
 import { HttpStatus } from '../enums/http-status.enum';
@@ -17,8 +18,11 @@ import {
   HttpErrorByCode,
 } from '../utils/http-error-by-code.util';
 import { loadPackage } from '../utils/load-package.util';
-import { isNil } from '../utils/shared.utils';
+import { isNil, isUndefined } from '../utils/shared.utils';
 
+/**
+ * @publicApi
+ */
 export interface ValidationPipeOptions extends ValidatorOptions {
   transform?: boolean;
   disableErrorMessages?: boolean;
@@ -34,6 +38,11 @@ export interface ValidationPipeOptions extends ValidatorOptions {
 let classValidator: ValidatorPackage = {} as any;
 let classTransformer: TransformerPackage = {} as any;
 
+/**
+ * @see [Validation](https://docs.nestjs.com/techniques/validation)
+ *
+ * @publicApi
+ */
 @Injectable()
 export class ValidationPipe implements PipeTransform<any> {
   protected isTransformEnabled: boolean;
@@ -57,8 +66,10 @@ export class ValidationPipe implements PipeTransform<any> {
       ...validatorOptions
     } = options;
 
+    // @see https://github.com/nestjs/nest/issues/10683#issuecomment-1413690508
+    this.validatorOptions = { forbidUnknownValues: false, ...validatorOptions };
+
     this.isTransformEnabled = !!transform;
-    this.validatorOptions = validatorOptions;
     this.transformOptions = transformOptions;
     this.isDetailedOutputDisabled = disableErrorMessages;
     this.validateCustomDecorators = validateCustomDecorators || false;
@@ -144,7 +155,11 @@ export class ValidationPipe implements PipeTransform<any> {
       // if the value was originally undefined or null, revert it back
       return originalValue;
     }
-    return Object.keys(this.validatorOptions).length > 0
+    // we check if the number of keys of the "validatorOptions" is higher than 1 (instead of 0)
+    // because the "forbidUnknownValues" now fallbacks to "false" (in case it wasn't explicitly specified)
+    const shouldTransformToPlain =
+      Object.keys(this.validatorOptions).length > 1;
+    return shouldTransformToPlain
       ? classTransformer.classToPlain(entity, this.transformOptions)
       : value;
   }
@@ -178,6 +193,13 @@ export class ValidationPipe implements PipeTransform<any> {
       return value;
     }
     if (metatype === Boolean) {
+      if (isUndefined(value)) {
+        // This is an workaround to deal with optional boolean values since
+        // optional booleans shouldn't be parsed to a valid boolean when
+        // they were not defined
+        return undefined;
+      }
+      // Any fasly value but `undefined` will be parsed to `false`
       return value === true || value === 'true';
     }
     if (metatype === Number) {
@@ -190,12 +212,24 @@ export class ValidationPipe implements PipeTransform<any> {
     return isNil(value) ? {} : value;
   }
 
-  protected stripProtoKeys(value: Record<string, any>) {
+  protected stripProtoKeys(value: any) {
+    if (
+      value == null ||
+      typeof value !== 'object' ||
+      types.isTypedArray(value)
+    ) {
+      return;
+    }
+    if (Array.isArray(value)) {
+      for (const v of value) {
+        this.stripProtoKeys(v);
+      }
+      return;
+    }
     delete value.__proto__;
-    const keys = Object.keys(value);
-    iterate(keys)
-      .filter(key => typeof value[key] === 'object' && value[key])
-      .forEach(key => this.stripProtoKeys(value[key]));
+    for (const key in value) {
+      this.stripProtoKeys(value[key]);
+    }
   }
 
   protected isPrimitive(value: unknown): boolean {
diff --git a/packages/common/serializer/class-serializer.interceptor.ts b/packages/common/serializer/class-serializer.interceptor.ts
index 7513447b0..3773fddc0 100644
--- a/packages/common/serializer/class-serializer.interceptor.ts
+++ b/packages/common/serializer/class-serializer.interceptor.ts
@@ -1,3 +1,4 @@
+import { ClassSerializerContextOptions } from './class-serializer.interfaces';
 import { Observable } from 'rxjs';
 import { map } from 'rxjs/operators';
 import { Inject, Injectable, Optional } from '../decorators/core';
@@ -20,11 +21,17 @@ export interface PlainLiteralObject {
 // between core and common packages
 const REFLECTOR = 'Reflector';
 
+/**
+ * @publicApi
+ */
 export interface ClassSerializerInterceptorOptions
   extends ClassTransformOptions {
   transformerPackage?: TransformerPackage;
 }
 
+/**
+ * @publicApi
+ */
 @Injectable()
 export class ClassSerializerInterceptor implements NestInterceptor {
   constructor(
@@ -63,7 +70,7 @@ export class ClassSerializerInterceptor implements NestInterceptor {
    */
   serialize(
     response: PlainLiteralObject | Array<PlainLiteralObject>,
-    options: ClassTransformOptions,
+    options: ClassSerializerContextOptions,
   ): PlainLiteralObject | Array<PlainLiteralObject> {
     if (!isObject(response) || response instanceof StreamableFile) {
       return response;
@@ -76,25 +83,27 @@ export class ClassSerializerInterceptor implements NestInterceptor {
 
   transformToPlain(
     plainOrClass: any,
-    options: ClassTransformOptions,
+    options: ClassSerializerContextOptions,
   ): PlainLiteralObject {
-    return plainOrClass
-      ? classTransformer.classToPlain(plainOrClass, options)
-      : plainOrClass;
+    if (!plainOrClass) {
+      return plainOrClass;
+    }
+    if (!options.type) {
+      return classTransformer.classToPlain(plainOrClass, options);
+    }
+    if (plainOrClass instanceof options.type) {
+      return classTransformer.classToPlain(plainOrClass, options);
+    }
+    const instance = classTransformer.plainToClass(options.type, plainOrClass);
+    return classTransformer.classToPlain(instance, options);
   }
 
   protected getContextOptions(
     context: ExecutionContext,
-  ): ClassTransformOptions | undefined {
-    return (
-      this.reflectSerializeMetadata(context.getHandler()) ||
-      this.reflectSerializeMetadata(context.getClass())
-    );
-  }
-
-  private reflectSerializeMetadata(
-    obj: object | Function,
-  ): ClassTransformOptions | undefined {
-    return this.reflector.get(CLASS_SERIALIZER_OPTIONS, obj);
+  ): ClassSerializerContextOptions | undefined {
+    return this.reflector.getAllAndOverride(CLASS_SERIALIZER_OPTIONS, [
+      context.getHandler(),
+      context.getClass(),
+    ]);
   }
 }
diff --git a/packages/common/serializer/class-serializer.interfaces.ts b/packages/common/serializer/class-serializer.interfaces.ts
new file mode 100644
index 000000000..c5404177c
--- /dev/null
+++ b/packages/common/serializer/class-serializer.interfaces.ts
@@ -0,0 +1,9 @@
+import { ClassTransformOptions } from '../interfaces/external/class-transform-options.interface';
+import { Type } from '../interfaces';
+
+/**
+ * @publicApi
+ */
+export interface ClassSerializerContextOptions extends ClassTransformOptions {
+  type?: Type<any>;
+}
diff --git a/packages/common/serializer/decorators/serialize-options.decorator.ts b/packages/common/serializer/decorators/serialize-options.decorator.ts
index 130dd992d..bd92695fd 100644
--- a/packages/common/serializer/decorators/serialize-options.decorator.ts
+++ b/packages/common/serializer/decorators/serialize-options.decorator.ts
@@ -1,6 +1,9 @@
 import { SetMetadata } from '../../decorators';
-import { ClassTransformOptions } from '../../interfaces/external/class-transform-options.interface';
+import { ClassSerializerContextOptions } from '../class-serializer.interfaces';
 import { CLASS_SERIALIZER_OPTIONS } from '../class-serializer.constants';
 
-export const SerializeOptions = (options: ClassTransformOptions) =>
+/**
+ * @publicApi
+ */
+export const SerializeOptions = (options: ClassSerializerContextOptions) =>
   SetMetadata(CLASS_SERIALIZER_OPTIONS, options);
diff --git a/packages/common/serializer/index.ts b/packages/common/serializer/index.ts
index 682c46707..828c4aec4 100644
--- a/packages/common/serializer/index.ts
+++ b/packages/common/serializer/index.ts
@@ -1,2 +1,3 @@
 export * from './class-serializer.interceptor';
 export * from './decorators';
+export * from './class-serializer.interfaces';
diff --git a/packages/common/services/console-logger.service.ts b/packages/common/services/console-logger.service.ts
index d5a4612ae..5b2f4c408 100644
--- a/packages/common/services/console-logger.service.ts
+++ b/packages/common/services/console-logger.service.ts
@@ -1,7 +1,11 @@
-import { Injectable } from '../decorators/core/injectable.decorator';
-import { Optional } from '../decorators/core/optional.decorator';
+import { Injectable, Optional } from '../decorators/core';
 import { clc, yellow } from '../utils/cli-colors.util';
-import { isPlainObject } from '../utils/shared.utils';
+import {
+  isFunction,
+  isPlainObject,
+  isString,
+  isUndefined,
+} from '../utils/shared.utils';
 import { LoggerService, LogLevel } from './logger.service';
 import { isLogLevelEnabled } from './utils';
 
@@ -24,6 +28,15 @@ const DEFAULT_LOG_LEVELS: LogLevel[] = [
   'verbose',
 ];
 
+const dateTimeFormatter = new Intl.DateTimeFormat(undefined, {
+  year: 'numeric',
+  hour: 'numeric',
+  minute: 'numeric',
+  second: 'numeric',
+  day: '2-digit',
+  month: '2-digit',
+});
+
 @Injectable()
 export class ConsoleLogger implements LoggerService {
   private static lastTimestampAt?: number;
@@ -163,18 +176,7 @@ export class ConsoleLogger implements LoggerService {
   }
 
   protected getTimestamp(): string {
-    const localeStringOptions = {
-      year: 'numeric',
-      hour: 'numeric',
-      minute: 'numeric',
-      second: 'numeric',
-      day: '2-digit',
-      month: '2-digit',
-    };
-    return new Date(Date.now()).toLocaleString(
-      undefined,
-      localeStringOptions as Intl.DateTimeFormatOptions,
-    );
+    return dateTimeFormatter.format(Date.now());
   }
 
   protected printMessages(
@@ -183,27 +185,65 @@ export class ConsoleLogger implements LoggerService {
     logLevel: LogLevel = 'log',
     writeStreamType?: 'stdout' | 'stderr',
   ) {
-    const color = this.getColorByLogLevel(logLevel);
     messages.forEach(message => {
-      const output = isPlainObject(message)
-        ? `${color('Object:')}\n${JSON.stringify(
-            message,
-            (key, value) =>
-              typeof value === 'bigint' ? value.toString() : value,
-            2,
-          )}\n`
-        : color(message as string);
-
-      const pidMessage = color(`[Nest] ${process.pid}  - `);
-      const contextMessage = context ? yellow(`[${context}] `) : '';
+      const pidMessage = this.formatPid(process.pid);
+      const contextMessage = this.formatContext(context);
       const timestampDiff = this.updateAndGetTimestampDiff();
-      const formattedLogLevel = color(logLevel.toUpperCase().padStart(7, ' '));
-      const computedMessage = `${pidMessage}${this.getTimestamp()} ${formattedLogLevel} ${contextMessage}${output}${timestampDiff}\n`;
+      const formattedLogLevel = logLevel.toUpperCase().padStart(7, ' ');
+      const formattedMessage = this.formatMessage(
+        logLevel,
+        message,
+        pidMessage,
+        formattedLogLevel,
+        contextMessage,
+        timestampDiff,
+      );
 
-      process[writeStreamType ?? 'stdout'].write(computedMessage);
+      process[writeStreamType ?? 'stdout'].write(formattedMessage);
     });
   }
 
+  protected formatPid(pid: number) {
+    return `[Nest] ${pid}  - `;
+  }
+
+  protected formatContext(context: string): string {
+    return context ? yellow(`[${context}] `) : '';
+  }
+
+  protected formatMessage(
+    logLevel: LogLevel,
+    message: unknown,
+    pidMessage: string,
+    formattedLogLevel: string,
+    contextMessage: string,
+    timestampDiff: string,
+  ) {
+    const output = this.stringifyMessage(message, logLevel);
+    pidMessage = this.colorize(pidMessage, logLevel);
+    formattedLogLevel = this.colorize(formattedLogLevel, logLevel);
+    return `${pidMessage}${this.getTimestamp()} ${formattedLogLevel} ${contextMessage}${output}${timestampDiff}\n`;
+  }
+
+  protected stringifyMessage(message: unknown, logLevel: LogLevel) {
+    // If the message is a function, call it and re-resolve its value.
+    return isFunction(message)
+      ? this.stringifyMessage(message(), logLevel)
+      : isPlainObject(message) || Array.isArray(message)
+      ? `${this.colorize('Object:', logLevel)}\n${JSON.stringify(
+          message,
+          (key, value) =>
+            typeof value === 'bigint' ? value.toString() : value,
+          2,
+        )}\n`
+      : this.colorize(message as string, logLevel);
+  }
+
+  protected colorize(message: string, logLevel: LogLevel) {
+    const color = this.getColorByLogLevel(logLevel);
+    return color(message);
+  }
+
   protected printStackTrace(stack: string) {
     if (!stack) {
       return;
@@ -211,22 +251,26 @@ export class ConsoleLogger implements LoggerService {
     process.stderr.write(`${stack}\n`);
   }
 
-  private updateAndGetTimestampDiff(): string {
+  protected updateAndGetTimestampDiff(): string {
     const includeTimestamp =
       ConsoleLogger.lastTimestampAt && this.options?.timestamp;
     const result = includeTimestamp
-      ? yellow(` +${Date.now() - ConsoleLogger.lastTimestampAt}ms`)
+      ? this.formatTimestampDiff(Date.now() - ConsoleLogger.lastTimestampAt)
       : '';
     ConsoleLogger.lastTimestampAt = Date.now();
     return result;
   }
 
+  protected formatTimestampDiff(timestampDiff: number) {
+    return yellow(` +${timestampDiff}ms`);
+  }
+
   private getContextAndMessagesToPrint(args: unknown[]) {
     if (args?.length <= 1) {
       return { messages: args, context: this.context };
     }
     const lastElement = args[args.length - 1];
-    const isContext = typeof lastElement === 'string';
+    const isContext = isString(lastElement);
     if (!isContext) {
       return { messages: args, context: this.context };
     }
@@ -242,8 +286,9 @@ export class ConsoleLogger implements LoggerService {
       return { messages, context };
     }
     const lastElement = messages[messages.length - 1];
-    const isStack = typeof lastElement === 'string';
-    if (!isStack) {
+    const isStack = isString(lastElement);
+    // https://github.com/nestjs/nest/issues/11074#issuecomment-1421680060
+    if (!isStack && !isUndefined(lastElement)) {
       return { messages, context };
     }
     return {
diff --git a/packages/common/services/logger.service.ts b/packages/common/services/logger.service.ts
index 962822b13..0ac2c8378 100644
--- a/packages/common/services/logger.service.ts
+++ b/packages/common/services/logger.service.ts
@@ -1,11 +1,16 @@
-import { Injectable } from '../decorators/core/injectable.decorator';
-import { Optional } from '../decorators/core/optional.decorator';
+import { Injectable, Optional } from '../decorators/core';
 import { isObject } from '../utils/shared.utils';
 import { ConsoleLogger } from './console-logger.service';
 import { isLogLevelEnabled } from './utils';
 
+/**
+ * @publicApi
+ */
 export type LogLevel = 'log' | 'error' | 'warn' | 'debug' | 'verbose';
 
+/**
+ * @publicApi
+ */
 export interface LoggerService {
   /**
    * Write a 'log' level log.
@@ -53,6 +58,18 @@ interface LogBufferRecord {
 
 const DEFAULT_LOGGER = new ConsoleLogger();
 
+const dateTimeFormatter = new Intl.DateTimeFormat(undefined, {
+  year: 'numeric',
+  hour: 'numeric',
+  minute: 'numeric',
+  second: 'numeric',
+  day: '2-digit',
+  month: '2-digit',
+});
+
+/**
+ * @publicApi
+ */
 @Injectable()
 export class Logger implements LoggerService {
   protected static logBuffer = new Array<LogBufferRecord>();
@@ -108,7 +125,9 @@ export class Logger implements LoggerService {
   @Logger.WrapBuffer
   error(message: any, ...optionalParams: any[]) {
     optionalParams = this.context
-      ? optionalParams.concat(this.context)
+      ? (optionalParams.length ? optionalParams : [undefined]).concat(
+          this.context,
+        )
       : optionalParams;
 
     this.localInstance?.error(message, ...optionalParams);
@@ -234,7 +253,7 @@ export class Logger implements LoggerService {
 
   /**
    * Attach buffer.
-   * Turns on initialisation logs buffering.
+   * Turns on initialization logs buffering.
    */
   static attachBuffer() {
     this.isBufferAttached = true;
@@ -242,25 +261,14 @@ export class Logger implements LoggerService {
 
   /**
    * Detach buffer.
-   * Turns off initialisation logs buffering.
+   * Turns off initialization logs buffering.
    */
   static detachBuffer() {
     this.isBufferAttached = false;
   }
 
   static getTimestamp() {
-    const localeStringOptions = {
-      year: 'numeric',
-      hour: 'numeric',
-      minute: 'numeric',
-      second: 'numeric',
-      day: '2-digit',
-      month: '2-digit',
-    };
-    return new Date(Date.now()).toLocaleString(
-      undefined,
-      localeStringOptions as Intl.DateTimeFormatOptions,
-    );
+    return dateTimeFormatter.format(Date.now());
   }
 
   static overrideLogger(logger: LoggerService | LogLevel[] | boolean) {
@@ -270,7 +278,7 @@ export class Logger implements LoggerService {
     }
     if (isObject(logger)) {
       if (logger instanceof Logger && logger.constructor !== Logger) {
-        const errorMessage = `Using the "extends Logger" instruction is not allowed in Nest v8. Please, use "extends ConsoleLogger" instead.`;
+        const errorMessage = `Using the "extends Logger" instruction is not allowed in Nest v9. Please, use "extends ConsoleLogger" instead.`;
         this.staticInstanceRef.error(errorMessage);
         throw new Error(errorMessage);
       }
diff --git a/packages/common/test/decorators/cache.decorator.spec.ts b/packages/common/test/decorators/cache.decorator.spec.ts
deleted file mode 100644
index a207b4180..000000000
--- a/packages/common/test/decorators/cache.decorator.spec.ts
+++ /dev/null
@@ -1,47 +0,0 @@
-import { expect } from 'chai';
-import { CacheKey, CacheInterceptor, CacheTTL } from '../../cache';
-import {
-  CACHE_KEY_METADATA,
-  CACHE_TTL_METADATA,
-} from '../../cache/cache.constants';
-import { UseInterceptors } from '../../decorators';
-import { Controller } from '../../decorators/core/controller.decorator';
-
-describe('@Cache', () => {
-  @Controller('test')
-  @CacheKey('/a_different_cache_key')
-  @CacheTTL(99999)
-  @UseInterceptors(CacheInterceptor)
-  class TestAll {}
-
-  @Controller()
-  @UseInterceptors(CacheInterceptor)
-  @CacheKey('/a_different_cache_key')
-  class TestKey {}
-
-  @Controller()
-  @UseInterceptors(CacheInterceptor)
-  @CacheTTL(99999)
-  class TestTTL {}
-
-  it('should override global defaults for CacheKey and CacheTTL', () => {
-    expect(Reflect.getMetadata(CACHE_KEY_METADATA, TestAll)).to.be.eql(
-      '/a_different_cache_key',
-    );
-    expect(Reflect.getMetadata(CACHE_TTL_METADATA, TestAll)).to.be.greaterThan(
-      9999,
-    );
-  });
-
-  it('should override only the TTL', () => {
-    expect(Reflect.getMetadata(CACHE_TTL_METADATA, TestTTL)).to.be.greaterThan(
-      9999,
-    );
-  });
-
-  it('should override only the Key', () => {
-    expect(Reflect.getMetadata(CACHE_KEY_METADATA, TestKey)).to.be.eql(
-      '/a_different_cache_key',
-    );
-  });
-});
diff --git a/packages/common/test/decorators/catch.decorator.spec.ts b/packages/common/test/decorators/catch.decorator.spec.ts
index bdd9e5f69..5fff8ebf1 100644
--- a/packages/common/test/decorators/catch.decorator.spec.ts
+++ b/packages/common/test/decorators/catch.decorator.spec.ts
@@ -1,5 +1,5 @@
 import { expect } from 'chai';
-import { FILTER_CATCH_EXCEPTIONS } from '../../constants';
+import { CATCH_WATERMARK, FILTER_CATCH_EXCEPTIONS } from '../../constants';
 import { Catch } from '../../decorators/core/catch.decorator';
 
 describe('@Catch', () => {
@@ -8,6 +8,12 @@ describe('@Catch', () => {
   @Catch(...exceptions)
   class Test {}
 
+  it(`should enhance component with "${CATCH_WATERMARK}" metadata`, () => {
+    const catchWatermark = Reflect.getMetadata(CATCH_WATERMARK, Test);
+
+    expect(catchWatermark).to.be.true;
+  });
+
   it('should enhance class with expected exceptions array', () => {
     const metadata = Reflect.getMetadata(FILTER_CATCH_EXCEPTIONS, Test);
     expect(metadata).to.be.eql(exceptions);
diff --git a/packages/common/test/decorators/controller.decorator.spec.ts b/packages/common/test/decorators/controller.decorator.spec.ts
index a375f5028..100a4ecbb 100644
--- a/packages/common/test/decorators/controller.decorator.spec.ts
+++ b/packages/common/test/decorators/controller.decorator.spec.ts
@@ -1,5 +1,5 @@
 import { expect } from 'chai';
-import { VERSION_METADATA } from '../../constants';
+import { VERSION_METADATA, CONTROLLER_WATERMARK } from '../../constants';
 import { Controller } from '../../decorators/core/controller.decorator';
 
 describe('@Controller', () => {
@@ -7,13 +7,15 @@ describe('@Controller', () => {
   const reflectedHost = 'api.example.com';
   const reflectedHostArray = ['api1.example.com', 'api2.example.com'];
   const reflectedVersion = '1';
-
-  @Controller(reflectedPath)
-  class Test {}
+  const reflectedVersionWithDuplicates = ['1', '2', '2', '1', '2', '1'];
+  const reflectedVersionWithoutDuplicates = ['1', '2'];
 
   @Controller()
   class EmptyDecorator {}
 
+  @Controller(reflectedPath)
+  class Test {}
+
   @Controller({ path: reflectedPath, host: reflectedHost })
   class PathAndHostDecorator {}
 
@@ -33,6 +35,18 @@ describe('@Controller', () => {
   @Controller({ version: reflectedVersion })
   class VersionOnlyDecorator {}
 
+  @Controller({ version: reflectedVersionWithDuplicates })
+  class VersionOnlyArrayDecorator {}
+
+  it(`should enhance component with "${CONTROLLER_WATERMARK}" metadata`, () => {
+    const controllerWatermark = Reflect.getMetadata(
+      CONTROLLER_WATERMARK,
+      EmptyDecorator,
+    );
+
+    expect(controllerWatermark).to.be.true;
+  });
+
   it('should enhance controller with expected path metadata', () => {
     const path = Reflect.getMetadata('path', Test);
     expect(path).to.be.eql(reflectedPath);
@@ -64,6 +78,11 @@ describe('@Controller', () => {
       VersionOnlyDecorator,
     );
     expect(version2).to.be.eql(reflectedVersion);
+    const version3 = Reflect.getMetadata(
+      VERSION_METADATA,
+      VersionOnlyArrayDecorator,
+    );
+    expect(version3).to.be.eql(reflectedVersionWithoutDuplicates);
   });
 
   it('should set default path when no object passed as param', () => {
diff --git a/packages/common/test/decorators/injectable.decorator.spec.ts b/packages/common/test/decorators/injectable.decorator.spec.ts
index 61b4df86d..388ecd710 100644
--- a/packages/common/test/decorators/injectable.decorator.spec.ts
+++ b/packages/common/test/decorators/injectable.decorator.spec.ts
@@ -1,12 +1,24 @@
 import { expect } from 'chai';
+import { SCOPE_OPTIONS_METADATA, INJECTABLE_WATERMARK } from '../../constants';
 import { Injectable, mixin } from '../../index';
 
 describe('@Injectable', () => {
-  @Injectable()
+  const options = {};
+
+  @Injectable(options)
   class TestMiddleware {
-    constructor(param: number, test: string) {}
+    constructor(_param: number, _test: string) {}
   }
 
+  it(`should enhance component with "${INJECTABLE_WATERMARK}" metadata`, () => {
+    const injectableWatermark = Reflect.getMetadata(
+      INJECTABLE_WATERMARK,
+      TestMiddleware,
+    );
+
+    expect(injectableWatermark).to.be.eql(true);
+  });
+
   it('should enhance component with "design:paramtypes" metadata', () => {
     const constructorParams = Reflect.getMetadata(
       'design:paramtypes',
@@ -16,22 +28,33 @@ describe('@Injectable', () => {
     expect(constructorParams[0]).to.be.eql(Number);
     expect(constructorParams[1]).to.be.eql(String);
   });
+
+  it(`should enhance component with "${SCOPE_OPTIONS_METADATA}" metadata`, () => {
+    const constructorParams = Reflect.getMetadata(
+      SCOPE_OPTIONS_METADATA,
+      TestMiddleware,
+    );
+
+    expect(constructorParams).to.be.eql(options);
+  });
 });
 
 describe('mixin', () => {
   @Injectable()
   class Test {
-    constructor(param: number, test: string) {}
+    constructor(_param: number, _test: string) {}
   }
 
   it('should set name of metatype', () => {
     const type = mixin(Test);
+
     expect(type.name).to.not.eql('Test');
   });
 
-  it('should not lost the design:parmatypes metadata', () => {
+  it('should not lost the design:paramtypes metadata', () => {
     const type = mixin(Test);
     const constructorParams = Reflect.getMetadata('design:paramtypes', type);
+
     expect(constructorParams[0]).to.be.eql(Number);
     expect(constructorParams[1]).to.be.eql(String);
   });
diff --git a/packages/common/test/decorators/route-params.decorator.spec.ts b/packages/common/test/decorators/route-params.decorator.spec.ts
index b96fcb2c0..93c26ab09 100644
--- a/packages/common/test/decorators/route-params.decorator.spec.ts
+++ b/packages/common/test/decorators/route-params.decorator.spec.ts
@@ -1,5 +1,5 @@
 import { expect } from 'chai';
-import { Body, HostParam, Param, Query } from '../../decorators';
+import { Body, HostParam, Param, Query, Search } from '../../decorators';
 import { RequestMethod } from '../../enums/request-method.enum';
 import { All, Delete, Get, Patch, Post, Put } from '../../index';
 
@@ -311,6 +311,63 @@ describe('@Patch', () => {
   });
 });
 
+describe('@Search', () => {
+  const requestPath = 'test';
+  const requestProps = {
+    path: requestPath,
+    method: RequestMethod.SEARCH,
+  };
+
+  const requestPathUsingArray = ['foo', 'bar'];
+  const requestPropsUsingArray = {
+    path: requestPathUsingArray,
+    method: RequestMethod.SEARCH,
+  };
+
+  it('should enhance class with expected request metadata', () => {
+    class Test {
+      @Search(requestPath)
+      public static test() {}
+
+      @Search(requestPathUsingArray)
+      public static testUsingArray() {}
+    }
+
+    const path = Reflect.getMetadata('path', Test.test);
+    const method = Reflect.getMetadata('method', Test.test);
+    const pathUsingArray = Reflect.getMetadata('path', Test.testUsingArray);
+    const methodUsingArray = Reflect.getMetadata('method', Test.testUsingArray);
+
+    expect(path).to.be.eql(requestPath);
+    expect(method).to.be.eql(requestProps.method);
+    expect(pathUsingArray).to.be.eql(requestPathUsingArray);
+    expect(methodUsingArray).to.be.eql(requestPropsUsingArray.method);
+  });
+
+  it('should set path on "/" by default', () => {
+    class Test {
+      @Search()
+      public static test(
+        @Query() query,
+        @Param() params,
+        @HostParam() hostParams,
+      ) {}
+
+      @Search([])
+      public static testUsingArray(
+        @Query() query,
+        @Param() params,
+        @HostParam() hostParams,
+      ) {}
+    }
+
+    const path = Reflect.getMetadata('path', Test.test);
+    const pathUsingArray = Reflect.getMetadata('path', Test.testUsingArray);
+    expect(path).to.be.eql('/');
+    expect(pathUsingArray).to.be.eql('/');
+  });
+});
+
 describe('Inheritance', () => {
   const requestPath = 'test';
   const requestProps = {
diff --git a/packages/common/test/decorators/version.decorator.spec.ts b/packages/common/test/decorators/version.decorator.spec.ts
index 950e3f971..d33ea668d 100644
--- a/packages/common/test/decorators/version.decorator.spec.ts
+++ b/packages/common/test/decorators/version.decorator.spec.ts
@@ -4,14 +4,27 @@ import { Version } from '../../decorators/core/version.decorator';
 
 describe('@Version', () => {
   const version = '1';
+  const versions = ['1', '2', '2', '1', '2', '1'];
+  const versionsWithoutDuplicates = ['1', '2'];
 
   class Test {
     @Version(version)
-    public static test() {}
+    public static oneVersion() {}
+
+    @Version(versions)
+    public static multipleVersions() {}
   }
 
   it('should enhance method with expected version string', () => {
-    const metadata = Reflect.getMetadata(VERSION_METADATA, Test.test);
+    const metadata = Reflect.getMetadata(VERSION_METADATA, Test.oneVersion);
     expect(metadata).to.be.eql(version);
   });
+
+  it('should enhance method with expected version array', () => {
+    const metadata = Reflect.getMetadata(
+      VERSION_METADATA,
+      Test.multipleVersions,
+    );
+    expect(metadata).to.be.eql(versionsWithoutDuplicates);
+  });
 });
diff --git a/packages/common/test/exceptions/http.exception.spec.ts b/packages/common/test/exceptions/http.exception.spec.ts
index c9fbab731..9e8aad94d 100644
--- a/packages/common/test/exceptions/http.exception.spec.ts
+++ b/packages/common/test/exceptions/http.exception.spec.ts
@@ -1,56 +1,145 @@
+import { Type } from '../../../common';
 import { expect } from 'chai';
 import {
+  BadGatewayException,
   BadRequestException,
+  ConflictException,
+  ForbiddenException,
+  GatewayTimeoutException,
+  GoneException,
   HttpException,
+  HttpVersionNotSupportedException,
+  ImATeapotException,
+  InternalServerErrorException,
+  MethodNotAllowedException,
+  MisdirectedException,
+  NotAcceptableException,
   NotFoundException,
+  NotImplementedException,
+  PayloadTooLargeException,
+  PreconditionFailedException,
+  RequestTimeoutException,
+  ServiceUnavailableException,
+  UnauthorizedException,
+  UnprocessableEntityException,
+  UnsupportedMediaTypeException,
 } from '../../exceptions';
 
 describe('HttpException', () => {
-  it('should return a response as a string when input is a string', () => {
-    const message = 'My error message';
-    expect(new HttpException(message, 404).getResponse()).to.be.eql(
-      'My error message',
-    );
-  });
+  describe('getResponse', () => {
+    it('should return a response as a string when input is a string', () => {
+      const message = 'My error message';
+      expect(new HttpException(message, 404).getResponse()).to.be.eql(
+        'My error message',
+      );
+    });
 
-  it('should return a response as an object when input is an object', () => {
-    const message = {
-      msg: 'My error message',
-      reason: 'this can be a human readable reason',
-      anything: 'else',
-    };
-    expect(new HttpException(message, 404).getResponse()).to.be.eql(message);
-  });
+    it('should return a response as an object when input is an object', () => {
+      const message = {
+        msg: 'My error message',
+        reason: 'this can be a human readable reason',
+        anything: 'else',
+      };
+      expect(new HttpException(message, 404).getResponse()).to.be.eql(message);
+    });
 
-  it('should return a message from a built-in exception as an object', () => {
-    const message = 'My error message';
-    expect(new BadRequestException(message).getResponse()).to.be.eql({
-      statusCode: 400,
-      error: 'Bad Request',
-      message: 'My error message',
+    it('should return a message from a built-in exception as an object', () => {
+      const message = 'My error message';
+      expect(new BadRequestException(message).getResponse()).to.be.eql({
+        statusCode: 400,
+        error: 'Bad Request',
+        message: 'My error message',
+      });
     });
-  });
 
-  it('should return an object even when the message is undefined', () => {
-    expect(new BadRequestException().getResponse()).to.be.eql({
-      statusCode: 400,
-      message: 'Bad Request',
+    it('should return an object even when the message is undefined', () => {
+      expect(new BadRequestException().getResponse()).to.be.eql({
+        statusCode: 400,
+        message: 'Bad Request',
+      });
     });
   });
 
-  it('should return a status code', () => {
-    expect(new BadRequestException().getStatus()).to.be.eql(400);
-    expect(new NotFoundException().getStatus()).to.be.eql(404);
-  });
+  describe('built-in exceptions', () => {
+    describe('getStatus', () => {
+      it('should return given status code', () => {
+        const testCases: [Type<HttpException>, number][] = [
+          [BadRequestException, 400],
+          [UnauthorizedException, 401],
+          [ForbiddenException, 403],
+          [NotFoundException, 404],
+          [MethodNotAllowedException, 405],
+          [NotAcceptableException, 406],
+          [RequestTimeoutException, 408],
+          [ConflictException, 409],
+          [GoneException, 410],
+          [PreconditionFailedException, 412],
+          [PayloadTooLargeException, 413],
+          [UnsupportedMediaTypeException, 415],
+          [ImATeapotException, 418],
+          [MisdirectedException, 421],
+          [UnprocessableEntityException, 422],
+          [InternalServerErrorException, 500],
+          [NotImplementedException, 501],
+          [BadGatewayException, 502],
+          [ServiceUnavailableException, 503],
+          [GatewayTimeoutException, 504],
+          [HttpVersionNotSupportedException, 505],
+        ];
 
-  it('should return a response', () => {
-    expect(new BadRequestException().getResponse()).to.be.eql({
-      message: 'Bad Request',
-      statusCode: 400,
+        testCases.forEach(([ExceptionClass, expectedStatus]) => {
+          expect(new ExceptionClass().getStatus()).to.be.eql(expectedStatus);
+        });
+      });
     });
-    expect(new NotFoundException().getResponse()).to.be.eql({
-      message: 'Not Found',
-      statusCode: 404,
+
+    describe('getResponse', () => {
+      it('should return a response with default message and status code', () => {
+        const testCases: [Type<HttpException>, number, string][] = [
+          [BadRequestException, 400, 'Bad Request'],
+          [UnauthorizedException, 401, 'Unauthorized'],
+          [ForbiddenException, 403, 'Forbidden'],
+          [NotFoundException, 404, 'Not Found'],
+          [MethodNotAllowedException, 405, 'Method Not Allowed'],
+          [NotAcceptableException, 406, 'Not Acceptable'],
+          [RequestTimeoutException, 408, 'Request Timeout'],
+          [ConflictException, 409, 'Conflict'],
+          [GoneException, 410, 'Gone'],
+          [PreconditionFailedException, 412, 'Precondition Failed'],
+          [PayloadTooLargeException, 413, 'Payload Too Large'],
+          [UnsupportedMediaTypeException, 415, 'Unsupported Media Type'],
+          [ImATeapotException, 418, "I'm a teapot"],
+          [MisdirectedException, 421, 'Misdirected'],
+          [UnprocessableEntityException, 422, 'Unprocessable Entity'],
+          [InternalServerErrorException, 500, 'Internal Server Error'],
+          [NotImplementedException, 501, 'Not Implemented'],
+          [BadGatewayException, 502, 'Bad Gateway'],
+          [ServiceUnavailableException, 503, 'Service Unavailable'],
+          [GatewayTimeoutException, 504, 'Gateway Timeout'],
+          [HttpVersionNotSupportedException, 505, 'HTTP Version Not Supported'],
+        ];
+
+        testCases.forEach(
+          ([ExceptionClass, expectedStatus, expectedMessage]) => {
+            expect(new ExceptionClass().getResponse()).to.be.eql({
+              message: expectedMessage,
+              statusCode: expectedStatus,
+            });
+          },
+        );
+      });
+
+      it('should return a response with an "error" attribute when description was provided as the "option" object', () => {
+        const badRequestError = new BadRequestException('ErrorMessage', {
+          description: 'Some error description',
+        });
+
+        expect(badRequestError.getResponse()).to.be.eql({
+          message: 'ErrorMessage',
+          error: 'Some error description',
+          statusCode: 400,
+        });
+      });
     });
   });
 
@@ -59,31 +148,28 @@ describe('HttpException', () => {
     expect(error instanceof Error).to.be.true;
   });
 
-  it('should be serializable', () => {
-    const message = 'Some Error';
-    const error = new HttpException(message, 400);
-    expect(`${error}`).to.be.eql(`HttpException: ${message}`);
-  });
+  describe('when serializing', () => {
+    describe('and "response" parameter is a string', () => {
+      it('should concatenate HttpException with the given message', () => {
+        const responseAsString = 'Some Error';
+        const error = new HttpException(responseAsString, 400);
+        expect(`${error}`).to.be.eql(`HttpException: ${responseAsString}`);
+        expect(`${error}`.includes('[object Object]')).to.not.be.true;
+      });
+    });
 
-  describe('when "response" is an object', () => {
-    it('should use default message', () => {
-      const obj = { foo: 'bar' };
-      const error = new HttpException(obj, 400);
-      const badRequestError = new BadRequestException(obj);
+    describe('and "response" parameter is an object', () => {
+      it('should use default message', () => {
+        const responseAsObject = { foo: 'bar' };
+        const error = new HttpException(responseAsObject, 400);
+        const badRequestError = new BadRequestException(responseAsObject);
 
-      expect(`${error}`).to.be.eql(`HttpException: Http Exception`);
-      expect(`${badRequestError}`).to.be.eql(
-        `BadRequestException: Bad Request Exception`,
-      );
-      expect(`${error}`.includes('[object Object]')).to.not.be.true;
-      expect(`${badRequestError}`.includes('[object Object]')).to.not.be.true;
-    });
-    describe('otherwise', () => {
-      it('should concat strings', () => {
-        const test = 'test message';
-        const error = new HttpException(test, 400);
-        expect(`${error}`).to.be.eql(`HttpException: ${test}`);
+        expect(`${error}`).to.be.eql(`HttpException: Http Exception`);
+        expect(`${badRequestError}`).to.be.eql(
+          `BadRequestException: Bad Request Exception`,
+        );
         expect(`${error}`.includes('[object Object]')).to.not.be.true;
+        expect(`${badRequestError}`.includes('[object Object]')).to.not.be.true;
       });
     });
   });
@@ -129,4 +215,65 @@ describe('HttpException', () => {
       });
     });
   });
+
+  describe('initCause', () => {
+    const errorCause = new Error('An internal error cause');
+    const customDescription = 'custom description';
+
+    it('configures a cause when message is an instance of error', () => {
+      const message = new Error('Some Error');
+      const error = new HttpException(message, 400);
+      expect(`${error}`).to.be.eql(`HttpException: ${message.message}`);
+      const { cause } = error;
+
+      expect(cause).to.be.eql(message);
+    });
+
+    it('configures a cause when message is a string and the options object is passed', () => {
+      const error = new HttpException(customDescription, 400, {
+        cause: errorCause,
+      });
+
+      expect(`${error}`).to.be.eql(`HttpException: ${customDescription}`);
+      const { cause } = error;
+
+      expect(cause).to.be.eql(errorCause);
+    });
+
+    it('configures a cause when using a built-in exception with options', () => {
+      const builtInErrorClasses = [
+        BadGatewayException,
+        BadRequestException,
+        ConflictException,
+        ForbiddenException,
+        GatewayTimeoutException,
+        GoneException,
+        HttpVersionNotSupportedException,
+        ImATeapotException,
+        InternalServerErrorException,
+        MethodNotAllowedException,
+        MisdirectedException,
+        NotAcceptableException,
+        NotFoundException,
+        NotImplementedException,
+        PayloadTooLargeException,
+        PreconditionFailedException,
+        RequestTimeoutException,
+        ServiceUnavailableException,
+        UnauthorizedException,
+        UnprocessableEntityException,
+        UnsupportedMediaTypeException,
+      ];
+
+      builtInErrorClasses.forEach(ExceptionClass => {
+        const error = new ExceptionClass(customDescription, {
+          cause: errorCause,
+        });
+
+        const { cause } = error;
+
+        expect(cause).to.be.eql(errorCause);
+      });
+    });
+  });
 });
diff --git a/packages/common/test/file-stream/streamable-file.spec.ts b/packages/common/test/file-stream/streamable-file.spec.ts
index 905e1d179..411e6224d 100644
--- a/packages/common/test/file-stream/streamable-file.spec.ts
+++ b/packages/common/test/file-stream/streamable-file.spec.ts
@@ -4,25 +4,61 @@ import { StreamableFile } from '../../file-stream';
 
 describe('StreamableFile', () => {
   describe('when input is a readable stream', () => {
-    it('should assing it to a stream class property', () => {
+    it('should assign it to a stream class property', () => {
       const stream = new Readable();
       const streamableFile = new StreamableFile(stream);
       expect(streamableFile.getStream()).to.equal(stream);
     });
   });
   describe('when input is an object with "pipe" method', () => {
-    it('should assing it to a stream class property', () => {
+    it('should assign it to a stream class property', () => {
       const stream = { pipe: () => {} };
       const streamableFile = new StreamableFile(stream as any);
       expect(streamableFile.getStream()).to.equal(stream);
     });
   });
+  describe('when options is empty', () => {
+    it('should return application/octet-stream for type and undefined for others', () => {
+      const stream = new Readable();
+      const streamableFile = new StreamableFile(stream);
+      expect(streamableFile.getHeaders()).to.deep.equal({
+        type: 'application/octet-stream',
+        disposition: undefined,
+        length: undefined,
+      });
+    });
+  });
+  describe('when options is defined', () => {
+    it('should pass provided headers', () => {
+      const stream = new Readable();
+      const streamableFile = new StreamableFile(stream, {
+        type: 'application/pdf',
+        disposition: 'inline',
+        length: 100,
+      });
+      expect(streamableFile.getHeaders()).to.deep.equal({
+        type: 'application/pdf',
+        disposition: 'inline',
+        length: 100,
+      });
+    });
+  });
   describe('otherwise', () => {
-    it('should create a readable straem and push the input buffer', () => {
-      const buffer = Buffer.from('test');
-      const streamableFile = new StreamableFile(buffer);
-      const stream = streamableFile.getStream();
-      expect(stream.read()).to.equal(buffer);
+    describe('when input is a Buffer instance', () => {
+      it('should create a readable stream and push the input buffer', () => {
+        const buffer = Buffer.from('test');
+        const streamableFile = new StreamableFile(buffer);
+        const stream = streamableFile.getStream();
+        expect(stream.read()).to.equal(buffer);
+      });
+    });
+    describe('when input is a Uint8Array', () => {
+      it('should create a readable stream and push the input buffer', () => {
+        const buffer = Uint8Array.from([0xab, 0xcd, 0xef, 0x00]);
+        const streamableFile = new StreamableFile(buffer);
+        const stream = streamableFile.getStream();
+        expect(stream.read()).to.deep.equal(Buffer.from(buffer));
+      });
     });
   });
 });
diff --git a/packages/common/test/http/http.service.spec.ts b/packages/common/test/http/http.service.spec.ts
deleted file mode 100644
index f8a6d9540..000000000
--- a/packages/common/test/http/http.service.spec.ts
+++ /dev/null
@@ -1,16 +0,0 @@
-import { AxiosRequestConfig } from 'axios';
-import { expect } from 'chai';
-import { lastValueFrom } from 'rxjs';
-import { HttpService } from '../../http/http.service';
-
-describe('HttpService', () => {
-  it('should not mutate user-given axios options object', done => {
-    const http = new HttpService({ get: () => Promise.resolve() } as any);
-    const options: AxiosRequestConfig = {};
-
-    lastValueFrom(http.get('/', options)).then(() => {
-      expect(options.cancelToken).to.be.undefined;
-      done();
-    });
-  });
-});
diff --git a/packages/common/test/module-utils/configurable-module.builder.spec.ts b/packages/common/test/module-utils/configurable-module.builder.spec.ts
new file mode 100644
index 000000000..3cca9a33f
--- /dev/null
+++ b/packages/common/test/module-utils/configurable-module.builder.spec.ts
@@ -0,0 +1,138 @@
+import { expect } from 'chai';
+import { Provider } from '../../interfaces';
+import { ConfigurableModuleBuilder } from '../../module-utils';
+
+describe('ConfigurableModuleBuilder', () => {
+  describe('setExtras', () => {
+    it('should apply module definition transformer function and return typed builder', () => {
+      const { ConfigurableModuleClass } = new ConfigurableModuleBuilder()
+        .setExtras(
+          { isGlobal: false },
+          (definition, extras: { isGlobal: boolean }) => ({
+            ...definition,
+            global: extras.isGlobal,
+          }),
+        )
+        .build();
+
+      expect(
+        ConfigurableModuleClass.register({
+          // No type error
+          isGlobal: true,
+        }),
+      ).to.deep.include({
+        global: true,
+      });
+    });
+  });
+  describe('setClassMethodName', () => {
+    it('should set static class method name and return typed builder', () => {
+      const { ConfigurableModuleClass } = new ConfigurableModuleBuilder()
+        .setClassMethodName('forRoot')
+        .build();
+
+      expect(ConfigurableModuleClass.forRoot).to.not.be.undefined;
+      expect(ConfigurableModuleClass.forRootAsync).to.not.be.undefined;
+      expect((ConfigurableModuleClass as any).register).to.be.undefined;
+    });
+  });
+  describe('setFactoryMethodName', () => {
+    it('should set configuration factory class method name and return typed builder', () => {
+      const { ConfigurableModuleClass } = new ConfigurableModuleBuilder()
+        .setFactoryMethodName('createOptions')
+        .build();
+
+      expect(
+        ConfigurableModuleClass.registerAsync({
+          useClass: class {
+            // No type error
+            createOptions() {}
+          },
+        }),
+      ).to.not.be.undefined;
+    });
+  });
+  describe('build', () => {
+    it('should return a fully typed "ConfigurableModuleClass"', () => {
+      type ExtraConfig = { isGlobal?: boolean; extraProviders: Provider[] };
+
+      const {
+        ConfigurableModuleClass,
+        OPTIONS_TYPE,
+        ASYNC_OPTIONS_TYPE,
+        MODULE_OPTIONS_TOKEN,
+      } = new ConfigurableModuleBuilder({
+        moduleName: 'RandomTest',
+        alwaysTransient: true,
+      })
+        .setFactoryMethodName('createOptions')
+        .setClassMethodName('forFeature')
+        .setExtras<ExtraConfig>(
+          { isGlobal: false, extraProviders: [] },
+          (definition, extras) => ({
+            ...definition,
+            global: extras.isGlobal,
+            providers: definition.providers?.concat(extras.extraProviders),
+          }),
+        )
+        .build();
+
+      const provideInjectionTokensFrom: Provider[] = [
+        {
+          provide: 'a',
+          useFactory: () => {},
+          inject: ['b'],
+        },
+        {
+          provide: 'b',
+          useFactory: () => {},
+          inject: ['x'],
+        },
+        {
+          provide: 'c',
+          useFactory: () => {},
+          inject: ['y'],
+        },
+      ];
+      const definition = ConfigurableModuleClass.forFeatureAsync({
+        useFactory: () => {},
+        inject: ['a'],
+        provideInjectionTokensFrom,
+        isGlobal: true,
+        extraProviders: ['test' as any],
+      });
+
+      expect(definition.global).to.equal(true);
+      expect(definition.providers).to.have.length(5);
+      console.log(definition.providers);
+      expect(definition.providers).to.deep.contain('test');
+      expect(definition.providers).to.include.members(
+        provideInjectionTokensFrom.slice(0, 2),
+      );
+      expect(definition.providers).not.to.include(
+        provideInjectionTokensFrom[2],
+      );
+      expect(MODULE_OPTIONS_TOKEN).to.equal('RANDOM_TEST_MODULE_OPTIONS');
+      expect((definition.providers[0] as any).provide).to.equal(
+        'RANDOM_TEST_MODULE_OPTIONS',
+      );
+
+      try {
+        expect(ASYNC_OPTIONS_TYPE.imports).to.equal(undefined);
+      } catch (err) {
+        expect(err).to.be.instanceOf(Error);
+        expect(err.message).to.equal(
+          '"ASYNC_OPTIONS_TYPE" is not supposed to be used as a value.',
+        );
+      }
+      try {
+        expect(OPTIONS_TYPE.isGlobal).to.equal(undefined);
+      } catch (err) {
+        expect(err).to.be.instanceOf(Error);
+        expect(err.message).to.equal(
+          '"OPTIONS_TYPE" is not supposed to be used as a value.',
+        );
+      }
+    });
+  });
+});
diff --git a/packages/common/test/module-utils/utils/get-injection-providers.util.spec.ts b/packages/common/test/module-utils/utils/get-injection-providers.util.spec.ts
new file mode 100644
index 000000000..fa9d29fce
--- /dev/null
+++ b/packages/common/test/module-utils/utils/get-injection-providers.util.spec.ts
@@ -0,0 +1,49 @@
+import { expect } from 'chai';
+import { Provider } from '../../../interfaces';
+import { getInjectionProviders } from '../../../module-utils/utils/get-injection-providers.util';
+
+describe('getInjectionProviders', () => {
+  it('should take only required providers', () => {
+    class C {
+      static token = 'a';
+    }
+    const p: Provider[] = [
+      {
+        provide: 'a',
+        useValue: 'a',
+      },
+      {
+        provide: 'b',
+        useValue: 'b',
+      },
+      C,
+      {
+        provide: 'd',
+        useFactory: (c, b) => [c, b],
+        inject: [
+          C,
+          {
+            token: 'b',
+            optional: true,
+          },
+          'x',
+        ],
+      },
+      {
+        provide: 'e',
+        useFactory: (d, b) => [d, b],
+        inject: ['d', 'b'],
+      },
+      {
+        provide: 'f',
+        useValue: 'f',
+      },
+    ];
+    // should not include 'a' and 'f'
+    const expected = p.slice(1, -1);
+    const result = getInjectionProviders(p, ['e']);
+    expect(result).to.have.length(expected.length);
+    expect(result).to.have.members(expected);
+    expect(result).not.to.have.members([p[0], p[5]]);
+  });
+});
diff --git a/packages/common/test/pipes/file/file-type.validator.spec.ts b/packages/common/test/pipes/file/file-type.validator.spec.ts
new file mode 100644
index 000000000..ec562aed0
--- /dev/null
+++ b/packages/common/test/pipes/file/file-type.validator.spec.ts
@@ -0,0 +1,89 @@
+import { expect } from 'chai';
+import { FileTypeValidator } from '../../../pipes';
+
+describe('FileTypeValidator', () => {
+  describe('isValid', () => {
+    it('should return true when the file mimetype is the same as the specified', () => {
+      const fileTypeValidator = new FileTypeValidator({
+        fileType: 'image/jpeg',
+      });
+
+      const requestFile = {
+        mimetype: 'image/jpeg',
+      } as any;
+
+      expect(fileTypeValidator.isValid(requestFile)).to.equal(true);
+    });
+
+    it('should return true when the file mimetype ends with the specified option type', () => {
+      const fileTypeValidator = new FileTypeValidator({
+        fileType: 'jpeg',
+      });
+
+      const requestFile = {
+        mimetype: 'image/jpeg',
+      } as any;
+
+      expect(fileTypeValidator.isValid(requestFile)).to.equal(true);
+    });
+
+    it('should return true when the file mimetype matches the specified regexp', () => {
+      const fileTypeValidator = new FileTypeValidator({
+        fileType: /word/,
+      });
+
+      const requestFile = {
+        mimetype: 'application/msword',
+      } as any;
+
+      expect(fileTypeValidator.isValid(requestFile)).to.equal(true);
+    });
+
+    it('should return false when the file mimetype is different from the specified', () => {
+      const fileTypeValidator = new FileTypeValidator({
+        fileType: 'image/jpeg',
+      });
+
+      const requestFile = {
+        mimetype: 'image/png',
+      } as any;
+
+      expect(fileTypeValidator.isValid(requestFile)).to.equal(false);
+    });
+
+    it('should return false when the file mimetype does not match the provided regexp', () => {
+      const fileTypeValidator = new FileTypeValidator({
+        fileType: /mp4/,
+      });
+
+      const requestFile = {
+        mimetype: 'image/png',
+      } as any;
+
+      expect(fileTypeValidator.isValid(requestFile)).to.equal(false);
+    });
+
+    it('should return false when the file mimetype was not provided', () => {
+      const fileTypeValidator = new FileTypeValidator({
+        fileType: 'image/jpeg',
+      });
+
+      const requestFile = {} as any;
+
+      expect(fileTypeValidator.isValid(requestFile)).to.equal(false);
+    });
+  });
+
+  describe('buildErrorMessage', () => {
+    it('should return a string with the format "Validation failed (expected type is #fileType)"', () => {
+      const fileType = 'image/jpeg';
+      const fileTypeValidator = new FileTypeValidator({
+        fileType,
+      });
+
+      expect(fileTypeValidator.buildErrorMessage()).to.equal(
+        `Validation failed (expected type is ${fileType})`,
+      );
+    });
+  });
+});
diff --git a/packages/common/test/pipes/file/max-file-size.validator.spec.ts b/packages/common/test/pipes/file/max-file-size.validator.spec.ts
new file mode 100644
index 000000000..61d49e6e8
--- /dev/null
+++ b/packages/common/test/pipes/file/max-file-size.validator.spec.ts
@@ -0,0 +1,56 @@
+import { expect } from 'chai';
+import { MaxFileSizeValidator } from '../../../pipes';
+
+describe('MaxFileSizeValidator', () => {
+  const oneKb = 1024;
+
+  describe('isValid', () => {
+    it('should return true when the file size is less than the maximum size', () => {
+      const maxFileSizeValidator = new MaxFileSizeValidator({
+        maxSize: oneKb,
+      });
+
+      const requestFile = {
+        size: 100,
+      } as any;
+
+      expect(maxFileSizeValidator.isValid(requestFile)).to.equal(true);
+    });
+
+    it('should return false when the file size is greater than the maximum size', () => {
+      const maxFileSizeValidator = new MaxFileSizeValidator({
+        maxSize: oneKb,
+      });
+
+      const requestFile = {
+        size: oneKb + 1,
+      } as any;
+
+      expect(maxFileSizeValidator.isValid(requestFile)).to.equal(false);
+    });
+
+    it('should return false when the file size is equal to the maximum size', () => {
+      const maxFileSizeValidator = new MaxFileSizeValidator({
+        maxSize: oneKb,
+      });
+
+      const requestFile = {
+        size: oneKb,
+      } as any;
+
+      expect(maxFileSizeValidator.isValid(requestFile)).to.equal(false);
+    });
+  });
+
+  describe('buildErrorMessage', () => {
+    it('should return a string with the format "Validation failed (expected size is less than #maxSize")', () => {
+      const maxFileSizeValidator = new MaxFileSizeValidator({
+        maxSize: oneKb,
+      });
+
+      expect(maxFileSizeValidator.buildErrorMessage()).to.equal(
+        `Validation failed (expected size is less than ${oneKb})`,
+      );
+    });
+  });
+});
diff --git a/packages/common/test/pipes/file/parse-file-pipe.builder.spec.ts b/packages/common/test/pipes/file/parse-file-pipe.builder.spec.ts
new file mode 100644
index 000000000..784cea3de
--- /dev/null
+++ b/packages/common/test/pipes/file/parse-file-pipe.builder.spec.ts
@@ -0,0 +1,104 @@
+import { expect } from 'chai';
+import {
+  FileTypeValidator,
+  FileValidator,
+  MaxFileSizeValidator,
+  ParseFilePipeBuilder,
+} from '../../../pipes';
+
+describe('ParseFilePipeBuilder', () => {
+  let parseFilePipeBuilder: ParseFilePipeBuilder;
+
+  beforeEach(() => {
+    parseFilePipeBuilder = new ParseFilePipeBuilder();
+  });
+
+  describe('build', () => {
+    describe('when no validator was passed', () => {
+      it('should return a ParseFilePipe with no validators', () => {
+        const parseFilePipe = parseFilePipeBuilder.build();
+        expect(parseFilePipe.getValidators()).to.be.empty;
+      });
+    });
+
+    describe('when addMaxSizeValidator was chained', () => {
+      it('should return a ParseFilePipe with MaxSizeValidator and given options', () => {
+        const options = {
+          maxSize: 1000,
+        };
+        const parseFilePipe = parseFilePipeBuilder
+          .addMaxSizeValidator(options)
+          .build();
+
+        expect(parseFilePipe.getValidators()).to.deep.include(
+          new MaxFileSizeValidator(options),
+        );
+      });
+    });
+
+    describe('when addFileTypeValidator was chained', () => {
+      it('should return a ParseFilePipe with FileTypeValidator and given options', () => {
+        const options = {
+          fileType: 'image/jpeg',
+        };
+        const parseFilePipe = parseFilePipeBuilder
+          .addFileTypeValidator(options)
+          .build();
+
+        expect(parseFilePipe.getValidators()).to.deep.include(
+          new FileTypeValidator(options),
+        );
+      });
+    });
+
+    describe('when custom validator was chained', () => {
+      it('should return a ParseFilePipe with TestFileValidator and given options', () => {
+        class TestFileValidator extends FileValidator<{ name: string }> {
+          buildErrorMessage(file: any): string {
+            return 'TestFileValidator failed';
+          }
+
+          isValid(file: any): boolean | Promise<boolean> {
+            return true;
+          }
+        }
+
+        const options = {
+          name: 'test',
+        };
+
+        const parseFilePipe = parseFilePipeBuilder
+          .addValidator(new TestFileValidator(options))
+          .build();
+
+        expect(parseFilePipe.getValidators()).to.deep.include(
+          new TestFileValidator(options),
+        );
+      });
+    });
+
+    describe('when it is called twice with different validators', () => {
+      it('should not reuse validators', () => {
+        const maxSizeValidatorOptions = {
+          maxSize: 1000,
+        };
+
+        const pipeWithMaxSizeValidator = parseFilePipeBuilder
+          .addMaxSizeValidator(maxSizeValidatorOptions)
+          .build();
+
+        const fileTypeValidatorOptions = {
+          fileType: 'image/jpeg',
+        };
+
+        const pipeWithFileTypeValidator = parseFilePipeBuilder
+          .addFileTypeValidator(fileTypeValidatorOptions)
+          .build();
+
+        expect(pipeWithFileTypeValidator.getValidators()).not.to.deep.equal(
+          pipeWithMaxSizeValidator.getValidators(),
+        );
+      });
+    });
+  });
+});
diff --git a/packages/common/test/pipes/file/parse-file.pipe.spec.ts b/packages/common/test/pipes/file/parse-file.pipe.spec.ts
new file mode 100644
index 000000000..0eecaf989
--- /dev/null
+++ b/packages/common/test/pipes/file/parse-file.pipe.spec.ts
@@ -0,0 +1,180 @@
+import { HttpStatus } from '../../../enums';
+import { BadRequestException, ConflictException } from '../../../exceptions';
+import { FileValidator, ParseFilePipe } from '../../../pipes';
+import { expect } from 'chai';
+
+class AlwaysValidValidator extends FileValidator {
+  isValid(): boolean {
+    return true;
+  }
+  buildErrorMessage(): string {
+    return '';
+  }
+}
+
+const customErrorMessage = 'Error!';
+
+class AlwaysInvalidValidator extends FileValidator {
+  isValid(): boolean {
+    return false;
+  }
+  buildErrorMessage(): string {
+    return customErrorMessage;
+  }
+}
+
+describe('ParseFilePipe', () => {
+  let parseFilePipe: ParseFilePipe;
+  describe('transform', () => {
+    describe('when there are no validators (explicit)', () => {
+      beforeEach(() => {
+        parseFilePipe = new ParseFilePipe({
+          validators: [],
+        });
+      });
+
+      it('should return the file object', async () => {
+        const requestFile = {
+          path: 'some-path',
+        };
+
+        await expect(parseFilePipe.transform(requestFile)).to.eventually.eql(
+          requestFile,
+        );
+      });
+    });
+
+    describe('when there are no validators (by default constructor)', () => {
+      beforeEach(() => {
+        parseFilePipe = new ParseFilePipe();
+      });
+
+      it('should return the file object', async () => {
+        const requestFile = {
+          path: 'some-path',
+        };
+
+        await expect(parseFilePipe.transform(requestFile)).to.eventually.eql(
+          requestFile,
+        );
+      });
+    });
+
+    describe('when all the validators validate the file', () => {
+      beforeEach(() => {
+        parseFilePipe = new ParseFilePipe({
+          validators: [new AlwaysValidValidator({})],
+        });
+      });
+
+      it('should return the file object', async () => {
+        const requestFile = {
+          path: 'some-path',
+        };
+
+        await expect(parseFilePipe.transform(requestFile)).to.eventually.eql(
+          requestFile,
+        );
+      });
+    });
+
+    describe('when some validator invalidates the file', () => {
+      describe('and the pipe has the default error', () => {
+        beforeEach(() => {
+          parseFilePipe = new ParseFilePipe({
+            validators: [new AlwaysInvalidValidator({})],
+          });
+        });
+
+        it('should throw a BadRequestException', async () => {
+          const requestFile = {
+            path: 'some-path',
+          };
+
+          await expect(parseFilePipe.transform(requestFile)).to.be.rejectedWith(
+            BadRequestException,
+          );
+        });
+      });
+
+      describe('and the pipe has a custom error code', () => {
+        beforeEach(() => {
+          parseFilePipe = new ParseFilePipe({
+            validators: [new AlwaysInvalidValidator({})],
+            errorHttpStatusCode: HttpStatus.CONFLICT,
+          });
+        });
+
+        it('should throw this custom Error', async () => {
+          const requestFile = {
+            path: 'some-path',
+          };
+
+          await expect(parseFilePipe.transform(requestFile)).to.be.rejectedWith(
+            ConflictException,
+          );
+        });
+      });
+    });
+
+    describe('when fileIsRequired is false', () => {
+      beforeEach(() => {
+        parseFilePipe = new ParseFilePipe({
+          validators: [],
+          fileIsRequired: false,
+        });
+      });
+
+      it('should pass validation if no file is provided', async () => {
+        const requestFile = undefined;
+
+        await expect(parseFilePipe.transform(requestFile)).to.eventually.eql(
+          requestFile,
+        );
+      });
+    });
+
+    describe('when fileIsRequired is true', () => {
+      beforeEach(() => {
+        parseFilePipe = new ParseFilePipe({
+          validators: [],
+          fileIsRequired: true,
+        });
+      });
+
+      it('should throw an error if no file is provided', async () => {
+        const requestFile = undefined;
+
+        await expect(parseFilePipe.transform(requestFile)).to.be.rejectedWith(
+          BadRequestException,
+        );
+      });
+
+      it('should pass validation if a file is provided', async () => {
+        const requestFile = {
+          path: 'some-path',
+        };
+
+        await expect(parseFilePipe.transform(requestFile)).to.eventually.eql(
+          requestFile,
+        );
+      });
+    });
+
+    describe('when fileIsRequired is not explicitly provided', () => {
+      beforeEach(() => {
+        parseFilePipe = new ParseFilePipe({
+          validators: [new AlwaysInvalidValidator({})],
+        });
+      });
+
+      it('should throw an error if no file is provided', async () => {
+        const requestFile = undefined;
+
+        await expect(parseFilePipe.transform(requestFile)).to.be.rejectedWith(
+          BadRequestException,
+        );
+      });
+    });
+  });
+});
diff --git a/packages/common/test/pipes/parse-array.pipe.spec.ts b/packages/common/test/pipes/parse-array.pipe.spec.ts
index dd5833002..096ab3f9b 100644
--- a/packages/common/test/pipes/parse-array.pipe.spec.ts
+++ b/packages/common/test/pipes/parse-array.pipe.spec.ts
@@ -78,8 +78,11 @@ describe('ParseArrayPipe', () => {
         target = new ParseArrayPipe();
 
         expect(
-          await target.transform('1,2,3', {} as ArgumentMetadata),
-        ).to.be.deep.equal(['1', '2', '3']);
+          await target.transform(
+            '1,2.0,3,{},true,null,,',
+            {} as ArgumentMetadata,
+          ),
+        ).to.be.deep.equal(['1', '2.0', '3', '{}', 'true', 'null', '', '']);
 
         target = new ParseArrayPipe({ separator: '/' });
 
@@ -151,7 +154,10 @@ describe('ParseArrayPipe', () => {
       class ArrItem {}
 
       it('should validate and transform each item', async () => {
-        target = new ParseArrayPipe({ items: ArrItem });
+        target = new ParseArrayPipe({
+          items: ArrItem,
+          forbidUnknownValues: false,
+        });
 
         let items = await target.transform(
           [{}, {}, {}],
@@ -168,13 +174,16 @@ describe('ParseArrayPipe', () => {
 
         target = new ParseArrayPipe({ items: Number });
         expect(
-          await target.transform('1,2,3', {} as ArgumentMetadata),
+          await target.transform('1,2.0,3', {} as ArgumentMetadata),
         ).to.deep.equal([1, 2, 3]);
 
         target = new ParseArrayPipe({ items: String });
         expect(
-          await target.transform('1,2,3', {} as ArgumentMetadata),
-        ).to.deep.equal(['1', '2', '3']);
+          await target.transform(
+            '1,2.0,3,{},true,null,,',
+            {} as ArgumentMetadata,
+          ),
+        ).to.deep.equal(['1', '2.0', '3', '{}', 'true', 'null', '', '']);
 
         target = new ParseArrayPipe({ items: Boolean });
         expect(
diff --git a/packages/common/test/pipes/parse-int.pipe.spec.ts b/packages/common/test/pipes/parse-int.pipe.spec.ts
index 3bb7ab185..d9d78de27 100644
--- a/packages/common/test/pipes/parse-int.pipe.spec.ts
+++ b/packages/common/test/pipes/parse-int.pipe.spec.ts
@@ -1,4 +1,3 @@
-import * as sinon from 'sinon';
 import { expect } from 'chai';
 import { ArgumentMetadata } from '../../interfaces';
 import { ParseIntPipe } from '../../pipes/parse-int.pipe';
diff --git a/packages/common/test/pipes/parse-uuid.pipe.spec.ts b/packages/common/test/pipes/parse-uuid.pipe.spec.ts
index 3f6cb79fb..bcb3a76b3 100644
--- a/packages/common/test/pipes/parse-uuid.pipe.spec.ts
+++ b/packages/common/test/pipes/parse-uuid.pipe.spec.ts
@@ -1,9 +1,18 @@
 import { expect } from 'chai';
+import { HttpStatus } from '../../enums';
+import { HttpException } from '../../exceptions';
 import { ArgumentMetadata } from '../../interfaces';
 import { ParseUUIDPipe } from '../../pipes/parse-uuid.pipe';
 
+class TestException extends HttpException {
+  constructor() {
+    super('This is a TestException', HttpStatus.I_AM_A_TEAPOT);
+  }
+}
+
 describe('ParseUUIDPipe', () => {
   let target: ParseUUIDPipe;
+  const exceptionFactory = (error: any) => new TestException();
 
   describe('transform', () => {
     const v3 = 'e8b5a51d-11c8-3310-a6ab-367563f20686';
@@ -12,53 +21,80 @@ describe('ParseUUIDPipe', () => {
 
     describe('when validation passes', () => {
       it('should return string if value is uuid v3, v4 or v5', async () => {
-        target = new ParseUUIDPipe();
+        target = new ParseUUIDPipe({ exceptionFactory });
         expect(await target.transform(v3, {} as ArgumentMetadata)).to.equal(v3);
         expect(await target.transform(v4, {} as ArgumentMetadata)).to.equal(v4);
         expect(await target.transform(v5, {} as ArgumentMetadata)).to.equal(v5);
       });
 
       it('should return string if value is uuid v3', async () => {
-        target = new ParseUUIDPipe({ version: '3' });
+        target = new ParseUUIDPipe({ version: '3', exceptionFactory });
         expect(await target.transform(v3, {} as ArgumentMetadata)).to.equal(v3);
       });
 
       it('should return string if value is uuid v4', async () => {
-        target = new ParseUUIDPipe({ version: '4' });
+        target = new ParseUUIDPipe({ version: '4', exceptionFactory });
         expect(await target.transform(v4, {} as ArgumentMetadata)).to.equal(v4);
       });
 
       it('should return string if value is uuid v5', async () => {
-        target = new ParseUUIDPipe({ version: '5' });
+        target = new ParseUUIDPipe({ version: '5', exceptionFactory });
         expect(await target.transform(v5, {} as ArgumentMetadata)).to.equal(v5);
       });
     });
 
     describe('when validation fails', () => {
       it('should throw an error', async () => {
-        target = new ParseUUIDPipe();
-        expect(target.transform('123a', {} as ArgumentMetadata)).to.be.rejected;
+        target = new ParseUUIDPipe({ exceptionFactory });
+        await expect(
+          target.transform('123a', {} as ArgumentMetadata),
+        ).to.be.rejectedWith(TestException);
+      });
+
+      it('should throw an error - not a string', async () => {
+        target = new ParseUUIDPipe({ exceptionFactory });
+        await expect(
+          target.transform(undefined, {} as ArgumentMetadata),
+        ).to.be.rejectedWith(TestException);
       });
 
       it('should throw an error - v3', async () => {
-        target = new ParseUUIDPipe({ version: '3' });
-        expect(target.transform('123a', {} as ArgumentMetadata)).to.be.rejected;
-        expect(target.transform(v4, {} as ArgumentMetadata)).to.be.rejected;
-        expect(target.transform(v5, {} as ArgumentMetadata)).to.be.rejected;
+        target = new ParseUUIDPipe({ version: '3', exceptionFactory });
+        await expect(
+          target.transform('123a', {} as ArgumentMetadata),
+        ).to.be.rejectedWith(TestException);
+        await expect(
+          target.transform(v4, {} as ArgumentMetadata),
+        ).to.be.rejectedWith(TestException);
+        await expect(
+          target.transform(v5, {} as ArgumentMetadata),
+        ).to.be.rejectedWith(TestException);
       });
 
       it('should throw an error - v4', async () => {
-        target = new ParseUUIDPipe({ version: '4' });
-        expect(target.transform('123a', {} as ArgumentMetadata)).to.be.rejected;
-        expect(target.transform(v3, {} as ArgumentMetadata)).to.be.rejected;
-        expect(target.transform(v5, {} as ArgumentMetadata)).to.be.rejected;
+        target = new ParseUUIDPipe({ version: '4', exceptionFactory });
+        await expect(
+          target.transform('123a', {} as ArgumentMetadata),
+        ).to.be.rejectedWith(TestException);
+        await expect(
+          target.transform(v3, {} as ArgumentMetadata),
+        ).to.be.rejectedWith(TestException);
+        await expect(
+          target.transform(v5, {} as ArgumentMetadata),
+        ).to.be.rejectedWith(TestException);
       });
 
       it('should throw an error - v5 ', async () => {
-        target = new ParseUUIDPipe({ version: '5' });
-        expect(target.transform('123a', {} as ArgumentMetadata)).to.be.rejected;
-        expect(target.transform(v3, {} as ArgumentMetadata)).to.be.rejected;
-        expect(target.transform(v4, {} as ArgumentMetadata)).to.be.rejected;
+        target = new ParseUUIDPipe({ version: '5', exceptionFactory });
+        await expect(
+          target.transform('123a', {} as ArgumentMetadata),
+        ).to.be.rejectedWith(TestException);
+        await expect(
+          target.transform(v3, {} as ArgumentMetadata),
+        ).to.be.rejectedWith(TestException);
+        await expect(
+          target.transform(v4, {} as ArgumentMetadata),
+        ).to.be.rejectedWith(TestException);
       });
     });
   });
diff --git a/packages/common/test/pipes/validation.pipe.spec.ts b/packages/common/test/pipes/validation.pipe.spec.ts
index 00a69a42d..980c43212 100644
--- a/packages/common/test/pipes/validation.pipe.spec.ts
+++ b/packages/common/test/pipes/validation.pipe.spec.ts
@@ -3,12 +3,12 @@ import { expect } from 'chai';
 import * as chaiAsPromised from 'chai-as-promised';
 import { Exclude, Expose, Type } from 'class-transformer';
 import {
+  IsArray,
   IsBoolean,
   IsDefined,
   IsOptional,
   IsString,
   ValidateNested,
-  IsArray,
 } from 'class-validator';
 import { HttpStatus } from '../../enums';
 import { UnprocessableEntityException } from '../../exceptions';
@@ -45,7 +45,7 @@ class TestModel {
   public optionalProp: string;
 }
 
-class TestModelNoValidaton {
+class TestModelNoValidation {
   constructor() {}
 
   public prop1: string;
@@ -221,7 +221,7 @@ describe('ValidationPipe', () => {
         });
       });
       describe('when input is a query parameter (boolean)', () => {
-        it('should parse to boolean', async () => {
+        it('should parse the string "true" to the boolean true', async () => {
           target = new ValidationPipe({ transform: true });
           const value = 'true';
 
@@ -233,9 +233,45 @@ describe('ValidationPipe', () => {
             }),
           ).to.be.true;
         });
+        it('should parse the string "false" to the boolean false', async () => {
+          target = new ValidationPipe({ transform: true });
+          const value = 'false';
+
+          expect(
+            await target.transform(value, {
+              metatype: Boolean,
+              data: 'test',
+              type: 'query',
+            }),
+          ).to.be.false;
+        });
+        it('should parse an empty string to false', async () => {
+          target = new ValidationPipe({ transform: true });
+          const value = '';
+
+          expect(
+            await target.transform(value, {
+              metatype: Boolean,
+              data: 'test',
+              type: 'query',
+            }),
+          ).to.be.false;
+        });
+        it('should parse undefined to undefined', async () => {
+          target = new ValidationPipe({ transform: true });
+          const value = undefined;
+
+          expect(
+            await target.transform(value, {
+              metatype: Boolean,
+              data: 'test',
+              type: 'query',
+            }),
+          ).to.be.undefined;
+        });
       });
       describe('when input is a path parameter (boolean)', () => {
-        it('should parse to boolean', async () => {
+        it('should parse the string "true" to boolean true', async () => {
           target = new ValidationPipe({ transform: true });
           const value = 'true';
 
@@ -247,6 +283,42 @@ describe('ValidationPipe', () => {
             }),
           ).to.be.true;
         });
+        it('should parse the string "false" to boolean false', async () => {
+          target = new ValidationPipe({ transform: true });
+          const value = 'false';
+
+          expect(
+            await target.transform(value, {
+              metatype: Boolean,
+              data: 'test',
+              type: 'param',
+            }),
+          ).to.be.false;
+        });
+        it('should parse an empty string to false', async () => {
+          target = new ValidationPipe({ transform: true });
+          const value = '';
+
+          expect(
+            await target.transform(value, {
+              metatype: Boolean,
+              data: 'test',
+              type: 'param',
+            }),
+          ).to.be.false;
+        });
+        it('should parse undefined to undefined', async () => {
+          target = new ValidationPipe({ transform: true });
+          const value = undefined;
+
+          expect(
+            await target.transform(value, {
+              metatype: Boolean,
+              data: 'test',
+              type: 'param',
+            }),
+          ).to.be.undefined;
+        });
       });
       describe('when validation strips', () => {
         it('should return a TestModel without extra properties', async () => {
@@ -367,7 +439,7 @@ describe('ValidationPipe', () => {
         });
       });
     });
-    describe('when type doesnt match', () => {
+    describe("when type doesn't match", () => {
       describe('when validation rules are applied', () => {
         it('should throw an error', async () => {
           target = new ValidationPipe();
@@ -389,7 +461,7 @@ describe('ValidationPipe', () => {
             { prop1: 'value1', prop2: 'value2', prop3: 'value3' },
           ];
 
-          const objMetadata = { ...metadata, metatype: TestModelNoValidaton };
+          const objMetadata = { ...metadata, metatype: TestModelNoValidation };
           const result = await target.transform(testObj, objMetadata);
 
           expect(result).to.not.be.instanceOf(TestModel);
@@ -447,7 +519,7 @@ describe('ValidationPipe', () => {
       target = new ValidationPipe({ expectedType: TestModel });
       const testObj = { prop1: 'value1', prop2: 'value2' };
 
-      expect(await target.transform(testObj, m)).to.equal(testObj);
+      expect(await target.transform(testObj, m)).to.deep.equal(testObj);
     });
 
     it('should validate against the expected type if presented and metatype is primitive type', async () => {
@@ -460,7 +532,7 @@ describe('ValidationPipe', () => {
       target = new ValidationPipe({ expectedType: TestModel });
       const testObj = { prop1: 'value1', prop2: 'value2' };
 
-      expect(await target.transform(testObj, m)).to.equal(testObj);
+      expect(await target.transform(testObj, m)).to.deep.equal(testObj);
     });
   });
 });
diff --git a/packages/common/test/services/logger.service.spec.ts b/packages/common/test/services/logger.service.spec.ts
index 5caa83a65..6ce8c96c0 100644
--- a/packages/common/test/services/logger.service.spec.ts
+++ b/packages/common/test/services/logger.service.spec.ts
@@ -1,7 +1,7 @@
 import { expect } from 'chai';
 import 'reflect-metadata';
 import * as sinon from 'sinon';
-import { ConsoleLogger, Logger, LoggerService } from '../../services';
+import { ConsoleLogger, Logger, LoggerService, LogLevel } from '../../services';
 
 describe('Logger', () => {
   describe('[static methods]', () => {
@@ -256,6 +256,34 @@ describe('Logger', () => {
       loggerWithContext.resetContext();
       expect(loggerWithContext['context']).to.equal('context');
     });
+
+    describe('functions for message', () => {
+      let processStdoutWriteSpy: sinon.SinonSpy;
+      const logger = new ConsoleLogger();
+      const message = 'Hello World';
+
+      beforeEach(() => {
+        processStdoutWriteSpy = sinon.spy(process.stdout, 'write');
+      });
+      afterEach(() => {
+        processStdoutWriteSpy.restore();
+      });
+
+      it('works', () => {
+        logger.log(() => message);
+
+        expect(processStdoutWriteSpy.calledOnce).to.be.true;
+        expect(processStdoutWriteSpy.firstCall.firstArg).to.include(message);
+        // Ensure we didn't serialize the function itself.
+        expect(processStdoutWriteSpy.firstCall.firstArg).not.to.include(' => ');
+        expect(processStdoutWriteSpy.firstCall.firstArg).not.to.include(
+          'function',
+        );
+        expect(processStdoutWriteSpy.firstCall.firstArg).not.to.include(
+          'Function',
+        );
+      });
+    });
   });
 
   describe('[instance methods]', () => {
@@ -442,6 +470,17 @@ describe('Logger', () => {
         );
         expect(processStdoutWriteSpy.thirdCall.firstArg).to.include('ms');
       });
+      it('should log out an error to stderr but not include an undefined log', () => {
+        const message = 'message 1';
+
+        logger.error(message);
+
+        expect(processStderrWriteSpy.calledOnce).to.be.true;
+        expect(processStderrWriteSpy.firstCall.firstArg).to.include(
+          `[${globalContext}]`,
+        );
+        expect(processStderrWriteSpy.firstCall.firstArg).to.include(message);
+      });
     });
 
     describe('when logging is disabled', () => {
@@ -480,44 +519,194 @@ describe('Logger', () => {
         warn(message: any, context?: string) {}
       }
 
-      const customLogger = new CustomLogger();
-      const originalLogger = new Logger();
+      describe('with global context', () => {
+        const customLogger = new CustomLogger();
+        const globalContext = 'RandomContext';
+        const originalLogger = new Logger(globalContext);
 
-      let previousLoggerRef: LoggerService;
+        let previousLoggerRef: LoggerService;
 
-      beforeEach(() => {
-        previousLoggerRef =
-          Logger['localInstanceRef'] || Logger['staticInstanceRef'];
-        Logger.overrideLogger(customLogger);
-      });
+        beforeEach(() => {
+          previousLoggerRef =
+            Logger['localInstanceRef'] || Logger['staticInstanceRef'];
+          Logger.overrideLogger(customLogger);
+        });
 
-      afterEach(() => {
-        Logger.overrideLogger(previousLoggerRef);
-      });
+        afterEach(() => {
+          Logger.overrideLogger(previousLoggerRef);
+        });
 
-      it('should call custom logger "#log()" method', () => {
-        const message = 'random message';
-        const context = 'RandomContext';
+        it('should call custom logger "#log()" method with context as second argument', () => {
+          const message = 'random log message with global context';
 
-        const customLoggerLogSpy = sinon.spy(customLogger, 'log');
+          const customLoggerLogSpy = sinon.spy(customLogger, 'log');
 
-        originalLogger.log(message, context);
+          originalLogger.log(message);
 
-        expect(customLoggerLogSpy.called).to.be.true;
-        expect(customLoggerLogSpy.calledWith(message, context)).to.be.true;
+          expect(customLoggerLogSpy.called).to.be.true;
+          expect(customLoggerLogSpy.calledWith(message, globalContext)).to.be
+            .true;
+        });
+        it('should call custom logger "#error()" method with context as third argument', () => {
+          const message = 'random error message with global context';
+
+          const customLoggerErrorSpy = sinon.spy(customLogger, 'error');
+
+          originalLogger.error(message);
+
+          expect(customLoggerErrorSpy.called).to.be.true;
+          expect(
+            customLoggerErrorSpy.calledWith(message, undefined, globalContext),
+          ).to.be.true;
+        });
       });
+      describe('without global context', () => {
+        const customLogger = new CustomLogger();
+        const originalLogger = new Logger();
 
-      it('should call custom logger "#error()" method', () => {
-        const message = 'random message';
-        const context = 'RandomContext';
+        let previousLoggerRef: LoggerService;
 
-        const customLoggerErrorSpy = sinon.spy(customLogger, 'error');
+        beforeEach(() => {
+          previousLoggerRef =
+            Logger['localInstanceRef'] || Logger['staticInstanceRef'];
+          Logger.overrideLogger(customLogger);
+        });
 
-        originalLogger.error(message, context);
+        afterEach(() => {
+          Logger.overrideLogger(previousLoggerRef);
+        });
 
-        expect(customLoggerErrorSpy.called).to.be.true;
-        expect(customLoggerErrorSpy.calledWith(message, context)).to.be.true;
+        it('should call custom logger "#log()" method', () => {
+          const message = 'random message';
+          const context = 'RandomContext';
+
+          const customLoggerLogSpy = sinon.spy(customLogger, 'log');
+
+          originalLogger.log(message, context);
+
+          expect(customLoggerLogSpy.called).to.be.true;
+          expect(customLoggerLogSpy.calledWith(message, context)).to.be.true;
+        });
+
+        it('should call custom logger "#error()" method', () => {
+          const message = 'random message';
+          const context = 'RandomContext';
+
+          const customLoggerErrorSpy = sinon.spy(customLogger, 'error');
+
+          originalLogger.error(message, undefined, context);
+
+          expect(customLoggerErrorSpy.called).to.be.true;
+          expect(customLoggerErrorSpy.calledWith(message, undefined, context))
+            .to.be.true;
+        });
       });
     });
   });
+  describe('ConsoleLogger', () => {
+    let processStdoutWriteSpy: sinon.SinonSpy;
+
+    beforeEach(() => {
+      processStdoutWriteSpy = sinon.spy(process.stdout, 'write');
+    });
+    afterEach(() => {
+      processStdoutWriteSpy.restore();
+    });
+
+    it('should support custom formatter', () => {
+      class CustomConsoleLogger extends ConsoleLogger {
+        protected formatMessage(
+          logLevel: LogLevel,
+          message: unknown,
+          pidMessage: string,
+          formattedLogLevel: string,
+          contextMessage: string,
+          timestampDiff: string,
+        ) {
+          return `Prefix: ${message}`;
+        }
+      }
+
+      const consoleLogger = new CustomConsoleLogger();
+      consoleLogger.debug('test');
+
+      expect(processStdoutWriteSpy.firstCall.firstArg).to.equal(`Prefix: test`);
+    });
+
+    it('should support custom formatter and colorizer', () => {
+      class CustomConsoleLogger extends ConsoleLogger {
+        protected formatMessage(
+          logLevel: LogLevel,
+          message: unknown,
+          pidMessage: string,
+          formattedLogLevel: string,
+          contextMessage: string,
+          timestampDiff: string,
+        ) {
+          const strMessage = this.stringifyMessage(message, logLevel);
+          return `Prefix: ${strMessage}`;
+        }
+
+        protected colorize(message: string, logLevel: LogLevel): string {
+          return `~~~${message}~~~`;
+        }
+      }
+
+      const consoleLogger = new CustomConsoleLogger();
+      consoleLogger.debug('test');
+
+      expect(processStdoutWriteSpy.firstCall.firstArg).to.equal(
+        `Prefix: ~~~test~~~`,
+      );
+    });
+
+    it('should stringify messages', () => {
+      class CustomConsoleLogger extends ConsoleLogger {
+        protected colorize(message: string, _: LogLevel): string {
+          return message;
+        }
+      }
+
+      const consoleLogger = new CustomConsoleLogger();
+      const consoleLoggerSpy = sinon.spy(
+        consoleLogger,
+        'stringifyMessage' as keyof ConsoleLogger,
+      );
+      consoleLogger.debug(
+        'str1',
+        { key: 'str2' },
+        ['str3'],
+        [{ key: 'str4' }],
+        null,
+        1,
+      );
+
+      expect(consoleLoggerSpy.getCall(0).returnValue).to.equal('str1');
+      expect(consoleLoggerSpy.getCall(1).returnValue).to.equal(
+        `Object:
+{
+  "key": "str2"
+}
+`,
+      );
+      expect(consoleLoggerSpy.getCall(2).returnValue).to.equal(
+        `Object:
+[
+  "str3"
+]
+`,
+      );
+      expect(consoleLoggerSpy.getCall(3).returnValue).to.equal(
+        `Object:
+[
+  {
+    "key": "str4"
+  }
+]
+`,
+      );
+      expect(consoleLoggerSpy.getCall(4).returnValue).to.equal(null);
+      expect(consoleLoggerSpy.getCall(5).returnValue).to.equal(1);
+    });
+  });
 });
diff --git a/packages/common/test/tsconfig.json b/packages/common/test/tsconfig.json
new file mode 100644
index 000000000..50d59661d
--- /dev/null
+++ b/packages/common/test/tsconfig.json
@@ -0,0 +1,3 @@
+{
+  "extends": "../../../tsconfig.spec.json"
+}
diff --git a/packages/common/test/utils/select-exception-filter-metadata.util.spec.ts b/packages/common/test/utils/select-exception-filter-metadata.util.spec.ts
new file mode 100644
index 000000000..f2fb5b92f
--- /dev/null
+++ b/packages/common/test/utils/select-exception-filter-metadata.util.spec.ts
@@ -0,0 +1,85 @@
+import { expect } from 'chai';
+import { selectExceptionFilterMetadata } from '../../utils/select-exception-filter-metadata.util';
+
+class FirstError {}
+
+class SecondError {}
+
+class ThirdError {}
+
+class FourthError {}
+
+describe('selectExceptionFilterMetadata', () => {
+  it('should pass error handling to first suitable error handler', () => {
+    const metadataList = [
+      {
+        exceptionMetatypes: [FirstError, SecondError],
+        func: () => {},
+      },
+      {
+        exceptionMetatypes: [ThirdError, FourthError],
+        func: () => {},
+      },
+    ];
+
+    expect(
+      selectExceptionFilterMetadata(metadataList, new FourthError()),
+    ).to.be.equal(metadataList[1]);
+  });
+
+  describe('when multiple exception handlers are accepting error handling', () => {
+    it('should pass exception handling to the first one', () => {
+      const metadataList = [
+        {
+          exceptionMetatypes: [FirstError, SecondError],
+          func: () => {},
+        },
+        {
+          exceptionMetatypes: [FirstError, FourthError],
+          func: () => {},
+        },
+      ];
+
+      expect(
+        selectExceptionFilterMetadata(metadataList, new FirstError()),
+      ).to.be.equal(metadataList[0]);
+    });
+  });
+
+  describe('when no exception handler is accepting error handling', () => {
+    it('should return undefined', () => {
+      const metadataList = [
+        {
+          exceptionMetatypes: [FirstError, SecondError],
+          func: () => {},
+        },
+        {
+          exceptionMetatypes: [FirstError, FourthError],
+          func: () => {},
+        },
+      ];
+
+      expect(selectExceptionFilterMetadata(metadataList, new ThirdError())).to
+        .be.undefined;
+    });
+  });
+
+  describe('when exception handler has empty list of meta types', () => {
+    it('should pass any remaining error handling to it', () => {
+      const metadataList = [
+        {
+          exceptionMetatypes: [FirstError, SecondError],
+          func: () => {},
+        },
+        {
+          exceptionMetatypes: [],
+          func: () => {},
+        },
+      ];
+
+      expect(
+        selectExceptionFilterMetadata(metadataList, new ThirdError()),
+      ).to.be.equal(metadataList[1]);
+    });
+  });
+});
diff --git a/packages/common/test/utils/shared.utils.spec.ts b/packages/common/test/utils/shared.utils.spec.ts
index a4ce885c0..d37ac4a0f 100644
--- a/packages/common/test/utils/shared.utils.spec.ts
+++ b/packages/common/test/utils/shared.utils.spec.ts
@@ -5,9 +5,11 @@ import {
   isEmpty,
   isFunction,
   isNil,
+  isNumber,
   isObject,
   isPlainObject,
   isString,
+  isSymbol,
   isUndefined,
   normalizePath,
   stripEndSlash,
@@ -66,15 +68,44 @@ describe('Shared utils', () => {
     });
   });
   describe('isString', () => {
-    it('should return true when obj is a string', () => {
+    it('should return true when val is a string', () => {
       expect(isString('true')).to.be.true;
     });
-    it('should return false when object is not a string', () => {
+    it('should return false when val is not a string', () => {
+      expect(isString(new String('fine'))).to.be.false;
       expect(isString(false)).to.be.false;
       expect(isString(null)).to.be.false;
       expect(isString(undefined)).to.be.false;
     });
   });
+  describe('isSymbol', () => {
+    it('should return true when val is a Symbol', () => {
+      expect(isSymbol(Symbol())).to.be.true;
+    });
+    it('should return false when val is not a symbol', () => {
+      expect(isSymbol('Symbol()')).to.be.false;
+      expect(isSymbol(false)).to.be.false;
+      expect(isSymbol(null)).to.be.false;
+      expect(isSymbol(undefined)).to.be.false;
+    });
+  });
+  describe('isNumber', () => {
+    it('should return true when val is a number or NaN', () => {
+      expect(isNumber(1)).to.be.true;
+      expect(isNumber(1.23)).to.be.true; // with decimals
+      expect(isNumber(123e-5)).to.be.true; // scientific (exponent) notation
+      expect(isNumber(0o1)).to.be.true; // octal notation
+      expect(isNumber(0b1)).to.be.true; // binary notation
+      expect(isNumber(0x1)).to.be.true; // hexadecimal notation
+      expect(isNumber(NaN)).to.be.true;
+    });
+    it('should return false when val is not a number', () => {
+      // expect(isNumber(1n)).to.be.false; // big int (available on ES2020)
+      expect(isNumber('1')).to.be.false; // string
+      expect(isNumber(undefined)).to.be.false; // nullish
+      expect(isNumber(null)).to.be.false; // nullish
+    });
+  });
   describe('isConstructor', () => {
     it('should return true when string is equal to constructor', () => {
       expect(isConstructor('constructor')).to.be.true;
diff --git a/packages/common/tsconfig.build.json b/packages/common/tsconfig.build.json
new file mode 100644
index 000000000..2d16c3a20
--- /dev/null
+++ b/packages/common/tsconfig.build.json
@@ -0,0 +1,10 @@
+{
+  "extends": "../tsconfig.build.json",
+  "compilerOptions": {
+    "outDir": ".",
+    "rootDir": ".",
+    "paths": {}
+  },
+  "exclude": ["node_modules", "dist", "test/**/*", "*.spec.ts"],
+  "references": []
+}
diff --git a/packages/common/tsconfig.json b/packages/common/tsconfig.json
index b238080a4..2ae9e3c90 100644
--- a/packages/common/tsconfig.json
+++ b/packages/common/tsconfig.json
@@ -1,7 +1,13 @@
 {
-  "extends": "./../tsconfig.base.json",
+  "extends": "../tsconfig.build.json",
   "compilerOptions": {
-    "baseUrl": "./"
+    "types": ["node"]
   },
-  "include": ["*.ts", "**/*.ts"]
+  "files": [],
+  "include": [],
+  "references": [
+    {
+      "path": "./tsconfig.build.json"
+    }
+  ]
 }
diff --git a/packages/common/utils/assign-custom-metadata.util.ts b/packages/common/utils/assign-custom-metadata.util.ts
index 3fb311647..38bd926db 100644
--- a/packages/common/utils/assign-custom-metadata.util.ts
+++ b/packages/common/utils/assign-custom-metadata.util.ts
@@ -1,4 +1,4 @@
-import { CUSTOM_ROUTE_AGRS_METADATA } from '../constants';
+import { CUSTOM_ROUTE_ARGS_METADATA } from '../constants';
 import {
   ParamData,
   RouteParamMetadata,
@@ -16,7 +16,7 @@ export function assignCustomParameterMetadata(
 ) {
   return {
     ...args,
-    [`${paramtype}${CUSTOM_ROUTE_AGRS_METADATA}:${index}`]: {
+    [`${paramtype}${CUSTOM_ROUTE_ARGS_METADATA}:${index}`]: {
       index,
       factory,
       data,
diff --git a/packages/common/utils/cli-colors.util.ts b/packages/common/utils/cli-colors.util.ts
index 8efd61670..738fbc6d3 100644
--- a/packages/common/utils/cli-colors.util.ts
+++ b/packages/common/utils/cli-colors.util.ts
@@ -5,6 +5,7 @@ const colorIfAllowed = (colorFn: ColorTextFn) => (text: string) =>
   isColorAllowed() ? colorFn(text) : text;
 
 export const clc = {
+  bold: colorIfAllowed((text: string) => `\x1B[1m${text}\x1B[0m`),
   green: colorIfAllowed((text: string) => `\x1B[32m${text}\x1B[39m`),
   yellow: colorIfAllowed((text: string) => `\x1B[33m${text}\x1B[39m`),
   red: colorIfAllowed((text: string) => `\x1B[31m${text}\x1B[39m`),
diff --git a/packages/common/utils/forward-ref.util.ts b/packages/common/utils/forward-ref.util.ts
index a43ac6df2..1b380c022 100644
--- a/packages/common/utils/forward-ref.util.ts
+++ b/packages/common/utils/forward-ref.util.ts
@@ -1,5 +1,8 @@
 import { ForwardReference } from '../interfaces/modules/forward-reference.interface';
 
+/**
+ * @publicApi
+ */
 export const forwardRef = (fn: () => any): ForwardReference => ({
   forwardRef: fn,
 });
diff --git a/packages/common/utils/is-uuid.ts b/packages/common/utils/is-uuid.ts
deleted file mode 100644
index 4c5474ade..000000000
--- a/packages/common/utils/is-uuid.ts
+++ /dev/null
@@ -1,16 +0,0 @@
-import { BadRequestException } from '../exceptions';
-
-const uuid = {
-  3: /^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,
-  4: /^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,
-  5: /^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,
-  all: /^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i,
-};
-
-export function isUUID(str: any, version = 'all') {
-  if (typeof str !== 'string') {
-    throw new BadRequestException('The value passed as UUID is not a string');
-  }
-  const pattern = uuid[version];
-  return pattern && pattern.test(str);
-}
diff --git a/packages/common/utils/random-string-generator.util.ts b/packages/common/utils/random-string-generator.util.ts
index 6897e6e7d..7e39be7b5 100644
--- a/packages/common/utils/random-string-generator.util.ts
+++ b/packages/common/utils/random-string-generator.util.ts
@@ -1,3 +1,3 @@
-import { v4 as uuid } from 'uuid';
+import { uid } from 'uid';
 
-export const randomStringGenerator = () => uuid();
+export const randomStringGenerator = () => uid(21);
diff --git a/packages/common/utils/select-exception-filter-metadata.util.ts b/packages/common/utils/select-exception-filter-metadata.util.ts
new file mode 100644
index 000000000..e1e1661f5
--- /dev/null
+++ b/packages/common/utils/select-exception-filter-metadata.util.ts
@@ -0,0 +1,13 @@
+import { ExceptionFilterMetadata } from '../interfaces/exceptions';
+
+export const selectExceptionFilterMetadata = <T = any>(
+  filters: ExceptionFilterMetadata[],
+  exception: T,
+): ExceptionFilterMetadata | undefined =>
+  filters.find(
+    ({ exceptionMetatypes }) =>
+      !exceptionMetatypes.length ||
+      exceptionMetatypes.some(
+        ExceptionMetaType => exception instanceof ExceptionMetaType,
+      ),
+  );
diff --git a/packages/common/utils/shared.utils.ts b/packages/common/utils/shared.utils.ts
index d988f0139..876b41551 100644
--- a/packages/common/utils/shared.utils.ts
+++ b/packages/common/utils/shared.utils.ts
@@ -31,12 +31,6 @@ export const addLeadingSlash = (path?: string): string =>
       : path
     : '';
 
-/**
- * Deprecated. Use the "addLeadingSlash" function instead.
- * @deprecated
- */
-export const validatePath = addLeadingSlash;
-
 export const normalizePath = (path?: string): string =>
   path
     ? path.startsWith('/')
@@ -47,10 +41,12 @@ export const normalizePath = (path?: string): string =>
 export const stripEndSlash = (path: string) =>
   path[path.length - 1] === '/' ? path.slice(0, path.length - 1) : path;
 
-export const isFunction = (fn: any): boolean => typeof fn === 'function';
-export const isString = (fn: any): fn is string => typeof fn === 'string';
-export const isConstructor = (fn: any): boolean => fn === 'constructor';
-export const isNil = (obj: any): obj is null | undefined =>
-  isUndefined(obj) || obj === null;
+export const isFunction = (val: any): val is Function =>
+  typeof val === 'function';
+export const isString = (val: any): val is string => typeof val === 'string';
+export const isNumber = (val: any): val is number => typeof val === 'number';
+export const isConstructor = (val: any): boolean => val === 'constructor';
+export const isNil = (val: any): val is null | undefined =>
+  isUndefined(val) || val === null;
 export const isEmpty = (array: any): boolean => !(array && array.length > 0);
-export const isSymbol = (fn: any): fn is symbol => typeof fn === 'symbol';
+export const isSymbol = (val: any): val is symbol => typeof val === 'symbol';
diff --git a/packages/core/CHANGELOG.md b/packages/core/CHANGELOG.md
deleted file mode 100644
index f16fa8cd1..000000000
--- a/packages/core/CHANGELOG.md
+++ /dev/null
@@ -1,12 +0,0 @@
-# Change Log
-
-All notable changes to this project will be documented in this file.
-See [Conventional Commits](https://conventionalcommits.org) for commit guidelines.
-
-<a name="8.2.0"></a>
-# [8.2.0](https://github.com/nestjs/nest/compare/v8.1.2...v8.2.0) (2021-11-08)
-
-
-
-
-**Note:** Version bump only for package @nestjs/core
diff --git a/packages/core/Readme.md b/packages/core/Readme.md
index f288809a9..16f48336d 100644
--- a/packages/core/Readme.md
+++ b/packages/core/Readme.md
@@ -11,7 +11,6 @@
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
 <a href="https://circleci.com/gh/nestjs/nest" target="_blank"><img src="https://img.shields.io/circleci/build/github/nestjs/nest/master" alt="CircleCI" /></a>
-<a href="https://coveralls.io/github/nestjs/nest?branch=master" target="_blank"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#9" alt="Coverage" /></a>
 <a href="https://discord.gg/G7Qnnhy" target="_blank"><img src="https://img.shields.io/badge/discord-online-brightgreen.svg" alt="Discord"/></a>
 <a href="https://opencollective.com/nest#backer" target="_blank"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
 <a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
@@ -37,8 +36,8 @@ Nest is a framework for building efficient, scalable <a href="http://nodejs.org"
 
 * To check out the [guide](https://docs.nestjs.com), visit [docs.nestjs.com](https://docs.nestjs.com). :books:
 * Ë¶ÅÊü•Áúã‰∏≠Êñá [ÊåáÂçó](readme_zh.md), ËØ∑ËÆøÈóÆ [docs.nestjs.cn](https://docs.nestjs.cn). :books:
-* [Í∞ÄÏù¥Îìú](readme_kr.md)Î•º ÌôïÏù∏ÌïòÎ†§Î©¥, [docs.nestjs.com](https://docs.nestjs.com)Î•º Î∞©Î¨∏ÌïòÏÑ∏Ïöî.:books: 
-* „ÉÅ„Çß„ÉÉ„ÇØ„Åô„Çã„Å´„ÅØ [„Ç¨„Ç§„Éâ](readme_jp.md), Ë©≥„Åó„Åè„ÅØ [docs.nestjs.com](https://docs.nestjs.com). :books: 
+* [Í∞ÄÏù¥Îìú](readme_kr.md) Î¨∏ÏÑúÎäî [docs.nestjs.com](https://docs.nestjs.com)ÏóêÏÑú ÌôïÏù∏ÌïòÏã§ Ïàò ÏûàÏäµÎãàÎã§. :books:
+* [„Ç¨„Ç§„Éâ](readme_jp.md)„ÅØ [docs.nestjs.com](https://docs.nestjs.com)„Åß„ÅîÁ¢∫Ë™ç„Åè„Å†„Åï„ÅÑ„ÄÇ :books:
 
 ## Questions
 
@@ -54,36 +53,49 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
 <table style="text-align:center;"><tr>
   <td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
+  <td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/red-hat-logo.svg" width="200" valign="middle" /></a></td>
 <td>
 <a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
 <td>
 <a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
+    <td>
+<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td><td>
+<a href="https://amplication.com/" target="_blank"><img src="https://nestjs.com/img/amplication-logo.svg" width="190" valign="middle" /></a></td>
 </tr></table>
 
 #### Gold Sponsors
 
 <table style="text-align:center;"><tr><td>
-  <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
-  <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
+<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="140" valign="middle" /></a></td>
 <td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
+<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td>
+ <td>
+<a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
+<a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td><td>
+<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td>
+<td>
+<a href="https://ridicorp.com/career/" target="_blank"><img src="https://nestjs.com/img/ridi-logo.svg" width="105" valign="middle" /></a></td><td>
+<a href="https://www.movavi.com/imovie-for-windows.html" target="_blank"><img src="https://nestjs.com/img/movavi-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
 <table style="text-align:center;"><tr><td>
 <a href="https://neoteric.eu/" target="_blank"><img src="https://nestjs.com/img/neoteric-cut.png" width="120" valign="middle" /></a> </td><td>
   <a href="http://gojob.com" target="_blank"><img src="http://nestjs.com/img/gojob-logo.png" valign="middle" width="100" /></a> </td><td>
-<a href="http://www.leogistics.com" target="_blank"><img src="https://nestjs.com/img/leogistics-logo.jpeg" width="150" valign="middle" /></td><td>
+<a href="https://www.myleodsc.com/" target="_blank"><img src="https://nestjs.com/img/myleo-logo.png" width="180" valign="middle" /></td><td>
 <a href="https://careers.meetdandy.com/?gh_src=063ba61e3us" target="_blank"><img src="https://nestjs.com/img/dandy-roles-logo.svg" width="150" valign="middle" /></td><td>
 <a href="https://www.castlecraft.in" target="_blank"><img src="https://nestjs.com/img/castlecraft-logo.png" width="150" valign="middle" /></td>
-<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td></tr></table>
+<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td>
+<td><a href="https://n.inc" target="_blank"><img src="https://nestjs.com/img/n-inc-logo.svg" width="120" valign="middle" /></td></tr><tr>
+<td><a href="https://bilberrry.com/" target="_blank"><img src="https://nestjs.com/img/bilberrry-logo.svg" width="180" valign="middle" /></td>
+<td><a href="https://ipinfo.ai/" target="_blank"><img src="https://nestjs.com/img/ipinfo-logo.png" width="130" valign="middle" /></td>
+<td><a href="https://chax.at" target="_blank"><img src="https://nestjs.com/img/chaxat-logo.png" width="100" valign="middle" /></td></tr>
+</table>
 
 #### Sponsors
 
@@ -91,7 +103,7 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <a href="https://www.swingdev.io" target="_blank"><img src="https://nestjs.com/img/swingdev-logo.svg#1" width="110" valign="middle" /> </a></td><td align="center" valign="middle">
 <a href="https://www.novologic.com/" target="_blank"><img src="https://nestjs.com/img/novologic.png" width="110" valign="middle" /></a> </td><td align="center" valign="middle">
 <a href="https://ever.co/" target="_blank"><img src="https://nestjs.com/img/ever-logo.png" width="72" valign="middle" /></a>  </td><td align="center" valign="middle">
-<a href="https://blokt.com" target="_blank"><img src="https://nestjs.com/img/blokt-logo.png" width="120" valign="middle" /></a>  </td><td align="center" valign="middle"> 
+<a href="https://blokt.com" target="_blank"><img src="https://nestjs.com/img/blokt-logo.png" width="120" valign="middle" /></a>  </td><td align="center" valign="middle">
   <a href="http://architectnow.net/" target="_blank"><img src="https://nestjs.com/img/architectnow.png" width="125" valign="middle" /></a> </td><td align="center" valign="middle">
   <a href="https://quander.io/" target="_blank"><img src="https://nestjs.com/img/quander.png" width="100" valign="middle" /></a> </td></tr><tr><td align="center" valign="middle">
   <a href="https://mantro.net/" target="_blank"><img src="https://nestjs.com/img/mantro-logo.svg" width="95" valign="middle" /></a> </td><td align="center" valign="middle">
@@ -117,6 +129,14 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/naologic-logo.svg" width="125" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://messaged.com/" target="_blank"><img src="https://nestjs.com/img/messaged-logo.png" width="50" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/triplecore-logo.svg" width="50" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://klqc.de" target="_blank"><img src="https://nestjs.com/img/klcqcl-logo.png" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://thecasinowizard.com/bonuses/no-deposit-bonuses/" target="_blank"><img src="https://nestjs.com/img/casinowizard-logo.png" width="120" valign="middle" /></a></td></tr><tr>
+     <td align="center" valign="middle"><a href="https://polygon-software.ch/" target="_blank"><img src="https://nestjs.com/img/polygon-logo.svg" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://mobilereality.pl/" target="_blank"><img src="https://nestjs.com/img/mobile-reality-logo.png" width="45" valign="middle" /></a></td>
+     <td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/boringowl-logo.svg" width="120" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://www.mobilefactory.jp/" target="_blank"><img src="https://nestjs.com/img/mobilefactory-logo.png" width="100" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://nordbot.app/" target="_blank"><img src="https://nestjs.com/img/nordbot-logo.png" width="120" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://doppio.sh/" target="_blank"><img src="https://nestjs.com/img/dopiosh-logo.png" width="50" valign="middle" /></a></td>
   </tr></table>
 
 ## Backers
diff --git a/packages/core/adapters/http-adapter.ts b/packages/core/adapters/http-adapter.ts
index b5379933a..6bfc4add7 100644
--- a/packages/core/adapters/http-adapter.ts
+++ b/packages/core/adapters/http-adapter.ts
@@ -1,5 +1,5 @@
-import { HttpServer, RequestMethod } from '@nestjs/common';
-import { RequestHandler } from '@nestjs/common/interfaces';
+import { HttpServer, RequestMethod, VersioningOptions } from '@nestjs/common';
+import { RequestHandler, VersionValue } from '@nestjs/common/interfaces';
 import {
   CorsOptions,
   CorsOptionsDelegate,
@@ -68,6 +68,12 @@ export abstract class AbstractHttpAdapter<
     return this.instance.all(...args);
   }
 
+  public search(port: string | number, callback?: () => void);
+  public search(port: string | number, hostname: string, callback?: () => void);
+  public search(port: any, hostname?: any, callback?: any) {
+    return this.instance.search(port, hostname, callback);
+  }
+
   public options(handler: RequestHandler);
   public options(path: any, handler: RequestHandler);
   public options(...args: any[]) {
@@ -100,17 +106,19 @@ export abstract class AbstractHttpAdapter<
   abstract initHttpServer(options: NestApplicationOptions);
   abstract useStaticAssets(...args: any[]);
   abstract setViewEngine(engine: string);
-  abstract getRequestHostname(request);
-  abstract getRequestMethod(request);
-  abstract getRequestUrl(request);
-  abstract status(response, statusCode: number);
-  abstract reply(response, body: any, statusCode?: number);
-  abstract render(response, view: string, options: any);
-  abstract redirect(response, statusCode: number, url: string);
+  abstract getRequestHostname(request: any);
+  abstract getRequestMethod(request: any);
+  abstract getRequestUrl(request: any);
+  abstract status(response: any, statusCode: number);
+  abstract reply(response: any, body: any, statusCode?: number);
+  abstract end(response: any, message?: string);
+  abstract render(response: any, view: string, options: any);
+  abstract redirect(response: any, statusCode: number, url: string);
   abstract setErrorHandler(handler: Function, prefix?: string);
   abstract setNotFoundHandler(handler: Function, prefix?: string);
-  abstract setHeader(response, name: string, value: string);
-  abstract registerParserMiddleware(prefix?: string);
+  abstract isHeadersSent(response: any);
+  abstract setHeader(response: any, name: string, value: string);
+  abstract registerParserMiddleware(prefix?: string, rawBody?: boolean);
   abstract enableCors(
     options: CorsOptions | CorsOptionsDelegate<TRequest>,
     prefix?: string,
@@ -121,4 +129,9 @@ export abstract class AbstractHttpAdapter<
     | ((path: string, callback: Function) => any)
     | Promise<(path: string, callback: Function) => any>;
   abstract getType(): string;
+  abstract applyVersionFilter(
+    handler: Function,
+    version: VersionValue,
+    versioningOptions: VersioningOptions,
+  ): (req: TRequest, res: TResponse, next: () => void) => Function;
 }
diff --git a/packages/core/application-config.ts b/packages/core/application-config.ts
index 4df293753..1b6adfa4e 100644
--- a/packages/core/application-config.ts
+++ b/packages/core/application-config.ts
@@ -136,6 +136,11 @@ export class ApplicationConfig {
   }
 
   public enableVersioning(options: VersioningOptions): void {
+    if (Array.isArray(options.defaultVersion)) {
+      // Drop duplicated versions
+      options.defaultVersion = Array.from(new Set(options.defaultVersion));
+    }
+
     this.versioningOptions = options;
   }
 
diff --git a/packages/core/constants.ts b/packages/core/constants.ts
index 877226690..6b0f56267 100644
--- a/packages/core/constants.ts
+++ b/packages/core/constants.ts
@@ -1,3 +1,5 @@
+import { EnhancerSubtype } from '@nestjs/common/constants';
+
 export const MESSAGES = {
   APPLICATION_START: `Starting Nest application...`,
   APPLICATION_READY: `Nest application successfully started`,
@@ -12,3 +14,15 @@ export const APP_INTERCEPTOR = 'APP_INTERCEPTOR';
 export const APP_PIPE = 'APP_PIPE';
 export const APP_GUARD = 'APP_GUARD';
 export const APP_FILTER = 'APP_FILTER';
+export const ENHANCER_TOKEN_TO_SUBTYPE_MAP: Record<
+  | typeof APP_GUARD
+  | typeof APP_PIPE
+  | typeof APP_FILTER
+  | typeof APP_INTERCEPTOR,
+  EnhancerSubtype
+> = {
+  [APP_GUARD]: 'guard',
+  [APP_INTERCEPTOR]: 'interceptor',
+  [APP_PIPE]: 'pipe',
+  [APP_FILTER]: 'filter',
+} as const;
diff --git a/packages/core/errors/exceptions/index.ts b/packages/core/errors/exceptions/index.ts
new file mode 100644
index 000000000..530968b2f
--- /dev/null
+++ b/packages/core/errors/exceptions/index.ts
@@ -0,0 +1,8 @@
+export * from './circular-dependency.exception';
+export * from './runtime.exception';
+export * from './unknown-element.exception';
+export * from './invalid-class-scope.exception';
+export * from './invalid-class.exception';
+export * from './unknown-export.exception';
+export * from './unknown-module.exception';
+export * from './undefined-forwardref.exception';
diff --git a/packages/core/errors/exceptions/invalid-class-module.exception.ts b/packages/core/errors/exceptions/invalid-class-module.exception.ts
new file mode 100644
index 000000000..0761ea5ce
--- /dev/null
+++ b/packages/core/errors/exceptions/invalid-class-module.exception.ts
@@ -0,0 +1,10 @@
+import { USING_INVALID_CLASS_AS_A_MODULE_MESSAGE } from '../messages';
+import { RuntimeException } from './runtime.exception';
+
+export class InvalidClassModuleException extends RuntimeException {
+  constructor(metatypeUsedAsAModule: any, scope: any[]) {
+    super(
+      USING_INVALID_CLASS_AS_A_MODULE_MESSAGE(metatypeUsedAsAModule, scope),
+    );
+  }
+}
diff --git a/packages/core/errors/exceptions/unknown-dependencies.exception.ts b/packages/core/errors/exceptions/unknown-dependencies.exception.ts
index d350952cb..57c7207c8 100644
--- a/packages/core/errors/exceptions/unknown-dependencies.exception.ts
+++ b/packages/core/errors/exceptions/unknown-dependencies.exception.ts
@@ -1,14 +1,18 @@
 import { InjectorDependencyContext } from '../../injector/injector';
+import { Module } from '../../injector/module';
 import { UNKNOWN_DEPENDENCIES_MESSAGE } from '../messages';
 import { RuntimeException } from './runtime.exception';
-import { Module } from '../../injector/module';
 
 export class UnknownDependenciesException extends RuntimeException {
+  public readonly moduleRef: { id: string } | undefined;
+
   constructor(
-    type: string | symbol,
-    unknownDependencyContext: InjectorDependencyContext,
-    module?: Module,
+    public readonly type: string | symbol,
+    public readonly context: InjectorDependencyContext,
+    moduleRef?: Module,
+    public readonly metadata?: { id: string },
   ) {
-    super(UNKNOWN_DEPENDENCIES_MESSAGE(type, unknownDependencyContext, module));
+    super(UNKNOWN_DEPENDENCIES_MESSAGE(type, context, moduleRef));
+    this.moduleRef = moduleRef && { id: moduleRef.id };
   }
 }
diff --git a/packages/core/errors/exceptions/unknown-request-mapping.exception.ts b/packages/core/errors/exceptions/unknown-request-mapping.exception.ts
index b0d64b212..561390bd9 100644
--- a/packages/core/errors/exceptions/unknown-request-mapping.exception.ts
+++ b/packages/core/errors/exceptions/unknown-request-mapping.exception.ts
@@ -1,8 +1,9 @@
+import type { Type } from '@nestjs/common';
 import { RuntimeException } from './runtime.exception';
 import { UNKNOWN_REQUEST_MAPPING } from '../messages';
 
 export class UnknownRequestMappingException extends RuntimeException {
-  constructor() {
-    super(UNKNOWN_REQUEST_MAPPING);
+  constructor(metatype: Type) {
+    super(UNKNOWN_REQUEST_MAPPING(metatype));
   }
 }
diff --git a/packages/core/errors/messages.ts b/packages/core/errors/messages.ts
index 2aaec08e6..ba33e4f85 100644
--- a/packages/core/errors/messages.ts
+++ b/packages/core/errors/messages.ts
@@ -1,4 +1,4 @@
-import { ForwardReference, Type } from '@nestjs/common';
+import type { ForwardReference, Type, DynamicModule } from '@nestjs/common';
 import { isNil, isSymbol } from '@nestjs/common/utils/shared.utils';
 import {
   InjectorDependency,
@@ -7,21 +7,26 @@ import {
 import { Module } from '../injector/module';
 
 /**
- * Returns the name of an instance
+ * Returns the name of an instance or `undefined`
  * @param instance The instance which should get the name from
  */
 const getInstanceName = (instance: unknown): string => {
   if ((instance as ForwardReference)?.forwardRef) {
     return (instance as ForwardReference).forwardRef()?.name;
   }
-  return (instance as Type<any>)?.name;
+
+  if ((instance as DynamicModule)?.module) {
+    return (instance as DynamicModule).module?.name;
+  }
+
+  return (instance as Type)?.name;
 };
 
 /**
  * Returns the name of the dependency
  * Tries to get the class name, otherwise the string value
  * (= injection token). As fallback it returns '+'
- * @param dependency The dependency whichs name should get displayed
+ * @param dependency The name of the dependency to be displayed
  */
 const getDependencyName = (dependency: InjectorDependency): string =>
   // use class name
@@ -55,20 +60,32 @@ export const UNKNOWN_DEPENDENCIES_MESSAGE = (
     dependencies,
     key,
   } = unknownDependencyContext;
-  const moduleName = getModuleName(module) || 'Module';
+  const moduleName = getModuleName(module);
   const dependencyName = getDependencyName(name);
 
-  let message = `Nest can't resolve dependencies of the ${type.toString()}`;
-
-  const potentialSolutions = `\n
+  const potentialSolutions =
+    // If module's name is well defined
+    moduleName !== 'current'
+      ? `\n
 Potential solutions:
+- Is ${moduleName} a valid NestJS module?
 - If ${dependencyName} is a provider, is it part of the current ${moduleName}?
 - If ${dependencyName} is exported from a separate @Module, is that module imported within ${moduleName}?
   @Module({
     imports: [ /* the Module containing ${dependencyName} */ ]
   })
+`
+      : `\n
+Potential solutions:
+- If ${dependencyName} is a provider, is it part of the current Module?
+- If ${dependencyName} is exported from a separate @Module, is that module imported within Module?
+  @Module({
+    imports: [ /* the Module containing ${dependencyName} */ ]
+  })
 `;
 
+  let message = `Nest can't resolve dependencies of the ${type.toString()}`;
+
   if (isNil(index)) {
     message += `. Please make sure that the "${key.toString()}" property is available in the current context.${potentialSolutions}`;
     return message;
@@ -78,9 +95,7 @@ Potential solutions:
 
   message += ` (`;
   message += dependenciesName.join(', ');
-  message += `). Please make sure that the argument ${dependencyName} at index [${index}] is available in the ${getModuleName(
-    module,
-  )} context.`;
+  message += `). Please make sure that the argument ${dependencyName} at index [${index}] is available in the ${moduleName} context.`;
   message += potentialSolutions;
 
   return message;
@@ -97,7 +112,7 @@ export const UNDEFINED_FORWARDREF_MESSAGE = (
 
 (Read more: https://docs.nestjs.com/fundamentals/circular-dependency)
 Scope [${stringifyScope(scope)}]
-  `;
+`;
 
 export const INVALID_MODULE_MESSAGE = (
   parentModule: any,
@@ -107,11 +122,25 @@ export const INVALID_MODULE_MESSAGE = (
   const parentModuleName = parentModule?.name || 'module';
 
   return `Nest cannot create the ${parentModuleName} instance.
-Received an unexpected value at index [${index}] of the ${parentModuleName} "imports" array. 
+Received an unexpected value at index [${index}] of the ${parentModuleName} "imports" array.
 
 Scope [${stringifyScope(scope)}]`;
 };
 
+export const USING_INVALID_CLASS_AS_A_MODULE_MESSAGE = (
+  metatypeUsedAsAModule: Type | ForwardReference,
+  scope: any[],
+) => {
+  const metatypeNameQuote =
+    `"${getInstanceName(metatypeUsedAsAModule)}"` || 'that class';
+
+  return `Classes annotated with @Injectable(), @Catch(), and @Controller() decorators must not appear in the "imports" array of a module.
+Please remove ${metatypeNameQuote} (including forwarded occurrences, if any) from all of the "imports" arrays.
+
+Scope [${stringifyScope(scope)}]
+`;
+};
+
 export const UNDEFINED_MODULE_MESSAGE = (
   parentModule: any,
   index: number,
@@ -153,8 +182,14 @@ export const INVALID_CLASS_SCOPE_MESSAGE = (
     name || 'This class'
   } is marked as a scoped provider. Request and transient-scoped providers can't be used in combination with "get()" method. Please, use "resolve()" instead.`;
 
+export const UNKNOWN_REQUEST_MAPPING = (metatype: Type) => {
+  const className = metatype.name;
+  return className
+    ? `An invalid controller has been detected. "${className}" does not have the @Controller() decorator but it is being listed in the "controllers" array of some module.`
+    : `An invalid controller has been detected. Perhaps, one of your controllers is missing the @Controller() decorator.`;
+};
+
 export const INVALID_MIDDLEWARE_CONFIGURATION = `An invalid middleware configuration has been passed inside the module 'configure()' method.`;
-export const UNKNOWN_REQUEST_MAPPING = `An invalid controller has been detected. Perhaps, one of your controllers is missing @Controller() decorator.`;
 export const UNHANDLED_RUNTIME_EXCEPTION = `Unhandled Runtime Exception.`;
 export const INVALID_EXCEPTION_FILTER = `Invalid exception filters (@UseFilters()).`;
 export const MICROSERVICES_PACKAGE_NOT_FOUND_EXCEPTION = `Unable to load @nestjs/microservices package. (Please make sure that it's already installed.)`;
diff --git a/packages/core/exceptions/base-exception-filter-context.ts b/packages/core/exceptions/base-exception-filter-context.ts
index aa9971227..40ff0a156 100644
--- a/packages/core/exceptions/base-exception-filter-context.ts
+++ b/packages/core/exceptions/base-exception-filter-context.ts
@@ -50,7 +50,7 @@ export class BaseExceptionFilterContext extends ContextCreator {
       return null;
     }
     const instanceHost = instanceWrapper.getInstanceByContextId(
-      contextId,
+      this.getContextId(contextId, instanceWrapper),
       inquirerId,
     );
     return instanceHost && instanceHost.instance;
diff --git a/packages/core/exceptions/base-exception-filter.ts b/packages/core/exceptions/base-exception-filter.ts
index ea360e84a..bc3784501 100644
--- a/packages/core/exceptions/base-exception-filter.ts
+++ b/packages/core/exceptions/base-exception-filter.ts
@@ -38,7 +38,12 @@ export class BaseExceptionFilter<T = any> implements ExceptionFilter<T> {
           message: res,
         };
 
-    applicationRef.reply(host.getArgByIndex(1), message, exception.getStatus());
+    const response = host.getArgByIndex(1);
+    if (!applicationRef.isHeadersSent(response)) {
+      applicationRef.reply(response, message, exception.getStatus());
+    } else {
+      applicationRef.end(response);
+    }
   }
 
   public handleUnknownError(
@@ -55,7 +60,14 @@ export class BaseExceptionFilter<T = any> implements ExceptionFilter<T> {
           statusCode: HttpStatus.INTERNAL_SERVER_ERROR,
           message: MESSAGES.UNKNOWN_EXCEPTION_MESSAGE,
         };
-    applicationRef.reply(host.getArgByIndex(1), body, body.statusCode);
+
+    const response = host.getArgByIndex(1);
+    if (!applicationRef.isHeadersSent(response)) {
+      applicationRef.reply(response, body, body.statusCode);
+    } else {
+      applicationRef.end(response);
+    }
+
     if (this.isExceptionObject(exception)) {
       return BaseExceptionFilter.logger.error(
         exception.message,
diff --git a/packages/core/exceptions/exceptions-handler.ts b/packages/core/exceptions/exceptions-handler.ts
index af54683ae..14290bcd9 100644
--- a/packages/core/exceptions/exceptions-handler.ts
+++ b/packages/core/exceptions/exceptions-handler.ts
@@ -1,9 +1,10 @@
-import { HttpException, Type } from '@nestjs/common';
-import { ExceptionFilterMetadata } from '@nestjs/common/interfaces/exceptions/exception-filter-metadata.interface';
-import { ArgumentsHost } from '@nestjs/common/interfaces/features/arguments-host.interface';
 import { isEmpty } from '@nestjs/common/utils/shared.utils';
-import { InvalidExceptionFilterException } from '../errors/exceptions/invalid-exception-filter.exception';
+import { HttpException } from '@nestjs/common';
+import { ArgumentsHost } from '@nestjs/common/interfaces/features/arguments-host.interface';
+import { ExceptionFilterMetadata } from '@nestjs/common/interfaces/exceptions/exception-filter-metadata.interface';
+import { selectExceptionFilterMetadata } from '@nestjs/common/utils/select-exception-filter-metadata.util';
 import { BaseExceptionFilter } from './base-exception-filter';
+import { InvalidExceptionFilterException } from '../errors/exceptions/invalid-exception-filter.exception';
 
 export class ExceptionsHandler extends BaseExceptionFilter {
   private filters: ExceptionFilterMetadata[] = [];
@@ -29,14 +30,8 @@ export class ExceptionsHandler extends BaseExceptionFilter {
     if (isEmpty(this.filters)) {
       return false;
     }
-    const isInstanceOf = (metatype: Type<unknown>) =>
-      exception instanceof metatype;
 
-    const filter = this.filters.find(({ exceptionMetatypes }) => {
-      const typeExists =
-        !exceptionMetatypes.length || exceptionMetatypes.some(isInstanceOf);
-      return typeExists;
-    });
+    const filter = selectExceptionFilterMetadata(this.filters, exception);
     filter && filter.func(exception, ctx);
     return !!filter;
   }
diff --git a/packages/core/exceptions/external-exceptions-handler.ts b/packages/core/exceptions/external-exceptions-handler.ts
index 15a6e6b3c..9e852ba35 100644
--- a/packages/core/exceptions/external-exceptions-handler.ts
+++ b/packages/core/exceptions/external-exceptions-handler.ts
@@ -1,9 +1,9 @@
-import { Type } from '@nestjs/common';
-import { ExceptionFilterMetadata } from '@nestjs/common/interfaces/exceptions';
-import { ArgumentsHost } from '@nestjs/common/interfaces/features/arguments-host.interface';
 import { isEmpty } from '@nestjs/common/utils/shared.utils';
-import { InvalidExceptionFilterException } from '../errors/exceptions/invalid-exception-filter.exception';
+import { ArgumentsHost } from '@nestjs/common/interfaces/features/arguments-host.interface';
+import { ExceptionFilterMetadata } from '@nestjs/common/interfaces/exceptions';
+import { selectExceptionFilterMetadata } from '@nestjs/common/utils/select-exception-filter-metadata.util';
 import { ExternalExceptionFilter } from './external-exception-filter';
+import { InvalidExceptionFilterException } from '../errors/exceptions/invalid-exception-filter.exception';
 
 export class ExternalExceptionsHandler extends ExternalExceptionFilter {
   private filters: ExceptionFilterMetadata[] = [];
@@ -30,14 +30,8 @@ export class ExternalExceptionsHandler extends ExternalExceptionFilter {
     if (isEmpty(this.filters)) {
       return null;
     }
-    const isInstanceOf = (metatype: Type<unknown>) =>
-      exception instanceof metatype;
 
-    const filter = this.filters.find(({ exceptionMetatypes }) => {
-      const typeExists =
-        !exceptionMetatypes.length || exceptionMetatypes.some(isInstanceOf);
-      return typeExists;
-    });
+    const filter = selectExceptionFilterMetadata(this.filters, exception);
     return filter ? filter.func(exception, host) : null;
   }
 }
diff --git a/packages/core/guards/guards-context-creator.ts b/packages/core/guards/guards-context-creator.ts
index e82a8fb04..7c9963b3a 100644
--- a/packages/core/guards/guards-context-creator.ts
+++ b/packages/core/guards/guards-context-creator.ts
@@ -69,7 +69,7 @@ export class GuardsContextCreator extends ContextCreator {
       return null;
     }
     const instanceHost = instanceWrapper.getInstanceByContextId(
-      contextId,
+      this.getContextId(contextId, instanceWrapper),
       inquirerId,
     );
     return instanceHost && instanceHost.instance;
@@ -104,7 +104,12 @@ export class GuardsContextCreator extends ContextCreator {
     const scopedGuardWrappers =
       this.config.getGlobalRequestGuards() as InstanceWrapper[];
     const scopedGuards = iterate(scopedGuardWrappers)
-      .map(wrapper => wrapper.getInstanceByContextId(contextId, inquirerId))
+      .map(wrapper =>
+        wrapper.getInstanceByContextId(
+          this.getContextId(contextId, wrapper),
+          inquirerId,
+        ),
+      )
       .filter(host => !!host)
       .map(host => host.instance)
       .toArray();
diff --git a/packages/core/guards/index.ts b/packages/core/guards/index.ts
new file mode 100644
index 000000000..61a8b775a
--- /dev/null
+++ b/packages/core/guards/index.ts
@@ -0,0 +1,3 @@
+export * from './constants';
+export * from './guards-consumer';
+export * from './guards-context-creator';
diff --git a/packages/core/helpers/context-creator.ts b/packages/core/helpers/context-creator.ts
index 5028cc973..fa8c9c4ac 100644
--- a/packages/core/helpers/context-creator.ts
+++ b/packages/core/helpers/context-creator.ts
@@ -1,6 +1,6 @@
 import { Controller } from '@nestjs/common/interfaces';
 import { STATIC_CONTEXT } from '../injector/constants';
-import { ContextId } from '../injector/instance-wrapper';
+import { ContextId, InstanceWrapper } from '../injector/instance-wrapper';
 
 export abstract class ContextCreator {
   public abstract createConcreteContext<T extends any[], R extends any[]>(
@@ -51,4 +51,16 @@ export abstract class ContextCreator {
   ): T {
     return Reflect.getMetadata(metadataKey, callback);
   }
+
+  protected getContextId(
+    contextId: ContextId,
+    instanceWrapper: InstanceWrapper,
+  ): ContextId {
+    return contextId.getParent
+      ? contextId.getParent({
+          token: instanceWrapper.token,
+          isTreeDurable: instanceWrapper.isDependencyTreeDurable(),
+        })
+      : contextId;
+  }
 }
diff --git a/packages/core/helpers/context-id-factory.ts b/packages/core/helpers/context-id-factory.ts
index 0cb80d311..0c7282cb9 100644
--- a/packages/core/helpers/context-id-factory.ts
+++ b/packages/core/helpers/context-id-factory.ts
@@ -1,4 +1,5 @@
-import { ContextId } from '../injector/instance-wrapper';
+import { isObject } from '@nestjs/common/utils/shared.utils';
+import { ContextId, HostComponentInfo } from '../injector/instance-wrapper';
 import { REQUEST_CONTEXT_ID } from '../router/request/request-constants';
 
 export function createContextId(): ContextId {
@@ -13,7 +14,35 @@ export function createContextId(): ContextId {
   return { id: Math.random() };
 }
 
+export type ContextIdResolverFn = (info: HostComponentInfo) => ContextId;
+
+export interface ContextIdResolver {
+  /**
+   * Payload associated with the custom context id
+   */
+  payload: unknown;
+  /**
+   * A context id resolver function
+   */
+  resolve: ContextIdResolverFn;
+}
+
+export interface ContextIdStrategy<T = any> {
+  /**
+   * Allows to attach a parent context id to the existing child context id.
+   * This lets you construct durable DI sub-trees that can be shared between contexts.
+   * @param contextId auto-generated child context id
+   * @param request request object
+   */
+  attach(
+    contextId: ContextId,
+    request: T,
+  ): ContextIdResolverFn | ContextIdResolver | undefined;
+}
+
 export class ContextIdFactory {
+  private static strategy?: ContextIdStrategy;
+
   /**
    * Generates a context identifier based on the request object.
    */
@@ -27,16 +56,45 @@ export class ContextIdFactory {
    */
   public static getByRequest<T extends Record<any, any> = any>(
     request: T,
+    propsToInspect: string[] = ['raw'],
   ): ContextId {
     if (!request) {
-      return createContextId();
+      return ContextIdFactory.create();
     }
     if (request[REQUEST_CONTEXT_ID as any]) {
       return request[REQUEST_CONTEXT_ID as any];
     }
-    if (request.raw && request.raw[REQUEST_CONTEXT_ID]) {
-      return request.raw[REQUEST_CONTEXT_ID];
+    for (const key of propsToInspect) {
+      if (request[key]?.[REQUEST_CONTEXT_ID]) {
+        return request[key][REQUEST_CONTEXT_ID];
+      }
     }
-    return createContextId();
+    if (!this.strategy) {
+      return ContextIdFactory.create();
+    }
+    const contextId = createContextId();
+    const resolverObjectOrFunction = this.strategy.attach(contextId, request);
+    if (this.isContextIdResolverWithPayload(resolverObjectOrFunction)) {
+      contextId.getParent = resolverObjectOrFunction.resolve;
+      contextId.payload = resolverObjectOrFunction.payload;
+    } else {
+      contextId.getParent = resolverObjectOrFunction;
+    }
+    return contextId;
+  }
+
+  /**
+   * Registers a custom context id strategy that lets you attach
+   * a parent context id to the existing context id object.
+   * @param strategy strategy instance
+   */
+  public static apply(strategy: ContextIdStrategy) {
+    this.strategy = strategy;
+  }
+
+  private static isContextIdResolverWithPayload(
+    resolverOrResolverFn: ContextIdResolver | ContextIdResolverFn,
+  ): resolverOrResolverFn is ContextIdResolver {
+    return isObject(resolverOrResolverFn);
   }
 }
diff --git a/packages/core/helpers/context-utils.ts b/packages/core/helpers/context-utils.ts
index dc64660f1..10c67b5a8 100644
--- a/packages/core/helpers/context-utils.ts
+++ b/packages/core/helpers/context-utils.ts
@@ -50,12 +50,15 @@ export class ContextUtils {
   }
 
   public getArgumentsLength<T>(keys: string[], metadata: T): number {
-    return Math.max(...keys.map(key => metadata[key].index)) + 1;
+    return keys.length
+      ? Math.max(...keys.map(key => metadata[key].index)) + 1
+      : 0;
   }
 
   public createNullArray(length: number): any[] {
-    // eslint-disable-next-line prefer-spread
-    return Array.apply(null, { length } as any).fill(undefined);
+    const a = new Array(length);
+    for (let i = 0; i < length; ++i) a[i] = undefined;
+    return a;
   }
 
   public mergeParamsMetatypes(
diff --git a/packages/core/helpers/external-context-creator.ts b/packages/core/helpers/external-context-creator.ts
index 847da432d..83ef9994d 100644
--- a/packages/core/helpers/external-context-creator.ts
+++ b/packages/core/helpers/external-context-creator.ts
@@ -1,24 +1,24 @@
 import { ForbiddenException, ParamData } from '@nestjs/common';
-import { CUSTOM_ROUTE_AGRS_METADATA } from '@nestjs/common/constants';
+import { CUSTOM_ROUTE_ARGS_METADATA } from '@nestjs/common/constants';
 import {
   ContextType,
   Controller,
   PipeTransform,
 } from '@nestjs/common/interfaces';
-import { isEmpty, isFunction } from '@nestjs/common/utils/shared.utils';
-import { lastValueFrom } from 'rxjs';
+import { isEmpty } from '@nestjs/common/utils/shared.utils';
+import { lastValueFrom, isObservable } from 'rxjs';
 import { ExternalExceptionFilterContext } from '../exceptions/external-exception-filter-context';
 import { FORBIDDEN_MESSAGE } from '../guards/constants';
-import { GuardsConsumer } from '../guards/guards-consumer';
-import { GuardsContextCreator } from '../guards/guards-context-creator';
+import { GuardsConsumer, GuardsContextCreator } from '../guards';
 import { STATIC_CONTEXT } from '../injector/constants';
 import { NestContainer } from '../injector/container';
 import { ContextId } from '../injector/instance-wrapper';
 import { ModulesContainer } from '../injector/modules-container';
-import { InterceptorsConsumer } from '../interceptors/interceptors-consumer';
-import { InterceptorsContextCreator } from '../interceptors/interceptors-context-creator';
-import { PipesConsumer } from '../pipes/pipes-consumer';
-import { PipesContextCreator } from '../pipes/pipes-context-creator';
+import {
+  InterceptorsConsumer,
+  InterceptorsContextCreator,
+} from '../interceptors';
+import { PipesConsumer, PipesContextCreator } from '../pipes';
 import { ContextUtils, ParamProperties } from './context-utils';
 import { ExternalErrorProxy } from './external-proxy';
 import { HandlerMetadataStorage } from './handler-metadata-storage';
@@ -272,7 +272,7 @@ export class ExternalContextCreator {
       );
       const type = this.contextUtils.mapParamType(key);
 
-      if (key.includes(CUSTOM_ROUTE_AGRS_METADATA)) {
+      if (key.includes(CUSTOM_ROUTE_ARGS_METADATA)) {
         const { factory } = metadata[key];
         const customExtractValue = this.contextUtils.getCustomFactory(
           factory,
@@ -329,7 +329,7 @@ export class ExternalContextCreator {
   }
 
   public async transformToResult(resultOrDeferred: any) {
-    if (resultOrDeferred && isFunction(resultOrDeferred.subscribe)) {
+    if (isObservable(resultOrDeferred)) {
       return lastValueFrom(resultOrDeferred);
     }
     return resultOrDeferred;
diff --git a/packages/core/helpers/handler-metadata-storage.ts b/packages/core/helpers/handler-metadata-storage.ts
index ef22c9ecc..36e280f2e 100644
--- a/packages/core/helpers/handler-metadata-storage.ts
+++ b/packages/core/helpers/handler-metadata-storage.ts
@@ -1,5 +1,4 @@
-import { Type } from '@nestjs/common';
-import { Controller } from '@nestjs/common/interfaces';
+import { Controller, Type } from '@nestjs/common/interfaces';
 import { IncomingMessage } from 'http';
 import { Observable } from 'rxjs';
 import { CONTROLLER_ID_KEY } from '../injector/constants';
diff --git a/packages/core/helpers/index.ts b/packages/core/helpers/index.ts
index 5319266f1..76f854606 100644
--- a/packages/core/helpers/index.ts
+++ b/packages/core/helpers/index.ts
@@ -1,2 +1,3 @@
 export * from './context-id-factory';
+export * from './external-context-creator';
 export * from './http-adapter-host';
diff --git a/packages/core/helpers/is-durable.ts b/packages/core/helpers/is-durable.ts
new file mode 100644
index 000000000..377c84f18
--- /dev/null
+++ b/packages/core/helpers/is-durable.ts
@@ -0,0 +1,7 @@
+import { SCOPE_OPTIONS_METADATA } from '@nestjs/common/constants';
+import { Type } from '@nestjs/common/interfaces/type.interface';
+
+export function isDurable(provider: Type<unknown>): boolean | undefined {
+  const metadata = Reflect.getMetadata(SCOPE_OPTIONS_METADATA, provider);
+  return metadata && metadata.durable;
+}
diff --git a/packages/core/helpers/messages.ts b/packages/core/helpers/messages.ts
index b7d37cc44..3c2fffd7c 100644
--- a/packages/core/helpers/messages.ts
+++ b/packages/core/helpers/messages.ts
@@ -17,10 +17,12 @@ export const VERSIONED_ROUTE_MAPPED_MESSAGE = (
   method: string | number,
   version: VersionValue,
 ) => {
-  if (version === VERSION_NEUTRAL) {
-    version = 'Neutral';
-  }
-  return `Mapped {${path}, ${RequestMethod[method]}} (version: ${version}) route`;
+  const controllerVersions = Array.isArray(version) ? version : [version];
+  const versions = controllerVersions
+    .map(version => (version === VERSION_NEUTRAL ? 'Neutral' : version))
+    .join(',');
+
+  return `Mapped {${path}, ${RequestMethod[method]}} (version: ${versions}) route`;
 };
 
 export const CONTROLLER_MAPPING_MESSAGE = (name: string, path: string) =>
@@ -31,10 +33,12 @@ export const VERSIONED_CONTROLLER_MAPPING_MESSAGE = (
   path: string,
   version: VersionValue,
 ) => {
-  if (version === VERSION_NEUTRAL) {
-    version = 'Neutral';
-  }
-  return `${name} {${path}} (version: ${version}):`;
+  const controllerVersions = Array.isArray(version) ? version : [version];
+  const versions = controllerVersions
+    .map(version => (version === VERSION_NEUTRAL ? 'Neutral' : version))
+    .join(',');
+
+  return `${name} {${path}} (version: ${versions}):`;
 };
 
 export const INVALID_EXECUTION_CONTEXT = (
diff --git a/packages/core/index.ts b/packages/core/index.ts
index 2915304ab..511eac90d 100644
--- a/packages/core/index.ts
+++ b/packages/core/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @core
- * Copyright(c) 2017 - 2021 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2023 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
@@ -13,10 +13,12 @@ export * from './discovery';
 export * from './exceptions';
 export * from './helpers';
 export * from './injector';
+export * from './inspector';
 export * from './metadata-scanner';
 export * from './middleware';
 export * from './nest-application';
 export * from './nest-application-context';
 export { NestFactory } from './nest-factory';
+export * from './repl';
 export * from './router';
 export * from './services';
diff --git a/packages/core/injector/abstract-instance-resolver.ts b/packages/core/injector/abstract-instance-resolver.ts
new file mode 100644
index 000000000..0308574d6
--- /dev/null
+++ b/packages/core/injector/abstract-instance-resolver.ts
@@ -0,0 +1,86 @@
+import { Abstract, Scope, Type } from '@nestjs/common';
+import { GetOrResolveOptions } from '@nestjs/common/interfaces';
+import {
+  InvalidClassScopeException,
+  UnknownElementException,
+} from '../errors/exceptions';
+import { Injector } from './injector';
+import { InstanceLink, InstanceLinksHost } from './instance-links-host';
+import { ContextId } from './instance-wrapper';
+import { Module } from './module';
+
+export abstract class AbstractInstanceResolver {
+  protected abstract instanceLinksHost: InstanceLinksHost;
+  protected abstract injector: Injector;
+
+  protected abstract get<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    options?: GetOrResolveOptions,
+  ): TResult | Array<TResult>;
+
+  protected find<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Abstract<TInput> | string | symbol,
+    options: { moduleId?: string; each?: boolean },
+  ): TResult | Array<TResult> {
+    const instanceLinkOrArray = this.instanceLinksHost.get<TResult>(
+      typeOrToken,
+      options,
+    );
+    const pluckInstance = ({ wrapperRef }: InstanceLink) => {
+      if (
+        wrapperRef.scope === Scope.REQUEST ||
+        wrapperRef.scope === Scope.TRANSIENT
+      ) {
+        throw new InvalidClassScopeException(typeOrToken);
+      }
+      return wrapperRef.instance;
+    };
+    if (Array.isArray(instanceLinkOrArray)) {
+      return instanceLinkOrArray.map(pluckInstance);
+    }
+    return pluckInstance(instanceLinkOrArray);
+  }
+
+  protected async resolvePerContext<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Abstract<TInput> | string | symbol,
+    contextModule: Module,
+    contextId: ContextId,
+    options?: GetOrResolveOptions,
+  ): Promise<TResult | Array<TResult>> {
+    const instanceLinkOrArray = options?.strict
+      ? this.instanceLinksHost.get(typeOrToken, {
+          moduleId: contextModule.id,
+          each: options.each,
+        })
+      : this.instanceLinksHost.get(typeOrToken, {
+          each: options.each,
+        });
+
+    const pluckInstance = async (instanceLink: InstanceLink) => {
+      const { wrapperRef, collection } = instanceLink;
+      if (wrapperRef.isDependencyTreeStatic() && !wrapperRef.isTransient) {
+        return this.get(typeOrToken, { strict: options.strict });
+      }
+
+      const ctorHost = wrapperRef.instance || { constructor: typeOrToken };
+      const instance = await this.injector.loadPerContext(
+        ctorHost,
+        wrapperRef.host,
+        collection,
+        contextId,
+        wrapperRef,
+      );
+      if (!instance) {
+        throw new UnknownElementException();
+      }
+      return instance;
+    };
+
+    if (Array.isArray(instanceLinkOrArray)) {
+      return Promise.all(
+        instanceLinkOrArray.map(instanceLink => pluckInstance(instanceLink)),
+      );
+    }
+    return pluckInstance(instanceLinkOrArray);
+  }
+}
diff --git a/packages/core/injector/compiler.ts b/packages/core/injector/compiler.ts
index 6c707fd61..353e27581 100644
--- a/packages/core/injector/compiler.ts
+++ b/packages/core/injector/compiler.ts
@@ -1,4 +1,8 @@
-import { DynamicModule, Type } from '@nestjs/common/interfaces';
+import {
+  DynamicModule,
+  ForwardReference,
+  Type,
+} from '@nestjs/common/interfaces';
 import { ModuleTokenFactory } from './module-token-factory';
 
 export interface ModuleFactory {
@@ -18,19 +22,25 @@ export class ModuleCompiler {
     return { type, dynamicMetadata, token };
   }
 
-  public extractMetadata(metatype: Type<any> | DynamicModule): {
+  public extractMetadata(
+    metatype: Type<any> | ForwardReference | DynamicModule,
+  ): {
     type: Type<any>;
     dynamicMetadata?: Partial<DynamicModule> | undefined;
   } {
     if (!this.isDynamicModule(metatype)) {
-      return { type: metatype };
+      return {
+        type: (metatype as ForwardReference)?.forwardRef
+          ? (metatype as ForwardReference).forwardRef()
+          : metatype,
+      };
     }
     const { module: type, ...dynamicMetadata } = metatype;
     return { type, dynamicMetadata };
   }
 
   public isDynamicModule(
-    module: Type<any> | DynamicModule,
+    module: Type<any> | DynamicModule | ForwardReference,
   ): module is DynamicModule {
     return !!(module as DynamicModule).module;
   }
diff --git a/packages/core/injector/container.ts b/packages/core/injector/container.ts
index d5b7fcbbf..2522eabed 100644
--- a/packages/core/injector/container.ts
+++ b/packages/core/injector/container.ts
@@ -1,23 +1,26 @@
 import { DynamicModule, Provider } from '@nestjs/common';
-import { GLOBAL_MODULE_METADATA } from '@nestjs/common/constants';
-import { Injectable } from '@nestjs/common/interfaces/injectable.interface';
-import { Type } from '@nestjs/common/interfaces/type.interface';
+import {
+  EnhancerSubtype,
+  GLOBAL_MODULE_METADATA,
+} from '@nestjs/common/constants';
+import { Injectable, Type } from '@nestjs/common/interfaces';
 import { ApplicationConfig } from '../application-config';
-import { CircularDependencyException } from '../errors/exceptions/circular-dependency.exception';
-import { UndefinedForwardRefException } from '../errors/exceptions/undefined-forwardref.exception';
-import { UnknownModuleException } from '../errors/exceptions/unknown-module.exception';
+import {
+  CircularDependencyException,
+  UndefinedForwardRefException,
+  UnknownModuleException,
+} from '../errors/exceptions';
+import { InitializeOnPreviewAllowlist } from '../inspector/initialize-on-preview.allowlist';
+import { SerializedGraph } from '../inspector/serialized-graph';
 import { REQUEST } from '../router/request/request-constants';
-import { ModuleCompiler, ModuleFactory } from './compiler';
+import { ModuleCompiler } from './compiler';
 import { ContextId } from './instance-wrapper';
-import { InternalCoreModule } from './internal-core-module';
+import { InternalCoreModule } from './internal-core-module/internal-core-module';
 import { InternalProvidersStorage } from './internal-providers-storage';
 import { Module } from './module';
 import { ModuleTokenFactory } from './module-token-factory';
 import { ModulesContainer } from './modules-container';
 
-type ModuleMetatype = Type<any> | DynamicModule | Promise<DynamicModule>;
-type ModuleScope = Type<any>[];
-
 export class NestContainer {
   private readonly globalModules = new Set<Module>();
   private readonly moduleTokenFactory = new ModuleTokenFactory();
@@ -28,12 +31,17 @@ export class NestContainer {
     Partial<DynamicModule>
   >();
   private readonly internalProvidersStorage = new InternalProvidersStorage();
+  private readonly _serializedGraph = new SerializedGraph();
   private internalCoreModule: Module;
 
   constructor(
     private readonly _applicationConfig: ApplicationConfig = undefined,
   ) {}
 
+  get serializedGraph(): SerializedGraph {
+    return this._serializedGraph;
+  }
+
   get applicationConfig(): ApplicationConfig | undefined {
     return this._applicationConfig;
   }
@@ -57,8 +65,8 @@ export class NestContainer {
   }
 
   public async addModule(
-    metatype: ModuleMetatype,
-    scope: ModuleScope,
+    metatype: Type<any> | DynamicModule | Promise<DynamicModule>,
+    scope: Type<any>[],
   ): Promise<Module | undefined> {
     // In DependenciesScanner#scanForModules we already check for undefined or invalid modules
     // We still need to catch the edge-case of `forwardRef(() => undefined)`
@@ -71,62 +79,18 @@ export class NestContainer {
     if (this.modules.has(token)) {
       return this.modules.get(token);
     }
-
-    return this.setModule(
-      {
-        token,
-        type,
-        dynamicMetadata,
-      },
-      scope,
-    );
-  }
-
-  public async replaceModule(
-    metatypeToReplace: ModuleMetatype,
-    newMetatype: ModuleMetatype,
-    scope: ModuleScope,
-  ): Promise<Module | undefined> {
-    // In DependenciesScanner#scanForModules we already check for undefined or invalid modules
-    // We still need to catch the edge-case of `forwardRef(() => undefined)`
-    if (!metatypeToReplace || !newMetatype) {
-      throw new UndefinedForwardRefException(scope);
-    }
-
-    const { token } = await this.moduleCompiler.compile(metatypeToReplace);
-    const { type, dynamicMetadata } = await this.moduleCompiler.compile(
-      newMetatype,
-    );
-
-    return this.setModule(
-      {
-        token,
-        type,
-        dynamicMetadata,
-      },
-      scope,
-    );
-  }
-
-  private async setModule(
-    { token, dynamicMetadata, type }: ModuleFactory,
-    scope: ModuleScope,
-  ): Promise<Module | undefined> {
     const moduleRef = new Module(type, this);
     moduleRef.token = token;
-
+    moduleRef.initOnPreview = this.shouldInitOnPreview(type);
     this.modules.set(token, moduleRef);
 
-    await this.addDynamicMetadata(
-      token,
-      dynamicMetadata,
-      [].concat(scope, type),
-    );
+    const updatedScope = [].concat(scope, type);
+    await this.addDynamicMetadata(token, dynamicMetadata, updatedScope);
 
     if (this.isGlobalModule(type, dynamicMetadata)) {
+      moduleRef.isGlobal = true;
       this.addGlobalModule(moduleRef);
     }
-
     return moduleRef;
   }
 
@@ -199,27 +163,29 @@ export class NestContainer {
   public addProvider(
     provider: Provider,
     token: string,
+    enhancerSubtype?: EnhancerSubtype,
   ): string | symbol | Function {
+    const moduleRef = this.modules.get(token);
     if (!provider) {
-      throw new CircularDependencyException();
+      throw new CircularDependencyException(moduleRef?.metatype.name);
     }
-    if (!this.modules.has(token)) {
+    if (!moduleRef) {
       throw new UnknownModuleException();
     }
-    const moduleRef = this.modules.get(token);
-    return moduleRef.addProvider(provider);
+    return moduleRef.addProvider(provider, enhancerSubtype) as Function;
   }
 
   public addInjectable(
     injectable: Provider,
     token: string,
+    enhancerSubtype: EnhancerSubtype,
     host?: Type<Injectable>,
   ) {
     if (!this.modules.has(token)) {
       throw new UnknownModuleException();
     }
     const moduleRef = this.modules.get(token);
-    moduleRef.addInjectable(injectable, host);
+    return moduleRef.addInjectable(injectable, enhancerSubtype, host);
   }
 
   public addExportedProvider(provider: Type<any>, token: string) {
@@ -263,15 +229,16 @@ export class NestContainer {
     target.addRelatedModule(globalModule);
   }
 
+  public getDynamicMetadataByToken(token: string): Partial<DynamicModule>;
+  public getDynamicMetadataByToken<
+    K extends Exclude<keyof DynamicModule, 'global' | 'module'>,
+  >(token: string, metadataKey: K): DynamicModule[K];
   public getDynamicMetadataByToken(
     token: string,
-    metadataKey: keyof DynamicModule,
+    metadataKey?: Exclude<keyof DynamicModule, 'global' | 'module'>,
   ) {
     const metadata = this.dynamicModulesMetadata.get(token);
-    if (metadata && metadata[metadataKey]) {
-      return metadata[metadataKey] as any[];
-    }
-    return [];
+    return metadataKey ? metadata?.[metadataKey] ?? [] : metadata;
   }
 
   public registerCoreModuleRef(moduleRef: Module) {
@@ -290,4 +257,8 @@ export class NestContainer {
       isResolved: true,
     });
   }
+
+  private shouldInitOnPreview(type: Type) {
+    return InitializeOnPreviewAllowlist.has(type);
+  }
 }
diff --git a/packages/core/injector/helpers/provider-classifier.ts b/packages/core/injector/helpers/provider-classifier.ts
new file mode 100644
index 000000000..b883a4ea8
--- /dev/null
+++ b/packages/core/injector/helpers/provider-classifier.ts
@@ -0,0 +1,26 @@
+import {
+  ClassProvider,
+  FactoryProvider,
+  Provider,
+  ValueProvider,
+} from '@nestjs/common';
+import { isUndefined } from '@nestjs/common/utils/shared.utils';
+
+export function isClassProvider<T = any>(
+  provider: Provider,
+): provider is ClassProvider<T> {
+  return Boolean((provider as ClassProvider<T>)?.useClass);
+}
+
+export function isValueProvider<T = any>(
+  provider: Provider,
+): provider is ValueProvider<T> {
+  const providerValue = (provider as ValueProvider)?.useValue;
+  return !isUndefined(providerValue);
+}
+
+export function isFactoryProvider<T = any>(
+  provider: Provider,
+): provider is FactoryProvider<T> {
+  return Boolean((provider as FactoryProvider).useFactory);
+}
diff --git a/packages/core/injector/helpers/silent-logger.ts b/packages/core/injector/helpers/silent-logger.ts
new file mode 100644
index 000000000..82c37d512
--- /dev/null
+++ b/packages/core/injector/helpers/silent-logger.ts
@@ -0,0 +1,12 @@
+import { Logger } from '@nestjs/common';
+
+// eslint-disable-next-line @typescript-eslint/no-empty-function
+const noop = () => {};
+export class SilentLogger extends Logger {
+  log = noop;
+  error = noop;
+  warn = noop;
+  debug = noop;
+  verbose = noop;
+  setLogLevels = noop;
+}
diff --git a/packages/core/injector/helpers/transient-instances.ts b/packages/core/injector/helpers/transient-instances.ts
index 17287ef80..4e7f4afd6 100644
--- a/packages/core/injector/helpers/transient-instances.ts
+++ b/packages/core/injector/helpers/transient-instances.ts
@@ -1,13 +1,13 @@
+import { InjectionToken } from '@nestjs/common';
 import { iterate } from 'iterare';
 import { InstanceWrapper } from '../instance-wrapper';
-import { InstanceToken } from '../module';
 
 /**
  * Returns the instances which are transient
- * @param instances The instances which should be checked whether they are transcient
+ * @param instances The instances which should be checked whether they are transient
  */
 export function getTransientInstances(
-  instances: [InstanceToken, InstanceWrapper][],
+  instances: [InjectionToken, InstanceWrapper][],
 ): InstanceWrapper[] {
   return iterate(instances)
     .filter(([_, wrapper]) => wrapper.isDependencyTreeStatic())
@@ -20,10 +20,10 @@ export function getTransientInstances(
 
 /**
  * Returns the instances which are not transient
- * @param instances The instances which should be checked whether they are transcient
+ * @param instances The instances which should be checked whether they are transient
  */
 export function getNonTransientInstances(
-  instances: [InstanceToken, InstanceWrapper][],
+  instances: [InjectionToken, InstanceWrapper][],
 ): InstanceWrapper[] {
   return iterate(instances)
     .filter(
diff --git a/packages/core/injector/index.ts b/packages/core/injector/index.ts
index 6eb81c89c..21e406d06 100644
--- a/packages/core/injector/index.ts
+++ b/packages/core/injector/index.ts
@@ -1,6 +1,6 @@
 export * from './container';
 export * from './inquirer';
-export { ContextId } from './instance-wrapper';
-export * from './lazy-module-loader';
+export { ContextId, HostComponentInfo } from './instance-wrapper';
+export * from './lazy-module-loader/lazy-module-loader';
 export * from './module-ref';
 export * from './modules-container';
diff --git a/packages/core/injector/injector.ts b/packages/core/injector/injector.ts
index 67996afb3..07361bfd9 100644
--- a/packages/core/injector/injector.ts
+++ b/packages/core/injector/injector.ts
@@ -1,4 +1,9 @@
-import { Logger, LoggerService } from '@nestjs/common';
+import {
+  InjectionToken,
+  Logger,
+  LoggerService,
+  OptionalFactoryDependency,
+} from '@nestjs/common';
 import {
   OPTIONAL_DEPS_METADATA,
   OPTIONAL_PROPERTY_DEPS_METADATA,
@@ -6,18 +11,18 @@ import {
   PROPERTY_DEPS_METADATA,
   SELF_DECLARED_DEPS_METADATA,
 } from '@nestjs/common/constants';
-import { Controller } from '@nestjs/common/interfaces/controllers/controller.interface';
-import { Injectable } from '@nestjs/common/interfaces/injectable.interface';
-import { Type } from '@nestjs/common/interfaces/type.interface';
+import { Controller, Injectable, Type } from '@nestjs/common/interfaces';
 import { clc } from '@nestjs/common/utils/cli-colors.util';
 import {
   isFunction,
   isNil,
   isObject,
   isString,
+  isSymbol,
   isUndefined,
 } from '@nestjs/common/utils/shared.utils';
 import { iterate } from 'iterare';
+import { performance } from 'perf_hooks';
 import { RuntimeException } from '../errors/exceptions/runtime.exception';
 import { UndefinedDependencyException } from '../errors/exceptions/undefined-dependency.exception';
 import { UnknownDependenciesException } from '../errors/exceptions/unknown-dependencies.exception';
@@ -29,18 +34,18 @@ import {
   InstanceWrapper,
   PropertyMetadata,
 } from './instance-wrapper';
-import { InstanceToken, Module } from './module';
+import { Module } from './module';
 
 /**
  * The type of an injectable dependency
  */
-export type InjectorDependency = Type<any> | Function | string | symbol;
+export type InjectorDependency = InjectionToken;
 
 /**
  * The property-based dependency
  */
 export interface PropertyDependency {
-  key: string;
+  key: symbol | string;
   name: InjectorDependency;
   isOptional?: boolean;
   instance?: any;
@@ -73,9 +78,11 @@ export interface InjectorDependencyContext {
 export class Injector {
   private logger: LoggerService = new Logger('InjectorLogger');
 
+  constructor(private readonly options?: { preview: boolean }) {}
+
   public loadPrototype<T>(
     { token }: InstanceWrapper<T>,
-    collection: Map<InstanceToken, InstanceWrapper<T>>,
+    collection: Map<InjectionToken, InstanceWrapper<T>>,
     contextId = STATIC_CONTEXT,
   ) {
     if (!collection) {
@@ -94,15 +101,22 @@ export class Injector {
 
   public async loadInstance<T>(
     wrapper: InstanceWrapper<T>,
-    collection: Map<InstanceToken, InstanceWrapper>,
+    collection: Map<InjectionToken, InstanceWrapper>,
     moduleRef: Module,
     contextId = STATIC_CONTEXT,
     inquirer?: InstanceWrapper,
   ) {
     const inquirerId = this.getInquirerId(inquirer);
-    const instanceHost = wrapper.getInstanceByContextId(contextId, inquirerId);
+    const instanceHost = wrapper.getInstanceByContextId(
+      this.getContextId(contextId, wrapper),
+      inquirerId,
+    );
     if (instanceHost.isPending) {
-      return instanceHost.donePromise;
+      return instanceHost.donePromise.then((err?: unknown) => {
+        if (err) {
+          throw err;
+        }
+      });
     }
     const done = this.applyDoneHook(instanceHost);
     const token = wrapper.token || wrapper.name;
@@ -115,39 +129,46 @@ export class Injector {
     if (instanceHost.isResolved) {
       return done();
     }
-    const callback = async (instances: unknown[]) => {
-      const properties = await this.resolveProperties(
+    try {
+      const t0 = this.getNowTimestamp();
+      const callback = async (instances: unknown[]) => {
+        const properties = await this.resolveProperties(
+          wrapper,
+          moduleRef,
+          inject as InjectionToken[],
+          contextId,
+          wrapper,
+          inquirer,
+        );
+        const instance = await this.instantiateClass(
+          instances,
+          wrapper,
+          targetWrapper,
+          contextId,
+          inquirer,
+        );
+        this.applyProperties(instance, properties);
+        wrapper.initTime = this.getNowTimestamp() - t0;
+        done();
+      };
+      await this.resolveConstructorParams<T>(
         wrapper,
         moduleRef,
-        inject,
+        inject as InjectionToken[],
+        callback,
         contextId,
         wrapper,
         inquirer,
       );
-      const instance = await this.instantiateClass(
-        instances,
-        wrapper,
-        targetWrapper,
-        contextId,
-        inquirer,
-      );
-      this.applyProperties(instance, properties);
-      done();
-    };
-    await this.resolveConstructorParams<T>(
-      wrapper,
-      moduleRef,
-      inject,
-      callback,
-      contextId,
-      wrapper,
-      inquirer,
-    );
+    } catch (err) {
+      done(err);
+      throw err;
+    }
   }
 
   public async loadMiddleware(
     wrapper: InstanceWrapper,
-    collection: Map<InstanceToken, InstanceWrapper>,
+    collection: Map<InjectionToken, InstanceWrapper>,
     moduleRef: Module,
     contextId = STATIC_CONTEXT,
     inquirer?: InstanceWrapper,
@@ -216,9 +237,11 @@ export class Injector {
     await this.loadEnhancersPerContext(wrapper, contextId, wrapper);
   }
 
-  public applyDoneHook<T>(wrapper: InstancePerContext<T>): () => void {
-    let done: () => void;
-    wrapper.donePromise = new Promise<void>((resolve, reject) => {
+  public applyDoneHook<T>(
+    wrapper: InstancePerContext<T>,
+  ): (err?: unknown) => void {
+    let done: (err?: unknown) => void;
+    wrapper.donePromise = new Promise<unknown>((resolve, reject) => {
       done = resolve;
     });
     wrapper.isPending = true;
@@ -246,12 +269,11 @@ export class Injector {
       );
       return callback(deps);
     }
-    const dependencies = isNil(inject)
-      ? this.reflectConstructorParams(wrapper.metatype as Type<any>)
-      : inject;
-    const optionalDependenciesIds = isNil(inject)
-      ? this.reflectOptionalParams(wrapper.metatype as Type<any>)
-      : [];
+
+    const isFactoryProvider = !isNil(inject);
+    const [dependencies, optionalDependenciesIds] = isFactoryProvider
+      ? this.getFactoryProviderDependencies(wrapper)
+      : this.getClassDependencies(wrapper);
 
     let isResolved = true;
     const resolveParam = async (param: unknown, index: number) => {
@@ -273,7 +295,7 @@ export class Injector {
           index,
         );
         const instanceHost = paramWrapper.getInstanceByContextId(
-          contextId,
+          this.getContextId(contextId, paramWrapper),
           inquirerId,
         );
         if (!instanceHost.isResolved && !paramWrapper.forwardRef) {
@@ -292,8 +314,51 @@ export class Injector {
     isResolved && (await callback(instances));
   }
 
+  public getClassDependencies<T>(
+    wrapper: InstanceWrapper<T>,
+  ): [InjectorDependency[], number[]] {
+    const ctorRef = wrapper.metatype as Type<any>;
+    return [
+      this.reflectConstructorParams(ctorRef),
+      this.reflectOptionalParams(ctorRef),
+    ];
+  }
+
+  public getFactoryProviderDependencies<T>(
+    wrapper: InstanceWrapper<T>,
+  ): [InjectorDependency[], number[]] {
+    const optionalDependenciesIds = [];
+    const isOptionalFactoryDep = (
+      item: InjectionToken | OptionalFactoryDependency,
+    ): item is OptionalFactoryDependency =>
+      !isUndefined((item as OptionalFactoryDependency).token) &&
+      !isUndefined((item as OptionalFactoryDependency).optional);
+
+    const mapFactoryProviderInjectArray = (
+      item: InjectionToken | OptionalFactoryDependency,
+      index: number,
+    ): InjectionToken => {
+      if (typeof item !== 'object') {
+        return item;
+      }
+      if (isOptionalFactoryDep(item)) {
+        if (item.optional) {
+          optionalDependenciesIds.push(index);
+        }
+        return item?.token;
+      }
+      return item;
+    };
+    return [
+      wrapper.inject?.map?.(mapFactoryProviderInjectArray),
+      optionalDependenciesIds,
+    ];
+  }
+
   public reflectConstructorParams<T>(type: Type<T>): any[] {
-    const paramtypes = Reflect.getMetadata(PARAMTYPES_METADATA, type) || [];
+    const paramtypes = [
+      ...(Reflect.getMetadata(PARAMTYPES_METADATA, type) || []),
+    ];
     const selfParams = this.reflectSelfParams<T>(type);
 
     selfParams.forEach(({ index, param }) => (paramtypes[index] = param));
@@ -315,7 +380,7 @@ export class Injector {
     moduleRef: Module,
     contextId = STATIC_CONTEXT,
     inquirer?: InstanceWrapper,
-    keyOrIndex?: string | number,
+    keyOrIndex?: symbol | string | number,
   ) {
     if (isUndefined(param)) {
       this.logger.log(
@@ -352,12 +417,12 @@ export class Injector {
 
   public async resolveComponentInstance<T>(
     moduleRef: Module,
-    token: InstanceToken,
+    token: InjectionToken,
     dependencyContext: InjectorDependencyContext,
     wrapper: InstanceWrapper<T>,
     contextId = STATIC_CONTEXT,
     inquirer?: InstanceWrapper,
-    keyOrIndex?: string | number,
+    keyOrIndex?: symbol | string | number,
   ): Promise<InstanceWrapper> {
     this.printResolvingDependenciesLog(token, inquirer);
     this.printLookingForProviderLog(token, moduleRef);
@@ -388,11 +453,16 @@ export class Injector {
   ): Promise<InstanceWrapper> {
     const inquirerId = this.getInquirerId(inquirer);
     const instanceHost = instanceWrapper.getInstanceByContextId(
-      contextId,
+      this.getContextId(contextId, instanceWrapper),
       inquirerId,
     );
     if (!instanceHost.isResolved && !instanceWrapper.forwardRef) {
-      await this.loadProvider(instanceWrapper, moduleRef, contextId, inquirer);
+      await this.loadProvider(
+        instanceWrapper,
+        instanceWrapper.host ?? moduleRef,
+        contextId,
+        inquirer,
+      );
     } else if (
       !instanceHost.isResolved &&
       instanceWrapper.forwardRef &&
@@ -412,7 +482,7 @@ export class Injector {
     }
     if (instanceWrapper.async) {
       const host = instanceWrapper.getInstanceByContextId(
-        contextId,
+        this.getContextId(contextId, instanceWrapper),
         inquirerId,
       );
       host.instance = await host.instance;
@@ -428,14 +498,16 @@ export class Injector {
     wrapper: InstanceWrapper<T>,
     contextId = STATIC_CONTEXT,
     inquirer?: InstanceWrapper,
-    keyOrIndex?: string | number,
+    keyOrIndex?: symbol | string | number,
   ): Promise<InstanceWrapper<T>> {
+    const token = wrapper.token || wrapper.name;
     const { name } = dependencyContext;
-    if (wrapper && wrapper.name === name) {
+    if (wrapper && token === name) {
       throw new UnknownDependenciesException(
         wrapper.name,
         dependencyContext,
         moduleRef,
+        { id: wrapper.id },
       );
     }
     if (providers.has(name)) {
@@ -460,7 +532,7 @@ export class Injector {
     wrapper: InstanceWrapper<T>,
     contextId = STATIC_CONTEXT,
     inquirer?: InstanceWrapper,
-    keyOrIndex?: string | number,
+    keyOrIndex?: symbol | string | number,
   ) {
     const instanceWrapper = await this.lookupComponentInImports(
       moduleRef,
@@ -476,6 +548,7 @@ export class Injector {
         wrapper.name,
         dependencyContext,
         moduleRef,
+        { id: wrapper.id },
       );
     }
     return instanceWrapper;
@@ -483,12 +556,12 @@ export class Injector {
 
   public async lookupComponentInImports(
     moduleRef: Module,
-    name: InstanceToken,
+    name: InjectionToken,
     wrapper: InstanceWrapper,
     moduleRegistry: any[] = [],
     contextId = STATIC_CONTEXT,
     inquirer?: InstanceWrapper,
-    keyOrIndex?: string | number,
+    keyOrIndex?: symbol | string | number,
     isTraversing?: boolean,
   ): Promise<any> {
     let instanceWrapperRef: InstanceWrapper = null;
@@ -532,7 +605,7 @@ export class Injector {
 
       const inquirerId = this.getInquirerId(inquirer);
       const instanceHost = instanceWrapperRef.getInstanceByContextId(
-        contextId,
+        this.getContextId(contextId, instanceWrapperRef),
         inquirerId,
       );
       if (!instanceHost.isResolved && !instanceWrapperRef.forwardRef) {
@@ -588,7 +661,7 @@ export class Injector {
           }
           const inquirerId = this.getInquirerId(inquirer);
           const instanceHost = paramWrapper.getInstanceByContextId(
-            contextId,
+            this.getContextId(contextId, paramWrapper),
             inquirerId,
           );
           return instanceHost.instance;
@@ -640,7 +713,7 @@ export class Injector {
     const { metatype, inject } = wrapper;
     const inquirerId = this.getInquirerId(inquirer);
     const instanceHost = targetMetatype.getInstanceByContextId(
-      contextId,
+      this.getContextId(contextId, targetMetatype),
       inquirerId,
     );
     const isInContext =
@@ -649,6 +722,11 @@ export class Injector {
       wrapper.isLazyTransient(contextId, inquirer) ||
       wrapper.isExplicitlyRequested(contextId, inquirer);
 
+    if (this.options?.preview && !wrapper.host?.initOnPreview) {
+      instanceHost.isResolved = true;
+      return instanceHost.instance;
+    }
+
     if (isNil(inject) && isInContext) {
       instanceHost.instance = wrapper.forwardRef
         ? Object.assign(
@@ -669,7 +747,7 @@ export class Injector {
   public async loadPerContext<T = any>(
     instance: T,
     moduleRef: Module,
-    collection: Map<InstanceToken, InstanceWrapper>,
+    collection: Map<InjectionToken, InstanceWrapper>,
     ctx: ContextId,
     wrapper?: InstanceWrapper,
   ): Promise<T> {
@@ -680,7 +758,10 @@ export class Injector {
     await this.loadInstance(wrapper, collection, moduleRef, ctx, wrapper);
     await this.loadEnhancersPerContext(wrapper, ctx, wrapper);
 
-    const host = wrapper.getInstanceByContextId(ctx, wrapper.id);
+    const host = wrapper.getInstanceByContextId(
+      this.getContextId(ctx, wrapper),
+      wrapper.id,
+    );
     return host && (host.instance as T);
   }
 
@@ -709,7 +790,7 @@ export class Injector {
     inquirer?: InstanceWrapper,
     parentInquirer?: InstanceWrapper,
   ): Promise<any[]> {
-    const hosts = await Promise.all(
+    const hosts: Array<InstanceWrapper<any> | undefined> = await Promise.all(
       metadata.map(async item =>
         this.resolveScopedComponentHost(
           item,
@@ -721,7 +802,11 @@ export class Injector {
     );
     const inquirerId = this.getInquirerId(inquirer);
     return hosts.map(
-      item => item.getInstanceByContextId(contextId, inquirerId).instance,
+      item =>
+        item?.getInstanceByContextId(
+          this.getContextId(contextId, item),
+          inquirerId,
+        ).instance,
     );
   }
 
@@ -745,7 +830,10 @@ export class Injector {
     return dependenciesHosts.map(({ key, host }) => ({
       key,
       name: key,
-      instance: host.getInstanceByContextId(contextId, inquirerId).instance,
+      instance: host.getInstanceByContextId(
+        this.getContextId(contextId, host),
+        inquirerId,
+      ).instance,
     }));
   }
 
@@ -779,21 +867,23 @@ export class Injector {
   }
 
   protected addDependencyMetadata(
-    keyOrIndex: number | string,
+    keyOrIndex: symbol | string | number,
     hostWrapper: InstanceWrapper,
     instanceWrapper: InstanceWrapper,
   ) {
-    isString(keyOrIndex)
-      ? hostWrapper.addPropertiesMetadata(keyOrIndex, instanceWrapper)
-      : hostWrapper.addCtorMetadata(keyOrIndex, instanceWrapper);
+    if (isSymbol(keyOrIndex) || isString(keyOrIndex)) {
+      hostWrapper.addPropertiesMetadata(keyOrIndex, instanceWrapper);
+    } else {
+      hostWrapper.addCtorMetadata(keyOrIndex, instanceWrapper);
+    }
   }
 
-  private getTokenName(token: InstanceToken): string {
+  private getTokenName(token: InjectionToken): string {
     return isFunction(token) ? (token as Function).name : token.toString();
   }
 
   private printResolvingDependenciesLog(
-    token: InstanceToken,
+    token: InjectionToken,
     inquirer?: InstanceWrapper,
   ): void {
     if (!this.isDebugMode()) {
@@ -814,7 +904,7 @@ export class Injector {
   }
 
   private printLookingForProviderLog(
-    token: InstanceToken,
+    token: InjectionToken,
     moduleRef: Module,
   ): void {
     if (!this.isDebugMode()) {
@@ -829,7 +919,10 @@ export class Injector {
     );
   }
 
-  private printFoundInModuleLog(token: InstanceToken, moduleRef: Module): void {
+  private printFoundInModuleLog(
+    token: InjectionToken,
+    moduleRef: Module,
+  ): void {
     if (!this.isDebugMode()) {
       return;
     }
@@ -845,4 +938,20 @@ export class Injector {
   private isDebugMode(): boolean {
     return !!process.env.NEST_DEBUG;
   }
+
+  private getContextId(
+    contextId: ContextId,
+    instanceWrapper: InstanceWrapper,
+  ): ContextId {
+    return contextId.getParent
+      ? contextId.getParent({
+          token: instanceWrapper.token,
+          isTreeDurable: instanceWrapper.isDependencyTreeDurable(),
+        })
+      : contextId;
+  }
+
+  private getNowTimestamp() {
+    return performance.now();
+  }
 }
diff --git a/packages/core/injector/instance-links-host.ts b/packages/core/injector/instance-links-host.ts
index a07617d28..bd6839e30 100644
--- a/packages/core/injector/instance-links-host.ts
+++ b/packages/core/injector/instance-links-host.ts
@@ -1,34 +1,50 @@
+import { InjectionToken } from '@nestjs/common';
 import { isFunction } from '@nestjs/common/utils/shared.utils';
 import { UnknownElementException } from '../errors/exceptions/unknown-element.exception';
 import { NestContainer } from './container';
 import { InstanceWrapper } from './instance-wrapper';
-import { InstanceToken, Module } from './module';
+import { Module } from './module';
 
 type HostCollection = 'providers' | 'controllers' | 'injectables';
 
 export interface InstanceLink<T = any> {
-  token: InstanceToken;
+  token: InjectionToken;
   wrapperRef: InstanceWrapper<T>;
   collection: Map<any, InstanceWrapper>;
   moduleId: string;
 }
 
 export class InstanceLinksHost {
-  private readonly instanceLinks = new Map<InstanceToken, InstanceLink[]>();
+  private readonly instanceLinks = new Map<InjectionToken, InstanceLink[]>();
 
   constructor(private readonly container: NestContainer) {
     this.initialize();
   }
 
-  get<T = any>(token: InstanceToken, moduleId?: string): InstanceLink<T> {
-    const modulesMap = this.instanceLinks.get(token);
+  get<T = any>(token: InjectionToken): InstanceLink<T>;
+  get<T = any>(
+    token: InjectionToken,
+    options?: { moduleId?: string; each?: boolean },
+  ): InstanceLink<T> | Array<InstanceLink<T>>;
+  get<T = any>(
+    token: InjectionToken,
+    options: { moduleId?: string; each?: boolean } = {},
+  ): InstanceLink<T> | Array<InstanceLink<T>> {
+    const instanceLinksForGivenToken = this.instanceLinks.get(token);
 
-    if (!modulesMap) {
+    if (!instanceLinksForGivenToken) {
       throw new UnknownElementException(this.getInstanceNameByToken(token));
     }
-    const instanceLink = moduleId
-      ? modulesMap.find(item => item.moduleId === moduleId)
-      : modulesMap[modulesMap.length - 1];
+
+    if (options.each) {
+      return instanceLinksForGivenToken;
+    }
+
+    const instanceLink = options.moduleId
+      ? instanceLinksForGivenToken.find(
+          item => item.moduleId === options.moduleId,
+        )
+      : instanceLinksForGivenToken[instanceLinksForGivenToken.length - 1];
 
     if (!instanceLink) {
       throw new UnknownElementException(this.getInstanceNameByToken(token));
@@ -54,7 +70,7 @@ export class InstanceLinksHost {
 
   private addLink(
     wrapper: InstanceWrapper,
-    token: InstanceToken,
+    token: InjectionToken,
     moduleRef: Module,
     collectionName: HostCollection,
   ) {
@@ -72,7 +88,7 @@ export class InstanceLinksHost {
     }
   }
 
-  private getInstanceNameByToken(token: InstanceToken): string {
+  private getInstanceNameByToken(token: InjectionToken): string {
     return isFunction(token) ? (token as Function)?.name : (token as string);
   }
 }
diff --git a/packages/core/injector/instance-loader.ts b/packages/core/injector/instance-loader.ts
index 01df482f8..489ffdef4 100644
--- a/packages/core/injector/instance-loader.ts
+++ b/packages/core/injector/instance-loader.ts
@@ -1,26 +1,40 @@
-import { Logger } from '@nestjs/common';
+import { Logger, LoggerService } from '@nestjs/common';
 import { Controller } from '@nestjs/common/interfaces/controllers/controller.interface';
 import { Injectable } from '@nestjs/common/interfaces/injectable.interface';
 import { MODULE_INIT_MESSAGE } from '../helpers/messages';
+import { GraphInspector } from '../inspector/graph-inspector';
 import { NestContainer } from './container';
 import { Injector } from './injector';
-import { InternalCoreModule } from './internal-core-module';
+import { InternalCoreModule } from './internal-core-module/internal-core-module';
 import { Module } from './module';
 
-export class InstanceLoader {
-  protected readonly injector = new Injector();
+export class InstanceLoader<TInjector extends Injector = Injector> {
   constructor(
     protected readonly container: NestContainer,
-    private readonly logger = new Logger(InstanceLoader.name, {
+    protected readonly injector: TInjector,
+    protected readonly graphInspector: GraphInspector,
+    private logger: LoggerService = new Logger(InstanceLoader.name, {
       timestamp: true,
     }),
   ) {}
 
+  public setLogger(logger: Logger) {
+    this.logger = logger;
+  }
+
   public async createInstancesOfDependencies(
     modules: Map<string, Module> = this.container.getModules(),
   ) {
     this.createPrototypes(modules);
-    await this.createInstances(modules);
+
+    try {
+      await this.createInstances(modules);
+    } catch (err) {
+      this.graphInspector.inspectModules(modules);
+      this.graphInspector.registerPartial(err);
+      throw err;
+    }
+    this.graphInspector.inspectModules(modules);
   }
 
   private createPrototypes(modules: Map<string, Module>) {
@@ -38,7 +52,7 @@ export class InstanceLoader {
         await this.createInstancesOfInjectables(moduleRef);
         await this.createInstancesOfControllers(moduleRef);
 
-        const { name } = moduleRef.metatype;
+        const { name } = moduleRef;
         this.isModuleWhitelisted(name) &&
           this.logger.log(MODULE_INIT_MESSAGE`${name}`);
       }),
@@ -56,7 +70,10 @@ export class InstanceLoader {
     const { providers } = moduleRef;
     const wrappers = [...providers.values()];
     await Promise.all(
-      wrappers.map(item => this.injector.loadProvider(item, moduleRef)),
+      wrappers.map(async item => {
+        await this.injector.loadProvider(item, moduleRef);
+        this.graphInspector.inspectInstanceWrapper(item, moduleRef);
+      }),
     );
   }
 
@@ -71,7 +88,10 @@ export class InstanceLoader {
     const { controllers } = moduleRef;
     const wrappers = [...controllers.values()];
     await Promise.all(
-      wrappers.map(item => this.injector.loadController(item, moduleRef)),
+      wrappers.map(async item => {
+        await this.injector.loadController(item, moduleRef);
+        this.graphInspector.inspectInstanceWrapper(item, moduleRef);
+      }),
     );
   }
 
@@ -86,7 +106,10 @@ export class InstanceLoader {
     const { injectables } = moduleRef;
     const wrappers = [...injectables.values()];
     await Promise.all(
-      wrappers.map(item => this.injector.loadInjectable(item, moduleRef)),
+      wrappers.map(async item => {
+        await this.injector.loadInjectable(item, moduleRef);
+        this.graphInspector.inspectInstanceWrapper(item, moduleRef);
+      }),
     );
   }
 
diff --git a/packages/core/injector/instance-wrapper.ts b/packages/core/injector/instance-wrapper.ts
index 9d9d29579..d29ae711d 100644
--- a/packages/core/injector/instance-wrapper.ts
+++ b/packages/core/injector/instance-wrapper.ts
@@ -1,30 +1,52 @@
-import { Provider, Scope, Type } from '@nestjs/common';
-import {
-  ClassProvider,
-  FactoryProvider,
-  ValueProvider,
-} from '@nestjs/common/interfaces';
+import { Logger, LoggerService, Provider, Scope, Type } from '@nestjs/common';
+import { EnhancerSubtype } from '@nestjs/common/constants';
+import { FactoryProvider, InjectionToken } from '@nestjs/common/interfaces';
+import { clc } from '@nestjs/common/utils/cli-colors.util';
 import { randomStringGenerator } from '@nestjs/common/utils/random-string-generator.util';
-import { isNil, isUndefined } from '@nestjs/common/utils/shared.utils';
+import {
+  isNil,
+  isString,
+  isUndefined,
+} from '@nestjs/common/utils/shared.utils';
 import { iterate } from 'iterare';
+import { UuidFactory } from '../inspector/uuid-factory';
 import { STATIC_CONTEXT } from './constants';
-import { InstanceToken, Module } from './module';
+import {
+  isClassProvider,
+  isFactoryProvider,
+  isValueProvider,
+} from './helpers/provider-classifier';
+import { Module } from './module';
 
 export const INSTANCE_METADATA_SYMBOL = Symbol.for('instance_metadata:cache');
 export const INSTANCE_ID_SYMBOL = Symbol.for('instance_metadata:id');
 
+export interface HostComponentInfo {
+  /**
+   * Injection token (or class reference)
+   */
+  token: InjectionToken;
+  /**
+   * Flag that indicates whether DI subtree is durable
+   */
+  isTreeDurable: boolean;
+}
+
 export interface ContextId {
   readonly id: number;
+  payload?: unknown;
+  getParent?(info: HostComponentInfo): ContextId;
 }
 
 export interface InstancePerContext<T> {
   instance: T;
   isResolved?: boolean;
   isPending?: boolean;
-  donePromise?: Promise<void>;
+  donePromise?: Promise<unknown>;
 }
+
 export interface PropertyMetadata {
-  key: string;
+  key: symbol | string;
   wrapper: InstanceWrapper;
 }
 
@@ -36,15 +58,20 @@ interface InstanceMetadataStore {
 
 export class InstanceWrapper<T = any> {
   public readonly name: any;
-  public readonly token: InstanceToken;
+  public readonly token: InjectionToken;
   public readonly async?: boolean;
   public readonly host?: Module;
   public readonly isAlias: boolean = false;
+  public readonly subtype?: EnhancerSubtype;
 
   public scope?: Scope = Scope.DEFAULT;
   public metatype: Type<T> | Function;
-  public inject?: (string | symbol | Function | Type<any>)[];
+  public inject?: FactoryProvider['inject'];
   public forwardRef?: boolean;
+  public durable?: boolean;
+  public initTime?: number;
+
+  private static logger: LoggerService = new Logger(InstanceWrapper.name);
 
   private readonly values = new WeakMap<ContextId, InstancePerContext<T>>();
   private readonly [INSTANCE_METADATA_SYMBOL]: InstanceMetadataStore = {};
@@ -53,12 +80,14 @@ export class InstanceWrapper<T = any> {
     | Map<string, WeakMap<ContextId, InstancePerContext<T>>>
     | undefined;
   private isTreeStatic: boolean | undefined;
+  private isTreeDurable: boolean | undefined;
 
   constructor(
     metadata: Partial<InstanceWrapper<T>> & Partial<InstancePerContext<T>> = {},
   ) {
-    this[INSTANCE_ID_SYMBOL] = randomStringGenerator();
     this.initialize(metadata);
+    this[INSTANCE_ID_SYMBOL] =
+      metadata[INSTANCE_ID_SYMBOL] ?? this.generateUuid();
   }
 
   get id(): string {
@@ -146,7 +175,7 @@ export class InstanceWrapper<T = any> {
     return this[INSTANCE_METADATA_SYMBOL].dependencies;
   }
 
-  public addPropertiesMetadata(key: string, wrapper: InstanceWrapper) {
+  public addPropertiesMetadata(key: symbol | string, wrapper: InstanceWrapper) {
     if (!this[INSTANCE_METADATA_SYMBOL].properties) {
       this[INSTANCE_METADATA_SYMBOL].properties = [];
     }
@@ -171,38 +200,91 @@ export class InstanceWrapper<T = any> {
     return this[INSTANCE_METADATA_SYMBOL].enhancers;
   }
 
-  public isDependencyTreeStatic(lookupRegistry: string[] = []): boolean {
-    if (!isUndefined(this.isTreeStatic)) {
-      return this.isTreeStatic;
+  public isDependencyTreeDurable(lookupRegistry: string[] = []): boolean {
+    if (!isUndefined(this.isTreeDurable)) {
+      return this.isTreeDurable;
     }
     if (this.scope === Scope.REQUEST) {
-      this.isTreeStatic = false;
-      return this.isTreeStatic;
+      this.isTreeDurable = this.durable === undefined ? false : this.durable;
+      if (this.isTreeDurable) {
+        this.printIntrospectedAsDurable();
+      }
+      return this.isTreeDurable;
+    }
+    const isStatic = this.isDependencyTreeStatic();
+    if (isStatic) {
+      return false;
     }
+
+    const isTreeNonDurable = this.introspectDepsAttribute(
+      (collection, registry) =>
+        collection.some(
+          (item: InstanceWrapper) =>
+            !item.isDependencyTreeStatic() &&
+            !item.isDependencyTreeDurable(registry),
+        ),
+      lookupRegistry,
+    );
+    this.isTreeDurable = !isTreeNonDurable;
+    if (this.isTreeDurable) {
+      this.printIntrospectedAsDurable();
+    }
+    return this.isTreeDurable;
+  }
+
+  public introspectDepsAttribute(
+    callback: (
+      collection: InstanceWrapper[],
+      lookupRegistry: string[],
+    ) => boolean,
+    lookupRegistry: string[] = [],
+  ): boolean {
     if (lookupRegistry.includes(this[INSTANCE_ID_SYMBOL])) {
-      return true;
+      return false;
     }
     lookupRegistry = lookupRegistry.concat(this[INSTANCE_ID_SYMBOL]);
 
     const { dependencies, properties, enhancers } =
       this[INSTANCE_METADATA_SYMBOL];
-    let isStatic =
-      (dependencies &&
-        this.isWrapperListStatic(dependencies, lookupRegistry)) ||
-      !dependencies;
 
-    if (!isStatic || !(properties || enhancers)) {
-      this.isTreeStatic = isStatic;
+    let introspectionResult = dependencies
+      ? callback(dependencies, lookupRegistry)
+      : false;
+
+    if (introspectionResult || !(properties || enhancers)) {
+      return introspectionResult;
+    }
+    introspectionResult = properties
+      ? callback(
+          properties.map(item => item.wrapper),
+          lookupRegistry,
+        )
+      : false;
+    if (introspectionResult || !enhancers) {
+      return introspectionResult;
+    }
+    return enhancers ? callback(enhancers, lookupRegistry) : false;
+  }
+
+  public isDependencyTreeStatic(lookupRegistry: string[] = []): boolean {
+    if (!isUndefined(this.isTreeStatic)) {
       return this.isTreeStatic;
     }
-    const propertiesHosts = (properties || []).map(item => item.wrapper);
-    isStatic =
-      isStatic && this.isWrapperListStatic(propertiesHosts, lookupRegistry);
-    if (!isStatic || !enhancers) {
-      this.isTreeStatic = isStatic;
+    if (this.scope === Scope.REQUEST) {
+      this.isTreeStatic = false;
+      this.printIntrospectedAsRequestScoped();
       return this.isTreeStatic;
     }
-    this.isTreeStatic = this.isWrapperListStatic(enhancers, lookupRegistry);
+    this.isTreeStatic = !this.introspectDepsAttribute(
+      (collection, registry) =>
+        collection.some(
+          (item: InstanceWrapper) => !item.isDependencyTreeStatic(registry),
+        ),
+      lookupRegistry,
+    );
+    if (!this.isTreeStatic) {
+      this.printIntrospectedAsRequestScoped();
+    }
     return this.isTreeStatic;
   }
 
@@ -318,22 +400,23 @@ export class InstanceWrapper<T = any> {
   }
 
   public mergeWith(provider: Provider) {
-    if (!isUndefined((provider as ValueProvider).useValue)) {
+    if (isValueProvider(provider)) {
       this.metatype = null;
       this.inject = null;
+
       this.scope = Scope.DEFAULT;
 
       this.setInstanceByContextId(STATIC_CONTEXT, {
-        instance: (provider as ValueProvider).useValue,
+        instance: provider.useValue,
         isResolved: true,
         isPending: false,
       });
-    } else if ((provider as ClassProvider).useClass) {
+    } else if (isClassProvider(provider)) {
       this.inject = null;
-      this.metatype = (provider as ClassProvider).useClass;
-    } else if ((provider as FactoryProvider).useFactory) {
-      this.metatype = (provider as FactoryProvider).useFactory;
-      this.inject = (provider as FactoryProvider).inject || [];
+      this.metatype = provider.useClass;
+    } else if (isFactoryProvider(provider)) {
+      this.metatype = provider.useFactory;
+      this.inject = provider.inject || [];
     }
   }
 
@@ -341,15 +424,6 @@ export class InstanceWrapper<T = any> {
     return isNil(this.inject) && this.metatype && this.metatype.prototype;
   }
 
-  private isWrapperListStatic(
-    tree: InstanceWrapper[],
-    lookupRegistry: string[],
-  ): boolean {
-    return tree.every((item: InstanceWrapper) =>
-      item.isDependencyTreeStatic(lookupRegistry),
-    );
-  }
-
   private initialize(
     metadata: Partial<InstanceWrapper<T>> & Partial<InstancePerContext<T>>,
   ) {
@@ -362,4 +436,41 @@ export class InstanceWrapper<T = any> {
     });
     this.scope === Scope.TRANSIENT && (this.transientMap = new Map());
   }
+
+  private printIntrospectedAsRequestScoped() {
+    if (!this.isDebugMode() || this.name === 'REQUEST') {
+      return;
+    }
+    if (isString(this.name)) {
+      InstanceWrapper.logger.log(
+        `${clc.cyanBright(this.name)}${clc.green(
+          ' introspected as ',
+        )}${clc.magentaBright('request-scoped')}`,
+      );
+    }
+  }
+
+  private printIntrospectedAsDurable() {
+    if (!this.isDebugMode()) {
+      return;
+    }
+    if (isString(this.name)) {
+      InstanceWrapper.logger.log(
+        `${clc.cyanBright(this.name)}${clc.green(
+          ' introspected as ',
+        )}${clc.magentaBright('durable')}`,
+      );
+    }
+  }
+
+  private isDebugMode(): boolean {
+    return !!process.env.NEST_DEBUG;
+  }
+
+  private generateUuid(): string {
+    let key = this.name?.toString() ?? this.token?.toString();
+    key += this.host?.name ?? '';
+
+    return key ? UuidFactory.get(key) : randomStringGenerator();
+  }
 }
diff --git a/packages/core/injector/internal-core-module-factory.ts b/packages/core/injector/internal-core-module-factory.ts
deleted file mode 100644
index daac18369..000000000
--- a/packages/core/injector/internal-core-module-factory.ts
+++ /dev/null
@@ -1,55 +0,0 @@
-import { Logger } from '@nestjs/common';
-import { ExternalContextCreator } from '../helpers/external-context-creator';
-import { HttpAdapterHost } from '../helpers/http-adapter-host';
-import { DependenciesScanner, ModuleToOverride } from '../scanner';
-import { ModuleCompiler } from './compiler';
-import { NestContainer } from './container';
-import { InstanceLoader } from './instance-loader';
-import { InternalCoreModule } from './internal-core-module';
-import { LazyModuleLoader } from './lazy-module-loader';
-import { ModulesContainer } from './modules-container';
-
-export class InternalCoreModuleFactory {
-  static create(
-    container: NestContainer,
-    scanner: DependenciesScanner,
-    moduleCompiler: ModuleCompiler,
-    httpAdapterHost: HttpAdapterHost,
-    modulesToOverride?: ModuleToOverride[],
-  ) {
-    return InternalCoreModule.register([
-      {
-        provide: ExternalContextCreator,
-        useValue: ExternalContextCreator.fromContainer(container),
-      },
-      {
-        provide: ModulesContainer,
-        useValue: container.getModules(),
-      },
-      {
-        provide: HttpAdapterHost,
-        useValue: httpAdapterHost,
-      },
-      {
-        provide: HttpAdapterHost.name,
-        useExisting: HttpAdapterHost,
-      },
-      {
-        provide: LazyModuleLoader,
-        useFactory: () => {
-          const logger = new Logger(LazyModuleLoader.name, {
-            timestamp: false,
-          });
-          const instanceLoader = new InstanceLoader(container, logger);
-          return new LazyModuleLoader(
-            scanner,
-            instanceLoader,
-            moduleCompiler,
-            container.getModules(),
-            modulesToOverride,
-          );
-        },
-      },
-    ]);
-  }
-}
diff --git a/packages/core/injector/internal-core-module/index.ts b/packages/core/injector/internal-core-module/index.ts
new file mode 100644
index 000000000..a863c2132
--- /dev/null
+++ b/packages/core/injector/internal-core-module/index.ts
@@ -0,0 +1 @@
+export * from './internal-core-module';
diff --git a/packages/core/injector/internal-core-module/internal-core-module-factory.ts b/packages/core/injector/internal-core-module/internal-core-module-factory.ts
new file mode 100644
index 000000000..2e93650a9
--- /dev/null
+++ b/packages/core/injector/internal-core-module/internal-core-module-factory.ts
@@ -0,0 +1,65 @@
+import { Logger } from '@nestjs/common';
+import { ExternalContextCreator } from '../../helpers/external-context-creator';
+import { HttpAdapterHost } from '../../helpers/http-adapter-host';
+import { GraphInspector } from '../../inspector/graph-inspector';
+import { SerializedGraph } from '../../inspector/serialized-graph';
+import { DependenciesScanner } from '../../scanner';
+import { ModuleCompiler } from '../compiler';
+import { NestContainer } from '../container';
+import { Injector } from '../injector';
+import { InstanceLoader } from '../instance-loader';
+import { LazyModuleLoader } from '../lazy-module-loader/lazy-module-loader';
+import { ModulesContainer } from '../modules-container';
+import { InternalCoreModule } from './internal-core-module';
+
+export class InternalCoreModuleFactory {
+  static create(
+    container: NestContainer,
+    scanner: DependenciesScanner,
+    moduleCompiler: ModuleCompiler,
+    httpAdapterHost: HttpAdapterHost,
+    graphInspector: GraphInspector,
+  ) {
+    const lazyModuleLoaderFactory = () => {
+      const logger = new Logger(LazyModuleLoader.name, {
+        timestamp: false,
+      });
+      const injector = new Injector();
+      const instanceLoader = new InstanceLoader(
+        container,
+        injector,
+        graphInspector,
+        logger,
+      );
+      return new LazyModuleLoader(
+        scanner,
+        instanceLoader,
+        moduleCompiler,
+        container.getModules(),
+      );
+    };
+
+    return InternalCoreModule.register([
+      {
+        provide: ExternalContextCreator,
+        useValue: ExternalContextCreator.fromContainer(container),
+      },
+      {
+        provide: ModulesContainer,
+        useValue: container.getModules(),
+      },
+      {
+        provide: HttpAdapterHost,
+        useValue: httpAdapterHost,
+      },
+      {
+        provide: LazyModuleLoader,
+        useFactory: lazyModuleLoaderFactory,
+      },
+      {
+        provide: SerializedGraph,
+        useValue: container.serializedGraph,
+      },
+    ]);
+  }
+}
diff --git a/packages/core/injector/internal-core-module.ts b/packages/core/injector/internal-core-module/internal-core-module.ts
similarity index 80%
rename from packages/core/injector/internal-core-module.ts
rename to packages/core/injector/internal-core-module/internal-core-module.ts
index 3e3a6156f..178818337 100644
--- a/packages/core/injector/internal-core-module.ts
+++ b/packages/core/injector/internal-core-module/internal-core-module.ts
@@ -4,9 +4,9 @@ import {
   FactoryProvider,
   ValueProvider,
 } from '@nestjs/common/interfaces';
-import { requestProvider } from '../router/request/request-providers';
-import { Reflector } from '../services';
-import { inquirerProvider } from './inquirer/inquirer-providers';
+import { requestProvider } from '../../router/request/request-providers';
+import { Reflector } from '../../services';
+import { inquirerProvider } from '../inquirer/inquirer-providers';
 
 const ReflectorAliasProvider = {
   provide: Reflector.name,
diff --git a/packages/core/injector/lazy-module-loader/lazy-module-loader-options.interface.ts b/packages/core/injector/lazy-module-loader/lazy-module-loader-options.interface.ts
new file mode 100644
index 000000000..db3a29575
--- /dev/null
+++ b/packages/core/injector/lazy-module-loader/lazy-module-loader-options.interface.ts
@@ -0,0 +1,6 @@
+export interface LazyModuleLoaderLoadOptions {
+  /**
+   * If `false`, no logs will be generated when loading some module lazily.
+   */
+  logger?: boolean;
+}
diff --git a/packages/core/injector/lazy-module-loader.ts b/packages/core/injector/lazy-module-loader/lazy-module-loader.ts
similarity index 68%
rename from packages/core/injector/lazy-module-loader.ts
rename to packages/core/injector/lazy-module-loader/lazy-module-loader.ts
index 3dd11dd15..df145e05e 100644
--- a/packages/core/injector/lazy-module-loader.ts
+++ b/packages/core/injector/lazy-module-loader/lazy-module-loader.ts
@@ -1,10 +1,12 @@
 import { DynamicModule, Type } from '@nestjs/common';
-import { DependenciesScanner, ModuleToOverride } from '../scanner';
-import { ModuleCompiler } from './compiler';
-import { InstanceLoader } from './instance-loader';
-import { Module } from './module';
-import { ModuleRef } from './module-ref';
-import { ModulesContainer } from './modules-container';
+import { DependenciesScanner } from '../../scanner';
+import { ModuleCompiler } from '../compiler';
+import { SilentLogger } from '../helpers/silent-logger';
+import { InstanceLoader } from '../instance-loader';
+import { Module } from '../module';
+import { ModuleRef } from '../module-ref';
+import { ModulesContainer } from '../modules-container';
+import { LazyModuleLoaderLoadOptions } from './lazy-module-loader-options.interface';
 
 export class LazyModuleLoader {
   constructor(
@@ -12,7 +14,6 @@ export class LazyModuleLoader {
     private readonly instanceLoader: InstanceLoader,
     private readonly moduleCompiler: ModuleCompiler,
     private readonly modulesContainer: ModulesContainer,
-    private readonly modulesToOverride?: ModuleToOverride[],
   ) {}
 
   public async load(
@@ -20,15 +21,17 @@ export class LazyModuleLoader {
       | Promise<Type<unknown> | DynamicModule>
       | Type<unknown>
       | DynamicModule,
+    loadOpts?: LazyModuleLoaderLoadOptions,
   ): Promise<ModuleRef> {
+    this.registerLoggerConfiguration(loadOpts);
+
     const moduleClassOrDynamicDefinition = await loaderFn();
-    const moduleInstances = await this.dependenciesScanner.scanForModules({
-      moduleDefinition: moduleClassOrDynamicDefinition,
-      modulesToOverride: this.modulesToOverride,
-    });
+    const moduleInstances = await this.dependenciesScanner.scanForModules(
+      moduleClassOrDynamicDefinition,
+    );
     if (moduleInstances.length === 0) {
       // The module has been loaded already. In this case, we must
-      // retrieve a module reference from the exising container.
+      // retrieve a module reference from the existing container.
       const { token } = await this.moduleCompiler.compile(
         moduleClassOrDynamicDefinition,
       );
@@ -47,6 +50,12 @@ export class LazyModuleLoader {
     return this.getTargetModuleRef(targetModule);
   }
 
+  private registerLoggerConfiguration(loadOpts?: LazyModuleLoaderLoadOptions) {
+    if (loadOpts?.logger === false) {
+      this.instanceLoader.setLogger(new SilentLogger());
+    }
+  }
+
   private createLazyModulesContainer(
     moduleInstances: Module[],
   ): Map<string, Module> {
diff --git a/packages/core/injector/module-ref.ts b/packages/core/injector/module-ref.ts
index 22fe0f383..83aa9c891 100644
--- a/packages/core/injector/module-ref.ts
+++ b/packages/core/injector/module-ref.ts
@@ -1,35 +1,133 @@
 import { IntrospectionResult, Scope, Type } from '@nestjs/common';
-import { InvalidClassScopeException } from '../errors/exceptions/invalid-class-scope.exception';
-import { UnknownElementException } from '../errors/exceptions/unknown-element.exception';
 import { getClassScope } from '../helpers/get-class-scope';
+import { isDurable } from '../helpers/is-durable';
+import { AbstractInstanceResolver } from './abstract-instance-resolver';
 import { NestContainer } from './container';
 import { Injector } from './injector';
 import { InstanceLinksHost } from './instance-links-host';
 import { ContextId, InstanceWrapper } from './instance-wrapper';
 import { Module } from './module';
 
-export abstract class ModuleRef {
-  private readonly injector = new Injector();
+export interface ModuleRefGetOrResolveOpts {
+  /**
+   * If enabled, lookup will only be performed in the host module.
+   * @default true
+   */
+  strict?: boolean;
+  /**
+   * If enabled, instead of returning a first instance registered under a given token,
+   * a list of instances will be returned.
+   * @default false
+   */
+  each?: boolean;
+}
+
+export abstract class ModuleRef extends AbstractInstanceResolver {
+  protected readonly injector = new Injector();
   private _instanceLinksHost: InstanceLinksHost;
 
-  private get instanceLinksHost() {
+  protected get instanceLinksHost() {
     if (!this._instanceLinksHost) {
       this._instanceLinksHost = new InstanceLinksHost(this.container);
     }
     return this._instanceLinksHost;
   }
 
-  constructor(protected readonly container: NestContainer) {}
+  constructor(protected readonly container: NestContainer) {
+    super();
+  }
 
-  public abstract get<TInput = any, TResult = TInput>(
+  /**
+   * Retrieves an instance of either injectable or controller, otherwise, throws exception.
+   * @returns {TResult}
+   */
+  abstract get<TInput = any, TResult = TInput>(
     typeOrToken: Type<TInput> | Function | string | symbol,
-    options?: { strict: boolean },
   ): TResult;
-  public abstract resolve<TInput = any, TResult = TInput>(
+  /**
+   * Retrieves an instance of either injectable or controller, otherwise, throws exception.
+   * @returns {TResult}
+   */
+  abstract get<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    options: {
+      /**
+       * If enabled, lookup will only be performed in the host module.
+       * @default true
+       */
+      strict?: boolean;
+      /** This indicates that only the first instance registered will be returned. */
+      each?: undefined | false;
+    },
+  ): TResult;
+  /**
+   * Retrieves a list of instances of either injectables or controllers, otherwise, throws exception.
+   * @returns {Array<TResult>}
+   */
+  abstract get<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    options: {
+      /**
+       * If enabled, lookup will only be performed in the host module.
+       * @default true
+       */
+      strict?: boolean;
+      /** This indicates that a list of instances will be returned. */
+      each: true;
+    },
+  ): Array<TResult>;
+  /**
+   * Retrieves an instance (or a list of instances) of either injectable or controller, otherwise, throws exception.
+   * @returns {TResult | Array<TResult>}
+   */
+  abstract get<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    options?: ModuleRefGetOrResolveOpts,
+  ): TResult | Array<TResult>;
+
+  /**
+   * Resolves transient or request-scoped instance of either injectable or controller, otherwise, throws exception.
+   * @returns {Array<TResult>}
+   */
+  abstract resolve<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+  ): Promise<TResult>;
+  /**
+   * Resolves transient or request-scoped instance of either injectable or controller, otherwise, throws exception.
+   * @returns {Array<TResult>}
+   */
+  abstract resolve<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    contextId?: { id: number },
+  ): Promise<TResult>;
+  /**
+   * Resolves transient or request-scoped instance of either injectable or controller, otherwise, throws exception.
+   * @returns {Array<TResult>}
+   */
+  abstract resolve<TInput = any, TResult = TInput>(
     typeOrToken: Type<TInput> | Function | string | symbol,
-    contextId?: ContextId,
-    options?: { strict: boolean },
+    contextId?: { id: number },
+    options?: { strict?: boolean; each?: undefined | false },
   ): Promise<TResult>;
+  /**
+   * Resolves transient or request-scoped instances of either injectables or controllers, otherwise, throws exception.
+   * @returns {Array<TResult>}
+   */
+  abstract resolve<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    contextId?: { id: number },
+    options?: { strict?: boolean; each: true },
+  ): Promise<Array<TResult>>;
+  /**
+   * Resolves transient or request-scoped instance (or a list of instances) of either injectable or controller, otherwise, throws exception.
+   * @returns {Promise<TResult | Array<TResult>>}
+   */
+  abstract resolve<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    contextId?: { id: number },
+    options?: ModuleRefGetOrResolveOpts,
+  ): Promise<TResult | Array<TResult>>;
+
   public abstract create<T = any>(type: Type<T>): Promise<T>;
 
   public introspect<T = any>(
@@ -50,54 +148,6 @@ export abstract class ModuleRef {
     this.container.registerRequestProvider(request, contextId);
   }
 
-  protected find<TInput = any, TResult = TInput>(
-    typeOrToken: Type<TInput> | string | symbol,
-    contextModule?: Module,
-  ): TResult {
-    const moduleId = contextModule && contextModule.id;
-    const { wrapperRef } = this.instanceLinksHost.get<TResult>(
-      typeOrToken,
-      moduleId,
-    );
-    if (
-      wrapperRef.scope === Scope.REQUEST ||
-      wrapperRef.scope === Scope.TRANSIENT
-    ) {
-      throw new InvalidClassScopeException(typeOrToken);
-    }
-    return wrapperRef.instance;
-  }
-
-  protected async resolvePerContext<TInput = any, TResult = TInput>(
-    typeOrToken: Type<TInput> | string | symbol,
-    contextModule: Module,
-    contextId: ContextId,
-    options?: { strict: boolean },
-  ): Promise<TResult> {
-    const isStrictModeEnabled = options && options.strict;
-    const instanceLink = isStrictModeEnabled
-      ? this.instanceLinksHost.get(typeOrToken, contextModule.id)
-      : this.instanceLinksHost.get(typeOrToken);
-
-    const { wrapperRef, collection } = instanceLink;
-    if (wrapperRef.isDependencyTreeStatic() && !wrapperRef.isTransient) {
-      return this.get(typeOrToken, options);
-    }
-
-    const ctorHost = wrapperRef.instance || { constructor: typeOrToken };
-    const instance = await this.injector.loadPerContext(
-      ctorHost,
-      wrapperRef.host,
-      collection,
-      contextId,
-      wrapperRef,
-    );
-    if (!instance) {
-      throw new UnknownElementException();
-    }
-    return instance;
-  }
-
   protected async instantiateClass<T = any>(
     type: Type<T>,
     moduleRef: Module,
@@ -107,6 +157,7 @@ export abstract class ModuleRef {
       metatype: type,
       isResolved: false,
       scope: getClassScope(type),
+      durable: isDurable(type),
       host: moduleRef,
     });
     return new Promise<T>(async (resolve, reject) => {
diff --git a/packages/core/injector/module-token-factory.ts b/packages/core/injector/module-token-factory.ts
index 8a81ddd47..4a407885c 100644
--- a/packages/core/injector/module-token-factory.ts
+++ b/packages/core/injector/module-token-factory.ts
@@ -1,10 +1,15 @@
 import { DynamicModule } from '@nestjs/common';
 import { Type } from '@nestjs/common/interfaces/type.interface';
 import { randomStringGenerator } from '@nestjs/common/utils/random-string-generator.util';
+import { isFunction, isSymbol } from '@nestjs/common/utils/shared.utils';
+import { createHash } from 'crypto';
 import stringify from 'fast-safe-stringify';
-import * as hash from 'object-hash';
+
+const CLASS_STR = 'class ';
+const CLASS_STR_LEN = CLASS_STR.length;
 
 export class ModuleTokenFactory {
+  private readonly moduleTokenCache = new Map<string, string>();
   private readonly moduleIdsCache = new WeakMap<Type<unknown>, string>();
 
   public create(
@@ -12,23 +17,36 @@ export class ModuleTokenFactory {
     dynamicModuleMetadata?: Partial<DynamicModule> | undefined,
   ): string {
     const moduleId = this.getModuleId(metatype);
+
+    if (!dynamicModuleMetadata) {
+      return this.getStaticModuleToken(moduleId, this.getModuleName(metatype));
+    }
     const opaqueToken = {
       id: moduleId,
       module: this.getModuleName(metatype),
-      dynamic: this.getDynamicMetadataToken(dynamicModuleMetadata),
+      dynamic: dynamicModuleMetadata,
     };
-    return hash(opaqueToken, { ignoreUnknown: true });
+    const opaqueTokenString = this.getStringifiedOpaqueToken(opaqueToken);
+
+    return this.hashString(opaqueTokenString);
   }
 
-  public getDynamicMetadataToken(
-    dynamicModuleMetadata: Partial<DynamicModule> | undefined,
-  ): string {
+  public getStaticModuleToken(moduleId: string, moduleName: string): string {
+    const key = `${moduleId}_${moduleName}`;
+    if (this.moduleTokenCache.has(key)) {
+      return this.moduleTokenCache.get(key);
+    }
+
+    const hash = this.hashString(key);
+    this.moduleTokenCache.set(key, hash);
+    return hash;
+  }
+
+  public getStringifiedOpaqueToken(opaqueToken: object | undefined): string {
     // Uses safeStringify instead of JSON.stringify to support circular dynamic modules
     // The replacer function is also required in order to obtain real class names
     // instead of the unified "Function" key
-    return dynamicModuleMetadata
-      ? stringify(dynamicModuleMetadata, this.replacer)
-      : '';
+    return opaqueToken ? stringify(opaqueToken, this.replacer) : '';
   }
 
   public getModuleId(metatype: Type<unknown>): string {
@@ -45,16 +63,20 @@ export class ModuleTokenFactory {
     return metatype.name;
   }
 
+  private hashString(value: string): string {
+    return createHash('sha256').update(value).digest('hex');
+  }
+
   private replacer(key: string, value: any) {
-    if (typeof value === 'function') {
+    if (isFunction(value)) {
       const funcAsString = value.toString();
-      const isClass = /^class\s/.test(funcAsString);
+      const isClass = funcAsString.slice(0, CLASS_STR_LEN) === CLASS_STR;
       if (isClass) {
         return value.name;
       }
-      return hash(funcAsString, { ignoreUnknown: true });
+      return funcAsString;
     }
-    if (typeof value === 'symbol') {
+    if (isSymbol(value)) {
       return value.toString();
     }
     return value;
diff --git a/packages/core/injector/module.ts b/packages/core/injector/module.ts
index ed3102a01..f6149ed5d 100644
--- a/packages/core/injector/module.ts
+++ b/packages/core/injector/module.ts
@@ -1,64 +1,70 @@
 import {
-  Abstract,
+  EnhancerSubtype,
+  ENTRY_PROVIDER_WATERMARK,
+} from '@nestjs/common/constants';
+import {
   ClassProvider,
   Controller,
   DynamicModule,
   ExistingProvider,
   FactoryProvider,
   Injectable,
+  InjectionToken,
   NestModule,
   Provider,
+  Type,
   ValueProvider,
 } from '@nestjs/common/interfaces';
-import { Type } from '@nestjs/common/interfaces/type.interface';
 import { randomStringGenerator } from '@nestjs/common/utils/random-string-generator.util';
 import {
   isFunction,
   isNil,
+  isObject,
   isString,
   isSymbol,
   isUndefined,
 } from '@nestjs/common/utils/shared.utils';
 import { iterate } from 'iterare';
 import { ApplicationConfig } from '../application-config';
-import { InvalidClassException } from '../errors/exceptions/invalid-class.exception';
-import { RuntimeException } from '../errors/exceptions/runtime.exception';
-import { UnknownExportException } from '../errors/exceptions/unknown-export.exception';
+import {
+  InvalidClassException,
+  RuntimeException,
+  UnknownExportException,
+} from '../errors/exceptions';
 import { createContextId } from '../helpers/context-id-factory';
 import { getClassScope } from '../helpers/get-class-scope';
+import { isDurable } from '../helpers/is-durable';
+import { UuidFactory } from '../inspector/uuid-factory';
 import { CONTROLLER_ID_KEY } from './constants';
 import { NestContainer } from './container';
 import { InstanceWrapper } from './instance-wrapper';
-import { ModuleRef } from './module-ref';
-
-export type InstanceToken =
-  | string
-  | symbol
-  | Type<any>
-  | Abstract<any>
-  | Function;
+import { ModuleRef, ModuleRefGetOrResolveOpts } from './module-ref';
 
 export class Module {
   private readonly _id: string;
   private readonly _imports = new Set<Module>();
   private readonly _providers = new Map<
-    InstanceToken,
+    InjectionToken,
     InstanceWrapper<Injectable>
   >();
   private readonly _injectables = new Map<
-    InstanceToken,
+    InjectionToken,
     InstanceWrapper<Injectable>
   >();
   private readonly _middlewares = new Map<
-    InstanceToken,
+    InjectionToken,
     InstanceWrapper<Injectable>
   >();
   private readonly _controllers = new Map<
-    InstanceToken,
+    InjectionToken,
     InstanceWrapper<Controller>
   >();
-  private readonly _exports = new Set<InstanceToken>();
+  private readonly _entryProviderKeys = new Set<InjectionToken>();
+  private readonly _exports = new Set<InjectionToken>();
+
   private _distance = 0;
+  private _initOnPreview = false;
+  private _isGlobal = false;
   private _token: string;
 
   constructor(
@@ -66,7 +72,7 @@ export class Module {
     private readonly container: NestContainer,
   ) {
     this.addCoreProviders();
-    this._id = randomStringGenerator();
+    this._id = this.generateUuid();
   }
 
   get id(): string {
@@ -81,48 +87,53 @@ export class Module {
     this._token = token;
   }
 
-  get providers(): Map<InstanceToken, InstanceWrapper<Injectable>> {
-    return this._providers;
+  get name() {
+    return this.metatype.name;
   }
 
-  get middlewares(): Map<InstanceToken, InstanceWrapper<Injectable>> {
-    return this._middlewares;
+  get isGlobal() {
+    return this._isGlobal;
   }
 
-  get imports(): Set<Module> {
-    return this._imports;
+  set isGlobal(global: boolean) {
+    this._isGlobal = global;
   }
 
-  /**
-   * Left for backward-compatibility reasons
-   */
-  get relatedModules(): Set<Module> {
-    return this._imports;
+  get initOnPreview() {
+    return this._initOnPreview;
+  }
+
+  set initOnPreview(initOnPreview: boolean) {
+    this._initOnPreview = initOnPreview;
   }
 
-  /**
-   * Left for backward-compatibility reasons
-   */
-  get components(): Map<InstanceToken, InstanceWrapper<Injectable>> {
+  get providers(): Map<InjectionToken, InstanceWrapper<Injectable>> {
     return this._providers;
   }
 
-  /**
-   * Left for backward-compatibility reasons
-   */
-  get routes(): Map<InstanceToken, InstanceWrapper<Controller>> {
-    return this._controllers;
+  get middlewares(): Map<InjectionToken, InstanceWrapper<Injectable>> {
+    return this._middlewares;
+  }
+
+  get imports(): Set<Module> {
+    return this._imports;
   }
 
-  get injectables(): Map<InstanceToken, InstanceWrapper<Injectable>> {
+  get injectables(): Map<InjectionToken, InstanceWrapper<Injectable>> {
     return this._injectables;
   }
 
-  get controllers(): Map<InstanceToken, InstanceWrapper<Controller>> {
+  get controllers(): Map<InjectionToken, InstanceWrapper<Controller>> {
     return this._controllers;
   }
 
-  get exports(): Set<InstanceToken> {
+  get entryProviders(): Array<InstanceWrapper<Injectable>> {
+    return Array.from(this._entryProviderKeys).map(token =>
+      this.providers.get(token),
+    );
+  }
+
+  get exports(): Set<InjectionToken> {
     return this._exports;
   }
 
@@ -196,10 +207,15 @@ export class Module {
 
   public addInjectable<T extends Injectable>(
     injectable: Provider,
+    enhancerSubtype: EnhancerSubtype,
     host?: Type<T>,
   ) {
     if (this.isCustomProvider(injectable)) {
-      return this.addCustomProvider(injectable, this._injectables);
+      return this.addCustomProvider(
+        injectable,
+        this._injectables,
+        enhancerSubtype,
+      );
     }
     let instanceWrapper = this.injectables.get(injectable);
     if (!instanceWrapper) {
@@ -210,6 +226,8 @@ export class Module {
         instance: null,
         isResolved: false,
         scope: getClassScope(injectable),
+        durable: isDurable(injectable),
+        subtype: enhancerSubtype,
         host: this,
       });
       this._injectables.set(injectable, instanceWrapper);
@@ -219,12 +237,22 @@ export class Module {
         this._controllers.get(host) || this._providers.get(host);
       hostWrapper && hostWrapper.addEnhancerMetadata(instanceWrapper);
     }
+    return instanceWrapper;
   }
 
-  public addProvider(provider: Provider) {
+  public addProvider(provider: Provider): Provider | InjectionToken;
+  public addProvider(
+    provider: Provider,
+    enhancerSubtype: EnhancerSubtype,
+  ): Provider | InjectionToken;
+  public addProvider(provider: Provider, enhancerSubtype?: EnhancerSubtype) {
     if (this.isCustomProvider(provider)) {
-      return this.addCustomProvider(provider, this._providers);
+      if (this.isEntryProvider(provider.provide)) {
+        this._entryProviderKeys.add(provider.provide);
+      }
+      return this.addCustomProvider(provider, this._providers, enhancerSubtype);
     }
+
     this._providers.set(
       provider,
       new InstanceWrapper({
@@ -234,9 +262,15 @@ export class Module {
         instance: null,
         isResolved: false,
         scope: getClassScope(provider),
+        durable: isDurable(provider),
         host: this,
       }),
     );
+
+    if (this.isEntryProvider(provider)) {
+      this._entryProviderKeys.add(provider);
+    }
+
     return provider as Type<Injectable>;
   }
 
@@ -265,15 +299,16 @@ export class Module {
       | ValueProvider
       | ExistingProvider,
     collection: Map<Function | string | symbol, any>,
+    enhancerSubtype?: EnhancerSubtype,
   ) {
     if (this.isCustomClass(provider)) {
-      this.addCustomClass(provider, collection);
+      this.addCustomClass(provider, collection, enhancerSubtype);
     } else if (this.isCustomValue(provider)) {
-      this.addCustomValue(provider, collection);
+      this.addCustomValue(provider, collection, enhancerSubtype);
     } else if (this.isCustomFactory(provider)) {
-      this.addCustomFactory(provider, collection);
+      this.addCustomFactory(provider, collection, enhancerSubtype);
     } else if (this.isCustomUseExisting(provider)) {
-      this.addCustomUseExisting(provider, collection);
+      this.addCustomUseExisting(provider, collection, enhancerSubtype);
     }
     return provider.provide;
   }
@@ -283,7 +318,10 @@ export class Module {
   }
 
   public isCustomValue(provider: any): provider is ValueProvider {
-    return !isUndefined((provider as ValueProvider).useValue);
+    return (
+      isObject(provider) &&
+      Object.prototype.hasOwnProperty.call(provider, 'useValue')
+    );
   }
 
   public isCustomFactory(provider: any): provider is FactoryProvider {
@@ -300,24 +338,32 @@ export class Module {
 
   public addCustomClass(
     provider: ClassProvider,
-    collection: Map<InstanceToken, InstanceWrapper>,
+    collection: Map<InjectionToken, InstanceWrapper>,
+    enhancerSubtype?: EnhancerSubtype,
   ) {
-    let { scope } = provider;
+    let { scope, durable } = provider;
 
     const { useClass } = provider;
     if (isUndefined(scope)) {
       scope = getClassScope(useClass);
     }
+    if (isUndefined(durable)) {
+      durable = isDurable(useClass);
+    }
+
+    const token = provider.provide;
     collection.set(
-      provider.provide,
+      token,
       new InstanceWrapper({
-        token: provider.provide,
+        token,
         name: useClass?.name || useClass,
         metatype: useClass,
         instance: null,
         isResolved: false,
         scope,
+        durable,
         host: this,
+        subtype: enhancerSubtype,
       }),
     );
   }
@@ -325,6 +371,7 @@ export class Module {
   public addCustomValue(
     provider: ValueProvider,
     collection: Map<Function | string | symbol, InstanceWrapper>,
+    enhancerSubtype?: EnhancerSubtype,
   ) {
     const { useValue: value, provide: providerToken } = provider;
     collection.set(
@@ -337,6 +384,7 @@ export class Module {
         isResolved: true,
         async: value instanceof Promise,
         host: this,
+        subtype: enhancerSubtype,
       }),
     );
   }
@@ -344,11 +392,13 @@ export class Module {
   public addCustomFactory(
     provider: FactoryProvider,
     collection: Map<Function | string | symbol, InstanceWrapper>,
+    enhancerSubtype?: EnhancerSubtype,
   ) {
     const {
       useFactory: factory,
       inject,
       scope,
+      durable,
       provide: providerToken,
     } = provider;
 
@@ -362,7 +412,9 @@ export class Module {
         isResolved: false,
         inject: inject || [],
         scope,
+        durable,
         host: this,
+        subtype: enhancerSubtype,
       }),
     );
   }
@@ -370,6 +422,7 @@ export class Module {
   public addCustomUseExisting(
     provider: ExistingProvider,
     collection: Map<Function | string | symbol, InstanceWrapper>,
+    enhancerSubtype?: EnhancerSubtype,
   ) {
     const { useExisting, provide: providerToken } = provider;
     collection.set(
@@ -383,6 +436,7 @@ export class Module {
         inject: [useExisting],
         host: this,
         isAlias: true,
+        subtype: enhancerSubtype,
       }),
     );
   }
@@ -390,7 +444,7 @@ export class Module {
   public addExportedProvider(
     provider: Provider | string | symbol | DynamicModule,
   ) {
-    const addExportedUnit = (token: InstanceToken) =>
+    const addExportedUnit = (token: InjectionToken) =>
       this._exports.add(this.validateExportedProvider(token));
 
     if (this.isCustomProvider(provider as any)) {
@@ -418,7 +472,7 @@ export class Module {
     this._exports.add(this.validateExportedProvider(provide));
   }
 
-  public validateExportedProvider(token: InstanceToken) {
+  public validateExportedProvider(token: InjectionToken) {
     if (this._providers.has(token)) {
       return token;
     }
@@ -446,6 +500,7 @@ export class Module {
         instance: null,
         isResolved: false,
         scope: getClassScope(controller),
+        durable: isDurable(controller),
         host: this,
       }),
     );
@@ -466,7 +521,7 @@ export class Module {
     this._imports.add(module);
   }
 
-  public replace(toReplace: InstanceToken, options: any) {
+  public replace(toReplace: InjectionToken, options: any) {
     if (options.isProvider && this.hasProvider(toReplace)) {
       const originalProvider = this._providers.get(toReplace);
 
@@ -481,20 +536,50 @@ export class Module {
     }
   }
 
-  public hasProvider(token: InstanceToken): boolean {
+  public hasProvider(token: InjectionToken): boolean {
     return this._providers.has(token);
   }
 
-  public hasInjectable(token: InstanceToken): boolean {
+  public hasInjectable(token: InjectionToken): boolean {
     return this._injectables.has(token);
   }
 
-  public getProviderByKey<T = any>(name: InstanceToken): InstanceWrapper<T> {
+  public getProviderByKey<T = any>(name: InjectionToken): InstanceWrapper<T> {
     return this._providers.get(name) as InstanceWrapper<T>;
   }
 
+  public getProviderById<T = any>(id: string): InstanceWrapper<T> | undefined {
+    return Array.from(this._providers.values()).find(
+      item => item.id === id,
+    ) as InstanceWrapper<T>;
+  }
+
+  public getControllerById<T = any>(
+    id: string,
+  ): InstanceWrapper<T> | undefined {
+    return Array.from(this._controllers.values()).find(
+      item => item.id === id,
+    ) as InstanceWrapper<T>;
+  }
+
+  public getInjectableById<T = any>(
+    id: string,
+  ): InstanceWrapper<T> | undefined {
+    return Array.from(this._injectables.values()).find(
+      item => item.id === id,
+    ) as InstanceWrapper<T>;
+  }
+
+  public getMiddlewareById<T = any>(
+    id: string,
+  ): InstanceWrapper<T> | undefined {
+    return Array.from(this._middlewares.values()).find(
+      item => item.id === id,
+    ) as InstanceWrapper<T>;
+  }
+
   public getNonAliasProviders(): Array<
-    [InstanceToken, InstanceWrapper<Injectable>]
+    [InjectionToken, InstanceWrapper<Injectable>]
   > {
     return [...this._providers].filter(([_, wrapper]) => !wrapper.isAlias);
   }
@@ -509,19 +594,36 @@ export class Module {
 
       public get<TInput = any, TResult = TInput>(
         typeOrToken: Type<TInput> | string | symbol,
-        options: { strict: boolean } = { strict: true },
-      ): TResult {
-        return !(options && options.strict)
-          ? this.find<TInput, TResult>(typeOrToken)
-          : this.find<TInput, TResult>(typeOrToken, self);
+        options: ModuleRefGetOrResolveOpts = {},
+      ): TResult | Array<TResult> {
+        options.strict ??= true;
+        options.each ??= false;
+
+        return this.find<TInput, TResult>(
+          typeOrToken,
+          options.strict
+            ? {
+                moduleId: self.id,
+                each: options.each,
+              }
+            : options,
+        );
       }
 
       public resolve<TInput = any, TResult = TInput>(
         typeOrToken: Type<TInput> | string | symbol,
         contextId = createContextId(),
-        options: { strict: boolean } = { strict: true },
-      ): Promise<TResult> {
-        return this.resolvePerContext(typeOrToken, self, contextId, options);
+        options: ModuleRefGetOrResolveOpts = {},
+      ): Promise<TResult | Array<TResult>> {
+        options.strict ??= true;
+        options.each ??= false;
+
+        return this.resolvePerContext<TInput, TResult>(
+          typeOrToken,
+          self,
+          contextId,
+          options,
+        );
       }
 
       public async create<T = any>(type: Type<T>): Promise<T> {
@@ -532,4 +634,16 @@ export class Module {
       }
     };
   }
+
+  private isEntryProvider(metatype: InjectionToken): boolean {
+    return typeof metatype === 'function'
+      ? !!Reflect.getMetadata(ENTRY_PROVIDER_WATERMARK, metatype)
+      : false;
+  }
+
+  private generateUuid(): string {
+    const prefix = 'M_';
+    const key = this.name?.toString() ?? this.token?.toString();
+    return key ? UuidFactory.get(`${prefix}_${key}`) : randomStringGenerator();
+  }
 }
diff --git a/packages/core/injector/modules-container.ts b/packages/core/injector/modules-container.ts
index 8f1d9dec6..31777bec2 100644
--- a/packages/core/injector/modules-container.ts
+++ b/packages/core/injector/modules-container.ts
@@ -1,10 +1,14 @@
-import { v4 as uuid } from 'uuid';
+import { uid } from 'uid';
 import { Module } from './module';
 
 export class ModulesContainer extends Map<string, Module> {
-  private readonly _applicationId = uuid();
+  private readonly _applicationId = uid(21);
 
   get applicationId(): string {
     return this._applicationId;
   }
+
+  public getById(id: string): Module | undefined {
+    return Array.from(this.values()).find(moduleRef => moduleRef.id === id);
+  }
 }
diff --git a/packages/core/inspector/deterministic-uuid-registry.ts b/packages/core/inspector/deterministic-uuid-registry.ts
new file mode 100644
index 000000000..352942cde
--- /dev/null
+++ b/packages/core/inspector/deterministic-uuid-registry.ts
@@ -0,0 +1,23 @@
+export class DeterministicUuidRegistry {
+  private static readonly registry = new Map<string, boolean>();
+
+  static get(str: string, inc = 0) {
+    const id = inc ? this.hashCode(`${str}_${inc}`) : this.hashCode(str);
+    if (this.registry.has(id)) {
+      return this.get(str, inc + 1);
+    }
+    this.registry.set(id, true);
+    return id;
+  }
+
+  static clear() {
+    this.registry.clear();
+  }
+
+  private static hashCode(s: string) {
+    let h = 0;
+    for (let i = 0; i < s.length; i++)
+      h = (Math.imul(31, h) + s.charCodeAt(i)) | 0;
+    return h.toString();
+  }
+}
diff --git a/packages/core/inspector/graph-inspector.ts b/packages/core/inspector/graph-inspector.ts
new file mode 100644
index 000000000..a2146a543
--- /dev/null
+++ b/packages/core/inspector/graph-inspector.ts
@@ -0,0 +1,240 @@
+import { UnknownDependenciesException } from '../errors/exceptions/unknown-dependencies.exception';
+import { NestContainer } from '../injector/container';
+import { InstanceWrapper } from '../injector/instance-wrapper';
+import { Module } from '../injector/module';
+import { DeterministicUuidRegistry } from './deterministic-uuid-registry';
+import { EnhancerMetadataCacheEntry } from './interfaces/enhancer-metadata-cache-entry.interface';
+import { Entrypoint } from './interfaces/entrypoint.interface';
+import { OrphanedEnhancerDefinition } from './interfaces/extras.interface';
+import { ClassNode, Node } from './interfaces/node.interface';
+import { PartialGraphHost } from './partial-graph.host';
+import { SerializedGraph } from './serialized-graph';
+
+export class GraphInspector {
+  private readonly graph: SerializedGraph;
+  private readonly enhancersMetadataCache =
+    new Array<EnhancerMetadataCacheEntry>();
+
+  constructor(private readonly container: NestContainer) {
+    this.graph = container.serializedGraph;
+  }
+
+  public inspectModules(
+    modules: Map<string, Module> = this.container.getModules(),
+  ) {
+    for (const moduleRef of modules.values()) {
+      this.insertModuleNode(moduleRef);
+      this.insertClassNodes(moduleRef);
+      this.insertModuleToModuleEdges(moduleRef);
+    }
+
+    this.enhancersMetadataCache.forEach(entry =>
+      this.insertEnhancerEdge(entry),
+    );
+
+    DeterministicUuidRegistry.clear();
+  }
+
+  public registerPartial(error: unknown) {
+    this.graph.status = 'partial';
+
+    if (error instanceof UnknownDependenciesException) {
+      this.graph.metadata = {
+        cause: {
+          type: 'unknown-dependencies',
+          context: error.context,
+          moduleId: error.moduleRef?.id,
+          nodeId: error.metadata?.id,
+        },
+      };
+    } else {
+      this.graph.metadata = {
+        cause: {
+          type: 'unknown',
+          error,
+        },
+      };
+    }
+    PartialGraphHost.register(this.graph);
+  }
+
+  public inspectInstanceWrapper<T = any>(
+    source: InstanceWrapper<T>,
+    moduleRef: Module,
+  ) {
+    const ctorMetadata = source.getCtorMetadata();
+    ctorMetadata?.forEach((target, index) =>
+      this.insertClassToClassEdge(
+        source,
+        target,
+        moduleRef,
+        index,
+        'constructor',
+      ),
+    );
+
+    const propertiesMetadata = source.getPropertiesMetadata();
+    propertiesMetadata?.forEach(({ key, wrapper: target }) =>
+      this.insertClassToClassEdge(source, target, moduleRef, key, 'property'),
+    );
+  }
+
+  public insertEnhancerMetadataCache(entry: EnhancerMetadataCacheEntry) {
+    this.enhancersMetadataCache.push(entry);
+  }
+
+  public insertOrphanedEnhancer(entry: OrphanedEnhancerDefinition) {
+    this.graph.insertOrphanedEnhancer({
+      ...entry,
+      ref: entry.ref?.constructor?.name ?? 'Object',
+    });
+  }
+
+  public insertAttachedEnhancer(wrapper: InstanceWrapper) {
+    const existingNode = this.graph.getNodeById(wrapper.id);
+    existingNode.metadata.global = true;
+
+    this.graph.insertAttachedEnhancer(existingNode.id);
+  }
+
+  public insertEntrypointDefinition<T>(
+    definition: Entrypoint<T>,
+    parentId: string,
+  ) {
+    definition = {
+      ...definition,
+      id: `${definition.classNodeId}_${definition.methodName}`,
+    };
+    this.graph.insertEntrypoint(definition, parentId);
+  }
+
+  public insertClassNode(
+    moduleRef: Module,
+    wrapper: InstanceWrapper,
+    type: Exclude<Node['metadata']['type'], 'module'>,
+  ) {
+    this.graph.insertNode({
+      id: wrapper.id,
+      label: wrapper.name,
+      parent: moduleRef.id,
+      metadata: {
+        type,
+        internal: wrapper.metatype === moduleRef.metatype,
+        sourceModuleName: moduleRef.name,
+        durable: wrapper.isDependencyTreeDurable(),
+        static: wrapper.isDependencyTreeStatic(),
+        scope: wrapper.scope,
+        transient: wrapper.isTransient,
+        exported: moduleRef.exports.has(wrapper.token),
+        token: wrapper.token,
+        subtype: wrapper.subtype,
+        initTime: wrapper.initTime,
+      },
+    });
+  }
+
+  private insertModuleNode(moduleRef: Module) {
+    const dynamicMetadata = this.container.getDynamicMetadataByToken(
+      moduleRef.token,
+    );
+    const node: Node = {
+      id: moduleRef.id,
+      label: moduleRef.name,
+      metadata: {
+        type: 'module',
+        global: moduleRef.isGlobal,
+        dynamic: !!dynamicMetadata,
+        internal: moduleRef.name === 'InternalCoreModule',
+      },
+    };
+    this.graph.insertNode(node);
+  }
+
+  private insertModuleToModuleEdges(moduleRef: Module) {
+    for (const targetModuleRef of moduleRef.imports) {
+      this.graph.insertEdge({
+        source: moduleRef.id,
+        target: targetModuleRef.id,
+        metadata: {
+          type: 'module-to-module',
+          sourceModuleName: moduleRef.name,
+          targetModuleName: targetModuleRef.name,
+        },
+      });
+    }
+  }
+
+  private insertEnhancerEdge(entry: EnhancerMetadataCacheEntry) {
+    const moduleRef = this.container.getModuleByKey(entry.moduleToken);
+    const sourceInstanceWrapper =
+      moduleRef.controllers.get(entry.classRef) ??
+      moduleRef.providers.get(entry.classRef);
+    const existingSourceNode = this.graph.getNodeById(
+      sourceInstanceWrapper.id,
+    ) as ClassNode;
+    const enhancers = existingSourceNode.metadata.enhancers ?? [];
+
+    if (entry.enhancerInstanceWrapper) {
+      this.insertClassToClassEdge(
+        sourceInstanceWrapper,
+        entry.enhancerInstanceWrapper,
+        moduleRef,
+        undefined,
+        'decorator',
+      );
+
+      enhancers.push({
+        id: entry.enhancerInstanceWrapper.id,
+        methodKey: entry.methodKey,
+        subtype: entry.subtype,
+      });
+    } else {
+      const name =
+        entry.enhancerRef.constructor?.name ??
+        (entry.enhancerRef as Function).name;
+
+      enhancers.push({
+        name,
+        methodKey: entry.methodKey,
+        subtype: entry.subtype,
+      });
+    }
+    existingSourceNode.metadata.enhancers = enhancers;
+  }
+
+  private insertClassToClassEdge<T>(
+    source: InstanceWrapper<T>,
+    target: InstanceWrapper,
+    moduleRef: Module,
+    keyOrIndex: number | string | symbol | undefined,
+    injectionType: 'constructor' | 'property' | 'decorator',
+  ) {
+    this.graph.insertEdge({
+      source: source.id,
+      target: target.id,
+      metadata: {
+        type: 'class-to-class',
+        sourceModuleName: moduleRef.name,
+        sourceClassName: source.name,
+        targetClassName: target.name,
+        sourceClassToken: source.token,
+        targetClassToken: target.token,
+        targetModuleName: target.host?.name,
+        keyOrIndex,
+        injectionType,
+      },
+    });
+  }
+
+  private insertClassNodes(moduleRef: Module) {
+    moduleRef.providers.forEach(value =>
+      this.insertClassNode(moduleRef, value, 'provider'),
+    );
+    moduleRef.injectables.forEach(value =>
+      this.insertClassNode(moduleRef, value, 'injectable'),
+    );
+    moduleRef.controllers.forEach(value =>
+      this.insertClassNode(moduleRef, value, 'controller'),
+    );
+  }
+}
diff --git a/packages/core/inspector/index.ts b/packages/core/inspector/index.ts
new file mode 100644
index 000000000..db830f6e7
--- /dev/null
+++ b/packages/core/inspector/index.ts
@@ -0,0 +1,4 @@
+export * from './graph-inspector';
+export * from './initialize-on-preview.allowlist';
+export * from './partial-graph.host';
+export * from './serialized-graph';
diff --git a/packages/core/inspector/initialize-on-preview.allowlist.ts b/packages/core/inspector/initialize-on-preview.allowlist.ts
new file mode 100644
index 000000000..27d6ad593
--- /dev/null
+++ b/packages/core/inspector/initialize-on-preview.allowlist.ts
@@ -0,0 +1,13 @@
+import { Type } from '@nestjs/common';
+
+export class InitializeOnPreviewAllowlist {
+  private static readonly allowlist = new WeakMap<Type, boolean>();
+
+  public static add(type: Type) {
+    this.allowlist.set(type, true);
+  }
+
+  public static has(type: Type) {
+    return this.allowlist.has(type);
+  }
+}
diff --git a/packages/core/inspector/interfaces/edge.interface.ts b/packages/core/inspector/interfaces/edge.interface.ts
new file mode 100644
index 000000000..9151ab43b
--- /dev/null
+++ b/packages/core/inspector/interfaces/edge.interface.ts
@@ -0,0 +1,31 @@
+import { InjectionToken } from '@nestjs/common';
+
+type CommonEdgeMetadata = {
+  sourceModuleName: string;
+  targetModuleName: string;
+};
+
+type ModuleToModuleEdgeMetadata = {
+  type: 'module-to-module';
+} & CommonEdgeMetadata;
+
+type ClassToClassEdgeMetadata = {
+  type: 'class-to-class';
+  sourceClassName: string;
+  targetClassName: string;
+  sourceClassToken: InjectionToken;
+  targetClassToken: InjectionToken;
+  injectionType: 'constructor' | 'property' | 'decorator';
+  keyOrIndex?: string | number | symbol;
+  /**
+   * If true, indicates that this edge represents an internal providers connection
+   */
+  internal?: boolean;
+} & CommonEdgeMetadata;
+
+export interface Edge {
+  id: string;
+  source: string;
+  target: string;
+  metadata: ModuleToModuleEdgeMetadata | ClassToClassEdgeMetadata;
+}
diff --git a/packages/core/inspector/interfaces/enhancer-metadata-cache-entry.interface.ts b/packages/core/inspector/interfaces/enhancer-metadata-cache-entry.interface.ts
new file mode 100644
index 000000000..7f4574d94
--- /dev/null
+++ b/packages/core/inspector/interfaces/enhancer-metadata-cache-entry.interface.ts
@@ -0,0 +1,13 @@
+import { Type } from '@nestjs/common';
+import { EnhancerSubtype } from '@nestjs/common/constants';
+import { InstanceWrapper } from '../../injector/instance-wrapper';
+
+export interface EnhancerMetadataCacheEntry {
+  targetNodeId?: string;
+  moduleToken: string;
+  classRef: Type;
+  methodKey: string | undefined;
+  enhancerRef?: unknown;
+  enhancerInstanceWrapper?: InstanceWrapper;
+  subtype: EnhancerSubtype;
+}
diff --git a/packages/core/inspector/interfaces/entrypoint.interface.ts b/packages/core/inspector/interfaces/entrypoint.interface.ts
new file mode 100644
index 000000000..057c040c3
--- /dev/null
+++ b/packages/core/inspector/interfaces/entrypoint.interface.ts
@@ -0,0 +1,24 @@
+import { RequestMethod } from '@nestjs/common';
+import { VersionValue } from '@nestjs/common/interfaces';
+
+export type HttpEntrypointMetadata = {
+  path: string;
+  requestMethod: keyof typeof RequestMethod;
+  methodVersion?: VersionValue;
+  controllerVersion?: VersionValue;
+};
+
+export type MiddlewareEntrypointMetadata = {
+  path: string;
+  requestMethod: keyof typeof RequestMethod;
+  version?: VersionValue;
+};
+
+export type Entrypoint<T> = {
+  id?: string;
+  type: string;
+  methodName: string;
+  className: string;
+  classNodeId: string;
+  metadata: { key: string } & T;
+};
diff --git a/packages/core/inspector/interfaces/extras.interface.ts b/packages/core/inspector/interfaces/extras.interface.ts
new file mode 100644
index 000000000..37abd639f
--- /dev/null
+++ b/packages/core/inspector/interfaces/extras.interface.ts
@@ -0,0 +1,21 @@
+import { EnhancerSubtype } from '@nestjs/common/constants';
+
+/**
+ * Enhancers attached through APP_PIPE, APP_GUARD, APP_INTERCEPTOR, and APP_FILTER tokens.
+ */
+export interface AttachedEnhancerDefinition {
+  nodeId: string;
+}
+
+/**
+ * Enhancers registered through "app.useGlobalPipes()", "app.useGlobalGuards()", "app.useGlobalInterceptors()", and "app.useGlobalFilters()" methods.
+ */
+export interface OrphanedEnhancerDefinition {
+  subtype: EnhancerSubtype;
+  ref: unknown;
+}
+
+export interface Extras {
+  orphanedEnhancers: Array<OrphanedEnhancerDefinition>;
+  attachedEnhancers: Array<AttachedEnhancerDefinition>;
+}
diff --git a/packages/core/inspector/interfaces/node.interface.ts b/packages/core/inspector/interfaces/node.interface.ts
new file mode 100644
index 000000000..1d8589399
--- /dev/null
+++ b/packages/core/inspector/interfaces/node.interface.ts
@@ -0,0 +1,47 @@
+import { InjectionToken, Scope } from '@nestjs/common';
+import { EnhancerSubtype } from '@nestjs/common/constants';
+
+export type ModuleNode = {
+  metadata: {
+    type: 'module';
+    global: boolean;
+    dynamic: boolean;
+    internal: boolean;
+  };
+};
+
+export type ClassNode = {
+  parent: string;
+  metadata: {
+    type: 'provider' | 'controller' | 'middleware' | 'injectable';
+    subtype?: EnhancerSubtype;
+    sourceModuleName: string;
+    durable: boolean;
+    static: boolean;
+    transient: boolean;
+    exported: boolean;
+    scope: Scope;
+    token: InjectionToken;
+    initTime: number;
+    /**
+     * Enhancers metadata collection
+     */
+    enhancers?: Array<
+      | { id: string; subtype: EnhancerSubtype }
+      | { name: string; methodKey?: string; subtype: EnhancerSubtype }
+    >;
+    /**
+     * If true, node is a globally registered enhancer
+     */
+    global?: boolean;
+    /**
+     * If true, indicates that this node represents an internal provider
+     */
+    internal?: boolean;
+  };
+};
+
+export type Node = {
+  id: string;
+  label: string;
+} & (ClassNode | ModuleNode);
diff --git a/packages/core/inspector/interfaces/serialized-graph-json.interface.ts b/packages/core/inspector/interfaces/serialized-graph-json.interface.ts
new file mode 100644
index 000000000..9cd9d76cf
--- /dev/null
+++ b/packages/core/inspector/interfaces/serialized-graph-json.interface.ts
@@ -0,0 +1,15 @@
+import { SerializedGraphStatus } from '../serialized-graph';
+import { Edge } from './edge.interface';
+import { Entrypoint } from './entrypoint.interface';
+import { Extras } from './extras.interface';
+import { Node } from './node.interface';
+import { SerializedGraphMetadata } from './serialized-graph-metadata.interface';
+
+export interface SerializedGraphJson {
+  nodes: Record<string, Node>;
+  edges: Record<string, Edge>;
+  entrypoints: Record<string, Entrypoint<unknown>[]>;
+  extras: Extras;
+  status?: SerializedGraphStatus;
+  metadata?: SerializedGraphMetadata;
+}
diff --git a/packages/core/inspector/interfaces/serialized-graph-metadata.interface.ts b/packages/core/inspector/interfaces/serialized-graph-metadata.interface.ts
new file mode 100644
index 000000000..c88749d01
--- /dev/null
+++ b/packages/core/inspector/interfaces/serialized-graph-metadata.interface.ts
@@ -0,0 +1,11 @@
+import { InjectorDependencyContext } from '../../injector/injector';
+
+export interface SerializedGraphMetadata {
+  cause: {
+    type: 'unknown-dependencies' | 'unknown';
+    context?: InjectorDependencyContext;
+    moduleId?: string;
+    nodeId?: string;
+    error?: any;
+  };
+}
diff --git a/packages/core/inspector/noop-graph-inspector.ts b/packages/core/inspector/noop-graph-inspector.ts
new file mode 100644
index 000000000..f4a36ee0e
--- /dev/null
+++ b/packages/core/inspector/noop-graph-inspector.ts
@@ -0,0 +1,10 @@
+import { GraphInspector } from './graph-inspector';
+
+// eslint-disable-next-line @typescript-eslint/no-empty-function
+const noop = () => {};
+export const NoopGraphInspector: GraphInspector = new Proxy(
+  GraphInspector.prototype,
+  {
+    get: () => noop,
+  },
+);
diff --git a/packages/core/inspector/partial-graph.host.ts b/packages/core/inspector/partial-graph.host.ts
new file mode 100644
index 000000000..84ae71f51
--- /dev/null
+++ b/packages/core/inspector/partial-graph.host.ts
@@ -0,0 +1,17 @@
+import { SerializedGraph } from './serialized-graph';
+
+export class PartialGraphHost {
+  private static partialGraph: SerializedGraph;
+
+  static toJSON() {
+    return this.partialGraph?.toJSON();
+  }
+
+  static toString() {
+    return this.partialGraph?.toString();
+  }
+
+  static register(partialGraph: SerializedGraph) {
+    this.partialGraph = partialGraph;
+  }
+}
diff --git a/packages/core/inspector/serialized-graph.ts b/packages/core/inspector/serialized-graph.ts
new file mode 100644
index 000000000..9ba1b7d4c
--- /dev/null
+++ b/packages/core/inspector/serialized-graph.ts
@@ -0,0 +1,157 @@
+import { InjectionToken } from '@nestjs/common';
+import { ApplicationConfig } from '../application-config';
+import { ExternalContextCreator } from '../helpers/external-context-creator';
+import { HttpAdapterHost } from '../helpers/http-adapter-host';
+import { INQUIRER } from '../injector/inquirer/inquirer-constants';
+import { LazyModuleLoader } from '../injector/lazy-module-loader/lazy-module-loader';
+import { ModuleRef } from '../injector/module-ref';
+import { ModulesContainer } from '../injector/modules-container';
+import { REQUEST } from '../router/request/request-constants';
+import { Reflector } from '../services/reflector.service';
+import { DeterministicUuidRegistry } from './deterministic-uuid-registry';
+import { Edge } from './interfaces/edge.interface';
+import { Entrypoint } from './interfaces/entrypoint.interface';
+import {
+  Extras,
+  OrphanedEnhancerDefinition,
+} from './interfaces/extras.interface';
+import { Node } from './interfaces/node.interface';
+import { SerializedGraphJson } from './interfaces/serialized-graph-json.interface';
+import { SerializedGraphMetadata } from './interfaces/serialized-graph-metadata.interface';
+
+export type SerializedGraphStatus = 'partial' | 'complete';
+type WithOptionalId<T extends Record<'id', string>> = Omit<T, 'id'> &
+  Partial<Pick<T, 'id'>>;
+
+export class SerializedGraph {
+  private readonly nodes = new Map<string, Node>();
+  private readonly edges = new Map<string, Edge>();
+  private readonly entrypoints = new Map<string, Entrypoint<unknown>[]>();
+  private readonly extras: Extras = {
+    orphanedEnhancers: [],
+    attachedEnhancers: [],
+  };
+  private _status: SerializedGraphStatus = 'complete';
+  private _metadata?: SerializedGraphMetadata;
+
+  private static readonly INTERNAL_PROVIDERS: Array<InjectionToken> = [
+    ApplicationConfig,
+    ModuleRef,
+    HttpAdapterHost,
+    LazyModuleLoader,
+    ExternalContextCreator,
+    ModulesContainer,
+    Reflector,
+    SerializedGraph,
+    HttpAdapterHost.name,
+    Reflector.name,
+    REQUEST,
+    INQUIRER,
+  ];
+
+  set status(status: SerializedGraphStatus) {
+    this._status = status;
+  }
+
+  set metadata(metadata: SerializedGraphMetadata) {
+    this._metadata = metadata;
+  }
+
+  public insertNode(nodeDefinition: Node) {
+    if (
+      nodeDefinition.metadata.type === 'provider' &&
+      SerializedGraph.INTERNAL_PROVIDERS.includes(nodeDefinition.metadata.token)
+    ) {
+      nodeDefinition.metadata = {
+        ...nodeDefinition.metadata,
+        internal: true,
+      };
+    }
+    if (this.nodes.has(nodeDefinition.id)) {
+      return this.nodes.get(nodeDefinition.id);
+    }
+    this.nodes.set(nodeDefinition.id, nodeDefinition);
+    return nodeDefinition;
+  }
+
+  public insertEdge(edgeDefinition: WithOptionalId<Edge>) {
+    if (
+      edgeDefinition.metadata.type === 'class-to-class' &&
+      (SerializedGraph.INTERNAL_PROVIDERS.includes(
+        edgeDefinition.metadata.sourceClassToken,
+      ) ||
+        SerializedGraph.INTERNAL_PROVIDERS.includes(
+          edgeDefinition.metadata.targetClassToken,
+        ))
+    ) {
+      edgeDefinition.metadata = {
+        ...edgeDefinition.metadata,
+        internal: true,
+      };
+    }
+    const id =
+      edgeDefinition.id ?? this.generateUuidByEdgeDefinition(edgeDefinition);
+    const edge = {
+      ...edgeDefinition,
+      id,
+    };
+    this.edges.set(id, edge);
+    return edge;
+  }
+
+  public insertEntrypoint<T>(definition: Entrypoint<T>, parentId: string) {
+    if (this.entrypoints.has(parentId)) {
+      const existingCollection = this.entrypoints.get(parentId);
+      existingCollection.push(definition);
+    } else {
+      this.entrypoints.set(parentId, [definition]);
+    }
+  }
+
+  public insertOrphanedEnhancer(entry: OrphanedEnhancerDefinition) {
+    this.extras.orphanedEnhancers.push(entry);
+  }
+
+  public insertAttachedEnhancer(nodeId: string) {
+    this.extras.attachedEnhancers.push({
+      nodeId,
+    });
+  }
+
+  public getNodeById(id: string) {
+    return this.nodes.get(id);
+  }
+
+  public toJSON(): SerializedGraphJson {
+    const json: SerializedGraphJson = {
+      nodes: Object.fromEntries(this.nodes),
+      edges: Object.fromEntries(this.edges),
+      entrypoints: Object.fromEntries(this.entrypoints),
+      extras: this.extras,
+    };
+
+    if (this._status) {
+      json['status'] = this._status;
+    }
+    if (this._metadata) {
+      json['metadata'] = this._metadata;
+    }
+    return json;
+  }
+
+  public toString() {
+    const replacer = (key: string, value: unknown) => {
+      if (typeof value === 'symbol') {
+        return value.toString();
+      }
+      return typeof value === 'function' ? value.name ?? 'Function' : value;
+    };
+    return JSON.stringify(this.toJSON(), replacer, 2);
+  }
+
+  private generateUuidByEdgeDefinition(
+    edgeDefinition: WithOptionalId<Edge>,
+  ): string {
+    return DeterministicUuidRegistry.get(JSON.stringify(edgeDefinition));
+  }
+}
diff --git a/packages/core/inspector/uuid-factory.ts b/packages/core/inspector/uuid-factory.ts
new file mode 100644
index 000000000..1f89ad13d
--- /dev/null
+++ b/packages/core/inspector/uuid-factory.ts
@@ -0,0 +1,21 @@
+import { randomStringGenerator } from '@nestjs/common/utils/random-string-generator.util';
+import { DeterministicUuidRegistry } from './deterministic-uuid-registry';
+
+export enum UuidFactoryMode {
+  Random = 'random',
+  Deterministic = 'deterministic',
+}
+
+export class UuidFactory {
+  private static _mode = UuidFactoryMode.Random;
+
+  static set mode(value: UuidFactoryMode) {
+    this._mode = value;
+  }
+
+  static get(key = '') {
+    return this._mode === UuidFactoryMode.Deterministic
+      ? DeterministicUuidRegistry.get(key)
+      : randomStringGenerator();
+  }
+}
diff --git a/packages/core/interceptors/index.ts b/packages/core/interceptors/index.ts
new file mode 100644
index 000000000..7835bb29b
--- /dev/null
+++ b/packages/core/interceptors/index.ts
@@ -0,0 +1,2 @@
+export * from './interceptors-consumer';
+export * from './interceptors-context-creator';
diff --git a/packages/core/interceptors/interceptors-consumer.ts b/packages/core/interceptors/interceptors-consumer.ts
index bcf3a5921..22f6d096e 100644
--- a/packages/core/interceptors/interceptors-consumer.ts
+++ b/packages/core/interceptors/interceptors-consumer.ts
@@ -24,19 +24,16 @@ export class InterceptorsConsumer {
     const context = this.createContext(args, instance, callback);
     context.setType<TContext>(type);
 
-    const start$ = defer(() => this.transformDeferred(next));
-    const nextFn =
-      (i = 0) =>
-      async () => {
-        if (i >= interceptors.length) {
-          return start$;
-        }
-        const handler: CallHandler = {
-          handle: () => fromPromise(nextFn(i + 1)()).pipe(mergeAll()),
-        };
-        return interceptors[i].intercept(context, handler);
+    const nextFn = async (i = 0) => {
+      if (i >= interceptors.length) {
+        return this.transformDeferred(next);
+      }
+      const handler: CallHandler = {
+        handle: () => fromPromise(nextFn(i + 1)).pipe(mergeAll()),
       };
-    return nextFn()();
+      return interceptors[i].intercept(context, handler);
+    };
+    return defer(() => nextFn()).pipe(mergeAll());
   }
 
   public createContext(
diff --git a/packages/core/interceptors/interceptors-context-creator.ts b/packages/core/interceptors/interceptors-context-creator.ts
index abc7dc903..b05dcb445 100644
--- a/packages/core/interceptors/interceptors-context-creator.ts
+++ b/packages/core/interceptors/interceptors-context-creator.ts
@@ -74,7 +74,7 @@ export class InterceptorsContextCreator extends ContextCreator {
       return null;
     }
     const instanceHost = instanceWrapper.getInstanceByContextId(
-      contextId,
+      this.getContextId(contextId, instanceWrapper),
       inquirerId,
     );
     return instanceHost && instanceHost.instance;
@@ -108,7 +108,12 @@ export class InterceptorsContextCreator extends ContextCreator {
     const scopedInterceptorWrappers =
       this.config.getGlobalRequestInterceptors() as InstanceWrapper[];
     const scopedInterceptors = iterate(scopedInterceptorWrappers)
-      .map(wrapper => wrapper.getInstanceByContextId(contextId, inquirerId))
+      .map(wrapper =>
+        wrapper.getInstanceByContextId(
+          this.getContextId(contextId, wrapper),
+          inquirerId,
+        ),
+      )
       .filter(host => !!host)
       .map(host => host.instance)
       .toArray();
diff --git a/packages/core/metadata-scanner.ts b/packages/core/metadata-scanner.ts
index 7365a7038..400764e00 100644
--- a/packages/core/metadata-scanner.ts
+++ b/packages/core/metadata-scanner.ts
@@ -4,36 +4,115 @@ import {
   isFunction,
   isNil,
 } from '@nestjs/common/utils/shared.utils';
-import { iterate } from 'iterare';
 
 export class MetadataScanner {
+  private readonly cachedScannedPrototypes: Map<object, string[]> = new Map();
+
+  /**
+   * @deprecated 
+   * @see {@link getAllMethodNames}
+   * @see getAllMethodNames
+   */
   public scanFromPrototype<T extends Injectable, R = any>(
     instance: T,
     prototype: object,
     callback: (name: string) => R,
   ): R[] {
-    const methodNames = new Set(this.getAllFilteredMethodNames(prototype));
-    return iterate(methodNames)
-      .map(callback)
-      .filter(metadata => !isNil(metadata))
-      .toArray();
-  }
+    if (!prototype) {
+      return [];
+    }
+
+    const visitedNames = new Map<string, boolean>();
+    const result: R[] = [];
+
+    do {
+      for (const property of Object.getOwnPropertyNames(prototype)) {
+        if (visitedNames.has(property)) {
+          continue;
+        }
+
+        visitedNames.set(property, true);
+
+        // reason: https://github.com/nestjs/nest/pull/10821#issuecomment-1411916533
+        const descriptor = Object.getOwnPropertyDescriptor(prototype, property);
+
+        if (
+          descriptor.set ||
+          descriptor.get ||
+          isConstructor(property) ||
+          !isFunction(prototype[property])
+        ) {
+          continue;
+        }
 
-  *getAllFilteredMethodNames(prototype: object): IterableIterator<string> {
-    const isMethod = (prop: string) => {
-      const descriptor = Object.getOwnPropertyDescriptor(prototype, prop);
-      if (descriptor.set || descriptor.get) {
-        return false;
+        const value = callback(property);
+
+        if (isNil(value)) {
+          continue;
+        }
+
+        result.push(value);
       }
-      return !isConstructor(prop) && isFunction(prototype[prop]);
-    };
+    } while (
+      (prototype = Reflect.getPrototypeOf(prototype)) &&
+      prototype !== Object.prototype
+    );
+
+    return result;
+  }
+
+  /**
+   * @deprecated 
+   * @see {@link getAllMethodNames}
+   * @see getAllMethodNames
+   */
+  public *getAllFilteredMethodNames(
+    prototype: object,
+  ): IterableIterator<string> {
+    yield* this.getAllMethodNames(prototype);
+  }
+
+  public getAllMethodNames(prototype: object | null): string[] {
+    if (!prototype) {
+      return [];
+    }
+
+    if (this.cachedScannedPrototypes.has(prototype)) {
+      return this.cachedScannedPrototypes.get(prototype);
+    }
+
+    const visitedNames = new Map<string, boolean>();
+    const result: string[] = [];
+
+    this.cachedScannedPrototypes.set(prototype, result);
+
     do {
-      yield* iterate(Object.getOwnPropertyNames(prototype))
-        .filter(isMethod)
-        .toArray();
+      for (const property of Object.getOwnPropertyNames(prototype)) {
+        if (visitedNames.has(property)) {
+          continue;
+        }
+
+        visitedNames.set(property, true);
+
+        // reason: https://github.com/nestjs/nest/pull/10821#issuecomment-1411916533
+        const descriptor = Object.getOwnPropertyDescriptor(prototype, property);
+
+        if (
+          descriptor.set ||
+          descriptor.get ||
+          isConstructor(property) ||
+          !isFunction(prototype[property])
+        ) {
+          continue;
+        }
+
+        result.push(property);
+      }
     } while (
       (prototype = Reflect.getPrototypeOf(prototype)) &&
       prototype !== Object.prototype
     );
+
+    return result;
   }
 }
diff --git a/packages/core/middleware/builder.ts b/packages/core/middleware/builder.ts
index d9d63f20f..ce347a143 100644
--- a/packages/core/middleware/builder.ts
+++ b/packages/core/middleware/builder.ts
@@ -6,10 +6,11 @@ import {
 } from '@nestjs/common/interfaces';
 import {
   MiddlewareConfigProxy,
+  MiddlewareConfiguration,
   RouteInfo,
 } from '@nestjs/common/interfaces/middleware';
-import { MiddlewareConfiguration } from '@nestjs/common/interfaces/middleware/middleware-configuration.interface';
 import { iterate } from 'iterare';
+import { RouteInfoPathExtractor } from './route-info-path-extractor';
 import { RoutesMapper } from './routes-mapper';
 import { filterMiddleware } from './utils';
 
@@ -19,12 +20,17 @@ export class MiddlewareBuilder implements MiddlewareConsumer {
   constructor(
     private readonly routesMapper: RoutesMapper,
     private readonly httpAdapter: HttpServer,
+    private readonly routeInfoPathExtractor: RouteInfoPathExtractor,
   ) {}
 
   public apply(
     ...middleware: Array<Type<any> | Function | any>
   ): MiddlewareConfigProxy {
-    return new MiddlewareBuilder.ConfigProxy(this, flatten(middleware));
+    return new MiddlewareBuilder.ConfigProxy(
+      this,
+      flatten(middleware),
+      this.routeInfoPathExtractor,
+    );
   }
 
   public build(): MiddlewareConfiguration[] {
@@ -41,6 +47,7 @@ export class MiddlewareBuilder implements MiddlewareConsumer {
     constructor(
       private readonly builder: MiddlewareBuilder,
       private readonly middleware: Array<Type<any> | Function | any>,
+      private routeInfoPathExtractor: RouteInfoPathExtractor,
     ) {}
 
     public getExcludedRoutes(): RouteInfo[] {
@@ -50,7 +57,10 @@ export class MiddlewareBuilder implements MiddlewareConsumer {
     public exclude(
       ...routes: Array<string | RouteInfo>
     ): MiddlewareConfigProxy {
-      this.excludedRoutes = this.getRoutesFlatList(routes);
+      this.excludedRoutes = this.getRoutesFlatList(routes).map(route => ({
+        ...route,
+        path: this.routeInfoPathExtractor.extractPathFrom(route),
+      }));
       return this;
     }
 
diff --git a/packages/core/middleware/container.ts b/packages/core/middleware/container.ts
index 326fc9089..5544f6827 100644
--- a/packages/core/middleware/container.ts
+++ b/packages/core/middleware/container.ts
@@ -1,14 +1,14 @@
-import { Scope, Type } from '@nestjs/common';
-import { SCOPE_OPTIONS_METADATA } from '@nestjs/common/constants';
+import { InjectionToken, Type } from '@nestjs/common';
 import { MiddlewareConfiguration } from '@nestjs/common/interfaces/middleware/middleware-configuration.interface';
+import { getClassScope } from '../helpers/get-class-scope';
+import { isDurable } from '../helpers/is-durable';
 import { NestContainer } from '../injector/container';
 import { InstanceWrapper } from '../injector/instance-wrapper';
-import { InstanceToken } from '../injector/module';
 
 export class MiddlewareContainer {
   private readonly middleware = new Map<
     string,
-    Map<InstanceToken, InstanceWrapper>
+    Map<InjectionToken, InstanceWrapper>
   >();
   private readonly configurationSets = new Map<
     string,
@@ -19,7 +19,7 @@ export class MiddlewareContainer {
 
   public getMiddlewareCollection(
     moduleKey: string,
-  ): Map<InstanceToken, InstanceWrapper> {
+  ): Map<InjectionToken, InstanceWrapper> {
     if (!this.middleware.has(moduleKey)) {
       const moduleRef = this.container.getModuleByKey(moduleKey);
       this.middleware.set(moduleKey, moduleRef.middlewares);
@@ -44,8 +44,9 @@ export class MiddlewareContainer {
       middleware.set(
         token,
         new InstanceWrapper({
-          scope: this.getClassScope(metatype),
-          name: token,
+          scope: getClassScope(metatype),
+          durable: isDurable(metatype),
+          name: token?.name ?? token,
           metatype,
           token,
         }),
@@ -66,9 +67,4 @@ export class MiddlewareContainer {
     }
     return this.configurationSets.get(moduleName);
   }
-
-  private getClassScope<T = unknown>(type: Type<T>): Scope {
-    const metadata = Reflect.getMetadata(SCOPE_OPTIONS_METADATA, type);
-    return metadata && metadata.scope;
-  }
 }
diff --git a/packages/core/middleware/middleware-module.ts b/packages/core/middleware/middleware-module.ts
index 748887811..627ede62b 100644
--- a/packages/core/middleware/middleware-module.ts
+++ b/packages/core/middleware/middleware-module.ts
@@ -1,15 +1,12 @@
-import { HttpServer } from '@nestjs/common';
+import { HttpServer, InjectionToken, Logger } from '@nestjs/common';
 import { RequestMethod } from '@nestjs/common/enums/request-method.enum';
 import {
   MiddlewareConfiguration,
+  NestMiddleware,
   RouteInfo,
-} from '@nestjs/common/interfaces/middleware/middleware-configuration.interface';
-import { NestMiddleware } from '@nestjs/common/interfaces/middleware/nest-middleware.interface';
-import {
-  addLeadingSlash,
-  isUndefined,
-} from '@nestjs/common/utils/shared.utils';
-import { isRouteExcluded, isRequestMethodAll } from '../router/utils';
+} from '@nestjs/common/interfaces/middleware';
+import { NestApplicationContextOptions } from '@nestjs/common/interfaces/nest-application-context-options.interface';
+import { isUndefined } from '@nestjs/common/utils/shared.utils';
 import { ApplicationConfig } from '../application-config';
 import { InvalidMiddlewareException } from '../errors/exceptions/invalid-middleware.exception';
 import { RuntimeException } from '../errors/exceptions/runtime.exception';
@@ -18,27 +15,39 @@ import { ExecutionContextHost } from '../helpers/execution-context-host';
 import { STATIC_CONTEXT } from '../injector/constants';
 import { NestContainer } from '../injector/container';
 import { Injector } from '../injector/injector';
-import { InstanceWrapper } from '../injector/instance-wrapper';
-import { InstanceToken, Module } from '../injector/module';
+import { ContextId, InstanceWrapper } from '../injector/instance-wrapper';
+import { Module } from '../injector/module';
+import { GraphInspector } from '../inspector/graph-inspector';
+import {
+  Entrypoint,
+  MiddlewareEntrypointMetadata,
+} from '../inspector/interfaces/entrypoint.interface';
 import { REQUEST_CONTEXT_ID } from '../router/request/request-constants';
 import { RouterExceptionFilters } from '../router/router-exception-filters';
 import { RouterProxy } from '../router/router-proxy';
+import { isRequestMethodAll } from '../router/utils';
 import { MiddlewareBuilder } from './builder';
 import { MiddlewareContainer } from './container';
 import { MiddlewareResolver } from './resolver';
+import { RouteInfoPathExtractor } from './route-info-path-extractor';
 import { RoutesMapper } from './routes-mapper';
 
-export class MiddlewareModule {
+export class MiddlewareModule<
+  TAppOptions extends NestApplicationContextOptions = NestApplicationContextOptions,
+> {
   private readonly routerProxy = new RouterProxy();
   private readonly exceptionFiltersCache = new WeakMap();
+  private readonly logger = new Logger(MiddlewareModule.name);
 
   private injector: Injector;
   private routerExceptionFilter: RouterExceptionFilters;
   private routesMapper: RoutesMapper;
   private resolver: MiddlewareResolver;
-  private config: ApplicationConfig;
   private container: NestContainer;
   private httpAdapter: HttpServer;
+  private graphInspector: GraphInspector;
+  private appOptions: TAppOptions;
+  private routeInfoPathExtractor: RouteInfoPathExtractor;
 
   public async register(
     middlewareContainer: MiddlewareContainer,
@@ -46,7 +55,11 @@ export class MiddlewareModule {
     config: ApplicationConfig,
     injector: Injector,
     httpAdapter: HttpServer,
+    graphInspector: GraphInspector,
+    options: TAppOptions,
   ) {
+    this.appOptions = options;
+
     const appRef = container.getHttpAdapterRef();
     this.routerExceptionFilter = new RouterExceptionFilters(
       container,
@@ -54,12 +67,12 @@ export class MiddlewareModule {
       appRef,
     );
     this.routesMapper = new RoutesMapper(container);
-    this.resolver = new MiddlewareResolver(middlewareContainer);
-
-    this.config = config;
+    this.resolver = new MiddlewareResolver(middlewareContainer, injector);
+    this.routeInfoPathExtractor = new RouteInfoPathExtractor(config);
     this.injector = injector;
     this.container = container;
     this.httpAdapter = httpAdapter;
+    this.graphInspector = graphInspector;
 
     const modules = container.getModules();
     await this.resolveMiddleware(middlewareContainer, modules);
@@ -92,8 +105,19 @@ export class MiddlewareModule {
     const middlewareBuilder = new MiddlewareBuilder(
       this.routesMapper,
       this.httpAdapter,
+      this.routeInfoPathExtractor,
     );
-    await instance.configure(middlewareBuilder);
+    try {
+      await instance.configure(middlewareBuilder);
+    } catch (err) {
+      if (!this.appOptions.preview) {
+        throw err;
+      }
+      const warningMessage =
+        `Warning! "${moduleRef.name}" module exposes a "configure" method that throws an exception in the preview mode` +
+        ` (possibly due to missing dependencies). Note: you can ignore this message, just be aware that some of those conditional middlewares will not be reflected in your graph.`;
+      this.logger.warn(warningMessage);
+    }
 
     if (!(middlewareBuilder instanceof MiddlewareBuilder)) {
       return;
@@ -171,11 +195,34 @@ export class MiddlewareModule {
       if (instanceWrapper.isTransient) {
         return;
       }
+      this.graphInspector.insertClassNode(
+        moduleRef,
+        instanceWrapper,
+        'middleware',
+      );
+      const middlewareDefinition: Entrypoint<MiddlewareEntrypointMetadata> = {
+        type: 'middleware',
+        methodName: 'use',
+        className: instanceWrapper.name,
+        classNodeId: instanceWrapper.id,
+        metadata: {
+          key: routeInfo.path,
+          path: routeInfo.path,
+          requestMethod:
+            (RequestMethod[routeInfo.method] as keyof typeof RequestMethod) ??
+            'ALL',
+          version: routeInfo.version,
+        },
+      };
+      this.graphInspector.insertEntrypointDefinition(
+        middlewareDefinition,
+        instanceWrapper.id,
+      );
+
       await this.bindHandler(
         instanceWrapper,
         applicationRef,
-        routeInfo.method,
-        routeInfo.path,
+        routeInfo,
         moduleRef,
         collection,
       );
@@ -185,10 +232,9 @@ export class MiddlewareModule {
   private async bindHandler(
     wrapper: InstanceWrapper<NestMiddleware>,
     applicationRef: HttpServer,
-    method: RequestMethod,
-    path: string,
+    routeInfo: RouteInfo,
     moduleRef: Module,
-    collection: Map<InstanceToken, InstanceWrapper>,
+    collection: Map<InjectionToken, InstanceWrapper>,
   ) {
     const { instance, metatype } = wrapper;
     if (isUndefined(instance?.use)) {
@@ -197,28 +243,21 @@ export class MiddlewareModule {
     const isStatic = wrapper.isDependencyTreeStatic();
     if (isStatic) {
       const proxy = await this.createProxy(instance);
-      return this.registerHandler(applicationRef, method, path, proxy);
+      return this.registerHandler(applicationRef, routeInfo, proxy);
     }
+
+    const isTreeDurable = wrapper.isDependencyTreeDurable();
+
     await this.registerHandler(
       applicationRef,
-      method,
-      path,
+      routeInfo,
       async <TRequest, TResponse>(
         req: TRequest,
         res: TResponse,
         next: () => void,
       ) => {
         try {
-          const contextId = ContextIdFactory.getByRequest(req);
-          if (!req[REQUEST_CONTEXT_ID]) {
-            Object.defineProperty(req, REQUEST_CONTEXT_ID, {
-              value: contextId,
-              enumerable: false,
-              writable: false,
-              configurable: false,
-            });
-            this.container.registerRequestProvider(req, contextId);
-          }
+          const contextId = this.getContextId(req, isTreeDurable);
           const contextInstance = await this.injector.loadPerContext(
             instance,
             moduleRef,
@@ -263,47 +302,46 @@ export class MiddlewareModule {
 
   private async registerHandler(
     applicationRef: HttpServer,
-    method: RequestMethod,
-    path: string,
+    routeInfo: RouteInfo,
     proxy: <TRequest, TResponse>(
       req: TRequest,
       res: TResponse,
       next: () => void,
     ) => void,
   ) {
-    const prefix = this.config.getGlobalPrefix();
-    const excludedRoutes = this.config.getGlobalPrefixOptions().exclude;
-    if (
-      Array.isArray(excludedRoutes) &&
-      isRouteExcluded(excludedRoutes, path, method)
-    ) {
-      path = addLeadingSlash(path);
-    } else {
-      const basePath = addLeadingSlash(prefix);
-      if (basePath?.endsWith('/') && path?.startsWith('/')) {
-        // strip slash when a wildcard is being used
-        // and global prefix has been set
-        path = path?.slice(1);
-      }
-      path = basePath + path;
-    }
+    const { method } = routeInfo;
+    const paths = this.routeInfoPathExtractor.extractPathsFrom(routeInfo);
     const isMethodAll = isRequestMethodAll(method);
     const requestMethod = RequestMethod[method];
     const router = await applicationRef.createMiddlewareFactory(method);
-    router(
-      path,
-      isMethodAll
-        ? proxy
-        : <TRequest, TResponse>(
-            req: TRequest,
-            res: TResponse,
-            next: () => void,
-          ) => {
-            if (applicationRef.getRequestMethod(req) === requestMethod) {
-              return proxy(req, res, next);
-            }
-            return next();
-          },
-    );
+    const middlewareFunction = isMethodAll
+      ? proxy
+      : <TRequest, TResponse>(
+          req: TRequest,
+          res: TResponse,
+          next: () => void,
+        ) => {
+          if (applicationRef.getRequestMethod(req) === requestMethod) {
+            return proxy(req, res, next);
+          }
+          return next();
+        };
+    paths.forEach(path => router(path, middlewareFunction));
+  }
+
+  private getContextId(request: unknown, isTreeDurable: boolean): ContextId {
+    const contextId = ContextIdFactory.getByRequest(request);
+    if (!request[REQUEST_CONTEXT_ID]) {
+      Object.defineProperty(request, REQUEST_CONTEXT_ID, {
+        value: contextId,
+        enumerable: false,
+        writable: false,
+        configurable: false,
+      });
+
+      const requestProviderValue = isTreeDurable ? contextId.payload : request;
+      this.container.registerRequestProvider(requestProviderValue, contextId);
+    }
+    return contextId;
   }
 }
diff --git a/packages/core/middleware/resolver.ts b/packages/core/middleware/resolver.ts
index 168cd00c0..99d02f418 100644
--- a/packages/core/middleware/resolver.ts
+++ b/packages/core/middleware/resolver.ts
@@ -1,26 +1,28 @@
+import { InjectionToken } from '@nestjs/common';
 import { Injector } from '../injector/injector';
 import { InstanceWrapper } from '../injector/instance-wrapper';
-import { InstanceToken, Module } from '../injector/module';
+import { Module } from '../injector/module';
 import { MiddlewareContainer } from './container';
 
 export class MiddlewareResolver {
-  private readonly instanceLoader = new Injector();
-
-  constructor(private readonly middlewareContainer: MiddlewareContainer) {}
+  constructor(
+    private readonly middlewareContainer: MiddlewareContainer,
+    private readonly injector: Injector,
+  ) {}
 
   public async resolveInstances(moduleRef: Module, moduleName: string) {
-    const middleware =
+    const middlewareMap =
       this.middlewareContainer.getMiddlewareCollection(moduleName);
     const resolveInstance = async (wrapper: InstanceWrapper) =>
-      this.resolveMiddlewareInstance(wrapper, middleware, moduleRef);
-    await Promise.all([...middleware.values()].map(resolveInstance));
+      this.resolveMiddlewareInstance(wrapper, middlewareMap, moduleRef);
+    await Promise.all([...middlewareMap.values()].map(resolveInstance));
   }
 
   private async resolveMiddlewareInstance(
     wrapper: InstanceWrapper,
-    middleware: Map<InstanceToken, InstanceWrapper>,
+    middlewareMap: Map<InjectionToken, InstanceWrapper>,
     moduleRef: Module,
   ) {
-    await this.instanceLoader.loadMiddleware(wrapper, middleware, moduleRef);
+    await this.injector.loadMiddleware(wrapper, middlewareMap, moduleRef);
   }
 }
diff --git a/packages/core/middleware/route-info-path-extractor.ts b/packages/core/middleware/route-info-path-extractor.ts
new file mode 100644
index 000000000..c3d2bf8bf
--- /dev/null
+++ b/packages/core/middleware/route-info-path-extractor.ts
@@ -0,0 +1,87 @@
+import { VersioningType } from '@nestjs/common';
+import {
+  RouteInfo,
+  VersioningOptions,
+  VersionValue,
+} from '@nestjs/common/interfaces';
+import {
+  addLeadingSlash,
+  stripEndSlash,
+} from '@nestjs/common/utils/shared.utils';
+import { ApplicationConfig } from '../application-config';
+import { ExcludeRouteMetadata } from '../router/interfaces/exclude-route-metadata.interface';
+import { isRouteExcluded } from '../router/utils';
+import { RoutePathFactory } from './../router/route-path-factory';
+
+export class RouteInfoPathExtractor {
+  private routePathFactory: RoutePathFactory;
+  private readonly prefixPath: string;
+  private readonly excludedGlobalPrefixRoutes: ExcludeRouteMetadata[];
+  private readonly versioningConfig?: VersioningOptions;
+
+  constructor(private readonly applicationConfig: ApplicationConfig) {
+    this.routePathFactory = new RoutePathFactory(applicationConfig);
+    this.prefixPath = stripEndSlash(
+      addLeadingSlash(this.applicationConfig.getGlobalPrefix()),
+    );
+    this.excludedGlobalPrefixRoutes =
+      this.applicationConfig.getGlobalPrefixOptions().exclude;
+    this.versioningConfig = this.applicationConfig.getVersioning();
+  }
+
+  public extractPathsFrom({ path, method, version }: RouteInfo): string[] {
+    const versionPath = this.extractVersionPathFrom(version);
+
+    if (this.isAWildcard(path)) {
+      return Array.isArray(this.excludedGlobalPrefixRoutes)
+        ? [
+            this.prefixPath + versionPath + addLeadingSlash(path),
+            ...this.excludedGlobalPrefixRoutes.map(
+              route => versionPath + addLeadingSlash(route.path),
+            ),
+          ]
+        : [this.prefixPath + versionPath + addLeadingSlash(path)];
+    }
+
+    return [this.extractNonWildcardPathFrom({ path, method, version })];
+  }
+
+  public extractPathFrom(route: RouteInfo): string {
+    if (this.isAWildcard(route.path) && !route.version) {
+      return addLeadingSlash(route.path);
+    }
+
+    return this.extractNonWildcardPathFrom(route);
+  }
+
+  private isAWildcard(path: string): boolean {
+    return ['*', '/*', '/*/', '(.*)', '/(.*)'].includes(path);
+  }
+
+  private extractNonWildcardPathFrom({
+    path,
+    method,
+    version,
+  }: RouteInfo): string {
+    const versionPath = this.extractVersionPathFrom(version);
+
+    if (
+      Array.isArray(this.excludedGlobalPrefixRoutes) &&
+      isRouteExcluded(this.excludedGlobalPrefixRoutes, path, method)
+    ) {
+      return versionPath + addLeadingSlash(path);
+    }
+
+    return this.prefixPath + versionPath + addLeadingSlash(path);
+  }
+
+  private extractVersionPathFrom(version?: VersionValue): string {
+    if (!version || this.versioningConfig?.type !== VersioningType.URI)
+      return '';
+
+    const versionPrefix = this.routePathFactory.getVersionPrefix(
+      this.versioningConfig,
+    );
+    return addLeadingSlash(versionPrefix + version.toString());
+  }
+}
diff --git a/packages/core/middleware/routes-mapper.ts b/packages/core/middleware/routes-mapper.ts
index bbb8ea36c..d6f98ec57 100644
--- a/packages/core/middleware/routes-mapper.ts
+++ b/packages/core/middleware/routes-mapper.ts
@@ -8,49 +8,68 @@ import {
 import { NestContainer } from '../injector/container';
 import { Module } from '../injector/module';
 import { MetadataScanner } from '../metadata-scanner';
-import { RouterExplorer } from '../router/router-explorer';
+import { PathsExplorer } from '../router/paths-explorer';
 import { targetModulesByContainer } from '../router/router-module';
 
 export class RoutesMapper {
-  private readonly routerExplorer: RouterExplorer;
+  private readonly pathsExplorer: PathsExplorer;
 
   constructor(private readonly container: NestContainer) {
-    this.routerExplorer = new RouterExplorer(new MetadataScanner(), container);
+    this.pathsExplorer = new PathsExplorer(new MetadataScanner());
   }
 
   public mapRouteToRouteInfo(
     route: Type<any> | RouteInfo | string,
   ): RouteInfo[] {
     if (isString(route)) {
-      const defaultRequestMethod = -1;
-      return [
-        {
-          path: addLeadingSlash(route),
-          method: defaultRequestMethod,
-        },
-      ];
+      return this.getRouteInfoFromPath(route);
     }
     const routePathOrPaths = this.getRoutePath(route);
     if (this.isRouteInfo(routePathOrPaths, route)) {
-      return [
-        {
-          path: addLeadingSlash(route.path),
-          method: route.method,
-        },
-      ];
+      return this.getRouteInfoFromObject(route);
     }
-    const controllerPaths = this.routerExplorer.scanForPaths(
-      Object.create(route),
-      route.prototype,
+
+    return this.getRouteInfoFromController(route, routePathOrPaths);
+  }
+
+  private getRouteInfoFromPath(routePath: string): RouteInfo[] {
+    const defaultRequestMethod = -1;
+    return [
+      {
+        path: addLeadingSlash(routePath),
+        method: defaultRequestMethod as any,
+      },
+    ];
+  }
+
+  private getRouteInfoFromObject(routeInfoObject: RouteInfo): RouteInfo[] {
+    const routeInfo: RouteInfo = {
+      path: addLeadingSlash(routeInfoObject.path),
+      method: routeInfoObject.method,
+    };
+
+    if (routeInfoObject.version) {
+      routeInfo.version = routeInfoObject.version;
+    }
+    return [routeInfo];
+  }
+
+  private getRouteInfoFromController(
+    controller: Type<any>,
+    routePath: string,
+  ): RouteInfo[] {
+    const controllerPaths = this.pathsExplorer.scanForPaths(
+      Object.create(controller),
+      controller.prototype,
     );
-    const moduleRef = this.getHostModuleOfController(route);
+    const moduleRef = this.getHostModuleOfController(controller);
     const modulePath = this.getModulePath(moduleRef?.metatype);
 
     const concatPaths = <T>(acc: T[], currentValue: T[]) =>
       acc.concat(currentValue);
 
     return []
-      .concat(routePathOrPaths)
+      .concat(routePath)
       .map(routePath =>
         controllerPaths
           .map(item =>
@@ -58,10 +77,16 @@ export class RoutesMapper {
               let path = modulePath ?? '';
               path += this.normalizeGlobalPath(routePath) + addLeadingSlash(p);
 
-              return {
+              const routeInfo: RouteInfo = {
                 path,
                 method: item.requestMethod,
               };
+
+              if (item.version) {
+                routeInfo.version = item.version;
+              }
+
+              return routeInfo;
             }),
           )
           .reduce(concatPaths, []),
@@ -100,7 +125,7 @@ export class RoutesMapper {
     const modules = Array.from(modulesContainer.values()).filter(moduleRef =>
       moduleRefsSet.has(moduleRef),
     );
-    return modules.find(({ routes }) => routes.has(metatype));
+    return modules.find(({ controllers }) => controllers.has(metatype));
   }
 
   private getModulePath(
diff --git a/packages/core/middleware/utils.ts b/packages/core/middleware/utils.ts
index f0cdddf99..7a23e24d0 100644
--- a/packages/core/middleware/utils.ts
+++ b/packages/core/middleware/utils.ts
@@ -1,19 +1,33 @@
 import { RequestMethod } from '@nestjs/common';
 import { HttpServer, RouteInfo, Type } from '@nestjs/common/interfaces';
-import { isFunction } from '@nestjs/common/utils/shared.utils';
+import {
+  addLeadingSlash,
+  isFunction,
+  isString,
+} from '@nestjs/common/utils/shared.utils';
 import { iterate } from 'iterare';
 import * as pathToRegexp from 'path-to-regexp';
-import { v4 as uuid } from 'uuid';
+import { uid } from 'uid';
 import { ExcludeRouteMetadata } from '../router/interfaces/exclude-route-metadata.interface';
 import { isRouteExcluded } from '../router/utils';
 
 export const mapToExcludeRoute = (
-  routes: RouteInfo[],
+  routes: (string | RouteInfo)[],
 ): ExcludeRouteMetadata[] => {
-  return routes.map(({ path, method }) => ({
-    pathRegex: pathToRegexp(path),
-    requestMethod: method,
-  }));
+  return routes.map(route => {
+    if (isString(route)) {
+      return {
+        path: route,
+        requestMethod: RequestMethod.ALL,
+        pathRegex: pathToRegexp(addLeadingSlash(route)),
+      };
+    }
+    return {
+      path: route.path,
+      requestMethod: route.method,
+      pathRegex: pathToRegexp(addLeadingSlash(route.path)),
+    };
+  });
 };
 
 export const filterMiddleware = <T extends Function | Type<any> = any>(
@@ -81,11 +95,11 @@ export function isMiddlewareClass(middleware: any): middleware is Type<any> {
   return (
     middlewareArr[0] === 'function' &&
     /[A-Z]/.test(middlewareArr[1]?.[0]) &&
-    typeof middleware.prototype?.use === 'function'
+    isFunction(middleware.prototype?.use)
   );
 }
 
-export function assignToken(metatype: Type<any>, token = uuid()): Type<any> {
+export function assignToken(metatype: Type<any>, token = uid(21)): Type<any> {
   Object.defineProperty(metatype, 'name', { value: token });
   return metatype;
 }
diff --git a/packages/core/nest-application-context.ts b/packages/core/nest-application-context.ts
index cfd4e19b6..ac4d64957 100644
--- a/packages/core/nest-application-context.ts
+++ b/packages/core/nest-application-context.ts
@@ -5,14 +5,17 @@ import {
   LogLevel,
   ShutdownSignal,
 } from '@nestjs/common';
-import { Abstract, DynamicModule, Scope } from '@nestjs/common/interfaces';
-import { Type } from '@nestjs/common/interfaces/type.interface';
+import {
+  Abstract,
+  DynamicModule,
+  GetOrResolveOptions,
+  Type,
+} from '@nestjs/common/interfaces';
+import { NestApplicationContextOptions } from '@nestjs/common/interfaces/nest-application-context-options.interface';
 import { isEmpty } from '@nestjs/common/utils/shared.utils';
 import { iterate } from 'iterare';
 import { MESSAGES } from './constants';
-import { InvalidClassScopeException } from './errors/exceptions/invalid-class-scope.exception';
-import { UnknownElementException } from './errors/exceptions/unknown-element.exception';
-import { UnknownModuleException } from './errors/exceptions/unknown-module.exception';
+import { UnknownModuleException } from './errors/exceptions';
 import { createContextId } from './helpers/context-id-factory';
 import {
   callAppShutdownHook,
@@ -21,6 +24,7 @@ import {
   callModuleDestroyHook,
   callModuleInitHook,
 } from './hooks';
+import { AbstractInstanceResolver } from './injector/abstract-instance-resolver';
 import { ModuleCompiler } from './injector/compiler';
 import { NestContainer } from './injector/container';
 import { Injector } from './injector/injector';
@@ -31,17 +35,26 @@ import { Module } from './injector/module';
 /**
  * @publicApi
  */
-export class NestApplicationContext implements INestApplicationContext {
+export class NestApplicationContext<
+    TOptions extends NestApplicationContextOptions = NestApplicationContextOptions,
+  >
+  extends AbstractInstanceResolver
+  implements INestApplicationContext
+{
   protected isInitialized = false;
-  protected readonly injector = new Injector();
+  protected injector: Injector;
+  protected readonly logger = new Logger(NestApplicationContext.name, {
+    timestamp: true,
+  });
 
+  private shouldFlushLogsOnOverride = false;
   private readonly activeShutdownSignals = new Array<string>();
   private readonly moduleCompiler = new ModuleCompiler();
   private shutdownCleanupRef?: (...args: unknown[]) => unknown;
   private _instanceLinksHost: InstanceLinksHost;
-  private _moduleRefsByDistance?: Array<Module>;
+  private _moduleRefsForHooksByDistance?: Array<Module>;
 
-  private get instanceLinksHost() {
+  protected get instanceLinksHost() {
     if (!this._instanceLinksHost) {
       this._instanceLinksHost = new InstanceLinksHost(this.container);
     }
@@ -50,15 +63,27 @@ export class NestApplicationContext implements INestApplicationContext {
 
   constructor(
     protected readonly container: NestContainer,
-    private readonly scope = new Array<Type<any>>(),
+    protected readonly appOptions: TOptions = {} as TOptions,
     private contextModule: Module = null,
-  ) {}
+    private readonly scope = new Array<Type<any>>(),
+  ) {
+    super();
+    this.injector = new Injector();
+
+    if (this.appOptions.preview) {
+      this.printInPreviewModeWarning();
+    }
+  }
 
   public selectContextModule() {
     const modules = this.container.getModules().values();
     this.contextModule = modules.next().value;
   }
 
+  /**
+   * Allows navigating through the modules tree, for example, to pull out a specific instance from the selected module.
+   * @returns {INestApplicationContext}
+   */
   public select<T>(
     moduleType: Type<T> | DynamicModule,
   ): INestApplicationContext {
@@ -75,24 +100,114 @@ export class NestApplicationContext implements INestApplicationContext {
     if (!selectedModule) {
       throw new UnknownModuleException();
     }
-    return new NestApplicationContext(this.container, scope, selectedModule);
+    return new NestApplicationContext(
+      this.container,
+      this.appOptions,
+      selectedModule,
+      scope,
+    );
   }
 
+  /**
+   * Retrieves an instance of either injectable or controller, otherwise, throws exception.
+   * @returns {TResult}
+   */
+  public get<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+  ): TResult;
+  /**
+   * Retrieves an instance of either injectable or controller, otherwise, throws exception.
+   * @returns {TResult}
+   */
+  public get<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    options: {
+      strict?: boolean;
+      each?: undefined | false;
+    },
+  ): TResult;
+  /**
+   * Retrieves a list of instances of either injectables or controllers, otherwise, throws exception.
+   * @returns {Array<TResult>}
+   */
+  public get<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    options: {
+      strict?: boolean;
+      each: true;
+    },
+  ): Array<TResult>;
+  /**
+   * Retrieves an instance (or a list of instances) of either injectable or controller, otherwise, throws exception.
+   * @returns {TResult | Array<TResult>}
+   */
   public get<TInput = any, TResult = TInput>(
     typeOrToken: Type<TInput> | Abstract<TInput> | string | symbol,
-    options: { strict: boolean } = { strict: false },
-  ): TResult {
+    options: GetOrResolveOptions = { strict: false },
+  ): TResult | Array<TResult> {
     return !(options && options.strict)
-      ? this.find<TInput, TResult>(typeOrToken)
-      : this.find<TInput, TResult>(typeOrToken, this.contextModule);
+      ? this.find<TInput, TResult>(typeOrToken, options)
+      : this.find<TInput, TResult>(typeOrToken, {
+          moduleId: this.contextModule?.id,
+          each: options.each,
+        });
   }
 
+  /**
+   * Resolves transient or request-scoped instance of either injectable or controller, otherwise, throws exception.
+   * @returns {Array<TResult>}
+   */
+  public resolve<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+  ): Promise<TResult>;
+  /**
+   * Resolves transient or request-scoped instance of either injectable or controller, otherwise, throws exception.
+   * @returns {Array<TResult>}
+   */
+  public resolve<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    contextId?: {
+      id: number;
+    },
+  ): Promise<TResult>;
+  /**
+   * Resolves transient or request-scoped instance of either injectable or controller, otherwise, throws exception.
+   * @returns {Array<TResult>}
+   */
+  public resolve<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    contextId?: {
+      id: number;
+    },
+    options?: {
+      strict?: boolean;
+      each?: undefined | false;
+    },
+  ): Promise<TResult>;
+  /**
+   * Resolves transient or request-scoped instances of either injectables or controllers, otherwise, throws exception.
+   * @returns {Array<TResult>}
+   */
+  public resolve<TInput = any, TResult = TInput>(
+    typeOrToken: Type<TInput> | Function | string | symbol,
+    contextId?: {
+      id: number;
+    },
+    options?: {
+      strict?: boolean;
+      each: true;
+    },
+  ): Promise<Array<TResult>>;
+  /**
+   * Resolves transient or request-scoped instance (or a list of instances) of either injectable or controller, otherwise, throws exception.
+   * @returns {Promise<TResult | Array<TResult>>}
+   */
   public resolve<TInput = any, TResult = TInput>(
     typeOrToken: Type<TInput> | Abstract<TInput> | string | symbol,
     contextId = createContextId(),
-    options: { strict: boolean } = { strict: false },
-  ): Promise<TResult> {
-    return this.resolvePerContext(
+    options: GetOrResolveOptions = { strict: false },
+  ): Promise<TResult | Array<TResult>> {
+    return this.resolvePerContext<TInput, TResult>(
       typeOrToken,
       this.contextModule,
       contextId,
@@ -100,12 +215,16 @@ export class NestApplicationContext implements INestApplicationContext {
     );
   }
 
+  /**
+   * Registers the request/context object for a given context ID (DI container sub-tree).
+   * @returns {void}
+   */
   public registerRequestByContextId<T = any>(request: T, contextId: ContextId) {
     this.container.registerRequestProvider(request, contextId);
   }
 
   /**
-   * Initalizes the Nest application.
+   * Initializes the Nest application.
    * Calls the Nest lifecycle events.
    *
    * @returns {Promise<this>} The NestApplicationContext instance as Promise
@@ -121,22 +240,46 @@ export class NestApplicationContext implements INestApplicationContext {
     return this;
   }
 
-  public async close(): Promise<void> {
+  /**
+   * Terminates the application
+   * @returns {Promise<void>}
+   */
+  public async close(signal?: string): Promise<void> {
     await this.callDestroyHook();
-    await this.callBeforeShutdownHook();
+    await this.callBeforeShutdownHook(signal);
     await this.dispose();
-    await this.callShutdownHook();
+    await this.callShutdownHook(signal);
     this.unsubscribeFromProcessSignals();
   }
 
+  /**
+   * Sets custom logger service.
+   * Flushes buffered logs if auto flush is on.
+   * @returns {void}
+   */
   public useLogger(logger: LoggerService | LogLevel[] | false) {
     Logger.overrideLogger(logger);
+
+    if (this.shouldFlushLogsOnOverride) {
+      this.flushLogs();
+    }
   }
 
+  /**
+   * Prints buffered logs and detaches buffer.
+   * @returns {void}
+   */
   public flushLogs() {
     Logger.flush();
   }
 
+  /**
+   * Define that it must flush logs right after defining a custom logger.
+   */
+  public flushLogsOnOverride() {
+    this.shouldFlushLogsOnOverride = true;
+  }
+
   /**
    * Enables the usage of shutdown hooks. Will call the
    * `onApplicationShutdown` function of a provider if the
@@ -180,13 +323,20 @@ export class NestApplicationContext implements INestApplicationContext {
    * @param {string[]} signals The system signals it should listen to
    */
   protected listenToShutdownSignals(signals: string[]) {
+    let receivedSignal = false;
     const cleanup = async (signal: string) => {
       try {
-        signals.forEach(sig => process.removeListener(sig, cleanup));
+        if (receivedSignal) {
+          // If we receive another signal while we're waiting
+          // for the server to stop, just ignore it.
+          return;
+        }
+        receivedSignal = true;
         await this.callDestroyHook();
         await this.callBeforeShutdownHook(signal);
         await this.dispose();
         await this.callShutdownHook(signal);
+        signals.forEach(sig => process.removeListener(sig, cleanup));
         process.kill(process.pid, signal);
       } catch (err) {
         Logger.error(
@@ -222,7 +372,7 @@ export class NestApplicationContext implements INestApplicationContext {
    * modules and its children.
    */
   protected async callInitHook(): Promise<void> {
-    const modulesSortedByDistance = this.getModulesSortedByDistance();
+    const modulesSortedByDistance = this.getModulesToTriggerHooksOn();
     for (const module of modulesSortedByDistance) {
       await callModuleInitHook(module);
     }
@@ -233,7 +383,7 @@ export class NestApplicationContext implements INestApplicationContext {
    * modules and its children.
    */
   protected async callDestroyHook(): Promise<void> {
-    const modulesSortedByDistance = this.getModulesSortedByDistance();
+    const modulesSortedByDistance = this.getModulesToTriggerHooksOn();
     for (const module of modulesSortedByDistance) {
       await callModuleDestroyHook(module);
     }
@@ -244,7 +394,7 @@ export class NestApplicationContext implements INestApplicationContext {
    * modules and its children.
    */
   protected async callBootstrapHook(): Promise<void> {
-    const modulesSortedByDistance = this.getModulesSortedByDistance();
+    const modulesSortedByDistance = this.getModulesToTriggerHooksOn();
     for (const module of modulesSortedByDistance) {
       await callModuleBootstrapHook(module);
     }
@@ -255,7 +405,7 @@ export class NestApplicationContext implements INestApplicationContext {
    * modules and children.
    */
   protected async callShutdownHook(signal?: string): Promise<void> {
-    const modulesSortedByDistance = this.getModulesSortedByDistance();
+    const modulesSortedByDistance = this.getModulesToTriggerHooksOn();
     for (const module of modulesSortedByDistance) {
       await callAppShutdownHook(module, signal);
     }
@@ -266,69 +416,40 @@ export class NestApplicationContext implements INestApplicationContext {
    * modules and children.
    */
   protected async callBeforeShutdownHook(signal?: string): Promise<void> {
-    const modulesSortedByDistance = this.getModulesSortedByDistance();
+    const modulesSortedByDistance = this.getModulesToTriggerHooksOn();
     for (const module of modulesSortedByDistance) {
       await callBeforeAppShutdownHook(module, signal);
     }
   }
 
-  protected find<TInput = any, TResult = TInput>(
-    typeOrToken: Type<TInput> | Abstract<TInput> | string | symbol,
-    contextModule?: Module,
-  ): TResult {
-    const moduleId = contextModule && contextModule.id;
-    const { wrapperRef } = this.instanceLinksHost.get<TResult>(
-      typeOrToken,
-      moduleId,
-    );
-    if (
-      wrapperRef.scope === Scope.REQUEST ||
-      wrapperRef.scope === Scope.TRANSIENT
-    ) {
-      throw new InvalidClassScopeException(typeOrToken);
-    }
-    return wrapperRef.instance;
-  }
-
-  protected async resolvePerContext<TInput = any, TResult = TInput>(
-    typeOrToken: Type<TInput> | Abstract<TInput> | string | symbol,
-    contextModule: Module,
-    contextId: ContextId,
-    options?: { strict: boolean },
-  ): Promise<TResult> {
-    const isStrictModeEnabled = options && options.strict;
-    const instanceLink = isStrictModeEnabled
-      ? this.instanceLinksHost.get(typeOrToken, contextModule.id)
-      : this.instanceLinksHost.get(typeOrToken);
-
-    const { wrapperRef, collection } = instanceLink;
-    if (wrapperRef.isDependencyTreeStatic() && !wrapperRef.isTransient) {
-      return this.get(typeOrToken, options);
-    }
-
-    const ctorHost = wrapperRef.instance || { constructor: typeOrToken };
-    const instance = await this.injector.loadPerContext(
-      ctorHost,
-      wrapperRef.host,
-      collection,
-      contextId,
-    );
-    if (!instance) {
-      throw new UnknownElementException();
+  protected assertNotInPreviewMode(methodName: string) {
+    if (this.appOptions.preview) {
+      const error = `Calling the "${methodName}" in the preview mode is not supported.`;
+      this.logger.error(error);
+      throw new Error(error);
     }
-    return instance;
   }
 
-  private getModulesSortedByDistance(): Module[] {
-    if (this._moduleRefsByDistance) {
-      return this._moduleRefsByDistance;
+  private getModulesToTriggerHooksOn(): Module[] {
+    if (this._moduleRefsForHooksByDistance) {
+      return this._moduleRefsForHooksByDistance;
     }
     const modulesContainer = this.container.getModules();
     const compareFn = (a: Module, b: Module) => b.distance - a.distance;
-
-    this._moduleRefsByDistance = Array.from(modulesContainer.values()).sort(
+    const modulesSortedByDistance = Array.from(modulesContainer.values()).sort(
       compareFn,
     );
-    return this._moduleRefsByDistance;
+
+    this._moduleRefsForHooksByDistance = this.appOptions?.preview
+      ? modulesSortedByDistance.filter(moduleRef => moduleRef.initOnPreview)
+      : modulesSortedByDistance;
+    return this._moduleRefsForHooksByDistance;
+  }
+
+  private printInPreviewModeWarning() {
+    this.logger.warn('------------------------------------------------');
+    this.logger.warn('Application is running in the PREVIEW mode!');
+    this.logger.warn('Providers/controllers will not be instantiated.');
+    this.logger.warn('------------------------------------------------');
   }
 }
diff --git a/packages/core/nest-application.ts b/packages/core/nest-application.ts
index 2fac71560..3b25d5877 100644
--- a/packages/core/nest-application.ts
+++ b/packages/core/nest-application.ts
@@ -7,18 +7,18 @@ import {
   NestHybridApplicationOptions,
   NestInterceptor,
   PipeTransform,
-  RequestMethod,
   VersioningOptions,
   VersioningType,
   WebSocketAdapter,
 } from '@nestjs/common';
-import { RouteInfo } from '@nestjs/common/interfaces';
+import {
+  GlobalPrefixOptions,
+  NestApplicationOptions,
+} from '@nestjs/common/interfaces';
 import {
   CorsOptions,
   CorsOptionsDelegate,
 } from '@nestjs/common/interfaces/external/cors-options.interface';
-import { GlobalPrefixOptions } from '@nestjs/common/interfaces/global-prefix-options.interface';
-import { NestApplicationOptions } from '@nestjs/common/interfaces/nest-application-options.interface';
 import { Logger } from '@nestjs/common/services/logger.service';
 import { loadPackage } from '@nestjs/common/utils/load-package.util';
 import {
@@ -29,16 +29,17 @@ import {
 } from '@nestjs/common/utils/shared.utils';
 import { iterate } from 'iterare';
 import { platform } from 'os';
-import * as pathToRegexp from 'path-to-regexp';
 import { AbstractHttpAdapter } from './adapters';
 import { ApplicationConfig } from './application-config';
 import { MESSAGES } from './constants';
 import { optionalRequire } from './helpers/optional-require';
 import { NestContainer } from './injector/container';
+import { Injector } from './injector/injector';
+import { GraphInspector } from './inspector/graph-inspector';
 import { MiddlewareContainer } from './middleware/container';
 import { MiddlewareModule } from './middleware/middleware-module';
+import { mapToExcludeRoute } from './middleware/utils';
 import { NestApplicationContext } from './nest-application-context';
-import { ExcludeRouteMetadata } from './router/interfaces/exclude-route-metadata.interface';
 import { Resolver } from './router/interfaces/resolver.interface';
 import { RoutesResolver } from './router/routes-resolver';
 
@@ -55,13 +56,13 @@ const { MicroservicesModule } = optionalRequire(
  * @publicApi
  */
 export class NestApplication
-  extends NestApplicationContext
+  extends NestApplicationContext<NestApplicationOptions>
   implements INestApplication
 {
-  private readonly logger = new Logger(NestApplication.name, {
+  protected readonly logger = new Logger(NestApplication.name, {
     timestamp: true,
   });
-  private readonly middlewareModule = new MiddlewareModule();
+  private readonly middlewareModule: MiddlewareModule;
   private readonly middlewareContainer = new MiddlewareContainer(
     this.container,
   );
@@ -77,17 +78,20 @@ export class NestApplication
     container: NestContainer,
     private readonly httpAdapter: HttpServer,
     private readonly config: ApplicationConfig,
-    private readonly appOptions: NestApplicationOptions = {},
+    private readonly graphInspector: GraphInspector,
+    appOptions: NestApplicationOptions = {},
   ) {
-    super(container);
+    super(container, appOptions);
 
     this.selectContextModule();
     this.registerHttpServer();
-
+    this.injector = new Injector({ preview: this.appOptions.preview });
+    this.middlewareModule = new MiddlewareModule();
     this.routesResolver = new RoutesResolver(
       this.container,
       this.config,
       this.injector,
+      this.graphInspector,
     );
   }
 
@@ -121,8 +125,7 @@ export class NestApplication
       return undefined;
     }
     const passCustomOptions =
-      isObject(this.appOptions.cors) ||
-      typeof this.appOptions.cors === 'function';
+      isObject(this.appOptions.cors) || isFunction(this.appOptions.cors);
     if (!passCustomOptions) {
       return this.enableCors();
     }
@@ -140,15 +143,23 @@ export class NestApplication
     this.registerWsModule();
 
     if (this.microservicesModule) {
-      this.microservicesModule.register(this.container, this.config);
+      this.microservicesModule.register(
+        this.container,
+        this.graphInspector,
+        this.config,
+        this.appOptions,
+      );
       this.microservicesModule.setupClients(this.container);
     }
+
     await this.middlewareModule.register(
       this.middlewareContainer,
       this.container,
       this.config,
       this.injector,
       this.httpAdapter,
+      this.graphInspector,
+      this.appOptions,
     );
   }
 
@@ -156,7 +167,13 @@ export class NestApplication
     if (!this.socketModule) {
       return;
     }
-    this.socketModule.register(this.container, this.config, this.httpServer);
+    this.socketModule.register(
+      this.container,
+      this.config,
+      this.graphInspector,
+      this.appOptions,
+      this.httpServer,
+    );
   }
 
   public async init(): Promise<this> {
@@ -179,7 +196,9 @@ export class NestApplication
   }
 
   public registerParserMiddleware() {
-    this.httpAdapter.registerParserMiddleware();
+    const prefix = this.config.getGlobalPrefix();
+    const rawBody = !!this.appOptions?.rawBody;
+    this.httpAdapter.registerParserMiddleware(prefix, rawBody);
   }
 
   public async registerRouter() {
@@ -212,6 +231,7 @@ export class NestApplication
     const instance = new NestMicroservice(
       this.container,
       microserviceOptions,
+      this.graphInspector,
       applicationConfig,
     );
     instance.registerListeners();
@@ -231,22 +251,30 @@ export class NestApplication
   }
 
   public async startAllMicroservices(): Promise<this> {
+    this.assertNotInPreviewMode('startAllMicroservices');
     await Promise.all(this.microservices.map(msvc => msvc.listen()));
     return this;
   }
 
-  public startAllMicroservicesAsync(): Promise<this> {
-    this.logger.warn(
-      'DEPRECATED! "startAllMicroservicesAsync" method is deprecated and will be removed in the next major release. Please, use "startAllMicroservices" instead.',
-    );
-    return this.startAllMicroservices();
-  }
-
   public use(...args: [any, any?]): this {
     this.httpAdapter.use(...args);
     return this;
   }
 
+  public useBodyParser(...args: [any, any?]): this {
+    if (!('useBodyParser' in this.httpAdapter)) {
+      this.logger.warn('Your HTTP Adapter does not support `.useBodyParser`.');
+      return this;
+    }
+
+    const [parserType, ...otherArgs] = args;
+    const rawBody = !!this.appOptions.rawBody;
+
+    this.httpAdapter.useBodyParser(...[parserType, rawBody, ...otherArgs]);
+
+    return this;
+  }
+
   public enableCors(options?: CorsOptions | CorsOptionsDelegate<any>): void {
     this.httpAdapter.enableCors(options);
   }
@@ -261,6 +289,7 @@ export class NestApplication
   public async listen(port: number | string): Promise<any>;
   public async listen(port: number | string, hostname: string): Promise<any>;
   public async listen(port: number | string, ...args: any[]): Promise<any> {
+    this.assertNotInPreviewMode('listen');
     !this.isInitialized && (await this.init());
 
     return new Promise((resolve, reject) => {
@@ -300,18 +329,12 @@ export class NestApplication
     });
   }
 
-  public listenAsync(port: number | string, ...args: any[]): Promise<any> {
-    this.logger.warn(
-      'DEPRECATED! "listenAsync" method is deprecated and will be removed in the next major release. Please, use "listen" instead.',
-    );
-    return this.listen(port, ...(args as [any]));
-  }
-
   public async getUrl(): Promise<string> {
     return new Promise((resolve, reject) => {
       if (!this.isListening) {
         this.logger.error(MESSAGES.CALL_LISTEN_FIRST);
         reject(MESSAGES.CALL_LISTEN_FIRST);
+        return;
       }
       const address = this.httpServer.address();
       resolve(this.formatAddress(address));
@@ -319,13 +342,14 @@ export class NestApplication
   }
 
   private formatAddress(address: any): string {
-    if (typeof address === 'string') {
+    if (isString(address)) {
       if (platform() === 'win32') {
         return address;
       }
       const basePath = encodeURIComponent(address);
       return `${this.getProtocol()}+unix://${basePath}`;
     }
+
     let host = this.host();
     if (address && address.family === 'IPv6') {
       if (host === '::') {
@@ -343,20 +367,9 @@ export class NestApplication
   public setGlobalPrefix(prefix: string, options?: GlobalPrefixOptions): this {
     this.config.setGlobalPrefix(prefix);
     if (options) {
-      const exclude = options?.exclude.map(
-        (route: string | RouteInfo): ExcludeRouteMetadata => {
-          if (isString(route)) {
-            return {
-              requestMethod: RequestMethod.ALL,
-              pathRegex: pathToRegexp(addLeadingSlash(route)),
-            };
-          }
-          return {
-            requestMethod: route.method,
-            pathRegex: pathToRegexp(addLeadingSlash(route.path)),
-          };
-        },
-      );
+      const exclude = options?.exclude
+        ? mapToExcludeRoute(options.exclude)
+        : [];
       this.config.setGlobalPrefixOptions({
         ...options,
         exclude,
@@ -372,21 +385,45 @@ export class NestApplication
 
   public useGlobalFilters(...filters: ExceptionFilter[]): this {
     this.config.useGlobalFilters(...filters);
+    filters.forEach(item =>
+      this.graphInspector.insertOrphanedEnhancer({
+        subtype: 'filter',
+        ref: item,
+      }),
+    );
     return this;
   }
 
   public useGlobalPipes(...pipes: PipeTransform<any>[]): this {
     this.config.useGlobalPipes(...pipes);
+    pipes.forEach(item =>
+      this.graphInspector.insertOrphanedEnhancer({
+        subtype: 'pipe',
+        ref: item,
+      }),
+    );
     return this;
   }
 
   public useGlobalInterceptors(...interceptors: NestInterceptor[]): this {
     this.config.useGlobalInterceptors(...interceptors);
+    interceptors.forEach(item =>
+      this.graphInspector.insertOrphanedEnhancer({
+        subtype: 'interceptor',
+        ref: item,
+      }),
+    );
     return this;
   }
 
   public useGlobalGuards(...guards: CanActivate[]): this {
     this.config.useGlobalGuards(...guards);
+    guards.forEach(item =>
+      this.graphInspector.insertOrphanedEnhancer({
+        subtype: 'guard',
+        ref: item,
+      }),
+    );
     return this;
   }
 
@@ -410,7 +447,7 @@ export class NestApplication
   }
   private host(): string | undefined {
     const address = this.httpServer.address();
-    if (typeof address === 'string') {
+    if (isString(address)) {
       return undefined;
     }
     return address && address.address;
diff --git a/packages/core/nest-factory.ts b/packages/core/nest-factory.ts
index 702ee9146..9d4c2c8f9 100644
--- a/packages/core/nest-factory.ts
+++ b/packages/core/nest-factory.ts
@@ -17,7 +17,11 @@ import { ExceptionsZone } from './errors/exceptions-zone';
 import { loadAdapter } from './helpers/load-adapter';
 import { rethrow } from './helpers/rethrow';
 import { NestContainer } from './injector/container';
+import { Injector } from './injector/injector';
 import { InstanceLoader } from './injector/instance-loader';
+import { GraphInspector } from './inspector/graph-inspector';
+import { NoopGraphInspector } from './inspector/noop-graph-inspector';
+import { UuidFactory, UuidFactoryMode } from './inspector/uuid-factory';
 import { MetadataScanner } from './metadata-scanner';
 import { NestApplication } from './nest-application';
 import { NestApplicationContext } from './nest-application-context';
@@ -63,7 +67,7 @@ export class NestFactoryStatic {
     options?: NestApplicationOptions,
   ): Promise<T>;
   public async create<T extends INestApplication = INestApplication>(
-    module: any,
+    moduleCls: any,
     serverOrOptions?: AbstractHttpAdapter | NestApplicationOptions,
     options?: NestApplicationOptions,
   ): Promise<T> {
@@ -73,15 +77,25 @@ export class NestFactoryStatic {
 
     const applicationConfig = new ApplicationConfig();
     const container = new NestContainer(applicationConfig);
+    const graphInspector = this.createGraphInspector(appOptions, container);
+
     this.setAbortOnError(serverOrOptions, options);
     this.registerLoggerConfiguration(appOptions);
 
-    await this.initialize(module, container, applicationConfig, httpServer);
+    await this.initialize(
+      moduleCls,
+      container,
+      graphInspector,
+      applicationConfig,
+      appOptions,
+      httpServer,
+    );
 
     const instance = new NestApplication(
       container,
       httpServer,
       applicationConfig,
+      graphInspector,
       appOptions,
     );
     const target = this.createNestInstance(instance);
@@ -91,14 +105,14 @@ export class NestFactoryStatic {
   /**
    * Creates an instance of NestMicroservice.
    *
-   * @param module Entry (root) application module class
+   * @param moduleCls Entry (root) application module class
    * @param options Optional microservice configuration
    *
    * @returns A promise that, when resolved,
    * contains a reference to the NestMicroservice instance.
    */
   public async createMicroservice<T extends object>(
-    module: any,
+    moduleCls: any,
     options?: NestMicroserviceOptions & T,
   ): Promise<INestMicroservice> {
     const { NestMicroservice } = loadPackage(
@@ -108,40 +122,65 @@ export class NestFactoryStatic {
     );
     const applicationConfig = new ApplicationConfig();
     const container = new NestContainer(applicationConfig);
+    const graphInspector = this.createGraphInspector(options, container);
+
     this.setAbortOnError(options);
     this.registerLoggerConfiguration(options);
 
-    await this.initialize(module, container, applicationConfig);
+    await this.initialize(
+      moduleCls,
+      container,
+      graphInspector,
+      applicationConfig,
+      options,
+    );
     return this.createNestInstance<INestMicroservice>(
-      new NestMicroservice(container, options, applicationConfig),
+      new NestMicroservice(
+        container,
+        options,
+        graphInspector,
+        applicationConfig,
+      ),
     );
   }
 
   /**
    * Creates an instance of NestApplicationContext.
    *
-   * @param module Entry (root) application module class
+   * @param moduleCls Entry (root) application module class
    * @param options Optional Nest application configuration
    *
    * @returns A promise that, when resolved,
    * contains a reference to the NestApplicationContext instance.
    */
   public async createApplicationContext(
-    module: any,
+    moduleCls: any,
     options?: NestApplicationContextOptions,
   ): Promise<INestApplicationContext> {
     const container = new NestContainer();
+    const graphInspector = this.createGraphInspector(options, container);
+
     this.setAbortOnError(options);
     this.registerLoggerConfiguration(options);
 
-    await this.initialize(module, container);
+    const applicationConfig = undefined;
+    await this.initialize(
+      moduleCls,
+      container,
+      graphInspector,
+      applicationConfig,
+      options,
+    );
 
     const modules = container.getModules().values();
     const root = modules.next().value;
 
     const context = this.createNestInstance<NestApplicationContext>(
-      new NestApplicationContext(container, [], root),
+      new NestApplicationContext(container, options, root),
     );
+    if (this.autoFlushLogs) {
+      context.flushLogsOnOverride();
+    }
     return context.init();
   }
 
@@ -152,14 +191,26 @@ export class NestFactoryStatic {
   private async initialize(
     module: any,
     container: NestContainer,
+    graphInspector: GraphInspector,
     config = new ApplicationConfig(),
+    options: NestApplicationContextOptions = {},
     httpServer: HttpServer = null,
   ) {
-    const instanceLoader = new InstanceLoader(container);
+    UuidFactory.mode = options.snapshot
+      ? UuidFactoryMode.Deterministic
+      : UuidFactoryMode.Random;
+
+    const injector = new Injector({ preview: options.preview });
+    const instanceLoader = new InstanceLoader(
+      container,
+      injector,
+      graphInspector,
+    );
     const metadataScanner = new MetadataScanner();
     const dependenciesScanner = new DependenciesScanner(
       container,
       metadataScanner,
+      graphInspector,
       config,
     );
     container.setHttpAdapter(httpServer);
@@ -296,6 +347,15 @@ export class NestFactoryStatic {
     });
     return proxy as unknown as T;
   }
+
+  private createGraphInspector(
+    appOptions: NestApplicationContextOptions,
+    container: NestContainer,
+  ) {
+    return appOptions?.snapshot
+      ? new GraphInspector(container)
+      : NoopGraphInspector;
+  }
 }
 
 /**
diff --git a/packages/core/package.json b/packages/core/package.json
index 0a82418a8..99f801e00 100644
--- a/packages/core/package.json
+++ b/packages/core/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/core",
-  "version": "8.2.3",
+  "version": "9.4.0",
   "description": "Nest - modern, fast, powerful node.js web framework (@core)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -30,19 +30,18 @@
     "@nuxtjs/opencollective": "0.3.2",
     "fast-safe-stringify": "2.1.1",
     "iterare": "1.2.1",
-    "object-hash": "2.2.0",
     "path-to-regexp": "3.2.0",
-    "tslib": "2.3.1",
-    "uuid": "8.3.2"
+    "tslib": "2.5.0",
+    "uid": "2.0.2"
   },
   "devDependencies": {
-    "@nestjs/common": "8.2.3"
+    "@nestjs/common": "9.4.0"
   },
   "peerDependencies": {
-    "@nestjs/common": "^8.0.0",
-    "@nestjs/microservices": "^8.0.0",
-    "@nestjs/platform-express": "^8.0.0",
-    "@nestjs/websockets": "^8.0.0",
+    "@nestjs/common": "^9.0.0",
+    "@nestjs/microservices": "^9.0.0",
+    "@nestjs/platform-express": "^9.0.0",
+    "@nestjs/websockets": "^9.0.0",
     "reflect-metadata": "^0.1.12",
     "rxjs": "^7.1.0"
   },
diff --git a/packages/core/pipes/index.ts b/packages/core/pipes/index.ts
new file mode 100644
index 000000000..ce7301a1d
--- /dev/null
+++ b/packages/core/pipes/index.ts
@@ -0,0 +1,3 @@
+export * from './params-token-factory';
+export * from './pipes-consumer';
+export * from './pipes-context-creator';
diff --git a/packages/core/pipes/pipes-context-creator.ts b/packages/core/pipes/pipes-context-creator.ts
index 7776f8552..fa8140237 100644
--- a/packages/core/pipes/pipes-context-creator.ts
+++ b/packages/core/pipes/pipes-context-creator.ts
@@ -64,7 +64,7 @@ export class PipesContextCreator extends ContextCreator {
       return null;
     }
     const instanceHost = instanceWrapper.getInstanceByContextId(
-      contextId,
+      this.getContextId(contextId, instanceWrapper),
       inquirerId,
     );
     return instanceHost && instanceHost.instance;
@@ -98,7 +98,12 @@ export class PipesContextCreator extends ContextCreator {
     const scopedPipeWrappers =
       this.config.getGlobalRequestPipes() as InstanceWrapper[];
     const scopedPipes = iterate(scopedPipeWrappers)
-      .map(wrapper => wrapper.getInstanceByContextId(contextId, inquirerId))
+      .map(wrapper =>
+        wrapper.getInstanceByContextId(
+          this.getContextId(contextId, wrapper),
+          inquirerId,
+        ),
+      )
       .filter(host => !!host)
       .map(host => host.instance)
       .toArray();
diff --git a/packages/core/repl/assign-to-object.util.ts b/packages/core/repl/assign-to-object.util.ts
new file mode 100644
index 000000000..16f937999
--- /dev/null
+++ b/packages/core/repl/assign-to-object.util.ts
@@ -0,0 +1,14 @@
+/**
+ * Similar to `Object.assign` but copying properties descriptors from `source`
+ * as well.
+ */
+export function assignToObject<T, U>(target: T, source: U): T & U {
+  Object.defineProperties(
+    target,
+    Object.keys(source).reduce((descriptors, key) => {
+      descriptors[key] = Object.getOwnPropertyDescriptor(source, key);
+      return descriptors;
+    }, Object.create(null)),
+  );
+  return target as T & U;
+}
diff --git a/packages/core/repl/constants.ts b/packages/core/repl/constants.ts
new file mode 100644
index 000000000..870e2ec51
--- /dev/null
+++ b/packages/core/repl/constants.ts
@@ -0,0 +1 @@
+export const REPL_INITIALIZED_MESSAGE = 'REPL initialized';
diff --git a/packages/core/repl/index.ts b/packages/core/repl/index.ts
new file mode 100644
index 000000000..8a399bd09
--- /dev/null
+++ b/packages/core/repl/index.ts
@@ -0,0 +1 @@
+export * from './repl';
diff --git a/packages/core/repl/native-functions/debug-repl-fn.ts b/packages/core/repl/native-functions/debug-repl-fn.ts
new file mode 100644
index 000000000..2f1d4a97d
--- /dev/null
+++ b/packages/core/repl/native-functions/debug-repl-fn.ts
@@ -0,0 +1,62 @@
+import type { Type, InjectionToken } from '@nestjs/common';
+import { clc } from '@nestjs/common/utils/cli-colors.util';
+import { ReplFunction } from '../repl-function';
+import type { ModuleDebugEntry } from '../repl-context';
+import type { ReplFnDefinition } from '../repl.interfaces';
+
+export class DebugReplFn extends ReplFunction {
+  public fnDefinition: ReplFnDefinition = {
+    name: 'debug',
+    description:
+      'Print all registered modules as a list together with their controllers and providers.\nIf the argument is passed in, for example, "debug(MyModule)" then it will only print components of this specific module.',
+    signature: '(moduleCls?: ClassRef | string) => void',
+  };
+
+  action(moduleCls?: Type<unknown> | string): void {
+    this.ctx.writeToStdout('\n');
+
+    if (moduleCls) {
+      const token =
+        typeof moduleCls === 'function' ? moduleCls.name : moduleCls;
+      const moduleEntry = this.ctx.debugRegistry[token];
+      if (!moduleEntry) {
+        return this.logger.error(
+          `"${token}" has not been found in the modules registry`,
+        );
+      }
+      this.printCtrlsAndProviders(token, moduleEntry);
+    } else {
+      Object.keys(this.ctx.debugRegistry).forEach(moduleKey => {
+        this.printCtrlsAndProviders(
+          moduleKey,
+          this.ctx.debugRegistry[moduleKey],
+        );
+      });
+    }
+    this.ctx.writeToStdout('\n');
+  }
+
+  private printCtrlsAndProviders(
+    moduleName: string,
+    moduleDebugEntry: ModuleDebugEntry,
+  ) {
+    this.ctx.writeToStdout(`${clc.green(moduleName)}:\n`);
+    this.printCollection('controllers', moduleDebugEntry['controllers']);
+    this.printCollection('providers', moduleDebugEntry['providers']);
+  }
+
+  private printCollection(
+    title: string,
+    collectionValue: Record<string, InjectionToken>,
+  ) {
+    const collectionEntries = Object.keys(collectionValue);
+    if (collectionEntries.length <= 0) {
+      return;
+    }
+
+    this.ctx.writeToStdout(` ${clc.yellow(`- ${title}`)}:\n`);
+    collectionEntries.forEach(provider =>
+      this.ctx.writeToStdout(`  ${clc.green('‚óª')} ${provider}\n`),
+    );
+  }
+}
diff --git a/packages/core/repl/native-functions/get-relp-fn.ts b/packages/core/repl/native-functions/get-relp-fn.ts
new file mode 100644
index 000000000..6de276918
--- /dev/null
+++ b/packages/core/repl/native-functions/get-relp-fn.ts
@@ -0,0 +1,17 @@
+import type { Type } from '@nestjs/common';
+import { ReplFunction } from '../repl-function';
+import type { ReplFnDefinition } from '../repl.interfaces';
+
+export class GetReplFn extends ReplFunction {
+  public fnDefinition: ReplFnDefinition = {
+    name: 'get',
+    signature: '(token: InjectionToken) => any',
+    description:
+      'Retrieves an instance of either injectable or controller, otherwise, throws exception.',
+    aliases: ['$'],
+  };
+
+  action(token: string | symbol | Function | Type<any>): any {
+    return this.ctx.app.get(token);
+  }
+}
diff --git a/packages/core/repl/native-functions/help-repl-fn.ts b/packages/core/repl/native-functions/help-repl-fn.ts
new file mode 100644
index 000000000..913ced7ee
--- /dev/null
+++ b/packages/core/repl/native-functions/help-repl-fn.ts
@@ -0,0 +1,32 @@
+import { iterate } from 'iterare';
+import { clc } from '@nestjs/common/utils/cli-colors.util';
+import { ReplFunction } from '../repl-function';
+import type { ReplFnDefinition } from '../repl.interfaces';
+
+export class HelpReplFn extends ReplFunction {
+  public fnDefinition: ReplFnDefinition = {
+    name: 'help',
+    signature: '() => void',
+    description: 'Display all available REPL native functions.',
+  };
+
+  static buildHelpMessage = ({ name, description }: ReplFnDefinition) =>
+    clc.cyanBright(name) +
+    (description ? ` ${clc.bold('-')} ${description}` : '');
+
+  action(): void {
+    const sortedNativeFunctions = iterate(this.ctx.nativeFunctions)
+      .map(([, nativeFunction]) => nativeFunction.fnDefinition)
+      .toArray()
+      .sort((a, b) => (a.name < b.name ? -1 : 1));
+
+    this.ctx.writeToStdout(
+      `You can call ${clc.bold(
+        '.help',
+      )} on any function listed below (e.g.: ${clc.bold('help.help')}):\n\n` +
+        sortedNativeFunctions.map(HelpReplFn.buildHelpMessage).join('\n') +
+        // Without the following LF the last item won't be displayed
+        '\n',
+    );
+  }
+}
diff --git a/packages/core/repl/native-functions/index.ts b/packages/core/repl/native-functions/index.ts
new file mode 100644
index 000000000..8799e685d
--- /dev/null
+++ b/packages/core/repl/native-functions/index.ts
@@ -0,0 +1,6 @@
+export * from './help-repl-fn';
+export * from './get-relp-fn';
+export * from './resolve-repl-fn';
+export * from './select-relp-fn';
+export * from './debug-repl-fn';
+export * from './methods-repl-fn';
diff --git a/packages/core/repl/native-functions/methods-repl-fn.ts b/packages/core/repl/native-functions/methods-repl-fn.ts
new file mode 100644
index 000000000..f44e1916e
--- /dev/null
+++ b/packages/core/repl/native-functions/methods-repl-fn.ts
@@ -0,0 +1,32 @@
+import type { Type } from '@nestjs/common';
+import { clc } from '@nestjs/common/utils/cli-colors.util';
+import { MetadataScanner } from '../../metadata-scanner';
+import { ReplFunction } from '../repl-function';
+import type { ReplFnDefinition } from '../repl.interfaces';
+
+export class MethodsReplFn extends ReplFunction {
+  public fnDefinition: ReplFnDefinition = {
+    name: 'methods',
+    description:
+      'Display all public methods available on a given provider or controller.',
+    signature: '(token: ClassRef | string) => void',
+  };
+
+  private readonly metadataScanner = new MetadataScanner();
+
+  action(token: Type<unknown> | string): void {
+    const proto =
+      typeof token !== 'function'
+        ? Object.getPrototypeOf(this.ctx.app.get(token))
+        : token?.prototype;
+
+    const methods = this.metadataScanner.getAllMethodNames(proto);
+
+    this.ctx.writeToStdout('\n');
+    this.ctx.writeToStdout(`${clc.green('Methods')}:\n`);
+    methods.forEach(methodName =>
+      this.ctx.writeToStdout(` ${clc.yellow('‚óª')} ${methodName}\n`),
+    );
+    this.ctx.writeToStdout('\n');
+  }
+}
diff --git a/packages/core/repl/native-functions/resolve-repl-fn.ts b/packages/core/repl/native-functions/resolve-repl-fn.ts
new file mode 100644
index 000000000..fe587682d
--- /dev/null
+++ b/packages/core/repl/native-functions/resolve-repl-fn.ts
@@ -0,0 +1,19 @@
+import type { Type } from '@nestjs/common';
+import { ReplFunction } from '../repl-function';
+import type { ReplFnDefinition } from '../repl.interfaces';
+
+export class ResolveReplFn extends ReplFunction {
+  public fnDefinition: ReplFnDefinition = {
+    name: 'resolve',
+    description:
+      'Resolves transient or request-scoped instance of either injectable or controller, otherwise, throws exception.',
+    signature: '(token: InjectionToken, contextId: any) => Promise<any>',
+  };
+
+  action(
+    token: string | symbol | Function | Type<any>,
+    contextId: any,
+  ): Promise<any> {
+    return this.ctx.app.resolve(token, contextId);
+  }
+}
diff --git a/packages/core/repl/native-functions/select-relp-fn.ts b/packages/core/repl/native-functions/select-relp-fn.ts
new file mode 100644
index 000000000..f35346cd1
--- /dev/null
+++ b/packages/core/repl/native-functions/select-relp-fn.ts
@@ -0,0 +1,20 @@
+import type {
+  DynamicModule,
+  INestApplicationContext,
+  Type,
+} from '@nestjs/common';
+import { ReplFunction } from '../repl-function';
+import type { ReplFnDefinition } from '../repl.interfaces';
+
+export class SelectReplFn extends ReplFunction {
+  public fnDefinition: ReplFnDefinition = {
+    name: 'select',
+    description:
+      'Allows navigating through the modules tree, for example, to pull out a specific instance from the selected module.',
+    signature: '(token: DynamicModule | ClassRef) => INestApplicationContext',
+  };
+
+  action(token: DynamicModule | Type<unknown>): INestApplicationContext {
+    return this.ctx.app.select(token);
+  }
+}
diff --git a/packages/core/repl/repl-context.ts b/packages/core/repl/repl-context.ts
new file mode 100644
index 000000000..e3f71b44f
--- /dev/null
+++ b/packages/core/repl/repl-context.ts
@@ -0,0 +1,186 @@
+import {
+  INestApplicationContext,
+  InjectionToken,
+  Logger,
+} from '@nestjs/common';
+import { ApplicationConfig } from '../application-config';
+import { ModuleRef, NestContainer } from '../injector';
+import { InternalCoreModule } from '../injector/internal-core-module/internal-core-module';
+import { Module } from '../injector/module';
+import {
+  DebugReplFn,
+  GetReplFn,
+  HelpReplFn,
+  MethodsReplFn,
+  ResolveReplFn,
+  SelectReplFn,
+} from './native-functions';
+import { ReplFunction } from './repl-function';
+import type { ReplFunctionClass } from './repl.interfaces';
+
+type ModuleKey = string;
+export type ModuleDebugEntry = {
+  controllers: Record<string, InjectionToken>;
+  providers: Record<string, InjectionToken>;
+};
+
+type ReplScope = Record<string, any>;
+
+export class ReplContext {
+  public readonly logger = new Logger(ReplContext.name);
+  public debugRegistry: Record<ModuleKey, ModuleDebugEntry> = {};
+  public readonly globalScope: ReplScope = Object.create(null);
+  public readonly nativeFunctions = new Map<
+    string,
+    InstanceType<ReplFunctionClass>
+  >();
+  private readonly container: NestContainer;
+
+  constructor(
+    public readonly app: INestApplicationContext,
+    nativeFunctionsClassRefs?: ReplFunctionClass[],
+  ) {
+    this.container = (app as any).container; // Using `any` because `app.container` is not public.
+
+    this.initializeContext();
+    this.initializeNativeFunctions(nativeFunctionsClassRefs || []);
+  }
+
+  public writeToStdout(text: string) {
+    process.stdout.write(text);
+  }
+
+  private initializeContext() {
+    const modules = this.container.getModules();
+
+    modules.forEach(moduleRef => {
+      let moduleName = moduleRef.metatype.name;
+      if (moduleName === InternalCoreModule.name) {
+        return;
+      }
+      if (this.globalScope[moduleName]) {
+        moduleName += ` (${moduleRef.token})`;
+      }
+
+      this.introspectCollection(moduleRef, moduleName, 'providers');
+      this.introspectCollection(moduleRef, moduleName, 'controllers');
+
+      // For in REPL auto-complete functionality
+      Object.defineProperty(this.globalScope, moduleName, {
+        value: moduleRef.metatype,
+        configurable: false,
+        enumerable: true,
+      });
+    });
+  }
+
+  private introspectCollection(
+    moduleRef: Module,
+    moduleKey: ModuleKey,
+    collection: keyof ModuleDebugEntry,
+  ) {
+    const moduleDebugEntry = {};
+    moduleRef[collection].forEach(({ token }) => {
+      const stringifiedToken = this.stringifyToken(token);
+      if (
+        stringifiedToken === ApplicationConfig.name ||
+        stringifiedToken === moduleRef.metatype.name
+      ) {
+        return;
+      }
+
+      if (!this.globalScope[stringifiedToken]) {
+        // For in REPL auto-complete functionality
+        Object.defineProperty(this.globalScope, stringifiedToken, {
+          value: token,
+          configurable: false,
+          enumerable: true,
+        });
+      }
+
+      if (stringifiedToken === ModuleRef.name) {
+        return;
+      }
+
+      moduleDebugEntry[stringifiedToken] = token;
+    });
+
+    this.debugRegistry[moduleKey] = {
+      ...this.debugRegistry?.[moduleKey],
+      [collection]: moduleDebugEntry,
+    };
+  }
+
+  private stringifyToken(token: unknown): string {
+    return typeof token !== 'string'
+      ? typeof token === 'function'
+        ? token.name
+        : token?.toString()
+      : `"${token}"`;
+  }
+
+  private addNativeFunction(
+    NativeFunctionRef: ReplFunctionClass,
+  ): InstanceType<ReplFunctionClass>[] {
+    const nativeFunction = new NativeFunctionRef(this);
+    const nativeFunctions = [nativeFunction];
+
+    this.nativeFunctions.set(nativeFunction.fnDefinition.name, nativeFunction);
+
+    nativeFunction.fnDefinition.aliases?.forEach(aliasName => {
+      const aliasNativeFunction: InstanceType<ReplFunctionClass> =
+        Object.create(nativeFunction);
+      aliasNativeFunction.fnDefinition = {
+        name: aliasName,
+        description: aliasNativeFunction.fnDefinition.description,
+        signature: aliasNativeFunction.fnDefinition.signature,
+      };
+      this.nativeFunctions.set(aliasName, aliasNativeFunction);
+      nativeFunctions.push(aliasNativeFunction);
+    });
+
+    return nativeFunctions;
+  }
+
+  private registerFunctionIntoGlobalScope(
+    nativeFunction: InstanceType<ReplFunctionClass>,
+  ) {
+    // Bind the method to REPL's context:
+    this.globalScope[nativeFunction.fnDefinition.name] =
+      nativeFunction.action.bind(nativeFunction);
+
+    // Load the help trigger as a `help` getter on each native function:
+    const functionBoundRef: ReplFunction['action'] =
+      this.globalScope[nativeFunction.fnDefinition.name];
+    Object.defineProperty(functionBoundRef, 'help', {
+      enumerable: false,
+      configurable: false,
+      get: () =>
+        // Dynamically builds the help message as will unlikely to be called
+        // several times.
+        this.writeToStdout(nativeFunction.makeHelpMessage()),
+    });
+  }
+
+  private initializeNativeFunctions(
+    nativeFunctionsClassRefs: ReplFunctionClass[],
+  ): void {
+    const builtInFunctionsClassRefs: ReplFunctionClass[] = [
+      HelpReplFn,
+      GetReplFn,
+      ResolveReplFn,
+      SelectReplFn,
+      DebugReplFn,
+      MethodsReplFn,
+    ];
+
+    builtInFunctionsClassRefs
+      .concat(nativeFunctionsClassRefs)
+      .forEach(NativeFunction => {
+        const nativeFunctions = this.addNativeFunction(NativeFunction);
+        nativeFunctions.forEach(nativeFunction => {
+          this.registerFunctionIntoGlobalScope(nativeFunction);
+        });
+      });
+  }
+}
diff --git a/packages/core/repl/repl-function.ts b/packages/core/repl/repl-function.ts
new file mode 100644
index 000000000..aa90972c8
--- /dev/null
+++ b/packages/core/repl/repl-function.ts
@@ -0,0 +1,36 @@
+import { Logger } from '@nestjs/common';
+import { clc } from '@nestjs/common/utils/cli-colors.util';
+import { ReplContext } from './repl-context';
+import type { ReplFnDefinition } from './repl.interfaces';
+
+export abstract class ReplFunction<
+  ActionParams extends Array<unknown> = Array<unknown>,
+  ActionReturn = any,
+> {
+  /** Metadata that describes the built-in function itself. */
+  public abstract fnDefinition: ReplFnDefinition;
+
+  protected readonly logger: Logger;
+
+  constructor(protected readonly ctx: ReplContext) {
+    this.logger = ctx.logger;
+  }
+
+  /**
+   * Method called when the function is invoked from the REPL by the user.
+   */
+  abstract action(...args: ActionParams): ActionReturn;
+
+  /**
+   * @returns A message displayed by calling `<fnName>.help`
+   */
+  public makeHelpMessage(): string {
+    const { description, name, signature } = this.fnDefinition;
+
+    const fnSignatureWithName = `${name}${signature}`;
+
+    return `${clc.yellow(description)}\n${clc.magentaBright(
+      'Interface:',
+    )} ${clc.bold(fnSignatureWithName)}\n`;
+  }
+}
diff --git a/packages/core/repl/repl-logger.ts b/packages/core/repl/repl-logger.ts
new file mode 100644
index 000000000..afaa04316
--- /dev/null
+++ b/packages/core/repl/repl-logger.ts
@@ -0,0 +1,20 @@
+import { ConsoleLogger } from '@nestjs/common';
+import { NestApplication } from '../nest-application';
+import { RouterExplorer } from '../router/router-explorer';
+import { RoutesResolver } from '../router/routes-resolver';
+
+export class ReplLogger extends ConsoleLogger {
+  private static readonly ignoredContexts = [
+    RoutesResolver.name,
+    RouterExplorer.name,
+    NestApplication.name,
+  ];
+
+  log(_message: any, context?: string) {
+    if (ReplLogger.ignoredContexts.includes(context)) {
+      return;
+    }
+    // eslint-disable-next-line
+    return super.log.apply(this, Array.from(arguments) as [any, string?]);
+  }
+}
diff --git a/packages/core/repl/repl-native-commands.ts b/packages/core/repl/repl-native-commands.ts
new file mode 100644
index 000000000..5cee6d9ff
--- /dev/null
+++ b/packages/core/repl/repl-native-commands.ts
@@ -0,0 +1,50 @@
+import type { REPLServer } from 'repl';
+
+/**
+ * Displays a list of available commands in the REPL alongside with their
+ * descriptions.
+ * (c) This code was inspired by the 'help' command from Node.js core:
+ * {@link https://github.com/nodejs/node/blob/58b60c1393dd65cd228a8b0084a19acd2c1d16aa/lib/repl.js#L1741-L1759}
+ */
+function listAllCommands(replServer: REPLServer) {
+  Object.keys(replServer.commands)
+    .sort()
+    .forEach(name => {
+      const cmd = replServer.commands[name];
+      if (cmd) {
+        replServer.output.write(`${name}\t${cmd.help || ''}\n`);
+      }
+    });
+}
+
+export function defineDefaultCommandsOnRepl(replServer: REPLServer): void {
+  replServer.defineCommand('help', {
+    help: 'Show REPL options',
+    action(name?: string) {
+      this.clearBufferedCommand();
+
+      if (name) {
+        // Considering native commands before native nestjs injected functions.
+        const nativeCommandOrFunction =
+          this.commands[name] || this.context[name];
+        // NOTE: If the command was retrieve from the context, it will have a `help`
+        // getter property that outputs the helper message and returns undefined.
+        // But if the command was retrieve from the `commands` object, it will
+        // have a `help` property that returns the helper message.
+        const helpMessage = nativeCommandOrFunction?.help;
+        if (helpMessage) {
+          this.output.write(`${helpMessage}\n`);
+        }
+      } else {
+        listAllCommands(this);
+        this.output.write('\n\n');
+        this.context.help();
+        this.output.write(
+          '\nPress Ctrl+C to abort current expression, Ctrl+D to exit the REPL\n',
+        );
+      }
+
+      this.displayPrompt();
+    },
+  });
+}
diff --git a/packages/core/repl/repl.interfaces.ts b/packages/core/repl/repl.interfaces.ts
new file mode 100644
index 000000000..ad4b8fd64
--- /dev/null
+++ b/packages/core/repl/repl.interfaces.ts
@@ -0,0 +1,21 @@
+import type { ReplContext } from './repl-context';
+import type { ReplFunction } from './repl-function';
+
+export type ReplFnDefinition = {
+  /** Function's name. Note that this should be a valid JavaScript function name. */
+  name: string;
+
+  /** Alternative names to the function. */
+  aliases?: ReplFnDefinition['name'][];
+
+  /** Function's description to display when `<function>.help` is entered. */
+  description: string;
+
+  /**
+   * Function's signature following TypeScript _function type expression_ syntax.
+   * @example '(token: InjectionToken) => any'
+   */
+  signature: string;
+};
+
+export type ReplFunctionClass = new (replContext: ReplContext) => ReplFunction;
diff --git a/packages/core/repl/repl.ts b/packages/core/repl/repl.ts
new file mode 100644
index 000000000..2e021a1e4
--- /dev/null
+++ b/packages/core/repl/repl.ts
@@ -0,0 +1,30 @@
+import { DynamicModule, Logger, Type } from '@nestjs/common';
+import { clc } from '@nestjs/common/utils/cli-colors.util';
+import { NestFactory } from '../nest-factory';
+import { assignToObject } from './assign-to-object.util';
+import { REPL_INITIALIZED_MESSAGE } from './constants';
+import { ReplContext } from './repl-context';
+import { ReplLogger } from './repl-logger';
+import { defineDefaultCommandsOnRepl } from './repl-native-commands';
+
+export async function repl(module: Type | DynamicModule) {
+  const app = await NestFactory.createApplicationContext(module, {
+    abortOnError: false,
+    logger: new ReplLogger(),
+  });
+  await app.init();
+
+  const replContext = new ReplContext(app);
+  Logger.log(REPL_INITIALIZED_MESSAGE);
+
+  const _repl = await import('repl');
+  const replServer = _repl.start({
+    prompt: clc.green('> '),
+    ignoreUndefined: true,
+  });
+  assignToObject(replServer.context, replContext.globalScope);
+
+  defineDefaultCommandsOnRepl(replServer);
+
+  return replServer;
+}
diff --git a/packages/core/router/interfaces/exclude-route-metadata.interface.ts b/packages/core/router/interfaces/exclude-route-metadata.interface.ts
index 1c143512f..b7f93b600 100644
--- a/packages/core/router/interfaces/exclude-route-metadata.interface.ts
+++ b/packages/core/router/interfaces/exclude-route-metadata.interface.ts
@@ -1,6 +1,11 @@
 import { RequestMethod } from '@nestjs/common';
 
 export interface ExcludeRouteMetadata {
+  /**
+   * Route path.
+   */
+  path: string;
+
   /**
    * Regular expression representing the route path.
    */
diff --git a/packages/core/router/paths-explorer.ts b/packages/core/router/paths-explorer.ts
new file mode 100644
index 000000000..34c9972eb
--- /dev/null
+++ b/packages/core/router/paths-explorer.ts
@@ -0,0 +1,84 @@
+import {
+  METHOD_METADATA,
+  PATH_METADATA,
+  VERSION_METADATA,
+} from '@nestjs/common/constants';
+import { RequestMethod } from '@nestjs/common/enums';
+import { Controller } from '@nestjs/common/interfaces/controllers/controller.interface';
+import { VersionValue } from '@nestjs/common/interfaces/version-options.interface';
+import {
+  addLeadingSlash,
+  isString,
+  isUndefined,
+} from '@nestjs/common/utils/shared.utils';
+import { MetadataScanner } from '../metadata-scanner';
+import { RouterProxyCallback } from './router-proxy';
+
+export interface RouteDefinition {
+  path: string[];
+  requestMethod: RequestMethod;
+  targetCallback: RouterProxyCallback;
+  methodName: string;
+  version?: VersionValue;
+}
+
+export class PathsExplorer {
+  constructor(private readonly metadataScanner: MetadataScanner) {}
+
+  public scanForPaths(
+    instance: Controller,
+    prototype?: object,
+  ): RouteDefinition[] {
+    const instancePrototype = isUndefined(prototype)
+      ? Object.getPrototypeOf(instance)
+      : prototype;
+
+    return this.metadataScanner
+      .getAllMethodNames(instancePrototype)
+      .reduce((acc, method) => {
+        const route = this.exploreMethodMetadata(
+          instance,
+          instancePrototype,
+          method,
+        );
+
+        if (route) {
+          acc.push(route);
+        }
+
+        return acc;
+      }, []);
+  }
+
+  public exploreMethodMetadata(
+    instance: Controller,
+    prototype: object,
+    methodName: string,
+  ): RouteDefinition | null {
+    const instanceCallback = instance[methodName];
+    const prototypeCallback = prototype[methodName];
+    const routePath = Reflect.getMetadata(PATH_METADATA, prototypeCallback);
+    if (isUndefined(routePath)) {
+      return null;
+    }
+    const requestMethod: RequestMethod = Reflect.getMetadata(
+      METHOD_METADATA,
+      prototypeCallback,
+    );
+    const version: VersionValue | undefined = Reflect.getMetadata(
+      VERSION_METADATA,
+      prototypeCallback,
+    );
+    const path = isString(routePath)
+      ? [addLeadingSlash(routePath)]
+      : routePath.map((p: string) => addLeadingSlash(p));
+
+    return {
+      path,
+      requestMethod,
+      targetCallback: instanceCallback,
+      methodName,
+      version,
+    };
+  }
+}
diff --git a/packages/core/router/route-path-factory.ts b/packages/core/router/route-path-factory.ts
index e53a35b95..78b674161 100644
--- a/packages/core/router/route-path-factory.ts
+++ b/packages/core/router/route-path-factory.ts
@@ -23,18 +23,30 @@ export class RoutePathFactory {
   ): string[] {
     let paths = [''];
 
-    const version = this.getVersion(metadata);
-    if (version && metadata.versioningOptions?.type === VersioningType.URI) {
+    const versionOrVersions = this.getVersion(metadata);
+    if (
+      versionOrVersions &&
+      metadata.versioningOptions?.type === VersioningType.URI
+    ) {
       const versionPrefix = this.getVersionPrefix(metadata.versioningOptions);
 
-      // Version Neutral - Do not include version in URL
-      if (version !== VERSION_NEUTRAL) {
-        if (Array.isArray(version)) {
-          paths = flatten(
-            paths.map(path => version.map(v => path + `/${versionPrefix}${v}`)),
+      if (Array.isArray(versionOrVersions)) {
+        paths = flatten(
+          paths.map(path =>
+            versionOrVersions.map(version =>
+              // Version Neutral - Do not include version in URL
+              version === VERSION_NEUTRAL
+                ? path
+                : `${path}/${versionPrefix}${version}`,
+            ),
+          ),
+        );
+      } else {
+        // Version Neutral - Do not include version in URL
+        if (versionOrVersions !== VERSION_NEUTRAL) {
+          paths = paths.map(
+            path => `${path}/${versionPrefix}${versionOrVersions}`,
           );
-        } else {
-          paths = paths.map(path => path + `/${versionPrefix}${version}`);
         }
       }
     }
diff --git a/packages/core/router/router-execution-context.ts b/packages/core/router/router-execution-context.ts
index f971cf2df..9e4fa897b 100644
--- a/packages/core/router/router-execution-context.ts
+++ b/packages/core/router/router-execution-context.ts
@@ -7,7 +7,7 @@ import {
   RequestMethod,
 } from '@nestjs/common';
 import {
-  CUSTOM_ROUTE_AGRS_METADATA,
+  CUSTOM_ROUTE_ARGS_METADATA,
   HEADERS_METADATA,
   HTTP_CODE_METADATA,
   REDIRECT_METADATA,
@@ -21,9 +21,11 @@ import { ContextType, Controller } from '@nestjs/common/interfaces';
 import { isEmpty, isString } from '@nestjs/common/utils/shared.utils';
 import { IncomingMessage } from 'http';
 import { Observable } from 'rxjs';
-import { FORBIDDEN_MESSAGE } from '../guards/constants';
-import { GuardsConsumer } from '../guards/guards-consumer';
-import { GuardsContextCreator } from '../guards/guards-context-creator';
+import {
+  FORBIDDEN_MESSAGE,
+  GuardsConsumer,
+  GuardsContextCreator,
+} from '../guards';
 import { ContextUtils } from '../helpers/context-utils';
 import { ExecutionContextHost } from '../helpers/execution-context-host';
 import {
@@ -297,7 +299,7 @@ export class RouterExecutionContext {
       );
       const type = this.contextUtils.mapParamType(key);
 
-      if (key.includes(CUSTOM_ROUTE_AGRS_METADATA)) {
+      if (key.includes(CUSTOM_ROUTE_ARGS_METADATA)) {
         const { factory } = metadata[key];
         const customExtractValue = this.contextUtils.getCustomFactory(
           factory,
@@ -424,14 +426,14 @@ export class RouterExecutionContext {
         );
       };
     }
-    if (redirectResponse && typeof redirectResponse.url === 'string') {
+    if (redirectResponse && isString(redirectResponse.url)) {
       return async <TResult, TResponse>(result: TResult, res: TResponse) => {
         await this.responseController.redirect(result, res, redirectResponse);
       };
     }
     const isSseHandler = !!this.reflectSse(callback);
     if (isSseHandler) {
-      return async <
+      return <
         TResult extends Observable<unknown> = any,
         TResponse extends HeaderStream = any,
         TRequest extends IncomingMessage = any,
@@ -440,10 +442,11 @@ export class RouterExecutionContext {
         res: TResponse,
         req: TRequest,
       ) => {
-        await this.responseController.sse(
+        this.responseController.sse(
           result,
           (res as any).raw || res,
           (req as any).raw || req,
+          { additionalHeaders: res.getHeaders?.() },
         );
       };
     }
@@ -451,6 +454,7 @@ export class RouterExecutionContext {
       result = await this.responseController.transformToResult(result);
       !isResponseHandled &&
         (await this.responseController.apply(result, res, httpStatusCode));
+      return res;
     };
   }
 
diff --git a/packages/core/router/router-explorer.ts b/packages/core/router/router-explorer.ts
index 153bf29b4..e7bbc6db1 100644
--- a/packages/core/router/router-explorer.ts
+++ b/packages/core/router/router-explorer.ts
@@ -1,29 +1,19 @@
 import { HttpServer } from '@nestjs/common';
-import {
-  METHOD_METADATA,
-  PATH_METADATA,
-  VERSION_METADATA,
-} from '@nestjs/common/constants';
-import { RequestMethod } from '@nestjs/common/enums/request-method.enum';
-import { VersioningType } from '@nestjs/common/enums/version-type.enum';
+import { PATH_METADATA } from '@nestjs/common/constants';
+import { RequestMethod, VersioningType } from '@nestjs/common/enums';
 import { InternalServerErrorException } from '@nestjs/common/exceptions';
 import { Controller } from '@nestjs/common/interfaces/controllers/controller.interface';
 import { Type } from '@nestjs/common/interfaces/type.interface';
-import {
-  VersionValue,
-  VERSION_NEUTRAL,
-} from '@nestjs/common/interfaces/version-options.interface';
+import { VersionValue } from '@nestjs/common/interfaces/version-options.interface';
 import { Logger } from '@nestjs/common/services/logger.service';
 import {
   addLeadingSlash,
-  isString,
   isUndefined,
 } from '@nestjs/common/utils/shared.utils';
 import * as pathToRegexp from 'path-to-regexp';
 import { ApplicationConfig } from '../application-config';
 import { UnknownRequestMappingException } from '../errors/exceptions/unknown-request-mapping.exception';
-import { GuardsConsumer } from '../guards/guards-consumer';
-import { GuardsContextCreator } from '../guards/guards-context-creator';
+import { GuardsConsumer, GuardsContextCreator } from '../guards';
 import { ContextIdFactory } from '../helpers/context-id-factory';
 import { ExecutionContextHost } from '../helpers/execution-context-host';
 import {
@@ -36,13 +26,20 @@ import { NestContainer } from '../injector/container';
 import { Injector } from '../injector/injector';
 import { ContextId, InstanceWrapper } from '../injector/instance-wrapper';
 import { Module } from '../injector/module';
-import { InterceptorsConsumer } from '../interceptors/interceptors-consumer';
-import { InterceptorsContextCreator } from '../interceptors/interceptors-context-creator';
+import {
+  InterceptorsConsumer,
+  InterceptorsContextCreator,
+} from '../interceptors';
+import { GraphInspector } from '../inspector/graph-inspector';
+import {
+  Entrypoint,
+  HttpEntrypointMetadata,
+} from '../inspector/interfaces/entrypoint.interface';
 import { MetadataScanner } from '../metadata-scanner';
-import { PipesConsumer } from '../pipes/pipes-consumer';
-import { PipesContextCreator } from '../pipes/pipes-context-creator';
+import { PipesConsumer, PipesContextCreator } from '../pipes';
 import { ExceptionsFilter } from './interfaces/exceptions-filter.interface';
 import { RoutePathMetadata } from './interfaces/route-path-metadata.interface';
+import { PathsExplorer } from './paths-explorer';
 import { REQUEST_CONTEXT_ID } from './request/request-constants';
 import { RouteParamsFactory } from './route-params-factory';
 import { RoutePathFactory } from './route-path-factory';
@@ -59,6 +56,7 @@ export interface RouteDefinition {
 
 export class RouterExplorer {
   private readonly executionContextCreator: RouterExecutionContext;
+  private readonly pathsExplorer: PathsExplorer;
   private readonly routerMethodFactory = new RouterMethodFactory();
   private readonly logger = new Logger(RouterExplorer.name, {
     timestamp: true,
@@ -66,14 +64,17 @@ export class RouterExplorer {
   private readonly exceptionFiltersCache = new WeakMap();
 
   constructor(
-    private readonly metadataScanner: MetadataScanner,
+    metadataScanner: MetadataScanner,
     private readonly container: NestContainer,
-    private readonly injector?: Injector,
-    private readonly routerProxy?: RouterProxy,
-    private readonly exceptionsFilter?: ExceptionsFilter,
-    private readonly config?: ApplicationConfig,
-    private readonly routePathFactory?: RoutePathFactory,
+    private readonly injector: Injector,
+    private readonly routerProxy: RouterProxy,
+    private readonly exceptionsFilter: ExceptionsFilter,
+    config: ApplicationConfig,
+    private readonly routePathFactory: RoutePathFactory,
+    private readonly graphInspector: GraphInspector,
   ) {
+    this.pathsExplorer = new PathsExplorer(metadataScanner);
+
     const routeParamsFactory = new RouteParamsFactory();
     const pipesContextCreator = new PipesContextCreator(container, config);
     const pipesConsumer = new PipesConsumer();
@@ -105,7 +106,7 @@ export class RouterExplorer {
     routePathMetadata: RoutePathMetadata,
   ) {
     const { instance } = instanceWrapper;
-    const routerPaths = this.scanForPaths(instance);
+    const routerPaths = this.pathsExplorer.scanForPaths(instance);
     this.applyPathsToRouterProxy(
       applicationRef,
       routerPaths,
@@ -120,7 +121,7 @@ export class RouterExplorer {
     const path = Reflect.getMetadata(PATH_METADATA, metatype);
 
     if (isUndefined(path)) {
-      throw new UnknownRequestMappingException();
+      throw new UnknownRequestMappingException(metatype);
     }
     if (Array.isArray(path)) {
       return path.map(p => addLeadingSlash(p));
@@ -128,53 +129,6 @@ export class RouterExplorer {
     return [addLeadingSlash(path)];
   }
 
-  public scanForPaths(
-    instance: Controller,
-    prototype?: object,
-  ): RouteDefinition[] {
-    const instancePrototype = isUndefined(prototype)
-      ? Object.getPrototypeOf(instance)
-      : prototype;
-
-    return this.metadataScanner.scanFromPrototype<Controller, RouteDefinition>(
-      instance,
-      instancePrototype,
-      method => this.exploreMethodMetadata(instance, instancePrototype, method),
-    );
-  }
-
-  public exploreMethodMetadata(
-    instance: Controller,
-    prototype: object,
-    methodName: string,
-  ): RouteDefinition {
-    const instanceCallback = instance[methodName];
-    const prototypeCallback = prototype[methodName];
-    const routePath = Reflect.getMetadata(PATH_METADATA, prototypeCallback);
-    if (isUndefined(routePath)) {
-      return null;
-    }
-    const requestMethod: RequestMethod = Reflect.getMetadata(
-      METHOD_METADATA,
-      prototypeCallback,
-    );
-    const version: VersionValue | undefined = Reflect.getMetadata(
-      VERSION_METADATA,
-      prototypeCallback,
-    );
-    const path = isString(routePath)
-      ? [addLeadingSlash(routePath)]
-      : routePath.map((p: string) => addLeadingSlash(p));
-
-    return {
-      path,
-      requestMethod,
-      targetCallback: instanceCallback,
-      methodName,
-      version,
-    };
-  }
-
   public applyPathsToRouterProxy<T extends HttpServer>(
     router: T,
     routeDefinitions: RouteDefinition[],
@@ -259,7 +213,31 @@ export class RouterExplorer {
         routePathMetadata,
         requestMethod,
       );
-      pathsToRegister.forEach(path => routerMethodRef(path, routeHandler));
+      pathsToRegister.forEach(path => {
+        const entrypointDefinition: Entrypoint<HttpEntrypointMetadata> = {
+          type: 'http-endpoint',
+          methodName,
+          className: instanceWrapper.name,
+          classNodeId: instanceWrapper.id,
+          metadata: {
+            key: path,
+            path,
+            requestMethod: RequestMethod[
+              requestMethod
+            ] as keyof typeof RequestMethod,
+            methodVersion: routePathMetadata.methodVersion as VersionValue,
+            controllerVersion:
+              routePathMetadata.controllerVersion as VersionValue,
+          },
+        };
+
+        routerMethodRef(path, routeHandler);
+
+        this.graphInspector.insertEntrypointDefinition<HttpEntrypointMetadata>(
+          entrypointDefinition,
+          instanceWrapper.id,
+        );
+      });
 
       const pathsToLog = this.routePathFactory.create(
         {
@@ -314,7 +292,13 @@ export class RouterExplorer {
       for (const exp of hostRegExps) {
         const match = hostname.match(exp.regexp);
         if (match) {
-          exp.keys.forEach((key, i) => (req.hosts[key.name] = match[i + 1]));
+          if (exp.keys.length > 0) {
+            exp.keys.forEach((key, i) => (req.hosts[key.name] = match[i + 1]));
+          } else if (exp.regexp && match.groups) {
+            for (const groupName in match.groups) {
+              req.hosts[groupName] = match.groups[groupName];
+            }
+          }
           return handler(req, res, next);
         }
       }
@@ -332,80 +316,12 @@ export class RouterExplorer {
     routePathMetadata: RoutePathMetadata,
     handler: Function,
   ) {
-    const { versioningOptions } = routePathMetadata;
     const version = this.routePathFactory.getVersion(routePathMetadata);
-    if (router?.applyVersionFilter) {
-      return router.applyVersionFilter(handler, version, versioningOptions);
-    }
-    /**
-     * This can be removed in the next major release.
-     * Left for backward-compatibility.
-     */
-    return <TRequest extends Record<string, any> = any, TResponse = any>(
-      req: TRequest,
-      res: TResponse,
-      next: () => void,
-    ) => {
-      if (version === VERSION_NEUTRAL) {
-        return handler(req, res, next);
-      }
-      // URL Versioning is done via the path, so the filter continues forward
-      if (versioningOptions.type === VersioningType.URI) {
-        return handler(req, res, next);
-      }
-      // Media Type (Accept Header) Versioning Handler
-      if (versioningOptions.type === VersioningType.MEDIA_TYPE) {
-        const MEDIA_TYPE_HEADER = 'Accept';
-        const acceptHeaderValue: string | undefined =
-          req.headers?.[MEDIA_TYPE_HEADER] ||
-          req.headers?.[MEDIA_TYPE_HEADER.toLowerCase()];
-
-        const acceptHeaderVersionParameter = acceptHeaderValue
-          ? acceptHeaderValue.split(';')[1]
-          : '';
-
-        if (acceptHeaderVersionParameter) {
-          const headerVersion = acceptHeaderVersionParameter.split(
-            versioningOptions.key,
-          )[1];
-
-          if (Array.isArray(version)) {
-            if (version.includes(headerVersion)) {
-              return handler(req, res, next);
-            }
-          } else if (isString(version)) {
-            if (version === headerVersion) {
-              return handler(req, res, next);
-            }
-          }
-        }
-      }
-      // Header Versioning Handler
-      else if (versioningOptions.type === VersioningType.HEADER) {
-        const customHeaderVersionParameter: string | undefined =
-          req.headers?.[versioningOptions.header] ||
-          req.headers?.[versioningOptions.header.toLowerCase()];
-
-        if (customHeaderVersionParameter) {
-          if (Array.isArray(version)) {
-            if (version.includes(customHeaderVersionParameter)) {
-              return handler(req, res, next);
-            }
-          } else if (isString(version)) {
-            if (version === customHeaderVersionParameter) {
-              return handler(req, res, next);
-            }
-          }
-        }
-      }
-
-      if (!next) {
-        throw new InternalServerErrorException(
-          'HTTP adapter does not support filtering on version',
-        );
-      }
-      return next();
-    };
+    return router.applyVersionFilter(
+      handler,
+      version,
+      routePathMetadata.versioningOptions,
+    );
   }
 
   private createCallbackProxy(
@@ -445,13 +361,16 @@ export class RouterExplorer {
   ) {
     const { instance } = instanceWrapper;
     const collection = moduleRef.controllers;
+
+    const isTreeDurable = instanceWrapper.isDependencyTreeDurable();
+
     return async <TRequest extends Record<any, any>, TResponse>(
       req: TRequest,
       res: TResponse,
       next: () => void,
     ) => {
       try {
-        const contextId = this.getContextId(req);
+        const contextId = this.getContextId(req, isTreeDurable);
         const contextInstance = await this.injector.loadPerContext(
           instance,
           moduleRef,
@@ -487,6 +406,7 @@ export class RouterExplorer {
 
   private getContextId<T extends Record<any, unknown> = any>(
     request: T,
+    isTreeDurable: boolean,
   ): ContextId {
     const contextId = ContextIdFactory.getByRequest(request);
     if (!request[REQUEST_CONTEXT_ID as any]) {
@@ -496,7 +416,9 @@ export class RouterExplorer {
         writable: false,
         configurable: false,
       });
-      this.container.registerRequestProvider(request, contextId);
+
+      const requestProviderValue = isTreeDurable ? contextId.payload : request;
+      this.container.registerRequestProvider(requestProviderValue, contextId);
     }
     return contextId;
   }
diff --git a/packages/core/router/router-proxy.ts b/packages/core/router/router-proxy.ts
index c1384e545..30087b0c1 100644
--- a/packages/core/router/router-proxy.ts
+++ b/packages/core/router/router-proxy.ts
@@ -22,6 +22,7 @@ export class RouterProxy {
       } catch (e) {
         const host = new ExecutionContextHost([req, res, next]);
         exceptionsHandler.next(e, host);
+        return res;
       }
     };
   }
@@ -46,6 +47,7 @@ export class RouterProxy {
       } catch (e) {
         const host = new ExecutionContextHost([req, res, next]);
         exceptionsHandler.next(e, host);
+        return res;
       }
     };
   }
diff --git a/packages/core/router/router-response-controller.ts b/packages/core/router/router-response-controller.ts
index aab864095..4128e7fca 100644
--- a/packages/core/router/router-response-controller.ts
+++ b/packages/core/router/router-response-controller.ts
@@ -1,9 +1,19 @@
-import { HttpServer, HttpStatus, RequestMethod } from '@nestjs/common';
-import { isFunction, isObject } from '@nestjs/common/utils/shared.utils';
+import {
+  HttpServer,
+  HttpStatus,
+  Logger,
+  RequestMethod,
+  MessageEvent,
+} from '@nestjs/common';
+import { isObject } from '@nestjs/common/utils/shared.utils';
 import { IncomingMessage } from 'http';
-import { lastValueFrom, Observable } from 'rxjs';
-import { debounce } from 'rxjs/operators';
-import { HeaderStream, SseStream } from './sse-stream';
+import { EMPTY, lastValueFrom, Observable, isObservable } from 'rxjs';
+import { catchError, debounce, map } from 'rxjs/operators';
+import {
+  AdditionalHeaders,
+  WritableHeaderStream,
+  SseStream,
+} from './sse-stream';
 
 export interface CustomHeader {
   name: string;
@@ -16,6 +26,8 @@ export interface RedirectResponse {
 }
 
 export class RouterResponseController {
+  private readonly logger = new Logger(RouterResponseController.name);
+
   constructor(private readonly applicationRef: HttpServer) {}
 
   public async apply<TInput = any, TResponse = any>(
@@ -52,7 +64,7 @@ export class RouterResponseController {
   }
 
   public async transformToResult(resultOrDeferred: any) {
-    if (resultOrDeferred && isFunction(resultOrDeferred.subscribe)) {
+    if (isObservable(resultOrDeferred)) {
       return lastValueFrom(resultOrDeferred);
     }
     return resultOrDeferred;
@@ -83,11 +95,16 @@ export class RouterResponseController {
     this.applicationRef.status(response, statusCode);
   }
 
-  public async sse<
+  public sse<
     TInput extends Observable<unknown> = any,
-    TResponse extends HeaderStream = any,
+    TResponse extends WritableHeaderStream = any,
     TRequest extends IncomingMessage = any,
-  >(result: TInput, response: TResponse, request: TRequest) {
+  >(
+    result: TInput,
+    response: TResponse,
+    request: TRequest,
+    options?: { additionalHeaders: AdditionalHeaders },
+  ) {
     // It's possible that we sent headers already so don't use a stream
     if (response.writableEnded) {
       return;
@@ -96,19 +113,33 @@ export class RouterResponseController {
     this.assertObservable(result);
 
     const stream = new SseStream(request);
-    stream.pipe(response);
+    stream.pipe(response, options);
 
     const subscription = result
       .pipe(
+        map((message): MessageEvent => {
+          if (isObject(message)) {
+            return message as MessageEvent;
+          }
+
+          return { data: message as object | string };
+        }),
         debounce(
-          (message: any) =>
-            new Promise(resolve => {
-              if (!isObject(message)) {
-                message = { data: message };
-              }
-              stream.writeMessage(message, resolve);
-            }),
+          message =>
+            new Promise<void>(resolve =>
+              stream.writeMessage(message, () => resolve()),
+            ),
         ),
+        catchError(err => {
+          const data = err instanceof Error ? err.message : err;
+          stream.writeMessage({ type: 'error', data }, writeError => {
+            if (writeError) {
+              this.logger.error(writeError);
+            }
+          });
+
+          return EMPTY;
+        }),
       )
       .subscribe({
         complete: () => {
@@ -121,8 +152,8 @@ export class RouterResponseController {
     });
   }
 
-  private assertObservable(result: any) {
-    if (!isFunction(result.subscribe)) {
+  private assertObservable(value: any) {
+    if (!isObservable(value)) {
       throw new ReferenceError(
         'You must return an Observable stream to use Server-Sent Events (SSE).',
       );
diff --git a/packages/core/router/routes-resolver.ts b/packages/core/router/routes-resolver.ts
index f342df916..e03ade389 100644
--- a/packages/core/router/routes-resolver.ts
+++ b/packages/core/router/routes-resolver.ts
@@ -4,9 +4,12 @@ import {
   MODULE_PATH,
   VERSION_METADATA,
 } from '@nestjs/common/constants';
-import { HttpServer, Type } from '@nestjs/common/interfaces';
-import { Controller } from '@nestjs/common/interfaces/controllers/controller.interface';
-import { VersionValue } from '@nestjs/common/interfaces/version-options.interface';
+import {
+  Controller,
+  HttpServer,
+  Type,
+  VersionValue,
+} from '@nestjs/common/interfaces';
 import { Logger } from '@nestjs/common/services/logger.service';
 import { ApplicationConfig } from '../application-config';
 import {
@@ -16,6 +19,7 @@ import {
 import { NestContainer } from '../injector/container';
 import { Injector } from '../injector/injector';
 import { InstanceWrapper } from '../injector/instance-wrapper';
+import { GraphInspector } from '../inspector/graph-inspector';
 import { MetadataScanner } from '../metadata-scanner';
 import { Resolver } from './interfaces/resolver.interface';
 import { RoutePathMetadata } from './interfaces/route-path-metadata.interface';
@@ -37,6 +41,7 @@ export class RoutesResolver implements Resolver {
     private readonly container: NestContainer,
     private readonly applicationConfig: ApplicationConfig,
     private readonly injector: Injector,
+    graphInspector: GraphInspector,
   ) {
     const httpAdapterRef = container.getHttpAdapterRef();
     this.routerExceptionsFilter = new RouterExceptionFilters(
@@ -55,6 +60,7 @@ export class RoutesResolver implements Resolver {
       this.routerExceptionsFilter,
       this.applicationConfig,
       this.routePathFactory,
+      graphInspector,
     );
   }
 
@@ -174,7 +180,10 @@ export class RoutesResolver implements Resolver {
 
   public mapExternalException(err: any) {
     switch (true) {
-      case err instanceof SyntaxError:
+      // SyntaxError is thrown by Express body-parser when given invalid JSON (#422, #430)
+      // URIError is thrown by Express when given a path parameter with an invalid percentage
+      // encoding, e.g. '%FF' (#8915)
+      case err instanceof SyntaxError || err instanceof URIError:
         return new BadRequestException(err.message);
       default:
         return err;
diff --git a/packages/core/router/sse-stream.ts b/packages/core/router/sse-stream.ts
index 489b7bc67..3bf666c03 100644
--- a/packages/core/router/sse-stream.ts
+++ b/packages/core/router/sse-stream.ts
@@ -1,9 +1,10 @@
 import { MessageEvent } from '@nestjs/common/interfaces';
+import { isObject } from '@nestjs/common/utils/shared.utils';
 import { IncomingMessage, OutgoingHttpHeaders } from 'http';
 import { Transform } from 'stream';
 
 function toDataString(data: string | object): string {
-  if (typeof data === 'object') {
+  if (isObject(data)) {
     return toDataString(JSON.stringify(data));
   }
 
@@ -13,6 +14,15 @@ function toDataString(data: string | object): string {
     .join('');
 }
 
+export type AdditionalHeaders = Record<
+  string,
+  string[] | string | number | undefined
+>;
+
+interface ReadHeaders {
+  getHeaders?(): AdditionalHeaders;
+}
+
 interface WriteHeaders {
   writableEnded?: boolean;
   writeHead?(
@@ -24,7 +34,8 @@ interface WriteHeaders {
   flushHeaders?(): void;
 }
 
-export type HeaderStream = NodeJS.WritableStream & WriteHeaders;
+export type WritableHeaderStream = NodeJS.WritableStream & WriteHeaders;
+export type HeaderStream = WritableHeaderStream & ReadHeaders;
 
 /**
  * Adapted from https://raw.githubusercontent.com/EventSource/node-ssestream
@@ -51,9 +62,16 @@ export class SseStream extends Transform {
     }
   }
 
-  pipe<T extends HeaderStream>(destination: T, options?: { end?: boolean }): T {
+  pipe<T extends WritableHeaderStream>(
+    destination: T,
+    options?: {
+      additionalHeaders?: AdditionalHeaders;
+      end?: boolean;
+    },
+  ): T {
     if (destination.writeHead) {
       destination.writeHead(200, {
+        ...options?.additionalHeaders,
         // See https://github.com/dunglas/mercure/blob/master/hub/subscribe.go#L124-L130
         'Content-Type': 'text/event-stream',
         Connection: 'keep-alive',
@@ -68,7 +86,7 @@ export class SseStream extends Transform {
       destination.flushHeaders();
     }
 
-    destination.write(':\n');
+    destination.write('\n');
     return super.pipe(destination, options);
   }
 
diff --git a/packages/core/router/utils/exclude-route.util.ts b/packages/core/router/utils/exclude-route.util.ts
index 798260bf2..8670f18f4 100644
--- a/packages/core/router/utils/exclude-route.util.ts
+++ b/packages/core/router/utils/exclude-route.util.ts
@@ -1,4 +1,5 @@
 import { RequestMethod } from '@nestjs/common';
+import { addLeadingSlash } from '@nestjs/common/utils/shared.utils';
 import { ExcludeRouteMetadata } from '../interfaces/exclude-route-metadata.interface';
 
 export const isRequestMethodAll = (method: RequestMethod) => {
@@ -15,7 +16,7 @@ export function isRouteExcluded(
       isRequestMethodAll(route.requestMethod) ||
       route.requestMethod === requestMethod
     ) {
-      return route.pathRegex.exec(path);
+      return route.pathRegex.exec(addLeadingSlash(path));
     }
     return false;
   });
diff --git a/packages/core/router/utils/flatten-route-paths.util.ts b/packages/core/router/utils/flatten-route-paths.util.ts
index 40b843408..cbb411f25 100644
--- a/packages/core/router/utils/flatten-route-paths.util.ts
+++ b/packages/core/router/utils/flatten-route-paths.util.ts
@@ -1,4 +1,4 @@
-import { normalizePath } from '@nestjs/common/utils/shared.utils';
+import { normalizePath, isString } from '@nestjs/common/utils/shared.utils';
 import { Routes } from '../interfaces/routes.interface';
 
 export function flattenRoutePaths(routes: Routes) {
@@ -10,7 +10,7 @@ export function flattenRoutePaths(routes: Routes) {
     if (item.children) {
       const childrenRef = item.children as Routes;
       childrenRef.forEach(child => {
-        if (typeof child !== 'string' && child.path) {
+        if (!isString(child) && child.path) {
           child.path = normalizePath(
             normalizePath(item.path) + normalizePath(child.path),
           );
diff --git a/packages/core/scanner.ts b/packages/core/scanner.ts
index 53300858d..f11f4432e 100644
--- a/packages/core/scanner.ts
+++ b/packages/core/scanner.ts
@@ -1,13 +1,12 @@
+import { DynamicModule, ForwardReference, Provider } from '@nestjs/common';
 import {
-  Abstract,
-  DynamicModule,
-  flatten,
-  ForwardReference,
-  Provider,
-} from '@nestjs/common';
-import {
+  CATCH_WATERMARK,
+  CONTROLLER_WATERMARK,
+  EnhancerSubtype,
+  ENHANCER_KEY_TO_SUBTYPE_MAP,
   EXCEPTION_FILTERS_METADATA,
   GUARDS_METADATA,
+  INJECTABLE_WATERMARK,
   INTERCEPTORS_METADATA,
   MODULE_METADATA,
   PIPES_METADATA,
@@ -16,18 +15,18 @@ import {
 import {
   CanActivate,
   ClassProvider,
+  Controller,
   ExceptionFilter,
   ExistingProvider,
   FactoryProvider,
+  Injectable,
+  InjectionToken,
   NestInterceptor,
   PipeTransform,
   Scope,
+  Type,
   ValueProvider,
 } from '@nestjs/common/interfaces';
-import { Controller } from '@nestjs/common/interfaces/controllers/controller.interface';
-import { Injectable } from '@nestjs/common/interfaces/injectable.interface';
-import { Type } from '@nestjs/common/interfaces/type.interface';
-import { randomStringGenerator } from '@nestjs/common/utils/random-string-generator.util';
 import {
   isFunction,
   isNil,
@@ -35,42 +34,33 @@ import {
 } from '@nestjs/common/utils/shared.utils';
 import { iterate } from 'iterare';
 import { ApplicationConfig } from './application-config';
-import { APP_FILTER, APP_GUARD, APP_INTERCEPTOR, APP_PIPE } from './constants';
+import {
+  APP_FILTER,
+  APP_GUARD,
+  APP_INTERCEPTOR,
+  APP_PIPE,
+  ENHANCER_TOKEN_TO_SUBTYPE_MAP,
+} from './constants';
 import { CircularDependencyException } from './errors/exceptions/circular-dependency.exception';
+import { InvalidClassModuleException } from './errors/exceptions/invalid-class-module.exception';
 import { InvalidModuleException } from './errors/exceptions/invalid-module.exception';
 import { UndefinedModuleException } from './errors/exceptions/undefined-module.exception';
 import { getClassScope } from './helpers/get-class-scope';
 import { NestContainer } from './injector/container';
 import { InstanceWrapper } from './injector/instance-wrapper';
-import { InternalCoreModuleFactory } from './injector/internal-core-module-factory';
+import { InternalCoreModuleFactory } from './injector/internal-core-module/internal-core-module-factory';
 import { Module } from './injector/module';
+import { GraphInspector } from './inspector/graph-inspector';
+import { UuidFactory } from './inspector/uuid-factory';
 import { MetadataScanner } from './metadata-scanner';
 
 interface ApplicationProviderWrapper {
   moduleKey: string;
   providerKey: string;
-  type: string | symbol | Type<any> | Abstract<any> | Function;
+  type: InjectionToken;
   scope?: Scope;
 }
 
-export type ModuleDefinition =
-  | ForwardReference
-  | Type<unknown>
-  | DynamicModule
-  | Promise<DynamicModule>;
-
-export interface ModuleToOverride {
-  moduleToReplace: ModuleDefinition;
-  newModule: ModuleDefinition;
-}
-
-interface ModulesScanParamaters {
-  moduleDefinition: ModuleDefinition;
-  scope?: Type<unknown>[];
-  ctxRegistry?: (ForwardReference | DynamicModule | Type<unknown>)[];
-  modulesToOverride?: ModuleToOverride[];
-}
-
 export class DependenciesScanner {
   private readonly applicationProvidersApplyMap: ApplicationProviderWrapper[] =
     [];
@@ -78,12 +68,13 @@ export class DependenciesScanner {
   constructor(
     private readonly container: NestContainer,
     private readonly metadataScanner: MetadataScanner,
+    private readonly graphInspector: GraphInspector,
     private readonly applicationConfig = new ApplicationConfig(),
   ) {}
 
-  public async scan(module: Type<any>, modulesToOverride?: ModuleToOverride[]) {
-    await this.registerCoreModule(modulesToOverride);
-    await this.scanForModules({ moduleDefinition: module, modulesToOverride });
+  public async scan(module: Type<any>) {
+    await this.registerCoreModule();
+    await this.scanForModules(module);
     await this.scanModulesForDependencies();
     this.calculateModulesDistance();
 
@@ -91,20 +82,16 @@ export class DependenciesScanner {
     this.container.bindGlobalScope();
   }
 
-  public async scanForModules({
-    moduleDefinition,
-    scope = [],
-    ctxRegistry = [],
-    modulesToOverride = [],
-  }: ModulesScanParamaters): Promise<Module[]> {
-    const moduleInstance = await this.putModule(
-      moduleDefinition,
-      modulesToOverride,
-      scope,
-    );
-    moduleDefinition =
-      this.getOverrideModuleByModule(moduleDefinition, modulesToOverride)
-        ?.newModule ?? moduleDefinition;
+  public async scanForModules(
+    moduleDefinition:
+      | ForwardReference
+      | Type<unknown>
+      | DynamicModule
+      | Promise<DynamicModule>,
+    scope: Type<unknown>[] = [],
+    ctxRegistry: (ForwardReference | DynamicModule | Type<unknown>)[] = [],
+  ): Promise<Module[]> {
+    const moduleInstance = await this.insertModule(moduleDefinition, scope);
     moduleDefinition =
       moduleDefinition instanceof Promise
         ? await moduleDefinition
@@ -118,13 +105,13 @@ export class DependenciesScanner {
       moduleDefinition as Type<any> | DynamicModule,
     )
       ? this.reflectMetadata(
-          moduleDefinition as Type<any>,
           MODULE_METADATA.IMPORTS,
+          moduleDefinition as Type<any>,
         )
       : [
           ...this.reflectMetadata(
-            (moduleDefinition as DynamicModule).module,
             MODULE_METADATA.IMPORTS,
+            (moduleDefinition as DynamicModule).module,
           ),
           ...((moduleDefinition as DynamicModule).imports || []),
         ];
@@ -141,12 +128,11 @@ export class DependenciesScanner {
       if (ctxRegistry.includes(innerModule)) {
         continue;
       }
-      const moduleRefs = await this.scanForModules({
-        moduleDefinition: innerModule,
-        scope: [].concat(scope, moduleDefinition),
+      const moduleRefs = await this.scanForModules(
+        innerModule,
+        [].concat(scope, moduleDefinition),
         ctxRegistry,
-        modulesToOverride,
-      });
+      );
       registeredModuleRefs = registeredModuleRefs.concat(moduleRefs);
     }
     if (!moduleInstance) {
@@ -156,13 +142,22 @@ export class DependenciesScanner {
   }
 
   public async insertModule(
-    module: any,
+    moduleDefinition: any,
     scope: Type<unknown>[],
   ): Promise<Module | undefined> {
-    if (module && module.forwardRef) {
-      return this.container.addModule(module.forwardRef(), scope);
+    const moduleToAdd = this.isForwardReference(moduleDefinition)
+      ? moduleDefinition.forwardRef()
+      : moduleDefinition;
+
+    if (
+      this.isInjectable(moduleToAdd) ||
+      this.isController(moduleToAdd) ||
+      this.isExceptionFilter(moduleToAdd)
+    ) {
+      throw new InvalidClassModuleException(moduleDefinition, scope);
     }
-    return this.container.addModule(module, scope);
+
+    return this.container.addModule(moduleToAdd, scope);
   }
 
   public async scanModulesForDependencies(
@@ -182,7 +177,7 @@ export class DependenciesScanner {
     context: string,
   ) {
     const modules = [
-      ...this.reflectMetadata(module, MODULE_METADATA.IMPORTS),
+      ...this.reflectMetadata(MODULE_METADATA.IMPORTS, module),
       ...this.container.getDynamicMetadataByToken(
         token,
         MODULE_METADATA.IMPORTS as 'imports',
@@ -195,7 +190,7 @@ export class DependenciesScanner {
 
   public reflectProviders(module: Type<any>, token: string) {
     const providers = [
-      ...this.reflectMetadata(module, MODULE_METADATA.PROVIDERS),
+      ...this.reflectMetadata(MODULE_METADATA.PROVIDERS, module),
       ...this.container.getDynamicMetadataByToken(
         token,
         MODULE_METADATA.PROVIDERS as 'providers',
@@ -209,7 +204,7 @@ export class DependenciesScanner {
 
   public reflectControllers(module: Type<any>, token: string) {
     const controllers = [
-      ...this.reflectMetadata(module, MODULE_METADATA.CONTROLLERS),
+      ...this.reflectMetadata(MODULE_METADATA.CONTROLLERS, module),
       ...this.container.getDynamicMetadataByToken(
         token,
         MODULE_METADATA.CONTROLLERS as 'controllers',
@@ -221,20 +216,20 @@ export class DependenciesScanner {
     });
   }
 
-  public reflectDynamicMetadata(obj: Type<Injectable>, token: string) {
-    if (!obj || !obj.prototype) {
+  public reflectDynamicMetadata(cls: Type<Injectable>, token: string) {
+    if (!cls || !cls.prototype) {
       return;
     }
-    this.reflectInjectables(obj, token, GUARDS_METADATA);
-    this.reflectInjectables(obj, token, INTERCEPTORS_METADATA);
-    this.reflectInjectables(obj, token, EXCEPTION_FILTERS_METADATA);
-    this.reflectInjectables(obj, token, PIPES_METADATA);
-    this.reflectParamInjectables(obj, token, ROUTE_ARGS_METADATA);
+    this.reflectInjectables(cls, token, GUARDS_METADATA);
+    this.reflectInjectables(cls, token, INTERCEPTORS_METADATA);
+    this.reflectInjectables(cls, token, EXCEPTION_FILTERS_METADATA);
+    this.reflectInjectables(cls, token, PIPES_METADATA);
+    this.reflectParamInjectables(cls, token, ROUTE_ARGS_METADATA);
   }
 
   public reflectExports(module: Type<unknown>, token: string) {
     const exports = [
-      ...this.reflectMetadata(module, MODULE_METADATA.EXPORTS),
+      ...this.reflectMetadata(MODULE_METADATA.EXPORTS, module),
       ...this.container.getDynamicMetadataByToken(
         token,
         MODULE_METADATA.EXPORTS as 'exports',
@@ -250,23 +245,45 @@ export class DependenciesScanner {
     token: string,
     metadataKey: string,
   ) {
-    const controllerInjectables = this.reflectMetadata(component, metadataKey);
-    const methodsInjectables = this.metadataScanner.scanFromPrototype(
-      null,
-      component.prototype,
-      this.reflectKeyMetadata.bind(this, component, metadataKey),
+    const controllerInjectables = this.reflectMetadata<Type<Injectable>>(
+      metadataKey,
+      component,
     );
+    const methodInjectables = this.metadataScanner
+      .getAllMethodNames(component.prototype)
+      .reduce((acc, method) => {
+        const methodInjectable = this.reflectKeyMetadata(
+          component,
+          metadataKey,
+          method,
+        );
+
+        if (methodInjectable) {
+          acc.push(methodInjectable);
+        }
 
-    const flattenMethodsInjectables = this.flatten(methodsInjectables);
-    const combinedInjectables = [
-      ...controllerInjectables,
-      ...flattenMethodsInjectables,
-    ].filter(isFunction);
-    const injectables = Array.from(new Set(combinedInjectables));
+        return acc;
+      }, []);
 
-    injectables.forEach(injectable =>
-      this.insertInjectable(injectable, token, component),
+    controllerInjectables.forEach(injectable =>
+      this.insertInjectable(
+        injectable,
+        token,
+        component,
+        ENHANCER_KEY_TO_SUBTYPE_MAP[metadataKey],
+      ),
     );
+    methodInjectables.forEach(methodInjectable => {
+      methodInjectable.metadata.forEach(injectable =>
+        this.insertInjectable(
+          injectable,
+          token,
+          component,
+          ENHANCER_KEY_TO_SUBTYPE_MAP[metadataKey],
+          methodInjectable.methodKey,
+        ),
+      );
+    });
   }
 
   public reflectParamInjectables(
@@ -274,32 +291,56 @@ export class DependenciesScanner {
     token: string,
     metadataKey: string,
   ) {
-    const paramsMetadata = this.metadataScanner.scanFromPrototype(
-      null,
+    const paramsMethods = this.metadataScanner.getAllMethodNames(
       component.prototype,
-      method => Reflect.getMetadata(metadataKey, component, method),
-    );
-    const paramsInjectables = this.flatten(paramsMetadata).map(
-      (param: Record<string, any>) =>
-        flatten(Object.keys(param).map(k => param[k].pipes)).filter(isFunction),
-    );
-    flatten(paramsInjectables).forEach((injectable: Type<Injectable>) =>
-      this.insertInjectable(injectable, token, component),
     );
+
+    paramsMethods.forEach(methodKey => {
+      const metadata: Record<
+        string,
+        {
+          index: number;
+          data: unknown;
+          pipes: Array<Type<PipeTransform> | PipeTransform>;
+        }
+      > = Reflect.getMetadata(metadataKey, component, methodKey);
+
+      if (!metadata) {
+        return;
+      }
+
+      const params = Object.values(metadata);
+      params
+        .map(item => item.pipes)
+        .flat(1)
+        .forEach(injectable =>
+          this.insertInjectable(
+            injectable,
+            token,
+            component,
+            'pipe',
+            methodKey,
+          ),
+        );
+    });
   }
 
   public reflectKeyMetadata(
     component: Type<Injectable>,
     key: string,
-    method: string,
-  ) {
+    methodKey: string,
+  ): { methodKey: string; metadata: any } | undefined {
     let prototype = component.prototype;
     do {
-      const descriptor = Reflect.getOwnPropertyDescriptor(prototype, method);
+      const descriptor = Reflect.getOwnPropertyDescriptor(prototype, methodKey);
       if (!descriptor) {
         continue;
       }
-      return Reflect.getMetadata(key, descriptor.value);
+      const metadata = Reflect.getMetadata(key, descriptor.value);
+      if (!metadata) {
+        return;
+      }
+      return { methodKey, metadata };
     } while (
       (prototype = Reflect.getPrototypeOf(prototype)) &&
       prototype !== Object.prototype &&
@@ -308,7 +349,7 @@ export class DependenciesScanner {
     return undefined;
   }
 
-  public async calculateModulesDistance() {
+  public calculateModulesDistance() {
     const modulesGenerator = this.container.getModules().values();
 
     // Skip "InternalCoreModule" from calculating distance
@@ -316,7 +357,7 @@ export class DependenciesScanner {
 
     const modulesStack = [];
     const calculateDistance = (moduleRef: Module, distance = 1) => {
-      if (modulesStack.includes(moduleRef)) {
+      if (!moduleRef || modulesStack.includes(moduleRef)) {
         return;
       }
       modulesStack.push(moduleRef);
@@ -338,7 +379,7 @@ export class DependenciesScanner {
     if (isUndefined(related)) {
       throw new CircularDependencyException(context);
     }
-    if (related && related.forwardRef) {
+    if (this.isForwardReference(related)) {
       return this.container.addImport(related.forwardRef(), token);
     }
     await this.container.addImport(related, token);
@@ -372,9 +413,8 @@ export class DependenciesScanner {
     if (!providersKeys.includes(type as string)) {
       return this.container.addProvider(provider as any, token);
     }
-    const providerToken = `${
-      type as string
-    } (UUID: ${randomStringGenerator()})`;
+    const uuid = UuidFactory.get(type.toString());
+    const providerToken = `${type as string} (UUID: ${uuid})`;
 
     let scope = (provider as ClassProvider | FactoryProvider).scope;
     if (isNil(scope) && (provider as ClassProvider).useClass) {
@@ -393,21 +433,56 @@ export class DependenciesScanner {
       scope,
     } as Provider;
 
+    const enhancerSubtype =
+      ENHANCER_TOKEN_TO_SUBTYPE_MAP[
+        type as
+          | typeof APP_GUARD
+          | typeof APP_PIPE
+          | typeof APP_FILTER
+          | typeof APP_INTERCEPTOR
+      ];
     const factoryOrClassProvider = newProvider as
       | FactoryProvider
       | ClassProvider;
     if (this.isRequestOrTransient(factoryOrClassProvider.scope)) {
-      return this.container.addInjectable(newProvider, token);
+      return this.container.addInjectable(newProvider, token, enhancerSubtype);
     }
-    this.container.addProvider(newProvider, token);
+    this.container.addProvider(newProvider, token, enhancerSubtype);
   }
 
   public insertInjectable(
-    injectable: Type<Injectable>,
+    injectable: Type<Injectable> | object,
     token: string,
     host: Type<Injectable>,
+    subtype: EnhancerSubtype,
+    methodKey?: string,
   ) {
-    this.container.addInjectable(injectable, token, host);
+    if (isFunction(injectable)) {
+      const instanceWrapper = this.container.addInjectable(
+        injectable as Type,
+        token,
+        subtype,
+        host,
+      ) as InstanceWrapper;
+
+      this.graphInspector.insertEnhancerMetadataCache({
+        moduleToken: token,
+        classRef: host,
+        enhancerInstanceWrapper: instanceWrapper,
+        targetNodeId: instanceWrapper.id,
+        subtype,
+        methodKey,
+      });
+      return instanceWrapper;
+    } else {
+      this.graphInspector.insertEnhancerMetadataCache({
+        moduleToken: token,
+        classRef: host,
+        enhancerRef: injectable,
+        methodKey,
+        subtype,
+      });
+    }
   }
 
   public insertExportedProvider(
@@ -421,22 +496,22 @@ export class DependenciesScanner {
     this.container.addController(controller, token);
   }
 
-  public reflectMetadata(metatype: Type<any>, metadataKey: string) {
+  public reflectMetadata<T = any>(
+    metadataKey: string,
+    metatype: Type<any>,
+  ): T[] {
     return Reflect.getMetadata(metadataKey, metatype) || [];
   }
 
-  public async registerCoreModule(modulesToOverride?: ModuleToOverride[]) {
+  public async registerCoreModule() {
     const moduleDefinition = InternalCoreModuleFactory.create(
       this.container,
       this,
       this.container.getModuleCompiler(),
       this.container.getHttpAdapterHostRef(),
-      modulesToOverride,
+      this.graphInspector,
     );
-    const [instance] = await this.scanForModules({
-      moduleDefinition,
-      modulesToOverride,
-    });
+    const [instance] = await this.scanForModules(moduleDefinition);
     this.container.registerCoreModuleRef(instance);
   }
 
@@ -452,11 +527,16 @@ export class DependenciesScanner {
         const { injectables } = modulesContainer.get(moduleKey);
         const instanceWrapper = injectables.get(providerKey);
 
-        iterate(modulesContainer.values())
-          .map(module => module.controllers.values())
+        const iterableIterator = modulesContainer.values();
+        iterate(iterableIterator)
+          .map(moduleRef =>
+            Array.from<InstanceWrapper>(moduleRef.controllers.values()).concat(
+              moduleRef.entryProviders,
+            ),
+          )
           .flatten()
-          .forEach(controller =>
-            controller.addEnhancerMetadata(instanceWrapper),
+          .forEach(controllerOrEntryProvider =>
+            controllerOrEntryProvider.addEnhancerMetadata(instanceWrapper),
           );
       });
   }
@@ -485,6 +565,8 @@ export class DependenciesScanner {
             providerKey,
             'injectables',
           );
+
+          this.graphInspector.insertAttachedEnhancer(instanceWrapper);
           return applyRequestProvidersMap[type as string](instanceWrapper);
         }
         instanceWrapper = getInstanceWrapper(
@@ -492,6 +574,7 @@ export class DependenciesScanner {
           providerKey,
           'providers',
         );
+        this.graphInspector.insertAttachedEnhancer(instanceWrapper);
         applyProvidersMap[type as string](instanceWrapper.instance);
       },
     );
@@ -529,71 +612,37 @@ export class DependenciesScanner {
     return module && !!(module as DynamicModule).module;
   }
 
-  public isForwardReference(
-    module: Type<any> | DynamicModule | ForwardReference,
-  ): module is ForwardReference {
-    return module && !!(module as ForwardReference).forwardRef;
-  }
-
-  private flatten<T = any>(arr: T[][]): T[] {
-    return arr.reduce((a: T[], b: T[]) => a.concat(b), []);
+  /**
+   * @param metatype
+   * @returns `true` if `metatype` is annotated with the `@Injectable()` decorator.
+   */
+  private isInjectable(metatype: Type<any>): boolean {
+    return !!Reflect.getMetadata(INJECTABLE_WATERMARK, metatype);
   }
 
-  private isRequestOrTransient(scope: Scope): boolean {
-    return scope === Scope.REQUEST || scope === Scope.TRANSIENT;
+  /**
+   * @param metatype
+   * @returns `true` if `metatype` is annotated with the `@Controller()` decorator.
+   */
+  private isController(metatype: Type<any>): boolean {
+    return !!Reflect.getMetadata(CONTROLLER_WATERMARK, metatype);
   }
 
-  private putModule(
-    moduleDefinition: ModuleDefinition,
-    modulesToOverride: ModuleToOverride[],
-    scope: Type<unknown>[],
-  ): Promise<Module | undefined> {
-    const overrideModule = this.getOverrideModuleByModule(
-      moduleDefinition,
-      modulesToOverride,
-    );
-    if (overrideModule !== undefined) {
-      return this.overrideModule(
-        moduleDefinition,
-        overrideModule.newModule,
-        scope,
-      );
-    }
-
-    return this.insertModule(moduleDefinition, scope);
+  /**
+   * @param metatype
+   * @returns `true` if `metatype` is annotated with the `@Catch()` decorator.
+   */
+  private isExceptionFilter(metatype: Type<any>): boolean {
+    return !!Reflect.getMetadata(CATCH_WATERMARK, metatype);
   }
 
-  // The 'any' definition and castings is related to forward reference, there is a better way do this?
-  private getOverrideModuleByModule(
-    module: ModuleDefinition | any,
-    modulesToOverride: ModuleToOverride[],
-  ): ModuleToOverride | undefined {
-    if (this.isForwardReference(module)) {
-      return modulesToOverride.find(moduleToOverride => {
-        return (
-          moduleToOverride.moduleToReplace === module.forwardRef() ||
-          (moduleToOverride.moduleToReplace as any).forwardRef?.() ===
-            module.forwardRef()
-        );
-      });
-    }
-
-    return modulesToOverride.find(
-      moduleToOverride => moduleToOverride.moduleToReplace === module,
-    );
+  private isForwardReference(
+    module: Type<any> | DynamicModule | ForwardReference,
+  ): module is ForwardReference {
+    return module && !!(module as ForwardReference).forwardRef;
   }
 
-  private async overrideModule(
-    moduleToOverride: any,
-    newModule: any,
-    scope: Type<unknown>[],
-  ): Promise<Module | undefined> {
-    return this.container.replaceModule(
-      this.isForwardReference(moduleToOverride)
-        ? moduleToOverride.forwardRef()
-        : moduleToOverride,
-      this.isForwardReference(newModule) ? newModule.forwardRef() : newModule,
-      scope,
-    );
+  private isRequestOrTransient(scope: Scope): boolean {
+    return scope === Scope.REQUEST || scope === Scope.TRANSIENT;
   }
 }
diff --git a/packages/core/services/reflector.service.ts b/packages/core/services/reflector.service.ts
index fd5a2d77a..52cd4964d 100644
--- a/packages/core/services/reflector.service.ts
+++ b/packages/core/services/reflector.service.ts
@@ -23,7 +23,7 @@ export class Reflector {
     metadataKey: TKey,
     target: Type<any> | Function,
   ): TResult {
-    return Reflect.getMetadata(metadataKey, target) as TResult;
+    return Reflect.getMetadata(metadataKey, target);
   }
 
   /**
@@ -38,7 +38,7 @@ export class Reflector {
     targets: (Type<any> | Function)[],
   ): TResult {
     return (targets || []).map(target =>
-      Reflect.getMetadata(metadataKey, target),
+      this.get(metadataKey, target),
     ) as TResult;
   }
 
@@ -86,9 +86,12 @@ export class Reflector {
     metadataKey: TKey,
     targets: (Type<any> | Function)[],
   ): TResult {
-    const metadataCollection = this.getAll(metadataKey, targets).filter(
-      item => item !== undefined,
-    );
-    return metadataCollection[0];
+    for (const target of targets) {
+      const result = this.get(metadataKey, target);
+      if (result !== undefined) {
+        return result;
+      }
+    }
+    return undefined;
   }
 }
diff --git a/packages/core/test/application-config.spec.ts b/packages/core/test/application-config.spec.ts
index b01828908..cff91bb11 100644
--- a/packages/core/test/application-config.spec.ts
+++ b/packages/core/test/application-config.spec.ts
@@ -1,5 +1,8 @@
 import { RequestMethod } from '@nestjs/common';
-import { GlobalPrefixOptions } from '@nestjs/common/interfaces';
+import {
+  GlobalPrefixOptions,
+  VersioningOptions,
+} from '@nestjs/common/interfaces';
 import { expect } from 'chai';
 import { ApplicationConfig } from '../application-config';
 import { ExcludeRouteMetadata } from '../router/interfaces/exclude-route-metadata.interface';
@@ -20,7 +23,11 @@ describe('ApplicationConfig', () => {
     it('should set global path options', () => {
       const options: GlobalPrefixOptions<ExcludeRouteMetadata> = {
         exclude: [
-          { pathRegex: new RegExp(/health/), requestMethod: RequestMethod.GET },
+          {
+            path: '/health',
+            pathRegex: new RegExp(/health/),
+            requestMethod: RequestMethod.GET,
+          },
         ],
       };
       appConfig.setGlobalPrefixOptions(options);
@@ -130,6 +137,13 @@ describe('ApplicationConfig', () => {
       expect(appConfig.getVersioning()).to.be.eql(options);
     });
 
+    it('should ignore duplicated versions on defaultVersion array', () => {
+      const options = { type: 'test', defaultVersion: ['1', '2', '2', '1'] };
+      appConfig.enableVersioning(options as any);
+
+      expect(appConfig.getVersioning().defaultVersion).to.be.eql(['1', '2']);
+    });
+
     it('should have undefined as the versioning by default', () => {
       expect(appConfig.getVersioning()).to.be.eql(undefined);
     });
diff --git a/packages/core/test/errors/test/messages.spec.ts b/packages/core/test/errors/test/messages.spec.ts
index 077f0b5cd..cbc3e15bd 100644
--- a/packages/core/test/errors/test/messages.spec.ts
+++ b/packages/core/test/errors/test/messages.spec.ts
@@ -18,8 +18,8 @@ describe('Error Messages', () => {
         stringCleaner(`Nest can't resolve dependencies of the CatService (?, CatService). Please make sure that the argument dependency at index [0] is available in the current context.
   
       Potential solutions:
-      - If dependency is a provider, is it part of the current current?
-      - If dependency is exported from a separate @Module, is that module imported within current?
+      - If dependency is a provider, is it part of the current Module?
+      - If dependency is exported from a separate @Module, is that module imported within Module?
       @Module({
         imports: [ /* the Module containing dependency */ ]
       })
@@ -41,8 +41,8 @@ describe('Error Messages', () => {
         stringCleaner(`Nest can't resolve dependencies of the CatService (?, MY_TOKEN). Please make sure that the argument dependency at index [0] is available in the current context.
   
       Potential solutions:
-      - If dependency is a provider, is it part of the current current?
-      - If dependency is exported from a separate @Module, is that module imported within current?
+      - If dependency is a provider, is it part of the current Module?
+      - If dependency is exported from a separate @Module, is that module imported within Module?
       @Module({
       imports: [ /* the Module containing dependency */ ]
       })
@@ -62,8 +62,8 @@ describe('Error Messages', () => {
         stringCleaner(`Nest can't resolve dependencies of the CatService (?, CatFunction). Please make sure that the argument dependency at index [0] is available in the current context.
   
       Potential solutions:
-      - If dependency is a provider, is it part of the current current?
-      - If dependency is exported from a separate @Module, is that module imported within current?
+      - If dependency is a provider, is it part of the current Module?
+      - If dependency is exported from a separate @Module, is that module imported within Module?
       @Module({
         imports: [ /* the Module containing dependency */ ]
       })
@@ -83,8 +83,8 @@ describe('Error Messages', () => {
         stringCleaner(`Nest can't resolve dependencies of the CatService (?, +). Please make sure that the argument dependency at index [0] is available in the current context.
   
       Potential solutions:
-      - If dependency is a provider, is it part of the current current?
-      - If dependency is exported from a separate @Module, is that module imported within current?
+      - If dependency is a provider, is it part of the current Module?
+      - If dependency is exported from a separate @Module, is that module imported within Module?
         @Module({
           imports: [ /* the Module containing dependency */ ]
         })
@@ -104,6 +104,7 @@ describe('Error Messages', () => {
         stringCleaner(`Nest can't resolve dependencies of the CatService (?, MY_TOKEN). Please make sure that the argument dependency at index [0] is available in the TestModule context.
   
       Potential solutions:
+      - Is TestModule a valid NestJS module?
       - If dependency is a provider, is it part of the current TestModule?
       - If dependency is exported from a separate @Module, is that module imported within TestModule?
         @Module({
@@ -137,8 +138,8 @@ describe('Error Messages', () => {
         stringCleaner(`Nest can't resolve dependencies of the Symbol(CatProvider) (?). Please make sure that the argument dependency at index [0] is available in the current context.
   
       Potential solutions:
-      - If dependency is a provider, is it part of the current current?
-      - If dependency is exported from a separate @Module, is that module imported within current?
+      - If dependency is a provider, is it part of the current Module?
+      - If dependency is exported from a separate @Module, is that module imported within Module?
         @Module({
           imports: [ /* the Module containing dependency */ ]
         })
@@ -158,8 +159,8 @@ describe('Error Messages', () => {
         stringCleaner(`Nest can't resolve dependencies of the CatProvider (?, Symbol(DogProvider)). Please make sure that the argument dependency at index [0] is available in the current context.
   
       Potential solutions:
-      - If dependency is a provider, is it part of the current current?
-      - If dependency is exported from a separate @Module, is that module imported within current?
+      - If dependency is a provider, is it part of the current Module?
+      - If dependency is exported from a separate @Module, is that module imported within Module?
         @Module({
           imports: [ /* the Module containing dependency */ ]
         })
diff --git a/packages/core/test/exceptions/exceptions-handler.spec.ts b/packages/core/test/exceptions/exceptions-handler.spec.ts
index 3956c6edd..d74ef9a74 100644
--- a/packages/core/test/exceptions/exceptions-handler.spec.ts
+++ b/packages/core/test/exceptions/exceptions-handler.spec.ts
@@ -102,7 +102,12 @@ describe('ExceptionsHandler', () => {
       beforeEach(() => {
         sinon.stub(handler, 'invokeCustomFilters').returns(true);
       });
-      it('should not call status and json stubs', () => {
+      it('should do nothing', () => {
+        handler.next(
+          new Error(),
+          sinon.createStubInstance(ExecutionContextHost),
+        );
+
         expect(statusStub.notCalled).to.be.true;
         expect(jsonStub.notCalled).to.be.true;
       });
diff --git a/packages/core/test/exceptions/external-exception-filter-context.spec.ts b/packages/core/test/exceptions/external-exception-filter-context.spec.ts
index 755ec3021..5c849fc88 100644
--- a/packages/core/test/exceptions/external-exception-filter-context.spec.ts
+++ b/packages/core/test/exceptions/external-exception-filter-context.spec.ts
@@ -1,5 +1,6 @@
 import { expect } from 'chai';
 import * as sinon from 'sinon';
+import { ExceptionFilter } from '../../../common';
 import { Catch } from '../../../common/decorators/core/catch.decorator';
 import { UseFilters } from '../../../common/decorators/core/exception-filters.decorator';
 import { ApplicationConfig } from '../../application-config';
@@ -13,7 +14,10 @@ describe('ExternalExceptionFilterContext', () => {
 
   class CustomException {}
   @Catch(CustomException)
-  class ExceptionFilter {
+  class ExceptionFilter implements ExceptionFilter {
+    public catch(exc, res) {}
+  }
+  class ClassWithNoMetadata implements ExceptionFilter {
     public catch(exc, res) {}
   }
 
@@ -59,6 +63,11 @@ describe('ExternalExceptionFilterContext', () => {
         exceptionFilter.reflectCatchExceptions(new ExceptionFilter()),
       ).to.be.eql([CustomException]);
     });
+    it('should return an empty array when metadata was found', () => {
+      expect(
+        exceptionFilter.reflectCatchExceptions(new ClassWithNoMetadata()),
+      ).to.be.eql([]);
+    });
   });
   describe('createConcreteContext', () => {
     class InvalidFilter {}
diff --git a/packages/core/test/exceptions/external-exceptions-handler.spec.ts b/packages/core/test/exceptions/external-exceptions-handler.spec.ts
index 8f39cd76f..d488029eb 100644
--- a/packages/core/test/exceptions/external-exceptions-handler.spec.ts
+++ b/packages/core/test/exceptions/external-exceptions-handler.spec.ts
@@ -2,22 +2,23 @@ import { expect } from 'chai';
 import { of } from 'rxjs';
 import * as sinon from 'sinon';
 import { ExternalExceptionsHandler } from '../../exceptions/external-exceptions-handler';
+import { ExternalExceptionFilter } from '../../exceptions/external-exception-filter';
 
 describe('ExternalExceptionsHandler', () => {
   let handler: ExternalExceptionsHandler;
 
   beforeEach(() => {
     handler = new ExternalExceptionsHandler();
+
+    // eslint-disable-next-line @typescript-eslint/ban-ts-comment
+    // @ts-ignore The 'logger' property is private but we want to avoid showing useless error logs
+    ExternalExceptionFilter.logger.error = () => {};
   });
 
   describe('next', () => {
-    it('should method returns expected stream with message when exception is unknown', async () => {
+    it('should method returns expected stream with message when exception is unknown', () => {
       const error = new Error();
-      try {
-        await handler.next(error, null);
-      } catch (err) {
-        expect(err).to.be.eql(error);
-      }
+      expect(() => handler.next(error, null)).to.throw(error);
     });
     describe('when "invokeCustomFilters" returns value', () => {
       const observable$ = of(true);
@@ -49,6 +50,7 @@ describe('ExternalExceptionsHandler', () => {
     describe('when filters array is not empty', () => {
       let filters, funcSpy;
       class TestException {}
+      class AnotherTestException {}
 
       beforeEach(() => {
         funcSpy = sinon.spy();
@@ -73,6 +75,12 @@ describe('ExternalExceptionsHandler', () => {
         });
       });
       describe('when filter does not exists in filters array', () => {
+        beforeEach(() => {
+          filters = [
+            { exceptionMetatypes: [AnotherTestException], func: funcSpy },
+          ];
+          (handler as any).filters = filters;
+        });
         it('should not call funcSpy', () => {
           handler.invokeCustomFilters(new TestException(), null);
           expect(funcSpy.notCalled).to.be.true;
diff --git a/packages/core/test/helpers/context-utils.spec.ts b/packages/core/test/helpers/context-utils.spec.ts
index 54111ef6d..d344f954c 100644
--- a/packages/core/test/helpers/context-utils.spec.ts
+++ b/packages/core/test/helpers/context-utils.spec.ts
@@ -1,4 +1,4 @@
-import { CUSTOM_ROUTE_AGRS_METADATA } from '@nestjs/common/constants';
+import { CUSTOM_ROUTE_ARGS_METADATA } from '@nestjs/common/constants';
 import { Body, createParamDecorator, Request } from '@nestjs/common/decorators';
 import { RouteParamtypes } from '@nestjs/common/enums/route-paramtypes.enum';
 import { expect } from 'chai';
@@ -40,7 +40,7 @@ describe('ContextUtils', () => {
           data: undefined,
           pipes: [],
         },
-        [`custom${CUSTOM_ROUTE_AGRS_METADATA}:2`]: {
+        [`custom${CUSTOM_ROUTE_ARGS_METADATA}:2`]: {
           index: 2,
           factory: () => {},
           data: undefined,
@@ -54,7 +54,7 @@ describe('ContextUtils', () => {
       );
 
       const keys = Object.keys(metadata);
-      const custom = keys.find(key => key.includes(CUSTOM_ROUTE_AGRS_METADATA));
+      const custom = keys.find(key => key.includes(CUSTOM_ROUTE_ARGS_METADATA));
 
       expect(metadata[custom]).to.be.an('object');
       expect(metadata[custom].index).to.be.eq(2);
@@ -87,7 +87,7 @@ describe('ContextUtils', () => {
     });
   });
   describe('mergeParamsMetatypes', () => {
-    it('should return "paramsProperties" when paramtypes array doesnt exists', () => {
+    it('should return "paramsProperties" when paramtypes array doesn\'t exists', () => {
       const paramsProperties = ['1'];
       expect(
         contextUtils.mergeParamsMetatypes(paramsProperties as any, null),
diff --git a/packages/core/test/helpers/external-context-creator.spec.ts b/packages/core/test/helpers/external-context-creator.spec.ts
index 98c098eab..cad7ed3b5 100644
--- a/packages/core/test/helpers/external-context-creator.spec.ts
+++ b/packages/core/test/helpers/external-context-creator.spec.ts
@@ -1,5 +1,5 @@
 import { ForbiddenException } from '@nestjs/common';
-import { CUSTOM_ROUTE_AGRS_METADATA } from '@nestjs/common/constants';
+import { CUSTOM_ROUTE_ARGS_METADATA } from '@nestjs/common/constants';
 import { RouteParamtypes } from '@nestjs/common/enums/route-paramtypes.enum';
 import { expect } from 'chai';
 import { of } from 'rxjs';
@@ -138,7 +138,7 @@ describe('ExternalContextCreator', () => {
       const metadata = {
         [RouteParamtypes.REQUEST]: { index: 0, data: 'test', pipes: [] },
         [RouteParamtypes.BODY]: { index: 2, data: 'test', pipes: [] },
-        [`key${CUSTOM_ROUTE_AGRS_METADATA}`]: {
+        [`key${CUSTOM_ROUTE_ARGS_METADATA}`]: {
           index: 3,
           data: 'custom',
           pipes: [],
@@ -154,7 +154,7 @@ describe('ExternalContextCreator', () => {
       const expectedValues = [
         { index: 0, type: RouteParamtypes.REQUEST, data: 'test' },
         { index: 2, type: RouteParamtypes.BODY, data: 'test' },
-        { index: 3, type: `key${CUSTOM_ROUTE_AGRS_METADATA}`, data: 'custom' },
+        { index: 3, type: `key${CUSTOM_ROUTE_ARGS_METADATA}`, data: 'custom' },
       ];
       expect(values[0]).to.deep.include(expectedValues[0]);
       expect(values[1]).to.deep.include(expectedValues[1]);
diff --git a/packages/core/test/helpers/router-method-factory.spec.ts b/packages/core/test/helpers/router-method-factory.spec.ts
index 242fc51a3..4f904519f 100644
--- a/packages/core/test/helpers/router-method-factory.spec.ts
+++ b/packages/core/test/helpers/router-method-factory.spec.ts
@@ -29,6 +29,6 @@ describe('RouterMethodFactory', () => {
     expect(factory.get(target, RequestMethod.PATCH)).to.equal(target.patch);
     expect(factory.get(target, RequestMethod.OPTIONS)).to.equal(target.options);
     expect(factory.get(target, RequestMethod.HEAD)).to.equal(target.head);
-    expect(factory.get(target, -1)).to.equal(target.use);
+    expect(factory.get(target, -1 as any)).to.equal(target.use);
   });
 });
diff --git a/packages/core/test/injector/container.spec.ts b/packages/core/test/injector/container.spec.ts
index eb435142a..0d7f181c5 100644
--- a/packages/core/test/injector/container.spec.ts
+++ b/packages/core/test/injector/container.spec.ts
@@ -81,37 +81,6 @@ describe('NestContainer', () => {
       expect(addGlobalModuleSpy.calledOnce).to.be.true;
     });
   });
-
-  describe('replaceModule', () => {
-    it('should replace module if already exists in collection', async () => {
-      @Module({})
-      class ReplaceTestModule {}
-
-      const modules = new Map();
-      const setSpy = sinon.spy(modules, 'set');
-      (container as any).modules = modules;
-
-      await container.addModule(TestModule as any, []);
-      await container.replaceModule(
-        TestModule as any,
-        ReplaceTestModule as any,
-        [],
-      );
-
-      expect(setSpy.calledTwice).to.be.true;
-    });
-
-    it('should throws an exception when metatype is not defined', () => {
-      expect(container.addModule(undefined, [])).to.eventually.throws();
-    });
-
-    it('should add global module when module is global', async () => {
-      const addGlobalModuleSpy = sinon.spy(container, 'addGlobalModule');
-      await container.addModule(GlobalTestModule as any, []);
-      expect(addGlobalModuleSpy.calledOnce).to.be.true;
-    });
-  });
-
   describe('isGlobalModule', () => {
     describe('when module is not globally scoped', () => {
       it('should return false', () => {
diff --git a/packages/core/test/injector/helpers/provider-classifier.spec.ts b/packages/core/test/injector/helpers/provider-classifier.spec.ts
new file mode 100644
index 000000000..091600bfb
--- /dev/null
+++ b/packages/core/test/injector/helpers/provider-classifier.spec.ts
@@ -0,0 +1,132 @@
+import { ClassProvider, FactoryProvider, ValueProvider } from '@nestjs/common';
+import { expect } from 'chai';
+import {
+  isClassProvider,
+  isFactoryProvider,
+  isValueProvider,
+} from '../../../injector/helpers/provider-classifier';
+
+describe('provider classifier', () => {
+  describe('isClassProvider', () => {
+    it('should return true if useClass is present', () => {
+      const classProvider: ClassProvider = {
+        useClass: class TestClass {},
+        provide: 'token',
+      };
+
+      expect(isClassProvider(classProvider)).to.be.true;
+    });
+
+    it('should return false if useClass is undefined', () => {
+      const classProvider: ClassProvider = {
+        useClass: undefined,
+        provide: 'token',
+      };
+
+      expect(isClassProvider(classProvider)).to.be.false;
+    });
+
+    it('should return false if useClass is not present', () => {
+      const classProvider = {
+        provide: 'token',
+      };
+
+      expect(isClassProvider(classProvider as ClassProvider)).to.be.false;
+    });
+
+    it('should return false if provider is undefined', () => {
+      const classProvider = undefined;
+
+      expect(isClassProvider(classProvider as ClassProvider)).to.be.false;
+    });
+  });
+
+  describe('isValueProvider', () => {
+    it('should return true if useValue is not undefined', () => {
+      const valueProvider: ValueProvider = {
+        useValue: 'value',
+        provide: 'token',
+      };
+
+      expect(isValueProvider(valueProvider)).to.be.true;
+    });
+
+    it('should return true if useValue is "false"', () => {
+      const valueProvider: ValueProvider = {
+        useValue: false,
+        provide: 'token',
+      };
+
+      expect(isValueProvider(valueProvider)).to.be.true;
+    });
+
+    it('should return true if useValue is "null"', () => {
+      const valueProvider: ValueProvider = {
+        useValue: null,
+        provide: 'token',
+      };
+
+      expect(isValueProvider(valueProvider)).to.be.true;
+    });
+
+    it('should return true if useValue is an empty string', () => {
+      const valueProvider: ValueProvider = {
+        useValue: null,
+        provide: '',
+      };
+
+      expect(isValueProvider(valueProvider)).to.be.true;
+    });
+
+    it('should return false if useValue is undefined', () => {
+      const valueProvider: ValueProvider = {
+        useValue: undefined,
+        provide: 'token',
+      };
+
+      expect(isValueProvider(valueProvider)).to.be.false;
+    });
+
+    it('should return false if useValue is not present', () => {
+      const valueProvider = {
+        provide: 'token',
+      };
+
+      expect(isValueProvider(valueProvider as ValueProvider)).to.be.false;
+    });
+
+    it('should return false if provider is undefined', () => {
+      const valueProvider = undefined;
+
+      expect(isValueProvider(valueProvider as ValueProvider)).to.be.false;
+    });
+  });
+
+  describe('isFactoryProvider', () => {
+    it('should return true if useFactory is present', () => {
+      const factoryProvider: FactoryProvider = {
+        provide: 'token',
+        useFactory: () => {},
+      };
+
+      expect(isFactoryProvider(factoryProvider)).to.be.true;
+    });
+
+    it('should return false if useFactory is not present', () => {
+      const factoryProvider = {
+        provide: 'token',
+      };
+
+      expect(isFactoryProvider(factoryProvider as FactoryProvider)).to.be.false;
+    });
+
+    it('should return false if useFactory is undefined', () => {
+      const factoryProvider: FactoryProvider = {
+        provide: 'token',
+        useFactory: undefined,
+      };
+
+      expect(isFactoryProvider(factoryProvider as FactoryProvider)).to.be.false;
+    });
+  });
+});
diff --git a/packages/core/test/injector/injector.spec.ts b/packages/core/test/injector/injector.spec.ts
index 8c7d54c2e..03f400b6b 100644
--- a/packages/core/test/injector/injector.spec.ts
+++ b/packages/core/test/injector/injector.spec.ts
@@ -1,3 +1,4 @@
+import { Optional } from '@nestjs/common';
 import * as chai from 'chai';
 import { expect } from 'chai';
 import * as chaiAsPromised from 'chai-as-promised';
@@ -9,6 +10,8 @@ import { NestContainer } from '../../injector/container';
 import { Injector, PropertyDependency } from '../../injector/injector';
 import { InstanceWrapper } from '../../injector/instance-wrapper';
 import { Module } from '../../injector/module';
+import { PARAMTYPES_METADATA } from '@nestjs/common/constants';
+
 chai.use(chaiAsPromised);
 
 describe('Injector', () => {
@@ -92,8 +95,7 @@ describe('Injector', () => {
       ).to.eventually.be.rejected;
     });
 
-    it('should await done$ when "isPending"', async () => {
-      const value = 'test';
+    it('should await done$ when "isPending"', () => {
       const wrapper = new InstanceWrapper({
         name: 'MainTest',
         metatype: MainTest,
@@ -101,15 +103,29 @@ describe('Injector', () => {
         isResolved: false,
       });
       const host = wrapper.getInstanceByContextId(STATIC_CONTEXT);
-      host.donePromise = Promise.resolve(value) as any;
+      host.donePromise = Promise.resolve();
       host.isPending = true;
 
-      const result = await injector.loadInstance(
-        wrapper,
-        moduleDeps.providers,
-        moduleDeps,
-      );
-      expect(result).to.be.eql(value);
+      expect(
+        injector.loadInstance(wrapper, moduleDeps.providers, moduleDeps),
+      ).to.eventually.not.throw();
+    });
+
+    it('should await done$ when "isPending" and rethrow an exception (if thrown)', () => {
+      const error = new Error('Test error');
+      const wrapper = new InstanceWrapper({
+        name: 'MainTest',
+        metatype: MainTest,
+        instance: Object.create(MainTest.prototype),
+        isResolved: false,
+      });
+      const host = wrapper.getInstanceByContextId(STATIC_CONTEXT);
+      host.donePromise = Promise.resolve(error);
+      host.isPending = true;
+
+      expect(
+        injector.loadInstance(wrapper, moduleDeps.providers, moduleDeps),
+      ).to.eventually.throw(error);
     });
 
     it('should return undefined when metatype is resolved', async () => {
@@ -594,7 +610,7 @@ describe('Injector', () => {
       });
     });
 
-    describe('when instanceWraper has async property', () => {
+    describe('when instanceWrapper has async property', () => {
       it('should await instance', async () => {
         sinon.stub(injector, 'loadProvider').callsFake(() => null);
 
@@ -803,4 +819,123 @@ describe('Injector', () => {
       expect(loadPropertiesMetadataSpy.called).to.be.true;
     });
   });
+
+  describe('getClassDependencies', () => {
+    it('should return an array that consists of deps and optional dep ids', async () => {
+      class FixtureDep1 {}
+      class FixtureDep2 {}
+
+      @Injectable()
+      class FixtureClass {
+        constructor(
+          private dep1: FixtureDep1,
+          @Optional() private dep2: FixtureDep2,
+        ) {}
+      }
+
+      const wrapper = new InstanceWrapper({ metatype: FixtureClass });
+      const [dependencies, optionalDependenciesIds] =
+        injector.getClassDependencies(wrapper);
+
+      expect(dependencies).to.deep.eq([FixtureDep1, FixtureDep2]);
+      expect(optionalDependenciesIds).to.deep.eq([1]);
+    });
+
+    it('should not mutate the constructor metadata', async () => {
+      class FixtureDep1 {}
+      /** This needs to be something other than FixtureDep1 so the test can ensure that the metadata was not mutated */
+      const injectionToken = 'test_token';
+
+      @Injectable()
+      class FixtureClass {
+        constructor(@Inject(injectionToken) private dep1: FixtureDep1) {}
+      }
+
+      const wrapper = new InstanceWrapper({ metatype: FixtureClass });
+      const [dependencies] = injector.getClassDependencies(wrapper);
+      expect(dependencies).to.deep.eq([injectionToken]);
+
+      const paramtypes = Reflect.getMetadata(PARAMTYPES_METADATA, FixtureClass);
+      expect(paramtypes).to.deep.eq([FixtureDep1]);
+    });
+  });
+
+  describe('getFactoryProviderDependencies', () => {
+    it('should return an array that consists of deps and optional dep ids', async () => {
+      class FixtureDep1 {}
+      class FixtureDep2 {}
+
+      const wrapper = new InstanceWrapper({
+        inject: [
+          FixtureDep1,
+          { token: FixtureDep2, optional: true },
+          { token: FixtureDep2, optional: false },
+          {} as any,
+        ],
+      });
+      const [dependencies, optionalDependenciesIds] =
+        injector.getFactoryProviderDependencies(wrapper);
+
+      expect(dependencies).to.deep.eq([
+        FixtureDep1,
+        FixtureDep2,
+        FixtureDep2,
+        {},
+      ]);
+      expect(optionalDependenciesIds).to.deep.eq([1]);
+    });
+  });
+
+  describe('addDependencyMetadata', () => {
+    interface IInjector extends Omit<Injector, 'addDependencyMetadata'> {
+      addDependencyMetadata: (
+        keyOrIndex: symbol | string | number,
+        hostWrapper: InstanceWrapper,
+        instanceWrapper: InstanceWrapper,
+      ) => void;
+    }
+
+    let exposedInjector: IInjector;
+    let hostWrapper: InstanceWrapper;
+    let instanceWrapper: InstanceWrapper;
+
+    beforeEach(() => {
+      exposedInjector = injector as unknown as IInjector;
+      hostWrapper = new InstanceWrapper();
+      instanceWrapper = new InstanceWrapper();
+    });
+
+    it('should add dependency metadata to PropertiesMetadata when key is symbol', async () => {
+      const addPropertiesMetadataSpy = sinon.spy(
+        hostWrapper,
+        'addPropertiesMetadata',
+      );
+
+      const key = Symbol.for('symbol');
+      exposedInjector.addDependencyMetadata(key, hostWrapper, instanceWrapper);
+
+      expect(addPropertiesMetadataSpy.called).to.be.true;
+    });
+
+    it('should add dependency metadata to PropertiesMetadata when key is string', async () => {
+      const addPropertiesMetadataSpy = sinon.spy(
+        hostWrapper,
+        'addPropertiesMetadata',
+      );
+
+      const key = 'string';
+      exposedInjector.addDependencyMetadata(key, hostWrapper, instanceWrapper);
+
+      expect(addPropertiesMetadataSpy.called).to.be.true;
+    });
+
+    it('should add dependency metadata to CtorMetadata when key is number', async () => {
+      const addCtorMetadataSpy = sinon.spy(hostWrapper, 'addCtorMetadata');
+
+      const key = 0;
+      exposedInjector.addDependencyMetadata(key, hostWrapper, instanceWrapper);
+
+      expect(addCtorMetadataSpy.called).to.be.true;
+    });
+  });
 });
diff --git a/packages/core/test/injector/instance-loader.spec.ts b/packages/core/test/injector/instance-loader.spec.ts
index 8c34354eb..5ee507cdf 100644
--- a/packages/core/test/injector/instance-loader.spec.ts
+++ b/packages/core/test/injector/instance-loader.spec.ts
@@ -6,51 +6,64 @@ import { NestContainer } from '../../injector/container';
 import { Injector } from '../../injector/injector';
 import { InstanceLoader } from '../../injector/instance-loader';
 import { InstanceWrapper } from '../../injector/instance-wrapper';
+import { GraphInspector } from '../../inspector/graph-inspector';
 
 describe('InstanceLoader', () => {
-  let loader: InstanceLoader;
-  let container: NestContainer;
-  let mockContainer: sinon.SinonMock;
-
   @Controller('')
-  class TestRoute {}
+  class TestCtrl {}
 
   @Injectable()
   class TestProvider {}
 
+  let loader: InstanceLoader;
+  let injector: Injector;
+  let container: NestContainer;
+  let graphInspector: GraphInspector;
+  let inspectInstanceWrapperStub: sinon.SinonStub;
+  let mockContainer: sinon.SinonMock;
+  let moduleMock: Record<string, any>;
+
   beforeEach(() => {
     container = new NestContainer();
-    loader = new InstanceLoader(container);
-    mockContainer = sinon.mock(container);
-  });
+    graphInspector = new GraphInspector(container);
 
-  it('should call "loadPrototype" for each provider and route in each module', async () => {
-    const injector = new Injector();
-    (loader as any).injector = injector;
+    inspectInstanceWrapperStub = sinon.stub(
+      graphInspector,
+      'inspectInstanceWrapper',
+    );
 
-    const module = {
+    injector = new Injector();
+    loader = new InstanceLoader(container, injector, graphInspector);
+    mockContainer = sinon.mock(container);
+
+    moduleMock = {
+      imports: new Set(),
       providers: new Map(),
       controllers: new Map(),
       injectables: new Map(),
+      exports: new Set(),
       metatype: { name: 'test' },
     };
-    const providerWrapper: InstanceWrapper = {
+
+    const modules = new Map();
+    modules.set('Test', moduleMock);
+    mockContainer.expects('getModules').returns(modules);
+  });
+
+  it('should call "loadPrototype" for every provider and controller in every module', async () => {
+    const providerWrapper = new InstanceWrapper({
       instance: null,
       metatype: TestProvider,
       token: 'TestProvider',
-    } as any;
-    const routeWrapper: InstanceWrapper = {
+    });
+    const ctrlWrapper = new InstanceWrapper({
       instance: null,
-      metatype: TestRoute,
+      metatype: TestCtrl,
       token: 'TestRoute',
-    } as any;
+    });
 
-    module.providers.set('TestProvider', providerWrapper);
-    module.controllers.set('TestRoute', routeWrapper);
-
-    const modules = new Map();
-    modules.set('Test', module);
-    mockContainer.expects('getModules').returns(modules);
+    moduleMock.providers.set('TestProvider', providerWrapper);
+    moduleMock.controllers.set('TestRoute', ctrlWrapper);
 
     const loadProviderPrototypeStub = sinon.stub(injector, 'loadPrototype');
 
@@ -58,113 +71,125 @@ describe('InstanceLoader', () => {
     sinon.stub(injector, 'loadProvider');
 
     await loader.createInstancesOfDependencies();
+
     expect(
-      loadProviderPrototypeStub.calledWith(providerWrapper, module.providers),
+      loadProviderPrototypeStub.calledWith(
+        providerWrapper,
+        moduleMock.providers,
+      ),
     ).to.be.true;
     expect(
-      loadProviderPrototypeStub.calledWith(routeWrapper, module.controllers),
+      loadProviderPrototypeStub.calledWith(ctrlWrapper, moduleMock.controllers),
     ).to.be.true;
   });
 
-  it('should call "loadProvider" for each provider in each module', async () => {
-    const injector = new Injector();
-    (loader as any).injector = injector;
+  describe('for every provider in every module', () => {
+    const testProviderToken = 'TestProvider';
 
-    const module = {
-      providers: new Map(),
-      controllers: new Map(),
-      injectables: new Map(),
-      metatype: { name: 'test' },
-    };
-    const testComp = new InstanceWrapper({
-      instance: null,
-      metatype: TestProvider,
-      name: 'TestProvider',
-      token: 'TestProvider',
-    });
-    module.providers.set('TestProvider', testComp);
+    let loadProviderStub: sinon.SinonStub;
 
-    const modules = new Map();
-    modules.set('Test', module);
-    mockContainer.expects('getModules').returns(modules);
+    beforeEach(async () => {
+      const testProviderWrapper = new InstanceWrapper({
+        instance: null,
+        metatype: TestProvider,
+        name: testProviderToken,
+        token: testProviderToken,
+      });
+      moduleMock.providers.set(testProviderToken, testProviderWrapper);
 
-    const loadProviderStub = sinon.stub(injector, 'loadProvider');
-    sinon.stub(injector, 'loadController');
+      loadProviderStub = sinon.stub(injector, 'loadProvider');
+      sinon.stub(injector, 'loadController');
 
-    await loader.createInstancesOfDependencies();
-    expect(
-      loadProviderStub.calledWith(
-        module.providers.get('TestProvider'),
-        module as any,
-      ),
-    ).to.be.true;
-  });
+      await loader.createInstancesOfDependencies();
+    });
 
-  it('should call "loadController" for each route in each module', async () => {
-    const injector = new Injector();
-    (loader as any).injector = injector;
+    it('should call "loadProvider"', async () => {
+      expect(
+        loadProviderStub.calledWith(
+          moduleMock.providers.get(testProviderToken),
+          moduleMock as any,
+        ),
+      ).to.be.true;
+    });
 
-    const module = {
-      providers: new Map(),
-      controllers: new Map(),
-      injectables: new Map(),
-      metatype: { name: 'test' },
-    };
-    const wrapper = new InstanceWrapper({
-      name: 'TestRoute',
-      token: 'TestRoute',
-      instance: null,
-      metatype: TestRoute,
+    it('should call "inspectInstanceWrapper"', async () => {
+      expect(
+        inspectInstanceWrapperStub.calledWith(
+          moduleMock.providers.get(testProviderToken),
+          moduleMock as any,
+        ),
+      ).to.be.true;
     });
-    module.controllers.set('TestRoute', wrapper);
+  });
 
-    const modules = new Map();
-    modules.set('Test', module);
-    mockContainer.expects('getModules').returns(modules);
+  describe('for every controller in every module', () => {
+    let loadControllerStub: sinon.SinonStub;
 
-    sinon.stub(injector, 'loadProvider');
-    const loadRoutesStub = sinon.stub(injector, 'loadController');
+    beforeEach(async () => {
+      const wrapper = new InstanceWrapper({
+        name: 'TestRoute',
+        token: 'TestRoute',
+        instance: null,
+        metatype: TestCtrl,
+      });
+      moduleMock.controllers.set('TestRoute', wrapper);
 
-    await loader.createInstancesOfDependencies();
-    expect(
-      loadRoutesStub.calledWith(
-        module.controllers.get('TestRoute'),
-        module as any,
-      ),
-    ).to.be.true;
+      sinon.stub(injector, 'loadProvider');
+      loadControllerStub = sinon.stub(injector, 'loadController');
+
+      await loader.createInstancesOfDependencies();
+    });
+    it('should call "loadController"', async () => {
+      expect(
+        loadControllerStub.calledWith(
+          moduleMock.controllers.get('TestRoute'),
+          moduleMock as any,
+        ),
+      ).to.be.true;
+    });
+    it('should call "inspectInstanceWrapper"', async () => {
+      expect(
+        inspectInstanceWrapperStub.calledWith(
+          moduleMock.controllers.get('TestRoute'),
+          moduleMock as any,
+        ),
+      ).to.be.true;
+    });
   });
 
-  it('should call "loadInjectable" for each injectable in each module', async () => {
-    const injector = new Injector();
-    (loader as any).injector = injector;
+  describe('for every injectable in every module', () => {
+    let loadInjectableStub: sinon.SinonStub;
 
-    const module = {
-      providers: new Map(),
-      controllers: new Map(),
-      injectables: new Map(),
-      metatype: { name: 'test' },
-    };
-    const testComp = new InstanceWrapper({
-      instance: null,
-      metatype: TestProvider,
-      name: 'TestProvider',
-      token: 'TestProvider',
-    });
-    module.injectables.set('TestProvider', testComp);
+    beforeEach(async () => {
+      const testInjectable = new InstanceWrapper({
+        instance: null,
+        metatype: TestProvider,
+        name: 'TestProvider',
+        token: 'TestProvider',
+      });
+      moduleMock.injectables.set('TestProvider', testInjectable);
 
-    const modules = new Map();
-    modules.set('Test', module);
-    mockContainer.expects('getModules').returns(modules);
+      loadInjectableStub = sinon.stub(injector, 'loadInjectable');
+      sinon.stub(injector, 'loadController');
 
-    const loadInjectableStub = sinon.stub(injector, 'loadInjectable');
-    sinon.stub(injector, 'loadController');
+      await loader.createInstancesOfDependencies();
+    });
 
-    await loader.createInstancesOfDependencies();
-    expect(
-      loadInjectableStub.calledWith(
-        module.injectables.get('TestProvider'),
-        module as any,
-      ),
-    ).to.be.true;
+    it('should call "loadInjectable"', async () => {
+      expect(
+        loadInjectableStub.calledWith(
+          moduleMock.injectables.get('TestProvider'),
+          moduleMock as any,
+        ),
+      ).to.be.true;
+    });
+    it('should call "inspectInstanceWrapper"', async () => {
+      expect(
+        inspectInstanceWrapperStub.calledWith(
+          moduleMock.injectables.get('TestProvider'),
+          moduleMock as any,
+        ),
+      ).to.be.true;
+    });
   });
 });
diff --git a/packages/core/test/injector/instance-wrapper.spec.ts b/packages/core/test/injector/instance-wrapper.spec.ts
index b94cf4e1d..aedbf5d21 100644
--- a/packages/core/test/injector/instance-wrapper.spec.ts
+++ b/packages/core/test/injector/instance-wrapper.spec.ts
@@ -31,6 +31,39 @@ describe('InstanceWrapper', () => {
   });
 
   describe('isDependencyTreeStatic', () => {
+    describe('when circular reference', () => {
+      it('should return true', () => {
+        const wrapper = new InstanceWrapper();
+        const otherWrapper = new InstanceWrapper();
+        wrapper.addCtorMetadata(0, otherWrapper);
+        otherWrapper.addCtorMetadata(0, wrapper);
+        expect(wrapper.isDependencyTreeStatic()).to.be.true;
+        expect(otherWrapper.isDependencyTreeStatic()).to.be.true;
+      });
+    });
+    describe('when circular reference and one non static', () => {
+      it('should return false', () => {
+        const wrapper = new InstanceWrapper();
+        const otherWrapper = new InstanceWrapper({ scope: Scope.REQUEST });
+        wrapper.addCtorMetadata(0, otherWrapper);
+        otherWrapper.addCtorMetadata(0, wrapper);
+        expect(wrapper.isDependencyTreeStatic()).to.be.false;
+        expect(otherWrapper.isDependencyTreeStatic()).to.be.false;
+      });
+    });
+    describe('when circular reference and one durable', () => {
+      it('should return false', () => {
+        const wrapper = new InstanceWrapper();
+        const otherWrapper = new InstanceWrapper({
+          scope: Scope.REQUEST,
+          durable: true,
+        });
+        wrapper.addCtorMetadata(0, otherWrapper);
+        otherWrapper.addCtorMetadata(0, wrapper);
+        expect(wrapper.isDependencyTreeStatic()).to.be.false;
+        expect(otherWrapper.isDependencyTreeStatic()).to.be.false;
+      });
+    });
     describe('when request scoped', () => {
       it('should return false', () => {
         const wrapper = new InstanceWrapper({
@@ -39,7 +72,68 @@ describe('InstanceWrapper', () => {
         expect(wrapper.isDependencyTreeStatic()).to.be.false;
       });
     });
+    describe('when request scoped durable', () => {
+      it('should return false', () => {
+        const wrapper = new InstanceWrapper({
+          scope: Scope.REQUEST,
+          durable: true,
+        });
+        expect(wrapper.isDependencyTreeStatic()).to.be.false;
+      });
+    });
+    describe('when request scoped explicit non durable', () => {
+      it('should return false', () => {
+        const wrapper = new InstanceWrapper({
+          scope: Scope.REQUEST,
+          durable: false,
+        });
+        expect(wrapper.isDependencyTreeStatic()).to.be.false;
+      });
+    });
+    describe('when default', () => {
+      it('should return true', () => {
+        const wrapper = new InstanceWrapper({});
+        expect(wrapper.isDependencyTreeStatic()).to.be.true;
+      });
+    });
     describe('when statically scoped', () => {
+      describe('dependencies, properties, enhancers', () => {
+        describe('dependencies non static, properties static, enhancers static', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addCtorMetadata(
+              0,
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            wrapper.addPropertiesMetadata('key1', new InstanceWrapper());
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            expect(wrapper.isDependencyTreeStatic()).to.be.false;
+          });
+        });
+        describe('dependencies static, properties non static, enhancers static', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addCtorMetadata(0, new InstanceWrapper());
+            wrapper.addPropertiesMetadata(
+              'key1',
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            expect(wrapper.isDependencyTreeStatic()).to.be.false;
+          });
+        });
+        describe('dependencies static, properties static, enhancers non static', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addCtorMetadata(0, new InstanceWrapper());
+            wrapper.addPropertiesMetadata('key1', new InstanceWrapper());
+            wrapper.addEnhancerMetadata(
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            expect(wrapper.isDependencyTreeStatic()).to.be.false;
+          });
+        });
+      });
       describe('dependencies', () => {
         describe('when each is static', () => {
           it('should return true', () => {
@@ -106,6 +200,450 @@ describe('InstanceWrapper', () => {
     });
   });
 
+  describe('isDependencyTreeDurable', () => {
+    describe('when circular reference and default scope', () => {
+      it('should return false', () => {
+        const wrapper = new InstanceWrapper();
+        const otherWrapper = new InstanceWrapper();
+        wrapper.addCtorMetadata(0, otherWrapper);
+        otherWrapper.addCtorMetadata(0, wrapper);
+        expect(wrapper.isDependencyTreeDurable()).to.be.false;
+        expect(otherWrapper.isDependencyTreeDurable()).to.be.false;
+      });
+    });
+    describe('when circular reference and one non durable', () => {
+      it('should return false', () => {
+        const wrapper = new InstanceWrapper();
+        const otherWrapper = new InstanceWrapper({ scope: Scope.REQUEST });
+        wrapper.addCtorMetadata(0, otherWrapper);
+        otherWrapper.addCtorMetadata(0, wrapper);
+        expect(wrapper.isDependencyTreeDurable()).to.be.false;
+        expect(otherWrapper.isDependencyTreeDurable()).to.be.false;
+      });
+    });
+    describe('when circular reference and one durable', () => {
+      it('should return true', () => {
+        const wrapper = new InstanceWrapper();
+        const otherWrapper = new InstanceWrapper({
+          scope: Scope.REQUEST,
+          durable: true,
+        });
+        wrapper.addCtorMetadata(0, otherWrapper);
+        otherWrapper.addCtorMetadata(0, wrapper);
+        expect(wrapper.isDependencyTreeDurable()).to.be.true;
+        expect(otherWrapper.isDependencyTreeDurable()).to.be.true;
+      });
+    });
+    describe('when request scoped and durable', () => {
+      it('should return true', () => {
+        const wrapper = new InstanceWrapper({
+          scope: Scope.REQUEST,
+          durable: true,
+        });
+        expect(wrapper.isDependencyTreeDurable()).to.be.true;
+      });
+    });
+    describe('when request scoped and non durable', () => {
+      it('should return false', () => {
+        const wrapper = new InstanceWrapper({
+          scope: Scope.REQUEST,
+        });
+        expect(wrapper.isDependencyTreeDurable()).to.be.false;
+      });
+    });
+    describe('when request scoped and explicit non durable', () => {
+      it('should return false', () => {
+        const wrapper = new InstanceWrapper({
+          scope: Scope.REQUEST,
+          durable: false,
+        });
+        expect(wrapper.isDependencyTreeDurable()).to.be.false;
+      });
+    });
+    describe('when default scope', () => {
+      it('should return false', () => {
+        const wrapper = new InstanceWrapper();
+        expect(wrapper.isDependencyTreeDurable()).to.be.false;
+      });
+    });
+    describe('when statically scoped', () => {
+      describe('dependencies, properties, enhancers', () => {
+        describe('dependencies non durable, properties non durable, enhancers durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addCtorMetadata(
+              0,
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            wrapper.addCtorMetadata(1, new InstanceWrapper());
+            wrapper.addPropertiesMetadata('key1', new InstanceWrapper());
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('dependencies non durable, properties durable, enhancers durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addCtorMetadata(
+              0,
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            wrapper.addCtorMetadata(1, new InstanceWrapper());
+            wrapper.addPropertiesMetadata(
+              'key1',
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('dependencies non durable, properties durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addCtorMetadata(
+              0,
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            wrapper.addCtorMetadata(1, new InstanceWrapper());
+            wrapper.addPropertiesMetadata('key1', new InstanceWrapper());
+            wrapper.addPropertiesMetadata(
+              'key2',
+              new InstanceWrapper({ scope: Scope.REQUEST, durable: true }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('properties durable, enhancers non durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addPropertiesMetadata('key1', new InstanceWrapper());
+            wrapper.addPropertiesMetadata(
+              'key2',
+              new InstanceWrapper({ scope: Scope.REQUEST, durable: true }),
+            );
+            wrapper.addEnhancerMetadata(
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('dependencies durable, enhancers non durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addCtorMetadata(
+              0,
+              new InstanceWrapper({ scope: Scope.REQUEST, durable: true }),
+            );
+            wrapper.addEnhancerMetadata(
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+      });
+      describe('dependencies', () => {
+        describe('when wrapper is non durable and dependency is static', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper({ scope: Scope.REQUEST });
+            wrapper.addCtorMetadata(0, new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when wrapper is durable and dependency is static', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+              durable: true,
+            });
+            wrapper.addCtorMetadata(0, new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
+        describe('when wrapper is non durable and dependency is durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+            });
+            wrapper.addCtorMetadata(
+              0,
+              new InstanceWrapper({ scope: Scope.REQUEST, durable: true }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when wrapper is durable and dependency is static', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+              durable: true,
+            });
+            wrapper.addCtorMetadata(0, new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
+        describe('when wrapper is durable and dependency is non durable', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+              durable: true,
+            });
+            wrapper.addCtorMetadata(
+              0,
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
+        describe('when each is static', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addCtorMetadata(0, new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when one is not static and non-durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addCtorMetadata(0, new InstanceWrapper());
+            wrapper.addCtorMetadata(
+              1,
+              new InstanceWrapper({
+                scope: Scope.REQUEST,
+              }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when one is not static and durable', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addCtorMetadata(0, new InstanceWrapper());
+            wrapper.addCtorMetadata(
+              1,
+              new InstanceWrapper({
+                scope: Scope.REQUEST,
+                durable: true,
+              }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
+        describe('when one is not static, durable and non durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addCtorMetadata(0, new InstanceWrapper());
+            wrapper.addCtorMetadata(
+              1,
+              new InstanceWrapper({
+                scope: Scope.REQUEST,
+                durable: true,
+              }),
+            );
+            wrapper.addCtorMetadata(
+              2,
+              new InstanceWrapper({
+                scope: Scope.REQUEST,
+              }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+      });
+      describe('properties', () => {
+        describe('when wrapper is non durable and dependency is static', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper({ scope: Scope.REQUEST });
+            wrapper.addPropertiesMetadata('key1', new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when wrapper is durable and dependency is static', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+              durable: true,
+            });
+            wrapper.addPropertiesMetadata('key1', new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
+        describe('when wrapper is non durable and dependency is durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+            });
+            wrapper.addPropertiesMetadata(
+              'key1',
+              new InstanceWrapper({ scope: Scope.REQUEST, durable: true }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when wrapper is durable and dependency is static', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+              durable: true,
+            });
+            wrapper.addPropertiesMetadata('key1', new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
+        describe('when wrapper is durable and dependency is non durable', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+              durable: true,
+            });
+            wrapper.addPropertiesMetadata(
+              'key1',
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
+        describe('when each is static', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addPropertiesMetadata('key1', new InstanceWrapper());
+            wrapper.addPropertiesMetadata('key2', new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when one is not static and non-durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addPropertiesMetadata(
+              'key1',
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            wrapper.addPropertiesMetadata('key2', new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when one is not static and durable', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addPropertiesMetadata(
+              'key1',
+              new InstanceWrapper({ scope: Scope.REQUEST, durable: true }),
+            );
+            wrapper.addPropertiesMetadata('key2', new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
+        describe('when one is not static, non durable and durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addPropertiesMetadata(
+              'key1',
+              new InstanceWrapper({ scope: Scope.REQUEST, durable: true }),
+            );
+            wrapper.addPropertiesMetadata('key2', new InstanceWrapper());
+            wrapper.addPropertiesMetadata(
+              'key3',
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+      });
+      describe('enhancers', () => {
+        describe('when wrapper is non durable and dependency is static', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper({ scope: Scope.REQUEST });
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when wrapper is durable and dependency is static', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+              durable: true,
+            });
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
+        describe('when wrapper is non durable and dependency is durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+            });
+            wrapper.addEnhancerMetadata(
+              new InstanceWrapper({ scope: Scope.REQUEST, durable: true }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when wrapper is durable and dependency is static', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+              durable: true,
+            });
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
+        describe('when wrapper is durable and dependency is non durable', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper({
+              scope: Scope.REQUEST,
+              durable: true,
+            });
+            wrapper.addEnhancerMetadata(
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
+        describe('when each is static', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when one is not static and non-durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addEnhancerMetadata(
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+        describe('when one is not static and durable', () => {
+          it('should return true', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addEnhancerMetadata(
+              new InstanceWrapper({ scope: Scope.REQUEST, durable: true }),
+            );
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            expect(wrapper.isDependencyTreeDurable()).to.be.true;
+          });
+        });
+        describe('when one is not static, non durable and durable', () => {
+          it('should return false', () => {
+            const wrapper = new InstanceWrapper();
+            wrapper.addEnhancerMetadata(
+              new InstanceWrapper({ scope: Scope.REQUEST, durable: true }),
+            );
+            wrapper.addEnhancerMetadata(new InstanceWrapper());
+            wrapper.addEnhancerMetadata(
+              new InstanceWrapper({ scope: Scope.REQUEST }),
+            );
+            expect(wrapper.isDependencyTreeDurable()).to.be.false;
+          });
+        });
+      });
+    });
+  });
+
   describe('isNotMetatype', () => {
     describe('when metatype is nil', () => {
       it('should return true', () => {
@@ -322,4 +860,68 @@ describe('InstanceWrapper', () => {
       });
     });
   });
+
+  describe('mergeWith', () => {
+    describe('when provider is a ValueProvider', () => {
+      it('should provide the given value in the STATIC_CONTEXT', () => {
+        const wrapper = new InstanceWrapper();
+        wrapper.mergeWith({
+          useValue: 'value',
+          provide: 'token',
+        });
+
+        expect(
+          wrapper.getInstanceByContextId(STATIC_CONTEXT).instance,
+        ).to.be.equal('value');
+      });
+    });
+
+    describe('when provider is a ClassProvider', () => {
+      it('should alter the instance wrapper metatype with the given class', () => {
+        const wrapper = new InstanceWrapper();
+
+        wrapper.mergeWith({
+          useClass: TestClass,
+          provide: 'token',
+        });
+
+        expect(wrapper.metatype).to.be.eql(TestClass);
+      });
+    });
+
+    describe('when provider is a FactoryProvider', () => {
+      describe('and it has injected dependencies', () => {
+        it('should alter the instance wrapper metatype and inject attributes with the given values', () => {
+          const wrapper = new InstanceWrapper();
+
+          const factory = (_dependency1: any, _dependency2: any) => {};
+          const injectedDependencies = ['dependency1', 'dependency2'];
+
+          wrapper.mergeWith({
+            provide: 'token',
+            useFactory: factory,
+            inject: injectedDependencies,
+          });
+
+          expect(wrapper.metatype).to.be.eql(factory);
+          expect(wrapper.inject).to.be.eq(injectedDependencies);
+        });
+      });
+
+      describe('and it has no injected dependencies', () => {
+        it('should alter the instance wrapper metatype with the given values', () => {
+          const wrapper = new InstanceWrapper();
+          const factory = (_dependency1: any, _dependency2: any) => {};
+
+          wrapper.mergeWith({
+            provide: 'token',
+            useFactory: factory,
+          });
+
+          expect(wrapper.metatype).to.be.eql(factory);
+          expect(wrapper.inject).to.be.eql([]);
+        });
+      });
+    });
+  });
 });
diff --git a/packages/core/test/injector/internal-core-module-factory.spec.ts b/packages/core/test/injector/internal-core-module/internal-core-module-factory.spec.ts
similarity index 57%
rename from packages/core/test/injector/internal-core-module-factory.spec.ts
rename to packages/core/test/injector/internal-core-module/internal-core-module-factory.spec.ts
index 85cf9cfe5..989170044 100644
--- a/packages/core/test/injector/internal-core-module-factory.spec.ts
+++ b/packages/core/test/injector/internal-core-module/internal-core-module-factory.spec.ts
@@ -1,19 +1,21 @@
 import { ClassProvider, FactoryProvider } from '@nestjs/common';
 import { expect } from 'chai';
-import { ExternalContextCreator } from '../../helpers/external-context-creator';
-import { HttpAdapterHost } from '../../helpers/http-adapter-host';
-import { LazyModuleLoader, ModulesContainer } from '../../injector';
-import { NestContainer } from '../../injector/container';
-import { InternalCoreModule } from '../../injector/internal-core-module';
-import { InternalCoreModuleFactory } from '../../injector/internal-core-module-factory';
+import { ExternalContextCreator } from '../../../helpers/external-context-creator';
+import { HttpAdapterHost } from '../../../helpers/http-adapter-host';
+import { LazyModuleLoader, ModulesContainer } from '../../../injector';
+import { NestContainer } from '../../../injector/container';
+import { InternalCoreModule } from '../../../injector/internal-core-module/internal-core-module';
+import { InternalCoreModuleFactory } from '../../../injector/internal-core-module/internal-core-module-factory';
+import { SerializedGraph } from '../../../inspector/serialized-graph';
 
 describe('InternalCoreModuleFactory', () => {
-  it('should return the interal core module definition', () => {
+  it('should return the internal core module definition', () => {
     const moduleDefinition = InternalCoreModuleFactory.create(
       new NestContainer(),
       null,
       null,
       null,
+      null,
     );
 
     expect(moduleDefinition.module).to.equal(InternalCoreModule);
@@ -25,8 +27,8 @@ describe('InternalCoreModuleFactory', () => {
       ExternalContextCreator,
       ModulesContainer,
       HttpAdapterHost,
-      HttpAdapterHost.name,
       LazyModuleLoader,
+      SerializedGraph,
     ]);
 
     const lazyModuleLoaderProvider = moduleDefinition.providers.find(
diff --git a/packages/core/test/injector/lazy-module-loader.spec.ts b/packages/core/test/injector/lazy-module-loader/lazy-module-loader.spec.ts
similarity index 74%
rename from packages/core/test/injector/lazy-module-loader.spec.ts
rename to packages/core/test/injector/lazy-module-loader/lazy-module-loader.spec.ts
index 35b0f8a45..4f2645272 100644
--- a/packages/core/test/injector/lazy-module-loader.spec.ts
+++ b/packages/core/test/injector/lazy-module-loader/lazy-module-loader.spec.ts
@@ -5,10 +5,12 @@ import {
   ModuleRef,
   ModulesContainer,
   NestContainer,
-} from '../../injector';
-import { InstanceLoader } from '../../injector/instance-loader';
-import { MetadataScanner } from '../../metadata-scanner';
-import { DependenciesScanner } from '../../scanner';
+} from '../../../injector';
+import { Injector } from '../../../injector/injector';
+import { InstanceLoader } from '../../../injector/instance-loader';
+import { GraphInspector } from '../../../inspector/graph-inspector';
+import { MetadataScanner } from '../../../metadata-scanner';
+import { DependenciesScanner } from '../../../scanner';
 
 describe('LazyModuleLoader', () => {
   let lazyModuleLoader: LazyModuleLoader;
@@ -18,15 +20,26 @@ describe('LazyModuleLoader', () => {
 
   class NoopLogger {
     log() {}
+    error() {}
+    warn() {}
   }
 
   beforeEach(() => {
     const nestContainer = new NestContainer();
+    const graphInspector = new GraphInspector(nestContainer);
     dependenciesScanner = new DependenciesScanner(
       nestContainer,
       new MetadataScanner(),
+      graphInspector,
+    );
+
+    const injector = new Injector();
+    instanceLoader = new InstanceLoader(
+      nestContainer,
+      injector,
+      graphInspector,
+      new NoopLogger(),
     );
-    instanceLoader = new InstanceLoader(nestContainer, new NoopLogger() as any);
     modulesContainer = nestContainer.getModules();
     lazyModuleLoader = new LazyModuleLoader(
       dependenciesScanner,
diff --git a/packages/core/test/injector/module-token-factory.spec.ts b/packages/core/test/injector/module-token-factory.spec.ts
index ed78b734e..22bda3e37 100644
--- a/packages/core/test/injector/module-token-factory.spec.ts
+++ b/packages/core/test/injector/module-token-factory.spec.ts
@@ -1,6 +1,4 @@
 import { expect } from 'chai';
-import stringify from 'fast-safe-stringify';
-import * as hash from 'object-hash';
 import * as sinon from 'sinon';
 import { ModuleTokenFactory } from '../../injector/module-token-factory';
 
@@ -16,30 +14,20 @@ describe('ModuleTokenFactory', () => {
     class Module {}
     it('should return expected token', () => {
       const type = Module;
-      const token = factory.create(type, undefined);
-      expect(token).to.be.deep.eq(
-        hash({
-          id: moduleId,
-          module: Module.name,
-          dynamic: '',
-        }),
-      );
+      const token1 = factory.create(type, undefined);
+      const token2 = factory.create(type, undefined);
+      expect(token1).to.be.deep.eq(token2);
     });
     it('should include dynamic metadata', () => {
       const type = Module;
-      const token = factory.create(type, {
+      const token1 = factory.create(type, {
+        providers: [{}],
+      } as any);
+      const token2 = factory.create(type, {
         providers: [{}],
       } as any);
 
-      expect(token).to.be.deep.eq(
-        hash({
-          id: moduleId,
-          module: Module.name,
-          dynamic: stringify({
-            providers: [{}],
-          }),
-        }),
-      );
+      expect(token1).to.be.deep.eq(token2);
     });
   });
   describe('getModuleName', () => {
@@ -48,21 +36,31 @@ describe('ModuleTokenFactory', () => {
       expect(factory.getModuleName(metatype as any)).to.be.eql(metatype.name);
     });
   });
-  describe('getDynamicMetadataToken', () => {
+  describe('getStringifiedOpaqueToken', () => {
     describe('when metadata exists', () => {
       it('should return hash', () => {
         const metadata = { providers: ['', {}] };
-        expect(factory.getDynamicMetadataToken(metadata as any)).to.be.eql(
+        expect(factory.getStringifiedOpaqueToken(metadata as any)).to.be.eql(
           JSON.stringify(metadata),
         );
       });
       it('should return hash with class', () => {
         class Provider {}
         const metadata = { providers: [Provider], exports: [Provider] };
-        expect(factory.getDynamicMetadataToken(metadata)).to.be.eql(
+        expect(factory.getStringifiedOpaqueToken(metadata)).to.be.eql(
           '{"providers":["Provider"],"exports":["Provider"]}',
         );
       });
+      it('should return hash with value provider with non-class function', () => {
+        const provider = {
+          provide: 'ProvideValue',
+          useValue: function Provider() {},
+        };
+        const metadata = { providers: [provider] };
+        expect(factory.getStringifiedOpaqueToken(metadata)).to.be.eql(
+          `{"providers":[{"provide":"ProvideValue","useValue":"${provider.useValue.toString()}"}]}`,
+        );
+      });
       it('should serialize symbols in a dynamic metadata object', () => {
         const metadata = {
           providers: [
@@ -77,14 +75,14 @@ describe('ModuleTokenFactory', () => {
           ],
         };
 
-        expect(factory.getDynamicMetadataToken(metadata)).to.be.eql(
+        expect(factory.getStringifiedOpaqueToken(metadata)).to.be.eql(
           '{"providers":[{"provide":"Symbol(a)","useValue":"a"},{"provide":"Symbol(b)","useValue":"b"}]}',
         );
       });
     });
     describe('when metadata does not exist', () => {
       it('should return empty string', () => {
-        expect(factory.getDynamicMetadataToken(undefined)).to.be.eql('');
+        expect(factory.getStringifiedOpaqueToken(undefined)).to.be.eql('');
       });
     });
   });
diff --git a/packages/core/test/injector/module.spec.ts b/packages/core/test/injector/module.spec.ts
index 04581b726..fb8665d15 100644
--- a/packages/core/test/injector/module.spec.ts
+++ b/packages/core/test/injector/module.spec.ts
@@ -30,7 +30,7 @@ describe('Module', () => {
     const setSpy = sinon.spy(collection, 'set');
     (module as any)._controllers = collection;
 
-    @Controller({ scope: Scope.REQUEST })
+    @Controller({ scope: Scope.REQUEST, durable: true })
     class Test {}
 
     module.addController(Test);
@@ -43,6 +43,7 @@ describe('Module', () => {
           name: 'Test',
           scope: Scope.REQUEST,
           metatype: Test,
+          durable: true,
           instance: null,
           isResolved: false,
         }),
@@ -55,7 +56,7 @@ describe('Module', () => {
     const setSpy = sinon.spy(collection, 'set');
     (module as any)._injectables = collection;
 
-    module.addInjectable(TestProvider, TestModule);
+    module.addInjectable(TestProvider, 'interceptor', TestModule);
     expect(
       setSpy.calledWith(
         TestProvider,
@@ -66,7 +67,9 @@ describe('Module', () => {
           scope: undefined,
           metatype: TestProvider,
           instance: null,
+          durable: undefined,
           isResolved: false,
+          subtype: 'interceptor',
         }),
       ),
     ).to.be.true;
@@ -76,7 +79,7 @@ describe('Module', () => {
     it('should call `addCustomProvider`', () => {
       const addCustomProviderSpy = sinon.spy(module, 'addCustomProvider');
 
-      module.addInjectable({ provide: 'test' } as any);
+      module.addInjectable({ provide: 'test' } as any, 'guard');
       expect(addCustomProviderSpy.called).to.be.true;
     });
   });
@@ -96,6 +99,7 @@ describe('Module', () => {
           token: TestProvider,
           scope: undefined,
           metatype: TestProvider,
+          durable: undefined,
           instance: null,
           isResolved: false,
         }),
@@ -133,6 +137,16 @@ describe('Module', () => {
     expect((addCustomValue as sinon.SinonSpy).called).to.be.true;
   });
 
+  it('should call "addCustomValue" when "useValue" property exists but its value is `undefined`', () => {
+    const addCustomValue = sinon.spy();
+    module.addCustomValue = addCustomValue;
+
+    const provider = { provide: 'test', useValue: undefined };
+
+    module.addCustomProvider(provider as any, new Map());
+    expect((addCustomValue as sinon.SinonSpy).called).to.be.true;
+  });
+
   it('should call "addCustomFactory" when "useFactory" property exists', () => {
     const addCustomFactory = sinon.spy();
     module.addCustomFactory = addCustomFactory;
@@ -155,7 +169,7 @@ describe('Module', () => {
 
   describe('addCustomClass', () => {
     const type = { name: 'TypeTest' };
-    const provider = { provide: type, useClass: type };
+    const provider = { provide: type, useClass: type, durable: true };
     let setSpy;
 
     beforeEach(() => {
@@ -174,8 +188,10 @@ describe('Module', () => {
             name: provider.provide.name,
             scope: undefined,
             metatype: type as any,
+            durable: true,
             instance: null,
             isResolved: false,
+            subtype: undefined,
           }),
         ),
       ).to.be.true;
@@ -207,6 +223,7 @@ describe('Module', () => {
             instance: value,
             isResolved: true,
             async: false,
+            subtype: undefined,
           }),
         ),
       ).to.be.true;
@@ -216,7 +233,7 @@ describe('Module', () => {
   describe('addCustomFactory', () => {
     const type = { name: 'TypeTest' };
     const inject = [1, 2, 3];
-    const provider = { provide: type, useFactory: type, inject };
+    const provider = { provide: type, useFactory: type, inject, durable: true };
 
     let setSpy;
     beforeEach(() => {
@@ -236,9 +253,11 @@ describe('Module', () => {
             name: provider.provide.name,
             scope: undefined,
             metatype: type as any,
+            durable: true,
             instance: null,
             isResolved: false,
             inject: inject as any,
+            subtype: undefined,
           }),
         ),
       ).to.be.true;
@@ -274,6 +293,7 @@ describe('Module', () => {
             inject: [provider.useExisting as any],
             isResolved: false,
             isAlias: true,
+            subtype: undefined,
           }),
         ),
       ).to.be.true;
diff --git a/packages/core/test/inspector/graph-inspector.spec.ts b/packages/core/test/inspector/graph-inspector.spec.ts
new file mode 100644
index 000000000..e7dea4142
--- /dev/null
+++ b/packages/core/test/inspector/graph-inspector.spec.ts
@@ -0,0 +1,219 @@
+import { Scope } from '@nestjs/common';
+import { expect } from 'chai';
+import * as sinon from 'sinon';
+import { NestContainer } from '../../injector/container';
+import { InstanceWrapper } from '../../injector/instance-wrapper';
+import { Module } from '../../injector/module';
+import { GraphInspector } from '../../inspector/graph-inspector';
+import { EnhancerMetadataCacheEntry } from '../../inspector/interfaces/enhancer-metadata-cache-entry.interface';
+import { SerializedGraph } from '../../inspector/serialized-graph';
+
+describe('GraphInspector', () => {
+  let graphInspector: GraphInspector;
+  let enhancersMetadataCache: Array<EnhancerMetadataCacheEntry>;
+  let graph: SerializedGraph;
+  let container: NestContainer;
+
+  beforeEach(() => {
+    container = new NestContainer();
+    graphInspector = new GraphInspector(container);
+
+    enhancersMetadataCache = graphInspector['enhancersMetadataCache'];
+    graph = graphInspector['graph'];
+  });
+
+  describe('insertEnhancerMetadataCache', () => {
+    it('should insert an enhancer metadata cache entry', () => {
+      const entry = {
+        moduleToken: 'moduleToken',
+        classRef: class AppService {},
+        methodKey: undefined,
+        subtype: 'guard' as const,
+      };
+      graphInspector.insertEnhancerMetadataCache(entry);
+      expect(enhancersMetadataCache).includes(entry);
+    });
+  });
+
+  describe('inspectInstanceWrapper', () => {
+    class AppService {}
+
+    it('should inspect given instance wrapper and insert appropriate edges', () => {
+      const moduleRef = new Module(class TestModule {}, container);
+      const instanceWrapper = new InstanceWrapper({
+        token: AppService,
+        name: AppService.name,
+        metatype: AppService,
+      });
+
+      const param1 = new InstanceWrapper({
+        token: 'PARAM_1',
+        metatype: class A {},
+        host: new Module(class AModule {}, container),
+      });
+      const param2 = new InstanceWrapper({
+        token: 'PARAM_2',
+        metatype: class B {},
+        host: new Module(class BModule {}, container),
+      });
+      const dependency = new InstanceWrapper({
+        name: 'PROPERTY',
+        token: 'PROPERTY',
+        metatype: class C {},
+        host: new Module(class CModule {}, container),
+      });
+
+      instanceWrapper.addCtorMetadata(0, param1);
+      instanceWrapper.addCtorMetadata(1, param2);
+      instanceWrapper.addCtorMetadata(2, dependency);
+
+      graphInspector.inspectInstanceWrapper(instanceWrapper, moduleRef);
+
+      const edgesArr = [...graph['edges'].values()];
+      expect(edgesArr).to.deep.equal([
+        {
+          id: edgesArr[0].id,
+          metadata: {
+            injectionType: 'constructor',
+            keyOrIndex: 0,
+            sourceClassName: instanceWrapper.metatype.name,
+            sourceClassToken: instanceWrapper.token,
+            sourceModuleName: 'TestModule',
+            targetClassName: param1.name,
+            targetClassToken: 'PARAM_1',
+            targetModuleName: 'AModule',
+            type: 'class-to-class',
+          },
+          source: instanceWrapper.id,
+          target: param1.id,
+        },
+        {
+          id: edgesArr[1].id,
+          metadata: {
+            injectionType: 'constructor',
+            keyOrIndex: 1,
+            sourceClassName: instanceWrapper.metatype.name,
+            sourceClassToken: instanceWrapper.token,
+            sourceModuleName: 'TestModule',
+            targetClassName: param2.name,
+            targetClassToken: 'PARAM_2',
+            targetModuleName: 'BModule',
+            type: 'class-to-class',
+          },
+          source: instanceWrapper.id,
+          target: param2.id,
+        },
+        {
+          id: edgesArr[2].id,
+          metadata: {
+            injectionType: 'constructor',
+            keyOrIndex: 2,
+            sourceClassName: 'AppService',
+            sourceClassToken: AppService,
+            sourceModuleName: 'TestModule',
+            targetClassName: dependency.name,
+            targetClassToken: 'PROPERTY',
+            targetModuleName: 'CModule',
+            type: 'class-to-class',
+          },
+          source: instanceWrapper.id,
+          target: dependency.id,
+        },
+      ]);
+    });
+  });
+
+  describe('inspectModules', () => {
+    class TestModule {}
+    class AController {}
+    class RandomPipe {}
+
+    it('should inspect all modules', async () => {
+      const moduleRef = await container.addModule(TestModule, []);
+      moduleRef.addController(AController);
+
+      const subtype = 'interceptor';
+      const enhancerInstanceWrapper = moduleRef.addInjectable(
+        class Enhancer {},
+        subtype,
+      ) as InstanceWrapper;
+
+      const methodKey = 'findOne';
+      enhancersMetadataCache.push(
+        {
+          moduleToken: moduleRef.token,
+          classRef: AController,
+          enhancerRef: new RandomPipe(),
+          methodKey,
+          subtype,
+        },
+        {
+          moduleToken: moduleRef.token,
+          classRef: AController,
+          enhancerRef: function test() {},
+          methodKey,
+          subtype,
+        },
+        {
+          moduleToken: moduleRef.token,
+          classRef: AController,
+          enhancerInstanceWrapper,
+          methodKey: undefined,
+          subtype,
+        },
+      );
+
+      const serializedNode = { metadata: {} };
+      sinon.stub(graph, 'getNodeById').callsFake(() => serializedNode as any);
+
+      graphInspector.inspectModules();
+
+      expect(serializedNode).to.deep.equal({
+        metadata: {
+          enhancers: [
+            { methodKey, name: RandomPipe.name, subtype },
+            { methodKey, name: 'Function', subtype },
+            { methodKey: undefined, id: enhancerInstanceWrapper.id, subtype },
+          ],
+        },
+      });
+    });
+  });
+
+  describe('insertAttachedEnhancer', () => {
+    it('should upsert existing node (update metadata) and add node to "attachedEnhancers" array', () => {
+      const instanceWrapper = new InstanceWrapper({
+        metatype: class A {},
+        token: 'A',
+      });
+
+      const nodeDefinition = {
+        id: instanceWrapper.id,
+        label: 'A',
+        parent: '2c989d11-2731-4828-a2eb-c86d10c73621',
+        metadata: {
+          type: 'provider' as const,
+          sourceModuleName: 'AppModule',
+          durable: false,
+          static: true,
+          scope: Scope.DEFAULT,
+          transient: false,
+          token: class A {},
+          exported: false,
+          initTime: 100,
+        },
+      };
+      const insertedNode = graph.insertNode(nodeDefinition);
+
+      graphInspector.insertAttachedEnhancer(instanceWrapper);
+
+      expect(insertedNode.metadata).to.deep.equal({
+        ...nodeDefinition.metadata,
+        global: true,
+      });
+      expect(graph['extras'].attachedEnhancers).to.deep.contain({
+        nodeId: insertedNode.id,
+      });
+    });
+  });
+});
diff --git a/packages/core/test/inspector/serialized-graph.spec.ts b/packages/core/test/inspector/serialized-graph.spec.ts
new file mode 100644
index 000000000..25c5bd15a
--- /dev/null
+++ b/packages/core/test/inspector/serialized-graph.spec.ts
@@ -0,0 +1,160 @@
+import { Scope } from '@nestjs/common';
+import { expect } from 'chai';
+import { ApplicationConfig } from '../../application-config';
+import { Edge } from '../../inspector/interfaces/edge.interface';
+import { Node } from '../../inspector/interfaces/node.interface';
+import { SerializedGraph } from '../../inspector/serialized-graph';
+
+describe('SerializedGraph', () => {
+  let serializedGraph: SerializedGraph;
+  let nodesCollection: Map<string, Node>;
+  let edgesCollection: Map<string, Edge>;
+
+  beforeEach(() => {
+    serializedGraph = new SerializedGraph();
+    nodesCollection = serializedGraph['nodes'];
+    edgesCollection = serializedGraph['edges'];
+  });
+
+  describe('insertNode', () => {
+    describe('when node definition represents an internal provider', () => {
+      it('should insert a node with the expected schema (internal: true)', () => {
+        const nodeDefinition = {
+          id: '11430093-e992-4ae6-8ba4-c7db80419de8',
+          label: 'ApplicationConfig',
+          parent: '2c989d11-2731-4828-a2eb-c86d10c73621',
+          metadata: {
+            type: 'provider' as const,
+            sourceModuleName: 'AppModule',
+            durable: false,
+            static: true,
+            transient: false,
+            token: ApplicationConfig,
+            scope: Scope.DEFAULT,
+            exported: false,
+            initTime: 100,
+          },
+        };
+        serializedGraph.insertNode(nodeDefinition);
+
+        expect(nodesCollection.get(nodeDefinition.id)).to.deep.equal({
+          ...nodeDefinition,
+          metadata: {
+            ...nodeDefinition.metadata,
+            internal: true,
+          },
+        });
+      });
+    });
+    describe('otherwise', () => {
+      it('should insert a node with the expected schema', () => {
+        class AppService {}
+
+        const nodeDefinition = {
+          id: '11430093-e992-4ae6-8ba4-c7db80419de8',
+          label: 'AppService',
+          parent: '2c989d11-2731-4828-a2eb-c86d10c73621',
+          metadata: {
+            type: 'provider' as const,
+            sourceModuleName: 'AppModule',
+            durable: false,
+            static: true,
+            transient: false,
+            token: AppService,
+            scope: Scope.DEFAULT,
+            exported: false,
+            initTime: 100,
+          },
+        };
+        serializedGraph.insertNode(nodeDefinition);
+
+        expect(nodesCollection.get(nodeDefinition.id)).to.equal(nodeDefinition);
+      });
+    });
+  });
+
+  describe('insertEdge', () => {
+    describe('when edge definition represents internal providers connection', () => {
+      it('should insert an edge with the expected schema (internal: true)', () => {
+        const edgeDefinition = {
+          source: '8920252f-4e7d-4f9e-9eeb-71da467a35cc',
+          target: 'c97bc04d-cfcf-41b1-96ec-db729f33676e',
+          metadata: {
+            type: 'class-to-class' as const,
+            sourceModuleName: 'UtilsExceptionsModule',
+            sourceClassName: 'AllExceptionsFilter',
+            targetClassName: 'HttpAdapterHost',
+            sourceClassToken:
+              'APP_FILTER (UUID: 4187828c-5c76-4aed-a29f-a6eb40054b9d)',
+            targetClassToken: 'HttpAdapterHost',
+            targetModuleName: 'InternalCoreModule',
+            keyOrIndex: 0,
+            injectionType: 'constructor' as const,
+          },
+        };
+        const edge = serializedGraph.insertEdge(edgeDefinition);
+
+        expect(edgesCollection.get(edge.id)).to.deep.equal({
+          ...edgeDefinition,
+          metadata: {
+            ...edgeDefinition.metadata,
+            internal: true,
+          },
+          id: edge.id,
+        });
+      });
+    });
+    describe('otherwise', () => {
+      it('should insert an edge with the expected schema', () => {
+        const edgeDefinition = {
+          source: '8920252f-4e7d-4f9e-9eeb-71da467a35cc',
+          target: 'c97bc04d-cfcf-41b1-96ec-db729f33676e',
+          metadata: {
+            type: 'class-to-class' as const,
+            sourceModuleName: 'UtilsExceptionsModule',
+            sourceClassName: 'AllExceptionsFilter',
+            targetClassName: 'AppService',
+            sourceClassToken:
+              'APP_FILTER (UUID: 4187828c-5c76-4aed-a29f-a6eb40054b9d)',
+            targetClassToken: 'AppService',
+            targetModuleName: 'InternalCoreModule',
+            keyOrIndex: 0,
+            injectionType: 'constructor' as const,
+          },
+        };
+        const edge = serializedGraph.insertEdge(edgeDefinition);
+
+        expect(edgesCollection.get(edge.id)).to.deep.equal({
+          ...edgeDefinition,
+          id: edge.id,
+        });
+      });
+    });
+  });
+
+  describe('getNodeById', () => {
+    it('should return a given node', () => {
+      const nodeDefinition = {
+        id: '11430093-e992-4ae6-8ba4-c7db80419de8',
+        label: 'AppService',
+        parent: '2c989d11-2731-4828-a2eb-c86d10c73621',
+        metadata: {
+          type: 'provider' as const,
+          sourceModuleName: 'AppModule',
+          durable: false,
+          static: true,
+          transient: false,
+          scope: Scope.DEFAULT,
+          token: 'AppService',
+          exported: true,
+          initTime: 100,
+        },
+      };
+
+      nodesCollection.set(nodeDefinition.id, nodeDefinition);
+      expect(serializedGraph.getNodeById(nodeDefinition.id)).to.eq(
+        nodeDefinition,
+      );
+    });
+  });
+});
diff --git a/packages/core/test/interceptors/interceptors-consumer.spec.ts b/packages/core/test/interceptors/interceptors-consumer.spec.ts
index d2efbcaf4..268950fcf 100644
--- a/packages/core/test/interceptors/interceptors-consumer.spec.ts
+++ b/packages/core/test/interceptors/interceptors-consumer.spec.ts
@@ -1,5 +1,7 @@
+import { CallHandler, ExecutionContext, NestInterceptor } from '@nestjs/common';
+import { AsyncLocalStorage } from 'async_hooks';
 import { expect } from 'chai';
-import { lastValueFrom, of } from 'rxjs';
+import { lastValueFrom, Observable, of } from 'rxjs';
 import * as sinon from 'sinon';
 import { InterceptorsConsumer } from '../../interceptors/interceptors-consumer';
 
@@ -35,7 +37,7 @@ describe('InterceptorsConsumer', () => {
       beforeEach(() => {
         next = sinon.stub().returns(Promise.resolve(''));
       });
-      it('should call every `intercept` method', async () => {
+      it('does not call `intercept` (lazy evaluation)', async () => {
         await consumer.intercept(
           interceptors,
           null,
@@ -44,6 +46,19 @@ describe('InterceptorsConsumer', () => {
           next,
         );
 
+        expect(interceptors[0].intercept.called).to.be.false;
+        expect(interceptors[1].intercept.called).to.be.false;
+      });
+      it('should call every `intercept` method when subscribe', async () => {
+        const intercepted = await consumer.intercept(
+          interceptors,
+          null,
+          { constructor: null },
+          null,
+          next,
+        );
+        await transformToResult(intercepted);
+
         expect(interceptors[0].intercept.calledOnce).to.be.true;
         expect(interceptors[1].intercept.calledOnce).to.be.true;
       });
@@ -58,15 +73,6 @@ describe('InterceptorsConsumer', () => {
         expect(next.called).to.be.false;
       });
       it('should call `next` when subscribe', async () => {
-        async function transformToResult(resultOrDeferred: any) {
-          if (
-            resultOrDeferred &&
-            typeof resultOrDeferred.subscribe === 'function'
-          ) {
-            return lastValueFrom(resultOrDeferred);
-          }
-          return resultOrDeferred;
-        }
         const intercepted = await consumer.intercept(
           interceptors,
           null,
@@ -78,6 +84,30 @@ describe('InterceptorsConsumer', () => {
         expect(next.called).to.be.true;
       });
     });
+
+    describe('AsyncLocalStorage', () => {
+      it('Allows an interceptor to set values in AsyncLocalStorage that are accesible from the controller', async () => {
+        const storage = new AsyncLocalStorage<Record<string, any>>({});
+        class StorageInterceptor implements NestInterceptor {
+          intercept(
+            _context: ExecutionContext,
+            next: CallHandler<any>,
+          ): Observable<any> | Promise<Observable<any>> {
+            return storage.run({ value: 'hello' }, () => next.handle());
+          }
+        }
+        const next = () => Promise.resolve(storage.getStore().value);
+        const intercepted = await consumer.intercept(
+          [new StorageInterceptor()],
+          null,
+          { constructor: null },
+          null,
+          next,
+        );
+        const result = await transformToResult(intercepted);
+        expect(result).to.equal('hello');
+      });
+    });
   });
   describe('createContext', () => {
     it('should return execution context object', () => {
@@ -119,3 +149,10 @@ describe('InterceptorsConsumer', () => {
     });
   });
 });
+
+async function transformToResult(resultOrDeferred: any) {
+  if (resultOrDeferred && typeof resultOrDeferred.subscribe === 'function') {
+    return lastValueFrom(resultOrDeferred);
+  }
+  return resultOrDeferred;
+}
diff --git a/packages/core/test/metadata-scanner.spec.ts b/packages/core/test/metadata-scanner.spec.ts
index f0a51b6d0..dd2c78b3f 100644
--- a/packages/core/test/metadata-scanner.spec.ts
+++ b/packages/core/test/metadata-scanner.spec.ts
@@ -30,12 +30,32 @@ describe('MetadataScanner', () => {
     }
 
     it('should return only methods', () => {
-      const methods = scanner.scanFromPrototype(
+      const methods = scanner.getAllMethodNames(Test.prototype);
+      expect(methods).to.eql(['test', 'test2', 'testParent', 'testParent2']);
+    });
+
+    it('should return the same instance for the same prototype', () => {
+      const methods1 = scanner.getAllMethodNames(Test.prototype);
+      const methods2 = scanner.getAllMethodNames(Test.prototype);
+      expect(methods1 === methods2).to.eql(true);
+    });
+
+    it('should keep compatibility with older methods', () => {
+      const methods1 = scanner.getAllMethodNames(Test.prototype).map(m => m[0]);
+      const methods2 = scanner.scanFromPrototype(
         new Test(),
         Test.prototype,
-        a => a,
+        r => r[0],
       );
-      expect(methods).to.eql(['test', 'test2', 'testParent', 'testParent2']);
+
+      expect(methods1).to.eql(methods2);
+
+      const methods3 = scanner.getAllMethodNames(Test.prototype);
+      const methods4 = [
+        ...new Set(scanner.getAllFilteredMethodNames(Test.prototype)),
+      ];
+
+      expect(methods3).to.eql(methods4);
     });
   });
 });
diff --git a/packages/core/test/middleware/builder.spec.ts b/packages/core/test/middleware/builder.spec.ts
index 1cc6e144d..bba4943a9 100644
--- a/packages/core/test/middleware/builder.spec.ts
+++ b/packages/core/test/middleware/builder.spec.ts
@@ -1,7 +1,9 @@
 import { expect } from 'chai';
-import { Controller, Get } from '../../../common';
+import { Controller, Get, RequestMethod, Version } from '../../../common';
+import { ApplicationConfig } from '../../application-config';
 import { NestContainer } from '../../injector/container';
 import { MiddlewareBuilder } from '../../middleware/builder';
+import { RouteInfoPathExtractor } from '../../middleware/route-info-path-extractor';
 import { RoutesMapper } from '../../middleware/routes-mapper';
 import { NoopHttpAdapter } from './../utils/noop-adapter.spec';
 
@@ -10,9 +12,11 @@ describe('MiddlewareBuilder', () => {
 
   beforeEach(() => {
     const container = new NestContainer();
+    const appConfig = new ApplicationConfig();
     builder = new MiddlewareBuilder(
       new RoutesMapper(container),
       new NoopHttpAdapter({}),
+      new RouteInfoPathExtractor(appConfig),
     );
   });
   describe('apply', () => {
@@ -30,8 +34,12 @@ describe('MiddlewareBuilder', () => {
         class Test {
           @Get('route')
           public getAll() {}
+
+          @Version('1')
+          @Get('versioned')
+          public getAllVersioned() {}
         }
-        const route = { path: '/test', method: 0 };
+        const route = { path: '/test', method: RequestMethod.GET };
         it('should store configuration passed as argument', () => {
           configProxy.forRoutes(route, Test);
 
@@ -40,13 +48,18 @@ describe('MiddlewareBuilder', () => {
               middleware: [],
               forRoutes: [
                 {
-                  method: 0,
+                  method: RequestMethod.GET,
                   path: route.path,
                 },
                 {
-                  method: 0,
+                  method: RequestMethod.GET,
                   path: '/path/route',
                 },
+                {
+                  method: RequestMethod.GET,
+                  path: '/path/versioned',
+                  version: '1',
+                },
               ],
             },
           ]);
@@ -63,7 +76,7 @@ describe('MiddlewareBuilder', () => {
       expect(proxy.getExcludedRoutes()).to.be.eql([
         {
           path,
-          method: -1,
+          method: -1 as any,
         },
       ]);
     });
diff --git a/packages/core/test/middleware/middleware-module.spec.ts b/packages/core/test/middleware/middleware-module.spec.ts
index 0b8d44f44..91639e3f0 100644
--- a/packages/core/test/middleware/middleware-module.spec.ts
+++ b/packages/core/test/middleware/middleware-module.spec.ts
@@ -1,5 +1,8 @@
 import { Injectable } from '@nestjs/common';
+import { RouteInfoPathExtractor } from '@nestjs/core/middleware/route-info-path-extractor';
+import * as chai from 'chai';
 import { expect } from 'chai';
+import * as chaiAsPromised from 'chai-as-promised';
 import * as sinon from 'sinon';
 import { Controller } from '../../../common/decorators/core/controller.decorator';
 import { RequestMapping } from '../../../common/decorators/http/request-mapping.decorator';
@@ -11,14 +14,18 @@ import { RuntimeException } from '../../errors/exceptions/runtime.exception';
 import { NestContainer } from '../../injector/container';
 import { InstanceWrapper } from '../../injector/instance-wrapper';
 import { Module } from '../../injector/module';
+import { GraphInspector } from '../../inspector/graph-inspector';
 import { MiddlewareBuilder } from '../../middleware/builder';
 import { MiddlewareContainer } from '../../middleware/container';
 import { MiddlewareModule } from '../../middleware/middleware-module';
 import { RouterExceptionFilters } from '../../router/router-exception-filters';
 import { NoopHttpAdapter } from '../utils/noop-adapter.spec';
 
+chai.use(chaiAsPromised);
+
 describe('MiddlewareModule', () => {
   let middlewareModule: MiddlewareModule;
+  let graphInspector: GraphInspector;
 
   @Controller('test')
   class BasicController {}
@@ -38,15 +45,24 @@ describe('MiddlewareModule', () => {
   }
 
   beforeEach(() => {
+    const container = new NestContainer();
     const appConfig = new ApplicationConfig();
+    graphInspector = new GraphInspector(container);
     middlewareModule = new MiddlewareModule();
-    (middlewareModule as any).routerExceptionFilter =
-      new RouterExceptionFilters(
-        new NestContainer(),
-        appConfig,
-        new NoopHttpAdapter({}),
-      );
-    (middlewareModule as any).config = appConfig;
+    middlewareModule['routerExceptionFilter'] = new RouterExceptionFilters(
+      new NestContainer(),
+      appConfig,
+      new NoopHttpAdapter({}),
+    );
+    middlewareModule['routeInfoPathExtractor'] = new RouteInfoPathExtractor(
+      appConfig,
+    );
+    middlewareModule['routerExceptionFilter'] = new RouterExceptionFilters(
+      container,
+      appConfig,
+      new NoopHttpAdapter({}),
+    );
+    middlewareModule['graphInspector'] = graphInspector;
   });
 
   describe('loadConfiguration', () => {
@@ -76,6 +92,7 @@ describe('MiddlewareModule', () => {
           new MiddlewareBuilder(
             (middlewareModule as any).routesMapper,
             undefined,
+            new RouteInfoPathExtractor(new ApplicationConfig()),
           ),
         ),
       ).to.be.true;
@@ -194,5 +211,69 @@ describe('MiddlewareModule', () => {
       );
       expect(createMiddlewareFactoryStub.calledOnce).to.be.true;
     });
+
+    it('should insert the expected middleware definition', async () => {
+      const route = 'testPath';
+      const configuration = {
+        middleware: [TestMiddleware],
+        forRoutes: ['test', BasicController, BaseController],
+      };
+      const instance = new TestMiddleware();
+      const instanceWrapper = new InstanceWrapper({
+        metatype: TestMiddleware,
+        instance,
+        name: TestMiddleware.name,
+      });
+      const createMiddlewareFactoryStub = sinon
+        .stub()
+        .callsFake(() => () => null);
+      const app = {
+        createMiddlewareFactory: createMiddlewareFactoryStub,
+      };
+
+      const stubContainer = new NestContainer();
+      stubContainer
+        .getModules()
+        .set('Test', new Module(TestModule, stubContainer));
+      const container = new MiddlewareContainer(stubContainer);
+      const moduleKey = 'Test';
+      container.insertConfig([configuration], moduleKey);
+      container
+        .getMiddlewareCollection(moduleKey)
+        .set(TestMiddleware, instanceWrapper);
+      sinon
+        .stub(stubContainer, 'getModuleByKey')
+        .callsFake(() => new Module(class {}, stubContainer));
+      middlewareModule['container'] = stubContainer;
+
+      const insertEntrypointDefinitionSpy = sinon.spy(
+        graphInspector,
+        'insertEntrypointDefinition',
+      );
+
+      await middlewareModule.registerRouteMiddleware(
+        container,
+        { path: route, method: RequestMethod.ALL },
+        configuration,
+        moduleKey,
+        app,
+      );
+
+      expect(createMiddlewareFactoryStub.calledOnce).to.be.true;
+      expect(
+        insertEntrypointDefinitionSpy.calledWith({
+          type: 'middleware',
+          methodName: 'use',
+          className: instanceWrapper.name,
+          classNodeId: instanceWrapper.id,
+          metadata: {
+            key: route,
+            path: route,
+            requestMethod: 'ALL',
+            version: undefined,
+          } as any,
+        }),
+      ).to.be.true;
+    });
   });
 });
diff --git a/packages/core/test/middleware/resolver.spec.ts b/packages/core/test/middleware/resolver.spec.ts
index 870e1ecfc..d57e4ee65 100644
--- a/packages/core/test/middleware/resolver.spec.ts
+++ b/packages/core/test/middleware/resolver.spec.ts
@@ -3,6 +3,7 @@ import * as sinon from 'sinon';
 import { Injectable } from '../../../common';
 import { NestMiddleware } from '../../../common/interfaces/middleware/nest-middleware.interface';
 import { NestContainer } from '../../injector';
+import { Injector } from '../../injector/injector';
 import { MiddlewareContainer } from '../../middleware/container';
 import { MiddlewareResolver } from '../../middleware/resolver';
 
@@ -17,16 +18,14 @@ describe('MiddlewareResolver', () => {
   let mockContainer: sinon.SinonMock;
 
   beforeEach(() => {
+    const injector = new Injector();
     container = new MiddlewareContainer(new NestContainer());
-    resolver = new MiddlewareResolver(container);
+    resolver = new MiddlewareResolver(container, injector);
     mockContainer = sinon.mock(container);
   });
 
   it('should resolve middleware instances from container', () => {
-    const loadMiddleware = sinon.stub(
-      resolver['instanceLoader'],
-      'loadMiddleware',
-    );
+    const loadMiddleware = sinon.stub(resolver['injector'], 'loadMiddleware');
     const middleware = new Map();
     const wrapper = {
       instance: { metatype: {} },
diff --git a/packages/core/test/middleware/route-info-path-extractor.spec.ts b/packages/core/test/middleware/route-info-path-extractor.spec.ts
new file mode 100644
index 000000000..967b26243
--- /dev/null
+++ b/packages/core/test/middleware/route-info-path-extractor.spec.ts
@@ -0,0 +1,185 @@
+import { RequestMethod, VersioningType } from '@nestjs/common';
+import { ApplicationConfig } from '@nestjs/core';
+import { mapToExcludeRoute } from '@nestjs/core/middleware/utils';
+import { expect } from 'chai';
+import { RouteInfoPathExtractor } from './../../middleware/route-info-path-extractor';
+
+describe('RouteInfoPathExtractor', () => {
+  describe('extractPathsFrom', () => {
+    let appConfig: ApplicationConfig;
+    let routeInfoPathExtractor: RouteInfoPathExtractor;
+
+    beforeEach(() => {
+      appConfig = new ApplicationConfig();
+      appConfig.enableVersioning({
+        type: VersioningType.URI,
+      });
+      routeInfoPathExtractor = new RouteInfoPathExtractor(appConfig);
+    });
+
+    it(`should return correct paths`, () => {
+      expect(
+        routeInfoPathExtractor.extractPathsFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+        }),
+      ).to.eql(['/*']);
+
+      expect(
+        routeInfoPathExtractor.extractPathsFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+          version: '1',
+        }),
+      ).to.eql(['/v1/*']);
+    });
+
+    it(`should return correct paths when set global prefix`, () => {
+      Reflect.set(routeInfoPathExtractor, 'prefixPath', '/api');
+
+      expect(
+        routeInfoPathExtractor.extractPathsFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+        }),
+      ).to.eql(['/api/*']);
+
+      expect(
+        routeInfoPathExtractor.extractPathsFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+          version: '1',
+        }),
+      ).to.eql(['/api/v1/*']);
+    });
+
+    it(`should return correct paths when set global prefix and global prefix options`, () => {
+      Reflect.set(routeInfoPathExtractor, 'prefixPath', '/api');
+      Reflect.set(
+        routeInfoPathExtractor,
+        'excludedGlobalPrefixRoutes',
+        mapToExcludeRoute(['foo']),
+      );
+
+      expect(
+        routeInfoPathExtractor.extractPathsFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+        }),
+      ).to.eql(['/api/*', '/foo']);
+
+      expect(
+        routeInfoPathExtractor.extractPathsFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+          version: '1',
+        }),
+      ).to.eql(['/api/v1/*', '/v1/foo']);
+
+      expect(
+        routeInfoPathExtractor.extractPathsFrom({
+          path: 'foo',
+          method: RequestMethod.ALL,
+          version: '1',
+        }),
+      ).to.eql(['/v1/foo']);
+
+      expect(
+        routeInfoPathExtractor.extractPathsFrom({
+          path: 'bar',
+          method: RequestMethod.ALL,
+          version: '1',
+        }),
+      ).to.eql(['/api/v1/bar']);
+    });
+  });
+
+  describe('extractPathFrom', () => {
+    let appConfig: ApplicationConfig;
+    let routeInfoPathExtractor: RouteInfoPathExtractor;
+
+    beforeEach(() => {
+      appConfig = new ApplicationConfig();
+      appConfig.enableVersioning({
+        type: VersioningType.URI,
+      });
+      routeInfoPathExtractor = new RouteInfoPathExtractor(appConfig);
+    });
+
+    it(`should return correct path`, () => {
+      expect(
+        routeInfoPathExtractor.extractPathFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+        }),
+      ).to.eql('/*');
+
+      expect(
+        routeInfoPathExtractor.extractPathFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+          version: '1',
+        }),
+      ).to.eql('/v1/*');
+    });
+
+    it(`should return correct path when set global prefix`, () => {
+      Reflect.set(routeInfoPathExtractor, 'prefixPath', '/api');
+
+      expect(
+        routeInfoPathExtractor.extractPathFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+        }),
+      ).to.eql('/*');
+
+      expect(
+        routeInfoPathExtractor.extractPathFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+          version: '1',
+        }),
+      ).to.eql('/api/v1/*');
+    });
+
+    it(`should return correct path when set global prefix and global prefix options`, () => {
+      Reflect.set(routeInfoPathExtractor, 'prefixPath', '/api');
+      Reflect.set(
+        routeInfoPathExtractor,
+        'excludedGlobalPrefixRoutes',
+        mapToExcludeRoute(['foo']),
+      );
+
+      expect(
+        routeInfoPathExtractor.extractPathFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+        }),
+      ).to.eql('/*');
+
+      expect(
+        routeInfoPathExtractor.extractPathFrom({
+          path: '*',
+          method: RequestMethod.ALL,
+          version: '1',
+        }),
+      ).to.eql('/api/v1/*');
+
+      expect(
+        routeInfoPathExtractor.extractPathFrom({
+          path: 'foo',
+          method: RequestMethod.ALL,
+          version: '1',
+        }),
+      ).to.eql('/v1/foo');
+
+      expect(
+        routeInfoPathExtractor.extractPathFrom({
+          path: 'bar',
+          method: RequestMethod.ALL,
+          version: '1',
+        }),
+      ).to.eql('/api/v1/bar');
+    });
+  });
+});
diff --git a/packages/core/test/middleware/routes-mapper.spec.ts b/packages/core/test/middleware/routes-mapper.spec.ts
index 7c1aabd51..f030a676c 100644
--- a/packages/core/test/middleware/routes-mapper.spec.ts
+++ b/packages/core/test/middleware/routes-mapper.spec.ts
@@ -1,6 +1,11 @@
+import { Version } from '../../../common';
+import { MiddlewareConfiguration } from '../../../common/interfaces';
 import { expect } from 'chai';
 import { Controller } from '../../../common/decorators/core/controller.decorator';
-import { RequestMapping } from '../../../common/decorators/http/request-mapping.decorator';
+import {
+  Get,
+  RequestMapping,
+} from '../../../common/decorators/http/request-mapping.decorator';
 import { RequestMethod } from '../../../common/enums/request-method.enum';
 import { NestContainer } from '../../injector/container';
 import { RoutesMapper } from '../../middleware/routes-mapper';
@@ -13,6 +18,10 @@ describe('RoutesMapper', () => {
 
     @RequestMapping({ path: 'another', method: RequestMethod.DELETE })
     public getAnother() {}
+
+    @Version('1')
+    @Get('versioned')
+    public getVersioned() {}
   }
 
   let mapper: RoutesMapper;
@@ -21,17 +30,27 @@ describe('RoutesMapper', () => {
   });
 
   it('should map @Controller() to "ControllerMetadata" in forRoutes', () => {
-    const config = {
+    const config: MiddlewareConfiguration = {
       middleware: 'Test',
-      forRoutes: [{ path: 'test', method: RequestMethod.GET }, TestRoute],
+      forRoutes: [
+        { path: 'test', method: RequestMethod.GET },
+        { path: 'versioned', version: '1', method: RequestMethod.GET },
+        TestRoute,
+      ],
     };
 
     expect(mapper.mapRouteToRouteInfo(config.forRoutes[0])).to.deep.equal([
       { path: '/test', method: RequestMethod.GET },
     ]);
+
     expect(mapper.mapRouteToRouteInfo(config.forRoutes[1])).to.deep.equal([
+      { path: '/versioned', version: '1', method: RequestMethod.GET },
+    ]);
+
+    expect(mapper.mapRouteToRouteInfo(config.forRoutes[2])).to.deep.equal([
       { path: '/test/test', method: RequestMethod.GET },
       { path: '/test/another', method: RequestMethod.DELETE },
+      { path: '/test/versioned', method: RequestMethod.GET, version: '1' },
     ]);
   });
   @Controller(['test', 'test2'])
diff --git a/packages/core/test/middleware/utils.spec.ts b/packages/core/test/middleware/utils.spec.ts
index 754878c22..a1c91d77b 100644
--- a/packages/core/test/middleware/utils.spec.ts
+++ b/packages/core/test/middleware/utils.spec.ts
@@ -1,4 +1,5 @@
 import { RequestMethod, Type } from '@nestjs/common';
+import { addLeadingSlash } from '@nestjs/common/utils/shared.utils';
 import { expect } from 'chai';
 import * as sinon from 'sinon';
 import {
@@ -10,6 +11,7 @@ import {
   mapToExcludeRoute,
 } from '../../middleware/utils';
 import { NoopHttpAdapter } from '../utils/noop-adapter.spec';
+import * as pathToRegexp from 'path-to-regexp';
 
 describe('middleware utils', () => {
   const noopAdapter = new NoopHttpAdapter({});
@@ -17,6 +19,27 @@ describe('middleware utils', () => {
   class Test {}
   function fnMiddleware(req, res, next) {}
 
+  describe('mapToExcludeRoute', () => {
+    it('should return exclude route metadata', () => {
+      const stringRoute = 'foo';
+      const routeInfo = {
+        path: 'bar',
+        method: RequestMethod.GET,
+      };
+      expect(mapToExcludeRoute([stringRoute, routeInfo])).to.eql([
+        {
+          path: stringRoute,
+          requestMethod: RequestMethod.ALL,
+          pathRegex: pathToRegexp(addLeadingSlash(stringRoute)),
+        },
+        {
+          path: routeInfo.path,
+          requestMethod: routeInfo.method,
+          pathRegex: pathToRegexp(addLeadingSlash(routeInfo.path)),
+        },
+      ]);
+    });
+  });
   describe('filterMiddleware', () => {
     let middleware: any[];
     beforeEach(() => {
diff --git a/packages/core/test/nest-application-context.spec.ts b/packages/core/test/nest-application-context.spec.ts
new file mode 100644
index 000000000..db2a6ef28
--- /dev/null
+++ b/packages/core/test/nest-application-context.spec.ts
@@ -0,0 +1,320 @@
+import { InjectionToken, Scope } from '@nestjs/common';
+import { expect } from 'chai';
+import { ContextIdFactory } from '../helpers/context-id-factory';
+import { NestContainer } from '../injector/container';
+import { Injector } from '../injector/injector';
+import { InstanceLoader } from '../injector/instance-loader';
+import { GraphInspector } from '../inspector/graph-inspector';
+import { NestApplicationContext } from '../nest-application-context';
+import * as sinon from 'sinon';
+
+describe('NestApplicationContext', () => {
+  class A {}
+
+  async function testHelper(
+    injectionKey: InjectionToken,
+    scope: Scope,
+  ): Promise<NestApplicationContext> {
+    const nestContainer = new NestContainer();
+    const injector = new Injector();
+    const instanceLoader = new InstanceLoader(
+      nestContainer,
+      injector,
+      new GraphInspector(nestContainer),
+    );
+    const module = await nestContainer.addModule(class T {}, []);
+
+    nestContainer.addProvider(
+      {
+        provide: injectionKey,
+        useClass: A,
+        scope,
+      },
+      module.token,
+    );
+
+    nestContainer.addInjectable(
+      {
+        provide: injectionKey,
+        useClass: A,
+        scope,
+      },
+      module.token,
+      'interceptor',
+    );
+
+    const modules = nestContainer.getModules();
+    await instanceLoader.createInstancesOfDependencies(modules);
+
+    const applicationContext = new NestApplicationContext(nestContainer);
+    return applicationContext;
+  }
+
+  describe('listenToShutdownSignals', () => {
+    it('shutdown process should not be interrupted by another handler', async () => {
+      const signal = 'SIGTERM';
+      let processUp = true;
+      let promisesResolved = false;
+      const applicationContext = await testHelper(A, Scope.DEFAULT);
+      applicationContext.enableShutdownHooks([signal]);
+
+      const waitProcessDown = new Promise(resolve => {
+        const shutdownCleanupRef = applicationContext['shutdownCleanupRef'];
+        const handler = () => {
+          if (
+            !process
+              .listeners(signal)
+              .find(handler => handler == shutdownCleanupRef)
+          ) {
+            processUp = false;
+            process.removeListener(signal, handler);
+            resolve(undefined);
+          }
+          return undefined;
+        };
+        process.on(signal, handler);
+      });
+
+      // add some third party handler
+      process.on(signal, signal => {
+        // do some work
+        process.kill(process.pid, signal);
+      });
+
+      const hookStub = sinon
+        .stub(applicationContext as any, 'callShutdownHook')
+        .callsFake(async () => {
+          // run some async code
+          await new Promise(resolve => setImmediate(() => resolve(undefined)));
+          if (processUp) {
+            promisesResolved = true;
+          }
+        });
+      process.kill(process.pid, signal);
+      await waitProcessDown;
+      hookStub.restore();
+      expect(processUp).to.be.false;
+      expect(promisesResolved).to.be.true;
+    });
+  });
+
+  describe('get', () => {
+    describe('when scope = DEFAULT', () => {
+      it('should get value with function injection key', async () => {
+        const key = A;
+        const applicationContext = await testHelper(key, Scope.DEFAULT);
+
+        const a1: A = await applicationContext.get(key);
+        const a2: A = await applicationContext.get(key);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).equal(a2);
+      });
+
+      it('should get value with string injection key', async () => {
+        const key = 'KEY_A';
+        const applicationContext = await testHelper(key, Scope.DEFAULT);
+
+        const a1: A = await applicationContext.get(key);
+        const a2: A = await applicationContext.get(key);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).equal(a2);
+      });
+
+      it('should get value with symbol injection key', async () => {
+        const key = Symbol('KEY_A');
+        const applicationContext = await testHelper(key, Scope.DEFAULT);
+
+        const a1: A = await applicationContext.get(key);
+        const a2: A = await applicationContext.get(key);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).equal(a2);
+      });
+    });
+
+    describe('when scope = REQUEST', () => {
+      it('should throw error when use function injection key', async () => {
+        const key = A;
+        const applicationContext = await testHelper(key, Scope.REQUEST);
+
+        expect(() => applicationContext.get(key)).to.be.throw;
+      });
+
+      it('should throw error when use string injection key', async () => {
+        const key = 'KEY_A';
+        const applicationContext = await testHelper(key, Scope.REQUEST);
+
+        expect(() => applicationContext.get(key)).to.be.throw;
+      });
+
+      it('should throw error when use symbol injection key', async () => {
+        const key = Symbol('KEY_A');
+        const applicationContext = await testHelper(key, Scope.REQUEST);
+
+        expect(() => applicationContext.get(key)).to.be.throw;
+      });
+    });
+
+    describe('when scope = TRANSIENT', () => {
+      it('should throw error when use function injection key', async () => {
+        const key = A;
+        const applicationContext = await testHelper(key, Scope.TRANSIENT);
+
+        expect(() => applicationContext.get(key)).to.be.throw;
+      });
+
+      it('should throw error when use string injection key', async () => {
+        const key = 'KEY_A';
+        const applicationContext = await testHelper(key, Scope.TRANSIENT);
+
+        expect(() => applicationContext.get(key)).to.be.throw;
+      });
+
+      it('should throw error when use symbol injection key', async () => {
+        const key = Symbol('KEY_A');
+        const applicationContext = await testHelper(key, Scope.TRANSIENT);
+
+        expect(() => applicationContext.get(key)).to.be.throw;
+      });
+    });
+  });
+
+  describe('resolve', () => {
+    describe('when scope = DEFAULT', () => {
+      it('should resolve value with function injection key', async () => {
+        const key = A;
+        const applicationContext = await testHelper(key, Scope.DEFAULT);
+
+        const a1: A = await applicationContext.resolve(key);
+        const a2: A = await applicationContext.resolve(key);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).equal(a2);
+      });
+
+      it('should resolve value with string injection key', async () => {
+        const key = 'KEY_A';
+        const applicationContext = await testHelper(key, Scope.DEFAULT);
+
+        const a1: A = await applicationContext.resolve(key);
+        const a2: A = await applicationContext.resolve(key);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).equal(a2);
+      });
+
+      it('should resolve value with symbol injection key', async () => {
+        const key = Symbol('KEY_A');
+        const applicationContext = await testHelper(key, Scope.DEFAULT);
+
+        const a1: A = await applicationContext.resolve(key);
+        const a2: A = await applicationContext.resolve(key);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).equal(a2);
+      });
+    });
+
+    describe('when scope = REQUEST', () => {
+      it('should resolve value with function injection key', async () => {
+        const key = A;
+        const applicationContext = await testHelper(key, Scope.REQUEST);
+
+        const contextId = ContextIdFactory.create();
+        const a1: A = await applicationContext.resolve(key);
+        const a2: A = await applicationContext.resolve(key, contextId);
+        const a3: A = await applicationContext.resolve(key, contextId);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).not.equal(a2);
+        expect(a2).equal(a3);
+      });
+
+      it('should resolve value with string injection key', async () => {
+        const key = 'KEY_A';
+        const applicationContext = await testHelper(key, Scope.REQUEST);
+
+        const contextId = ContextIdFactory.create();
+        const a1: A = await applicationContext.resolve(key);
+        const a2: A = await applicationContext.resolve(key, contextId);
+        const a3: A = await applicationContext.resolve(key, contextId);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).not.equal(a2);
+        expect(a2).equal(a3);
+      });
+
+      it('should resolve value with symbol injection key', async () => {
+        const key = Symbol('KEY_A');
+        const applicationContext = await testHelper(key, Scope.REQUEST);
+
+        const contextId = ContextIdFactory.create();
+        const a1: A = await applicationContext.resolve(key);
+        const a2: A = await applicationContext.resolve(key, contextId);
+        const a3: A = await applicationContext.resolve(key, contextId);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).not.equal(a2);
+        expect(a2).equal(a3);
+      });
+    });
+
+    describe('when scope = TRANSIENT', () => {
+      it('should resolve value with function injection key', async () => {
+        const key = A;
+        const applicationContext = await testHelper(key, Scope.TRANSIENT);
+
+        const contextId = ContextIdFactory.create();
+        const a1: A = await applicationContext.resolve(key);
+        const a2: A = await applicationContext.resolve(key, contextId);
+        const a3: A = await applicationContext.resolve(key, contextId);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).not.equal(a2);
+        expect(a2).equal(a3);
+      });
+
+      it('should resolve value with string injection key', async () => {
+        const key = 'KEY_A';
+        const applicationContext = await testHelper(key, Scope.TRANSIENT);
+
+        const contextId = ContextIdFactory.create();
+        const a1: A = await applicationContext.resolve(key);
+        const a2: A = await applicationContext.resolve(key, contextId);
+        const a3: A = await applicationContext.resolve(key, contextId);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).not.equal(a2);
+        expect(a2).equal(a3);
+      });
+
+      it('should resolve value with symbol injection key', async () => {
+        const key = Symbol('KEY_A');
+        const applicationContext = await testHelper(key, Scope.TRANSIENT);
+
+        const contextId = ContextIdFactory.create();
+        const a1: A = await applicationContext.resolve(key);
+        const a2: A = await applicationContext.resolve(key, contextId);
+        const a3: A = await applicationContext.resolve(key, contextId);
+
+        expect(a1).instanceOf(A);
+        expect(a2).instanceOf(A);
+        expect(a1).not.equal(a2);
+        expect(a2).equal(a3);
+      });
+    });
+  });
+});
diff --git a/packages/core/test/nest-application.spec.ts b/packages/core/test/nest-application.spec.ts
index 19f9825b3..e9fb0ab66 100644
--- a/packages/core/test/nest-application.spec.ts
+++ b/packages/core/test/nest-application.spec.ts
@@ -1,8 +1,12 @@
+import { RequestMethod } from '@nestjs/common';
 import { expect } from 'chai';
 import { ApplicationConfig } from '../application-config';
 import { NestContainer } from '../injector/container';
+import { GraphInspector } from '../inspector/graph-inspector';
 import { NestApplication } from '../nest-application';
+import { mapToExcludeRoute } from './../middleware/utils';
 import { NoopHttpAdapter } from './utils/noop-adapter.spec';
+import { MicroserviceOptions } from '@nestjs/microservices';
 
 describe('NestApplication', () => {
   describe('Hybrid Application', () => {
@@ -18,10 +22,13 @@ describe('NestApplication', () => {
         container,
         new NoopHttpAdapter({}),
         applicationConfig,
+        new GraphInspector(container),
         {},
       );
       instance.useGlobalInterceptors(new Interceptor());
-      const microservice = instance.connectMicroservice({});
+      const microservice = instance.connectMicroservice<MicroserviceOptions>(
+        {},
+      );
       expect((instance as any).config.getGlobalInterceptors().length).to.equal(
         1,
       );
@@ -36,10 +43,11 @@ describe('NestApplication', () => {
         container,
         new NoopHttpAdapter({}),
         applicationConfig,
+        new GraphInspector(container),
         {},
       );
       instance.useGlobalInterceptors(new Interceptor());
-      const microservice = instance.connectMicroservice(
+      const microservice = instance.connectMicroservice<MicroserviceOptions>(
         {},
         { inheritAppConfig: true },
       );
@@ -51,4 +59,24 @@ describe('NestApplication', () => {
       ).to.equal(1);
     });
   });
+  describe('Global Prefix', () => {
+    it('should get correct global prefix options', () => {
+      const applicationConfig = new ApplicationConfig();
+      const container = new NestContainer(applicationConfig);
+      const instance = new NestApplication(
+        container,
+        new NoopHttpAdapter({}),
+        applicationConfig,
+        new GraphInspector(container),
+        {},
+      );
+      const excludeRoute = ['foo', { path: 'bar', method: RequestMethod.GET }];
+      instance.setGlobalPrefix('api', {
+        exclude: excludeRoute,
+      });
+      expect(applicationConfig.getGlobalPrefixOptions()).to.eql({
+        exclude: mapToExcludeRoute(excludeRoute),
+      });
+    });
+  });
 });
diff --git a/packages/core/test/pipes/params-token-factory.spec.ts b/packages/core/test/pipes/params-token-factory.spec.ts
index 752f118de..6bc83aadd 100644
--- a/packages/core/test/pipes/params-token-factory.spec.ts
+++ b/packages/core/test/pipes/params-token-factory.spec.ts
@@ -32,7 +32,7 @@ describe('ParamsTokenFactory', () => {
       });
       describe('not available', () => {
         it('should return "custom"', () => {
-          expect(factory.exchangeEnumForString(-1)).to.be.eql('custom');
+          expect(factory.exchangeEnumForString(-1 as any)).to.be.eql('custom');
         });
       });
     });
diff --git a/packages/core/test/repl/assign-to-object.util.spec.ts b/packages/core/test/repl/assign-to-object.util.spec.ts
new file mode 100644
index 000000000..0a7a58bf5
--- /dev/null
+++ b/packages/core/test/repl/assign-to-object.util.spec.ts
@@ -0,0 +1,36 @@
+import { expect } from 'chai';
+import { assignToObject } from '../../repl/assign-to-object.util';
+
+describe('assignToObject', () => {
+  it('should copy all enumerable properties and their descriptors', () => {
+    const sourceObj = {};
+    Object.defineProperty(sourceObj, 'foo', {
+      value: 123,
+      configurable: true,
+      enumerable: true,
+      writable: true,
+    });
+    Object.defineProperty(sourceObj, 'bar', {
+      value: 456,
+      configurable: true,
+      enumerable: true,
+      writable: false,
+    });
+    const targetObj = {};
+
+    assignToObject(targetObj, sourceObj);
+
+    expect(Object.getOwnPropertyDescriptor(targetObj, 'foo')).to.be.eql({
+      value: 123,
+      configurable: true,
+      enumerable: true,
+      writable: true,
+    });
+    expect(Object.getOwnPropertyDescriptor(targetObj, 'bar')).to.be.eql({
+      value: 456,
+      configurable: true,
+      enumerable: true,
+      writable: false,
+    });
+  });
+});
diff --git a/packages/core/test/repl/native-functions/debug-repl-fn.spec.ts b/packages/core/test/repl/native-functions/debug-repl-fn.spec.ts
new file mode 100644
index 000000000..a23090a5b
--- /dev/null
+++ b/packages/core/test/repl/native-functions/debug-repl-fn.spec.ts
@@ -0,0 +1,135 @@
+import { expect } from 'chai';
+import * as sinon from 'sinon';
+import { clc } from '@nestjs/common/utils/cli-colors.util';
+import { DebugReplFn } from '../../../repl/native-functions';
+import { ReplContext } from '../../../repl/repl-context';
+import { NestContainer } from '../../../injector/container';
+
+describe('DebugReplFn', () => {
+  let debugReplFn: DebugReplFn;
+
+  let replContext: ReplContext;
+  let mockApp: {
+    container: NestContainer;
+    get: sinon.SinonStub;
+    resolve: sinon.SinonSpy;
+    select: sinon.SinonSpy;
+  };
+
+  before(async () => {
+    const container = new NestContainer();
+    const aModuleRef = await container.addModule(class ModuleA {}, []);
+    const bModuleRef = await container.addModule(class ModuleB {}, []);
+
+    container.addController(class ControllerA {}, aModuleRef.token);
+    container.addProvider(class ProviderA1 {}, aModuleRef.token);
+    container.addProvider(class ProviderA2 {}, aModuleRef.token);
+    container.addProvider(class SharedProvider {}, aModuleRef.token);
+    container.addProvider(
+      { provide: 'StringToken', useValue: 123 },
+      aModuleRef.token,
+    );
+
+    container.addProvider(class ProviderB1 {}, bModuleRef.token);
+    container.addProvider(class ProviderB2 {}, bModuleRef.token);
+    container.addProvider(class SharedProvider {}, bModuleRef.token);
+
+    mockApp = {
+      container,
+      get: sinon.stub(),
+      resolve: sinon.spy(),
+      select: sinon.spy(),
+    };
+    replContext = new ReplContext(mockApp as any);
+  });
+
+  beforeEach(() => {
+    debugReplFn = replContext.nativeFunctions.get('debug') as DebugReplFn;
+
+    // To avoid coloring the output:
+    sinon.stub(clc, 'yellow').callsFake(text => text);
+    sinon.stub(clc, 'green').callsFake(text => text);
+  });
+  afterEach(() => sinon.restore());
+
+  it('the function name should be "debug"', () => {
+    expect(debugReplFn).to.not.be.undefined;
+    expect(debugReplFn.fnDefinition.name).to.eql('debug');
+  });
+
+  describe('action', () => {
+    it('should print all modules along with their controllers and providers', () => {
+      let outputText = '';
+
+      sinon
+        .stub(replContext, 'writeToStdout')
+        .callsFake(text => (outputText += text));
+
+      debugReplFn.action();
+
+      expect(outputText).to.equal(`
+ModuleA:
+ - controllers:
+  ‚óª ControllerA
+ - providers:
+  ‚óª ProviderA1
+  ‚óª ProviderA2
+  ‚óª SharedProvider
+  ‚óª "StringToken"
+ModuleB:
+ - providers:
+  ‚óª ProviderB1
+  ‚óª ProviderB2
+  ‚óª SharedProvider
+
+`);
+    });
+
+    describe('when module passed as a class reference', () => {
+      it("should print a specified module's controllers and providers", () => {
+        let outputText = '';
+
+        sinon
+          .stub(replContext, 'writeToStdout')
+          .callsFake(text => (outputText += text));
+
+        debugReplFn.action(class ModuleA {});
+
+        expect(outputText).to.equal(`
+ModuleA:
+ - controllers:
+  ‚óª ControllerA
+ - providers:
+  ‚óª ProviderA1
+  ‚óª ProviderA2
+  ‚óª SharedProvider
+  ‚óª "StringToken"
+
+`);
+      });
+    });
+    describe("when module passed as a string (module's key)", () => {
+      it("should print a specified module's controllers and providers", () => {
+        let outputText = '';
+
+        sinon
+          .stub(replContext, 'writeToStdout')
+          .callsFake(text => (outputText += text));
+
+        debugReplFn.action('ModuleA');
+
+        expect(outputText).to.equal(`
+ModuleA:
+ - controllers:
+  ‚óª ControllerA
+ - providers:
+  ‚óª ProviderA1
+  ‚óª ProviderA2
+  ‚óª SharedProvider
+  ‚óª "StringToken"
+
+`);
+      });
+    });
+  });
+});
diff --git a/packages/core/test/repl/native-functions/get-repl-fn.spec.ts b/packages/core/test/repl/native-functions/get-repl-fn.spec.ts
new file mode 100644
index 000000000..aec8f335f
--- /dev/null
+++ b/packages/core/test/repl/native-functions/get-repl-fn.spec.ts
@@ -0,0 +1,47 @@
+import { expect } from 'chai';
+import * as sinon from 'sinon';
+import { GetReplFn } from '../../../repl/native-functions';
+import { ReplContext } from '../../../repl/repl-context';
+import { NestContainer } from '../../../injector/container';
+
+describe('GetReplFn', () => {
+  let getReplFn: GetReplFn;
+
+  let replContext: ReplContext;
+  let mockApp: {
+    container: NestContainer;
+    get: sinon.SinonStub;
+    resolve: sinon.SinonSpy;
+    select: sinon.SinonSpy;
+  };
+
+  before(async () => {
+    const container = new NestContainer();
+
+    mockApp = {
+      container,
+      get: sinon.stub(),
+      resolve: sinon.spy(),
+      select: sinon.spy(),
+    };
+    replContext = new ReplContext(mockApp as any);
+  });
+
+  beforeEach(() => {
+    getReplFn = replContext.nativeFunctions.get('get') as GetReplFn;
+  });
+  afterEach(() => sinon.restore());
+
+  it('the function name should be "get"', () => {
+    expect(getReplFn).to.not.be.undefined;
+    expect(getReplFn.fnDefinition.name).to.eql('get');
+  });
+
+  describe('action', () => {
+    it('should pass arguments down to the application context', () => {
+      const token = 'test';
+      getReplFn.action(token);
+      expect(mockApp.get.calledWith(token)).to.be.true;
+    });
+  });
+});
diff --git a/packages/core/test/repl/native-functions/help-repl-fn.spec.ts b/packages/core/test/repl/native-functions/help-repl-fn.spec.ts
new file mode 100644
index 000000000..09f041153
--- /dev/null
+++ b/packages/core/test/repl/native-functions/help-repl-fn.spec.ts
@@ -0,0 +1,68 @@
+import { expect } from 'chai';
+import * as sinon from 'sinon';
+import { clc } from '@nestjs/common/utils/cli-colors.util';
+import { HelpReplFn } from '../../../repl/native-functions';
+import { ReplContext } from '../../../repl/repl-context';
+import { NestContainer } from '../../../injector/container';
+
+describe('HelpReplFn', () => {
+  let helpReplFn: HelpReplFn;
+
+  let replContext: ReplContext;
+  let mockApp: {
+    container: NestContainer;
+    get: sinon.SinonStub;
+    resolve: sinon.SinonSpy;
+    select: sinon.SinonSpy;
+  };
+
+  before(async () => {
+    const container = new NestContainer();
+
+    mockApp = {
+      container,
+      get: sinon.stub(),
+      resolve: sinon.spy(),
+      select: sinon.spy(),
+    };
+    replContext = new ReplContext(mockApp as any);
+  });
+
+  beforeEach(() => {
+    helpReplFn = replContext.nativeFunctions.get('help') as HelpReplFn;
+
+    // To avoid coloring the output:
+    sinon.stub(clc, 'bold').callsFake(text => text);
+    sinon.stub(clc, 'cyanBright').callsFake(text => text);
+  });
+  afterEach(() => sinon.restore());
+
+  it('the function name should be "help"', () => {
+    expect(helpReplFn).to.not.be.undefined;
+    expect(helpReplFn.fnDefinition.name).to.eql('help');
+  });
+
+  describe('action', () => {
+    it('should print all available native functions and their description', () => {
+      let outputText = '';
+      sinon
+        .stub(replContext, 'writeToStdout')
+        .callsFake(text => (outputText += text));
+
+      helpReplFn.action();
+
+      expect(outputText).to
+        .equal(`You can call .help on any function listed below (e.g.: help.help):
+
+$ - Retrieves an instance of either injectable or controller, otherwise, throws exception.
+debug - Print all registered modules as a list together with their controllers and providers.
+If the argument is passed in, for example, "debug(MyModule)" then it will only print components of this specific module.
+get - Retrieves an instance of either injectable or controller, otherwise, throws exception.
+help - Display all available REPL native functions.
+methods - Display all public methods available on a given provider or controller.
+resolve - Resolves transient or request-scoped instance of either injectable or controller, otherwise, throws exception.
+select - Allows navigating through the modules tree, for example, to pull out a specific instance from the selected module.
+`);
+    });
+  });
+});
diff --git a/packages/core/test/repl/native-functions/methods-repl-fn.spec.ts b/packages/core/test/repl/native-functions/methods-repl-fn.spec.ts
new file mode 100644
index 000000000..a45f5c255
--- /dev/null
+++ b/packages/core/test/repl/native-functions/methods-repl-fn.spec.ts
@@ -0,0 +1,108 @@
+import { expect } from 'chai';
+import * as sinon from 'sinon';
+import { clc } from '@nestjs/common/utils/cli-colors.util';
+import { MethodsReplFn } from '../../../repl/native-functions';
+import { ReplContext } from '../../../repl/repl-context';
+import { NestContainer } from '../../../injector/container';
+
+describe('MethodsReplFn', () => {
+  let methodsReplFn: MethodsReplFn;
+
+  let replContext: ReplContext;
+  let mockApp: {
+    container: NestContainer;
+    get: sinon.SinonStub;
+    resolve: sinon.SinonSpy;
+    select: sinon.SinonSpy;
+  };
+
+  before(async () => {
+    const container = new NestContainer();
+    const aModuleRef = await container.addModule(class ModuleA {}, []);
+    const bModuleRef = await container.addModule(class ModuleB {}, []);
+
+    container.addController(class ControllerA {}, aModuleRef.token);
+    container.addProvider(class ProviderA1 {}, aModuleRef.token);
+    container.addProvider(class ProviderA2 {}, aModuleRef.token);
+
+    container.addProvider(class ProviderB1 {}, bModuleRef.token);
+    container.addProvider(class ProviderB2 {}, bModuleRef.token);
+
+    mockApp = {
+      container,
+      get: sinon.stub(),
+      resolve: sinon.spy(),
+      select: sinon.spy(),
+    };
+    replContext = new ReplContext(mockApp as any);
+  });
+
+  beforeEach(() => {
+    methodsReplFn = replContext.nativeFunctions.get('methods') as MethodsReplFn;
+
+    // To avoid coloring the output:
+    sinon.stub(clc, 'yellow').callsFake(text => text);
+    sinon.stub(clc, 'green').callsFake(text => text);
+  });
+  afterEach(() => sinon.restore());
+
+  it('the function name should be "methods"', () => {
+    expect(methodsReplFn).to.not.be.undefined;
+    expect(methodsReplFn.fnDefinition.name).to.eql('methods');
+  });
+
+  describe('action', () => {
+    describe('when token is a class reference', () => {
+      it('should print all class methods', () => {
+        class BaseService {
+          create() {}
+        }
+        class TestService extends BaseService {
+          findAll() {}
+          findOne() {}
+        }
+
+        let outputText = '';
+
+        sinon
+          .stub(replContext, 'writeToStdout')
+          .callsFake(text => (outputText += text));
+
+        methodsReplFn.action(TestService);
+
+        expect(outputText).to.equal(`
+Methods:
+ ‚óª findAll
+ ‚óª findOne
+ ‚óª create
+
+`);
+      });
+    });
+
+    describe('when token is a string', () => {
+      it('should grab provider from the container and print its all methods', () => {
+        class ProviderA1 {
+          findAll() {}
+          findOne() {}
+        }
+        let outputText = '';
+
+        sinon
+          .stub(replContext, 'writeToStdout')
+          .callsFake(text => (outputText += text));
+
+        mockApp.get.callsFake(() => new ProviderA1());
+
+        methodsReplFn.action('ProviderA1');
+
+        expect(outputText).to.equal(`
+Methods:
+ ‚óª findAll
+ ‚óª findOne
+
+`);
+      });
+    });
+  });
+});
diff --git a/packages/core/test/repl/native-functions/resolve-repl-fn.spec.ts b/packages/core/test/repl/native-functions/resolve-repl-fn.spec.ts
new file mode 100644
index 000000000..cf78bbd40
--- /dev/null
+++ b/packages/core/test/repl/native-functions/resolve-repl-fn.spec.ts
@@ -0,0 +1,49 @@
+import { expect } from 'chai';
+import * as sinon from 'sinon';
+import { ResolveReplFn } from '../../../repl/native-functions';
+import { ReplContext } from '../../../repl/repl-context';
+import { NestContainer } from '../../../injector/container';
+
+describe('ResolveReplFn', () => {
+  let resolveReplFn: ResolveReplFn;
+
+  let replContext: ReplContext;
+  let mockApp: {
+    container: NestContainer;
+    get: sinon.SinonStub;
+    resolve: sinon.SinonSpy;
+    select: sinon.SinonSpy;
+  };
+
+  before(async () => {
+    const container = new NestContainer();
+
+    mockApp = {
+      container,
+      get: sinon.stub(),
+      resolve: sinon.spy(),
+      select: sinon.spy(),
+    };
+    replContext = new ReplContext(mockApp as any);
+  });
+
+  beforeEach(() => {
+    resolveReplFn = replContext.nativeFunctions.get('resolve') as ResolveReplFn;
+  });
+  afterEach(() => sinon.restore());
+
+  it('the function name should be "resolve"', () => {
+    expect(resolveReplFn).to.not.be.undefined;
+    expect(resolveReplFn.fnDefinition.name).to.eql('resolve');
+  });
+
+  describe('action', () => {
+    it('should pass arguments down to the application context', async () => {
+      const token = 'test';
+      const contextId = {};
+
+      await resolveReplFn.action(token, contextId);
+      expect(mockApp.resolve.calledWith(token, contextId)).to.be.true;
+    });
+  });
+});
diff --git a/packages/core/test/repl/native-functions/select-repl-fn.spec.ts b/packages/core/test/repl/native-functions/select-repl-fn.spec.ts
new file mode 100644
index 000000000..22a033e54
--- /dev/null
+++ b/packages/core/test/repl/native-functions/select-repl-fn.spec.ts
@@ -0,0 +1,47 @@
+import { expect } from 'chai';
+import * as sinon from 'sinon';
+import { SelectReplFn } from '../../../repl/native-functions';
+import { ReplContext } from '../../../repl/repl-context';
+import { NestContainer } from '../../../injector/container';
+
+describe('SelectReplFn', () => {
+  let selectReplFn: SelectReplFn;
+
+  let replContext: ReplContext;
+  let mockApp: {
+    container: NestContainer;
+    get: sinon.SinonStub;
+    resolve: sinon.SinonSpy;
+    select: sinon.SinonSpy;
+  };
+
+  before(async () => {
+    const container = new NestContainer();
+
+    mockApp = {
+      container,
+      get: sinon.stub(),
+      resolve: sinon.spy(),
+      select: sinon.spy(),
+    };
+    replContext = new ReplContext(mockApp as any);
+  });
+
+  beforeEach(() => {
+    selectReplFn = replContext.nativeFunctions.get('select') as SelectReplFn;
+  });
+  afterEach(() => sinon.restore());
+
+  it('the function name should be "select"', () => {
+    expect(selectReplFn).to.not.be.undefined;
+    expect(selectReplFn.fnDefinition.name).to.eql('select');
+  });
+
+  describe('action', () => {
+    it('should pass arguments down to the application context', () => {
+      const moduleCls = class TestModule {};
+      selectReplFn.action(moduleCls);
+      expect(mockApp.select.calledWith(moduleCls)).to.be.true;
+    });
+  });
+});
diff --git a/packages/core/test/repl/repl-context.spec.ts b/packages/core/test/repl/repl-context.spec.ts
new file mode 100644
index 000000000..9654dfce5
--- /dev/null
+++ b/packages/core/test/repl/repl-context.spec.ts
@@ -0,0 +1,38 @@
+import { expect } from 'chai';
+import * as sinon from 'sinon';
+import { NestContainer } from '../../injector/container';
+import { ReplContext } from '../../repl/repl-context';
+
+describe('ReplContext', () => {
+  let replContext: ReplContext;
+  let mockApp: {
+    container: NestContainer;
+    get: sinon.SinonStub;
+    resolve: sinon.SinonSpy;
+    select: sinon.SinonSpy;
+  };
+
+  before(async () => {
+    const container = new NestContainer();
+
+    mockApp = {
+      container,
+      get: sinon.stub(),
+      resolve: sinon.spy(),
+      select: sinon.spy(),
+    };
+    replContext = new ReplContext(mockApp as any);
+  });
+
+  afterEach(() => sinon.restore());
+
+  it('writeToStdout', () => {
+    const stdOutWrite = sinon.stub(process.stdout, 'write');
+    const text = sinon.stub() as unknown as string;
+
+    replContext.writeToStdout(text);
+
+    expect(stdOutWrite.calledOnce).to.be.true;
+    expect(stdOutWrite.calledWith(text)).to.be.true;
+  });
+});
diff --git a/packages/core/test/router/paths-explorer.spec.ts b/packages/core/test/router/paths-explorer.spec.ts
new file mode 100644
index 000000000..6607cd814
--- /dev/null
+++ b/packages/core/test/router/paths-explorer.spec.ts
@@ -0,0 +1,218 @@
+import { expect } from 'chai';
+import { Controller } from '../../../common/decorators/core/controller.decorator';
+import {
+  All,
+  Get,
+  Post,
+} from '../../../common/decorators/http/request-mapping.decorator';
+import { RequestMethod } from '../../../common/enums/request-method.enum';
+import { MetadataScanner } from '../../metadata-scanner';
+import { PathsExplorer } from '../../router/paths-explorer';
+
+describe('PathsExplorer', () => {
+  @Controller('global')
+  class TestRoute {
+    @Get('test')
+    public getTest() {}
+
+    @Post('test')
+    public postTest() {}
+
+    @All('another-test')
+    public anotherTest() {}
+
+    @Get(['foo', 'bar'])
+    public getTestUsingArray() {}
+  }
+
+  @Controller(['global', 'global-alias'])
+  class TestRouteAlias {
+    @Get('test')
+    public getTest() {}
+
+    @Post('test')
+    public postTest() {}
+
+    @All('another-test')
+    public anotherTest() {}
+
+    @Get(['foo', 'bar'])
+    public getTestUsingArray() {}
+  }
+
+  let pathsExplorer: PathsExplorer;
+
+  beforeEach(() => {
+    pathsExplorer = new PathsExplorer(new MetadataScanner());
+  });
+
+  describe('scanForPaths', () => {
+    it('should method return expected list of route paths', () => {
+      const paths = pathsExplorer.scanForPaths(new TestRoute());
+
+      expect(paths).to.have.length(4);
+
+      expect(paths[0].path).to.eql(['/test']);
+      expect(paths[1].path).to.eql(['/test']);
+      expect(paths[2].path).to.eql(['/another-test']);
+      expect(paths[3].path).to.eql(['/foo', '/bar']);
+
+      expect(paths[0].requestMethod).to.eql(RequestMethod.GET);
+      expect(paths[1].requestMethod).to.eql(RequestMethod.POST);
+      expect(paths[2].requestMethod).to.eql(RequestMethod.ALL);
+      expect(paths[3].requestMethod).to.eql(RequestMethod.GET);
+    });
+
+    it('should method return expected list of route paths alias', () => {
+      const paths = pathsExplorer.scanForPaths(new TestRouteAlias());
+
+      expect(paths).to.have.length(4);
+
+      expect(paths[0].path).to.eql(['/test']);
+      expect(paths[1].path).to.eql(['/test']);
+      expect(paths[2].path).to.eql(['/another-test']);
+      expect(paths[3].path).to.eql(['/foo', '/bar']);
+
+      expect(paths[0].requestMethod).to.eql(RequestMethod.GET);
+      expect(paths[1].requestMethod).to.eql(RequestMethod.POST);
+      expect(paths[2].requestMethod).to.eql(RequestMethod.ALL);
+      expect(paths[3].requestMethod).to.eql(RequestMethod.GET);
+    });
+  });
+
+  describe('exploreMethodMetadata', () => {
+    it('should method return expected object which represent single route', () => {
+      const instance = new TestRoute();
+      const instanceProto = Object.getPrototypeOf(instance);
+
+      const route = pathsExplorer.exploreMethodMetadata(
+        instance,
+        instanceProto,
+        'getTest',
+      );
+
+      expect(route.path).to.eql(['/test']);
+      expect(route.requestMethod).to.eql(RequestMethod.GET);
+      expect(route.targetCallback).to.eq(instance.getTest);
+    });
+
+    it('should method return expected object which represent single route with alias', () => {
+      const instance = new TestRouteAlias();
+      const instanceProto = Object.getPrototypeOf(instance);
+
+      const route = pathsExplorer.exploreMethodMetadata(
+        instance,
+        instanceProto,
+        'getTest',
+      );
+
+      expect(route.path).to.eql(['/test']);
+      expect(route.requestMethod).to.eql(RequestMethod.GET);
+      expect(route.targetCallback).to.eq(instance.getTest);
+    });
+
+    it('should method return expected object which represent multiple routes', () => {
+      const instance = new TestRoute();
+      const instanceProto = Object.getPrototypeOf(instance);
+
+      const route = pathsExplorer.exploreMethodMetadata(
+        instance,
+        instanceProto,
+        'getTestUsingArray',
+      );
+
+      expect(route.path).to.eql(['/foo', '/bar']);
+      expect(route.requestMethod).to.eql(RequestMethod.GET);
+      expect(route.targetCallback).to.eq(instance.getTestUsingArray);
+    });
+
+    it('should method return expected object which represent multiple routes with alias', () => {
+      const instance = new TestRouteAlias();
+      const instanceProto = Object.getPrototypeOf(instance);
+
+      const route = pathsExplorer.exploreMethodMetadata(
+        instance,
+        instanceProto,
+        'getTestUsingArray',
+      );
+
+      expect(route.path).to.eql(['/foo', '/bar']);
+      expect(route.requestMethod).to.eql(RequestMethod.GET);
+      expect(route.targetCallback).to.eq(instance.getTestUsingArray);
+    });
+
+    describe('when new implementation is injected into router', () => {
+      it('should method return changed impl of single route', () => {
+        const instance = new TestRoute();
+        const instanceProto = Object.getPrototypeOf(instance);
+
+        const newImpl = function () {};
+        instance.getTest = newImpl;
+
+        const route = pathsExplorer.exploreMethodMetadata(
+          instance,
+          instanceProto,
+          'getTest',
+        );
+
+        expect(route.targetCallback).to.eq(newImpl);
+        expect(route.path).to.eql(['/test']);
+        expect(route.requestMethod).to.eql(RequestMethod.GET);
+      });
+
+      it('should method return changed impl of single route which alias applied', () => {
+        const instance = new TestRouteAlias();
+        const instanceProto = Object.getPrototypeOf(instance);
+
+        const newImpl = function () {};
+        instance.getTest = newImpl;
+
+        const route = pathsExplorer.exploreMethodMetadata(
+          instance,
+          instanceProto,
+          'getTest',
+        );
+
+        expect(route.targetCallback).to.eq(newImpl);
+        expect(route.path).to.eql(['/test']);
+        expect(route.requestMethod).to.eql(RequestMethod.GET);
+      });
+
+      it('should method return changed impl of multiple routes', () => {
+        const instance = new TestRoute();
+        const instanceProto = Object.getPrototypeOf(instance);
+
+        const newImpl = function () {};
+        instance.getTestUsingArray = newImpl;
+
+        const route = pathsExplorer.exploreMethodMetadata(
+          instance,
+          instanceProto,
+          'getTestUsingArray',
+        );
+
+        expect(route.targetCallback).to.eq(newImpl);
+        expect(route.path).to.eql(['/foo', '/bar']);
+        expect(route.requestMethod).to.eql(RequestMethod.GET);
+      });
+
+      it('should method return changed impl of multiple routes which alias applied', () => {
+        const instance = new TestRouteAlias();
+        const instanceProto = Object.getPrototypeOf(instance);
+
+        const newImpl = function () {};
+        instance.getTestUsingArray = newImpl;
+
+        const route = pathsExplorer.exploreMethodMetadata(
+          instance,
+          instanceProto,
+          'getTestUsingArray',
+        );
+
+        expect(route.targetCallback).to.eq(newImpl);
+        expect(route.path).to.eql(['/foo', '/bar']);
+        expect(route.requestMethod).to.eql(RequestMethod.GET);
+      });
+    });
+  });
+});
diff --git a/packages/core/test/router/route-path-factory.spec.ts b/packages/core/test/router/route-path-factory.spec.ts
index c956eb367..4c110651d 100644
--- a/packages/core/test/router/route-path-factory.spec.ts
+++ b/packages/core/test/router/route-path-factory.spec.ts
@@ -1,4 +1,4 @@
-import { RequestMethod, VersioningType } from '@nestjs/common';
+import { RequestMethod, VersioningType, VERSION_NEUTRAL } from '@nestjs/common';
 import { expect } from 'chai';
 import * as pathToRegexp from 'path-to-regexp';
 import * as sinon from 'sinon';
@@ -180,6 +180,32 @@ describe('RoutePathFactory', () => {
         }),
       ).to.deep.equal(['/api/v1.1.1', '/api/v1.2.3']);
 
+      expect(
+        routePathFactory.create({
+          ctrlPath: '',
+          methodPath: '',
+          globalPrefix: '',
+          controllerVersion: VERSION_NEUTRAL,
+          versioningOptions: {
+            type: VersioningType.URI,
+            defaultVersion: VERSION_NEUTRAL,
+          },
+        }),
+      ).to.deep.equal(['/']);
+
+      expect(
+        routePathFactory.create({
+          ctrlPath: '',
+          methodPath: '',
+          globalPrefix: '',
+          controllerVersion: ['1', VERSION_NEUTRAL],
+          versioningOptions: {
+            type: VersioningType.URI,
+            defaultVersion: ['1', VERSION_NEUTRAL],
+          },
+        }),
+      ).to.deep.equal(['/v1', '/']);
+
       expect(
         routePathFactory.create({
           ctrlPath: '',
@@ -187,6 +213,17 @@ describe('RoutePathFactory', () => {
           globalPrefix: '',
         }),
       ).to.deep.equal(['/']);
+
+      sinon.stub(routePathFactory, 'isExcludedFromGlobalPrefix').returns(true);
+      expect(
+        routePathFactory.create({
+          ctrlPath: '/ctrlPath/',
+          methodPath: '/',
+          modulePath: '/',
+          globalPrefix: '/api',
+        }),
+      ).to.deep.equal(['/ctrlPath']);
+      sinon.restore();
     });
   });
 
@@ -210,6 +247,7 @@ describe('RoutePathFactory', () => {
           sinon.stub(applicationConfig, 'getGlobalPrefixOptions').returns({
             exclude: [
               {
+                path: '/random',
                 pathRegex: pathToRegexp('/random'),
                 requestMethod: RequestMethod.ALL,
               },
@@ -228,6 +266,7 @@ describe('RoutePathFactory', () => {
           sinon.stub(applicationConfig, 'getGlobalPrefixOptions').returns({
             exclude: [
               {
+                path: '/cats',
                 pathRegex: pathToRegexp('/cats'),
                 requestMethod: RequestMethod.ALL,
               },
@@ -246,6 +285,7 @@ describe('RoutePathFactory', () => {
             sinon.stub(applicationConfig, 'getGlobalPrefixOptions').returns({
               exclude: [
                 {
+                  path: '/cats',
                   pathRegex: pathToRegexp('/cats'),
                   requestMethod: RequestMethod.GET,
                 },
diff --git a/packages/core/test/router/router-execution-context.spec.ts b/packages/core/test/router/router-execution-context.spec.ts
index d669b03fd..b531ee972 100644
--- a/packages/core/test/router/router-execution-context.spec.ts
+++ b/packages/core/test/router/router-execution-context.spec.ts
@@ -4,7 +4,7 @@ import { of } from 'rxjs';
 import * as sinon from 'sinon';
 import { PassThrough } from 'stream';
 import { HttpException, HttpStatus, RouteParamMetadata } from '../../../common';
-import { CUSTOM_ROUTE_AGRS_METADATA } from '../../../common/constants';
+import { CUSTOM_ROUTE_ARGS_METADATA } from '../../../common/constants';
 import { RouteParamtypes } from '../../../common/enums/route-paramtypes.enum';
 import { AbstractHttpAdapter } from '../../adapters';
 import { ApplicationConfig } from '../../application-config';
@@ -19,6 +19,7 @@ import { PipesConsumer } from '../../pipes/pipes-consumer';
 import { PipesContextCreator } from '../../pipes/pipes-context-creator';
 import { RouteParamsFactory } from '../../router/route-params-factory';
 import { RouterExecutionContext } from '../../router/router-execution-context';
+import { HeaderStream } from '../../router/sse-stream';
 import { NoopHttpAdapter } from '../utils/noop-adapter.spec';
 
 describe('RouterExecutionContext', () => {
@@ -182,7 +183,7 @@ describe('RouterExecutionContext', () => {
       const metadata = {
         [RouteParamtypes.REQUEST]: { index: 0, data: 'test', pipes: [] },
         [RouteParamtypes.BODY]: { index: 2, data: 'test', pipes: [] },
-        [`key${CUSTOM_ROUTE_AGRS_METADATA}`]: {
+        [`key${CUSTOM_ROUTE_ARGS_METADATA}`]: {
           index: 3,
           data: 'custom',
           pipes: [],
@@ -193,7 +194,7 @@ describe('RouterExecutionContext', () => {
       const expectedValues = [
         { index: 0, type: RouteParamtypes.REQUEST, data: 'test' },
         { index: 2, type: RouteParamtypes.BODY, data: 'test' },
-        { index: 3, type: `key${CUSTOM_ROUTE_AGRS_METADATA}`, data: 'custom' },
+        { index: 3, type: `key${CUSTOM_ROUTE_ARGS_METADATA}`, data: 'custom' },
       ];
       expect(values[0]).to.deep.include(expectedValues[0]);
       expect(values[1]).to.deep.include(expectedValues[1]);
@@ -470,6 +471,38 @@ describe('RouterExecutionContext', () => {
           );
         }
       });
+
+      it('should apply any headers that exists on the response', async () => {
+        const result = of('test');
+        const response = new PassThrough() as HeaderStream;
+        response.write = sinon.spy();
+        response.writeHead = sinon.spy();
+        response.flushHeaders = sinon.spy();
+        response.getHeaders = sinon
+          .stub()
+          .returns({ 'access-control-headers': 'some-cors-value' });
+
+        const request = new PassThrough();
+        request.on = sinon.spy();
+
+        sinon.stub(contextCreator, 'reflectRenderTemplate').returns(undefined);
+        sinon.stub(contextCreator, 'reflectSse').returns('/');
+
+        const handler = contextCreator.createHandleResponseFn(
+          null,
+          true,
+          undefined,
+          200,
+        ) as HandlerResponseBasicFn;
+        await handler(result, response, request);
+
+        expect(
+          (response.writeHead as sinon.SinonSpy).calledWith(
+            200,
+            sinon.match.hasNested('access-control-headers', 'some-cors-value'),
+          ),
+        ).to.be.true;
+      });
     });
   });
 });
diff --git a/packages/core/test/router/router-explorer.spec.ts b/packages/core/test/router/router-explorer.spec.ts
index f8da6c375..82ec5f51f 100644
--- a/packages/core/test/router/router-explorer.spec.ts
+++ b/packages/core/test/router/router-explorer.spec.ts
@@ -1,5 +1,3 @@
-import { VERSION_NEUTRAL } from '@nestjs/common';
-import { VersionValue } from '@nestjs/common/interfaces';
 import { expect } from 'chai';
 import * as sinon from 'sinon';
 import { Controller } from '../../../common/decorators/core/controller.decorator';
@@ -10,17 +8,19 @@ import {
 } from '../../../common/decorators/http/request-mapping.decorator';
 import { RequestMethod } from '../../../common/enums/request-method.enum';
 import { VersioningType } from '../../../common/enums/version-type.enum';
-import { VersioningOptions } from '../../../common/interfaces/version-options.interface';
 import { Injector } from '../../../core/injector/injector';
 import { ApplicationConfig } from '../../application-config';
+import { UnknownRequestMappingException } from '../../errors/exceptions/unknown-request-mapping.exception';
 import { ExecutionContextHost } from '../../helpers/execution-context-host';
 import { NestContainer } from '../../injector/container';
 import { InstanceWrapper } from '../../injector/instance-wrapper';
+import { GraphInspector } from '../../inspector/graph-inspector';
 import { MetadataScanner } from '../../metadata-scanner';
 import { RoutePathMetadata } from '../../router/interfaces/route-path-metadata.interface';
 import { RoutePathFactory } from '../../router/route-path-factory';
 import { RouterExceptionFilters } from '../../router/router-exception-filters';
 import { RouterExplorer } from '../../router/router-explorer';
+import { NoopHttpAdapter } from '../utils/noop-adapter.spec';
 
 describe('RouterExplorer', () => {
   @Controller('global')
@@ -53,11 +53,14 @@ describe('RouterExplorer', () => {
     public getTestUsingArray() {}
   }
 
+  class ClassWithMissingControllerDecorator {}
+
   let routerBuilder: RouterExplorer;
   let injector: Injector;
   let exceptionsFilter: RouterExceptionFilters;
   let applicationConfig: ApplicationConfig;
   let routePathFactory: RoutePathFactory;
+  let graphInspector: GraphInspector;
 
   beforeEach(() => {
     const container = new NestContainer();
@@ -65,6 +68,7 @@ describe('RouterExplorer', () => {
     applicationConfig = new ApplicationConfig();
     injector = new Injector();
     routePathFactory = new RoutePathFactory(applicationConfig);
+    graphInspector = new GraphInspector(container);
     exceptionsFilter = new RouterExceptionFilters(
       container,
       applicationConfig,
@@ -78,179 +82,10 @@ describe('RouterExplorer', () => {
       exceptionsFilter,
       applicationConfig,
       routePathFactory,
+      graphInspector,
     );
   });
 
-  describe('scanForPaths', () => {
-    it('should method return expected list of route paths', () => {
-      const paths = routerBuilder.scanForPaths(new TestRoute());
-
-      expect(paths).to.have.length(4);
-
-      expect(paths[0].path).to.eql(['/test']);
-      expect(paths[1].path).to.eql(['/test']);
-      expect(paths[2].path).to.eql(['/another-test']);
-      expect(paths[3].path).to.eql(['/foo', '/bar']);
-
-      expect(paths[0].requestMethod).to.eql(RequestMethod.GET);
-      expect(paths[1].requestMethod).to.eql(RequestMethod.POST);
-      expect(paths[2].requestMethod).to.eql(RequestMethod.ALL);
-      expect(paths[3].requestMethod).to.eql(RequestMethod.GET);
-    });
-
-    it('should method return expected list of route paths alias', () => {
-      const paths = routerBuilder.scanForPaths(new TestRouteAlias());
-
-      expect(paths).to.have.length(4);
-
-      expect(paths[0].path).to.eql(['/test']);
-      expect(paths[1].path).to.eql(['/test']);
-      expect(paths[2].path).to.eql(['/another-test']);
-      expect(paths[3].path).to.eql(['/foo', '/bar']);
-
-      expect(paths[0].requestMethod).to.eql(RequestMethod.GET);
-      expect(paths[1].requestMethod).to.eql(RequestMethod.POST);
-      expect(paths[2].requestMethod).to.eql(RequestMethod.ALL);
-      expect(paths[3].requestMethod).to.eql(RequestMethod.GET);
-    });
-  });
-
-  describe('exploreMethodMetadata', () => {
-    it('should method return expected object which represent single route', () => {
-      const instance = new TestRoute();
-      const instanceProto = Object.getPrototypeOf(instance);
-
-      const route = routerBuilder.exploreMethodMetadata(
-        instance,
-        instanceProto,
-        'getTest',
-      );
-
-      expect(route.path).to.eql(['/test']);
-      expect(route.requestMethod).to.eql(RequestMethod.GET);
-      expect(route.targetCallback).to.eq(instance.getTest);
-    });
-
-    it('should method return expected object which represent single route with alias', () => {
-      const instance = new TestRouteAlias();
-      const instanceProto = Object.getPrototypeOf(instance);
-
-      const route = routerBuilder.exploreMethodMetadata(
-        instance,
-        instanceProto,
-        'getTest',
-      );
-
-      expect(route.path).to.eql(['/test']);
-      expect(route.requestMethod).to.eql(RequestMethod.GET);
-      expect(route.targetCallback).to.eq(instance.getTest);
-    });
-
-    it('should method return expected object which represent multiple routes', () => {
-      const instance = new TestRoute();
-      const instanceProto = Object.getPrototypeOf(instance);
-
-      const route = routerBuilder.exploreMethodMetadata(
-        instance,
-        instanceProto,
-        'getTestUsingArray',
-      );
-
-      expect(route.path).to.eql(['/foo', '/bar']);
-      expect(route.requestMethod).to.eql(RequestMethod.GET);
-      expect(route.targetCallback).to.eq(instance.getTestUsingArray);
-    });
-
-    it('should method return expected object which represent multiple routes with alias', () => {
-      const instance = new TestRouteAlias();
-      const instanceProto = Object.getPrototypeOf(instance);
-
-      const route = routerBuilder.exploreMethodMetadata(
-        instance,
-        instanceProto,
-        'getTestUsingArray',
-      );
-
-      expect(route.path).to.eql(['/foo', '/bar']);
-      expect(route.requestMethod).to.eql(RequestMethod.GET);
-      expect(route.targetCallback).to.eq(instance.getTestUsingArray);
-    });
-
-    describe('when new implementation is injected into router', () => {
-      it('should method return changed impl of single route', () => {
-        const instance = new TestRoute();
-        const instanceProto = Object.getPrototypeOf(instance);
-
-        const newImpl = function () {};
-        instance.getTest = newImpl;
-
-        const route = routerBuilder.exploreMethodMetadata(
-          instance,
-          instanceProto,
-          'getTest',
-        );
-
-        expect(route.targetCallback).to.eq(newImpl);
-        expect(route.path).to.eql(['/test']);
-        expect(route.requestMethod).to.eql(RequestMethod.GET);
-      });
-
-      it('should method return changed impl of single route which alias applied', () => {
-        const instance = new TestRouteAlias();
-        const instanceProto = Object.getPrototypeOf(instance);
-
-        const newImpl = function () {};
-        instance.getTest = newImpl;
-
-        const route = routerBuilder.exploreMethodMetadata(
-          instance,
-          instanceProto,
-          'getTest',
-        );
-
-        expect(route.targetCallback).to.eq(newImpl);
-        expect(route.path).to.eql(['/test']);
-        expect(route.requestMethod).to.eql(RequestMethod.GET);
-      });
-
-      it('should method return changed impl of multiple routes', () => {
-        const instance = new TestRoute();
-        const instanceProto = Object.getPrototypeOf(instance);
-
-        const newImpl = function () {};
-        instance.getTestUsingArray = newImpl;
-
-        const route = routerBuilder.exploreMethodMetadata(
-          instance,
-          instanceProto,
-          'getTestUsingArray',
-        );
-
-        expect(route.targetCallback).to.eq(newImpl);
-        expect(route.path).to.eql(['/foo', '/bar']);
-        expect(route.requestMethod).to.eql(RequestMethod.GET);
-      });
-
-      it('should method return changed impl of multiple routes which alias applied', () => {
-        const instance = new TestRouteAlias();
-        const instanceProto = Object.getPrototypeOf(instance);
-
-        const newImpl = function () {};
-        instance.getTestUsingArray = newImpl;
-
-        const route = routerBuilder.exploreMethodMetadata(
-          instance,
-          instanceProto,
-          'getTestUsingArray',
-        );
-
-        expect(route.targetCallback).to.eq(newImpl);
-        expect(route.path).to.eql(['/foo', '/bar']);
-        expect(route.requestMethod).to.eql(RequestMethod.GET);
-      });
-    });
-  });
-
   describe('applyPathsToRouterProxy', () => {
     it('should method return expected object which represent single route', () => {
       const bindStub = sinon.stub(
@@ -317,6 +152,15 @@ describe('RouterExplorer', () => {
         '/global-alias',
       ]);
     });
+
+    it("should throw UnknownRequestMappingException when missing the `@Controller()` decorator in the class, displaying class's name", () => {
+      expect(() =>
+        routerBuilder.extractRouterPath(ClassWithMissingControllerDecorator),
+      ).to.throw(
+        UnknownRequestMappingException,
+        /ClassWithMissingControllerDecorator/,
+      );
+    });
   });
 
   describe('createRequestScopedHandler', () => {
@@ -345,7 +189,7 @@ describe('RouterExplorer', () => {
         instance: { [methodKey]: {} },
       });
 
-      it('should delegete error to exception filters', async () => {
+      it('should delegate error to exception filters', async () => {
         const handler = routerBuilder.createRequestScopedHandler(
           wrapper,
           RequestMethod.ALL,
@@ -365,449 +209,34 @@ describe('RouterExplorer', () => {
   });
 
   describe('applyVersionFilter', () => {
-    describe('when the version is VERSION_NEUTRAL', () => {
-      it('should return the handler', () => {
-        const version = VERSION_NEUTRAL as VersionValue;
-        const versioningOptions: VersioningOptions = {
-          type: VersioningType.URI,
-        };
-        const handler = sinon.stub();
-
-        const routePathMetadata: RoutePathMetadata = {
-          methodVersion: version,
-          versioningOptions,
-        };
-        const versionFilter = (routerBuilder as any).applyVersionFilter(
-          null,
-          routePathMetadata,
-          handler,
-        );
-
-        const req = {};
-        const res = {};
-        const next = sinon.stub();
-
-        versionFilter(req, res, next);
-
-        expect(handler.calledWith(req, res, next)).to.be.true;
-      });
-    });
-
-    describe('when the versioning type is URI', () => {
-      it('should return the handler', () => {
-        const version = '1';
-        const versioningOptions: VersioningOptions = {
-          type: VersioningType.URI,
-        };
-        const handler = sinon.stub();
-
-        const routePathMetadata: RoutePathMetadata = {
-          methodVersion: version,
-          versioningOptions,
-        };
-        const versionFilter = (routerBuilder as any).applyVersionFilter(
-          null,
-          routePathMetadata,
-          handler,
-        );
-
-        const req = {};
-        const res = {};
-        const next = sinon.stub();
-
-        versionFilter(req, res, next);
-        expect(handler.calledWith(req, res, next)).to.be.true;
-      });
-    });
-
-    describe('when the versioning type is MEDIA_TYPE', () => {
-      it('should return next if there is no Media Type header', () => {
-        const version = '1';
-        const versioningOptions: VersioningOptions = {
-          type: VersioningType.MEDIA_TYPE,
-          key: 'v=',
-        };
-        const handler = sinon.stub();
-
-        const routePathMetadata: RoutePathMetadata = {
-          methodVersion: version,
-          versioningOptions,
-        };
-        const versionFilter = (routerBuilder as any).applyVersionFilter(
-          null,
-          routePathMetadata,
-          handler,
-        );
-
-        const req = { headers: {} };
-        const res = {};
-        const next = sinon.stub();
-
-        versionFilter(req, res, next);
-
-        expect(next.called).to.be.true;
-      });
-
-      it('should return next if there is no version in the Media Type header', () => {
-        const version = '1';
-        const versioningOptions: VersioningOptions = {
-          type: VersioningType.MEDIA_TYPE,
-          key: 'v=',
-        };
-        const handler = sinon.stub();
-
-        const routePathMetadata: RoutePathMetadata = {
-          methodVersion: version,
-          versioningOptions,
-        };
-        const versionFilter = (routerBuilder as any).applyVersionFilter(
-          null,
-          routePathMetadata,
-          handler,
-        );
-
-        const req = { headers: { accept: 'application/json;' } };
-        const res = {};
-        const next = sinon.stub();
-
-        versionFilter(req, res, next);
-
-        expect(next.called).to.be.true;
-      });
-
-      describe('when the handler version is an array', () => {
-        it('should return next if the version in the Media Type header does not match the handler version', () => {
-          const version = ['1', '2'];
-          const versioningOptions: VersioningOptions = {
-            type: VersioningType.MEDIA_TYPE,
-            key: 'v=',
-          };
-          const handler = sinon.stub();
-
-          const routePathMetadata: RoutePathMetadata = {
-            methodVersion: version,
-            versioningOptions,
-          };
-          const versionFilter = (routerBuilder as any).applyVersionFilter(
-            null,
-            routePathMetadata,
-            handler,
-          );
-
-          const req = { headers: { accept: 'application/json;v=3' } };
-          const res = {};
-          const next = sinon.stub();
-
-          versionFilter(req, res, next);
-
-          expect(next.called).to.be.true;
-        });
-
-        it('should return the handler if the version in the Media Type header matches the handler version', () => {
-          const version = ['1', '2'];
-          const versioningOptions: VersioningOptions = {
-            type: VersioningType.MEDIA_TYPE,
-            key: 'v=',
-          };
-          const handler = sinon.stub();
-
-          const routePathMetadata: RoutePathMetadata = {
-            methodVersion: version,
-            versioningOptions,
-          };
-          const versionFilter = (routerBuilder as any).applyVersionFilter(
-            null,
-            routePathMetadata,
-            handler,
-          );
-
-          const req = { headers: { accept: 'application/json;v=1' } };
-          const res = {};
-          const next = sinon.stub();
-
-          versionFilter(req, res, next);
-
-          expect(handler.calledWith(req, res, next)).to.be.true;
-        });
-      });
-
-      describe('when the handler version is a string', () => {
-        it('should return next if the version in the Media Type header does not match the handler version', () => {
-          const version = '1';
-          const versioningOptions: VersioningOptions = {
-            type: VersioningType.MEDIA_TYPE,
-            key: 'v=',
-          };
-          const handler = sinon.stub();
-
-          const routePathMetadata: RoutePathMetadata = {
-            methodVersion: version,
-            versioningOptions,
-          };
-          const versionFilter = (routerBuilder as any).applyVersionFilter(
-            null,
-            routePathMetadata,
-            handler,
-          );
-
-          const req = { headers: { accept: 'application/json;v=3' } };
-          const res = {};
-          const next = sinon.stub();
-
-          versionFilter(req, res, next);
-
-          expect(next.called).to.be.true;
-        });
-
-        it('should return the handler if the version in the Media Type header matches the handler version', () => {
-          const version = '1';
-          const versioningOptions: VersioningOptions = {
-            type: VersioningType.MEDIA_TYPE,
-            key: 'v=',
-          };
-          const handler = sinon.stub();
-
-          const routePathMetadata: RoutePathMetadata = {
-            methodVersion: version,
-            versioningOptions,
-          };
-          const versionFilter = (routerBuilder as any).applyVersionFilter(
-            null,
-            routePathMetadata,
-            handler,
-          );
-
-          const req = { headers: { accept: 'application/json;v=1' } };
-          const res = {};
-          const next = sinon.stub();
-
-          versionFilter(req, res, next);
-
-          expect(handler.calledWith(req, res, next)).to.be.true;
-        });
-      });
-    });
-
-    describe('when the versioning type is HEADER', () => {
-      it('should return next if there is no Custom Header', () => {
-        const version = '1';
-        const versioningOptions: VersioningOptions = {
-          type: VersioningType.HEADER,
-          header: 'X-API-Version',
-        };
-        const handler = sinon.stub();
-
-        const routePathMetadata: RoutePathMetadata = {
-          methodVersion: version,
-          versioningOptions,
-        };
-        const versionFilter = (routerBuilder as any).applyVersionFilter(
-          null,
-          routePathMetadata,
-          handler,
-        );
-
-        const req = { headers: {} };
-        const res = {};
-        const next = sinon.stub();
-
-        versionFilter(req, res, next);
-
-        expect(next.called).to.be.true;
-      });
-
-      it('should return next if there is no version in the Custom Header', () => {
-        const version = '1';
-        const versioningOptions: VersioningOptions = {
-          type: VersioningType.HEADER,
-          header: 'X-API-Version',
-        };
-        const handler = sinon.stub();
-
-        const routePathMetadata: RoutePathMetadata = {
-          methodVersion: version,
-          versioningOptions,
-        };
-        const versionFilter = (routerBuilder as any).applyVersionFilter(
-          null,
-          routePathMetadata,
-          handler,
-        );
-
-        const req = { headers: { 'X-API-Version': '' } };
-        const res = {};
-        const next = sinon.stub();
-
-        versionFilter(req, res, next);
-
-        expect(next.called).to.be.true;
-      });
-
-      describe('when the handler version is an array', () => {
-        it('should return next if the version in the Custom Header does not match the handler version', () => {
-          const version = ['1', '2'];
-          const versioningOptions: VersioningOptions = {
-            type: VersioningType.HEADER,
-            header: 'X-API-Version',
-          };
-          const handler = sinon.stub();
-
-          const routePathMetadata: RoutePathMetadata = {
-            methodVersion: version,
-            versioningOptions,
-          };
-          const versionFilter = (routerBuilder as any).applyVersionFilter(
-            null,
-            routePathMetadata,
-            handler,
-          );
-
-          const req = { headers: { 'X-API-Version': '3' } };
-          const res = {};
-          const next = sinon.stub();
-
-          versionFilter(req, res, next);
-
-          expect(next.called).to.be.true;
-        });
-
-        it('should return the handler if the version in the Custom Header matches the handler version', () => {
-          const version = ['1', '2'];
-          const versioningOptions: VersioningOptions = {
-            type: VersioningType.HEADER,
-            header: 'X-API-Version',
-          };
-          const handler = sinon.stub();
-
-          const routePathMetadata: RoutePathMetadata = {
-            methodVersion: version,
-            versioningOptions,
-          };
-          const versionFilter = (routerBuilder as any).applyVersionFilter(
-            null,
-            routePathMetadata,
-            handler,
-          );
-
-          const req = { headers: { 'X-API-Version': '1' } };
-          const res = {};
-          const next = sinon.stub();
-
-          versionFilter(req, res, next);
-
-          expect(handler.calledWith(req, res, next)).to.be.true;
-        });
-      });
-
-      describe('when the handler version is a string', () => {
-        it('should return next if the version in the Custom Header does not match the handler version', () => {
-          const version = '1';
-          const versioningOptions: VersioningOptions = {
-            type: VersioningType.HEADER,
-            header: 'X-API-Version',
-          };
-          const handler = sinon.stub();
-
-          const routePathMetadata: RoutePathMetadata = {
-            methodVersion: version,
-            versioningOptions,
-          };
-          const versionFilter = (routerBuilder as any).applyVersionFilter(
-            null,
-            routePathMetadata,
-            handler,
-          );
-
-          const req = { headers: { 'X-API-Version': '3' } };
-          const res = {};
-          const next = sinon.stub();
-
-          versionFilter(req, res, next);
-
-          expect(next.called).to.be.true;
-        });
-
-        it('should return the handler if the version in the Custom Header matches the handler version', () => {
-          const version = '1';
-          const versioningOptions: VersioningOptions = {
-            type: VersioningType.HEADER,
-            header: 'X-API-Version',
-          };
-          const handler = sinon.stub();
-
-          const routePathMetadata: RoutePathMetadata = {
-            methodVersion: version,
-            versioningOptions,
-          };
-          const versionFilter = (routerBuilder as any).applyVersionFilter(
-            null,
-            routePathMetadata,
-            handler,
-          );
-
-          const req = { headers: { 'X-API-Version': '1' } };
-          const res = {};
-          const next = sinon.stub();
-
-          versionFilter(req, res, next);
-
-          expect(handler.calledWith(req, res, next)).to.be.true;
-        });
-      });
-    });
-
-    describe('when versioning type is unrecognized', () => {
-      it('should throw an error if there is no next function', () => {
-        const version = '1';
-        const versioningOptions: any = {
-          type: 'UNKNOWN',
-        };
-        const handler = sinon.stub();
-
-        const routePathMetadata: RoutePathMetadata = {
-          methodVersion: version,
-          versioningOptions,
-        };
-        const versionFilter = (routerBuilder as any).applyVersionFilter(
-          null,
-          routePathMetadata,
-          handler,
-        );
-
-        const req = {};
-        const res = {};
-        const next = null;
-
-        expect(() => versionFilter(req, res, next)).to.throw(
-          'HTTP adapter does not support filtering on version',
-        );
-      });
+    it('should call and return the `applyVersionFilter` from the underlying http server', () => {
+      const router = sinon.spy(new NoopHttpAdapter({}));
+      const routePathMetadata: RoutePathMetadata = {
+        methodVersion:
+          sinon.fake() as unknown as RoutePathMetadata['methodVersion'],
+        versioningOptions:
+          sinon.fake() as unknown as RoutePathMetadata['versioningOptions'],
+      };
+      const handler = sinon.stub();
 
-      it('should return next', () => {
-        const version = '1';
-        const versioningOptions: any = {
-          type: 'UNKNOWN',
-        };
-        const handler = sinon.stub();
+      // We're using type assertion here because `applyVersionFilter` is private
+      const versionFilter = (routerBuilder as any).applyVersionFilter(
+        router,
+        routePathMetadata,
+        handler,
+      );
 
-        const routePathMetadata: RoutePathMetadata = {
-          methodVersion: version,
-          versioningOptions,
-        };
-        const versionFilter = (routerBuilder as any).applyVersionFilter(
-          null,
-          routePathMetadata,
+      expect(
+        router.applyVersionFilter.calledOnceWithExactly(
           handler,
-        );
-
-        const req = {};
-        const res = {};
-        const next = sinon.stub();
-
-        versionFilter(req, res, next);
+          routePathMetadata.methodVersion,
+          routePathMetadata.versioningOptions,
+        ),
+      ).to.be.true;
 
-        expect(next.called).to.be.true;
-      });
+      expect(router.applyVersionFilter.returnValues[0]).to.be.equal(
+        versionFilter,
+      );
     });
   });
 });
diff --git a/packages/core/test/router/router-response-controller.spec.ts b/packages/core/test/router/router-response-controller.spec.ts
index 3f24aa7b5..aac321262 100644
--- a/packages/core/test/router/router-response-controller.spec.ts
+++ b/packages/core/test/router/router-response-controller.spec.ts
@@ -1,7 +1,7 @@
 import { isNil, isObject } from '@nestjs/common/utils/shared.utils';
 import { expect } from 'chai';
 import { IncomingMessage, ServerResponse } from 'http';
-import { Observable, of } from 'rxjs';
+import { Observable, of, Subject } from 'rxjs';
 import * as sinon from 'sinon';
 import { PassThrough, Writable } from 'stream';
 import { HttpStatus, RequestMethod } from '../../../common';
@@ -71,13 +71,13 @@ describe('RouterResponseController', () => {
   describe('transformToResult', () => {
     describe('when resultOrDeferred', () => {
       describe('is Promise', () => {
-        it('should return Promise', async () => {
+        it('should return Promise that resolves to the value resolved by the input Promise', async () => {
           const value = 100;
           expect(
             await routerResponseController.transformToResult(
               Promise.resolve(value),
             ),
-          ).to.be.eq(100);
+          ).to.be.eq(value);
         });
       });
 
@@ -88,16 +88,25 @@ describe('RouterResponseController', () => {
             await routerResponseController.transformToResult(
               of(1, 2, 3, lastValue),
             ),
-          ).to.be.eq(100);
+          ).to.be.eq(lastValue);
         });
       });
 
-      describe('is value', () => {
-        it('should return Promise', async () => {
+      describe('is an object that has the method `subscribe`', () => {
+        it('should return a Promise that resolves to the input value', async () => {
+          const value = { subscribe() {} };
+          expect(
+            await routerResponseController.transformToResult(value),
+          ).to.equal(value);
+        });
+      });
+
+      describe('is an ordinary value', () => {
+        it('should return a Promise that resolves to the input value', async () => {
           const value = 100;
           expect(
             await routerResponseController.transformToResult(value),
-          ).to.be.eq(100);
+          ).to.be.eq(value);
         });
       });
     });
@@ -299,7 +308,7 @@ describe('RouterResponseController', () => {
       request.destroy();
       await written(response);
       expect(response.content).to.eql(
-        `:
+        `
 id: 1
 data: test
 
@@ -310,7 +319,7 @@ data: test
     it('should close on request close', done => {
       const result = of('test');
       const response = new Writable();
-      response.end = () => done();
+      response.end = () => done() as any;
       response._write = () => {};
 
       const request = new Writable();
@@ -327,7 +336,7 @@ data: test
     it('should close the request when observable completes', done => {
       const result = of('test');
       const response = new Writable();
-      response.end = done;
+      response.end = done as any;
       response._write = () => {};
 
       const request = new Writable();
@@ -349,14 +358,86 @@ data: test
       const request = new Writable();
       request._write = () => {};
 
-      routerResponseController.sse(
-        result as unknown as Observable<string>,
-        response as unknown as ServerResponse,
-        request as unknown as IncomingMessage,
-      );
+      try {
+        routerResponseController.sse(
+          result as unknown as Observable<string>,
+          response as unknown as ServerResponse,
+          request as unknown as IncomingMessage,
+        );
+      } catch {
+        // Whether an error is thrown or not
+        // is not relevant, so long as
+        // result is not called
+      }
 
       sinon.assert.notCalled(result);
       done();
     });
+
+    describe('when there is an error', () => {
+      it('should close the request', done => {
+        const result = new Subject();
+        const response = new Writable();
+        response.end = done as any;
+        response._write = () => {};
+
+        const request = new Writable();
+        request._write = () => {};
+
+        routerResponseController.sse(
+          result,
+          response as unknown as ServerResponse,
+          request as unknown as IncomingMessage,
+        );
+
+        result.error(new Error('Some error'));
+      });
+
+      it('should write the error message to the stream', async () => {
+        class Sink extends Writable {
+          private readonly chunks: string[] = [];
+
+          _write(
+            chunk: any,
+            encoding: string,
+            callback: (error?: Error | null) => void,
+          ): void {
+            this.chunks.push(chunk);
+            callback();
+          }
+
+          get content() {
+            return this.chunks.join('');
+          }
+        }
+
+        const written = (stream: Writable) =>
+          new Promise((resolve, reject) =>
+            stream.on('error', reject).on('finish', resolve),
+          );
+
+        const result = new Subject();
+        const response = new Sink();
+        const request = new PassThrough();
+        routerResponseController.sse(
+          result,
+          response as unknown as ServerResponse,
+          request as unknown as IncomingMessage,
+        );
+
+        result.error(new Error('Some error'));
+        request.destroy();
+
+        await written(response);
+        expect(response.content).to.eql(
+          `
+event: error
+id: 1
+data: Some error
+
+`,
+        );
+      });
+    });
   });
 });
diff --git a/packages/core/test/router/routes-resolver.spec.ts b/packages/core/test/router/routes-resolver.spec.ts
index 1b88cee5f..9819f4aae 100644
--- a/packages/core/test/router/routes-resolver.spec.ts
+++ b/packages/core/test/router/routes-resolver.spec.ts
@@ -13,6 +13,8 @@ import { ApplicationConfig } from '../../application-config';
 import { NestContainer } from '../../injector';
 import { Injector } from '../../injector/injector';
 import { InstanceWrapper } from '../../injector/instance-wrapper';
+import { GraphInspector } from '../../inspector/graph-inspector';
+import { SerializedGraph } from '../../inspector/serialized-graph';
 import { RoutesResolver } from '../../router/routes-resolver';
 import { NoopHttpAdapter } from '../utils/noop-adapter.spec';
 
@@ -65,6 +67,7 @@ describe('RoutesResolver', () => {
       getModules: () => modules,
       getModuleByKey: (key: string) => modules.get(key),
       getHttpAdapterRef: () => applicationRef,
+      serializedGraph: new SerializedGraph(),
     } as any;
     router = {
       get() {},
@@ -77,6 +80,7 @@ describe('RoutesResolver', () => {
       container,
       new ApplicationConfig(),
       new Injector(),
+      new GraphInspector(container),
     );
   });
 
@@ -175,6 +179,7 @@ describe('RoutesResolver', () => {
         container,
         applicationConfig,
         new Injector(),
+        new GraphInspector(container),
       );
 
       const routes = new Map();
@@ -319,6 +324,13 @@ describe('RoutesResolver', () => {
           expect(outputErr).to.be.instanceof(BadRequestException);
         });
       });
+      describe('URIError', () => {
+        it('should map to BadRequestException', () => {
+          const err = new URIError();
+          const outputErr = routesResolver.mapExternalException(err);
+          expect(outputErr).to.be.instanceof(BadRequestException);
+        });
+      });
       describe('other', () => {
         it('should behave as an identity', () => {
           const err = new Error();
diff --git a/packages/core/test/router/sse-stream.spec.ts b/packages/core/test/router/sse-stream.spec.ts
index 1e7dda54a..173a522fe 100644
--- a/packages/core/test/router/sse-stream.spec.ts
+++ b/packages/core/test/router/sse-stream.spec.ts
@@ -43,6 +43,7 @@ describe('SseStream', () => {
     const sse = new SseStream();
     const sink = new Sink();
     sse.pipe(sink);
+
     sse.writeMessage(
       {
         data: 'hello\nworld',
@@ -57,8 +58,9 @@ describe('SseStream', () => {
     );
     sse.end();
     await written(sink);
+
     expect(sink.content).to.equal(
-      `:
+      `
 id: 1
 data: hello
 data: world
@@ -75,6 +77,7 @@ data: monde
     const sse = new SseStream();
     const sink = new Sink();
     sse.pipe(sink);
+
     sse.writeMessage(
       {
         data: { hello: 'world' },
@@ -83,8 +86,9 @@ data: monde
     );
     sse.end();
     await written(sink);
+
     expect(sink.content).to.equal(
-      `:
+      `
 id: 1
 data: {"hello":"world"}
 
@@ -96,6 +100,7 @@ data: {"hello":"world"}
     const sse = new SseStream();
     const sink = new Sink();
     sse.pipe(sink);
+
     sse.writeMessage(
       {
         type: 'tea-time',
@@ -107,8 +112,9 @@ data: {"hello":"world"}
     );
     sse.end();
     await written(sink);
+
     expect(sink.content).to.equal(
-      `:
+      `
 event: tea-time
 id: the-id
 retry: 222
@@ -138,12 +144,29 @@ data: hello
     sse.pipe(sink);
   });
 
+  it('sets additional headers when provided', callback => {
+    const sse = new SseStream();
+    const sink = new Sink(
+      (status: number, headers: string | OutgoingHttpHeaders) => {
+        expect(headers).to.contain.keys('access-control-headers');
+        expect(headers['access-control-headers']).to.equal('some-cors-value');
+        callback();
+        return sink;
+      },
+    );
+
+    sse.pipe(sink, {
+      additionalHeaders: { 'access-control-headers': 'some-cors-value' },
+    });
+  });
+
   it('allows an eventsource to connect', callback => {
     let sse: SseStream;
     const server = createServer((req, res) => {
       sse = new SseStream(req);
       sse.pipe(res);
     });
+
     server.listen(() => {
       const es = new EventSource(
         `http://localhost:${(server.address() as AddressInfo).port}`,
diff --git a/packages/core/test/scanner.spec.ts b/packages/core/test/scanner.spec.ts
index 9fe8e5e6a..e7b5b2b52 100644
--- a/packages/core/test/scanner.spec.ts
+++ b/packages/core/test/scanner.spec.ts
@@ -1,4 +1,4 @@
-import { Injectable } from '@nestjs/common';
+import { Catch, Injectable } from '@nestjs/common';
 import { expect } from 'chai';
 import * as sinon from 'sinon';
 import { GUARDS_METADATA } from '../../common/constants';
@@ -8,12 +8,15 @@ import { Module } from '../../common/decorators/modules/module.decorator';
 import { Scope } from '../../common/interfaces';
 import { ApplicationConfig } from '../application-config';
 import { APP_FILTER, APP_GUARD, APP_INTERCEPTOR, APP_PIPE } from '../constants';
+import { InvalidClassModuleException } from '../errors/exceptions/invalid-class-module.exception';
 import { InvalidModuleException } from '../errors/exceptions/invalid-module.exception';
 import { UndefinedModuleException } from '../errors/exceptions/undefined-module.exception';
 import { NestContainer } from '../injector/container';
 import { InstanceWrapper } from '../injector/instance-wrapper';
+import { GraphInspector } from '../inspector/graph-inspector';
 import { MetadataScanner } from '../metadata-scanner';
-import { DependenciesScanner, ModuleToOverride } from '../scanner';
+import { DependenciesScanner } from '../scanner';
+import Sinon = require('sinon');
 
 describe('DependenciesScanner', () => {
   class Guard {}
@@ -21,6 +24,9 @@ describe('DependenciesScanner', () => {
   @Injectable()
   class TestComponent {}
 
+  @Catch()
+  class TestExceptionFilterWithoutInjectable {}
+
   @Controller('')
   class TestController {}
 
@@ -51,14 +57,17 @@ describe('DependenciesScanner', () => {
   let scanner: DependenciesScanner;
   let mockContainer: sinon.SinonMock;
   let container: NestContainer;
+  let graphInspector: GraphInspector;
 
   beforeEach(() => {
     container = new NestContainer();
     mockContainer = sinon.mock(container);
+    graphInspector = new GraphInspector(container);
 
     scanner = new DependenciesScanner(
       container,
       new MetadataScanner(),
+      graphInspector,
       new ApplicationConfig(),
     );
     sinon.stub(scanner, 'registerCoreModule').callsFake(async () => {});
@@ -68,17 +77,11 @@ describe('DependenciesScanner', () => {
     mockContainer.restore();
   });
 
-  it('should "putModule" call twice (2 modules) container method "addModule"', async () => {
-    const expectationCountAddModule = mockContainer
-      .expects('addModule')
-      .twice();
-    const expectationCountReplaceModule = mockContainer
-      .expects('replaceModule')
-      .never();
+  it('should "insertModule" call twice (2 modules) container method "addModule"', async () => {
+    const expectation = mockContainer.expects('addModule').twice();
 
-    await scanner.scan(TestModule as any);
-    expectationCountAddModule.verify();
-    expectationCountReplaceModule.verify();
+    await scanner.scan(TestModule);
+    expectation.verify();
   });
 
   it('should "insertProvider" call twice (2 components) container method "addProvider"', async () => {
@@ -102,134 +105,6 @@ describe('DependenciesScanner', () => {
     expectation.verify();
   });
 
-  describe('when there is modules overrides', () => {
-    @Injectable()
-    class OverwrittenTestComponent {}
-
-    @Controller('')
-    class OverwrittenControlerOne {}
-
-    @Controller('')
-    class OverwrittenControllerTwo {}
-
-    @Module({
-      controllers: [OverwrittenControlerOne],
-      providers: [OverwrittenTestComponent],
-    })
-    class OverwrittenModuleOne {}
-
-    @Module({
-      controllers: [OverwrittenControllerTwo],
-    })
-    class OverwrittenModuleTwo {}
-
-    @Module({
-      imports: [OverwrittenModuleOne, OverwrittenModuleTwo],
-    })
-    class OverrideTestModule {}
-
-    @Injectable()
-    class OverrideTestComponent {}
-
-    @Controller('')
-    class OverrideControllerOne {}
-
-    @Controller('')
-    class OverrideControllerTwo {}
-
-    @Module({
-      controllers: [OverwrittenControlerOne],
-      providers: [OverrideTestComponent],
-    })
-    class OverrideModuleOne {}
-
-    @Module({
-      controllers: [OverrideControllerTwo],
-    })
-    class OverrideModuleTwo {}
-
-    const modulesToOverride: ModuleToOverride[] = [
-      { moduleToReplace: OverwrittenModuleOne, newModule: OverrideModuleOne },
-      { moduleToReplace: OverwrittenModuleTwo, newModule: OverrideModuleTwo },
-    ];
-
-    it('should "putModule" call twice (2 modules) container method "replaceModule"', async () => {
-      const expectationReplaceModuleFirst = mockContainer
-        .expects('replaceModule')
-        .once()
-        .withArgs(OverwrittenModuleOne, OverrideModuleOne, sinon.match.array);
-      const expectationReplaceModuleSecond = mockContainer
-        .expects('replaceModule')
-        .once()
-        .withArgs(OverwrittenModuleTwo, OverrideModuleTwo, sinon.match.array);
-      const expectationCountAddModule = mockContainer
-        .expects('addModule')
-        .once();
-
-      await scanner.scan(OverrideTestModule as any, modulesToOverride);
-
-      expectationReplaceModuleFirst.verify();
-      expectationReplaceModuleSecond.verify();
-      expectationCountAddModule.verify();
-    });
-
-    it('should "insertProvider" call once container method "addProvider"', async () => {
-      const expectation = mockContainer.expects('addProvider').once();
-
-      await scanner.scan(OverrideTestModule as any);
-      expectation.verify();
-    });
-
-    it('should "insertController" call twice (2 components) container method "addController"', async () => {
-      const expectation = mockContainer.expects('addController').twice();
-      await scanner.scan(OverrideTestModule as any);
-      expectation.verify();
-    });
-
-    it('should "putModule" call container method "replaceModule" with forwardRef() when forwardRef property exists', async () => {
-      const overwrittenForwardRefSpy = sinon.spy();
-
-      @Module({})
-      class OverwrittenForwardRef {}
-
-      @Module({})
-      class Overwritten {
-        public static forwardRef() {
-          overwrittenForwardRefSpy();
-          return OverwrittenForwardRef;
-        }
-      }
-
-      const overrideForwardRefSpy = sinon.spy();
-
-      @Module({})
-      class OverrideForwardRef {}
-
-      @Module({})
-      class Override {
-        public static forwardRef() {
-          overrideForwardRefSpy();
-          return OverrideForwardRef;
-        }
-      }
-
-      @Module({
-        imports: [Overwritten],
-      })
-      class OverrideForwardRefTestModule {}
-
-      await scanner.scan(OverrideForwardRefTestModule as any, [
-        {
-          moduleToReplace: Overwritten,
-          newModule: Override,
-        },
-      ]);
-
-      expect(overwrittenForwardRefSpy.called).to.be.true;
-      expect(overrideForwardRefSpy.called).to.be.true;
-    });
-  });
-
   describe('reflectDynamicMetadata', () => {
     describe('when param has prototype', () => {
       it('should call "reflectParamInjectables" and "reflectInjectables"', () => {
@@ -264,45 +139,148 @@ describe('DependenciesScanner', () => {
   });
 
   describe('insertInjectable', () => {
-    it('should call "addInjectable"', () => {
-      const addInjectable = sinon
+    class InjectableCls {}
+    class HostCls {}
+
+    const instanceWrapper = { id: 'random_id' };
+    const token = 'token';
+    const methodKey = 'methodKey';
+
+    let addInjectableStub: Sinon.SinonStub;
+    let insertEnhancerMetadataCacheStub: Sinon.SinonStub;
+
+    beforeEach(() => {
+      addInjectableStub = sinon
         .stub((scanner as any).container, 'addInjectable')
+        .callsFake(() => instanceWrapper);
+      insertEnhancerMetadataCacheStub = sinon
+        .stub(graphInspector, 'insertEnhancerMetadataCache')
         .callsFake(() => undefined);
-      const comp = {};
-      const token = 'token';
+    });
 
-      scanner.insertInjectable(comp as any, token, null);
-      expect(addInjectable.calledWith(comp, token)).to.be.true;
+    describe('when injectable is of type function', () => {
+      const subtype = 'filter';
+      beforeEach(() => {
+        scanner.insertInjectable(
+          InjectableCls,
+          token,
+          HostCls,
+          subtype,
+          methodKey,
+        );
+      });
+
+      it('should call "addInjectable"', () => {
+        expect(addInjectableStub.calledWith(InjectableCls, token)).to.be.true;
+      });
+
+      it('should call "insertEnhancerMetadataCache"', () => {
+        expect(
+          insertEnhancerMetadataCacheStub.calledWith({
+            moduleToken: token,
+            classRef: HostCls,
+            enhancerInstanceWrapper: instanceWrapper,
+            targetNodeId: instanceWrapper.id,
+            methodKey,
+            subtype,
+          }),
+        ).to.be.true;
+      });
+    });
+    describe('when injectable is not of type function', () => {
+      const injectableRef = new InjectableCls();
+      const subtype = 'interceptor';
+
+      beforeEach(() => {
+        scanner.insertInjectable(
+          injectableRef,
+          token,
+          HostCls,
+          subtype,
+          methodKey,
+        );
+      });
+
+      it('should not call "addInjectable"', () => {
+        expect(addInjectableStub.notCalled).to.be.true;
+      });
+
+      it('should call "insertEnhancerMetadataCache"', () => {
+        expect(
+          insertEnhancerMetadataCacheStub.calledWith({
+            moduleToken: token,
+            classRef: HostCls,
+            enhancerRef: injectableRef,
+            methodKey,
+            subtype,
+          }),
+        ).to.be.true;
+      });
     });
   });
 
   class CompMethod {
     @UseGuards(Guard)
     public method() {}
+
+    @UseGuards(Guard, Guard)
+    public method2() {}
   }
   describe('reflectKeyMetadata', () => {
     it('should return undefined', () => {
       const result = scanner.reflectKeyMetadata(TestComponent, 'key', 'method');
       expect(result).to.be.undefined;
     });
-    it('should return array', () => {
+    it('should return an array that consists of 1 element', () => {
+      const methodKey = 'method';
+      const result = scanner.reflectKeyMetadata(
+        CompMethod,
+        GUARDS_METADATA,
+        methodKey,
+      );
+      expect(result).to.be.deep.equal({ methodKey, metadata: [Guard] });
+    });
+    it('should return an array that consists of 2 elements', () => {
+      const methodKey = 'method2';
       const result = scanner.reflectKeyMetadata(
         CompMethod,
         GUARDS_METADATA,
-        'method',
+        methodKey,
       );
-      expect(result).to.be.eql([Guard]);
+      expect(result).to.be.deep.equal({ methodKey, metadata: [Guard, Guard] });
     });
   });
 
   describe('insertModule', () => {
     it('should call forwardRef() when forwardRef property exists', () => {
+      sinon.stub(container, 'addModule').returns({} as any);
+
       const module = { forwardRef: sinon.spy() };
+      scanner.insertModule(module, []);
 
-      sinon.stub(container, 'addModule').returns({} as any);
-      scanner.insertModule(module as any, [] as any);
       expect(module.forwardRef.called).to.be.true;
     });
+    it('should throw "InvalidClassModuleException" exception when supplying a class annotated with `@Injectable()` decorator', () => {
+      sinon.stub(container, 'addModule').returns({} as any);
+
+      expect(scanner.insertModule(TestComponent, [])).to.be.rejectedWith(
+        InvalidClassModuleException,
+      );
+    });
+    it('should throw "InvalidClassModuleException" exception when supplying a class annotated with `@Controller()` decorator', () => {
+      sinon.stub(container, 'addModule').returns({} as any);
+
+      expect(scanner.insertModule(TestController, [])).to.be.rejectedWith(
+        InvalidClassModuleException,
+      );
+    });
+    it('should throw "InvalidClassModuleException" exception when supplying a class annotated with (only) `@Catch()` decorator', () => {
+      sinon.stub(container, 'addModule').returns({} as any);
+
+      expect(
+        scanner.insertModule(TestExceptionFilterWithoutInjectable, []),
+      ).to.be.rejectedWith(InvalidClassModuleException);
+    });
   });
 
   describe('insertImport', () => {
@@ -420,18 +398,30 @@ describe('DependenciesScanner', () => {
       (scanner as any).applicationProvidersApplyMap = [provider];
 
       const expectedInstance = {};
+      const instanceWrapper = {
+        instance: expectedInstance,
+      } as unknown as InstanceWrapper;
       mockContainer.expects('getModules').callsFake(() => ({
         get: () => ({
-          providers: { get: () => ({ instance: expectedInstance }) },
+          providers: { get: () => instanceWrapper },
         }),
       }));
+
       const applySpy = sinon.spy();
       sinon.stub(scanner, 'getApplyProvidersMap').callsFake(() => ({
         [provider.type]: applySpy,
       }));
+
+      const insertAttachedEnhancerStub = sinon.stub(
+        graphInspector,
+        'insertAttachedEnhancer',
+      );
+
       scanner.applyApplicationProviders();
+
       expect(applySpy.called).to.be.true;
       expect(applySpy.calledWith(expectedInstance)).to.be.true;
+      expect(insertAttachedEnhancerStub.calledWith(instanceWrapper)).to.be.true;
     });
     it('should apply each globally scoped provider', () => {
       const provider = {
@@ -448,13 +438,23 @@ describe('DependenciesScanner', () => {
           injectables: { get: () => expectedInstanceWrapper },
         }),
       }));
+
       const applySpy = sinon.spy();
       sinon.stub(scanner, 'getApplyRequestProvidersMap').callsFake(() => ({
         [provider.type]: applySpy,
       }));
+
+      const insertAttachedEnhancerStub = sinon.stub(
+        graphInspector,
+        'insertAttachedEnhancer',
+      );
+
       scanner.applyApplicationProviders();
+
       expect(applySpy.called).to.be.true;
       expect(applySpy.calledWith(expectedInstanceWrapper)).to.be.true;
+      expect(insertAttachedEnhancerStub.calledWith(expectedInstanceWrapper)).to
+        .be.true;
     });
   });
 
@@ -466,31 +466,45 @@ describe('DependenciesScanner', () => {
       scope: Scope.REQUEST,
     };
 
-    it('should add enhancers metadata to every controller', () => {
+    it('should add enhancers metadata to every controller and every entry provider', () => {
       (scanner as any).applicationProvidersApplyMap = [provider];
 
       const instance = new InstanceWrapper({ name: 'test' });
       const controllers = new Map();
-      const mockController = new InstanceWrapper();
+      const providers = new Map();
+
+      const fakeController = new InstanceWrapper();
+      const fakeProvider = new InstanceWrapper();
+
+      const providerToken = 'entryProvider';
+      controllers.set('test', fakeController);
+      providers.set(providerToken, fakeProvider);
 
-      controllers.set('test', mockController);
       mockContainer.expects('getModules').callsFake(() => ({
         get: () => ({
           injectables: { get: () => instance },
           controllers,
+          entryProviders: Array.from(providers.values()),
         }),
         values() {
           return [this.get()];
         },
       }));
-      const addEnhancerMetadataSpy = sinon.spy(
-        mockController,
+
+      const addEnhancerMetadataControllerSpy = sinon.spy(
+        fakeController,
+        'addEnhancerMetadata',
+      );
+      const addEnhancerMetadataProviderSpy = sinon.spy(
+        fakeProvider,
         'addEnhancerMetadata',
       );
       scanner.addScopedEnhancersMetadata();
 
-      expect(addEnhancerMetadataSpy.called).to.be.true;
-      expect(addEnhancerMetadataSpy.calledWith(instance)).to.be.true;
+      expect(addEnhancerMetadataControllerSpy.called).to.be.true;
+      expect(addEnhancerMetadataControllerSpy.calledWith(instance)).to.be.true;
+      expect(addEnhancerMetadataProviderSpy.called).to.be.true;
+      expect(addEnhancerMetadataProviderSpy.calledWith(instance)).to.be.true;
     });
   });
 
@@ -581,20 +595,14 @@ describe('DependenciesScanner', () => {
   describe('scanForModules', () => {
     it('should throw an exception when the imports array includes undefined', () => {
       try {
-        scanner.scanForModules({
-          moduleDefinition: UndefinedModule,
-          scope: [UndefinedModule],
-        });
+        scanner.scanForModules(UndefinedModule, [UndefinedModule]);
       } catch (exception) {
         expect(exception instanceof UndefinedModuleException).to.be.true;
       }
     });
     it('should throw an exception when the imports array includes an invalid value', () => {
       try {
-        scanner.scanForModules({
-          moduleDefinition: InvalidModule,
-          scope: [InvalidModule],
-        });
+        scanner.scanForModules(InvalidModule, [InvalidModule]);
       } catch (exception) {
         expect(exception instanceof InvalidModuleException).to.be.true;
       }
diff --git a/packages/core/test/services/reflector.service.spec.ts b/packages/core/test/services/reflector.service.spec.ts
index 27c8b04bd..20e7b5102 100644
--- a/packages/core/test/services/reflector.service.spec.ts
+++ b/packages/core/test/services/reflector.service.spec.ts
@@ -26,6 +26,10 @@ describe('Reflector', () => {
   });
 
   describe('getAllAndMerge', () => {
+    it('should return an empty array when there are no targets', () => {
+      const key = 'key';
+      expect(reflector.getAllAndMerge(key, [])).to.be.empty;
+    });
     it('should reflect metadata of all targets and concat arrays', () => {
       const key = 'key';
       const value = 'value';
diff --git a/packages/core/test/tsconfig.json b/packages/core/test/tsconfig.json
new file mode 100644
index 000000000..50d59661d
--- /dev/null
+++ b/packages/core/test/tsconfig.json
@@ -0,0 +1,3 @@
+{
+  "extends": "../../../tsconfig.spec.json"
+}
diff --git a/packages/core/test/utils/noop-adapter.spec.ts b/packages/core/test/utils/noop-adapter.spec.ts
index c2e73d09f..dc7daecb2 100644
--- a/packages/core/test/utils/noop-adapter.spec.ts
+++ b/packages/core/test/utils/noop-adapter.spec.ts
@@ -1,4 +1,5 @@
-import { RequestMethod } from '@nestjs/common';
+import { RequestMethod, VersioningOptions } from '@nestjs/common';
+import { VersionValue } from '@nestjs/common/interfaces';
 import { AbstractHttpAdapter } from '../../adapters';
 
 export class NoopHttpAdapter extends AbstractHttpAdapter {
@@ -13,11 +14,13 @@ export class NoopHttpAdapter extends AbstractHttpAdapter {
   getRequestMethod(request: any): any {}
   getRequestUrl(request: any): any {}
   reply(response: any, body: any): any {}
+  end(response: any, message?: any): any {}
   status(response: any, statusCode: number): any {}
   render(response: any, view: string, options: any): any {}
   redirect(response: any, statusCode: number, url: string) {}
   setErrorHandler(handler: Function, prefix = '/'): any {}
   setNotFoundHandler(handler: Function, prefix = '/'): any {}
+  isHeadersSent(response: any): any {}
   setHeader(response: any, name: string, value: string): any {}
   registerParserMiddleware(): any {}
   enableCors(options: any): any {}
@@ -25,4 +28,13 @@ export class NoopHttpAdapter extends AbstractHttpAdapter {
   getType() {
     return '';
   }
+  applyVersionFilter(
+    handler: Function,
+    version: VersionValue,
+    versioningOptions: VersioningOptions,
+  ) {
+    return (req, res, next) => {
+      return () => {};
+    };
+  }
 }
diff --git a/packages/core/tsconfig.build.json b/packages/core/tsconfig.build.json
new file mode 100644
index 000000000..99c13372d
--- /dev/null
+++ b/packages/core/tsconfig.build.json
@@ -0,0 +1,21 @@
+{
+  "extends": "../tsconfig.build.json",
+  "compilerOptions": {
+    "outDir": ".",
+    "rootDir": ".",
+    "paths": {
+      "@nestjs/common": ["../common"],
+      "@nestjs/common/*": ["../common/*"],
+      "@nestjs/microservices": ["../microservices"],
+      "@nestjs/microservices/*": ["../microservices/*"],
+      "@nestjs/websockets": ["../websockets"],
+      "@nestjs/websockets/*": ["../websockets/*"]
+    }
+  },
+  "exclude": ["node_modules", "dist", "test/**/*", "*.spec.ts"],
+  "references": [
+    {
+      "path": "../common/tsconfig.build.json"
+    }
+  ]
+}
diff --git a/packages/core/tsconfig.json b/packages/core/tsconfig.json
index b238080a4..2ae9e3c90 100644
--- a/packages/core/tsconfig.json
+++ b/packages/core/tsconfig.json
@@ -1,7 +1,13 @@
 {
-  "extends": "./../tsconfig.base.json",
+  "extends": "../tsconfig.build.json",
   "compilerOptions": {
-    "baseUrl": "./"
+    "types": ["node"]
   },
-  "include": ["*.ts", "**/*.ts"]
+  "files": [],
+  "include": [],
+  "references": [
+    {
+      "path": "./tsconfig.build.json"
+    }
+  ]
 }
diff --git a/packages/microservices/CHANGELOG.md b/packages/microservices/CHANGELOG.md
deleted file mode 100644
index f455b343b..000000000
--- a/packages/microservices/CHANGELOG.md
+++ /dev/null
@@ -1,18 +0,0 @@
-# Change Log
-
-All notable changes to this project will be documented in this file.
-See [Conventional Commits](https://conventionalcommits.org) for commit guidelines.
-
-<a name="8.2.0"></a>
-# [8.2.0](https://github.com/nestjs/nest/compare/v8.1.2...v8.2.0) (2021-11-08)
-
-
-### Bug Fixes
-
-* **microservices:** npm run format ([fdf11a5](https://github.com/nestjs/nest/commit/fdf11a5))
-
-
-### Features
-
-* **microservices:** adds packageDefinition option to ClientGrpc ([76f2918](https://github.com/nestjs/nest/commit/76f2918)), closes [#8457](https://github.com/nestjs/nest/issues/8457)
-* **microservices:** removes [@grpc](https://github.com/grpc)/grpc-js import ([3b74293](https://github.com/nestjs/nest/commit/3b74293))
diff --git a/packages/microservices/Readme.md b/packages/microservices/Readme.md
index f288809a9..16f48336d 100644
--- a/packages/microservices/Readme.md
+++ b/packages/microservices/Readme.md
@@ -11,7 +11,6 @@
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
 <a href="https://circleci.com/gh/nestjs/nest" target="_blank"><img src="https://img.shields.io/circleci/build/github/nestjs/nest/master" alt="CircleCI" /></a>
-<a href="https://coveralls.io/github/nestjs/nest?branch=master" target="_blank"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#9" alt="Coverage" /></a>
 <a href="https://discord.gg/G7Qnnhy" target="_blank"><img src="https://img.shields.io/badge/discord-online-brightgreen.svg" alt="Discord"/></a>
 <a href="https://opencollective.com/nest#backer" target="_blank"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
 <a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
@@ -37,8 +36,8 @@ Nest is a framework for building efficient, scalable <a href="http://nodejs.org"
 
 * To check out the [guide](https://docs.nestjs.com), visit [docs.nestjs.com](https://docs.nestjs.com). :books:
 * Ë¶ÅÊü•Áúã‰∏≠Êñá [ÊåáÂçó](readme_zh.md), ËØ∑ËÆøÈóÆ [docs.nestjs.cn](https://docs.nestjs.cn). :books:
-* [Í∞ÄÏù¥Îìú](readme_kr.md)Î•º ÌôïÏù∏ÌïòÎ†§Î©¥, [docs.nestjs.com](https://docs.nestjs.com)Î•º Î∞©Î¨∏ÌïòÏÑ∏Ïöî.:books: 
-* „ÉÅ„Çß„ÉÉ„ÇØ„Åô„Çã„Å´„ÅØ [„Ç¨„Ç§„Éâ](readme_jp.md), Ë©≥„Åó„Åè„ÅØ [docs.nestjs.com](https://docs.nestjs.com). :books: 
+* [Í∞ÄÏù¥Îìú](readme_kr.md) Î¨∏ÏÑúÎäî [docs.nestjs.com](https://docs.nestjs.com)ÏóêÏÑú ÌôïÏù∏ÌïòÏã§ Ïàò ÏûàÏäµÎãàÎã§. :books:
+* [„Ç¨„Ç§„Éâ](readme_jp.md)„ÅØ [docs.nestjs.com](https://docs.nestjs.com)„Åß„ÅîÁ¢∫Ë™ç„Åè„Å†„Åï„ÅÑ„ÄÇ :books:
 
 ## Questions
 
@@ -54,36 +53,49 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
 <table style="text-align:center;"><tr>
   <td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
+  <td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/red-hat-logo.svg" width="200" valign="middle" /></a></td>
 <td>
 <a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
 <td>
 <a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
+    <td>
+<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td><td>
+<a href="https://amplication.com/" target="_blank"><img src="https://nestjs.com/img/amplication-logo.svg" width="190" valign="middle" /></a></td>
 </tr></table>
 
 #### Gold Sponsors
 
 <table style="text-align:center;"><tr><td>
-  <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
-  <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
+<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="140" valign="middle" /></a></td>
 <td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
+<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td>
+ <td>
+<a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
+<a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td><td>
+<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td>
+<td>
+<a href="https://ridicorp.com/career/" target="_blank"><img src="https://nestjs.com/img/ridi-logo.svg" width="105" valign="middle" /></a></td><td>
+<a href="https://www.movavi.com/imovie-for-windows.html" target="_blank"><img src="https://nestjs.com/img/movavi-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
 <table style="text-align:center;"><tr><td>
 <a href="https://neoteric.eu/" target="_blank"><img src="https://nestjs.com/img/neoteric-cut.png" width="120" valign="middle" /></a> </td><td>
   <a href="http://gojob.com" target="_blank"><img src="http://nestjs.com/img/gojob-logo.png" valign="middle" width="100" /></a> </td><td>
-<a href="http://www.leogistics.com" target="_blank"><img src="https://nestjs.com/img/leogistics-logo.jpeg" width="150" valign="middle" /></td><td>
+<a href="https://www.myleodsc.com/" target="_blank"><img src="https://nestjs.com/img/myleo-logo.png" width="180" valign="middle" /></td><td>
 <a href="https://careers.meetdandy.com/?gh_src=063ba61e3us" target="_blank"><img src="https://nestjs.com/img/dandy-roles-logo.svg" width="150" valign="middle" /></td><td>
 <a href="https://www.castlecraft.in" target="_blank"><img src="https://nestjs.com/img/castlecraft-logo.png" width="150" valign="middle" /></td>
-<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td></tr></table>
+<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td>
+<td><a href="https://n.inc" target="_blank"><img src="https://nestjs.com/img/n-inc-logo.svg" width="120" valign="middle" /></td></tr><tr>
+<td><a href="https://bilberrry.com/" target="_blank"><img src="https://nestjs.com/img/bilberrry-logo.svg" width="180" valign="middle" /></td>
+<td><a href="https://ipinfo.ai/" target="_blank"><img src="https://nestjs.com/img/ipinfo-logo.png" width="130" valign="middle" /></td>
+<td><a href="https://chax.at" target="_blank"><img src="https://nestjs.com/img/chaxat-logo.png" width="100" valign="middle" /></td></tr>
+</table>
 
 #### Sponsors
 
@@ -91,7 +103,7 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <a href="https://www.swingdev.io" target="_blank"><img src="https://nestjs.com/img/swingdev-logo.svg#1" width="110" valign="middle" /> </a></td><td align="center" valign="middle">
 <a href="https://www.novologic.com/" target="_blank"><img src="https://nestjs.com/img/novologic.png" width="110" valign="middle" /></a> </td><td align="center" valign="middle">
 <a href="https://ever.co/" target="_blank"><img src="https://nestjs.com/img/ever-logo.png" width="72" valign="middle" /></a>  </td><td align="center" valign="middle">
-<a href="https://blokt.com" target="_blank"><img src="https://nestjs.com/img/blokt-logo.png" width="120" valign="middle" /></a>  </td><td align="center" valign="middle"> 
+<a href="https://blokt.com" target="_blank"><img src="https://nestjs.com/img/blokt-logo.png" width="120" valign="middle" /></a>  </td><td align="center" valign="middle">
   <a href="http://architectnow.net/" target="_blank"><img src="https://nestjs.com/img/architectnow.png" width="125" valign="middle" /></a> </td><td align="center" valign="middle">
   <a href="https://quander.io/" target="_blank"><img src="https://nestjs.com/img/quander.png" width="100" valign="middle" /></a> </td></tr><tr><td align="center" valign="middle">
   <a href="https://mantro.net/" target="_blank"><img src="https://nestjs.com/img/mantro-logo.svg" width="95" valign="middle" /></a> </td><td align="center" valign="middle">
@@ -117,6 +129,14 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/naologic-logo.svg" width="125" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://messaged.com/" target="_blank"><img src="https://nestjs.com/img/messaged-logo.png" width="50" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/triplecore-logo.svg" width="50" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://klqc.de" target="_blank"><img src="https://nestjs.com/img/klcqcl-logo.png" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://thecasinowizard.com/bonuses/no-deposit-bonuses/" target="_blank"><img src="https://nestjs.com/img/casinowizard-logo.png" width="120" valign="middle" /></a></td></tr><tr>
+     <td align="center" valign="middle"><a href="https://polygon-software.ch/" target="_blank"><img src="https://nestjs.com/img/polygon-logo.svg" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://mobilereality.pl/" target="_blank"><img src="https://nestjs.com/img/mobile-reality-logo.png" width="45" valign="middle" /></a></td>
+     <td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/boringowl-logo.svg" width="120" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://www.mobilefactory.jp/" target="_blank"><img src="https://nestjs.com/img/mobilefactory-logo.png" width="100" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://nordbot.app/" target="_blank"><img src="https://nestjs.com/img/nordbot-logo.png" width="120" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://doppio.sh/" target="_blank"><img src="https://nestjs.com/img/dopiosh-logo.png" width="50" valign="middle" /></a></td>
   </tr></table>
 
 ## Backers
diff --git a/packages/microservices/client/client-grpc.ts b/packages/microservices/client/client-grpc.ts
index 298a9e152..a03c1e78d 100644
--- a/packages/microservices/client/client-grpc.ts
+++ b/packages/microservices/client/client-grpc.ts
@@ -14,6 +14,9 @@ import { ChannelOptions } from '../external/grpc-options.interface';
 let grpcPackage: any = {};
 let grpcProtoLoaderPackage: any = {};
 
+/**
+ * @publicApi
+ */
 export class ClientGrpcProxy extends ClientProxy implements ClientGrpc {
   protected readonly logger = new Logger(ClientProxy.name);
   protected readonly clients = new Map<string, any>();
@@ -46,15 +49,14 @@ export class ClientGrpcProxy extends ClientProxy implements ClientGrpc {
     const grpcClient = this.createClientByServiceName(name);
     const clientRef = this.getClient(name);
     if (!clientRef) {
-      throw new InvalidGrpcServiceException();
+      throw new InvalidGrpcServiceException(name);
     }
 
     const protoMethods = Object.keys(clientRef[name].prototype);
     const grpcService = {} as T;
 
     protoMethods.forEach(m => {
-      const key = m[0].toLowerCase() + m.slice(1, m.length);
-      grpcService[key] = this.createServiceMethod(grpcClient, m);
+      grpcService[m] = this.createServiceMethod(grpcClient, m);
     });
     return grpcService;
   }
@@ -66,7 +68,7 @@ export class ClientGrpcProxy extends ClientProxy implements ClientGrpc {
   public createClientByServiceName(name: string) {
     const clientRef = this.getClient(name);
     if (!clientRef) {
-      throw new InvalidGrpcServiceException();
+      throw new InvalidGrpcServiceException(name);
     }
 
     const channelOptions: ChannelOptions =
@@ -175,7 +177,7 @@ export class ClientGrpcProxy extends ClientProxy implements ClientGrpc {
               return;
             }
           }
-          observer.error(error);
+          observer.error(this.serializeError(error));
         });
         call.on('end', () => {
           if (upstreamSubscription) {
@@ -217,7 +219,7 @@ export class ClientGrpcProxy extends ClientProxy implements ClientGrpc {
           const callArgs = [
             (error: unknown, data: unknown) => {
               if (error) {
-                return observer.error(error);
+                return observer.error(this.serializeError(error));
               }
               observer.next(data);
               observer.complete();
@@ -242,13 +244,19 @@ export class ClientGrpcProxy extends ClientProxy implements ClientGrpc {
         });
       }
       return new Observable(observer => {
-        client[methodName](...args, (error: any, data: any) => {
+        const call = client[methodName](...args, (error: any, data: any) => {
           if (error) {
-            return observer.error(error);
+            return observer.error(this.serializeError(error));
           }
           observer.next(data);
           observer.complete();
         });
+
+        return () => {
+          if (!call.finished) {
+            call.cancel();
+          }
+        };
       });
     };
   }
@@ -265,7 +273,9 @@ export class ClientGrpcProxy extends ClientProxy implements ClientGrpc {
       const grpcPkg = this.lookupPackage(grpcContext, packageName);
 
       if (!grpcPkg) {
-        const invalidPackageError = new InvalidGrpcPackageException();
+        const invalidPackageError = new InvalidGrpcPackageException(
+          packageName,
+        );
         this.logger.error(
           invalidPackageError.message,
           invalidPackageError.stack,
@@ -290,7 +300,7 @@ export class ClientGrpcProxy extends ClientProxy implements ClientGrpc {
         grpcPackage.loadPackageDefinition(packageDefinition);
       return packageObject;
     } catch (err) {
-      const invalidProtoError = new InvalidProtoDefinitionException();
+      const invalidProtoError = new InvalidProtoDefinitionException(err.path);
       const message =
         err && err.message ? err.message : invalidProtoError.message;
 
diff --git a/packages/microservices/client/client-kafka.ts b/packages/microservices/client/client-kafka.ts
index 1900336e4..618993d6f 100644
--- a/packages/microservices/client/client-kafka.ts
+++ b/packages/microservices/client/client-kafka.ts
@@ -19,6 +19,7 @@ import {
   KafkaConfig,
   KafkaMessage,
   Producer,
+  TopicPartitionOffsetAndMetadata,
 } from '../external/kafka.interface';
 import {
   KafkaLogger,
@@ -39,28 +40,42 @@ import { ClientProxy } from './client-proxy';
 
 let kafkaPackage: any = {};
 
+/**
+ * @publicApi
+ */
 export class ClientKafka extends ClientProxy {
   protected logger = new Logger(ClientKafka.name);
-  protected client: Kafka = null;
-  protected consumer: Consumer = null;
-  protected producer: Producer = null;
-  protected parser: KafkaParser = null;
+  protected client: Kafka | null = null;
+  protected consumer: Consumer | null = null;
+  protected producer: Producer | null = null;
+  protected parser: KafkaParser | null = null;
+  protected initialized: Promise<void> | null = null;
   protected responsePatterns: string[] = [];
   protected consumerAssignments: { [key: string]: number } = {};
-
   protected brokers: string[] | BrokersFunction;
   protected clientId: string;
   protected groupId: string;
+  protected producerOnlyMode: boolean;
 
   constructor(protected readonly options: KafkaOptions['options']) {
     super();
 
-    const clientOptions =
-      this.getOptionsProp(this.options, 'client') || ({} as KafkaConfig);
-    const consumerOptions =
-      this.getOptionsProp(this.options, 'consumer') || ({} as ConsumerConfig);
-    const postfixId =
-      this.getOptionsProp(this.options, 'postfixId') || '-client';
+    const clientOptions = this.getOptionsProp(
+      this.options,
+      'client',
+      {} as KafkaConfig,
+    );
+    const consumerOptions = this.getOptionsProp(
+      this.options,
+      'consumer',
+      {} as ConsumerConfig,
+    );
+    const postfixId = this.getOptionsProp(this.options, 'postfixId', '-client');
+    this.producerOnlyMode = this.getOptionsProp(
+      this.options,
+      'producerOnlyMode',
+      false,
+    );
 
     this.brokers = clientOptions.brokers || [KAFKA_DEFAULT_BROKER];
 
@@ -90,45 +105,63 @@ export class ClientKafka extends ClientProxy {
     this.consumer && (await this.consumer.disconnect());
     this.producer = null;
     this.consumer = null;
+    this.initialized = null;
     this.client = null;
   }
 
   public async connect(): Promise<Producer> {
-    if (this.client) {
-      return this.producer;
+    if (this.initialized) {
+      return this.initialized.then(() => this.producer);
     }
-    this.client = this.createClient();
-
-    const partitionAssigners = [
-      (config: ConstructorParameters<typeof KafkaReplyPartitionAssigner>[1]) =>
-        new KafkaReplyPartitionAssigner(this, config),
-    ] as any[];
-
-    const consumerOptions = Object.assign(
-      {
-        partitionAssigners,
-      },
-      this.options.consumer || {},
-      {
-        groupId: this.groupId,
-      },
-    );
-    this.producer = this.client.producer(this.options.producer || {});
-    this.consumer = this.client.consumer(consumerOptions);
-
-    // set member assignments on join and rebalance
-    this.consumer.on(
-      this.consumer.events.GROUP_JOIN,
-      this.setConsumerAssignments.bind(this),
-    );
-
-    await this.producer.connect();
-    await this.consumer.connect();
-    await this.bindTopics();
-    return this.producer;
+    this.initialized = new Promise(async (resolve, reject) => {
+      try {
+        this.client = this.createClient();
+
+        if (!this.producerOnlyMode) {
+          const partitionAssigners = [
+            (
+              config: ConstructorParameters<
+                typeof KafkaReplyPartitionAssigner
+              >[1],
+            ) => new KafkaReplyPartitionAssigner(this, config),
+          ];
+
+          const consumerOptions = Object.assign(
+            {
+              partitionAssigners,
+            },
+            this.options.consumer || {},
+            {
+              groupId: this.groupId,
+            },
+          );
+
+          this.consumer = this.client.consumer(consumerOptions);
+          // set member assignments on join and rebalance
+          this.consumer.on(
+            this.consumer.events.GROUP_JOIN,
+            this.setConsumerAssignments.bind(this),
+          );
+          await this.consumer.connect();
+          await this.bindTopics();
+        }
+
+        this.producer = this.client.producer(this.options.producer || {});
+        await this.producer.connect();
+
+        resolve();
+      } catch (err) {
+        reject(err);
+      }
+    });
+    return this.initialized.then(() => this.producer);
   }
 
   public async bindTopics(): Promise<void> {
+    if (!this.consumer) {
+      throw Error('No consumer initialized');
+    }
+
     const consumerSubscribeOptions = this.options.subscribe || {};
     const subscribeTo = async (responsePattern: string) =>
       this.consumer.subscribe({
@@ -189,9 +222,11 @@ export class ClientKafka extends ClientProxy {
     return this.consumerAssignments;
   }
 
-  protected dispatchEvent(packet: OutgoingEvent): Promise<any> {
+  protected async dispatchEvent(packet: OutgoingEvent): Promise<any> {
     const pattern = this.normalizePattern(packet.pattern);
-    const outgoingEvent = this.serializer.serialize(packet.data);
+    const outgoingEvent = await this.serializer.serialize(packet.data, {
+      pattern,
+    });
     const message = Object.assign(
       {
         topic: pattern,
@@ -199,6 +234,7 @@ export class ClientKafka extends ClientProxy {
       },
       this.options.send || {},
     );
+
     return this.producer.send(message);
   }
 
@@ -216,33 +252,42 @@ export class ClientKafka extends ClientProxy {
     partialPacket: ReadPacket,
     callback: (packet: WritePacket) => any,
   ): () => void {
+    const packet = this.assignPacketId(partialPacket);
+    this.routingMap.set(packet.id, callback);
+
+    const cleanup = () => this.routingMap.delete(packet.id);
+    const errorCallback = (err: unknown) => {
+      cleanup();
+      callback({ err });
+    };
+
     try {
-      const packet = this.assignPacketId(partialPacket);
       const pattern = this.normalizePattern(partialPacket.pattern);
       const replyTopic = this.getResponsePatternName(pattern);
       const replyPartition = this.getReplyTopicPartition(replyTopic);
 
-      const serializedPacket: KafkaRequest = this.serializer.serialize(
-        packet.data,
-      );
-      serializedPacket.headers[KafkaHeaders.CORRELATION_ID] = packet.id;
-      serializedPacket.headers[KafkaHeaders.REPLY_TOPIC] = replyTopic;
-      serializedPacket.headers[KafkaHeaders.REPLY_PARTITION] = replyPartition;
-
-      this.routingMap.set(packet.id, callback);
-
-      const message = Object.assign(
-        {
-          topic: pattern,
-          messages: [serializedPacket],
-        },
-        this.options.send || {},
-      );
-      this.producer.send(message).catch(err => callback({ err }));
-
-      return () => this.routingMap.delete(packet.id);
+      Promise.resolve(this.serializer.serialize(packet.data, { pattern }))
+        .then((serializedPacket: KafkaRequest) => {
+          serializedPacket.headers[KafkaHeaders.CORRELATION_ID] = packet.id;
+          serializedPacket.headers[KafkaHeaders.REPLY_TOPIC] = replyTopic;
+          serializedPacket.headers[KafkaHeaders.REPLY_PARTITION] =
+            replyPartition;
+
+          const message = Object.assign(
+            {
+              topic: pattern,
+              messages: [serializedPacket],
+            },
+            this.options.send || {},
+          );
+
+          return this.producer.send(message);
+        })
+        .catch(err => errorCallback(err));
+
+      return cleanup;
     } catch (err) {
-      callback({ err });
+      errorCallback(err);
     }
   }
 
@@ -274,4 +319,14 @@ export class ClientKafka extends ClientProxy {
     this.deserializer =
       (options && options.deserializer) || new KafkaResponseDeserializer();
   }
+
+  public commitOffsets(
+    topicPartitions: TopicPartitionOffsetAndMetadata[],
+  ): Promise<void> {
+    if (this.consumer) {
+      return this.consumer.commitOffsets(topicPartitions);
+    } else {
+      throw new Error('No consumer initialized');
+    }
+  }
 }
diff --git a/packages/microservices/client/client-mqtt.ts b/packages/microservices/client/client-mqtt.ts
index 8797b56f8..c2e7c6cf3 100644
--- a/packages/microservices/client/client-mqtt.ts
+++ b/packages/microservices/client/client-mqtt.ts
@@ -20,6 +20,9 @@ import { ClientProxy } from './client-proxy';
 
 let mqttPackage: any = {};
 
+/**
+ * @publicApi
+ */
 export class ClientMqtt extends ClientProxy {
   protected readonly logger = new Logger(ClientProxy.name);
   protected readonly subscriptionsCount = new Map<string, number>();
@@ -174,11 +177,14 @@ export class ClientMqtt extends ClientProxy {
     const serializedPacket: ReadPacket & Partial<MqttRecord> =
       this.serializer.serialize(packet);
 
+    const options = serializedPacket.options;
+    delete serializedPacket.options;
+
     return new Promise<void>((resolve, reject) =>
       this.mqttClient.publish(
         pattern,
         JSON.stringify(serializedPacket),
-        this.mergePacketOptions(serializedPacket.options),
+        this.mergePacketOptions(options),
         (err: any) => (err ? reject(err) : resolve()),
       ),
     );
diff --git a/packages/microservices/client/client-nats.ts b/packages/microservices/client/client-nats.ts
index c124b6c18..bf541cbbd 100644
--- a/packages/microservices/client/client-nats.ts
+++ b/packages/microservices/client/client-nats.ts
@@ -1,5 +1,6 @@
 import { Logger } from '@nestjs/common/services/logger.service';
 import { loadPackage } from '@nestjs/common/utils/load-package.util';
+import { isObject } from '@nestjs/common/utils/shared.utils';
 import { NATS_DEFAULT_URL } from '../constants';
 import { NatsResponseJSONDeserializer } from '../deserializers/nats-response-json.deserializer';
 import { EmptyResponseException } from '../errors/empty-response.exception';
@@ -11,6 +12,9 @@ import { ClientProxy } from './client-proxy';
 
 let natsPackage = {} as any;
 
+/**
+ * @publicApi
+ */
 export class ClientNats extends ClientProxy {
   protected readonly logger = new Logger(ClientNats.name);
   protected natsClient: Client;
@@ -48,20 +52,31 @@ export class ClientNats extends ClientProxy {
   public async handleStatusUpdates(client: Client) {
     for await (const status of client.status()) {
       const data =
-        status.data && typeof status.data === 'object'
+        status.data && isObject(status.data)
           ? JSON.stringify(status.data)
           : status.data;
-      if (status.type === 'disconnect' || status.type === 'error') {
-        this.logger.error(
-          `NatsError: type: "${status.type}", data: "${data}".`,
-        );
-      } else {
-        const message = `NatsStatus: type: "${status.type}", data: "${data}".`;
-        if (status.type === 'pingTimer') {
-          this.logger.debug(message);
-        } else {
-          this.logger.log(message);
-        }
+
+      switch (status.type) {
+        case 'error':
+        case 'disconnect':
+          this.logger.error(
+            `NatsError: type: "${status.type}", data: "${data}".`,
+          );
+          break;
+
+        case 'pingTimer':
+          if (this.options.debug) {
+            this.logger.debug(
+              `NatsStatus: type: "${status.type}", data: "${data}".`,
+            );
+          }
+          break;
+
+        default:
+          this.logger.log(
+            `NatsStatus: type: "${status.type}", data: "${data}".`,
+          );
+          break;
       }
     }
   }
diff --git a/packages/microservices/client/client-proxy-factory.ts b/packages/microservices/client/client-proxy-factory.ts
index f6bd89227..a19200990 100644
--- a/packages/microservices/client/client-proxy-factory.ts
+++ b/packages/microservices/client/client-proxy-factory.ts
@@ -26,6 +26,9 @@ export interface IClientProxyFactory {
   create(clientOptions: ClientOptions): ClientProxy & Closeable;
 }
 
+/**
+ * @publicApi
+ */
 export class ClientProxyFactory {
   public static create(
     clientOptions: { transport: Transport.GRPC } & ClientOptions,
diff --git a/packages/microservices/client/client-proxy.ts b/packages/microservices/client/client-proxy.ts
index bdd3484d7..3950cf3db 100644
--- a/packages/microservices/client/client-proxy.ts
+++ b/packages/microservices/client/client-proxy.ts
@@ -130,7 +130,7 @@ export abstract class ClientProxy {
     T extends ClientOptions['options'],
     K extends keyof T,
   >(obj: T, prop: K, defaultValue: T[K] = undefined) {
-    return (obj && obj[prop]) || defaultValue;
+    return obj && prop in obj ? obj[prop] : defaultValue;
   }
 
   protected normalizePattern(pattern: MsPattern): string {
diff --git a/packages/microservices/client/client-redis.ts b/packages/microservices/client/client-redis.ts
index 8b42ce6a0..9148a450f 100644
--- a/packages/microservices/client/client-redis.ts
+++ b/packages/microservices/client/client-redis.ts
@@ -1,48 +1,34 @@
 import { Logger } from '@nestjs/common/services/logger.service';
 import { loadPackage } from '@nestjs/common/utils/load-package.util';
 import {
-  EmptyError,
-  fromEvent,
-  lastValueFrom,
-  merge,
-  Subject,
-  zip,
-} from 'rxjs';
-import { share, take, tap } from 'rxjs/operators';
-import {
-  CONNECT_EVENT,
-  ECONNREFUSED,
   ERROR_EVENT,
   MESSAGE_EVENT,
-  REDIS_DEFAULT_URL,
+  REDIS_DEFAULT_HOST,
+  REDIS_DEFAULT_PORT,
 } from '../constants';
-import {
-  ClientOpts,
-  RedisClient,
-  RetryStrategyOptions,
-} from '../external/redis.interface';
 import { ReadPacket, RedisOptions, WritePacket } from '../interfaces';
 import { ClientProxy } from './client-proxy';
 
-let redisPackage: any = {};
+type Redis = any;
+
+let redisPackage = {} as any;
 
+/**
+ * @publicApi
+ */
 export class ClientRedis extends ClientProxy {
   protected readonly logger = new Logger(ClientProxy.name);
   protected readonly subscriptionsCount = new Map<string, number>();
-  protected readonly url: string;
-  protected pubClient: RedisClient;
-  protected subClient: RedisClient;
+  protected pubClient: Redis;
+  protected subClient: Redis;
   protected connection: Promise<any>;
   protected isExplicitlyTerminated = false;
 
   constructor(protected readonly options: RedisOptions['options']) {
     super();
-    this.url =
-      this.getOptionsProp(options, 'url') ||
-      (!this.getOptionsProp(options, 'host') && REDIS_DEFAULT_URL);
 
-    redisPackage = loadPackage('redis', ClientRedis.name, () =>
-      require('redis'),
+    redisPackage = loadPackage('ioredis', ClientRedis.name, () =>
+      require('ioredis'),
     );
 
     this.initializeSerializer(options);
@@ -64,73 +50,57 @@ export class ClientRedis extends ClientProxy {
     this.isExplicitlyTerminated = true;
   }
 
-  public connect(): Promise<any> {
+  public async connect(): Promise<any> {
     if (this.pubClient && this.subClient) {
       return this.connection;
     }
-    const error$ = new Subject<Error>();
-
-    this.pubClient = this.createClient(error$);
-    this.subClient = this.createClient(error$);
+    this.pubClient = this.createClient();
+    this.subClient = this.createClient();
     this.handleError(this.pubClient);
     this.handleError(this.subClient);
 
-    const pubConnect$ = fromEvent(this.pubClient, CONNECT_EVENT);
-    const subClient$ = fromEvent(this.subClient, CONNECT_EVENT);
+    this.connection = Promise.all([
+      this.subClient.connect(),
+      this.pubClient.connect(),
+    ]);
+    await this.connection;
 
-    this.connection = lastValueFrom(
-      merge(error$, zip(pubConnect$, subClient$)).pipe(
-        take(1),
-        tap(() =>
-          this.subClient.on(MESSAGE_EVENT, this.createResponseCallback()),
-        ),
-        share(),
-      ),
-    ).catch(err => {
-      if (err instanceof EmptyError) {
-        return;
-      }
-      throw err;
-    });
+    this.subClient.on(MESSAGE_EVENT, this.createResponseCallback());
     return this.connection;
   }
 
-  public createClient(error$: Subject<Error>): RedisClient {
-    return redisPackage.createClient({
-      ...this.getClientOptions(error$),
-      url: this.url,
+  public createClient(): Redis {
+    return new redisPackage({
+      host: REDIS_DEFAULT_HOST,
+      port: REDIS_DEFAULT_PORT,
+      ...this.getClientOptions(),
+      lazyConnect: true,
     });
   }
 
-  public handleError(client: RedisClient) {
+  public handleError(client: Redis) {
     client.addListener(ERROR_EVENT, (err: any) => this.logger.error(err));
   }
 
-  public getClientOptions(error$: Subject<Error>): Partial<ClientOpts> {
-    const retry_strategy = (options: RetryStrategyOptions) =>
-      this.createRetryStrategy(options, error$);
+  public getClientOptions(): Partial<RedisOptions['options']> {
+    const retryStrategy = (times: number) => this.createRetryStrategy(times);
 
     return {
       ...(this.options || {}),
-      retry_strategy,
+      retryStrategy,
     };
   }
 
-  public createRetryStrategy(
-    options: RetryStrategyOptions,
-    error$: Subject<Error>,
-  ): undefined | number | Error {
-    if (options.error && (options.error as any).code === ECONNREFUSED) {
-      error$.error(options.error);
-    }
+  public createRetryStrategy(times: number): undefined | number {
     if (this.isExplicitlyTerminated) {
       return undefined;
     }
     if (
       !this.getOptionsProp(this.options, 'retryAttempts') ||
-      options.attempt > this.getOptionsProp(this.options, 'retryAttempts')
+      times > this.getOptionsProp(this.options, 'retryAttempts')
     ) {
-      return new Error('Retry time exhausted');
+      this.logger.error('Retry time exhausted');
+      return;
     }
     return this.getOptionsProp(this.options, 'retryDelay') || 0;
   }
diff --git a/packages/microservices/client/client-rmq.ts b/packages/microservices/client/client-rmq.ts
index 04498e18f..f68ef3bec 100644
--- a/packages/microservices/client/client-rmq.ts
+++ b/packages/microservices/client/client-rmq.ts
@@ -1,15 +1,26 @@
 import { Logger } from '@nestjs/common/services/logger.service';
 import { loadPackage } from '@nestjs/common/utils/load-package.util';
 import { randomStringGenerator } from '@nestjs/common/utils/random-string-generator.util';
+import { isFunction } from '@nestjs/common/utils/shared.utils';
 import { EventEmitter } from 'events';
-import { EmptyError, fromEvent, lastValueFrom, merge, Observable } from 'rxjs';
-import { first, map, share, switchMap } from 'rxjs/operators';
 import {
+  EmptyError,
+  firstValueFrom,
+  fromEvent,
+  merge,
+  Observable,
+  ReplaySubject,
+} from 'rxjs';
+import { first, map, retryWhen, scan, skip, switchMap } from 'rxjs/operators';
+import {
+  CONNECT_EVENT,
+  CONNECT_FAILED_EVENT,
   DISCONNECTED_RMQ_MESSAGE,
   DISCONNECT_EVENT,
   ERROR_EVENT,
   RQM_DEFAULT_IS_GLOBAL_PREFETCH_COUNT,
   RQM_DEFAULT_NOACK,
+  RQM_DEFAULT_NO_ASSERT,
   RQM_DEFAULT_PERSISTENT,
   RQM_DEFAULT_PREFETCH_COUNT,
   RQM_DEFAULT_QUEUE,
@@ -22,21 +33,37 @@ import { RmqRecord } from '../record-builders';
 import { RmqRecordSerializer } from '../serializers/rmq-record.serializer';
 import { ClientProxy } from './client-proxy';
 
+// import type {
+//   AmqpConnectionManager,
+//   ChannelWrapper,
+// } from 'amqp-connection-manager';
+// import type { Channel, ConsumeMessage } from 'amqplib';
+
+type Channel = any;
+type ChannelWrapper = any;
+type ConsumeMessage = any;
+type AmqpConnectionManager = any;
+
 let rqmPackage: any = {};
 
 const REPLY_QUEUE = 'amq.rabbitmq.reply-to';
 
+/**
+ * @publicApi
+ */
 export class ClientRMQ extends ClientProxy {
   protected readonly logger = new Logger(ClientProxy.name);
+  protected connection$: ReplaySubject<any>;
   protected connection: Promise<any>;
-  protected client: any = null;
-  protected channel: any = null;
+  protected client: AmqpConnectionManager = null;
+  protected channel: ChannelWrapper = null;
   protected urls: string[] | RmqUrl[];
   protected queue: string;
-  protected queueOptions: any;
+  protected queueOptions: Record<string, any>;
   protected responseEmitter: EventEmitter;
   protected replyQueue: string;
   protected persistent: boolean;
+  protected noAssert: boolean;
 
   constructor(protected readonly options: RmqOptions['options']) {
     super();
@@ -50,6 +77,9 @@ export class ClientRMQ extends ClientProxy {
       this.getOptionsProp(this.options, 'replyQueue') || REPLY_QUEUE;
     this.persistent =
       this.getOptionsProp(this.options, 'persistent') || RQM_DEFAULT_PERSISTENT;
+    this.noAssert =
+      this.getOptionsProp(this.options, 'noAssert') || RQM_DEFAULT_NO_ASSERT;
+
     loadPackage('amqplib', ClientRMQ.name, () => require('amqplib'));
     rqmPackage = loadPackage('amqp-connection-manager', ClientRMQ.name, () =>
       require('amqp-connection-manager'),
@@ -68,57 +98,88 @@ export class ClientRMQ extends ClientProxy {
 
   public connect(): Promise<any> {
     if (this.client) {
-      return this.connection;
+      return this.convertConnectionToPromise();
     }
     this.client = this.createClient();
     this.handleError(this.client);
     this.handleDisconnectError(this.client);
 
+    this.responseEmitter = new EventEmitter();
+    this.responseEmitter.setMaxListeners(0);
+
     const connect$ = this.connect$(this.client);
-    this.connection = lastValueFrom(
-      this.mergeDisconnectEvent(this.client, connect$).pipe(
-        switchMap(() => this.createChannel()),
-        share(),
-      ),
-    ).catch(err => {
-      if (err instanceof EmptyError) {
-        return;
-      }
-      throw err;
-    });
+    const withDisconnect$ = this.mergeDisconnectEvent(
+      this.client,
+      connect$,
+    ).pipe(switchMap(() => this.createChannel()));
 
-    return this.connection;
+    const withReconnect$ = fromEvent(this.client, CONNECT_EVENT).pipe(skip(1));
+    const source$ = merge(withDisconnect$, withReconnect$);
+
+    this.connection$ = new ReplaySubject(1);
+    source$.subscribe(this.connection$);
+
+    return this.convertConnectionToPromise();
   }
 
   public createChannel(): Promise<void> {
     return new Promise(resolve => {
       this.channel = this.client.createChannel({
         json: false,
-        setup: (channel: any) => this.setupChannel(channel, resolve),
+        setup: (channel: Channel) => this.setupChannel(channel, resolve),
       });
     });
   }
 
-  public createClient<T = any>(): T {
+  public createClient(): AmqpConnectionManager {
     const socketOptions = this.getOptionsProp(this.options, 'socketOptions');
     return rqmPackage.connect(this.urls, {
       connectionOptions: socketOptions,
-    }) as T;
+    });
   }
 
   public mergeDisconnectEvent<T = any>(
     instance: any,
     source$: Observable<T>,
   ): Observable<T> {
-    const close$ = fromEvent(instance, DISCONNECT_EVENT).pipe(
-      map((err: any) => {
-        throw err;
-      }),
+    const eventToError = (eventType: string) =>
+      fromEvent(instance, eventType).pipe(
+        map((err: unknown) => {
+          throw err;
+        }),
+      );
+    const disconnect$ = eventToError(DISCONNECT_EVENT);
+
+    const urls = this.getOptionsProp(this.options, 'urls', []);
+    const connectFailed$ = eventToError(CONNECT_FAILED_EVENT).pipe(
+      retryWhen(e =>
+        e.pipe(
+          scan((errorCount, error: any) => {
+            if (urls.indexOf(error.url) >= urls.length - 1) {
+              throw error;
+            }
+            return errorCount + 1;
+          }, 0),
+        ),
+      ),
     );
-    return merge(source$, close$).pipe(first());
+    // If we ever decide to propagate all disconnect errors & re-emit them through
+    // the "connection" stream then comment out "first()" operator.
+    return merge(source$, disconnect$, connectFailed$).pipe(first());
+  }
+
+  public async convertConnectionToPromise() {
+    try {
+      return await firstValueFrom(this.connection$);
+    } catch (err) {
+      if (err instanceof EmptyError) {
+        return;
+      }
+      throw err;
+    }
   }
 
-  public async setupChannel(channel: any, resolve: Function) {
+  public async setupChannel(channel: Channel, resolve: Function) {
     const prefetchCount =
       this.getOptionsProp(this.options, 'prefetchCount') ||
       RQM_DEFAULT_PREFETCH_COUNT;
@@ -126,20 +187,19 @@ export class ClientRMQ extends ClientProxy {
       this.getOptionsProp(this.options, 'isGlobalPrefetchCount') ||
       RQM_DEFAULT_IS_GLOBAL_PREFETCH_COUNT;
 
-    await channel.assertQueue(this.queue, this.queueOptions);
+    if (!this.queueOptions.noAssert) {
+      await channel.assertQueue(this.queue, this.queueOptions);
+    }
     await channel.prefetch(prefetchCount, isGlobalPrefetchCount);
-
-    this.responseEmitter = new EventEmitter();
-    this.responseEmitter.setMaxListeners(0);
     await this.consumeChannel(channel);
     resolve();
   }
 
-  public async consumeChannel(channel: any) {
+  public async consumeChannel(channel: Channel) {
     const noAck = this.getOptionsProp(this.options, 'noAck', RQM_DEFAULT_NOACK);
     await channel.consume(
       this.replyQueue,
-      (msg: any) =>
+      (msg: ConsumeMessage) =>
         this.responseEmitter.emit(msg.properties.correlationId, msg),
       {
         noAck,
@@ -147,25 +207,39 @@ export class ClientRMQ extends ClientProxy {
     );
   }
 
-  public handleError(client: any): void {
+  public handleError(client: AmqpConnectionManager): void {
     client.addListener(ERROR_EVENT, (err: any) => this.logger.error(err));
   }
 
-  public handleDisconnectError(client: any): void {
+  public handleDisconnectError(client: AmqpConnectionManager): void {
     client.addListener(DISCONNECT_EVENT, (err: any) => {
       this.logger.error(DISCONNECTED_RMQ_MESSAGE);
       this.logger.error(err);
-
-      this.close();
     });
   }
 
   public async handleMessage(
     packet: unknown,
     callback: (packet: WritePacket) => any,
+  );
+  public async handleMessage(
+    packet: unknown,
+    options: Record<string, unknown>,
+    callback: (packet: WritePacket) => any,
+  );
+  public async handleMessage(
+    packet: unknown,
+    options: Record<string, unknown> | ((packet: WritePacket) => any),
+    callback?: (packet: WritePacket) => any,
   ) {
+    if (isFunction(options)) {
+      callback = options as (packet: WritePacket) => any;
+      options = undefined;
+    }
+
     const { err, response, isDisposed } = await this.deserializer.deserialize(
       packet,
+      options,
     );
     if (isDisposed || err) {
       callback({
@@ -186,8 +260,14 @@ export class ClientRMQ extends ClientProxy {
   ): () => void {
     try {
       const correlationId = randomStringGenerator();
-      const listener = ({ content }: { content: any }) =>
-        this.handleMessage(JSON.parse(content.toString()), callback);
+      const listener = ({
+        content,
+        options,
+      }: {
+        content: Buffer;
+        options: Record<string, unknown>;
+      }) =>
+        this.handleMessage(JSON.parse(content.toString()), options, callback);
 
       Object.assign(message, { id: correlationId });
       const serializedPacket: ReadPacket & Partial<RmqRecord> =
@@ -197,17 +277,19 @@ export class ClientRMQ extends ClientProxy {
       delete serializedPacket.options;
 
       this.responseEmitter.on(correlationId, listener);
-      this.channel.sendToQueue(
-        this.queue,
-        Buffer.from(JSON.stringify(serializedPacket)),
-        {
-          replyTo: this.replyQueue,
-          persistent: this.persistent,
-          ...options,
-          headers: this.mergeHeaders(options?.headers),
-          correlationId,
-        },
-      );
+      this.channel
+        .sendToQueue(
+          this.queue,
+          Buffer.from(JSON.stringify(serializedPacket)),
+          {
+            replyTo: this.replyQueue,
+            persistent: this.persistent,
+            ...options,
+            headers: this.mergeHeaders(options?.headers),
+            correlationId,
+          },
+        )
+        .catch(err => callback({ err }));
       return () => this.responseEmitter.removeListener(correlationId, listener);
     } catch (err) {
       callback({ err });
@@ -218,14 +300,17 @@ export class ClientRMQ extends ClientProxy {
     const serializedPacket: ReadPacket & Partial<RmqRecord> =
       this.serializer.serialize(packet);
 
+    const options = serializedPacket.options;
+    delete serializedPacket.options;
+
     return new Promise<void>((resolve, reject) =>
       this.channel.sendToQueue(
         this.queue,
         Buffer.from(JSON.stringify(serializedPacket)),
         {
           persistent: this.persistent,
-          ...serializedPacket.options,
-          headers: this.mergeHeaders(serializedPacket.options?.headers),
+          ...options,
+          headers: this.mergeHeaders(options?.headers),
         },
         (err: unknown) => (err ? reject(err) : resolve()),
       ),
diff --git a/packages/microservices/client/client-tcp.ts b/packages/microservices/client/client-tcp.ts
index f16c6407c..e0b1ddb91 100644
--- a/packages/microservices/client/client-tcp.ts
+++ b/packages/microservices/client/client-tcp.ts
@@ -1,7 +1,8 @@
-import { Logger } from '@nestjs/common';
+import { Logger, Type } from '@nestjs/common';
 import * as net from 'net';
 import { EmptyError, lastValueFrom } from 'rxjs';
 import { share, tap } from 'rxjs/operators';
+import { ConnectionOptions } from 'tls';
 import {
   CLOSE_EVENT,
   ECONNREFUSED,
@@ -10,30 +11,39 @@ import {
   TCP_DEFAULT_HOST,
   TCP_DEFAULT_PORT,
 } from '../constants';
-import { JsonSocket } from '../helpers/json-socket';
+import { JsonSocket, TcpSocket } from '../helpers';
+import { connect as tlsConnect, TLSSocket } from 'tls';
 import { PacketId, ReadPacket, WritePacket } from '../interfaces';
 import { TcpClientOptions } from '../interfaces/client-metadata.interface';
 import { ClientProxy } from './client-proxy';
 
+/**
+ * @publicApi
+ */
 export class ClientTCP extends ClientProxy {
   protected connection: Promise<any>;
   private readonly logger = new Logger(ClientTCP.name);
   private readonly port: number;
   private readonly host: string;
+  private readonly socketClass: Type<TcpSocket>;
   private isConnected = false;
-  private socket: JsonSocket;
+  private socket: TcpSocket;
+  public tlsOptions?: ConnectionOptions;
 
   constructor(options: TcpClientOptions['options']) {
     super();
     this.port = this.getOptionsProp(options, 'port') || TCP_DEFAULT_PORT;
     this.host = this.getOptionsProp(options, 'host') || TCP_DEFAULT_HOST;
+    this.socketClass =
+      this.getOptionsProp(options, 'socketClass') || JsonSocket;
+    this.tlsOptions = this.getOptionsProp(options, 'tlsOptions');
 
     this.initializeSerializer(options);
     this.initializeDeserializer(options);
   }
 
   public connect(): Promise<any> {
-    if (this.isConnected && this.connection) {
+    if (this.connection) {
       return this.connection;
     }
     this.socket = this.createSocket();
@@ -49,7 +59,10 @@ export class ClientTCP extends ClientProxy {
       share(),
     );
 
-    this.socket.connect(this.port, this.host);
+    // For TLS connections, the connection is initiated when the socket is created
+    if (!this.tlsOptions) {
+      this.socket.connect(this.port, this.host);
+    }
     this.connection = lastValueFrom(source$).catch(err => {
       if (err instanceof EmptyError) {
         return;
@@ -80,8 +93,22 @@ export class ClientTCP extends ClientProxy {
     });
   }
 
-  public createSocket(): JsonSocket {
-    return new JsonSocket(new net.Socket());
+  public createSocket(): TcpSocket {
+    let socket: net.Socket | TLSSocket;
+    /**
+     * TLS enabled, "upgrade" the TCP Socket to TLS
+     */
+    if (this.tlsOptions) {
+      socket = tlsConnect({
+        ...this.tlsOptions,
+        port: this.port,
+        host: this.host,
+        socket,
+      });
+    } else {
+      socket = new net.Socket();
+    }
+    return new this.socketClass(socket);
   }
 
   public close() {
@@ -89,7 +116,7 @@ export class ClientTCP extends ClientProxy {
     this.handleClose();
   }
 
-  public bindEvents(socket: JsonSocket) {
+  public bindEvents(socket: TcpSocket) {
     socket.on(
       ERROR_EVENT,
       (err: any) => err.code !== ECONNREFUSED && this.handleError(err),
@@ -104,6 +131,15 @@ export class ClientTCP extends ClientProxy {
   public handleClose() {
     this.isConnected = false;
     this.socket = null;
+    this.connection = undefined;
+
+    if (this.routingMap.size > 0) {
+      const err = new Error('Connection closed');
+      for (const callback of this.routingMap.values()) {
+        callback({ err });
+      }
+      this.routingMap.clear();
+    }
   }
 
   protected publish(
diff --git a/packages/microservices/constants.ts b/packages/microservices/constants.ts
index 7999319b4..0d5868f5b 100644
--- a/packages/microservices/constants.ts
+++ b/packages/microservices/constants.ts
@@ -2,7 +2,10 @@ import { ROUTE_ARGS_METADATA } from '@nestjs/common/constants';
 
 export const TCP_DEFAULT_PORT = 3000;
 export const TCP_DEFAULT_HOST = 'localhost';
-export const REDIS_DEFAULT_URL = 'redis://localhost:6379';
+
+export const REDIS_DEFAULT_PORT = 6379;
+export const REDIS_DEFAULT_HOST = 'localhost';
+
 export const NATS_DEFAULT_URL = 'nats://localhost:4222';
 export const MQTT_DEFAULT_URL = 'mqtt://localhost:1883';
 export const GRPC_DEFAULT_URL = 'localhost:5000';
@@ -11,6 +14,7 @@ export const KAFKA_DEFAULT_BROKER = 'localhost:9092';
 
 export const CONNECT_EVENT = 'connect';
 export const DISCONNECT_EVENT = 'disconnect';
+export const CONNECT_FAILED_EVENT = 'connectFailed';
 export const MESSAGE_EVENT = 'message';
 export const DATA_EVENT = 'data';
 export const ERROR_EVENT = 'error';
@@ -19,6 +23,7 @@ export const SUBSCRIBE = 'subscribe';
 export const CANCEL_EVENT = 'cancelled';
 
 export const PATTERN_METADATA = 'microservices:pattern';
+export const PATTERN_EXTRAS_METADATA = 'microservices:pattern_extras';
 export const TRANSPORT_METADATA = 'microservices:transport';
 export const CLIENT_CONFIGURATION_METADATA = 'microservices:client';
 export const PATTERN_HANDLER_METADATA = 'microservices:handler_type';
@@ -34,10 +39,13 @@ export const RQM_DEFAULT_IS_GLOBAL_PREFETCH_COUNT = false;
 export const RQM_DEFAULT_QUEUE_OPTIONS = {};
 export const RQM_DEFAULT_NOACK = true;
 export const RQM_DEFAULT_PERSISTENT = false;
+export const RQM_DEFAULT_NO_ASSERT = false;
 export const GRPC_DEFAULT_PROTO_LOADER = '@grpc/proto-loader';
 
+export const NO_EVENT_HANDLER = (text: TemplateStringsArray, pattern: string) =>
+  `There is no matching event handler defined in the remote service. Event pattern: ${pattern}`;
 export const NO_MESSAGE_HANDLER = `There is no matching message handler defined in the remote service.`;
-export const NO_EVENT_HANDLER = `There is no matching event handler defined in the remote service.`;
+
 export const DISCONNECTED_RMQ_MESSAGE = `Disconnected from RMQ. Trying to reconnect.`;
 
 export const KAFKA_DEFAULT_CLIENT = 'nestjs-consumer';
@@ -50,3 +58,6 @@ export const MQTT_WILDCARD_ALL = '#';
 export const ECONNREFUSED = 'ECONNREFUSED';
 export const CONN_ERR = 'CONN_ERR';
 export const EADDRINUSE = 'EADDRINUSE';
+
+export const CONNECTION_FAILED_MESSAGE =
+  'Connection to transport failed. Trying to reconnect...';
diff --git a/packages/microservices/context/exception-filters-context.ts b/packages/microservices/context/exception-filters-context.ts
index 3f8ab49bd..14d42da91 100644
--- a/packages/microservices/context/exception-filters-context.ts
+++ b/packages/microservices/context/exception-filters-context.ts
@@ -6,10 +6,13 @@ import { BaseExceptionFilterContext } from '@nestjs/core/exceptions/base-excepti
 import { STATIC_CONTEXT } from '@nestjs/core/injector/constants';
 import { NestContainer } from '@nestjs/core/injector/container';
 import { InstanceWrapper } from '@nestjs/core/injector/instance-wrapper';
+import { iterate } from 'iterare';
 import { Observable } from 'rxjs';
 import { RpcExceptionsHandler } from '../exceptions/rpc-exceptions-handler';
-import { iterate } from 'iterare';
 
+/**
+ * @publicApi
+ */
 export class ExceptionFiltersContext extends BaseExceptionFilterContext {
   constructor(
     container: NestContainer,
@@ -53,7 +56,12 @@ export class ExceptionFiltersContext extends BaseExceptionFilterContext {
     const scopedFilterWrappers =
       this.config.getGlobalRequestFilters() as InstanceWrapper[];
     const scopedFilters = iterate(scopedFilterWrappers)
-      .map(wrapper => wrapper.getInstanceByContextId(contextId, inquirerId))
+      .map(wrapper =>
+        wrapper.getInstanceByContextId(
+          this.getContextId(contextId, wrapper),
+          inquirerId,
+        ),
+      )
       .filter(host => !!host)
       .map(host => host.instance)
       .toArray();
diff --git a/packages/microservices/context/request-context-host.ts b/packages/microservices/context/request-context-host.ts
index 2d221cca7..f15eb29d8 100644
--- a/packages/microservices/context/request-context-host.ts
+++ b/packages/microservices/context/request-context-host.ts
@@ -1,6 +1,9 @@
 import { BaseRpcContext } from '../ctx-host/base-rpc.context';
 import { RequestContext } from '../interfaces';
 
+/**
+ * @publicApi
+ */
 export class RequestContextHost<
   TData = any,
   TContext extends BaseRpcContext = any,
diff --git a/packages/microservices/context/rpc-context-creator.ts b/packages/microservices/context/rpc-context-creator.ts
index 003cd646c..a7ee74e02 100644
--- a/packages/microservices/context/rpc-context-creator.ts
+++ b/packages/microservices/context/rpc-context-creator.ts
@@ -1,5 +1,5 @@
 import {
-  CUSTOM_ROUTE_AGRS_METADATA,
+  CUSTOM_ROUTE_ARGS_METADATA,
   PARAMTYPES_METADATA,
 } from '@nestjs/common/constants';
 import {
@@ -225,7 +225,7 @@ export class RpcContextCreator {
         this.pipesContextCreator.createConcreteContext(pipesCollection);
       const type = this.contextUtils.mapParamType(key);
 
-      if (key.includes(CUSTOM_ROUTE_AGRS_METADATA)) {
+      if (key.includes(CUSTOM_ROUTE_ARGS_METADATA)) {
         const { factory } = metadata[key];
         const customExtractValue = this.contextUtils.getCustomFactory(
           factory,
diff --git a/packages/microservices/context/rpc-proxy.ts b/packages/microservices/context/rpc-proxy.ts
index 6d30b4591..521d5b7cd 100644
--- a/packages/microservices/context/rpc-proxy.ts
+++ b/packages/microservices/context/rpc-proxy.ts
@@ -1,6 +1,5 @@
-import { isFunction } from '@nestjs/common/utils/shared.utils';
 import { ExecutionContextHost } from '@nestjs/core/helpers/execution-context-host';
-import { Observable } from 'rxjs';
+import { isObservable, Observable } from 'rxjs';
 import { catchError } from 'rxjs/operators';
 import { RpcExceptionsHandler } from '../exceptions/rpc-exceptions-handler';
 
@@ -12,7 +11,7 @@ export class RpcProxy {
     return async (...args: unknown[]) => {
       try {
         const result = await targetCallback(...args);
-        return !this.isObservable(result)
+        return !isObservable(result)
           ? result
           : result.pipe(
               catchError(error =>
@@ -34,8 +33,4 @@ export class RpcProxy {
     host.setType('rpc');
     return exceptionsHandler.handle(error, host);
   }
-
-  isObservable(result: any): boolean {
-    return result && isFunction(result.subscribe);
-  }
 }
diff --git a/packages/microservices/ctx-host/index.ts b/packages/microservices/ctx-host/index.ts
index 923346e48..9d871dee2 100644
--- a/packages/microservices/ctx-host/index.ts
+++ b/packages/microservices/ctx-host/index.ts
@@ -4,3 +4,4 @@ export * from './nats.context';
 export * from './redis.context';
 export * from './rmq.context';
 export * from './tcp.context';
+export * from './base-rpc.context';
diff --git a/packages/microservices/ctx-host/kafka.context.ts b/packages/microservices/ctx-host/kafka.context.ts
index 922ccb9c5..4ba1663c8 100644
--- a/packages/microservices/ctx-host/kafka.context.ts
+++ b/packages/microservices/ctx-host/kafka.context.ts
@@ -1,7 +1,14 @@
-import { KafkaMessage } from '../external/kafka.interface';
+import { Consumer, KafkaMessage, Producer } from '../external/kafka.interface';
 import { BaseRpcContext } from './base-rpc.context';
 
-type KafkaContextArgs = [KafkaMessage, number, string];
+type KafkaContextArgs = [
+  message: KafkaMessage,
+  partition: number,
+  topic: string,
+  consumer: Consumer,
+  heartbeat: () => Promise<void>,
+  producer: Producer,
+];
 
 export class KafkaContext extends BaseRpcContext<KafkaContextArgs> {
   constructor(args: KafkaContextArgs) {
@@ -28,4 +35,25 @@ export class KafkaContext extends BaseRpcContext<KafkaContextArgs> {
   getTopic() {
     return this.args[2];
   }
+
+  /**
+   * Returns the Kafka consumer reference.
+   */
+  getConsumer() {
+    return this.args[3];
+  }
+
+  /**
+   * Returns the Kafka heartbeat callback.
+   */
+  getHeartbeat() {
+    return this.args[4];
+  }
+
+  /**
+   * Returns the Kafka producer reference,
+   */
+  getProducer() {
+    return this.args[5];
+  }
 }
diff --git a/packages/microservices/ctx-host/mqtt.context.ts b/packages/microservices/ctx-host/mqtt.context.ts
index 0693c35d3..3b953516a 100644
--- a/packages/microservices/ctx-host/mqtt.context.ts
+++ b/packages/microservices/ctx-host/mqtt.context.ts
@@ -15,7 +15,7 @@ export class MqttContext extends BaseRpcContext<MqttContextArgs> {
   }
 
   /**
-   * Returns the refernce to the original MQTT packet.
+   * Returns the reference to the original MQTT packet.
    */
   getPacket() {
     return this.args[1];
diff --git a/packages/microservices/ctx-host/tcp.context.ts b/packages/microservices/ctx-host/tcp.context.ts
index a858ea442..1f1c6a28d 100644
--- a/packages/microservices/ctx-host/tcp.context.ts
+++ b/packages/microservices/ctx-host/tcp.context.ts
@@ -1,7 +1,7 @@
-import { JsonSocket } from '../helpers/json-socket';
+import { TcpSocket } from '../helpers';
 import { BaseRpcContext } from './base-rpc.context';
 
-type TcpContextArgs = [JsonSocket, string];
+type TcpContextArgs = [TcpSocket, string];
 
 export class TcpContext extends BaseRpcContext<TcpContextArgs> {
   constructor(args: TcpContextArgs) {
diff --git a/packages/microservices/decorators/client.decorator.ts b/packages/microservices/decorators/client.decorator.ts
index 53d99d4fb..48848b6a4 100644
--- a/packages/microservices/decorators/client.decorator.ts
+++ b/packages/microservices/decorators/client.decorator.ts
@@ -5,6 +5,9 @@ import { ClientOptions } from '../interfaces/client-metadata.interface';
  * Attaches the `ClientProxy` instance to the given property
  *
  * @param  {ClientOptions} metadata optional client metadata
+ *
+ * @publicApi
+ *
  */
 export function Client(metadata?: ClientOptions): PropertyDecorator {
   return (target: object, propertyKey: string | symbol): void => {
diff --git a/packages/microservices/decorators/event-pattern.decorator.ts b/packages/microservices/decorators/event-pattern.decorator.ts
index 5fe9561df..ead1830b9 100644
--- a/packages/microservices/decorators/event-pattern.decorator.ts
+++ b/packages/microservices/decorators/event-pattern.decorator.ts
@@ -1,30 +1,74 @@
+import {
+  isObject,
+  isNumber,
+  isNil,
+  isSymbol,
+} from '@nestjs/common/utils/shared.utils';
 import {
   PATTERN_HANDLER_METADATA,
   PATTERN_METADATA,
   TRANSPORT_METADATA,
+  PATTERN_EXTRAS_METADATA,
 } from '../constants';
 import { PatternHandler } from '../enums/pattern-handler.enum';
 import { Transport } from '../enums';
 
 /**
  * Subscribes to incoming events which fulfils chosen pattern.
+ *
+ * @publicApi
  */
-export const EventPattern = <T = string>(
+export const EventPattern: {
+  <T = string>(metadata?: T): MethodDecorator;
+  <T = string>(metadata?: T, transport?: Transport | symbol): MethodDecorator;
+  <T = string>(metadata?: T, extras?: Record<string, any>): MethodDecorator;
+  <T = string>(
+    metadata?: T,
+    transport?: Transport | symbol,
+    extras?: Record<string, any>,
+  ): MethodDecorator;
+} = <T = string>(
   metadata?: T,
-  transport?: Transport,
+  transportOrExtras?: Transport | symbol | Record<string, any>,
+  maybeExtras?: Record<string, any>,
 ): MethodDecorator => {
+  let transport: Transport | symbol;
+  let extras: Record<string, any>;
+  if (
+    (isNumber(transportOrExtras) || isSymbol(transportOrExtras)) &&
+    isNil(maybeExtras)
+  ) {
+    transport = transportOrExtras;
+  } else if (isObject(transportOrExtras) && isNil(maybeExtras)) {
+    extras = transportOrExtras;
+  } else {
+    transport = transportOrExtras as Transport | symbol;
+    extras = maybeExtras;
+  }
   return (
     target: object,
     key: string | symbol,
     descriptor: PropertyDescriptor,
   ) => {
-    Reflect.defineMetadata(PATTERN_METADATA, metadata, descriptor.value);
+    Reflect.defineMetadata(
+      PATTERN_METADATA,
+      [].concat(metadata),
+      descriptor.value,
+    );
     Reflect.defineMetadata(
       PATTERN_HANDLER_METADATA,
       PatternHandler.EVENT,
       descriptor.value,
     );
     Reflect.defineMetadata(TRANSPORT_METADATA, transport, descriptor.value);
+    Reflect.defineMetadata(
+      PATTERN_EXTRAS_METADATA,
+      {
+        ...Reflect.getMetadata(PATTERN_EXTRAS_METADATA, descriptor.value),
+        ...extras,
+      },
+      descriptor.value,
+    );
     return descriptor;
   };
 };
diff --git a/packages/microservices/decorators/message-pattern.decorator.ts b/packages/microservices/decorators/message-pattern.decorator.ts
index 936d76703..86d460f1f 100644
--- a/packages/microservices/decorators/message-pattern.decorator.ts
+++ b/packages/microservices/decorators/message-pattern.decorator.ts
@@ -1,8 +1,15 @@
+import {
+  isObject,
+  isNumber,
+  isNil,
+  isSymbol,
+} from '@nestjs/common/utils/shared.utils';
 /* eslint-disable @typescript-eslint/no-use-before-define */
 import {
   PATTERN_HANDLER_METADATA,
   PATTERN_METADATA,
   TRANSPORT_METADATA,
+  PATTERN_EXTRAS_METADATA,
 } from '../constants';
 import { PatternHandler } from '../enums/pattern-handler.enum';
 import { PatternMetadata } from '../interfaces/pattern-metadata.interface';
@@ -16,23 +23,66 @@ export enum GrpcMethodStreamingType {
 
 /**
  * Subscribes to incoming messages which fulfils chosen pattern.
+ *
+ * @publicApi
  */
-export const MessagePattern = <T = PatternMetadata | string>(
+export const MessagePattern: {
+  <T = PatternMetadata | string>(metadata?: T): MethodDecorator;
+  <T = PatternMetadata | string>(
+    metadata?: T,
+    transport?: Transport | symbol,
+  ): MethodDecorator;
+  <T = PatternMetadata | string>(
+    metadata?: T,
+    extras?: Record<string, any>,
+  ): MethodDecorator;
+  <T = PatternMetadata | string>(
+    metadata?: T,
+    transport?: Transport | symbol,
+    extras?: Record<string, any>,
+  ): MethodDecorator;
+} = <T = PatternMetadata | string>(
   metadata?: T,
-  transport?: Transport,
+  transportOrExtras?: Transport | symbol | Record<string, any>,
+  maybeExtras?: Record<string, any>,
 ): MethodDecorator => {
+  let transport: Transport | symbol;
+  let extras: Record<string, any>;
+  if (
+    (isNumber(transportOrExtras) || isSymbol(transportOrExtras)) &&
+    isNil(maybeExtras)
+  ) {
+    transport = transportOrExtras;
+  } else if (isObject(transportOrExtras) && isNil(maybeExtras)) {
+    extras = transportOrExtras;
+  } else {
+    transport = transportOrExtras as Transport | symbol;
+    extras = maybeExtras;
+  }
   return (
     target: object,
     key: string | symbol,
     descriptor: PropertyDescriptor,
   ) => {
-    Reflect.defineMetadata(PATTERN_METADATA, metadata, descriptor.value);
+    Reflect.defineMetadata(
+      PATTERN_METADATA,
+      [].concat(metadata),
+      descriptor.value,
+    );
     Reflect.defineMetadata(
       PATTERN_HANDLER_METADATA,
       PatternHandler.MESSAGE,
       descriptor.value,
     );
     Reflect.defineMetadata(TRANSPORT_METADATA, transport, descriptor.value);
+    Reflect.defineMetadata(
+      PATTERN_EXTRAS_METADATA,
+      {
+        ...Reflect.getMetadata(PATTERN_EXTRAS_METADATA, descriptor.value),
+        ...extras,
+      },
+      descriptor.value,
+    );
     return descriptor;
   };
 };
diff --git a/packages/microservices/deserializers/identity.deserializer.ts b/packages/microservices/deserializers/identity.deserializer.ts
index 9eccb6621..7a6d1e0d4 100644
--- a/packages/microservices/deserializers/identity.deserializer.ts
+++ b/packages/microservices/deserializers/identity.deserializer.ts
@@ -1,5 +1,8 @@
 import { Deserializer } from '../interfaces/deserializer.interface';
 
+/**
+ * @publicApi
+ */
 export class IdentityDeserializer implements Deserializer {
   deserialize(value: any) {
     return value;
diff --git a/packages/microservices/deserializers/incoming-request.deserializer.ts b/packages/microservices/deserializers/incoming-request.deserializer.ts
index 3e3a6f6f0..537e9b715 100644
--- a/packages/microservices/deserializers/incoming-request.deserializer.ts
+++ b/packages/microservices/deserializers/incoming-request.deserializer.ts
@@ -5,6 +5,9 @@ import {
   IncomingRequest,
 } from '../interfaces';
 
+/**
+ * @publicApi
+ */
 export class IncomingRequestDeserializer implements ConsumerDeserializer {
   deserialize(
     value: any,
diff --git a/packages/microservices/deserializers/incoming-response.deserializer.ts b/packages/microservices/deserializers/incoming-response.deserializer.ts
index 5ea343b1f..55ecc4684 100644
--- a/packages/microservices/deserializers/incoming-response.deserializer.ts
+++ b/packages/microservices/deserializers/incoming-response.deserializer.ts
@@ -1,6 +1,9 @@
 import { isUndefined } from '@nestjs/common/utils/shared.utils';
 import { IncomingResponse, ProducerDeserializer } from '../interfaces';
 
+/**
+ * @publicApi
+ */
 export class IncomingResponseDeserializer implements ProducerDeserializer {
   deserialize(value: any, options?: Record<string, any>): IncomingResponse {
     return this.isExternal(value) ? this.mapToSchema(value) : value;
diff --git a/packages/microservices/deserializers/index.ts b/packages/microservices/deserializers/index.ts
new file mode 100644
index 000000000..21fdbeb26
--- /dev/null
+++ b/packages/microservices/deserializers/index.ts
@@ -0,0 +1,7 @@
+export * from './identity.deserializer';
+export * from './incoming-request.deserializer';
+export * from './incoming-response.deserializer';
+export * from './kafka-request.deserializer';
+export * from './kafka-response.deserializer';
+export * from './nats-request-json.deserializer';
+export * from './nats-response-json.deserializer';
diff --git a/packages/microservices/deserializers/kafka-request.deserializer.ts b/packages/microservices/deserializers/kafka-request.deserializer.ts
new file mode 100644
index 000000000..359321728
--- /dev/null
+++ b/packages/microservices/deserializers/kafka-request.deserializer.ts
@@ -0,0 +1,24 @@
+import { IncomingEvent, IncomingRequest } from '../interfaces';
+import { KafkaRequest } from '../serializers/kafka-request.serializer';
+import { IncomingRequestDeserializer } from './incoming-request.deserializer';
+
+/**
+ * @publicApi
+ */
+export class KafkaRequestDeserializer extends IncomingRequestDeserializer {
+  mapToSchema(
+    data: KafkaRequest,
+    options?: Record<string, any>,
+  ): IncomingRequest | IncomingEvent {
+    if (!options) {
+      return {
+        pattern: undefined,
+        data: undefined,
+      };
+    }
+    return {
+      pattern: options.channel,
+      data: data?.value ?? data,
+    };
+  }
+}
diff --git a/packages/microservices/deserializers/kafka-response.deserializer.ts b/packages/microservices/deserializers/kafka-response.deserializer.ts
index 2b5385458..93d2977b2 100644
--- a/packages/microservices/deserializers/kafka-response.deserializer.ts
+++ b/packages/microservices/deserializers/kafka-response.deserializer.ts
@@ -2,6 +2,9 @@ import { isUndefined } from '@nestjs/common/utils/shared.utils';
 import { KafkaHeaders } from '../enums/kafka-headers.enum';
 import { Deserializer, IncomingResponse } from '../interfaces';
 
+/**
+ * @publicApi
+ */
 export class KafkaResponseDeserializer
   implements Deserializer<any, IncomingResponse>
 {
diff --git a/packages/microservices/deserializers/nats-request-json.deserializer.ts b/packages/microservices/deserializers/nats-request-json.deserializer.ts
index e46851751..68763e17f 100644
--- a/packages/microservices/deserializers/nats-request-json.deserializer.ts
+++ b/packages/microservices/deserializers/nats-request-json.deserializer.ts
@@ -5,6 +5,9 @@ import { IncomingRequestDeserializer } from './incoming-request.deserializer';
 
 let natsPackage = {} as any;
 
+/**
+ * @publicApi
+ */
 export class NatsRequestJSONDeserializer extends IncomingRequestDeserializer {
   private readonly jsonCodec: NatsCodec<unknown>;
 
diff --git a/packages/microservices/deserializers/nats-response-json.deserializer.ts b/packages/microservices/deserializers/nats-response-json.deserializer.ts
index 70787afc7..51a809726 100644
--- a/packages/microservices/deserializers/nats-response-json.deserializer.ts
+++ b/packages/microservices/deserializers/nats-response-json.deserializer.ts
@@ -6,6 +6,9 @@ import { NatsRequestJSONDeserializer } from './nats-request-json.deserializer';
 
 let natsPackage = {} as any;
 
+/**
+ * @publicApi
+ */
 export class NatsResponseJSONDeserializer extends IncomingResponseDeserializer {
   private readonly jsonCodec: NatsCodec<unknown>;
 
diff --git a/packages/microservices/enums/kafka-headers.enum.ts b/packages/microservices/enums/kafka-headers.enum.ts
index c4c622873..82d5eead2 100644
--- a/packages/microservices/enums/kafka-headers.enum.ts
+++ b/packages/microservices/enums/kafka-headers.enum.ts
@@ -1,5 +1,7 @@
 /**
  * @see https://docs.spring.io/spring-kafka/api/org/springframework/kafka/support/KafkaHeaders.html
+ *
+ * @publicApi
  */
 export enum KafkaHeaders {
   ACKNOWLEDGMENT = 'kafka_acknowledgment',
diff --git a/packages/microservices/errors/corrupted-packet-length.exception.ts b/packages/microservices/errors/corrupted-packet-length.exception.ts
index c00e20a6e..8dea792c5 100644
--- a/packages/microservices/errors/corrupted-packet-length.exception.ts
+++ b/packages/microservices/errors/corrupted-packet-length.exception.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export class CorruptedPacketLengthException extends Error {
   constructor(rawContentLength: string) {
     super(`Corrupted length value "${rawContentLength}" supplied in a packet`);
diff --git a/packages/microservices/errors/empty-response.exception.ts b/packages/microservices/errors/empty-response.exception.ts
index d0b0d7330..1151f8dc4 100644
--- a/packages/microservices/errors/empty-response.exception.ts
+++ b/packages/microservices/errors/empty-response.exception.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export class EmptyResponseException extends Error {
   constructor(pattern: string) {
     super(
diff --git a/packages/microservices/errors/invalid-grpc-package.exception.ts b/packages/microservices/errors/invalid-grpc-package.exception.ts
index d9f044f33..a0599e457 100644
--- a/packages/microservices/errors/invalid-grpc-package.exception.ts
+++ b/packages/microservices/errors/invalid-grpc-package.exception.ts
@@ -1,7 +1,10 @@
 import { RuntimeException } from '@nestjs/core/errors/exceptions/runtime.exception';
 
+/**
+ * @publicApi
+ */
 export class InvalidGrpcPackageException extends RuntimeException {
-  constructor() {
-    super('The invalid gRPC package (package not found)');
+  constructor(name: string) {
+    super(`The invalid gRPC package (package "${name}" not found)`);
   }
 }
diff --git a/packages/microservices/errors/invalid-grpc-service.exception.ts b/packages/microservices/errors/invalid-grpc-service.exception.ts
index 0a0a1d489..1da6a18c8 100644
--- a/packages/microservices/errors/invalid-grpc-service.exception.ts
+++ b/packages/microservices/errors/invalid-grpc-service.exception.ts
@@ -1,7 +1,10 @@
 import { RuntimeException } from '@nestjs/core/errors/exceptions/runtime.exception';
 
+/**
+ * @publicApi
+ */
 export class InvalidGrpcServiceException extends RuntimeException {
-  constructor() {
-    super(`The invalid gRPC service (service not found)`);
+  constructor(name: string) {
+    super(`The invalid gRPC service (service "${name}" not found)`);
   }
 }
diff --git a/packages/microservices/errors/invalid-json-format.exception.ts b/packages/microservices/errors/invalid-json-format.exception.ts
index ef7f69108..ac830a49b 100644
--- a/packages/microservices/errors/invalid-json-format.exception.ts
+++ b/packages/microservices/errors/invalid-json-format.exception.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export class InvalidJSONFormatException extends Error {
   constructor(err: Error, data: string) {
     super(`Could not parse JSON: ${err.message}\nRequest data: ${data}`);
diff --git a/packages/microservices/errors/invalid-kafka-client-topic.exception.ts b/packages/microservices/errors/invalid-kafka-client-topic.exception.ts
index aa0062569..12871369f 100644
--- a/packages/microservices/errors/invalid-kafka-client-topic.exception.ts
+++ b/packages/microservices/errors/invalid-kafka-client-topic.exception.ts
@@ -1,5 +1,8 @@
 import { RuntimeException } from '@nestjs/core/errors/exceptions/runtime.exception';
 
+/**
+ * @publicApi
+ */
 export class InvalidKafkaClientTopicException extends RuntimeException {
   constructor(topic?: string) {
     super(
diff --git a/packages/microservices/errors/invalid-message.exception.ts b/packages/microservices/errors/invalid-message.exception.ts
index cc1627b87..6b8c0e9ee 100644
--- a/packages/microservices/errors/invalid-message.exception.ts
+++ b/packages/microservices/errors/invalid-message.exception.ts
@@ -1,5 +1,8 @@
 import { RuntimeException } from '@nestjs/core/errors/exceptions/runtime.exception';
 
+/**
+ * @publicApi
+ */
 export class InvalidMessageException extends RuntimeException {
   constructor() {
     super(`The invalid data or message pattern (undefined/null)`);
diff --git a/packages/microservices/errors/invalid-proto-definition.exception.ts b/packages/microservices/errors/invalid-proto-definition.exception.ts
index ac2d2c8f8..28ce445a0 100644
--- a/packages/microservices/errors/invalid-proto-definition.exception.ts
+++ b/packages/microservices/errors/invalid-proto-definition.exception.ts
@@ -1,7 +1,10 @@
 import { RuntimeException } from '@nestjs/core/errors/exceptions/runtime.exception';
 
+/**
+ * @publicApi
+ */
 export class InvalidProtoDefinitionException extends RuntimeException {
-  constructor() {
-    super('The invalid .proto definition (file not found)');
+  constructor(path: string) {
+    super(`The invalid .proto definition (file at "${path}" not found)`);
   }
 }
diff --git a/packages/microservices/errors/net-socket-closed.exception.ts b/packages/microservices/errors/net-socket-closed.exception.ts
index 3453aaaa7..9f20bbd0d 100644
--- a/packages/microservices/errors/net-socket-closed.exception.ts
+++ b/packages/microservices/errors/net-socket-closed.exception.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export class NetSocketClosedException extends Error {
   constructor() {
     super(`The net socket is closed.`);
diff --git a/packages/microservices/exceptions/base-rpc-exception-filter.ts b/packages/microservices/exceptions/base-rpc-exception-filter.ts
index d7783d40b..837330fac 100644
--- a/packages/microservices/exceptions/base-rpc-exception-filter.ts
+++ b/packages/microservices/exceptions/base-rpc-exception-filter.ts
@@ -5,6 +5,9 @@ import { MESSAGES } from '@nestjs/core/constants';
 import { Observable, throwError as _throw } from 'rxjs';
 import { RpcException } from './rpc-exception';
 
+/**
+ * @publicApi
+ */
 export class BaseRpcExceptionFilter<T = any, R = any>
   implements RpcExceptionFilter<T>
 {
@@ -17,7 +20,7 @@ export class BaseRpcExceptionFilter<T = any, R = any>
     }
     const res = exception.getError();
     const message = isObject(res) ? res : { status, message: res };
-    return _throw(message);
+    return _throw(() => message);
   }
 
   public handleUnknownError(exception: T, status: string) {
@@ -29,7 +32,7 @@ export class BaseRpcExceptionFilter<T = any, R = any>
     const logger = BaseRpcExceptionFilter.logger;
     logger.error.apply(logger, loggerArgs as any);
 
-    return _throw({ status, message: errorMessage });
+    return _throw(() => ({ status, message: errorMessage }));
   }
 
   public isError(exception: any): exception is Error {
diff --git a/packages/microservices/exceptions/index.ts b/packages/microservices/exceptions/index.ts
index dd6e4d298..73e4c3176 100644
--- a/packages/microservices/exceptions/index.ts
+++ b/packages/microservices/exceptions/index.ts
@@ -1,2 +1,3 @@
 export * from './base-rpc-exception-filter';
+export * from './kafka-retriable-exception';
 export * from './rpc-exception';
diff --git a/packages/microservices/exceptions/kafka-retriable-exception.ts b/packages/microservices/exceptions/kafka-retriable-exception.ts
new file mode 100644
index 000000000..c62194a2e
--- /dev/null
+++ b/packages/microservices/exceptions/kafka-retriable-exception.ts
@@ -0,0 +1,17 @@
+import { RpcException } from './rpc-exception';
+
+/**
+ * Exception that instructs Kafka driver to instead of introspecting
+ * error processing flow and sending serialized error message to the consumer,
+ * force bubble it up to the "eachMessage" callback of the underlying "kafkajs" package
+ * (even if interceptors are applied, or an observable stream is returned from the message handler).
+ *
+ * A transient exception that if retried may succeed.
+ *
+ * @publicApi
+ */
+export class KafkaRetriableException extends RpcException {
+  public getError(): string | object {
+    return this;
+  }
+}
diff --git a/packages/microservices/exceptions/rpc-exception.ts b/packages/microservices/exceptions/rpc-exception.ts
index 1d59c61c7..60d77f5c1 100644
--- a/packages/microservices/exceptions/rpc-exception.ts
+++ b/packages/microservices/exceptions/rpc-exception.ts
@@ -1,5 +1,8 @@
 import { isObject, isString } from '@nestjs/common/utils/shared.utils';
 
+/**
+ * @publicApi
+ */
 export class RpcException extends Error {
   constructor(private readonly error: string | object) {
     super();
diff --git a/packages/microservices/exceptions/rpc-exceptions-handler.ts b/packages/microservices/exceptions/rpc-exceptions-handler.ts
index 7815c80d1..97ee23270 100644
--- a/packages/microservices/exceptions/rpc-exceptions-handler.ts
+++ b/packages/microservices/exceptions/rpc-exceptions-handler.ts
@@ -1,11 +1,15 @@
-import { RpcExceptionFilterMetadata } from '@nestjs/common/interfaces/exceptions';
-import { ArgumentsHost } from '@nestjs/common/interfaces/features/arguments-host.interface';
 import { isEmpty } from '@nestjs/common/utils/shared.utils';
-import { InvalidExceptionFilterException } from '@nestjs/core/errors/exceptions/invalid-exception-filter.exception';
 import { Observable } from 'rxjs';
-import { BaseRpcExceptionFilter } from './base-rpc-exception-filter';
+import { ArgumentsHost } from '@nestjs/common/interfaces/features/arguments-host.interface';
+import { RpcExceptionFilterMetadata } from '@nestjs/common/interfaces/exceptions';
+import { selectExceptionFilterMetadata } from '@nestjs/common/utils/select-exception-filter-metadata.util';
+import { InvalidExceptionFilterException } from '@nestjs/core/errors/exceptions/invalid-exception-filter.exception';
 import { RpcException } from './rpc-exception';
+import { BaseRpcExceptionFilter } from './base-rpc-exception-filter';
 
+/**
+ * @publicApi
+ */
 export class RpcExceptionsHandler extends BaseRpcExceptionFilter {
   private filters: RpcExceptionFilterMetadata[] = [];
 
@@ -34,14 +38,8 @@ export class RpcExceptionsHandler extends BaseRpcExceptionFilter {
     if (isEmpty(this.filters)) {
       return null;
     }
-    const filter = this.filters.find(({ exceptionMetatypes }) => {
-      const hasMetatype =
-        !exceptionMetatypes.length ||
-        exceptionMetatypes.some(
-          ExceptionMetatype => exception instanceof ExceptionMetatype,
-        );
-      return hasMetatype;
-    });
+
+    const filter = selectExceptionFilterMetadata(this.filters, exception);
     return filter ? filter.func(exception, host) : null;
   }
 }
diff --git a/packages/microservices/external/grpc-options.interface.ts b/packages/microservices/external/grpc-options.interface.ts
index f00fb4cb7..51ceac477 100644
--- a/packages/microservices/external/grpc-options.interface.ts
+++ b/packages/microservices/external/grpc-options.interface.ts
@@ -1,6 +1,8 @@
 /**
  * An interface that contains options used when initializing a Channel instance.
  * This listing is incomplete. Full reference: https://grpc.github.io/grpc/core/group__grpc__arg__keys.html
+ *
+ * @publicApi
  */
 export interface ChannelOptions {
   'grpc.max_send_message_length'?: number;
@@ -16,5 +18,5 @@ export interface ChannelOptions {
   'grpc.max_reconnect_backoff_ms'?: number;
   'grpc.use_local_subchannel_pool'?: number;
   'grpc-node.max_session_memory'?: number;
-  [key: string]: string | number | undefined;
+  [key: string]: any;
 }
diff --git a/packages/microservices/external/kafka.interface.ts b/packages/microservices/external/kafka.interface.ts
index ea7a29a4c..ed7a07bef 100644
--- a/packages/microservices/external/kafka.interface.ts
+++ b/packages/microservices/external/kafka.interface.ts
@@ -2,10 +2,12 @@
  * Do NOT add NestJS logic to this interface.  It is meant to ONLY represent the types for the kafkajs package.
  *
  * @see https://github.com/tulios/kafkajs/blob/master/types/index.d.ts
+ *
+ * @publicApi
+ *
  */
 
 /// <reference types="node" />
-
 import * as net from 'net';
 import * as tls from 'tls';
 
@@ -17,17 +19,44 @@ type XOR<T, U> = T | U extends object
 export declare class Kafka {
   constructor(config: KafkaConfig);
   producer(config?: ProducerConfig): Producer;
-  consumer(config?: ConsumerConfig): Consumer;
+  consumer(config: ConsumerConfig): Consumer;
   admin(config?: AdminConfig): Admin;
   logger(): Logger;
 }
 
 export type BrokersFunction = () => string[] | Promise<string[]>;
 
+type SaslAuthenticationRequest = {
+  encode: () => Buffer | Promise<Buffer>;
+};
+type SaslAuthenticationResponse<ParseResult> = {
+  decode: (rawResponse: Buffer) => Buffer | Promise<Buffer>;
+  parse: (data: Buffer) => ParseResult;
+};
+
+type Authenticator = {
+  authenticate: () => Promise<void>;
+};
+
+type AuthenticationProviderArgs = {
+  host: string;
+  port: number;
+  logger: Logger;
+  saslAuthenticate: <ParseResult>(
+    request: SaslAuthenticationRequest,
+    response?: SaslAuthenticationResponse<ParseResult>,
+  ) => Promise<ParseResult | void>;
+};
+
+type Mechanism = {
+  mechanism: string;
+  authenticationProvider: (args: AuthenticationProviderArgs) => Authenticator;
+};
+
 export interface KafkaConfig {
   brokers: string[] | BrokersFunction;
   ssl?: tls.ConnectionOptions | boolean;
-  sasl?: SASLOptions;
+  sasl?: SASLOptions | Mechanism;
   clientId?: string;
   connectionTimeout?: number;
   authenticationTimeout?: number;
@@ -101,11 +130,18 @@ export interface PartitionerArgs {
 
 export type ICustomPartitioner = () => (args: PartitionerArgs) => number;
 export type DefaultPartitioner = ICustomPartitioner;
-export type JavaCompatiblePartitioner = ICustomPartitioner;
+export type LegacyPartitioner = ICustomPartitioner;
 
 export let Partitioners: {
   DefaultPartitioner: DefaultPartitioner;
-  JavaCompatiblePartitioner: JavaCompatiblePartitioner;
+  LegacyPartitioner: LegacyPartitioner;
+  /**
+   * @deprecated Use DefaultPartitioner instead
+   *
+   * The JavaCompatiblePartitioner was renamed DefaultPartitioner
+   * and made to be the default in 2.0.0.
+   */
+  JavaCompatiblePartitioner: DefaultPartitioner;
 };
 
 export type PartitionMetadata = {
@@ -118,7 +154,7 @@ export type PartitionMetadata = {
 };
 
 export interface IHeaders {
-  [key: string]: Buffer | string | undefined;
+  [key: string]: Buffer | string | (Buffer | string)[] | undefined;
 }
 
 export interface ConsumerConfig {
@@ -141,7 +177,11 @@ export interface ConsumerConfig {
   rackId?: string;
 }
 
-export type PartitionAssigner = (config: { cluster: Cluster }) => Assigner;
+export type PartitionAssigner = (config: {
+  cluster: Cluster;
+  groupId: string;
+  logger: Logger;
+}) => Assigner;
 
 export interface CoordinatorMetadata {
   errorCode: number;
@@ -153,6 +193,10 @@ export interface CoordinatorMetadata {
 }
 
 export type Cluster = {
+  getNodeIds(): number[];
+  metadata(): Promise<BrokerMetadata>;
+  removeBroker(options: { host: string; port: number }): void;
+  addMultipleTargetTopics(topics: string[]): Promise<void>;
   isConnected(): boolean;
   connect(): Promise<void>;
   disconnect(): Promise<void>;
@@ -178,10 +222,7 @@ export type Cluster = {
         partitions: Array<{ partition: number }>;
       } & XOR<{ fromBeginning: boolean }, { fromTimestamp: number }>
     >,
-  ): Promise<{
-    topic: string;
-    partitions: Array<{ partition: number; offset: string }>;
-  }>;
+  ): Promise<TopicOffsets[]>;
 };
 
 export type Assignment = { [topic: string]: number[] };
@@ -211,6 +252,7 @@ export interface RetryOptions {
   factor?: number;
   multiplier?: number;
   retries?: number;
+  restartOnFailure?: (e: Error) => Promise<boolean>;
 }
 
 export interface AdminConfig {
@@ -222,7 +264,7 @@ export interface ITopicConfig {
   numPartitions?: number;
   replicationFactor?: number;
   replicaAssignment?: object[];
-  configEntries?: object[];
+  configEntries?: IResourceConfigEntry[];
 }
 
 export interface ITopicPartitionConfig {
@@ -236,20 +278,6 @@ export interface ITopicMetadata {
   partitions: PartitionMetadata[];
 }
 
-/**
- * @deprecated
- * Use ConfigResourceTypes or AclResourceTypes
- */
-export enum ResourceTypes {
-  UNKNOWN = 0,
-  ANY = 1,
-  TOPIC = 2,
-  GROUP = 3,
-  CLUSTER = 4,
-  TRANSACTIONAL_ID = 5,
-  DELEGATION_TOKEN = 6,
-}
-
 export enum AclResourceTypes {
   UNKNOWN = 0,
   ANY = 1,
@@ -267,6 +295,16 @@ export enum ConfigResourceTypes {
   BROKER_LOGGER = 8,
 }
 
+export enum ConfigSource {
+  UNKNOWN = 0,
+  TOPIC_CONFIG = 1,
+  DYNAMIC_BROKER_CONFIG = 2,
+  DYNAMIC_DEFAULT_BROKER_CONFIG = 3,
+  STATIC_BROKER_CONFIG = 4,
+  DEFAULT_CONFIG = 5,
+  DYNAMIC_BROKER_LOGGER_CONFIG = 6,
+}
+
 export enum AclPermissionTypes {
   UNKNOWN = 0,
   ANY = 1,
@@ -299,7 +337,7 @@ export enum ResourcePatternTypes {
 }
 
 export interface ResourceConfigQuery {
-  type: ResourceTypes | ConfigResourceTypes;
+  type: ConfigResourceTypes;
   name: string;
   configNames?: string[];
 }
@@ -308,6 +346,7 @@ export interface ConfigEntries {
   configName: string;
   configValue: string;
   isDefault: boolean;
+  configSource: ConfigSource;
   isSensitive: boolean;
   readOnly: boolean;
   configSynonyms: ConfigSynonyms[];
@@ -316,7 +355,7 @@ export interface ConfigEntries {
 export interface ConfigSynonyms {
   configName: string;
   configValue: string;
-  configSource: number;
+  configSource: ConfigSource;
 }
 
 export interface DescribeConfigResponse {
@@ -325,15 +364,20 @@ export interface DescribeConfigResponse {
     errorCode: number;
     errorMessage: string;
     resourceName: string;
-    resourceType: ResourceTypes | ConfigResourceTypes;
+    resourceType: ConfigResourceTypes;
   }[];
   throttleTime: number;
 }
 
+export interface IResourceConfigEntry {
+  name: string;
+  value: string;
+}
+
 export interface IResourceConfig {
-  type: ResourceTypes | ConfigResourceTypes;
+  type: ConfigResourceTypes;
   name: string;
-  configEntries: { name: string; value: string }[];
+  configEntries: IResourceConfigEntry[];
 }
 
 type ValueOf<T> = T[keyof T];
@@ -387,11 +431,11 @@ export type RequestQueueSizeEvent = InstrumentationEvent<{
   queueSize: number;
 }>;
 
-export interface SeekEntry {
-  partition: number;
-  offset: string;
-}
+export type SeekEntry = PartitionOffset;
 
+export type FetchOffsetsPartition = PartitionOffset & {
+  metadata: string | null;
+};
 export interface Acl {
   principal: string;
   host: string;
@@ -408,7 +452,7 @@ export interface AclResource {
 export type AclEntry = Acl & AclResource;
 
 export type DescribeAclResource = AclResource & {
-  acl: Acl[];
+  acls: Acl[];
 };
 
 export interface DescribeAclResponse {
@@ -472,9 +516,9 @@ export type Admin = {
   }): Promise<{ topics: Array<ITopicMetadata> }>;
   fetchOffsets(options: {
     groupId: string;
-    topic: string;
+    topics?: string[];
     resolveOffsets?: boolean;
-  }): Promise<Array<SeekEntry & { metadata: string | null }>>;
+  }): Promise<Array<{ topic: string; partitions: FetchOffsetsPartition[] }>>;
   fetchTopicOffsets(
     topic: string,
   ): Promise<Array<SeekEntry & { high: string; low: string }>>;
@@ -516,11 +560,31 @@ export type Admin = {
     partitions: SeekEntry[];
   }): Promise<void>;
   logger(): Logger;
+  on(
+    eventName: AdminEvents['CONNECT'],
+    listener: (event: ConnectEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: AdminEvents['DISCONNECT'],
+    listener: (event: DisconnectEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: AdminEvents['REQUEST'],
+    listener: (event: RequestEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: AdminEvents['REQUEST_QUEUE_SIZE'],
+    listener: (event: RequestQueueSizeEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: AdminEvents['REQUEST_TIMEOUT'],
+    listener: (event: RequestTimeoutEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
   on(
     eventName: ValueOf<AdminEvents>,
-    listener: (...args: any[]) => void,
+    listener: (event: InstrumentationEvent<any>) => void,
   ): RemoveInstrumentationEventListener<typeof eventName>;
-  events: AdminEvents;
+  readonly events: AdminEvents;
 };
 
 export let PartitionAssigners: { roundRobin: PartitionAssigner };
@@ -563,7 +627,7 @@ export interface LogEntry {
 }
 
 export interface LoggerEntryContent {
-  readonly timestamp: Date;
+  readonly timestamp: string;
   readonly message: string;
   [key: string]: any;
 }
@@ -575,38 +639,44 @@ export type Logger = {
   error: (message: string, extra?: object) => void;
   warn: (message: string, extra?: object) => void;
   debug: (message: string, extra?: object) => void;
+
+  namespace: (namespace: string, logLevel?: logLevel) => Logger;
+  setLogLevel: (logLevel: logLevel) => void;
 };
 
+export interface BrokerMetadata {
+  brokers: Array<{ nodeId: number; host: string; port: number; rack?: string }>;
+  topicMetadata: Array<{
+    topicErrorCode: number;
+    topic: string;
+    partitionMetadata: PartitionMetadata[];
+  }>;
+}
+
+export interface ApiVersions {
+  [apiKey: number]: {
+    minVersion: number;
+    maxVersion: number;
+  };
+}
+
 export type Broker = {
   isConnected(): boolean;
   connect(): Promise<void>;
   disconnect(): Promise<void>;
-  apiVersions(): Promise<{
-    [apiKey: number]: { minVersion: number; maxVersion: number };
-  }>;
-  metadata(topics: string[]): Promise<{
-    brokers: Array<{
-      nodeId: number;
-      host: string;
-      port: number;
-      rack?: string;
-    }>;
-    topicMetadata: Array<{
-      topicErrorCode: number;
-      topic: number;
-      partitionMetadata: PartitionMetadata[];
-    }>;
-  }>;
+  apiVersions(): Promise<ApiVersions>;
+  metadata(topics: string[]): Promise<BrokerMetadata>;
+  describeGroups: (options: { groupIds: string[] }) => Promise<any>;
   offsetCommit(request: {
     groupId: string;
     groupGenerationId: number;
     memberId: string;
     retentionTime?: number;
-    topics: Array<{
-      topic: string;
-      partitions: Array<{ partition: number; offset: string }>;
-    }>;
+    topics: TopicOffsets[];
   }): Promise<any>;
+  offsetFetch(request: { groupId: string; topics: TopicOffsets[] }): Promise<{
+    responses: TopicOffsets[];
+  }>;
   fetch(request: {
     replicaId?: number;
     isolationLevel?: number;
@@ -623,17 +693,45 @@ export type Broker = {
     }>;
     rackId?: string;
   }): Promise<any>;
+  produce(request: {
+    topicData: Array<{
+      topic: string;
+      partitions: Array<{
+        partition: number;
+        firstSequence?: number;
+        messages: Message[];
+      }>;
+    }>;
+    transactionalId?: string;
+    producerId?: number;
+    producerEpoch?: number;
+    acks?: number;
+    timeout?: number;
+    compression?: CompressionTypes;
+  }): Promise<any>;
 };
 
-export type KafkaMessage = {
-  key: Buffer;
+interface MessageSetEntry {
+  key: Buffer | null;
   value: Buffer | null;
   timestamp: string;
+  attributes: number;
+  offset: string;
   size: number;
+  headers?: never;
+}
+
+interface RecordBatchEntry {
+  key: Buffer | null;
+  value: Buffer | null;
+  timestamp: string;
   attributes: number;
   offset: string;
-  headers?: IHeaders;
-};
+  headers: IHeaders;
+  size?: never;
+}
+
+export type KafkaMessage = MessageSetEntry | RecordBatchEntry;
 
 export interface ProducerRecord {
   topic: string;
@@ -697,10 +795,30 @@ export type Producer = Sender & {
   connect(): Promise<void>;
   disconnect(): Promise<void>;
   isIdempotent(): boolean;
-  events: ProducerEvents;
+  readonly events: ProducerEvents;
+  on(
+    eventName: ProducerEvents['CONNECT'],
+    listener: (event: ConnectEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ProducerEvents['DISCONNECT'],
+    listener: (event: DisconnectEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ProducerEvents['REQUEST'],
+    listener: (event: RequestEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ProducerEvents['REQUEST_QUEUE_SIZE'],
+    listener: (event: RequestQueueSizeEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ProducerEvents['REQUEST_TIMEOUT'],
+    listener: (event: RequestTimeoutEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
   on(
     eventName: ValueOf<ProducerEvents>,
-    listener: (...args: any[]) => void,
+    listener: (event: InstrumentationEvent<any>) => void,
   ): RemoveInstrumentationEventListener<typeof eventName>;
   transaction(): Promise<Transaction>;
   logger(): Logger;
@@ -750,16 +868,18 @@ export type GroupDescriptions = {
 };
 
 export type TopicPartitions = { topic: string; partitions: number[] };
-export type TopicPartitionOffsetAndMetadata = {
+
+export type TopicPartition = {
   topic: string;
   partition: number;
+};
+export type TopicPartitionOffset = TopicPartition & {
   offset: string;
+};
+export type TopicPartitionOffsetAndMetadata = TopicPartitionOffset & {
   metadata?: string | null;
 };
 
-// TODO: Remove with 2.x
-export type TopicPartitionOffsetAndMedata = TopicPartitionOffsetAndMetadata;
-
 export type Batch = {
   topic: string;
   partition: number;
@@ -795,6 +915,7 @@ export type ConsumerEvents = {
   DISCONNECT: 'consumer.disconnect';
   STOP: 'consumer.stop';
   CRASH: 'consumer.crash';
+  REBALANCING: 'consumer.rebalancing';
   RECEIVED_UNSUBSCRIBED_TOPICS: 'consumer.received_unsubscribed_topics';
   REQUEST: 'consumer.network.request';
   REQUEST_TIMEOUT: 'consumer.network.request_timeout';
@@ -809,13 +930,7 @@ export type ConsumerCommitOffsetsEvent = InstrumentationEvent<{
   groupId: string;
   memberId: string;
   groupGenerationId: number;
-  topics: {
-    topic: string;
-    partitions: {
-      offset: string;
-      partition: string;
-    }[];
-  }[];
+  topics: TopicOffsets[];
 }>;
 export interface IMemberAssignment {
   [key: string]: number[];
@@ -829,9 +944,11 @@ export type ConsumerGroupJoinEvent = InstrumentationEvent<{
   memberId: string;
   memberAssignment: IMemberAssignment;
 }>;
+export type ConsumerFetchStartEvent = InstrumentationEvent<{ nodeId: number }>;
 export type ConsumerFetchEvent = InstrumentationEvent<{
   numberOfBatches: number;
   duration: number;
+  nodeId: number;
 }>;
 interface IBatchProcessEvent {
   topic: string;
@@ -853,7 +970,11 @@ export type ConsumerCrashEvent = InstrumentationEvent<{
   groupId: string;
   restart: boolean;
 }>;
-export type ConsumerReceivedUnsubcribedTopicsEvent = InstrumentationEvent<{
+export type ConsumerRebalancingEvent = InstrumentationEvent<{
+  groupId: string;
+  memberId: string;
+}>;
+export type ConsumerReceivedUnsubscribedTopicsEvent = InstrumentationEvent<{
   groupId: string;
   generationId: number;
   memberId: string;
@@ -870,12 +991,15 @@ export interface EachMessagePayload {
   topic: string;
   partition: number;
   message: KafkaMessage;
+  heartbeat(): Promise<void>;
+  pause(): () => void;
 }
 
 export interface EachBatchPayload {
   batch: Batch;
   resolveOffset(offset: string): void;
   heartbeat(): Promise<void>;
+  pause(): () => void;
   commitOffsetsIfNecessary(offsets?: Offsets): Promise<void>;
   uncommittedOffsets(): OffsetsByTopicPartition;
   isRunning(): boolean;
@@ -894,45 +1018,117 @@ export type ConsumerEachMessagePayload = EachMessagePayload;
  */
 export type ConsumerEachBatchPayload = EachBatchPayload;
 
+export type EachBatchHandler = (payload: EachBatchPayload) => Promise<void>;
+export type EachMessageHandler = (payload: EachMessagePayload) => Promise<void>;
+
 export type ConsumerRunConfig = {
   autoCommit?: boolean;
   autoCommitInterval?: number | null;
   autoCommitThreshold?: number | null;
   eachBatchAutoResolve?: boolean;
   partitionsConsumedConcurrently?: number;
-  eachBatch?: (payload: EachBatchPayload) => Promise<void>;
-  eachMessage?: (payload: EachMessagePayload) => Promise<void>;
+  eachBatch?: EachBatchHandler;
+  eachMessage?: EachMessageHandler;
 };
 
+/**
+ * @deprecated Replaced by ConsumerSubscribeTopics
+ */
 export type ConsumerSubscribeTopic = {
   topic: string | RegExp;
   fromBeginning?: boolean;
 };
+export type ConsumerSubscribeTopics = {
+  topics: (string | RegExp)[];
+  fromBeginning?: boolean;
+};
 
 export type Consumer = {
   connect(): Promise<void>;
   disconnect(): Promise<void>;
-  subscribe(topic: ConsumerSubscribeTopic): Promise<void>;
+  subscribe(
+    subscription: ConsumerSubscribeTopics | ConsumerSubscribeTopic,
+  ): Promise<void>;
   stop(): Promise<void>;
   run(config?: ConsumerRunConfig): Promise<void>;
   commitOffsets(
     topicPartitions: Array<TopicPartitionOffsetAndMetadata>,
   ): Promise<void>;
-  seek(topicPartition: {
-    topic: string;
-    partition: number;
-    offset: string;
-  }): void;
+  seek(topicPartitionOffset: TopicPartitionOffset): void;
   describeGroup(): Promise<GroupDescription>;
   pause(topics: Array<{ topic: string; partitions?: number[] }>): void;
   paused(): TopicPartitions[];
   resume(topics: Array<{ topic: string; partitions?: number[] }>): void;
+  on(
+    eventName: ConsumerEvents['HEARTBEAT'],
+    listener: (event: ConsumerHeartbeatEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ConsumerEvents['COMMIT_OFFSETS'],
+    listener: (event: ConsumerCommitOffsetsEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ConsumerEvents['GROUP_JOIN'],
+    listener: (event: ConsumerGroupJoinEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ConsumerEvents['FETCH_START'],
+    listener: (event: ConsumerFetchStartEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ConsumerEvents['FETCH'],
+    listener: (event: ConsumerFetchEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ConsumerEvents['START_BATCH_PROCESS'],
+    listener: (event: ConsumerStartBatchProcessEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ConsumerEvents['END_BATCH_PROCESS'],
+    listener: (event: ConsumerEndBatchProcessEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ConsumerEvents['CONNECT'],
+    listener: (event: ConnectEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ConsumerEvents['DISCONNECT'],
+    listener: (event: DisconnectEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ConsumerEvents['STOP'],
+    listener: (event: InstrumentationEvent<null>) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ConsumerEvents['CRASH'],
+    listener: (event: ConsumerCrashEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ConsumerEvents['REBALANCING'],
+    listener: (event: ConsumerRebalancingEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ConsumerEvents['RECEIVED_UNSUBSCRIBED_TOPICS'],
+    listener: (event: ConsumerReceivedUnsubscribedTopicsEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ConsumerEvents['REQUEST'],
+    listener: (event: RequestEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ConsumerEvents['REQUEST_TIMEOUT'],
+    listener: (event: RequestTimeoutEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
+  on(
+    eventName: ConsumerEvents['REQUEST_QUEUE_SIZE'],
+    listener: (event: RequestQueueSizeEvent) => void,
+  ): RemoveInstrumentationEventListener<typeof eventName>;
   on(
     eventName: ValueOf<ConsumerEvents>,
-    listener: (...args: any[]) => void,
+    listener: (event: InstrumentationEvent<any>) => void,
   ): RemoveInstrumentationEventListener<typeof eventName>;
   logger(): Logger;
-  events: ConsumerEvents;
+  readonly events: ConsumerEvents;
 };
 
 export enum CompressionTypes {
@@ -955,6 +1151,7 @@ export declare class KafkaJSError extends Error {
   readonly name: string;
   readonly retriable: boolean;
   readonly helpUrl?: string;
+  readonly cause?: Error;
 
   constructor(e: Error | string, metadata?: KafkaJSErrorMetadata);
 }
@@ -977,7 +1174,6 @@ export declare class KafkaJSOffsetOutOfRange extends KafkaJSProtocolError {
 
 export declare class KafkaJSNumberOfRetriesExceeded extends KafkaJSNonRetriableError {
   readonly stack: string;
-  readonly originalError: Error;
   readonly retryCount: number;
   readonly retryTime: number;
   constructor(
diff --git a/packages/microservices/external/mqtt-client.interface.ts b/packages/microservices/external/mqtt-client.interface.ts
index 506081338..0429c850d 100644
--- a/packages/microservices/external/mqtt-client.interface.ts
+++ b/packages/microservices/external/mqtt-client.interface.ts
@@ -2,6 +2,9 @@ import { EventEmitter } from 'events';
 
 /**
  * @see https://github.com/mqttjs/MQTT.js/
+ *
+ * @publicApi
+ *
  */
 export declare class MqttClient extends EventEmitter {
   public connected: boolean;
@@ -75,7 +78,7 @@ export declare class MqttClient extends EventEmitter {
   /**
    * unsubscribe - unsubscribe from topic(s)
    *
-   * @param {String, Array} topic - topics to unsubscribe from
+   * @param {string|Array} topic - topics to unsubscribe from
    * @param {Function} [callback] - callback fired on unsuback
    * @returns {MqttClient} this - for chaining
    * @api public
diff --git a/packages/microservices/external/mqtt-options.interface.ts b/packages/microservices/external/mqtt-options.interface.ts
index 47c0d12b8..3eba9f18d 100644
--- a/packages/microservices/external/mqtt-options.interface.ts
+++ b/packages/microservices/external/mqtt-options.interface.ts
@@ -1,5 +1,7 @@
 /**
  * @see https://github.com/mqttjs/MQTT.js/
+ *
+ * @publicApi
  */
 export declare type QoS = 0 | 1 | 2;
 
diff --git a/packages/microservices/external/nats-client.interface.ts b/packages/microservices/external/nats-client.interface.ts
index b40cd679e..637883a42 100644
--- a/packages/microservices/external/nats-client.interface.ts
+++ b/packages/microservices/external/nats-client.interface.ts
@@ -1,5 +1,7 @@
 /**
  * @see https://github.com/nats-io/nats.js
+ *
+ * @publicApi
  */
 export interface NatsCodec<T> {
   encode(d: T): Uint8Array;
diff --git a/packages/microservices/external/redis.interface.ts b/packages/microservices/external/redis.interface.ts
index 00ae1bba7..506d3669c 100644
--- a/packages/microservices/external/redis.interface.ts
+++ b/packages/microservices/external/redis.interface.ts
@@ -1,383 +1,215 @@
-/* eslint-disable @typescript-eslint/adjacent-overload-signatures */
+import { ConnectionOptions } from 'tls';
 
-export interface RetryStrategyOptions {
-  error: Error;
-  total_retry_time: number;
-  times_connected: number;
-  attempt: number;
-}
+/**
+ * @see https://github.dev/luin/ioredis/blob/df04dd8d87a44d3b64b385c86581915248554508/lib/redis/RedisOptions.ts#L184
+ *
+ * @publicApi
+ */
+export interface IORedisOptions {
+  Connector?: any;
+  retryStrategy?: (times: number) => number | void | null;
+
+  /**
+   * If a command does not return a reply within a set number of milliseconds,
+   * a "Command timed out" error will be thrown.
+   */
+  commandTimeout?: number;
+  /**
+   * Enable/disable keep-alive functionality.
+   * @link https://nodejs.org/api/net.html#socketsetkeepaliveenable-initialdelay
+   * @default 0
+   */
+  keepAlive?: number;
+
+  /**
+   * Enable/disable the use of Nagle's algorithm.
+   * @link https://nodejs.org/api/net.html#socketsetnodelaynodelay
+   * @default true
+   */
+  noDelay?: boolean;
+
+  /**
+   * Set the name of the connection to make it easier to identity the connection
+   * in client list.
+   * @link https://redis.io/commands/client-setname
+   */
+  connectionName?: string;
+
+  /**
+   * If set, client will send AUTH command with the value of this option as the first argument when connected.
+   * This is supported since Redis 6.
+   */
+  username?: string;
 
-export interface ClientOpts {
-  auth_pass?: string;
-  command_queue_high_water?: number;
-  command_queue_low_water?: number;
-  connect_timeout?: number;
-  db?: string;
-  detect_buffers?: boolean;
-  disable_resubscribing?: boolean;
-  enable_offline_queue?: boolean;
-  family?: string;
-  host?: string;
-  max_attempts?: number;
-  no_ready_check?: boolean;
-  parser?: string;
+  /**
+   * If set, client will send AUTH command with the value of this option when connected.
+   */
   password?: string;
-  path?: string;
-  port?: number;
-  prefix?: string;
-  rename_commands?: any;
-  retry_max_delay?: number;
-  retry_strategy?: any;
-  retry_unfulfilled_commands?: boolean;
-  return_buffers?: boolean;
-  socket_keepalive?: boolean;
-  socket_nodelay?: boolean;
-  string_numbers?: boolean;
-  tls?: any;
-  url?: string;
-}
 
-export interface RedisClient {
-  // event: connect
-  // event: error
-  // event: message
-  // event: pmessage
-  // event: subscribe
-  // event: psubscribe
-  // event: unsubscribe
-  // event: punsubscribe
+  /**
+   * Database index to use.
+   *
+   * @default 0
+   */
+  db?: number;
 
-  connected: boolean;
-  retry_delay: number;
-  retry_backoff: number;
-  command_queue: any[];
-  offline_queue: any[];
-  server_info: any;
+  /**
+   * When the client reconnects, channels subscribed in the previous connection will be
+   * resubscribed automatically if `autoResubscribe` is `true`.
+   * @default true
+   */
+  autoResubscribe?: boolean;
 
   /**
-   * Forcibly close the connection to the Redis server. Note that this does not wait until all replies have been parsed. If you want to exit cleanly, call client.quit()
+   * Whether or not to resend unfulfilled commands on reconnect.
+   * Unfulfilled commands are most likely to be blocking commands such as `brpop` or `blpop`.
+   * @default true
+   */
+  autoResendUnfulfilledCommands?: boolean;
+  /**
+   * Whether or not to reconnect on certain Redis errors.
+   * This options by default is `null`, which means it should never reconnect on Redis errors.
+   * You can pass a function that accepts an Redis error, and returns:
+   * - `true` or `1` to trigger a reconnection.
+   * - `false` or `0` to not reconnect.
+   * - `2` to reconnect and resend the failed command (who triggered the error) after reconnection.
+   * @example
+   * ```js
+   * const redis = new Redis({
+   *   reconnectOnError(err) {
+   *     const targetError = "READONLY";
+   *     if (err.message.includes(targetError)) {
+   *       // Only reconnect when the error contains "READONLY"
+   *       return true; // or `return 1;`
+   *     }
+   *   },
+   * });
+   * ```
+   * @default null
+   */
+  reconnectOnError?: ((err: Error) => boolean | 1 | 2) | null;
+
+  /**
+   * @default false
+   */
+  readOnly?: boolean;
+  /**
+   * When enabled, numbers returned by Redis will be converted to JavaScript strings instead of numbers.
+   * This is necessary if you want to handle big numbers (above `Number.MAX_SAFE_INTEGER` === 2^53).
+   * @default false
+   */
+  stringNumbers?: boolean;
+
+  /**
+   * How long the client will wait before killing a socket due to inactivity during initial connection.
+   * @default 10000
+   */
+  connectTimeout?: number;
+
+  /**
+   * This option is used internally when you call `redis.monitor()` to tell Redis
+   * to enter the monitor mode when the connection is established.
    *
-   * @param {boolean} flush You should set flush to true, if you are not absolutely sure you do not care about any other commands. If you set flush to false all still running commands will silently fail.
+   * @default false
    */
-  end(flush: boolean): void;
-  unref(): void;
+  monitor?: boolean;
 
   /**
-   * Stop sending commands and queue the commands.
+   * The commands that don't get a reply due to the connection to the server is lost are
+   * put into a queue and will be resent on reconnect (if allowed by the `retryStrategy` option).
+   * This option is used to configure how many reconnection attempts should be allowed before
+   * the queue is flushed with a `MaxRetriesPerRequestError` error.
+   * Set this options to `null` instead of a number to let commands wait forever
+   * until the connection is alive again.
+   *
+   * @default 20
    */
-  cork(): void;
+  maxRetriesPerRequest?: number | null;
 
   /**
-   * Resume and send the queued commands at once.
+   * @default 10000
    */
-  uncork(): void;
+  maxLoadingRetryTime?: number;
+  /**
+   * @default false
+   */
+  enableAutoPipelining?: boolean;
+  /**
+   * @default []
+   */
+  autoPipeliningIgnoredCommands?: string[];
+  offlineQueue?: boolean;
+  commandQueue?: boolean;
 
-  // Low level command execution
-  send_command(command: string, ...args: any[]): boolean;
+  /**
+   *
+   * By default, if the connection to Redis server has not been established, commands are added to a queue
+   * and are executed once the connection is "ready" (when `enableReadyCheck` is true, "ready" means
+   * the Redis server has loaded the database from disk, otherwise means the connection to the Redis
+   * server has been established). If this option is false, when execute the command when the connection
+   * isn't ready, an error will be returned.
+   *
+   * @default true
+   */
+  enableOfflineQueue?: boolean;
 
-  // Connection (http://redis.io/commands#connection)
-  auth(password: string, callback?: any): boolean;
-  ping(callback?: any): boolean;
+  /**
+   * The client will sent an INFO command to check whether the server is still loading data from the disk (
+   * which happens when the server is just launched) when the connection is established, and only wait until
+   * the loading process is finished before emitting the `ready` event.
+   *
+   * @default true
+   */
+  enableReadyCheck?: boolean;
 
-  // Strings (http://redis.io/commands#strings)
-  append(key: string, value: string, callback?: any): boolean;
-  bitcount(key: string, callback?: any): boolean;
-  bitcount(key: string, start: number, end: number, callback?: any): boolean;
-  set(key: string, value: string, callback?: any): boolean;
-  get(key: string, callback?: any): boolean;
-  exists(key: string, value: string, callback?: any): boolean;
+  /**
+   * When a Redis instance is initialized, a connection to the server is immediately established. Set this to
+   * true will delay the connection to the server until the first command is sent or `redis.connect()` is called
+   * explicitly.
+   *
+   * @default false
+   */
 
-  publish(channel: string, value: any): boolean;
-  subscribe(channel: string): boolean;
-  on(event: string, callback: Function): any;
-  off(event: string, callback: Function): any;
-  addListener(event: string, callback: Function): any;
+  lazyConnect?: boolean;
 
-  /*
-   commands = set_union([
-   "get", "set", "setnx", "setex", "append", "strlen", "del", "exists", "setbit", "getbit", "setrange", "getrange", "substr",
-   "incr", "decr", "mget", "rpush", "lpush", "rpushx", "lpushx", "linsert", "rpop", "lpop", "brpop", "brpoplpush", "blpop", "llen", "lindex",
-   "lset", "lrange", "ltrim", "lrem", "rpoplpush", "sadd", "srem", "smove", "sismember", "scard", "spop", "srandmember", "sinter", "sinterstore",
-   "sunion", "sunionstore", "sdiff", "sdiffstore", "smembers", "zadd", "zincrby", "zrem", "zremrangebyscore", "zremrangebyrank", "zunionstore",
-   "zinterstore", "zrange", "zrangebyscore", "zrevrangebyscore", "zcount", "zrevrange", "zcard", "zscore", "zrank", "zrevrank", "hset", "hsetnx",
-   "hget", "hmset", "hmget", "hincrby", "hincrbyfloat", "hdel", "hlen", "hkeys", "hvals", "hgetall", "hexists", "incrby", "decrby", "getset", "mset", "msetnx",
-   "randomkey", "select", "move", "rename", "renamenx", "expire", "expireat", "keys", "dbsize", "auth", "ping", "echo", "save", "bgsave",
-   "bgrewriteaof", "shutdown", "lastsave", "type", "any", "exec", "discard", "sync", "flushdb", "flushall", "sort", "info", "monitor", "ttl",
-   "persist", "slaveof", "debug", "config", "subscribe", "unsubscribe", "psubscribe", "punsubscribe", "publish", "watch", "unwatch", "cluster",
-   "restore", "migrate", "dump", "object", "client", "eval", "evalsha"], require("./lib/commands"));
+  /**
+   * @default undefined
    */
+  scripts?: Record<
+    string,
+    { lua: string; numberOfKeys?: number; readOnly?: boolean }
+  >;
 
-  get(args: any[], callback?: any): boolean;
-  get(...args: any[]): boolean;
-  set(args: any[], callback?: any): boolean;
-  set(...args: any[]): boolean;
-  setnx(args: any[], callback?: any): boolean;
-  setnx(...args: any[]): boolean;
-  setex(args: any[], callback?: any): boolean;
-  setex(...args: any[]): boolean;
-  append(args: any[], callback?: any): boolean;
-  append(...args: any[]): boolean;
-  strlen(args: any[], callback?: any): boolean;
-  strlen(...args: any[]): boolean;
-  del(args: any[], callback?: any): boolean;
-  del(...args: any[]): boolean;
-  exists(args: any[], callback?: any): boolean;
-  exists(...args: any[]): boolean;
-  setbit(args: any[], callback?: any): boolean;
-  setbit(...args: any[]): boolean;
-  getbit(args: any[], callback?: any): boolean;
-  getbit(...args: any[]): boolean;
-  setrange(args: any[], callback?: any): boolean;
-  setrange(...args: any[]): boolean;
-  getrange(args: any[], callback?: any): boolean;
-  getrange(...args: any[]): boolean;
-  substr(args: any[], callback?: any): boolean;
-  substr(...args: any[]): boolean;
-  incr(args: any[], callback?: any): boolean;
-  incr(...args: any[]): boolean;
-  decr(args: any[], callback?: any): boolean;
-  decr(...args: any[]): boolean;
-  mget(args: any[], callback?: any): boolean;
-  mget(...args: any[]): boolean;
-  rpush(...args: any[]): boolean;
-  lpush(args: any[], callback?: any): boolean;
-  lpush(...args: any[]): boolean;
-  rpushx(args: any[], callback?: any): boolean;
-  rpushx(...args: any[]): boolean;
-  lpushx(args: any[], callback?: any): boolean;
-  lpushx(...args: any[]): boolean;
-  linsert(args: any[], callback?: any): boolean;
-  linsert(...args: any[]): boolean;
-  rpop(args: any[], callback?: any): boolean;
-  rpop(...args: any[]): boolean;
-  lpop(args: any[], callback?: any): boolean;
-  lpop(...args: any[]): boolean;
-  brpop(args: any[], callback?: any): boolean;
-  brpop(...args: any[]): boolean;
-  brpoplpush(args: any[], callback?: any): boolean;
-  brpoplpush(...args: any[]): boolean;
-  blpop(args: any[], callback?: any): boolean;
-  blpop(...args: any[]): boolean;
-  llen(args: any[], callback?: any): boolean;
-  llen(...args: any[]): boolean;
-  lindex(args: any[], callback?: any): boolean;
-  lindex(...args: any[]): boolean;
-  lset(args: any[], callback?: any): boolean;
-  lset(...args: any[]): boolean;
-  lrange(args: any[], callback?: any): boolean;
-  lrange(...args: any[]): boolean;
-  ltrim(args: any[], callback?: any): boolean;
-  ltrim(...args: any[]): boolean;
-  lrem(args: any[], callback?: any): boolean;
-  lrem(...args: any[]): boolean;
-  rpoplpush(args: any[], callback?: any): boolean;
-  rpoplpush(...args: any[]): boolean;
-  sadd(args: any[], callback?: any): boolean;
-  sadd(...args: any[]): boolean;
-  srem(args: any[], callback?: any): boolean;
-  srem(...args: any[]): boolean;
-  smove(args: any[], callback?: any): boolean;
-  smove(...args: any[]): boolean;
-  sismember(args: any[], callback?: any): boolean;
-  sismember(...args: any[]): boolean;
-  scard(args: any[], callback?: any): boolean;
-  scard(...args: any[]): boolean;
-  spop(args: any[], callback?: any): boolean;
-  spop(...args: any[]): boolean;
-  srandmember(args: any[], callback?: any): boolean;
-  srandmember(...args: any[]): boolean;
-  sinter(args: any[], callback?: any): boolean;
-  sinter(...args: any[]): boolean;
-  sinterstore(args: any[], callback?: any): boolean;
-  sinterstore(...args: any[]): boolean;
-  sunion(args: any[], callback?: any): boolean;
-  sunion(...args: any[]): boolean;
-  sunionstore(args: any[], callback?: any): boolean;
-  sunionstore(...args: any[]): boolean;
-  sdiff(args: any[], callback?: any): boolean;
-  sdiff(...args: any[]): boolean;
-  sdiffstore(args: any[], callback?: any): boolean;
-  sdiffstore(...args: any[]): boolean;
-  smembers(args: any[], callback?: any): boolean;
-  smembers(...args: any[]): boolean;
-  zadd(args: any[], callback?: any): boolean;
-  zadd(...args: any[]): boolean;
-  zincrby(args: any[], callback?: any): boolean;
-  zincrby(...args: any[]): boolean;
-  zrem(args: any[], callback?: any): boolean;
-  zrem(...args: any[]): boolean;
-  zremrangebyscore(args: any[], callback?: any): boolean;
-  zremrangebyscore(...args: any[]): boolean;
-  zremrangebyrank(args: any[], callback?: any): boolean;
-  zremrangebyrank(...args: any[]): boolean;
-  zunionstore(args: any[], callback?: any): boolean;
-  zunionstore(...args: any[]): boolean;
-  zinterstore(args: any[], callback?: any): boolean;
-  zinterstore(...args: any[]): boolean;
-  zrange(args: any[], callback?: any): boolean;
-  zrange(...args: any[]): boolean;
-  zrangebyscore(args: any[], callback?: any): boolean;
-  zrangebyscore(...args: any[]): boolean;
-  zrevrangebyscore(args: any[], callback?: any): boolean;
-  zrevrangebyscore(...args: any[]): boolean;
-  zcount(args: any[], callback?: any): boolean;
-  zcount(...args: any[]): boolean;
-  zrevrange(args: any[], callback?: any): boolean;
-  zrevrange(...args: any[]): boolean;
-  zcard(args: any[], callback?: any): boolean;
-  zcard(...args: any[]): boolean;
-  zscore(args: any[], callback?: any): boolean;
-  zscore(...args: any[]): boolean;
-  zrank(args: any[], callback?: any): boolean;
-  zrank(...args: any[]): boolean;
-  zrevrank(args: any[], callback?: any): boolean;
-  zrevrank(...args: any[]): boolean;
-  hset(args: any[], callback?: any): boolean;
-  hset(...args: any[]): boolean;
-  hsetnx(args: any[], callback?: any): boolean;
-  hsetnx(...args: any[]): boolean;
-  hget(args: any[], callback?: any): boolean;
-  hget(...args: any[]): boolean;
-  hmset(args: any[], callback?: any): boolean;
-  hmset(key: string, hash: any, callback?: any): boolean;
-  hmset(...args: any[]): boolean;
-  hmget(args: any[], callback?: any): boolean;
-  hmget(...args: any[]): boolean;
-  hincrby(args: any[], callback?: any): boolean;
-  hincrby(...args: any[]): boolean;
-  hincrbyfloat(args: any[], callback?: any): boolean;
-  hincrbyfloat(...args: any[]): boolean;
-  hdel(args: any[], callback?: any): boolean;
-  hdel(...args: any[]): boolean;
-  hlen(args: any[], callback?: any): boolean;
-  hlen(...args: any[]): boolean;
-  hkeys(args: any[], callback?: any): boolean;
-  hkeys(...args: any[]): boolean;
-  hvals(args: any[], callback?: any): boolean;
-  hvals(...args: any[]): boolean;
-  hgetall(args: any[], callback?: any): boolean;
-  hgetall(...args: any[]): boolean;
-  hgetall(key: string, callback?: any): boolean;
-  hexists(args: any[], callback?: any): boolean;
-  hexists(...args: any[]): boolean;
-  incrby(args: any[], callback?: any): boolean;
-  incrby(...args: any[]): boolean;
-  decrby(args: any[], callback?: any): boolean;
-  decrby(...args: any[]): boolean;
-  getset(args: any[], callback?: any): boolean;
-  getset(...args: any[]): boolean;
-  mset(args: any[], callback?: any): boolean;
-  mset(...args: any[]): boolean;
-  msetnx(args: any[], callback?: any): boolean;
-  msetnx(...args: any[]): boolean;
-  randomkey(args: any[], callback?: any): boolean;
-  randomkey(...args: any[]): boolean;
-  select(args: any[], callback?: any): void;
-  select(...args: any[]): void;
-  move(args: any[], callback?: any): boolean;
-  move(...args: any[]): boolean;
-  rename(args: any[], callback?: any): boolean;
-  rename(...args: any[]): boolean;
-  renamenx(args: any[], callback?: any): boolean;
-  renamenx(...args: any[]): boolean;
-  expire(args: any[], callback?: any): boolean;
-  expire(...args: any[]): boolean;
-  expireat(args: any[], callback?: any): boolean;
-  expireat(...args: any[]): boolean;
-  keys(args: any[], callback?: any): boolean;
-  keys(...args: any[]): boolean;
-  dbsize(args: any[], callback?: any): boolean;
-  dbsize(...args: any[]): boolean;
-  auth(args: any[], callback?: any): void;
-  auth(...args: any[]): void;
-  ping(args: any[], callback?: any): boolean;
-  ping(...args: any[]): boolean;
-  echo(args: any[], callback?: any): boolean;
-  echo(...args: any[]): boolean;
-  save(args: any[], callback?: any): boolean;
-  save(...args: any[]): boolean;
-  bgsave(args: any[], callback?: any): boolean;
-  bgsave(...args: any[]): boolean;
-  bgrewriteaof(args: any[], callback?: any): boolean;
-  bgrewriteaof(...args: any[]): boolean;
-  shutdown(args: any[], callback?: any): boolean;
-  shutdown(...args: any[]): boolean;
-  lastsave(args: any[], callback?: any): boolean;
-  lastsave(...args: any[]): boolean;
-  type(args: any[], callback?: any): boolean;
-  type(...args: any[]): boolean;
-  any(args: any[], callback?: any): any;
-  any(...args: any[]): any;
-  exec(args: any[], callback?: any): boolean;
-  exec(...args: any[]): boolean;
-  discard(args: any[], callback?: any): boolean;
-  discard(...args: any[]): boolean;
-  sync(args: any[], callback?: any): boolean;
-  sync(...args: any[]): boolean;
-  flushdb(args: any[], callback?: any): boolean;
-  flushdb(...args: any[]): boolean;
-  flushall(args: any[], callback?: any): boolean;
-  flushall(...args: any[]): boolean;
-  sort(args: any[], callback?: any): boolean;
-  sort(...args: any[]): boolean;
-  info(args: any[], callback?: any): boolean;
-  info(...args: any[]): boolean;
-  monitor(args: any[], callback?: any): boolean;
-  monitor(...args: any[]): boolean;
-  ttl(args: any[], callback?: any): boolean;
-  ttl(...args: any[]): boolean;
-  persist(args: any[], callback?: any): boolean;
-  persist(...args: any[]): boolean;
-  slaveof(args: any[], callback?: any): boolean;
-  slaveof(...args: any[]): boolean;
-  debug(args: any[], callback?: any): boolean;
-  debug(...args: any[]): boolean;
-  config(args: any[], callback?: any): boolean;
-  config(...args: any[]): boolean;
-  subscribe(args: any[], callback?: any): boolean;
-  subscribe(...args: any[]): boolean;
-  unsubscribe(args: any[], callback?: any): boolean;
-  unsubscribe(...args: any[]): boolean;
-  psubscribe(args: any[], callback?: any): boolean;
-  psubscribe(...args: any[]): boolean;
-  punsubscribe(args: any[], callback?: any): boolean;
-  punsubscribe(...args: any[]): boolean;
-  publish(args: any[], callback?: any): boolean;
-  publish(...args: any[]): boolean;
-  watch(args: any[], callback?: any): boolean;
-  watch(...args: any[]): boolean;
-  unwatch(args: any[], callback?: any): boolean;
-  unwatch(...args: any[]): boolean;
-  cluster(args: any[], callback?: any): boolean;
-  cluster(...args: any[]): boolean;
-  restore(args: any[], callback?: any): boolean;
-  restore(...args: any[]): boolean;
-  migrate(args: any[], callback?: any): boolean;
-  migrate(...args: any[]): boolean;
-  dump(args: any[], callback?: any): boolean;
-  dump(...args: any[]): boolean;
-  object(args: any[], callback?: any): boolean;
-  object(...args: any[]): boolean;
-  client(args: any[], callback?: any): boolean;
-  client(...args: any[]): boolean;
-  eval(args: any[], callback?: any): boolean;
-  eval(...args: any[]): boolean;
-  evalsha(args: any[], callback?: any): boolean;
-  evalsha(...args: any[]): boolean;
-  script(args: any[], callback?: any): boolean;
-  script(...args: any[]): boolean;
-  script(key: string, callback?: any): boolean;
-  quit(args: any[], callback?: any): boolean;
-  quit(...args: any[]): boolean;
-  sscan(...args: any[]): boolean;
-  sscan(args: any[], callback?: any): boolean;
-  scan(...args: any[]): boolean;
-  scan(args: any[], callback?: any): boolean;
-  hscan(...args: any[]): boolean;
-  hscan(args: any[], callback?: any): boolean;
-  zscan(...args: any[]): boolean;
-  zscan(args: any[], callback?: any): boolean;
+  keyPrefix?: string;
+  showFriendlyErrorStack?: boolean;
 
-  // Extras
-  duplicate(options?: any[], callback?: any): RedisClient;
+  // StandaloneConnectionOptions
+  disconnectTimeout?: number;
+  tls?: ConnectionOptions;
+
+  // SentinelConnectionOptions
+  /**
+   * Master group name of the Sentinel
+   */
+  name?: string;
+  /**
+   * @default "master"
+   */
+  role?: 'master' | 'slave';
+  sentinelUsername?: string;
+  sentinelPassword?: string;
+  sentinels?: Array<Partial<any>>;
+  sentinelRetryStrategy?: (retryAttempts: number) => number | void | null;
+  sentinelReconnectStrategy?: (retryAttempts: number) => number | void | null;
+  preferredSlaves?: any;
+  sentinelCommandTimeout?: number;
+  enableTLSForSentinelMode?: boolean;
+  sentinelTLS?: ConnectionOptions;
+  natMap?: any;
+  updateSentinels?: boolean;
+  /**
+   * @default 10
+   */
+  sentinelMaxConnections?: number;
+  failoverDetector?: boolean;
 }
diff --git a/packages/microservices/external/rmq-url.interface.ts b/packages/microservices/external/rmq-url.interface.ts
index c19501e59..9899d2a93 100644
--- a/packages/microservices/external/rmq-url.interface.ts
+++ b/packages/microservices/external/rmq-url.interface.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export interface RmqUrl {
   protocol?: string;
   hostname?: string;
@@ -10,6 +13,9 @@ export interface RmqUrl {
   vhost?: string;
 }
 
+/**
+ * @publicApi
+ */
 export interface AmqpConnectionManagerSocketOptions {
   reconnectTimeInSeconds?: number;
   heartbeatIntervalInSeconds?: number;
@@ -17,6 +23,9 @@ export interface AmqpConnectionManagerSocketOptions {
   connectionOptions?: any;
 }
 
+/**
+ * @publicApi
+ */
 export interface AmqplibQueueOptions {
   durable?: boolean;
   autoDelete?: boolean;
diff --git a/packages/microservices/helpers/index.ts b/packages/microservices/helpers/index.ts
index a02fe778e..ff6118b51 100644
--- a/packages/microservices/helpers/index.ts
+++ b/packages/microservices/helpers/index.ts
@@ -2,3 +2,4 @@ export * from './json-socket';
 export * from './kafka-logger';
 export * from './kafka-parser';
 export * from './kafka-reply-partition-assigner';
+export * from './tcp-socket';
diff --git a/packages/microservices/helpers/json-socket.ts b/packages/microservices/helpers/json-socket.ts
index 0320e0dbc..5d017f9b5 100644
--- a/packages/microservices/helpers/json-socket.ts
+++ b/packages/microservices/helpers/json-socket.ts
@@ -1,83 +1,29 @@
-import { Socket } from 'net';
+import { Buffer } from 'buffer';
 import { StringDecoder } from 'string_decoder';
-import {
-  CLOSE_EVENT,
-  CONNECT_EVENT,
-  DATA_EVENT,
-  ERROR_EVENT,
-  MESSAGE_EVENT,
-} from '../constants';
 import { CorruptedPacketLengthException } from '../errors/corrupted-packet-length.exception';
-import { InvalidJSONFormatException } from '../errors/invalid-json-format.exception';
-import { NetSocketClosedException } from '../errors/net-socket-closed.exception';
+import { TcpSocket } from './tcp-socket';
 
-export class JsonSocket {
+export class JsonSocket extends TcpSocket {
   private contentLength: number | null = null;
-  private isClosed = false;
   private buffer = '';
 
   private readonly stringDecoder = new StringDecoder();
-  private readonly delimeter = '#';
+  private readonly delimiter = '#';
 
-  public get netSocket() {
-    return this.socket;
-  }
-
-  constructor(public readonly socket: Socket) {
-    this.socket.on(DATA_EVENT, this.onData.bind(this));
-    this.socket.on(CONNECT_EVENT, () => (this.isClosed = false));
-    this.socket.on(CLOSE_EVENT, () => (this.isClosed = true));
-    this.socket.on(ERROR_EVENT, () => (this.isClosed = true));
-  }
-
-  public connect(port: number, host: string) {
-    this.socket.connect(port, host);
-    return this;
-  }
-
-  public on(event: string, callback: (err?: any) => void) {
-    this.socket.on(event, callback);
-    return this;
-  }
-
-  public once(event: string, callback: (err?: any) => void) {
-    this.socket.once(event, callback);
-    return this;
-  }
-
-  public end() {
-    this.socket.end();
-    return this;
-  }
-
-  public sendMessage(message: any, callback?: (err?: any) => void) {
-    if (this.isClosed) {
-      callback && callback(new NetSocketClosedException());
-      return;
-    }
+  protected handleSend(message: any, callback?: (err?: any) => void) {
     this.socket.write(this.formatMessageData(message), 'utf-8', callback);
   }
 
-  private onData(dataRaw: Buffer | string) {
+  protected handleData(dataRaw: Buffer | string) {
     const data = Buffer.isBuffer(dataRaw)
       ? this.stringDecoder.write(dataRaw)
       : dataRaw;
-
-    try {
-      this.handleData(data);
-    } catch (e) {
-      this.socket.emit(ERROR_EVENT, e.message);
-      this.socket.end();
-    }
-  }
-
-  private handleData(data: string) {
     this.buffer += data;
 
     if (this.contentLength == null) {
-      const i = this.buffer.indexOf(this.delimeter);
+      const i = this.buffer.indexOf(this.delimiter);
       /**
-       * Check if the buffer has the delimeter (#),
+       * Check if the buffer has the delimiter (#),
        * if not, the end of the buffer string might be in the middle of a content length string
        */
       if (i !== -1) {
@@ -95,36 +41,27 @@ export class JsonSocket {
 
     if (this.contentLength !== null) {
       const length = this.buffer.length;
-
       if (length === this.contentLength) {
         this.handleMessage(this.buffer);
       } else if (length > this.contentLength) {
         const message = this.buffer.substring(0, this.contentLength);
         const rest = this.buffer.substring(this.contentLength);
         this.handleMessage(message);
-        this.onData(rest);
+        this.handleData(rest);
       }
     }
   }
 
-  private handleMessage(data: string) {
+  private handleMessage(message: any) {
     this.contentLength = null;
     this.buffer = '';
-
-    let message: Record<string, unknown>;
-    try {
-      message = JSON.parse(data);
-    } catch (e) {
-      throw new InvalidJSONFormatException(e, data);
-    }
-    message = message || {};
-    this.socket.emit(MESSAGE_EVENT, message);
+    this.emitMessage(message);
   }
 
   private formatMessageData(message: any) {
     const messageData = JSON.stringify(message);
     const length = messageData.length;
-    const data = length + this.delimeter + messageData;
+    const data = length + this.delimiter + messageData;
     return data;
   }
 }
diff --git a/packages/microservices/helpers/kafka-parser.ts b/packages/microservices/helpers/kafka-parser.ts
index 781217ff8..61056e7c1 100644
--- a/packages/microservices/helpers/kafka-parser.ts
+++ b/packages/microservices/helpers/kafka-parser.ts
@@ -9,22 +9,28 @@ export class KafkaParser {
   }
 
   public parse<T = any>(data: any): T {
+    // Clone object to as modifying the original one would break KafkaJS retries
+    const result = {
+      ...data,
+      headers: { ...data.headers },
+    };
+
     if (!this.keepBinary) {
-      data.value = this.decode(data.value);
+      result.value = this.decode(data.value);
     }
 
     if (!isNil(data.key)) {
-      data.key = this.decode(data.key);
+      result.key = this.decode(data.key);
     }
     if (!isNil(data.headers)) {
       const decodeHeaderByKey = (key: string) => {
-        data.headers[key] = this.decode(data.headers[key]);
+        result.headers[key] = this.decode(data.headers[key]);
       };
       Object.keys(data.headers).forEach(decodeHeaderByKey);
     } else {
-      data.headers = {};
+      result.headers = {};
     }
-    return data;
+    return result;
   }
 
   public decode(value: Buffer): object | string | null | Buffer {
diff --git a/packages/microservices/helpers/tcp-socket.ts b/packages/microservices/helpers/tcp-socket.ts
new file mode 100644
index 000000000..cca8fe94d
--- /dev/null
+++ b/packages/microservices/helpers/tcp-socket.ts
@@ -0,0 +1,78 @@
+import { Buffer } from 'buffer';
+import { Socket } from 'net';
+import {
+  CLOSE_EVENT,
+  CONNECT_EVENT,
+  DATA_EVENT,
+  ERROR_EVENT,
+  MESSAGE_EVENT,
+} from '../constants';
+import { NetSocketClosedException } from '../errors/net-socket-closed.exception';
+import { InvalidJSONFormatException } from '../errors/invalid-json-format.exception';
+
+export abstract class TcpSocket {
+  private isClosed = false;
+
+  public get netSocket() {
+    return this.socket;
+  }
+
+  constructor(public readonly socket: Socket) {
+    this.socket.on(DATA_EVENT, this.onData.bind(this));
+    this.socket.on(CONNECT_EVENT, () => (this.isClosed = false));
+    this.socket.on(CLOSE_EVENT, () => (this.isClosed = true));
+    this.socket.on(ERROR_EVENT, () => (this.isClosed = true));
+  }
+
+  public connect(port: number, host: string) {
+    this.socket.connect(port, host);
+    return this;
+  }
+
+  public on(event: string, callback: (err?: any) => void) {
+    this.socket.on(event, callback);
+    return this;
+  }
+
+  public once(event: string, callback: (err?: any) => void) {
+    this.socket.once(event, callback);
+    return this;
+  }
+
+  public end() {
+    this.socket.end();
+    return this;
+  }
+
+  public sendMessage(message: any, callback?: (err?: any) => void) {
+    if (this.isClosed) {
+      callback && callback(new NetSocketClosedException());
+      return;
+    }
+    this.handleSend(message, callback);
+  }
+
+  protected abstract handleSend(message: any, callback?: (err?: any) => void);
+
+  private onData(data: Buffer) {
+    try {
+      this.handleData(data);
+    } catch (e) {
+      this.socket.emit(ERROR_EVENT, e.message);
+      this.socket.end();
+    }
+  }
+
+  protected abstract handleData(data: Buffer | string);
+
+  protected emitMessage(data: string) {
+    let message: Record<string, unknown>;
+    try {
+      message = JSON.parse(data);
+    } catch (e) {
+      throw new InvalidJSONFormatException(e, data);
+    }
+    message = message || {};
+    this.socket.emit(MESSAGE_EVENT, message);
+  }
+}
diff --git a/packages/microservices/index.ts b/packages/microservices/index.ts
index 81f4992ef..bf44f34f7 100644
--- a/packages/microservices/index.ts
+++ b/packages/microservices/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @microservices
- * Copyright(c) 2017 - 2021 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2023 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
diff --git a/packages/microservices/interfaces/client-grpc.interface.ts b/packages/microservices/interfaces/client-grpc.interface.ts
index ebb73f466..95815ef0f 100644
--- a/packages/microservices/interfaces/client-grpc.interface.ts
+++ b/packages/microservices/interfaces/client-grpc.interface.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export interface ClientGrpc {
   getService<T extends {}>(name: string): T;
   getClientByServiceName<T = any>(name: string): T;
diff --git a/packages/microservices/interfaces/client-metadata.interface.ts b/packages/microservices/interfaces/client-metadata.interface.ts
index 4962eecc1..53bb8b556 100644
--- a/packages/microservices/interfaces/client-metadata.interface.ts
+++ b/packages/microservices/interfaces/client-metadata.interface.ts
@@ -1,5 +1,6 @@
 import { Type } from '@nestjs/common';
 import { ClientProxy } from '../client';
+import { TcpSocket } from '../helpers';
 import { Transport } from '../enums/transport.enum';
 import { Deserializer } from './deserializer.interface';
 import {
@@ -11,6 +12,7 @@ import {
   RmqOptions,
 } from './microservice-configuration.interface';
 import { Serializer } from './serializer.interface';
+import { ConnectionOptions } from 'tls';
 
 export type ClientOptions =
   | RedisOptions
@@ -21,11 +23,17 @@ export type ClientOptions =
   | TcpClientOptions
   | RmqOptions;
 
+/**
+ * @publicApi
+ */
 export interface CustomClientOptions {
   customClass: Type<ClientProxy>;
   options?: Record<string, any>;
 }
 
+/**
+ * @publicApi
+ */
 export interface TcpClientOptions {
   transport: Transport.TCP;
   options?: {
@@ -33,5 +41,7 @@ export interface TcpClientOptions {
     port?: number;
     serializer?: Serializer;
     deserializer?: Deserializer;
+    tlsOptions?: ConnectionOptions;
+    socketClass?: Type<TcpSocket>;
   };
 }
diff --git a/packages/microservices/interfaces/custom-transport-strategy.interface.ts b/packages/microservices/interfaces/custom-transport-strategy.interface.ts
index b5d5b2760..c7b4e9e44 100644
--- a/packages/microservices/interfaces/custom-transport-strategy.interface.ts
+++ b/packages/microservices/interfaces/custom-transport-strategy.interface.ts
@@ -1,7 +1,10 @@
 import { Transport } from '../enums';
 
+/**
+ * @publicApi
+ */
 export interface CustomTransportStrategy {
-  readonly transportId?: Transport;
+  readonly transportId?: Transport | symbol;
   listen(callback: (...optionalParams: unknown[]) => any): any;
   close(): any;
 }
diff --git a/packages/microservices/interfaces/deserializer.interface.ts b/packages/microservices/interfaces/deserializer.interface.ts
index 69d3af4ad..d5529b697 100644
--- a/packages/microservices/interfaces/deserializer.interface.ts
+++ b/packages/microservices/interfaces/deserializer.interface.ts
@@ -4,6 +4,9 @@ import {
   IncomingResponse,
 } from './packet.interface';
 
+/**
+ * @publicApi
+ */
 export interface Deserializer<TInput = any, TOutput = any> {
   deserialize(
     value: TInput,
diff --git a/packages/microservices/interfaces/message-handler.interface.ts b/packages/microservices/interfaces/message-handler.interface.ts
index f93896d78..8568262d2 100644
--- a/packages/microservices/interfaces/message-handler.interface.ts
+++ b/packages/microservices/interfaces/message-handler.interface.ts
@@ -1,7 +1,16 @@
 import { Observable } from 'rxjs';
 
+/**
+ * @publicApi
+ */
 export interface MessageHandler<TInput = any, TContext = any, TResult = any> {
-  (data: TInput, ctx?: TContext): Promise<Observable<TResult>>;
-  next?: (data: TInput, ctx?: TContext) => Promise<Observable<TResult>>;
+  (data: TInput, ctx?: TContext):
+    | Promise<Observable<TResult>>
+    | Promise<TResult>;
+  next?: (
+    data: TInput,
+    ctx?: TContext,
+  ) => Promise<Observable<TResult>> | Promise<TResult>;
   isEventHandler?: boolean;
+  extras?: Record<string, any>;
 }
diff --git a/packages/microservices/interfaces/microservice-configuration.interface.ts b/packages/microservices/interfaces/microservice-configuration.interface.ts
index 9942b8b55..0f2da17d5 100644
--- a/packages/microservices/interfaces/microservice-configuration.interface.ts
+++ b/packages/microservices/interfaces/microservice-configuration.interface.ts
@@ -1,16 +1,19 @@
+import { Type } from '@nestjs/common';
+import { ConnectionOptions } from 'tls';
 import { Transport } from '../enums/transport.enum';
 import { ChannelOptions } from '../external/grpc-options.interface';
 import {
   ConsumerConfig,
   ConsumerRunConfig,
-  ConsumerSubscribeTopic,
+  ConsumerSubscribeTopics,
   KafkaConfig,
   ProducerConfig,
   ProducerRecord,
 } from '../external/kafka.interface';
 import { MqttClientOptions, QoS } from '../external/mqtt-options.interface';
-import { ClientOpts } from '../external/redis.interface';
+import { IORedisOptions } from '../external/redis.interface';
 import { RmqUrl } from '../external/rmq-url.interface';
+import { TcpSocket } from '../helpers';
 import { CustomTransportStrategy } from './custom-transport-strategy.interface';
 import { Deserializer } from './deserializer.interface';
 import { Serializer } from './serializer.interface';
@@ -25,17 +28,20 @@ export type MicroserviceOptions =
   | KafkaOptions
   | CustomStrategy;
 
+/**
+ * @publicApi
+ */
 export interface CustomStrategy {
   strategy: CustomTransportStrategy;
   options?: {};
 }
 
+/**
+ * @publicApi
+ */
 export interface GrpcOptions {
   transport?: Transport.GRPC;
   options: {
-    interceptors?: Array<
-      (options: any, nextCall: (options: any) => any) => any
-    >;
     url?: string;
     maxSendMessageLength?: number;
     maxReceiveMessageLength?: number;
@@ -71,6 +77,9 @@ export interface GrpcOptions {
   };
 }
 
+/**
+ * @publicApi
+ */
 export interface TcpOptions {
   transport?: Transport.TCP;
   options?: {
@@ -79,21 +88,34 @@ export interface TcpOptions {
     retryAttempts?: number;
     retryDelay?: number;
     serializer?: Serializer;
+    tlsOptions?: ConnectionOptions;
     deserializer?: Deserializer;
+    socketClass?: Type<TcpSocket>;
   };
 }
 
+/**
+ * @publicApi
+ */
 export interface RedisOptions {
   transport?: Transport.REDIS;
   options?: {
-    url?: string;
+    host?: string;
+    port?: number;
     retryAttempts?: number;
     retryDelay?: number;
+    /**
+     * Use `psubscribe`/`pmessage` to enable wildcards in the patterns
+     */
+    wildcards?: boolean;
     serializer?: Serializer;
     deserializer?: Deserializer;
-  } & ClientOpts;
+  } & IORedisOptions;
 }
 
+/**
+ * @publicApi
+ */
 export interface MqttOptions {
   transport?: Transport.MQTT;
   options?: MqttClientOptions & {
@@ -122,6 +144,9 @@ export interface MqttOptions {
   };
 }
 
+/**
+ * @publicApi
+ */
 export interface NatsOptions {
   transport?: Transport.NATS;
   options?: {
@@ -166,6 +191,9 @@ export interface NatsOptions {
   };
 }
 
+/**
+ * @publicApi
+ */
 export interface RmqOptions {
   transport?: Transport.RMQ;
   options?: {
@@ -181,25 +209,43 @@ export interface RmqOptions {
     replyQueue?: string;
     persistent?: boolean;
     headers?: Record<string, string>;
+    noAssert?: boolean;
+    /**
+     * Maximum number of connection attempts.
+     * Applies only to the consumer configuration.
+     * -1 === infinite
+     * @default -1
+     */
+    maxConnectionAttempts?: number;
   };
 }
 
+/**
+ * @publicApi
+ */
 export interface KafkaParserConfig {
   keepBinary?: boolean;
 }
 
+/**
+ * @publicApi
+ */
 export interface KafkaOptions {
   transport?: Transport.KAFKA;
   options?: {
+    /**
+     * Defaults to `"-server"` on server side and `"-client"` on client side.
+     */
     postfixId?: string;
     client?: KafkaConfig;
     consumer?: ConsumerConfig;
     run?: Omit<ConsumerRunConfig, 'eachBatch' | 'eachMessage'>;
-    subscribe?: Omit<ConsumerSubscribeTopic, 'topic'>;
+    subscribe?: Omit<ConsumerSubscribeTopics, 'topic'>;
     producer?: ProducerConfig;
     send?: Omit<ProducerRecord, 'topic' | 'messages'>;
     serializer?: Serializer;
     deserializer?: Deserializer;
     parser?: KafkaParserConfig;
+    producerOnlyMode?: boolean;
   };
 }
diff --git a/packages/microservices/interfaces/microservice-entrypoint-metadata.interface.ts b/packages/microservices/interfaces/microservice-entrypoint-metadata.interface.ts
new file mode 100644
index 000000000..9993c7d77
--- /dev/null
+++ b/packages/microservices/interfaces/microservice-entrypoint-metadata.interface.ts
@@ -0,0 +1,9 @@
+import { Transport } from '../enums';
+import { PatternMetadata } from './pattern-metadata.interface';
+
+export type MicroserviceEntrypointMetadata = {
+  transportId: keyof typeof Transport | symbol;
+  patterns: PatternMetadata[];
+  isEventHandler: boolean;
+  extras?: Record<string, any>;
+};
diff --git a/packages/microservices/interfaces/serializer.interface.ts b/packages/microservices/interfaces/serializer.interface.ts
index 6674cd6b1..4c090467c 100644
--- a/packages/microservices/interfaces/serializer.interface.ts
+++ b/packages/microservices/interfaces/serializer.interface.ts
@@ -4,8 +4,11 @@ import {
   OutgoingResponse,
 } from './packet.interface';
 
+/**
+ * @publicApi
+ */
 export interface Serializer<TInput = any, TOutput = any> {
-  serialize(value: TInput): TOutput;
+  serialize(value: TInput, options?: Record<string, any>): TOutput;
 }
 
 export type ProducerSerializer = Serializer<
diff --git a/packages/microservices/listener-metadata-explorer.ts b/packages/microservices/listener-metadata-explorer.ts
index 322780ad5..faa98b71b 100644
--- a/packages/microservices/listener-metadata-explorer.ts
+++ b/packages/microservices/listener-metadata-explorer.ts
@@ -4,14 +4,14 @@ import { MetadataScanner } from '@nestjs/core/metadata-scanner';
 import {
   CLIENT_CONFIGURATION_METADATA,
   CLIENT_METADATA,
+  PATTERN_EXTRAS_METADATA,
   PATTERN_HANDLER_METADATA,
   PATTERN_METADATA,
   TRANSPORT_METADATA,
 } from './constants';
 import { Transport } from './enums';
 import { PatternHandler } from './enums/pattern-handler.enum';
-import { ClientOptions } from './interfaces/client-metadata.interface';
-import { PatternMetadata } from './interfaces/pattern-metadata.interface';
+import { ClientOptions, PatternMetadata } from './interfaces';
 
 export interface ClientProperties {
   property: string;
@@ -19,11 +19,12 @@ export interface ClientProperties {
 }
 
 export interface EventOrMessageListenerDefinition {
-  pattern: PatternMetadata;
+  patterns: PatternMetadata[];
   methodKey: string;
   isEventHandler: boolean;
   targetCallback: (...args: any[]) => any;
   transport?: Transport;
+  extras?: Record<string, any>;
 }
 
 export interface MessageRequestProperties {
@@ -36,12 +37,10 @@ export class ListenerMetadataExplorer {
 
   public explore(instance: Controller): EventOrMessageListenerDefinition[] {
     const instancePrototype = Object.getPrototypeOf(instance);
-    return this.metadataScanner.scanFromPrototype<
-      Controller,
-      EventOrMessageListenerDefinition
-    >(instance, instancePrototype, method =>
-      this.exploreMethodMetadata(instancePrototype, method),
-    );
+    return this.metadataScanner
+      .getAllMethodNames(instancePrototype)
+      .map(method => this.exploreMethodMetadata(instancePrototype, method))
+      .filter(metadata => metadata);
   }
 
   public exploreMethodMetadata(
@@ -56,13 +55,15 @@ export class ListenerMetadataExplorer {
     if (isUndefined(handlerType)) {
       return;
     }
-    const pattern = Reflect.getMetadata(PATTERN_METADATA, targetCallback);
+    const patterns = Reflect.getMetadata(PATTERN_METADATA, targetCallback);
     const transport = Reflect.getMetadata(TRANSPORT_METADATA, targetCallback);
+    const extras = Reflect.getMetadata(PATTERN_EXTRAS_METADATA, targetCallback);
     return {
       methodKey,
       targetCallback,
-      pattern,
+      patterns,
       transport,
+      extras,
       isEventHandler: handlerType === PatternHandler.EVENT,
     };
   }
diff --git a/packages/microservices/listeners-controller.ts b/packages/microservices/listeners-controller.ts
index 1f3c307a8..cba398269 100644
--- a/packages/microservices/listeners-controller.ts
+++ b/packages/microservices/listeners-controller.ts
@@ -11,9 +11,18 @@ import {
   InstanceWrapper,
 } from '@nestjs/core/injector/instance-wrapper';
 import { Module } from '@nestjs/core/injector/module';
+import { GraphInspector } from '@nestjs/core/inspector/graph-inspector';
 import { MetadataScanner } from '@nestjs/core/metadata-scanner';
 import { REQUEST_CONTEXT_ID } from '@nestjs/core/router/request/request-constants';
-import { connectable, Observable, Subject } from 'rxjs';
+import {
+  forkJoin,
+  from as fromPromise,
+  isObservable,
+  mergeMap,
+  Observable,
+  ObservedValueOf,
+  of,
+} from 'rxjs';
 import { IClientProxyFactory } from './client/client-proxy-factory';
 import { ClientsContainer } from './container';
 import { ExceptionFiltersContext } from './context/exception-filters-context';
@@ -24,13 +33,18 @@ import {
   DEFAULT_GRPC_CALLBACK_METADATA,
 } from './context/rpc-metadata-constants';
 import { BaseRpcContext } from './ctx-host/base-rpc.context';
+import { Transport } from './enums';
 import {
   CustomTransportStrategy,
   MessageHandler,
   PatternMetadata,
   RequestContext,
 } from './interfaces';
-import { ListenerMetadataExplorer } from './listener-metadata-explorer';
+import { MicroserviceEntrypointMetadata } from './interfaces/microservice-entrypoint-metadata.interface';
+import {
+  EventOrMessageListenerDefinition,
+  ListenerMetadataExplorer,
+} from './listener-metadata-explorer';
 import { ServerGrpc } from './server';
 import { Server } from './server/server';
 
@@ -47,6 +61,7 @@ export class ListenersController {
     private readonly injector: Injector,
     private readonly clientFactory: IClientProxyFactory,
     private readonly exceptionFiltersContext: ExceptionFiltersContext,
+    private readonly graphInspector: GraphInspector,
   ) {}
 
   public registerPatternHandlers(
@@ -71,7 +86,27 @@ export class ListenersController {
           isUndefined(server.transportId) ||
           transport === server.transportId,
       )
-      .forEach(({ pattern, targetCallback, methodKey, isEventHandler }) => {
+      .reduce((acc, handler) => {
+        handler.patterns.forEach(pattern =>
+          acc.push({ ...handler, patterns: [pattern] }),
+        );
+        return acc;
+      }, [])
+      .forEach((definition: EventOrMessageListenerDefinition) => {
+        const {
+          patterns: [pattern],
+          targetCallback,
+          methodKey,
+          extras,
+          isEventHandler,
+        } = definition;
+
+        this.insertEntrypointDefinition(
+          instanceWrapper,
+          definition,
+          server.transportId,
+        );
+
         if (isStatic) {
           const proxy = this.contextCreator.create(
             instance as object,
@@ -83,24 +118,27 @@ export class ListenersController {
             defaultCallMetadata,
           );
           if (isEventHandler) {
-            const eventHandler: MessageHandler = (...args: unknown[]) => {
+            const eventHandler: MessageHandler = async (...args: unknown[]) => {
               const originalArgs = args;
               const [dataOrContextHost] = originalArgs;
               if (dataOrContextHost instanceof RequestContextHost) {
                 args = args.slice(1, args.length);
               }
-              const originalReturnValue = proxy(...args);
-              const returnedValueWrapper = eventHandler.next?.(
-                ...(originalArgs as Parameters<MessageHandler>),
-              );
-              returnedValueWrapper?.then(returnedValue =>
-                this.connectIfStream(returnedValue as Observable<unknown>),
+              const returnValue = proxy(...args);
+              return this.forkJoinHandlersIfAttached(
+                returnValue,
+                originalArgs,
+                eventHandler,
               );
-              return originalReturnValue;
             };
-            return server.addHandler(pattern, eventHandler, isEventHandler);
+            return server.addHandler(
+              pattern,
+              eventHandler,
+              isEventHandler,
+              extras,
+            );
           } else {
-            return server.addHandler(pattern, proxy, isEventHandler);
+            return server.addHandler(pattern, proxy, isEventHandler, extras);
           }
         }
         const asyncHandler = this.createRequestScopedHandler(
@@ -110,9 +148,53 @@ export class ListenersController {
           moduleKey,
           methodKey,
           defaultCallMetadata,
+          isEventHandler,
         );
-        server.addHandler(pattern, asyncHandler, isEventHandler);
+        server.addHandler(pattern, asyncHandler, isEventHandler, extras);
+      });
+  }
+
+  public insertEntrypointDefinition(
+    instanceWrapper: InstanceWrapper,
+    definition: EventOrMessageListenerDefinition,
+    transportId: Transport | symbol,
+  ) {
+    this.graphInspector.insertEntrypointDefinition<MicroserviceEntrypointMetadata>(
+      {
+        type: 'microservice',
+        methodName: definition.methodKey,
+        className: instanceWrapper.metatype?.name,
+        classNodeId: instanceWrapper.id,
+        metadata: {
+          key: definition.patterns.toString(),
+          transportId:
+            typeof transportId === 'number'
+              ? (Transport[transportId] as keyof typeof Transport)
+              : transportId,
+          patterns: definition.patterns,
+          isEventHandler: definition.isEventHandler,
+          extras: definition.extras,
+        },
+      },
+      instanceWrapper.id,
+    );
+  }
+
+  public forkJoinHandlersIfAttached(
+    currentReturnValue: Promise<unknown> | Observable<unknown>,
+    originalArgs: unknown[],
+    handlerRef: MessageHandler,
+  ) {
+    if (handlerRef.next) {
+      const returnedValueWrapper = handlerRef.next(
+        ...(originalArgs as Parameters<MessageHandler>),
+      );
+      return forkJoin({
+        current: this.transformToObservable(currentReturnValue),
+        next: this.transformToObservable(returnedValueWrapper),
       });
+    }
+    return currentReturnValue;
   }
 
   public assignClientsToProperties(instance: Controller | Injectable) {
@@ -142,17 +224,20 @@ export class ListenersController {
     moduleKey: string,
     methodKey: string,
     defaultCallMetadata: Record<string, any> = DEFAULT_CALLBACK_METADATA,
+    isEventHandler = false,
   ) {
     const collection = moduleRef.controllers;
     const { instance } = wrapper;
 
+    const isTreeDurable = wrapper.isDependencyTreeDurable();
+
     const requestScopedHandler: MessageHandler = async (...args: unknown[]) => {
       try {
         let contextId: ContextId;
 
         let [dataOrContextHost] = args;
         if (dataOrContextHost instanceof RequestContextHost) {
-          contextId = this.getContextId(dataOrContextHost);
+          contextId = this.getContextId(dataOrContextHost, isTreeDurable);
           args.shift();
         } else {
           const [data, reqCtx] = args;
@@ -161,10 +246,10 @@ export class ListenersController {
             data,
             reqCtx as BaseRpcContext,
           );
-          contextId = this.getContextId(request);
-          this.container.registerRequestProvider(request, contextId);
+          contextId = this.getContextId(request, isTreeDurable);
           dataOrContextHost = request;
         }
+
         const contextInstance = await this.injector.loadPerContext(
           instance,
           moduleRef,
@@ -180,8 +265,16 @@ export class ListenersController {
           wrapper.id,
           defaultCallMetadata,
         );
-        requestScopedHandler.next?.(dataOrContextHost, ...args);
-        return proxy(...args);
+
+        const returnValue = proxy(...args);
+        if (isEventHandler) {
+          return this.forkJoinHandlersIfAttached(
+            returnValue,
+            [dataOrContextHost, ...args],
+            requestScopedHandler,
+          );
+        }
+        return returnValue;
       } catch (err) {
         let exceptionFilter = this.exceptionFiltersCache.get(
           instance[methodKey],
@@ -202,7 +295,10 @@ export class ListenersController {
     return requestScopedHandler;
   }
 
-  private getContextId<T extends RequestContext = any>(request: T): ContextId {
+  private getContextId<T extends RequestContext = any>(
+    request: T,
+    isTreeDurable: boolean,
+  ): ContextId {
     const contextId = ContextIdFactory.getByRequest(request);
     if (!request[REQUEST_CONTEXT_ID as any]) {
       Object.defineProperty(request, REQUEST_CONTEXT_ID, {
@@ -211,19 +307,32 @@ export class ListenersController {
         writable: false,
         configurable: false,
       });
-      this.container.registerRequestProvider(request, contextId);
+
+      const requestProviderValue = isTreeDurable ? contextId.payload : request;
+      this.container.registerRequestProvider(requestProviderValue, contextId);
     }
     return contextId;
   }
 
-  private connectIfStream(source: Observable<unknown>) {
-    if (!source) {
-      return;
+  public transformToObservable<T>(
+    resultOrDeferred: Observable<T> | Promise<T>,
+  ): Observable<T>;
+  public transformToObservable<T>(
+    resultOrDeferred: T,
+  ): never extends Observable<ObservedValueOf<T>>
+    ? Observable<T>
+    : Observable<ObservedValueOf<T>>;
+  public transformToObservable(resultOrDeferred: any) {
+    if (resultOrDeferred instanceof Promise) {
+      return fromPromise(resultOrDeferred).pipe(
+        mergeMap(val => (isObservable(val) ? val : of(val))),
+      );
     }
-    const connectableSource = connectable(source, {
-      connector: () => new Subject(),
-      resetOnDisconnect: false,
-    });
-    connectableSource.connect();
+
+    if (isObservable(resultOrDeferred)) {
+      return resultOrDeferred;
+    }
+
+    return of(resultOrDeferred);
   }
 }
diff --git a/packages/microservices/microservices-module.ts b/packages/microservices/microservices-module.ts
index 735fda9fe..3dbda4464 100644
--- a/packages/microservices/microservices-module.ts
+++ b/packages/microservices/microservices-module.ts
@@ -1,15 +1,17 @@
 import { Controller } from '@nestjs/common/interfaces/controllers/controller.interface';
+import { NestApplicationContextOptions } from '@nestjs/common/interfaces/nest-application-context-options.interface';
 import { ApplicationConfig } from '@nestjs/core/application-config';
 import { RuntimeException } from '@nestjs/core/errors/exceptions/runtime.exception';
-import { GuardsConsumer } from '@nestjs/core/guards/guards-consumer';
-import { GuardsContextCreator } from '@nestjs/core/guards/guards-context-creator';
+import { GuardsConsumer, GuardsContextCreator } from '@nestjs/core/guards';
 import { NestContainer } from '@nestjs/core/injector/container';
 import { Injector } from '@nestjs/core/injector/injector';
 import { InstanceWrapper } from '@nestjs/core/injector/instance-wrapper';
-import { InterceptorsConsumer } from '@nestjs/core/interceptors/interceptors-consumer';
-import { InterceptorsContextCreator } from '@nestjs/core/interceptors/interceptors-context-creator';
-import { PipesConsumer } from '@nestjs/core/pipes/pipes-consumer';
-import { PipesContextCreator } from '@nestjs/core/pipes/pipes-context-creator';
+import { GraphInspector } from '@nestjs/core/inspector/graph-inspector';
+import {
+  InterceptorsConsumer,
+  InterceptorsContextCreator,
+} from '@nestjs/core/interceptors';
+import { PipesConsumer, PipesContextCreator } from '@nestjs/core/pipes';
 import { ClientProxyFactory } from './client';
 import { ClientsContainer } from './container';
 import { ExceptionFiltersContext } from './context/exception-filters-context';
@@ -19,18 +21,26 @@ import { CustomTransportStrategy } from './interfaces';
 import { ListenersController } from './listeners-controller';
 import { Server } from './server/server';
 
-export class MicroservicesModule {
+export class MicroservicesModule<
+  TAppOptions extends NestApplicationContextOptions = NestApplicationContextOptions,
+> {
   private readonly clientsContainer = new ClientsContainer();
   private listenersController: ListenersController;
+  private appOptions: TAppOptions;
 
-  public register(container: NestContainer, config: ApplicationConfig) {
-    const rpcProxy = new RpcProxy();
+  public register(
+    container: NestContainer,
+    graphInspector: GraphInspector,
+    config: ApplicationConfig,
+    options: TAppOptions,
+  ) {
+    this.appOptions = options;
     const exceptionFiltersContext = new ExceptionFiltersContext(
       container,
       config,
     );
     const contextCreator = new RpcContextCreator(
-      rpcProxy,
+      new RpcProxy(),
       exceptionFiltersContext,
       new PipesContextCreator(container, config),
       new PipesConsumer(),
@@ -48,6 +58,7 @@ export class MicroservicesModule {
       injector,
       ClientProxyFactory,
       exceptionFiltersContext,
+      graphInspector,
     );
   }
 
@@ -68,6 +79,9 @@ export class MicroservicesModule {
     if (!this.listenersController) {
       throw new RuntimeException();
     }
+    if (this.appOptions?.preview) {
+      return;
+    }
     const modules = container.getModules();
     modules.forEach(({ controllers, providers }) => {
       this.bindClients(controllers);
diff --git a/packages/microservices/nest-microservice.ts b/packages/microservices/nest-microservice.ts
index be5a79c5f..7b0930e69 100644
--- a/packages/microservices/nest-microservice.ts
+++ b/packages/microservices/nest-microservice.ts
@@ -12,6 +12,8 @@ import { ApplicationConfig } from '@nestjs/core/application-config';
 import { MESSAGES } from '@nestjs/core/constants';
 import { optionalRequire } from '@nestjs/core/helpers/optional-require';
 import { NestContainer } from '@nestjs/core/injector/container';
+import { Injector } from '@nestjs/core/injector/injector';
+import { GraphInspector } from '@nestjs/core/inspector/graph-inspector';
 import { NestApplicationContext } from '@nestjs/core/nest-application-context';
 import { Transport } from './enums/transport.enum';
 import { CustomTransportStrategy } from './interfaces/custom-transport-strategy.interface';
@@ -26,10 +28,10 @@ const { SocketModule } = optionalRequire(
 );
 
 export class NestMicroservice
-  extends NestApplicationContext
+  extends NestApplicationContext<NestMicroserviceOptions>
   implements INestMicroservice
 {
-  private readonly logger = new Logger(NestMicroservice.name, {
+  protected readonly logger = new Logger(NestMicroservice.name, {
     timestamp: true,
   });
   private readonly microservicesModule = new MicroservicesModule();
@@ -42,11 +44,18 @@ export class NestMicroservice
   constructor(
     container: NestContainer,
     config: NestMicroserviceOptions & MicroserviceOptions = {},
+    private readonly graphInspector: GraphInspector,
     private readonly applicationConfig: ApplicationConfig,
   ) {
-    super(container);
-
-    this.microservicesModule.register(container, this.applicationConfig);
+    super(container, config);
+
+    this.injector = new Injector({ preview: config.preview });
+    this.microservicesModule.register(
+      container,
+      this.graphInspector,
+      this.applicationConfig,
+      this.appOptions,
+    );
     this.createServer(config);
     this.selectContextModule();
   }
@@ -69,10 +78,18 @@ export class NestMicroservice
 
   public async registerModules(): Promise<any> {
     this.socketModule &&
-      this.socketModule.register(this.container, this.applicationConfig);
-    this.microservicesModule.setupClients(this.container);
+      this.socketModule.register(
+        this.container,
+        this.applicationConfig,
+        this.graphInspector,
+        this.appOptions,
+      );
+
+    if (!this.appOptions.preview) {
+      this.microservicesModule.setupClients(this.container);
+      this.registerListeners();
+    }
 
-    this.registerListeners();
     this.setIsInitialized(true);
 
     if (!this.isInitHookCalled) {
@@ -92,21 +109,45 @@ export class NestMicroservice
 
   public useGlobalFilters(...filters: ExceptionFilter[]): this {
     this.applicationConfig.useGlobalFilters(...filters);
+    filters.forEach(item =>
+      this.graphInspector.insertOrphanedEnhancer({
+        subtype: 'filter',
+        ref: item,
+      }),
+    );
     return this;
   }
 
   public useGlobalPipes(...pipes: PipeTransform<any>[]): this {
     this.applicationConfig.useGlobalPipes(...pipes);
+    pipes.forEach(item =>
+      this.graphInspector.insertOrphanedEnhancer({
+        subtype: 'pipe',
+        ref: item,
+      }),
+    );
     return this;
   }
 
   public useGlobalInterceptors(...interceptors: NestInterceptor[]): this {
     this.applicationConfig.useGlobalInterceptors(...interceptors);
+    interceptors.forEach(item =>
+      this.graphInspector.insertOrphanedEnhancer({
+        subtype: 'interceptor',
+        ref: item,
+      }),
+    );
     return this;
   }
 
   public useGlobalGuards(...guards: CanActivate[]): this {
     this.applicationConfig.useGlobalGuards(...guards);
+    guards.forEach(item =>
+      this.graphInspector.insertOrphanedEnhancer({
+        subtype: 'guard',
+        ref: item,
+      }),
+    );
     return this;
   }
 
@@ -120,6 +161,7 @@ export class NestMicroservice
   }
 
   public async listen() {
+    this.assertNotInPreviewMode('listen');
     !this.isInitialized && (await this.registerModules());
 
     return new Promise<any>((resolve, reject) => {
@@ -136,13 +178,6 @@ export class NestMicroservice
     });
   }
 
-  public async listenAsync(): Promise<any> {
-    this.logger.warn(
-      'DEPRECATED! "listenAsync" method is deprecated and will be removed in the next major release. Please, use "listen" instead.',
-    );
-    return this.listen();
-  }
-
   public async close(): Promise<any> {
     await this.server.close();
     if (this.isTerminated) {
@@ -173,10 +208,10 @@ export class NestMicroservice
   }
 
   protected async dispose(): Promise<void> {
-    await this.server.close();
     if (this.isTerminated) {
       return;
     }
+    await this.server.close();
     this.socketModule && (await this.socketModule.close());
     this.microservicesModule && (await this.microservicesModule.close());
   }
diff --git a/packages/microservices/package.json b/packages/microservices/package.json
index 3f3a31c82..994bf9dc0 100644
--- a/packages/microservices/package.json
+++ b/packages/microservices/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/microservices",
-  "version": "8.2.3",
+  "version": "9.4.0",
   "description": "Nest - modern, fast, powerful node.js web framework (@microservices)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -18,25 +18,24 @@
   },
   "dependencies": {
     "iterare": "1.2.1",
-    "json-socket": "0.3.0",
-    "tslib": "2.3.1"
+    "tslib": "2.5.0"
   },
   "devDependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3"
+    "@nestjs/common": "9.4.0",
+    "@nestjs/core": "9.4.0"
   },
   "peerDependencies": {
     "@grpc/grpc-js": "*",
-    "@nestjs/common": "^8.0.0",
-    "@nestjs/core": "^8.0.0",
-    "@nestjs/websockets": "^8.0.0",
+    "@nestjs/common": "^9.0.0",
+    "@nestjs/core": "^9.0.0",
+    "@nestjs/websockets": "^9.0.0",
     "amqp-connection-manager": "*",
     "amqplib": "*",
     "cache-manager": "*",
+    "ioredis": "*",
     "kafkajs": "*",
     "mqtt": "*",
     "nats": "*",
-    "redis": "*",
     "reflect-metadata": "^0.1.12",
     "rxjs": "^7.1.0"
   },
@@ -59,7 +58,7 @@
     "nats": {
       "optional": true
     },
-    "redis": {
+    "ioredis": {
       "optional": true
     },
     "amqplib": {
diff --git a/packages/microservices/serializers/index.ts b/packages/microservices/serializers/index.ts
new file mode 100644
index 000000000..b58734cf1
--- /dev/null
+++ b/packages/microservices/serializers/index.ts
@@ -0,0 +1,5 @@
+export * from './identity.serializer';
+export * from './kafka-request.serializer';
+export * from './mqtt-record.serializer';
+export * from './nats-record.serializer';
+export * from './rmq-record.serializer';
diff --git a/packages/microservices/serializers/kafka-request.serializer.ts b/packages/microservices/serializers/kafka-request.serializer.ts
index cfe73b2ab..7c519c458 100644
--- a/packages/microservices/serializers/kafka-request.serializer.ts
+++ b/packages/microservices/serializers/kafka-request.serializer.ts
@@ -13,8 +13,13 @@ export interface KafkaRequest<T = any> {
   headers: Record<string, any>;
 }
 
-export class KafkaRequestSerializer implements Serializer<any, KafkaRequest> {
-  serialize(value: any): KafkaRequest {
+/**
+ * @publicApi
+ */
+export class KafkaRequestSerializer
+  implements Serializer<any, KafkaRequest | Promise<KafkaRequest>>
+{
+  serialize(value: any) {
     const isNotKafkaMessage =
       isNil(value) ||
       !isObject(value) ||
diff --git a/packages/microservices/serializers/mqtt-record.serializer.ts b/packages/microservices/serializers/mqtt-record.serializer.ts
index 18c0bb161..be482b68e 100644
--- a/packages/microservices/serializers/mqtt-record.serializer.ts
+++ b/packages/microservices/serializers/mqtt-record.serializer.ts
@@ -1,5 +1,5 @@
-import { ReadPacket } from '../interfaces';
-import { Serializer } from '../interfaces/serializer.interface';
+import { isObject } from '@nestjs/common/utils/shared.utils';
+import { ReadPacket, Serializer } from '../interfaces';
 import { MqttRecord } from '../record-builders';
 
 export class MqttRecordSerializer
@@ -8,7 +8,7 @@ export class MqttRecordSerializer
   serialize(packet: ReadPacket | any): ReadPacket & Partial<MqttRecord> {
     if (
       packet?.data &&
-      typeof packet.data === 'object' &&
+      isObject(packet.data) &&
       packet.data instanceof MqttRecord
     ) {
       const record = packet.data as MqttRecord;
diff --git a/packages/microservices/serializers/nats-record.serializer.ts b/packages/microservices/serializers/nats-record.serializer.ts
index f1dc9a8df..77f9a4bab 100644
--- a/packages/microservices/serializers/nats-record.serializer.ts
+++ b/packages/microservices/serializers/nats-record.serializer.ts
@@ -1,4 +1,5 @@
 import { loadPackage } from '@nestjs/common/utils/load-package.util';
+import { isObject } from '@nestjs/common/utils/shared.utils';
 import { NatsCodec } from '../external/nats-client.interface';
 import { ReadPacket } from '../interfaces';
 import { Serializer } from '../interfaces/serializer.interface';
@@ -20,9 +21,7 @@ export class NatsRecordSerializer
 
   serialize(packet: ReadPacket | any): NatsRecord {
     const natsMessage =
-      packet?.data &&
-      typeof packet.data === 'object' &&
-      packet.data instanceof NatsRecord
+      packet?.data && isObject(packet.data) && packet.data instanceof NatsRecord
         ? (packet.data as NatsRecord)
         : new NatsRecordBuilder(packet?.data).build();
 
diff --git a/packages/microservices/serializers/rmq-record.serializer.ts b/packages/microservices/serializers/rmq-record.serializer.ts
index 0d85426bb..8039c2f1c 100644
--- a/packages/microservices/serializers/rmq-record.serializer.ts
+++ b/packages/microservices/serializers/rmq-record.serializer.ts
@@ -1,3 +1,4 @@
+import { isObject } from '@nestjs/common/utils/shared.utils';
 import { ReadPacket } from '../interfaces';
 import { Serializer } from '../interfaces/serializer.interface';
 import { RmqRecord } from '../record-builders';
@@ -8,7 +9,7 @@ export class RmqRecordSerializer
   serialize(packet: ReadPacket | any): ReadPacket & Partial<RmqRecord> {
     if (
       packet?.data &&
-      typeof packet.data === 'object' &&
+      isObject(packet.data) &&
       packet.data instanceof RmqRecord
     ) {
       const record = packet.data as RmqRecord;
diff --git a/packages/microservices/server/server-grpc.ts b/packages/microservices/server/server-grpc.ts
index 9606765ad..e001907a0 100644
--- a/packages/microservices/server/server-grpc.ts
+++ b/packages/microservices/server/server-grpc.ts
@@ -14,10 +14,10 @@ import { GrpcMethodStreamingType } from '../decorators';
 import { Transport } from '../enums';
 import { InvalidGrpcPackageException } from '../errors/invalid-grpc-package.exception';
 import { InvalidProtoDefinitionException } from '../errors/invalid-proto-definition.exception';
+import { ChannelOptions } from '../external/grpc-options.interface';
 import { CustomTransportStrategy, MessageHandler } from '../interfaces';
 import { GrpcOptions } from '../interfaces/microservice-configuration.interface';
 import { Server } from './server';
-import { ChannelOptions } from '../external/grpc-options.interface';
 
 let grpcPackage: any = {};
 let grpcProtoLoaderPackage: any = {};
@@ -84,7 +84,7 @@ export class ServerGrpc extends Server implements CustomTransportStrategy {
 
     for (const packageName of packageNames) {
       const grpcPkg = this.lookupPackage(grpcContext, packageName);
-      await this.createServices(grpcPkg);
+      await this.createServices(grpcPkg, packageName);
     }
   }
 
@@ -220,10 +220,10 @@ export class ServerGrpc extends Server implements CustomTransportStrategy {
   public createUnaryServiceMethod(methodHandler: Function): Function {
     return async (call: GrpcCall, callback: Function) => {
       const handler = methodHandler(call.request, call.metadata, call);
-      this.transformToObservable(await handler).subscribe(
-        data => callback(null, data),
-        (err: any) => callback(err),
-      );
+      this.transformToObservable(await handler).subscribe({
+        next: data => callback(null, data),
+        error: (err: any) => callback(err),
+      });
     };
   }
 
@@ -292,7 +292,7 @@ export class ServerGrpc extends Server implements CustomTransportStrategy {
           ),
         );
 
-        if (typeof response !== 'undefined') {
+        if (!isUndefined(response)) {
           callback(null, response);
         }
       }
@@ -388,7 +388,7 @@ export class ServerGrpc extends Server implements CustomTransportStrategy {
         grpcPackage.loadPackageDefinition(packageDefinition);
       return packageObject;
     } catch (err) {
-      const invalidProtoError = new InvalidProtoDefinitionException();
+      const invalidProtoError = new InvalidProtoDefinitionException(err.path);
       const message =
         err && err.message ? err.message : invalidProtoError.message;
 
@@ -452,9 +452,9 @@ export class ServerGrpc extends Server implements CustomTransportStrategy {
     return name + '.' + key;
   }
 
-  private async createServices(grpcPkg: any) {
+  private async createServices(grpcPkg: any, packageName: string) {
     if (!grpcPkg) {
-      const invalidPackageError = new InvalidGrpcPackageException();
+      const invalidPackageError = new InvalidGrpcPackageException(packageName);
       this.logger.error(invalidPackageError.message, invalidPackageError.stack);
       throw invalidPackageError;
     }
diff --git a/packages/microservices/server/server-kafka.ts b/packages/microservices/server/server-kafka.ts
index 4715ed57a..292cbb384 100644
--- a/packages/microservices/server/server-kafka.ts
+++ b/packages/microservices/server/server-kafka.ts
@@ -1,14 +1,17 @@
 import { Logger } from '@nestjs/common/services/logger.service';
 import { isNil } from '@nestjs/common/utils/shared.utils';
-import { Observable } from 'rxjs';
+import { isObservable, lastValueFrom, Observable, ReplaySubject } from 'rxjs';
 import {
   KAFKA_DEFAULT_BROKER,
   KAFKA_DEFAULT_CLIENT,
   KAFKA_DEFAULT_GROUP,
+  NO_EVENT_HANDLER,
   NO_MESSAGE_HANDLER,
 } from '../constants';
 import { KafkaContext } from '../ctx-host';
+import { KafkaRequestDeserializer } from '../deserializers/kafka-request.deserializer';
 import { KafkaHeaders, Transport } from '../enums';
+import { KafkaRetriableException } from '../exceptions';
 import {
   BrokersFunction,
   Consumer,
@@ -26,6 +29,7 @@ import {
   CustomTransportStrategy,
   KafkaOptions,
   OutgoingResponse,
+  ReadPacket,
 } from '../interfaces';
 import { KafkaRequestSerializer } from '../serializers/kafka-request.serializer';
 import { Server } from './server';
@@ -53,7 +57,7 @@ export class ServerKafka extends Server implements CustomTransportStrategy {
     const consumerOptions =
       this.getOptionsProp(this.options, 'consumer') || ({} as ConsumerConfig);
     const postfixId =
-      this.getOptionsProp(this.options, 'postfixId') || '-server';
+      this.getOptionsProp(this.options, 'postfixId') ?? '-server';
 
     this.brokers = clientOptions.brokers || [KAFKA_DEFAULT_BROKER];
 
@@ -162,10 +166,14 @@ export class ServerKafka extends Server implements CustomTransportStrategy {
       rawMessage,
       payload.partition,
       payload.topic,
+      this.consumer,
+      payload.heartbeat,
+      this.producer,
     ]);
+    const handler = this.getHandlerByPattern(packet.pattern);
     // if the correlation id or reply topic is not set
     // then this is an event (events could still have correlation id)
-    if (!correlationId || !replyTopic) {
+    if (handler?.isEventHandler || !correlationId || !replyTopic) {
       return this.handleEvent(packet.pattern, packet, kafkaContext);
     }
 
@@ -174,7 +182,7 @@ export class ServerKafka extends Server implements CustomTransportStrategy {
       replyPartition,
       correlationId,
     );
-    const handler = this.getHandlerByPattern(packet.pattern);
+
     if (!handler) {
       return publish({
         id: correlationId,
@@ -183,18 +191,50 @@ export class ServerKafka extends Server implements CustomTransportStrategy {
     }
 
     const response$ = this.transformToObservable(
-      await handler(packet.data, kafkaContext),
-    ) as Observable<any>;
-    response$ && this.send(response$, publish);
+      handler(packet.data, kafkaContext),
+    );
+
+    const replayStream$ = new ReplaySubject();
+    await this.combineStreamsAndThrowIfRetriable(response$, replayStream$);
+
+    this.send(replayStream$, publish);
   }
 
-  public sendMessage(
+  private combineStreamsAndThrowIfRetriable(
+    response$: Observable<any>,
+    replayStream$: ReplaySubject<unknown>,
+  ) {
+    return new Promise<void>((resolve, reject) => {
+      let isPromiseResolved = false;
+      response$.subscribe({
+        next: val => {
+          replayStream$.next(val);
+          if (!isPromiseResolved) {
+            isPromiseResolved = true;
+            resolve();
+          }
+        },
+        error: err => {
+          if (err instanceof KafkaRetriableException && !isPromiseResolved) {
+            isPromiseResolved = true;
+            reject(err);
+          } else {
+            resolve();
+          }
+          replayStream$.error(err);
+        },
+        complete: () => replayStream$.complete(),
+      });
+    });
+  }
+
+  public async sendMessage(
     message: OutgoingResponse,
     replyTopic: string,
     replyPartition: string,
     correlationId: string,
   ): Promise<RecordMetadata[]> {
-    const outgoingMessage = this.serializer.serialize(message.response);
+    const outgoingMessage = await this.serializer.serialize(message.response);
     this.assignReplyPartition(replyPartition, outgoingMessage);
     this.assignCorrelationIdHeader(correlationId, outgoingMessage);
     this.assignErrorHeader(message, outgoingMessage);
@@ -227,9 +267,12 @@ export class ServerKafka extends Server implements CustomTransportStrategy {
     if (!outgoingResponse.err) {
       return;
     }
-    outgoingMessage.headers[KafkaHeaders.NEST_ERR] = Buffer.from(
-      outgoingResponse.err,
-    );
+    const stringifiedError =
+      typeof outgoingResponse.err === 'object'
+        ? JSON.stringify(outgoingResponse.err)
+        : outgoingResponse.err;
+    outgoingMessage.headers[KafkaHeaders.NEST_ERR] =
+      Buffer.from(stringifiedError);
   }
 
   public assignCorrelationIdHeader(
@@ -250,8 +293,27 @@ export class ServerKafka extends Server implements CustomTransportStrategy {
     outgoingMessage.partition = parseFloat(replyPartition);
   }
 
+  public async handleEvent(
+    pattern: string,
+    packet: ReadPacket,
+    context: KafkaContext,
+  ): Promise<any> {
+    const handler = this.getHandlerByPattern(pattern);
+    if (!handler) {
+      return this.logger.error(NO_EVENT_HANDLER`${pattern}`);
+    }
+    const resultOrStream = await handler(packet.data, context);
+    if (isObservable(resultOrStream)) {
+      await lastValueFrom(resultOrStream);
+    }
+  }
+
   protected initializeSerializer(options: KafkaOptions['options']) {
     this.serializer =
       (options && options.serializer) || new KafkaRequestSerializer();
   }
+
+  protected initializeDeserializer(options: KafkaOptions['options']) {
+    this.deserializer = options?.deserializer ?? new KafkaRequestDeserializer();
+  }
 }
diff --git a/packages/microservices/server/server-mqtt.ts b/packages/microservices/server/server-mqtt.ts
index b57c6c519..7568e7f06 100644
--- a/packages/microservices/server/server-mqtt.ts
+++ b/packages/microservices/server/server-mqtt.ts
@@ -1,5 +1,4 @@
 import { isUndefined } from '@nestjs/common/utils/shared.utils';
-import { Observable } from 'rxjs';
 import {
   CONNECT_EVENT,
   ERROR_EVENT,
@@ -30,8 +29,9 @@ let mqttPackage: any = {};
 export class ServerMqtt extends Server implements CustomTransportStrategy {
   public readonly transportId = Transport.MQTT;
 
+  protected mqttClient: MqttClient;
+
   private readonly url: string;
-  private mqttClient: MqttClient;
 
   constructor(private readonly options: MqttOptions['options']) {
     super();
@@ -123,7 +123,7 @@ export class ServerMqtt extends Server implements CustomTransportStrategy {
     }
     const response$ = this.transformToObservable(
       await handler(packet.data, mqttContext),
-    ) as Observable<any>;
+    );
     response$ && this.send(response$, publish);
   }
 
@@ -191,18 +191,25 @@ export class ServerMqtt extends Server implements CustomTransportStrategy {
 
     for (const [key, value] of this.messageHandlers) {
       if (
-        key.indexOf(MQTT_WILDCARD_SINGLE) === -1 &&
-        key.indexOf(MQTT_WILDCARD_ALL) === -1
+        !key.includes(MQTT_WILDCARD_SINGLE) &&
+        !key.includes(MQTT_WILDCARD_ALL)
       ) {
         continue;
       }
-      if (this.matchMqttPattern(key, route)) {
+      const keyWithoutSharedPrefix = this.removeHandlerKeySharedPrefix(key);
+      if (this.matchMqttPattern(keyWithoutSharedPrefix, route)) {
         return value;
       }
     }
     return null;
   }
 
+  public removeHandlerKeySharedPrefix(handlerKey: string) {
+    return handlerKey && handlerKey.startsWith('$share')
+      ? handlerKey.split('/').slice(2).join('/')
+      : handlerKey;
+  }
+
   public getRequestPattern(pattern: string): string {
     return pattern;
   }
diff --git a/packages/microservices/server/server-nats.ts b/packages/microservices/server/server-nats.ts
index 266b96a14..73206ee77 100644
--- a/packages/microservices/server/server-nats.ts
+++ b/packages/microservices/server/server-nats.ts
@@ -1,5 +1,4 @@
-import { isUndefined } from '@nestjs/common/utils/shared.utils';
-import { Observable } from 'rxjs';
+import { isUndefined, isObject } from '@nestjs/common/utils/shared.utils';
 import { NATS_DEFAULT_URL, NO_MESSAGE_HANDLER } from '../constants';
 import { NatsContext } from '../ctx-host/nats.context';
 import { NatsRequestJSONDeserializer } from '../deserializers/nats-request-json.deserializer';
@@ -109,7 +108,7 @@ export class ServerNats extends Server implements CustomTransportStrategy {
     }
     const response$ = this.transformToObservable(
       await handler(message.data, natsCtx),
-    ) as Observable<any>;
+    );
     response$ && this.send(response$, publish);
   }
 
@@ -134,20 +133,31 @@ export class ServerNats extends Server implements CustomTransportStrategy {
   public async handleStatusUpdates(client: Client) {
     for await (const status of client.status()) {
       const data =
-        status.data && typeof status.data === 'object'
+        status.data && isObject(status.data)
           ? JSON.stringify(status.data)
           : status.data;
-      if (status.type === 'disconnect' || status.type === 'error') {
-        this.logger.error(
-          `NatsError: type: "${status.type}", data: "${data}".`,
-        );
-      } else {
-        const message = `NatsStatus: type: "${status.type}", data: "${data}".`;
-        if (status.type === 'pingTimer') {
-          this.logger.debug(message);
-        } else {
-          this.logger.log(message);
-        }
+
+      switch (status.type) {
+        case 'error':
+        case 'disconnect':
+          this.logger.error(
+            `NatsError: type: "${status.type}", data: "${data}".`,
+          );
+          break;
+
+        case 'pingTimer':
+          if (this.options.debug) {
+            this.logger.debug(
+              `NatsStatus: type: "${status.type}", data: "${data}".`,
+            );
+          }
+          break;
+
+        default:
+          this.logger.log(
+            `NatsStatus: type: "${status.type}", data: "${data}".`,
+          );
+          break;
       }
     }
   }
diff --git a/packages/microservices/server/server-redis.ts b/packages/microservices/server/server-redis.ts
index 085849d09..09c619f13 100644
--- a/packages/microservices/server/server-redis.ts
+++ b/packages/microservices/server/server-redis.ts
@@ -1,41 +1,36 @@
 import { isUndefined } from '@nestjs/common/utils/shared.utils';
-import { Observable } from 'rxjs';
 import {
-  CONNECT_EVENT,
   ERROR_EVENT,
   MESSAGE_EVENT,
   NO_MESSAGE_HANDLER,
-  REDIS_DEFAULT_URL,
+  REDIS_DEFAULT_HOST,
+  REDIS_DEFAULT_PORT,
 } from '../constants';
 import { RedisContext } from '../ctx-host';
 import { Transport } from '../enums';
 import {
-  ClientOpts,
-  RedisClient,
-  RetryStrategyOptions,
-} from '../external/redis.interface';
-import { CustomTransportStrategy, IncomingRequest } from '../interfaces';
-import { RedisOptions } from '../interfaces/microservice-configuration.interface';
+  CustomTransportStrategy,
+  IncomingRequest,
+  RedisOptions,
+} from '../interfaces';
 import { Server } from './server';
 
-let redisPackage: any = {};
+type Redis = any;
+
+let redisPackage = {} as any;
 
 export class ServerRedis extends Server implements CustomTransportStrategy {
   public readonly transportId = Transport.REDIS;
 
-  private readonly url: string;
-  private subClient: RedisClient;
-  private pubClient: RedisClient;
+  private subClient: Redis;
+  private pubClient: Redis;
   private isExplicitlyTerminated = false;
 
   constructor(private readonly options: RedisOptions['options']) {
     super();
-    this.url =
-      this.getOptionsProp(options, 'url') ||
-      (!this.getOptionsProp(options, 'host') && REDIS_DEFAULT_URL);
 
-    redisPackage = this.loadPackage('redis', ServerRedis.name, () =>
-      require('redis'),
+    redisPackage = this.loadPackage('ioredis', ServerRedis.name, () =>
+      require('ioredis'),
     );
 
     this.initializeSerializer(options);
@@ -51,6 +46,7 @@ export class ServerRedis extends Server implements CustomTransportStrategy {
 
       this.handleError(this.pubClient);
       this.handleError(this.subClient);
+
       this.start(callback);
     } catch (err) {
       callback(err);
@@ -58,18 +54,32 @@ export class ServerRedis extends Server implements CustomTransportStrategy {
   }
 
   public start(callback?: () => void) {
-    this.bindEvents(this.subClient, this.pubClient);
-    this.subClient.on(CONNECT_EVENT, callback);
+    Promise.all([this.subClient.connect(), this.pubClient.connect()])
+      .then(() => {
+        this.bindEvents(this.subClient, this.pubClient);
+        callback();
+      })
+      .catch(callback);
   }
 
-  public bindEvents(subClient: RedisClient, pubClient: RedisClient) {
-    subClient.on(MESSAGE_EVENT, this.getMessageHandler(pubClient).bind(this));
+  public bindEvents(subClient: Redis, pubClient: Redis) {
+    subClient.on(
+      this.options.wildcards ? 'pmessage' : MESSAGE_EVENT,
+      this.getMessageHandler(pubClient).bind(this),
+    );
     const subscribePatterns = [...this.messageHandlers.keys()];
     subscribePatterns.forEach(pattern => {
       const { isEventHandler } = this.messageHandlers.get(pattern);
-      subClient.subscribe(
-        isEventHandler ? pattern : this.getRequestPattern(pattern),
-      );
+
+      const channel = isEventHandler
+        ? pattern
+        : this.getRequestPattern(pattern);
+
+      if (this.options.wildcards) {
+        subClient.psubscribe(channel);
+      } else {
+        subClient.subscribe(channel);
+      }
     });
   }
 
@@ -79,26 +89,32 @@ export class ServerRedis extends Server implements CustomTransportStrategy {
     this.subClient && this.subClient.quit();
   }
 
-  public createRedisClient(): RedisClient {
-    return redisPackage.createClient({
+  public createRedisClient(): Redis {
+    return new redisPackage({
+      port: REDIS_DEFAULT_PORT,
+      host: REDIS_DEFAULT_HOST,
       ...this.getClientOptions(),
-      url: this.url,
+      lazyConnect: true,
     });
   }
 
-  public getMessageHandler(pub: RedisClient) {
-    return async (channel: string, buffer: string | any) =>
-      this.handleMessage(channel, buffer, pub);
+  public getMessageHandler(pub: Redis) {
+    return this.options.wildcards
+      ? (channel: string, pattern: string, buffer: string | any) =>
+          this.handleMessage(channel, buffer, pub, pattern)
+      : (channel: string, buffer: string | any) =>
+          this.handleMessage(channel, buffer, pub, channel);
   }
 
   public async handleMessage(
     channel: string,
     buffer: string | any,
-    pub: RedisClient,
+    pub: Redis,
+    pattern: string,
   ) {
     const rawMessage = this.parseMessage(buffer);
     const packet = await this.deserializer.deserialize(rawMessage, { channel });
-    const redisCtx = new RedisContext([channel]);
+    const redisCtx = new RedisContext([pattern]);
 
     if (isUndefined((packet as IncomingRequest).id)) {
       return this.handleEvent(channel, packet, redisCtx);
@@ -121,11 +137,11 @@ export class ServerRedis extends Server implements CustomTransportStrategy {
     }
     const response$ = this.transformToObservable(
       await handler(packet.data, redisCtx),
-    ) as Observable<any>;
+    );
     response$ && this.send(response$, publish);
   }
 
-  public getPublisher(pub: RedisClient, pattern: any, id: string) {
+  public getPublisher(pub: Redis, pattern: any, id: string) {
     return (response: any) => {
       Object.assign(response, { id });
       const outgoingResponse = this.serializer.serialize(response);
@@ -157,31 +173,25 @@ export class ServerRedis extends Server implements CustomTransportStrategy {
     stream.on(ERROR_EVENT, (err: any) => this.logger.error(err));
   }
 
-  public getClientOptions(): Partial<ClientOpts> {
-    const retry_strategy = (options: RetryStrategyOptions) =>
-      this.createRetryStrategy(options);
+  public getClientOptions(): Partial<RedisOptions['options']> {
+    const retryStrategy = (times: number) => this.createRetryStrategy(times);
 
     return {
       ...(this.options || {}),
-      retry_strategy,
+      retryStrategy,
     };
   }
 
-  public createRetryStrategy(
-    options: RetryStrategyOptions,
-  ): undefined | number | void {
-    if (options.error && (options.error as any).code === 'ECONNREFUSED') {
-      this.logger.error(`Error ECONNREFUSED: ${this.url}`);
-    }
+  public createRetryStrategy(times: number): undefined | number | void {
     if (this.isExplicitlyTerminated) {
       return undefined;
     }
     if (
       !this.getOptionsProp(this.options, 'retryAttempts') ||
-      options.attempt > this.getOptionsProp(this.options, 'retryAttempts')
+      times > this.getOptionsProp(this.options, 'retryAttempts')
     ) {
-      this.logger.error(`Retry time exhausted: ${this.url}`);
-      throw new Error('Retry time exhausted');
+      this.logger.error(`Retry time exhausted`);
+      return;
     }
     return this.getOptionsProp(this.options, 'retryDelay') || 0;
   }
diff --git a/packages/microservices/server/server-rmq.ts b/packages/microservices/server/server-rmq.ts
index d6645ba73..7827c8c7a 100644
--- a/packages/microservices/server/server-rmq.ts
+++ b/packages/microservices/server/server-rmq.ts
@@ -3,14 +3,16 @@ import {
   isString,
   isUndefined,
 } from '@nestjs/common/utils/shared.utils';
-import { Observable } from 'rxjs';
 import {
+  CONNECTION_FAILED_MESSAGE,
   CONNECT_EVENT,
+  CONNECT_FAILED_EVENT,
   DISCONNECTED_RMQ_MESSAGE,
   DISCONNECT_EVENT,
   NO_MESSAGE_HANDLER,
   RQM_DEFAULT_IS_GLOBAL_PREFETCH_COUNT,
   RQM_DEFAULT_NOACK,
+  RQM_DEFAULT_NO_ASSERT,
   RQM_DEFAULT_PREFETCH_COUNT,
   RQM_DEFAULT_QUEUE,
   RQM_DEFAULT_QUEUE_OPTIONS,
@@ -29,16 +31,20 @@ import { Server } from './server';
 
 let rqmPackage: any = {};
 
+const INFINITE_CONNECTION_ATTEMPTS = -1;
+
 export class ServerRMQ extends Server implements CustomTransportStrategy {
   public readonly transportId = Transport.RMQ;
 
   protected server: any = null;
   protected channel: any = null;
+  protected connectionAttempts = 0;
   protected readonly urls: string[] | RmqUrl[];
   protected readonly queue: string;
   protected readonly prefetchCount: number;
   protected readonly queueOptions: any;
   protected readonly isGlobalPrefetchCount: boolean;
+  protected readonly noAssert: boolean;
 
   constructor(protected readonly options: RmqOptions['options']) {
     super();
@@ -54,6 +60,8 @@ export class ServerRMQ extends Server implements CustomTransportStrategy {
     this.queueOptions =
       this.getOptionsProp(this.options, 'queueOptions') ||
       RQM_DEFAULT_QUEUE_OPTIONS;
+    this.noAssert =
+      this.getOptionsProp(this.options, 'noAssert') || RQM_DEFAULT_NO_ASSERT;
 
     this.loadPackage('amqplib', ServerRMQ.name, () => require('amqplib'));
     rqmPackage = this.loadPackage(
@@ -81,7 +89,9 @@ export class ServerRMQ extends Server implements CustomTransportStrategy {
     this.server && this.server.close();
   }
 
-  public async start(callback?: () => void) {
+  public async start(
+    callback?: (err?: unknown, ...optionalParams: unknown[]) => void,
+  ) {
     this.server = this.createClient();
     this.server.on(CONNECT_EVENT, () => {
       if (this.channel) {
@@ -92,10 +102,33 @@ export class ServerRMQ extends Server implements CustomTransportStrategy {
         setup: (channel: any) => this.setupChannel(channel, callback),
       });
     });
+
+    const maxConnectionAttempts = this.getOptionsProp(
+      this.options,
+      'maxConnectionAttempts',
+      INFINITE_CONNECTION_ATTEMPTS,
+    );
     this.server.on(DISCONNECT_EVENT, (err: any) => {
       this.logger.error(DISCONNECTED_RMQ_MESSAGE);
       this.logger.error(err);
     });
+    this.server.on(CONNECT_FAILED_EVENT, (error: Record<string, unknown>) => {
+      this.logger.error(CONNECTION_FAILED_MESSAGE);
+      if (error?.err) {
+        this.logger.error(error.err);
+      }
+      const isReconnecting = !!this.channel;
+      if (
+        maxConnectionAttempts === INFINITE_CONNECTION_ATTEMPTS ||
+        isReconnecting
+      ) {
+        return;
+      }
+      if (++this.connectionAttempts === maxConnectionAttempts) {
+        this.close();
+        callback?.(error.err ?? new Error(CONNECTION_FAILED_MESSAGE));
+      }
+    });
   }
 
   public createClient<T = any>(): T {
@@ -110,7 +143,9 @@ export class ServerRMQ extends Server implements CustomTransportStrategy {
   public async setupChannel(channel: any, callback: Function) {
     const noAck = this.getOptionsProp(this.options, 'noAck', RQM_DEFAULT_NOACK);
 
-    await channel.assertQueue(this.queue, this.queueOptions);
+    if (!this.queueOptions.noAssert) {
+      await channel.assertQueue(this.queue, this.queueOptions);
+    }
     await channel.prefetch(this.prefetchCount, this.isGlobalPrefetchCount);
     channel.consume(
       this.queue,
@@ -130,8 +165,8 @@ export class ServerRMQ extends Server implements CustomTransportStrategy {
       return;
     }
     const { content, properties } = message;
-    const rawMessage = JSON.parse(content.toString());
-    const packet = await this.deserializer.deserialize(rawMessage);
+    const rawMessage = this.parseMessageContent(content);
+    const packet = await this.deserializer.deserialize(rawMessage, properties);
     const pattern = isString(packet.pattern)
       ? packet.pattern
       : JSON.stringify(packet.pattern);
@@ -157,7 +192,7 @@ export class ServerRMQ extends Server implements CustomTransportStrategy {
     }
     const response$ = this.transformToObservable(
       await handler(packet.data, rmqContext),
-    ) as Observable<any>;
+    );
 
     const publish = <T>(data: T) =>
       this.sendMessage(data, properties.replyTo, properties.correlationId);
@@ -183,4 +218,12 @@ export class ServerRMQ extends Server implements CustomTransportStrategy {
   protected initializeSerializer(options: RmqOptions['options']) {
     this.serializer = options?.serializer ?? new RmqRecordSerializer();
   }
+
+  private parseMessageContent(content: Buffer) {
+    try {
+      return JSON.parse(content.toString());
+    } catch {
+      return content.toString();
+    }
+  }
 }
diff --git a/packages/microservices/server/server-tcp.ts b/packages/microservices/server/server-tcp.ts
index 0e57c73d5..655fcd003 100644
--- a/packages/microservices/server/server-tcp.ts
+++ b/packages/microservices/server/server-tcp.ts
@@ -1,7 +1,7 @@
+import { Type } from '@nestjs/common';
 import { isString, isUndefined } from '@nestjs/common/utils/shared.utils';
 import * as net from 'net';
 import { Server as NetSocket, Socket } from 'net';
-import { Observable } from 'rxjs';
 import {
   CLOSE_EVENT,
   EADDRINUSE,
@@ -14,7 +14,8 @@ import {
 } from '../constants';
 import { TcpContext } from '../ctx-host/tcp.context';
 import { Transport } from '../enums';
-import { JsonSocket } from '../helpers/json-socket';
+import { JsonSocket, TcpSocket } from '../helpers';
+import { createServer as tlsCreateServer } from 'tls';
 import {
   CustomTransportStrategy,
   IncomingRequest,
@@ -28,16 +29,22 @@ import { Server } from './server';
 export class ServerTCP extends Server implements CustomTransportStrategy {
   public readonly transportId = Transport.TCP;
 
+  protected server: NetSocket;
+
   private readonly port: number;
   private readonly host: string;
-  private server: NetSocket;
+  private readonly socketClass: Type<TcpSocket>;
   private isExplicitlyTerminated = false;
   private retryAttemptsCount = 0;
+  private tlsOptions?;
 
   constructor(private readonly options: TcpOptions['options']) {
     super();
     this.port = this.getOptionsProp(options, 'port') || TCP_DEFAULT_PORT;
     this.host = this.getOptionsProp(options, 'host') || TCP_DEFAULT_HOST;
+    this.socketClass =
+      this.getOptionsProp(options, 'socketClass') || JsonSocket;
+    this.tlsOptions = this.getOptionsProp(options, 'tlsOptions');
 
     this.init();
     this.initializeSerializer(options);
@@ -57,6 +64,7 @@ export class ServerTCP extends Server implements CustomTransportStrategy {
 
   public close() {
     this.isExplicitlyTerminated = true;
+
     this.server.close();
   }
 
@@ -68,7 +76,7 @@ export class ServerTCP extends Server implements CustomTransportStrategy {
     readSocket.on(ERROR_EVENT, this.handleError.bind(this));
   }
 
-  public async handleMessage(socket: JsonSocket, rawMessage: unknown) {
+  public async handleMessage(socket: TcpSocket, rawMessage: unknown) {
     const packet = await this.deserializer.deserialize(rawMessage);
     const pattern = !isString(packet.pattern)
       ? JSON.stringify(packet.pattern)
@@ -90,7 +98,7 @@ export class ServerTCP extends Server implements CustomTransportStrategy {
     }
     const response$ = this.transformToObservable(
       await handler(packet.data, tcpContext),
-    ) as Observable<any>;
+    );
 
     response$ &&
       this.send(response$, data => {
@@ -113,18 +121,27 @@ export class ServerTCP extends Server implements CustomTransportStrategy {
     }
     ++this.retryAttemptsCount;
     return setTimeout(
-      () => this.server.listen(this.port),
+      () => this.server.listen(this.port, this.host),
       this.getOptionsProp(this.options, 'retryDelay') || 0,
     );
   }
 
   private init() {
-    this.server = net.createServer(this.bindHandler.bind(this));
+    if (this.tlsOptions) {
+      // TLS enabled, use tls server
+      this.server = tlsCreateServer(
+        this.tlsOptions,
+        this.bindHandler.bind(this),
+      );
+    } else {
+      // TLS disabled, use net server
+      this.server = net.createServer(this.bindHandler.bind(this));
+    }
     this.server.on(ERROR_EVENT, this.handleError.bind(this));
     this.server.on(CLOSE_EVENT, this.handleClose.bind(this));
   }
 
-  private getSocketInstance(socket: Socket): JsonSocket {
-    return new JsonSocket(socket);
+  private getSocketInstance(socket: Socket): TcpSocket {
+    return new this.socketClass(socket);
   }
 }
diff --git a/packages/microservices/server/server.ts b/packages/microservices/server/server.ts
index 99025a9dd..8a88a1296 100644
--- a/packages/microservices/server/server.ts
+++ b/packages/microservices/server/server.ts
@@ -1,16 +1,17 @@
 import { Logger, LoggerService } from '@nestjs/common/services/logger.service';
 import { loadPackage } from '@nestjs/common/utils/load-package.util';
-import { isFunction } from '@nestjs/common/utils/shared.utils';
 import {
   connectable,
-  EMPTY as empty,
+  EMPTY,
   from as fromPromise,
+  isObservable,
   Observable,
+  ObservedValueOf,
   of,
   Subject,
   Subscription,
 } from 'rxjs';
-import { catchError, finalize } from 'rxjs/operators';
+import { catchError, finalize, mergeMap } from 'rxjs/operators';
 import { NO_EVENT_HANDLER } from '../constants';
 import { BaseRpcContext } from '../ctx-host/base-rpc.context';
 import { IncomingRequestDeserializer } from '../deserializers/incoming-request.deserializer';
@@ -43,9 +44,11 @@ export abstract class Server {
     pattern: any,
     callback: MessageHandler,
     isEventHandler = false,
+    extras: Record<string, any> = {},
   ) {
     const normalizedPattern = this.normalizePattern(pattern);
     callback.isEventHandler = isEventHandler;
+    callback.extras = extras;
 
     if (this.messageHandlers.has(normalizedPattern) && isEventHandler) {
       const headRef = this.messageHandlers.get(normalizedPattern);
@@ -94,7 +97,7 @@ export abstract class Server {
       .pipe(
         catchError((err: any) => {
           scheduleOnNextTick({ err });
-          return empty;
+          return EMPTY;
         }),
         finalize(() => scheduleOnNextTick({ isDisposed: true })),
       )
@@ -108,12 +111,10 @@ export abstract class Server {
   ): Promise<any> {
     const handler = this.getHandlerByPattern(pattern);
     if (!handler) {
-      return this.logger.error(
-        `${NO_EVENT_HANDLER} Event pattern: ${JSON.stringify(pattern)}.`,
-      );
+      return this.logger.error(NO_EVENT_HANDLER`${pattern}`);
     }
     const resultOrStream = await handler(packet.data, context);
-    if (this.isObservable(resultOrStream)) {
+    if (isObservable(resultOrStream)) {
       const connectableSource = connectable(resultOrStream, {
         connector: () => new Subject(),
         resetOnDisconnect: false,
@@ -122,13 +123,26 @@ export abstract class Server {
     }
   }
 
-  public transformToObservable<T = any>(resultOrDeferred: any): Observable<T> {
+  public transformToObservable<T>(
+    resultOrDeferred: Observable<T> | Promise<T>,
+  ): Observable<T>;
+  public transformToObservable<T>(
+    resultOrDeferred: T,
+  ): never extends Observable<ObservedValueOf<T>>
+    ? Observable<T>
+    : Observable<ObservedValueOf<T>>;
+  public transformToObservable(resultOrDeferred: any) {
     if (resultOrDeferred instanceof Promise) {
-      return fromPromise(resultOrDeferred);
-    } else if (!this.isObservable(resultOrDeferred)) {
-      return of(resultOrDeferred);
+      return fromPromise(resultOrDeferred).pipe(
+        mergeMap(val => (isObservable(val) ? val : of(val))),
+      );
+    }
+
+    if (isObservable(resultOrDeferred)) {
+      return resultOrDeferred;
     }
-    return resultOrDeferred;
+
+    return of(resultOrDeferred);
   }
 
   public getOptionsProp<
@@ -180,10 +194,6 @@ export abstract class Server {
       new IncomingRequestDeserializer();
   }
 
-  private isObservable(input: unknown): input is Observable<any> {
-    return input && isFunction((input as Observable<any>).subscribe);
-  }
-
   /**
    * Transforms the server Pattern to valid type and returns a route for him.
    *
diff --git a/packages/microservices/test/client/client-grpc.spec.ts b/packages/microservices/test/client/client-grpc.spec.ts
index a87b3f5ef..83699cdc2 100644
--- a/packages/microservices/test/client/client-grpc.spec.ts
+++ b/packages/microservices/test/client/client-grpc.spec.ts
@@ -129,10 +129,10 @@ describe('ClientGrpcProxy', () => {
 
       it('should call native method', () => {
         const spy = sinon.spy(obj, methodName);
-        stream$.subscribe(
-          () => ({}),
-          () => ({}),
-        );
+        stream$.subscribe({
+          next: () => ({}),
+          error: () => ({}),
+        });
 
         expect(spy.called).to.be.true;
       });
@@ -156,10 +156,10 @@ describe('ClientGrpcProxy', () => {
 
       it('should subscribe to request upstream', () => {
         const upstreamSubscribe = sinon.spy(upstream, 'subscribe');
-        stream$.subscribe(
-          () => ({}),
-          () => ({}),
-        );
+        stream$.subscribe({
+          next: () => ({}),
+          error: () => ({}),
+        });
         upstream.next({ test: true });
 
         expect(writeSpy.called).to.be.true;
@@ -201,7 +201,12 @@ describe('ClientGrpcProxy', () => {
 
       it('propagates server errors', () => {
         const err = new Error('something happened');
-        stream$.subscribe(dataSpy, errorSpy, completeSpy);
+        stream$.subscribe({
+          next: dataSpy,
+          error: errorSpy,
+          complete: completeSpy,
+        });
+
         eventCallbacks.data('a');
         eventCallbacks.data('b');
         callMock.finished = true;
@@ -219,7 +224,11 @@ describe('ClientGrpcProxy', () => {
         const grpcServerCancelErrMock = {
           details: 'Cancelled',
         };
-        const subscription = stream$.subscribe(dataSpy, errorSpy);
+        const subscription = stream$.subscribe({
+          next: dataSpy,
+          error: errorSpy,
+        });
+
         eventCallbacks.data('a');
         eventCallbacks.data('b');
         subscription.unsubscribe();
@@ -248,7 +257,15 @@ describe('ClientGrpcProxy', () => {
     });
     describe('on subscribe', () => {
       const methodName = 'm';
-      const obj = { [methodName]: callback => callback(null, {}) };
+      const obj = {
+        [methodName]: callback => {
+          callback(null, {});
+
+          return {
+            finished: true,
+          };
+        },
+      };
 
       let stream$: Observable<any>;
 
@@ -258,10 +275,10 @@ describe('ClientGrpcProxy', () => {
 
       it('should call native method', () => {
         const spy = sinon.spy(obj, methodName);
-        stream$.subscribe(
-          () => ({}),
-          () => ({}),
-        );
+        stream$.subscribe({
+          next: () => ({}),
+          error: () => ({}),
+        });
 
         expect(spy.called).to.be.true;
       });
@@ -298,16 +315,57 @@ describe('ClientGrpcProxy', () => {
 
       it('should subscribe to request upstream', () => {
         const upstreamSubscribe = sinon.spy(upstream, 'subscribe');
-        stream$.subscribe(
-          () => ({}),
-          () => ({}),
-        );
+        stream$.subscribe({
+          next: () => ({}),
+          error: () => ({}),
+        });
         upstream.next({ test: true });
 
         expect(writeSpy.called).to.be.true;
         expect(upstreamSubscribe.called).to.be.true;
       });
     });
+
+    describe('flow-control', () => {
+      it('should cancel call on client unsubscribe', () => {
+        const methodName = 'm';
+
+        const dataSpy = sinon.spy();
+        const errorSpy = sinon.spy();
+        const completeSpy = sinon.spy();
+
+        const callMock = {
+          cancel: sinon.spy(),
+          finished: false,
+        };
+
+        let handler: (error: any, data: any) => void;
+
+        const obj = {
+          [methodName]: (callback, ...args) => {
+            handler = callback;
+
+            return callMock;
+          },
+        };
+
+        const stream$ = client.createUnaryServiceMethod(obj, methodName)();
+
+        const subscription = stream$.subscribe({
+          next: dataSpy,
+          error: errorSpy,
+          complete: completeSpy,
+        });
+
+        subscription.unsubscribe();
+        handler(null, 'a');
+
+        expect(dataSpy.called).to.be.false;
+        expect(errorSpy.called).to.be.false;
+        expect(completeSpy.called).to.be.false;
+        expect(callMock.cancel.called).to.be.true;
+      });
+    });
   });
 
   describe('createClients', () => {
diff --git a/packages/microservices/test/client/client-kafka.spec.ts b/packages/microservices/test/client/client-kafka.spec.ts
index d5af20a8c..4bc9e6eca 100644
--- a/packages/microservices/test/client/client-kafka.spec.ts
+++ b/packages/microservices/test/client/client-kafka.spec.ts
@@ -11,7 +11,6 @@ import {
 } from '../../external/kafka.interface';
 
 describe('ClientKafka', () => {
-  // static
   const topic = 'test.topic';
   const partition = 0;
   const replyTopic = 'test.topic.reply';
@@ -22,8 +21,9 @@ describe('ClientKafka', () => {
   const timestamp = new Date().toISOString();
   const attributes = 1;
   const messageValue = 'test-message';
+  const heartbeat = async () => {};
+  const pause = () => () => {};
 
-  // message
   const message: KafkaMessage = {
     key: Buffer.from(key),
     offset,
@@ -33,7 +33,6 @@ describe('ClientKafka', () => {
     attributes,
   };
 
-  // deserialized message
   const deserializedMessage: any = {
     key,
     offset,
@@ -45,7 +44,6 @@ describe('ClientKafka', () => {
     partition,
   };
 
-  // payloads
   const payload: EachMessagePayload = {
     topic,
     partition,
@@ -57,6 +55,8 @@ describe('ClientKafka', () => {
       },
       message,
     ),
+    heartbeat,
+    pause,
   };
 
   const payloadDisposed: EachMessagePayload = {
@@ -72,9 +72,11 @@ describe('ClientKafka', () => {
       message,
       {
         size: 0,
-        value: { test: true },
+        value: Buffer.from(JSON.stringify({ test: true })),
       },
     ),
+    heartbeat,
+    pause,
   };
 
   const payloadError: EachMessagePayload = {
@@ -93,6 +95,8 @@ describe('ClientKafka', () => {
         value: null,
       },
     ),
+    heartbeat,
+    pause,
   };
 
   const payloadWithoutCorrelation: EachMessagePayload = {
@@ -104,6 +108,8 @@ describe('ClientKafka', () => {
       },
       message,
     ),
+    heartbeat,
+    pause,
   };
 
   // deserialized payload
@@ -118,6 +124,8 @@ describe('ClientKafka', () => {
       },
       deserializedMessage,
     ),
+    heartbeat,
+    pause,
   };
 
   const deserializedPayloadDisposed: EachMessagePayload = {
@@ -136,24 +144,8 @@ describe('ClientKafka', () => {
         value: { test: true },
       },
     ),
-  };
-
-  const deserializedPayloadError: EachMessagePayload = {
-    topic,
-    partition,
-    message: Object.assign(
-      {
-        headers: {
-          [KafkaHeaders.CORRELATION_ID]: correlationId,
-          [KafkaHeaders.NEST_ERR]: NO_MESSAGE_HANDLER,
-        },
-      },
-      deserializedMessage,
-      {
-        size: 0,
-        value: null,
-      },
-    ),
+    heartbeat,
+    pause,
   };
 
   let client: ClientKafka;
@@ -166,7 +158,7 @@ describe('ClientKafka', () => {
   let consumerStub: sinon.SinonStub;
   let producerStub: sinon.SinonStub;
   let createClientStub: sinon.SinonStub;
-  let kafkaClient;
+  let kafkaClient: any;
 
   beforeEach(() => {
     client = new ClientKafka({});
@@ -277,47 +269,97 @@ describe('ClientKafka', () => {
     let bindTopicsStub: sinon.SinonStub;
     // let handleErrorsSpy: sinon.SinonSpy;
 
-    beforeEach(() => {
-      consumerAssignmentsStub = sinon.stub(
-        client as any,
-        'consumerAssignments',
-      );
-      bindTopicsStub = sinon
-        .stub(client, 'bindTopics')
-        .callsFake(async () => {});
-    });
+    describe('consumer and producer', () => {
+      beforeEach(() => {
+        consumerAssignmentsStub = sinon.stub(
+          client as any,
+          'consumerAssignments',
+        );
+        bindTopicsStub = sinon
+          .stub(client, 'bindTopics')
+          .callsFake(async () => {});
+      });
+
+      it('should expect the connection to be created', async () => {
+        const connection = await client.connect();
 
-    it('should expect the connection to be created', async () => {
-      const connection = await client.connect();
+        expect(createClientStub.calledOnce).to.be.true;
+        expect(producerStub.calledOnce).to.be.true;
 
-      expect(createClientStub.calledOnce).to.be.true;
-      expect(producerStub.calledOnce).to.be.true;
+        expect(consumerStub.calledOnce).to.be.true;
 
-      expect(consumerStub.calledOnce).to.be.true;
+        expect(on.calledOnce).to.be.true;
+        expect(client['consumerAssignments']).to.be.empty;
 
-      expect(on.calledOnce).to.be.true;
-      expect(client['consumerAssignments']).to.be.empty;
+        expect(connect.calledTwice).to.be.true;
 
-      expect(connect.calledTwice).to.be.true;
+        expect(bindTopicsStub.calledOnce).to.be.true;
+        expect(connection).to.deep.equal(producerStub());
+      });
 
-      expect(bindTopicsStub.calledOnce).to.be.true;
-      expect(connection).to.deep.equal(producerStub());
+      it('should expect the connection to be reused', async () => {
+        (client as any).initialized = Promise.resolve({});
+
+        await client.connect();
+
+        expect(createClientStub.calledOnce).to.be.false;
+        expect(producerStub.calledOnce).to.be.false;
+        expect(consumerStub.calledOnce).to.be.false;
+
+        expect(on.calledOnce).to.be.false;
+        expect(client['consumerAssignments']).to.be.empty;
+
+        expect(connect.calledTwice).to.be.false;
+
+        expect(bindTopicsStub.calledOnce).to.be.false;
+      });
     });
 
-    it('should expect the connection to be reused', async () => {
-      (client as any).client = kafkaClient;
-      await client.connect();
+    describe('producer only mode', () => {
+      beforeEach(() => {
+        consumerAssignmentsStub = sinon.stub(
+          client as any,
+          'consumerAssignments',
+        );
+        bindTopicsStub = sinon
+          .stub(client, 'bindTopics')
+          .callsFake(async () => {});
+        client['producerOnlyMode'] = true;
+      });
 
-      expect(createClientStub.calledOnce).to.be.false;
-      expect(producerStub.calledOnce).to.be.false;
-      expect(consumerStub.calledOnce).to.be.false;
+      it('should expect the connection to be created', async () => {
+        const connection = await client.connect();
 
-      expect(on.calledOnce).to.be.false;
-      expect(client['consumerAssignments']).to.be.empty;
+        expect(createClientStub.calledOnce).to.be.true;
+        expect(producerStub.calledOnce).to.be.true;
 
-      expect(connect.calledTwice).to.be.false;
+        expect(consumerStub.calledOnce).to.be.false;
 
-      expect(bindTopicsStub.calledOnce).to.be.false;
+        expect(on.calledOnce).to.be.false;
+        expect(client['consumerAssignments']).to.be.empty;
+
+        expect(connect.calledOnce).to.be.true;
+
+        expect(bindTopicsStub.calledOnce).to.be.false;
+        expect(connection).to.deep.equal(producerStub());
+      });
+
+      it('should expect the connection to be reused', async () => {
+        (client as any).initialized = Promise.resolve({});
+
+        await client.connect();
+
+        expect(createClientStub.calledOnce).to.be.false;
+        expect(producerStub.calledOnce).to.be.false;
+        expect(consumerStub.calledOnce).to.be.false;
+
+        expect(on.calledOnce).to.be.false;
+        expect(client['consumerAssignments']).to.be.empty;
+
+        expect(connect.calledTwice).to.be.false;
+
+        expect(bindTopicsStub.calledOnce).to.be.false;
+      });
     });
   });
 
@@ -424,7 +466,7 @@ describe('ClientKafka', () => {
         expect(
           callback.calledWith({
             isDisposed: true,
-            response: payloadDisposed.message.value,
+            response: deserializedPayloadDisposed.message.value,
             err: undefined,
           }),
         ).to.be.true;
@@ -659,6 +701,12 @@ describe('ClientKafka', () => {
       );
     });
 
+    it('should remove callback from routing map when unsubscribe', async () => {
+      client['publish'](readPacket, callback)();
+      expect(client['routingMap'].has(correlationId)).to.be.false;
+      expect(client['routingMap'].size).to.eq(0);
+    });
+
     describe('on error', () => {
       let clientProducerStub: sinon.SinonStub;
       let sendStub: sinon.SinonStub;
@@ -678,10 +726,11 @@ describe('ClientKafka', () => {
       });
 
       it('should call callback', async () => {
-        await client['publish'](readPacket, callback);
-
-        expect(callback.called).to.be.true;
-        expect(callback.getCall(0).args[0].err).to.be.instanceof(Error);
+        return new Promise(async resolve => {
+          return client['publish'](readPacket, ({ err }) => resolve(err));
+        }).then(err => {
+          expect(err).to.be.instanceof(Error);
+        });
       });
     });
 
diff --git a/packages/microservices/test/client/client-mqtt.spec.ts b/packages/microservices/test/client/client-mqtt.spec.ts
index fb8250c71..b3131af73 100644
--- a/packages/microservices/test/client/client-mqtt.spec.ts
+++ b/packages/microservices/test/client/client-mqtt.spec.ts
@@ -1,5 +1,5 @@
 import { expect } from 'chai';
-import { empty } from 'rxjs';
+import { EMPTY } from 'rxjs';
 import * as sinon from 'sinon';
 import { ClientMqtt } from '../../client/client-mqtt';
 import { ERROR_EVENT } from '../../constants';
@@ -110,7 +110,7 @@ describe('ClientMqtt', () => {
       it('should unsubscribe to response pattern name', () => {
         expect(unsubscribeSpy.calledWith(channel)).to.be.true;
       });
-      it('should remove callback from routin map', () => {
+      it('should remove callback from routing map', () => {
         expect(client['routingMap'].has(id)).to.be.false;
       });
     });
@@ -311,9 +311,9 @@ describe('ClientMqtt', () => {
         on: (ev, callback) => callback(error),
         off: () => ({}),
       };
-      client
-        .mergeCloseEvent(instance as any, empty())
-        .subscribe(null, (err: any) => expect(err).to.be.eql(error));
+      client.mergeCloseEvent(instance as any, EMPTY).subscribe({
+        error: (err: any) => expect(err).to.be.eql(error),
+      });
     });
   });
   describe('handleError', () => {
diff --git a/packages/microservices/test/client/client-proxy.spec.ts b/packages/microservices/test/client/client-proxy.spec.ts
index 12080d011..ea1a912dc 100644
--- a/packages/microservices/test/client/client-proxy.spec.ts
+++ b/packages/microservices/test/client/client-proxy.spec.ts
@@ -96,12 +96,12 @@ describe('ClientProxy', function () {
           throw new Error();
         });
         const stream$ = client.send({ test: 3 }, 'test');
-        stream$.subscribe(
-          () => {},
-          err => {
+        stream$.subscribe({
+          next: () => {},
+          error: err => {
             expect(err).to.be.instanceof(Error);
           },
-        );
+        });
       });
     });
     describe('when is connected', () => {
@@ -142,12 +142,12 @@ describe('ClientProxy', function () {
           throw new Error();
         });
         const stream$ = client.emit({ test: 3 }, 'test');
-        stream$.subscribe(
-          () => {},
-          err => {
+        stream$.subscribe({
+          next: () => {},
+          error: err => {
             expect(err).to.be.instanceof(Error);
           },
-        );
+        });
       });
     });
     describe('when is connected', () => {
diff --git a/packages/microservices/test/client/client-redis.spec.ts b/packages/microservices/test/client/client-redis.spec.ts
index 8045f90a5..b7fb3ec5e 100644
--- a/packages/microservices/test/client/client-redis.spec.ts
+++ b/packages/microservices/test/client/client-redis.spec.ts
@@ -1,9 +1,7 @@
 import { expect } from 'chai';
-import { Subject } from 'rxjs';
 import * as sinon from 'sinon';
 import { ClientRedis } from '../../client/client-redis';
 import { ERROR_EVENT } from '../../constants';
-import { Client } from '../../external/nats-client.interface';
 
 describe('ClientRedis', () => {
   const test = 'test';
@@ -252,53 +250,39 @@ describe('ClientRedis', () => {
     });
   });
   describe('getClientOptions', () => {
-    it('should return options object with "retry_strategy" and call "createRetryStrategy"', () => {
+    it('should return options object with "retryStrategy" and call "createRetryStrategy"', () => {
       const createSpy = sinon.spy(client, 'createRetryStrategy');
-      const { retry_strategy } = client.getClientOptions(new Subject());
+      const { retryStrategy } = client.getClientOptions();
       try {
-        retry_strategy({} as any);
+        retryStrategy({} as any);
       } catch {}
       expect(createSpy.called).to.be.true;
     });
   });
   describe('createRetryStrategy', () => {
-    const subject = new Subject<Error>();
     describe('when is terminated', () => {
       it('should return undefined', () => {
         (client as any).isExplicitlyTerminated = true;
-        const result = client.createRetryStrategy({} as any, subject);
+        const result = client.createRetryStrategy(0);
         expect(result).to.be.undefined;
       });
     });
     describe('when "retryAttempts" does not exist', () => {
-      it('should return an error', () => {
+      it('should return undefined', () => {
         (client as any).isExplicitlyTerminated = false;
         (client as any).options.options = {};
         (client as any).options.options.retryAttempts = undefined;
-        const result = client.createRetryStrategy({} as any, subject);
-        expect(result).to.be.instanceOf(Error);
+        const result = client.createRetryStrategy(1);
+        expect(result).to.be.undefined;
       });
     });
     describe('when "attempts" count is max', () => {
-      it('should return an error', () => {
+      it('should return undefined', () => {
         (client as any).isExplicitlyTerminated = false;
         (client as any).options.options = {};
         (client as any).options.options.retryAttempts = 3;
-        const result = client.createRetryStrategy(
-          { attempt: 4 } as any,
-          subject,
-        );
-        expect(result).to.be.instanceOf(Error);
-      });
-    });
-    describe('when ECONNREFUSED', () => {
-      it('should return error', () => {
-        (client as any).options.options = {};
-        (client as any).options.options.retryAttempts = 10;
-
-        const error = { code: 'ECONNREFUSED' };
-        const result = client.createRetryStrategy({ error } as any, subject);
-        expect(result).to.be.instanceOf(Error);
+        const result = client.createRetryStrategy(4);
+        expect(result).to.be.undefined;
       });
     });
     describe('otherwise', () => {
@@ -307,10 +291,7 @@ describe('ClientRedis', () => {
         (client as any).isExplicitlyTerminated = false;
         (client as any).options.retryAttempts = 3;
         (client as any).options.retryDelay = 3;
-        const result = client.createRetryStrategy(
-          { attempt: 2 } as any,
-          subject,
-        );
+        const result = client.createRetryStrategy(2);
         expect(result).to.be.eql((client as any).options.retryDelay);
       });
     });
diff --git a/packages/microservices/test/client/client-rmq.spec.ts b/packages/microservices/test/client/client-rmq.spec.ts
index 060865ade..6b1533d66 100644
--- a/packages/microservices/test/client/client-rmq.spec.ts
+++ b/packages/microservices/test/client/client-rmq.spec.ts
@@ -1,6 +1,6 @@
 import { expect } from 'chai';
 import { EventEmitter } from 'events';
-import { empty } from 'rxjs';
+import { EMPTY } from 'rxjs';
 import * as sinon from 'sinon';
 import { ClientRMQ } from '../../client/client-rmq';
 import { ReadPacket } from '../../interfaces';
@@ -15,7 +15,6 @@ describe('ClientRMQ', function () {
     let createClientStub: sinon.SinonStub;
     let handleErrorsSpy: sinon.SinonSpy;
     let connect$Stub: sinon.SinonStub;
-    let mergeDisconnectEvent: sinon.SinonStub;
 
     beforeEach(async () => {
       client = new ClientRMQ({});
@@ -33,7 +32,7 @@ describe('ClientRMQ', function () {
           return this;
         },
       }));
-      mergeDisconnectEvent = sinon
+      sinon
         .stub(client, 'mergeDisconnectEvent')
         .callsFake((_, source) => source);
     });
@@ -164,8 +163,8 @@ describe('ClientRMQ', function () {
         off: () => ({}),
       };
       client
-        .mergeDisconnectEvent(instance as any, empty())
-        .subscribe(null, (err: any) => expect(err).to.be.eql(error));
+        .mergeDisconnectEvent(instance as any, EMPTY)
+        .subscribe({ error: (err: any) => expect(err).to.be.eql(error) });
     });
   });
 
@@ -173,7 +172,7 @@ describe('ClientRMQ', function () {
     const pattern = 'test';
     let msg: ReadPacket;
     let connectSpy: sinon.SinonSpy,
-      sendToQueueSpy: sinon.SinonSpy,
+      sendToQueueStub: sinon.SinonStub,
       eventSpy: sinon.SinonSpy;
 
     beforeEach(() => {
@@ -181,10 +180,10 @@ describe('ClientRMQ', function () {
       msg = { pattern, data: 'data' };
       connectSpy = sinon.spy(client, 'connect');
       eventSpy = sinon.spy();
-      sendToQueueSpy = sinon.spy();
+      sendToQueueStub = sinon.stub().callsFake(() => ({ catch: sinon.spy() }));
 
       client['channel'] = {
-        sendToQueue: sendToQueueSpy,
+        sendToQueue: sendToQueueStub,
       };
       client['responseEmitter'] = new EventEmitter();
       client['responseEmitter'].on(pattern, eventSpy);
@@ -196,15 +195,15 @@ describe('ClientRMQ', function () {
 
     it('should send message to a proper queue', () => {
       client['publish'](msg, () => {
-        expect(sendToQueueSpy.called).to.be.true;
-        expect(sendToQueueSpy.getCall(0).args[0]).to.be.eql(client['queue']);
+        expect(sendToQueueStub.called).to.be.true;
+        expect(sendToQueueStub.getCall(0).args[0]).to.be.eql(client['queue']);
       });
     });
 
     it('should send buffer from stringified message', () => {
       client['publish'](msg, () => {
-        expect(sendToQueueSpy.called).to.be.true;
-        expect(sendToQueueSpy.getCall(1).args[1]).to.be.eql(
+        expect(sendToQueueStub.called).to.be.true;
+        expect(sendToQueueStub.getCall(1).args[1]).to.be.eql(
           Buffer.from(JSON.stringify(msg)),
         );
       });
@@ -231,7 +230,7 @@ describe('ClientRMQ', function () {
     describe('headers', () => {
       it('should not generate headers if none are configured', () => {
         client['publish'](msg, () => {
-          expect(sendToQueueSpy.getCall(0).args[2].headers).to.be.undefined;
+          expect(sendToQueueStub.getCall(0).args[2].headers).to.be.undefined;
         });
       });
 
@@ -240,7 +239,7 @@ describe('ClientRMQ', function () {
         msg.data = new RmqRecord('data', { headers: requestHeaders });
 
         client['publish'](msg, () => {
-          expect(sendToQueueSpy.getCall(0).args[2].headers).to.eql(
+          expect(sendToQueueStub.getCall(0).args[2].headers).to.eql(
             requestHeaders,
           );
         });
@@ -254,7 +253,7 @@ describe('ClientRMQ', function () {
         msg.data = new RmqRecord('data', { headers: requestHeaders });
 
         client['publish'](msg, () => {
-          expect(sendToQueueSpy.getCall(0).args[2].headers).to.eql({
+          expect(sendToQueueStub.getCall(0).args[2].headers).to.eql({
             ...staticHeaders,
             ...requestHeaders,
           });
@@ -269,7 +268,7 @@ describe('ClientRMQ', function () {
         msg.data = new RmqRecord('data', { headers: requestHeaders });
 
         client['publish'](msg, () => {
-          expect(sendToQueueSpy.getCall(0).args[2].headers).to.eql(
+          expect(sendToQueueStub.getCall(0).args[2].headers).to.eql(
             requestHeaders,
           );
         });
diff --git a/packages/microservices/test/client/client-tcp.spec.ts b/packages/microservices/test/client/client-tcp.spec.ts
index 51cc34a54..d3b36c172 100644
--- a/packages/microservices/test/client/client-tcp.spec.ts
+++ b/packages/microservices/test/client/client-tcp.spec.ts
@@ -1,5 +1,7 @@
 import { expect } from 'chai';
 import * as sinon from 'sinon';
+import { TLSSocket } from 'tls';
+import { Socket as NetSocket } from 'net';
 import { ClientTCP } from '../../client/client-tcp';
 import { ERROR_EVENT } from '../../constants';
 
@@ -154,9 +156,16 @@ describe('ClientTCP', () => {
     });
   });
   describe('close', () => {
+    let routingMap;
+    let callback;
+
     beforeEach(() => {
+      routingMap = new Map<string, Function>();
+      callback = sinon.spy();
+      routingMap.set('some id', callback);
       (client as any).socket = socket;
       (client as any).isConnected = true;
+      (client as any).routingMap = routingMap;
       client.close();
     });
     it('should end() socket', () => {
@@ -168,6 +177,16 @@ describe('ClientTCP', () => {
     it('should set "socket" to null', () => {
       expect((client as any).socket).to.be.null;
     });
+    it('should clear out the routing map', () => {
+      expect((client as any).routingMap.size).to.be.eq(0);
+    });
+    it('should call callbacks', () => {
+      expect(
+        callback.calledWith({
+          err: sinon.match({ message: 'Connection closed' }),
+        }),
+      ).to.be.true;
+    });
   });
   describe('bindEvents', () => {
     it('should bind error event handler', () => {
@@ -197,4 +216,17 @@ describe('ClientTCP', () => {
       expect(sendMessageStub.called).to.be.true;
     });
   });
+
+  describe('tls', () => {
+    it('should upgrade to TLS', () => {
+      const client = new ClientTCP({ tlsOptions: {} });
+      console.log(client);
+      const jsonSocket = client.createSocket();
+      expect(jsonSocket.socket).instanceOf(TLSSocket);
+    });
+    it('should not upgrade to TLS, if not requested', () => {
+      const jsonSocket = new ClientTCP({}).createSocket();
+      expect(jsonSocket.socket).instanceOf(NetSocket);
+    });
+  });
 });
diff --git a/packages/microservices/test/context/rpc-context-creator.spec.ts b/packages/microservices/test/context/rpc-context-creator.spec.ts
index 6de5a5ca4..1f622a485 100644
--- a/packages/microservices/test/context/rpc-context-creator.spec.ts
+++ b/packages/microservices/test/context/rpc-context-creator.spec.ts
@@ -3,7 +3,7 @@ import { expect } from 'chai';
 import { of } from 'rxjs';
 import * as sinon from 'sinon';
 import { Injectable, UseGuards, UsePipes } from '../../../common';
-import { CUSTOM_ROUTE_AGRS_METADATA } from '../../../common/constants';
+import { CUSTOM_ROUTE_ARGS_METADATA } from '../../../common/constants';
 import { ApplicationConfig } from '../../../core/application-config';
 import { GuardsConsumer } from '../../../core/guards/guards-consumer';
 import { GuardsContextCreator } from '../../../core/guards/guards-context-creator';
@@ -160,7 +160,7 @@ describe('RpcContextCreator', () => {
       const metadata = {
         [RpcParamtype.PAYLOAD]: { index: 0, data: 'test', pipes: [] },
         [RpcParamtype.CONTEXT]: { index: 2, data: 'test', pipes: [] },
-        [`key${CUSTOM_ROUTE_AGRS_METADATA}`]: {
+        [`key${CUSTOM_ROUTE_ARGS_METADATA}`]: {
           index: 3,
           data: 'custom',
           pipes: [],
@@ -177,7 +177,7 @@ describe('RpcContextCreator', () => {
       const expectedValues = [
         { index: 0, type: RpcParamtype.PAYLOAD, data: 'test' },
         { index: 2, type: RpcParamtype.CONTEXT, data: 'test' },
-        { index: 3, type: `key${CUSTOM_ROUTE_AGRS_METADATA}`, data: 'custom' },
+        { index: 3, type: `key${CUSTOM_ROUTE_ARGS_METADATA}`, data: 'custom' },
       ];
       expect(values[0]).to.deep.include(expectedValues[0]);
       expect(values[1]).to.deep.include(expectedValues[1]);
diff --git a/packages/microservices/test/context/rpc-proxy.spec.ts b/packages/microservices/test/context/rpc-proxy.spec.ts
index ffa2222bc..dbfe7f0b1 100644
--- a/packages/microservices/test/context/rpc-proxy.spec.ts
+++ b/packages/microservices/test/context/rpc-proxy.spec.ts
@@ -36,19 +36,8 @@ describe('RpcProxy', () => {
       const proxy = routerProxy.create(async (client, data) => {
         return throwError(() => new RpcException('test'));
       }, handler);
-      (await proxy(null, null)).subscribe(null, () => expectation.verify());
-    });
-  });
-
-  describe('isObservable', () => {
-    describe('when observable', () => {
-      it('should return true', () => {
-        expect(routerProxy.isObservable(of('test'))).to.be.true;
-      });
-    });
-    describe('when not observable', () => {
-      it('should return false', () => {
-        expect(routerProxy.isObservable({})).to.be.false;
+      (await proxy(null, null)).subscribe({
+        error: () => expectation.verify(),
       });
     });
   });
diff --git a/packages/microservices/test/ctx-host/kafka.context.spec.ts b/packages/microservices/test/ctx-host/kafka.context.spec.ts
index 9c0c1b312..11ba73456 100644
--- a/packages/microservices/test/ctx-host/kafka.context.spec.ts
+++ b/packages/microservices/test/ctx-host/kafka.context.spec.ts
@@ -1,13 +1,33 @@
 import { expect } from 'chai';
 import { KafkaContext } from '../../ctx-host';
-import { KafkaMessage } from '../../external/kafka.interface';
+import {
+  Consumer,
+  KafkaMessage,
+  Producer,
+} from '../../external/kafka.interface';
 
 describe('KafkaContext', () => {
-  const args = ['test', { test: true }];
+  const args = [
+    'test',
+    { test: true },
+    undefined,
+    { test: 'consumer' },
+    () => {},
+    { test: 'producer' },
+  ];
   let context: KafkaContext;
 
   beforeEach(() => {
-    context = new KafkaContext(args as [KafkaMessage, number, string]);
+    context = new KafkaContext(
+      args as [
+        KafkaMessage,
+        number,
+        string,
+        Consumer,
+        () => Promise<void>,
+        Producer,
+      ],
+    );
   });
   describe('getTopic', () => {
     it('should return topic', () => {
@@ -24,4 +44,19 @@ describe('KafkaContext', () => {
       expect(context.getMessage()).to.be.eql(args[0]);
     });
   });
+  describe('getConsumer', () => {
+    it('should return consumer instance', () => {
+      expect(context.getConsumer()).to.deep.eq({ test: 'consumer' });
+    });
+  });
+  describe('getHeartbeat', () => {
+    it('should return heartbeat callback', () => {
+      expect(context.getHeartbeat()).to.be.eql(args[4]);
+    });
+  });
+  describe('getProducer', () => {
+    it('should return producer instance', () => {
+      expect(context.getProducer()).to.deep.eq({ test: 'producer' });
+    });
+  });
 });
diff --git a/packages/microservices/test/decorators/event-pattern.decorator.spec.ts b/packages/microservices/test/decorators/event-pattern.decorator.spec.ts
index d1cb0df25..3a78e602d 100644
--- a/packages/microservices/test/decorators/event-pattern.decorator.spec.ts
+++ b/packages/microservices/test/decorators/event-pattern.decorator.spec.ts
@@ -1,15 +1,182 @@
 import { expect } from 'chai';
-import { PATTERN_METADATA } from '../../constants';
+import {
+  PATTERN_EXTRAS_METADATA,
+  PATTERN_METADATA,
+  TRANSPORT_METADATA,
+} from '../../constants';
+import { Transport } from '../../enums/transport.enum';
 import { EventPattern } from '../../decorators/event-pattern.decorator';
 
 describe('@EventPattern', () => {
   const pattern = { role: 'test' };
+  const patternSecond = { role: 'test2' };
+  const patternThird = { role: 'test3' };
+  const extras = { param: 'value' };
   class TestComponent {
-    @EventPattern(pattern)
+    @EventPattern(pattern, undefined, extras)
     public static test() {}
+
+    @EventPattern(patternSecond, undefined, extras)
+    @EventPattern(patternThird, undefined, extras)
+    public static testOnlyThird() {}
+
+    @EventPattern([patternSecond, patternThird], undefined, extras)
+    public static testBoth() {}
   }
   it(`should enhance method with ${PATTERN_METADATA} metadata`, () => {
     const metadata = Reflect.getMetadata(PATTERN_METADATA, TestComponent.test);
-    expect(metadata).to.be.eql(pattern);
+    expect(metadata.length).to.equal(1);
+    expect(metadata[0]).to.be.eql(pattern);
+  });
+  it(`should enhance method with ${PATTERN_EXTRAS_METADATA} metadata`, () => {
+    const metadata = Reflect.getMetadata(
+      PATTERN_EXTRAS_METADATA,
+      TestComponent.test,
+    );
+    expect(metadata).to.be.deep.equal(extras);
+  });
+  it(`should enhance method with last ${PATTERN_METADATA} metadata`, () => {
+    const metadata = Reflect.getMetadata(
+      PATTERN_METADATA,
+      TestComponent.testOnlyThird,
+    );
+    expect(metadata.length).to.equal(1);
+    expect(metadata[0]).to.be.eql(patternSecond);
+  });
+  it(`should enhance method with both ${PATTERN_METADATA} metadata`, () => {
+    const metadata = Reflect.getMetadata(
+      PATTERN_METADATA,
+      TestComponent.testBoth,
+    );
+    expect(metadata.length).to.equal(2);
+    expect(metadata[0]).to.be.eql(patternSecond);
+    expect(metadata[1]).to.be.eql(patternThird);
+  });
+
+  describe('decorator overloads', () => {
+    const additionalExtras = { foo: 'bar' };
+
+    class TestComponent1 {
+      @EventPattern(pattern)
+      public static test() {}
+    }
+    class TestComponent2 {
+      @EventPattern(pattern, Transport.TCP)
+      public static test() {}
+    }
+    class TestComponent3 {
+      @EventPattern(pattern, extras)
+      public static test() {}
+    }
+    class TestComponent4 {
+      @EventPattern(pattern, Transport.TCP, extras)
+      public static test() {}
+    }
+    class TestComponent5 {
+      @EventPattern(pattern, Transport.TCP, extras)
+      @((
+        (): MethodDecorator => (_target, _key, descriptor) =>
+          Reflect.defineMetadata(
+            PATTERN_EXTRAS_METADATA,
+            additionalExtras,
+            descriptor.value,
+          )
+      )())
+      public static test() {}
+    }
+
+    it(`should enhance method with ${PATTERN_METADATA} metadata`, () => {
+      const [metadataArg] = Reflect.getMetadata(
+        PATTERN_METADATA,
+        TestComponent1.test,
+      );
+      const transportArg = Reflect.getMetadata(
+        TRANSPORT_METADATA,
+        TestComponent1.test,
+      );
+      const extrasArg = Reflect.getMetadata(
+        PATTERN_EXTRAS_METADATA,
+        TestComponent1.test,
+      );
+      expect(metadataArg).to.be.eql(pattern);
+      expect(transportArg).to.be.undefined;
+      expect(extrasArg).to.be.eql({});
+    });
+
+    it(`should enhance method with ${PATTERN_METADATA}, ${TRANSPORT_METADATA} metadata`, () => {
+      const [metadataArg] = Reflect.getMetadata(
+        PATTERN_METADATA,
+        TestComponent2.test,
+      );
+      const transportArg = Reflect.getMetadata(
+        TRANSPORT_METADATA,
+        TestComponent2.test,
+      );
+      const extrasArg = Reflect.getMetadata(
+        PATTERN_EXTRAS_METADATA,
+        TestComponent2.test,
+      );
+      expect(metadataArg).to.be.eql(pattern);
+      expect(transportArg).to.be.eql(Transport.TCP);
+      expect(extrasArg).to.be.eql({});
+    });
+
+    it(`should enhance method with ${PATTERN_METADATA}, ${PATTERN_EXTRAS_METADATA} metadata`, () => {
+      const [metadataArg] = Reflect.getMetadata(
+        PATTERN_METADATA,
+        TestComponent3.test,
+      );
+      const transportArg = Reflect.getMetadata(
+        TRANSPORT_METADATA,
+        TestComponent3.test,
+      );
+      const extrasArg = Reflect.getMetadata(
+        PATTERN_EXTRAS_METADATA,
+        TestComponent3.test,
+      );
+      expect(metadataArg).to.be.eql(pattern);
+      expect(transportArg).to.be.undefined;
+      expect(extrasArg).to.be.eql(extras);
+    });
+
+    it(`should enhance method with ${PATTERN_METADATA}, ${TRANSPORT_METADATA} and \
+${PATTERN_EXTRAS_METADATA} metadata`, () => {
+      const [metadataArg] = Reflect.getMetadata(
+        PATTERN_METADATA,
+        TestComponent4.test,
+      );
+      const transportArg = Reflect.getMetadata(
+        TRANSPORT_METADATA,
+        TestComponent4.test,
+      );
+      const extrasArg = Reflect.getMetadata(
+        PATTERN_EXTRAS_METADATA,
+        TestComponent4.test,
+      );
+      expect(metadataArg).to.be.eql(pattern);
+      expect(transportArg).to.be.eql(Transport.TCP);
+      expect(extrasArg).to.be.eql(extras);
+    });
+
+    it(`should merge with existing ${PATTERN_EXTRAS_METADATA} metadata`, () => {
+      const [metadataArg] = Reflect.getMetadata(
+        PATTERN_METADATA,
+        TestComponent5.test,
+      );
+      const transportArg = Reflect.getMetadata(
+        TRANSPORT_METADATA,
+        TestComponent5.test,
+      );
+      const extrasArg = Reflect.getMetadata(
+        PATTERN_EXTRAS_METADATA,
+        TestComponent5.test,
+      );
+      expect(metadataArg).to.be.eql(pattern);
+      expect(transportArg).to.be.eql(Transport.TCP);
+      expect(extrasArg).to.be.eql({
+        ...additionalExtras,
+        ...extras,
+      });
+    });
   });
 });
diff --git a/packages/microservices/test/decorators/message-pattern.decorator.spec.ts b/packages/microservices/test/decorators/message-pattern.decorator.spec.ts
index b3500e106..4980c3ff1 100644
--- a/packages/microservices/test/decorators/message-pattern.decorator.spec.ts
+++ b/packages/microservices/test/decorators/message-pattern.decorator.spec.ts
@@ -1,5 +1,10 @@
 import { expect } from 'chai';
-import { PATTERN_METADATA } from '../../constants';
+import {
+  PATTERN_METADATA,
+  PATTERN_EXTRAS_METADATA,
+  TRANSPORT_METADATA,
+} from '../../constants';
+import { Transport } from '../../enums/transport.enum';
 import {
   GrpcMethod,
   GrpcMethodStreamingType,
@@ -10,14 +15,152 @@ import {
 
 describe('@MessagePattern', () => {
   const pattern = { role: 'test' };
+  const extras = { param: 'value' };
   class TestComponent {
-    @MessagePattern(pattern)
+    @MessagePattern(pattern, undefined, extras)
     public static test() {}
   }
   it(`should enhance method with ${PATTERN_METADATA} metadata`, () => {
-    const metadata = Reflect.getMetadata(PATTERN_METADATA, TestComponent.test);
+    const [metadata] = Reflect.getMetadata(
+      PATTERN_METADATA,
+      TestComponent.test,
+    );
     expect(metadata).to.be.eql(pattern);
   });
+  it(`should enhance method with ${PATTERN_EXTRAS_METADATA} metadata`, () => {
+    const metadata = Reflect.getMetadata(
+      PATTERN_EXTRAS_METADATA,
+      TestComponent.test,
+    );
+    expect(metadata).to.be.deep.equal(extras);
+  });
+
+  describe('decorator overloads', () => {
+    const additionalExtras = { foo: 'bar' };
+
+    class TestComponent1 {
+      @MessagePattern(pattern)
+      public static test() {}
+    }
+    class TestComponent2 {
+      @MessagePattern(pattern, Transport.TCP)
+      public static test() {}
+    }
+    class TestComponent3 {
+      @MessagePattern(pattern, extras)
+      public static test() {}
+    }
+    class TestComponent4 {
+      @MessagePattern(pattern, Transport.TCP, extras)
+      public static test() {}
+    }
+    class TestComponent5 {
+      @MessagePattern(pattern, Transport.TCP, extras)
+      @((
+        (): MethodDecorator => (_target, _key, descriptor) =>
+          Reflect.defineMetadata(
+            PATTERN_EXTRAS_METADATA,
+            additionalExtras,
+            descriptor.value,
+          )
+      )())
+      public static test() {}
+    }
+
+    it(`should enhance method with ${PATTERN_METADATA} metadata`, () => {
+      const [metadataArg] = Reflect.getMetadata(
+        PATTERN_METADATA,
+        TestComponent1.test,
+      );
+      const transportArg = Reflect.getMetadata(
+        TRANSPORT_METADATA,
+        TestComponent1.test,
+      );
+      const extrasArg = Reflect.getMetadata(
+        PATTERN_EXTRAS_METADATA,
+        TestComponent1.test,
+      );
+      expect(metadataArg).to.be.eql(pattern);
+      expect(transportArg).to.be.undefined;
+      expect(extrasArg).to.be.eql({});
+    });
+
+    it(`should enhance method with ${PATTERN_METADATA}, ${TRANSPORT_METADATA} metadata`, () => {
+      const [metadataArg] = Reflect.getMetadata(
+        PATTERN_METADATA,
+        TestComponent2.test,
+      );
+      const transportArg = Reflect.getMetadata(
+        TRANSPORT_METADATA,
+        TestComponent2.test,
+      );
+      const extrasArg = Reflect.getMetadata(
+        PATTERN_EXTRAS_METADATA,
+        TestComponent2.test,
+      );
+      expect(metadataArg).to.be.eql(pattern);
+      expect(transportArg).to.be.eql(Transport.TCP);
+      expect(extrasArg).to.be.eql({});
+    });
+
+    it(`should enhance method with ${PATTERN_METADATA}, ${PATTERN_EXTRAS_METADATA} metadata`, () => {
+      const [metadataArg] = Reflect.getMetadata(
+        PATTERN_METADATA,
+        TestComponent3.test,
+      );
+      const transportArg = Reflect.getMetadata(
+        TRANSPORT_METADATA,
+        TestComponent3.test,
+      );
+      const extrasArg = Reflect.getMetadata(
+        PATTERN_EXTRAS_METADATA,
+        TestComponent3.test,
+      );
+      expect(metadataArg).to.be.eql(pattern);
+      expect(transportArg).to.be.undefined;
+      expect(extrasArg).to.be.eql(extras);
+    });
+
+    it(`should enhance method with ${PATTERN_METADATA}, ${TRANSPORT_METADATA} and \
+${PATTERN_EXTRAS_METADATA} metadata`, () => {
+      const [metadataArg] = Reflect.getMetadata(
+        PATTERN_METADATA,
+        TestComponent4.test,
+      );
+      const transportArg = Reflect.getMetadata(
+        TRANSPORT_METADATA,
+        TestComponent4.test,
+      );
+      const extrasArg = Reflect.getMetadata(
+        PATTERN_EXTRAS_METADATA,
+        TestComponent4.test,
+      );
+      expect(metadataArg).to.be.eql(pattern);
+      expect(transportArg).to.be.eql(Transport.TCP);
+      expect(extrasArg).to.be.eql(extras);
+    });
+
+    it(`should merge with existing ${PATTERN_EXTRAS_METADATA} metadata`, () => {
+      const [metadataArg] = Reflect.getMetadata(
+        PATTERN_METADATA,
+        TestComponent5.test,
+      );
+      const transportArg = Reflect.getMetadata(
+        TRANSPORT_METADATA,
+        TestComponent5.test,
+      );
+      const extrasArg = Reflect.getMetadata(
+        PATTERN_EXTRAS_METADATA,
+        TestComponent5.test,
+      );
+      expect(metadataArg).to.be.eql(pattern);
+      expect(transportArg).to.be.eql(Transport.TCP);
+      expect(extrasArg).to.be.eql({
+        ...additionalExtras,
+        ...extras,
+      });
+    });
+  });
 });
 
 describe('@GrpcMethod', () => {
@@ -34,7 +177,7 @@ describe('@GrpcMethod', () => {
 
   it('should derive method and service name', () => {
     const svc = new TestService();
-    const metadata = Reflect.getMetadata(PATTERN_METADATA, svc.test);
+    const [metadata] = Reflect.getMetadata(PATTERN_METADATA, svc.test);
     expect(metadata).to.be.eql({
       service: TestService.name,
       rpc: 'Test',
@@ -44,7 +187,7 @@ describe('@GrpcMethod', () => {
 
   it('should derive method', () => {
     const svc = new TestService();
-    const metadata = Reflect.getMetadata(PATTERN_METADATA, svc.test2);
+    const [metadata] = Reflect.getMetadata(PATTERN_METADATA, svc.test2);
     expect(metadata).to.be.eql({
       service: 'TestService2',
       rpc: 'Test2',
@@ -54,7 +197,7 @@ describe('@GrpcMethod', () => {
 
   it('should override both method and service', () => {
     const svc = new TestService();
-    const metadata = Reflect.getMetadata(PATTERN_METADATA, svc.test3);
+    const [metadata] = Reflect.getMetadata(PATTERN_METADATA, svc.test3);
     expect(metadata).to.be.eql({
       service: 'TestService2',
       rpc: 'Test2',
@@ -77,7 +220,7 @@ describe('@GrpcStreamMethod', () => {
 
   it('should derive method and service name', () => {
     const svc = new TestService();
-    const metadata = Reflect.getMetadata(PATTERN_METADATA, svc.test);
+    const [metadata] = Reflect.getMetadata(PATTERN_METADATA, svc.test);
     expect(metadata).to.be.eql({
       service: TestService.name,
       rpc: 'Test',
@@ -87,7 +230,7 @@ describe('@GrpcStreamMethod', () => {
 
   it('should derive method', () => {
     const svc = new TestService();
-    const metadata = Reflect.getMetadata(PATTERN_METADATA, svc.test2);
+    const [metadata] = Reflect.getMetadata(PATTERN_METADATA, svc.test2);
     expect(metadata).to.be.eql({
       service: 'TestService2',
       rpc: 'Test2',
@@ -97,7 +240,7 @@ describe('@GrpcStreamMethod', () => {
 
   it('should override both method and service', () => {
     const svc = new TestService();
-    const metadata = Reflect.getMetadata(PATTERN_METADATA, svc.test3);
+    const [metadata] = Reflect.getMetadata(PATTERN_METADATA, svc.test3);
     expect(metadata).to.be.eql({
       service: 'TestService2',
       rpc: 'Test2',
@@ -120,7 +263,7 @@ describe('@GrpcStreamCall', () => {
 
   it('should derive method and service name', () => {
     const svc = new TestService();
-    const metadata = Reflect.getMetadata(PATTERN_METADATA, svc.test);
+    const [metadata] = Reflect.getMetadata(PATTERN_METADATA, svc.test);
     expect(metadata).to.be.eql({
       service: TestService.name,
       rpc: 'Test',
@@ -130,7 +273,7 @@ describe('@GrpcStreamCall', () => {
 
   it('should derive method', () => {
     const svc = new TestService();
-    const metadata = Reflect.getMetadata(PATTERN_METADATA, svc.test2);
+    const [metadata] = Reflect.getMetadata(PATTERN_METADATA, svc.test2);
     expect(metadata).to.be.eql({
       service: 'TestService2',
       rpc: 'Test2',
@@ -140,7 +283,7 @@ describe('@GrpcStreamCall', () => {
 
   it('should override both method and service', () => {
     const svc = new TestService();
-    const metadata = Reflect.getMetadata(PATTERN_METADATA, svc.test3);
+    const [metadata] = Reflect.getMetadata(PATTERN_METADATA, svc.test3);
     expect(metadata).to.be.eql({
       service: 'TestService2',
       rpc: 'Test2',
diff --git a/packages/microservices/test/deserializers/kafka-response.deserializer.spec.ts b/packages/microservices/test/deserializers/kafka-response.deserializer.spec.ts
index 2941c6875..30b327642 100644
--- a/packages/microservices/test/deserializers/kafka-response.deserializer.spec.ts
+++ b/packages/microservices/test/deserializers/kafka-response.deserializer.spec.ts
@@ -26,7 +26,7 @@ describe('KafkaResponseDeserializer', () => {
       });
     });
     describe('when is disposed header is present', () => {
-      it('should return an objet with "isDisposed"', () => {
+      it('should return an object with "isDisposed"', () => {
         const value = 'test';
         const packet = instance.deserialize({
           headers: {
diff --git a/packages/microservices/test/exceptions/rpc-exceptions-handler.spec.ts b/packages/microservices/test/exceptions/rpc-exceptions-handler.spec.ts
index 9c40ca858..a3ffb69b7 100644
--- a/packages/microservices/test/exceptions/rpc-exceptions-handler.spec.ts
+++ b/packages/microservices/test/exceptions/rpc-exceptions-handler.spec.ts
@@ -1,5 +1,5 @@
 import { expect } from 'chai';
-import { EMPTY as empty, of } from 'rxjs';
+import { EMPTY, of } from 'rxjs';
 import { catchError } from 'rxjs/operators';
 import * as sinon from 'sinon';
 import { RpcException } from '../../exceptions/rpc-exception';
@@ -23,7 +23,7 @@ describe('RpcExceptionsHandler', () => {
               message: 'Internal server error',
             });
             done();
-            return empty;
+            return EMPTY;
           }),
         )
         .subscribe(() => ({}));
@@ -39,7 +39,7 @@ describe('RpcExceptionsHandler', () => {
             catchError((err: any) => {
               expect(err).to.be.eql(message);
               done();
-              return empty;
+              return EMPTY;
             }),
           )
           .subscribe(() => ({}));
@@ -53,7 +53,7 @@ describe('RpcExceptionsHandler', () => {
             catchError((err: any) => {
               expect(err).to.be.eql({ message, status: 'error' });
               done();
-              return empty;
+              return EMPTY;
             }),
           )
           .subscribe(() => ({}));
diff --git a/packages/microservices/test/helpers/kafka-parser.spec.ts b/packages/microservices/test/helpers/kafka-parser.spec.ts
index 91c698d1b..e4f8babcd 100644
--- a/packages/microservices/test/helpers/kafka-parser.spec.ts
+++ b/packages/microservices/test/helpers/kafka-parser.spec.ts
@@ -126,5 +126,35 @@ describe('KafkaParser', () => {
         },
       });
     });
+
+    it('parse message multiple times (simulate retry)', () => {
+      const message = {
+        headers: {
+          [KafkaHeaders.CORRELATION_ID]: Buffer.from('correlation-id'),
+        },
+        value: Buffer.from(JSON.stringify({ prop: 'value' })),
+        key: Buffer.from('1'),
+      };
+      const expectedParsedMessage = {
+        key: '1',
+        value: {
+          prop: 'value',
+        },
+        headers: {
+          [KafkaHeaders.CORRELATION_ID]: 'correlation-id',
+        },
+      };
+      expect(kafkaParser.parse(message)).to.deep.eq(expectedParsedMessage);
+      // Parse message again and verify it still works correctly
+      expect(kafkaParser.parse(message)).to.deep.eq(expectedParsedMessage);
+      // Verify message was not modified
+      expect(message).to.deep.eq({
+        headers: {
+          [KafkaHeaders.CORRELATION_ID]: Buffer.from('correlation-id'),
+        },
+        value: Buffer.from(JSON.stringify({ prop: 'value' })),
+        key: Buffer.from('1'),
+      });
+    });
   });
 });
diff --git a/packages/microservices/test/json-socket/message-parsing.spec.ts b/packages/microservices/test/json-socket/message-parsing.spec.ts
index 853ddff2b..f714eb9bb 100644
--- a/packages/microservices/test/json-socket/message-parsing.spec.ts
+++ b/packages/microservices/test/json-socket/message-parsing.spec.ts
@@ -108,8 +108,8 @@ describe('JsonSocket message parsing', () => {
   describe('Error handling', () => {
     describe('JSON Error', () => {
       const errorMsg = `Could not parse JSON: Unexpected end of JSON input\nRequest data: "Hel`;
-      const packetStrin = '4#"Hel';
-      const packet = Buffer.from(packetStrin);
+      const packetString = '4#"Hel';
+      const packet = Buffer.from(packetString);
 
       it('should fail to parse invalid JSON', () => {
         try {
@@ -146,12 +146,12 @@ describe('JsonSocket message parsing', () => {
 
     describe('Corrupted length value', () => {
       const errorMsg = `Corrupted length value "wtf" supplied in a packet`;
-      const packetStrin = 'wtf#"Hello"';
-      const packet = Buffer.from(packetStrin);
+      const packetString = 'wtf#"Hello"';
+      const packet = Buffer.from(packetString);
 
       it('should not accept invalid content length', () => {
         try {
-          socket['handleData'](packetStrin);
+          socket['handleData'](packetString);
         } catch (err) {
           expect(err.message).to.deep.equal(errorMsg);
         }
diff --git a/packages/microservices/test/listeners-controller.spec.ts b/packages/microservices/test/listeners-controller.spec.ts
index 9b9f67f94..dd9cadb09 100644
--- a/packages/microservices/test/listeners-controller.spec.ts
+++ b/packages/microservices/test/listeners-controller.spec.ts
@@ -6,13 +6,17 @@ import { Injector } from '@nestjs/core/injector/injector';
 import { InstanceWrapper } from '@nestjs/core/injector/instance-wrapper';
 import { expect } from 'chai';
 import * as sinon from 'sinon';
+import { GraphInspector } from '../../core/inspector/graph-inspector';
 import { MetadataScanner } from '../../core/metadata-scanner';
 import { ClientProxyFactory } from '../client';
 import { ClientsContainer } from '../container';
 import { ExceptionFiltersContext } from '../context/exception-filters-context';
 import { RpcContextCreator } from '../context/rpc-context-creator';
 import { Transport } from '../enums/transport.enum';
-import { ListenerMetadataExplorer } from '../listener-metadata-explorer';
+import {
+  EventOrMessageListenerDefinition,
+  ListenerMetadataExplorer,
+} from '../listener-metadata-explorer';
 import { ListenersController } from '../listeners-controller';
 
 describe('ListenersController', () => {
@@ -21,10 +25,14 @@ describe('ListenersController', () => {
     metadataExplorer: ListenerMetadataExplorer,
     server: any,
     serverTCP: any,
+    serverCustom: any,
+    customTransport: Symbol,
     addSpy: sinon.SinonSpy,
     addSpyTCP: sinon.SinonSpy,
+    addSpyCustom: sinon.SinonSpy,
     proxySpy: sinon.SinonSpy,
     container: NestContainer,
+    graphInspector: GraphInspector,
     injector: Injector,
     rpcContextCreator: RpcContextCreator,
     exceptionFiltersContext: ExceptionFiltersContext;
@@ -35,6 +43,7 @@ describe('ListenersController', () => {
   });
   beforeEach(() => {
     container = new NestContainer();
+    graphInspector = new GraphInspector(container);
     injector = new Injector();
     exceptionFiltersContext = new ExceptionFiltersContext(
       container,
@@ -43,6 +52,7 @@ describe('ListenersController', () => {
     rpcContextCreator = sinon.createStubInstance(RpcContextCreator) as any;
     proxySpy = sinon.spy();
     (rpcContextCreator as any).create.callsFake(() => proxySpy);
+
     instance = new ListenersController(
       new ClientsContainer(),
       rpcContextCreator,
@@ -50,6 +60,7 @@ describe('ListenersController', () => {
       injector,
       ClientProxyFactory,
       exceptionFiltersContext,
+      graphInspector,
     );
     (instance as any).metadataExplorer = metadataExplorer;
     addSpy = sinon.spy();
@@ -61,12 +72,18 @@ describe('ListenersController', () => {
       addHandler: addSpyTCP,
       transportId: Transport.TCP,
     };
+    addSpyCustom = sinon.spy();
+    customTransport = Symbol();
+    serverCustom = {
+      addHandler: addSpyCustom,
+      transportId: customTransport,
+    };
   });
 
   describe('registerPatternHandlers', () => {
     const handlers = [
-      { pattern: 'test', targetCallback: 'tt' },
-      { pattern: 'test2', targetCallback: '2', isEventHandler: true },
+      { patterns: ['test'], targetCallback: 'tt' },
+      { patterns: ['test2'], targetCallback: '2', isEventHandler: true },
     ];
 
     beforeEach(() => {
@@ -80,7 +97,7 @@ describe('ListenersController', () => {
     it(`should call "addHandler" method of server for each pattern handler with same transport`, () => {
       const serverHandlers = [
         {
-          pattern: { cmd: 'test' },
+          patterns: [{ cmd: 'test' }],
           targetCallback: 'tt',
           transport: Transport.TCP,
         },
@@ -92,8 +109,12 @@ describe('ListenersController', () => {
     });
     it(`should call "addHandler" method of server without transportID for each pattern handler with any transport value`, () => {
       const serverHandlers = [
-        { pattern: { cmd: 'test' }, targetCallback: 'tt' },
-        { pattern: 'test2', targetCallback: '2', transport: Transport.KAFKA },
+        { patterns: [{ cmd: 'test' }], targetCallback: 'tt' },
+        {
+          patterns: ['test2'],
+          targetCallback: '2',
+          transport: Transport.KAFKA,
+        },
       ];
       explorer.expects('explore').returns(serverHandlers);
       instance.registerPatternHandlers(new InstanceWrapper(), server, '');
@@ -101,10 +122,14 @@ describe('ListenersController', () => {
     });
     it(`should call "addHandler" method of server with transportID for each pattern handler with self transport and without transport`, () => {
       const serverHandlers = [
-        { pattern: 'test', targetCallback: 'tt' },
-        { pattern: 'test2', targetCallback: '2', transport: Transport.KAFKA },
+        { patterns: ['test'], targetCallback: 'tt' },
+        {
+          patterns: ['test2'],
+          targetCallback: '2',
+          transport: Transport.KAFKA,
+        },
         {
-          pattern: { cmd: 'test3' },
+          patterns: [{ cmd: 'test3' }],
           targetCallback: '3',
           transport: Transport.TCP,
         },
@@ -118,6 +143,44 @@ describe('ListenersController', () => {
       instance.registerPatternHandlers(new InstanceWrapper(), serverTCP, '');
       expect(addSpyTCP.calledTwice).to.be.true;
     });
+    it(`should call "addHandler" method of server with custom transportID for pattern handler with the same custom token`, () => {
+      const serverHandlers = [
+        {
+          patterns: [{ cmd: 'test' }],
+          targetCallback: 'tt',
+          transport: customTransport,
+        },
+        {
+          patterns: ['test2'],
+          targetCallback: '2',
+          transport: Transport.KAFKA,
+        },
+      ];
+
+      explorer.expects('explore').returns(serverHandlers);
+      instance.registerPatternHandlers(new InstanceWrapper(), serverCustom, '');
+      expect(addSpyCustom.calledOnce).to.be.true;
+    });
+    it(`should call "addHandler" method of server with extras data`, () => {
+      const serverHandlers = [
+        {
+          patterns: ['test'],
+          targetCallback: 'tt',
+          extras: { param: 'value' },
+        },
+      ];
+      explorer.expects('explore').returns(serverHandlers);
+      instance.registerPatternHandlers(new InstanceWrapper(), serverTCP, '');
+      expect(addSpyTCP.calledOnce).to.be.true;
+      expect(
+        addSpyTCP.calledWith(
+          sinon.match.any,
+          sinon.match.any,
+          sinon.match.any,
+          sinon.match({ param: 'value' }),
+        ),
+      ).to.be.true;
+    });
     describe('when request scoped', () => {
       it(`should call "addHandler" with deferred proxy`, () => {
         explorer.expects('explore').returns(handlers);
@@ -154,7 +217,7 @@ describe('ListenersController', () => {
       const module = {
         controllers: new Map(),
       } as any;
-      const pattern = {};
+      const patterns = [{}];
       const wrapper = new InstanceWrapper({ instance: { [methodKey]: {} } });
 
       it('should pass all arguments to the proxy chain', async () => {
@@ -163,7 +226,7 @@ describe('ListenersController', () => {
           .callsFake(() => Promise.resolve({}));
         const handler = instance.createRequestScopedHandler(
           wrapper,
-          pattern,
+          patterns,
           module,
           moduleKey,
           methodKey,
@@ -182,16 +245,16 @@ describe('ListenersController', () => {
       const module = {
         controllers: new Map(),
       } as any;
-      const pattern = {};
+      const patterns = [{}];
       const wrapper = new InstanceWrapper({ instance: { [methodKey]: {} } });
 
-      it('should delegete error to exception filters', async () => {
+      it('should delegate error to exception filters', async () => {
         sinon.stub(injector, 'loadPerContext').callsFake(() => {
           throw new Error();
         });
         const handler = instance.createRequestScopedHandler(
           wrapper,
-          pattern,
+          patterns,
           module,
           moduleKey,
           methodKey,
@@ -207,8 +270,51 @@ describe('ListenersController', () => {
     });
   });
 
+  describe('insertEntrypointDefinition', () => {
+    it('should inspect & insert corresponding entrypoint definitions', () => {
+      class TestCtrl {}
+      const instanceWrapper = new InstanceWrapper({
+        metatype: TestCtrl,
+        name: TestCtrl.name,
+      });
+      const definition: EventOrMessageListenerDefinition = {
+        patterns: ['findOne'],
+        methodKey: 'find',
+        isEventHandler: false,
+        targetCallback: null,
+        extras: { qos: 2 },
+      };
+      const transportId = Transport.MQTT;
+
+      const insertEntrypointDefinitionSpy = sinon.spy(
+        graphInspector,
+        'insertEntrypointDefinition',
+      );
+      instance.insertEntrypointDefinition(
+        instanceWrapper,
+        definition,
+        transportId,
+      );
+      expect(
+        insertEntrypointDefinitionSpy.calledWith({
+          type: 'microservice',
+          methodName: definition.methodKey,
+          className: 'TestCtrl',
+          classNodeId: instanceWrapper.id,
+          metadata: {
+            key: definition.patterns.toString(),
+            transportId: 'MQTT',
+            patterns: definition.patterns,
+            isEventHandler: definition.isEventHandler,
+            extras: definition.extras,
+          } as any,
+        }),
+      ).to.be.true;
+    });
+  });
+
   describe('assignClientToInstance', () => {
-    it('should assing client to instance', () => {
+    it('should assign client to instance', () => {
       const propertyKey = 'key';
       const object = {};
       const client = { test: true };
diff --git a/packages/microservices/test/listeners-metadata-explorer.spec.ts b/packages/microservices/test/listeners-metadata-explorer.spec.ts
index 01b63413a..18ccdc2f7 100644
--- a/packages/microservices/test/listeners-metadata-explorer.spec.ts
+++ b/packages/microservices/test/listeners-metadata-explorer.spec.ts
@@ -2,15 +2,20 @@ import { expect } from 'chai';
 import * as sinon from 'sinon';
 import { MetadataScanner } from '../../core/metadata-scanner';
 import { Client } from '../decorators/client.decorator';
+import { EventPattern } from '../decorators/event-pattern.decorator';
 import { MessagePattern } from '../decorators/message-pattern.decorator';
 import { Transport } from '../enums/transport.enum';
 import { ListenerMetadataExplorer } from '../listener-metadata-explorer';
 
 describe('ListenerMetadataExplorer', () => {
-  const pattern = { pattern: 'test' };
-  const secPattern = { role: '2', cmd: 'm' };
+  const msgPattern = { pattern: 'testMsg' };
+  const firstMultipleMsgPattern = { pattern: 'testMultipleMsg1' };
+  const secondMultipleMsgPattern = { pattern: 'testMultipleMsg2' };
   const clientMetadata = {};
   const clientSecMetadata = { transport: Transport.REDIS };
+  const evtPattern = { role: 'testEvt' };
+  const firstMultipleEvtPattern = { role: 'testMultipleEvt1' };
+  const secondMultipleEvtPattern = { role: 'testMultipleEvt2' };
 
   class Test {
     @Client(clientMetadata as any)
@@ -25,11 +30,17 @@ describe('ListenerMetadataExplorer', () => {
 
     constructor() {}
 
-    @MessagePattern(pattern)
-    public test() {}
+    @MessagePattern(msgPattern)
+    public testMessage() {}
 
-    @MessagePattern(secPattern)
-    public testSec() {}
+    @MessagePattern([firstMultipleMsgPattern, secondMultipleMsgPattern])
+    public testMultipleMessage() {}
+
+    @EventPattern(evtPattern)
+    public testEvent() {}
+
+    @EventPattern([firstMultipleEvtPattern, secondMultipleEvtPattern])
+    public testMultipleEvent() {}
 
     public noPattern() {}
   }
@@ -41,17 +52,16 @@ describe('ListenerMetadataExplorer', () => {
     instance = new ListenerMetadataExplorer(scanner);
   });
   describe('explore', () => {
-    let scanFromPrototype: sinon.SinonSpy;
+    let getAllMethodNames: sinon.SinonSpy;
     beforeEach(() => {
-      scanFromPrototype = sinon.spy(scanner, 'scanFromPrototype');
+      getAllMethodNames = sinon.spy(scanner, 'getAllMethodNames');
     });
     it(`should call "scanFromPrototype" with expected arguments`, () => {
       const obj = new Test();
       instance.explore(obj);
 
-      const { args } = scanFromPrototype.getCall(0);
-      expect(args[0]).to.be.eql(obj);
-      expect(args[1]).to.be.eql(Object.getPrototypeOf(obj));
+      const { args } = getAllMethodNames.getCall(0);
+      expect(args[0]).to.be.eql(Object.getPrototypeOf(obj));
     });
   });
   describe('exploreMethodMetadata', () => {
@@ -66,19 +76,77 @@ describe('ListenerMetadataExplorer', () => {
       );
       expect(metadata).to.eq(undefined);
     });
-    it(`should return pattern properties when "handlerType" metadata is not undefined`, () => {
-      const metadata = instance.exploreMethodMetadata(
-        Object.getPrototypeOf(test),
-        'test',
-      );
-      expect(metadata).to.have.keys([
-        'isEventHandler',
-        'methodKey',
-        'targetCallback',
-        'pattern',
-        'transport',
-      ]);
-      expect(metadata.pattern).to.eql(pattern);
+
+    describe('@MessagePattern', () => {
+      it(`should return pattern properties when "handlerType" metadata is not undefined`, () => {
+        const metadata = instance.exploreMethodMetadata(
+          Object.getPrototypeOf(test),
+          'testMessage',
+        );
+        expect(metadata).to.have.keys([
+          'isEventHandler',
+          'methodKey',
+          'targetCallback',
+          'patterns',
+          'transport',
+          'extras',
+        ]);
+        expect(metadata.patterns.length).to.eql(1);
+        expect(metadata.patterns[0]).to.eql(msgPattern);
+      });
+      it(`should return multiple patterns when more than one is declared`, () => {
+        const metadata = instance.exploreMethodMetadata(
+          Object.getPrototypeOf(test),
+          'testMultipleMessage',
+        );
+        expect(metadata).to.have.keys([
+          'isEventHandler',
+          'methodKey',
+          'targetCallback',
+          'patterns',
+          'transport',
+          'extras',
+        ]);
+        expect(metadata.patterns.length).to.eql(2);
+        expect(metadata.patterns[0]).to.eql(firstMultipleMsgPattern);
+        expect(metadata.patterns[1]).to.eql(secondMultipleMsgPattern);
+      });
+    });
+
+    describe('@EventPattern', () => {
+      it(`should return pattern properties when "handlerType" metadata is not undefined`, () => {
+        const metadata = instance.exploreMethodMetadata(
+          Object.getPrototypeOf(test),
+          'testEvent',
+        );
+        expect(metadata).to.have.keys([
+          'isEventHandler',
+          'methodKey',
+          'targetCallback',
+          'patterns',
+          'transport',
+          'extras',
+        ]);
+        expect(metadata.patterns.length).to.eql(1);
+        expect(metadata.patterns[0]).to.eql(evtPattern);
+      });
+      it(`should return multiple patterns when more than one is declared`, () => {
+        const metadata = instance.exploreMethodMetadata(
+          Object.getPrototypeOf(test),
+          'testMultipleEvent',
+        );
+        expect(metadata).to.have.keys([
+          'isEventHandler',
+          'methodKey',
+          'targetCallback',
+          'patterns',
+          'transport',
+          'extras',
+        ]);
+        expect(metadata.patterns.length).to.eql(2);
+        expect(metadata.patterns[0]).to.eql(firstMultipleEvtPattern);
+        expect(metadata.patterns[1]).to.eql(secondMultipleEvtPattern);
+      });
     });
   });
   describe('scanForClientHooks', () => {
diff --git a/packages/microservices/test/serializers/kafka-request.serializer.spec.ts b/packages/microservices/test/serializers/kafka-request.serializer.spec.ts
index 5cde5292e..566e86d95 100644
--- a/packages/microservices/test/serializers/kafka-request.serializer.spec.ts
+++ b/packages/microservices/test/serializers/kafka-request.serializer.spec.ts
@@ -8,51 +8,51 @@ describe('KafkaRequestSerializer', () => {
     instance = new KafkaRequestSerializer();
   });
   describe('serialize', () => {
-    it('undefined', () => {
-      expect(instance.serialize(undefined)).to.deep.eq({
+    it('undefined', async () => {
+      expect(await instance.serialize(undefined)).to.deep.eq({
         headers: {},
         value: null,
       });
     });
 
-    it('null', () => {
-      expect(instance.serialize(null)).to.deep.eq({
+    it('null', async () => {
+      expect(await instance.serialize(null)).to.deep.eq({
         headers: {},
         value: null,
       });
     });
 
-    it('string', () => {
-      expect(instance.serialize('string')).to.deep.eq({
+    it('string', async () => {
+      expect(await instance.serialize('string')).to.deep.eq({
         headers: {},
         value: 'string',
       });
     });
 
-    it('number', () => {
-      expect(instance.serialize(12345)).to.deep.eq({
+    it('number', async () => {
+      expect(await instance.serialize(12345)).to.deep.eq({
         headers: {},
         value: '12345',
       });
     });
 
-    it('buffer', () => {
-      expect(instance.serialize(Buffer.from('buffer'))).to.deep.eq({
+    it('buffer', async () => {
+      expect(await instance.serialize(Buffer.from('buffer'))).to.deep.eq({
         headers: {},
         value: Buffer.from('buffer'),
       });
     });
 
-    it('array', () => {
-      expect(instance.serialize([1, 2, 3, 4, 5])).to.deep.eq({
+    it('array', async () => {
+      expect(await instance.serialize([1, 2, 3, 4, 5])).to.deep.eq({
         headers: {},
         value: '[1,2,3,4,5]',
       });
     });
 
-    it('object', () => {
+    it('object', async () => {
       expect(
-        instance.serialize({
+        await instance.serialize({
           prop: 'value',
         }),
       ).to.deep.eq({
@@ -61,7 +61,7 @@ describe('KafkaRequestSerializer', () => {
       });
     });
 
-    it('complex object with .toString()', () => {
+    it('complex object with .toString()', async () => {
       class Complex {
         private readonly name = 'complex';
         public toString(): string {
@@ -69,28 +69,30 @@ describe('KafkaRequestSerializer', () => {
         }
       }
 
-      expect(instance.serialize(new Complex())).to.deep.eq({
+      expect(await instance.serialize(new Complex())).to.deep.eq({
         headers: {},
         value: 'complex',
       });
     });
 
-    it('complex object without .toString()', () => {
+    it('complex object without .toString()', async () => {
       class ComplexWithOutToString {
         private readonly name = 'complex';
       }
 
-      expect(instance.serialize(new ComplexWithOutToString())).to.deep.eq({
-        headers: {},
-        value: '[object Object]',
-      });
+      expect(await instance.serialize(new ComplexWithOutToString())).to.deep.eq(
+        {
+          headers: {},
+          value: '[object Object]',
+        },
+      );
     });
   });
 
   describe('serialize kafka message', () => {
-    it('kafka message without key', () => {
+    it('kafka message without key', async () => {
       expect(
-        instance.serialize({
+        await instance.serialize({
           value: 'string',
         }),
       ).to.deep.eq({
@@ -99,9 +101,9 @@ describe('KafkaRequestSerializer', () => {
       });
     });
 
-    it('kafka message with key', () => {
+    it('kafka message with key', async () => {
       expect(
-        instance.serialize({
+        await instance.serialize({
           key: '1',
           value: 'string',
         }),
@@ -112,9 +114,9 @@ describe('KafkaRequestSerializer', () => {
       });
     });
 
-    it('kafka message with headers', () => {
+    it('kafka message with headers', async () => {
       expect(
-        instance.serialize({
+        await instance.serialize({
           key: '1',
           value: 'string',
           headers: {
diff --git a/packages/microservices/test/serializers/mqtt-record.serializer.spec.ts b/packages/microservices/test/serializers/mqtt-record.serializer.spec.ts
index 95a50d3b5..ff3d33f1c 100644
--- a/packages/microservices/test/serializers/mqtt-record.serializer.spec.ts
+++ b/packages/microservices/test/serializers/mqtt-record.serializer.spec.ts
@@ -26,7 +26,7 @@ describe('MqttRecordSerializer', () => {
         data: { value: 'string' },
       });
     });
-    it('should act as an indentity function if msg is not an instance of MqttRecord class', () => {
+    it('should act as an identity function if msg is not an instance of MqttRecord class', () => {
       const packet = {
         data: { random: true },
       };
diff --git a/packages/microservices/test/serializers/rmq-record.serializer.spec.ts b/packages/microservices/test/serializers/rmq-record.serializer.spec.ts
index 8551d823f..eb3f80973 100644
--- a/packages/microservices/test/serializers/rmq-record.serializer.spec.ts
+++ b/packages/microservices/test/serializers/rmq-record.serializer.spec.ts
@@ -24,7 +24,7 @@ describe('RmqRecordSerializer', () => {
       });
     });
 
-    it('should act as an indentity function if msg is not an instance of RmqRecord class', () => {
+    it('should act as an identity function if msg is not an instance of RmqRecord class', () => {
       const packet = {
         data: { random: true },
       };
diff --git a/packages/microservices/test/server/server-kafka.spec.ts b/packages/microservices/test/server/server-kafka.spec.ts
index 4d086581b..5c32118e4 100644
--- a/packages/microservices/test/server/server-kafka.spec.ts
+++ b/packages/microservices/test/server/server-kafka.spec.ts
@@ -1,5 +1,5 @@
 import { Logger } from '@nestjs/common';
-import { expect } from 'chai';
+import { AssertionError, expect } from 'chai';
 import * as sinon from 'sinon';
 import { NO_MESSAGE_HANDLER } from '../../constants';
 import { KafkaHeaders } from '../../enums';
@@ -26,6 +26,8 @@ describe('ServerKafka', () => {
   const key = '1';
   const timestamp = new Date().toISOString();
   const messageValue = 'test-message';
+  const heartbeat = async () => {};
+  const pause = () => () => {};
 
   const eventMessage: KafkaMessage = {
     key: Buffer.from(key),
@@ -44,6 +46,8 @@ describe('ServerKafka', () => {
       },
       eventMessage,
     ),
+    heartbeat,
+    pause,
   };
 
   const eventWithCorrelationIdPayload: EachMessagePayload = {
@@ -57,6 +61,8 @@ describe('ServerKafka', () => {
       },
       eventMessage,
     ),
+    heartbeat,
+    pause,
   };
 
   const message: KafkaMessage = Object.assign(
@@ -73,6 +79,8 @@ describe('ServerKafka', () => {
     topic,
     partition: 0,
     message,
+    heartbeat,
+    pause,
   };
 
   let server: ServerKafka;
@@ -277,18 +285,77 @@ describe('ServerKafka', () => {
 
       sinon.stub(server, 'getPublisher').callsFake(() => getPublisherSpy);
     });
+
     it('should call "handleEvent" if correlation identifier is not present', async () => {
       const handleEventSpy = sinon.spy(server, 'handleEvent');
       await server.handleMessage(eventPayload);
       expect(handleEventSpy.called).to.be.true;
     });
 
-    it('should call "handleEvent" if correlation identifier is present by the reply topic is not present', async () => {
+    it('should call "handleEvent" if correlation identifier is present but the reply topic is not present', async () => {
       const handleEventSpy = sinon.spy(server, 'handleEvent');
       await server.handleMessage(eventWithCorrelationIdPayload);
       expect(handleEventSpy.called).to.be.true;
     });
 
+    it('should call event handler when "handleEvent" is called', async () => {
+      const messageHandler = sinon.mock();
+      const context = { test: true } as any;
+      const messageData = 'some data';
+      sinon.stub(server, 'getHandlerByPattern').callsFake(() => messageHandler);
+
+      await server.handleEvent(
+        topic,
+        { data: messageData, pattern: topic },
+        context,
+      );
+      expect(messageHandler.calledWith(messageData, context)).to.be.true;
+    });
+
+    it('should not catch error thrown by event handler as part of "handleEvent"', async () => {
+      const error = new Error('handler error');
+      const messageHandler = sinon.mock().throwsException(error);
+      sinon.stub(server, 'getHandlerByPattern').callsFake(() => messageHandler);
+
+      try {
+        await server.handleEvent(
+          topic,
+          { data: 'some data', pattern: topic },
+          {} as any,
+        );
+
+        // code should not be executed
+        expect(true).to.be.false;
+      } catch (e) {
+        if (e instanceof AssertionError) {
+          throw e;
+        }
+        expect(e).to.be.eq(error);
+      }
+    });
+
+    it('should call "handleEvent" if correlation identifier and reply topic are present but the handler is of type eventHandler', async () => {
+      const handler = sinon.spy();
+      (handler as any).isEventHandler = true;
+      (server as any).messageHandlers = objectToMap({
+        [topic]: handler,
+      });
+      const handleEventSpy = sinon.spy(server, 'handleEvent');
+      await server.handleMessage(payload);
+      expect(handleEventSpy.called).to.be.true;
+    });
+
+    it('should NOT call "handleEvent" if correlation identifier and reply topic are present but the handler is not of type eventHandler', async () => {
+      const handler = sinon.spy();
+      (handler as any).isEventHandler = false;
+      (server as any).messageHandlers = objectToMap({
+        [topic]: handler,
+      });
+      const handleEventSpy = sinon.spy(server, 'handleEvent');
+      await server.handleMessage(payload);
+      expect(handleEventSpy.called).to.be.false;
+    });
+
     it(`should publish NO_MESSAGE_HANDLER if pattern not exists in messageHandlers object`, async () => {
       await server.handleMessage(payload);
       expect(
@@ -298,6 +365,7 @@ describe('ServerKafka', () => {
         }),
       ).to.be.true;
     });
+
     it(`should call handler with expected arguments`, async () => {
       const handler = sinon.spy();
       (server as any).messageHandlers = objectToMap({
@@ -319,8 +387,8 @@ describe('ServerKafka', () => {
       });
     });
 
-    it('should send message', () => {
-      server.sendMessage(
+    it('should send message', async () => {
+      await server.sendMessage(
         {
           id: correlationId,
           response: messageValue,
@@ -345,8 +413,8 @@ describe('ServerKafka', () => {
         }),
       ).to.be.true;
     });
-    it('should send message without reply partition', () => {
-      server.sendMessage(
+    it('should send message without reply partition', async () => {
+      await server.sendMessage(
         {
           id: correlationId,
           response: messageValue,
@@ -370,8 +438,8 @@ describe('ServerKafka', () => {
         }),
       ).to.be.true;
     });
-    it('should send error message', () => {
-      server.sendMessage(
+    it('should send error message', async () => {
+      await server.sendMessage(
         {
           id: correlationId,
           err: NO_MESSAGE_HANDLER,
@@ -397,8 +465,8 @@ describe('ServerKafka', () => {
         }),
       ).to.be.true;
     });
-    it('should send `isDisposed` message', () => {
-      server.sendMessage(
+    it('should send `isDisposed` message', async () => {
+      await server.sendMessage(
         {
           id: correlationId,
           isDisposed: true,
diff --git a/packages/microservices/test/server/server-mqtt.spec.ts b/packages/microservices/test/server/server-mqtt.spec.ts
index 43f54eb4a..8e63a0162 100644
--- a/packages/microservices/test/server/server-mqtt.spec.ts
+++ b/packages/microservices/test/server/server-mqtt.spec.ts
@@ -112,7 +112,7 @@ describe('ServerMqtt', () => {
       const handleEventSpy = sinon.spy(server, 'handleEvent');
       await server.handleMessage(
         channel,
-        new Buffer(JSON.stringify({ pattern: '', data })),
+        Buffer.from(JSON.stringify({ pattern: '', data })),
         null,
       );
       expect(handleEventSpy.called).to.be.true;
@@ -120,7 +120,7 @@ describe('ServerMqtt', () => {
     it(`should publish NO_MESSAGE_HANDLER if pattern not exists in messageHandlers object`, async () => {
       await server.handleMessage(
         channel,
-        new Buffer(JSON.stringify({ id, pattern: '', data })),
+        Buffer.from(JSON.stringify({ id, pattern: '', data })),
         null,
       );
       expect(
@@ -139,7 +139,7 @@ describe('ServerMqtt', () => {
 
       await server.handleMessage(
         channel,
-        new Buffer(JSON.stringify({ pattern: '', data, id: '2' })),
+        Buffer.from(JSON.stringify({ pattern: '', data, id: '2' })),
         null,
       );
       expect(handler.calledWith(data)).to.be.true;
@@ -175,7 +175,7 @@ describe('ServerMqtt', () => {
   });
   describe('getRequestPattern', () => {
     const test = 'test';
-    it(`should leave patern as it is`, () => {
+    it(`should leave pattern as it is`, () => {
       expect(server.getRequestPattern(test)).to.equal(test);
     });
   });
diff --git a/packages/microservices/test/server/server-redis.spec.ts b/packages/microservices/test/server/server-redis.spec.ts
index fc9650c87..8a831ff6b 100644
--- a/packages/microservices/test/server/server-redis.spec.ts
+++ b/packages/microservices/test/server/server-redis.spec.ts
@@ -15,13 +15,17 @@ describe('ServerRedis', () => {
   });
   describe('listen', () => {
     let onSpy: sinon.SinonSpy;
+    let connectSpy: sinon.SinonSpy;
     let client: any;
     let callbackSpy: sinon.SinonSpy;
 
     beforeEach(() => {
       onSpy = sinon.spy();
+      connectSpy = sinon.spy();
+
       client = {
         on: onSpy,
+        connect: connectSpy,
       };
       sinon.stub(server, 'createRedisClient').callsFake(() => client);
 
@@ -31,13 +35,9 @@ describe('ServerRedis', () => {
       server.listen(callbackSpy);
       expect(onSpy.getCall(0).args[0]).to.be.equal('error');
     });
-    it('should bind "connect" event to handler', () => {
-      server.listen(callbackSpy);
-      expect(onSpy.getCall(3).args[0]).to.be.equal('connect');
-    });
-    it('should bind "message" event to handler', () => {
+    it('should call "RedisClient#connect()"', () => {
       server.listen(callbackSpy);
-      expect(onSpy.getCall(2).args[0]).to.be.equal('message');
+      expect(connectSpy.called).to.be.true;
     });
     describe('when "start" throws an exception', () => {
       it('should call callback with a thrown error as an argument', () => {
@@ -67,7 +67,7 @@ describe('ServerRedis', () => {
     });
   });
   describe('handleConnection', () => {
-    let onSpy: sinon.SinonSpy, subscribeSpy: sinon.SinonSpy, sub;
+    let onSpy: sinon.SinonSpy, subscribeSpy: sinon.SinonSpy, sub, psub;
 
     beforeEach(() => {
       onSpy = sinon.spy();
@@ -76,12 +76,24 @@ describe('ServerRedis', () => {
         on: onSpy,
         subscribe: subscribeSpy,
       };
+      psub = {
+        on: onSpy,
+        psubscribe: subscribeSpy,
+      };
     });
-    it('should bind "message" event to handler', () => {
+    it('should bind "message" event to handler if wildcards are disabled', () => {
       server.bindEvents(sub, null);
       expect(onSpy.getCall(0).args[0]).to.be.equal('message');
     });
-    it('should subscribe to each pattern', () => {
+    it('should bind "pmessage" event to handler if wildcards are enabled', () => {
+      (server as any).options = {};
+      (server as any).options.wildcards = true;
+
+      server.bindEvents(psub, null);
+      expect(onSpy.getCall(0).args[0]).to.be.equal('pmessage');
+    });
+
+    it('should "subscribe" to each pattern if wildcards are disabled', () => {
       const pattern = 'test';
       const handler = sinon.spy();
       (server as any).messageHandlers = objectToMap({
@@ -90,6 +102,19 @@ describe('ServerRedis', () => {
       server.bindEvents(sub, null);
       expect(subscribeSpy.calledWith(pattern)).to.be.true;
     });
+
+    it('should "psubscribe" to each pattern if wildcards are enabled', () => {
+      (server as any).options = {};
+      (server as any).options.wildcards = true;
+
+      const pattern = 'test';
+      const handler = sinon.spy();
+      (server as any).messageHandlers = objectToMap({
+        [pattern]: handler,
+      });
+      server.bindEvents(psub, null);
+      expect(subscribeSpy.calledWith(pattern)).to.be.true;
+    });
   });
   describe('getMessageHandler', () => {
     it(`should return function`, () => {
@@ -111,12 +136,17 @@ describe('ServerRedis', () => {
       const handleEventSpy = sinon.spy(server, 'handleEvent');
       sinon.stub(server, 'parseMessage').callsFake(() => ({ data } as any));
 
-      await server.handleMessage(channel, JSON.stringify({}), null);
+      await server.handleMessage(channel, JSON.stringify({}), null, channel);
       expect(handleEventSpy.called).to.be.true;
     });
     it(`should publish NO_MESSAGE_HANDLER if pattern not exists in messageHandlers object`, async () => {
       sinon.stub(server, 'parseMessage').callsFake(() => ({ id, data } as any));
-      await server.handleMessage(channel, JSON.stringify({ id }), null);
+      await server.handleMessage(
+        channel,
+        JSON.stringify({ id }),
+        null,
+        channel,
+      );
       expect(
         getPublisherSpy.calledWith({
           id,
@@ -132,7 +162,7 @@ describe('ServerRedis', () => {
       });
       sinon.stub(server, 'parseMessage').callsFake(() => ({ id, data } as any));
 
-      await server.handleMessage(channel, {}, null);
+      await server.handleMessage(channel, {}, null, channel);
       expect(handler.calledWith(data)).to.be.true;
     });
   });
@@ -191,11 +221,11 @@ describe('ServerRedis', () => {
     });
   });
   describe('getClientOptions', () => {
-    it('should return options object with "retry_strategy" and call "createRetryStrategy"', () => {
+    it('should return options object with "retryStrategy" and call "createRetryStrategy"', () => {
       const createSpy = sinon.spy(server, 'createRetryStrategy');
-      const { retry_strategy } = server.getClientOptions();
+      const { retryStrategy } = server.getClientOptions();
       try {
-        retry_strategy({} as any);
+        retryStrategy(0);
       } catch {}
       expect(createSpy.called).to.be.true;
     });
@@ -204,37 +234,24 @@ describe('ServerRedis', () => {
     describe('when is terminated', () => {
       it('should return undefined', () => {
         (server as any).isExplicitlyTerminated = true;
-        const result = server.createRetryStrategy({} as any);
+        const result = server.createRetryStrategy(0);
         expect(result).to.be.undefined;
       });
     });
     describe('when "retryAttempts" does not exist', () => {
-      it('should throw an exception', () => {
+      it('should return undefined', () => {
         (server as any).options.options = {};
         (server as any).options.options.retryAttempts = undefined;
 
-        expect(() => server.createRetryStrategy({} as any)).to.throw(Error);
+        expect(server.createRetryStrategy(4)).to.be.undefined;
       });
     });
     describe('when "attempts" count is max', () => {
-      it('should throw an exception', () => {
+      it('should return undefined', () => {
         (server as any).options.options = {};
         (server as any).options.options.retryAttempts = 3;
 
-        expect(() =>
-          server.createRetryStrategy({ attempt: 4 } as any),
-        ).to.throw(Error);
-      });
-    });
-    describe('when ECONNREFUSED', () => {
-      it('should call logger', () => {
-        const loggerErrorSpy = sinon.spy((server as any).logger, 'error');
-        try {
-          server.createRetryStrategy({
-            error: { code: 'ECONNREFUSED' },
-          } as any);
-        } catch {}
-        expect(loggerErrorSpy.called).to.be.true;
+        expect(server.createRetryStrategy(4)).to.be.undefined;
       });
     });
     describe('otherwise', () => {
@@ -243,7 +260,7 @@ describe('ServerRedis', () => {
         (server as any).isExplicitlyTerminated = false;
         (server as any).options.retryAttempts = 3;
         (server as any).options.retryDelay = 3;
-        const result = server.createRetryStrategy({ attempt: 2 } as any);
+        const result = server.createRetryStrategy(2);
         expect(result).to.be.eql((server as any).options.retryDelay);
       });
     });
diff --git a/packages/microservices/test/server/server-rmq.spec.ts b/packages/microservices/test/server/server-rmq.spec.ts
index 5a0ded627..33374bf8c 100644
--- a/packages/microservices/test/server/server-rmq.spec.ts
+++ b/packages/microservices/test/server/server-rmq.spec.ts
@@ -1,4 +1,4 @@
-import { expect } from 'chai';
+import { assert, expect } from 'chai';
 import * as sinon from 'sinon';
 import { NO_MESSAGE_HANDLER } from '../../constants';
 import { BaseRpcContext } from '../../ctx-host/base-rpc.context';
@@ -52,6 +52,10 @@ describe('ServerRMQ', () => {
       server.listen(callbackSpy);
       expect(onStub.getCall(1).args[0]).to.be.equal('disconnect');
     });
+    it('should bind "connectFailed" event to handler', () => {
+      server.listen(callbackSpy);
+      expect(onStub.getCall(2).args[0]).to.be.equal('connectFailed');
+    });
     describe('when "start" throws an exception', () => {
       it('should call callback with a thrown error as an argument', () => {
         const error = new Error('random error');
@@ -123,6 +127,22 @@ describe('ServerRMQ', () => {
       await server.handleMessage(msg, '');
       expect(handler.calledOnce).to.be.true;
     });
+    it('should not throw if the message is an invalid json', async () => {
+      const invalidMsg = {
+        content: {
+          toString: () => 'd',
+        },
+        properties: { correlationId: 1 },
+      };
+      const handler = sinon.spy();
+      (server as any).messageHandlers = objectToMap({
+        [pattern]: handler as any,
+      });
+
+      return server.handleMessage(invalidMsg, '').catch(() => {
+        assert.fail('Was not supposed to throw an error');
+      });
+    });
   });
   describe('setupChannel', () => {
     const queue = 'test';
diff --git a/packages/microservices/test/server/server.spec.ts b/packages/microservices/test/server/server.spec.ts
index 111b48d2f..ae62ca108 100644
--- a/packages/microservices/test/server/server.spec.ts
+++ b/packages/microservices/test/server/server.spec.ts
@@ -116,7 +116,7 @@ describe('Server', () => {
       });
       describe('throws exception', () => {
         beforeEach(() => {
-          server.send(_throw('test') as any, sendSpy);
+          server.send(_throw(() => 'test') as any, sendSpy);
         });
         it('should send error and complete', () => {
           process.nextTick(() => {
@@ -149,7 +149,7 @@ describe('Server', () => {
   describe('transformToObservable', () => {
     describe('when resultOrDeferred', () => {
       describe('is Promise', () => {
-        it('should return Observable', async () => {
+        it('should return Observable that emits the resolved value of the supplied promise', async () => {
           const value = 100;
           expect(
             await lastValueFrom(
@@ -159,21 +159,29 @@ describe('Server', () => {
         });
       });
       describe('is Observable', () => {
-        it('should return Observable', async () => {
+        it('should return the observable itself', async () => {
           const value = 100;
           expect(
             await lastValueFrom(server.transformToObservable(of(value))),
           ).to.be.eq(100);
         });
       });
-      describe('is value', () => {
-        it('should return Observable', async () => {
+      describe('is any number', () => {
+        it('should return Observable that emits the supplied number', async () => {
           const value = 100;
           expect(
             await lastValueFrom(server.transformToObservable(value)),
           ).to.be.eq(100);
         });
       });
+      describe('is an array', () => {
+        it('should return Observable that emits the supplied array', async () => {
+          const value = [1, 2, 3];
+          expect(
+            await lastValueFrom(server.transformToObservable(value)),
+          ).to.be.eq(value);
+        });
+      });
     });
   });
 
diff --git a/packages/microservices/test/tsconfig.json b/packages/microservices/test/tsconfig.json
new file mode 100644
index 000000000..50d59661d
--- /dev/null
+++ b/packages/microservices/test/tsconfig.json
@@ -0,0 +1,3 @@
+{
+  "extends": "../../../tsconfig.spec.json"
+}
diff --git a/packages/microservices/tsconfig.build.json b/packages/microservices/tsconfig.build.json
new file mode 100644
index 000000000..e8b71a07a
--- /dev/null
+++ b/packages/microservices/tsconfig.build.json
@@ -0,0 +1,27 @@
+{
+  "extends": "../tsconfig.build.json",
+  "compilerOptions": {
+    "outDir": ".",
+    "rootDir": ".",
+    "paths": {
+      "@nestjs/common": ["../common"],
+      "@nestjs/common/*": ["../common/*"],
+      "@nestjs/core": ["../core"],
+      "@nestjs/core/*": ["../core/*"],
+      "@nestjs/websockets": ["../websockets"],
+      "@nestjs/websockets/*": ["../websockets/*"]
+    }
+  },
+  "exclude": ["node_modules", "dist", "test/**/*", "*.spec.ts"],
+  "references": [
+    {
+      "path": "../common/tsconfig.build.json"
+    },
+    {
+      "path": "../core/tsconfig.build.json"
+    },
+    {
+      "path": "../websockets/tsconfig.build.json"
+    }
+  ]
+}
diff --git a/packages/microservices/tsconfig.json b/packages/microservices/tsconfig.json
index b238080a4..2ae9e3c90 100644
--- a/packages/microservices/tsconfig.json
+++ b/packages/microservices/tsconfig.json
@@ -1,7 +1,13 @@
 {
-  "extends": "./../tsconfig.base.json",
+  "extends": "../tsconfig.build.json",
   "compilerOptions": {
-    "baseUrl": "./"
+    "types": ["node"]
   },
-  "include": ["*.ts", "**/*.ts"]
+  "files": [],
+  "include": [],
+  "references": [
+    {
+      "path": "./tsconfig.build.json"
+    }
+  ]
 }
diff --git a/packages/microservices/utils/transform-pattern.utils.ts b/packages/microservices/utils/transform-pattern.utils.ts
index 0074ef409..4bcb299ed 100644
--- a/packages/microservices/utils/transform-pattern.utils.ts
+++ b/packages/microservices/utils/transform-pattern.utils.ts
@@ -1,4 +1,8 @@
-import { isObject, isString } from '@nestjs/common/utils/shared.utils';
+import {
+  isObject,
+  isString,
+  isNumber,
+} from '@nestjs/common/utils/shared.utils';
 import { MsPattern } from '../interfaces';
 
 /**
@@ -14,7 +18,7 @@ import { MsPattern } from '../interfaces';
  * @returns string
  */
 export function transformPatternToRoute(pattern: MsPattern): string {
-  if (isString(pattern) || typeof pattern === 'number') {
+  if (isString(pattern) || isNumber(pattern)) {
     return `${pattern}`;
   }
   if (!isObject(pattern)) {
diff --git a/packages/platform-express/CHANGELOG.md b/packages/platform-express/CHANGELOG.md
deleted file mode 100644
index 9fbcf7681..000000000
--- a/packages/platform-express/CHANGELOG.md
+++ /dev/null
@@ -1,12 +0,0 @@
-# Change Log
-
-All notable changes to this project will be documented in this file.
-See [Conventional Commits](https://conventionalcommits.org) for commit guidelines.
-
-<a name="8.2.0"></a>
-# [8.2.0](https://github.com/nestjs/nest/compare/v8.1.2...v8.2.0) (2021-11-08)
-
-
-### Features
-
-* **common:** add the ability to set some extra metadata about returned files ([5100573](https://github.com/nestjs/nest/commit/5100573))
diff --git a/packages/platform-express/Readme.md b/packages/platform-express/Readme.md
index f288809a9..16f48336d 100644
--- a/packages/platform-express/Readme.md
+++ b/packages/platform-express/Readme.md
@@ -11,7 +11,6 @@
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
 <a href="https://circleci.com/gh/nestjs/nest" target="_blank"><img src="https://img.shields.io/circleci/build/github/nestjs/nest/master" alt="CircleCI" /></a>
-<a href="https://coveralls.io/github/nestjs/nest?branch=master" target="_blank"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#9" alt="Coverage" /></a>
 <a href="https://discord.gg/G7Qnnhy" target="_blank"><img src="https://img.shields.io/badge/discord-online-brightgreen.svg" alt="Discord"/></a>
 <a href="https://opencollective.com/nest#backer" target="_blank"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
 <a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
@@ -37,8 +36,8 @@ Nest is a framework for building efficient, scalable <a href="http://nodejs.org"
 
 * To check out the [guide](https://docs.nestjs.com), visit [docs.nestjs.com](https://docs.nestjs.com). :books:
 * Ë¶ÅÊü•Áúã‰∏≠Êñá [ÊåáÂçó](readme_zh.md), ËØ∑ËÆøÈóÆ [docs.nestjs.cn](https://docs.nestjs.cn). :books:
-* [Í∞ÄÏù¥Îìú](readme_kr.md)Î•º ÌôïÏù∏ÌïòÎ†§Î©¥, [docs.nestjs.com](https://docs.nestjs.com)Î•º Î∞©Î¨∏ÌïòÏÑ∏Ïöî.:books: 
-* „ÉÅ„Çß„ÉÉ„ÇØ„Åô„Çã„Å´„ÅØ [„Ç¨„Ç§„Éâ](readme_jp.md), Ë©≥„Åó„Åè„ÅØ [docs.nestjs.com](https://docs.nestjs.com). :books: 
+* [Í∞ÄÏù¥Îìú](readme_kr.md) Î¨∏ÏÑúÎäî [docs.nestjs.com](https://docs.nestjs.com)ÏóêÏÑú ÌôïÏù∏ÌïòÏã§ Ïàò ÏûàÏäµÎãàÎã§. :books:
+* [„Ç¨„Ç§„Éâ](readme_jp.md)„ÅØ [docs.nestjs.com](https://docs.nestjs.com)„Åß„ÅîÁ¢∫Ë™ç„Åè„Å†„Åï„ÅÑ„ÄÇ :books:
 
 ## Questions
 
@@ -54,36 +53,49 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
 <table style="text-align:center;"><tr>
   <td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
+  <td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/red-hat-logo.svg" width="200" valign="middle" /></a></td>
 <td>
 <a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
 <td>
 <a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
+    <td>
+<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td><td>
+<a href="https://amplication.com/" target="_blank"><img src="https://nestjs.com/img/amplication-logo.svg" width="190" valign="middle" /></a></td>
 </tr></table>
 
 #### Gold Sponsors
 
 <table style="text-align:center;"><tr><td>
-  <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
-  <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
+<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="140" valign="middle" /></a></td>
 <td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
+<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td>
+ <td>
+<a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
+<a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td><td>
+<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td>
+<td>
+<a href="https://ridicorp.com/career/" target="_blank"><img src="https://nestjs.com/img/ridi-logo.svg" width="105" valign="middle" /></a></td><td>
+<a href="https://www.movavi.com/imovie-for-windows.html" target="_blank"><img src="https://nestjs.com/img/movavi-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
 <table style="text-align:center;"><tr><td>
 <a href="https://neoteric.eu/" target="_blank"><img src="https://nestjs.com/img/neoteric-cut.png" width="120" valign="middle" /></a> </td><td>
   <a href="http://gojob.com" target="_blank"><img src="http://nestjs.com/img/gojob-logo.png" valign="middle" width="100" /></a> </td><td>
-<a href="http://www.leogistics.com" target="_blank"><img src="https://nestjs.com/img/leogistics-logo.jpeg" width="150" valign="middle" /></td><td>
+<a href="https://www.myleodsc.com/" target="_blank"><img src="https://nestjs.com/img/myleo-logo.png" width="180" valign="middle" /></td><td>
 <a href="https://careers.meetdandy.com/?gh_src=063ba61e3us" target="_blank"><img src="https://nestjs.com/img/dandy-roles-logo.svg" width="150" valign="middle" /></td><td>
 <a href="https://www.castlecraft.in" target="_blank"><img src="https://nestjs.com/img/castlecraft-logo.png" width="150" valign="middle" /></td>
-<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td></tr></table>
+<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td>
+<td><a href="https://n.inc" target="_blank"><img src="https://nestjs.com/img/n-inc-logo.svg" width="120" valign="middle" /></td></tr><tr>
+<td><a href="https://bilberrry.com/" target="_blank"><img src="https://nestjs.com/img/bilberrry-logo.svg" width="180" valign="middle" /></td>
+<td><a href="https://ipinfo.ai/" target="_blank"><img src="https://nestjs.com/img/ipinfo-logo.png" width="130" valign="middle" /></td>
+<td><a href="https://chax.at" target="_blank"><img src="https://nestjs.com/img/chaxat-logo.png" width="100" valign="middle" /></td></tr>
+</table>
 
 #### Sponsors
 
@@ -91,7 +103,7 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <a href="https://www.swingdev.io" target="_blank"><img src="https://nestjs.com/img/swingdev-logo.svg#1" width="110" valign="middle" /> </a></td><td align="center" valign="middle">
 <a href="https://www.novologic.com/" target="_blank"><img src="https://nestjs.com/img/novologic.png" width="110" valign="middle" /></a> </td><td align="center" valign="middle">
 <a href="https://ever.co/" target="_blank"><img src="https://nestjs.com/img/ever-logo.png" width="72" valign="middle" /></a>  </td><td align="center" valign="middle">
-<a href="https://blokt.com" target="_blank"><img src="https://nestjs.com/img/blokt-logo.png" width="120" valign="middle" /></a>  </td><td align="center" valign="middle"> 
+<a href="https://blokt.com" target="_blank"><img src="https://nestjs.com/img/blokt-logo.png" width="120" valign="middle" /></a>  </td><td align="center" valign="middle">
   <a href="http://architectnow.net/" target="_blank"><img src="https://nestjs.com/img/architectnow.png" width="125" valign="middle" /></a> </td><td align="center" valign="middle">
   <a href="https://quander.io/" target="_blank"><img src="https://nestjs.com/img/quander.png" width="100" valign="middle" /></a> </td></tr><tr><td align="center" valign="middle">
   <a href="https://mantro.net/" target="_blank"><img src="https://nestjs.com/img/mantro-logo.svg" width="95" valign="middle" /></a> </td><td align="center" valign="middle">
@@ -117,6 +129,14 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/naologic-logo.svg" width="125" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://messaged.com/" target="_blank"><img src="https://nestjs.com/img/messaged-logo.png" width="50" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/triplecore-logo.svg" width="50" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://klqc.de" target="_blank"><img src="https://nestjs.com/img/klcqcl-logo.png" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://thecasinowizard.com/bonuses/no-deposit-bonuses/" target="_blank"><img src="https://nestjs.com/img/casinowizard-logo.png" width="120" valign="middle" /></a></td></tr><tr>
+     <td align="center" valign="middle"><a href="https://polygon-software.ch/" target="_blank"><img src="https://nestjs.com/img/polygon-logo.svg" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://mobilereality.pl/" target="_blank"><img src="https://nestjs.com/img/mobile-reality-logo.png" width="45" valign="middle" /></a></td>
+     <td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/boringowl-logo.svg" width="120" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://www.mobilefactory.jp/" target="_blank"><img src="https://nestjs.com/img/mobilefactory-logo.png" width="100" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://nordbot.app/" target="_blank"><img src="https://nestjs.com/img/nordbot-logo.png" width="120" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://doppio.sh/" target="_blank"><img src="https://nestjs.com/img/dopiosh-logo.png" width="50" valign="middle" /></a></td>
   </tr></table>
 
 ## Backers
diff --git a/packages/platform-express/adapters/express-adapter.ts b/packages/platform-express/adapters/express-adapter.ts
index bb2ae7337..7a0597778 100644
--- a/packages/platform-express/adapters/express-adapter.ts
+++ b/packages/platform-express/adapters/express-adapter.ts
@@ -1,14 +1,15 @@
+import type { Server } from 'http';
 import {
+  HttpStatus,
   InternalServerErrorException,
+  Logger,
   RequestMethod,
   StreamableFile,
-  VersioningType,
-} from '@nestjs/common';
-import {
   VersioningOptions,
-  VersionValue,
+  VersioningType,
   VERSION_NEUTRAL,
-} from '@nestjs/common/interfaces';
+} from '@nestjs/common';
+import { VersionValue } from '@nestjs/common/interfaces';
 import {
   CorsOptions,
   CorsOptionsDelegate,
@@ -19,18 +20,43 @@ import {
   isNil,
   isObject,
   isString,
+  isUndefined,
 } from '@nestjs/common/utils/shared.utils';
 import { AbstractHttpAdapter } from '@nestjs/core/adapters/http-adapter';
 import { RouterMethodFactory } from '@nestjs/core/helpers/router-method-factory';
-import * as bodyParser from 'body-parser';
+import {
+  json as bodyParserJson,
+  urlencoded as bodyParserUrlencoded,
+} from 'body-parser';
+import * as bodyparser from 'body-parser';
 import * as cors from 'cors';
 import * as express from 'express';
 import * as http from 'http';
 import * as https from 'https';
+import { Duplex, pipeline } from 'stream';
+import { NestExpressBodyParserOptions } from '../interfaces/nest-express-body-parser-options.interface';
+import { NestExpressBodyParserType } from '../interfaces/nest-express-body-parser.interface';
 import { ServeStaticOptions } from '../interfaces/serve-static-options.interface';
-
-export class ExpressAdapter extends AbstractHttpAdapter {
+import { getBodyParserOptions } from './utils/get-body-parser-options.util';
+
+type VersionedRoute = <
+  TRequest extends Record<string, any> = any,
+  TResponse = any,
+>(
+  req: TRequest,
+  res: TResponse,
+  next: () => void,
+) => any;
+
+/**
+ * @publicApi
+ */
+export class ExpressAdapter extends AbstractHttpAdapter<
+  http.Server | https.Server
+> {
   private readonly routerMethodFactory = new RouterMethodFactory();
+  private readonly logger = new Logger(ExpressAdapter.name);
+  private readonly openConnections = new Set<Duplex>();
 
   constructor(instance?: any) {
     super(instance || express());
@@ -45,13 +71,45 @@ export class ExpressAdapter extends AbstractHttpAdapter {
     }
     if (body instanceof StreamableFile) {
       const streamHeaders = body.getHeaders();
-      if (response.getHeader('Content-Type') === undefined) {
+      if (
+        response.getHeader('Content-Type') === undefined &&
+        streamHeaders.type !== undefined
+      ) {
         response.setHeader('Content-Type', streamHeaders.type);
       }
-      if (response.getHeader('Content-Disposition') === undefined) {
+      if (
+        response.getHeader('Content-Disposition') === undefined &&
+        streamHeaders.disposition !== undefined
+      ) {
         response.setHeader('Content-Disposition', streamHeaders.disposition);
       }
-      return body.getStream().pipe(response);
+      if (
+        response.getHeader('Content-Length') === undefined &&
+        streamHeaders.length !== undefined
+      ) {
+        response.setHeader('Content-Length', streamHeaders.length);
+      }
+      return pipeline(
+        body.getStream().once('error', (err: Error) => {
+          body.errorHandler(err, response);
+        }),
+        response,
+        (err: Error) => {
+          if (err) {
+            this.logger.error(err.message, err.stack);
+          }
+        },
+      );
+    }
+    if (
+      response.getHeader('Content-Type') !== undefined &&
+      response.getHeader('Content-Type') !== 'application/json' &&
+      body?.statusCode >= HttpStatus.BAD_REQUEST
+    ) {
+      this.logger.warn(
+        "Content-Type doesn't match Reply body, you might need a custom ExceptionFilter for non-JSON responses",
+      );
+      response.setHeader('Content-Type', 'application/json');
     }
     return isObject(body) ? response.json(body) : response.send(String(body));
   }
@@ -60,6 +118,10 @@ export class ExpressAdapter extends AbstractHttpAdapter {
     return response.status(statusCode);
   }
 
+  public end(response: any, message?: string) {
+    return response.end(message);
+  }
+
   public render(response: any, view: string, options: any) {
     return response.render(view, options);
   }
@@ -76,17 +138,27 @@ export class ExpressAdapter extends AbstractHttpAdapter {
     return this.use(handler);
   }
 
+  public isHeadersSent(response: any): boolean {
+    return response.headersSent;
+  }
+
   public setHeader(response: any, name: string, value: string) {
     return response.set(name, value);
   }
 
-  public listen(port: string | number, callback?: () => void);
-  public listen(port: string | number, hostname: string, callback?: () => void);
-  public listen(port: any, ...args: any[]) {
+  public listen(port: string | number, callback?: () => void): Server;
+  public listen(
+    port: string | number,
+    hostname: string,
+    callback?: () => void,
+  ): Server;
+  public listen(port: any, ...args: any[]): Server {
     return this.httpServer.listen(port, ...args);
   }
 
   public close() {
+    this.closeOpenConnections();
+
     if (!this.httpServer) {
       return undefined;
     }
@@ -155,21 +227,43 @@ export class ExpressAdapter extends AbstractHttpAdapter {
         options.httpsOptions,
         this.getInstance(),
       );
-      return;
+    } else {
+      this.httpServer = http.createServer(this.getInstance());
+    }
+
+    if (options?.forceCloseConnections) {
+      this.trackOpenConnections();
     }
-    this.httpServer = http.createServer(this.getInstance());
   }
 
-  public registerParserMiddleware() {
+  public registerParserMiddleware(prefix?: string, rawBody?: boolean) {
+    const bodyParserJsonOptions = getBodyParserOptions(rawBody);
+    const bodyParserUrlencodedOptions = getBodyParserOptions(rawBody, {
+      extended: true,
+    });
+
     const parserMiddleware = {
-      jsonParser: bodyParser.json(),
-      urlencodedParser: bodyParser.urlencoded({ extended: true }),
+      jsonParser: bodyParserJson(bodyParserJsonOptions),
+      urlencodedParser: bodyParserUrlencoded(bodyParserUrlencodedOptions),
     };
     Object.keys(parserMiddleware)
       .filter(parser => !this.isMiddlewareApplied(parser))
       .forEach(parserKey => this.use(parserMiddleware[parserKey]));
   }
 
+  public useBodyParser<Options = NestExpressBodyParserOptions>(
+    type: NestExpressBodyParserType,
+    rawBody: boolean,
+    options?: Omit<Options, 'verify'>,
+  ): this {
+    const parserOptions = getBodyParserOptions<Options>(rawBody, options);
+    const parser = bodyparser[type](parserOptions);
+
+    this.use(parser);
+
+    return this;
+  }
+
   public setLocal(key: string, value: any) {
     this.instance.locals[key] = value;
     return this;
@@ -183,21 +277,76 @@ export class ExpressAdapter extends AbstractHttpAdapter {
     handler: Function,
     version: VersionValue,
     versioningOptions: VersioningOptions,
-  ) {
-    return <TRequest extends Record<string, any> = any, TResponse = any>(
-      req: TRequest,
-      res: TResponse,
-      next: () => void,
-    ) => {
-      if (version === VERSION_NEUTRAL) {
-        return handler(req, res, next);
+  ): VersionedRoute {
+    const callNextHandler: VersionedRoute = (req, res, next) => {
+      if (!next) {
+        throw new InternalServerErrorException(
+          'HTTP adapter does not support filtering on version',
+        );
       }
+      return next();
+    };
+
+    if (
+      version === VERSION_NEUTRAL ||
       // URL Versioning is done via the path, so the filter continues forward
-      if (versioningOptions.type === VersioningType.URI) {
-        return handler(req, res, next);
-      }
-      // Media Type (Accept Header) Versioning Handler
-      if (versioningOptions.type === VersioningType.MEDIA_TYPE) {
+      versioningOptions.type === VersioningType.URI
+    ) {
+      const handlerForNoVersioning: VersionedRoute = (req, res, next) =>
+        handler(req, res, next);
+
+      return handlerForNoVersioning;
+    }
+
+    // Custom Extractor Versioning Handler
+    if (versioningOptions.type === VersioningType.CUSTOM) {
+      const handlerForCustomVersioning: VersionedRoute = (req, res, next) => {
+        const extractedVersion = versioningOptions.extractor(req);
+
+        if (Array.isArray(version)) {
+          if (
+            Array.isArray(extractedVersion) &&
+            version.filter(v => extractedVersion.includes(v as string)).length
+          ) {
+            return handler(req, res, next);
+          }
+
+          if (
+            isString(extractedVersion) &&
+            version.includes(extractedVersion)
+          ) {
+            return handler(req, res, next);
+          }
+        } else if (isString(version)) {
+          // Known bug here - if there are multiple versions supported across separate
+          // handlers/controllers, we can't select the highest matching handler.
+          // Since this code is evaluated per-handler, then we can't see if the highest
+          // specified version exists in a different handler.
+          if (
+            Array.isArray(extractedVersion) &&
+            extractedVersion.includes(version)
+          ) {
+            return handler(req, res, next);
+          }
+
+          if (isString(extractedVersion) && version === extractedVersion) {
+            return handler(req, res, next);
+          }
+        }
+
+        return callNextHandler(req, res, next);
+      };
+
+      return handlerForCustomVersioning;
+    }
+
+    // Media Type (Accept Header) Versioning Handler
+    if (versioningOptions.type === VersioningType.MEDIA_TYPE) {
+      const handlerForMediaTypeVersioning: VersionedRoute = (
+        req,
+        res,
+        next,
+      ) => {
         const MEDIA_TYPE_HEADER = 'Accept';
         const acceptHeaderValue: string | undefined =
           req.headers?.[MEDIA_TYPE_HEADER] ||
@@ -205,9 +354,16 @@ export class ExpressAdapter extends AbstractHttpAdapter {
 
         const acceptHeaderVersionParameter = acceptHeaderValue
           ? acceptHeaderValue.split(';')[1]
-          : '';
+          : undefined;
 
-        if (acceptHeaderVersionParameter) {
+        // No version was supplied
+        if (isUndefined(acceptHeaderVersionParameter)) {
+          if (Array.isArray(version)) {
+            if (version.includes(VERSION_NEUTRAL)) {
+              return handler(req, res, next);
+            }
+          }
+        } else {
           const headerVersion = acceptHeaderVersionParameter.split(
             versioningOptions.key,
           )[1];
@@ -222,14 +378,28 @@ export class ExpressAdapter extends AbstractHttpAdapter {
             }
           }
         }
-      }
-      // Header Versioning Handler
-      else if (versioningOptions.type === VersioningType.HEADER) {
+
+        return callNextHandler(req, res, next);
+      };
+
+      return handlerForMediaTypeVersioning;
+    }
+
+    // Header Versioning Handler
+    if (versioningOptions.type === VersioningType.HEADER) {
+      const handlerForHeaderVersioning: VersionedRoute = (req, res, next) => {
         const customHeaderVersionParameter: string | undefined =
           req.headers?.[versioningOptions.header] ||
           req.headers?.[versioningOptions.header.toLowerCase()];
 
-        if (customHeaderVersionParameter) {
+        // No version was supplied
+        if (isUndefined(customHeaderVersionParameter)) {
+          if (Array.isArray(version)) {
+            if (version.includes(VERSION_NEUTRAL)) {
+              return handler(req, res, next);
+            }
+          }
+        } else {
           if (Array.isArray(version)) {
             if (version.includes(customHeaderVersionParameter)) {
               return handler(req, res, next);
@@ -240,15 +410,27 @@ export class ExpressAdapter extends AbstractHttpAdapter {
             }
           }
         }
-      }
 
-      if (!next) {
-        throw new InternalServerErrorException(
-          'HTTP adapter does not support filtering on version',
-        );
-      }
-      return next();
-    };
+        return callNextHandler(req, res, next);
+      };
+
+      return handlerForHeaderVersioning;
+    }
+  }
+
+  private trackOpenConnections() {
+    this.httpServer.on('connection', (socket: Duplex) => {
+      this.openConnections.add(socket);
+
+      socket.on('close', () => this.openConnections.delete(socket));
+    });
+  }
+
+  private closeOpenConnections() {
+    for (const socket of this.openConnections) {
+      socket.destroy();
+      this.openConnections.delete(socket);
+    }
   }
 
   private isMiddlewareApplied(name: string): boolean {
diff --git a/packages/platform-express/adapters/utils/get-body-parser-options.util.ts b/packages/platform-express/adapters/utils/get-body-parser-options.util.ts
new file mode 100644
index 000000000..c89ed92ab
--- /dev/null
+++ b/packages/platform-express/adapters/utils/get-body-parser-options.util.ts
@@ -0,0 +1,30 @@
+import type { RawBodyRequest } from '@nestjs/common';
+import type { IncomingMessage, ServerResponse } from 'http';
+import type { NestExpressBodyParserOptions } from '../../interfaces';
+
+const rawBodyParser = (
+  req: RawBodyRequest<IncomingMessage>,
+  _res: ServerResponse,
+  buffer: Buffer,
+) => {
+  if (Buffer.isBuffer(buffer)) {
+    req.rawBody = buffer;
+  }
+  return true;
+};
+
+export function getBodyParserOptions<Options = NestExpressBodyParserOptions>(
+  rawBody: boolean,
+  options?: Omit<Options, 'verify'> | undefined,
+): Options {
+  let parserOptions: Options = (options || {}) as Options;
+
+  if (rawBody === true) {
+    parserOptions = {
+      ...parserOptions,
+      verify: rawBodyParser,
+    };
+  }
+
+  return parserOptions;
+}
diff --git a/packages/platform-express/index.ts b/packages/platform-express/index.ts
index df03ac629..ce3dbc432 100644
--- a/packages/platform-express/index.ts
+++ b/packages/platform-express/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @platform-express
- * Copyright(c) 2017 - 2021 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2023 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
diff --git a/packages/platform-express/interfaces/index.ts b/packages/platform-express/interfaces/index.ts
index 3238b1c16..ac057435a 100644
--- a/packages/platform-express/interfaces/index.ts
+++ b/packages/platform-express/interfaces/index.ts
@@ -1 +1,3 @@
 export * from './nest-express-application.interface';
+export { NestExpressBodyParserOptions } from './nest-express-body-parser-options.interface';
+export * from './nest-express-body-parser.interface';
diff --git a/packages/platform-express/interfaces/nest-express-application.interface.ts b/packages/platform-express/interfaces/nest-express-application.interface.ts
index 0b93c1dbf..62e31ebb8 100644
--- a/packages/platform-express/interfaces/nest-express-application.interface.ts
+++ b/packages/platform-express/interfaces/nest-express-application.interface.ts
@@ -1,4 +1,10 @@
-import { INestApplication } from '@nestjs/common';
+import { INestApplication, HttpServer } from '@nestjs/common';
+import type { Server as CoreHttpServer } from 'http';
+import type { Server as CoreHttpsServer } from 'https';
+import type { Server } from 'net';
+import type { Express } from 'express';
+import { NestExpressBodyParserOptions } from './nest-express-body-parser-options.interface';
+import { NestExpressBodyParserType } from './nest-express-body-parser.interface';
 import { ServeStaticOptions } from './serve-static-options.interface';
 
 /**
@@ -8,7 +14,31 @@ import { ServeStaticOptions } from './serve-static-options.interface';
  *
  * @publicApi
  */
-export interface NestExpressApplication extends INestApplication {
+export interface NestExpressApplication<
+  TServer extends CoreHttpServer | CoreHttpsServer = CoreHttpServer,
+> extends INestApplication<TServer> {
+  /**
+   * Returns the underlying HTTP adapter bounded to the Express.js app.
+   *
+   * @returns {HttpServer}
+   */
+  getHttpAdapter(): HttpServer<Express.Request, Express.Response, Express>;
+
+  /**
+   * Starts the application.
+   *
+   * @param {number|string} port
+   * @param {string} [hostname]
+   * @param {Function} [callback] Optional callback
+   * @returns {Promise} A Promise that, when resolved, is a reference to the underlying HttpServer.
+   */
+  listen(port: number | string, callback?: () => void): Promise<Server>;
+  listen(
+    port: number | string,
+    hostname: string,
+    callback?: () => void,
+  ): Promise<Server>;
+
   /**
    * A wrapper function around native `express.set()` method.
    *
@@ -57,6 +87,24 @@ export interface NestExpressApplication extends INestApplication {
    */
   useStaticAssets(path: string, options?: ServeStaticOptions): this;
 
+  /**
+   * Register Express body parsers on the fly. Will respect
+   * the application's `rawBody` option.
+   *
+   * @example
+   * const app = await NestFactory.create<NestExpressApplication>(
+   *   AppModule,
+   *   { rawBody: true }
+   * );
+   * app.useBodyParser('json', { limit: '50mb' });
+   *
+   * @returns {this}
+   */
+  useBodyParser<Options = NestExpressBodyParserOptions>(
+    parser: NestExpressBodyParserType,
+    options?: Omit<Options, 'verify'>,
+  ): this;
+
   /**
    * Sets one or multiple base directories for templates (views).
    *
diff --git a/packages/platform-express/interfaces/nest-express-body-parser-options.interface.ts b/packages/platform-express/interfaces/nest-express-body-parser-options.interface.ts
new file mode 100644
index 000000000..93df3c5f6
--- /dev/null
+++ b/packages/platform-express/interfaces/nest-express-body-parser-options.interface.ts
@@ -0,0 +1,26 @@
+import type { IncomingMessage } from 'http';
+
+/**
+ * Type alias to keep compatibility with @types/body-parser
+ * @see https://github.com/DefinitelyTyped/DefinitelyTyped/blob/dcd1673c4fa18a15ea8cd8ff8af7d563bb6dc8e6/types/body-parser/index.d.ts#L48-L66#L48-L66
+ * @publicApi
+ */
+export interface NestExpressBodyParserOptions {
+  /** When set to true, then deflated (compressed) bodies will be inflated; when false, deflated bodies are rejected. Defaults to true. */
+  inflate?: boolean | undefined;
+
+  /**
+   * Controls the maximum request body size. If this is a number,
+   * then the value specifies the number of bytes; if it is a string,
+   * the value is passed to the bytes library for parsing. Defaults to '100kb'.
+   */
+  limit?: number | string | undefined;
+
+  /**
+   * The type option is used to determine what media type the middleware will parse
+   */
+  type?: string | string[] | ((req: IncomingMessage) => any) | undefined;
+
+  // Catch-all for body-parser type specific options
+  [key: string]: unknown;
+}
diff --git a/packages/platform-express/interfaces/nest-express-body-parser.interface.ts b/packages/platform-express/interfaces/nest-express-body-parser.interface.ts
new file mode 100644
index 000000000..9cb003054
--- /dev/null
+++ b/packages/platform-express/interfaces/nest-express-body-parser.interface.ts
@@ -0,0 +1,4 @@
+/**
+ * Interface defining possible body parser types, to be used with `NestExpressApplication.useBodyParser()`.
+ */
+export type NestExpressBodyParserType = 'json' | 'urlencoded' | 'text' | 'raw';
diff --git a/packages/platform-express/multer/interfaces/files-upload-module.interface.ts b/packages/platform-express/multer/interfaces/files-upload-module.interface.ts
index d467e476e..50ef58802 100644
--- a/packages/platform-express/multer/interfaces/files-upload-module.interface.ts
+++ b/packages/platform-express/multer/interfaces/files-upload-module.interface.ts
@@ -1,5 +1,4 @@
-import { Type } from '@nestjs/common';
-import { ModuleMetadata } from '@nestjs/common/interfaces';
+import { ModuleMetadata, Type } from '@nestjs/common/interfaces';
 import { MulterOptions } from './multer-options.interface';
 
 export type MulterModuleOptions = MulterOptions;
diff --git a/packages/platform-express/multer/multer/multer.constants.ts b/packages/platform-express/multer/multer/multer.constants.ts
index e3c7b4557..5a6f6aaa4 100644
--- a/packages/platform-express/multer/multer/multer.constants.ts
+++ b/packages/platform-express/multer/multer/multer.constants.ts
@@ -1,4 +1,5 @@
 export const multerExceptions = {
+  // from https://github.com/expressjs/multer/blob/master/lib/multer-error.js
   LIMIT_PART_COUNT: 'Too many parts',
   LIMIT_FILE_SIZE: 'File too large',
   LIMIT_FILE_COUNT: 'Too many files',
@@ -6,4 +7,13 @@ export const multerExceptions = {
   LIMIT_FIELD_VALUE: 'Field value too long',
   LIMIT_FIELD_COUNT: 'Too many fields',
   LIMIT_UNEXPECTED_FILE: 'Unexpected field',
+  MISSING_FIELD_NAME: 'Field name missing',
+};
+
+export const busboyExceptions = {
+  // from https://github.com/mscdex/busboy/blob/master/lib/types/multipart.js
+  MULTIPART_BOUNDARY_NOT_FOUND: 'Multipart: Boundary not found',
+  MULTIPART_MALFORMED_PART_HEADER: 'Malformed part header',
+  MULTIPART_UNEXPECTED_END_OF_FORM: 'Unexpected end of form',
+  MULTIPART_UNEXPECTED_END_OF_FILE: 'Unexpected end of file',
 };
diff --git a/packages/platform-express/multer/multer/multer.utils.ts b/packages/platform-express/multer/multer/multer.utils.ts
index 81e19739c..9df215832 100644
--- a/packages/platform-express/multer/multer/multer.utils.ts
+++ b/packages/platform-express/multer/multer/multer.utils.ts
@@ -3,7 +3,7 @@ import {
   HttpException,
   PayloadTooLargeException,
 } from '@nestjs/common';
-import { multerExceptions } from './multer.constants';
+import { multerExceptions, busboyExceptions } from './multer.constants';
 
 export function transformException(error: Error | undefined) {
   if (!error || error instanceof HttpException) {
@@ -18,7 +18,14 @@ export function transformException(error: Error | undefined) {
     case multerExceptions.LIMIT_FIELD_COUNT:
     case multerExceptions.LIMIT_UNEXPECTED_FILE:
     case multerExceptions.LIMIT_PART_COUNT:
+    case multerExceptions.MISSING_FIELD_NAME:
       return new BadRequestException(error.message);
+    case busboyExceptions.MULTIPART_BOUNDARY_NOT_FOUND:
+      return new BadRequestException(error.message);
+    case busboyExceptions.MULTIPART_MALFORMED_PART_HEADER:
+    case busboyExceptions.MULTIPART_UNEXPECTED_END_OF_FORM:
+    case busboyExceptions.MULTIPART_UNEXPECTED_END_OF_FILE:
+      return new BadRequestException(`Multipart: ${error.message}`);
   }
   return error;
 }
diff --git a/packages/platform-express/package.json b/packages/platform-express/package.json
index d2843a9cf..e113761f2 100644
--- a/packages/platform-express/package.json
+++ b/packages/platform-express/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/platform-express",
-  "version": "8.2.3",
+  "version": "9.4.0",
   "description": "Nest - modern, fast, powerful node.js web framework (@platform-express)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -17,18 +17,18 @@
     "access": "public"
   },
   "dependencies": {
-    "body-parser": "1.19.0",
+    "body-parser": "1.20.2",
     "cors": "2.8.5",
-    "express": "4.17.1",
-    "multer": "1.4.3",
-    "tslib": "2.3.1"
+    "express": "4.18.2",
+    "multer": "1.4.4-lts.1",
+    "tslib": "2.5.0"
   },
   "devDependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3"
+    "@nestjs/common": "9.4.0",
+    "@nestjs/core": "9.4.0"
   },
   "peerDependencies": {
-    "@nestjs/common": "^8.0.0",
-    "@nestjs/core": "^8.0.0"
+    "@nestjs/common": "^9.0.0",
+    "@nestjs/core": "^9.0.0"
   }
 }
diff --git a/packages/platform-express/test/multer/multer/multer.utils.spec.ts b/packages/platform-express/test/multer/multer/multer.utils.spec.ts
index 7ad1eec90..f3745b936 100644
--- a/packages/platform-express/test/multer/multer/multer.utils.spec.ts
+++ b/packages/platform-express/test/multer/multer/multer.utils.spec.ts
@@ -4,18 +4,21 @@ import {
   PayloadTooLargeException,
 } from '@nestjs/common';
 import { expect } from 'chai';
-import { multerExceptions } from '../../../multer/multer/multer.constants';
+import {
+  multerExceptions,
+  busboyExceptions,
+} from '../../../multer/multer/multer.constants';
 import { transformException } from '../../../multer/multer/multer.utils';
 
 describe('transformException', () => {
   describe('if error does not exist', () => {
-    it('behave as identity', () => {
+    it('should behave as identity', () => {
       const err = undefined;
       expect(transformException(err)).to.be.eq(err);
     });
   });
   describe('if error is instance of HttpException', () => {
-    it('behave as identity', () => {
+    it('should behave as identity', () => {
       const err = new HttpException('response', 500);
       expect(transformException(err)).to.be.eq(err);
     });
@@ -37,5 +40,22 @@ describe('transformException', () => {
         );
       });
     });
+    describe('and is busboy/multipart exception', () => {
+      it('should return "BadRequestException"', () => {
+        const err = { message: busboyExceptions.MULTIPART_BOUNDARY_NOT_FOUND };
+        expect(transformException(err as any)).to.be.instanceof(
+          BadRequestException,
+        );
+      });
+
+      it('should return "BadRequestException"', () => {
+        const err = {
+          message: busboyExceptions.MULTIPART_UNEXPECTED_END_OF_FORM,
+        };
+        expect(transformException(err as any)).to.be.instanceof(
+          BadRequestException,
+        );
+      });
+    });
   });
 });
diff --git a/packages/platform-express/test/tsconfig.json b/packages/platform-express/test/tsconfig.json
new file mode 100644
index 000000000..50d59661d
--- /dev/null
+++ b/packages/platform-express/test/tsconfig.json
@@ -0,0 +1,3 @@
+{
+  "extends": "../../../tsconfig.spec.json"
+}
diff --git a/packages/platform-express/tsconfig.build.json b/packages/platform-express/tsconfig.build.json
new file mode 100644
index 000000000..732ca00cb
--- /dev/null
+++ b/packages/platform-express/tsconfig.build.json
@@ -0,0 +1,22 @@
+{
+  "extends": "../tsconfig.build.json",
+  "compilerOptions": {
+    "outDir": ".",
+    "rootDir": ".",
+    "paths": {
+      "@nestjs/common": ["../common"],
+      "@nestjs/common/*": ["../common/*"],
+      "@nestjs/core": ["../core"],
+      "@nestjs/core/*": ["../core/*"]
+    }
+  },
+  "exclude": ["node_modules", "dist", "test/**/*", "*.spec.ts"],
+  "references": [
+    {
+      "path": "../common/tsconfig.build.json"
+    },
+    {
+      "path": "../core/tsconfig.build.json"
+    }
+  ]
+}
diff --git a/packages/platform-express/tsconfig.json b/packages/platform-express/tsconfig.json
index b238080a4..2ae9e3c90 100644
--- a/packages/platform-express/tsconfig.json
+++ b/packages/platform-express/tsconfig.json
@@ -1,7 +1,13 @@
 {
-  "extends": "./../tsconfig.base.json",
+  "extends": "../tsconfig.build.json",
   "compilerOptions": {
-    "baseUrl": "./"
+    "types": ["node"]
   },
-  "include": ["*.ts", "**/*.ts"]
+  "files": [],
+  "include": [],
+  "references": [
+    {
+      "path": "./tsconfig.build.json"
+    }
+  ]
 }
diff --git a/packages/platform-fastify/CHANGELOG.md b/packages/platform-fastify/CHANGELOG.md
deleted file mode 100644
index 8c9c6cd94..000000000
--- a/packages/platform-fastify/CHANGELOG.md
+++ /dev/null
@@ -1,18 +0,0 @@
-# Change Log
-
-All notable changes to this project will be documented in this file.
-See [Conventional Commits](https://conventionalcommits.org) for commit guidelines.
-
-<a name="8.2.0"></a>
-# [8.2.0](https://github.com/nestjs/nest/compare/v8.1.2...v8.2.0) (2021-11-08)
-
-
-### Bug Fixes
-
-* **deps:** update dependency fastify to v3.23.1 ([63113d8](https://github.com/nestjs/nest/commit/63113d8))
-* **platform-fastify:** fix streamable file processing ([365c40b](https://github.com/nestjs/nest/commit/365c40b))
-
-
-### Features
-
-* **common:** add the ability to set some extra metadata about returned files ([5100573](https://github.com/nestjs/nest/commit/5100573))
diff --git a/packages/platform-fastify/Readme.md b/packages/platform-fastify/Readme.md
index f288809a9..16f48336d 100644
--- a/packages/platform-fastify/Readme.md
+++ b/packages/platform-fastify/Readme.md
@@ -11,7 +11,6 @@
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
 <a href="https://circleci.com/gh/nestjs/nest" target="_blank"><img src="https://img.shields.io/circleci/build/github/nestjs/nest/master" alt="CircleCI" /></a>
-<a href="https://coveralls.io/github/nestjs/nest?branch=master" target="_blank"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#9" alt="Coverage" /></a>
 <a href="https://discord.gg/G7Qnnhy" target="_blank"><img src="https://img.shields.io/badge/discord-online-brightgreen.svg" alt="Discord"/></a>
 <a href="https://opencollective.com/nest#backer" target="_blank"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
 <a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
@@ -37,8 +36,8 @@ Nest is a framework for building efficient, scalable <a href="http://nodejs.org"
 
 * To check out the [guide](https://docs.nestjs.com), visit [docs.nestjs.com](https://docs.nestjs.com). :books:
 * Ë¶ÅÊü•Áúã‰∏≠Êñá [ÊåáÂçó](readme_zh.md), ËØ∑ËÆøÈóÆ [docs.nestjs.cn](https://docs.nestjs.cn). :books:
-* [Í∞ÄÏù¥Îìú](readme_kr.md)Î•º ÌôïÏù∏ÌïòÎ†§Î©¥, [docs.nestjs.com](https://docs.nestjs.com)Î•º Î∞©Î¨∏ÌïòÏÑ∏Ïöî.:books: 
-* „ÉÅ„Çß„ÉÉ„ÇØ„Åô„Çã„Å´„ÅØ [„Ç¨„Ç§„Éâ](readme_jp.md), Ë©≥„Åó„Åè„ÅØ [docs.nestjs.com](https://docs.nestjs.com). :books: 
+* [Í∞ÄÏù¥Îìú](readme_kr.md) Î¨∏ÏÑúÎäî [docs.nestjs.com](https://docs.nestjs.com)ÏóêÏÑú ÌôïÏù∏ÌïòÏã§ Ïàò ÏûàÏäµÎãàÎã§. :books:
+* [„Ç¨„Ç§„Éâ](readme_jp.md)„ÅØ [docs.nestjs.com](https://docs.nestjs.com)„Åß„ÅîÁ¢∫Ë™ç„Åè„Å†„Åï„ÅÑ„ÄÇ :books:
 
 ## Questions
 
@@ -54,36 +53,49 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
 <table style="text-align:center;"><tr>
   <td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
+  <td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/red-hat-logo.svg" width="200" valign="middle" /></a></td>
 <td>
 <a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
 <td>
 <a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
+    <td>
+<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td><td>
+<a href="https://amplication.com/" target="_blank"><img src="https://nestjs.com/img/amplication-logo.svg" width="190" valign="middle" /></a></td>
 </tr></table>
 
 #### Gold Sponsors
 
 <table style="text-align:center;"><tr><td>
-  <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
-  <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
+<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="140" valign="middle" /></a></td>
 <td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
+<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td>
+ <td>
+<a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
+<a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td><td>
+<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td>
+<td>
+<a href="https://ridicorp.com/career/" target="_blank"><img src="https://nestjs.com/img/ridi-logo.svg" width="105" valign="middle" /></a></td><td>
+<a href="https://www.movavi.com/imovie-for-windows.html" target="_blank"><img src="https://nestjs.com/img/movavi-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
 <table style="text-align:center;"><tr><td>
 <a href="https://neoteric.eu/" target="_blank"><img src="https://nestjs.com/img/neoteric-cut.png" width="120" valign="middle" /></a> </td><td>
   <a href="http://gojob.com" target="_blank"><img src="http://nestjs.com/img/gojob-logo.png" valign="middle" width="100" /></a> </td><td>
-<a href="http://www.leogistics.com" target="_blank"><img src="https://nestjs.com/img/leogistics-logo.jpeg" width="150" valign="middle" /></td><td>
+<a href="https://www.myleodsc.com/" target="_blank"><img src="https://nestjs.com/img/myleo-logo.png" width="180" valign="middle" /></td><td>
 <a href="https://careers.meetdandy.com/?gh_src=063ba61e3us" target="_blank"><img src="https://nestjs.com/img/dandy-roles-logo.svg" width="150" valign="middle" /></td><td>
 <a href="https://www.castlecraft.in" target="_blank"><img src="https://nestjs.com/img/castlecraft-logo.png" width="150" valign="middle" /></td>
-<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td></tr></table>
+<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td>
+<td><a href="https://n.inc" target="_blank"><img src="https://nestjs.com/img/n-inc-logo.svg" width="120" valign="middle" /></td></tr><tr>
+<td><a href="https://bilberrry.com/" target="_blank"><img src="https://nestjs.com/img/bilberrry-logo.svg" width="180" valign="middle" /></td>
+<td><a href="https://ipinfo.ai/" target="_blank"><img src="https://nestjs.com/img/ipinfo-logo.png" width="130" valign="middle" /></td>
+<td><a href="https://chax.at" target="_blank"><img src="https://nestjs.com/img/chaxat-logo.png" width="100" valign="middle" /></td></tr>
+</table>
 
 #### Sponsors
 
@@ -91,7 +103,7 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <a href="https://www.swingdev.io" target="_blank"><img src="https://nestjs.com/img/swingdev-logo.svg#1" width="110" valign="middle" /> </a></td><td align="center" valign="middle">
 <a href="https://www.novologic.com/" target="_blank"><img src="https://nestjs.com/img/novologic.png" width="110" valign="middle" /></a> </td><td align="center" valign="middle">
 <a href="https://ever.co/" target="_blank"><img src="https://nestjs.com/img/ever-logo.png" width="72" valign="middle" /></a>  </td><td align="center" valign="middle">
-<a href="https://blokt.com" target="_blank"><img src="https://nestjs.com/img/blokt-logo.png" width="120" valign="middle" /></a>  </td><td align="center" valign="middle"> 
+<a href="https://blokt.com" target="_blank"><img src="https://nestjs.com/img/blokt-logo.png" width="120" valign="middle" /></a>  </td><td align="center" valign="middle">
   <a href="http://architectnow.net/" target="_blank"><img src="https://nestjs.com/img/architectnow.png" width="125" valign="middle" /></a> </td><td align="center" valign="middle">
   <a href="https://quander.io/" target="_blank"><img src="https://nestjs.com/img/quander.png" width="100" valign="middle" /></a> </td></tr><tr><td align="center" valign="middle">
   <a href="https://mantro.net/" target="_blank"><img src="https://nestjs.com/img/mantro-logo.svg" width="95" valign="middle" /></a> </td><td align="center" valign="middle">
@@ -117,6 +129,14 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/naologic-logo.svg" width="125" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://messaged.com/" target="_blank"><img src="https://nestjs.com/img/messaged-logo.png" width="50" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/triplecore-logo.svg" width="50" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://klqc.de" target="_blank"><img src="https://nestjs.com/img/klcqcl-logo.png" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://thecasinowizard.com/bonuses/no-deposit-bonuses/" target="_blank"><img src="https://nestjs.com/img/casinowizard-logo.png" width="120" valign="middle" /></a></td></tr><tr>
+     <td align="center" valign="middle"><a href="https://polygon-software.ch/" target="_blank"><img src="https://nestjs.com/img/polygon-logo.svg" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://mobilereality.pl/" target="_blank"><img src="https://nestjs.com/img/mobile-reality-logo.png" width="45" valign="middle" /></a></td>
+     <td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/boringowl-logo.svg" width="120" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://www.mobilefactory.jp/" target="_blank"><img src="https://nestjs.com/img/mobilefactory-logo.png" width="100" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://nordbot.app/" target="_blank"><img src="https://nestjs.com/img/nordbot-logo.png" width="120" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://doppio.sh/" target="_blank"><img src="https://nestjs.com/img/dopiosh-logo.png" width="50" valign="middle" /></a></td>
   </tr></table>
 
 ## Backers
diff --git a/packages/platform-fastify/adapters/fastify-adapter.ts b/packages/platform-fastify/adapters/fastify-adapter.ts
index 77ac6ae16..06aa48d7e 100644
--- a/packages/platform-fastify/adapters/fastify-adapter.ts
+++ b/packages/platform-fastify/adapters/fastify-adapter.ts
@@ -1,24 +1,30 @@
 import {
   HttpStatus,
   Logger,
+  RawBodyRequest,
   RequestMethod,
   StreamableFile,
   VersioningOptions,
   VersioningType,
+  VERSION_NEUTRAL,
 } from '@nestjs/common';
-import { VersionValue, VERSION_NEUTRAL } from '@nestjs/common/interfaces';
+import { VersionValue } from '@nestjs/common/interfaces';
 import {
   CorsOptions,
   CorsOptionsDelegate,
 } from '@nestjs/common/interfaces/external/cors-options.interface';
 import { loadPackage } from '@nestjs/common/utils/load-package.util';
+import { isString, isUndefined } from '@nestjs/common/utils/shared.utils';
 import { AbstractHttpAdapter } from '@nestjs/core/adapters/http-adapter';
 import {
   fastify,
+  FastifyBaseLogger,
+  FastifyBodyParser,
   FastifyInstance,
-  FastifyLoggerInstance,
+  FastifyListenOptions,
   FastifyPluginAsync,
   FastifyPluginCallback,
+  FastifyRegister,
   FastifyReply,
   FastifyRequest,
   FastifyServerOptions,
@@ -29,6 +35,7 @@ import {
   RequestGenericInterface,
 } from 'fastify';
 import * as Reply from 'fastify/lib/reply';
+import { kRouteContext } from 'fastify/lib/symbols';
 import { RouteShorthandMethod } from 'fastify/types/route';
 import * as http2 from 'http2';
 import * as https from 'https';
@@ -37,14 +44,17 @@ import {
   InjectOptions,
   Response as LightMyRequestResponse,
 } from 'light-my-request';
+// `querystring` is used internally in fastify for registering urlencoded body parser.
+import { parse as querystringParse } from 'querystring';
+import { NestFastifyBodyParserOptions } from '../interfaces';
 import {
   FastifyStaticOptions,
-  PointOfViewOptions,
+  FastifyViewOptions,
 } from '../interfaces/external';
 
 type FastifyHttp2SecureOptions<
   Server extends http2.Http2SecureServer,
-  Logger extends FastifyLoggerInstance = FastifyLoggerInstance,
+  Logger extends FastifyBaseLogger = FastifyBaseLogger,
 > = FastifyServerOptions<Server, Logger> & {
   http2: true;
   https: http2.SecureServerOptions;
@@ -52,7 +62,7 @@ type FastifyHttp2SecureOptions<
 
 type FastifyHttp2Options<
   Server extends http2.Http2Server,
-  Logger extends FastifyLoggerInstance = FastifyLoggerInstance,
+  Logger extends FastifyBaseLogger = FastifyBaseLogger,
 > = FastifyServerOptions<Server, Logger> & {
   http2: true;
   http2SessionTimeout?: number;
@@ -60,12 +70,16 @@ type FastifyHttp2Options<
 
 type FastifyHttpsOptions<
   Server extends https.Server,
-  Logger extends FastifyLoggerInstance = FastifyLoggerInstance,
+  Logger extends FastifyBaseLogger = FastifyBaseLogger,
 > = FastifyServerOptions<Server, Logger> & {
   https: https.ServerOptions;
 };
 
-type VersionedRoute = Function & {
+type VersionedRoute<TRequest, TResponse> = ((
+  req: TRequest,
+  res: TResponse,
+  next: Function,
+) => Function) & {
   version: VersionValue;
   versioningOptions: VersioningOptions;
 };
@@ -79,6 +93,9 @@ type VersionedRoute = Function & {
 type FastifyRawRequest<TServer extends RawServerBase> =
   RawRequestDefaultExpression<TServer> & { originalUrl?: string };
 
+/**
+ * @publicApi
+ */
 export class FastifyAdapter<
   TServer extends RawServerBase = RawServerDefault,
   TRawRequest extends FastifyRawRequest<TServer> = FastifyRawRequest<TServer>,
@@ -107,30 +124,34 @@ export class FastifyAdapter<
   private readonly versionConstraint = {
     name: 'version',
     validate(value: unknown) {
-      if (typeof value !== 'string' && !Array.isArray(value)) {
+      if (!isString(value) && !Array.isArray(value)) {
         throw new Error(
           'Version constraint should be a string or an array of strings.',
         );
       }
     },
     storage() {
-      const versions = new Map();
+      const versions = new Map<string, unknown>();
       return {
         get(version: string | Array<string>) {
+          if (Array.isArray(version)) {
+            return versions.get(version.find(v => versions.has(v))) || null;
+          }
           return versions.get(version) || null;
         },
-        set(
-          versionOrVersions: string | Array<string>,
-          store: Map<string, any>,
-        ) {
-          const storeVersionConstraint = version =>
+        set(versionOrVersions: string | Array<string>, store: unknown) {
+          const storeVersionConstraint = (version: string) =>
             versions.set(version, store);
           if (Array.isArray(versionOrVersions))
             versionOrVersions.forEach(storeVersionConstraint);
           else storeVersionConstraint(versionOrVersions);
         },
         del(version: string | Array<string>) {
-          versions.delete(version);
+          if (Array.isArray(version)) {
+            version.forEach(v => versions.delete(v));
+          } else {
+            versions.delete(version);
+          }
         },
         empty() {
           versions.clear();
@@ -149,12 +170,9 @@ export class FastifyAdapter<
           ? acceptHeaderValue.split(';')[1]
           : '';
 
-        if (acceptHeaderVersionParameter) {
-          const headerVersion = acceptHeaderVersionParameter.split(
-            this.versioningOptions.key,
-          )[1];
-          return headerVersion;
-        }
+        return isUndefined(acceptHeaderVersionParameter)
+          ? VERSION_NEUTRAL // No version was supplied
+          : acceptHeaderVersionParameter.split(this.versioningOptions.key)[1];
       }
       // Header Versioning Handler
       else if (this.versioningOptions.type === VersioningType.HEADER) {
@@ -162,9 +180,13 @@ export class FastifyAdapter<
           req.headers?.[this.versioningOptions.header] ||
           req.headers?.[this.versioningOptions.header.toLowerCase()];
 
-        if (customHeaderVersionParameter) {
-          return customHeaderVersionParameter;
-        }
+        return isUndefined(customHeaderVersionParameter)
+          ? VERSION_NEUTRAL // No version was supplied
+          : customHeaderVersionParameter;
+      }
+      // Custom Versioning Handler
+      else if (this.versioningOptions.type === VersioningType.CUSTOM) {
+        return this.versioningOptions.extractor(req);
       }
       return undefined;
     },
@@ -210,8 +232,31 @@ export class FastifyAdapter<
     hostname: string,
     callback?: () => void,
   ): void;
-  public listen(port: string | number, ...args: any[]): Promise<string> {
-    return this.instance.listen(port, ...args);
+  public listen(
+    listenOptions: string | number | FastifyListenOptions,
+    ...args: any[]
+  ): void {
+    const isFirstArgTypeofFunction = typeof args[0] === 'function';
+    const callback = isFirstArgTypeofFunction ? args[0] : args[1];
+
+    let options: Record<string, any>;
+    if (
+      typeof listenOptions === 'object' &&
+      (listenOptions.host !== undefined ||
+        listenOptions.port !== undefined ||
+        listenOptions.path !== undefined)
+    ) {
+      // First parameter is an object with a path, port and/or host attributes
+      options = listenOptions;
+    } else {
+      options = {
+        port: +listenOptions,
+      };
+    }
+    if (!isFirstArgTypeofFunction) {
+      options.host = args[0];
+    }
+    return this.instance.listen(options, callback);
   }
 
   public get(...args: any[]) {
@@ -246,11 +291,11 @@ export class FastifyAdapter<
     handler: Function,
     version: VersionValue,
     versioningOptions: VersioningOptions,
-  ) {
+  ): VersionedRoute<TRequest, TReply> {
     if (!this.versioningOptions) {
       this.versioningOptions = versioningOptions;
     }
-    const versionedRoute = handler as VersionedRoute;
+    const versionedRoute = handler as VersionedRoute<TRequest, TReply>;
     versionedRoute.version = version;
     return versionedRoute;
   }
@@ -264,7 +309,7 @@ export class FastifyAdapter<
       ? new Reply(
           response,
           {
-            context: {
+            [kRouteContext]: {
               preSerialization: null,
               preValidation: [],
               preHandler: [],
@@ -281,14 +326,37 @@ export class FastifyAdapter<
     }
     if (body instanceof StreamableFile) {
       const streamHeaders = body.getHeaders();
-      if (fastifyReply.getHeader('Content-Type') === undefined) {
+      if (
+        fastifyReply.getHeader('Content-Type') === undefined &&
+        streamHeaders.type !== undefined
+      ) {
         fastifyReply.header('Content-Type', streamHeaders.type);
       }
-      if (fastifyReply.getHeader('Content-Disposition') === undefined) {
+      if (
+        fastifyReply.getHeader('Content-Disposition') === undefined &&
+        streamHeaders.disposition !== undefined
+      ) {
         fastifyReply.header('Content-Disposition', streamHeaders.disposition);
       }
+      if (
+        fastifyReply.getHeader('Content-Length') === undefined &&
+        streamHeaders.length !== undefined
+      ) {
+        fastifyReply.header('Content-Length', streamHeaders.length);
+      }
       body = body.getStream();
     }
+    if (
+      fastifyReply.getHeader('Content-Type') !== undefined &&
+      fastifyReply.getHeader('Content-Type') !== 'application/json' &&
+      body?.statusCode >= HttpStatus.BAD_REQUEST
+    ) {
+      Logger.warn(
+        "Content-Type doesn't match Reply body, you might need a custom ExceptionFilter for non-JSON responses",
+        FastifyAdapter.name,
+      );
+      fastifyReply.header('Content-Type', 'application/json');
+    }
     return fastifyReply.send(body);
   }
 
@@ -300,6 +368,10 @@ export class FastifyAdapter<
     return (response as TReply).code(statusCode);
   }
 
+  public end(response: TReply, message?: string) {
+    response.raw.end(message);
+  }
+
   public render(
     response: TReply & { view: Function },
     view: string,
@@ -329,7 +401,7 @@ export class FastifyAdapter<
     return this.instance as unknown as T;
   }
 
-  public register<TRegister extends Parameters<TInstance['register']>>(
+  public register<TRegister extends Parameters<FastifyRegister<TInstance>>>(
     plugin: TRegister['0'],
     opts?: TRegister['1'],
   ) {
@@ -362,28 +434,32 @@ export class FastifyAdapter<
 
   public useStaticAssets(options: FastifyStaticOptions) {
     return this.register(
-      loadPackage('fastify-static', 'FastifyAdapter.useStaticAssets()', () =>
-        require('fastify-static'),
+      loadPackage('@fastify/static', 'FastifyAdapter.useStaticAssets()', () =>
+        require('@fastify/static'),
       ),
       options,
     );
   }
 
-  public setViewEngine(options: PointOfViewOptions | string) {
-    if (typeof options === 'string') {
+  public setViewEngine(options: FastifyViewOptions | string) {
+    if (isString(options)) {
       new Logger('FastifyAdapter').error(
         "setViewEngine() doesn't support a string argument.",
       );
       process.exit(1);
     }
     return this.register(
-      loadPackage('point-of-view', 'FastifyAdapter.setViewEngine()', () =>
-        require('point-of-view'),
+      loadPackage('@fastify/view', 'FastifyAdapter.setViewEngine()', () =>
+        require('@fastify/view'),
       ),
       options,
     );
   }
 
+  public isHeadersSent(response: TReply): boolean {
+    return response.sent;
+  }
+
   public setHeader(response: TReply, name: string, value: string) {
     return response.header(name, value);
   }
@@ -403,14 +479,57 @@ export class FastifyAdapter<
   }
 
   public enableCors(options: CorsOptions | CorsOptionsDelegate<TRequest>) {
-    this.register(import('fastify-cors'), options);
+    this.register(
+      import('@fastify/cors') as Parameters<TInstance['register']>[0],
+      options,
+    );
   }
 
-  public registerParserMiddleware() {
+  public registerParserMiddleware(prefix?: string, rawBody?: boolean) {
     if (this._isParserRegistered) {
       return;
     }
-    this.register(import('fastify-formbody'));
+
+    this.registerUrlencodedContentParser(rawBody);
+    this.registerJsonContentParser(rawBody);
+
+    this._isParserRegistered = true;
+  }
+
+  public useBodyParser(
+    type: string | string[] | RegExp,
+    rawBody: boolean,
+    options?: NestFastifyBodyParserOptions,
+    parser?: FastifyBodyParser<Buffer, TServer>,
+  ) {
+    const parserOptions = {
+      ...(options || {}),
+      parseAs: 'buffer' as const,
+    };
+
+    this.getInstance().addContentTypeParser<Buffer>(
+      type,
+      parserOptions,
+      (
+        req: RawBodyRequest<FastifyRequest<unknown, TServer, TRawRequest>>,
+        body: Buffer,
+        done,
+      ) => {
+        if (rawBody === true && Buffer.isBuffer(body)) {
+          req.rawBody = body;
+        }
+
+        if (parser) {
+          parser(req, body, done);
+          return;
+        }
+
+        done(null, body);
+      },
+    );
+
+    // To avoid the Nest application init to override our custom
+    // body parser, we mark the parsers as registered.
     this._isParserRegistered = true;
   }
 
@@ -421,11 +540,14 @@ export class FastifyAdapter<
       await this.registerMiddie();
     }
     return (path: string, callback: Function) => {
-      const normalizedPath = path.endsWith('/*')
+      let normalizedPath = path.endsWith('/*')
         ? `${path.slice(0, -1)}(.*)`
         : path;
 
-      // The following type assertion is valid as we use import('middie') rather than require('middie')
+      // Fallback to "(.*)" to support plugins like GraphQL
+      normalizedPath = normalizedPath === '/(.*)' ? '(.*)' : normalizedPath;
+
+      // The following type assertion is valid as we use import('@fastify/middie') rather than require('@fastify/middie')
       // ref https://github.com/fastify/middie/pull/55
       this.instance.use(
         normalizedPath,
@@ -455,9 +577,47 @@ export class FastifyAdapter<
     return !('status' in response);
   }
 
+  private registerJsonContentParser(rawBody?: boolean) {
+    const contentType = 'application/json';
+    const withRawBody = !!rawBody;
+    const { bodyLimit } = this.getInstance().initialConfig;
+
+    this.useBodyParser(
+      contentType,
+      withRawBody,
+      { bodyLimit },
+      (req, body, done) => {
+        const { onProtoPoisoning, onConstructorPoisoning } =
+          this.instance.initialConfig;
+        const defaultJsonParser = this.instance.getDefaultJsonParser(
+          onProtoPoisoning || 'error',
+          onConstructorPoisoning || 'error',
+        ) as FastifyBodyParser<string | Buffer, TServer>;
+        defaultJsonParser(req, body, done);
+      },
+    );
+  }
+
+  private registerUrlencodedContentParser(rawBody?: boolean) {
+    const contentType = 'application/x-www-form-urlencoded';
+    const withRawBody = !!rawBody;
+    const { bodyLimit } = this.getInstance().initialConfig;
+
+    this.useBodyParser(
+      contentType,
+      withRawBody,
+      { bodyLimit },
+      (_req, body, done) => {
+        done(null, querystringParse(body.toString()));
+      },
+    );
+  }
+
   private async registerMiddie() {
     this.isMiddieRegistered = true;
-    await this.register(import('middie'));
+    await this.register(
+      import('@fastify/middie') as Parameters<TInstance['register']>[0],
+    );
   }
 
   private getRequestOriginalUrl(rawRequest: TRawRequest) {
@@ -477,7 +637,7 @@ export class FastifyAdapter<
   ) {
     const handlerRef = args[args.length - 1];
     const isVersioned =
-      typeof handlerRef.version !== 'undefined' &&
+      !isUndefined(handlerRef.version) &&
       handlerRef.version !== VERSION_NEUTRAL;
 
     if (isVersioned) {
diff --git a/packages/platform-fastify/index.ts b/packages/platform-fastify/index.ts
index 6ee0f8cf9..6d28e2ccd 100644
--- a/packages/platform-fastify/index.ts
+++ b/packages/platform-fastify/index.ts
@@ -1,6 +1,6 @@
 /*
- * Nest @platform-express
- * Copyright(c) 2017 - 2021 Kamil Mysliwiec
+ * Nest @platform-fastify
+ * Copyright(c) 2017 - 2023 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
diff --git a/packages/platform-fastify/interfaces/external/fastify-static-options.interface.ts b/packages/platform-fastify/interfaces/external/fastify-static-options.interface.ts
index 9f591764a..8bd294c0f 100644
--- a/packages/platform-fastify/interfaces/external/fastify-static-options.interface.ts
+++ b/packages/platform-fastify/interfaces/external/fastify-static-options.interface.ts
@@ -1,16 +1,30 @@
 /**
  * "fastify-static" interfaces
- * @see https://github.com/fastify/fastify-static/blob/master/index.d.ts
+ * @see https://github.com/fastify/fastify-static/blob/master/types/index.d.ts
+ * @publicApi
  */
+import { Stats } from 'fs';
+
+interface ExtendedInformation {
+  fileCount: number;
+  totalFileCount: number;
+  folderCount: number;
+  totalFolderCount: number;
+  totalSize: number;
+  lastModified: number;
+}
 
 interface ListDir {
   href: string;
   name: string;
+  stats: Stats;
+  extendedInfo?: ExtendedInformation;
 }
 
 interface ListFile {
   href: string;
   name: string;
+  stats: Stats;
 }
 
 interface ListRender {
@@ -21,6 +35,8 @@ interface ListOptions {
   format: 'json' | 'html';
   names: string[];
   render: ListRender;
+  extendedFolderInfo?: boolean;
+  jsonFormat?: 'names' | 'extended';
 }
 
 // Passed on to `send`
@@ -34,6 +50,7 @@ interface SendOptions {
   index?: string[] | false;
   lastModified?: boolean;
   maxAge?: string | number;
+  serveDotFiles?: boolean;
 }
 
 export interface FastifyStaticOptions extends SendOptions {
@@ -48,6 +65,11 @@ export interface FastifyStaticOptions extends SendOptions {
   wildcard?: boolean;
   list?: boolean | ListOptions;
   allowedPath?: (pathName: string, root?: string) => boolean;
+  /**
+   * @description
+   * Opt-in to looking for pre-compressed files
+   */
+  preCompressed?: boolean;
 
   // Passed on to `send`
   acceptRanges?: boolean;
diff --git a/packages/platform-fastify/interfaces/external/point-of-view-options.interface.ts b/packages/platform-fastify/interfaces/external/fastify-view-options.interface.ts
similarity index 74%
rename from packages/platform-fastify/interfaces/external/point-of-view-options.interface.ts
rename to packages/platform-fastify/interfaces/external/fastify-view-options.interface.ts
index 4d5f918c6..c6774c65d 100644
--- a/packages/platform-fastify/interfaces/external/point-of-view-options.interface.ts
+++ b/packages/platform-fastify/interfaces/external/fastify-view-options.interface.ts
@@ -1,15 +1,15 @@
 /**
- * @see https://github.com/fastify/point-of-view/blob/master/index.d.ts
+ * "fastify/view" interfaces
+ * @see https://github.com/fastify/point-of-view/blob/master/types/index.d.ts
+ * @publicApi
  */
-
-export interface PointOfViewOptions {
+export interface FastifyViewOptions {
   engine: {
     ejs?: any;
     eta?: any;
     nunjucks?: any;
     pug?: any;
     handlebars?: any;
-    marko?: any;
     mustache?: any;
     'art-template'?: any;
     twig?: any;
diff --git a/packages/platform-fastify/interfaces/external/index.ts b/packages/platform-fastify/interfaces/external/index.ts
index df4df129f..a80eb8a36 100644
--- a/packages/platform-fastify/interfaces/external/index.ts
+++ b/packages/platform-fastify/interfaces/external/index.ts
@@ -1,2 +1,2 @@
 export * from './fastify-static-options.interface';
-export * from './point-of-view-options.interface';
+export * from './fastify-view-options.interface';
diff --git a/packages/platform-fastify/interfaces/index.ts b/packages/platform-fastify/interfaces/index.ts
index ee1841f2f..ae18b9a3c 100644
--- a/packages/platform-fastify/interfaces/index.ts
+++ b/packages/platform-fastify/interfaces/index.ts
@@ -1 +1,2 @@
 export * from './nest-fastify-application.interface';
+export * from './nest-fastify-body-parser-options.interface';
diff --git a/packages/platform-fastify/interfaces/nest-fastify-application.interface.ts b/packages/platform-fastify/interfaces/nest-fastify-application.interface.ts
index f275385ba..e77c715fd 100644
--- a/packages/platform-fastify/interfaces/nest-fastify-application.interface.ts
+++ b/packages/platform-fastify/interfaces/nest-fastify-application.interface.ts
@@ -1,22 +1,40 @@
-import { INestApplication } from '@nestjs/common';
+import { INestApplication, HttpServer } from '@nestjs/common';
 import {
+  FastifyBodyParser,
   FastifyInstance,
   FastifyPluginAsync,
   FastifyPluginCallback,
   FastifyPluginOptions,
   FastifyRegisterOptions,
+  FastifyRequest,
+  FastifyReply,
+  RawServerBase,
+  RawServerDefault,
 } from 'fastify';
 import {
   Chain as LightMyRequestChain,
   InjectOptions,
   Response as LightMyRequestResponse,
 } from 'light-my-request';
-import { FastifyStaticOptions, PointOfViewOptions } from './external';
+import { FastifyStaticOptions, FastifyViewOptions } from './external';
+import { NestFastifyBodyParserOptions } from './nest-fastify-body-parser-options.interface';
+
+/**
+ * @publicApi
+ */
+export interface NestFastifyApplication<
+  TServer extends RawServerBase = RawServerDefault,
+> extends INestApplication<TServer> {
+  /**
+   * Returns the underlying HTTP adapter bounded to a Fastify app.
+   *
+   * @returns {HttpServer}
+   */
+  getHttpAdapter(): HttpServer<FastifyRequest, FastifyReply, FastifyInstance>;
 
-export interface NestFastifyApplication extends INestApplication {
   /**
    * A wrapper function around native `fastify.register()` method.
-   * Example `app.register(require('fastify-formbody'))
+   * Example `app.register(require('@fastify/formbody'))
    * @returns {Promise<FastifyInstance>}
    */
   register<Options extends FastifyPluginOptions = any>(
@@ -28,6 +46,27 @@ export interface NestFastifyApplication extends INestApplication {
     opts?: FastifyRegisterOptions<Options>,
   ): Promise<FastifyInstance>;
 
+  /**
+   * Register Fastify body parsers on the fly. Will respect
+   * the application's `rawBody` option.
+   *
+   * @example
+   * const app = await NestFactory.create<NestFastifyApplication>(
+   *   AppModule,
+   *   new FastifyAdapter(),
+   *   { rawBody: true }
+   * );
+   * // enable the json parser with a parser limit of 50mb
+   * app.useBodyParser('application/json', { bodyLimit: 50 * 1000 * 1024 });
+   *
+   * @returns {this}
+   */
+  useBodyParser<TServer extends RawServerBase = RawServerBase>(
+    type: string | string[] | RegExp,
+    options?: NestFastifyBodyParserOptions,
+    parser?: FastifyBodyParser<Buffer, TServer>,
+  ): this;
+
   /**
    * Sets a base directory for public assets.
    * Example `app.useStaticAssets({ root: 'public' })`
@@ -38,10 +77,10 @@ export interface NestFastifyApplication extends INestApplication {
   /**
    * Sets a view engine for templates (views), for example: `pug`, `handlebars`, or `ejs`.
    *
-   * Don't pass in a string. The string type in the argument is for compatibilility reason and will cause an exception.
+   * Don't pass in a string. The string type in the argument is for compatibility reason and will cause an exception.
    * @returns {this}
    */
-  setViewEngine(options: PointOfViewOptions | string): this;
+  setViewEngine(options: FastifyViewOptions | string): this;
 
   /**
    * A wrapper function around native `fastify.inject()` method.
diff --git a/packages/platform-fastify/interfaces/nest-fastify-body-parser-options.interface.ts b/packages/platform-fastify/interfaces/nest-fastify-body-parser-options.interface.ts
new file mode 100644
index 000000000..9f7ecc054
--- /dev/null
+++ b/packages/platform-fastify/interfaces/nest-fastify-body-parser-options.interface.ts
@@ -0,0 +1,6 @@
+import type { AddContentTypeParser } from 'fastify';
+
+export type NestFastifyBodyParserOptions = Omit<
+  Parameters<AddContentTypeParser>[1],
+  'parseAs'
+>;
diff --git a/packages/platform-fastify/package.json b/packages/platform-fastify/package.json
index edb5e03b9..8a2b0a470 100644
--- a/packages/platform-fastify/package.json
+++ b/packages/platform-fastify/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/platform-fastify",
-  "version": "8.2.3",
+  "version": "9.4.0",
   "description": "Nest - modern, fast, powerful node.js web framework (@platform-fastify)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -17,16 +17,26 @@
     "access": "public"
   },
   "dependencies": {
-    "fastify": "3.24.1",
-    "fastify-cors": "6.0.2",
-    "fastify-formbody": "5.2.0",
-    "light-my-request": "4.7.0",
-    "middie": "5.3.0",
+    "@fastify/cors": "8.2.1",
+    "@fastify/formbody": "7.4.0",
+    "@fastify/middie": "8.1.0",
+    "fastify": "4.15.0",
+    "light-my-request": "5.9.1",
     "path-to-regexp": "3.2.0",
-    "tslib": "2.3.1"
+    "tslib": "2.5.0"
   },
   "peerDependencies": {
-    "@nestjs/common": "^8.0.0",
-    "@nestjs/core": "^8.0.0"
+    "@fastify/static": "^6.0.0",
+    "@fastify/view": "^7.0.0",
+    "@nestjs/common": "^9.0.0",
+    "@nestjs/core": "^9.0.0"
+  },
+  "peerDependenciesMeta": {
+    "@fastify/static": {
+      "optional": true
+    },
+    "@fastify/view": {
+      "optional": true
+    }
   }
 }
diff --git a/packages/platform-fastify/tsconfig.build.json b/packages/platform-fastify/tsconfig.build.json
new file mode 100644
index 000000000..732ca00cb
--- /dev/null
+++ b/packages/platform-fastify/tsconfig.build.json
@@ -0,0 +1,22 @@
+{
+  "extends": "../tsconfig.build.json",
+  "compilerOptions": {
+    "outDir": ".",
+    "rootDir": ".",
+    "paths": {
+      "@nestjs/common": ["../common"],
+      "@nestjs/common/*": ["../common/*"],
+      "@nestjs/core": ["../core"],
+      "@nestjs/core/*": ["../core/*"]
+    }
+  },
+  "exclude": ["node_modules", "dist", "test/**/*", "*.spec.ts"],
+  "references": [
+    {
+      "path": "../common/tsconfig.build.json"
+    },
+    {
+      "path": "../core/tsconfig.build.json"
+    }
+  ]
+}
diff --git a/packages/platform-fastify/tsconfig.json b/packages/platform-fastify/tsconfig.json
index b238080a4..2ae9e3c90 100644
--- a/packages/platform-fastify/tsconfig.json
+++ b/packages/platform-fastify/tsconfig.json
@@ -1,7 +1,13 @@
 {
-  "extends": "./../tsconfig.base.json",
+  "extends": "../tsconfig.build.json",
   "compilerOptions": {
-    "baseUrl": "./"
+    "types": ["node"]
   },
-  "include": ["*.ts", "**/*.ts"]
+  "files": [],
+  "include": [],
+  "references": [
+    {
+      "path": "./tsconfig.build.json"
+    }
+  ]
 }
diff --git a/packages/platform-socket.io/CHANGELOG.md b/packages/platform-socket.io/CHANGELOG.md
deleted file mode 100644
index 2074a9b0d..000000000
--- a/packages/platform-socket.io/CHANGELOG.md
+++ /dev/null
@@ -1,12 +0,0 @@
-# Change Log
-
-All notable changes to this project will be documented in this file.
-See [Conventional Commits](https://conventionalcommits.org) for commit guidelines.
-
-<a name="8.2.0"></a>
-# [8.2.0](https://github.com/nestjs/nest/compare/v8.1.2...v8.2.0) (2021-11-08)
-
-
-
-
-**Note:** Version bump only for package @nestjs/platform-socket.io
diff --git a/packages/platform-socket.io/Readme.md b/packages/platform-socket.io/Readme.md
index f288809a9..16f48336d 100644
--- a/packages/platform-socket.io/Readme.md
+++ b/packages/platform-socket.io/Readme.md
@@ -11,7 +11,6 @@
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
 <a href="https://circleci.com/gh/nestjs/nest" target="_blank"><img src="https://img.shields.io/circleci/build/github/nestjs/nest/master" alt="CircleCI" /></a>
-<a href="https://coveralls.io/github/nestjs/nest?branch=master" target="_blank"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#9" alt="Coverage" /></a>
 <a href="https://discord.gg/G7Qnnhy" target="_blank"><img src="https://img.shields.io/badge/discord-online-brightgreen.svg" alt="Discord"/></a>
 <a href="https://opencollective.com/nest#backer" target="_blank"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
 <a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
@@ -37,8 +36,8 @@ Nest is a framework for building efficient, scalable <a href="http://nodejs.org"
 
 * To check out the [guide](https://docs.nestjs.com), visit [docs.nestjs.com](https://docs.nestjs.com). :books:
 * Ë¶ÅÊü•Áúã‰∏≠Êñá [ÊåáÂçó](readme_zh.md), ËØ∑ËÆøÈóÆ [docs.nestjs.cn](https://docs.nestjs.cn). :books:
-* [Í∞ÄÏù¥Îìú](readme_kr.md)Î•º ÌôïÏù∏ÌïòÎ†§Î©¥, [docs.nestjs.com](https://docs.nestjs.com)Î•º Î∞©Î¨∏ÌïòÏÑ∏Ïöî.:books: 
-* „ÉÅ„Çß„ÉÉ„ÇØ„Åô„Çã„Å´„ÅØ [„Ç¨„Ç§„Éâ](readme_jp.md), Ë©≥„Åó„Åè„ÅØ [docs.nestjs.com](https://docs.nestjs.com). :books: 
+* [Í∞ÄÏù¥Îìú](readme_kr.md) Î¨∏ÏÑúÎäî [docs.nestjs.com](https://docs.nestjs.com)ÏóêÏÑú ÌôïÏù∏ÌïòÏã§ Ïàò ÏûàÏäµÎãàÎã§. :books:
+* [„Ç¨„Ç§„Éâ](readme_jp.md)„ÅØ [docs.nestjs.com](https://docs.nestjs.com)„Åß„ÅîÁ¢∫Ë™ç„Åè„Å†„Åï„ÅÑ„ÄÇ :books:
 
 ## Questions
 
@@ -54,36 +53,49 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
 <table style="text-align:center;"><tr>
   <td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
+  <td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/red-hat-logo.svg" width="200" valign="middle" /></a></td>
 <td>
 <a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
 <td>
 <a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
+    <td>
+<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td><td>
+<a href="https://amplication.com/" target="_blank"><img src="https://nestjs.com/img/amplication-logo.svg" width="190" valign="middle" /></a></td>
 </tr></table>
 
 #### Gold Sponsors
 
 <table style="text-align:center;"><tr><td>
-  <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
-  <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
+<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="140" valign="middle" /></a></td>
 <td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
+<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td>
+ <td>
+<a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
+<a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td><td>
+<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td>
+<td>
+<a href="https://ridicorp.com/career/" target="_blank"><img src="https://nestjs.com/img/ridi-logo.svg" width="105" valign="middle" /></a></td><td>
+<a href="https://www.movavi.com/imovie-for-windows.html" target="_blank"><img src="https://nestjs.com/img/movavi-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
 <table style="text-align:center;"><tr><td>
 <a href="https://neoteric.eu/" target="_blank"><img src="https://nestjs.com/img/neoteric-cut.png" width="120" valign="middle" /></a> </td><td>
   <a href="http://gojob.com" target="_blank"><img src="http://nestjs.com/img/gojob-logo.png" valign="middle" width="100" /></a> </td><td>
-<a href="http://www.leogistics.com" target="_blank"><img src="https://nestjs.com/img/leogistics-logo.jpeg" width="150" valign="middle" /></td><td>
+<a href="https://www.myleodsc.com/" target="_blank"><img src="https://nestjs.com/img/myleo-logo.png" width="180" valign="middle" /></td><td>
 <a href="https://careers.meetdandy.com/?gh_src=063ba61e3us" target="_blank"><img src="https://nestjs.com/img/dandy-roles-logo.svg" width="150" valign="middle" /></td><td>
 <a href="https://www.castlecraft.in" target="_blank"><img src="https://nestjs.com/img/castlecraft-logo.png" width="150" valign="middle" /></td>
-<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td></tr></table>
+<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td>
+<td><a href="https://n.inc" target="_blank"><img src="https://nestjs.com/img/n-inc-logo.svg" width="120" valign="middle" /></td></tr><tr>
+<td><a href="https://bilberrry.com/" target="_blank"><img src="https://nestjs.com/img/bilberrry-logo.svg" width="180" valign="middle" /></td>
+<td><a href="https://ipinfo.ai/" target="_blank"><img src="https://nestjs.com/img/ipinfo-logo.png" width="130" valign="middle" /></td>
+<td><a href="https://chax.at" target="_blank"><img src="https://nestjs.com/img/chaxat-logo.png" width="100" valign="middle" /></td></tr>
+</table>
 
 #### Sponsors
 
@@ -91,7 +103,7 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <a href="https://www.swingdev.io" target="_blank"><img src="https://nestjs.com/img/swingdev-logo.svg#1" width="110" valign="middle" /> </a></td><td align="center" valign="middle">
 <a href="https://www.novologic.com/" target="_blank"><img src="https://nestjs.com/img/novologic.png" width="110" valign="middle" /></a> </td><td align="center" valign="middle">
 <a href="https://ever.co/" target="_blank"><img src="https://nestjs.com/img/ever-logo.png" width="72" valign="middle" /></a>  </td><td align="center" valign="middle">
-<a href="https://blokt.com" target="_blank"><img src="https://nestjs.com/img/blokt-logo.png" width="120" valign="middle" /></a>  </td><td align="center" valign="middle"> 
+<a href="https://blokt.com" target="_blank"><img src="https://nestjs.com/img/blokt-logo.png" width="120" valign="middle" /></a>  </td><td align="center" valign="middle">
   <a href="http://architectnow.net/" target="_blank"><img src="https://nestjs.com/img/architectnow.png" width="125" valign="middle" /></a> </td><td align="center" valign="middle">
   <a href="https://quander.io/" target="_blank"><img src="https://nestjs.com/img/quander.png" width="100" valign="middle" /></a> </td></tr><tr><td align="center" valign="middle">
   <a href="https://mantro.net/" target="_blank"><img src="https://nestjs.com/img/mantro-logo.svg" width="95" valign="middle" /></a> </td><td align="center" valign="middle">
@@ -117,6 +129,14 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/naologic-logo.svg" width="125" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://messaged.com/" target="_blank"><img src="https://nestjs.com/img/messaged-logo.png" width="50" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/triplecore-logo.svg" width="50" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://klqc.de" target="_blank"><img src="https://nestjs.com/img/klcqcl-logo.png" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://thecasinowizard.com/bonuses/no-deposit-bonuses/" target="_blank"><img src="https://nestjs.com/img/casinowizard-logo.png" width="120" valign="middle" /></a></td></tr><tr>
+     <td align="center" valign="middle"><a href="https://polygon-software.ch/" target="_blank"><img src="https://nestjs.com/img/polygon-logo.svg" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://mobilereality.pl/" target="_blank"><img src="https://nestjs.com/img/mobile-reality-logo.png" width="45" valign="middle" /></a></td>
+     <td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/boringowl-logo.svg" width="120" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://www.mobilefactory.jp/" target="_blank"><img src="https://nestjs.com/img/mobilefactory-logo.png" width="100" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://nordbot.app/" target="_blank"><img src="https://nestjs.com/img/nordbot-logo.png" width="120" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://doppio.sh/" target="_blank"><img src="https://nestjs.com/img/dopiosh-logo.png" width="50" valign="middle" /></a></td>
   </tr></table>
 
 ## Backers
diff --git a/packages/platform-socket.io/adapters/io-adapter.ts b/packages/platform-socket.io/adapters/io-adapter.ts
index 22eb9155c..d3c8d161d 100644
--- a/packages/platform-socket.io/adapters/io-adapter.ts
+++ b/packages/platform-socket.io/adapters/io-adapter.ts
@@ -8,6 +8,9 @@ import { fromEvent, Observable } from 'rxjs';
 import { filter, first, map, mergeMap, share, takeUntil } from 'rxjs/operators';
 import { Server, ServerOptions, Socket } from 'socket.io';
 
+/**
+ * @publicApi
+ */
 export class IoAdapter extends AbstractWsAdapter {
   public create(
     port: number,
diff --git a/packages/platform-socket.io/index.ts b/packages/platform-socket.io/index.ts
index 175a4e0d6..434d79eb4 100644
--- a/packages/platform-socket.io/index.ts
+++ b/packages/platform-socket.io/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @platform-socket.io
- * Copyright(c) 2017 - 2021 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2023 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
diff --git a/packages/platform-socket.io/package.json b/packages/platform-socket.io/package.json
index 38fde3ee1..8a1eda801 100644
--- a/packages/platform-socket.io/package.json
+++ b/packages/platform-socket.io/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/platform-socket.io",
-  "version": "8.2.3",
+  "version": "9.4.0",
   "description": "Nest - modern, fast, powerful node.js web framework (@platform-socket.io)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -17,12 +17,12 @@
     "access": "public"
   },
   "dependencies": {
-    "socket.io": "4.4.0",
-    "tslib": "2.3.1"
+    "socket.io": "4.6.1",
+    "tslib": "2.5.0"
   },
   "peerDependencies": {
-    "@nestjs/common": "^8.0.0",
-    "@nestjs/websockets": "^8.0.0",
+    "@nestjs/common": "^9.0.0",
+    "@nestjs/websockets": "^9.0.0",
     "rxjs": "^7.1.0"
   }
 }
diff --git a/packages/platform-socket.io/tsconfig.build.json b/packages/platform-socket.io/tsconfig.build.json
new file mode 100644
index 000000000..b9ccddc22
--- /dev/null
+++ b/packages/platform-socket.io/tsconfig.build.json
@@ -0,0 +1,22 @@
+{
+  "extends": "../tsconfig.build.json",
+  "compilerOptions": {
+    "outDir": ".",
+    "rootDir": ".",
+    "paths": {
+      "@nestjs/common": ["../common"],
+      "@nestjs/common/*": ["../common/*"],
+      "@nestjs/websockets": ["../websockets"],
+      "@nestjs/websockets/*": ["../websockets/*"]
+    }
+  },
+  "exclude": ["node_modules", "dist", "test/**/*", "*.spec.ts"],
+  "references": [
+    {
+      "path": "../common/tsconfig.build.json"
+    },
+    {
+      "path": "../websockets/tsconfig.build.json"
+    }
+  ]
+}
diff --git a/packages/platform-socket.io/tsconfig.json b/packages/platform-socket.io/tsconfig.json
index b238080a4..2ae9e3c90 100644
--- a/packages/platform-socket.io/tsconfig.json
+++ b/packages/platform-socket.io/tsconfig.json
@@ -1,7 +1,13 @@
 {
-  "extends": "./../tsconfig.base.json",
+  "extends": "../tsconfig.build.json",
   "compilerOptions": {
-    "baseUrl": "./"
+    "types": ["node"]
   },
-  "include": ["*.ts", "**/*.ts"]
+  "files": [],
+  "include": [],
+  "references": [
+    {
+      "path": "./tsconfig.build.json"
+    }
+  ]
 }
diff --git a/packages/platform-ws/CHANGELOG.md b/packages/platform-ws/CHANGELOG.md
deleted file mode 100644
index 38ce8ea49..000000000
--- a/packages/platform-ws/CHANGELOG.md
+++ /dev/null
@@ -1,12 +0,0 @@
-# Change Log
-
-All notable changes to this project will be documented in this file.
-See [Conventional Commits](https://conventionalcommits.org) for commit guidelines.
-
-<a name="8.2.0"></a>
-# [8.2.0](https://github.com/nestjs/nest/compare/v8.1.2...v8.2.0) (2021-11-08)
-
-
-
-
-**Note:** Version bump only for package @nestjs/platform-ws
diff --git a/packages/platform-ws/Readme.md b/packages/platform-ws/Readme.md
index f288809a9..16f48336d 100644
--- a/packages/platform-ws/Readme.md
+++ b/packages/platform-ws/Readme.md
@@ -11,7 +11,6 @@
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
 <a href="https://circleci.com/gh/nestjs/nest" target="_blank"><img src="https://img.shields.io/circleci/build/github/nestjs/nest/master" alt="CircleCI" /></a>
-<a href="https://coveralls.io/github/nestjs/nest?branch=master" target="_blank"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#9" alt="Coverage" /></a>
 <a href="https://discord.gg/G7Qnnhy" target="_blank"><img src="https://img.shields.io/badge/discord-online-brightgreen.svg" alt="Discord"/></a>
 <a href="https://opencollective.com/nest#backer" target="_blank"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
 <a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
@@ -37,8 +36,8 @@ Nest is a framework for building efficient, scalable <a href="http://nodejs.org"
 
 * To check out the [guide](https://docs.nestjs.com), visit [docs.nestjs.com](https://docs.nestjs.com). :books:
 * Ë¶ÅÊü•Áúã‰∏≠Êñá [ÊåáÂçó](readme_zh.md), ËØ∑ËÆøÈóÆ [docs.nestjs.cn](https://docs.nestjs.cn). :books:
-* [Í∞ÄÏù¥Îìú](readme_kr.md)Î•º ÌôïÏù∏ÌïòÎ†§Î©¥, [docs.nestjs.com](https://docs.nestjs.com)Î•º Î∞©Î¨∏ÌïòÏÑ∏Ïöî.:books: 
-* „ÉÅ„Çß„ÉÉ„ÇØ„Åô„Çã„Å´„ÅØ [„Ç¨„Ç§„Éâ](readme_jp.md), Ë©≥„Åó„Åè„ÅØ [docs.nestjs.com](https://docs.nestjs.com). :books: 
+* [Í∞ÄÏù¥Îìú](readme_kr.md) Î¨∏ÏÑúÎäî [docs.nestjs.com](https://docs.nestjs.com)ÏóêÏÑú ÌôïÏù∏ÌïòÏã§ Ïàò ÏûàÏäµÎãàÎã§. :books:
+* [„Ç¨„Ç§„Éâ](readme_jp.md)„ÅØ [docs.nestjs.com](https://docs.nestjs.com)„Åß„ÅîÁ¢∫Ë™ç„Åè„Å†„Åï„ÅÑ„ÄÇ :books:
 
 ## Questions
 
@@ -54,36 +53,49 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
 <table style="text-align:center;"><tr>
   <td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
+  <td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/red-hat-logo.svg" width="200" valign="middle" /></a></td>
 <td>
 <a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
 <td>
 <a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
+    <td>
+<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td><td>
+<a href="https://amplication.com/" target="_blank"><img src="https://nestjs.com/img/amplication-logo.svg" width="190" valign="middle" /></a></td>
 </tr></table>
 
 #### Gold Sponsors
 
 <table style="text-align:center;"><tr><td>
-  <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
-  <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
+<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="140" valign="middle" /></a></td>
 <td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
+<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td>
+ <td>
+<a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
+<a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td><td>
+<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td>
+<td>
+<a href="https://ridicorp.com/career/" target="_blank"><img src="https://nestjs.com/img/ridi-logo.svg" width="105" valign="middle" /></a></td><td>
+<a href="https://www.movavi.com/imovie-for-windows.html" target="_blank"><img src="https://nestjs.com/img/movavi-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
 <table style="text-align:center;"><tr><td>
 <a href="https://neoteric.eu/" target="_blank"><img src="https://nestjs.com/img/neoteric-cut.png" width="120" valign="middle" /></a> </td><td>
   <a href="http://gojob.com" target="_blank"><img src="http://nestjs.com/img/gojob-logo.png" valign="middle" width="100" /></a> </td><td>
-<a href="http://www.leogistics.com" target="_blank"><img src="https://nestjs.com/img/leogistics-logo.jpeg" width="150" valign="middle" /></td><td>
+<a href="https://www.myleodsc.com/" target="_blank"><img src="https://nestjs.com/img/myleo-logo.png" width="180" valign="middle" /></td><td>
 <a href="https://careers.meetdandy.com/?gh_src=063ba61e3us" target="_blank"><img src="https://nestjs.com/img/dandy-roles-logo.svg" width="150" valign="middle" /></td><td>
 <a href="https://www.castlecraft.in" target="_blank"><img src="https://nestjs.com/img/castlecraft-logo.png" width="150" valign="middle" /></td>
-<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td></tr></table>
+<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td>
+<td><a href="https://n.inc" target="_blank"><img src="https://nestjs.com/img/n-inc-logo.svg" width="120" valign="middle" /></td></tr><tr>
+<td><a href="https://bilberrry.com/" target="_blank"><img src="https://nestjs.com/img/bilberrry-logo.svg" width="180" valign="middle" /></td>
+<td><a href="https://ipinfo.ai/" target="_blank"><img src="https://nestjs.com/img/ipinfo-logo.png" width="130" valign="middle" /></td>
+<td><a href="https://chax.at" target="_blank"><img src="https://nestjs.com/img/chaxat-logo.png" width="100" valign="middle" /></td></tr>
+</table>
 
 #### Sponsors
 
@@ -91,7 +103,7 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <a href="https://www.swingdev.io" target="_blank"><img src="https://nestjs.com/img/swingdev-logo.svg#1" width="110" valign="middle" /> </a></td><td align="center" valign="middle">
 <a href="https://www.novologic.com/" target="_blank"><img src="https://nestjs.com/img/novologic.png" width="110" valign="middle" /></a> </td><td align="center" valign="middle">
 <a href="https://ever.co/" target="_blank"><img src="https://nestjs.com/img/ever-logo.png" width="72" valign="middle" /></a>  </td><td align="center" valign="middle">
-<a href="https://blokt.com" target="_blank"><img src="https://nestjs.com/img/blokt-logo.png" width="120" valign="middle" /></a>  </td><td align="center" valign="middle"> 
+<a href="https://blokt.com" target="_blank"><img src="https://nestjs.com/img/blokt-logo.png" width="120" valign="middle" /></a>  </td><td align="center" valign="middle">
   <a href="http://architectnow.net/" target="_blank"><img src="https://nestjs.com/img/architectnow.png" width="125" valign="middle" /></a> </td><td align="center" valign="middle">
   <a href="https://quander.io/" target="_blank"><img src="https://nestjs.com/img/quander.png" width="100" valign="middle" /></a> </td></tr><tr><td align="center" valign="middle">
   <a href="https://mantro.net/" target="_blank"><img src="https://nestjs.com/img/mantro-logo.svg" width="95" valign="middle" /></a> </td><td align="center" valign="middle">
@@ -117,6 +129,14 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/naologic-logo.svg" width="125" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://messaged.com/" target="_blank"><img src="https://nestjs.com/img/messaged-logo.png" width="50" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/triplecore-logo.svg" width="50" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://klqc.de" target="_blank"><img src="https://nestjs.com/img/klcqcl-logo.png" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://thecasinowizard.com/bonuses/no-deposit-bonuses/" target="_blank"><img src="https://nestjs.com/img/casinowizard-logo.png" width="120" valign="middle" /></a></td></tr><tr>
+     <td align="center" valign="middle"><a href="https://polygon-software.ch/" target="_blank"><img src="https://nestjs.com/img/polygon-logo.svg" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://mobilereality.pl/" target="_blank"><img src="https://nestjs.com/img/mobile-reality-logo.png" width="45" valign="middle" /></a></td>
+     <td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/boringowl-logo.svg" width="120" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://www.mobilefactory.jp/" target="_blank"><img src="https://nestjs.com/img/mobilefactory-logo.png" width="100" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://nordbot.app/" target="_blank"><img src="https://nestjs.com/img/nordbot-logo.png" width="120" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://doppio.sh/" target="_blank"><img src="https://nestjs.com/img/dopiosh-logo.png" width="50" valign="middle" /></a></td>
   </tr></table>
 
 ## Backers
diff --git a/packages/platform-ws/adapters/ws-adapter.ts b/packages/platform-ws/adapters/ws-adapter.ts
index cca1f81a6..d0791be91 100644
--- a/packages/platform-ws/adapters/ws-adapter.ts
+++ b/packages/platform-ws/adapters/ws-adapter.ts
@@ -1,5 +1,6 @@
 import { INestApplicationContext, Logger } from '@nestjs/common';
 import { loadPackage } from '@nestjs/common/utils/load-package.util';
+import { normalizePath, isNil } from '@nestjs/common/utils/shared.utils';
 import { AbstractWsAdapter } from '@nestjs/websockets';
 import {
   CLOSE_EVENT,
@@ -8,7 +9,7 @@ import {
 } from '@nestjs/websockets/constants';
 import { MessageMappingProperties } from '@nestjs/websockets/gateway-metadata-explorer';
 import * as http from 'http';
-import { EMPTY as empty, fromEvent, Observable } from 'rxjs';
+import { EMPTY, fromEvent, Observable } from 'rxjs';
 import { filter, first, mergeMap, share, takeUntil } from 'rxjs/operators';
 
 let wsPackage: any = {};
@@ -27,6 +28,9 @@ type WsServerRegistryEntry = any[];
 
 const UNDERLYING_HTTP_SERVER_PORT = 0;
 
+/**
+ * @publicApi
+ */
 export class WsAdapter extends AbstractWsAdapter {
   protected readonly logger = new Logger(WsAdapter.name);
   protected readonly httpServersRegistry = new Map<
@@ -45,9 +49,13 @@ export class WsAdapter extends AbstractWsAdapter {
 
   public create(
     port: number,
-    options?: Record<string, any> & { namespace?: string; server?: any },
+    options?: Record<string, any> & {
+      namespace?: string;
+      server?: any;
+      path?: string;
+    },
   ) {
-    const { server, ...wsOptions } = options;
+    const { server, path, ...wsOptions } = options;
     if (wsOptions?.namespace) {
       const error = new Error(
         '"WsAdapter" does not support namespaces. If you need namespaces in your project, consider using the "@nestjs/platform-socket.io" package instead.',
@@ -65,14 +73,14 @@ export class WsAdapter extends AbstractWsAdapter {
         }),
       );
 
-      this.addWsServerToRegistry(wsServer, port, options.path || '/');
+      this.addWsServerToRegistry(wsServer, port, path);
       return wsServer;
     }
 
     if (server) {
       return server;
     }
-    if (options.path && port !== UNDERLYING_HTTP_SERVER_PORT) {
+    if (path && port !== UNDERLYING_HTTP_SERVER_PORT) {
       // Multiple servers with different paths
       // sharing a single HTTP/S server running on different port
       // than a regular HTTP application
@@ -85,12 +93,13 @@ export class WsAdapter extends AbstractWsAdapter {
           ...wsOptions,
         }),
       );
-      this.addWsServerToRegistry(wsServer, port, options.path);
+      this.addWsServerToRegistry(wsServer, port, path);
       return wsServer;
     }
     const wsServer = this.bindErrorHandler(
       new wsPackage.Server({
         port,
+        path,
         ...wsOptions,
       }),
     );
@@ -106,7 +115,7 @@ export class WsAdapter extends AbstractWsAdapter {
     const source$ = fromEvent(client, 'message').pipe(
       mergeMap(data =>
         this.bindMessageHandler(data, handlers, transform).pipe(
-          filter(result => result),
+          filter(result => !isNil(result)),
         ),
       ),
       takeUntil(close$),
@@ -133,7 +142,7 @@ export class WsAdapter extends AbstractWsAdapter {
       const { callback } = messageHandler;
       return transform(callback(message.data));
     } catch {
-      return empty;
+      return EMPTY;
     }
   }
 
@@ -198,7 +207,7 @@ export class WsAdapter extends AbstractWsAdapter {
     const entries = this.wsServersRegistry.get(port) ?? [];
     entries.push(wsServer);
 
-    wsServer.path = path;
+    wsServer.path = normalizePath(path);
     this.wsServersRegistry.set(port, entries);
   }
 }
diff --git a/packages/platform-ws/index.ts b/packages/platform-ws/index.ts
index e1b9386e4..e83223e11 100644
--- a/packages/platform-ws/index.ts
+++ b/packages/platform-ws/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @platform-ws
- * Copyright(c) 2017 - 2021 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2023 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
diff --git a/packages/platform-ws/package.json b/packages/platform-ws/package.json
index ac6c0e077..9410fb4b2 100644
--- a/packages/platform-ws/package.json
+++ b/packages/platform-ws/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/platform-ws",
-  "version": "8.2.3",
+  "version": "9.4.0",
   "description": "Nest - modern, fast, powerful node.js web framework (@platform-ws)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -17,12 +17,12 @@
     "access": "public"
   },
   "dependencies": {
-    "tslib": "2.3.1",
-    "ws": "7.5.6"
+    "tslib": "2.5.0",
+    "ws": "8.13.0"
   },
   "peerDependencies": {
-    "@nestjs/common": "^8.0.0",
-    "@nestjs/websockets": "^8.0.0",
+    "@nestjs/common": "^9.0.0",
+    "@nestjs/websockets": "^9.0.0",
     "rxjs": "^7.1.0"
   }
 }
diff --git a/packages/platform-ws/tsconfig.build.json b/packages/platform-ws/tsconfig.build.json
new file mode 100644
index 000000000..b9ccddc22
--- /dev/null
+++ b/packages/platform-ws/tsconfig.build.json
@@ -0,0 +1,22 @@
+{
+  "extends": "../tsconfig.build.json",
+  "compilerOptions": {
+    "outDir": ".",
+    "rootDir": ".",
+    "paths": {
+      "@nestjs/common": ["../common"],
+      "@nestjs/common/*": ["../common/*"],
+      "@nestjs/websockets": ["../websockets"],
+      "@nestjs/websockets/*": ["../websockets/*"]
+    }
+  },
+  "exclude": ["node_modules", "dist", "test/**/*", "*.spec.ts"],
+  "references": [
+    {
+      "path": "../common/tsconfig.build.json"
+    },
+    {
+      "path": "../websockets/tsconfig.build.json"
+    }
+  ]
+}
diff --git a/packages/platform-ws/tsconfig.json b/packages/platform-ws/tsconfig.json
index b238080a4..2ae9e3c90 100644
--- a/packages/platform-ws/tsconfig.json
+++ b/packages/platform-ws/tsconfig.json
@@ -1,7 +1,13 @@
 {
-  "extends": "./../tsconfig.base.json",
+  "extends": "../tsconfig.build.json",
   "compilerOptions": {
-    "baseUrl": "./"
+    "types": ["node"]
   },
-  "include": ["*.ts", "**/*.ts"]
+  "files": [],
+  "include": [],
+  "references": [
+    {
+      "path": "./tsconfig.build.json"
+    }
+  ]
 }
diff --git a/packages/testing/CHANGELOG.md b/packages/testing/CHANGELOG.md
deleted file mode 100644
index fca1fb6df..000000000
--- a/packages/testing/CHANGELOG.md
+++ /dev/null
@@ -1,12 +0,0 @@
-# Change Log
-
-All notable changes to this project will be documented in this file.
-See [Conventional Commits](https://conventionalcommits.org) for commit guidelines.
-
-<a name="8.2.0"></a>
-# [8.2.0](https://github.com/nestjs/nest/compare/v8.1.2...v8.2.0) (2021-11-08)
-
-
-
-
-**Note:** Version bump only for package @nestjs/testing
diff --git a/packages/testing/Readme.md b/packages/testing/Readme.md
index f288809a9..16f48336d 100644
--- a/packages/testing/Readme.md
+++ b/packages/testing/Readme.md
@@ -11,7 +11,6 @@
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
 <a href="https://circleci.com/gh/nestjs/nest" target="_blank"><img src="https://img.shields.io/circleci/build/github/nestjs/nest/master" alt="CircleCI" /></a>
-<a href="https://coveralls.io/github/nestjs/nest?branch=master" target="_blank"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#9" alt="Coverage" /></a>
 <a href="https://discord.gg/G7Qnnhy" target="_blank"><img src="https://img.shields.io/badge/discord-online-brightgreen.svg" alt="Discord"/></a>
 <a href="https://opencollective.com/nest#backer" target="_blank"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
 <a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
@@ -37,8 +36,8 @@ Nest is a framework for building efficient, scalable <a href="http://nodejs.org"
 
 * To check out the [guide](https://docs.nestjs.com), visit [docs.nestjs.com](https://docs.nestjs.com). :books:
 * Ë¶ÅÊü•Áúã‰∏≠Êñá [ÊåáÂçó](readme_zh.md), ËØ∑ËÆøÈóÆ [docs.nestjs.cn](https://docs.nestjs.cn). :books:
-* [Í∞ÄÏù¥Îìú](readme_kr.md)Î•º ÌôïÏù∏ÌïòÎ†§Î©¥, [docs.nestjs.com](https://docs.nestjs.com)Î•º Î∞©Î¨∏ÌïòÏÑ∏Ïöî.:books: 
-* „ÉÅ„Çß„ÉÉ„ÇØ„Åô„Çã„Å´„ÅØ [„Ç¨„Ç§„Éâ](readme_jp.md), Ë©≥„Åó„Åè„ÅØ [docs.nestjs.com](https://docs.nestjs.com). :books: 
+* [Í∞ÄÏù¥Îìú](readme_kr.md) Î¨∏ÏÑúÎäî [docs.nestjs.com](https://docs.nestjs.com)ÏóêÏÑú ÌôïÏù∏ÌïòÏã§ Ïàò ÏûàÏäµÎãàÎã§. :books:
+* [„Ç¨„Ç§„Éâ](readme_jp.md)„ÅØ [docs.nestjs.com](https://docs.nestjs.com)„Åß„ÅîÁ¢∫Ë™ç„Åè„Å†„Åï„ÅÑ„ÄÇ :books:
 
 ## Questions
 
@@ -54,36 +53,49 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
 <table style="text-align:center;"><tr>
   <td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
+  <td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/red-hat-logo.svg" width="200" valign="middle" /></a></td>
 <td>
 <a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
 <td>
 <a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
+    <td>
+<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td><td>
+<a href="https://amplication.com/" target="_blank"><img src="https://nestjs.com/img/amplication-logo.svg" width="190" valign="middle" /></a></td>
 </tr></table>
 
 #### Gold Sponsors
 
 <table style="text-align:center;"><tr><td>
-  <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
-  <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
+<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="140" valign="middle" /></a></td>
 <td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
+<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td>
+ <td>
+<a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
+<a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td><td>
+<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td>
+<td>
+<a href="https://ridicorp.com/career/" target="_blank"><img src="https://nestjs.com/img/ridi-logo.svg" width="105" valign="middle" /></a></td><td>
+<a href="https://www.movavi.com/imovie-for-windows.html" target="_blank"><img src="https://nestjs.com/img/movavi-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
 <table style="text-align:center;"><tr><td>
 <a href="https://neoteric.eu/" target="_blank"><img src="https://nestjs.com/img/neoteric-cut.png" width="120" valign="middle" /></a> </td><td>
   <a href="http://gojob.com" target="_blank"><img src="http://nestjs.com/img/gojob-logo.png" valign="middle" width="100" /></a> </td><td>
-<a href="http://www.leogistics.com" target="_blank"><img src="https://nestjs.com/img/leogistics-logo.jpeg" width="150" valign="middle" /></td><td>
+<a href="https://www.myleodsc.com/" target="_blank"><img src="https://nestjs.com/img/myleo-logo.png" width="180" valign="middle" /></td><td>
 <a href="https://careers.meetdandy.com/?gh_src=063ba61e3us" target="_blank"><img src="https://nestjs.com/img/dandy-roles-logo.svg" width="150" valign="middle" /></td><td>
 <a href="https://www.castlecraft.in" target="_blank"><img src="https://nestjs.com/img/castlecraft-logo.png" width="150" valign="middle" /></td>
-<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td></tr></table>
+<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td>
+<td><a href="https://n.inc" target="_blank"><img src="https://nestjs.com/img/n-inc-logo.svg" width="120" valign="middle" /></td></tr><tr>
+<td><a href="https://bilberrry.com/" target="_blank"><img src="https://nestjs.com/img/bilberrry-logo.svg" width="180" valign="middle" /></td>
+<td><a href="https://ipinfo.ai/" target="_blank"><img src="https://nestjs.com/img/ipinfo-logo.png" width="130" valign="middle" /></td>
+<td><a href="https://chax.at" target="_blank"><img src="https://nestjs.com/img/chaxat-logo.png" width="100" valign="middle" /></td></tr>
+</table>
 
 #### Sponsors
 
@@ -91,7 +103,7 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <a href="https://www.swingdev.io" target="_blank"><img src="https://nestjs.com/img/swingdev-logo.svg#1" width="110" valign="middle" /> </a></td><td align="center" valign="middle">
 <a href="https://www.novologic.com/" target="_blank"><img src="https://nestjs.com/img/novologic.png" width="110" valign="middle" /></a> </td><td align="center" valign="middle">
 <a href="https://ever.co/" target="_blank"><img src="https://nestjs.com/img/ever-logo.png" width="72" valign="middle" /></a>  </td><td align="center" valign="middle">
-<a href="https://blokt.com" target="_blank"><img src="https://nestjs.com/img/blokt-logo.png" width="120" valign="middle" /></a>  </td><td align="center" valign="middle"> 
+<a href="https://blokt.com" target="_blank"><img src="https://nestjs.com/img/blokt-logo.png" width="120" valign="middle" /></a>  </td><td align="center" valign="middle">
   <a href="http://architectnow.net/" target="_blank"><img src="https://nestjs.com/img/architectnow.png" width="125" valign="middle" /></a> </td><td align="center" valign="middle">
   <a href="https://quander.io/" target="_blank"><img src="https://nestjs.com/img/quander.png" width="100" valign="middle" /></a> </td></tr><tr><td align="center" valign="middle">
   <a href="https://mantro.net/" target="_blank"><img src="https://nestjs.com/img/mantro-logo.svg" width="95" valign="middle" /></a> </td><td align="center" valign="middle">
@@ -117,6 +129,14 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/naologic-logo.svg" width="125" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://messaged.com/" target="_blank"><img src="https://nestjs.com/img/messaged-logo.png" width="50" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/triplecore-logo.svg" width="50" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://klqc.de" target="_blank"><img src="https://nestjs.com/img/klcqcl-logo.png" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://thecasinowizard.com/bonuses/no-deposit-bonuses/" target="_blank"><img src="https://nestjs.com/img/casinowizard-logo.png" width="120" valign="middle" /></a></td></tr><tr>
+     <td align="center" valign="middle"><a href="https://polygon-software.ch/" target="_blank"><img src="https://nestjs.com/img/polygon-logo.svg" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://mobilereality.pl/" target="_blank"><img src="https://nestjs.com/img/mobile-reality-logo.png" width="45" valign="middle" /></a></td>
+     <td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/boringowl-logo.svg" width="120" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://www.mobilefactory.jp/" target="_blank"><img src="https://nestjs.com/img/mobilefactory-logo.png" width="100" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://nordbot.app/" target="_blank"><img src="https://nestjs.com/img/nordbot-logo.png" width="120" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://doppio.sh/" target="_blank"><img src="https://nestjs.com/img/dopiosh-logo.png" width="50" valign="middle" /></a></td>
   </tr></table>
 
 ## Backers
diff --git a/packages/testing/index.ts b/packages/testing/index.ts
index c68ed76f1..d760d09f7 100644
--- a/packages/testing/index.ts
+++ b/packages/testing/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @testing
- * Copyright(c) 2017 - 2021 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2023 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
diff --git a/packages/testing/interfaces/mock-factory.ts b/packages/testing/interfaces/mock-factory.ts
index 6dc400fb1..0b67435ea 100644
--- a/packages/testing/interfaces/mock-factory.ts
+++ b/packages/testing/interfaces/mock-factory.ts
@@ -1,3 +1,3 @@
-import { InstanceToken } from '@nestjs/core/injector/module';
+import { InjectionToken } from '@nestjs/common';
 
-export type MockFactory = (token?: InstanceToken) => any;
+export type MockFactory = (token?: InjectionToken) => any;
diff --git a/packages/testing/interfaces/override-by-factory-options.interface.ts b/packages/testing/interfaces/override-by-factory-options.interface.ts
index 59a78d657..a2d58ec91 100644
--- a/packages/testing/interfaces/override-by-factory-options.interface.ts
+++ b/packages/testing/interfaces/override-by-factory-options.interface.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export interface OverrideByFactoryOptions {
   factory: (...args: any[]) => any;
   inject?: any[];
diff --git a/packages/testing/interfaces/override-by.interface.ts b/packages/testing/interfaces/override-by.interface.ts
index 25fc60a95..fafc82e46 100644
--- a/packages/testing/interfaces/override-by.interface.ts
+++ b/packages/testing/interfaces/override-by.interface.ts
@@ -1,6 +1,9 @@
 import { TestingModuleBuilder } from '../testing-module.builder';
 import { OverrideByFactoryOptions } from './override-by-factory-options.interface';
 
+/**
+ * @publicApi
+ */
 export interface OverrideBy {
   useValue: (value: any) => TestingModuleBuilder;
   useFactory: (options: OverrideByFactoryOptions) => TestingModuleBuilder;
diff --git a/packages/testing/package.json b/packages/testing/package.json
index bf07363c2..81c012bb0 100644
--- a/packages/testing/package.json
+++ b/packages/testing/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/testing",
-  "version": "8.2.3",
+  "version": "9.4.0",
   "description": "Nest - modern, fast, powerful node.js web framework (@testing)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -17,14 +17,13 @@
     "access": "public"
   },
   "dependencies": {
-    "optional": "0.1.4",
-    "tslib": "2.3.1"
+    "tslib": "2.5.0"
   },
   "peerDependencies": {
-    "@nestjs/common": "^8.0.0",
-    "@nestjs/core": "^8.0.0",
-    "@nestjs/microservices": "^8.0.0",
-    "@nestjs/platform-express": "^8.0.0"
+    "@nestjs/common": "^9.0.0",
+    "@nestjs/core": "^9.0.0",
+    "@nestjs/microservices": "^9.0.0",
+    "@nestjs/platform-express": "^9.0.0"
   },
   "peerDependenciesMeta": {
     "@nestjs/microservices": {
diff --git a/packages/testing/services/testing-logger.service.ts b/packages/testing/services/testing-logger.service.ts
index 1e7b44b2a..3e4b89bf8 100644
--- a/packages/testing/services/testing-logger.service.ts
+++ b/packages/testing/services/testing-logger.service.ts
@@ -2,6 +2,9 @@
 /* eslint-disable @typescript-eslint/no-unused-vars */
 import { ConsoleLogger } from '@nestjs/common';
 
+/**
+ * @publicApi
+ */
 export class TestingLogger extends ConsoleLogger {
   constructor() {
     super('Testing');
diff --git a/packages/testing/testing-injector.ts b/packages/testing/testing-injector.ts
index 417ef295c..4847e4122 100644
--- a/packages/testing/testing-injector.ts
+++ b/packages/testing/testing-injector.ts
@@ -8,6 +8,9 @@ import { InstanceWrapper } from '@nestjs/core/injector/instance-wrapper';
 import { Module } from '@nestjs/core/injector/module';
 import { MockFactory } from './interfaces';
 
+/**
+ * @publicApi
+ */
 export class TestingInjector extends Injector {
   protected mocker?: MockFactory;
   protected container: NestContainer;
diff --git a/packages/testing/testing-instance-loader.ts b/packages/testing/testing-instance-loader.ts
index e11062210..6c4aead48 100644
--- a/packages/testing/testing-instance-loader.ts
+++ b/packages/testing/testing-instance-loader.ts
@@ -3,9 +3,7 @@ import { Module } from '@nestjs/core/injector/module';
 import { MockFactory } from './interfaces';
 import { TestingInjector } from './testing-injector';
 
-export class TestingInstanceLoader extends InstanceLoader {
-  protected injector = new TestingInjector();
-
+export class TestingInstanceLoader extends InstanceLoader<TestingInjector> {
   public async createInstancesOfDependencies(
     modules: Map<string, Module> = this.container.getModules(),
     mocker?: MockFactory,
diff --git a/packages/testing/testing-module.builder.ts b/packages/testing/testing-module.builder.ts
index 3389a9361..673d7455d 100644
--- a/packages/testing/testing-module.builder.ts
+++ b/packages/testing/testing-module.builder.ts
@@ -1,42 +1,40 @@
-import { Logger, LoggerService, Module } from '@nestjs/common';
-import { ModuleMetadata } from '@nestjs/common/interfaces';
+import { Logger, LoggerService, Module, ModuleMetadata } from '@nestjs/common';
+import { NestApplicationContextOptions } from '@nestjs/common/interfaces/nest-application-context-options.interface';
 import { ApplicationConfig } from '@nestjs/core/application-config';
 import { NestContainer } from '@nestjs/core/injector/container';
-import { MetadataScanner } from '@nestjs/core/metadata-scanner';
+import { GraphInspector } from '@nestjs/core/inspector/graph-inspector';
+import { NoopGraphInspector } from '@nestjs/core/inspector/noop-graph-inspector';
 import {
-  DependenciesScanner,
-  ModuleToOverride,
-  ModuleDefinition,
-} from '@nestjs/core/scanner';
+  UuidFactory,
+  UuidFactoryMode,
+} from '@nestjs/core/inspector/uuid-factory';
+import { MetadataScanner } from '@nestjs/core/metadata-scanner';
+import { DependenciesScanner } from '@nestjs/core/scanner';
 import {
   MockFactory,
   OverrideBy,
   OverrideByFactoryOptions,
 } from './interfaces';
 import { TestingLogger } from './services/testing-logger.service';
+import { TestingInjector } from './testing-injector';
 import { TestingInstanceLoader } from './testing-instance-loader';
 import { TestingModule } from './testing-module';
 
+/**
+ * @publicApi
+ */
 export class TestingModuleBuilder {
   private readonly applicationConfig = new ApplicationConfig();
   private readonly container = new NestContainer(this.applicationConfig);
   private readonly overloadsMap = new Map();
-  private readonly overloadsModuleMap = new Map<
-    ModuleDefinition,
-    ModuleDefinition
-  >();
-  private readonly scanner: DependenciesScanner;
-  private readonly instanceLoader = new TestingInstanceLoader(this.container);
   private readonly module: any;
   private testingLogger: LoggerService;
   private mocker?: MockFactory;
 
-  constructor(metadataScanner: MetadataScanner, metadata: ModuleMetadata) {
-    this.scanner = new DependenciesScanner(
-      this.container,
-      metadataScanner,
-      this.applicationConfig,
-    );
+  constructor(
+    private readonly metadataScanner: MetadataScanner,
+    metadata: ModuleMetadata,
+  ) {
     this.module = this.createModule(metadata);
   }
 
@@ -70,30 +68,39 @@ export class TestingModuleBuilder {
     return this.override(typeOrToken, true);
   }
 
-  public overrideModule(moduleToOverride: ModuleDefinition): {
-    useModule: (newModule: ModuleDefinition) => TestingModuleBuilder;
-  } {
-    return {
-      useModule: newModule => {
-        this.overloadsModuleMap.set(moduleToOverride, newModule);
-        return this;
-      },
-    };
-  }
-
-  public async compile(): Promise<TestingModule> {
+  public async compile(
+    options: Pick<NestApplicationContextOptions, 'snapshot' | 'preview'> = {},
+  ): Promise<TestingModule> {
     this.applyLogger();
-    await this.scanner.scan(this.module, this.getModuleOverloads());
 
-    this.applyOverloadsMap();
-    await this.instanceLoader.createInstancesOfDependencies(
-      this.container.getModules(),
-      this.mocker,
+    let graphInspector: GraphInspector;
+    if (options?.snapshot) {
+      graphInspector = new GraphInspector(this.container);
+      UuidFactory.mode = UuidFactoryMode.Deterministic;
+    } else {
+      graphInspector = NoopGraphInspector;
+      UuidFactory.mode = UuidFactoryMode.Random;
+    }
+
+    const scanner = new DependenciesScanner(
+      this.container,
+      this.metadataScanner,
+      graphInspector,
+      this.applicationConfig,
     );
-    this.scanner.applyApplicationProviders();
+    await scanner.scan(this.module);
+
+    this.applyOverloadsMap();
+    await this.createInstancesOfDependencies(graphInspector, options);
+    scanner.applyApplicationProviders();
 
     const root = this.getRootModule();
-    return new TestingModule(this.container, [], root, this.applicationConfig);
+    return new TestingModule(
+      this.container,
+      graphInspector,
+      root,
+      this.applicationConfig,
+    );
   }
 
   private override<T = any>(typeOrToken: T, isProvider: boolean): OverrideBy {
@@ -124,20 +131,29 @@ export class TestingModuleBuilder {
     });
   }
 
-  private getModuleOverloads(): ModuleToOverride[] {
-    return [...this.overloadsModuleMap.entries()].map(
-      ([moduleToReplace, newModule]) => ({
-        moduleToReplace,
-        newModule,
-      }),
-    );
-  }
-
   private getRootModule() {
     const modules = this.container.getModules().values();
     return modules.next().value;
   }
 
+  private async createInstancesOfDependencies(
+    graphInspector: GraphInspector,
+    options: { preview?: boolean },
+  ) {
+    const injector = new TestingInjector({
+      preview: options?.preview ?? false,
+    });
+    const instanceLoader = new TestingInstanceLoader(
+      this.container,
+      injector,
+      graphInspector,
+    );
+    await instanceLoader.createInstancesOfDependencies(
+      this.container.getModules(),
+      this.mocker,
+    );
+  }
+
   private createModule(metadata: ModuleMetadata) {
     class RootTestModule {}
     Module(metadata)(RootTestModule);
diff --git a/packages/testing/testing-module.ts b/packages/testing/testing-module.ts
index d1e15acd6..79d2e86c3 100644
--- a/packages/testing/testing-module.ts
+++ b/packages/testing/testing-module.ts
@@ -9,6 +9,7 @@ import {
 import { NestMicroserviceOptions } from '@nestjs/common/interfaces/microservices/nest-microservice-options.interface';
 import { NestApplicationContextOptions } from '@nestjs/common/interfaces/nest-application-context-options.interface';
 import { loadPackage } from '@nestjs/common/utils/load-package.util';
+import { isUndefined } from '@nestjs/common/utils/shared.utils';
 import {
   AbstractHttpAdapter,
   NestApplication,
@@ -17,31 +18,65 @@ import {
 import { ApplicationConfig } from '@nestjs/core/application-config';
 import { NestContainer } from '@nestjs/core/injector/container';
 import { Module } from '@nestjs/core/injector/module';
+import { GraphInspector } from '@nestjs/core/inspector/graph-inspector';
 
+/**
+ * @publicApi
+ */
 export class TestingModule extends NestApplicationContext {
+  protected readonly graphInspector: GraphInspector;
+
   constructor(
     container: NestContainer,
-    scope: Type<any>[],
+    graphInspector: GraphInspector,
     contextModule: Module,
     private readonly applicationConfig: ApplicationConfig,
+    scope: Type<any>[] = [],
   ) {
-    super(container, scope, contextModule);
+    const options = {};
+    super(container, options, contextModule, scope);
+
+    this.graphInspector = graphInspector;
   }
 
+  private isHttpServer(
+    serverOrOptions:
+      | HttpServer
+      | AbstractHttpAdapter
+      | NestApplicationOptions
+      | undefined,
+  ): serverOrOptions is HttpServer | AbstractHttpAdapter {
+    return !!(serverOrOptions && (serverOrOptions as HttpServer).patch);
+  }
+
+  public createNestApplication<T extends INestApplication = INestApplication>(
+    httpAdapter: HttpServer | AbstractHttpAdapter,
+    options?: NestApplicationOptions,
+  ): T;
+  public createNestApplication<T extends INestApplication = INestApplication>(
+    options?: NestApplicationOptions,
+  ): T;
   public createNestApplication<T extends INestApplication = INestApplication>(
-    httpAdapter?: HttpServer | AbstractHttpAdapter,
+    serverOrOptions:
+      | HttpServer
+      | AbstractHttpAdapter
+      | NestApplicationOptions
+      | undefined,
     options?: NestApplicationOptions,
   ): T {
-    httpAdapter = httpAdapter || this.createHttpAdapter();
+    const [httpAdapter, appOptions] = this.isHttpServer(serverOrOptions)
+      ? [serverOrOptions, options]
+      : [this.createHttpAdapter(), serverOrOptions];
 
-    this.applyLogger(options);
+    this.applyLogger(appOptions);
     this.container.setHttpAdapter(httpAdapter);
 
     const instance = new NestApplication(
       this.container,
       httpAdapter,
       this.applicationConfig,
-      options,
+      this.graphInspector,
+      appOptions,
     );
     return this.createAdapterProxy<T>(instance, httpAdapter);
   }
@@ -58,6 +93,7 @@ export class TestingModule extends NestApplicationContext {
     return new NestMicroservice(
       this.container,
       options,
+      this.graphInspector,
       this.applicationConfig,
     );
   }
@@ -72,7 +108,7 @@ export class TestingModule extends NestApplicationContext {
   }
 
   private applyLogger(options: NestApplicationContextOptions | undefined) {
-    if (!options || !options.logger) {
+    if (!options || isUndefined(options.logger)) {
       return;
     }
     Logger.overrideLogger(options.logger);
diff --git a/packages/testing/tsconfig.build.json b/packages/testing/tsconfig.build.json
new file mode 100644
index 000000000..a5a3a6305
--- /dev/null
+++ b/packages/testing/tsconfig.build.json
@@ -0,0 +1,32 @@
+{
+  "extends": "../tsconfig.build.json",
+  "compilerOptions": {
+    "outDir": ".",
+    "rootDir": ".",
+    "paths": {
+      "@nestjs/common": ["../common"],
+      "@nestjs/common/*": ["../common/*"],
+      "@nestjs/core": ["../core"],
+      "@nestjs/core/*": ["../core/*"],
+      "@nestjs/microservices": ["../microservices"],
+      "@nestjs/microservices/*": ["../microservices/*"],
+      "@nestjs/platform-express": ["../platform-express"],
+      "@nestjs/platform-express/*": ["../platform-express/*"]
+    }
+  },
+  "exclude": ["node_modules", "dist", "test/**/*", "*.spec.ts"],
+  "references": [
+    {
+      "path": "../common/tsconfig.build.json"
+    },
+    {
+      "path": "../core/tsconfig.build.json"
+    },
+    {
+      "path": "../microservices/tsconfig.build.json"
+    },
+    {
+      "path": "../platform-express/tsconfig.build.json"
+    }
+  ]
+}
diff --git a/packages/testing/tsconfig.json b/packages/testing/tsconfig.json
index b238080a4..2ae9e3c90 100644
--- a/packages/testing/tsconfig.json
+++ b/packages/testing/tsconfig.json
@@ -1,7 +1,13 @@
 {
-  "extends": "./../tsconfig.base.json",
+  "extends": "../tsconfig.build.json",
   "compilerOptions": {
-    "baseUrl": "./"
+    "types": ["node"]
   },
-  "include": ["*.ts", "**/*.ts"]
+  "files": [],
+  "include": [],
+  "references": [
+    {
+      "path": "./tsconfig.build.json"
+    }
+  ]
 }
diff --git a/packages/tsconfig.base.json b/packages/tsconfig.build.json
similarity index 81%
rename from packages/tsconfig.base.json
rename to packages/tsconfig.build.json
index ff837eb4f..f91353d5b 100644
--- a/packages/tsconfig.base.json
+++ b/packages/tsconfig.build.json
@@ -1,22 +1,22 @@
 {
   "compilerOptions": {
+    "composite": true,
     "module": "commonjs",
     "declaration": true,
     "noImplicitAny": false,
     "skipLibCheck": true,
-    "suppressImplicitAnyIndexErrors": true,
     "noUnusedLocals": false,
     "importHelpers": true,
     "removeComments": false,
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
+    "useUnknownInCatchVariables": false,
     "target": "es2017",
     "sourceMap": false,
     "allowJs": false,
     "strict": true,
     "strictNullChecks": false,
     "types": ["node"]
-  },
-  "exclude": ["../node_modules", "./**/*.spec.ts"]
+  }
 }
diff --git a/packages/tsconfig.json b/packages/tsconfig.json
new file mode 100644
index 000000000..b980bbe84
--- /dev/null
+++ b/packages/tsconfig.json
@@ -0,0 +1,32 @@
+{
+  "files": [],
+  "references": [
+    {
+      "path": "./common/tsconfig.build.json"
+    },
+    {
+      "path": "./core/tsconfig.build.json"
+    },
+    {
+      "path": "./microservices/tsconfig.build.json"
+    },
+    {
+      "path": "./platform-express/tsconfig.build.json"
+    },
+    {
+      "path": "./platform-fastify/tsconfig.build.json"
+    },
+    {
+      "path": "./platform-socket.io/tsconfig.build.json"
+    },
+    {
+      "path": "./platform-ws/tsconfig.build.json"
+    },
+    {
+      "path": "./testing/tsconfig.build.json"
+    },
+    {
+      "path": "./websockets/tsconfig.build.json"
+    }
+  ]
+}
diff --git a/packages/websockets/CHANGELOG.md b/packages/websockets/CHANGELOG.md
deleted file mode 100644
index 125af3005..000000000
--- a/packages/websockets/CHANGELOG.md
+++ /dev/null
@@ -1,12 +0,0 @@
-# Change Log
-
-All notable changes to this project will be documented in this file.
-See [Conventional Commits](https://conventionalcommits.org) for commit guidelines.
-
-<a name="8.2.0"></a>
-# [8.2.0](https://github.com/nestjs/nest/compare/v8.1.2...v8.2.0) (2021-11-08)
-
-
-
-
-**Note:** Version bump only for package @nestjs/websockets
diff --git a/packages/websockets/Readme.md b/packages/websockets/Readme.md
index f288809a9..16f48336d 100644
--- a/packages/websockets/Readme.md
+++ b/packages/websockets/Readme.md
@@ -11,7 +11,6 @@
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
 <a href="https://circleci.com/gh/nestjs/nest" target="_blank"><img src="https://img.shields.io/circleci/build/github/nestjs/nest/master" alt="CircleCI" /></a>
-<a href="https://coveralls.io/github/nestjs/nest?branch=master" target="_blank"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#9" alt="Coverage" /></a>
 <a href="https://discord.gg/G7Qnnhy" target="_blank"><img src="https://img.shields.io/badge/discord-online-brightgreen.svg" alt="Discord"/></a>
 <a href="https://opencollective.com/nest#backer" target="_blank"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
 <a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
@@ -37,8 +36,8 @@ Nest is a framework for building efficient, scalable <a href="http://nodejs.org"
 
 * To check out the [guide](https://docs.nestjs.com), visit [docs.nestjs.com](https://docs.nestjs.com). :books:
 * Ë¶ÅÊü•Áúã‰∏≠Êñá [ÊåáÂçó](readme_zh.md), ËØ∑ËÆøÈóÆ [docs.nestjs.cn](https://docs.nestjs.cn). :books:
-* [Í∞ÄÏù¥Îìú](readme_kr.md)Î•º ÌôïÏù∏ÌïòÎ†§Î©¥, [docs.nestjs.com](https://docs.nestjs.com)Î•º Î∞©Î¨∏ÌïòÏÑ∏Ïöî.:books: 
-* „ÉÅ„Çß„ÉÉ„ÇØ„Åô„Çã„Å´„ÅØ [„Ç¨„Ç§„Éâ](readme_jp.md), Ë©≥„Åó„Åè„ÅØ [docs.nestjs.com](https://docs.nestjs.com). :books: 
+* [Í∞ÄÏù¥Îìú](readme_kr.md) Î¨∏ÏÑúÎäî [docs.nestjs.com](https://docs.nestjs.com)ÏóêÏÑú ÌôïÏù∏ÌïòÏã§ Ïàò ÏûàÏäµÎãàÎã§. :books:
+* [„Ç¨„Ç§„Éâ](readme_jp.md)„ÅØ [docs.nestjs.com](https://docs.nestjs.com)„Åß„ÅîÁ¢∫Ë™ç„Åè„Å†„Åï„ÅÑ„ÄÇ :books:
 
 ## Questions
 
@@ -54,36 +53,49 @@ With official support, you can get expert help straight from Nest core team. We
 
 ## Support
 
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support from the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
 
 #### Principal Sponsors
 <table style="text-align:center;"><tr>
   <td><a href="https://trilon.io" target="_blank"><img src="https://nestjs.com/img/trilon.svg" width="200" valign="middle" /></a></td>
+  <td><a href="https://www.redhat.com" target="_blank"><img src="https://nestjs.com/img/red-hat-logo.svg" width="200" valign="middle" /></a></td>
 <td>
 <a href="https://github.com/Sanofi-IADC" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/sanofi.png" width="180" valign="middle" /></a></td>
 <td>
 <a href="https://nx.dev" target="_blank"><img src="https://nestjs.com/img/nx-logo.png" height="45" valign="middle" /></a></td>
+    <td>
+<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td><td>
+<a href="https://amplication.com/" target="_blank"><img src="https://nestjs.com/img/amplication-logo.svg" width="190" valign="middle" /></a></td>
 </tr></table>
 
 #### Gold Sponsors
 
 <table style="text-align:center;"><tr><td>
-  <a href="https://careers.labster.com/departments/platform" target="_blank"><img src="https://nestjs.com/img/labster-logo.png" width="170" valign="middle" /></a></td><td>
-<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="150" valign="middle" /></a></td>
-  <td>
-<a href="https://valor-software.com/" target="_blank"><img src="https://docs.nestjs.com/assets/sponsors/valor-software.png" width="170" valign="middle" /></a></td>
+<a href="https://weld.app/" target="_blank"><img src="https://nestjs.com/img/weld-logo.svg" width="140" valign="middle" /></a></td>
 <td>
-<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td></</tr></table>
+<a href="https://intrinsic.ventures/" target="_blank"><img src="https://nestjs.com/img/intrinisic-logo.png" width="210" valign="middle" /></a></td>
+ <td>
+<a href="https://jetbrains.com/" target="_blank"><img src="https://nestjs.com/img/jetbrains-logo.svg" width="110" valign="middle" /></a></td><td>
+<a href="https://snyk.co/nestjs" target="_blank"><img src="https://nestjs.com/img/snyk-logo-black.png" width="185" valign="middle" /></a></td><td>
+<a href="https://fuseautotech.com/" target="_blank"><img src="https://nestjs.com/img/fuse-logo.svg" width="105" valign="middle" /></a></td>
+<td>
+<a href="https://ridicorp.com/career/" target="_blank"><img src="https://nestjs.com/img/ridi-logo.svg" width="105" valign="middle" /></a></td><td>
+<a href="https://www.movavi.com/imovie-for-windows.html" target="_blank"><img src="https://nestjs.com/img/movavi-logo.svg" width="105" valign="middle" /></a></td></</tr></table>
 
 #### Silver Sponsors
 
 <table style="text-align:center;"><tr><td>
 <a href="https://neoteric.eu/" target="_blank"><img src="https://nestjs.com/img/neoteric-cut.png" width="120" valign="middle" /></a> </td><td>
   <a href="http://gojob.com" target="_blank"><img src="http://nestjs.com/img/gojob-logo.png" valign="middle" width="100" /></a> </td><td>
-<a href="http://www.leogistics.com" target="_blank"><img src="https://nestjs.com/img/leogistics-logo.jpeg" width="150" valign="middle" /></td><td>
+<a href="https://www.myleodsc.com/" target="_blank"><img src="https://nestjs.com/img/myleo-logo.png" width="180" valign="middle" /></td><td>
 <a href="https://careers.meetdandy.com/?gh_src=063ba61e3us" target="_blank"><img src="https://nestjs.com/img/dandy-roles-logo.svg" width="150" valign="middle" /></td><td>
 <a href="https://www.castlecraft.in" target="_blank"><img src="https://nestjs.com/img/castlecraft-logo.png" width="150" valign="middle" /></td>
-<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td></tr></table>
+<td><a href="https://www.tinystacks.com" target="_blank"><img src="https://nestjs.com/img/tinystacks-logo.png#1" width="140" valign="middle" /></td>
+<td><a href="https://n.inc" target="_blank"><img src="https://nestjs.com/img/n-inc-logo.svg" width="120" valign="middle" /></td></tr><tr>
+<td><a href="https://bilberrry.com/" target="_blank"><img src="https://nestjs.com/img/bilberrry-logo.svg" width="180" valign="middle" /></td>
+<td><a href="https://ipinfo.ai/" target="_blank"><img src="https://nestjs.com/img/ipinfo-logo.png" width="130" valign="middle" /></td>
+<td><a href="https://chax.at" target="_blank"><img src="https://nestjs.com/img/chaxat-logo.png" width="100" valign="middle" /></td></tr>
+</table>
 
 #### Sponsors
 
@@ -91,7 +103,7 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <a href="https://www.swingdev.io" target="_blank"><img src="https://nestjs.com/img/swingdev-logo.svg#1" width="110" valign="middle" /> </a></td><td align="center" valign="middle">
 <a href="https://www.novologic.com/" target="_blank"><img src="https://nestjs.com/img/novologic.png" width="110" valign="middle" /></a> </td><td align="center" valign="middle">
 <a href="https://ever.co/" target="_blank"><img src="https://nestjs.com/img/ever-logo.png" width="72" valign="middle" /></a>  </td><td align="center" valign="middle">
-<a href="https://blokt.com" target="_blank"><img src="https://nestjs.com/img/blokt-logo.png" width="120" valign="middle" /></a>  </td><td align="center" valign="middle"> 
+<a href="https://blokt.com" target="_blank"><img src="https://nestjs.com/img/blokt-logo.png" width="120" valign="middle" /></a>  </td><td align="center" valign="middle">
   <a href="http://architectnow.net/" target="_blank"><img src="https://nestjs.com/img/architectnow.png" width="125" valign="middle" /></a> </td><td align="center" valign="middle">
   <a href="https://quander.io/" target="_blank"><img src="https://nestjs.com/img/quander.png" width="100" valign="middle" /></a> </td></tr><tr><td align="center" valign="middle">
   <a href="https://mantro.net/" target="_blank"><img src="https://nestjs.com/img/mantro-logo.svg" width="95" valign="middle" /></a> </td><td align="center" valign="middle">
@@ -117,6 +129,14 @@ Nest is an MIT-licensed open source project. It can grow thanks to the sponsors
 <td align="center" valign="middle"><a href="https://www.naologic.com/" target="_blank"><img src="https://nestjs.com/img/naologic-logo.svg" width="125" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://messaged.com/" target="_blank"><img src="https://nestjs.com/img/messaged-logo.png" width="50" valign="middle" /></a></td>
   <td align="center" valign="middle"><a href="https://triplecore.io" target="_blank"><img src="https://nestjs.com/img/triplecore-logo.svg" width="50" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://klqc.de" target="_blank"><img src="https://nestjs.com/img/klcqcl-logo.png" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://thecasinowizard.com/bonuses/no-deposit-bonuses/" target="_blank"><img src="https://nestjs.com/img/casinowizard-logo.png" width="120" valign="middle" /></a></td></tr><tr>
+     <td align="center" valign="middle"><a href="https://polygon-software.ch/" target="_blank"><img src="https://nestjs.com/img/polygon-logo.svg" width="120" valign="middle" /></a></td>
+   <td align="center" valign="middle"><a href="https://mobilereality.pl/" target="_blank"><img src="https://nestjs.com/img/mobile-reality-logo.png" width="45" valign="middle" /></a></td>
+     <td align="center" valign="middle"><a href="https://boringowl.io/" target="_blank"><img src="https://nestjs.com/img/boringowl-logo.svg" width="120" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://www.mobilefactory.jp/" target="_blank"><img src="https://nestjs.com/img/mobilefactory-logo.png" width="100" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://nordbot.app/" target="_blank"><img src="https://nestjs.com/img/nordbot-logo.png" width="120" valign="middle" /></a></td>
+ <td align="center" valign="middle"><a href="https://doppio.sh/" target="_blank"><img src="https://nestjs.com/img/dopiosh-logo.png" width="50" valign="middle" /></a></td>
   </tr></table>
 
 ## Backers
diff --git a/packages/websockets/context/exception-filters-context.ts b/packages/websockets/context/exception-filters-context.ts
index 319aedc54..6ec95a1f9 100644
--- a/packages/websockets/context/exception-filters-context.ts
+++ b/packages/websockets/context/exception-filters-context.ts
@@ -4,6 +4,9 @@ import { BaseExceptionFilterContext } from '@nestjs/core/exceptions/base-excepti
 import { NestContainer } from '@nestjs/core/injector/container';
 import { WsExceptionsHandler } from '../exceptions/ws-exceptions-handler';
 
+/**
+ * @publicApi
+ */
 export class ExceptionFiltersContext extends BaseExceptionFilterContext {
   constructor(container: NestContainer) {
     super(container);
diff --git a/packages/websockets/context/ws-context-creator.ts b/packages/websockets/context/ws-context-creator.ts
index ed0819bf8..3dca71f95 100644
--- a/packages/websockets/context/ws-context-creator.ts
+++ b/packages/websockets/context/ws-context-creator.ts
@@ -1,5 +1,5 @@
 import {
-  CUSTOM_ROUTE_AGRS_METADATA,
+  CUSTOM_ROUTE_ARGS_METADATA,
   PARAMTYPES_METADATA,
 } from '@nestjs/common/constants';
 import {
@@ -18,10 +18,11 @@ import {
 import { ExecutionContextHost } from '@nestjs/core/helpers/execution-context-host';
 import { HandlerMetadataStorage } from '@nestjs/core/helpers/handler-metadata-storage';
 import { ParamsMetadata } from '@nestjs/core/helpers/interfaces';
-import { InterceptorsConsumer } from '@nestjs/core/interceptors/interceptors-consumer';
-import { InterceptorsContextCreator } from '@nestjs/core/interceptors/interceptors-context-creator';
-import { PipesConsumer } from '@nestjs/core/pipes/pipes-consumer';
-import { PipesContextCreator } from '@nestjs/core/pipes/pipes-context-creator';
+import {
+  InterceptorsConsumer,
+  InterceptorsContextCreator,
+} from '@nestjs/core/interceptors';
+import { PipesConsumer, PipesContextCreator } from '@nestjs/core/pipes';
 import { PARAM_ARGS_METADATA } from '../constants';
 import { WsException } from '../errors/ws-exception';
 import { WsParamsFactory } from '../factories/ws-params-factory';
@@ -210,7 +211,7 @@ export class WsContextCreator {
         this.pipesContextCreator.createConcreteContext(pipesCollection);
       const type = this.contextUtils.mapParamType(key);
 
-      if (key.includes(CUSTOM_ROUTE_AGRS_METADATA)) {
+      if (key.includes(CUSTOM_ROUTE_ARGS_METADATA)) {
         const { factory } = metadata[key];
         const customExtractValue = this.contextUtils.getCustomFactory(
           factory,
diff --git a/packages/websockets/context/ws-proxy.ts b/packages/websockets/context/ws-proxy.ts
index ca1ce3b95..dee999afc 100644
--- a/packages/websockets/context/ws-proxy.ts
+++ b/packages/websockets/context/ws-proxy.ts
@@ -1,6 +1,5 @@
-import { isFunction } from '@nestjs/common/utils/shared.utils';
 import { ExecutionContextHost } from '@nestjs/core/helpers/execution-context-host';
-import { empty } from 'rxjs';
+import { EMPTY, isObservable } from 'rxjs';
 import { catchError } from 'rxjs/operators';
 import { WsExceptionsHandler } from '../exceptions/ws-exceptions-handler';
 
@@ -12,12 +11,12 @@ export class WsProxy {
     return async (...args: unknown[]) => {
       try {
         const result = await targetCallback(...args);
-        return !this.isObservable(result)
+        return !isObservable(result)
           ? result
           : result.pipe(
               catchError(error => {
                 this.handleError(exceptionsHandler, args, error);
-                return empty();
+                return EMPTY;
               }),
             );
       } catch (error) {
@@ -35,8 +34,4 @@ export class WsProxy {
     host.setType('ws');
     exceptionsHandler.handle(error, host);
   }
-
-  isObservable(result: any): boolean {
-    return result && isFunction(result.subscribe);
-  }
 }
diff --git a/packages/websockets/decorators/connected-socket.decorator.ts b/packages/websockets/decorators/connected-socket.decorator.ts
index 32bd663c7..c21e4f8a1 100644
--- a/packages/websockets/decorators/connected-socket.decorator.ts
+++ b/packages/websockets/decorators/connected-socket.decorator.ts
@@ -1,6 +1,9 @@
 import { WsParamtype } from '../enums/ws-paramtype.enum';
 import { createWsParamDecorator } from '../utils/param.utils';
 
+/**
+ * @publicApi
+ */
 export const ConnectedSocket: () => ParameterDecorator = createWsParamDecorator(
   WsParamtype.SOCKET,
 );
diff --git a/packages/websockets/decorators/gateway-server.decorator.ts b/packages/websockets/decorators/gateway-server.decorator.ts
index a3a21b634..3a0832639 100644
--- a/packages/websockets/decorators/gateway-server.decorator.ts
+++ b/packages/websockets/decorators/gateway-server.decorator.ts
@@ -2,6 +2,8 @@ import { GATEWAY_SERVER_METADATA } from '../constants';
 
 /**
  * Attaches native Web Socket Server to a given property.
+ *
+ * @publicApi
  */
 export const WebSocketServer = (): PropertyDecorator => {
   return (target: object, propertyKey: string | symbol) => {
diff --git a/packages/websockets/decorators/socket-gateway.decorator.ts b/packages/websockets/decorators/socket-gateway.decorator.ts
index 4361b121d..8fc1c9bae 100644
--- a/packages/websockets/decorators/socket-gateway.decorator.ts
+++ b/packages/websockets/decorators/socket-gateway.decorator.ts
@@ -4,6 +4,8 @@ import { GatewayMetadata } from '../interfaces';
 /**
  * Decorator that marks a class as a Nest gateway that enables real-time, bidirectional
  * and event-based communication between the browser and the server.
+ *
+ * @publicApi
  */
 export function WebSocketGateway(port?: number): ClassDecorator;
 export function WebSocketGateway<
diff --git a/packages/websockets/decorators/subscribe-message.decorator.ts b/packages/websockets/decorators/subscribe-message.decorator.ts
index 2b22c9376..4e3329900 100644
--- a/packages/websockets/decorators/subscribe-message.decorator.ts
+++ b/packages/websockets/decorators/subscribe-message.decorator.ts
@@ -2,6 +2,8 @@ import { MESSAGE_MAPPING_METADATA, MESSAGE_METADATA } from '../constants';
 
 /**
  * Subscribes to messages that fulfils chosen pattern.
+ *
+ * @publicApi
  */
 export const SubscribeMessage = <T = string>(message: T): MethodDecorator => {
   return (
diff --git a/packages/websockets/exceptions/base-ws-exception-filter.ts b/packages/websockets/exceptions/base-ws-exception-filter.ts
index 5c29d5a03..bcc48b0a6 100644
--- a/packages/websockets/exceptions/base-ws-exception-filter.ts
+++ b/packages/websockets/exceptions/base-ws-exception-filter.ts
@@ -3,6 +3,9 @@ import { isObject } from '@nestjs/common/utils/shared.utils';
 import { MESSAGES } from '@nestjs/core/constants';
 import { WsException } from '../errors/ws-exception';
 
+/**
+ * @publicApi
+ */
 export class BaseWsExceptionFilter<TError = any>
   implements WsExceptionFilter<TError>
 {
diff --git a/packages/websockets/exceptions/ws-exceptions-handler.ts b/packages/websockets/exceptions/ws-exceptions-handler.ts
index e1b09589d..feed7d397 100644
--- a/packages/websockets/exceptions/ws-exceptions-handler.ts
+++ b/packages/websockets/exceptions/ws-exceptions-handler.ts
@@ -1,10 +1,14 @@
+import { isEmpty } from '@nestjs/common/utils/shared.utils';
 import { ArgumentsHost } from '@nestjs/common';
 import { ExceptionFilterMetadata } from '@nestjs/common/interfaces/exceptions/exception-filter-metadata.interface';
-import { isEmpty } from '@nestjs/common/utils/shared.utils';
+import { selectExceptionFilterMetadata } from '@nestjs/common/utils/select-exception-filter-metadata.util';
 import { InvalidExceptionFilterException } from '@nestjs/core/errors/exceptions/invalid-exception-filter.exception';
 import { WsException } from '../errors/ws-exception';
 import { BaseWsExceptionFilter } from './base-ws-exception-filter';
 
+/**
+ * @publicApi
+ */
 export class WsExceptionsHandler extends BaseWsExceptionFilter {
   private filters: ExceptionFilterMetadata[] = [];
 
@@ -29,14 +33,7 @@ export class WsExceptionsHandler extends BaseWsExceptionFilter {
   ): boolean {
     if (isEmpty(this.filters)) return false;
 
-    const filter = this.filters.find(({ exceptionMetatypes }) => {
-      const hasMetatype =
-        !exceptionMetatypes.length ||
-        exceptionMetatypes.some(
-          ExceptionMetatype => exception instanceof ExceptionMetatype,
-        );
-      return hasMetatype;
-    });
+    const filter = selectExceptionFilterMetadata(this.filters, exception);
     filter && filter.func(exception, args);
     return !!filter;
   }
diff --git a/packages/websockets/gateway-metadata-explorer.ts b/packages/websockets/gateway-metadata-explorer.ts
index dc20cfbe3..65a0c4077 100644
--- a/packages/websockets/gateway-metadata-explorer.ts
+++ b/packages/websockets/gateway-metadata-explorer.ts
@@ -19,12 +19,10 @@ export class GatewayMetadataExplorer {
 
   public explore(instance: NestGateway): MessageMappingProperties[] {
     const instancePrototype = Object.getPrototypeOf(instance);
-    return this.metadataScanner.scanFromPrototype<
-      NestGateway,
-      MessageMappingProperties
-    >(instance, instancePrototype, method =>
-      this.exploreMethodMetadata(instancePrototype, method),
-    );
+    return this.metadataScanner
+      .getAllMethodNames(instancePrototype)
+      .map(method => this.exploreMethodMetadata(instancePrototype, method))
+      .filter(metadata => metadata);
   }
 
   public exploreMethodMetadata(
diff --git a/packages/websockets/index.ts b/packages/websockets/index.ts
index 76db23065..bccb398b5 100644
--- a/packages/websockets/index.ts
+++ b/packages/websockets/index.ts
@@ -1,6 +1,6 @@
 /*
  * Nest @websockets
- * Copyright(c) 2017 - 2021 Kamil Mysliwiec
+ * Copyright(c) 2017 - 2023 Kamil Mysliwiec
  * https://nestjs.com
  * MIT Licensed
  */
diff --git a/packages/websockets/interfaces/gateway-metadata.interface.ts b/packages/websockets/interfaces/gateway-metadata.interface.ts
index 1666b321f..383287682 100644
--- a/packages/websockets/interfaces/gateway-metadata.interface.ts
+++ b/packages/websockets/interfaces/gateway-metadata.interface.ts
@@ -1,9 +1,10 @@
-/**
- * @external https://github.com/socketio/socket.io/blob/master/lib/index.ts
- */
-
 import { CorsOptions } from '@nestjs/common/interfaces/external/cors-options.interface';
 
+/**
+ * External interface
+ * @see https://github.com/socketio/socket.io/blob/master/lib/index.ts 
+ * @publicApi
+ */
 export interface GatewayMetadata {
   /**
    * The name of a namespace
@@ -31,27 +32,27 @@ export interface GatewayMetadata {
   parser?: any;
   /**
    * How many ms before a client without namespace is closed
-   * @default 45000
+   * @default 45_000
    */
   connectTimeout?: number;
   /**
    * How many ms without a pong packet to consider the connection closed
-   * @default 5000
+   * @default 20_000
    */
   pingTimeout?: number;
   /**
    * How many ms before sending a new ping packet
-   * @default 25000
+   * @default 25_000
    */
   pingInterval?: number;
   /**
    * How many ms before an uncompleted transport upgrade is cancelled
-   * @default 10000
+   * @default 10_000
    */
   upgradeTimeout?: number;
   /**
    * How many bytes or characters a message can be, before closing the session (to avoid DoS).
-   * @default 1e5 (100 KB)
+   * @default 1e6 (1 MB)
    */
   maxHttpBufferSize?: number;
   /**
@@ -116,7 +117,7 @@ export interface GatewayMetadata {
   destroyUpgrade?: boolean;
   /**
    * Milliseconds after which unhandled requests are ended
-   * @default 1000
+   * @default 1_000
    */
   destroyUpgradeTimeout?: number;
 }
diff --git a/packages/websockets/interfaces/hooks/on-gateway-connection.interface.ts b/packages/websockets/interfaces/hooks/on-gateway-connection.interface.ts
index b3ca0f51c..7f39dbdcf 100644
--- a/packages/websockets/interfaces/hooks/on-gateway-connection.interface.ts
+++ b/packages/websockets/interfaces/hooks/on-gateway-connection.interface.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export interface OnGatewayConnection<T = any> {
   handleConnection(client: T, ...args: any[]): any;
 }
diff --git a/packages/websockets/interfaces/hooks/on-gateway-disconnect.interface.ts b/packages/websockets/interfaces/hooks/on-gateway-disconnect.interface.ts
index f038c2162..e86e27d8f 100644
--- a/packages/websockets/interfaces/hooks/on-gateway-disconnect.interface.ts
+++ b/packages/websockets/interfaces/hooks/on-gateway-disconnect.interface.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export interface OnGatewayDisconnect<T = any> {
   handleDisconnect(client: T): any;
 }
diff --git a/packages/websockets/interfaces/hooks/on-gateway-init.interface.ts b/packages/websockets/interfaces/hooks/on-gateway-init.interface.ts
index 81096e55c..c90f5d8c6 100644
--- a/packages/websockets/interfaces/hooks/on-gateway-init.interface.ts
+++ b/packages/websockets/interfaces/hooks/on-gateway-init.interface.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export interface OnGatewayInit<T = any> {
   afterInit(server: T): any;
 }
diff --git a/packages/websockets/interfaces/nest-gateway.interface.ts b/packages/websockets/interfaces/nest-gateway.interface.ts
index 1011bb053..89472d362 100644
--- a/packages/websockets/interfaces/nest-gateway.interface.ts
+++ b/packages/websockets/interfaces/nest-gateway.interface.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export interface NestGateway {
   afterInit?: (server: any) => void;
   handleConnection?: (...args: any[]) => void;
diff --git a/packages/websockets/interfaces/server-and-event-streams-host.interface.ts b/packages/websockets/interfaces/server-and-event-streams-host.interface.ts
index 4b04a81e5..5049dc959 100644
--- a/packages/websockets/interfaces/server-and-event-streams-host.interface.ts
+++ b/packages/websockets/interfaces/server-and-event-streams-host.interface.ts
@@ -1,5 +1,8 @@
 import { ReplaySubject, Subject } from 'rxjs';
 
+/**
+ * @publicApi
+ */
 export interface ServerAndEventStreamsHost<T = any> {
   server: T;
   init: ReplaySubject<T>;
diff --git a/packages/websockets/interfaces/web-socket-server.interface.ts b/packages/websockets/interfaces/web-socket-server.interface.ts
index 0c0387acf..d573038c1 100644
--- a/packages/websockets/interfaces/web-socket-server.interface.ts
+++ b/packages/websockets/interfaces/web-socket-server.interface.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export interface WebSocketServerOptions {
   port: number;
   namespace: string;
diff --git a/packages/websockets/interfaces/websockets-entrypoint-metadata.interface.ts b/packages/websockets/interfaces/websockets-entrypoint-metadata.interface.ts
new file mode 100644
index 000000000..bd80cd5d2
--- /dev/null
+++ b/packages/websockets/interfaces/websockets-entrypoint-metadata.interface.ts
@@ -0,0 +1,4 @@
+export type WebsocketEntrypointMetadata = {
+  port: number;
+  message: unknown;
+};
diff --git a/packages/websockets/interfaces/ws-response.interface.ts b/packages/websockets/interfaces/ws-response.interface.ts
index 04e815cbf..bf04aa48a 100644
--- a/packages/websockets/interfaces/ws-response.interface.ts
+++ b/packages/websockets/interfaces/ws-response.interface.ts
@@ -1,3 +1,6 @@
+/**
+ * @publicApi
+ */
 export interface WsResponse<T = any> {
   event: string;
   data: T;
diff --git a/packages/websockets/package.json b/packages/websockets/package.json
index c1bbcacae..faf4ff219 100644
--- a/packages/websockets/package.json
+++ b/packages/websockets/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@nestjs/websockets",
-  "version": "8.2.3",
+  "version": "9.4.0",
   "description": "Nest - modern, fast, powerful node.js web framework (@websockets)",
   "author": "Kamil Mysliwiec",
   "license": "MIT",
@@ -13,17 +13,17 @@
   },
   "dependencies": {
     "iterare": "1.2.1",
-    "object-hash": "2.2.0",
-    "tslib": "2.3.1"
+    "object-hash": "3.0.0",
+    "tslib": "2.5.0"
   },
   "devDependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3"
+    "@nestjs/common": "9.4.0",
+    "@nestjs/core": "9.4.0"
   },
   "peerDependencies": {
-    "@nestjs/common": "^8.0.0",
-    "@nestjs/core": "^8.0.0",
-    "@nestjs/platform-socket.io": "^8.0.0",
+    "@nestjs/common": "^9.0.0",
+    "@nestjs/core": "^9.0.0",
+    "@nestjs/platform-socket.io": "^9.0.0",
     "reflect-metadata": "^0.1.12",
     "rxjs": "^7.1.0"
   },
diff --git a/packages/websockets/socket-module.ts b/packages/websockets/socket-module.ts
index 681cb0a08..d22e45067 100644
--- a/packages/websockets/socket-module.ts
+++ b/packages/websockets/socket-module.ts
@@ -1,11 +1,13 @@
+import { InjectionToken } from '@nestjs/common/interfaces';
 import { Injectable } from '@nestjs/common/interfaces/injectable.interface';
+import { NestApplicationContextOptions } from '@nestjs/common/interfaces/nest-application-context-options.interface';
 import { ApplicationConfig } from '@nestjs/core/application-config';
 import { GuardsConsumer } from '@nestjs/core/guards/guards-consumer';
 import { GuardsContextCreator } from '@nestjs/core/guards/guards-context-creator';
 import { loadAdapter } from '@nestjs/core/helpers/load-adapter';
 import { NestContainer } from '@nestjs/core/injector/container';
 import { InstanceWrapper } from '@nestjs/core/injector/instance-wrapper';
-import { InstanceToken } from '@nestjs/core/injector/module';
+import { GraphInspector } from '@nestjs/core/inspector/graph-inspector';
 import { InterceptorsConsumer } from '@nestjs/core/interceptors/interceptors-consumer';
 import { InterceptorsContextCreator } from '@nestjs/core/interceptors/interceptors-context-creator';
 import { PipesConsumer } from '@nestjs/core/pipes/pipes-consumer';
@@ -21,30 +23,39 @@ import { SocketServerProvider } from './socket-server-provider';
 import { SocketsContainer } from './sockets-container';
 import { WebSocketsController } from './web-sockets-controller';
 
-export class SocketModule<HttpServer = any> {
+export class SocketModule<
+  THttpServer = any,
+  TAppOptions extends NestApplicationContextOptions = NestApplicationContextOptions,
+> {
   private readonly socketsContainer = new SocketsContainer();
   private applicationConfig: ApplicationConfig;
   private webSocketsController: WebSocketsController;
   private isAdapterInitialized: boolean;
-  private httpServer: HttpServer | undefined;
+  private httpServer: THttpServer | undefined;
+  private appOptions: TAppOptions;
 
   public register(
     container: NestContainer,
-    config: ApplicationConfig,
-    httpServer?: HttpServer,
+    applicationConfig: ApplicationConfig,
+    graphInspector: GraphInspector,
+    appOptions: TAppOptions,
+    httpServer?: THttpServer,
   ) {
-    this.applicationConfig = config;
+    this.applicationConfig = applicationConfig;
+    this.appOptions = appOptions;
     this.httpServer = httpServer;
 
     const contextCreator = this.getContextCreator(container);
     const serverProvider = new SocketServerProvider(
       this.socketsContainer,
-      config,
+      applicationConfig,
     );
     this.webSocketsController = new WebSocketsController(
       serverProvider,
-      config,
+      applicationConfig,
       contextCreator,
+      graphInspector,
+      this.appOptions,
     );
     const modules = container.getModules();
     modules.forEach(({ providers }, moduleName: string) =>
@@ -53,7 +64,7 @@ export class SocketModule<HttpServer = any> {
   }
 
   public connectAllGateways(
-    providers: Map<InstanceToken, InstanceWrapper<Injectable>>,
+    providers: Map<InjectionToken, InstanceWrapper<Injectable>>,
     moduleName: string,
   ) {
     iterate(providers.values())
@@ -77,6 +88,7 @@ export class SocketModule<HttpServer = any> {
       instance as NestGateway,
       metatype,
       moduleName,
+      wrapper.id,
     );
   }
 
diff --git a/packages/websockets/test/context/ws-context-creator.spec.ts b/packages/websockets/test/context/ws-context-creator.spec.ts
index b51a48987..e6b7b5107 100644
--- a/packages/websockets/test/context/ws-context-creator.spec.ts
+++ b/packages/websockets/test/context/ws-context-creator.spec.ts
@@ -3,7 +3,7 @@ import { expect } from 'chai';
 import { of } from 'rxjs';
 import * as sinon from 'sinon';
 import { Injectable, UseGuards, UsePipes } from '../../../common';
-import { CUSTOM_ROUTE_AGRS_METADATA } from '../../../common/constants';
+import { CUSTOM_ROUTE_ARGS_METADATA } from '../../../common/constants';
 import { GuardsConsumer } from '../../../core/guards/guards-consumer';
 import { GuardsContextCreator } from '../../../core/guards/guards-context-creator';
 import { NestContainer } from '../../../core/injector/container';
@@ -155,7 +155,7 @@ describe('WsContextCreator', () => {
       const metadata = {
         [WsParamtype.SOCKET]: { index: 0, data: 'test', pipes: [] },
         [WsParamtype.PAYLOAD]: { index: 2, data: 'test', pipes: [] },
-        [`key${CUSTOM_ROUTE_AGRS_METADATA}`]: {
+        [`key${CUSTOM_ROUTE_ARGS_METADATA}`]: {
           index: 3,
           data: 'custom',
           pipes: [],
@@ -172,7 +172,7 @@ describe('WsContextCreator', () => {
       const expectedValues = [
         { index: 0, type: WsParamtype.SOCKET, data: 'test' },
         { index: 2, type: WsParamtype.PAYLOAD, data: 'test' },
-        { index: 3, type: `key${CUSTOM_ROUTE_AGRS_METADATA}`, data: 'custom' },
+        { index: 3, type: `key${CUSTOM_ROUTE_ARGS_METADATA}`, data: 'custom' },
       ];
       expect(values[0]).to.deep.include(expectedValues[0]);
       expect(values[1]).to.deep.include(expectedValues[1]);
diff --git a/packages/websockets/test/context/ws-proxy.spec.ts b/packages/websockets/test/context/ws-proxy.spec.ts
index d4f2b065a..1d416c7d5 100644
--- a/packages/websockets/test/context/ws-proxy.spec.ts
+++ b/packages/websockets/test/context/ws-proxy.spec.ts
@@ -1,5 +1,5 @@
 import { expect } from 'chai';
-import { of, throwError } from 'rxjs';
+import { throwError } from 'rxjs';
 import * as sinon from 'sinon';
 import { WsProxy } from '../../context/ws-proxy';
 import { WsException } from '../../errors/ws-exception';
@@ -40,17 +40,4 @@ describe('WsProxy', () => {
       (await proxy(null, null)).subscribe(null, () => expectation.verify());
     });
   });
-
-  describe('isObservable', () => {
-    describe('when observable', () => {
-      it('should return true', () => {
-        expect(routerProxy.isObservable(of('test'))).to.be.true;
-      });
-    });
-    describe('when not observable', () => {
-      it('should return false', () => {
-        expect(routerProxy.isObservable({})).to.be.false;
-      });
-    });
-  });
 });
diff --git a/packages/websockets/test/gateway-metadata-explorer.spec.ts b/packages/websockets/test/gateway-metadata-explorer.spec.ts
index b495fea5f..cfef62f0c 100644
--- a/packages/websockets/test/gateway-metadata-explorer.spec.ts
+++ b/packages/websockets/test/gateway-metadata-explorer.spec.ts
@@ -38,16 +38,15 @@ describe('GatewayMetadataExplorer', () => {
     instance = new GatewayMetadataExplorer(scanner);
   });
   describe('explore', () => {
-    let scanFromPrototype: sinon.SinonSpy;
+    let getAllMethodNames: sinon.SinonSpy;
     beforeEach(() => {
-      scanFromPrototype = sinon.spy(scanner, 'scanFromPrototype');
+      getAllMethodNames = sinon.spy(scanner, 'getAllMethodNames');
     });
     it(`should call "scanFromPrototype" with expected arguments`, () => {
       const obj = new Test();
       instance.explore(obj as any);
 
-      const [argObj, argProto] = scanFromPrototype.getCall(0).args;
-      expect(argObj).to.be.eql(obj);
+      const [argProto] = getAllMethodNames.getCall(0).args;
       expect(argProto).to.be.eql(Object.getPrototypeOf(obj));
     });
   });
diff --git a/packages/websockets/test/tsconfig.json b/packages/websockets/test/tsconfig.json
new file mode 100644
index 000000000..50d59661d
--- /dev/null
+++ b/packages/websockets/test/tsconfig.json
@@ -0,0 +1,3 @@
+{
+  "extends": "../../../tsconfig.spec.json"
+}
diff --git a/packages/websockets/test/web-sockets-controller.spec.ts b/packages/websockets/test/web-sockets-controller.spec.ts
index 68503abb0..3edb1c27e 100644
--- a/packages/websockets/test/web-sockets-controller.spec.ts
+++ b/packages/websockets/test/web-sockets-controller.spec.ts
@@ -1,14 +1,19 @@
+import { NestContainer } from '@nestjs/core';
 import { ApplicationConfig } from '@nestjs/core/application-config';
 import { expect } from 'chai';
 import { fromEvent, lastValueFrom, Observable, of } from 'rxjs';
 import * as sinon from 'sinon';
+import { GraphInspector } from '../../core/inspector/graph-inspector';
 import { MetadataScanner } from '../../core/metadata-scanner';
 import { AbstractWsAdapter } from '../adapters/ws-adapter';
 import { PORT_METADATA } from '../constants';
 import { WsContextCreator } from '../context/ws-context-creator';
 import { WebSocketGateway } from '../decorators/socket-gateway.decorator';
 import { InvalidSocketPortException } from '../errors/invalid-socket-port.exception';
-import { GatewayMetadataExplorer } from '../gateway-metadata-explorer';
+import {
+  GatewayMetadataExplorer,
+  MessageMappingProperties,
+} from '../gateway-metadata-explorer';
 import { SocketServerProvider } from '../socket-server-provider';
 import { WebSocketsController } from '../web-sockets-controller';
 
@@ -29,8 +34,10 @@ class NoopAdapter extends AbstractWsAdapter {
 describe('WebSocketsController', () => {
   let instance: WebSocketsController;
   let provider: SocketServerProvider,
+    graphInspector: GraphInspector,
     config: ApplicationConfig,
     mockProvider: sinon.SinonMock;
+
   const messageHandlerCallback = () => Promise.resolve();
   const port = 90,
     namespace = '/';
@@ -40,6 +47,7 @@ describe('WebSocketsController', () => {
   beforeEach(() => {
     config = new ApplicationConfig(new NoopAdapter());
     provider = new SocketServerProvider(null, config);
+    graphInspector = new GraphInspector(new NestContainer());
     mockProvider = sinon.mock(provider);
 
     const contextCreator = sinon.createStubInstance(WsContextCreator);
@@ -48,6 +56,7 @@ describe('WebSocketsController', () => {
       provider,
       config,
       contextCreator as any,
+      graphInspector,
     );
   });
   describe('connectGatewayToServer', () => {
@@ -69,20 +78,37 @@ describe('WebSocketsController', () => {
         instance.connectGatewayToServer(
           new InvalidGateway(),
           InvalidGateway,
-          '',
+          'moduleKey',
+          'instanceWrapperId',
         ),
       ).throws(InvalidSocketPortException);
     });
     it('should call "subscribeToServerEvents" with default values when metadata is empty', () => {
       const gateway = new DefaultGateway();
-      instance.connectGatewayToServer(gateway, DefaultGateway, '');
-      expect(subscribeToServerEvents.calledWith(gateway, {}, 0, '')).to.be.true;
+      instance.connectGatewayToServer(
+        gateway,
+        DefaultGateway,
+        'moduleKey',
+        'instanceWrapperId',
+      );
+      expect(subscribeToServerEvents.calledWith(gateway, {}, 0, 'moduleKey')).to
+        .be.true;
     });
     it('should call "subscribeToServerEvents" when metadata is valid', () => {
       const gateway = new Test();
-      instance.connectGatewayToServer(gateway, Test, '');
+      instance.connectGatewayToServer(
+        gateway,
+        Test,
+        'moduleKey',
+        'instanceWrapperId',
+      );
       expect(
-        subscribeToServerEvents.calledWith(gateway, { namespace }, port, ''),
+        subscribeToServerEvents.calledWith(
+          gateway,
+          { namespace },
+          port,
+          'moduleKey',
+        ),
       ).to.be.true;
     });
   });
@@ -116,16 +142,28 @@ describe('WebSocketsController', () => {
 
       assignServerToProperties = sinon.spy();
       subscribeEvents = sinon.spy();
-      (instance as any).assignServerToProperties = assignServerToProperties;
-      (instance as any).subscribeEvents = subscribeEvents;
+      instance['assignServerToProperties'] = assignServerToProperties;
+      instance['subscribeEvents'] = subscribeEvents;
     });
     it('should call "assignServerToProperties" with expected arguments', () => {
-      instance.subscribeToServerEvents(gateway, { namespace }, port, '');
+      instance.subscribeToServerEvents(
+        gateway,
+        { namespace },
+        port,
+        'moduleKey',
+        'instanceWrapperId',
+      );
       expect(assignServerToProperties.calledWith(gateway, server.server)).to.be
         .true;
     });
     it('should call "subscribeEvents" with expected arguments', () => {
-      instance.subscribeToServerEvents(gateway, { namespace }, port, '');
+      instance.subscribeToServerEvents(
+        gateway,
+        { namespace },
+        port,
+        'moduleKey',
+        'instanceWrapperId',
+      );
       expect(subscribeEvents.firstCall.args[0]).to.be.equal(gateway);
       expect(subscribeEvents.firstCall.args[2]).to.be.equal(server);
       expect(subscribeEvents.firstCall.args[1]).to.be.eql([
@@ -137,11 +175,69 @@ describe('WebSocketsController', () => {
       ]);
     });
   });
+  describe('inspectEntrypointDefinitions', () => {
+    it('should inspect & insert corresponding entrypoint definitions', () => {
+      class GatewayHostCls {}
+
+      const port = 80;
+      const instanceWrapperId = '1234';
+      const messageHandlers: MessageMappingProperties[] = [
+        {
+          methodName: 'findOne',
+          message: 'find',
+          callback: null,
+        },
+        {
+          methodName: 'create',
+          message: 'insert',
+          callback: null,
+        },
+      ];
+      const insertEntrypointDefinitionSpy = sinon.spy(
+        graphInspector,
+        'insertEntrypointDefinition',
+      );
+      instance.inspectEntrypointDefinitions(
+        new GatewayHostCls(),
+        port,
+        messageHandlers,
+        instanceWrapperId,
+      );
+
+      expect(insertEntrypointDefinitionSpy.calledTwice).to.be.true;
+      expect(
+        insertEntrypointDefinitionSpy.calledWith({
+          type: 'websocket',
+          methodName: messageHandlers[0].methodName,
+          className: GatewayHostCls.name,
+          classNodeId: instanceWrapperId,
+          metadata: {
+            port,
+            key: messageHandlers[0].message,
+            message: messageHandlers[0].message,
+          } as any,
+        }),
+      ).to.be.true;
+      expect(
+        insertEntrypointDefinitionSpy.calledWith({
+          type: 'websocket',
+          methodName: messageHandlers[1].methodName,
+          className: GatewayHostCls.name,
+          classNodeId: instanceWrapperId,
+          metadata: {
+            port,
+            key: messageHandlers[1].message,
+            message: messageHandlers[1].message,
+          } as any,
+        }),
+      ).to.be.true;
+    });
+  });
   describe('subscribeEvents', () => {
     const gateway = new Test();
 
-    let handlers;
-    let server,
+    let handlers: any;
+    let server: any,
       subscribeConnectionEvent: sinon.SinonSpy,
       subscribeDisconnectEvent: sinon.SinonSpy,
       nextSpy: sinon.SinonSpy,
@@ -345,7 +441,7 @@ describe('WebSocketsController', () => {
                 Promise.resolve(Promise.resolve(value)),
               ),
             ),
-          ).to.be.eq(100);
+          ).to.be.eq(value);
         });
       });
 
@@ -356,18 +452,29 @@ describe('WebSocketsController', () => {
             await lastValueFrom(
               await instance.pickResult(Promise.resolve(of(value))),
             ),
-          ).to.be.eq(100);
+          ).to.be.eq(value);
+        });
+      });
+
+      describe('is an object that has the method `subscribe`', () => {
+        it('should return Promise<Observable>', async () => {
+          const value = { subscribe() {} };
+          expect(
+            await lastValueFrom(
+              await instance.pickResult(Promise.resolve(value)),
+            ),
+          ).to.equal(value);
         });
       });
 
-      describe('is a value', () => {
+      describe('is an ordinary value', () => {
         it('should return Promise<Observable>', async () => {
           const value = 100;
           expect(
             await lastValueFrom(
               await instance.pickResult(Promise.resolve(value)),
             ),
-          ).to.be.eq(100);
+          ).to.be.eq(value);
         });
       });
     });
diff --git a/packages/websockets/tsconfig.build.json b/packages/websockets/tsconfig.build.json
new file mode 100644
index 000000000..732ca00cb
--- /dev/null
+++ b/packages/websockets/tsconfig.build.json
@@ -0,0 +1,22 @@
+{
+  "extends": "../tsconfig.build.json",
+  "compilerOptions": {
+    "outDir": ".",
+    "rootDir": ".",
+    "paths": {
+      "@nestjs/common": ["../common"],
+      "@nestjs/common/*": ["../common/*"],
+      "@nestjs/core": ["../core"],
+      "@nestjs/core/*": ["../core/*"]
+    }
+  },
+  "exclude": ["node_modules", "dist", "test/**/*", "*.spec.ts"],
+  "references": [
+    {
+      "path": "../common/tsconfig.build.json"
+    },
+    {
+      "path": "../core/tsconfig.build.json"
+    }
+  ]
+}
diff --git a/packages/websockets/tsconfig.json b/packages/websockets/tsconfig.json
index b238080a4..2ae9e3c90 100644
--- a/packages/websockets/tsconfig.json
+++ b/packages/websockets/tsconfig.json
@@ -1,7 +1,13 @@
 {
-  "extends": "./../tsconfig.base.json",
+  "extends": "../tsconfig.build.json",
   "compilerOptions": {
-    "baseUrl": "./"
+    "types": ["node"]
   },
-  "include": ["*.ts", "**/*.ts"]
+  "files": [],
+  "include": [],
+  "references": [
+    {
+      "path": "./tsconfig.build.json"
+    }
+  ]
 }
diff --git a/packages/websockets/web-sockets-controller.ts b/packages/websockets/web-sockets-controller.ts
index 75e790c82..bb29f373f 100644
--- a/packages/websockets/web-sockets-controller.ts
+++ b/packages/websockets/web-sockets-controller.ts
@@ -1,9 +1,16 @@
+import { NestApplicationContextOptions } from '@nestjs/common/interfaces/nest-application-context-options.interface';
 import { Type } from '@nestjs/common/interfaces/type.interface';
 import { Logger } from '@nestjs/common/services/logger.service';
-import { isFunction } from '@nestjs/common/utils/shared.utils';
 import { ApplicationConfig } from '@nestjs/core/application-config';
+import { GraphInspector } from '@nestjs/core/inspector/graph-inspector';
 import { MetadataScanner } from '@nestjs/core/metadata-scanner';
-import { from as fromPromise, Observable, of, Subject } from 'rxjs';
+import {
+  from as fromPromise,
+  isObservable,
+  Observable,
+  of,
+  Subject,
+} from 'rxjs';
 import { distinctUntilChanged, mergeAll } from 'rxjs/operators';
 import { GATEWAY_OPTIONS, PORT_METADATA } from './constants';
 import { WsContextCreator } from './context/ws-context-creator';
@@ -15,6 +22,7 @@ import {
 import { GatewayMetadata } from './interfaces/gateway-metadata.interface';
 import { NestGateway } from './interfaces/nest-gateway.interface';
 import { ServerAndEventStreamsHost } from './interfaces/server-and-event-streams-host.interface';
+import { WebsocketEntrypointMetadata } from './interfaces/websockets-entrypoint-metadata.interface';
 import { SocketServerProvider } from './socket-server-provider';
 import { compareElementAt } from './utils/compare-element.util';
 
@@ -30,12 +38,15 @@ export class WebSocketsController {
     private readonly socketServerProvider: SocketServerProvider,
     private readonly config: ApplicationConfig,
     private readonly contextCreator: WsContextCreator,
+    private readonly graphInspector: GraphInspector,
+    private readonly appOptions: NestApplicationContextOptions = {},
   ) {}
 
   public connectGatewayToServer(
     instance: NestGateway,
     metatype: Type<unknown> | Function,
     moduleKey: string,
+    instanceWrapperId: string,
   ) {
     const options = Reflect.getMetadata(GATEWAY_OPTIONS, metatype) || {};
     const port = Reflect.getMetadata(PORT_METADATA, metatype) || 0;
@@ -43,7 +54,13 @@ export class WebSocketsController {
     if (!Number.isInteger(port)) {
       throw new InvalidSocketPortException(port, metatype);
     }
-    this.subscribeToServerEvents(instance, options, port, moduleKey);
+    this.subscribeToServerEvents(
+      instance,
+      options,
+      port,
+      moduleKey,
+      instanceWrapperId,
+    );
   }
 
   public subscribeToServerEvents<T extends GatewayMetadata>(
@@ -51,6 +68,7 @@ export class WebSocketsController {
     options: T,
     port: number,
     moduleKey: string,
+    instanceWrapperId: string,
   ) {
     const nativeMessageHandlers = this.metadataExplorer.explore(instance);
     const messageHandlers = nativeMessageHandlers.map(
@@ -65,6 +83,17 @@ export class WebSocketsController {
         ),
       }),
     );
+
+    this.inspectEntrypointDefinitions(
+      instance,
+      port,
+      messageHandlers,
+      instanceWrapperId,
+    );
+
+    if (this.appOptions.preview) {
+      return;
+    }
     const observableServer = this.socketServerProvider.scanForSocketServer<T>(
       options,
       port,
@@ -158,7 +187,7 @@ export class WebSocketsController {
     deferredResult: Promise<any>,
   ): Promise<Observable<any>> {
     const result = await deferredResult;
-    if (result && isFunction(result.subscribe)) {
+    if (isObservable(result)) {
       return result;
     }
     if (result instanceof Promise) {
@@ -167,6 +196,30 @@ export class WebSocketsController {
     return of(result);
   }
 
+  public inspectEntrypointDefinitions(
+    instance: NestGateway,
+    port: number,
+    messageHandlers: MessageMappingProperties[],
+    instanceWrapperId: string,
+  ) {
+    messageHandlers.forEach(handler => {
+      this.graphInspector.insertEntrypointDefinition<WebsocketEntrypointMetadata>(
+        {
+          type: 'websocket',
+          methodName: handler.methodName,
+          className: instance.constructor?.name,
+          classNodeId: instanceWrapperId,
+          metadata: {
+            port,
+            key: handler.message,
+            message: handler.message,
+          },
+        },
+        instanceWrapperId,
+      );
+    });
+  }
+
   private assignServerToProperties<T = any>(
     instance: NestGateway,
     server: object,
diff --git a/readme_jp.md b/readme_jp.md
index 53991a69b..ae40a6537 100644
--- a/readme_jp.md
+++ b/readme_jp.md
@@ -37,20 +37,20 @@
 
 <p>Nest„ÅØ„ÄÅÂÆüÁî®ÁöÑ„Å™„Ç¢„Éº„Ç≠„ÉÜ„ÇØ„ÉÅ„É£„Çí„Åô„Åê„Å´ÊßãÁØâ„Åß„Åç„Çã„Åì„Å®„ÇíÁõÆÁöÑ„Å®„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇÂÖ∑‰ΩìÁöÑ„Å´„ÅØ„ÄÅ„ÉÜ„Çπ„Éà„Éï„É¨„É≥„Éâ„É™„Éº„Åß„ÄÅ„Çπ„Ç±„Éº„É©„Éñ„É´„Åß„ÄÅÁñéÁµêÂêà„Åß„ÄÅÈÅãÁî®„Å´„ÇÑ„Åï„Åó„ÅÑ„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÇíÊßãÁØâ„Åß„Åç„Çã„Çà„ÅÜ„Å´„Å™„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Åæ„Åü„ÄÅ„Ç¢„Éº„Ç≠„ÉÜ„ÇØ„ÉÅ„É£„ÅØAngular„Å´„Ç§„É≥„Çπ„Éë„Ç§„Ç¢„Åï„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ</p>
 
-## ÂÖ•ÈñÄ
+## „ÅØ„Åò„ÇÅ„Å´
 
 * To check out the [guide](https://docs.nestjs.com), visit [docs.nestjs.com](https://docs.nestjs.com). :books:
 * Ë¶ÅÊü•Áúã‰∏≠Êñá [ÊåáÂçó](readme_zh.md), ËØ∑ËÆøÈóÆ [docs.nestjs.cn](https://docs.nestjs.cn). :books:
-* [Í∞ÄÏù¥Îìú](readme_kr.md)Î•º ÌôïÏù∏ÌïòÎ†§Î©¥, [docs.nestjs.com](https://docs.nestjs.com)Î•º Î∞©Î¨∏ÌïòÏÑ∏Ïöî.:books: 
-* „ÉÅ„Çß„ÉÉ„ÇØ„Åô„Çã„Å´„ÅØ [„Ç¨„Ç§„Éâ](readme_jp.md), Ë©≥„Åó„Åè„ÅØ [docs.nestjs.com](https://docs.nestjs.com).:books:
+* [Í∞ÄÏù¥Îìú](readme_kr.md) Î¨∏ÏÑúÎäî [docs.nestjs.com](https://docs.nestjs.com)ÏóêÏÑú ÌôïÏù∏ÌïòÏã§ Ïàò ÏûàÏäµÎãàÎã§. :books:
+* [„Ç¨„Ç§„Éâ](readme_jp.md)„ÅØ [docs.nestjs.com](https://docs.nestjs.com)„Åß„ÅîÁ¢∫Ë™ç„Åè„Å†„Åï„ÅÑ„ÄÇ :books:
 
 ## Ë≥™Âïè
 
 Ë≥™Âïè„ÇÑ„Çµ„Éù„Éº„Éà„Å´„Å§„ÅÑ„Å¶„ÅØ„ÄÅÂÖ¨Âºè„ÅÆ[Discord„ÉÅ„É£„É≥„Éç„É´](https://discord.gg/G7Qnnhy)„Çí‰ΩøÁî®„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ„Åæ„Åü„ÄÅ„Åì„ÅÆ„É™„Éù„Ç∏„Éà„É™„ÅÆissue„É™„Çπ„Éà„ÅØ„ÄÅ„Éê„Ç∞„É¨„Éù„Éº„Éà„Å®Ê©üËÉΩ„É™„ÇØ„Ç®„Çπ„Éà **Â∞ÇÁî®** „Åß„Åô„ÄÇ
 
-## ÂïèÈ°å(Issues)
+## „Ç§„Ç∑„É•„Éº(Issues)
 
-issue„ÇíÈñã„ÅèÂâç„Å´„ÄÅÂøÖ„Åö[Issue Reporting Checklist](https://github.com/nestjs/nest/blob/master/CONTRIBUTING.md#-submitting-an-issue)„Çí„ÅäË™≠„Åø„Åè„Å†„Åï„ÅÑ„ÄÇ„Ç¨„Ç§„Éâ„É©„Ç§„É≥„Å´Ê∫ñÊã†„Åó„Å¶„ÅÑ„Å™„ÅÑissue„ÅØ„ÄÅ„ÇØ„É≠„Éº„Ç∫„Åï„Çå„ÇãÂ†¥Âêà„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ
+issue„Çí‰ΩúÊàê„Åô„ÇãÂâç„Å´„ÄÅÂøÖ„Åö[Issue Reporting Checklist](https://github.com/nestjs/nest/blob/master/CONTRIBUTING.md#-submitting-an-issue)„Çí„ÅäË™≠„Åø„Åè„Å†„Åï„ÅÑ„ÄÇ„Ç¨„Ç§„Éâ„É©„Ç§„É≥„Å´Ê∫ñÊã†„Åó„Å¶„ÅÑ„Å™„ÅÑissue„ÅØ„ÄÅ„ÇØ„É≠„Éº„Ç∫„Åï„Çå„ÇãÂ†¥Âêà„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ
 
 ## „Ç≥„É≥„Çµ„É´„ÉÜ„Ç£„É≥„Ç∞
 
@@ -60,7 +60,7 @@ issue„ÇíÈñã„ÅèÂâç„Å´„ÄÅÂøÖ„Åö[Issue Reporting Checklist](https://github.com/nest
 
 Nest„ÅØ„ÄÅMIT„É©„Ç§„Çª„É≥„Çπ„ÅÆ„Ç™„Éº„Éó„É≥„ÇΩ„Éº„Çπ„Éó„É≠„Ç∏„Çß„ÇØ„Éà„Åß„Åô„ÄÇ„Çπ„Éù„É≥„Çµ„Éº„Å®ÊîØÊè¥ËÄÖ„Å´„Çà„ÇãÁ¥†Êô¥„Çâ„Åó„ÅÑ„Çµ„Éù„Éº„Éà„Å´„Çà„Å£„Å¶„ÄÅ„Åù„ÅÆÁô∫Â±ï„ÇíÊîØ„Åà„Çâ„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇÂèÇÂä†„Åó„Åü„ÅÑÂ†¥Âêà„ÅØ[„Åì„Å°„Çâ](https://docs.nestjs.com/support)„Çí„ÅîË¶ß„Åè„Å†„Åï„ÅÑ„ÄÇ
 
-## ÈÄ£Áµ°„Åô„Çã
+## ÈÄ£Áµ°ÂÖà
 
 * Author - [Kamil My≈õliwiec](https://twitter.com/kammysliwiec)
 * Website - [https://nestjs.com](https://nestjs.com/)
diff --git a/readme_kr.md b/readme_kr.md
index f00e9429e..613880df6 100644
--- a/readme_kr.md
+++ b/readme_kr.md
@@ -5,7 +5,7 @@
 [circleci-image]: https://img.shields.io/circleci/build/github/nestjs/nest/master?token=abc123def456
 [circleci-url]: https://circleci.com/gh/nestjs/nest
 
-  <p align="center">Ìö®Ïú®Ï†ÅÏù¥Í≥† ÌôïÏû• Í∞ÄÎä•Ìïú ÏÑúÎ≤Ñ-ÏÇ¨Ïù¥Îìú Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖòÏùÑ ÏúÑÌïú ÌòÅÏã†Ï†ÅÏù∏ <a href="http://nodejs.org" target="_blank">Node.js</a> ÌîÑÎ†àÏûÑÏõåÌÅ¨.</p>
+  <p align="center">Ìö®Ïú®Ï†ÅÏù¥Í≥† ÌôïÏû• Í∞ÄÎä•Ìïú ÏÑúÎ≤Ñ ÏÇ¨Ïù¥Îìú Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖòÏùÑ ÏúÑÌïú ÌòÅÏã†Ï†Å <a href="http://nodejs.org" target="_blank">Node.js</a> ÌîÑÎ†àÏûÑÏõåÌÅ¨.</p>
     <p align="center">
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/v/@nestjs/core.svg" alt="NPM Version" /></a>
 <a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
@@ -24,43 +24,40 @@
 
 ## Í∞úÏöî
 
-NestÎäî Ìö®Í≥ºÏ†ÅÏù¥Í≥†, ÌôïÏû• Í∞ÄÎä•Ìïú <a href="http://nodejs.org" target="_blank">Node.js</a> ÏÑúÎ≤Ñ ÏÇ¨Ïù¥Îìú Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖòÏùÑ ÎπåÎìúÌïòÍ∏∞ ÏúÑÌïú ÌîÑÎ†àÏûÑÏõåÌÅ¨ÏûÖÎãàÎã§. NestÎäî Î™®Îçò JavascriptÎ•º ÏÇ¨Ïö©ÌïòÍ≥†, <a href="http://www.typescriptlang.org" target="_blank">TypeScript</a>Î°ú ÎπåÎìúÎêòÏóàÏúºÎ©∞(ÏàúÏàò ÏûêÎ∞îÏä§ÌÅ¨Î¶ΩÌä∏ÏôÄ Ìò∏ÌôòÏÑ±ÏùÑ Ïú†ÏßÄÌï©ÎãàÎã§) OOP(Í∞ùÏ≤¥ ÏßÄÌñ• ÌîÑÎ°úÍ∑∏ÎûòÎ∞ç), FP(Ìï®ÏàòÌòï ÌîÑÎ°úÍ∑∏ÎûòÎ∞ç), FRP(Ìï®Ïàò Î∞òÏùëÌòï ÌîÑÎ°úÍ∑∏ÎûòÎ∞ç)Ïùò ÏöîÏÜåÎì§Ïù¥ Í≤∞Ìï©ÎêòÏóàÏäµÎãàÎã§.
+NestÎäî Ìö®Ïú®Ï†ÅÏù¥Í≥† ÌôïÏû• Í∞ÄÎä•Ìïú <a href="http://nodejs.org" target="_blank">Node.js</a> ÏÑúÎ≤Ñ ÏÇ¨Ïù¥Îìú Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖòÏùÑ ÎπåÎìúÌïòÍ∏∞ ÏúÑÌïú ÌîÑÎ†àÏûÑÏõåÌÅ¨ÏûÖÎãàÎã§. NestÎäî Î™®Îçò JavascriptÎ•º ÏÇ¨Ïö©ÌïòÍ≥† <a href="http://www.typescriptlang.org" target="_blank">TypeScript</a>Î°ú ÎπåÎìúÎêòÏóàÏúºÎ©∞(ÏàúÏàò ÏûêÎ∞îÏä§ÌÅ¨Î¶ΩÌä∏ÏôÄ Ìò∏Ìôò), OOP(Í∞ùÏ≤¥ ÏßÄÌñ• ÌîÑÎ°úÍ∑∏ÎûòÎ∞ç), FP(Ìï®ÏàòÌòï ÌîÑÎ°úÍ∑∏ÎûòÎ∞ç), FRP(Ìï®Ïàò Î∞òÏùëÌòï ÌîÑÎ°úÍ∑∏ÎûòÎ∞ç)Ïùò ÏöîÏÜåÎì§Ïù¥ Í≤∞Ìï©ÎêòÏñ¥ ÏûàÏäµÎãàÎã§.
 
-<p>ÎÇ¥Î∂ÄÏ†ÅÏúºÎ°ú NestÎäî <a href="https://expressjs.com/" target="_blank">Express</a>Î•º ÏÇ¨Ïö©ÌïòÏßÄÎßå, ÎßéÏùÄ ÏÑúÎìúÌååÌã∞ ÌîåÎü¨Í∑∏Ïù∏Îì§ÏùÑ ÏâΩÍ≤å ÏÇ¨Ïö©ÌïòÍ≤å ÌïòÎäî Îã§ÏñëÌïú ÎùºÏù¥Î∏åÎü¨Î¶¨Îì§Í≥ºÏùò Ìò∏ÌôòÏÑ±ÏùÑ Ï†úÍ≥µÌï©ÎãàÎã§. ÏòàÏãú-<a href="https://github.com/fastify/fastify" target="_blank">Fastify</a></p>
+<p>NestÎäî ÎÇ¥Î∂ÄÏ†ÅÏúºÎ°ú <a href="https://expressjs.com/" target="_blank">Express</a>Î•º ÏÇ¨Ïö©ÌïòÏßÄÎßå, <a href="https://github.com/fastify/fastify" target="_blank">Fastify</a>ÏôÄ Í∞ôÏùÄ ÌÉÄ ÎùºÏù¥Î∏åÎü¨Î¶¨Îì§Í≥ºÏùò Ìò∏ÌôòÏÑ±ÏùÑ Í¥ëÎ≤îÏúÑÌïòÍ≤å Ï†úÍ≥µÌïòÎ©∞ ÎßéÏùÄ ÏÑúÎìúÌååÌã∞ ÌîåÎü¨Í∑∏Ïù∏Îì§ÏùÑ ÏÜêÏâΩÍ≤å ÏÇ¨Ïö©Ìï† Ïàò ÏûàÍ≤å Ìï¥Ï§çÎãàÎã§.</p>
 
 ## Ï≤†Ìïô
 
-<p>ÏµúÍ∑º Î™á ÎÖÑÍ∞Ñ, Node.js ÎçïÎ∂ÑÏóê JavascriptÎäî ÏõπÏùò ÌîÑÎ°†Ìä∏ÏôÄ Î∞±ÏóîÎìúÏóêÏÑú ÏÇ¨Ïö©ÌïòÎäî "Í≥µÌÜµÏñ¥"Í∞Ä ÎêòÏóàÍ≥†, Ïù¥Í≤ÉÏùÄ Í∞úÎ∞úÏûêÏùò ÏÉùÏÇ∞ÏÑ±ÏùÑ Ìñ•ÏÉÅÌï¥Ï£ºÍ≥†, Îπ†Î•¥Í≥†, ÌÖåÏä§Ìä∏ Í∞ÄÎä•ÌïòÍ≥† ÌôïÏû• Í∞ÄÎä•Ìïú ÌîÑÎ°†Ìä∏ÏóîÎìú Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖòÏùò Í∞úÎ∞úÏùÑ Í∞ÄÎä•ÌïòÍ≤å Ìï¥Ï£ºÎäî <a href="https://angular.io/" target="_blank">Angular</a>ÏôÄ <a href="https://github.com/facebook/react" target="_blank">React</a>, <a href="https://github.com/vuejs/vue" target="_blank">Vue</a> Îì±Ïùò Î©ãÏßÑ ÌîÑÎ°úÏ†ùÌä∏Îì§Ïù¥ Îì±Ïû•ÌñàÏßÄÎßå. Ïù¥ÏôÄ Î∞òÌï¥ ÏÑúÎ≤Ñ ÏÇ¨Ïù¥Îìú Î∂ÑÏïºÏóêÏÑúÎäî ÏÇ¨Ïö©ÏûêÎ•º ÎèÑÏôÄÏ£ºÎäî ÌõåÎ•≠Ìïú ÎùºÏù¥Î∏åÎü¨Î¶¨Í∞Ä Îã§ÏñëÌïòÍ≤å Ï°¥Ïû¨ÌïòÏßÄÎßå, Ïù¥ Ï§ë Ïñ¥Îäê Í≤ÉÎèÑ Í∞ÄÏû• Ï§ëÏöîÌïú Î¨∏Ï†úÎ•º Ìö®Í≥ºÏ†ÅÏúºÎ°ú Ìï¥Í≤∞ÌïòÏßÄ Î™ªÌñàÏäµÎãàÎã§. - Íµ¨Ï°∞(architecture)Ïùò Î¨∏Ï†ú.</p>
-<p>NestÎäî Í∞ÑÌé∏ÌïòÍ≤å Í≥†ÏàòÏ§ÄÏúºÎ°ú ÌÖåÏä§Ìä∏ Í∞ÄÎä•ÌïòÍ≥†, ÌôïÏû• Í∞ÄÎä•ÌïòÎ©¥ÏÑú, ÎÇ¥Î∂Ä ÏùòÏ°¥ÏÑ±Ïù¥ ÎÇÆÏúºÎ©∞(loosely coupled), Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖòÏùÑ ÏâΩÍ≤å Ïú†ÏßÄÌï† Ïàò ÏûàÎäî ÌòÅÏã†Ï†ÅÏù∏ Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖò Íµ¨Ï°∞(architecture)Î•º Ï†úÍ≥µÌïòÎäî Í≤ÉÏùÑ Î™©ÌëúÎ°ú Ìï©ÎãàÎã§. Nest Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖòÏùò Íµ¨Ï°∞(architecture)Îäî AngularÎ°úÎ∂ÄÌÑ∞ ÎßéÏùÄ ÏòÅÍ∞êÏùÑ Î∞õÏïòÏäµÎãàÎã§. </p>
+<p>ÏµúÍ∑º Î™á ÎÖÑÍ∞Ñ JavascriptÎäî Node.jsÏùò Î∞úÏ†ÑÏóê Îî∞Îùº ÏõπÏùò ÌîÑÎ°†Ìä∏ÏóîÎìúÏôÄ Î∞±ÏóîÎìúÏóê ÏûàÏñ¥ÏÑú "Í≥µÏö©Ïñ¥"Í∞Ä ÎêòÏóàÏäµÎãàÎã§. Í∑∏Î¶¨Í≥† ÌîÑÎ°†Ìä∏ÏóîÎìúÏóêÏÑúÎäî <a href="https://angular.io/" target="_blank">Angular</a>ÏôÄ <a href="https://github.com/facebook/react" target="_blank">React</a>, <a href="https://github.com/vuejs/vue" target="_blank">Vue</a>ÏôÄ Í∞ôÏù¥ Î©ãÏßÑ ÌîÑÎ°úÏ†ùÌä∏Îì§Ïù¥ Îì±Ïû•ÌïòÏó¨ Í∞úÎ∞úÏûêÏùò ÏÉùÏÇ∞ÏÑ±ÏùÑ Ìñ•ÏÉÅÏãúÏº∞ÏúºÎ©∞, Îπ†Î•¥Í≥† ÌÖåÏä§Ìä∏ÏôÄ ÌôïÏû•Ïù¥ Í∞ÄÎä•Ìïú ÌîÑÎ°†Ìä∏ÏóîÎìú Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖòÏùÑ ÎßåÎì§ Ïàò ÏûàÍ≤å Ìï¥Ï£ºÏóàÏäµÎãàÎã§. ÌïòÏßÄÎßå ÏÑúÎ≤Ñ ÏÇ¨Ïù¥ÎìúÏóêÏÑúÎäî Node.jsÎ•º ÏúÑÌïú Ïö∞ÏàòÌïú ÎùºÏù¥Î∏åÎü¨Î¶¨ÏôÄ Ìà¥Ïù¥ ÎßéÏùÄ Í∞ÄÏö¥Îç∞, Ï£ºÏöî Î¨∏Ï†úÎ•º Ìö®Í≥ºÏ†ÅÏúºÎ°ú Ìï¥Í≤∞ÌïòÎäî Í≤ÉÏùÄ ÏóÜÏóàÏäµÎãàÎã§. Í∑∏ Ï£ºÏöî Î¨∏Ï†úÎûÄ Î∞îÎ°ú ÏïÑÌÇ§ÌÖçÏ≤ò(architecture)ÏûÖÎãàÎã§.</p>
+<p>NestÎäî ÌÖåÏä§Ìä∏ ÏπúÌôîÏ†ÅÏù¥Î©¥ÏÑú ÌôïÏû•Ïù¥ Í∞ÄÎä•ÌïòÍ≥† Í≤∞Ìï©Ïù¥ ÎäêÏä®ÌïòÎ©∞, Ïú†ÏßÄ Í¥ÄÎ¶¨Í∞Ä Ïö©Ïù¥Ìïú Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖòÏùÑ ÏÜêÏâΩÍ≤å ÎßåÎì§ Ïàò ÏûàÎäî Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖò ÏïÑÌÇ§ÌÖçÏ≤ò Ï†úÍ≥µÏùÑ Î™©ÌëúÎ°ú Ìï©ÎãàÎã§. Ïù¥ ÏïÑÌÇ§ÌÖçÏ≤òÎäî AngularÏóêÏÑú ÎßéÏùÄ ÏòÅÍ∞êÏùÑ Î∞õÏïòÏäµÎãàÎã§.</p>
 
-## ÏãúÏûëÌïòÎ†§Î©¥
+## ÏãúÏûëÌïòÍ∏∞
 
 * To check out the [guide](https://docs.nestjs.com), visit [docs.nestjs.com](https://docs.nestjs.com). :books:
 * Ë¶ÅÊü•Áúã‰∏≠Êñá [ÊåáÂçó](readme_zh.md), ËØ∑ËÆøÈóÆ [docs.nestjs.cn](https://docs.nestjs.cn). :books:
-* [Í∞ÄÏù¥Îìú](readme_kr.md)Î•º ÌôïÏù∏ÌïòÎ†§Î©¥, [docs.nestjs.com](https://docs.nestjs.com)Î•º Î∞©Î¨∏ÌïòÏÑ∏Ïöî.:books: 
-* „ÉÅ„Çß„ÉÉ„ÇØ„Åô„Çã„Å´„ÅØ [„Ç¨„Ç§„Éâ](readme_jp.md), Ë©≥„Åó„Åè„ÅØ [docs.nestjs.com](https://docs.nestjs.com).:books:
+* [Í∞ÄÏù¥Îìú](readme_kr.md) Î¨∏ÏÑúÎäî [docs.nestjs.com](https://docs.nestjs.com)ÏóêÏÑú ÌôïÏù∏ÌïòÏã§ Ïàò ÏûàÏäµÎãàÎã§. :books:
+* [„Ç¨„Ç§„Éâ](readme_jp.md)„ÅØ [docs.nestjs.com](https://docs.nestjs.com)„Åß„ÅîÁ¢∫Ë™ç„Åè„Å†„Åï„ÅÑ„ÄÇ :books:
 
 ## ÏßàÎ¨∏
 
-ÏßàÎ¨∏ ÏÇ¨Ìï≠Ïù¥ ÏûàÍ±∞ÎÇò ÏßÄÏõêÏùÑ Î∞õÏúºÎ†§Î©¥ Í≥µÏãù [ÎîîÏä§ÏΩîÎìú Ï±ÑÎÑê](https://discord.gg/G7Qnnhy)ÏùÑ Ïù¥Ïö©Ìï¥Ï£ºÏÑ∏Ïöî.
-Ïù¥ Ï†ÄÏû•ÏÜå(repo)Ïùò Ïù¥Ïäà Î™©Î°ùÏùÄ **Ïò§ÏßÅ** Î≤ÑÍ∑∏ Î¶¨Ìè¨Ìä∏ÏôÄ Í∏∞Îä• ÏöîÏ≤≠Îßå Í∞ÄÎä•Ìï©ÎãàÎã§. 
+ÏßàÎ¨∏Ïù¥ ÏûàÍ±∞ÎÇò ÏßÄÏõêÏùÑ Î∞õÍ≥† Ïã∂ÏúºÏã§ Í≤ΩÏö∞ Í≥µÏãù [ÎîîÏä§ÏΩîÎìú Ï±ÑÎÑê](https://discord.gg/G7Qnnhy)ÏùÑ Ïù¥Ïö©Ìï¥Ï£ºÏÑ∏Ïöî.
+Ïù¥ Ï†ÄÏû•ÏÜåÏùò Ïù¥Ïäà Î™©Î°ùÏùÄ Î≤ÑÍ∑∏ Î¶¨Ìè¨Ìä∏ÏôÄ Í∏∞Îä• ÏöîÏ≤≠ **Ï†ÑÏö©**ÏúºÎ°ú ÏÇ¨Ïö©ÎêòÍ≥† ÏûàÏäµÎãàÎã§.
 
+## Ïù¥Ïäà
 
-## Ïù¥Ïäà(Issues)
-
-
- IssueÎ•º Ï†úÎ≥¥ÌïòÍ∏∞ Ï†ÑÏóê [Issue Ï†úÎ≥¥ Ï†Ñ Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏](https://github.com/nestjs/nest/blob/master/CONTRIBUTING.md#-submitting-an-issue)Î•º ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî. Í∞ÄÏù¥ÎìúÎùºÏù∏Ïóê ÎßûÏßÄ ÏïäÎäî Ïù¥ÏäàÎì§ÏùÄ Ï¶âÏãú ÏÇ≠Ï†úÎê† Ïàò ÏûàÏäµÎãàÎã§.
-
+Ïù¥ÏäàÎ•º Ïò¨Î¶¨Í∏∞ Ï†ÑÏóê Î∞òÎìúÏãú [Ïù¥Ïäà Î≥¥Í≥† Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏](https://github.com/nestjs/nest/blob/master/CONTRIBUTING.md#-submitting-an-issue)Î•º ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî. Í∞ÄÏù¥ÎìúÎùºÏù∏Ïóê ÎßûÏßÄ ÏïäÎäî Ïù¥ÏäàÎäî Î∞îÎ°ú ÌÅ¥Î°úÏ¶àÎê† Ïàò ÏûàÏäµÎãàÎã§.
 
 ## ÏûêÎ¨∏
 
-Í≥µÏãùÏ†ÅÏù∏ ÏßÄÏõêÏùÑ ÌÜµÌï¥, Nest core ÌåÄÏùò Ï†ÑÎ¨∏Ï†ÅÏù∏ ÎèÑÏõÄÏùÑ Î∞õÏùÑ Ïàò ÏûàÏäµÎãàÎã§. Ïö∞Î¶¨Îäî Ï†ÑÎÖêÏ†Å Í∏∞Ïà† ÏßÄÏõê, Ïù¥Ï£º(migration) Ï†ÑÎûµ, Î™®Î≤îÏÇ¨Î°ÄÏóê ÎåÄÌïú Ï°∞Ïñ∏(Î∞è ÏÑ§Í≥Ñ Í≤∞Ï†ï), PR Î¶¨Î∑∞, ÌåÄ Ï¶ùÎåÄ(team augment)Îì±ÏùÑ Ï†úÍ≥µÌï©ÎãàÎã§. Îçî ÎßéÏùÄ ÎÇ¥Ïö©ÏùÑ Î≥¥ÏãúÎ†§Î©¥ [ÏßÄÏõê](https://enterprise.nestjs.com)ÏùÑ Î∞©Î¨∏Ìï¥Ï£ºÏÑ∏Ïöî.
+Í≥µÏãù ÏßÄÏõêÏùÑ ÌÜµÌï¥ Nest core ÌåÄÏùò Ï†ÑÎ¨∏Ï†ÅÏù∏ ÎèÑÏõÄÏùÑ Î∞õÏùÑ Ïàò ÏûàÏäµÎãàÎã§. Ïö∞Î¶¨Îäî Ï†ÑÎã¥ Í∏∞Ïà† ÏßÄÏõê, ÎßàÏù¥Í∑∏Î†àÏù¥ÏÖò Ï†ÑÎûµ, Î™®Î≤î ÏÇ¨Î°Ä Î∞è ÏÑ§Í≥ÑÏóê ÎåÄÌïú Ï°∞Ïñ∏, PR Î¶¨Î∑∞, ÌåÄ Î≥¥Í∞ïÏóê ÎåÄÌïú ÎèÑÏõÄÏùÑ Ï†úÍ≥µÌï©ÎãàÎã§. Îçî ÏûêÏÑ∏Ìïú ÎÇ¥Ïö©ÏùÄ [Í≥µÏãù ÏßÄÏõê ÌéòÏù¥ÏßÄ](https://enterprise.nestjs.com)ÏóêÏÑú ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.
 
-## ÏßÄÏõê
+## ÏÑúÌè¨Ìä∏
 
-NestÎäî MIT-licensed Ïò§Ìîà ÏÜåÏä§ ÌîÑÎ°úÏ†ùÌä∏ÏûÖÎãàÎã§. NestÎäî ÌõÑÏõêÏûêÏôÄ ÎÜÄÎùºÏö¥ Í∏∞Ïó¨ÏûêÎì§Ïùò ÏßÄÏõêÏúºÎ°ú ÏÑ±Ïû•Ìï† Ïàò ÏûàÏäµÎãàÎã§. Ï∞∏Ïó¨ÌïòÍ≥† Ïã∂ÏúºÏãúÎã§Î©¥ [Ïó¨Í∏∞](https://docs.nestjs.com/support)Î•º Î∞©Î¨∏Ìï¥Ï£ºÏÑ∏Ïöî.
+NestÎäî MIT License Ïò§Ìîà ÏÜåÏä§ ÌîÑÎ°úÏ†ùÌä∏Ïù¥Î©∞, Í∞êÏÇ¨ÌïòÍ≤åÎèÑ ÌõÑÏõêÏûêÎì§Í≥º ÍµâÏû•Ìïú Í∏∞Ïó¨ÏûêÎì§Ïùò ÏÑúÌè¨Ìä∏Î•º ÌÜµÌï¥ÏÑú ÎçîÏö± ÏÑ±Ïû•Ìï† Ïàò ÏûàÏäµÎãàÎã§. Ï∞∏Ïó¨ÌïòÍ≥† Ïã∂ÏúºÏãúÎã§Î©¥ [ÏÑúÌè¨Ìä∏ Î¨∏ÏÑú](https://docs.nestjs.com/support)Î•º ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.
 
-## Stay in touch
+## Ïó∞ÎùΩÏ≤ò
 
 * Author - [Kamil My≈õliwiec](https://twitter.com/kammysliwiec)
 * Website - [https://nestjs.com](https://nestjs.com/)
diff --git a/renovate.json b/renovate.json
index a75e902ef..26c1d72d6 100644
--- a/renovate.json
+++ b/renovate.json
@@ -1,7 +1,5 @@
 {
-  "extends": [
-    "config:base"
-  ],
+  "extends": ["config:base", ":dependencyDashboard"],
   "labels": ["dependencies"],
   "packageRules": [
     {
diff --git a/sample/01-cats-app/package-lock.json b/sample/01-cats-app/package-lock.json
index 704f22905..641754f8f 100644
Binary files a/sample/01-cats-app/package-lock.json and b/sample/01-cats-app/package-lock.json differ
diff --git a/sample/01-cats-app/package.json b/sample/01-cats-app/package.json
index 96a42c105..ee1ed2a48 100644
--- a/sample/01-cats-app/package.json
+++ b/sample/01-cats-app/package.json
@@ -19,36 +19,36 @@
     "test:e2e": "jest --config ./e2e/jest-e2e.json"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "class-transformer": "0.4.0",
-    "class-validator": "0.13.2",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
+    "class-transformer": "0.5.1",
+    "class-validator": "0.14.0",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "rimraf": "4.4.1",
+    "rxjs": "7.5.5"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
+    "@nestjs/cli": "9.0.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.11",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@types/jest": "28.1.4",
+    "@types/node": "18.0.3",
+    "@types/supertest": "2.0.12",
+    "jest": "28.1.2",
+    "prettier": "2.7.1",
+    "supertest": "6.2.4",
+    "ts-jest": "28.0.8",
+    "ts-loader": "9.3.1",
+    "ts-node": "10.8.2",
+    "tsconfig-paths": "4.0.0",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.19.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-import": "2.26.0",
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/01-cats-app/tsconfig.json b/sample/01-cats-app/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/01-cats-app/tsconfig.json
+++ b/sample/01-cats-app/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/02-gateways/e2e/events-gateway/gateway.e2e-spec.ts b/sample/02-gateways/e2e/events-gateway/gateway.e2e-spec.ts
new file mode 100644
index 000000000..26b9f42ed
--- /dev/null
+++ b/sample/02-gateways/e2e/events-gateway/gateway.e2e-spec.ts
@@ -0,0 +1,53 @@
+import { INestApplication } from '@nestjs/common';
+import { Test } from '@nestjs/testing';
+import { AppModule } from '../../src/app.module';
+import { io, Socket } from 'socket.io-client';
+
+describe('EventsGateway', () => {
+  let app: INestApplication;
+  let socket: Socket;
+
+  beforeAll(async () => {
+    const moduleRef = await Test.createTestingModule({
+      imports: [AppModule],
+    }).compile();
+
+    app = moduleRef.createNestApplication();
+    await app.listen(3000);
+  });
+
+  beforeEach(() => {
+    socket = io('http://localhost:3000');
+    socket.connect();
+  });
+
+  describe('findAll', () => {
+    it('should receive 3 numbers', done => {
+      let eventCount = 1;
+      socket.emit('events', { test: 'test' });
+      socket.on('events', data => {
+        expect(data).toBe(eventCount);
+        if (++eventCount > 3) {
+          done();
+        }
+      });
+    });
+  });
+
+  describe('identity', () => {
+    it('should return the same number has what was sent', done => {
+      socket.emit('identity', 0, response => {
+        expect(response).toBe(0);
+        done();
+      });
+    });
+  });
+
+  afterEach(() => {
+    socket.disconnect();
+  });
+
+  afterAll(async () => {
+    await app.close();
+  });
+});
diff --git a/sample/02-gateways/e2e/jest-e2e.json b/sample/02-gateways/e2e/jest-e2e.json
new file mode 100644
index 000000000..72eb5c3c0
--- /dev/null
+++ b/sample/02-gateways/e2e/jest-e2e.json
@@ -0,0 +1,14 @@
+{
+    "moduleFileExtensions": [
+        "ts",
+        "tsx",
+        "js",
+        "json"
+    ],
+    "transform": {
+        "^.+\\.tsx?$": "ts-jest"
+    },
+    "testRegex": "/e2e/.*\\.(e2e-test|e2e-spec).(ts|tsx|js)$",
+    "collectCoverageFrom" : ["src/**/*.{js,jsx,tsx,ts}", "!**/node_modules/**", "!**/vendor/**"],
+    "coverageReporters": ["json", "lcov"]
+}
\ No newline at end of file
diff --git a/sample/02-gateways/jest.json b/sample/02-gateways/jest.json
new file mode 100644
index 000000000..591de12b6
--- /dev/null
+++ b/sample/02-gateways/jest.json
@@ -0,0 +1,14 @@
+{
+  "moduleFileExtensions": [
+        "ts",
+        "tsx",
+        "js",
+        "json"
+    ],
+    "transform": {
+        "^.+\\.tsx?$": "ts-jest"
+    },
+    "testRegex": "/src/.*\\.(test|spec).(ts|tsx|js)$",
+    "collectCoverageFrom" : ["src/**/*.{js,jsx,tsx,ts}", "!**/node_modules/**", "!**/vendor/**"],
+    "coverageReporters": ["json", "lcov"]
+}
\ No newline at end of file
diff --git a/sample/02-gateways/package-lock.json b/sample/02-gateways/package-lock.json
index 34a4e35df..365bf5d6a 100644
Binary files a/sample/02-gateways/package-lock.json and b/sample/02-gateways/package-lock.json differ
diff --git a/sample/02-gateways/package.json b/sample/02-gateways/package.json
index 56c2540e5..4e8c9c557 100644
--- a/sample/02-gateways/package.json
+++ b/sample/02-gateways/package.json
@@ -16,44 +16,61 @@
     "test:watch": "jest --watch",
     "test:cov": "jest --coverage",
     "test:debug": "node --inspect-brk -r tsconfig-paths/register -r ts-node/register node_modules/.bin/jest --runInBand",
-    "test:e2e": "echo 'No e2e tests implemented yet.'"
+    "test:e2e": "jest --config ./e2e/jest-e2e.json"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "@nestjs/platform-socket.io": "8.2.3",
-    "@nestjs/websockets": "8.2.3",
-    "class-transformer": "0.4.0",
-    "class-validator": "0.13.2",
-    "redis": "3.1.2",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
+    "@nestjs/platform-socket.io": "9.3.12",
+    "@nestjs/websockets": "9.3.12",
+    "@socket.io/redis-adapter": "7.2.0",
+    "class-transformer": "0.5.1",
+    "class-validator": "0.14.0",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0",
-    "socket.io-redis": "6.1.1"
+    "rimraf": "4.4.1",
+    "rxjs": "7.5.5",
+    "socket.io": "4.6.1"
   },
   "devDependencies": {
-    "@types/socket.io": "3.0.1",
-    "@types/socket.io-redis": "1.0.27",
-    "@types/ws": "7.4.7",
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
+    "@nestjs/cli": "9.0.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.11",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@types/jest": "28.1.4",
+    "@types/node": "18.0.3",
+    "@types/supertest": "2.0.12",
+    "@types/ws": "8.5.3",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.19.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-import": "2.26.0",
+    "jest": "28.1.2",
+    "prettier": "2.7.1",
+    "redis": "4.6.5",
+    "supertest": "6.2.4",
+    "ts-jest": "28.0.8",
+    "ts-loader": "9.3.1",
+    "ts-node": "10.8.2",
+    "tsconfig-paths": "4.0.0",
+    "typescript": "4.9.5"
+  },
+  "jest": {
+    "moduleFileExtensions": [
+      "js",
+      "json",
+      "ts"
+    ],
+    "rootDir": "src",
+    "testRegex": ".*\\.spec\\.ts$",
+    "transform": {
+      "^.+\\.(t|j)s$": "ts-jest"
+    },
+    "collectCoverageFrom": [
+      "**/*.(t|j)s"
+    ],
+    "coverageDirectory": "../coverage",
+    "testEnvironment": "node"
   }
 }
diff --git a/sample/02-gateways/src/adapters/redis-io.adapter.ts b/sample/02-gateways/src/adapters/redis-io.adapter.ts
index a0f83932a..e8c4467d0 100644
--- a/sample/02-gateways/src/adapters/redis-io.adapter.ts
+++ b/sample/02-gateways/src/adapters/redis-io.adapter.ts
@@ -1,16 +1,23 @@
 import { IoAdapter } from '@nestjs/platform-socket.io';
-import { RedisClient } from 'redis';
 import { ServerOptions } from 'socket.io';
-import { createAdapter } from 'socket.io-redis';
-
-const pubClient = new RedisClient({ host: 'localhost', port: 6379 });
-const subClient = pubClient.duplicate();
-const redisAdapter = createAdapter({ pubClient, subClient });
+import { createAdapter } from '@socket.io/redis-adapter';
+import { createClient } from 'redis';
 
 export class RedisIoAdapter extends IoAdapter {
+  private adapterConstructor: ReturnType<typeof createAdapter>;
+
+  async connectToRedis(): Promise<void> {
+    const pubClient = createClient({ url: `redis://localhost:6379` });
+    const subClient = pubClient.duplicate();
+
+    await Promise.all([pubClient.connect(), subClient.connect()]);
+
+    this.adapterConstructor = createAdapter(pubClient, subClient);
+  }
+
   createIOServer(port: number, options?: ServerOptions): any {
     const server = super.createIOServer(port, options);
-    server.adapter(redisAdapter);
+    server.adapter(this.adapterConstructor);
     return server;
   }
 }
diff --git a/sample/02-gateways/src/events/events.gateway.spec.ts b/sample/02-gateways/src/events/events.gateway.spec.ts
new file mode 100644
index 000000000..e40de3deb
--- /dev/null
+++ b/sample/02-gateways/src/events/events.gateway.spec.ts
@@ -0,0 +1,40 @@
+import { Test, TestingModule } from '@nestjs/testing';
+import { reduce } from 'rxjs/operators';
+import { EventsGateway } from './events.gateway';
+
+describe('EventsGateway', () => {
+  let gateway: EventsGateway;
+
+  beforeEach(async () => {
+    const module: TestingModule = await Test.createTestingModule({
+      providers: [EventsGateway],
+    }).compile();
+
+    gateway = module.get<EventsGateway>(EventsGateway);
+  });
+
+  it('should be defined', () => {
+    expect(gateway).toBeDefined();
+  });
+
+  describe('findAll', () => {
+    it('should return 3 numbers', done => {
+      gateway
+        .findAll({})
+        .pipe(reduce((acc, item) => [...acc, item], []))
+        .subscribe(results => {
+          expect(results.length).toBe(3);
+          results.forEach((result, index) =>
+            expect(result.data).toBe(index + 1),
+          );
+          done();
+        });
+    });
+  });
+
+  describe('identity', () => {
+    it('should return the same number has what was sent', async () => {
+      await expect(gateway.identity(1)).resolves.toBe(1);
+    });
+  });
+});
diff --git a/sample/02-gateways/src/main.ts b/sample/02-gateways/src/main.ts
index e1e10d969..02ced27bc 100644
--- a/sample/02-gateways/src/main.ts
+++ b/sample/02-gateways/src/main.ts
@@ -3,6 +3,12 @@ import { AppModule } from './app.module';
 
 async function bootstrap() {
   const app = await NestFactory.create(AppModule);
+
+  // Uncomment these lines to use the Redis adapter:
+  // const redisIoAdapter = new RedisIoAdapter(app);
+  // await redisIoAdapter.connectToRedis();
+  // app.useWebSocketAdapter(redisIoAdapter);
+
   await app.listen(3000);
   console.log(`Application is running on: ${await app.getUrl()}`);
 }
diff --git a/sample/02-gateways/tsconfig.json b/sample/02-gateways/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/02-gateways/tsconfig.json
+++ b/sample/02-gateways/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/03-microservices/package-lock.json b/sample/03-microservices/package-lock.json
index ed12395cd..5f916f6cd 100644
Binary files a/sample/03-microservices/package-lock.json and b/sample/03-microservices/package-lock.json differ
diff --git a/sample/03-microservices/package.json b/sample/03-microservices/package.json
index 6a3bfe918..873bf9a5d 100644
--- a/sample/03-microservices/package.json
+++ b/sample/03-microservices/package.json
@@ -19,36 +19,36 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/microservices": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "class-transformer": "0.4.0",
-    "class-validator": "0.13.2",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/microservices": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
+    "class-transformer": "0.5.1",
+    "class-validator": "0.14.0",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "rimraf": "4.4.1",
+    "rxjs": "7.5.5"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/amqplib": "0.8.2",
+    "@nestjs/cli": "9.0.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
+    "@types/amqplib": "0.10.1",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.11",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@types/node": "18.0.3",
+    "@types/supertest": "2.0.12",
+    "jest": "28.1.2",
+    "prettier": "2.7.1",
+    "supertest": "6.2.4",
+    "ts-jest": "28.0.8",
+    "ts-loader": "9.3.1",
+    "ts-node": "10.8.2",
+    "tsconfig-paths": "4.0.0",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.19.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-import": "2.26.0",
+    "typescript": "4.9.5"
   }
 }
diff --git a/sample/03-microservices/tsconfig.json b/sample/03-microservices/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/03-microservices/tsconfig.json
+++ b/sample/03-microservices/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/04-grpc/package-lock.json b/sample/04-grpc/package-lock.json
index 45b964a5c..6cbfff115 100644
Binary files a/sample/04-grpc/package-lock.json and b/sample/04-grpc/package-lock.json differ
diff --git a/sample/04-grpc/package.json b/sample/04-grpc/package.json
index f972d8880..8cfe27426 100644
--- a/sample/04-grpc/package.json
+++ b/sample/04-grpc/package.json
@@ -19,37 +19,36 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@grpc/grpc-js": "1.4.4",
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/microservices": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "class-transformer": "0.4.0",
-    "class-validator": "0.13.2",
+    "@grpc/grpc-js": "1.6.7",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/microservices": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
+    "class-transformer": "0.5.1",
+    "class-validator": "0.14.0",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "rimraf": "4.4.1",
+    "rxjs": "7.5.5"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
+    "@nestjs/cli": "9.0.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.11",
-    "@types/supertest": "2.0.11",
-    "@types/ws": "7.4.7",
-    "jest": "27.3.1",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@types/node": "18.0.3",
+    "@types/supertest": "2.0.12",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.19.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-import": "2.26.0",
+    "jest": "28.1.2",
+    "prettier": "2.7.1",
+    "supertest": "6.2.4",
+    "ts-jest": "28.0.8",
+    "ts-loader": "9.3.1",
+    "ts-node": "10.8.2",
+    "tsconfig-paths": "4.0.0",
+    "typescript": "4.9.5"
   }
 }
diff --git a/sample/04-grpc/tsconfig.json b/sample/04-grpc/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/04-grpc/tsconfig.json
+++ b/sample/04-grpc/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/05-sql-typeorm/.gitignore b/sample/05-sql-typeorm/.gitignore
index b5e5f9755..44c92371f 100644
--- a/sample/05-sql-typeorm/.gitignore
+++ b/sample/05-sql-typeorm/.gitignore
@@ -13,7 +13,6 @@ npm-debug.log
 /quick-start
 
 # tests
-/test
 /coverage
 /.nyc_output
 
diff --git a/sample/05-sql-typeorm/docker-compose.yml b/sample/05-sql-typeorm/docker-compose.yml
index eee25f209..a8b6aadb8 100644
--- a/sample/05-sql-typeorm/docker-compose.yml
+++ b/sample/05-sql-typeorm/docker-compose.yml
@@ -9,3 +9,11 @@ services:
       MYSQL_DATABASE: test
     ports:
       - "3306:3306"
+  db-test:
+    image: mysql:8
+    restart: always
+    environment:
+      MYSQL_ROOT_PASSWORD: root
+      MYSQL_DATABASE: test
+    ports:
+      - "3307:3306"
\ No newline at end of file
diff --git a/sample/05-sql-typeorm/package-lock.json b/sample/05-sql-typeorm/package-lock.json
index bd4ed3fad..9f90795a7 100644
Binary files a/sample/05-sql-typeorm/package-lock.json and b/sample/05-sql-typeorm/package-lock.json differ
diff --git a/sample/05-sql-typeorm/package.json b/sample/05-sql-typeorm/package.json
index f57d0e322..885ab90e0 100644
--- a/sample/05-sql-typeorm/package.json
+++ b/sample/05-sql-typeorm/package.json
@@ -19,38 +19,37 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "@nestjs/typeorm": "8.0.2",
-    "mysql": "2.18.1",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
+    "@nestjs/typeorm": "9.0.1",
+    "mysql2": "3.2.0",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0",
-    "typeorm": "0.2.41"
+    "rimraf": "4.4.1",
+    "rxjs": "7.5.5",
+    "typeorm": "0.3.12"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
+    "@nestjs/cli": "9.0.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.11",
-    "@types/supertest": "2.0.11",
-    "@types/ws": "7.4.7",
-    "jest": "27.3.1",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@types/jest": "28.1.4",
+    "@types/node": "18.0.3",
+    "@types/supertest": "2.0.12",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.19.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-import": "2.26.0",
+    "jest": "28.1.2",
+    "prettier": "2.7.1",
+    "supertest": "6.2.4",
+    "ts-jest": "28.0.8",
+    "ts-loader": "9.3.1",
+    "ts-node": "10.8.2",
+    "tsconfig-paths": "4.0.0",
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/05-sql-typeorm/src/users/users.controller.spec.ts b/sample/05-sql-typeorm/src/users/users.controller.spec.ts
index 199cea13b..4d1160037 100644
--- a/sample/05-sql-typeorm/src/users/users.controller.spec.ts
+++ b/sample/05-sql-typeorm/src/users/users.controller.spec.ts
@@ -76,10 +76,10 @@ describe('UsersController', () => {
 
   describe('findOne()', () => {
     it('should find a user', () => {
-      expect(usersController.findOne('1')).resolves.toEqual({
+      expect(usersController.findOne(1)).resolves.toEqual({
         firstName: 'firstName #1',
         lastName: 'lastName #1',
-        id: '1',
+        id: 1,
       });
       expect(usersService.findOne).toHaveBeenCalled();
     });
diff --git a/sample/05-sql-typeorm/src/users/users.controller.ts b/sample/05-sql-typeorm/src/users/users.controller.ts
index f710be650..4f88099cd 100644
--- a/sample/05-sql-typeorm/src/users/users.controller.ts
+++ b/sample/05-sql-typeorm/src/users/users.controller.ts
@@ -1,4 +1,12 @@
-import { Body, Controller, Delete, Get, Param, Post } from '@nestjs/common';
+import {
+  Body,
+  Controller,
+  Delete,
+  Get,
+  Param,
+  Post,
+  ParseIntPipe,
+} from '@nestjs/common';
 import { CreateUserDto } from './dto/create-user.dto';
 import { User } from './user.entity';
 import { UsersService } from './users.service';
@@ -18,7 +26,7 @@ export class UsersController {
   }
 
   @Get(':id')
-  findOne(@Param('id') id: string): Promise<User> {
+  findOne(@Param('id', ParseIntPipe) id: number): Promise<User> {
     return this.usersService.findOne(id);
   }
 
diff --git a/sample/05-sql-typeorm/src/users/users.service.spec.ts b/sample/05-sql-typeorm/src/users/users.service.spec.ts
index 46c8b7eda..575df1573 100644
--- a/sample/05-sql-typeorm/src/users/users.service.spec.ts
+++ b/sample/05-sql-typeorm/src/users/users.service.spec.ts
@@ -32,7 +32,7 @@ describe('UserService', () => {
           provide: getRepositoryToken(User),
           useValue: {
             find: jest.fn().mockResolvedValue(userArray),
-            findOne: jest.fn().mockResolvedValue(oneUser),
+            findOneBy: jest.fn().mockResolvedValue(oneUser),
             save: jest.fn().mockResolvedValue(oneUser),
             remove: jest.fn(),
             delete: jest.fn(),
@@ -74,9 +74,9 @@ describe('UserService', () => {
 
   describe('findOne()', () => {
     it('should get a single user', () => {
-      const repoSpy = jest.spyOn(repository, 'findOne');
-      expect(service.findOne('1')).resolves.toEqual(oneUser);
-      expect(repoSpy).toBeCalledWith('1');
+      const repoSpy = jest.spyOn(repository, 'findOneBy');
+      expect(service.findOne(1)).resolves.toEqual(oneUser);
+      expect(repoSpy).toBeCalledWith({ id: 1 });
     });
   });
 
diff --git a/sample/05-sql-typeorm/src/users/users.service.ts b/sample/05-sql-typeorm/src/users/users.service.ts
index 12ca83286..ac82eb7e1 100644
--- a/sample/05-sql-typeorm/src/users/users.service.ts
+++ b/sample/05-sql-typeorm/src/users/users.service.ts
@@ -23,8 +23,8 @@ export class UsersService {
     return this.usersRepository.find();
   }
 
-  findOne(id: string): Promise<User> {
-    return this.usersRepository.findOne(id);
+  findOne(id: number): Promise<User> {
+    return this.usersRepository.findOneBy({ id: id });
   }
 
   async remove(id: string): Promise<void> {
diff --git a/sample/05-sql-typeorm/test/jest-e2e.json b/sample/05-sql-typeorm/test/jest-e2e.json
new file mode 100644
index 000000000..e9d912f3e
--- /dev/null
+++ b/sample/05-sql-typeorm/test/jest-e2e.json
@@ -0,0 +1,9 @@
+{
+  "moduleFileExtensions": ["js", "json", "ts"],
+  "rootDir": ".",
+  "testEnvironment": "node",
+  "testRegex": ".e2e-spec.ts$",
+  "transform": {
+    "^.+\\.(t|j)s$": "ts-jest"
+  }
+}
diff --git a/sample/05-sql-typeorm/test/users/users.e2e-spec.ts b/sample/05-sql-typeorm/test/users/users.e2e-spec.ts
new file mode 100644
index 000000000..1f1db731f
--- /dev/null
+++ b/sample/05-sql-typeorm/test/users/users.e2e-spec.ts
@@ -0,0 +1,74 @@
+import { Test, TestingModule } from '@nestjs/testing';
+import { INestApplication } from '@nestjs/common';
+import * as request from 'supertest';
+import { UsersModule } from '../../src/users/users.module';
+import { TypeOrmModule } from '@nestjs/typeorm';
+import { CreateUserDto } from '../../src/users/dto/create-user.dto';
+
+describe('Users - /users (e2e)', () => {
+  const users = {
+    id: 1,
+    firstName: 'FirstName #1',
+    lastName: 'LastName #1',
+    isActive: true,
+  };
+
+  let app: INestApplication;
+
+  beforeAll(async () => {
+    const moduleFixture: TestingModule = await Test.createTestingModule({
+      imports: [
+        TypeOrmModule.forRoot({
+          type: 'mysql',
+          host: 'localhost',
+          port: 3307,
+          username: 'root',
+          password: 'root',
+          database: 'test',
+          autoLoadEntities: true,
+          synchronize: true,
+        }),
+        UsersModule,
+      ],
+    }).compile();
+
+    app = moduleFixture.createNestApplication();
+    await app.init();
+  });
+
+  it('Create [POST /users]', () => {
+    return request(app.getHttpServer())
+      .post('/users')
+      .send(users as CreateUserDto)
+      .expect(201)
+      .then(({ body }) => {
+        expect(body).toEqual(users);
+      });
+  });
+
+  it('Get all users [GET /users]', () => {
+    return request(app.getHttpServer())
+      .get('/users')
+      .expect(200)
+      .then(({ body }) => {
+        expect(body).toBeDefined();
+      });
+  });
+
+  it('Get one user [GET /users/:id]', () => {
+    return request(app.getHttpServer())
+      .get('/users/2')
+      .expect(200)
+      .then(({ body }) => {
+        expect(body).toBeDefined();
+      });
+  });
+
+  it('Delete one user [DELETE /users/:id]', () => {
+    return request(app.getHttpServer()).delete('/users/1').expect(200);
+  });
+
+  afterAll(async () => {
+    await app.close();
+  });
+});
diff --git a/sample/05-sql-typeorm/tsconfig.json b/sample/05-sql-typeorm/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/05-sql-typeorm/tsconfig.json
+++ b/sample/05-sql-typeorm/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/06-mongoose/package-lock.json b/sample/06-mongoose/package-lock.json
index 760cfb54d..984b5c1fa 100644
Binary files a/sample/06-mongoose/package-lock.json and b/sample/06-mongoose/package-lock.json differ
diff --git a/sample/06-mongoose/package.json b/sample/06-mongoose/package.json
index 3cc383e9d..361b025cb 100644
--- a/sample/06-mongoose/package.json
+++ b/sample/06-mongoose/package.json
@@ -19,39 +19,36 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/mongoose": "9.0.1",
-    "@nestjs/platform-express": "8.2.3",
-    "mongoose": "6.0.14",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/mongoose": "9.2.2",
+    "@nestjs/platform-express": "9.3.12",
+    "mongoose": "6.4.6",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "rimraf": "4.4.1",
+    "rxjs": "7.5.5"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@types/mongoose": "5.11.96",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
+    "@nestjs/cli": "9.0.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/mongoose": "5.11.96",
-    "@types/node": "16.11.11",
-    "@types/supertest": "2.0.11",
-    "@types/ws": "7.4.7",
-    "jest": "27.3.1",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@types/jest": "28.1.4",
+    "@types/node": "18.0.3",
+    "@types/supertest": "2.0.12",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.19.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-import": "2.26.0",
+    "jest": "28.1.2",
+    "prettier": "2.7.1",
+    "supertest": "6.2.4",
+    "ts-jest": "28.0.8",
+    "ts-loader": "9.3.1",
+    "ts-node": "10.8.2",
+    "tsconfig-paths": "4.0.0",
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/06-mongoose/src/cats/cats.controller.ts b/sample/06-mongoose/src/cats/cats.controller.ts
index 84306fe38..c9aa1f645 100644
--- a/sample/06-mongoose/src/cats/cats.controller.ts
+++ b/sample/06-mongoose/src/cats/cats.controller.ts
@@ -1,4 +1,4 @@
-import { Body, Controller, Get, Post } from '@nestjs/common';
+import { Body, Controller, Delete, Get, Param, Post } from '@nestjs/common';
 import { CatsService } from './cats.service';
 import { CreateCatDto } from './dto/create-cat.dto';
 import { Cat } from './schemas/cat.schema';
@@ -16,4 +16,14 @@ export class CatsController {
   async findAll(): Promise<Cat[]> {
     return this.catsService.findAll();
   }
+
+  @Get(':id')
+  async findOne(@Param('id') id: string): Promise<Cat> {
+    return this.catsService.findOne(id);
+  }
+
+  @Delete(':id')
+  async delete(@Param('id') id: string) {
+    return this.catsService.delete(id);
+  }
 }
diff --git a/sample/06-mongoose/src/cats/cats.service.ts b/sample/06-mongoose/src/cats/cats.service.ts
index 73d44320a..27020406f 100644
--- a/sample/06-mongoose/src/cats/cats.service.ts
+++ b/sample/06-mongoose/src/cats/cats.service.ts
@@ -2,13 +2,11 @@ import { Injectable } from '@nestjs/common';
 import { InjectModel } from '@nestjs/mongoose';
 import { Model } from 'mongoose';
 import { CreateCatDto } from './dto/create-cat.dto';
-import { Cat, CatDocument } from './schemas/cat.schema';
+import { Cat } from './schemas/cat.schema';
 
 @Injectable()
 export class CatsService {
-  constructor(
-    @InjectModel(Cat.name) private readonly catModel: Model<CatDocument>,
-  ) {}
+  constructor(@InjectModel(Cat.name) private readonly catModel: Model<Cat>) {}
 
   async create(createCatDto: CreateCatDto): Promise<Cat> {
     const createdCat = await this.catModel.create(createCatDto);
@@ -18,4 +16,15 @@ export class CatsService {
   async findAll(): Promise<Cat[]> {
     return this.catModel.find().exec();
   }
+
+  async findOne(id: string): Promise<Cat> {
+    return this.catModel.findOne({ _id: id }).exec();
+  }
+
+  async delete(id: string) {
+    const deletedCat = await this.catModel
+      .findByIdAndRemove({ _id: id })
+      .exec();
+    return deletedCat;
+  }
 }
diff --git a/sample/06-mongoose/src/cats/schemas/cat.schema.ts b/sample/06-mongoose/src/cats/schemas/cat.schema.ts
index 2cd7b90af..ff3500720 100644
--- a/sample/06-mongoose/src/cats/schemas/cat.schema.ts
+++ b/sample/06-mongoose/src/cats/schemas/cat.schema.ts
@@ -1,7 +1,7 @@
 import { Prop, Schema, SchemaFactory } from '@nestjs/mongoose';
-import { Document } from 'mongoose';
+import { HydratedDocument } from 'mongoose';
 
-export type CatDocument = Cat & Document;
+export type CatDocument = HydratedDocument<Cat>;
 
 @Schema()
 export class Cat {
diff --git a/sample/06-mongoose/tsconfig.json b/sample/06-mongoose/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/06-mongoose/tsconfig.json
+++ b/sample/06-mongoose/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/07-sequelize/package-lock.json b/sample/07-sequelize/package-lock.json
index 0963e940a..9d3e6f502 100644
Binary files a/sample/07-sequelize/package-lock.json and b/sample/07-sequelize/package-lock.json differ
diff --git a/sample/07-sequelize/package.json b/sample/07-sequelize/package.json
index 6340d91a5..138ed58f6 100644
--- a/sample/07-sequelize/package.json
+++ b/sample/07-sequelize/package.json
@@ -19,41 +19,39 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "@nestjs/sequelize": "8.0.0",
-    "mysql2": "2.3.3",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
+    "@nestjs/sequelize": "9.0.0",
+    "mysql2": "3.2.0",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0",
-    "sequelize": "6.9.0",
-    "sequelize-typescript": "2.1.1",
-    "typescript": "4.3.5"
+    "rimraf": "4.4.1",
+    "rxjs": "7.5.5",
+    "sequelize": "6.29.0",
+    "sequelize-typescript": "2.1.5",
+    "typescript": "4.9.5"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@types/sequelize": "4.28.10",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
+    "@nestjs/cli": "9.0.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.11",
-    "@types/supertest": "2.0.11",
-    "@types/ws": "7.4.7",
-    "jest": "27.3.1",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@types/jest": "28.1.4",
+    "@types/node": "18.0.3",
+    "@types/supertest": "2.0.12",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.19.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-import": "2.26.0",
+    "jest": "28.1.2",
+    "prettier": "2.7.1",
+    "supertest": "6.2.4",
+    "ts-jest": "28.0.8",
+    "ts-loader": "9.3.1",
+    "ts-node": "10.8.2",
+    "tsconfig-paths": "4.0.0",
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/07-sequelize/src/users/users.service.ts b/sample/07-sequelize/src/users/users.service.ts
index ebdb2282e..615252598 100644
--- a/sample/07-sequelize/src/users/users.service.ts
+++ b/sample/07-sequelize/src/users/users.service.ts
@@ -11,7 +11,10 @@ export class UsersService {
   ) {}
 
   create(createUserDto: CreateUserDto): Promise<User> {
-    return this.userModel.create(createUserDto);
+    return this.userModel.create({
+      firstName: createUserDto.firstName,
+      lastName: createUserDto.lastName,
+    });
   }
 
   async findAll(): Promise<User[]> {
diff --git a/sample/07-sequelize/tsconfig.json b/sample/07-sequelize/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/07-sequelize/tsconfig.json
+++ b/sample/07-sequelize/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/08-webpack/package-lock.json b/sample/08-webpack/package-lock.json
index b9cbdcf38..a840162e4 100644
Binary files a/sample/08-webpack/package-lock.json and b/sample/08-webpack/package-lock.json differ
diff --git a/sample/08-webpack/package.json b/sample/08-webpack/package.json
index 1e376eaa5..ea33f0a0d 100644
--- a/sample/08-webpack/package.json
+++ b/sample/08-webpack/package.json
@@ -8,30 +8,31 @@
     "build:dev": "nest build --watch --webpack --webpackPath webpack-hmr.config.js",
     "start": "node dist/main",
     "lint": "eslint '{src,apps,libs,test}/**/*.ts' --fix",
+    "test": "echo 'No tests implemented yet.'",
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
     "reflect-metadata": "0.1.13",
-    "rxjs": "7.4.0",
-    "typescript": "4.3.5"
+    "rxjs": "7.5.5",
+    "typescript": "4.9.5"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@types/node": "16.11.11",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
+    "@nestjs/cli": "9.0.0",
+    "@nestjs/schematics": "9.0.4",
+    "@types/node": "18.0.3",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.19.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-import": "2.26.0",
     "start-server-webpack-plugin": "2.2.5",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "webpack": "5.64.4",
-    "webpack-cli": "4.9.1",
+    "ts-loader": "9.3.1",
+    "ts-node": "10.8.2",
+    "webpack": "5.76.3",
+    "webpack-cli": "4.10.0",
     "webpack-node-externals": "3.0.0"
   }
 }
diff --git a/sample/08-webpack/tsconfig.json b/sample/08-webpack/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/08-webpack/tsconfig.json
+++ b/sample/08-webpack/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/09-babel-example/package-lock.json b/sample/09-babel-example/package-lock.json
index 5842c0aeb..040b41422 100644
Binary files a/sample/09-babel-example/package-lock.json and b/sample/09-babel-example/package-lock.json differ
diff --git a/sample/09-babel-example/package.json b/sample/09-babel-example/package.json
index b55012b38..9ecb4f240 100644
--- a/sample/09-babel-example/package.json
+++ b/sample/09-babel-example/package.json
@@ -13,28 +13,28 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "@nestjs/microservices": "8.2.3",
-    "@nestjs/websockets": "8.2.3",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
+    "@nestjs/microservices": "9.3.12",
+    "@nestjs/websockets": "9.3.12",
     "reflect-metadata": "0.1.13",
-    "rxjs": "7.4.0"
+    "rxjs": "7.5.5"
   },
   "devDependencies": {
-    "@babel/cli": "7.16.0",
-    "@babel/core": "7.16.0",
-    "@babel/node": "7.16.0",
-    "@babel/plugin-proposal-decorators": "7.16.4",
-    "@babel/plugin-transform-runtime": "7.16.4",
-    "@babel/preset-env": "7.16.4",
-    "@babel/register": "7.16.0",
-    "@babel/runtime": "7.16.3",
-    "@nestjs/testing": "8.2.3",
-    "jest": "27.3.1",
-    "nodemon": "2.0.15",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6"
+    "@babel/cli": "7.21.0",
+    "@babel/core": "7.21.3",
+    "@babel/node": "7.20.7",
+    "@babel/plugin-proposal-decorators": "7.21.0",
+    "@babel/plugin-transform-runtime": "7.21.0",
+    "@babel/preset-env": "7.20.2",
+    "@babel/register": "7.21.0",
+    "@babel/runtime": "7.21.0",
+    "@nestjs/testing": "9.3.12",
+    "jest": "28.1.2",
+    "nodemon": "2.0.22",
+    "prettier": "2.7.1",
+    "supertest": "6.2.4"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/10-fastify/package-lock.json b/sample/10-fastify/package-lock.json
index 6b7815f34..b8804b6a9 100644
Binary files a/sample/10-fastify/package-lock.json and b/sample/10-fastify/package-lock.json differ
diff --git a/sample/10-fastify/package.json b/sample/10-fastify/package.json
index e4f20415b..0746b1379 100644
--- a/sample/10-fastify/package.json
+++ b/sample/10-fastify/package.json
@@ -19,35 +19,34 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-fastify": "8.2.3",
-    "class-transformer": "0.4.0",
-    "class-validator": "0.13.2",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-fastify": "9.3.12",
+    "class-transformer": "0.5.1",
+    "class-validator": "0.14.0",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "rimraf": "4.4.1",
+    "rxjs": "7.5.5"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
+    "@nestjs/cli": "9.0.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.11",
-    "@types/supertest": "2.0.11",
-    "@types/ws": "7.4.7",
-    "jest": "27.3.1",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@types/node": "18.0.3",
+    "@types/supertest": "2.0.12",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.19.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-import": "2.26.0",
+    "jest": "28.1.2",
+    "prettier": "2.7.1",
+    "supertest": "6.2.4",
+    "ts-jest": "28.0.8",
+    "ts-loader": "9.3.1",
+    "ts-node": "10.8.2",
+    "tsconfig-paths": "4.0.0",
+    "typescript": "4.9.5"
   }
 }
diff --git a/sample/10-fastify/tsconfig.json b/sample/10-fastify/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/10-fastify/tsconfig.json
+++ b/sample/10-fastify/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/11-swagger/package-lock.json b/sample/11-swagger/package-lock.json
index d888e637c..ac7915151 100644
Binary files a/sample/11-swagger/package-lock.json and b/sample/11-swagger/package-lock.json differ
diff --git a/sample/11-swagger/package.json b/sample/11-swagger/package.json
index e120a4b04..e3aaba9a4 100644
--- a/sample/11-swagger/package.json
+++ b/sample/11-swagger/package.json
@@ -19,36 +19,35 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "@nestjs/swagger": "5.1.5",
-    "class-transformer": "0.4.0",
-    "class-validator": "0.13.2",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
+    "@nestjs/swagger": "6.0.1",
+    "class-transformer": "0.5.1",
+    "class-validator": "0.14.0",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0",
-    "swagger-ui-express": "4.1.6"
+    "rimraf": "4.4.1",
+    "rxjs": "7.5.5"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
+    "@nestjs/cli": "9.0.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.11",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@types/node": "18.0.3",
+    "@types/supertest": "2.0.12",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.19.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-import": "2.26.0",
+    "jest": "28.1.2",
+    "prettier": "2.7.1",
+    "supertest": "6.2.4",
+    "ts-jest": "28.0.8",
+    "ts-loader": "9.3.1",
+    "ts-node": "10.8.2",
+    "tsconfig-paths": "4.0.0",
+    "typescript": "4.9.5"
   }
 }
diff --git a/sample/11-swagger/tsconfig.json b/sample/11-swagger/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/11-swagger/tsconfig.json
+++ b/sample/11-swagger/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/12-graphql-schema-first/package-lock.json b/sample/12-graphql-schema-first/package-lock.json
index 1821ccea4..eed73df26 100644
Binary files a/sample/12-graphql-schema-first/package-lock.json and b/sample/12-graphql-schema-first/package-lock.json differ
diff --git a/sample/12-graphql-schema-first/package.json b/sample/12-graphql-schema-first/package.json
index 35776fc46..03db9cc2d 100644
--- a/sample/12-graphql-schema-first/package.json
+++ b/sample/12-graphql-schema-first/package.json
@@ -19,40 +19,41 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/graphql": "9.1.2",
-    "@nestjs/platform-express": "8.2.3",
-    "apollo-server": "3.5.0",
-    "apollo-server-express": "3.5.0",
-    "class-transformer": "0.4.0",
-    "class-validator": "0.13.2",
-    "graphql": "15.7.2",
+    "@apollo/server": "4.5.0",
+    "@graphql-tools/utils": "9.2.1",
+    "@nestjs/apollo": "11.0.4",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/graphql": "11.0.0",
+    "@nestjs/platform-express": "9.3.12",
+    "class-transformer": "0.5.1",
+    "class-validator": "0.14.0",
+    "graphql": "16.6.0",
     "graphql-subscriptions": "2.0.0",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "rimraf": "4.4.1",
+    "rxjs": "7.8.0"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/node": "16.11.11",
-    "@types/supertest": "2.0.11",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "jest": "27.3.1",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-morph": "12.2.0",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "typescript": "4.4.2"
+    "@nestjs/cli": "9.2.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
+    "@types/express": "4.17.17",
+    "@types/node": "18.15.0",
+    "@types/supertest": "2.0.12",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.35.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-import": "2.27.5",
+    "jest": "29.5.0",
+    "prettier": "2.8.4",
+    "supertest": "6.3.3",
+    "ts-jest": "29.0.5",
+    "ts-loader": "9.4.2",
+    "ts-morph": "17.0.1",
+    "ts-node": "10.9.1",
+    "tsconfig-paths": "4.1.2",
+    "typescript": "4.9.5"
   }
 }
diff --git a/sample/12-graphql-schema-first/src/app.module.ts b/sample/12-graphql-schema-first/src/app.module.ts
index c3b0f1f25..c6833d0f6 100644
--- a/sample/12-graphql-schema-first/src/app.module.ts
+++ b/sample/12-graphql-schema-first/src/app.module.ts
@@ -1,12 +1,16 @@
+import { ApolloDriver, ApolloDriverConfig } from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
 import { GraphQLModule } from '@nestjs/graphql';
 import { CatsModule } from './cats/cats.module';
+import { upperDirectiveTransformer } from './common/directives/upper-case.directive';
 
 @Module({
   imports: [
     CatsModule,
-    GraphQLModule.forRoot({
+    GraphQLModule.forRoot<ApolloDriverConfig>({
+      driver: ApolloDriver,
       typePaths: ['./**/*.graphql'],
+      transformSchema: schema => upperDirectiveTransformer(schema, 'upper'),
       installSubscriptionHandlers: true,
     }),
   ],
diff --git a/sample/12-graphql-schema-first/src/common/directives/upper-case.directive.ts b/sample/12-graphql-schema-first/src/common/directives/upper-case.directive.ts
index 49341fe8e..52cabe0ef 100644
--- a/sample/12-graphql-schema-first/src/common/directives/upper-case.directive.ts
+++ b/sample/12-graphql-schema-first/src/common/directives/upper-case.directive.ts
@@ -1,15 +1,32 @@
-import { SchemaDirectiveVisitor } from '@graphql-tools/utils';
-import { defaultFieldResolver, GraphQLField } from 'graphql';
+import { getDirective, MapperKind, mapSchema } from '@graphql-tools/utils';
+import { defaultFieldResolver, GraphQLSchema } from 'graphql';
 
-export class UpperCaseDirective extends SchemaDirectiveVisitor {
-  visitFieldDefinition(field: GraphQLField<any, any>) {
-    const { resolve = defaultFieldResolver } = field;
-    field.resolve = async function (...args) {
-      const result = await resolve.apply(this, args);
-      if (typeof result === 'string') {
-        return result.toUpperCase();
+export function upperDirectiveTransformer(
+  schema: GraphQLSchema,
+  directiveName: string,
+) {
+  return mapSchema(schema, {
+    [MapperKind.OBJECT_FIELD]: fieldConfig => {
+      const upperDirective = getDirective(
+        schema,
+        fieldConfig,
+        directiveName,
+      )?.[0];
+
+      if (upperDirective) {
+        const { resolve = defaultFieldResolver } = fieldConfig;
+
+        // Replace the original resolver with a function that *first* calls
+        // the original resolver, then converts its result to upper case
+        fieldConfig.resolve = async function (source, args, context, info) {
+          const result = await resolve(source, args, context, info);
+          if (typeof result === 'string') {
+            return result.toUpperCase();
+          }
+          return result;
+        };
+        return fieldConfig;
       }
-      return result;
-    };
-  }
+    },
+  });
 }
diff --git a/sample/12-graphql-schema-first/src/common/plugins/logging.plugin.ts b/sample/12-graphql-schema-first/src/common/plugins/logging.plugin.ts
index 8e48e29cb..77c23a96c 100644
--- a/sample/12-graphql-schema-first/src/common/plugins/logging.plugin.ts
+++ b/sample/12-graphql-schema-first/src/common/plugins/logging.plugin.ts
@@ -1,12 +1,9 @@
-import { Plugin } from '@nestjs/graphql';
-import {
-  ApolloServerPlugin,
-  GraphQLRequestListener,
-} from 'apollo-server-plugin-base';
+import { ApolloServerPlugin, GraphQLRequestListener } from '@apollo/server';
+import { Plugin } from '@nestjs/apollo';
 
 @Plugin()
 export class LoggingPlugin implements ApolloServerPlugin {
-  async requestDidStart(): Promise<GraphQLRequestListener> {
+  async requestDidStart(): Promise<GraphQLRequestListener<any>> {
     console.log('Request started');
     return {
       async willSendResponse() {
diff --git a/sample/12-graphql-schema-first/src/graphql.schema.ts b/sample/12-graphql-schema-first/src/graphql.schema.ts
index d93925312..47a938f40 100644
--- a/sample/12-graphql-schema-first/src/graphql.schema.ts
+++ b/sample/12-graphql-schema-first/src/graphql.schema.ts
@@ -1,4 +1,3 @@
-
 /*
  * -------------------------------------------------------
  * THIS FILE WAS AUTOMATICALLY GENERATED (DO NOT MODIFY)
@@ -8,36 +7,40 @@
 /* tslint:disable */
 /* eslint-disable */
 export class CreateCatInput {
-    name?: Nullable<string>;
-    age?: Nullable<number>;
+  name?: Nullable<string>;
+  age?: Nullable<number>;
 }
 
 export abstract class IQuery {
-    abstract cats(): Nullable<Nullable<Cat>[]> | Promise<Nullable<Nullable<Cat>[]>>;
+  abstract cats():
+    | Nullable<Nullable<Cat>[]>
+    | Promise<Nullable<Nullable<Cat>[]>>;
 
-    abstract cat(id: string): Nullable<Cat> | Promise<Nullable<Cat>>;
+  abstract cat(id: string): Nullable<Cat> | Promise<Nullable<Cat>>;
 }
 
 export abstract class IMutation {
-    abstract createCat(createCatInput?: Nullable<CreateCatInput>): Nullable<Cat> | Promise<Nullable<Cat>>;
+  abstract createCat(
+    createCatInput?: Nullable<CreateCatInput>,
+  ): Nullable<Cat> | Promise<Nullable<Cat>>;
 }
 
 export abstract class ISubscription {
-    abstract catCreated(): Nullable<Cat> | Promise<Nullable<Cat>>;
+  abstract catCreated(): Nullable<Cat> | Promise<Nullable<Cat>>;
 }
 
 export class Owner {
-    id: number;
-    name: string;
-    age?: Nullable<number>;
-    cats?: Nullable<Cat[]>;
+  id: number;
+  name: string;
+  age?: Nullable<number>;
+  cats?: Nullable<Cat[]>;
 }
 
 export class Cat {
-    id?: Nullable<number>;
-    name?: Nullable<string>;
-    age?: Nullable<number>;
-    owner?: Nullable<Owner>;
+  id?: Nullable<number>;
+  name?: Nullable<string>;
+  age?: Nullable<number>;
+  owner?: Nullable<Owner>;
 }
 
 type Nullable<T> = T | null;
diff --git a/sample/12-graphql-schema-first/tsconfig.json b/sample/12-graphql-schema-first/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/12-graphql-schema-first/tsconfig.json
+++ b/sample/12-graphql-schema-first/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/13-mongo-typeorm/docker-compose.yml b/sample/13-mongo-typeorm/docker-compose.yml
index 834d04a17..e4adc7194 100644
--- a/sample/13-mongo-typeorm/docker-compose.yml
+++ b/sample/13-mongo-typeorm/docker-compose.yml
@@ -2,7 +2,7 @@ version: "3"
 
 services:
   mongodb:
-    image: mongo:5.0
+    image: mongo:6.0
     environment:
       - MONGODB_DATABASE="test"
     ports:
diff --git a/sample/13-mongo-typeorm/package-lock.json b/sample/13-mongo-typeorm/package-lock.json
index b20c41a43..28b93e391 100644
Binary files a/sample/13-mongo-typeorm/package-lock.json and b/sample/13-mongo-typeorm/package-lock.json differ
diff --git a/sample/13-mongo-typeorm/package.json b/sample/13-mongo-typeorm/package.json
index 06dcee60c..a5714a958 100644
--- a/sample/13-mongo-typeorm/package.json
+++ b/sample/13-mongo-typeorm/package.json
@@ -19,37 +19,37 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "@nestjs/typeorm": "8.0.2",
-    "mongodb": "3.7.3",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
+    "@nestjs/typeorm": "9.0.1",
+    "mongodb": "3.6.0",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0",
-    "typeorm": "0.2.41"
+    "rimraf": "4.4.1",
+    "rxjs": "7.5.5",
+    "typeorm": "0.3.12"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
+    "@nestjs/cli": "9.0.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.11",
-    "@types/supertest": "2.0.11",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "jest": "27.3.1",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "typescript": "4.3.5"
+    "@types/jest": "28.1.4",
+    "@types/node": "18.0.3",
+    "@types/supertest": "2.0.12",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.19.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-import": "2.26.0",
+    "jest": "28.1.2",
+    "prettier": "2.7.1",
+    "supertest": "6.2.4",
+    "ts-jest": "28.0.8",
+    "ts-loader": "9.3.1",
+    "ts-node": "10.8.2",
+    "tsconfig-paths": "4.0.0",
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/13-mongo-typeorm/src/photo/photo.service.ts b/sample/13-mongo-typeorm/src/photo/photo.service.ts
index 31c751b35..0bca3ddee 100644
--- a/sample/13-mongo-typeorm/src/photo/photo.service.ts
+++ b/sample/13-mongo-typeorm/src/photo/photo.service.ts
@@ -1,13 +1,13 @@
 import { Injectable } from '@nestjs/common';
 import { InjectRepository } from '@nestjs/typeorm';
-import { Repository } from 'typeorm';
+import { MongoRepository } from 'typeorm';
 import { Photo } from './photo.entity';
 
 @Injectable()
 export class PhotoService {
   constructor(
     @InjectRepository(Photo)
-    private readonly photoRepository: Repository<Photo>,
+    private readonly photoRepository: MongoRepository<Photo>,
   ) {}
 
   async findAll(): Promise<Photo[]> {
diff --git a/sample/13-mongo-typeorm/tsconfig.json b/sample/13-mongo-typeorm/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/13-mongo-typeorm/tsconfig.json
+++ b/sample/13-mongo-typeorm/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/14-mongoose-base/package-lock.json b/sample/14-mongoose-base/package-lock.json
index 44e37b5d5..0f621b706 100644
Binary files a/sample/14-mongoose-base/package-lock.json and b/sample/14-mongoose-base/package-lock.json differ
diff --git a/sample/14-mongoose-base/package.json b/sample/14-mongoose-base/package.json
index b11f5637c..8e395ef6b 100644
--- a/sample/14-mongoose-base/package.json
+++ b/sample/14-mongoose-base/package.json
@@ -19,35 +19,35 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "mongoose": "6.0.14",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
+    "mongoose": "6.4.6",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "rimraf": "4.4.1",
+    "rxjs": "7.5.5"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
+    "@nestjs/cli": "9.0.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.11",
-    "@types/supertest": "2.0.11",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "jest": "27.3.1",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "typescript": "4.3.5"
+    "@types/jest": "28.1.4",
+    "@types/node": "18.0.3",
+    "@types/supertest": "2.0.12",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.19.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-import": "2.26.0",
+    "jest": "28.1.2",
+    "prettier": "2.7.1",
+    "supertest": "6.2.4",
+    "ts-jest": "28.0.8",
+    "ts-loader": "9.3.1",
+    "ts-node": "10.8.2",
+    "tsconfig-paths": "4.0.0",
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/14-mongoose-base/tsconfig.json b/sample/14-mongoose-base/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/14-mongoose-base/tsconfig.json
+++ b/sample/14-mongoose-base/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/15-mvc/package-lock.json b/sample/15-mvc/package-lock.json
index a6133ce03..e03fca618 100644
Binary files a/sample/15-mvc/package-lock.json and b/sample/15-mvc/package-lock.json differ
diff --git a/sample/15-mvc/package.json b/sample/15-mvc/package.json
index af5859d7e..92be8e8a3 100644
--- a/sample/15-mvc/package.json
+++ b/sample/15-mvc/package.json
@@ -19,34 +19,33 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
     "hbs": "4.2.0",
-    "pug": "3.0.2",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "rimraf": "4.4.1",
+    "rxjs": "7.5.5"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
+    "@nestjs/cli": "9.0.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.11",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@types/node": "18.0.3",
+    "@types/supertest": "2.0.12",
+    "jest": "28.1.2",
+    "prettier": "2.7.1",
+    "supertest": "6.2.4",
+    "ts-jest": "28.0.8",
+    "ts-loader": "9.3.1",
+    "ts-node": "10.8.2",
+    "tsconfig-paths": "4.0.0",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.19.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-import": "2.26.0",
+    "typescript": "4.9.5"
   }
 }
diff --git a/sample/15-mvc/tsconfig.json b/sample/15-mvc/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/15-mvc/tsconfig.json
+++ b/sample/15-mvc/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/16-gateways-ws/package-lock.json b/sample/16-gateways-ws/package-lock.json
index 95ec101bb..bbd22ca3c 100644
Binary files a/sample/16-gateways-ws/package-lock.json and b/sample/16-gateways-ws/package-lock.json differ
diff --git a/sample/16-gateways-ws/package.json b/sample/16-gateways-ws/package.json
index 0e4a7c0b2..5089aed07 100644
--- a/sample/16-gateways-ws/package.json
+++ b/sample/16-gateways-ws/package.json
@@ -19,38 +19,38 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "@nestjs/platform-ws": "8.2.3",
-    "@nestjs/websockets": "8.2.3",
-    "class-transformer": "0.4.0",
-    "class-validator": "0.13.2",
-    "rimraf": "3.0.2",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
+    "@nestjs/platform-ws": "9.3.12",
+    "@nestjs/websockets": "9.3.12",
+    "class-transformer": "0.5.1",
+    "class-validator": "0.14.0",
+    "rimraf": "4.4.1",
     "reflect-metadata": "0.1.13",
-    "rxjs": "7.4.0",
-    "ws": "7.5.6"
+    "rxjs": "7.5.5",
+    "ws": "8.8.0"
   },
   "devDependencies": {
-    "@types/ws": "7.4.7",
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
+    "@types/ws": "8.5.3",
+    "@nestjs/cli": "9.0.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.11",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@types/node": "18.0.3",
+    "@types/supertest": "2.0.12",
+    "jest": "28.1.2",
+    "prettier": "2.7.1",
+    "supertest": "6.2.4",
+    "ts-jest": "28.0.8",
+    "ts-loader": "9.3.1",
+    "ts-node": "10.8.2",
+    "tsconfig-paths": "4.0.0",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.19.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-import": "2.26.0",
+    "typescript": "4.9.5"
   }
 }
diff --git a/sample/16-gateways-ws/tsconfig.json b/sample/16-gateways-ws/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/16-gateways-ws/tsconfig.json
+++ b/sample/16-gateways-ws/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/17-mvc-fastify/package-lock.json b/sample/17-mvc-fastify/package-lock.json
index ad8b53384..0ce71c566 100644
Binary files a/sample/17-mvc-fastify/package-lock.json and b/sample/17-mvc-fastify/package-lock.json differ
diff --git a/sample/17-mvc-fastify/package.json b/sample/17-mvc-fastify/package.json
index 483c30cf1..bc007d7aa 100644
--- a/sample/17-mvc-fastify/package.json
+++ b/sample/17-mvc-fastify/package.json
@@ -1,56 +1,53 @@
 {
-  "name": "nest-typescript-starter",
-  "version": "1.0.0",
-  "description": "Nest TypeScript starter repository",
-  "license": "MIT",
-  "scripts": {
-    "prebuild": "rimraf dist",
-    "build": "nest build",
-    "format": "prettier --write \"src/**/*.ts\" \"test/**/*.ts\"",
-    "start": "nest start",
-    "start:dev": "nest start --watch",
-    "start:debug": "nest start --debug --watch",
-    "start:prod": "node dist/main",
-    "lint": "eslint '{src,apps,libs,test}/**/*.ts' --fix",
-    "test": "jest",
-    "test:watch": "jest --watch",
-    "test:cov": "jest --coverage",
-    "test:debug": "node --inspect-brk -r tsconfig-paths/register -r ts-node/register node_modules/.bin/jest --runInBand",
-    "test:e2e": "echo 'No e2e tests implemented yet.'"
-  },
-  "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-fastify": "8.2.3",
-    "fastify-static": "4.5.0",
-    "handlebars": "4.7.7",
-    "point-of-view": "4.15.3",
-    "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
-  },
-  "devDependencies": {
-    "@types/socket.io": "3.0.1",
-    "@types/socket.io-redis": "1.0.27",
-    "@types/ws": "7.4.7",
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/node": "16.11.11",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
-  }
+    "name": "nest-typescript-starter",
+    "version": "1.0.0",
+    "description": "Nest TypeScript starter repository",
+    "license": "MIT",
+    "scripts": {
+        "prebuild": "rimraf dist",
+        "build": "nest build",
+        "format": "prettier --write \"src/**/*.ts\" \"test/**/*.ts\"",
+        "start": "nest start",
+        "start:dev": "nest start --watch",
+        "start:debug": "nest start --debug --watch",
+        "start:prod": "node dist/main",
+        "lint": "eslint '{src,apps,libs,test}/**/*.ts' --fix",
+        "test": "jest",
+        "test:watch": "jest --watch",
+        "test:cov": "jest --coverage",
+        "test:debug": "node --inspect-brk -r tsconfig-paths/register -r ts-node/register node_modules/.bin/jest --runInBand",
+        "test:e2e": "echo 'No e2e tests implemented yet.'"
+    },
+    "dependencies": {
+        "@nestjs/common": "9.3.12",
+        "@nestjs/core": "9.3.12",
+        "@nestjs/platform-fastify": "9.3.12",
+        "@fastify/static": "6.4.0",
+        "handlebars": "4.7.7",
+        "@fastify/view": "7.4.1",
+        "reflect-metadata": "0.1.13",
+        "rimraf": "4.4.1",
+        "rxjs": "7.5.5"
+    },
+    "devDependencies": {
+        "@nestjs/cli": "9.0.0",
+        "@nestjs/schematics": "9.0.4",
+        "@nestjs/testing": "9.3.12",
+        "@types/express": "4.17.13",
+        "@types/node": "18.0.3",
+        "@types/supertest": "2.0.12",
+        "@typescript-eslint/eslint-plugin": "5.56.0",
+        "@typescript-eslint/parser": "5.56.0",
+        "eslint": "8.19.0",
+        "eslint-config-prettier": "8.8.0",
+        "eslint-plugin-import": "2.26.0",
+        "jest": "28.1.2",
+        "prettier": "2.7.1",
+        "supertest": "6.2.4",
+        "ts-jest": "28.0.8",
+        "ts-loader": "9.3.1",
+        "ts-node": "10.8.2",
+        "tsconfig-paths": "4.0.0",
+        "typescript": "4.9.5"
+    }
 }
diff --git a/sample/17-mvc-fastify/tsconfig.json b/sample/17-mvc-fastify/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/17-mvc-fastify/tsconfig.json
+++ b/sample/17-mvc-fastify/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/18-context/package-lock.json b/sample/18-context/package-lock.json
index c6ccd13c7..9bd55509f 100644
Binary files a/sample/18-context/package-lock.json and b/sample/18-context/package-lock.json differ
diff --git a/sample/18-context/package.json b/sample/18-context/package.json
index c2f9c168c..489a53079 100644
--- a/sample/18-context/package.json
+++ b/sample/18-context/package.json
@@ -19,29 +19,29 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "rimraf": "4.4.1",
+    "rxjs": "7.5.5"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@types/node": "16.11.11",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "9.0.0",
+    "@nestjs/schematics": "9.0.4",
+    "@types/node": "18.0.3",
+    "@types/supertest": "2.0.12",
+    "jest": "28.1.2",
+    "prettier": "2.7.1",
+    "supertest": "6.2.4",
+    "ts-jest": "28.0.8",
+    "ts-loader": "9.3.1",
+    "ts-node": "10.8.2",
+    "tsconfig-paths": "4.0.0",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.19.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-import": "2.26.0",
+    "typescript": "4.9.5"
   }
 }
diff --git a/sample/18-context/tsconfig.json b/sample/18-context/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/18-context/tsconfig.json
+++ b/sample/18-context/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/19-auth-jwt/e2e/app/app.e2e-spec.ts b/sample/19-auth-jwt/e2e/app/app.e2e-spec.ts
index 7c07c91cc..066c288ff 100644
--- a/sample/19-auth-jwt/e2e/app/app.e2e-spec.ts
+++ b/sample/19-auth-jwt/e2e/app/app.e2e-spec.ts
@@ -1,5 +1,6 @@
 import { INestApplication } from '@nestjs/common';
 import { Test } from '@nestjs/testing';
+import { expect } from 'chai';
 import * as request from 'supertest';
 import { AppModule } from '../../src/app.module';
 
@@ -19,14 +20,17 @@ describe('E2E JWT Sample', () => {
     const loginReq = await request(app.getHttpServer())
       .post('/auth/login')
       .send({ username: 'john', password: 'changeme' })
-      .expect(201);
+      .expect(200);
 
     const token = loginReq.body.access_token;
     return request(app.getHttpServer())
-      .get('/profile')
+      .get('/auth/profile')
       .set('Authorization', 'Bearer ' + token)
       .expect(200)
-      .expect({ userId: 1, username: 'john' });
+      .expect(({ body }) => {
+        expect(body.sub).to.equal(1);
+        expect(body.username).to.equal('john');
+      });
   });
 
   afterAll(async () => {
diff --git a/sample/19-auth-jwt/package-lock.json b/sample/19-auth-jwt/package-lock.json
index 25b5d0d0d..9850e515b 100644
Binary files a/sample/19-auth-jwt/package-lock.json and b/sample/19-auth-jwt/package-lock.json differ
diff --git a/sample/19-auth-jwt/package.json b/sample/19-auth-jwt/package.json
index 1fd68d6b2..0dfa5a90c 100644
--- a/sample/19-auth-jwt/package.json
+++ b/sample/19-auth-jwt/package.json
@@ -20,39 +20,36 @@
     "test:e2e": "jest --config ./e2e/jest-e2e.json"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/jwt": "8.0.0",
-    "@nestjs/passport": "8.0.1",
-    "@nestjs/platform-express": "8.2.3",
-    "passport": "0.5.0",
-    "passport-jwt": "4.0.0",
-    "passport-local": "1.0.0",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/jwt": "10.0.3",
+    "@nestjs/passport": "9.0.3",
+    "@nestjs/platform-express": "9.3.12",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "rimraf": "4.4.1",
+    "rxjs": "7.5.5"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
+    "@nestjs/cli": "9.0.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.11",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@types/jest": "28.1.4",
+    "@types/node": "18.0.3",
+    "@types/supertest": "2.0.12",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.19.0",
+    "eslint-config-prettier": "8.5.0",
+    "eslint-plugin-import": "2.26.0",
+    "jest": "28.1.2",
+    "prettier": "2.7.1",
+    "supertest": "6.2.4",
+    "ts-jest": "28.0.8",
+    "ts-loader": "9.3.1",
+    "ts-node": "10.8.2",
+    "tsconfig-paths": "4.0.0",
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/19-auth-jwt/src/app.controller.ts b/sample/19-auth-jwt/src/app.controller.ts
index 4c6b68ca9..24fa19368 100644
--- a/sample/19-auth-jwt/src/app.controller.ts
+++ b/sample/19-auth-jwt/src/app.controller.ts
@@ -1,21 +1,4 @@
-import { Controller, Get, Post, Request, UseGuards } from '@nestjs/common';
-import { AuthService } from './auth/auth.service';
-import { JwtAuthGuard } from './auth/guards/jwt-auth.guard';
-import { LocalAuthGuard } from './auth/guards/local-auth.guard';
+import { Controller } from '@nestjs/common';
 
 @Controller()
-export class AppController {
-  constructor(private readonly authService: AuthService) {}
-
-  @UseGuards(LocalAuthGuard)
-  @Post('auth/login')
-  async login(@Request() req) {
-    return this.authService.login(req.user);
-  }
-
-  @UseGuards(JwtAuthGuard)
-  @Get('profile')
-  getProfile(@Request() req) {
-    return req.user;
-  }
-}
+export class AppController {}
diff --git a/sample/19-auth-jwt/src/auth/auth.controller.ts b/sample/19-auth-jwt/src/auth/auth.controller.ts
new file mode 100644
index 000000000..8e7b51642
--- /dev/null
+++ b/sample/19-auth-jwt/src/auth/auth.controller.ts
@@ -0,0 +1,28 @@
+import {
+  Body,
+  Controller,
+  Get,
+  HttpCode,
+  HttpStatus,
+  Post,
+  Request,
+} from '@nestjs/common';
+import { AuthService } from './auth.service';
+import { Public } from './decorators/public.decorator';
+
+@Controller('auth')
+export class AuthController {
+  constructor(private authService: AuthService) {}
+
+  @Public()
+  @HttpCode(HttpStatus.OK)
+  @Post('login')
+  signIn(@Body() signInDto: Record<string, any>) {
+    return this.authService.signIn(signInDto.username, signInDto.password);
+  }
+
+  @Get('profile')
+  getProfile(@Request() req) {
+    return req.user;
+  }
+}
diff --git a/sample/19-auth-jwt/src/auth/auth.guard.ts b/sample/19-auth-jwt/src/auth/auth.guard.ts
new file mode 100644
index 000000000..2fd63a07a
--- /dev/null
+++ b/sample/19-auth-jwt/src/auth/auth.guard.ts
@@ -0,0 +1,49 @@
+import {
+  CanActivate,
+  ExecutionContext,
+  Injectable,
+  UnauthorizedException,
+} from '@nestjs/common';
+import { Reflector } from '@nestjs/core';
+import { JwtService } from '@nestjs/jwt';
+import { Request } from 'express';
+import { jwtConstants } from './constants';
+import { IS_PUBLIC_KEY } from './decorators/public.decorator';
+
+@Injectable()
+export class AuthGuard implements CanActivate {
+  constructor(private jwtService: JwtService, private reflector: Reflector) {}
+
+  async canActivate(context: ExecutionContext): Promise<boolean> {
+    const isPublic = this.reflector.getAllAndOverride<boolean>(IS_PUBLIC_KEY, [
+      context.getHandler(),
+      context.getClass(),
+    ]);
+    if (isPublic) {
+      // üí° See this condition
+      return true;
+    }
+
+    const request = context.switchToHttp().getRequest();
+    const token = this.extractTokenFromHeader(request);
+    if (!token) {
+      throw new UnauthorizedException();
+    }
+    try {
+      const payload = await this.jwtService.verifyAsync(token, {
+        secret: jwtConstants.secret,
+      });
+      // üí° We're assigning the payload to the request object here
+      // so that we can access it in our route handlers
+      request['user'] = payload;
+    } catch {
+      throw new UnauthorizedException();
+    }
+    return true;
+  }
+
+  private extractTokenFromHeader(request: Request): string | undefined {
+    const [type, token] = request.headers.authorization?.split(' ') ?? [];
+    return type === 'Bearer' ? token : undefined;
+  }
+}
diff --git a/sample/19-auth-jwt/src/auth/auth.module.ts b/sample/19-auth-jwt/src/auth/auth.module.ts
index 7e853d5b7..9361229eb 100644
--- a/sample/19-auth-jwt/src/auth/auth.module.ts
+++ b/sample/19-auth-jwt/src/auth/auth.module.ts
@@ -1,22 +1,29 @@
 import { Module } from '@nestjs/common';
+import { APP_GUARD } from '@nestjs/core';
 import { JwtModule } from '@nestjs/jwt';
-import { PassportModule } from '@nestjs/passport';
 import { UsersModule } from '../users/users.module';
+import { AuthController } from './auth.controller';
+import { AuthGuard } from './auth.guard';
 import { AuthService } from './auth.service';
 import { jwtConstants } from './constants';
-import { JwtStrategy } from './strategies/jwt.strategy';
-import { LocalStrategy } from './strategies/local.strategy';
 
 @Module({
   imports: [
     UsersModule,
-    PassportModule,
     JwtModule.register({
+      global: true,
       secret: jwtConstants.secret,
       signOptions: { expiresIn: '60s' },
     }),
   ],
-  providers: [AuthService, LocalStrategy, JwtStrategy],
+  providers: [
+    AuthService,
+    {
+      provide: APP_GUARD,
+      useClass: AuthGuard,
+    },
+  ],
+  controllers: [AuthController],
   exports: [AuthService],
 })
 export class AuthModule {}
diff --git a/sample/19-auth-jwt/src/auth/auth.service.spec.ts b/sample/19-auth-jwt/src/auth/auth.service.spec.ts
deleted file mode 100644
index 7f1241107..000000000
--- a/sample/19-auth-jwt/src/auth/auth.service.spec.ts
+++ /dev/null
@@ -1,87 +0,0 @@
-import { JwtModule } from '@nestjs/jwt';
-import { PassportModule } from '@nestjs/passport';
-import { Test, TestingModule } from '@nestjs/testing';
-import { UsersModule } from '../users/users.module';
-import { AuthService } from './auth.service';
-import { jwtConstants } from './constants';
-import { JwtStrategy } from './strategies/jwt.strategy';
-import { LocalStrategy } from './strategies/local.strategy';
-
-describe('AuthService', () => {
-  let service: AuthService;
-
-  beforeEach(async () => {
-    const moduleRef: TestingModule = await Test.createTestingModule({
-      imports: [
-        UsersModule,
-        PassportModule,
-        JwtModule.register({
-          secret: jwtConstants.secret,
-          signOptions: { expiresIn: '60s' },
-        }),
-      ],
-      providers: [AuthService, LocalStrategy, JwtStrategy],
-    }).compile();
-
-    service = moduleRef.get<AuthService>(AuthService);
-  });
-
-  it('should be defined', () => {
-    expect(service).toBeDefined();
-  });
-});
-
-describe('validateUser', () => {
-  let service: AuthService;
-
-  beforeEach(async () => {
-    const moduleRef: TestingModule = await Test.createTestingModule({
-      imports: [
-        UsersModule,
-        PassportModule,
-        JwtModule.register({
-          secret: jwtConstants.secret,
-          signOptions: { expiresIn: '60s' },
-        }),
-      ],
-      providers: [AuthService, LocalStrategy, JwtStrategy],
-    }).compile();
-
-    service = moduleRef.get<AuthService>(AuthService);
-  });
-
-  it('should return a user object when credentials are valid', async () => {
-    const res = await service.validateUser('maria', 'guess');
-    expect(res.userId).toEqual(3);
-  });
-
-  it('should return null when credentials are invalid', async () => {
-    const res = await service.validateUser('xxx', 'xxx');
-    expect(res).toBeNull();
-  });
-});
-
-describe('validateLogin', () => {
-  let service: AuthService;
-
-  beforeEach(async () => {
-    const moduleRef: TestingModule = await Test.createTestingModule({
-      imports: [
-        UsersModule,
-        PassportModule,
-        JwtModule.register({
-          secret: jwtConstants.secret,
-          signOptions: { expiresIn: '60s' },
-        }),
-      ],
-      providers: [AuthService, LocalStrategy, JwtStrategy],
-    }).compile();
-
-    service = moduleRef.get<AuthService>(AuthService);
-  });
-
-  it('should return JWT object when credentials are valid', async () => {
-    const res = await service.login({ username: 'maria', userId: 3 });
-    expect(res.access_token).toBeDefined();
-  });
-});
diff --git a/sample/19-auth-jwt/src/auth/auth.service.ts b/sample/19-auth-jwt/src/auth/auth.service.ts
index c477d52b2..6321d1c3e 100644
--- a/sample/19-auth-jwt/src/auth/auth.service.ts
+++ b/sample/19-auth-jwt/src/auth/auth.service.ts
@@ -1,27 +1,22 @@
-import { Injectable } from '@nestjs/common';
-import { UsersService } from '../users/users.service';
+import { Injectable, UnauthorizedException } from '@nestjs/common';
 import { JwtService } from '@nestjs/jwt';
+import { UsersService } from '../users/users.service';
 
 @Injectable()
 export class AuthService {
   constructor(
-    private readonly usersService: UsersService,
-    private readonly jwtService: JwtService,
+    private usersService: UsersService,
+    private jwtService: JwtService,
   ) {}
 
-  async validateUser(username: string, pass: string): Promise<any> {
+  async signIn(username, pass) {
     const user = await this.usersService.findOne(username);
-    if (user && user.password === pass) {
-      const { password, ...result } = user;
-      return result;
+    if (user?.password !== pass) {
+      throw new UnauthorizedException();
     }
-    return null;
-  }
-
-  async login(user: any) {
     const payload = { username: user.username, sub: user.userId };
     return {
-      access_token: this.jwtService.sign(payload),
+      access_token: await this.jwtService.signAsync(payload),
     };
   }
 }
diff --git a/sample/19-auth-jwt/src/auth/constants.ts b/sample/19-auth-jwt/src/auth/constants.ts
index 8b22f8b64..9e8c4061f 100644
--- a/sample/19-auth-jwt/src/auth/constants.ts
+++ b/sample/19-auth-jwt/src/auth/constants.ts
@@ -1,3 +1,4 @@
 export const jwtConstants = {
-  secret: 'secretKey',
+  secret:
+    'DO NOT USE THIS VALUE. INSTEAD, CREATE A COMPLEX SECRET AND KEEP IT SAFE OUTSIDE OF THE SOURCE CODE.',
 };
diff --git a/sample/19-auth-jwt/src/auth/decorators/public.decorator.ts b/sample/19-auth-jwt/src/auth/decorators/public.decorator.ts
new file mode 100644
index 000000000..b3845e122
--- /dev/null
+++ b/sample/19-auth-jwt/src/auth/decorators/public.decorator.ts
@@ -0,0 +1,4 @@
+import { SetMetadata } from '@nestjs/common';
+
+export const IS_PUBLIC_KEY = 'isPublic';
+export const Public = () => SetMetadata(IS_PUBLIC_KEY, true);
diff --git a/sample/19-auth-jwt/src/auth/guards/jwt-auth.guard.ts b/sample/19-auth-jwt/src/auth/guards/jwt-auth.guard.ts
deleted file mode 100644
index 2155290ed..000000000
--- a/sample/19-auth-jwt/src/auth/guards/jwt-auth.guard.ts
+++ /dev/null
@@ -1,5 +0,0 @@
-import { Injectable } from '@nestjs/common';
-import { AuthGuard } from '@nestjs/passport';
-
-@Injectable()
-export class JwtAuthGuard extends AuthGuard('jwt') {}
diff --git a/sample/19-auth-jwt/src/auth/guards/local-auth.guard.ts b/sample/19-auth-jwt/src/auth/guards/local-auth.guard.ts
deleted file mode 100644
index ccf962b67..000000000
--- a/sample/19-auth-jwt/src/auth/guards/local-auth.guard.ts
+++ /dev/null
@@ -1,5 +0,0 @@
-import { Injectable } from '@nestjs/common';
-import { AuthGuard } from '@nestjs/passport';
-
-@Injectable()
-export class LocalAuthGuard extends AuthGuard('local') {}
diff --git a/sample/19-auth-jwt/src/auth/strategies/jwt.strategy.ts b/sample/19-auth-jwt/src/auth/strategies/jwt.strategy.ts
deleted file mode 100644
index 08524da5a..000000000
--- a/sample/19-auth-jwt/src/auth/strategies/jwt.strategy.ts
+++ /dev/null
@@ -1,19 +0,0 @@
-import { Injectable } from '@nestjs/common';
-import { PassportStrategy } from '@nestjs/passport';
-import { ExtractJwt, Strategy } from 'passport-jwt';
-import { jwtConstants } from '../constants';
-
-@Injectable()
-export class JwtStrategy extends PassportStrategy(Strategy) {
-  constructor() {
-    super({
-      jwtFromRequest: ExtractJwt.fromAuthHeaderAsBearerToken(),
-      ignoreExpiration: false,
-      secretOrKey: jwtConstants.secret,
-    });
-  }
-
-  async validate(payload: any) {
-    return { userId: payload.sub, username: payload.username };
-  }
-}
diff --git a/sample/19-auth-jwt/src/auth/strategies/local.strategy.ts b/sample/19-auth-jwt/src/auth/strategies/local.strategy.ts
deleted file mode 100644
index 79f85280f..000000000
--- a/sample/19-auth-jwt/src/auth/strategies/local.strategy.ts
+++ /dev/null
@@ -1,19 +0,0 @@
-import { Injectable, UnauthorizedException } from '@nestjs/common';
-import { PassportStrategy } from '@nestjs/passport';
-import { Strategy } from 'passport-local';
-import { AuthService } from '../auth.service';
-
-@Injectable()
-export class LocalStrategy extends PassportStrategy(Strategy) {
-  constructor(private readonly authService: AuthService) {
-    super();
-  }
-
-  async validate(username: string, password: string): Promise<any> {
-    const user = await this.authService.validateUser(username, password);
-    if (!user) {
-      throw new UnauthorizedException();
-    }
-    return user;
-  }
-}
diff --git a/sample/19-auth-jwt/src/users/users.service.spec.ts b/sample/19-auth-jwt/src/users/users.service.spec.ts
index 71c5e2da4..62815ba64 100644
--- a/sample/19-auth-jwt/src/users/users.service.spec.ts
+++ b/sample/19-auth-jwt/src/users/users.service.spec.ts
@@ -1,27 +1,18 @@
 import { Test, TestingModule } from '@nestjs/testing';
-import { User, UsersService } from './users.service';
+import { UsersService } from './users.service';
 
 describe('UsersService', () => {
   let service: UsersService;
 
   beforeEach(async () => {
-    const moduleRef: TestingModule = await Test.createTestingModule({
+    const module: TestingModule = await Test.createTestingModule({
       providers: [UsersService],
     }).compile();
 
-    service = moduleRef.get<UsersService>(UsersService);
+    service = module.get<UsersService>(UsersService);
   });
 
   it('should be defined', () => {
     expect(service).toBeDefined();
   });
-  it.each`
-    name      | returnVal
-    ${'john'} | ${{ userId: 1, username: 'john', password: 'changeme' }}
-  `(
-    'should call findOne for $name and return $returnVal',
-    async ({ name, returnVal }: { name: string; returnVal: User }) => {
-      expect(await service.findOne(name)).toEqual(returnVal);
-    },
-  );
 });
diff --git a/sample/19-auth-jwt/src/users/users.service.ts b/sample/19-auth-jwt/src/users/users.service.ts
index f24f26b30..47e5cde7b 100644
--- a/sample/19-auth-jwt/src/users/users.service.ts
+++ b/sample/19-auth-jwt/src/users/users.service.ts
@@ -1,30 +1,22 @@
 import { Injectable } from '@nestjs/common';
 
+// This should be a real class/interface representing a user entity
 export type User = any;
 
 @Injectable()
 export class UsersService {
-  private readonly users: User[];
-
-  constructor() {
-    this.users = [
-      {
-        userId: 1,
-        username: 'john',
-        password: 'changeme',
-      },
-      {
-        userId: 2,
-        username: 'chris',
-        password: 'secret',
-      },
-      {
-        userId: 3,
-        username: 'maria',
-        password: 'guess',
-      },
-    ];
-  }
+  private readonly users = [
+    {
+      userId: 1,
+      username: 'john',
+      password: 'changeme',
+    },
+    {
+      userId: 2,
+      username: 'maria',
+      password: 'guess',
+    },
+  ];
 
   async findOne(username: string): Promise<User | undefined> {
     return this.users.find(user => user.username === username);
diff --git a/sample/19-auth-jwt/tsconfig.json b/sample/19-auth-jwt/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/19-auth-jwt/tsconfig.json
+++ b/sample/19-auth-jwt/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/20-cache/package-lock.json b/sample/20-cache/package-lock.json
index b272da17c..1d13a94a7 100644
Binary files a/sample/20-cache/package-lock.json and b/sample/20-cache/package-lock.json differ
diff --git a/sample/20-cache/package.json b/sample/20-cache/package.json
index b5d3fd84d..392d9c6f8 100644
--- a/sample/20-cache/package.json
+++ b/sample/20-cache/package.json
@@ -19,34 +19,36 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "cache-manager-redis-store": "2.0.0",
-    "class-transformer": "0.4.0",
-    "class-validator": "0.13.2",
+    "@nestjs/cache-manager": "1.0.0",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
+    "cache-manager": "^4.1.0",
+    "class-transformer": "0.5.1",
+    "class-validator": "0.14.0",
     "reflect-metadata": "0.1.13",
-    "rxjs": "7.4.0"
+    "rxjs": "7.5.5"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
+    "@nestjs/cli": "9.0.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
+    "@types/cache-manager": "^4.0.1",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.11",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@types/node": "18.0.3",
+    "@types/supertest": "2.0.12",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.19.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-import": "2.26.0",
+    "jest": "28.1.2",
+    "prettier": "2.7.1",
+    "supertest": "6.2.4",
+    "ts-jest": "28.0.8",
+    "ts-loader": "9.3.1",
+    "ts-node": "10.8.2",
+    "tsconfig-paths": "4.0.0",
+    "typescript": "4.9.5"
   }
 }
diff --git a/sample/20-cache/src/app.controller.ts b/sample/20-cache/src/app.controller.ts
index d2ba94e99..19a3b181f 100644
--- a/sample/20-cache/src/app.controller.ts
+++ b/sample/20-cache/src/app.controller.ts
@@ -1,9 +1,5 @@
-import {
-  CacheInterceptor,
-  Controller,
-  Get,
-  UseInterceptors,
-} from '@nestjs/common';
+import { CacheInterceptor } from '@nestjs/cache-manager';
+import { Controller, Get, UseInterceptors } from '@nestjs/common';
 
 @Controller()
 @UseInterceptors(CacheInterceptor)
diff --git a/sample/20-cache/src/app.module.ts b/sample/20-cache/src/app.module.ts
index a85f2b5fb..310d05226 100644
--- a/sample/20-cache/src/app.module.ts
+++ b/sample/20-cache/src/app.module.ts
@@ -1,4 +1,5 @@
-import { CacheModule, Module } from '@nestjs/common';
+import { CacheModule } from '@nestjs/cache-manager';
+import { Module } from '@nestjs/common';
 import { AppController } from './app.controller';
 
 @Module({
diff --git a/sample/20-cache/src/common/http-cache.interceptor.ts b/sample/20-cache/src/common/http-cache.interceptor.ts
index c0d3638c7..f2bc578ef 100644
--- a/sample/20-cache/src/common/http-cache.interceptor.ts
+++ b/sample/20-cache/src/common/http-cache.interceptor.ts
@@ -1,4 +1,5 @@
-import { CacheInterceptor, ExecutionContext, Injectable } from '@nestjs/common';
+import { CacheInterceptor } from '@nestjs/cache-manager';
+import { ExecutionContext, Injectable } from '@nestjs/common';
 
 @Injectable()
 export class HttpCacheInterceptor extends CacheInterceptor {
diff --git a/sample/20-cache/tsconfig.json b/sample/20-cache/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/20-cache/tsconfig.json
+++ b/sample/20-cache/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/21-serializer/package-lock.json b/sample/21-serializer/package-lock.json
index fcbc30dca..7f568dfb1 100644
Binary files a/sample/21-serializer/package-lock.json and b/sample/21-serializer/package-lock.json differ
diff --git a/sample/21-serializer/package.json b/sample/21-serializer/package.json
index c5fc7bb2c..a06427aee 100644
--- a/sample/21-serializer/package.json
+++ b/sample/21-serializer/package.json
@@ -19,33 +19,33 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "class-transformer": "0.4.0",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
+    "class-transformer": "0.5.1",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "rimraf": "4.4.1",
+    "rxjs": "7.5.5"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
+    "@nestjs/cli": "9.0.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.11",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@types/node": "18.0.3",
+    "@types/supertest": "2.0.12",
+    "jest": "28.1.2",
+    "prettier": "2.7.1",
+    "supertest": "6.2.4",
+    "ts-jest": "28.0.8",
+    "ts-loader": "9.3.1",
+    "ts-node": "10.8.2",
+    "tsconfig-paths": "4.0.0",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.19.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-import": "2.26.0",
+    "typescript": "4.9.5"
   }
 }
diff --git a/sample/21-serializer/tsconfig.json b/sample/21-serializer/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/21-serializer/tsconfig.json
+++ b/sample/21-serializer/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/22-graphql-prisma/.eslintrc.js b/sample/22-graphql-prisma/.eslintrc.js
old mode 100644
new mode 100755
diff --git a/sample/22-graphql-prisma/.gitignore b/sample/22-graphql-prisma/.gitignore
old mode 100644
new mode 100755
index d5c8a57e7..d64fba583
--- a/sample/22-graphql-prisma/.gitignore
+++ b/sample/22-graphql-prisma/.gitignore
@@ -1,104 +1,27 @@
+# dependencies
+/node_modules
 
-# Created by https://www.gitignore.io/api/node,macos,visualstudiocode
+# IDE
+/.idea
+/.awcache
+/.vscode
 
-### macOS ###
-*.DS_Store
-.AppleDouble
-.LSOverride
+# misc
+npm-debug.log
 
-# Icon must end with two \r
-Icon
+# example
+/quick-start
 
-# Thumbnails
-._*
+# tests
+/test
+/coverage
+/.nyc_output
 
-# Files that might appear in the root of a volume
-.DocumentRevisions-V100
-.fseventsd
-.Spotlight-V100
-.TemporaryItems
-.Trashes
-.VolumeIcon.icns
-.com.apple.timemachine.donotpresent
+# dist
+/dist
 
-# Directories potentially created on remote AFP share
-.AppleDB
-.AppleDesktop
-Network Trash Folder
-Temporary Items
-.apdisk
+# database
+prisma/dev.db
 
-### Node ###
-# Logs
-logs
-*.log
-npm-debug.log*
-yarn-debug.log*
-yarn-error.log*
-
-# Runtime data
-pids
-*.pid
-*.seed
-*.pid.lock
-
-# Directory for instrumented libs generated by jscoverage/JSCover
-lib-cov
-
-# Coverage directory used by tools like istanbul
-coverage
-
-# nyc test coverage
-.nyc_output
-
-# Grunt intermediate storage (http://gruntjs.com/creating-plugins#storing-task-files)
-.grunt
-
-# Bower dependency directory (https://bower.io/)
-bower_components
-
-# node-waf configuration
-.lock-wscript
-
-# Compiled binary addons (http://nodejs.org/api/addons.html)
-build/Release
-
-# Dependency directories
-node_modules/
-jspm_packages/
-
-# Typescript v1 declaration files
-typings/
-
-# Optional npm cache directory
-.npm
-
-# Optional eslint cache
-.eslintcache
-
-# Optional REPL history
-.node_repl_history
-
-# Output of 'npm pack'
-*.tgz
-
-# Yarn Integrity file
-.yarn-integrity
-
-# dotenv environment variables file
-.env
-
-### VisualStudioCode ###
-.vscode/*
-!.vscode/settings.json
-!.vscode/tasks.json
-!.vscode/launch.json
-!.vscode/extensions.json
-.history
-
-
-# Target Folder
-dist/
-*.deb
-
-# End of https://www.gitignore.io/api/node,macos,visualstudiocode
+# secrets
+.env
\ No newline at end of file
diff --git a/sample/22-graphql-prisma/.graphqlconfig.yml b/sample/22-graphql-prisma/.graphqlconfig.yml
deleted file mode 100644
index 0ef04dedd..000000000
--- a/sample/22-graphql-prisma/.graphqlconfig.yml
+++ /dev/null
@@ -1,11 +0,0 @@
-projects:
-  database:
-    schemaPath: src/prisma/prisma-types.graphql
-    extensions:
-      endpoints:
-        default: https://eu1.prisma.sh/public-agatepuma-476/my-app/dev
-      codegen:
-        - generator: prisma-binding
-          language: typescript
-          output:
-            binding: src/prisma/prisma.binding.ts
diff --git a/sample/22-graphql-prisma/README.md b/sample/22-graphql-prisma/README.md
new file mode 100755
index 000000000..75c5b827a
--- /dev/null
+++ b/sample/22-graphql-prisma/README.md
@@ -0,0 +1,14 @@
+### Prisma GraphQL schema first sample
+
+This sample project uses sqlite as the relational database. To use a different database, check the [Prisma docs](https://www.prisma.io/docs/getting-started).
+
+### Installation
+
+1. Install dependencies: `npm install`
+2. Generate TypeScript type definitions for the GraphQL schema: `npm run generate:typings`
+3. Create sqlite database and create tables: `npx prisma db push`
+4. Start server: `npm run start:dev`
+
+### Graphql Playground
+
+When the application is running, you can go to [http://localhost:3000/graphql](http://localhost:3000/graphql) to access the GraphQL Playground.  See [here](https://docs.nestjs.com/graphql/quick-start#playground) for more.
\ No newline at end of file
diff --git a/sample/22-graphql-prisma/database/datamodel.graphql b/sample/22-graphql-prisma/database/datamodel.graphql
deleted file mode 100644
index d94e42feb..000000000
--- a/sample/22-graphql-prisma/database/datamodel.graphql
+++ /dev/null
@@ -1,6 +0,0 @@
-type Post {
-  id: ID! @unique @id
-  isPublished: Boolean! @default(value: false)
-  title: String!
-  text: String!
-}
diff --git a/sample/22-graphql-prisma/database/prisma.yml b/sample/22-graphql-prisma/database/prisma.yml
deleted file mode 100644
index 33bd8b9e7..000000000
--- a/sample/22-graphql-prisma/database/prisma.yml
+++ /dev/null
@@ -1,20 +0,0 @@
-# The endpoint of your Prisma API (deployed to a Prisma Sandbox).
-endpoint: https://eu1.prisma.sh/public-agatepuma-476/my-app/dev
-
-# The file containing the definition of your data model.
-datamodel: datamodel.graphql
-
-# Seed your service with initial data based on `seed.graphql`.
-seed:
-  import: seed.graphql
-
-# Download the GraphQL schema of the Prisma API into
-# `src/generated/prisma.graphql` (as specfied in `.graphqlconfig.yml`).
-hooks:
-  post-deploy:
-    - graphql get-schema --project database
-
-# If specified, the `secret` must be used to generate a JWT which is attached
-# to the `Authorization` header of HTTP requests made against the Prisma API.
-# Info: https://www.prisma.io/docs/reference/prisma-api/concepts-utee3eiquo#authentication
-# secret: mysecret123
diff --git a/sample/22-graphql-prisma/database/seed.graphql b/sample/22-graphql-prisma/database/seed.graphql
deleted file mode 100644
index c5c21972f..000000000
--- a/sample/22-graphql-prisma/database/seed.graphql
+++ /dev/null
@@ -1,31 +0,0 @@
-mutation {
-  first: createPost(
-    data: {
-      title: "Hello World üëã"
-      text: "I like turtles."
-      isPublished: true
-    }
-  ) {
-    id
-  }
-
-  second: createPost(
-    data: {
-      title: "Join us at GraphQL Europe üá™üá∫ "
-      text: "Get a 10%-discount with this promo code on graphql-europe.org: gql-boilerplates"
-      isPublished: true
-    }
-  ) {
-    id
-  }
-
-  third: createPost(
-    data: {
-      title: "Solving world hunger"
-      text: "This is a draft..."
-      isPublished: false
-    }
-  ) {
-    id
-  }
-}
diff --git a/sample/22-graphql-prisma/generate-typings.ts b/sample/22-graphql-prisma/generate-typings.ts
new file mode 100755
index 000000000..91f00bd20
--- /dev/null
+++ b/sample/22-graphql-prisma/generate-typings.ts
@@ -0,0 +1,9 @@
+import { GraphQLDefinitionsFactory } from '@nestjs/graphql';
+import { join } from 'path';
+
+const definitionsFactory = new GraphQLDefinitionsFactory();
+definitionsFactory.generate({
+  typePaths: ['./src/**/*.graphql'],
+  path: join(process.cwd(), 'src/graphql.schema.ts'),
+  outputAs: 'class',
+});
diff --git a/sample/22-graphql-prisma/nest-cli.json b/sample/22-graphql-prisma/nest-cli.json
new file mode 100755
index 000000000..89bc59ae9
--- /dev/null
+++ b/sample/22-graphql-prisma/nest-cli.json
@@ -0,0 +1,5 @@
+{
+  "compilerOptions": {
+    "assets": ["**/*.graphql"]
+  }
+}
diff --git a/sample/22-graphql-prisma/nodemon.json b/sample/22-graphql-prisma/nodemon.json
deleted file mode 100644
index cef103d86..000000000
--- a/sample/22-graphql-prisma/nodemon.json
+++ /dev/null
@@ -1,6 +0,0 @@
-{
-  "watch": ["src"],
-  "ext": "ts",
-  "ignore": ["src/**/*.spec.ts", "src/graphql.schema.d.ts"],
-  "exec": "ts-node -r tsconfig-paths/register src/main.ts"
-}
diff --git a/sample/22-graphql-prisma/package-lock.json b/sample/22-graphql-prisma/package-lock.json
index b5d52f6df..8cc786aba 100644
Binary files a/sample/22-graphql-prisma/package-lock.json and b/sample/22-graphql-prisma/package-lock.json differ
diff --git a/sample/22-graphql-prisma/package.json b/sample/22-graphql-prisma/package.json
index 19f093dc9..839c0a723 100644
--- a/sample/22-graphql-prisma/package.json
+++ b/sample/22-graphql-prisma/package.json
@@ -6,6 +6,7 @@
   "scripts": {
     "prebuild": "rimraf dist",
     "build": "nest build",
+    "generate:typings": "ts-node generate-typings.ts",
     "format": "prettier --write \"src/**/*.ts\" \"test/**/*.ts\"",
     "start": "nest start",
     "start:dev": "nest start --watch",
@@ -19,37 +20,42 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/graphql": "9.1.2",
-    "@nestjs/platform-express": "8.2.3",
-    "apollo-server-express": "3.5.0",
-    "graphql": "15.7.2",
-    "graphql-tools": "7.0.5",
-    "prisma-binding": "2.3.16",
+    "@apollo/server": "4.5.0",
+    "@nestjs/apollo": "11.0.4",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/graphql": "11.0.0",
+    "@nestjs/platform-express": "9.3.12",
+    "@prisma/client": "4.11.0",
+    "class-transformer": "0.5.1",
+    "class-validator": "0.14.0",
+    "graphql": "16.6.0",
+    "graphql-subscriptions": "2.0.0",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "rimraf": "4.4.1",
+    "rxjs": "7.8.0"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/node": "16.11.11",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "9.2.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
+    "@types/express": "4.17.17",
+    "@types/node": "18.15.0",
+    "@types/supertest": "2.0.12",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.35.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-import": "2.27.5",
+    "jest": "29.5.0",
+    "prettier": "2.8.4",
+    "prisma": "^4.11.0",
+    "supertest": "6.3.3",
+    "ts-jest": "29.0.5",
+    "ts-loader": "9.4.2",
+    "ts-morph": "17.0.1",
+    "ts-node": "10.9.1",
+    "tsconfig-paths": "4.1.2",
+    "typescript": "4.9.5"
   }
 }
diff --git a/sample/22-graphql-prisma/prisma/schema.prisma b/sample/22-graphql-prisma/prisma/schema.prisma
new file mode 100755
index 000000000..c085f0aee
--- /dev/null
+++ b/sample/22-graphql-prisma/prisma/schema.prisma
@@ -0,0 +1,18 @@
+// This is your Prisma schema file,
+// learn more about it in the docs: https://pris.ly/d/prisma-schema
+
+datasource db {
+  provider = "sqlite"
+  url      = "file:./dev.db"
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+model Post {
+  id          String  @id @default(uuid())
+  title       String
+  text        String
+  isPublished Boolean @default(false)
+}
diff --git a/sample/22-graphql-prisma/src/app.module.ts b/sample/22-graphql-prisma/src/app.module.ts
old mode 100644
new mode 100755
index 616ec9848..b8ea4ccb2
--- a/sample/22-graphql-prisma/src/app.module.ts
+++ b/sample/22-graphql-prisma/src/app.module.ts
@@ -1,16 +1,16 @@
 import { Module } from '@nestjs/common';
 import { GraphQLModule } from '@nestjs/graphql';
-import { GraphqlOptions } from './graphql.options';
 import { PostsModule } from './posts/posts.module';
-import { PrismaModule } from './prisma/prisma.module';
+import { ApolloDriver, ApolloDriverConfig } from '@nestjs/apollo';
 
 @Module({
   imports: [
-    GraphQLModule.forRootAsync({
-      useClass: GraphqlOptions,
-    }),
-    PrismaModule,
     PostsModule,
+    GraphQLModule.forRoot<ApolloDriverConfig>({
+      driver: ApolloDriver,
+      typePaths: ['./**/*.graphql'],
+      installSubscriptionHandlers: true,
+    }),
   ],
 })
 export class AppModule {}
diff --git a/sample/22-graphql-prisma/src/graphql.options.ts b/sample/22-graphql-prisma/src/graphql.options.ts
deleted file mode 100644
index 5de5f64ae..000000000
--- a/sample/22-graphql-prisma/src/graphql.options.ts
+++ /dev/null
@@ -1,21 +0,0 @@
-import { Injectable } from '@nestjs/common';
-import { GqlModuleOptions, GqlOptionsFactory } from '@nestjs/graphql';
-import { join } from 'path';
-
-@Injectable()
-export class GraphqlOptions implements GqlOptionsFactory {
-  createGqlOptions(): Promise<GqlModuleOptions> | GqlModuleOptions {
-    return {
-      typePaths: ['./src/**/*.graphql'],
-      path: '/',
-      installSubscriptionHandlers: true,
-      resolverValidationOptions: {
-        requireResolversForResolveType: 'ignore',
-      },
-      definitions: {
-        path: join(process.cwd(), 'src/graphql.schema.d.ts'),
-        outputAs: 'class',
-      },
-    };
-  }
-}
diff --git a/sample/22-graphql-prisma/src/graphql.schema.d.ts b/sample/22-graphql-prisma/src/graphql.schema.d.ts
deleted file mode 100644
index d818b240e..000000000
--- a/sample/22-graphql-prisma/src/graphql.schema.d.ts
+++ /dev/null
@@ -1,209 +0,0 @@
-/** ------------------------------------------------------
- * THIS FILE WAS AUTOMATICALLY GENERATED (DO NOT MODIFY)
- * -------------------------------------------------------
- */
-
-/* tslint:disable */
-export enum MutationType {
-  CREATED = 'CREATED',
-  UPDATED = 'UPDATED',
-  DELETED = 'DELETED',
-}
-
-export enum PostOrderByInput {
-  id_ASC = 'id_ASC',
-  id_DESC = 'id_DESC',
-  isPublished_ASC = 'isPublished_ASC',
-  isPublished_DESC = 'isPublished_DESC',
-  title_ASC = 'title_ASC',
-  title_DESC = 'title_DESC',
-  text_ASC = 'text_ASC',
-  text_DESC = 'text_DESC',
-}
-
-export class PostCreateInput {
-  id?: string;
-  isPublished?: boolean;
-  title: string;
-  text: string;
-}
-
-export class PostSubscriptionWhereInput {
-  AND?: PostSubscriptionWhereInput[];
-  OR?: PostSubscriptionWhereInput[];
-  NOT?: PostSubscriptionWhereInput[];
-  mutation_in?: MutationType[];
-  updatedFields_contains?: string;
-  updatedFields_contains_every?: string[];
-  updatedFields_contains_some?: string[];
-  node?: PostWhereInput;
-}
-
-export class PostUpdateInput {
-  isPublished?: boolean;
-  title?: string;
-  text?: string;
-}
-
-export class PostUpdateManyMutationInput {
-  isPublished?: boolean;
-  title?: string;
-  text?: string;
-}
-
-export class PostWhereInput {
-  AND?: PostWhereInput[];
-  OR?: PostWhereInput[];
-  NOT?: PostWhereInput[];
-  id?: string;
-  id_not?: string;
-  id_in?: string[];
-  id_not_in?: string[];
-  id_lt?: string;
-  id_lte?: string;
-  id_gt?: string;
-  id_gte?: string;
-  id_contains?: string;
-  id_not_contains?: string;
-  id_starts_with?: string;
-  id_not_starts_with?: string;
-  id_ends_with?: string;
-  id_not_ends_with?: string;
-  isPublished?: boolean;
-  isPublished_not?: boolean;
-  title?: string;
-  title_not?: string;
-  title_in?: string[];
-  title_not_in?: string[];
-  title_lt?: string;
-  title_lte?: string;
-  title_gt?: string;
-  title_gte?: string;
-  title_contains?: string;
-  title_not_contains?: string;
-  title_starts_with?: string;
-  title_not_starts_with?: string;
-  title_ends_with?: string;
-  title_not_ends_with?: string;
-  text?: string;
-  text_not?: string;
-  text_in?: string[];
-  text_not_in?: string[];
-  text_lt?: string;
-  text_lte?: string;
-  text_gt?: string;
-  text_gte?: string;
-  text_contains?: string;
-  text_not_contains?: string;
-  text_starts_with?: string;
-  text_not_starts_with?: string;
-  text_ends_with?: string;
-  text_not_ends_with?: string;
-}
-
-export class PostWhereUniqueInput {
-  id?: string;
-}
-
-export interface Node {
-  id: string;
-}
-
-export class AggregatePost {
-  count: number;
-}
-
-export class BatchPayload {
-  count: Long;
-}
-
-export abstract class IMutation {
-  abstract createPost(data: PostCreateInput): Post | Promise<Post>;
-  abstract updatePost(
-    data: PostUpdateInput,
-    where: PostWhereUniqueInput,
-  ): Post | Promise<Post>;
-  abstract deletePost(where: PostWhereUniqueInput): Post | Promise<Post>;
-  abstract upsertPost(
-    where: PostWhereUniqueInput,
-    create: PostCreateInput,
-    update: PostUpdateInput,
-  ): Post | Promise<Post>;
-  abstract updateManyPosts(
-    data: PostUpdateManyMutationInput,
-    where?: PostWhereInput,
-  ): BatchPayload | Promise<BatchPayload>;
-  abstract deleteManyPosts(
-    where?: PostWhereInput,
-  ): BatchPayload | Promise<BatchPayload>;
-}
-
-export class PageInfo {
-  hasNextPage: boolean;
-  hasPreviousPage: boolean;
-  startCursor?: string;
-  endCursor?: string;
-}
-
-export class Post implements Node {
-  id: string;
-  isPublished: boolean;
-  title: string;
-  text: string;
-}
-
-export class PostConnection {
-  pageInfo: PageInfo;
-  edges: PostEdge[];
-  aggregate: AggregatePost;
-}
-
-export class PostEdge {
-  node: Post;
-  cursor: string;
-}
-
-export class PostPreviousValues {
-  id: string;
-  isPublished: boolean;
-  title: string;
-  text: string;
-}
-
-export class PostSubscriptionPayload {
-  mutation: MutationType;
-  node?: Post;
-  updatedFields?: string[];
-  previousValues?: PostPreviousValues;
-}
-
-export abstract class IQuery {
-  abstract posts(
-    where?: PostWhereInput,
-    orderBy?: PostOrderByInput,
-    skip?: number,
-    after?: string,
-    before?: string,
-    first?: number,
-    last?: number,
-  ): Post[] | Promise<Post[]>;
-  abstract post(where: PostWhereUniqueInput): Post | Promise<Post>;
-  abstract postsConnection(
-    where?: PostWhereInput,
-    orderBy?: PostOrderByInput,
-    skip?: number,
-    after?: string,
-    before?: string,
-    first?: number,
-    last?: number,
-  ): PostConnection | Promise<PostConnection>;
-  abstract node(id: string): Node | Promise<Node>;
-}
-
-export abstract class ISubscription {
-  abstract post(
-    where?: PostSubscriptionWhereInput,
-  ): PostSubscriptionPayload | Promise<PostSubscriptionPayload>;
-}
-
-export type Long = any;
diff --git a/sample/22-graphql-prisma/src/graphql.schema.ts b/sample/22-graphql-prisma/src/graphql.schema.ts
new file mode 100755
index 000000000..38a134f7f
--- /dev/null
+++ b/sample/22-graphql-prisma/src/graphql.schema.ts
@@ -0,0 +1,48 @@
+/*
+ * -------------------------------------------------------
+ * THIS FILE WAS AUTOMATICALLY GENERATED (DO NOT MODIFY)
+ * -------------------------------------------------------
+ */
+
+/* tslint:disable */
+/* eslint-disable */
+export class NewPost {
+  title: string;
+  text: string;
+}
+
+export class UpdatePost {
+  id: string;
+  title?: Nullable<string>;
+  text?: Nullable<string>;
+  isPublished?: Nullable<boolean>;
+}
+
+export class Post {
+  id: string;
+  title: string;
+  text: string;
+  isPublished: boolean;
+}
+
+export abstract class IQuery {
+  abstract posts(): Post[] | Promise<Post[]>;
+
+  abstract post(id: string): Nullable<Post> | Promise<Nullable<Post>>;
+}
+
+export abstract class IMutation {
+  abstract createPost(input: NewPost): Post | Promise<Post>;
+
+  abstract updatePost(
+    input: UpdatePost,
+  ): Nullable<Post> | Promise<Nullable<Post>>;
+
+  abstract deletePost(id: string): Nullable<Post> | Promise<Nullable<Post>>;
+}
+
+export abstract class ISubscription {
+  abstract postCreated(): Nullable<Post> | Promise<Nullable<Post>>;
+}
+
+type Nullable<T> = T | null;
diff --git a/sample/22-graphql-prisma/src/main.ts b/sample/22-graphql-prisma/src/main.ts
old mode 100644
new mode 100755
index e1e10d969..c442b692c
--- a/sample/22-graphql-prisma/src/main.ts
+++ b/sample/22-graphql-prisma/src/main.ts
@@ -1,9 +1,13 @@
+import { ValidationPipe } from '@nestjs/common';
 import { NestFactory } from '@nestjs/core';
 import { AppModule } from './app.module';
 
 async function bootstrap() {
   const app = await NestFactory.create(AppModule);
+  app.useGlobalPipes(new ValidationPipe());
+
   await app.listen(3000);
   console.log(`Application is running on: ${await app.getUrl()}`);
+  console.log(`GraphQL Playground: ${await app.getUrl()}/graphql`);
 }
 bootstrap();
diff --git a/sample/22-graphql-prisma/src/posts/posts.module.ts b/sample/22-graphql-prisma/src/posts/posts.module.ts
old mode 100644
new mode 100755
index a1f53f854..a70df6058
--- a/sample/22-graphql-prisma/src/posts/posts.module.ts
+++ b/sample/22-graphql-prisma/src/posts/posts.module.ts
@@ -1,9 +1,10 @@
 import { Module } from '@nestjs/common';
-import { PrismaModule } from './../prisma/prisma.module';
-import { PostsResolver } from './posts.resolver';
+import { PostsResolvers } from './posts.resolvers';
+import { PostsService } from './posts.service';
+import { PrismaModule } from '../prisma/prisma.module';
 
 @Module({
-  providers: [PostsResolver],
+  providers: [PostsResolvers, PostsService],
   imports: [PrismaModule],
 })
 export class PostsModule {}
diff --git a/sample/22-graphql-prisma/src/posts/posts.resolver.ts b/sample/22-graphql-prisma/src/posts/posts.resolver.ts
deleted file mode 100644
index 303b65dae..000000000
--- a/sample/22-graphql-prisma/src/posts/posts.resolver.ts
+++ /dev/null
@@ -1,56 +0,0 @@
-import {
-  Args,
-  Info,
-  Mutation,
-  Query,
-  Resolver,
-  Subscription,
-} from '@nestjs/graphql';
-import { Post } from '../graphql.schema';
-import { BatchPayload } from '../prisma/prisma.binding';
-import { PrismaService } from '../prisma/prisma.service';
-
-@Resolver()
-export class PostsResolver {
-  constructor(private readonly prisma: PrismaService) {}
-
-  @Query('posts')
-  async getPosts(@Args() args, @Info() info): Promise<Post[]> {
-    return this.prisma.query.posts(args, info);
-  }
-
-  @Query('post')
-  async getPost(@Args() args, @Info() info): Promise<Post> {
-    return this.prisma.query.post(args, info);
-  }
-
-  @Mutation('createPost')
-  async createPost(@Args() args, @Info() info): Promise<Post> {
-    return this.prisma.mutation.createPost(args, info);
-  }
-
-  @Mutation('updatePost')
-  async updatePost(@Args() args, @Info() info): Promise<Post> {
-    return this.prisma.mutation.updatePost(args, info);
-  }
-
-  @Mutation('updateManyPosts')
-  async updateManyPosts(@Args() args, @Info() info): Promise<BatchPayload> {
-    return this.prisma.mutation.updateManyPosts(args, info);
-  }
-
-  @Mutation('deletePost')
-  async deletePost(@Args() args, @Info() info): Promise<Post> {
-    return this.prisma.mutation.deletePost(args, info);
-  }
-
-  @Mutation('deleteManyPosts')
-  async deleteManyPosts(@Args() args, @Info() info): Promise<BatchPayload> {
-    return this.prisma.mutation.deleteManyPosts(args, info);
-  }
-
-  @Subscription('post')
-  onPostMutation(@Args() args, @Info() info) {
-    return this.prisma.subscription.post(args, info);
-  }
-}
diff --git a/sample/22-graphql-prisma/src/posts/posts.resolvers.ts b/sample/22-graphql-prisma/src/posts/posts.resolvers.ts
new file mode 100755
index 000000000..5ecb8c28f
--- /dev/null
+++ b/sample/22-graphql-prisma/src/posts/posts.resolvers.ts
@@ -0,0 +1,43 @@
+import { Resolver, Query, Mutation, Args, Subscription } from '@nestjs/graphql';
+import { PostsService } from './posts.service';
+import { Post, NewPost, UpdatePost } from 'src/graphql.schema';
+import { PubSub } from 'graphql-subscriptions';
+
+const pubSub = new PubSub();
+
+@Resolver('Post')
+export class PostsResolvers {
+  constructor(private readonly postService: PostsService) {}
+
+  @Query('posts')
+  async posts(): Promise<Post[]> {
+    return this.postService.findAll();
+  }
+
+  @Query('post')
+  async post(@Args('id') args: string): Promise<Post> {
+    return this.postService.findOne(args);
+  }
+
+  @Mutation('createPost')
+  async create(@Args('input') args: NewPost): Promise<Post> {
+    const createdPost = await this.postService.create(args);
+    pubSub.publish('postCreated', { postCreated: createdPost });
+    return createdPost;
+  }
+
+  @Mutation('updatePost')
+  async update(@Args('input') args: UpdatePost): Promise<Post> {
+    return this.postService.update(args);
+  }
+
+  @Mutation('deletePost')
+  async delete(@Args('id') args: string): Promise<Post> {
+    return this.postService.delete(args);
+  }
+
+  @Subscription('postCreated')
+  postCreated() {
+    return pubSub.asyncIterator('postCreated');
+  }
+}
diff --git a/sample/22-graphql-prisma/src/posts/posts.service.ts b/sample/22-graphql-prisma/src/posts/posts.service.ts
new file mode 100755
index 000000000..633065a28
--- /dev/null
+++ b/sample/22-graphql-prisma/src/posts/posts.service.ts
@@ -0,0 +1,48 @@
+import { Injectable } from '@nestjs/common';
+import { Post } from '@prisma/client';
+import { NewPost, UpdatePost } from 'src/graphql.schema';
+import { PrismaService } from '../prisma/prisma.service';
+
+@Injectable()
+export class PostsService {
+  constructor(private prisma: PrismaService) {}
+
+  async findOne(id: string): Promise<Post | null> {
+    return this.prisma.post.findUnique({
+      where: {
+        id,
+      },
+    });
+  }
+
+  async findAll(): Promise<Post[]> {
+    return this.prisma.post.findMany({});
+  }
+
+  async create(input: NewPost): Promise<Post> {
+    return this.prisma.post.create({
+      data: input,
+    });
+  }
+
+  async update(params: UpdatePost): Promise<Post> {
+    const { id, ...params_without_id } = params;
+
+    return this.prisma.post.update({
+      where: {
+        id,
+      },
+      data: {
+        ...params_without_id,
+      },
+    });
+  }
+
+  async delete(id: string): Promise<Post> {
+    return this.prisma.post.delete({
+      where: {
+        id,
+      },
+    });
+  }
+}
diff --git a/sample/22-graphql-prisma/src/posts/schema.graphql b/sample/22-graphql-prisma/src/posts/schema.graphql
new file mode 100755
index 000000000..ac00d18f0
--- /dev/null
+++ b/sample/22-graphql-prisma/src/posts/schema.graphql
@@ -0,0 +1,33 @@
+type Post {
+  id: ID!
+  title: String!
+  text: String!
+  isPublished: Boolean!
+}
+
+input NewPost {
+  title: String!
+  text: String!
+}
+
+input UpdatePost {
+  id: ID!
+  title: String
+  text: String
+  isPublished: Boolean
+}
+
+type Query {
+  posts: [Post!]!
+  post(id: ID!): Post
+}
+
+type Mutation {
+  createPost(input: NewPost!): Post!
+  updatePost(input: UpdatePost!): Post
+  deletePost(id: ID!): Post
+}
+
+type Subscription {
+  postCreated: Post
+}
diff --git a/sample/22-graphql-prisma/src/prisma/prisma-types.graphql b/sample/22-graphql-prisma/src/prisma/prisma-types.graphql
deleted file mode 100644
index 36380cf51..000000000
--- a/sample/22-graphql-prisma/src/prisma/prisma-types.graphql
+++ /dev/null
@@ -1,308 +0,0 @@
-# source: https://eu1.prisma.sh/adam-gajzlerowicz-1dadb3/demo/dev
-# timestamp: Sun Jan 26 2020 09:49:46 GMT+0100 (Central European Standard Time)
-
-type AggregatePost {
-  count: Int!
-}
-
-type BatchPayload {
-  """The number of nodes that have been affected by the Batch operation."""
-  count: Long!
-}
-
-"""
-The `Long` scalar type represents non-fractional signed whole numeric values.
-Long can represent values between -(2^63) and 2^63 - 1.
-"""
-scalar Long
-
-type Mutation {
-  createPost(data: PostCreateInput!): Post!
-  updatePost(data: PostUpdateInput!, where: PostWhereUniqueInput!): Post
-  deletePost(where: PostWhereUniqueInput!): Post
-  upsertPost(where: PostWhereUniqueInput!, create: PostCreateInput!, update: PostUpdateInput!): Post!
-  updateManyPosts(data: PostUpdateManyMutationInput!, where: PostWhereInput): BatchPayload!
-  deleteManyPosts(where: PostWhereInput): BatchPayload!
-}
-
-enum MutationType {
-  CREATED
-  UPDATED
-  DELETED
-}
-
-"""An object with an ID"""
-interface Node {
-  """The id of the object."""
-  id: ID!
-}
-
-"""Information about pagination in a connection."""
-type PageInfo {
-  """When paginating forwards, are there more items?"""
-  hasNextPage: Boolean!
-
-  """When paginating backwards, are there more items?"""
-  hasPreviousPage: Boolean!
-
-  """When paginating backwards, the cursor to continue."""
-  startCursor: String
-
-  """When paginating forwards, the cursor to continue."""
-  endCursor: String
-}
-
-type Post implements Node {
-  id: ID!
-  isPublished: Boolean!
-  title: String!
-  text: String!
-}
-
-"""A connection to a list of items."""
-type PostConnection {
-  """Information to aid in pagination."""
-  pageInfo: PageInfo!
-
-  """A list of edges."""
-  edges: [PostEdge]!
-  aggregate: AggregatePost!
-}
-
-input PostCreateInput {
-  id: ID
-  isPublished: Boolean
-  title: String!
-  text: String!
-}
-
-"""An edge in a connection."""
-type PostEdge {
-  """The item at the end of the edge."""
-  node: Post!
-
-  """A cursor for use in pagination."""
-  cursor: String!
-}
-
-enum PostOrderByInput {
-  id_ASC
-  id_DESC
-  isPublished_ASC
-  isPublished_DESC
-  title_ASC
-  title_DESC
-  text_ASC
-  text_DESC
-}
-
-type PostPreviousValues {
-  id: ID!
-  isPublished: Boolean!
-  title: String!
-  text: String!
-}
-
-type PostSubscriptionPayload {
-  mutation: MutationType!
-  node: Post
-  updatedFields: [String!]
-  previousValues: PostPreviousValues
-}
-
-input PostSubscriptionWhereInput {
-  """Logical AND on all given filters."""
-  AND: [PostSubscriptionWhereInput!]
-
-  """Logical OR on all given filters."""
-  OR: [PostSubscriptionWhereInput!]
-
-  """Logical NOT on all given filters combined by AND."""
-  NOT: [PostSubscriptionWhereInput!]
-
-  """The subscription event gets dispatched when it's listed in mutation_in"""
-  mutation_in: [MutationType!]
-
-  """
-  The subscription event gets only dispatched when one of the updated fields names is included in this list
-  """
-  updatedFields_contains: String
-
-  """
-  The subscription event gets only dispatched when all of the field names included in this list have been updated
-  """
-  updatedFields_contains_every: [String!]
-
-  """
-  The subscription event gets only dispatched when some of the field names included in this list have been updated
-  """
-  updatedFields_contains_some: [String!]
-  node: PostWhereInput
-}
-
-input PostUpdateInput {
-  isPublished: Boolean
-  title: String
-  text: String
-}
-
-input PostUpdateManyMutationInput {
-  isPublished: Boolean
-  title: String
-  text: String
-}
-
-input PostWhereInput {
-  """Logical AND on all given filters."""
-  AND: [PostWhereInput!]
-
-  """Logical OR on all given filters."""
-  OR: [PostWhereInput!]
-
-  """Logical NOT on all given filters combined by AND."""
-  NOT: [PostWhereInput!]
-  id: ID
-
-  """All values that are not equal to given value."""
-  id_not: ID
-
-  """All values that are contained in given list."""
-  id_in: [ID!]
-
-  """All values that are not contained in given list."""
-  id_not_in: [ID!]
-
-  """All values less than the given value."""
-  id_lt: ID
-
-  """All values less than or equal the given value."""
-  id_lte: ID
-
-  """All values greater than the given value."""
-  id_gt: ID
-
-  """All values greater than or equal the given value."""
-  id_gte: ID
-
-  """All values containing the given string."""
-  id_contains: ID
-
-  """All values not containing the given string."""
-  id_not_contains: ID
-
-  """All values starting with the given string."""
-  id_starts_with: ID
-
-  """All values not starting with the given string."""
-  id_not_starts_with: ID
-
-  """All values ending with the given string."""
-  id_ends_with: ID
-
-  """All values not ending with the given string."""
-  id_not_ends_with: ID
-  isPublished: Boolean
-
-  """All values that are not equal to given value."""
-  isPublished_not: Boolean
-  title: String
-
-  """All values that are not equal to given value."""
-  title_not: String
-
-  """All values that are contained in given list."""
-  title_in: [String!]
-
-  """All values that are not contained in given list."""
-  title_not_in: [String!]
-
-  """All values less than the given value."""
-  title_lt: String
-
-  """All values less than or equal the given value."""
-  title_lte: String
-
-  """All values greater than the given value."""
-  title_gt: String
-
-  """All values greater than or equal the given value."""
-  title_gte: String
-
-  """All values containing the given string."""
-  title_contains: String
-
-  """All values not containing the given string."""
-  title_not_contains: String
-
-  """All values starting with the given string."""
-  title_starts_with: String
-
-  """All values not starting with the given string."""
-  title_not_starts_with: String
-
-  """All values ending with the given string."""
-  title_ends_with: String
-
-  """All values not ending with the given string."""
-  title_not_ends_with: String
-  text: String
-
-  """All values that are not equal to given value."""
-  text_not: String
-
-  """All values that are contained in given list."""
-  text_in: [String!]
-
-  """All values that are not contained in given list."""
-  text_not_in: [String!]
-
-  """All values less than the given value."""
-  text_lt: String
-
-  """All values less than or equal the given value."""
-  text_lte: String
-
-  """All values greater than the given value."""
-  text_gt: String
-
-  """All values greater than or equal the given value."""
-  text_gte: String
-
-  """All values containing the given string."""
-  text_contains: String
-
-  """All values not containing the given string."""
-  text_not_contains: String
-
-  """All values starting with the given string."""
-  text_starts_with: String
-
-  """All values not starting with the given string."""
-  text_not_starts_with: String
-
-  """All values ending with the given string."""
-  text_ends_with: String
-
-  """All values not ending with the given string."""
-  text_not_ends_with: String
-}
-
-input PostWhereUniqueInput {
-  id: ID
-}
-
-type Query {
-  posts(where: PostWhereInput, orderBy: PostOrderByInput, skip: Int, after: String, before: String, first: Int, last: Int): [Post]!
-  post(where: PostWhereUniqueInput!): Post
-  postsConnection(where: PostWhereInput, orderBy: PostOrderByInput, skip: Int, after: String, before: String, first: Int, last: Int): PostConnection!
-
-  """Fetches an object given its ID"""
-  node(
-    """The ID of an object"""
-    id: ID!
-  ): Node
-}
-
-type Subscription {
-  post(where: PostSubscriptionWhereInput): PostSubscriptionPayload
-}
diff --git a/sample/22-graphql-prisma/src/prisma/prisma.binding.ts b/sample/22-graphql-prisma/src/prisma/prisma.binding.ts
deleted file mode 100644
index a9dbf053a..000000000
--- a/sample/22-graphql-prisma/src/prisma/prisma.binding.ts
+++ /dev/null
@@ -1,629 +0,0 @@
-import { GraphQLResolveInfo, GraphQLSchema } from 'graphql';
-import { Options } from 'graphql-binding';
-import { IResolvers } from 'graphql-tools';
-import { BasePrismaOptions, makePrismaBindingClass } from 'prisma-binding';
-
-export interface Query {
-  posts: <T = Post[]>(
-    args: {
-      where?: PostWhereInput;
-      orderBy?: PostOrderByInput;
-      skip?: Int;
-      after?: String;
-      before?: String;
-      first?: Int;
-      last?: Int;
-    },
-    info?: GraphQLResolveInfo | string,
-    options?: Options,
-  ) => Promise<T>;
-  post: <T = Post | null>(
-    args: { where: PostWhereUniqueInput },
-    info?: GraphQLResolveInfo | string,
-    options?: Options,
-  ) => Promise<T>;
-  postsConnection: <T = PostConnection>(
-    args: {
-      where?: PostWhereInput;
-      orderBy?: PostOrderByInput;
-      skip?: Int;
-      after?: String;
-      before?: String;
-      first?: Int;
-      last?: Int;
-    },
-    info?: GraphQLResolveInfo | string,
-    options?: Options,
-  ) => Promise<T>;
-  node: <T = Node | null>(
-    args: { id: ID_Output },
-    info?: GraphQLResolveInfo | string,
-    options?: Options,
-  ) => Promise<T>;
-}
-
-export interface Mutation {
-  createPost: <T = Post>(
-    args: { data: PostCreateInput },
-    info?: GraphQLResolveInfo | string,
-    options?: Options,
-  ) => Promise<T>;
-  updatePost: <T = Post | null>(
-    args: { data: PostUpdateInput; where: PostWhereUniqueInput },
-    info?: GraphQLResolveInfo | string,
-    options?: Options,
-  ) => Promise<T>;
-  deletePost: <T = Post | null>(
-    args: { where: PostWhereUniqueInput },
-    info?: GraphQLResolveInfo | string,
-    options?: Options,
-  ) => Promise<T>;
-  upsertPost: <T = Post>(
-    args: {
-      where: PostWhereUniqueInput;
-      create: PostCreateInput;
-      update: PostUpdateInput;
-    },
-    info?: GraphQLResolveInfo | string,
-    options?: Options,
-  ) => Promise<T>;
-  updateManyPosts: <T = BatchPayload>(
-    args: { data: PostUpdateInput; where?: PostWhereInput },
-    info?: GraphQLResolveInfo | string,
-    options?: Options,
-  ) => Promise<T>;
-  deleteManyPosts: <T = BatchPayload>(
-    args: { where?: PostWhereInput },
-    info?: GraphQLResolveInfo | string,
-    options?: Options,
-  ) => Promise<T>;
-}
-
-export interface Subscription {
-  post: <T = PostSubscriptionPayload | null>(
-    args: { where?: PostSubscriptionWhereInput },
-    info?: GraphQLResolveInfo | string,
-    options?: Options,
-  ) => Promise<AsyncIterator<T>>;
-}
-
-export interface Exists {
-  Post: (where?: PostWhereInput) => Promise<boolean>;
-}
-
-export interface Prisma {
-  query: Query;
-  mutation: Mutation;
-  subscription: Subscription;
-  exists: Exists;
-  request: <T = any>(
-    query: string,
-    variables?: { [key: string]: any },
-  ) => Promise<T>;
-  delegate(
-    operation: 'query' | 'mutation',
-    fieldName: string,
-    args: {
-      [key: string]: any;
-    },
-    infoOrQuery?: GraphQLResolveInfo | string,
-    options?: Options,
-  ): Promise<any>;
-  delegateSubscription(
-    fieldName: string,
-    args?: {
-      [key: string]: any;
-    },
-    infoOrQuery?: GraphQLResolveInfo | string,
-    options?: Options,
-  ): Promise<AsyncIterator<any>>;
-  getAbstractResolvers(filterSchema?: GraphQLSchema | string): IResolvers;
-}
-
-export interface BindingConstructor<T> {
-  new (options: BasePrismaOptions): T;
-}
-/**
- * Type Defs
- */
-
-const typeDefs = `type AggregatePost {
-  count: Int!
-}
-
-type BatchPayload {
-  """The number of nodes that have been affected by the Batch operation."""
-  count: Long!
-}
-
-"""
-The \`Long\` scalar type represents non-fractional signed whole numeric values.
-Long can represent values between -(2^63) and 2^63 - 1.
-"""
-scalar Long
-
-type Mutation {
-  createPost(data: PostCreateInput!): Post!
-  updatePost(data: PostUpdateInput!, where: PostWhereUniqueInput!): Post
-  deletePost(where: PostWhereUniqueInput!): Post
-  upsertPost(where: PostWhereUniqueInput!, create: PostCreateInput!, update: PostUpdateInput!): Post!
-  updateManyPosts(data: PostUpdateInput!, where: PostWhereInput): BatchPayload!
-  deleteManyPosts(where: PostWhereInput): BatchPayload!
-}
-
-enum MutationType {
-  CREATED
-  UPDATED
-  DELETED
-}
-
-"""An object with an ID"""
-interface Node {
-  """The id of the object."""
-  id: ID!
-}
-
-"""Information about pagination in a connection."""
-type PageInfo {
-  """When paginating forwards, are there more items?"""
-  hasNextPage: Boolean!
-
-  """When paginating backwards, are there more items?"""
-  hasPreviousPage: Boolean!
-
-  """When paginating backwards, the cursor to continue."""
-  startCursor: String
-
-  """When paginating forwards, the cursor to continue."""
-  endCursor: String
-}
-
-type Post implements Node {
-  id: ID!
-  isPublished: Boolean!
-  title: String!
-  text: String!
-}
-
-"""A connection to a list of items."""
-type PostConnection {
-  """Information to aid in pagination."""
-  pageInfo: PageInfo!
-
-  """A list of edges."""
-  edges: [PostEdge]!
-  aggregate: AggregatePost!
-}
-
-input PostCreateInput {
-  isPublished: Boolean
-  title: String!
-  text: String!
-}
-
-"""An edge in a connection."""
-type PostEdge {
-  """The item at the end of the edge."""
-  node: Post!
-
-  """A cursor for use in pagination."""
-  cursor: String!
-}
-
-enum PostOrderByInput {
-  id_ASC
-  id_DESC
-  isPublished_ASC
-  isPublished_DESC
-  title_ASC
-  title_DESC
-  text_ASC
-  text_DESC
-  updatedAt_ASC
-  updatedAt_DESC
-  createdAt_ASC
-  createdAt_DESC
-}
-
-type PostPreviousValues {
-  id: ID!
-  isPublished: Boolean!
-  title: String!
-  text: String!
-}
-
-type PostSubscriptionPayload {
-  mutation: MutationType!
-  node: Post
-  updatedFields: [String!]
-  previousValues: PostPreviousValues
-}
-
-input PostSubscriptionWhereInput {
-  """Logical AND on all given filters."""
-  AND: [PostSubscriptionWhereInput!]
-
-  """Logical OR on all given filters."""
-  OR: [PostSubscriptionWhereInput!]
-
-  """Logical NOT on all given filters combined by AND."""
-  NOT: [PostSubscriptionWhereInput!]
-
-  """
-  The subscription event gets dispatched when it's listed in mutation_in
-  """
-  mutation_in: [MutationType!]
-
-  """
-  The subscription event gets only dispatched when one of the updated fields names is included in this list
-  """
-  updatedFields_contains: String
-
-  """
-  The subscription event gets only dispatched when all of the field names included in this list have been updated
-  """
-  updatedFields_contains_every: [String!]
-
-  """
-  The subscription event gets only dispatched when some of the field names included in this list have been updated
-  """
-  updatedFields_contains_some: [String!]
-  node: PostWhereInput
-}
-
-input PostUpdateInput {
-  isPublished: Boolean
-  title: String
-  text: String
-}
-
-input PostWhereInput {
-  """Logical AND on all given filters."""
-  AND: [PostWhereInput!]
-
-  """Logical OR on all given filters."""
-  OR: [PostWhereInput!]
-
-  """Logical NOT on all given filters combined by AND."""
-  NOT: [PostWhereInput!]
-  id: ID
-
-  """All values that are not equal to given value."""
-  id_not: ID
-
-  """All values that are contained in given list."""
-  id_in: [ID!]
-
-  """All values that are not contained in given list."""
-  id_not_in: [ID!]
-
-  """All values less than the given value."""
-  id_lt: ID
-
-  """All values less than or equal the given value."""
-  id_lte: ID
-
-  """All values greater than the given value."""
-  id_gt: ID
-
-  """All values greater than or equal the given value."""
-  id_gte: ID
-
-  """All values containing the given string."""
-  id_contains: ID
-
-  """All values not containing the given string."""
-  id_not_contains: ID
-
-  """All values starting with the given string."""
-  id_starts_with: ID
-
-  """All values not starting with the given string."""
-  id_not_starts_with: ID
-
-  """All values ending with the given string."""
-  id_ends_with: ID
-
-  """All values not ending with the given string."""
-  id_not_ends_with: ID
-  isPublished: Boolean
-
-  """All values that are not equal to given value."""
-  isPublished_not: Boolean
-  title: String
-
-  """All values that are not equal to given value."""
-  title_not: String
-
-  """All values that are contained in given list."""
-  title_in: [String!]
-
-  """All values that are not contained in given list."""
-  title_not_in: [String!]
-
-  """All values less than the given value."""
-  title_lt: String
-
-  """All values less than or equal the given value."""
-  title_lte: String
-
-  """All values greater than the given value."""
-  title_gt: String
-
-  """All values greater than or equal the given value."""
-  title_gte: String
-
-  """All values containing the given string."""
-  title_contains: String
-
-  """All values not containing the given string."""
-  title_not_contains: String
-
-  """All values starting with the given string."""
-  title_starts_with: String
-
-  """All values not starting with the given string."""
-  title_not_starts_with: String
-
-  """All values ending with the given string."""
-  title_ends_with: String
-
-  """All values not ending with the given string."""
-  title_not_ends_with: String
-  text: String
-
-  """All values that are not equal to given value."""
-  text_not: String
-
-  """All values that are contained in given list."""
-  text_in: [String!]
-
-  """All values that are not contained in given list."""
-  text_not_in: [String!]
-
-  """All values less than the given value."""
-  text_lt: String
-
-  """All values less than or equal the given value."""
-  text_lte: String
-
-  """All values greater than the given value."""
-  text_gt: String
-
-  """All values greater than or equal the given value."""
-  text_gte: String
-
-  """All values containing the given string."""
-  text_contains: String
-
-  """All values not containing the given string."""
-  text_not_contains: String
-
-  """All values starting with the given string."""
-  text_starts_with: String
-
-  """All values not starting with the given string."""
-  text_not_starts_with: String
-
-  """All values ending with the given string."""
-  text_ends_with: String
-
-  """All values not ending with the given string."""
-  text_not_ends_with: String
-}
-
-input PostWhereUniqueInput {
-  id: ID
-}
-
-type Query {
-  posts(where: PostWhereInput, orderBy: PostOrderByInput, skip: Int, after: String, before: String, first: Int, last: Int): [Post]!
-  post(where: PostWhereUniqueInput!): Post
-  postsConnection(where: PostWhereInput, orderBy: PostOrderByInput, skip: Int, after: String, before: String, first: Int, last: Int): PostConnection!
-
-  """Fetches an object given its ID"""
-  node(
-    """The ID of an object"""
-    id: ID!
-  ): Node
-}
-
-type Subscription {
-  post(where: PostSubscriptionWhereInput): PostSubscriptionPayload
-}
-`;
-
-export const Prisma = makePrismaBindingClass<BindingConstructor<Prisma>>({
-  typeDefs,
-});
-
-/**
- * Types
- */
-
-export type PostOrderByInput =
-  | 'id_ASC'
-  | 'id_DESC'
-  | 'isPublished_ASC'
-  | 'isPublished_DESC'
-  | 'title_ASC'
-  | 'title_DESC'
-  | 'text_ASC'
-  | 'text_DESC'
-  | 'updatedAt_ASC'
-  | 'updatedAt_DESC'
-  | 'createdAt_ASC'
-  | 'createdAt_DESC';
-
-export type MutationType = 'CREATED' | 'UPDATED' | 'DELETED';
-
-export interface PostWhereUniqueInput {
-  id?: ID_Input;
-}
-
-export interface PostCreateInput {
-  isPublished?: Boolean;
-  title: String;
-  text: String;
-}
-
-export interface PostUpdateInput {
-  isPublished?: Boolean;
-  title?: String;
-  text?: String;
-}
-
-export interface PostSubscriptionWhereInput {
-  AND?: PostSubscriptionWhereInput[] | PostSubscriptionWhereInput;
-  OR?: PostSubscriptionWhereInput[] | PostSubscriptionWhereInput;
-  NOT?: PostSubscriptionWhereInput[] | PostSubscriptionWhereInput;
-  mutation_in?: MutationType[] | MutationType;
-  updatedFields_contains?: String;
-  updatedFields_contains_every?: String[] | String;
-  updatedFields_contains_some?: String[] | String;
-  node?: PostWhereInput;
-}
-
-export interface PostWhereInput {
-  AND?: PostWhereInput[] | PostWhereInput;
-  OR?: PostWhereInput[] | PostWhereInput;
-  NOT?: PostWhereInput[] | PostWhereInput;
-  id?: ID_Input;
-  id_not?: ID_Input;
-  id_in?: ID_Input[] | ID_Input;
-  id_not_in?: ID_Input[] | ID_Input;
-  id_lt?: ID_Input;
-  id_lte?: ID_Input;
-  id_gt?: ID_Input;
-  id_gte?: ID_Input;
-  id_contains?: ID_Input;
-  id_not_contains?: ID_Input;
-  id_starts_with?: ID_Input;
-  id_not_starts_with?: ID_Input;
-  id_ends_with?: ID_Input;
-  id_not_ends_with?: ID_Input;
-  isPublished?: Boolean;
-  isPublished_not?: Boolean;
-  title?: String;
-  title_not?: String;
-  title_in?: String[] | String;
-  title_not_in?: String[] | String;
-  title_lt?: String;
-  title_lte?: String;
-  title_gt?: String;
-  title_gte?: String;
-  title_contains?: String;
-  title_not_contains?: String;
-  title_starts_with?: String;
-  title_not_starts_with?: String;
-  title_ends_with?: String;
-  title_not_ends_with?: String;
-  text?: String;
-  text_not?: String;
-  text_in?: String[] | String;
-  text_not_in?: String[] | String;
-  text_lt?: String;
-  text_lte?: String;
-  text_gt?: String;
-  text_gte?: String;
-  text_contains?: String;
-  text_not_contains?: String;
-  text_starts_with?: String;
-  text_not_starts_with?: String;
-  text_ends_with?: String;
-  text_not_ends_with?: String;
-}
-
-/*
- * An object with an ID
-
- */
-export interface Node {
-  id: ID_Output;
-}
-
-/*
- * Information about pagination in a connection.
-
- */
-export interface PageInfo {
-  hasNextPage: Boolean;
-  hasPreviousPage: Boolean;
-  startCursor?: String;
-  endCursor?: String;
-}
-
-export interface BatchPayload {
-  count: Long;
-}
-
-export interface PostPreviousValues {
-  id: ID_Output;
-  isPublished: Boolean;
-  title: String;
-  text: String;
-}
-
-/*
- * A connection to a list of items.
-
- */
-export interface PostConnection {
-  pageInfo: PageInfo;
-  edges: PostEdge[];
-  aggregate: AggregatePost;
-}
-
-export interface PostSubscriptionPayload {
-  mutation: MutationType;
-  node?: Post;
-  updatedFields?: String[];
-  previousValues?: PostPreviousValues;
-}
-
-export interface Post extends Node {
-  id: ID_Output;
-  isPublished: Boolean;
-  title: String;
-  text: String;
-}
-
-export interface AggregatePost {
-  count: Int;
-}
-
-/*
- * An edge in a connection.
-
- */
-export interface PostEdge {
-  node: Post;
-  cursor: String;
-}
-
-/*
-The `Boolean` scalar type represents `true` or `false`.
-*/
-export type Boolean = boolean;
-
-/*
-The `String` scalar type represents textual data, represented as UTF-8 character sequences. The String type is most often used by GraphQL to represent free-form human-readable text.
-*/
-export type String = string;
-
-/*
-The `Long` scalar type represents non-fractional signed whole numeric values.
-Long can represent values between -(2^63) and 2^63 - 1.
-*/
-export type Long = string;
-
-/*
-The `ID` scalar type represents a unique identifier, often used to refetch an object or as key for a cache. The ID type appears in a JSON response as a String; however, it is not intended to be human-readable. When expected as an input type, any string (such as `"4"`) or integer (such as `4`) input value will be accepted as an ID.
-*/
-export type ID_Input = string | number;
-export type ID_Output = string;
-
-/*
-The `Int` scalar type represents non-fractional signed whole numeric values. Int can represent values between -(2^31) and 2^31 - 1. 
-*/
-export type Int = number;
diff --git a/sample/22-graphql-prisma/src/prisma/prisma.module.ts b/sample/22-graphql-prisma/src/prisma/prisma.module.ts
old mode 100644
new mode 100755
diff --git a/sample/22-graphql-prisma/src/prisma/prisma.service.ts b/sample/22-graphql-prisma/src/prisma/prisma.service.ts
old mode 100644
new mode 100755
index dc2e22529..edf653202
--- a/sample/22-graphql-prisma/src/prisma/prisma.service.ts
+++ b/sample/22-graphql-prisma/src/prisma/prisma.service.ts
@@ -1,12 +1,15 @@
-import { Injectable } from '@nestjs/common';
-import { Prisma } from './prisma.binding';
+import { INestApplication, Injectable, OnModuleInit } from '@nestjs/common';
+import { PrismaClient } from '@prisma/client';
 
 @Injectable()
-export class PrismaService extends Prisma {
-  constructor() {
-    super({
-      endpoint: 'https://eu1.prisma.sh/public-agatepuma-476/my-app/dev',
-      debug: false,
+export class PrismaService extends PrismaClient implements OnModuleInit {
+  async onModuleInit() {
+    await this.$connect();
+  }
+
+  async enableShutdownHooks(app: INestApplication) {
+    this.$on('beforeExit', async () => {
+      await app.close();
     });
   }
 }
diff --git a/sample/22-graphql-prisma/tsconfig.build.json b/sample/22-graphql-prisma/tsconfig.build.json
old mode 100644
new mode 100755
diff --git a/sample/22-graphql-prisma/tsconfig.json b/sample/22-graphql-prisma/tsconfig.json
old mode 100644
new mode 100755
index e268e37aa..d9c82ca97
--- a/sample/22-graphql-prisma/tsconfig.json
+++ b/sample/22-graphql-prisma/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/23-graphql-code-first/package-lock.json b/sample/23-graphql-code-first/package-lock.json
index 950f277dc..f40dee72a 100644
Binary files a/sample/23-graphql-code-first/package-lock.json and b/sample/23-graphql-code-first/package-lock.json differ
diff --git a/sample/23-graphql-code-first/package.json b/sample/23-graphql-code-first/package.json
index f4f81c6d0..febc762b8 100644
--- a/sample/23-graphql-code-first/package.json
+++ b/sample/23-graphql-code-first/package.json
@@ -19,39 +19,39 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/graphql": "9.1.2",
-    "@nestjs/platform-express": "8.2.3",
-    "apollo-server": "3.5.0",
-    "apollo-server-express": "3.5.0",
-    "class-transformer": "0.4.0",
-    "class-validator": "0.13.2",
-    "graphql": "15.7.2",
-    "graphql-query-complexity": "0.11.0",
+    "@apollo/server": "4.5.0",
+    "@nestjs/apollo": "11.0.4",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/graphql": "11.0.0",
+    "@nestjs/platform-express": "9.3.12",
+    "class-transformer": "0.5.1",
+    "class-validator": "0.14.0",
+    "graphql": "16.6.0",
+    "graphql-query-complexity": "0.12.0",
     "graphql-subscriptions": "2.0.0",
     "reflect-metadata": "0.1.13",
-    "rxjs": "7.4.0"
+    "rxjs": "7.8.0"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/node": "16.11.11",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.4.2"
+    "@nestjs/cli": "9.2.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
+    "@types/express": "4.17.17",
+    "@types/node": "18.15.0",
+    "@types/supertest": "2.0.12",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.35.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-import": "2.27.5",
+    "jest": "29.5.0",
+    "prettier": "2.8.4",
+    "supertest": "6.3.3",
+    "ts-jest": "29.0.5",
+    "ts-loader": "9.4.2",
+    "ts-node": "10.9.1",
+    "tsconfig-paths": "4.1.2",
+    "typescript": "4.9.5"
   }
 }
diff --git a/sample/23-graphql-code-first/schema.gql b/sample/23-graphql-code-first/schema.gql
index 9c1d511de..7a46060d1 100644
--- a/sample/23-graphql-code-first/schema.gql
+++ b/sample/23-graphql-code-first/schema.gql
@@ -2,13 +2,15 @@
 # THIS FILE WAS AUTOMATICALLY GENERATED (DO NOT MODIFY)
 # ------------------------------------------------------
 
+directive @upper on FIELD_DEFINITION
+
 """recipe """
 type Recipe {
   id: ID!
-  title: String!
   description: String
   creationDate: Date!
   ingredients: [String!]!
+  title: String!
 }
 
 """Date custom scalar type"""
@@ -16,7 +18,7 @@ scalar Date
 
 type Query {
   recipe(id: String!): Recipe!
-  recipes(skip: Int = 0, take: Int = 25): [Recipe!]!
+  recipes(skip: Int! = 0, take: Int! = 25): [Recipe!]!
 }
 
 type Mutation {
@@ -32,4 +34,4 @@ input NewRecipeInput {
 
 type Subscription {
   recipeAdded: Recipe!
-}
+}
\ No newline at end of file
diff --git a/sample/23-graphql-code-first/src/app.module.ts b/sample/23-graphql-code-first/src/app.module.ts
index c418f9f79..2b32aa272 100644
--- a/sample/23-graphql-code-first/src/app.module.ts
+++ b/sample/23-graphql-code-first/src/app.module.ts
@@ -1,13 +1,26 @@
+import { ApolloDriver, ApolloDriverConfig } from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
 import { GraphQLModule } from '@nestjs/graphql';
+import { DirectiveLocation, GraphQLDirective } from 'graphql';
+import { upperDirectiveTransformer } from './common/directives/upper-case.directive';
 import { RecipesModule } from './recipes/recipes.module';
 
 @Module({
   imports: [
     RecipesModule,
-    GraphQLModule.forRoot({
-      installSubscriptionHandlers: true,
+    GraphQLModule.forRoot<ApolloDriverConfig>({
+      driver: ApolloDriver,
       autoSchemaFile: 'schema.gql',
+      transformSchema: schema => upperDirectiveTransformer(schema, 'upper'),
+      installSubscriptionHandlers: true,
+      buildSchemaOptions: {
+        directives: [
+          new GraphQLDirective({
+            name: 'upper',
+            locations: [DirectiveLocation.FIELD_DEFINITION],
+          }),
+        ],
+      },
     }),
   ],
 })
diff --git a/sample/23-graphql-code-first/src/common/directives/upper-case.directive.ts b/sample/23-graphql-code-first/src/common/directives/upper-case.directive.ts
index 49341fe8e..52cabe0ef 100644
--- a/sample/23-graphql-code-first/src/common/directives/upper-case.directive.ts
+++ b/sample/23-graphql-code-first/src/common/directives/upper-case.directive.ts
@@ -1,15 +1,32 @@
-import { SchemaDirectiveVisitor } from '@graphql-tools/utils';
-import { defaultFieldResolver, GraphQLField } from 'graphql';
+import { getDirective, MapperKind, mapSchema } from '@graphql-tools/utils';
+import { defaultFieldResolver, GraphQLSchema } from 'graphql';
 
-export class UpperCaseDirective extends SchemaDirectiveVisitor {
-  visitFieldDefinition(field: GraphQLField<any, any>) {
-    const { resolve = defaultFieldResolver } = field;
-    field.resolve = async function (...args) {
-      const result = await resolve.apply(this, args);
-      if (typeof result === 'string') {
-        return result.toUpperCase();
+export function upperDirectiveTransformer(
+  schema: GraphQLSchema,
+  directiveName: string,
+) {
+  return mapSchema(schema, {
+    [MapperKind.OBJECT_FIELD]: fieldConfig => {
+      const upperDirective = getDirective(
+        schema,
+        fieldConfig,
+        directiveName,
+      )?.[0];
+
+      if (upperDirective) {
+        const { resolve = defaultFieldResolver } = fieldConfig;
+
+        // Replace the original resolver with a function that *first* calls
+        // the original resolver, then converts its result to upper case
+        fieldConfig.resolve = async function (source, args, context, info) {
+          const result = await resolve(source, args, context, info);
+          if (typeof result === 'string') {
+            return result.toUpperCase();
+          }
+          return result;
+        };
+        return fieldConfig;
       }
-      return result;
-    };
-  }
+    },
+  });
 }
diff --git a/sample/23-graphql-code-first/src/common/plugins/complexity.plugin.ts b/sample/23-graphql-code-first/src/common/plugins/complexity.plugin.ts
index 86883940e..d7e3699e9 100644
--- a/sample/23-graphql-code-first/src/common/plugins/complexity.plugin.ts
+++ b/sample/23-graphql-code-first/src/common/plugins/complexity.plugin.ts
@@ -1,8 +1,6 @@
-import { GraphQLSchemaHost, Plugin } from '@nestjs/graphql';
-import {
-  ApolloServerPlugin,
-  GraphQLRequestListener,
-} from 'apollo-server-plugin-base';
+import { ApolloServerPlugin, GraphQLRequestListener } from '@apollo/server';
+import { Plugin } from '@nestjs/apollo';
+import { GraphQLSchemaHost } from '@nestjs/graphql';
 import { GraphQLError } from 'graphql';
 import {
   fieldExtensionsEstimator,
@@ -14,7 +12,7 @@ import {
 export class ComplexityPlugin implements ApolloServerPlugin {
   constructor(private gqlSchemaHost: GraphQLSchemaHost) {}
 
-  async requestDidStart(): Promise<GraphQLRequestListener> {
+  async requestDidStart(): Promise<GraphQLRequestListener<any>> {
     const { schema } = this.gqlSchemaHost;
 
     return {
diff --git a/sample/23-graphql-code-first/src/common/plugins/logging.plugin.ts b/sample/23-graphql-code-first/src/common/plugins/logging.plugin.ts
index 8e48e29cb..77c23a96c 100644
--- a/sample/23-graphql-code-first/src/common/plugins/logging.plugin.ts
+++ b/sample/23-graphql-code-first/src/common/plugins/logging.plugin.ts
@@ -1,12 +1,9 @@
-import { Plugin } from '@nestjs/graphql';
-import {
-  ApolloServerPlugin,
-  GraphQLRequestListener,
-} from 'apollo-server-plugin-base';
+import { ApolloServerPlugin, GraphQLRequestListener } from '@apollo/server';
+import { Plugin } from '@nestjs/apollo';
 
 @Plugin()
 export class LoggingPlugin implements ApolloServerPlugin {
-  async requestDidStart(): Promise<GraphQLRequestListener> {
+  async requestDidStart(): Promise<GraphQLRequestListener<any>> {
     console.log('Request started');
     return {
       async willSendResponse() {
diff --git a/sample/23-graphql-code-first/src/recipes/models/recipe.model.ts b/sample/23-graphql-code-first/src/recipes/models/recipe.model.ts
index 2193b2310..ef0a772bc 100644
--- a/sample/23-graphql-code-first/src/recipes/models/recipe.model.ts
+++ b/sample/23-graphql-code-first/src/recipes/models/recipe.model.ts
@@ -1,11 +1,11 @@
-import { Field, ID, ObjectType } from '@nestjs/graphql';
+import { Directive, Field, ID, ObjectType } from '@nestjs/graphql';
 
 @ObjectType({ description: 'recipe ' })
 export class Recipe {
   @Field(type => ID)
   id: string;
 
-  @Field()
+  @Directive('@upper')
   title: string;
 
   @Field({ nullable: true })
diff --git a/sample/23-graphql-code-first/tsconfig.json b/sample/23-graphql-code-first/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/23-graphql-code-first/tsconfig.json
+++ b/sample/23-graphql-code-first/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/24-serve-static/package-lock.json b/sample/24-serve-static/package-lock.json
index 42b8085b2..01d8f21ad 100644
Binary files a/sample/24-serve-static/package-lock.json and b/sample/24-serve-static/package-lock.json differ
diff --git a/sample/24-serve-static/package.json b/sample/24-serve-static/package.json
index 606e4d648..e7f0ec201 100644
--- a/sample/24-serve-static/package.json
+++ b/sample/24-serve-static/package.json
@@ -19,35 +19,35 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/serve-static": "2.2.2",
-    "@nestjs/platform-express": "8.2.3",
-    "class-transformer": "0.4.0",
-    "class-validator": "0.13.2",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/serve-static": "3.0.1",
+    "@nestjs/platform-express": "9.3.12",
+    "class-transformer": "0.5.1",
+    "class-validator": "0.14.0",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "rimraf": "4.4.1",
+    "rxjs": "7.5.5"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
+    "@nestjs/cli": "9.0.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
-    "@types/node": "16.11.11",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@types/node": "18.0.3",
+    "@types/supertest": "2.0.12",
+    "jest": "28.1.2",
+    "prettier": "2.7.1",
+    "supertest": "6.2.4",
+    "ts-jest": "28.0.8",
+    "ts-loader": "9.3.1",
+    "ts-node": "10.8.2",
+    "tsconfig-paths": "4.0.0",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.19.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-import": "2.26.0",
+    "typescript": "4.9.5"
   }
 }
diff --git a/sample/24-serve-static/src/app.module.ts b/sample/24-serve-static/src/app.module.ts
index 3f4864ce5..4fbea3cf2 100644
--- a/sample/24-serve-static/src/app.module.ts
+++ b/sample/24-serve-static/src/app.module.ts
@@ -7,7 +7,7 @@ import { AppController } from './app.controller';
   imports: [
     ServeStaticModule.forRoot({
       rootPath: join(__dirname, '..', 'client'),
-      exclude: ['/api*'],
+      exclude: ['/api/(.*)'],
     }),
   ],
   controllers: [AppController],
diff --git a/sample/24-serve-static/tsconfig.json b/sample/24-serve-static/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/24-serve-static/tsconfig.json
+++ b/sample/24-serve-static/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/25-dynamic-modules/README.md b/sample/25-dynamic-modules/README.md
index a59ef9241..9343fcc8a 100644
--- a/sample/25-dynamic-modules/README.md
+++ b/sample/25-dynamic-modules/README.md
@@ -1,5 +1,5 @@
 <p align="center">
-  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo_text.svg" width="320" alt="Nest Logo" /></a>
+  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
 </p>
 
 [travis-image]: https://api.travis-ci.org/nestjs/nest.svg?branch=master
diff --git a/sample/25-dynamic-modules/package-lock.json b/sample/25-dynamic-modules/package-lock.json
index 249909939..9bb761fd3 100644
Binary files a/sample/25-dynamic-modules/package-lock.json and b/sample/25-dynamic-modules/package-lock.json differ
diff --git a/sample/25-dynamic-modules/package.json b/sample/25-dynamic-modules/package.json
index 3636a758a..337372628 100644
--- a/sample/25-dynamic-modules/package.json
+++ b/sample/25-dynamic-modules/package.json
@@ -19,36 +19,36 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "dotenv": "10.0.0",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
+    "dotenv": "16.0.1",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "rimraf": "4.4.1",
+    "rxjs": "7.5.5"
   },
   "devDependencies": {
     "@types/dotenv": "8.2.0",
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
+    "@nestjs/cli": "9.0.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.11",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@types/jest": "28.1.4",
+    "@types/node": "18.0.3",
+    "@types/supertest": "2.0.12",
+    "jest": "28.1.2",
+    "prettier": "2.7.1",
+    "supertest": "6.2.4",
+    "ts-jest": "28.0.8",
+    "ts-loader": "9.3.1",
+    "ts-node": "10.8.2",
+    "tsconfig-paths": "4.0.0",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.19.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-import": "2.26.0",
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/25-dynamic-modules/tsconfig.json b/sample/25-dynamic-modules/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/25-dynamic-modules/tsconfig.json
+++ b/sample/25-dynamic-modules/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/26-queues/README.md b/sample/26-queues/README.md
index a59ef9241..9343fcc8a 100644
--- a/sample/26-queues/README.md
+++ b/sample/26-queues/README.md
@@ -1,5 +1,5 @@
 <p align="center">
-  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo_text.svg" width="320" alt="Nest Logo" /></a>
+  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
 </p>
 
 [travis-image]: https://api.travis-ci.org/nestjs/nest.svg?branch=master
diff --git a/sample/26-queues/package-lock.json b/sample/26-queues/package-lock.json
index 91f18d919..d432abc4c 100644
Binary files a/sample/26-queues/package-lock.json and b/sample/26-queues/package-lock.json differ
diff --git a/sample/26-queues/package.json b/sample/26-queues/package.json
index adcfafe09..5b1c44d02 100644
--- a/sample/26-queues/package.json
+++ b/sample/26-queues/package.json
@@ -19,39 +19,39 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/bull": "0.4.2",
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "bull": "3.29.3",
-    "dotenv": "10.0.0",
+    "@nestjs/bull": "0.6.3",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
+    "bull": "4.8.4",
+    "dotenv": "16.0.1",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "rimraf": "4.4.1",
+    "rxjs": "7.5.5"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/bull": "3.15.6",
+    "@nestjs/cli": "9.0.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
+    "@types/bull": "3.15.9",
     "@types/dotenv": "8.2.0",
     "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.11",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@types/jest": "28.1.4",
+    "@types/node": "18.0.3",
+    "@types/supertest": "2.0.12",
+    "jest": "28.1.2",
+    "prettier": "2.7.1",
+    "supertest": "6.2.4",
+    "ts-jest": "28.0.8",
+    "ts-loader": "9.3.1",
+    "ts-node": "10.8.2",
+    "tsconfig-paths": "4.0.0",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.19.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-import": "2.26.0",
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/26-queues/tsconfig.json b/sample/26-queues/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/26-queues/tsconfig.json
+++ b/sample/26-queues/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/27-scheduling/README.md b/sample/27-scheduling/README.md
index a59ef9241..9343fcc8a 100644
--- a/sample/27-scheduling/README.md
+++ b/sample/27-scheduling/README.md
@@ -1,5 +1,5 @@
 <p align="center">
-  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo_text.svg" width="320" alt="Nest Logo" /></a>
+  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
 </p>
 
 [travis-image]: https://api.travis-ci.org/nestjs/nest.svg?branch=master
diff --git a/sample/27-scheduling/package-lock.json b/sample/27-scheduling/package-lock.json
index 704437eb2..19e418ab2 100644
Binary files a/sample/27-scheduling/package-lock.json and b/sample/27-scheduling/package-lock.json differ
diff --git a/sample/27-scheduling/package.json b/sample/27-scheduling/package.json
index ef7764c37..4eda6d526 100644
--- a/sample/27-scheduling/package.json
+++ b/sample/27-scheduling/package.json
@@ -19,38 +19,38 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "@nestjs/schedule": "1.0.2",
-    "dotenv": "10.0.0",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
+    "@nestjs/schedule": "2.1.0",
+    "dotenv": "16.0.1",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "rimraf": "4.4.1",
+    "rxjs": "7.5.5"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/bull": "3.15.6",
+    "@nestjs/cli": "9.0.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
+    "@types/bull": "3.15.9",
     "@types/dotenv": "8.2.0",
     "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.11",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@types/jest": "28.1.4",
+    "@types/node": "18.0.3",
+    "@types/supertest": "2.0.12",
+    "jest": "28.1.2",
+    "prettier": "2.7.1",
+    "supertest": "6.2.4",
+    "ts-jest": "28.0.8",
+    "ts-loader": "9.3.1",
+    "ts-node": "10.8.2",
+    "tsconfig-paths": "4.0.0",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.19.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-import": "2.26.0",
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/27-scheduling/tsconfig.json b/sample/27-scheduling/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/27-scheduling/tsconfig.json
+++ b/sample/27-scheduling/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/28-sse/README.md b/sample/28-sse/README.md
index a59ef9241..9343fcc8a 100644
--- a/sample/28-sse/README.md
+++ b/sample/28-sse/README.md
@@ -1,5 +1,5 @@
 <p align="center">
-  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo_text.svg" width="320" alt="Nest Logo" /></a>
+  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
 </p>
 
 [travis-image]: https://api.travis-ci.org/nestjs/nest.svg?branch=master
diff --git a/sample/28-sse/package-lock.json b/sample/28-sse/package-lock.json
index 98d639b81..ca85e404e 100644
Binary files a/sample/28-sse/package-lock.json and b/sample/28-sse/package-lock.json differ
diff --git a/sample/28-sse/package.json b/sample/28-sse/package.json
index 62575d555..5e46008b2 100644
--- a/sample/28-sse/package.json
+++ b/sample/28-sse/package.json
@@ -19,35 +19,35 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "rimraf": "4.4.1",
+    "rxjs": "7.5.5"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
+    "@nestjs/cli": "9.0.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/dotenv": "8.2.0",
     "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.11",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@types/jest": "28.1.4",
+    "@types/node": "18.0.3",
+    "@types/supertest": "2.0.12",
+    "jest": "28.1.2",
+    "prettier": "2.7.1",
+    "supertest": "6.2.4",
+    "ts-jest": "28.0.8",
+    "ts-loader": "9.3.1",
+    "ts-node": "10.8.2",
+    "tsconfig-paths": "4.0.0",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.19.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-import": "2.26.0",
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/28-sse/src/main.ts b/sample/28-sse/src/main.ts
index e1e10d969..4d8008da5 100644
--- a/sample/28-sse/src/main.ts
+++ b/sample/28-sse/src/main.ts
@@ -2,7 +2,10 @@ import { NestFactory } from '@nestjs/core';
 import { AppModule } from './app.module';
 
 async function bootstrap() {
-  const app = await NestFactory.create(AppModule);
+  const app = await NestFactory.create(AppModule, {
+    forceCloseConnections: true,
+  });
+  app.enableShutdownHooks();
   await app.listen(3000);
   console.log(`Application is running on: ${await app.getUrl()}`);
 }
diff --git a/sample/28-sse/tsconfig.json b/sample/28-sse/tsconfig.json
index 4e6e210f1..1bbdea209 100644
--- a/sample/28-sse/tsconfig.json
+++ b/sample/28-sse/tsconfig.json
@@ -5,7 +5,7 @@
     "removeComments": true,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/29-file-upload/e2e/app/app.e2e-spec.ts b/sample/29-file-upload/e2e/app/app.e2e-spec.ts
index 826b5ba8d..6f8bc9034 100644
--- a/sample/29-file-upload/e2e/app/app.e2e-spec.ts
+++ b/sample/29-file-upload/e2e/app/app.e2e-spec.ts
@@ -1,7 +1,6 @@
 import { INestApplication } from '@nestjs/common';
 import { Test } from '@nestjs/testing';
 import { readFileSync } from 'fs';
-import { join } from 'path';
 import * as request from 'supertest';
 import { AppModule } from '../../src/app.module';
 
@@ -30,6 +29,40 @@ describe('E2E FileTest', () => {
       });
   });
 
+  it('should allow for file uploads that pass validation', async () => {
+    return request(app.getHttpServer())
+      .post('/file/pass-validation')
+      .attach('file', './package.json')
+      .field('name', 'test')
+      .expect(201)
+      .expect({
+        body: {
+          name: 'test',
+        },
+        file: readFileSync('./package.json').toString(),
+      });
+  });
+
+  it('should throw for file uploads that do not pass validation', async () => {
+    return request(app.getHttpServer())
+      .post('/file/fail-validation')
+      .attach('file', './package.json')
+      .field('name', 'test')
+      .expect(400);
+  });
+
+  it('should throw when file is required but no file is uploaded', async () => {
+    return request(app.getHttpServer())
+      .post('/file/fail-validation')
+      .expect(400);
+  });
+
+  it('should allow for optional file uploads with validation enabled (fixes #10017)', () => {
+    return request(app.getHttpServer())
+      .post('/file/pass-validation')
+      .expect(201);
+  });
+
   afterAll(async () => {
     await app.close();
   });
diff --git a/sample/29-file-upload/package-lock.json b/sample/29-file-upload/package-lock.json
index 477f91040..2b858006d 100644
Binary files a/sample/29-file-upload/package-lock.json and b/sample/29-file-upload/package-lock.json differ
diff --git a/sample/29-file-upload/package.json b/sample/29-file-upload/package.json
index eb8681b02..88a0effb5 100644
--- a/sample/29-file-upload/package.json
+++ b/sample/29-file-upload/package.json
@@ -19,37 +19,37 @@
     "test:e2e": "jest --config ./e2e/jest-e2e.json"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/platform-express": "8.2.3",
-    "class-transformer": "0.4.0",
-    "class-validator": "0.13.2",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/platform-express": "9.3.12",
+    "class-transformer": "0.5.1",
+    "class-validator": "0.14.0",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "rimraf": "4.4.1",
+    "rxjs": "7.5.5"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
+    "@nestjs/cli": "9.0.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
+    "@types/jest": "28.1.4",
     "@types/multer": "1.4.7",
-    "@types/node": "16.11.11",
-    "@types/supertest": "2.0.11",
-    "jest": "27.3.1",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "typescript": "4.3.5"
+    "@types/node": "18.0.3",
+    "@types/supertest": "2.0.12",
+    "jest": "28.1.2",
+    "prettier": "2.7.1",
+    "supertest": "6.2.4",
+    "ts-jest": "28.0.8",
+    "ts-loader": "9.3.1",
+    "ts-node": "10.8.2",
+    "tsconfig-paths": "4.0.0",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.19.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-import": "2.26.0",
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/29-file-upload/src/app.controller.ts b/sample/29-file-upload/src/app.controller.ts
index dc59cd260..371a1fd69 100644
--- a/sample/29-file-upload/src/app.controller.ts
+++ b/sample/29-file-upload/src/app.controller.ts
@@ -2,6 +2,7 @@ import {
   Body,
   Controller,
   Get,
+  ParseFilePipeBuilder,
   Post,
   UploadedFile,
   UseInterceptors,
@@ -31,4 +32,44 @@ export class AppController {
       file: file.buffer.toString(),
     };
   }
+
+  @UseInterceptors(FileInterceptor('file'))
+  @Post('file/pass-validation')
+  uploadFileAndPassValidation(
+    @Body() body: SampleDto,
+    @UploadedFile(
+      new ParseFilePipeBuilder()
+        .addFileTypeValidator({
+          fileType: 'json',
+        })
+        .build({
+          fileIsRequired: false,
+        }),
+    )
+    file?: Express.Multer.File,
+  ) {
+    return {
+      body,
+      file: file?.buffer.toString(),
+    };
+  }
+
+  @UseInterceptors(FileInterceptor('file'))
+  @Post('file/fail-validation')
+  uploadFileAndFailValidation(
+    @Body() body: SampleDto,
+    @UploadedFile(
+      new ParseFilePipeBuilder()
+        .addFileTypeValidator({
+          fileType: 'jpg',
+        })
+        .build(),
+    )
+    file: Express.Multer.File,
+  ) {
+    return {
+      body,
+      file: file.buffer.toString(),
+    };
+  }
 }
diff --git a/sample/29-file-upload/tsconfig.json b/sample/29-file-upload/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/29-file-upload/tsconfig.json
+++ b/sample/29-file-upload/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/30-event-emitter/package-lock.json b/sample/30-event-emitter/package-lock.json
index 2bbbec935..6808ed49d 100644
Binary files a/sample/30-event-emitter/package-lock.json and b/sample/30-event-emitter/package-lock.json differ
diff --git a/sample/30-event-emitter/package.json b/sample/30-event-emitter/package.json
index 3378b3e56..ae503c037 100644
--- a/sample/30-event-emitter/package.json
+++ b/sample/30-event-emitter/package.json
@@ -19,35 +19,35 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/event-emitter": "1.0.0",
-    "@nestjs/platform-express": "8.2.3",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/event-emitter": "1.2.0",
+    "@nestjs/platform-express": "9.3.12",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0"
+    "rimraf": "4.4.1",
+    "rxjs": "7.5.5"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
+    "@nestjs/cli": "9.0.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
     "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.11",
-    "@types/supertest": "2.0.11",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-import": "2.25.3",
-    "jest": "27.3.1",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "typescript": "4.3.5"
+    "@types/jest": "28.1.4",
+    "@types/node": "18.0.3",
+    "@types/supertest": "2.0.12",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.19.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-import": "2.26.0",
+    "jest": "28.1.2",
+    "prettier": "2.7.1",
+    "supertest": "6.2.4",
+    "ts-jest": "28.0.8",
+    "ts-loader": "9.3.1",
+    "ts-node": "10.8.2",
+    "tsconfig-paths": "4.0.0",
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/30-event-emitter/test/app.e2e-spec.ts b/sample/30-event-emitter/test/app.e2e-spec.ts
index 50cda6233..0136f2d60 100644
--- a/sample/30-event-emitter/test/app.e2e-spec.ts
+++ b/sample/30-event-emitter/test/app.e2e-spec.ts
@@ -21,4 +21,6 @@ describe('AppController (e2e)', () => {
       .expect(200)
       .expect('Hello World!');
   });
+
+  afterEach(() => app.close());
 });
diff --git a/sample/30-event-emitter/tsconfig.json b/sample/30-event-emitter/tsconfig.json
index a0e283732..d670b01d5 100644
--- a/sample/30-event-emitter/tsconfig.json
+++ b/sample/30-event-emitter/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/31-graphql-federation-code-first/README.md b/sample/31-graphql-federation-code-first/README.md
index e7b90c765..bbe0acfd8 100644
--- a/sample/31-graphql-federation-code-first/README.md
+++ b/sample/31-graphql-federation-code-first/README.md
@@ -4,7 +4,7 @@ A simple example of GraphQL Federation using Code First approach.
 
 ## Execution
 
-Make sure to start the two sub-graph applications first, then the gatway. Otherwise the gateway won't be able to fetch schemas from the sub-graphs.
+Make sure to start the two sub-graph applications first, then the gateway. Otherwise the gateway won't be able to fetch schemas from the sub-graphs.
 
 ```sh
 cd users-application && npm run start
diff --git a/sample/31-graphql-federation-code-first/gateway/README.md b/sample/31-graphql-federation-code-first/gateway/README.md
index 9fe8812ff..262b3aaa1 100644
--- a/sample/31-graphql-federation-code-first/gateway/README.md
+++ b/sample/31-graphql-federation-code-first/gateway/README.md
@@ -1,5 +1,5 @@
 <p align="center">
-  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo_text.svg" width="320" alt="Nest Logo" /></a>
+  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
 </p>
 
 [circleci-image]: https://img.shields.io/circleci/build/github/nestjs/nest/master?token=abc123def456
diff --git a/sample/31-graphql-federation-code-first/gateway/package-lock.json b/sample/31-graphql-federation-code-first/gateway/package-lock.json
index 5e620eaac..9f8bf7aae 100644
Binary files a/sample/31-graphql-federation-code-first/gateway/package-lock.json and b/sample/31-graphql-federation-code-first/gateway/package-lock.json differ
diff --git a/sample/31-graphql-federation-code-first/gateway/package.json b/sample/31-graphql-federation-code-first/gateway/package.json
index 9c1f5e6d8..cf98ac931 100644
--- a/sample/31-graphql-federation-code-first/gateway/package.json
+++ b/sample/31-graphql-federation-code-first/gateway/package.json
@@ -21,40 +21,41 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@apollo/gateway": "0.44.1",
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/graphql": "9.1.2",
-    "@nestjs/platform-express": "8.2.3",
-    "apollo-server-express": "3.5.0",
-    "graphql": "15.7.2",
-    "graphql-tools": "7.0.5",
+    "@apollo/gateway": "2.4.0",
+    "@apollo/server": "4.5.0",
+    "@nestjs/apollo": "11.0.4",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/graphql": "11.0.0",
+    "@nestjs/platform-express": "9.3.12",
+    "graphql": "16.6.0",
+    "graphql-tools": "8.3.19",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0",
-    "ts-morph": "12.2.0"
+    "rimraf": "4.4.1",
+    "rxjs": "7.8.0",
+    "ts-morph": "17.0.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.11",
-    "@types/supertest": "2.0.11",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-prettier": "4.0.0",
-    "jest": "27.3.1",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "9.2.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
+    "@types/express": "4.17.17",
+    "@types/jest": "29.4.0",
+    "@types/node": "18.15.0",
+    "@types/supertest": "2.0.12",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.35.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-prettier": "4.2.1",
+    "jest": "29.5.0",
+    "prettier": "2.8.4",
+    "supertest": "6.3.3",
+    "ts-jest": "29.0.5",
+    "ts-loader": "9.4.2",
+    "ts-node": "10.9.1",
+    "tsconfig-paths": "4.1.2",
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/31-graphql-federation-code-first/gateway/src/app.module.ts b/sample/31-graphql-federation-code-first/gateway/src/app.module.ts
index c07abd63e..8c6c39d1e 100644
--- a/sample/31-graphql-federation-code-first/gateway/src/app.module.ts
+++ b/sample/31-graphql-federation-code-first/gateway/src/app.module.ts
@@ -1,19 +1,21 @@
+import { IntrospectAndCompose } from '@apollo/gateway';
+import { ApolloGatewayDriver, ApolloGatewayDriverConfig } from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
+import { GraphQLModule } from '@nestjs/graphql';
 import { AppController } from './app.controller';
 import { AppService } from './app.service';
-import { GraphQLGatewayModule } from '@nestjs/graphql';
 
 @Module({
   imports: [
-    GraphQLGatewayModule.forRoot({
-      server: {
-        cors: true,
-      },
+    GraphQLModule.forRoot<ApolloGatewayDriverConfig>({
+      driver: ApolloGatewayDriver,
       gateway: {
-        serviceList: [
-          { name: 'users', url: 'http://localhost:3000/graphql' },
-          { name: 'posts', url: 'http://localhost:3001/graphql' },
-        ],
+        supergraphSdl: new IntrospectAndCompose({
+          subgraphs: [
+            { name: 'users', url: 'http://localhost:3000/graphql' },
+            { name: 'posts', url: 'http://localhost:3001/graphql' },
+          ],
+        }),
       },
     }),
   ],
diff --git a/sample/31-graphql-federation-code-first/gateway/tsconfig.json b/sample/31-graphql-federation-code-first/gateway/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/31-graphql-federation-code-first/gateway/tsconfig.json
+++ b/sample/31-graphql-federation-code-first/gateway/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/31-graphql-federation-code-first/posts-application/README.md b/sample/31-graphql-federation-code-first/posts-application/README.md
index 9fe8812ff..262b3aaa1 100644
--- a/sample/31-graphql-federation-code-first/posts-application/README.md
+++ b/sample/31-graphql-federation-code-first/posts-application/README.md
@@ -1,5 +1,5 @@
 <p align="center">
-  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo_text.svg" width="320" alt="Nest Logo" /></a>
+  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
 </p>
 
 [circleci-image]: https://img.shields.io/circleci/build/github/nestjs/nest/master?token=abc123def456
diff --git a/sample/31-graphql-federation-code-first/posts-application/package-lock.json b/sample/31-graphql-federation-code-first/posts-application/package-lock.json
index 2acac2e3e..b0c7e5696 100644
Binary files a/sample/31-graphql-federation-code-first/posts-application/package-lock.json and b/sample/31-graphql-federation-code-first/posts-application/package-lock.json differ
diff --git a/sample/31-graphql-federation-code-first/posts-application/package.json b/sample/31-graphql-federation-code-first/posts-application/package.json
index 97d5c10d1..6bcdf34d4 100644
--- a/sample/31-graphql-federation-code-first/posts-application/package.json
+++ b/sample/31-graphql-federation-code-first/posts-application/package.json
@@ -21,42 +21,42 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@apollo/federation": "0.33.8",
-    "@apollo/gateway": "0.44.1",
-    "@apollo/subgraph": "0.1.5",
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/graphql": "9.1.2",
-    "@nestjs/platform-express": "8.2.3",
-    "apollo-server-express": "3.5.0",
-    "graphql": "15.7.2",
-    "graphql-tools": "7.0.5",
+    "@apollo/gateway": "2.4.0",
+    "@apollo/server": "4.5.0",
+    "@apollo/subgraph": "2.4.0",
+    "@nestjs/apollo": "11.0.4",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/graphql": "11.0.0",
+    "@nestjs/platform-express": "9.3.12",
+    "graphql": "16.6.0",
+    "graphql-tools": "8.3.19",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0",
-    "ts-morph": "12.2.0"
+    "rimraf": "4.4.1",
+    "rxjs": "7.8.0",
+    "ts-morph": "17.0.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.11",
-    "@types/supertest": "2.0.11",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-prettier": "4.0.0",
-    "jest": "27.3.1",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "9.2.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
+    "@types/express": "4.17.17",
+    "@types/jest": "29.4.0",
+    "@types/node": "18.15.0",
+    "@types/supertest": "2.0.12",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.35.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-prettier": "4.2.1",
+    "jest": "29.5.0",
+    "prettier": "2.8.4",
+    "supertest": "6.3.3",
+    "ts-jest": "29.0.5",
+    "ts-loader": "9.4.2",
+    "ts-node": "10.9.1",
+    "tsconfig-paths": "4.1.2",
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/31-graphql-federation-code-first/posts-application/src/posts/posts.module.ts b/sample/31-graphql-federation-code-first/posts-application/src/posts/posts.module.ts
index 4ebf3c92f..e2cf306d9 100644
--- a/sample/31-graphql-federation-code-first/posts-application/src/posts/posts.module.ts
+++ b/sample/31-graphql-federation-code-first/posts-application/src/posts/posts.module.ts
@@ -1,5 +1,9 @@
+import {
+  ApolloFederationDriver,
+  ApolloFederationDriverConfig,
+} from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
-import { GraphQLFederationModule } from '@nestjs/graphql';
+import { GraphQLModule } from '@nestjs/graphql';
 import { User } from './models/user.model';
 import { PostsResolver } from './posts.resolver';
 import { PostsService } from './posts.service';
@@ -7,7 +11,8 @@ import { UsersResolver } from './users.resolver';
 
 @Module({
   imports: [
-    GraphQLFederationModule.forRoot({
+    GraphQLModule.forRoot<ApolloFederationDriverConfig>({
+      driver: ApolloFederationDriver,
       autoSchemaFile: true,
       buildSchemaOptions: {
         orphanedTypes: [User],
diff --git a/sample/31-graphql-federation-code-first/posts-application/src/posts/posts.resolver.ts b/sample/31-graphql-federation-code-first/posts-application/src/posts/posts.resolver.ts
index 891f1398a..c66f8dc38 100644
--- a/sample/31-graphql-federation-code-first/posts-application/src/posts/posts.resolver.ts
+++ b/sample/31-graphql-federation-code-first/posts-application/src/posts/posts.resolver.ts
@@ -9,13 +9,14 @@ import {
 import { Post } from './models/post.model';
 import { User } from './models/user.model';
 import { PostsService } from './posts.service';
+import { ParseIntPipe } from '@nestjs/common';
 
 @Resolver((of) => Post)
 export class PostsResolver {
   constructor(private readonly postsService: PostsService) {}
 
   @Query((returns) => Post)
-  post(@Args({ name: 'id', type: () => ID }) id: number): Post {
+  post(@Args({ name: 'id', type: () => ID }, ParseIntPipe) id: number): Post {
     return this.postsService.findOne(id);
   }
 
diff --git a/sample/31-graphql-federation-code-first/posts-application/tsconfig.json b/sample/31-graphql-federation-code-first/posts-application/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/31-graphql-federation-code-first/posts-application/tsconfig.json
+++ b/sample/31-graphql-federation-code-first/posts-application/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/31-graphql-federation-code-first/users-application/README.md b/sample/31-graphql-federation-code-first/users-application/README.md
index 9fe8812ff..262b3aaa1 100644
--- a/sample/31-graphql-federation-code-first/users-application/README.md
+++ b/sample/31-graphql-federation-code-first/users-application/README.md
@@ -1,5 +1,5 @@
 <p align="center">
-  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo_text.svg" width="320" alt="Nest Logo" /></a>
+  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
 </p>
 
 [circleci-image]: https://img.shields.io/circleci/build/github/nestjs/nest/master?token=abc123def456
diff --git a/sample/31-graphql-federation-code-first/users-application/package-lock.json b/sample/31-graphql-federation-code-first/users-application/package-lock.json
index a3c0b6520..0af9f34e7 100644
Binary files a/sample/31-graphql-federation-code-first/users-application/package-lock.json and b/sample/31-graphql-federation-code-first/users-application/package-lock.json differ
diff --git a/sample/31-graphql-federation-code-first/users-application/package.json b/sample/31-graphql-federation-code-first/users-application/package.json
index ac1b7973e..87bfa1797 100644
--- a/sample/31-graphql-federation-code-first/users-application/package.json
+++ b/sample/31-graphql-federation-code-first/users-application/package.json
@@ -20,42 +20,42 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@apollo/federation": "0.33.8",
-    "@apollo/gateway": "0.44.1",
-    "@apollo/subgraph": "0.1.5",
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/graphql": "9.1.2",
-    "@nestjs/platform-express": "8.2.3",
-    "apollo-server-express": "3.5.0",
-    "graphql": "15.7.2",
-    "graphql-tools": "7.0.5",
+    "@apollo/gateway": "2.4.0",
+    "@apollo/server": "4.5.0",
+    "@apollo/subgraph": "2.4.0",
+    "@nestjs/apollo": "11.0.4",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/graphql": "11.0.0",
+    "@nestjs/platform-express": "9.3.12",
+    "graphql": "16.6.0",
+    "graphql-tools": "8.3.19",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0",
-    "ts-morph": "12.2.0"
+    "rimraf": "4.4.1",
+    "rxjs": "7.8.0",
+    "ts-morph": "17.0.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.11",
-    "@types/supertest": "2.0.11",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-prettier": "4.0.0",
-    "jest": "27.3.1",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "9.2.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
+    "@types/express": "4.17.17",
+    "@types/jest": "29.4.0",
+    "@types/node": "18.15.0",
+    "@types/supertest": "2.0.12",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.35.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-prettier": "4.2.1",
+    "jest": "29.5.0",
+    "prettier": "2.8.4",
+    "supertest": "6.3.3",
+    "ts-jest": "29.0.5",
+    "ts-loader": "9.4.2",
+    "ts-node": "10.9.1",
+    "tsconfig-paths": "4.1.2",
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/31-graphql-federation-code-first/users-application/src/users/users.module.ts b/sample/31-graphql-federation-code-first/users-application/src/users/users.module.ts
index f70c88091..fea78661e 100644
--- a/sample/31-graphql-federation-code-first/users-application/src/users/users.module.ts
+++ b/sample/31-graphql-federation-code-first/users-application/src/users/users.module.ts
@@ -1,12 +1,17 @@
+import {
+  ApolloFederationDriver,
+  ApolloFederationDriverConfig,
+} from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
-import { GraphQLFederationModule } from '@nestjs/graphql';
+import { GraphQLModule } from '@nestjs/graphql';
 import { UsersResolver } from './users.resolver';
 import { UsersService } from './users.service';
 
 @Module({
   providers: [UsersResolver, UsersService],
   imports: [
-    GraphQLFederationModule.forRoot({
+    GraphQLModule.forRoot<ApolloFederationDriverConfig>({
+      driver: ApolloFederationDriver,
       autoSchemaFile: true,
     }),
   ],
diff --git a/sample/31-graphql-federation-code-first/users-application/tsconfig.json b/sample/31-graphql-federation-code-first/users-application/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/31-graphql-federation-code-first/users-application/tsconfig.json
+++ b/sample/31-graphql-federation-code-first/users-application/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/32-graphql-federation-schema-first/README.md b/sample/32-graphql-federation-schema-first/README.md
index 1f3fd3dc1..7a0f47a9d 100644
--- a/sample/32-graphql-federation-schema-first/README.md
+++ b/sample/32-graphql-federation-schema-first/README.md
@@ -4,7 +4,7 @@ A simple example of GraphQL Federation using Schema First approach.
 
 ## Execution
 
-Make sure to start the two sub-graph applications first, then the gatway. Otherwise the gateway won't be able to fetch schemas from the sub-graphs.
+Make sure to start the two sub-graph applications first, then the gateway. Otherwise the gateway won't be able to fetch schemas from the sub-graphs.
 
 ```sh
 cd users-application && npm run start
diff --git a/sample/32-graphql-federation-schema-first/gateway/README.md b/sample/32-graphql-federation-schema-first/gateway/README.md
index 9fe8812ff..262b3aaa1 100644
--- a/sample/32-graphql-federation-schema-first/gateway/README.md
+++ b/sample/32-graphql-federation-schema-first/gateway/README.md
@@ -1,5 +1,5 @@
 <p align="center">
-  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo_text.svg" width="320" alt="Nest Logo" /></a>
+  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
 </p>
 
 [circleci-image]: https://img.shields.io/circleci/build/github/nestjs/nest/master?token=abc123def456
diff --git a/sample/32-graphql-federation-schema-first/gateway/package-lock.json b/sample/32-graphql-federation-schema-first/gateway/package-lock.json
index 5e620eaac..9b0805d5d 100644
Binary files a/sample/32-graphql-federation-schema-first/gateway/package-lock.json and b/sample/32-graphql-federation-schema-first/gateway/package-lock.json differ
diff --git a/sample/32-graphql-federation-schema-first/gateway/package.json b/sample/32-graphql-federation-schema-first/gateway/package.json
index 9c1f5e6d8..ff3ff8bf0 100644
--- a/sample/32-graphql-federation-schema-first/gateway/package.json
+++ b/sample/32-graphql-federation-schema-first/gateway/package.json
@@ -21,40 +21,41 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@apollo/gateway": "0.44.1",
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/graphql": "9.1.2",
-    "@nestjs/platform-express": "8.2.3",
-    "apollo-server-express": "3.5.0",
-    "graphql": "15.7.2",
-    "graphql-tools": "7.0.5",
+    "@apollo/gateway": "2.4.0",
+    "@apollo/server": "^4.4.1",
+    "@nestjs/apollo": "11.0.4",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/graphql": "11.0.0",
+    "@nestjs/platform-express": "9.3.12",
+    "graphql": "16.6.0",
+    "graphql-tools": "8.3.19",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0",
-    "ts-morph": "12.2.0"
+    "rimraf": "4.4.1",
+    "rxjs": "7.8.0",
+    "ts-morph": "17.0.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.11",
-    "@types/supertest": "2.0.11",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-prettier": "4.0.0",
-    "jest": "27.3.1",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "9.2.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
+    "@types/express": "4.17.17",
+    "@types/jest": "29.4.0",
+    "@types/node": "18.15.0",
+    "@types/supertest": "2.0.12",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.35.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-prettier": "4.2.1",
+    "jest": "29.5.0",
+    "prettier": "2.8.4",
+    "supertest": "6.3.3",
+    "ts-jest": "29.0.5",
+    "ts-loader": "9.4.2",
+    "ts-node": "10.9.1",
+    "tsconfig-paths": "4.1.2",
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/32-graphql-federation-schema-first/gateway/src/app.module.ts b/sample/32-graphql-federation-schema-first/gateway/src/app.module.ts
index c07abd63e..8c6c39d1e 100644
--- a/sample/32-graphql-federation-schema-first/gateway/src/app.module.ts
+++ b/sample/32-graphql-federation-schema-first/gateway/src/app.module.ts
@@ -1,19 +1,21 @@
+import { IntrospectAndCompose } from '@apollo/gateway';
+import { ApolloGatewayDriver, ApolloGatewayDriverConfig } from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
+import { GraphQLModule } from '@nestjs/graphql';
 import { AppController } from './app.controller';
 import { AppService } from './app.service';
-import { GraphQLGatewayModule } from '@nestjs/graphql';
 
 @Module({
   imports: [
-    GraphQLGatewayModule.forRoot({
-      server: {
-        cors: true,
-      },
+    GraphQLModule.forRoot<ApolloGatewayDriverConfig>({
+      driver: ApolloGatewayDriver,
       gateway: {
-        serviceList: [
-          { name: 'users', url: 'http://localhost:3000/graphql' },
-          { name: 'posts', url: 'http://localhost:3001/graphql' },
-        ],
+        supergraphSdl: new IntrospectAndCompose({
+          subgraphs: [
+            { name: 'users', url: 'http://localhost:3000/graphql' },
+            { name: 'posts', url: 'http://localhost:3001/graphql' },
+          ],
+        }),
       },
     }),
   ],
diff --git a/sample/32-graphql-federation-schema-first/gateway/tsconfig.json b/sample/32-graphql-federation-schema-first/gateway/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/32-graphql-federation-schema-first/gateway/tsconfig.json
+++ b/sample/32-graphql-federation-schema-first/gateway/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/32-graphql-federation-schema-first/posts-application/README.md b/sample/32-graphql-federation-schema-first/posts-application/README.md
index 9fe8812ff..262b3aaa1 100644
--- a/sample/32-graphql-federation-schema-first/posts-application/README.md
+++ b/sample/32-graphql-federation-schema-first/posts-application/README.md
@@ -1,5 +1,5 @@
 <p align="center">
-  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo_text.svg" width="320" alt="Nest Logo" /></a>
+  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
 </p>
 
 [circleci-image]: https://img.shields.io/circleci/build/github/nestjs/nest/master?token=abc123def456
diff --git a/sample/32-graphql-federation-schema-first/posts-application/package-lock.json b/sample/32-graphql-federation-schema-first/posts-application/package-lock.json
index 2acac2e3e..2eefbed12 100644
Binary files a/sample/32-graphql-federation-schema-first/posts-application/package-lock.json and b/sample/32-graphql-federation-schema-first/posts-application/package-lock.json differ
diff --git a/sample/32-graphql-federation-schema-first/posts-application/package.json b/sample/32-graphql-federation-schema-first/posts-application/package.json
index 97d5c10d1..2f071dace 100644
--- a/sample/32-graphql-federation-schema-first/posts-application/package.json
+++ b/sample/32-graphql-federation-schema-first/posts-application/package.json
@@ -21,42 +21,42 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@apollo/federation": "0.33.8",
-    "@apollo/gateway": "0.44.1",
-    "@apollo/subgraph": "0.1.5",
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/graphql": "9.1.2",
-    "@nestjs/platform-express": "8.2.3",
-    "apollo-server-express": "3.5.0",
-    "graphql": "15.7.2",
-    "graphql-tools": "7.0.5",
+    "@apollo/gateway": "2.4.0",
+    "@apollo/server": "^4.4.1",
+    "@apollo/subgraph": "2.4.0",
+    "@nestjs/apollo": "11.0.4",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/graphql": "11.0.0",
+    "@nestjs/platform-express": "9.3.12",
+    "graphql": "16.6.0",
+    "graphql-tools": "8.3.19",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0",
-    "ts-morph": "12.2.0"
+    "rimraf": "4.4.1",
+    "rxjs": "7.8.0",
+    "ts-morph": "17.0.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.11",
-    "@types/supertest": "2.0.11",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-prettier": "4.0.0",
-    "jest": "27.3.1",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "9.2.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
+    "@types/express": "4.17.17",
+    "@types/jest": "29.4.0",
+    "@types/node": "18.15.0",
+    "@types/supertest": "2.0.12",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.35.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-prettier": "4.2.1",
+    "jest": "29.5.0",
+    "prettier": "2.8.4",
+    "supertest": "6.3.3",
+    "ts-jest": "29.0.5",
+    "ts-loader": "9.4.2",
+    "ts-node": "10.9.1",
+    "tsconfig-paths": "4.1.2",
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/32-graphql-federation-schema-first/posts-application/src/posts/posts.module.ts b/sample/32-graphql-federation-schema-first/posts-application/src/posts/posts.module.ts
index 8c34378d7..2254d715d 100644
--- a/sample/32-graphql-federation-schema-first/posts-application/src/posts/posts.module.ts
+++ b/sample/32-graphql-federation-schema-first/posts-application/src/posts/posts.module.ts
@@ -1,12 +1,17 @@
+import {
+  ApolloFederationDriver,
+  ApolloFederationDriverConfig,
+} from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
-import { GraphQLFederationModule } from '@nestjs/graphql';
+import { GraphQLModule } from '@nestjs/graphql';
 import { PostsResolver } from './posts.resolver';
 import { PostsService } from './posts.service';
 import { UsersResolver } from './users.resolver';
 
 @Module({
   imports: [
-    GraphQLFederationModule.forRoot({
+    GraphQLModule.forRoot<ApolloFederationDriverConfig>({
+      driver: ApolloFederationDriver,
       typePaths: ['**/*.graphql'],
     }),
   ],
diff --git a/sample/32-graphql-federation-schema-first/posts-application/tsconfig.json b/sample/32-graphql-federation-schema-first/posts-application/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/32-graphql-federation-schema-first/posts-application/tsconfig.json
+++ b/sample/32-graphql-federation-schema-first/posts-application/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/32-graphql-federation-schema-first/users-application/README.md b/sample/32-graphql-federation-schema-first/users-application/README.md
index 9fe8812ff..262b3aaa1 100644
--- a/sample/32-graphql-federation-schema-first/users-application/README.md
+++ b/sample/32-graphql-federation-schema-first/users-application/README.md
@@ -1,5 +1,5 @@
 <p align="center">
-  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo_text.svg" width="320" alt="Nest Logo" /></a>
+  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="120" alt="Nest Logo" /></a>
 </p>
 
 [circleci-image]: https://img.shields.io/circleci/build/github/nestjs/nest/master?token=abc123def456
diff --git a/sample/32-graphql-federation-schema-first/users-application/package-lock.json b/sample/32-graphql-federation-schema-first/users-application/package-lock.json
index a3c0b6520..4f6f15d4c 100644
Binary files a/sample/32-graphql-federation-schema-first/users-application/package-lock.json and b/sample/32-graphql-federation-schema-first/users-application/package-lock.json differ
diff --git a/sample/32-graphql-federation-schema-first/users-application/package.json b/sample/32-graphql-federation-schema-first/users-application/package.json
index ac1b7973e..0c016b1b6 100644
--- a/sample/32-graphql-federation-schema-first/users-application/package.json
+++ b/sample/32-graphql-federation-schema-first/users-application/package.json
@@ -20,42 +20,42 @@
     "test:e2e": "echo 'No e2e tests implemented yet.'"
   },
   "dependencies": {
-    "@apollo/federation": "0.33.8",
-    "@apollo/gateway": "0.44.1",
-    "@apollo/subgraph": "0.1.5",
-    "@nestjs/common": "8.2.3",
-    "@nestjs/core": "8.2.3",
-    "@nestjs/graphql": "9.1.2",
-    "@nestjs/platform-express": "8.2.3",
-    "apollo-server-express": "3.5.0",
-    "graphql": "15.7.2",
-    "graphql-tools": "7.0.5",
+    "@apollo/gateway": "2.4.0",
+    "@apollo/server": "^4.4.1",
+    "@apollo/subgraph": "2.4.0",
+    "@nestjs/apollo": "11.0.4",
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/graphql": "11.0.0",
+    "@nestjs/platform-express": "9.3.12",
+    "graphql": "16.6.0",
+    "graphql-tools": "8.3.19",
     "reflect-metadata": "0.1.13",
-    "rimraf": "3.0.2",
-    "rxjs": "7.4.0",
-    "ts-morph": "12.2.0"
+    "rimraf": "4.4.1",
+    "rxjs": "7.8.0",
+    "ts-morph": "17.0.1"
   },
   "devDependencies": {
-    "@nestjs/cli": "8.1.5",
-    "@nestjs/schematics": "8.0.5",
-    "@nestjs/testing": "8.2.3",
-    "@types/express": "4.17.13",
-    "@types/jest": "27.0.3",
-    "@types/node": "16.11.11",
-    "@types/supertest": "2.0.11",
-    "@typescript-eslint/eslint-plugin": "4.33.0",
-    "@typescript-eslint/parser": "4.33.0",
-    "eslint": "7.32.0",
-    "eslint-config-prettier": "8.3.0",
-    "eslint-plugin-prettier": "4.0.0",
-    "jest": "27.3.1",
-    "prettier": "2.5.0",
-    "supertest": "6.1.6",
-    "ts-jest": "27.0.7",
-    "ts-loader": "9.2.6",
-    "ts-node": "10.4.0",
-    "tsconfig-paths": "3.11.0",
-    "typescript": "4.3.5"
+    "@nestjs/cli": "9.2.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
+    "@types/express": "4.17.17",
+    "@types/jest": "29.4.0",
+    "@types/node": "18.15.0",
+    "@types/supertest": "2.0.12",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.35.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-prettier": "4.2.1",
+    "jest": "29.5.0",
+    "prettier": "2.8.4",
+    "supertest": "6.3.3",
+    "ts-jest": "29.0.5",
+    "ts-loader": "9.4.2",
+    "ts-node": "10.9.1",
+    "tsconfig-paths": "4.1.2",
+    "typescript": "4.9.5"
   },
   "jest": {
     "moduleFileExtensions": [
diff --git a/sample/32-graphql-federation-schema-first/users-application/src/users/users.module.ts b/sample/32-graphql-federation-schema-first/users-application/src/users/users.module.ts
index e4a70b139..d98abacac 100644
--- a/sample/32-graphql-federation-schema-first/users-application/src/users/users.module.ts
+++ b/sample/32-graphql-federation-schema-first/users-application/src/users/users.module.ts
@@ -1,12 +1,17 @@
+import {
+  ApolloFederationDriver,
+  ApolloFederationDriverConfig,
+} from '@nestjs/apollo';
 import { Module } from '@nestjs/common';
-import { GraphQLFederationModule } from '@nestjs/graphql';
+import { GraphQLModule } from '@nestjs/graphql';
 import { UsersResolver } from './users.resolver';
 import { UsersService } from './users.service';
 
 @Module({
   providers: [UsersResolver, UsersService],
   imports: [
-    GraphQLFederationModule.forRoot({
+    GraphQLModule.forRoot<ApolloFederationDriverConfig>({
+      driver: ApolloFederationDriver,
       typePaths: ['**/*.graphql'],
     }),
   ],
diff --git a/sample/32-graphql-federation-schema-first/users-application/tsconfig.json b/sample/32-graphql-federation-schema-first/users-application/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/sample/32-graphql-federation-schema-first/users-application/tsconfig.json
+++ b/sample/32-graphql-federation-schema-first/users-application/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/sample/33-graphql-mercurius/.eslintrc.js b/sample/33-graphql-mercurius/.eslintrc.js
new file mode 100644
index 000000000..284719548
--- /dev/null
+++ b/sample/33-graphql-mercurius/.eslintrc.js
@@ -0,0 +1,23 @@
+module.exports = {
+  parser: '@typescript-eslint/parser',
+  parserOptions: {
+    project: 'tsconfig.json',
+    sourceType: 'module',
+  },
+  plugins: ['@typescript-eslint/eslint-plugin'],
+  extends: [
+    'plugin:@typescript-eslint/eslint-recommended',
+    'plugin:@typescript-eslint/recommended',
+    'prettier',
+  ],
+  root: true,
+  env: {
+    node: true,
+    jest: true,
+  },
+  rules: {
+    '@typescript-eslint/interface-name-prefix': 'off',
+    '@typescript-eslint/explicit-function-return-type': 'off',
+    '@typescript-eslint/no-explicit-any': 'off',
+  },
+};
diff --git a/sample/33-graphql-mercurius/.gitignore b/sample/33-graphql-mercurius/.gitignore
new file mode 100644
index 000000000..b5e5f9755
--- /dev/null
+++ b/sample/33-graphql-mercurius/.gitignore
@@ -0,0 +1,21 @@
+# dependencies
+/node_modules
+
+# IDE
+/.idea
+/.awcache
+/.vscode
+
+# misc
+npm-debug.log
+
+# example
+/quick-start
+
+# tests
+/test
+/coverage
+/.nyc_output
+
+# dist
+/dist
\ No newline at end of file
diff --git a/sample/33-graphql-mercurius/nest-cli.json b/sample/33-graphql-mercurius/nest-cli.json
new file mode 100644
index 000000000..095fdb25b
--- /dev/null
+++ b/sample/33-graphql-mercurius/nest-cli.json
@@ -0,0 +1,12 @@
+{
+  "compilerOptions": {
+    "plugins": [
+      {
+        "name": "@nestjs/graphql",
+        "options": {
+          "introspectComments": true
+        }
+      }
+    ]
+  }
+}
diff --git a/sample/33-graphql-mercurius/package-lock.json b/sample/33-graphql-mercurius/package-lock.json
new file mode 100644
index 000000000..c0711430a
Binary files /dev/null and b/sample/33-graphql-mercurius/package-lock.json differ
diff --git a/sample/33-graphql-mercurius/package.json b/sample/33-graphql-mercurius/package.json
new file mode 100644
index 000000000..b05ea311d
--- /dev/null
+++ b/sample/33-graphql-mercurius/package.json
@@ -0,0 +1,55 @@
+{
+  "name": "nest-typescript-starter",
+  "version": "1.0.0",
+  "description": "Nest TypeScript starter repository",
+  "license": "MIT",
+  "scripts": {
+    "prebuild": "rimraf dist",
+    "build": "nest build",
+    "format": "prettier --write \"src/**/*.ts\" \"test/**/*.ts\"",
+    "start": "nest start",
+    "start:dev": "nest start --watch",
+    "start:debug": "nest start --debug --watch",
+    "start:prod": "node dist/main",
+    "lint": "eslint '{src,apps,libs,test}/**/*.ts' --fix",
+    "test": "jest",
+    "test:watch": "jest --watch",
+    "test:cov": "jest --coverage",
+    "test:debug": "node --inspect-brk -r tsconfig-paths/register -r ts-node/register node_modules/.bin/jest --runInBand",
+    "test:e2e": "echo 'No e2e tests implemented yet.'"
+  },
+  "dependencies": {
+    "@nestjs/common": "9.3.12",
+    "@nestjs/core": "9.3.12",
+    "@nestjs/graphql": "10.0.18",
+    "@nestjs/mercurius": "10.0.17",
+    "@nestjs/platform-fastify": "9.3.12",
+    "class-transformer": "0.5.1",
+    "class-validator": "0.14.0",
+    "graphql": "16.5.0",
+    "mercurius": "12.2.0",
+    "reflect-metadata": "0.1.13",
+    "rxjs": "7.5.5"
+  },
+  "devDependencies": {
+    "@nestjs/cli": "9.0.0",
+    "@nestjs/schematics": "9.0.4",
+    "@nestjs/testing": "9.3.12",
+    "@types/express": "4.17.13",
+    "@types/node": "18.0.3",
+    "@types/supertest": "2.0.12",
+    "jest": "28.1.2",
+    "prettier": "2.7.1",
+    "supertest": "6.2.4",
+    "ts-jest": "28.0.8",
+    "ts-loader": "9.3.1",
+    "ts-node": "10.8.2",
+    "tsconfig-paths": "4.0.0",
+    "@typescript-eslint/eslint-plugin": "5.56.0",
+    "@typescript-eslint/parser": "5.56.0",
+    "eslint": "8.19.0",
+    "eslint-config-prettier": "8.8.0",
+    "eslint-plugin-import": "2.26.0",
+    "typescript": "4.9.5"
+  }
+}
diff --git a/sample/33-graphql-mercurius/schema.gql b/sample/33-graphql-mercurius/schema.gql
new file mode 100644
index 000000000..e11c56434
--- /dev/null
+++ b/sample/33-graphql-mercurius/schema.gql
@@ -0,0 +1,35 @@
+# ------------------------------------------------------
+# THIS FILE WAS AUTOMATICALLY GENERATED (DO NOT MODIFY)
+# ------------------------------------------------------
+
+"""recipe """
+type Recipe {
+  id: ID!
+  title: String!
+  description: String
+  creationDate: Date!
+  ingredients: [String!]!
+}
+
+"""Date custom scalar type"""
+scalar Date
+
+type Query {
+  recipe(id: String!): Recipe!
+  recipes(skip: Int = 0, take: Int = 25): [Recipe!]!
+}
+
+type Mutation {
+  addRecipe(newRecipeData: NewRecipeInput!): Recipe!
+  removeRecipe(id: String!): Boolean!
+}
+
+input NewRecipeInput {
+  title: String!
+  description: String
+  ingredients: [String!]!
+}
+
+type Subscription {
+  recipeAdded: Recipe!
+}
\ No newline at end of file
diff --git a/sample/33-graphql-mercurius/src/app.module.ts b/sample/33-graphql-mercurius/src/app.module.ts
new file mode 100644
index 000000000..53cc6458e
--- /dev/null
+++ b/sample/33-graphql-mercurius/src/app.module.ts
@@ -0,0 +1,17 @@
+import { Module } from '@nestjs/common';
+import { GraphQLModule } from '@nestjs/graphql';
+import { MercuriusDriver, MercuriusDriverConfig } from '@nestjs/mercurius';
+import { RecipesModule } from './recipes/recipes.module';
+
+@Module({
+  imports: [
+    RecipesModule,
+    GraphQLModule.forRoot<MercuriusDriverConfig>({
+      driver: MercuriusDriver,
+      autoSchemaFile: 'schema.gql',
+      subscription: true,
+      graphiql: true,
+    }),
+  ],
+})
+export class AppModule {}
diff --git a/sample/33-graphql-mercurius/src/common/scalars/date.scalar.ts b/sample/33-graphql-mercurius/src/common/scalars/date.scalar.ts
new file mode 100644
index 000000000..38290dcc8
--- /dev/null
+++ b/sample/33-graphql-mercurius/src/common/scalars/date.scalar.ts
@@ -0,0 +1,22 @@
+import { CustomScalar, Scalar } from '@nestjs/graphql';
+import { Kind, ValueNode } from 'graphql';
+
+@Scalar('Date', type => Date)
+export class DateScalar implements CustomScalar<number, Date> {
+  description = 'Date custom scalar type';
+
+  parseValue(value: number): Date {
+    return new Date(value); // value from the client
+  }
+
+  serialize(value: Date): number {
+    return value.getTime(); // value sent to the client
+  }
+
+  parseLiteral(ast: ValueNode): Date {
+    if (ast.kind === Kind.INT) {
+      return new Date(ast.value);
+    }
+    return null;
+  }
+}
diff --git a/sample/33-graphql-mercurius/src/main.ts b/sample/33-graphql-mercurius/src/main.ts
new file mode 100644
index 000000000..8e7886667
--- /dev/null
+++ b/sample/33-graphql-mercurius/src/main.ts
@@ -0,0 +1,13 @@
+import { ValidationPipe } from '@nestjs/common';
+import { NestFactory } from '@nestjs/core';
+import { FastifyAdapter } from '@nestjs/platform-fastify';
+import { AppModule } from './app.module';
+
+async function bootstrap() {
+  const app = await NestFactory.create(AppModule, new FastifyAdapter());
+  app.useGlobalPipes(new ValidationPipe());
+
+  await app.listen(3000);
+  console.log(`Application is running on: ${await app.getUrl()}`);
+}
+bootstrap();
diff --git a/sample/33-graphql-mercurius/src/recipes/dto/new-recipe.input.ts b/sample/33-graphql-mercurius/src/recipes/dto/new-recipe.input.ts
new file mode 100644
index 000000000..79645888c
--- /dev/null
+++ b/sample/33-graphql-mercurius/src/recipes/dto/new-recipe.input.ts
@@ -0,0 +1,17 @@
+import { Field, InputType } from '@nestjs/graphql';
+import { IsOptional, Length, MaxLength } from 'class-validator';
+
+@InputType()
+export class NewRecipeInput {
+  @Field()
+  @MaxLength(30)
+  title: string;
+
+  @Field({ nullable: true })
+  @IsOptional()
+  @Length(30, 255)
+  description?: string;
+
+  @Field(type => [String])
+  ingredients: string[];
+}
diff --git a/sample/33-graphql-mercurius/src/recipes/dto/recipes.args.ts b/sample/33-graphql-mercurius/src/recipes/dto/recipes.args.ts
new file mode 100644
index 000000000..9bce0582f
--- /dev/null
+++ b/sample/33-graphql-mercurius/src/recipes/dto/recipes.args.ts
@@ -0,0 +1,14 @@
+import { ArgsType, Field, Int } from '@nestjs/graphql';
+import { Max, Min } from 'class-validator';
+
+@ArgsType()
+export class RecipesArgs {
+  @Field(type => Int)
+  @Min(0)
+  skip = 0;
+
+  @Field(type => Int)
+  @Min(1)
+  @Max(50)
+  take = 25;
+}
diff --git a/sample/33-graphql-mercurius/src/recipes/models/recipe.model.ts b/sample/33-graphql-mercurius/src/recipes/models/recipe.model.ts
new file mode 100644
index 000000000..2193b2310
--- /dev/null
+++ b/sample/33-graphql-mercurius/src/recipes/models/recipe.model.ts
@@ -0,0 +1,19 @@
+import { Field, ID, ObjectType } from '@nestjs/graphql';
+
+@ObjectType({ description: 'recipe ' })
+export class Recipe {
+  @Field(type => ID)
+  id: string;
+
+  @Field()
+  title: string;
+
+  @Field({ nullable: true })
+  description?: string;
+
+  @Field()
+  creationDate: Date;
+
+  @Field(type => [String])
+  ingredients: string[];
+}
diff --git a/sample/33-graphql-mercurius/src/recipes/recipes.module.ts b/sample/33-graphql-mercurius/src/recipes/recipes.module.ts
new file mode 100644
index 000000000..fd2d2cc95
--- /dev/null
+++ b/sample/33-graphql-mercurius/src/recipes/recipes.module.ts
@@ -0,0 +1,9 @@
+import { Module } from '@nestjs/common';
+import { DateScalar } from '../common/scalars/date.scalar';
+import { RecipesResolver } from './recipes.resolver';
+import { RecipesService } from './recipes.service';
+
+@Module({
+  providers: [RecipesResolver, RecipesService, DateScalar],
+})
+export class RecipesModule {}
diff --git a/sample/33-graphql-mercurius/src/recipes/recipes.resolver.ts b/sample/33-graphql-mercurius/src/recipes/recipes.resolver.ts
new file mode 100644
index 000000000..5b42038fc
--- /dev/null
+++ b/sample/33-graphql-mercurius/src/recipes/recipes.resolver.ts
@@ -0,0 +1,53 @@
+import { NotFoundException } from '@nestjs/common';
+import {
+  Args,
+  Context,
+  Mutation,
+  Query,
+  Resolver,
+  Subscription,
+} from '@nestjs/graphql';
+import { PubSub } from 'mercurius';
+import { NewRecipeInput } from './dto/new-recipe.input';
+import { RecipesArgs } from './dto/recipes.args';
+import { Recipe } from './models/recipe.model';
+import { RecipesService } from './recipes.service';
+
+@Resolver(of => Recipe)
+export class RecipesResolver {
+  constructor(private readonly recipesService: RecipesService) {}
+
+  @Query(returns => Recipe)
+  async recipe(@Args('id') id: string): Promise<Recipe> {
+    const recipe = await this.recipesService.findOneById(id);
+    if (!recipe) {
+      throw new NotFoundException(id);
+    }
+    return recipe;
+  }
+
+  @Query(returns => [Recipe])
+  recipes(@Args() recipesArgs: RecipesArgs): Promise<Recipe[]> {
+    return this.recipesService.findAll(recipesArgs);
+  }
+
+  @Mutation(returns => Recipe)
+  async addRecipe(
+    @Args('newRecipeData') newRecipeData: NewRecipeInput,
+    @Context('pubsub') pubSub: PubSub,
+  ): Promise<Recipe> {
+    const recipe = await this.recipesService.create(newRecipeData);
+    pubSub.publish({ topic: 'recipeAdded', payload: { recipeAdded: recipe } });
+    return recipe;
+  }
+
+  @Mutation(returns => Boolean)
+  async removeRecipe(@Args('id') id: string) {
+    return this.recipesService.remove(id);
+  }
+
+  @Subscription(returns => Recipe)
+  recipeAdded(@Context('pubsub') pubSub: PubSub) {
+    return pubSub.subscribe('recipeAdded');
+  }
+}
diff --git a/sample/33-graphql-mercurius/src/recipes/recipes.service.ts b/sample/33-graphql-mercurius/src/recipes/recipes.service.ts
new file mode 100644
index 000000000..a4d6428eb
--- /dev/null
+++ b/sample/33-graphql-mercurius/src/recipes/recipes.service.ts
@@ -0,0 +1,29 @@
+import { Injectable } from '@nestjs/common';
+import { NewRecipeInput } from './dto/new-recipe.input';
+import { RecipesArgs } from './dto/recipes.args';
+import { Recipe } from './models/recipe.model';
+
+@Injectable()
+export class RecipesService {
+  /**
+   * MOCK
+   * Put some real business logic here
+   * Left for demonstration purposes
+   */
+
+  async create(data: NewRecipeInput): Promise<Recipe> {
+    return {} as any;
+  }
+
+  async findOneById(id: string): Promise<Recipe> {
+    return {} as any;
+  }
+
+  async findAll(recipesArgs: RecipesArgs): Promise<Recipe[]> {
+    return [] as Recipe[];
+  }
+
+  async remove(id: string): Promise<boolean> {
+    return true;
+  }
+}
diff --git a/sample/33-graphql-mercurius/tsconfig.build.json b/sample/33-graphql-mercurius/tsconfig.build.json
new file mode 100644
index 000000000..2fe1df273
--- /dev/null
+++ b/sample/33-graphql-mercurius/tsconfig.build.json
@@ -0,0 +1,4 @@
+{
+  "extends": "./tsconfig.json",
+  "exclude": ["node_modules", "dist", "test", "**/*spec.ts"]
+}
diff --git a/integration/testing-module-override/tsconfig.json b/sample/33-graphql-mercurius/tsconfig.json
similarity index 93%
rename from integration/testing-module-override/tsconfig.json
rename to sample/33-graphql-mercurius/tsconfig.json
index e268e37aa..d9c82ca97 100644
--- a/integration/testing-module-override/tsconfig.json
+++ b/sample/33-graphql-mercurius/tsconfig.json
@@ -6,7 +6,7 @@
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
     "allowSyntheticDefaultImports": true,
-    "target": "es2017",
+    "target": "ES2021",
     "sourceMap": true,
     "outDir": "./dist",
     "baseUrl": "./",
diff --git a/tools/benchmarks/get-benchmarks.ts b/tools/benchmarks/get-benchmarks.ts
index eaf9a320b..a4fc51668 100644
--- a/tools/benchmarks/get-benchmarks.ts
+++ b/tools/benchmarks/get-benchmarks.ts
@@ -23,7 +23,13 @@ async function runBenchmarkOfLib(lib: string): Promise<WrkResults> {
   const libPath = join(BENCHMARK_PATH, `${lib}.js`);
   const process = spawn('node', [libPath], {
     detached: true,
-    stdio: 'ignore',
+  });
+
+  process.stdout!.on('data', data => {
+    console.log(`stdout: ${data}`);
+  });
+  process.stderr!.on('data', data => {
+    console.log(`stderr: ${data}`);
   });
 
   process.unref();
@@ -32,7 +38,7 @@ async function runBenchmarkOfLib(lib: string): Promise<WrkResults> {
 
   const result = await wrk({
     threads: 8,
-    duraton: '10s',
+    duration: '10s',
     connections: 1024,
     url: 'http://localhost:3000',
   });
diff --git a/tools/gulp/gulpfile.ts b/tools/gulp/gulpfile.ts
index de25610c2..1e6200761 100644
--- a/tools/gulp/gulpfile.ts
+++ b/tools/gulp/gulpfile.ts
@@ -1,5 +1,4 @@
-import './tasks/copy-misc';
 import './tasks/clean';
-import './tasks/packages';
+import './tasks/copy-misc';
 import './tasks/move';
 import './tasks/samples';
diff --git a/tools/gulp/tasks/move.ts b/tools/gulp/tasks/move.ts
index d01a29d59..0991e1e6f 100644
--- a/tools/gulp/tasks/move.ts
+++ b/tools/gulp/tasks/move.ts
@@ -3,12 +3,24 @@ import { join } from 'path';
 import { samplePath } from '../config';
 import { containsPackageJson, getDirs } from '../util/task-helpers';
 
+const distFiles = src([
+  'packages/**/*',
+  '!packages/**/*.ts',
+  'packages/**/*.d.ts',
+]);
+
+/**
+ * Moves the compiled nest files into "node_module" folder.
+ */
+function moveToNodeModules() {
+  return distFiles.pipe(dest('node_modules/@nestjs'));
+}
+
 /**
  * Moves the compiled nest files into the `samples/*` dirs.
  */
-function move() {
+function moveToSamples() {
   const samplesDirs = getDirs(samplePath);
-  const distFiles = src(['node_modules/@nestjs/**/*']);
 
   /**
    * Flatten the sampleDirs
@@ -31,4 +43,5 @@ function move() {
   );
 }
 
-task('move', move);
+task('move:node_modules', moveToNodeModules);
+task('move:samples', moveToSamples);
diff --git a/tools/gulp/tasks/packages.ts b/tools/gulp/tasks/packages.ts
deleted file mode 100644
index d71d76e90..000000000
--- a/tools/gulp/tasks/packages.ts
+++ /dev/null
@@ -1,78 +0,0 @@
-import { source, packagePaths } from '../config';
-import { task, watch, series, dest } from 'gulp';
-import { createProject } from 'gulp-typescript';
-import * as sourcemaps from 'gulp-sourcemaps';
-import * as log from 'fancy-log';
-
-// Has to be a hardcoded object due to build order
-const packages = {
-  common: createProject('packages/common/tsconfig.json'),
-  core: createProject('packages/core/tsconfig.json'),
-  microservices: createProject('packages/microservices/tsconfig.json'),
-  websockets: createProject('packages/websockets/tsconfig.json'),
-  testing: createProject('packages/testing/tsconfig.json'),
-  'platform-express': createProject('packages/platform-express/tsconfig.json'),
-  'platform-fastify': createProject('packages/platform-fastify/tsconfig.json'),
-  'platform-socket.io': createProject(
-    'packages/platform-socket.io/tsconfig.json',
-  ),
-  'platform-ws': createProject('packages/platform-ws/tsconfig.json'),
-};
-
-const modules = Object.keys(packages);
-
-const distId = process.argv.indexOf('--dist');
-const dist = distId < 0 ? source : process.argv[distId + 1];
-
-/**
- * Watches the packages/* folder and
- * builds the package on file change
- */
-function defaultTask() {
-  log.info('Watching files..');
-  modules.forEach(packageName => {
-    watch(
-      [`${source}/${packageName}/**/*.ts`, `${source}/${packageName}/*.ts`],
-      series(packageName),
-    );
-  });
-}
-
-/**
- * Builds the given package
- * @param packageName The name of the package
- */
-function buildPackage(packageName: string) {
-  return packages[packageName]
-    .src()
-    .pipe(packages[packageName]())
-    .pipe(dest(`${dist}/${packageName}`));
-}
-
-/**
- * Builds the given package and adds sourcemaps
- * @param packageName The name of the package
- */
-function buildPackageDev(packageName: string) {
-  return packages[packageName]
-    .src()
-    .pipe(sourcemaps.init())
-    .pipe(packages[packageName]())
-    .pipe(
-      sourcemaps.mapSources(
-        (sourcePath: string) => './' + sourcePath.split('/').pop(),
-      ),
-    )
-    .pipe(sourcemaps.write('.', {}))
-    .pipe(dest(`${dist}/${packageName}`));
-}
-
-modules.forEach(packageName => {
-  task(packageName, () => buildPackage(packageName));
-  task(`${packageName}:dev`, () => buildPackageDev(packageName));
-});
-
-task('common:dev', series(modules.map(packageName => `${packageName}:dev`)));
-task('build', series(modules));
-task('build:dev', series('common:dev'));
-task('default', defaultTask);
diff --git a/tools/gulp/tsconfig.json b/tools/gulp/tsconfig.json
index 6438b3c5a..043217830 100644
--- a/tools/gulp/tsconfig.json
+++ b/tools/gulp/tsconfig.json
@@ -3,7 +3,6 @@
     "experimentalDecorators": true,
     "noUnusedParameters": false,
     "noUnusedLocals": false,
-    "lib": ["es2015", "dom", "es2016.array.include"],
     "module": "commonjs",
     "moduleResolution": "node",
     "outDir": "../../dist/tools/gulp",
@@ -12,7 +11,7 @@
     "noImplicitThis": true,
     "noEmitOnError": true,
     "noImplicitAny": false,
-    "target": "es5",
+    "target": "ES2021",
     "types": [
       "node"
     ],
diff --git a/tools/gulp/util/task-helpers.ts b/tools/gulp/util/task-helpers.ts
index 736a1087c..9e9e65e3c 100644
--- a/tools/gulp/util/task-helpers.ts
+++ b/tools/gulp/util/task-helpers.ts
@@ -15,7 +15,7 @@ export function getDirs(base: string) {
 
 /**
  * Checks if the directory contains a package.json file
- * @param dir Path to the dircetory
+ * @param dir Path to the directory
  * @returns True if the directory contains a package.json
  */
 export function containsPackageJson(dir: string) {
diff --git a/tsconfig.json b/tsconfig.json
index 036b1a814..89fc99832 100644
--- a/tsconfig.json
+++ b/tsconfig.json
@@ -1,18 +1,18 @@
 {
   "compilerOptions": {
     "module": "commonjs",
-    "declaration": false,
     "noImplicitAny": false,
     "noUnusedLocals": false,
     "removeComments": true,
     "noLib": false,
     "emitDecoratorMetadata": true,
     "experimentalDecorators": true,
-    "target": "es6",
+    "useUnknownInCatchVariables": false,
+    "target": "ES2021",
     "sourceMap": true,
-    "allowJs": true,
+    "allowJs": false,
     "outDir": "dist",
-    "lib": ["es7"],
+    "baseUrl": ".",
     "paths": {
       "@nestjs/common": ["./packages/common"],
       "@nestjs/common/*": ["./packages/common/*"],
@@ -30,7 +30,7 @@
       "@nestjs/platform-ws/*": ["./packages/platform-ws/*"],
       "@nestjs/platform-fastify": ["./packages/platform-fastify"],
       "@nestjs/platform-fastify/*": ["./packages/platform-fastify/*"],
-      "@nestjs/platform-socket.io": ["./packages/platform-ws"],
+      "@nestjs/platform-socket.io": ["./packages/platform-socket.io"],
       "@nestjs/platform-socket.io/*": ["./packages/platform-socket.io/*"],
     }
   },
diff --git a/tsconfig.spec.json b/tsconfig.spec.json
index 60e239b85..95af08508 100644
--- a/tsconfig.spec.json
+++ b/tsconfig.spec.json
@@ -2,4 +2,4 @@
   "extends": "./tsconfig.json",
   "include": ["integration/**/*", "**/*.spec.ts"],
   "exclude": ["node_modules", "dist"]
-}
+}
\ No newline at end of file
